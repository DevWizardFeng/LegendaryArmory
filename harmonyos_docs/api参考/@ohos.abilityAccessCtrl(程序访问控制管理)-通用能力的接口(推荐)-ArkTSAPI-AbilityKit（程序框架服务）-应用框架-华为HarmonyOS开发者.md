<h1 _ngcontent-gnp-c119="" class="doc-title ng-star-inserted" title="@ohos.abilityAccessCtrl (程序访问控制管理)"> @ohos.abilityAccessCtrl (程序访问控制管理) </h1>

<div _ngcontent-gnp-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p>程序访问控制提供应用程序的权限校验和管理能力。</p>    <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">      <p>本模块首批接口从API version 8开始支持。后续版本的新增接口，采用上角标单独标记接口的起始版本。</p>     </div></div></div>    <div class="tiledSection">     <h2 id="导入模块" device-type="phone,2in1,tablet,wearable,tv">导入模块<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="导入模块" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><div _ngcontent-gnp-c106="" class="highlight-div"><div _ngcontent-gnp-c106="" class="highlight-div-header"><div _ngcontent-gnp-c106="" class="highlight-div-header-left"><div _ngcontent-gnp-c106="" class="handle-button expand-button"><div _ngcontent-gnp-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gnp-c106="" class="highlight-div-header-right"><div _ngcontent-gnp-c106="" class="handle-button ai-button"></div><div _ngcontent-gnp-c106="" class="handle-button line-button"><div _ngcontent-gnp-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gnp-c106="" class="handle-button theme-button"><div _ngcontent-gnp-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gnp-c106="" class="handle-button copy-button"><div _ngcontent-gnp-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gnp-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { abilityAccessCtrl } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="abilityaccessctrlcreateatmanager" device-type="phone,2in1,tablet,wearable,tv">abilityAccessCtrl.createAtManager<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="abilityaccessctrlcreateatmanager" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>createAtManager(): AtManager</p>     <p>访问控制管理：创建程序访问控制管理的实例对象。</p>     <p><strong>元服务API：</strong> 从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力：</strong> SystemCapability.Security.AccessToken</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.4.7.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.4.7.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-abilityaccessctrl#atmanager">AtManager</a></td>         <td class="cellrowborder" width="50%">获取程序访问控制模块的实例。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-gnp-c106="" class="highlight-div"><div _ngcontent-gnp-c106="" class="highlight-div-header"><div _ngcontent-gnp-c106="" class="highlight-div-header-left"><div _ngcontent-gnp-c106="" class="handle-button expand-button"><div _ngcontent-gnp-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gnp-c106="" class="highlight-div-header-right"><div _ngcontent-gnp-c106="" class="handle-button ai-button"></div><div _ngcontent-gnp-c106="" class="handle-button line-button"><div _ngcontent-gnp-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gnp-c106="" class="handle-button theme-button"><div _ngcontent-gnp-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gnp-c106="" class="handle-button copy-button"><div _ngcontent-gnp-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gnp-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">let</span> <span class="hljs-attr">atManager</span>: abilityAccessCtrl.<span class="hljs-property">AtManager</span> = abilityAccessCtrl.<span class="hljs-title function_">createAtManager</span>();</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="atmanager" device-type="phone,2in1,tablet,wearable,tv">AtManager<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="atmanager" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>管理访问控制模块的实例。</p>    </div>    <div class="tiledSection">     <h3 id="checkaccesstoken9" device-type="phone,2in1,tablet,wearable,tv" class="firsth2">checkAccessToken<sup>9+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="checkaccesstoken9" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>checkAccessToken(tokenID: number, permissionName: Permissions): Promise&lt;GrantStatus&gt;</p>     <p>校验应用是否被授予权限。使用Promise异步回调。</p>     <p><strong>元服务API：</strong> 从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力：</strong> SystemCapability.Security.AccessToken</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.6.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.6.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.6.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.6.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">tokenID</td>         <td class="cellrowborder" width="25%">number</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">要校验的目标应用的身份标识，可通过应用的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-bundlemanager-applicationinfo">ApplicationInfo</a>的accessTokenId字段获得。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">permissionName</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/app-permissions" target="_blank">Permissions</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">需要校验的权限名称，合法的权限名取值可在<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/app-permissions" target="_blank">应用权限列表</a>中查询。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.6.9.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.6.9.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-abilityaccessctrl#grantstatus">GrantStatus</a>&gt;</td>         <td class="cellrowborder" width="50%">Promise对象，返回授权状态结果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-access-token">访问控制错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.6.12.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.6.12.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1.Mandatory parameters are left unspecified; 2.Incorrect parameter types.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">12100001</td>         <td class="cellrowborder" width="50%">Invalid parameter. The tokenID is 0, or the permissionName exceeds 256 characters.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-gnp-c106="" class="highlight-div"><div _ngcontent-gnp-c106="" class="highlight-div-header"><div _ngcontent-gnp-c106="" class="highlight-div-header-left"><div _ngcontent-gnp-c106="" class="handle-button expand-button"><div _ngcontent-gnp-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gnp-c106="" class="highlight-div-header-right"><div _ngcontent-gnp-c106="" class="handle-button ai-button"></div><div _ngcontent-gnp-c106="" class="handle-button line-button"><div _ngcontent-gnp-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gnp-c106="" class="handle-button theme-button"><div _ngcontent-gnp-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gnp-c106="" class="handle-button copy-button"><div _ngcontent-gnp-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gnp-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { abilityAccessCtrl } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">atManager</span>: abilityAccessCtrl.<span class="hljs-property">AtManager</span> = abilityAccessCtrl.<span class="hljs-title function_">createAtManager</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tokenID</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>; <span class="hljs-comment">// 系统应用可以通过bundleManager.getApplicationInfo获取，三方应用可以通过bundleManager.getBundleInfoForSelf获取。</span></li><li>atManager.<span class="hljs-title function_">checkAccessToken</span>(tokenID, <span class="hljs-string">'ohos.permission.GRANT_SENSITIVE_PERMISSIONS'</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">data: abilityAccessCtrl.GrantStatus</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`checkAccessToken success, result: <span class="hljs-subst">${data}</span>`</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`checkAccessToken fail, code: <span class="hljs-subst">${err.code}</span>, message: <span class="hljs-subst">${err.message}</span>`</span>);</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="checkaccesstokensync10" device-type="phone,2in1,tablet,wearable,tv">checkAccessTokenSync<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="checkaccesstokensync10" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>checkAccessTokenSync(tokenID: number, permissionName: Permissions): GrantStatus</p>     <p>校验应用是否被授予权限，同步返回结果。</p>     <p><strong>元服务API：</strong> 从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力：</strong> SystemCapability.Security.AccessToken</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.7.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.7.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.7.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.7.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">tokenID</td>         <td class="cellrowborder" width="25%">number</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">要校验应用的身份标识，可通过应用的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-bundlemanager-applicationinfo">ApplicationInfo</a>的accessTokenId字段获得。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">permissionName</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/app-permissions" target="_blank">Permissions</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">需要校验的权限名称，合法的权限名取值可在<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/app-permissions" target="_blank">应用权限列表</a>中查询。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.7.9.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.7.9.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-abilityaccessctrl#grantstatus">GrantStatus</a></td>         <td class="cellrowborder" width="50%">枚举实例，返回授权状态。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-access-token">访问控制错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.7.12.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.7.12.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1.Mandatory parameters are left unspecified; 2.Incorrect parameter types.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">12100001</td>         <td class="cellrowborder" width="50%">Invalid parameter. The tokenID is 0, or the permissionName exceeds 256 characters.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-gnp-c106="" class="highlight-div"><div _ngcontent-gnp-c106="" class="highlight-div-header"><div _ngcontent-gnp-c106="" class="highlight-div-header-left"><div _ngcontent-gnp-c106="" class="handle-button expand-button"><div _ngcontent-gnp-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gnp-c106="" class="highlight-div-header-right"><div _ngcontent-gnp-c106="" class="handle-button ai-button"></div><div _ngcontent-gnp-c106="" class="handle-button line-button"><div _ngcontent-gnp-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gnp-c106="" class="handle-button theme-button"><div _ngcontent-gnp-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gnp-c106="" class="handle-button copy-button"><div _ngcontent-gnp-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gnp-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { abilityAccessCtrl, <span class="hljs-title class_">Permissions</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">atManager</span>: abilityAccessCtrl.<span class="hljs-property">AtManager</span> = abilityAccessCtrl.<span class="hljs-title function_">createAtManager</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tokenID</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>; <span class="hljs-comment">// 系统应用可以通过bundleManager.getApplicationInfo获取，三方应用可以通过bundleManager.getBundleInfoForSelf获取。</span></li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">permissionName</span>: <span class="hljs-title class_">Permissions</span> = <span class="hljs-string">'ohos.permission.GRANT_SENSITIVE_PERMISSIONS'</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">data</span>: abilityAccessCtrl.<span class="hljs-property">GrantStatus</span> = atManager.<span class="hljs-title function_">checkAccessTokenSync</span>(tokenID, permissionName);</li><li><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`Result: <span class="hljs-subst">${data}</span>`</span>);</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="on18" device-type="phone,2in1,tablet,wearable,tv">on<sup>18+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="on18" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>on(type: 'selfPermissionStateChange', permissionList: Array&lt;Permissions&gt;, callback: Callback&lt;PermissionStateChangeInfo&gt;): void</p>     <p>订阅本应用的指定权限列表的权限授权状态变化事件。当本应用对应权限的授权状态发生变化时，触发对应回调函数的执行。</p>     <ul>      <li>       <p>多次调用本订阅接口时，如果订阅的权限列表相同，callback不同，允许订阅成功。</p></li>      <li>       <p>多次调用本订阅接口时，如果订阅的权限列表间有相同的子集，callback相同时，订阅失败。</p></li>     </ul>     <p><strong>元服务API：</strong> 从API version 18开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力：</strong> SystemCapability.Security.AccessToken</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.8.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.8.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.8.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.8.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">订阅事件类型，固定为'selfPermissionStateChange'，自身权限状态变更事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">permissionList</td>         <td class="cellrowborder" width="25%">Array&lt;<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/app-permissions" target="_blank">Permissions</a>&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">订阅的权限名列表，如果为空，则表示订阅所有的权限状态变化，合法的权限名取值可在<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/app-permissions" target="_blank">应用权限列表</a>中查询。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-abilityaccessctrl#permissionstatechangeinfo18">PermissionStateChangeInfo</a>&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">订阅指定权限名状态变更事件的回调。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-access-token">访问控制错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.8.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.8.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1.Mandatory parameters are left unspecified; 2.Incorrect parameter types.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">12100001</td>         <td class="cellrowborder" width="50%">Invalid parameter. Possible causes: 1. The permissionList exceeds the size limit; 2. The permissionNames in the list are all invalid.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">12100004</td>         <td class="cellrowborder" width="50%">The API is used repeatedly with the same input.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">12100005</td>         <td class="cellrowborder" width="50%">The registration time has exceeded the limit.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">12100007</td>         <td class="cellrowborder" width="50%">The service is abnormal.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-gnp-c106="" class="highlight-div"><div _ngcontent-gnp-c106="" class="highlight-div-header"><div _ngcontent-gnp-c106="" class="highlight-div-header-left"><div _ngcontent-gnp-c106="" class="handle-button expand-button"><div _ngcontent-gnp-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gnp-c106="" class="highlight-div-header-right"><div _ngcontent-gnp-c106="" class="handle-button ai-button"></div><div _ngcontent-gnp-c106="" class="handle-button line-button"><div _ngcontent-gnp-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gnp-c106="" class="handle-button theme-button"><div _ngcontent-gnp-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gnp-c106="" class="handle-button copy-button"><div _ngcontent-gnp-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gnp-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { abilityAccessCtrl, <span class="hljs-title class_">Permissions</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">atManager</span>: abilityAccessCtrl.<span class="hljs-property">AtManager</span> = abilityAccessCtrl.<span class="hljs-title function_">createAtManager</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">permissionList</span>: <span class="hljs-title class_">Array</span>&lt;<span class="hljs-title class_">Permissions</span>&gt; = [<span class="hljs-string">'ohos.permission.APPROXIMATELY_LOCATION'</span>];</li><li><span class="hljs-keyword">try</span> {</li><li>    atManager.<span class="hljs-title function_">on</span>(<span class="hljs-string">'selfPermissionStateChange'</span>, permissionList, <span class="hljs-function">(<span class="hljs-params">data: abilityAccessCtrl.PermissionStateChangeInfo</span>) =&gt;</span> {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`receive permission state change, result: <span class="hljs-subst">${data}</span>`</span>);</li><li>    });</li><li>} <span class="hljs-keyword">catch</span>(err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Code: <span class="hljs-subst">${err.code}</span>, message: <span class="hljs-subst">${err.message}</span>`</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="off18" device-type="phone,2in1,tablet,wearable,tv">off<sup>18+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="off18" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>off(type: 'selfPermissionStateChange', permissionList: Array&lt;Permissions&gt;, callback?: Callback&lt;PermissionStateChangeInfo&gt;): void</p>     <p>取消订阅自身指定权限列表的权限状态变更事件，使用callback回调异步返回结果。</p>     <p>取消订阅不传callback时，批量删除permissionList下面的所有callback。</p>     <p><strong>元服务API：</strong> 从API version 18开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力：</strong> SystemCapability.Security.AccessToken</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.9.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.9.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.9.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.9.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">订阅事件类型，固定为'selfPermissionStateChange'，权限状态变更事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">permissionList</td>         <td class="cellrowborder" width="25%">Array&lt;<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/app-permissions" target="_blank">Permissions</a>&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">取消订阅的权限名列表，为空时表示取消订阅所有的权限状态变化，必须与on的输入一致，合法的权限名取值可在<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/app-permissions" target="_blank">应用权限列表</a>中查询。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-abilityaccessctrl#permissionstatechangeinfo18">PermissionStateChangeInfo</a>&gt;</td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">取消订阅指定tokenID与指定权限名状态变更事件的回调。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-access-token">访问控制错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.9.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.9.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1.Mandatory parameters are left unspecified; 2.Incorrect parameter types.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">12100001</td>         <td class="cellrowborder" width="50%">Invalid parameter. The permissionNames in the list are all invalid.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">12100004</td>         <td class="cellrowborder" width="50%">The API is not used in pair with 'on'.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">12100007</td>         <td class="cellrowborder" width="50%">The service is abnormal.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-gnp-c106="" class="highlight-div"><div _ngcontent-gnp-c106="" class="highlight-div-header"><div _ngcontent-gnp-c106="" class="highlight-div-header-left"><div _ngcontent-gnp-c106="" class="handle-button expand-button"><div _ngcontent-gnp-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gnp-c106="" class="highlight-div-header-right"><div _ngcontent-gnp-c106="" class="handle-button ai-button"></div><div _ngcontent-gnp-c106="" class="handle-button line-button"><div _ngcontent-gnp-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gnp-c106="" class="handle-button theme-button"><div _ngcontent-gnp-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gnp-c106="" class="handle-button copy-button"><div _ngcontent-gnp-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gnp-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { abilityAccessCtrl, <span class="hljs-title class_">Permissions</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">atManager</span>: abilityAccessCtrl.<span class="hljs-property">AtManager</span> = abilityAccessCtrl.<span class="hljs-title function_">createAtManager</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">permissionList</span>: <span class="hljs-title class_">Array</span>&lt;<span class="hljs-title class_">Permissions</span>&gt; = [<span class="hljs-string">'ohos.permission.APPROXIMATELY_LOCATION'</span>];</li><li><span class="hljs-keyword">try</span> {</li><li>    atManager.<span class="hljs-title function_">off</span>(<span class="hljs-string">'selfPermissionStateChange'</span>, permissionList);</li><li>} <span class="hljs-keyword">catch</span>(err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Code: <span class="hljs-subst">${err.code}</span>, message: <span class="hljs-subst">${err.message}</span>`</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="requestpermissionsfromuser9" device-type="phone,2in1,tablet,wearable,tv">requestPermissionsFromUser<sup>9+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="requestpermissionsfromuser9" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>requestPermissionsFromUser(context: Context, permissionList: Array&lt;Permissions&gt;, requestCallback: AsyncCallback&lt;PermissionRequestResult&gt;): void</p>     <p>用于UIAbility/UIExtensionAbility拉起弹框请求<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/request-user-authorization" target="_blank">用户授权</a>。使用callback异步回调。</p>     <p>如果用户拒绝授权，将无法再次拉起弹框，需要用户在系统应用“设置”的界面中，手动授予权限，或是调用<a href="/consumer/cn/doc/harmonyos-references/js-apis-abilityaccessctrl#requestpermissiononsetting12">requestPermissionOnSetting</a>，拉起权限设置弹框，引导用户授权。</p>     <p><span><img originheight="200" originwidth="320" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211115406.19519770216627561317643953952012:50001231000000:2800:FEC8029BCC65ECBC2D9E5EA8D9F39638DC73674A220B612E47C7520F39086245.png" width="320" height="200"></span></p>     <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>模型约束：</strong> 此接口仅可在Stage模型下使用。</p>     <p><strong>系统能力：</strong> SystemCapability.Security.AccessToken</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.10.10.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.10.10.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.10.10.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.10.10.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">context</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-context">Context</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">请求权限的UIAbility/UIExtensionAbility的Context。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">permissionList</td>         <td class="cellrowborder" width="25%">Array&lt;<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/app-permissions" target="_blank">Permissions</a>&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">权限名列表，合法的权限名取值可在<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/app-permissions" target="_blank">应用权限列表</a>中查询。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">requestCallback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-permissionrequestresult">PermissionRequestResult</a>&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数，返回接口调用是否成功的结果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-access-token">访问控制错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.10.13.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.10.13.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1.Mandatory parameters are left unspecified; 2.Incorrect parameter types.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">12100001</td>         <td class="cellrowborder" width="50%">Invalid parameter. The context is invalid when it does not belong to the application itself.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <p>下述示例中context的获取方式请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/uiability-usage#获取uiability的上下文信息" target="_blank">获取UIAbility的上下文信息</a>。</p>     <p>关于向用户申请授权的完整流程及示例，请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/request-user-authorization" target="_blank">向用户申请授权</a>。</p>     <div _ngcontent-gnp-c106="" class="highlight-div"><div _ngcontent-gnp-c106="" class="highlight-div-header"><div _ngcontent-gnp-c106="" class="highlight-div-header-left"><div _ngcontent-gnp-c106="" class="handle-button expand-button"><div _ngcontent-gnp-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gnp-c106="" class="highlight-div-header-right"><div _ngcontent-gnp-c106="" class="handle-button ai-button"></div><div _ngcontent-gnp-c106="" class="handle-button line-button"><div _ngcontent-gnp-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gnp-c106="" class="handle-button theme-button"><div _ngcontent-gnp-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gnp-c106="" class="handle-button copy-button"><div _ngcontent-gnp-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gnp-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { abilityAccessCtrl, <span class="hljs-title class_">Context</span>, <span class="hljs-title class_">PermissionRequestResult</span>, common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">atManager</span>: abilityAccessCtrl.<span class="hljs-property">AtManager</span> = abilityAccessCtrl.<span class="hljs-title function_">createAtManager</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">context</span>: <span class="hljs-title class_">Context</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li>atManager.<span class="hljs-title function_">requestPermissionsFromUser</span>(context, [<span class="hljs-string">'ohos.permission.CAMERA'</span>], <span class="hljs-function">(<span class="hljs-params">err: BusinessError, data: PermissionRequestResult</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`requestPermissionsFromUser fail, code: <span class="hljs-subst">${err.code}</span>, message: <span class="hljs-subst">${err.message}</span>`</span>);</li><li>  } <span class="hljs-keyword">else</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`requestPermissionsFromUser success, result: <span class="hljs-subst">${data}</span>`</span>);</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'requestPermissionsFromUser data permissions:'</span> + data.<span class="hljs-property">permissions</span>);</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'requestPermissionsFromUser data authResults:'</span> + data.<span class="hljs-property">authResults</span>);</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'requestPermissionsFromUser data dialogShownResults:'</span> + data.<span class="hljs-property">dialogShownResults</span>);</li><li>  }</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="requestpermissionsfromuser9-1" device-type="phone,2in1,tablet,wearable,tv">requestPermissionsFromUser<sup>9+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="requestpermissionsfromuser9-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>requestPermissionsFromUser(context: Context, permissionList: Array&lt;Permissions&gt;): Promise&lt;PermissionRequestResult&gt;</p>     <p>用于UIAbility/UIExtensionAbility拉起弹框请求<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/request-user-authorization" target="_blank">用户授权</a>。使用promise异步回调。</p>     <p>如果用户拒绝授权，将无法再次拉起弹框，需要用户在系统应用“设置”的界面中，手动授予权限，或是调用<a href="/consumer/cn/doc/harmonyos-references/js-apis-abilityaccessctrl#requestpermissiononsetting12">requestPermissionOnSetting</a>，拉起权限设置弹框，引导用户授权。</p>     <p><strong>元服务API：</strong> 从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>模型约束：</strong> 此接口仅可在Stage模型下使用。</p>     <p><strong>系统能力：</strong> SystemCapability.Security.AccessToken</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.11.9.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.11.9.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.11.9.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.11.9.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">context</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-context">Context</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">请求权限的UIAbility/UIExtensionAbility的Context。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">permissionList</td>         <td class="cellrowborder" width="25%">Array&lt;<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/app-permissions" target="_blank">Permissions</a>&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">需要校验的权限名称，合法的权限名取值可在<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/app-permissions" target="_blank">应用权限列表</a>中查询。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.11.11.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.11.11.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-permissionrequestresult">PermissionRequestResult</a>&gt;</td>         <td class="cellrowborder" width="50%">返回一个Promise，包含接口的结果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-access-token">访问控制错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.11.14.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.11.14.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1.Mandatory parameters are left unspecified; 2.Incorrect parameter types.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">12100001</td>         <td class="cellrowborder" width="50%">Invalid parameter. The context is invalid when it does not belong to the application itself.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <p>下述示例中context的获取方式请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/uiability-usage#获取uiability的上下文信息" target="_blank">获取UIAbility的上下文信息</a>。</p>     <p>关于向用户申请授权的完整流程及示例，请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/request-user-authorization" target="_blank">向用户申请授权</a>。</p>     <div _ngcontent-gnp-c106="" class="highlight-div"><div _ngcontent-gnp-c106="" class="highlight-div-header"><div _ngcontent-gnp-c106="" class="highlight-div-header-left"><div _ngcontent-gnp-c106="" class="handle-button expand-button"><div _ngcontent-gnp-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gnp-c106="" class="highlight-div-header-right"><div _ngcontent-gnp-c106="" class="handle-button ai-button"></div><div _ngcontent-gnp-c106="" class="handle-button line-button"><div _ngcontent-gnp-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gnp-c106="" class="handle-button theme-button"><div _ngcontent-gnp-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gnp-c106="" class="handle-button copy-button"><div _ngcontent-gnp-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gnp-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { abilityAccessCtrl, <span class="hljs-title class_">Context</span>, <span class="hljs-title class_">PermissionRequestResult</span>, common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">atManager</span>: abilityAccessCtrl.<span class="hljs-property">AtManager</span> = abilityAccessCtrl.<span class="hljs-title function_">createAtManager</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">context</span>: <span class="hljs-title class_">Context</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li>atManager.<span class="hljs-title function_">requestPermissionsFromUser</span>(context, [<span class="hljs-string">'ohos.permission.CAMERA'</span>]).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">data: PermissionRequestResult</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`requestPermissionsFromUser success, result: <span class="hljs-subst">${data}</span>`</span>);</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'requestPermissionsFromUser data permissions:'</span> + data.<span class="hljs-property">permissions</span>);</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'requestPermissionsFromUser data authResults:'</span> + data.<span class="hljs-property">authResults</span>);</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'requestPermissionsFromUser data dialogShownResults:'</span> + data.<span class="hljs-property">dialogShownResults</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`requestPermissionsFromUser fail, code: <span class="hljs-subst">${err.code}</span>, message: <span class="hljs-subst">${err.message}</span>`</span>);</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="requestpermissiononsetting12" device-type="phone,2in1,tablet,wearable,tv">requestPermissionOnSetting<sup>12+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="requestpermissiononsetting12" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>requestPermissionOnSetting(context: Context, permissionList: Array&lt;Permissions&gt;): Promise&lt;Array&lt;GrantStatus&gt;&gt;</p>     <p>用于<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability#uiability">UIAbility</a>/<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiextensionability#uiextensionability">UIExtensionAbility</a>二次拉起权限设置弹框。</p>     <p>在调用此接口前，应用需要先调用<a href="/consumer/cn/doc/harmonyos-references/js-apis-abilityaccessctrl#requestpermissionsfromuser9">requestPermissionsFromUser</a>，如果用户在首次弹窗授权时已授权，调用当前接口将无法拉起弹窗。</p>     <p><span><img originheight="497" originwidth="320" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211115406.60429274049807616595823223084600:50001231000000:2800:18043F1D3101A9A78A7B4FFED816794AD9AA569012AC30FA365753BB606B0C23.png" width="320" height="497"></span></p>     <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>模型约束：</strong> 此接口仅可在Stage模型下使用。</p>     <p><strong>系统能力：</strong> SystemCapability.Security.AccessToken</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.12.10.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.12.10.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.12.10.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.12.10.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">context</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-context">Context</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">请求权限的UIAbility/UIExtensionAbility的Context。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">permissionList</td>         <td class="cellrowborder" width="25%">Array&lt;<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/app-permissions" target="_blank">Permissions</a>&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">权限名列表，合法的权限名取值可在<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/app-permission-group-list" target="_blank">应用权限组列表</a>中查询。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.12.12.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.12.12.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;Array&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-abilityaccessctrl#grantstatus">GrantStatus</a>&gt;&gt;</td>         <td class="cellrowborder" width="50%">Promise对象，返回授权状态结果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-access-token">访问控制错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.12.15.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.12.15.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">12100001</td>         <td class="cellrowborder" width="50%">          <p>Invalid parameter. Possible causes:</p>          <p>1. The context is invalid because it does not belong to the application itself;</p>          <p>2. The permission list contains the permission that is not declared in the module.json file;</p>          <p>3. The permission list is invalid because the permissions in it do not belong to the same permission group.</p></td>        </tr>        <tr>         <td class="cellrowborder" width="50%">12100011</td>         <td class="cellrowborder" width="50%">All permissions in the permission list have been granted.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">12100012</td>         <td class="cellrowborder" width="50%">The permission list contains the permission that has not been revoked by the user.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">12100014</td>         <td class="cellrowborder" width="50%">Unexpected permission. You cannot request this type of permission from users via a pop-up window.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <p>示例中context的获取方式请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/uiability-usage#获取uiability的上下文信息" target="_blank">获取UIAbility的上下文信息</a>。</p>     <div _ngcontent-gnp-c106="" class="highlight-div"><div _ngcontent-gnp-c106="" class="highlight-div-header"><div _ngcontent-gnp-c106="" class="highlight-div-header-left"><div _ngcontent-gnp-c106="" class="handle-button expand-button"><div _ngcontent-gnp-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gnp-c106="" class="highlight-div-header-right"><div _ngcontent-gnp-c106="" class="handle-button ai-button"></div><div _ngcontent-gnp-c106="" class="handle-button line-button"><div _ngcontent-gnp-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gnp-c106="" class="handle-button theme-button"><div _ngcontent-gnp-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gnp-c106="" class="handle-button copy-button"><div _ngcontent-gnp-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gnp-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { abilityAccessCtrl, <span class="hljs-title class_">Context</span>, common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">atManager</span>: abilityAccessCtrl.<span class="hljs-property">AtManager</span> = abilityAccessCtrl.<span class="hljs-title function_">createAtManager</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">context</span>: <span class="hljs-title class_">Context</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li>atManager.<span class="hljs-title function_">requestPermissionOnSetting</span>(context, [<span class="hljs-string">'ohos.permission.CAMERA'</span>]).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">data: <span class="hljs-built_in">Array</span>&lt;abilityAccessCtrl.GrantStatus&gt;</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`requestPermissionOnSetting success, result: <span class="hljs-subst">${data}</span>`</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`requestPermissionOnSetting fail, code: <span class="hljs-subst">${err.code}</span>, message: <span class="hljs-subst">${err.message}</span>`</span>);</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="requestglobalswitch12" device-type="phone,2in1,tablet,wearable,tv">requestGlobalSwitch<sup>12+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="requestglobalswitch12" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>requestGlobalSwitch(context: Context, type: SwitchType): Promise&lt;boolean&gt;</p>     <p>用于UIAbility/UIExtensionAbility拉起全局开关设置弹框。</p>     <p>在某些情况下，如果录音、拍照等功能被禁用，应用可拉起此弹框请求用户同意开启对应功能。如果当前全局开关的状态为开启，则不拉起弹框。</p>     <p><span><img originheight="261" originwidth="320" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211115406.29877607297479328249846314671948:50001231000000:2800:1F963C2E0D6AE42EBE7F3F0B35F442322E7720D1156C6A240C532594582C0BED.png" width="320" height="261"></span></p>     <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>模型约束：</strong> 此接口仅可在Stage模型下使用。</p>     <p><strong>系统能力：</strong> SystemCapability.Security.AccessToken</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.13.10.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.13.10.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.13.10.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.13.10.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">context</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-context">Context</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">请求权限的UIAbility/UIExtensionAbility的Context。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-abilityaccessctrl#switchtype12">SwitchType</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">全局开关类型。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.13.12.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.13.12.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;boolean&gt;</td>         <td class="cellrowborder" width="50%">Promise对象，返回全局开关状态。true表示开启，false表示关闭。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-access-token">访问控制错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.13.15.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.13.15.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1. Mandatory parameters are left unspecified; 2. Incorrect parameter types.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">12100001</td>         <td class="cellrowborder" width="50%">Invalid parameter. Possible causes: 1. The context is invalid because it does not belong to the application itself; 2. The type of global switch is not support.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">12100010</td>         <td class="cellrowborder" width="50%">The request already exists.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">12100013</td>         <td class="cellrowborder" width="50%">The specific global switch is already open.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <p>示例中context的获取方式请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/uiability-usage#获取uiability的上下文信息" target="_blank">获取UIAbility的上下文信息</a>。</p>     <div _ngcontent-gnp-c106="" class="highlight-div"><div _ngcontent-gnp-c106="" class="highlight-div-header"><div _ngcontent-gnp-c106="" class="highlight-div-header-left"><div _ngcontent-gnp-c106="" class="handle-button expand-button"><div _ngcontent-gnp-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gnp-c106="" class="highlight-div-header-right"><div _ngcontent-gnp-c106="" class="handle-button ai-button"></div><div _ngcontent-gnp-c106="" class="handle-button line-button"><div _ngcontent-gnp-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gnp-c106="" class="handle-button theme-button"><div _ngcontent-gnp-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gnp-c106="" class="handle-button copy-button"><div _ngcontent-gnp-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gnp-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { abilityAccessCtrl, <span class="hljs-title class_">Context</span>, common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">atManager</span>: abilityAccessCtrl.<span class="hljs-property">AtManager</span> = abilityAccessCtrl.<span class="hljs-title function_">createAtManager</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">context</span>: <span class="hljs-title class_">Context</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li>atManager.<span class="hljs-title function_">requestGlobalSwitch</span>(context, abilityAccessCtrl.<span class="hljs-property">SwitchType</span>.<span class="hljs-property">CAMERA</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">data: <span class="hljs-built_in">Boolean</span></span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`requestGlobalSwitch success, result: <span class="hljs-subst">${data}</span>`</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`requestGlobalSwitch fail, code: <span class="hljs-subst">${err.code}</span>, message: <span class="hljs-subst">${err.message}</span>`</span>);</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="getselfpermissionstatus20" device-type="phone,2in1,tablet,wearable,tv">getSelfPermissionStatus<sup>20+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getselfpermissionstatus20" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>getSelfPermissionStatus(permissionName: Permissions): PermissionStatus</p>     <p>查询应用权限状态，同步返回结果。</p>     <p><strong>元服务API：</strong> 从API version 20开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力：</strong> SystemCapability.Security.AccessToken</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.14.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.14.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.14.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.14.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">permissionName</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/app-permissions" target="_blank">Permissions</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">需要校验的权限名称，合法的权限名取值可在<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/app-permissions" target="_blank">应用权限列表</a>中查询。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.14.9.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.14.9.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-abilityaccessctrl#permissionstatus20">PermissionStatus</a></td>         <td class="cellrowborder" width="50%">枚举实例，返回权限状态。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-access-token">访问控制错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.14.12.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.14.12.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">12100001</td>         <td class="cellrowborder" width="50%">Invalid parameter. The permissionName is empty or exceeds 256 characters.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">12100007</td>         <td class="cellrowborder" width="50%">The service is abnormal.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-gnp-c106="" class="highlight-div"><div _ngcontent-gnp-c106="" class="highlight-div-header"><div _ngcontent-gnp-c106="" class="highlight-div-header-left"><div _ngcontent-gnp-c106="" class="handle-button expand-button"><div _ngcontent-gnp-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gnp-c106="" class="highlight-div-header-right"><div _ngcontent-gnp-c106="" class="handle-button ai-button"></div><div _ngcontent-gnp-c106="" class="handle-button line-button"><div _ngcontent-gnp-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gnp-c106="" class="handle-button theme-button"><div _ngcontent-gnp-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gnp-c106="" class="handle-button copy-button"><div _ngcontent-gnp-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gnp-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { abilityAccessCtrl } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">atManager</span>: abilityAccessCtrl.<span class="hljs-property">AtManager</span> = abilityAccessCtrl.<span class="hljs-title function_">createAtManager</span>();</li><li><span class="hljs-keyword">try</span> {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">data</span>: abilityAccessCtrl.<span class="hljs-property">PermissionStatus</span> = atManager.<span class="hljs-title function_">getSelfPermissionStatus</span>(<span class="hljs-string">'ohos.permission.CAMERA'</span>);</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`getSelfPermissionStatus success, result: <span class="hljs-subst">${data}</span>`</span>);</li><li>} <span class="hljs-keyword">catch</span>(err) {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`getSelfPermissionStatus fail, code: <span class="hljs-subst">${err.code}</span>, message: <span class="hljs-subst">${err.message}</span>`</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="verifyaccesstokensync9" device-type="phone,2in1,tablet,wearable,tv">verifyAccessTokenSync<sup>9+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="verifyaccesstokensync9" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>verifyAccessTokenSync(tokenID: number, permissionName: Permissions): GrantStatus</p>     <p>校验应用是否被授予权限，同步返回结果。</p>     <p><strong>系统能力：</strong> SystemCapability.Security.AccessToken</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.15.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.15.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.15.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.15.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">tokenID</td>         <td class="cellrowborder" width="25%">number</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">要校验应用的身份标识，可通过应用的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-bundlemanager-applicationinfo">ApplicationInfo</a>的accessTokenId字段获得。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">permissionName</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/app-permissions" target="_blank">Permissions</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">需要校验的权限名称，合法的权限名取值可在<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/app-permissions" target="_blank">应用权限列表</a>中查询。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.15.8.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.15.8.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-abilityaccessctrl#grantstatus">GrantStatus</a></td>         <td class="cellrowborder" width="50%">枚举实例，返回授权状态。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-access-token">访问控制错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.15.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.15.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1.Mandatory parameters are left unspecified; 2.Incorrect parameter types.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">12100001</td>         <td class="cellrowborder" width="50%">Invalid parameter. The tokenID is 0, or the permissionName exceeds 256 characters.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-gnp-c106="" class="highlight-div"><div _ngcontent-gnp-c106="" class="highlight-div-header"><div _ngcontent-gnp-c106="" class="highlight-div-header-left"><div _ngcontent-gnp-c106="" class="handle-button expand-button"><div _ngcontent-gnp-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gnp-c106="" class="highlight-div-header-right"><div _ngcontent-gnp-c106="" class="handle-button ai-button"></div><div _ngcontent-gnp-c106="" class="handle-button line-button"><div _ngcontent-gnp-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gnp-c106="" class="handle-button theme-button"><div _ngcontent-gnp-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gnp-c106="" class="handle-button copy-button"><div _ngcontent-gnp-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gnp-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { abilityAccessCtrl } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">atManager</span>: abilityAccessCtrl.<span class="hljs-property">AtManager</span> = abilityAccessCtrl.<span class="hljs-title function_">createAtManager</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tokenID</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>; <span class="hljs-comment">// 系统应用可以通过bundleManager.getApplicationInfo获取，三方应用可以通过bundleManager.getBundleInfoForSelf获取。</span></li><li><span class="hljs-keyword">try</span> {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">data</span>: abilityAccessCtrl.<span class="hljs-property">GrantStatus</span> = atManager.<span class="hljs-title function_">verifyAccessTokenSync</span>(tokenID, <span class="hljs-string">'ohos.permission.GRANT_SENSITIVE_PERMISSIONS'</span>);</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`verifyAccessTokenSync success, result: <span class="hljs-subst">${data}</span>`</span>);</li><li>} <span class="hljs-keyword">catch</span>(err) {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`verifyAccessTokenSync fail, code: <span class="hljs-subst">${err.code}</span>, message: <span class="hljs-subst">${err.message}</span>`</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="verifyaccesstoken9" device-type="phone,2in1,tablet,wearable,tv">verifyAccessToken<sup>9+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="verifyaccesstoken9" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>verifyAccessToken(tokenID: number, permissionName: Permissions): Promise&lt;GrantStatus&gt;</p>     <p>校验应用是否被授予权限。使用Promise异步回调。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>建议使用<a href="/consumer/cn/doc/harmonyos-references/js-apis-abilityaccessctrl#checkaccesstoken9">checkAccessToken</a>替代。</p>      </div></div></div>     <p><strong>系统能力：</strong> SystemCapability.Security.AccessToken</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.16.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.16.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.16.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.16.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">tokenID</td>         <td class="cellrowborder" width="25%">number</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">要校验的目标应用的身份标识，可通过应用的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-bundlemanager-applicationinfo">ApplicationInfo</a>的accessTokenId字段获得。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">permissionName</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/app-permissions" target="_blank">Permissions</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">需要校验的权限名称，合法的权限名取值可在<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/app-permissions" target="_blank">应用权限列表</a>中查询。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.16.9.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.16.9.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-abilityaccessctrl#grantstatus">GrantStatus</a>&gt;</td>         <td class="cellrowborder" width="50%">Promise对象，返回授权状态结果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-gnp-c106="" class="highlight-div"><div _ngcontent-gnp-c106="" class="highlight-div-header"><div _ngcontent-gnp-c106="" class="highlight-div-header-left"><div _ngcontent-gnp-c106="" class="handle-button expand-button"><div _ngcontent-gnp-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gnp-c106="" class="highlight-div-header-right"><div _ngcontent-gnp-c106="" class="handle-button ai-button"></div><div _ngcontent-gnp-c106="" class="handle-button line-button"><div _ngcontent-gnp-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gnp-c106="" class="handle-button theme-button"><div _ngcontent-gnp-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gnp-c106="" class="handle-button copy-button"><div _ngcontent-gnp-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gnp-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { abilityAccessCtrl, <span class="hljs-title class_">Permissions</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">atManager</span>: abilityAccessCtrl.<span class="hljs-property">AtManager</span> = abilityAccessCtrl.<span class="hljs-title function_">createAtManager</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tokenID</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>; <span class="hljs-comment">// 系统应用可以通过bundleManager.getApplicationInfo获取，三方应用可以通过bundleManager.getBundleInfoForSelf获取。</span></li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">permissionName</span>: <span class="hljs-title class_">Permissions</span> = <span class="hljs-string">'ohos.permission.GRANT_SENSITIVE_PERMISSIONS'</span>;</li><li>atManager.<span class="hljs-title function_">verifyAccessToken</span>(tokenID, permissionName).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">data: abilityAccessCtrl.GrantStatus</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`verifyAccessToken success, result: <span class="hljs-subst">${data}</span>`</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`verifyAccessToken fail, code: <span class="hljs-subst">${err.code}</span>, message: <span class="hljs-subst">${err.message}</span>`</span>);</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="verifyaccesstokendeprecated" device-type="phone,2in1,tablet,wearable,tv">verifyAccessToken<sup>(deprecated)</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="verifyaccesstokendeprecated" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>verifyAccessToken(tokenID: number, permissionName: string): Promise&lt;GrantStatus&gt;</p>     <p>校验应用是否被授予权限。使用Promise异步回调。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>从API version 9开始不再维护，建议使用<a href="/consumer/cn/doc/harmonyos-references/js-apis-abilityaccessctrl#checkaccesstoken9">checkAccessToken</a>替代。</p>      </div></div></div>     <p><strong>系统能力：</strong> SystemCapability.Security.AccessToken</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.17.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.17.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.17.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.17.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">tokenID</td>         <td class="cellrowborder" width="25%">number</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">要校验的目标应用的身份标识，可通过应用的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-bundlemanager-applicationinfo">ApplicationInfo</a>的accessTokenId字段获得。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">permissionName</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">需要校验的权限名称，合法的权限名取值可在<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/app-permissions" target="_blank">应用权限列表</a>中查询。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.17.9.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.17.9.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-abilityaccessctrl#grantstatus">GrantStatus</a>&gt;</td>         <td class="cellrowborder" width="50%">Promise对象，返回授权状态结果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-gnp-c106="" class="highlight-div"><div _ngcontent-gnp-c106="" class="highlight-div-header"><div _ngcontent-gnp-c106="" class="highlight-div-header-left"><div _ngcontent-gnp-c106="" class="handle-button expand-button"><div _ngcontent-gnp-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gnp-c106="" class="highlight-div-header-right"><div _ngcontent-gnp-c106="" class="handle-button ai-button"></div><div _ngcontent-gnp-c106="" class="handle-button line-button"><div _ngcontent-gnp-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gnp-c106="" class="handle-button theme-button"><div _ngcontent-gnp-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gnp-c106="" class="handle-button copy-button"><div _ngcontent-gnp-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gnp-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { abilityAccessCtrl } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">atManager</span>: abilityAccessCtrl.<span class="hljs-property">AtManager</span> = abilityAccessCtrl.<span class="hljs-title function_">createAtManager</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tokenID</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>; <span class="hljs-comment">// 系统应用可以通过bundleManager.getApplicationInfo获取，三方应用可以通过bundleManager.getBundleInfoForSelf获取。</span></li><li>atManager.<span class="hljs-title function_">verifyAccessToken</span>(tokenID, <span class="hljs-string">'ohos.permission.GRANT_SENSITIVE_PERMISSIONS'</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">data: abilityAccessCtrl.GrantStatus</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`verifyAccessToken success, result: <span class="hljs-subst">${data}</span>`</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`verifyAccessToken fail, code: <span class="hljs-subst">${err.code}</span>, message: <span class="hljs-subst">${err.message}</span>`</span>);</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="grantstatus" device-type="phone,2in1,tablet,wearable,tv">GrantStatus<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="grantstatus" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>表示授权状态的枚举。</p>     <p><strong>元服务API：</strong> 从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力：</strong> SystemCapability.Security.AccessToken</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.18.5.1.4.1.1" width="33.33333333333333%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.18.5.1.4.1.2" width="33.33333333333333%">值</th>         <th align="left" class="cellrowborder" id="mcps1.3.18.5.1.4.1.3" width="33.33333333333333%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="33.33333333333333%">PERMISSION_DENIED</td>         <td class="cellrowborder" width="33.33333333333333%">-1</td>         <td class="cellrowborder" width="33.33333333333333%">表示未授权。</td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">PERMISSION_GRANTED</td>         <td class="cellrowborder" width="33.33333333333333%">0</td>         <td class="cellrowborder" width="33.33333333333333%">表示已授权。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="switchtype12" device-type="phone,2in1,tablet,wearable,tv">SwitchType<sup>12+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="switchtype12" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>表示全局开关类型的枚举。</p>     <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力：</strong> SystemCapability.Security.AccessToken</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.19.5.1.4.1.1" width="33.33333333333333%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.19.5.1.4.1.2" width="33.33333333333333%">值</th>         <th align="left" class="cellrowborder" id="mcps1.3.19.5.1.4.1.3" width="33.33333333333333%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="33.33333333333333%">CAMERA</td>         <td class="cellrowborder" width="33.33333333333333%">0</td>         <td class="cellrowborder" width="33.33333333333333%">表示相机全局开关。</td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">MICROPHONE</td>         <td class="cellrowborder" width="33.33333333333333%">1</td>         <td class="cellrowborder" width="33.33333333333333%">表示麦克风全局开关。</td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">LOCATION</td>         <td class="cellrowborder" width="33.33333333333333%">2</td>         <td class="cellrowborder" width="33.33333333333333%">表示位置全局开关。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="permissionstatechangetype18" device-type="phone,2in1,tablet,wearable,tv">PermissionStateChangeType<sup>18+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="permissionstatechangetype18" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>表示权限授权状态变化操作类型的枚举。</p>     <p><strong>元服务API：</strong> 从API version 18开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力：</strong> SystemCapability.Security.AccessToken</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.20.5.1.4.1.1" width="33.33333333333333%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.20.5.1.4.1.2" width="33.33333333333333%">值</th>         <th align="left" class="cellrowborder" id="mcps1.3.20.5.1.4.1.3" width="33.33333333333333%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="33.33333333333333%">PERMISSION_REVOKED_OPER</td>         <td class="cellrowborder" width="33.33333333333333%">0</td>         <td class="cellrowborder" width="33.33333333333333%">表示权限取消操作。</td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">PERMISSION_GRANTED_OPER</td>         <td class="cellrowborder" width="33.33333333333333%">1</td>         <td class="cellrowborder" width="33.33333333333333%">表示权限授予操作。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="permissionstatechangeinfo18" device-type="phone,2in1,tablet,wearable,tv">PermissionStateChangeInfo<sup>18+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="permissionstatechangeinfo18" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>表示某次权限授权状态变化的详情。</p>     <p><strong>元服务API：</strong> 从API version 18开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力：</strong> SystemCapability.Security.AccessToken</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.21.5.1.6.1.1" width="20%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.21.5.1.6.1.2" width="20%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.21.5.1.6.1.3" width="20%">只读</th>         <th align="left" class="cellrowborder" id="mcps1.3.21.5.1.6.1.4" width="20%">可选</th>         <th align="left" class="cellrowborder" id="mcps1.3.21.5.1.6.1.5" width="20%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">change</td>         <td class="cellrowborder" width="20%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-abilityaccessctrl#permissionstatechangetype18">PermissionStateChangeType</a></td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">权限授权状态变化类型。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">tokenID</td>         <td class="cellrowborder" width="20%">number</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">被订阅的应用身份标识，可通过应用的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-bundlemanager-applicationinfo">ApplicationInfo</a>的accessTokenId字段获得。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">permissionName</td>         <td class="cellrowborder" width="20%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/app-permissions" target="_blank">Permissions</a></td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">当前授权状态发生变化的权限名，合法的权限名取值可在<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/app-permissions" target="_blank">应用权限列表</a>中查询。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="permissionrequestresult10" device-type="phone,2in1,tablet,wearable,tv">PermissionRequestResult<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="permissionrequestresult10" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>type PermissionRequestResult = _PermissionRequestResult</p>     <p>权限请求结果对象。</p>     <p><strong>元服务API：</strong> 从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>模型约束：</strong> 此接口仅可在Stage模型下使用。</p>     <p><strong>系统能力：</strong> SystemCapability.Security.AccessToken</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.22.7.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.22.7.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-permissionrequestresult">_PermissionRequestResult</a></td>         <td class="cellrowborder" width="50%">权限请求结果对象。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="context10" device-type="phone,2in1,tablet,wearable,tv">Context<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="context10" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>type Context = _Context</p>     <p>提供了ability或application的上下文的能力，包括访问特定应用程序的资源等。</p>     <p><strong>元服务API：</strong> 从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>模型约束：</strong> 此接口仅可在Stage模型下使用。</p>     <p><strong>系统能力：</strong> SystemCapability.Security.AccessToken</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.23.7.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.23.7.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-context">_Context</a></td>         <td class="cellrowborder" width="50%">提供了ability或application的上下文的能力，包括访问特定应用程序的资源等。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="permissionstatus20" device-type="phone,2in1,tablet,wearable,tv">PermissionStatus<sup>20+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="permissionstatus20" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>表示权限状态的枚举。</p>     <p><strong>元服务API：</strong> 从API version 20开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力：</strong> SystemCapability.Security.AccessToken</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.24.5.1.4.1.1" width="33.33333333333333%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.24.5.1.4.1.2" width="33.33333333333333%">值</th>         <th align="left" class="cellrowborder" id="mcps1.3.24.5.1.4.1.3" width="33.33333333333333%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="33.33333333333333%">DENIED</td>         <td class="cellrowborder" width="33.33333333333333%">-1</td>         <td class="cellrowborder" width="33.33333333333333%">表示用户未授权。</td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">GRANTED</td>         <td class="cellrowborder" width="33.33333333333333%">0</td>         <td class="cellrowborder" width="33.33333333333333%">表示已授权。</td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">NOT_DETERMINED</td>         <td class="cellrowborder" width="33.33333333333333%">1</td>         <td class="cellrowborder" width="33.33333333333333%">表示未操作。应用声明<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/permissions-for-all-user" target="_blank">用户授权权限</a>，暂未调用<a href="/consumer/cn/doc/harmonyos-references/js-apis-abilityaccessctrl#requestpermissionsfromuser9">requestPermissionsFromUser</a>接口请求用户授权时，或用户在设置中将权限状态修改为每次询问时，查询权限状态将返回此值。</td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">INVALID</td>         <td class="cellrowborder" width="33.33333333333333%">2</td>         <td class="cellrowborder" width="33.33333333333333%">表示无效。应用未<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/declare-permissions" target="_blank">声明权限</a>或当前无法处理。例如：当模糊位置权限的状态为NOT_DETERMINED时，查询精确位置权限状态，返回此值。</td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">RESTRICTED</td>         <td class="cellrowborder" width="33.33333333333333%">3</td>         <td class="cellrowborder" width="33.33333333333333%">表示受限。用户未同意隐私声明（仅系统应用会返回此状态）。</td>        </tr>             </tbody></table></div>     </div>    </div>   </div>   <div></div></div>