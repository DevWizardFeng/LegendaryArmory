<h1 _ngcontent-mdt-c119="" class="doc-title ng-star-inserted" title="@ohos.app.ability.UIAbility (带界面的应用组件)"> @ohos.app.ability.UIAbility (带界面的应用组件) </h1>

<div _ngcontent-mdt-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted renderOptimization" style="position: relative;">   <div>    <p>UIAbility是包含UI界面的应用组件，继承自<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-ability">Ability</a>，提供UIAbility组件创建、销毁、前后台切换等<a href="/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability#uiability生命周期状态">生命周期</a>回调，同时也具备<a href="/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability#后台通信能力">后台通信能力</a>。</p>    <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">      <p>本模块首批接口从API version 9 开始支持。后续版本的新增接口，采用上角标单独标记接口的起始版本。</p>      <p>本模块接口仅可在Stage模型下使用。</p>     </div></div></div>    <p>各类Ability的继承关系详见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-ability#ability的继承关系说明">继承关系说明</a>。</p>    <div class="tiledSection scroll-inwindow" style="contain-intrinsic-size: auto 992px;">     <h2 id="uiability生命周期状态" device-type="phone,2in1,tablet,wearable,tv">UIAbility生命周期状态<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="uiability生命周期状态" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p><strong>图1</strong> UIAbility生命周期状态</p>     <p><span><img originheight="570" originwidth="400" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211115730.27683317883837687704857881502646:50001231000000:2800:5A9CB38C715E99C4AB5790DC2071B274F45F6ADED1D2AB6B83224F0902F99C46.png" width="400" height="570"></span></p>     <ul>      <li>Create：表示UIAbility实例已创建。系统会在该状态下触发其<a href="/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability#oncreate">onCreate</a>回调函数，开发者可以在<a href="/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability#oncreate">onCreate</a>中执行初始化操作。</li>      <li>Foreground：表示UIAbility被拉到前台。系统会在该状态下触发其<a href="/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability#onforeground">onForeground</a>回调函数，开发者可以在<a href="/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability#onforeground">onForeground</a>中申请应用所需的资源。</li>      <li>Background：表示UIAbility被拉到后台。系统会在该状态下触发其<a href="/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability#onbackground">onBackground</a>回调函数，开发者可以在<a href="/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability#onbackground">onBackground</a>中释放一些应用资源。</li>      <li>Destroy：表示UIAbility实例要销毁。系统会在该状态下触发其<a href="/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability#ondestroy">onDestroy</a>回调函数，开发者可以在<a href="/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability#ondestroy">onDestroy</a>中执行数据保存等操作。</li>     </ul>    </div>    <div class="tiledSection scroll-inwindow" style="contain-intrinsic-size: auto 544px;">     <h2 id="后台通信能力" device-type="phone,2in1,tablet,wearable,tv">后台通信能力<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="后台通信能力" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>通过Call调用可以与目标UIAbility进行后台通信。Call调用示意图如下所示。</p>     <p><strong>图2</strong> Call调用示意图</p>     <p><span><img originheight="210" originwidth="799" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211115730.87721450339467291212676453437153:50001231000000:2800:D52D786499F31A68FCB27F283B467D8868447AE1FF77F2792906E51BA2F26DD5.png" width="799" height="210"></span></p>     <ul>      <li>       <p>Caller UIAbility调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext#startabilitybycall">startAbilityByCall()</a>接口获取<a href="/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability#caller">Caller</a>对象，并使用Caller对象的<a href="/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability#call">call</a>方法向Callee UIAbility发送数据。</p></li>      <li>       <p>Callee UIAbility持有一个<a href="/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability#callee">Callee</a>对象，通过Callee的<a href="/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability#on">on</a>方法注册回调函数，用于接收Caller对象发送的数据。</p></li>     </ul>    </div>    <div class="tiledSection scroll-inwindow" style="contain-intrinsic-size: auto 247px;">     <h2 id="导入模块" device-type="phone,2in1,tablet,wearable,tv">导入模块<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="导入模块" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><div _ngcontent-mdt-c106="" class="highlight-div"><div _ngcontent-mdt-c106="" class="highlight-div-header"><div _ngcontent-mdt-c106="" class="highlight-div-header-left"><div _ngcontent-mdt-c106="" class="handle-button expand-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mdt-c106="" class="highlight-div-header-right"><div _ngcontent-mdt-c106="" class="handle-button ai-button"></div><div _ngcontent-mdt-c106="" class="handle-button line-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mdt-c106="" class="handle-button theme-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mdt-c106="" class="handle-button copy-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mdt-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li></ol></pre></div></div>    </div>    <div class="tiledSection scroll-inwindow" style="contain-intrinsic-size: auto 182px;">     <h2 id="uiability" device-type="phone,2in1,tablet,wearable,tv">UIAbility<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="uiability" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>表示包含UI界面的应用组件，提供组件创建、销毁、前后台切换等生命周期回调，同时也具备后台通信能力。</p>    </div>    <div class="tiledSection scroll-inwindow" style="contain-intrinsic-size: auto 1068px;">     <h3 id="属性" device-type="phone,2in1,tablet,wearable,tv" class="firsth2">属性<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="属性" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.AbilityCore</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.8.3.1.6.1.1" width="20%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.8.3.1.6.1.2" width="20%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.8.3.1.6.1.3" width="20%">只读</th>         <th align="left" class="cellrowborder" id="mcps1.3.8.3.1.6.1.4" width="20%">可选</th>         <th align="left" class="cellrowborder" id="mcps1.3.8.3.1.6.1.5" width="20%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">context</td>         <td class="cellrowborder" width="20%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext">UIAbilityContext</a></td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">          <p>UIAbility的上下文。</p>          <p><strong>元服务API</strong>：从API version 11开始，该接口支持在元服务中使用。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">launchWant</td>         <td class="cellrowborder" width="20%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-want">Want</a></td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">          <p>UIAbility<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/uiability-intra-device-interaction#目标uiability冷启动" target="_blank">冷启动</a>时接收到的Want参数，取值为<a href="/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability#oncreate">onCreate</a>接收到的Want参数。</p>          <p><strong>元服务API</strong>：从API version 11开始，该接口支持在元服务中使用。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">lastRequestWant</td>         <td class="cellrowborder" width="20%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-want">Want</a></td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">          <p>最近一次拉起UIAbility请求的Want参数。</p>          <p>- 首次拉起UIAbility时，取值为<a href="/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability#oncreate">onCreate</a>接收到的Want参数。</p>          <p>- 重复拉起UIAbility时，取值为<a href="/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability#onnewwant">onNewWant</a>最近一次接收到的Want参数。</p>          <p><strong>元服务API</strong>：从API version 11开始，该接口支持在元服务中使用。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">callee</td>         <td class="cellrowborder" width="20%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability#callee">Callee</a></td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">系统为UIAbility创建的后台通信对象，Callee UIAbility（被调用方）可以通过Callee对象接收Caller对象发送的数据。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1035px;">     <h3 id="oncreate" device-type="phone,2in1,tablet,wearable,tv">onCreate<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="oncreate" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>onCreate(want: Want, launchParam: AbilityConstant.LaunchParam): void</p>     <p>当UIAbility实例创建完成时，系统会触发该回调，开发者可在该回调中执行初始化逻辑（如定义变量、加载资源等）。该回调仅会在UIAbility<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/uiability-intra-device-interaction#目标uiability冷启动" target="_blank">冷启动</a>时触发。</p>     <p>同步接口，不支持异步回调。</p>     <p><strong>元服务API</strong>：从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.AbilityCore</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.9.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.9.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.9.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.9.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">want</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-want">Want</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">调用方拉起该UIAbility时传递的数据。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">launchParam</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-abilityconstant#launchparam">AbilityConstant.LaunchParam</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">应用启动参数，包含应用启动原因、应用上次退出原因等。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-mdt-c106="" class="highlight-div"><div _ngcontent-mdt-c106="" class="highlight-div-header"><div _ngcontent-mdt-c106="" class="highlight-div-header-left"><div _ngcontent-mdt-c106="" class="handle-button expand-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mdt-c106="" class="highlight-div-header-right"><div _ngcontent-mdt-c106="" class="handle-button ai-button"></div><div _ngcontent-mdt-c106="" class="handle-button line-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mdt-c106="" class="handle-button theme-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mdt-c106="" class="handle-button copy-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mdt-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span>, <span class="hljs-title class_">AbilityConstant</span>, <span class="hljs-title class_">Want</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyUIAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onCreate</span>(<span class="hljs-params">want: Want, launchParam: AbilityConstant.LaunchParam</span>) {</li><li>    <span class="hljs-comment">// 执行异步任务</span></li><li>    hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>,</li><li>      <span class="hljs-string">`onCreate, want: <span class="hljs-subst">${want.abilityName}</span>, the launchReason is <span class="hljs-subst">${launchParam.launchReason}</span>, the lastExitReason is <span class="hljs-subst">${launchParam.lastExitReason}</span>`</span>);</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 990px;">     <h3 id="onwindowstagecreate" device-type="phone,2in1,tablet,wearable,tv">onWindowStageCreate<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onwindowstagecreate" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>onWindowStageCreate(windowStage: window.WindowStage): void</p>     <p>当<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-window-windowstage">WindowStage</a>实例创建完成后，系统会触发该回调。开发者可以在该回调中通过WindowStage加载页面。</p>     <p><strong>元服务API</strong>：从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.AbilityCore</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.10.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.10.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.10.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.10.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">windowStage</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-window-windowstage">window.WindowStage</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">WindowStage实例对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-mdt-c106="" class="highlight-div"><div _ngcontent-mdt-c106="" class="highlight-div-header"><div _ngcontent-mdt-c106="" class="highlight-div-header-left"><div _ngcontent-mdt-c106="" class="handle-button expand-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mdt-c106="" class="highlight-div-header-right"><div _ngcontent-mdt-c106="" class="handle-button ai-button"></div><div _ngcontent-mdt-c106="" class="handle-button line-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mdt-c106="" class="handle-button theme-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mdt-c106="" class="handle-button copy-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mdt-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-variable language_">window</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyUIAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-comment">// 主窗口已创建，为该UIAbility设置主页面</span></li><li>  <span class="hljs-title function_">onWindowStageCreate</span>(<span class="hljs-attr">windowStage</span>: <span class="hljs-variable language_">window</span>.<span class="hljs-property">WindowStage</span>): <span class="hljs-built_in">void</span> {</li><li>    windowStage.<span class="hljs-title function_">loadContent</span>(<span class="hljs-string">'pages/Index'</span>, <span class="hljs-function">(<span class="hljs-params">err, data</span>) =&gt;</span> {</li><li>      <span class="hljs-keyword">if</span> (err.<span class="hljs-property">code</span>) {</li><li>        hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">`Failed to load the content. Cause: <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(err)}</span>`</span>);</li><li>        <span class="hljs-keyword">return</span>;</li><li>      }</li><li>      hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">`Succeeded in loading the content. Data: <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(data)}</span>`</span>);</li><li>    });</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 822px;">     <h3 id="onwindowstagewilldestroy12" device-type="phone,2in1,tablet,wearable,tv">onWindowStageWillDestroy<sup>12+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onwindowstagewilldestroy12" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>onWindowStageWillDestroy(windowStage: window.WindowStage): void</p>     <p>当WindowStage即将销毁时，系统触发该回调。开发者可以在该生命周期中取消windowStage事件的监听。</p>     <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.AbilityCore</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.11.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.11.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.11.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.11.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">windowStage</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-window-windowstage">window.WindowStage</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">WindowStage实例对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-mdt-c106="" class="highlight-div"><div _ngcontent-mdt-c106="" class="highlight-div-header"><div _ngcontent-mdt-c106="" class="highlight-div-header-left"><div _ngcontent-mdt-c106="" class="handle-button expand-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mdt-c106="" class="highlight-div-header-right"><div _ngcontent-mdt-c106="" class="handle-button ai-button"></div><div _ngcontent-mdt-c106="" class="handle-button line-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mdt-c106="" class="handle-button theme-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mdt-c106="" class="handle-button copy-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mdt-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-variable language_">window</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyUIAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onWindowStageWillDestroy</span>(<span class="hljs-params">windowStage: <span class="hljs-variable language_">window</span>.WindowStage</span>) {</li><li>    hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">`onWindowStageWillDestroy`</span>);</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 719px;">     <h3 id="onwindowstagedestroy" device-type="phone,2in1,tablet,wearable,tv">onWindowStageDestroy<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onwindowstagedestroy" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>onWindowStageDestroy(): void</p>     <p>当WindowStage销毁后，系统触发该回调。该回调用于通知开发者WindowStage对象已被销毁，不能再继续使用。</p>     <p>仅当UIAbility正常退出时会触发该回调，异常退出场景（例如低内存终止进程）不会触发该回调。</p>     <p><strong>元服务API</strong>：从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.AbilityCore</p>     <p><strong>示例：</strong></p>     <div _ngcontent-mdt-c106="" class="highlight-div"><div _ngcontent-mdt-c106="" class="highlight-div-header"><div _ngcontent-mdt-c106="" class="highlight-div-header-left"><div _ngcontent-mdt-c106="" class="handle-button expand-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mdt-c106="" class="highlight-div-header-right"><div _ngcontent-mdt-c106="" class="handle-button ai-button"></div><div _ngcontent-mdt-c106="" class="handle-button line-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mdt-c106="" class="handle-button theme-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mdt-c106="" class="handle-button copy-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mdt-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyUIAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onWindowStageDestroy</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-comment">// 主窗口已销毁，释放UI相关资源</span></li><li>    hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">`onWindowStageDestroy`</span>);</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 938px;">     <h3 id="onwindowstagerestore" device-type="phone,2in1,tablet,wearable,tv">onWindowStageRestore<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onwindowstagerestore" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>onWindowStageRestore(windowStage: window.WindowStage): void</p>     <p>当UIAbility跨端迁移时，目标端UIAbility恢复页面栈时回调。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>在应用迁移启动时，无论是<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/uiability-intra-device-interaction#目标uiability冷启动" target="_blank">冷启动</a>还是<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/uiability-intra-device-interaction#目标uiability热启动" target="_blank">热启动</a>，都会在执行完<a href="/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability#oncreate">onCreate()</a>/<a href="/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability#onnewwant">onNewWant()</a>后，触发onWindowStageRestore()生命周期函数，不执行onWindowStageCreate()生命周期函数。</p>      </div></div></div>     <p><strong>元服务API</strong>：从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.AbilityCore</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.13.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.13.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.13.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.13.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">windowStage</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-window-windowstage">window.WindowStage</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">WindowStage实例对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-mdt-c106="" class="highlight-div"><div _ngcontent-mdt-c106="" class="highlight-div-header"><div _ngcontent-mdt-c106="" class="highlight-div-header-left"><div _ngcontent-mdt-c106="" class="handle-button expand-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mdt-c106="" class="highlight-div-header-right"><div _ngcontent-mdt-c106="" class="handle-button ai-button"></div><div _ngcontent-mdt-c106="" class="handle-button line-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mdt-c106="" class="handle-button theme-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mdt-c106="" class="handle-button copy-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mdt-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-variable language_">window</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyUIAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onWindowStageRestore</span>(<span class="hljs-params">windowStage: <span class="hljs-variable language_">window</span>.WindowStage</span>) {</li><li>    hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">`onWindowStageRestore`</span>);</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1450px;">     <h3 id="ondestroy" device-type="phone,2in1,tablet,wearable,tv">onDestroy<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="ondestroy" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>onDestroy(): void | Promise&lt;void&gt;</p>     <p>当UIAbility被销毁（例如使用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext#terminateself">terminateSelf</a>接口停止UIAbility）时，系统触发该回调。开发者可以在该生命周期中执行资源清理、数据保存等相关操作。</p>     <p>使用同步回调或Promise异步回调。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <ul>        <li>在执行完onDestroy生命周期回调后，应用可能会退出，从而导致其中的异步函数（比如异步写入数据库）未能正确执行。在此情况下，推荐使用Promise异步回调。</li>        <li>该回调仅在UIAbility正常退出时触发，当UIAbility异常退出（例如低内存终止进程）时，该回调将不被触发。</li>       </ul>      </div></div></div>     <p><strong>元服务API</strong>：从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.AbilityCore</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.14.9.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.14.9.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">void | Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">无返回结果或无返回结果的Promise对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <ul>      <li>       <p>同步回调示例如下：</p>       <div _ngcontent-mdt-c106="" class="highlight-div"><div _ngcontent-mdt-c106="" class="highlight-div-header"><div _ngcontent-mdt-c106="" class="highlight-div-header-left"><div _ngcontent-mdt-c106="" class="handle-button expand-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mdt-c106="" class="highlight-div-header-right"><div _ngcontent-mdt-c106="" class="handle-button ai-button"></div><div _ngcontent-mdt-c106="" class="handle-button line-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mdt-c106="" class="handle-button theme-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mdt-c106="" class="handle-button copy-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mdt-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyUIAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onDestroy</span>(<span class="hljs-params"></span>) {</li><li>    hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">`onDestroy`</span>);</li><li>    <span class="hljs-comment">// 调用同步函数...</span></li><li>  }</li><li>}</li></ol></pre></div></div></li>      <li>       <p>Promise异步回调示例如下：</p>       <div _ngcontent-mdt-c106="" class="highlight-div"><div _ngcontent-mdt-c106="" class="highlight-div-header"><div _ngcontent-mdt-c106="" class="highlight-div-header-left"><div _ngcontent-mdt-c106="" class="handle-button expand-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mdt-c106="" class="highlight-div-header-right"><div _ngcontent-mdt-c106="" class="handle-button ai-button"></div><div _ngcontent-mdt-c106="" class="handle-button line-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mdt-c106="" class="handle-button theme-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mdt-c106="" class="handle-button copy-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mdt-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyUIAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-keyword">async</span> <span class="hljs-title function_">onDestroy</span>(<span class="hljs-params"></span>) {</li><li>    hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">`onDestroy`</span>);</li><li>    <span class="hljs-comment">// 调用异步函数...</span></li><li>  }</li><li>}</li></ol></pre></div></div></li>     </ul>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1703px;">     <h3 id="onwillforeground20" device-type="phone,2in1,tablet,wearable,tv">onWillForeground<sup>20+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onwillforeground20" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>onWillForeground(): void</p>     <p>UIAbility生命周期回调，应用转到前台前触发，在<a href="/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability#onforeground">onForeground</a>前被调用。可在该回调中实现采集应用开始进入前台的时间。如果与<a href="/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability#ondidforeground20">onDidForeground</a>配合使用，还可以统计出从应用开始进入前台到切换至前台状态的耗时。</p>     <p>同步接口，不支持异步回调。</p>     <p><strong>元服务API</strong>：从API version 20开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.AbilityCore</p>     <p><strong>示例：</strong></p>     <div _ngcontent-mdt-c106="" class="highlight-div"><div _ngcontent-mdt-c106="" class="highlight-div-header"><div _ngcontent-mdt-c106="" class="highlight-div-header-left"><div _ngcontent-mdt-c106="" class="handle-button expand-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mdt-c106="" class="highlight-div-header-right"><div _ngcontent-mdt-c106="" class="handle-button ai-button"></div><div _ngcontent-mdt-c106="" class="handle-button line-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mdt-c106="" class="handle-button theme-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mdt-c106="" class="handle-button copy-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mdt-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { hiAppEvent, hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-comment">// ...</span></li><li>
</li><li>  <span class="hljs-title function_">onWillForeground</span>(): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-comment">// 应用开始进入前台事件打点</span></li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">eventParams</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">number</span>&gt; = { <span class="hljs-string">'xxxx'</span>: <span class="hljs-number">100</span> };</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">eventInfo</span>: hiAppEvent.<span class="hljs-property">AppEventInfo</span> = {</li><li>      <span class="hljs-comment">// 事件领域定义</span></li><li>      <span class="hljs-attr">domain</span>: <span class="hljs-string">"lifecycle"</span>,</li><li>      <span class="hljs-comment">// 事件名称定义</span></li><li>      <span class="hljs-attr">name</span>: <span class="hljs-string">"onwillforeground"</span>,</li><li>      <span class="hljs-comment">// 事件类型定义</span></li><li>      <span class="hljs-attr">eventType</span>: hiAppEvent.<span class="hljs-property">EventType</span>.<span class="hljs-property">BEHAVIOR</span>,</li><li>      <span class="hljs-comment">// 事件参数定义</span></li><li>      <span class="hljs-attr">params</span>: eventParams,</li><li>    };</li><li>    hiAppEvent.<span class="hljs-title function_">write</span>(eventInfo).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>      hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">`HiAppEvent success to write event`</span>);</li><li>    }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>      hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">`HiAppEvent err.code: <span class="hljs-subst">${err.code}</span>, err.message: <span class="hljs-subst">${err.message}</span>`</span>);</li><li>    });</li><li>  }</li><li>
</li><li>  <span class="hljs-comment">// ...</span></li><li>
</li><li>  <span class="hljs-title function_">onDidForeground</span>(): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-comment">// 应用进入前台后事件打点</span></li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">eventParams</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">number</span>&gt; = { <span class="hljs-string">'xxxx'</span>: <span class="hljs-number">100</span> };</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">eventInfo</span>: hiAppEvent.<span class="hljs-property">AppEventInfo</span> = {</li><li>      <span class="hljs-comment">// 事件领域定义</span></li><li>      <span class="hljs-attr">domain</span>: <span class="hljs-string">"lifecycle"</span>,</li><li>      <span class="hljs-comment">// 事件名称定义</span></li><li>      <span class="hljs-attr">name</span>: <span class="hljs-string">"ondidforeground"</span>,</li><li>      <span class="hljs-comment">// 事件类型定义</span></li><li>      <span class="hljs-attr">eventType</span>: hiAppEvent.<span class="hljs-property">EventType</span>.<span class="hljs-property">BEHAVIOR</span>,</li><li>      <span class="hljs-comment">// 事件参数定义</span></li><li>      <span class="hljs-attr">params</span>: eventParams,</li><li>    };</li><li>    hiAppEvent.<span class="hljs-title function_">write</span>(eventInfo).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>      hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">`HiAppEvent success to write event`</span>);</li><li>    }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>      hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">`HiAppEvent err.code: <span class="hljs-subst">${err.code}</span>, err.message: <span class="hljs-subst">${err.message}</span>`</span>);</li><li>    });</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 719px;">     <h3 id="onforeground" device-type="phone,2in1,tablet,wearable,tv">onForeground<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onforeground" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>onForeground(): void</p>     <p>当应用首次启动到前台或者从后台转入到前台时，系统触发该回调。开发者可在该回调中实现系统所需资源的申请，如应用转到前台时申请定位服务等。</p>     <p>同步接口，不支持异步回调。</p>     <p><strong>元服务API</strong>：从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.AbilityCore</p>     <p><strong>示例：</strong></p>     <div _ngcontent-mdt-c106="" class="highlight-div"><div _ngcontent-mdt-c106="" class="highlight-div-header"><div _ngcontent-mdt-c106="" class="highlight-div-header-left"><div _ngcontent-mdt-c106="" class="handle-button expand-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mdt-c106="" class="highlight-div-header-right"><div _ngcontent-mdt-c106="" class="handle-button ai-button"></div><div _ngcontent-mdt-c106="" class="handle-button line-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mdt-c106="" class="handle-button theme-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mdt-c106="" class="handle-button copy-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mdt-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyUIAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onForeground</span>(<span class="hljs-params"></span>) {</li><li>    hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">`onForeground`</span>);</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 486px;">     <h3 id="ondidforeground20" device-type="phone,2in1,tablet,wearable,tv">onDidForeground<sup>20+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="ondidforeground20" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>onDidForeground(): void</p>     <p>UIAbility生命周期回调，应用转到前台后触发，在<a href="/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability#onforeground">onForeground</a>后被调用，可在该回调中实现应用切换到前台后的时间打点。如果与<a href="/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability#onwillforeground20">onWillForeground</a>配合使用，还可以统计出从应用开始进入前台到切换至前台状态的耗时。</p>     <p>同步接口，不支持异步回调。</p>     <p><strong>元服务API</strong>：从API version 20开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.AbilityCore</p>     <p><strong>示例：</strong></p>     <p>参考<a href="/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability#onwillforeground20">onWillForeground</a>。</p>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1127px;">     <h3 id="onwillbackground20" device-type="phone,2in1,tablet,wearable,tv">onWillBackground<sup>20+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onwillbackground20" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>onWillBackground(): void</p>     <p>UIAbility生命周期回调，当应用从前台转到后台前触发，在<a href="/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability#onbackground">onBackground</a>前被调用。可在该回调中实现数据打点，例如，打点应用运行过程中发生的故障信息、统计信息、安全信息、用户行为信息等。</p>     <p>同步接口，不支持异步回调。</p>     <p><strong>元服务API</strong>：从API version 20开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.AbilityCore</p>     <p><strong>示例：</strong></p>     <div _ngcontent-mdt-c106="" class="highlight-div"><div _ngcontent-mdt-c106="" class="highlight-div-header"><div _ngcontent-mdt-c106="" class="highlight-div-header-left"><div _ngcontent-mdt-c106="" class="handle-button expand-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mdt-c106="" class="highlight-div-header-right"><div _ngcontent-mdt-c106="" class="handle-button ai-button"></div><div _ngcontent-mdt-c106="" class="handle-button line-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mdt-c106="" class="handle-button theme-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mdt-c106="" class="handle-button copy-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mdt-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { hiAppEvent, hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyUIAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onWillBackground</span>(): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">eventParams</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">number</span> | <span class="hljs-built_in">string</span>&gt; = {</li><li>      <span class="hljs-string">"int_data"</span>: <span class="hljs-number">100</span>,</li><li>      <span class="hljs-string">"str_data"</span>: <span class="hljs-string">"strValue"</span>,</li><li>    };</li><li>    <span class="hljs-comment">// 打点应用故障信息</span></li><li>    hiAppEvent.<span class="hljs-title function_">write</span>({</li><li>      <span class="hljs-attr">domain</span>: <span class="hljs-string">"test_domain"</span>,</li><li>      <span class="hljs-attr">name</span>: <span class="hljs-string">"test_event"</span>,</li><li>      <span class="hljs-attr">eventType</span>: hiAppEvent.<span class="hljs-property">EventType</span>.<span class="hljs-property">FAULT</span>,</li><li>      <span class="hljs-attr">params</span>: eventParams,</li><li>    }, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>      <span class="hljs-keyword">if</span> (err) {</li><li>        hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">`hiAppEvent code: <span class="hljs-subst">${err.code}</span>, message: <span class="hljs-subst">${err.message}</span>`</span>);</li><li>        <span class="hljs-keyword">return</span>;</li><li>      }</li><li>      hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">`hiAppEvent success to write event`</span>);</li><li>    });</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 719px;">     <h3 id="onbackground" device-type="phone,2in1,tablet,wearable,tv">onBackground<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onbackground" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>onBackground(): void</p>     <p>当应用从前台转入到后台时，系统触发该回调。开发者可在该回调中实现UI不可见时的资源释放操作，如停止定位功能等。</p>     <p>同步接口，不支持异步回调。</p>     <p><strong>元服务API</strong>：从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.AbilityCore</p>     <p><strong>示例：</strong></p>     <div _ngcontent-mdt-c106="" class="highlight-div"><div _ngcontent-mdt-c106="" class="highlight-div-header"><div _ngcontent-mdt-c106="" class="highlight-div-header-left"><div _ngcontent-mdt-c106="" class="handle-button expand-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mdt-c106="" class="highlight-div-header-right"><div _ngcontent-mdt-c106="" class="handle-button ai-button"></div><div _ngcontent-mdt-c106="" class="handle-button line-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mdt-c106="" class="handle-button theme-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mdt-c106="" class="handle-button copy-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mdt-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyUIAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onBackground</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-comment">// UIAbility回到后台</span></li><li>    hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">`onBackground`</span>);</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1655px;">     <h3 id="ondidbackground20" device-type="phone,2in1,tablet,wearable,tv">onDidBackground<sup>20+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="ondidbackground20" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>onDidBackground(): void</p>     <p>UIAbility生命周期回调，当应用从前台转到后台后触发，在<a href="/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability#onbackground">onBackground</a>之后被调用。可在该回调中实现应用进入后台之后的资源释放操作，如进入后台后停止音频播放等。</p>     <p>同步接口，不支持异步回调。</p>     <p><strong>元服务API</strong>：从API version 20开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.AbilityCore</p>     <p><strong>示例：</strong></p>     <div _ngcontent-mdt-c106="" class="highlight-div"><div _ngcontent-mdt-c106="" class="highlight-div-header"><div _ngcontent-mdt-c106="" class="highlight-div-header-left"><div _ngcontent-mdt-c106="" class="handle-button expand-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mdt-c106="" class="highlight-div-header-right"><div _ngcontent-mdt-c106="" class="handle-button ai-button"></div><div _ngcontent-mdt-c106="" class="handle-button line-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mdt-c106="" class="handle-button theme-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mdt-c106="" class="handle-button copy-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mdt-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li><span class="hljs-keyword">import</span> { audio } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AudioKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyUIAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-keyword">static</span> <span class="hljs-attr">audioRenderer</span>: audio.<span class="hljs-property">AudioRenderer</span>;</li><li>
</li><li>  <span class="hljs-comment">// ...</span></li><li>  <span class="hljs-title function_">onForeground</span>(): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">audioStreamInfo</span>: audio.<span class="hljs-property">AudioStreamInfo</span> = {</li><li>      <span class="hljs-attr">samplingRate</span>: audio.<span class="hljs-property">AudioSamplingRate</span>.<span class="hljs-property">SAMPLE_RATE_48000</span>, <span class="hljs-comment">// 采样率。</span></li><li>      <span class="hljs-attr">channels</span>: audio.<span class="hljs-property">AudioChannel</span>.<span class="hljs-property">CHANNEL_2</span>, <span class="hljs-comment">// 通道。</span></li><li>      <span class="hljs-attr">sampleFormat</span>: audio.<span class="hljs-property">AudioSampleFormat</span>.<span class="hljs-property">SAMPLE_FORMAT_S16LE</span>, <span class="hljs-comment">// 采样格式。</span></li><li>      <span class="hljs-attr">encodingType</span>: audio.<span class="hljs-property">AudioEncodingType</span>.<span class="hljs-property">ENCODING_TYPE_RAW</span> <span class="hljs-comment">// 编码格式。</span></li><li>    };</li><li>
</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">audioRendererInfo</span>: audio.<span class="hljs-property">AudioRendererInfo</span> = {</li><li>      <span class="hljs-attr">usage</span>: audio.<span class="hljs-property">StreamUsage</span>.<span class="hljs-property">STREAM_USAGE_MUSIC</span>, <span class="hljs-comment">// 音频流使用类型：音乐。根据业务场景配置，参考StreamUsage。</span></li><li>      <span class="hljs-attr">rendererFlags</span>: <span class="hljs-number">0</span> <span class="hljs-comment">// 音频渲染器标志。</span></li><li>    };</li><li>
</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">audioRendererOptions</span>: audio.<span class="hljs-property">AudioRendererOptions</span> = {</li><li>      <span class="hljs-attr">streamInfo</span>: audioStreamInfo,</li><li>      <span class="hljs-attr">rendererInfo</span>: audioRendererInfo</li><li>    };</li><li>
</li><li>    <span class="hljs-comment">// 在前台时申请audioRenderer，用于播放PCM（Pulse Code Modulation）音频数据</span></li><li>    audio.<span class="hljs-title function_">createAudioRenderer</span>(audioRendererOptions).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {</li><li>      <span class="hljs-title class_">MyUIAbility</span>.<span class="hljs-property">audioRenderer</span> = data;</li><li>      hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">`AudioRenderer Created : Success : Stream Type: SUCCESS.`</span>);</li><li>    }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>      hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">`AudioRenderer Created : F : <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(err)}</span>.`</span>);</li><li>    });</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">onDidBackground</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-comment">// 转到后台后，释放audioRenderer资源</span></li><li>    <span class="hljs-title class_">MyUIAbility</span>.<span class="hljs-property">audioRenderer</span>.<span class="hljs-title function_">release</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>      <span class="hljs-keyword">if</span> (err) {</li><li>        hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">`AudioRenderer release failed, error: <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(err)}</span>.`</span>);</li><li>      } <span class="hljs-keyword">else</span> {</li><li>        hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">`AudioRenderer released.`</span>);</li><li>      }</li><li>    });</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1969px;">     <h3 id="oncontinue" device-type="phone,2in1,tablet,wearable,tv">onContinue<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="oncontinue" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>onContinue(wantParam: Record&lt;string, Object&gt;): AbilityConstant.OnContinueResult | Promise&lt;AbilityConstant.OnContinueResult&gt;</p>     <p>当UIAbility准备跨端迁移时触发，可以保存待迁移的业务数据。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>对于API version 18（不含18） 之前版本仅支持同步调用，从API version 18及后续版本可支持异步调用。</p>      </div></div></div>     <p><strong>元服务API</strong>：从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.AbilityCore</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.21.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.21.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.21.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.21.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">wantParam</td>         <td class="cellrowborder" width="25%">Record&lt;string, Object&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">开发者通过该参数保存待迁移的数据。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.21.10.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.21.10.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-abilityconstant#oncontinueresult">AbilityConstant.OnContinueResult</a> | Promise&lt;<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-abilityconstant#oncontinueresult">AbilityConstant.OnContinueResult</a>&gt;</td>         <td class="cellrowborder" width="50%">          <p>表示是否同意迁移的结果：</p>          <p>- AGREE：表示同意。</p>          <p>- REJECT：表示拒绝，如应用在onContinue中异常可以返回REJECT。</p>          <p>- MISMATCH：表示版本不匹配，接续源端应用可以在onContinue中获取到迁移对端应用的版本号，进行协商后，如果版本不匹配导致无法迁移，可以返回该结果。</p>          <p>该回调与onWindowStageRestore成对出现。在接续场景下，源端的UIAbility触发onContinue保存自定义数据，在目标端UIAbility触发onWindowStageRestore恢复自定义数据。</p></td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <ul>      <li>       <p>应用迁移时使用同步接口进行数据保存，示例如下：</p>       <div _ngcontent-mdt-c106="" class="highlight-div"><div _ngcontent-mdt-c106="" class="highlight-div-header"><div _ngcontent-mdt-c106="" class="highlight-div-header-left"><div _ngcontent-mdt-c106="" class="handle-button expand-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mdt-c106="" class="highlight-div-header-right"><div _ngcontent-mdt-c106="" class="handle-button ai-button"></div><div _ngcontent-mdt-c106="" class="handle-button line-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mdt-c106="" class="handle-button theme-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mdt-c106="" class="handle-button copy-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mdt-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span>, <span class="hljs-title class_">AbilityConstant</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyUIAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onContinue</span>(<span class="hljs-params">wantParams: Record&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">Object</span>&gt;</span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'onContinue'</span>);</li><li>    wantParams[<span class="hljs-string">'myData'</span>] = <span class="hljs-string">'my1234567'</span>;</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-title class_">AbilityConstant</span>.<span class="hljs-property">OnContinueResult</span>.<span class="hljs-property">AGREE</span>;</li><li>  }</li><li>}</li></ol></pre></div></div></li>      <li>       <p>应用迁移时使用异步接口进行数据保存，示例如下：</p>       <div _ngcontent-mdt-c106="" class="highlight-div"><div _ngcontent-mdt-c106="" class="highlight-div-header"><div _ngcontent-mdt-c106="" class="highlight-div-header-left"><div _ngcontent-mdt-c106="" class="handle-button expand-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mdt-c106="" class="highlight-div-header-right"><div _ngcontent-mdt-c106="" class="handle-button ai-button"></div><div _ngcontent-mdt-c106="" class="handle-button line-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mdt-c106="" class="handle-button theme-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mdt-c106="" class="handle-button copy-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mdt-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span>, <span class="hljs-title class_">AbilityConstant</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyUIAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-keyword">async</span> <span class="hljs-title function_">setWant</span>(<span class="hljs-params">wantParams: Record&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">Object</span>&gt;</span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'setWant start'</span>);</li><li>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> time = <span class="hljs-number">0</span>; time &lt; <span class="hljs-number">1000</span>; ++time) {</li><li>      wantParams[time] = time;</li><li>    }</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'setWant end'</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">async</span> <span class="hljs-title function_">onContinue</span>(<span class="hljs-params">wantParams: Record&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">Object</span>&gt;</span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'onContinue'</span>);</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setWant</span>(wantParams).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>      <span class="hljs-keyword">return</span> <span class="hljs-title class_">AbilityConstant</span>.<span class="hljs-property">OnContinueResult</span>.<span class="hljs-property">AGREE</span>;</li><li>    });</li><li>  }</li><li>}</li></ol></pre></div></div></li>     </ul>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 963px;">     <h3 id="onnewwant" device-type="phone,2in1,tablet,wearable,tv">onNewWant<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onnewwant" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>onNewWant(want: Want, launchParam: AbilityConstant.LaunchParam): void</p>     <p>当已经启动的UIAbility实例再次被拉起时，系统会触发该回调。若在特定场景下（参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-contextconstant#scenarios20">Scenarios</a>），不需要触发该生命周期回调，可以使用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext#setonnewwantskipscenarios20">setOnNewWantSkipScenarios</a>接口设置。</p>     <p>同步接口，不支持异步回调。</p>     <p><strong>元服务API</strong>：从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.AbilityCore</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.22.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.22.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.22.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.22.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">want</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-want">Want</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">调用方再次拉起该UIAbility时传递的数据。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">launchParam</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-abilityconstant#launchparam">AbilityConstant.LaunchParam</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">UIAbility启动参数，包含启动原因等。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-mdt-c106="" class="highlight-div"><div _ngcontent-mdt-c106="" class="highlight-div-header"><div _ngcontent-mdt-c106="" class="highlight-div-header-left"><div _ngcontent-mdt-c106="" class="handle-button expand-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mdt-c106="" class="highlight-div-header-right"><div _ngcontent-mdt-c106="" class="handle-button ai-button"></div><div _ngcontent-mdt-c106="" class="handle-button line-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mdt-c106="" class="handle-button theme-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mdt-c106="" class="handle-button copy-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mdt-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span>, <span class="hljs-title class_">AbilityConstant</span>, <span class="hljs-title class_">Want</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyUIAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onNewWant</span>(<span class="hljs-params">want: Want, launchParam: AbilityConstant.LaunchParam</span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`onNewWant, want: <span class="hljs-subst">${want.abilityName}</span>`</span>);</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`onNewWant, launchParam: <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(launchParam)}</span>`</span>);</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 993px;">     <h3 id="ondump" device-type="phone,2in1,tablet,wearable,tv">onDump<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="ondump" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>onDump(params: Array&lt;string&gt;): Array&lt;string&gt;</p>     <p>应用调测场景下，通过命令行dump UIAbility数据时，系统会触发该回调。开发者可以在该回调中返回UIAbility要转储的非敏感信息。</p>     <p><strong>元服务API</strong>：从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.AbilityCore</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.23.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.23.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.23.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.23.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">params</td>         <td class="cellrowborder" width="25%">Array&lt;string&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">表示dump命令参数。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.23.9.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.23.9.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Array&lt;string&gt;</td>         <td class="cellrowborder" width="50%">返回的dump信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-mdt-c106="" class="highlight-div"><div _ngcontent-mdt-c106="" class="highlight-div-header"><div _ngcontent-mdt-c106="" class="highlight-div-header-left"><div _ngcontent-mdt-c106="" class="handle-button expand-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mdt-c106="" class="highlight-div-header-right"><div _ngcontent-mdt-c106="" class="handle-button ai-button"></div><div _ngcontent-mdt-c106="" class="handle-button line-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mdt-c106="" class="handle-button theme-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mdt-c106="" class="handle-button copy-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mdt-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyUIAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onDump</span>(<span class="hljs-params">params: <span class="hljs-built_in">Array</span>&lt;<span class="hljs-built_in">string</span>&gt;</span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`dump, params: <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(params)}</span>`</span>);</li><li>    <span class="hljs-keyword">return</span> [<span class="hljs-string">'params'</span>];</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1298px;">     <h3 id="onsavestate" device-type="phone,2in1,tablet,wearable,tv">onSaveState<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onsavestate" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>onSaveState(reason: AbilityConstant.StateType, wantParam: Record&lt;string, Object&gt;): AbilityConstant.OnSaveResult</p>     <p>该接口需要与<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-apprecovery">appRecovery</a>配合使用。如果应用已使能故障恢复功能（即<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-apprecovery#apprecoveryenableapprecovery">enableAppRecovery</a>接口中的saveOccasion参数设置为SAVE_WHEN_ERROR），当应用出现故障时，系统将触发该回调来保存UIAbility的数据。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>从API version 20开始，当<a href="/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability#onsavestateasync20">onSaveStateAsync</a>实现时，本回调函数将不执行。</p>      </div></div></div>     <p><strong>元服务API</strong>：从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.AbilityCore</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.24.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.24.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.24.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.24.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">reason</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-abilityconstant#statetype">AbilityConstant.StateType</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">触发应用保存状态的原因，当前仅支持APP_RECOVERY（即应用故障恢复场景）。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">wantParam</td>         <td class="cellrowborder" width="25%">Record&lt;string, Object&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">用户自定义的应用状态数据，应用再启动时被保存在<a href="/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability#oncreate">onCreate</a>的Want.parameters中。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.24.10.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.24.10.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-abilityconstant#onsaveresult">AbilityConstant.OnSaveResult</a></td>         <td class="cellrowborder" width="50%">返回一个数据保存策略的对象（如全部拒绝、全部允许、只允许故障恢复场景等）。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-mdt-c106="" class="highlight-div"><div _ngcontent-mdt-c106="" class="highlight-div-header"><div _ngcontent-mdt-c106="" class="highlight-div-header-left"><div _ngcontent-mdt-c106="" class="handle-button expand-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mdt-c106="" class="highlight-div-header-right"><div _ngcontent-mdt-c106="" class="handle-button ai-button"></div><div _ngcontent-mdt-c106="" class="handle-button line-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mdt-c106="" class="handle-button theme-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mdt-c106="" class="handle-button copy-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mdt-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span>, <span class="hljs-title class_">AbilityConstant</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyUIAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onSaveState</span>(<span class="hljs-params">reason: AbilityConstant.StateType, wantParam: Record&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">Object</span>&gt;</span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'onSaveState'</span>);</li><li>    wantParam[<span class="hljs-string">'myData'</span>] = <span class="hljs-string">'my1234567'</span>;</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-title class_">AbilityConstant</span>.<span class="hljs-property">OnSaveResult</span>.<span class="hljs-property">RECOVERY_AGREE</span>;</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1278px;">     <h3 id="onsavestateasync20" device-type="phone,2in1,tablet,wearable,tv">onSaveStateAsync<sup>20+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onsavestateasync20" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>onSaveStateAsync(stateType: AbilityConstant.StateType, wantParam: Record&lt;string, Object&gt;): Promise&lt;AbilityConstant.OnSaveResult&gt;</p>     <p>该接口需要与<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-apprecovery">appRecovery</a>配合使用。如果应用已使能故障恢复功能（即<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-apprecovery#apprecoveryenableapprecovery">enableAppRecovery</a>接口中的saveOccasion参数设置为SAVE_WHEN_ERROR），当应用出现故障时，将触发该回调来保存UIAbility的数据。使用Promise异步回调。</p>     <p><strong>元服务API</strong>：从API version 20开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.AbilityCore</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.25.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.25.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.25.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.25.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">stateType</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-abilityconstant#statetype">AbilityConstant.StateType</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">触发应用保存状态的原因，当前仅支持APP_RECOVERY（即应用故障恢复场景）。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">wantParam</td>         <td class="cellrowborder" width="25%">Record&lt;string, Object&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">用户自定义的应用状态数据，应用再启动时被保存在<a href="/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability#oncreate">onCreate</a>的Want.parameters中。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.25.9.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.25.9.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-abilityconstant#onsaveresult">AbilityConstant.OnSaveResult</a>&gt;</td>         <td class="cellrowborder" width="50%">Promise对象。返回一个数据保存策略的对象（如全部拒绝、全部允许、只允许故障恢复场景等）。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-mdt-c106="" class="highlight-div"><div _ngcontent-mdt-c106="" class="highlight-div-header"><div _ngcontent-mdt-c106="" class="highlight-div-header-left"><div _ngcontent-mdt-c106="" class="handle-button expand-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mdt-c106="" class="highlight-div-header-right"><div _ngcontent-mdt-c106="" class="handle-button ai-button"></div><div _ngcontent-mdt-c106="" class="handle-button line-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mdt-c106="" class="handle-button theme-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mdt-c106="" class="handle-button copy-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mdt-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span>, <span class="hljs-title class_">AbilityConstant</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyUIAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-keyword">async</span> <span class="hljs-title function_">onSaveStateAsync</span>(<span class="hljs-attr">reason</span>: <span class="hljs-title class_">AbilityConstant</span>.<span class="hljs-property">StateType</span>,</li><li>    <span class="hljs-attr">wantParam</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-title class_">Object</span>&gt;): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">AbilityConstant</span>.<span class="hljs-property">OnSaveResult</span>&gt; {</li><li>    <span class="hljs-keyword">await</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">string</span>&gt;(<span class="hljs-function">(<span class="hljs-params">res, rej</span>) =&gt;</span> {</li><li>      <span class="hljs-built_in">setTimeout</span>(res, <span class="hljs-number">1000</span>); <span class="hljs-comment">// 延时1秒后执行</span></li><li>    });</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-title class_">AbilityConstant</span>.<span class="hljs-property">OnSaveResult</span>.<span class="hljs-property">RECOVERY_AGREE</span>;</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 798px;">     <h3 id="onshare10" device-type="phone,2in1,tablet,wearable,tv">onShare<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onshare10" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>onShare(wantParam: Record&lt;string, Object&gt;): void</p>     <p>当跨端分享元服务时，系统触发该回调。开发者可以在该回调中设置待分享元服务的标题、摘要和URL等数据。</p>     <p><strong>元服务API</strong>：从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.AbilityCore</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.26.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.26.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.26.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.26.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">wantParam</td>         <td class="cellrowborder" width="25%">Record&lt;string, Object&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">待分享的数据。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-mdt-c106="" class="highlight-div"><div _ngcontent-mdt-c106="" class="highlight-div-header"><div _ngcontent-mdt-c106="" class="highlight-div-header-left"><div _ngcontent-mdt-c106="" class="handle-button expand-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mdt-c106="" class="highlight-div-header-right"><div _ngcontent-mdt-c106="" class="handle-button ai-button"></div><div _ngcontent-mdt-c106="" class="handle-button line-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mdt-c106="" class="handle-button theme-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mdt-c106="" class="handle-button copy-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mdt-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyUIAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onShare</span>(<span class="hljs-params">wantParams: Record&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">Object</span>&gt;</span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'onShare'</span>);</li><li>    wantParams[<span class="hljs-string">'ohos.extra.param.key.shareUrl'</span>] = <span class="hljs-string">'example.com'</span>;</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1670px;">     <h3 id="onpreparetoterminate10" device-type="phone,2in1,tablet,wearable,tv">onPrepareToTerminate<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onpreparetoterminate10" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>onPrepareToTerminate(): boolean</p>     <p>在UIAbility即将关闭前（例如用户通过点击应用窗口右上角的关闭按钮、或者通过Dock栏/托盘右键退出应用时），系统会触发该回调，用于在UIAbility正式关闭前执行其他操作。开发者可以在该回调中返回true阻拦此次关闭，然后在合适时机主动调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext#terminateself">terminateSelf</a>接口关闭。例如，询问用户是否确认关闭UIAbility，再主动销毁UIAbility。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <ul>        <li>从API version 15开始，当<a href="/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability#onpreparetoterminateasync15">UIAbility.onPrepareToTerminateAsync</a>实现时，本回调函数将不执行。当<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-abilitystage#onprepareterminationasync15">AbilityStage.onPrepareTerminationAsync</a>或<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-abilitystage#onpreparetermination15">AbilityStage.onPrepareTermination</a>实现时，在dock栏或系统托盘处右键点击关闭，本回调函数将不执行。</li>        <li>如果应用本身或者所使用的三方框架注册了<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-window-windowstage#onwindowstageclose14">window.WindowStage.on('windowStageClose')</a>监听，本回调函数将不执行。</li>       </ul>      </div></div></div>     <p><strong>需要权限</strong>：ohos.permission.PREPARE_APP_TERMINATE</p>     <p><strong>元服务API</strong>：从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.AbilityCore</p>     <p><strong>设备行为差异</strong>：该接口仅在2in1和Tablet设备中可正常执行回调，在其他设备上不执行回调。</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.27.10.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.27.10.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">boolean</td>         <td class="cellrowborder" width="50%">是否执行UIAbility关闭操作，返回true表示本次UIAbility关闭流程取消，返回false表示UIAbility继续正常关闭。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-mdt-c106="" class="highlight-div"><div _ngcontent-mdt-c106="" class="highlight-div-header"><div _ngcontent-mdt-c106="" class="highlight-div-header-left"><div _ngcontent-mdt-c106="" class="handle-button expand-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mdt-c106="" class="highlight-div-header-right"><div _ngcontent-mdt-c106="" class="handle-button ai-button"></div><div _ngcontent-mdt-c106="" class="handle-button line-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mdt-c106="" class="handle-button theme-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mdt-c106="" class="handle-button copy-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mdt-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span>, <span class="hljs-title class_">Want</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onPrepareToTerminate</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-comment">// 开发者定义预关闭动作</span></li><li>    <span class="hljs-comment">// 例如拉起另一个ability，根据ability处理结果执行异步关闭</span></li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">want</span>: <span class="hljs-title class_">Want</span> = {</li><li>      <span class="hljs-attr">bundleName</span>: <span class="hljs-string">"com.example.myapplication"</span>,</li><li>      <span class="hljs-attr">moduleName</span>: <span class="hljs-string">"entry"</span>,</li><li>      <span class="hljs-attr">abilityName</span>: <span class="hljs-string">"SecondAbility"</span></li><li>    }</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">startAbilityForResult</span>(want)</li><li>      .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">result</span>) =&gt;</span> {</li><li>        <span class="hljs-comment">// 获取ability处理结果，当返回结果的resultCode为0关闭当前UIAbility</span></li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'startAbilityForResult success, resultCode is '</span> + result.<span class="hljs-property">resultCode</span>);</li><li>        <span class="hljs-keyword">if</span> (result.<span class="hljs-property">resultCode</span> === <span class="hljs-number">0</span>) {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">terminateSelf</span>();</li><li>        }</li><li>      }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>      <span class="hljs-comment">// 异常处理</span></li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'startAbilityForResult failed, err:'</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">terminateSelf</span>();</li><li>    })</li><li>
</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>; <span class="hljs-comment">// 已定义预关闭操作后，返回true表示UIAbility取消关闭</span></li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1398px;">     <h3 id="onpreparetoterminateasync15" device-type="phone,2in1,tablet,wearable,tv">onPrepareToTerminateAsync<sup>15+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onpreparetoterminateasync15" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>onPrepareToTerminateAsync(): Promise&lt;boolean&gt;</p>     <p>在UIAbility关闭前（例如用户通过点击应用窗口右上角的关闭按钮、或者通过Dock栏/托盘右键退出应用时），系统会触发该回调，用于在UIAbility正式关闭前执行其他操作。</p>     <p>开发者可以在该回调中返回true阻拦此次关闭，然后在合适时机主动调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext#terminateself">terminateSelf</a>接口关闭。例如，询问用户是否确认关闭UIAbility，再主动销毁UIAbility。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <ul>        <li>         <p>当<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-abilitystage#onprepareterminationasync15">AbilityStage.onPrepareTerminationAsync</a>或<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-abilitystage#onpreparetermination15">AbilityStage.onPrepareTermination</a>实现时，在dock栏或系统托盘处右键点击关闭，本回调函数将不执行。</p></li>        <li>         <p>如果应用本身或者所使用的三方框架注册了<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-window-windowstage#onwindowstageclose14">window.WindowStage.on('windowStageClose')</a>监听，本回调函数将不执行。</p></li>        <li>         <p>若异步回调内发生crash，按超时处理，执行等待超过10秒未响应，UIAbility将被强制关闭。</p></li>       </ul>      </div></div></div>     <p><strong>需要权限</strong>：ohos.permission.PREPARE_APP_TERMINATE</p>     <p><strong>元服务API</strong>：从API version 15开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.AbilityCore</p>     <p><strong>设备行为差异</strong>：</p>     <ul>      <li>从API version 15开始，该接口仅在2in1设备中可正常执行回调，在其他设备上不执行回调。</li>      <li>从API version 19开始，该接口在2in1和Tablet设备中可正常执行回调，在其他设备上不执行回调。</li>     </ul>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.28.12.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.28.12.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;boolean&gt;</td>         <td class="cellrowborder" width="50%">Promise对象。表示是否执行UIAbility关闭操作，返回true表示本次UIAbility关闭流程取消，返回false表示UIAbility继续正常关闭。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-mdt-c106="" class="highlight-div"><div _ngcontent-mdt-c106="" class="highlight-div-header"><div _ngcontent-mdt-c106="" class="highlight-div-header-left"><div _ngcontent-mdt-c106="" class="handle-button expand-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mdt-c106="" class="highlight-div-header-right"><div _ngcontent-mdt-c106="" class="handle-button ai-button"></div><div _ngcontent-mdt-c106="" class="handle-button line-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mdt-c106="" class="handle-button theme-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mdt-c106="" class="handle-button copy-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mdt-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-keyword">async</span> <span class="hljs-title function_">onPrepareToTerminateAsync</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">boolean</span>&gt; {</li><li>    <span class="hljs-keyword">await</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">boolean</span>&gt;(<span class="hljs-function">(<span class="hljs-params">res, rej</span>) =&gt;</span> {</li><li>      <span class="hljs-built_in">setTimeout</span>(res, <span class="hljs-number">2000</span>); <span class="hljs-comment">// 延时2秒</span></li><li>    });</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>; <span class="hljs-comment">// 已定义预关闭操作后，返回true表示UIAbility取消关闭</span></li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 898px;">     <h3 id="onbackpressed10" device-type="phone,2in1,tablet,wearable,tv">onBackPressed<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onbackpressed10" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>onBackPressed(): boolean</p>     <p>UIAbility生命周期回调，当UIAbility侧滑返回时触发，根据返回值决定是否销毁UIAbility。</p>     <ul>      <li>当targetSdkVersion&lt;12时，默认返回值为false，会销毁UIAbility。</li>      <li>当targetSdkVersion&gt;=12时，默认返回值为true，会将UIAbility移动到后台不销毁。</li>     </ul>     <p><strong>元服务API</strong>：从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.AbilityCore</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.29.8.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.29.8.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">boolean</td>         <td class="cellrowborder" width="50%">返回true表示UIAbility将会被移到后台不销毁，返回false表示UIAbility将正常销毁。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-mdt-c106="" class="highlight-div"><div _ngcontent-mdt-c106="" class="highlight-div-header"><div _ngcontent-mdt-c106="" class="highlight-div-header-left"><div _ngcontent-mdt-c106="" class="handle-button expand-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mdt-c106="" class="highlight-div-header-right"><div _ngcontent-mdt-c106="" class="handle-button ai-button"></div><div _ngcontent-mdt-c106="" class="handle-button line-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mdt-c106="" class="handle-button theme-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mdt-c106="" class="handle-button copy-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mdt-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onBackPressed</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1229px;">     <h3 id="oncollaborate18" device-type="phone,2in1,tablet,wearable,tv">onCollaborate<sup>18+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="oncollaborate18" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>onCollaborate(wantParam: Record&lt;string, Object&gt;): AbilityConstant.CollaborateResult</p>     <p>UIAbility生命周期回调，在多设备协同场景下，协同方应用在被拉起的过程中返回是否接受协同。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <ul>        <li>该生命周期回调不支持<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/uiability-launch-type#specified启动模式" target="_blank">specified启动模式</a>。</li>        <li>通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext#startability">startAbility</a>等方法拉起协同方应用时，需要在Want对象中设置协同标记<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-wantconstant#flags">Flags</a>为FLAG_ABILITY_ON_COLLABORATE。</li>        <li><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/uiability-intra-device-interaction#目标uiability冷启动" target="_blank">冷启动</a>时，该回调在<a href="/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability#onforeground">onForeground</a>前或<a href="/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability#onbackground">onBackground</a>后调用；<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/uiability-intra-device-interaction#目标uiability热启动" target="_blank">热启动</a>时，该回调在<a href="/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability#onnewwant">onNewWant</a>前调用。</li>       </ul>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.AbilityCore</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.30.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.30.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.30.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.30.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">wantParam</td>         <td class="cellrowborder" width="25%">Record&lt;string, Object&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">want相关参数，仅支持key值取"ohos.extra.param.key.supportCollaborateIndex"。通过该key值可以获取到调用方传输的数据并进行相应的处理。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.30.9.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.30.9.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-abilityconstant#collaborateresult18">AbilityConstant.CollaborateResult</a></td>         <td class="cellrowborder" width="50%">协同方是否接受协同的结果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-mdt-c106="" class="highlight-div"><div _ngcontent-mdt-c106="" class="highlight-div-header"><div _ngcontent-mdt-c106="" class="highlight-div-header-left"><div _ngcontent-mdt-c106="" class="handle-button expand-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mdt-c106="" class="highlight-div-header-right"><div _ngcontent-mdt-c106="" class="handle-button ai-button"></div><div _ngcontent-mdt-c106="" class="handle-button line-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mdt-c106="" class="handle-button theme-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mdt-c106="" class="handle-button copy-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mdt-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span>, <span class="hljs-title class_">AbilityConstant</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onCollaborate</span>(<span class="hljs-params">wantParam: Record&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">Object</span>&gt;</span>) {</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-title class_">AbilityConstant</span>.<span class="hljs-property">CollaborateResult</span>.<span class="hljs-property">ACCEPT</span>;</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 206px;">     <h2 id="caller" device-type="phone,2in1,tablet,wearable,tv">Caller<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="caller" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>调用方Caller UIAbility（仅支持系统应用）可以通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext#startabilitybycall">startAbilityByCall</a>接口拉起目标Callee UIAbility（可以为三方应用）。目标UIAbility启动成功后，会返回一个Caller对象给调用方进行通信。</p>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 2558px;">     <h3 id="call" device-type="phone,2in1,tablet,wearable,tv" class="firsth2">call<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="call" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>call(method: string, data: rpc.Parcelable): Promise&lt;void&gt;</p>     <p>Caller UIAbility向Callee UIAbility发送双方约定好的序列化的数据。使用Promise异步回调。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.AbilityCore</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.32.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.32.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.32.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.32.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">method</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">由Caller和Callee双方约定好的方法名，Callee方通过该字段区分消息类型。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">data</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-rpc#parcelable9">rpc.Parcelable</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">由Caller向Callee发送的消息内容，消息内容是序列化的数据。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.32.8.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.32.8.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">Promise对象。无返回结果的Promise对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-ability">元能力子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.32.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.32.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1. Mandatory parameters are left unspecified; 2. Incorrect parameter types.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16200001</td>         <td class="cellrowborder" width="50%">The caller has been released.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16200002</td>         <td class="cellrowborder" width="50%">The callee does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000050</td>         <td class="cellrowborder" width="50%">Internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-mdt-c106="" class="highlight-div"><div _ngcontent-mdt-c106="" class="highlight-div-header"><div _ngcontent-mdt-c106="" class="highlight-div-header-left"><div _ngcontent-mdt-c106="" class="handle-button expand-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mdt-c106="" class="highlight-div-header-right"><div _ngcontent-mdt-c106="" class="handle-button ai-button"></div><div _ngcontent-mdt-c106="" class="handle-button line-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mdt-c106="" class="handle-button theme-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mdt-c106="" class="handle-button copy-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mdt-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span>, <span class="hljs-title class_">Caller</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-variable language_">window</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span>;</li><li><span class="hljs-keyword">import</span> { rpc } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.IPCKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyMessageAble</span> <span class="hljs-keyword">implements</span> rpc.<span class="hljs-property">Parcelable</span> { <span class="hljs-comment">// 自定义的Parcelable数据结构</span></li><li>  <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;</li><li>  <span class="hljs-attr">str</span>: <span class="hljs-built_in">string</span>;</li><li>  <span class="hljs-attr">num</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">1</span>;</li><li>
</li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name: <span class="hljs-built_in">string</span>, str: <span class="hljs-built_in">string</span></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">str</span> = str;</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">marshalling</span>(<span class="hljs-params">messageSequence: rpc.MessageSequence</span>) {</li><li>    messageSequence.<span class="hljs-title function_">writeInt</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">num</span>);</li><li>    messageSequence.<span class="hljs-title function_">writeString</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">str</span>);</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`MyMessageAble marshalling num[<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.num}</span>] str[<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.str}</span>]`</span>);</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">unmarshalling</span>(<span class="hljs-params">messageSequence: rpc.MessageSequence</span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">num</span> = messageSequence.<span class="hljs-title function_">readInt</span>();</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">str</span> = messageSequence.<span class="hljs-title function_">readString</span>();</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`MyMessageAble unmarshalling num[<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.num}</span>] str[<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.str}</span>]`</span>);</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-keyword">let</span> method = <span class="hljs-string">'call_Function'</span>; <span class="hljs-comment">// 约定的通知消息字符串</span></li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MainUIAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onWindowStageCreate</span>(<span class="hljs-params">windowStage: <span class="hljs-variable language_">window</span>.WindowStage</span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">startAbilityByCall</span>({</li><li>      <span class="hljs-attr">bundleName</span>: <span class="hljs-string">'com.example.myservice'</span>,</li><li>      <span class="hljs-attr">abilityName</span>: <span class="hljs-string">'MainUIAbility'</span>,</li><li>      <span class="hljs-attr">deviceId</span>: <span class="hljs-string">''</span></li><li>    }).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">obj</span>) =&gt;</span> {</li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">caller</span>: <span class="hljs-title class_">Caller</span> = obj;</li><li>      <span class="hljs-keyword">let</span> msg = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyMessageAble</span>(<span class="hljs-string">'msg'</span>, <span class="hljs-string">'world'</span>); <span class="hljs-comment">// 参考Parcelable数据定义</span></li><li>      caller.<span class="hljs-title function_">call</span>(method, msg)</li><li>        .<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Caller call() called'</span>);</li><li>        })</li><li>        .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">callErr: BusinessError</span>) =&gt;</span> {</li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Caller.call catch error, error.code: <span class="hljs-subst">${callErr.code}</span>, error.message: <span class="hljs-subst">${callErr.message}</span>`</span>);</li><li>        });</li><li>    }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Caller GetCaller error, error.code: <span class="hljs-subst">${err.code}</span>, error.message: <span class="hljs-subst">${err.message}</span>`</span>);</li><li>    });</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 2646px;">     <h3 id="callwithresult" device-type="phone,2in1,tablet,wearable,tv">callWithResult<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="callwithresult" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>callWithResult(method: string, data: rpc.Parcelable): Promise&lt;rpc.MessageSequence&gt;</p>     <p>Caller UIAbility向Callee UIAbility发送消息，Callee UIAbility处理完成后返回结果。使用Promise异步回调。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.AbilityCore</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.33.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.33.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.33.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.33.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">method</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">由Caller和Callee双方约定好的方法名，Callee方通过该字段区分消息类型。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">data</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-rpc#parcelable9">rpc.Parcelable</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">由Caller向Callee发送的消息内容，消息内容是序列化的数据。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.33.8.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.33.8.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-rpc#messagesequence9">rpc.MessageSequence</a>&gt;</td>         <td class="cellrowborder" width="50%">Promise对象，返回Callee UIAbility的应答数据。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-ability">元能力子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.33.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.33.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1. Mandatory parameters are left unspecified; 2. Incorrect parameter types.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16200001</td>         <td class="cellrowborder" width="50%">The caller has been released.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16200002</td>         <td class="cellrowborder" width="50%">The callee does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000050</td>         <td class="cellrowborder" width="50%">Internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-mdt-c106="" class="highlight-div"><div _ngcontent-mdt-c106="" class="highlight-div-header"><div _ngcontent-mdt-c106="" class="highlight-div-header-left"><div _ngcontent-mdt-c106="" class="handle-button expand-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mdt-c106="" class="highlight-div-header-right"><div _ngcontent-mdt-c106="" class="handle-button ai-button"></div><div _ngcontent-mdt-c106="" class="handle-button line-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mdt-c106="" class="handle-button theme-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mdt-c106="" class="handle-button copy-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mdt-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span>, <span class="hljs-title class_">Caller</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-variable language_">window</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span>;</li><li><span class="hljs-keyword">import</span> { rpc } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.IPCKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyMessageAble</span> <span class="hljs-keyword">implements</span> rpc.<span class="hljs-property">Parcelable</span> {</li><li>  <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span></li><li>  <span class="hljs-attr">str</span>: <span class="hljs-built_in">string</span></li><li>  <span class="hljs-attr">num</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">1</span></li><li>
</li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name: <span class="hljs-built_in">string</span>, str: <span class="hljs-built_in">string</span></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">str</span> = str;</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">marshalling</span>(<span class="hljs-params">messageSequence: rpc.MessageSequence</span>) {</li><li>    messageSequence.<span class="hljs-title function_">writeInt</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">num</span>);</li><li>    messageSequence.<span class="hljs-title function_">writeString</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">str</span>);</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`MyMessageAble marshalling num[<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.num}</span>] str[<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.str}</span>]`</span>);</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">unmarshalling</span>(<span class="hljs-params">messageSequence: rpc.MessageSequence</span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">num</span> = messageSequence.<span class="hljs-title function_">readInt</span>();</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">str</span> = messageSequence.<span class="hljs-title function_">readString</span>();</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`MyMessageAble unmarshalling num[<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.num}</span>] str[<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.str}</span>]`</span>);</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-keyword">let</span> method = <span class="hljs-string">'call_Function'</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">caller</span>: <span class="hljs-title class_">Caller</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MainUIAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onWindowStageCreate</span>(<span class="hljs-params">windowStage: <span class="hljs-variable language_">window</span>.WindowStage</span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">startAbilityByCall</span>({</li><li>      <span class="hljs-attr">bundleName</span>: <span class="hljs-string">'com.example.myservice'</span>,</li><li>      <span class="hljs-attr">abilityName</span>: <span class="hljs-string">'MainUIAbility'</span>,</li><li>      <span class="hljs-attr">deviceId</span>: <span class="hljs-string">''</span></li><li>    }).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">obj</span>) =&gt;</span> {</li><li>      caller = obj;</li><li>      <span class="hljs-keyword">let</span> msg = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyMessageAble</span>(<span class="hljs-string">'msg'</span>, <span class="hljs-string">'world'</span>);</li><li>      caller.<span class="hljs-title function_">callWithResult</span>(method, msg)</li><li>        .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {</li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Caller callWithResult() called'</span>);</li><li>          <span class="hljs-keyword">let</span> retMsg = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyMessageAble</span>(<span class="hljs-string">'msg'</span>, <span class="hljs-string">'world'</span>);</li><li>          data.<span class="hljs-title function_">readParcelable</span>(retMsg);</li><li>        })</li><li>        .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">callErr: BusinessError</span>) =&gt;</span> {</li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Caller.callWithResult catch error, error.code: <span class="hljs-subst">${callErr.code}</span>, error.message: <span class="hljs-subst">${callErr.message}</span>`</span>);</li><li>        });</li><li>    }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Caller GetCaller error, error.code: <span class="hljs-subst">${err.code}</span>, error.message: <span class="hljs-subst">${err.message}</span>`</span>);</li><li>    });</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1257px;">     <h3 id="release" device-type="phone,2in1,tablet,wearable,tv">release<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="release" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>release(): void</p>     <p>Caller主动释放与Callee UIAbility的连接。调用该接口后，Caller不能再使用call或callWithResult向Callee方发送消息。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.AbilityCore</p>     <p><strong>错误码：</strong></p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-ability">元能力子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.34.7.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.34.7.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">16200001</td>         <td class="cellrowborder" width="50%">The caller has been released.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16200002</td>         <td class="cellrowborder" width="50%">The callee does not exist.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-mdt-c106="" class="highlight-div"><div _ngcontent-mdt-c106="" class="highlight-div-header"><div _ngcontent-mdt-c106="" class="highlight-div-header-left"><div _ngcontent-mdt-c106="" class="handle-button expand-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mdt-c106="" class="highlight-div-header-right"><div _ngcontent-mdt-c106="" class="handle-button ai-button"></div><div _ngcontent-mdt-c106="" class="handle-button line-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mdt-c106="" class="handle-button theme-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mdt-c106="" class="handle-button copy-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mdt-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span>, <span class="hljs-title class_">Caller</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-variable language_">window</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">caller</span>: <span class="hljs-title class_">Caller</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MainUIAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onWindowStageCreate</span>(<span class="hljs-params">windowStage: <span class="hljs-variable language_">window</span>.WindowStage</span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">startAbilityByCall</span>({</li><li>      <span class="hljs-attr">bundleName</span>: <span class="hljs-string">'com.example.myservice'</span>,</li><li>      <span class="hljs-attr">abilityName</span>: <span class="hljs-string">'MainUIAbility'</span>,</li><li>      <span class="hljs-attr">deviceId</span>: <span class="hljs-string">''</span></li><li>    }).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">obj</span>) =&gt;</span> {</li><li>      caller = obj;</li><li>      <span class="hljs-keyword">try</span> {</li><li>        caller.<span class="hljs-title function_">release</span>();</li><li>      } <span class="hljs-keyword">catch</span> (releaseErr) {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Caller.release catch error, error.code: <span class="hljs-subst">${releaseErr.code}</span>, error.message: <span class="hljs-subst">${releaseErr.message}</span>`</span>);</li><li>      }</li><li>    }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Caller GetCaller error, error.code: <span class="hljs-subst">${err.code}</span>, error.message: <span class="hljs-subst">${err.message}</span>`</span>);</li><li>    });</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1480px;">     <h3 id="onrelease" device-type="phone,2in1,tablet,wearable,tv">onRelease<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onrelease" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>onRelease(callback: OnReleaseCallback): void</p>     <p>Caller UIAbility可使用该接口注册与Callee UIAbility连接断开通知的监听。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.AbilityCore</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.35.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.35.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.35.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.35.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability#onreleasecallback">OnReleaseCallback</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数，返回onRelease回调结果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-ability">元能力子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.35.9.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.35.9.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1. Mandatory parameters are left unspecified; 2. Incorrect parameter types.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16200001</td>         <td class="cellrowborder" width="50%">The caller has been released.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-mdt-c106="" class="highlight-div"><div _ngcontent-mdt-c106="" class="highlight-div-header"><div _ngcontent-mdt-c106="" class="highlight-div-header-left"><div _ngcontent-mdt-c106="" class="handle-button expand-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mdt-c106="" class="highlight-div-header-right"><div _ngcontent-mdt-c106="" class="handle-button ai-button"></div><div _ngcontent-mdt-c106="" class="handle-button line-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mdt-c106="" class="handle-button theme-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mdt-c106="" class="handle-button copy-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mdt-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span>, <span class="hljs-title class_">Caller</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-variable language_">window</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MainUIAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onWindowStageCreate</span>(<span class="hljs-params">windowStage: <span class="hljs-variable language_">window</span>.WindowStage</span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">startAbilityByCall</span>({</li><li>      <span class="hljs-attr">bundleName</span>: <span class="hljs-string">'com.example.myservice'</span>,</li><li>      <span class="hljs-attr">abilityName</span>: <span class="hljs-string">'MainUIAbility'</span>,</li><li>      <span class="hljs-attr">deviceId</span>: <span class="hljs-string">''</span></li><li>    }).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">obj</span>) =&gt;</span> {</li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">caller</span>: <span class="hljs-title class_">Caller</span> = obj;</li><li>      <span class="hljs-keyword">try</span> {</li><li>        caller.<span class="hljs-title function_">onRelease</span>(<span class="hljs-function">(<span class="hljs-params">str</span>) =&gt;</span> {</li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`Caller OnRelease CallBack is called <span class="hljs-subst">${str}</span>`</span>);</li><li>        });</li><li>      } <span class="hljs-keyword">catch</span> (error) {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Caller.onRelease catch error, error.code: <span class="hljs-subst">${error.code}</span>, error.message: <span class="hljs-subst">${error.message}</span>`</span>);</li><li>      }</li><li>    }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Caller GetCaller error, error.code: <span class="hljs-subst">${err.code}</span>, error.message: <span class="hljs-subst">${err.message}</span>`</span>);</li><li>    });</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1528px;">     <h3 id="onremotestatechange10" device-type="phone,2in1,tablet,wearable,tv">onRemoteStateChange<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onremotestatechange10" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>onRemoteStateChange(callback: OnRemoteStateChangeCallback): void</p>     <p>注册协同场景下跨设备组件状态变化监听通知。使用callback异步回调。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.AbilityCore</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.36.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.36.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.36.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.36.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability#onremotestatechangecallback">OnRemoteStateChangeCallback</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数，返回onRemoteStateChange回调结果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-ability">元能力子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.36.9.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.36.9.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1. Mandatory parameters are left unspecified; 2. Incorrect parameter types.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16200001</td>         <td class="cellrowborder" width="50%">The caller has been released.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-mdt-c106="" class="highlight-div"><div _ngcontent-mdt-c106="" class="highlight-div-header"><div _ngcontent-mdt-c106="" class="highlight-div-header-left"><div _ngcontent-mdt-c106="" class="handle-button expand-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mdt-c106="" class="highlight-div-header-right"><div _ngcontent-mdt-c106="" class="handle-button ai-button"></div><div _ngcontent-mdt-c106="" class="handle-button line-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mdt-c106="" class="handle-button theme-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mdt-c106="" class="handle-button copy-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mdt-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span>, <span class="hljs-title class_">Caller</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-variable language_">window</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MainAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onWindowStageCreate</span>(<span class="hljs-params">windowStage: <span class="hljs-variable language_">window</span>.WindowStage</span>) {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">dstDeviceId</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'xxxxx'</span>;</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">startAbilityByCall</span>({</li><li>      <span class="hljs-attr">bundleName</span>: <span class="hljs-string">'com.example.myservice'</span>,</li><li>      <span class="hljs-attr">abilityName</span>: <span class="hljs-string">'MainUIAbility'</span>,</li><li>      <span class="hljs-attr">deviceId</span>: dstDeviceId</li><li>    }).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">obj</span>) =&gt;</span> {</li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">caller</span>: <span class="hljs-title class_">Caller</span> = obj;</li><li>      <span class="hljs-keyword">try</span> {</li><li>        caller.<span class="hljs-title function_">onRemoteStateChange</span>(<span class="hljs-function">(<span class="hljs-params">str</span>) =&gt;</span> {</li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Remote state changed '</span> + str);</li><li>        });</li><li>      } <span class="hljs-keyword">catch</span> (error) {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Caller.onRemoteStateChange catch error, error.code: <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(error.code)}</span>, error.message: <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(error.message)}</span>`</span>);</li><li>      }</li><li>    }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Caller GetCaller error, error.code: <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(err.code)}</span>, error.message: <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(err.message)}</span>`</span>);</li><li>    });</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1573px;">     <h3 id="onrelease-1" device-type="phone,2in1,tablet,wearable,tv">on('release')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onrelease-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>on(type: 'release', callback: OnReleaseCallback): void</p>     <p>Caller UIAbility可使用该接口注册与Callee UIAbility连接断开通知的监听。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.AbilityCore</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.37.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.37.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.37.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.37.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">监听releaseCall事件，固定为'release'。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability#onreleasecallback">OnReleaseCallback</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数，返回on回调结果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-ability">元能力子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.37.9.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.37.9.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1. Mandatory parameters are left unspecified; 2. Incorrect parameter types; 3. Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16200001</td>         <td class="cellrowborder" width="50%">The caller has been released.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-mdt-c106="" class="highlight-div"><div _ngcontent-mdt-c106="" class="highlight-div-header"><div _ngcontent-mdt-c106="" class="highlight-div-header-left"><div _ngcontent-mdt-c106="" class="handle-button expand-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mdt-c106="" class="highlight-div-header-right"><div _ngcontent-mdt-c106="" class="handle-button ai-button"></div><div _ngcontent-mdt-c106="" class="handle-button line-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mdt-c106="" class="handle-button theme-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mdt-c106="" class="handle-button copy-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mdt-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span>, <span class="hljs-title class_">Caller</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-variable language_">window</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MainUIAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onWindowStageCreate</span>(<span class="hljs-params">windowStage: <span class="hljs-variable language_">window</span>.WindowStage</span>) {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">dstDeviceId</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'xxxx'</span>;</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">startAbilityByCall</span>({</li><li>      <span class="hljs-attr">bundleName</span>: <span class="hljs-string">'com.example.myservice'</span>,</li><li>      <span class="hljs-attr">abilityName</span>: <span class="hljs-string">'MainUIAbility'</span>,</li><li>      <span class="hljs-attr">deviceId</span>: dstDeviceId</li><li>    }).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">obj</span>) =&gt;</span> {</li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">caller</span>: <span class="hljs-title class_">Caller</span> = obj;</li><li>      <span class="hljs-keyword">try</span> {</li><li>        caller.<span class="hljs-title function_">on</span>(<span class="hljs-string">'release'</span>, <span class="hljs-function">(<span class="hljs-params">str</span>) =&gt;</span> {</li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`Caller OnRelease CallBack is called <span class="hljs-subst">${str}</span>`</span>);</li><li>        });</li><li>      } <span class="hljs-keyword">catch</span> (error) {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Caller.on catch error, error.code: <span class="hljs-subst">${error.code}</span>, error.message: <span class="hljs-subst">${error.message}</span>`</span>);</li><li>      }</li><li>    }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Caller GetCaller error, error.code: <span class="hljs-subst">${err.code}</span>, error.message: <span class="hljs-subst">${err.message}</span>`</span>);</li><li>    });</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1542px;">     <h3 id="offrelease" device-type="phone,2in1,tablet,wearable,tv">off('release')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="offrelease" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>off(type: 'release', callback: OnReleaseCallback): void</p>     <p>取消注册Callee UIAbility断开通知的监听，与<a href="/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability#onrelease-1">on('release')</a>是反向操作，当前暂未支持。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.AbilityCore</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.38.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.38.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.38.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.38.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">监听releaseCall事件，固定为'release'。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability#onreleasecallback">OnReleaseCallback</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数，返回off回调结果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.38.9.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.38.9.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1. Mandatory parameters are left unspecified; 2. Incorrect parameter types; 3. Parameter verification failed.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-mdt-c106="" class="highlight-div"><div _ngcontent-mdt-c106="" class="highlight-div-header"><div _ngcontent-mdt-c106="" class="highlight-div-header-left"><div _ngcontent-mdt-c106="" class="handle-button expand-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mdt-c106="" class="highlight-div-header-right"><div _ngcontent-mdt-c106="" class="handle-button ai-button"></div><div _ngcontent-mdt-c106="" class="handle-button line-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mdt-c106="" class="handle-button theme-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mdt-c106="" class="handle-button copy-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mdt-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span>, <span class="hljs-title class_">Caller</span>, <span class="hljs-title class_">OnReleaseCallback</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-variable language_">window</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MainUIAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onWindowStageCreate</span>(<span class="hljs-params">windowStage: <span class="hljs-variable language_">window</span>.WindowStage</span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">startAbilityByCall</span>({</li><li>      <span class="hljs-attr">bundleName</span>: <span class="hljs-string">'com.example.myservice'</span>,</li><li>      <span class="hljs-attr">abilityName</span>: <span class="hljs-string">'MainUIAbility'</span>,</li><li>      <span class="hljs-attr">deviceId</span>: <span class="hljs-string">''</span></li><li>    }).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">obj</span>) =&gt;</span> {</li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">caller</span>: <span class="hljs-title class_">Caller</span> = obj;</li><li>      <span class="hljs-keyword">try</span> {</li><li>        <span class="hljs-keyword">let</span> <span class="hljs-attr">onReleaseCallBack</span>: <span class="hljs-title class_">OnReleaseCallback</span> = <span class="hljs-function">(<span class="hljs-params">str</span>) =&gt;</span> {</li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`Caller OnRelease CallBack is called <span class="hljs-subst">${str}</span>`</span>);</li><li>        };</li><li>        caller.<span class="hljs-title function_">on</span>(<span class="hljs-string">'release'</span>, onReleaseCallBack);</li><li>        caller.<span class="hljs-title function_">off</span>(<span class="hljs-string">'release'</span>, onReleaseCallBack);</li><li>      } <span class="hljs-keyword">catch</span> (error) {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Caller.on or Caller.off catch error, error.code: <span class="hljs-subst">${error.code}</span>, error.message: <span class="hljs-subst">${error.message}</span>`</span>);</li><li>      }</li><li>    }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Caller GetCaller error, error.code: <span class="hljs-subst">${err.code}</span>, error.message: <span class="hljs-subst">${err.message}</span>`</span>);</li><li>    });</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1521px;">     <h3 id="offrelease-1" device-type="phone,2in1,tablet,wearable,tv">off('release')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="offrelease-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>off(type: 'release'): void</p>     <p>取消注册Callee UIAbility断开通知的监听，与<a href="/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability#onrelease-1">Caller.on('release')</a>是反向操作，当前暂未支持。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.AbilityCore</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.39.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.39.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.39.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.39.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">监听releaseCall事件，固定为'release'。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.39.9.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.39.9.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1. Mandatory parameters are left unspecified; 2. Incorrect parameter types; 3. Parameter verification failed.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-mdt-c106="" class="highlight-div"><div _ngcontent-mdt-c106="" class="highlight-div-header"><div _ngcontent-mdt-c106="" class="highlight-div-header-left"><div _ngcontent-mdt-c106="" class="handle-button expand-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mdt-c106="" class="highlight-div-header-right"><div _ngcontent-mdt-c106="" class="handle-button ai-button"></div><div _ngcontent-mdt-c106="" class="handle-button line-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mdt-c106="" class="handle-button theme-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mdt-c106="" class="handle-button copy-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mdt-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span>, <span class="hljs-title class_">Caller</span>, <span class="hljs-title class_">OnReleaseCallback</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-variable language_">window</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">caller</span>: <span class="hljs-title class_">Caller</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MainUIAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onWindowStageCreate</span>(<span class="hljs-params">windowStage: <span class="hljs-variable language_">window</span>.WindowStage</span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">startAbilityByCall</span>({</li><li>      <span class="hljs-attr">bundleName</span>: <span class="hljs-string">'com.example.myservice'</span>,</li><li>      <span class="hljs-attr">abilityName</span>: <span class="hljs-string">'MainUIAbility'</span>,</li><li>      <span class="hljs-attr">deviceId</span>: <span class="hljs-string">''</span></li><li>    }).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">obj</span>) =&gt;</span> {</li><li>      caller = obj;</li><li>      <span class="hljs-keyword">try</span> {</li><li>        <span class="hljs-keyword">let</span> <span class="hljs-attr">onReleaseCallBack</span>: <span class="hljs-title class_">OnReleaseCallback</span> = <span class="hljs-function">(<span class="hljs-params">str</span>) =&gt;</span> {</li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`Caller OnRelease CallBack is called <span class="hljs-subst">${str}</span>`</span>);</li><li>        };</li><li>        caller.<span class="hljs-title function_">on</span>(<span class="hljs-string">'release'</span>, onReleaseCallBack);</li><li>        caller.<span class="hljs-title function_">off</span>(<span class="hljs-string">'release'</span>);</li><li>      } <span class="hljs-keyword">catch</span> (error) {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Caller.on or Caller.off catch error, error.code: <span class="hljs-subst">${error.code}</span>, error.message: <span class="hljs-subst">${error.message}</span>`</span>);</li><li>      }</li><li>    }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Caller GetCaller error, error.code: <span class="hljs-subst">${err.code}</span>, error.message: <span class="hljs-subst">${err.message}</span>`</span>);</li><li>    });</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 182px;">     <h2 id="callee" device-type="phone,2in1,tablet,wearable,tv">Callee<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="callee" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>系统为UIAbility创建的后台通信对象，Callee UIAbility（被调用方）可以通过Callee对象接收Caller对象发送的数据。</p>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 2212px;">     <h3 id="on" device-type="phone,2in1,tablet,wearable,tv" class="firsth2">on<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="on" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>on(method: string, callback: CalleeCallback): void</p>     <p>通用组件服务端注册消息通知callback。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.AbilityCore</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.41.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.41.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.41.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.41.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">method</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">由Caller和Callee双方约定好的方法名，Callee方通过该字段区分消息类型。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability#calleecallback">CalleeCallback</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">一个<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-rpc#messagesequence9">rpc.MessageSequence</a>类型入参的js通知同步回调函数, 回调函数至少要返回一个空的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-rpc#parcelable9">rpc.Parcelable</a>数据对象, 其他视为函数执行错误。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-ability">元能力子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.41.9.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.41.9.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1. Mandatory parameters are left unspecified; 2. Incorrect parameter types; 3. Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16200004</td>         <td class="cellrowborder" width="50%">The method has been registered.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000050</td>         <td class="cellrowborder" width="50%">Internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-mdt-c106="" class="highlight-div"><div _ngcontent-mdt-c106="" class="highlight-div-header"><div _ngcontent-mdt-c106="" class="highlight-div-header-left"><div _ngcontent-mdt-c106="" class="handle-button expand-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mdt-c106="" class="highlight-div-header-right"><div _ngcontent-mdt-c106="" class="handle-button ai-button"></div><div _ngcontent-mdt-c106="" class="handle-button line-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mdt-c106="" class="handle-button theme-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mdt-c106="" class="handle-button copy-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mdt-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span>, <span class="hljs-title class_">AbilityConstant</span>, <span class="hljs-title class_">Want</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { rpc } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.IPCKit'</span>;</li><li>
</li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyMessageAble</span> <span class="hljs-keyword">implements</span> rpc.<span class="hljs-property">Parcelable</span> {</li><li>  <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span></li><li>  <span class="hljs-attr">str</span>: <span class="hljs-built_in">string</span></li><li>  <span class="hljs-attr">num</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">1</span></li><li>
</li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name: <span class="hljs-built_in">string</span>, str: <span class="hljs-built_in">string</span></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">str</span> = str;</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">marshalling</span>(<span class="hljs-params">messageSequence: rpc.MessageSequence</span>) {</li><li>    messageSequence.<span class="hljs-title function_">writeInt</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">num</span>);</li><li>    messageSequence.<span class="hljs-title function_">writeString</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">str</span>);</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`MyMessageAble marshalling num[<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.num}</span>] str[<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.str}</span>]`</span>);</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">unmarshalling</span>(<span class="hljs-params">messageSequence: rpc.MessageSequence</span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">num</span> = messageSequence.<span class="hljs-title function_">readInt</span>();</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">str</span> = messageSequence.<span class="hljs-title function_">readString</span>();</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`MyMessageAble unmarshalling num[<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.num}</span>] str[<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.str}</span>]`</span>);</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-keyword">let</span> method = <span class="hljs-string">'call_Function'</span>;</li><li>
</li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">funcCallBack</span>(<span class="hljs-params">pdata: rpc.MessageSequence</span>) {</li><li>  <span class="hljs-keyword">let</span> msg = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyMessageAble</span>(<span class="hljs-string">'test'</span>, <span class="hljs-string">''</span>);</li><li>  pdata.<span class="hljs-title function_">readParcelable</span>(msg);</li><li>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyMessageAble</span>(<span class="hljs-string">'test1'</span>, <span class="hljs-string">'Callee test'</span>);</li><li>}</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MainUIAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onCreate</span>(<span class="hljs-params">want: Want, launchParam: AbilityConstant.LaunchParam</span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Callee onCreate is called'</span>);</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">callee</span>.<span class="hljs-title function_">on</span>(method, funcCallBack);</li><li>    } <span class="hljs-keyword">catch</span> (error) {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Callee.on catch error, error.code: <span class="hljs-subst">${error.code}</span>, error.message: <span class="hljs-subst">${error.message}</span>`</span>);</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1271px;">     <h3 id="off" device-type="phone,2in1,tablet,wearable,tv">off<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="off" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>off(method: string): void</p>     <p>解除通用组件服务端注册消息通知callback。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.AbilityCore</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.42.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.42.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.42.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.42.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">method</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">已注册的通知事件字符串。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-ability">元能力子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.42.9.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.42.9.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1. Mandatory parameters are left unspecified; 2. Incorrect parameter types; 3. Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16200005</td>         <td class="cellrowborder" width="50%">The method has not been registered.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000050</td>         <td class="cellrowborder" width="50%">Internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-mdt-c106="" class="highlight-div"><div _ngcontent-mdt-c106="" class="highlight-div-header"><div _ngcontent-mdt-c106="" class="highlight-div-header-left"><div _ngcontent-mdt-c106="" class="handle-button expand-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mdt-c106="" class="highlight-div-header-right"><div _ngcontent-mdt-c106="" class="handle-button ai-button"></div><div _ngcontent-mdt-c106="" class="handle-button line-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mdt-c106="" class="handle-button theme-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mdt-c106="" class="handle-button copy-button"><div _ngcontent-mdt-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mdt-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span>, <span class="hljs-title class_">AbilityConstant</span>, <span class="hljs-title class_">Want</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> method = <span class="hljs-string">'call_Function'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MainUIAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onCreate</span>(<span class="hljs-params">want: Want, launchParam: AbilityConstant.LaunchParam</span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Callee onCreate is called'</span>);</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">callee</span>.<span class="hljs-title function_">off</span>(method);</li><li>    } <span class="hljs-keyword">catch</span> (error) {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Callee.off catch error, error.code: <span class="hljs-subst">${error.code}</span>, error.message: <span class="hljs-subst">${error.message}</span>`</span>);</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 146px;">     <h2 id="onreleasecallback" device-type="phone,2in1,tablet,wearable,tv">OnReleaseCallback<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onreleasecallback" tips="复制节点链接"></i></h2>         <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div></div>    <div class="tiledSection" style="contain-intrinsic-size: auto 405px;">     <h3 id="msg-string" device-type="phone,2in1,tablet,wearable,tv" class="firsth2">(msg: string)<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="msg-string" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>(msg: string): void</p>     <p>注册通用组件服务端Stub（桩）断开监听通知的回调函数类型。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.AbilityCore</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.44.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.44.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.44.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.44.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">msg</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">用于传递释放消息。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 146px;">     <h2 id="onremotestatechangecallback" device-type="phone,2in1,tablet,wearable,tv">OnRemoteStateChangeCallback<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onremotestatechangecallback" tips="复制节点链接"></i></h2>         <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div></div>    <div class="tiledSection" style="contain-intrinsic-size: auto 405px;">     <h3 id="msg-string10" device-type="phone,2in1,tablet,wearable,tv" class="firsth2">(msg: string)<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="msg-string10" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>(msg: string): void</p>     <p>注册协同场景下跨设备组件状态变化监听通知的回调函数类型。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.AbilityCore</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.46.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.46.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.46.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.46.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">msg</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">用于传递释放消息。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 146px;">     <h2 id="calleecallback" device-type="phone,2in1,tablet,wearable,tv">CalleeCallback<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="calleecallback" tips="复制节点链接"></i></h2>         <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div></div>    <div class="tiledSection" style="contain-intrinsic-size: auto 576px;">     <h3 id="indata-rpcmessagesequence" device-type="phone,2in1,tablet,wearable,tv" class="firsth2">(indata: rpc.MessageSequence)<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="indata-rpcmessagesequence" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>(indata: rpc.MessageSequence): rpc.Parcelable</p>     <p>通用组件服务端注册消息通知的回调函数类型。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.AbilityCore</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.48.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.48.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.48.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.48.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">indata</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-rpc#messagesequence9">rpc.MessageSequence</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">发送需传递的数据。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.48.8.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.48.8.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-rpc#parcelable9">rpc.Parcelable</a></td>         <td class="cellrowborder" width="50%">返回的数据对象。</td>        </tr>             </tbody></table></div>     </div>    </div>   </div>   <div></div></div>