<h1 _ngcontent-pkn-c119="" class="doc-title ng-star-inserted" title="@ohos.app.ability.childProcessManager (子进程管理)"> @ohos.app.ability.childProcessManager (子进程管理) </h1>

<div _ngcontent-pkn-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p>childProcessManager模块提供子进程管理能力，支持子进程创建和启动操作。</p>    <p>创建的子进程会随着父进程的退出而退出，无法脱离父进程独立运行。</p>    <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">      <p>本模块首批接口从API version 11开始支持。后续版本的新增接口，采用上角标单独标记接口的起始版本。</p>      <p>本模块接口仅可在Stage模型下使用。</p>     </div></div></div>    <div class="tiledSection">     <h2 id="约束限制" device-type="phone,2in1,tablet,wearable,tv">约束限制<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="约束限制" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><ul>      <li>       <p>通过本模块中接口创建的子进程有如下限制:</p>       <ul>        <li>创建的子进程不支持创建UI界面。</li>        <li>创建的子进程不支持依赖Context的API调用（包括Context模块自身API及将Context实例作为入参的API）。</li>        <li>创建的子进程内不支持再次创建子进程。</li>       </ul></li>      <li>       <p>通过本模块中定义的创建子进程的接口和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-native-child-process-h">native_child_process.h</a>中定义的创建子进程的接口启动的子进程总数最大为512个（系统资源充足情况下），其中<a href="/consumer/cn/doc/harmonyos-references/js-apis-app-ability-childprocessmanager#childprocessmanagerstartchildprocess">startChildProcess</a>接口在SELF_FORK模式下启动的子进程不计入总数内。</p></li>     </ul>    </div>    <div class="tiledSection">     <h2 id="导入模块" device-type="phone,2in1,tablet,wearable,tv">导入模块<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="导入模块" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><div _ngcontent-pkn-c106="" class="highlight-div"><div _ngcontent-pkn-c106="" class="highlight-div-header"><div _ngcontent-pkn-c106="" class="highlight-div-header-left"><div _ngcontent-pkn-c106="" class="handle-button expand-button"><div _ngcontent-pkn-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pkn-c106="" class="highlight-div-header-right"><div _ngcontent-pkn-c106="" class="handle-button ai-button"></div><div _ngcontent-pkn-c106="" class="handle-button line-button"><div _ngcontent-pkn-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pkn-c106="" class="handle-button theme-button"><div _ngcontent-pkn-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pkn-c106="" class="handle-button copy-button"><div _ngcontent-pkn-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pkn-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { childProcessManager } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="startmode" device-type="phone,2in1,tablet,wearable,tv">StartMode<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="startmode" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>子进程启动模式枚举。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.Core</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.6.4.1.4.1.1" width="33.33333333333333%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.6.4.1.4.1.2" width="33.33333333333333%">值</th>         <th align="left" class="cellrowborder" id="mcps1.3.6.4.1.4.1.3" width="33.33333333333333%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="33.33333333333333%">SELF_FORK</td>         <td class="cellrowborder" width="33.33333333333333%">0</td>         <td class="cellrowborder" width="33.33333333333333%">从App自身进程Fork子进程。以该模式启动的子进程会继承父进程资源，不能使用Binder IPC和其他进程通信，否则会导致子进程崩溃退出。</td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">APP_SPAWN_FORK</td>         <td class="cellrowborder" width="33.33333333333333%">1</td>         <td class="cellrowborder" width="33.33333333333333%">从AppSpawn Fork子进程。以该模式启动的子进程不会继承父进程资源，可以使用Binder IPC和其他进程通信。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="childprocessmanagerstartchildprocess" device-type="phone,2in1,tablet,wearable,tv">childProcessManager.startChildProcess<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="childprocessmanagerstartchildprocess" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>startChildProcess(srcEntry: string, startMode: StartMode): Promise&lt;number&gt;</p>     <p>启动<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ability-terminology#arkts子进程" target="_blank">ArkTS子进程</a>。使用Promise异步回调。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>调用该接口创建子进程成功会返回子进程pid，然后执行子进程的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-childprocess#childprocessonstart">ChildProcess.onStart</a>函数，<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-childprocess#childprocessonstart">ChildProcess.onStart</a>函数执行完后子进程会自动销毁。</p>       <p>调用该接口创建的子进程不支持异步ArkTS API调用，仅支持同步ArkTS API调用。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.Core</p>     <p><strong>设备行为差异</strong>：该接口在Tablet、PC/2in1中可正常调用，在其他设备类型中返回16000061错误码。</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.7.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.7.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.7.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.7.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">srcEntry</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">          <p>子进程源文件路径，只支持源文件放在entry类型的模块中，以src/main为根目录。例如子进程文件在entry模块下src/main/ets/process/DemoProcess.ets，则srcEntry为"./ets/process/DemoProcess.ets"。</p>          <p>另外，需要确保子进程源文件被其它文件引用到，防止被构建工具优化掉。（详见下方示例代码）</p></td>        </tr>        <tr>         <td class="cellrowborder" width="25%">startMode</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-app-ability-childprocessmanager#startmode">StartMode</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">子进程启动模式。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.7.10.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.7.10.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;number&gt;</td>         <td class="cellrowborder" width="50%">Promise对象，返回子进程pid。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-ability">元能力子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.7.13.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.7.13.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1.Mandatory parameters are left unspecified; 2.Incorrect parameter types; 3.Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000050</td>         <td class="cellrowborder" width="50%">Internal error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000061</td>         <td class="cellrowborder" width="50%">Operation not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000062</td>         <td class="cellrowborder" width="50%">The number of child processes exceeds the upper limit.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-pkn-c106="" class="highlight-div"><div _ngcontent-pkn-c106="" class="highlight-div-header"><div _ngcontent-pkn-c106="" class="highlight-div-header-left"><div _ngcontent-pkn-c106="" class="handle-button expand-button"><div _ngcontent-pkn-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pkn-c106="" class="highlight-div-header-right"><div _ngcontent-pkn-c106="" class="handle-button ai-button"></div><div _ngcontent-pkn-c106="" class="handle-button line-button"><div _ngcontent-pkn-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pkn-c106="" class="handle-button theme-button"><div _ngcontent-pkn-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pkn-c106="" class="handle-button copy-button"><div _ngcontent-pkn-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pkn-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 在entry模块的src/main/ets/process下创建DemoProcess.ets子进程类:</span></li><li><span class="hljs-comment">// entry/src/main/ets/process/DemoProcess.ets</span></li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">ChildProcess</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DemoProcess</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">ChildProcess</span> {</li><li>  <span class="hljs-title function_">onStart</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"DemoProcess OnStart() called"</span>);</li><li>  }</li><li>}</li></ol></pre></div></div>     <div _ngcontent-pkn-c106="" class="highlight-div"><div _ngcontent-pkn-c106="" class="highlight-div-header"><div _ngcontent-pkn-c106="" class="highlight-div-header-left"><div _ngcontent-pkn-c106="" class="handle-button expand-button"><div _ngcontent-pkn-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pkn-c106="" class="highlight-div-header-right"><div _ngcontent-pkn-c106="" class="handle-button ai-button"></div><div _ngcontent-pkn-c106="" class="handle-button line-button"><div _ngcontent-pkn-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pkn-c106="" class="handle-button theme-button"><div _ngcontent-pkn-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pkn-c106="" class="handle-button copy-button"><div _ngcontent-pkn-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pkn-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 使用childProcessManager.startChildProcess方法启动子进程:</span></li><li><span class="hljs-comment">// entry/src/main/ets/tool/Tool.ets</span></li><li><span class="hljs-keyword">import</span> { childProcessManager } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> <span class="hljs-title class_">DemoProcess</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'../process/DemoProcess'</span>;</li><li>
</li><li><span class="hljs-keyword">try</span> {</li><li>  <span class="hljs-title class_">DemoProcess</span>.<span class="hljs-title function_">toString</span>(); <span class="hljs-comment">// 这里要调用下DemoProcess类的任意方法，防止没有引用到而被构建工具优化掉</span></li><li>  childProcessManager.<span class="hljs-title function_">startChildProcess</span>(<span class="hljs-string">"./ets/process/DemoProcess.ets"</span>, childProcessManager.<span class="hljs-property">StartMode</span>.<span class="hljs-property">SELF_FORK</span>)</li><li>    .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`startChildProcess success, pid: <span class="hljs-subst">${data}</span>`</span>);</li><li>    }, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`startChildProcess error, errorCode: <span class="hljs-subst">${err.code}</span>`</span>);</li><li>    })</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`startChildProcess error, errorCode: <span class="hljs-subst">${(err <span class="hljs-keyword">as</span> BusinessError).code}</span>`</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="childprocessmanagerstartchildprocess-1" device-type="phone,2in1,tablet,wearable,tv">childProcessManager.startChildProcess<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="childprocessmanagerstartchildprocess-1" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>startChildProcess(srcEntry: string, startMode: StartMode, callback: AsyncCallback&lt;number&gt;): void</p>     <p>启动<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ability-terminology#arkts子进程" target="_blank">ArkTS子进程</a>。使用callback异步回调。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>调用该接口创建子进程成功会返回子进程pid，然后执行子进程的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-childprocess#childprocessonstart">ChildProcess.onStart</a>函数，<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-childprocess#childprocessonstart">ChildProcess.onStart</a>函数执行完后子进程会自动销毁。</p>       <p>调用该接口创建的子进程不支持异步ArkTS API调用，仅支持同步ArkTS API调用。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.Core</p>     <p><strong>设备行为差异</strong>：该接口在Tablet、PC/2in1中可正常调用，在其他设备类型中返回16000061错误码。</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.8.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.8.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.8.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.8.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">srcEntry</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">          <p>子进程源文件路径，只支持源文件放在entry类型的模块中，以src/main为根目录。例如子进程文件在entry模块下src/main/ets/process/DemoProcess.ets，则srcEntry为"./ets/process/DemoProcess.ets"。</p>          <p>另外，需要确保子进程源文件被其它文件引用到，防止被构建工具优化掉。（详见下方示例代码）</p></td>        </tr>        <tr>         <td class="cellrowborder" width="25%">startMode</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-app-ability-childprocessmanager#startmode">StartMode</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">子进程启动模式。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;number&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。当子进程启动成功，err为undefined，data为获取到的子进程pid；否则为错误对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-ability">元能力子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.8.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.8.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1.Mandatory parameters are left unspecified; 2.Incorrect parameter types; 3.Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000050</td>         <td class="cellrowborder" width="50%">Internal error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000061</td>         <td class="cellrowborder" width="50%">Operation not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000062</td>         <td class="cellrowborder" width="50%">The number of child processes exceeds the upper limit.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-pkn-c106="" class="highlight-div"><div _ngcontent-pkn-c106="" class="highlight-div-header"><div _ngcontent-pkn-c106="" class="highlight-div-header-left"><div _ngcontent-pkn-c106="" class="handle-button expand-button"><div _ngcontent-pkn-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pkn-c106="" class="highlight-div-header-right"><div _ngcontent-pkn-c106="" class="handle-button ai-button"></div><div _ngcontent-pkn-c106="" class="handle-button line-button"><div _ngcontent-pkn-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pkn-c106="" class="handle-button theme-button"><div _ngcontent-pkn-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pkn-c106="" class="handle-button copy-button"><div _ngcontent-pkn-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pkn-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 在entry模块的src/main/ets/process下创建DemoProcess.ets子进程类:</span></li><li><span class="hljs-comment">// entry/src/main/ets/process/DemoProcess.ets</span></li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">ChildProcess</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DemoProcess</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">ChildProcess</span> {</li><li>  <span class="hljs-title function_">onStart</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"DemoProcess OnStart() called"</span>);</li><li>  }</li><li>}</li></ol></pre></div></div>     <div _ngcontent-pkn-c106="" class="highlight-div"><div _ngcontent-pkn-c106="" class="highlight-div-header"><div _ngcontent-pkn-c106="" class="highlight-div-header-left"><div _ngcontent-pkn-c106="" class="handle-button expand-button"><div _ngcontent-pkn-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pkn-c106="" class="highlight-div-header-right"><div _ngcontent-pkn-c106="" class="handle-button ai-button"></div><div _ngcontent-pkn-c106="" class="handle-button line-button"><div _ngcontent-pkn-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pkn-c106="" class="handle-button theme-button"><div _ngcontent-pkn-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pkn-c106="" class="handle-button copy-button"><div _ngcontent-pkn-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pkn-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 使用childProcessManager.startChildProcess方法启动子进程:</span></li><li><span class="hljs-comment">// entry/src/main/ets/tool/Tool.ets</span></li><li><span class="hljs-keyword">import</span> { childProcessManager } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> <span class="hljs-title class_">DemoProcess</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'../process/DemoProcess'</span>;</li><li>
</li><li><span class="hljs-keyword">try</span> {</li><li>  <span class="hljs-title class_">DemoProcess</span>.<span class="hljs-title function_">toString</span>(); <span class="hljs-comment">// 这里要调用下DemoProcess类的任意方法，防止没有引用到而被构建工具优化掉</span></li><li>  childProcessManager.<span class="hljs-title function_">startChildProcess</span>(<span class="hljs-string">"./ets/process/DemoProcess.ets"</span>, childProcessManager.<span class="hljs-property">StartMode</span>.<span class="hljs-property">SELF_FORK</span>, <span class="hljs-function">(<span class="hljs-params">err, data</span>) =&gt;</span> {</li><li>    <span class="hljs-keyword">if</span> (data) {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`startChildProcess success, pid: <span class="hljs-subst">${data}</span>`</span>);</li><li>    } <span class="hljs-keyword">else</span> {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`startChildProcess error, errorCode: <span class="hljs-subst">${err.code}</span>`</span>);</li><li>    }</li><li>  });</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`startChildProcess error, errorCode: <span class="hljs-subst">${(err <span class="hljs-keyword">as</span> BusinessError).code}</span>`</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="childprocessmanagerstartarkchildprocess12" device-type="phone,2in1,tablet,wearable,tv">childProcessManager.startArkChildProcess<sup>12+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="childprocessmanagerstartarkchildprocess12" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>startArkChildProcess(srcEntry: string, args: ChildProcessArgs, options?: ChildProcessOptions): Promise&lt;number&gt;</p>     <p>启动<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ability-terminology#arkts子进程" target="_blank">ArkTS子进程</a>。使用Promise异步回调。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>调用该接口创建的子进程不会继承父进程资源，子进程创建成功会返回子进程pid，然后执行子进程的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-childprocess#childprocessonstart">ChildProcess.onStart</a>函数。<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-childprocess#childprocessonstart">ChildProcess.onStart</a>函数执行完后子进程不会自动销毁，需要子进程调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-process#processabort">process.abort</a>销毁。调用该接口的进程销毁后，所创建的子进程也会一并销毁。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.Core</p>     <p><strong>设备行为差异</strong>：该接口在Tablet、PC/2in1中可正常调用，在其他设备类型中返回801错误码。</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.9.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.9.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.9.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.9.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">srcEntry</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">          <p>子进程源文件路径，不支持源文件放在HAR类型的模块中。由“模块名” + “/” + “文件路径”组成，文件路径以src/main为根目录。例如子进程文件在module1模块下src/main/ets/process/DemoProcess.ets，则srcEntry为"module1/ets/process/DemoProcess.ets"。</p>          <p>另外，需要确保子进程源文件被其它文件引用到，防止被构建工具优化掉。（详见下方示例代码）</p></td>        </tr>        <tr>         <td class="cellrowborder" width="25%">args</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-childprocessargs">ChildProcessArgs</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">传递到子进程的参数。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">options</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-childprocessoptions">ChildProcessOptions</a></td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">子进程的启动配置选项。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.9.10.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.9.10.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;number&gt;</td>         <td class="cellrowborder" width="50%">Promise对象，返回子进程pid。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-ability">元能力子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.9.13.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.9.13.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1.Mandatory parameters are left unspecified; 2.Incorrect parameter types; 3.Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000050</td>         <td class="cellrowborder" width="50%">Internal error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000061</td>         <td class="cellrowborder" width="50%">Operation not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000062</td>         <td class="cellrowborder" width="50%">The number of child processes exceeds the upper limit.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <p>子进程部分：</p>     <div _ngcontent-pkn-c106="" class="highlight-div"><div _ngcontent-pkn-c106="" class="highlight-div-header"><div _ngcontent-pkn-c106="" class="highlight-div-header-left"><div _ngcontent-pkn-c106="" class="handle-button expand-button"><div _ngcontent-pkn-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pkn-c106="" class="highlight-div-header-right"><div _ngcontent-pkn-c106="" class="handle-button ai-button"></div><div _ngcontent-pkn-c106="" class="handle-button line-button"><div _ngcontent-pkn-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pkn-c106="" class="handle-button theme-button"><div _ngcontent-pkn-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pkn-c106="" class="handle-button copy-button"><div _ngcontent-pkn-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pkn-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 在module1模块的src/main/ets/process下创建DemoProcess.ets子进程类:</span></li><li><span class="hljs-comment">// module1/src/main/ets/process/DemoProcess.ets</span></li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">ChildProcess</span>, <span class="hljs-title class_">ChildProcessArgs</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DemoProcess</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">ChildProcess</span> {</li><li>
</li><li>  <span class="hljs-title function_">onStart</span>(<span class="hljs-params">args?: ChildProcessArgs</span>) {</li><li>    <span class="hljs-keyword">let</span> entryParams = args?.<span class="hljs-property">entryParams</span>;</li><li>    <span class="hljs-keyword">let</span> fd = args?.<span class="hljs-property">fds</span>?.<span class="hljs-property">key1</span>;</li><li>    <span class="hljs-comment">// ..</span></li><li>  }</li><li>}</li></ol></pre></div></div>     <p>主进程部分，示例中的context的获取方式请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/uiability-usage#获取uiability的上下文信息" target="_blank">获取UIAbility的上下文信息</a>：</p>     <div _ngcontent-pkn-c106="" class="highlight-div"><div _ngcontent-pkn-c106="" class="highlight-div-header"><div _ngcontent-pkn-c106="" class="highlight-div-header-left"><div _ngcontent-pkn-c106="" class="handle-button expand-button"><div _ngcontent-pkn-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pkn-c106="" class="highlight-div-header-right"><div _ngcontent-pkn-c106="" class="handle-button ai-button"></div><div _ngcontent-pkn-c106="" class="handle-button line-button"><div _ngcontent-pkn-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pkn-c106="" class="handle-button theme-button"><div _ngcontent-pkn-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pkn-c106="" class="handle-button copy-button"><div _ngcontent-pkn-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pkn-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 使用childProcessManager.startArkChildProcess方法启动子进程:</span></li><li><span class="hljs-comment">// module1/src/main/ets/tool/Tool.ets</span></li><li><span class="hljs-keyword">import</span> { common, <span class="hljs-title class_">ChildProcessArgs</span>, <span class="hljs-title class_">ChildProcessOptions</span>, childProcessManager } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { fileIo } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.CoreFileKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> <span class="hljs-title class_">DemoProcess</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'../process/DemoProcess'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Row</span>() {</li><li>      <span class="hljs-title class_">Column</span>() {</li><li>        <span class="hljs-title class_">Text</span>(<span class="hljs-string">'Click'</span>)</li><li>          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">30</span>)</li><li>          .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-keyword">try</span> {</li><li>              <span class="hljs-title class_">DemoProcess</span>.<span class="hljs-title function_">toString</span>(); <span class="hljs-comment">// 这里要调用下DemoProcess类的任意方法，防止没有引用到而被构建工具优化掉</span></li><li>              <span class="hljs-keyword">let</span> context = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li>              <span class="hljs-keyword">let</span> path = context.<span class="hljs-property">filesDir</span> + <span class="hljs-string">"/test.txt"</span>;</li><li>              <span class="hljs-keyword">let</span> file = fileIo.<span class="hljs-title function_">openSync</span>(path, fileIo.<span class="hljs-property">OpenMode</span>.<span class="hljs-property">READ_ONLY</span> | fileIo.<span class="hljs-property">OpenMode</span>.<span class="hljs-property">CREATE</span>);</li><li>              <span class="hljs-keyword">let</span> <span class="hljs-attr">args</span>: <span class="hljs-title class_">ChildProcessArgs</span> = {</li><li>                <span class="hljs-attr">entryParams</span>: <span class="hljs-string">"testParam"</span>,</li><li>                <span class="hljs-attr">fds</span>: {</li><li>                  <span class="hljs-string">"key1"</span>: file.<span class="hljs-property">fd</span></li><li>                }</li><li>              };</li><li>              <span class="hljs-keyword">let</span> <span class="hljs-attr">options</span>: <span class="hljs-title class_">ChildProcessOptions</span> = {</li><li>                <span class="hljs-attr">isolationMode</span>: <span class="hljs-literal">false</span></li><li>              };</li><li>              childProcessManager.<span class="hljs-title function_">startArkChildProcess</span>(<span class="hljs-string">"module1/ets/process/DemoProcess.ets"</span>, args, options)</li><li>                .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">pid</span>) =&gt;</span> {</li><li>                  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`startChildProcess success, pid: <span class="hljs-subst">${pid}</span>`</span>);</li><li>                })</li><li>                .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>                  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`startChildProcess business error, errorCode: <span class="hljs-subst">${err.code}</span>, errorMsg:<span class="hljs-subst">${err.message}</span>`</span>);</li><li>                })</li><li>            } <span class="hljs-keyword">catch</span> (err) {</li><li>              <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`startChildProcess error, errorCode: <span class="hljs-subst">${err.code}</span>, errorMsg:<span class="hljs-subst">${err.message}</span>`</span>);</li><li>            }</li><li>          });</li><li>      }</li><li>      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    }</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="childprocessmanagerstartnativechildprocess13" device-type="phone,2in1,tablet,wearable,tv">childProcessManager.startNativeChildProcess<sup>13+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="childprocessmanagerstartnativechildprocess13" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>startNativeChildProcess(entryPoint: string, args: ChildProcessArgs, options?: ChildProcessOptions): Promise&lt;number&gt;</p>     <p>启动<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ability-terminology#native子进程" target="_blank">Native子进程</a>。使用Promise异步回调。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>调用该接口创建的子进程不会继承父进程资源，子进程创建成功会返回子进程pid，然后加载参数中指定的动态链接库文件并执行子进程的入口函数，入口函数执行完后子进程会自动销毁。调用该接口的进程销毁后，所创建的子进程也会一并销毁。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.Core</p>     <p><strong>设备行为差异</strong>：该接口在Tablet、PC/2in1中可正常调用，在其他设备类型中返回801错误码。</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.10.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.10.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.10.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.10.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">entryPoint</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">子进程中调用动态库的符号和入口函数，中间用“:”隔开（例如“libentry.so:Main”)。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">args</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-childprocessargs">ChildProcessArgs</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">传递到子进程的参数。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">options</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-childprocessoptions">ChildProcessOptions</a></td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">子进程的启动配置选项。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.10.10.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.10.10.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;number&gt;</td>         <td class="cellrowborder" width="50%">Promise对象，返回子进程pid。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-ability">元能力子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.10.13.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.10.13.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1.Mandatory parameters are left unspecified; 2.Incorrect parameter types; 3.Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported. Failed to call the API due to limited device capabilities.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000050</td>         <td class="cellrowborder" width="50%">Internal error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000061</td>         <td class="cellrowborder" width="50%">Operation not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000062</td>         <td class="cellrowborder" width="50%">The number of child processes exceeds the upper limit.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <p>子进程部分，详见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/capi_nativechildprocess_development_guideline#创建支持参数传递的native子进程" target="_blank">Native子进程开发指导（C/C++）- 创建支持参数传递的Native子进程</a>：</p>     <div _ngcontent-pkn-c106="" class="highlight-div"><div _ngcontent-pkn-c106="" class="highlight-div-header"><div _ngcontent-pkn-c106="" class="highlight-div-header-left"><div _ngcontent-pkn-c106="" class="handle-button expand-button"><div _ngcontent-pkn-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pkn-c106="" class="highlight-div-header-right"><div _ngcontent-pkn-c106="" class="handle-button ai-button"></div><div _ngcontent-pkn-c106="" class="handle-button line-button"><div _ngcontent-pkn-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pkn-c106="" class="handle-button theme-button"><div _ngcontent-pkn-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pkn-c106="" class="handle-button copy-button"><div _ngcontent-pkn-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pkn-c106="" class="highlight-scroll-div"><pre class="prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;AbilityKit/native_child_process.h&gt;</span></span></li><li>
</li><li><span class="hljs-keyword">extern</span> <span class="hljs-string">"C"</span> {</li><li>
</li><li><span class="hljs-comment">/**</span></li><li><span class="hljs-comment"> * 子进程的入口函数，实现子进程的业务逻辑</span></li><li><span class="hljs-comment"> * 函数名称可以自定义，在主进程调用OH_Ability_StartNativeChildProcess方法时指定，此示例中为Main</span></li><li><span class="hljs-comment"> * 函数返回后子进程退出</span></li><li><span class="hljs-comment"> */</span></li><li><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">Main</span><span class="hljs-params">(NativeChildProcess_Args args)</span></span></li><li><span class="hljs-function"></span>{</li><li>    <span class="hljs-comment">// 获取传入的entryPrams</span></li><li>    <span class="hljs-type">char</span> *entryParams = args.entryParams;</li><li>    <span class="hljs-comment">// 获取传入的fd列表，对应ChildProcessArgs中的args.fds</span></li><li>    NativeChildProcess_Fd *current = args.fdList.head;</li><li>    <span class="hljs-keyword">while</span> (current != <span class="hljs-literal">nullptr</span>) {</li><li>        <span class="hljs-type">char</span> *fdName = current-&gt;fdName;</li><li>        <span class="hljs-type">int32_t</span> fd = current-&gt;fd;</li><li>        current = current-&gt;next;</li><li>        <span class="hljs-comment">// 业务逻辑..</span></li><li>    }</li><li>}</li><li>} <span class="hljs-comment">// extern "C"</span></li></ol></pre></div></div>     <p>主进程部分，示例中的context的获取方式请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/uiability-usage#获取uiability的上下文信息" target="_blank">获取UIAbility的上下文信息</a>：</p>     <div _ngcontent-pkn-c106="" class="highlight-div"><div _ngcontent-pkn-c106="" class="highlight-div-header"><div _ngcontent-pkn-c106="" class="highlight-div-header-left"><div _ngcontent-pkn-c106="" class="handle-button expand-button"><div _ngcontent-pkn-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pkn-c106="" class="highlight-div-header-right"><div _ngcontent-pkn-c106="" class="handle-button ai-button"></div><div _ngcontent-pkn-c106="" class="handle-button line-button"><div _ngcontent-pkn-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pkn-c106="" class="handle-button theme-button"><div _ngcontent-pkn-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pkn-c106="" class="handle-button copy-button"><div _ngcontent-pkn-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pkn-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 主进程：</span></li><li><span class="hljs-comment">// 使用childProcessManager.startNativeChildProcess方法启动子进程:</span></li><li><span class="hljs-keyword">import</span> { common, <span class="hljs-title class_">ChildProcessArgs</span>, <span class="hljs-title class_">ChildProcessOptions</span>, childProcessManager } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { fileIo } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.CoreFileKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Row</span>() {</li><li>      <span class="hljs-title class_">Column</span>() {</li><li>        <span class="hljs-title class_">Text</span>(<span class="hljs-string">'Click'</span>)</li><li>          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">30</span>)</li><li>          .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-keyword">try</span> {</li><li>              <span class="hljs-keyword">let</span> context = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li>              <span class="hljs-keyword">let</span> path = context.<span class="hljs-property">filesDir</span> + <span class="hljs-string">"/test.txt"</span>;</li><li>              <span class="hljs-keyword">let</span> file = fileIo.<span class="hljs-title function_">openSync</span>(path, fileIo.<span class="hljs-property">OpenMode</span>.<span class="hljs-property">READ_ONLY</span> | fileIo.<span class="hljs-property">OpenMode</span>.<span class="hljs-property">CREATE</span>);</li><li>              <span class="hljs-keyword">let</span> <span class="hljs-attr">args</span>: <span class="hljs-title class_">ChildProcessArgs</span> = {</li><li>                <span class="hljs-attr">entryParams</span>: <span class="hljs-string">"testParam"</span>,</li><li>                <span class="hljs-attr">fds</span>: {</li><li>                  <span class="hljs-string">"key1"</span>: file.<span class="hljs-property">fd</span></li><li>                }</li><li>              };</li><li>              <span class="hljs-keyword">let</span> <span class="hljs-attr">options</span>: <span class="hljs-title class_">ChildProcessOptions</span> = {</li><li>                <span class="hljs-attr">isolationMode</span>: <span class="hljs-literal">false</span></li><li>              };</li><li>              childProcessManager.<span class="hljs-title function_">startNativeChildProcess</span>(<span class="hljs-string">"libentry.so:Main"</span>, args, options)</li><li>                .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">pid</span>) =&gt;</span> {</li><li>                  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`startChildProcess success, pid: <span class="hljs-subst">${pid}</span>`</span>);</li><li>                })</li><li>                .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>                  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`startChildProcess business error, errorCode: <span class="hljs-subst">${err.code}</span>, errorMsg:<span class="hljs-subst">${err.message}</span>`</span>);</li><li>                })</li><li>            } <span class="hljs-keyword">catch</span> (err) {</li><li>              <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`startChildProcess error, errorCode: <span class="hljs-subst">${err.code}</span>, errorMsg:<span class="hljs-subst">${err.message}</span>`</span>);</li><li>            }</li><li>          });</li><li>      }</li><li>      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    }</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>   </div>   <div></div></div>