<h1 _ngcontent-ruc-c119="" class="doc-title ng-star-inserted" title="@ohos.arkui.Prefetcher (Prefetching)"> @ohos.arkui.Prefetcher (Prefetching) </h1>

<div _ngcontent-ruc-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div><p>配合LazyForEach，为List、Grid、WaterFlow和Swiper等容器组件滑动浏览时提供内容预加载能力，提升用户浏览体验。</p> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"> <p> 本模块首批接口从API version 12开始支持。后续版本的新增接口，采用上角标单独标记接口的起始版本。</p>  </div></div></div>  <div class="tiledSection"><h2 id="导入模块" device-type="phone,2in1,tablet,wearable,tv">导入模块<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="导入模块" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><div _ngcontent-ruc-c106="" class="highlight-div"><div _ngcontent-ruc-c106="" class="highlight-div-header"><div _ngcontent-ruc-c106="" class="highlight-div-header-left"><div _ngcontent-ruc-c106="" class="handle-button expand-button"><div _ngcontent-ruc-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ruc-c106="" class="highlight-div-header-right"><div _ngcontent-ruc-c106="" class="handle-button ai-button"></div><div _ngcontent-ruc-c106="" class="handle-button line-button"><div _ngcontent-ruc-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ruc-c106="" class="handle-button theme-button"><div _ngcontent-ruc-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ruc-c106="" class="handle-button copy-button"><div _ngcontent-ruc-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ruc-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BasicPrefetcher</span>, <span class="hljs-title class_">IDataSourcePrefetching</span>, <span class="hljs-title class_">IPrefetcher</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span>;</li></ol></pre></div></div> </div>  <div class="tiledSection"><h2 id="iprefetcher" device-type="phone,2in1,tablet,wearable,tv">IPrefetcher<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="iprefetcher" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>实现此接口以提供预取能力。</p> <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong> SystemCapability.ArkUI.ArkUI.Full</p> </div>  <div class="tiledSection"><h3 id="setdatasource" device-type="phone,2in1,tablet,wearable,tv" class="firsth2">setDataSource<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="setdatasource" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>setDataSource(dataSource: IDataSourcePrefetching): void;</p> <p>设置支持预取的DataSource以绑定到Prefetcher。</p> <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong> SystemCapability.ArkUI.ArkUI.Full</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.5.7.1.5.1.1" width="25%">参数名</th> <th align="left" class="cellrowborder" id="mcps1.3.5.7.1.5.1.2" width="25%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.5.7.1.5.1.3" width="25%">必填</th> <th align="left" class="cellrowborder" id="mcps1.3.5.7.1.5.1.4" width="25%">说明</th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="25%">dataSource</td> <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-arkui-prefetcher#idatasourceprefetching">IDataSourcePrefetching</a></td> <td class="cellrowborder" width="25%">是</td> <td class="cellrowborder" width="25%">支持预取能力的数据源。</td> </tr>  </tbody></table></div> </div> <div _ngcontent-ruc-c106="" class="highlight-div"><div _ngcontent-ruc-c106="" class="highlight-div-header"><div _ngcontent-ruc-c106="" class="highlight-div-header-left"><div _ngcontent-ruc-c106="" class="handle-button expand-button"><div _ngcontent-ruc-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ruc-c106="" class="highlight-div-header-right"><div _ngcontent-ruc-c106="" class="handle-button ai-button"></div><div _ngcontent-ruc-c106="" class="handle-button line-button"><div _ngcontent-ruc-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ruc-c106="" class="handle-button theme-button"><div _ngcontent-ruc-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ruc-c106="" class="handle-button copy-button"><div _ngcontent-ruc-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ruc-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyPrefetcher</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">IPrefetcher</span> {</li><li>  <span class="hljs-keyword">private</span> dataSource?: <span class="hljs-title class_">IDataSourcePrefetching</span>;</li><li>
</li><li>  <span class="hljs-title function_">setDataSource</span>(<span class="hljs-attr">dataSource</span>: <span class="hljs-title class_">IDataSourcePrefetching</span>): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">dataSource</span> = dataSource;</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">visibleAreaChanged</span>(<span class="hljs-attr">minVisible</span>: <span class="hljs-built_in">number</span>, <span class="hljs-attr">maxVisible</span>: <span class="hljs-built_in">number</span>): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">dataSource</span>?.<span class="hljs-title function_">prefetch</span>(minVisible);</li><li>  }</li><li>}</li></ol></pre></div></div> </div>  <div class="tiledSection"><h3 id="visibleareachanged" device-type="phone,2in1,tablet,wearable,tv">visibleAreaChanged<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="visibleareachanged" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>visibleAreaChanged(minVisible: number, maxVisible: number): void;</p> <p>当可见区域边界发生改变时调用此方法。支持与List、Grid、WaterFlow和Swiper组件配合使用。</p> <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong> SystemCapability.ArkUI.ArkUI.Full</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.6.7.1.5.1.1" width="25%">参数名</th> <th align="left" class="cellrowborder" id="mcps1.3.6.7.1.5.1.2" width="25%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.6.7.1.5.1.3" width="25%">必填</th> <th align="left" class="cellrowborder" id="mcps1.3.6.7.1.5.1.4" width="25%">说明</th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="25%">minVisible</td> <td class="cellrowborder" width="25%">number</td> <td class="cellrowborder" width="25%">是</td> <td class="cellrowborder" width="25%">列表可见区域的上界。</td> </tr> <tr><td class="cellrowborder" width="25%">maxVisible</td> <td class="cellrowborder" width="25%">number</td> <td class="cellrowborder" width="25%">是</td> <td class="cellrowborder" width="25%">列表可见区域的下界。</td> </tr>  </tbody></table></div> </div> <div _ngcontent-ruc-c106="" class="highlight-div"><div _ngcontent-ruc-c106="" class="highlight-div-header"><div _ngcontent-ruc-c106="" class="highlight-div-header-left"><div _ngcontent-ruc-c106="" class="handle-button expand-button"><div _ngcontent-ruc-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ruc-c106="" class="highlight-div-header-right"><div _ngcontent-ruc-c106="" class="handle-button ai-button"></div><div _ngcontent-ruc-c106="" class="handle-button line-button"><div _ngcontent-ruc-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ruc-c106="" class="handle-button theme-button"><div _ngcontent-ruc-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ruc-c106="" class="handle-button copy-button"><div _ngcontent-ruc-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ruc-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyPrefetcher</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">IPrefetcher</span> {</li><li>  <span class="hljs-keyword">private</span> dataSource?: <span class="hljs-title class_">IDataSourcePrefetching</span>;</li><li>
</li><li>  <span class="hljs-title function_">setDataSource</span>(<span class="hljs-attr">dataSource</span>: <span class="hljs-title class_">IDataSourcePrefetching</span>): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">dataSource</span> = dataSource;</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">visibleAreaChanged</span>(<span class="hljs-attr">minVisible</span>: <span class="hljs-built_in">number</span>, <span class="hljs-attr">maxVisible</span>: <span class="hljs-built_in">number</span>): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">dataSource</span>?.<span class="hljs-title function_">prefetch</span>(minVisible);</li><li>  }</li><li>}</li></ol></pre></div></div> </div>  <div class="tiledSection"><h2 id="basicprefetcher" device-type="phone,2in1,tablet,wearable,tv">BasicPrefetcher<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="basicprefetcher" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>BasicPrefetcher是IPrefetcher的基础实现。它提供了一种智能数据预取算法，以根据屏幕上可见区域的实时变化和预取持续时间的变化来决定应预取哪些数据项。它还可以根据用户的滚动操作来确定哪些预取请求应该被取消。</p> <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong> SystemCapability.ArkUI.ArkUI.Full</p> </div>  <div class="tiledSection"><h3 id="constructor" device-type="phone,2in1,tablet,wearable,tv" class="firsth2">constructor<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="constructor" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>constructor(dataSource?: IDataSourcePrefetching);</p> <p>传入支持预取的DataSource以绑定到Prefetcher。</p> <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong> SystemCapability.ArkUI.ArkUI.Full</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.8.7.1.5.1.1" width="25%">参数名</th> <th align="left" class="cellrowborder" id="mcps1.3.8.7.1.5.1.2" width="25%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.8.7.1.5.1.3" width="25%">必填</th> <th align="left" class="cellrowborder" id="mcps1.3.8.7.1.5.1.4" width="25%">说明</th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="25%">dataSource</td> <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-arkui-prefetcher#idatasourceprefetching">IDataSourcePrefetching</a></td> <td class="cellrowborder" width="25%">否</td> <td class="cellrowborder" width="25%">支持预取能力的数据源。</td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h3 id="setdatasource-1" device-type="phone,2in1,tablet,wearable,tv">setDataSource<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="setdatasource-1" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>setDataSource(dataSource: IDataSourcePrefetching): void;</p> <p>设置支持预取的DataSource以绑定到Prefetcher。</p> <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong> SystemCapability.ArkUI.ArkUI.Full</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.9.7.1.5.1.1" width="25%">参数名</th> <th align="left" class="cellrowborder" id="mcps1.3.9.7.1.5.1.2" width="25%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.9.7.1.5.1.3" width="25%">必填</th> <th align="left" class="cellrowborder" id="mcps1.3.9.7.1.5.1.4" width="25%">说明</th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="25%">dataSource</td> <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-arkui-prefetcher#idatasourceprefetching">IDataSourcePrefetching</a></td> <td class="cellrowborder" width="25%">是</td> <td class="cellrowborder" width="25%">支持预取能力的数据源。</td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h3 id="visibleareachanged-1" device-type="phone,2in1,tablet,wearable,tv">visibleAreaChanged<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="visibleareachanged-1" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>visibleAreaChanged(minVisible: number, maxVisible: number): void;</p> <p>当可见区域边界发生改变时调用此方法。支持与List、Grid、WaterFlow和Swiper组件配合使用。</p> <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong> SystemCapability.ArkUI.ArkUI.Full</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.10.7.1.5.1.1" width="25%">参数名</th> <th align="left" class="cellrowborder" id="mcps1.3.10.7.1.5.1.2" width="25%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.10.7.1.5.1.3" width="25%">必填</th> <th align="left" class="cellrowborder" id="mcps1.3.10.7.1.5.1.4" width="25%">说明</th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="25%">minVisible</td> <td class="cellrowborder" width="25%">number</td> <td class="cellrowborder" width="25%">是</td> <td class="cellrowborder" width="25%">列表可见区域的上界。</td> </tr> <tr><td class="cellrowborder" width="25%">maxVisible</td> <td class="cellrowborder" width="25%">number</td> <td class="cellrowborder" width="25%">是</td> <td class="cellrowborder" width="25%">列表可见区域的下界。</td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h2 id="idatasourceprefetching" device-type="phone,2in1,tablet,wearable,tv">IDataSourcePrefetching<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="idatasourceprefetching" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>继承自<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-rendering-control-lazyforeach#idatasource">IDataSource</a>。实现该接口，提供具备预取能力的DataSource。</p> <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong> SystemCapability.ArkUI.ArkUI.Full</p> </div>  <div class="tiledSection"><h3 id="prefetch" device-type="phone,2in1,tablet,wearable,tv" class="firsth2">prefetch<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="prefetch" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>prefetch(index: number): Promise&lt;void&gt; | void;</p> <p>从数据集中预取指定的元素。该方法可以为同步，也可为异步。</p> <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong> SystemCapability.ArkUI.ArkUI.Full</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.12.7.1.5.1.1" width="25%">参数名</th> <th align="left" class="cellrowborder" id="mcps1.3.12.7.1.5.1.2" width="25%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.12.7.1.5.1.3" width="25%">必填</th> <th align="left" class="cellrowborder" id="mcps1.3.12.7.1.5.1.4" width="25%">说明</th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="25%">index</td> <td class="cellrowborder" width="25%">number</td> <td class="cellrowborder" width="25%">是</td> <td class="cellrowborder" width="25%">预取数据项索引值。</td> </tr>  </tbody></table></div> </div> <p><strong>返回值：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.12.9.1.3.1.1" width="50%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.12.9.1.3.1.2" width="50%">说明</th> </tr><tr><td class="cellrowborder" width="50%">Promise&lt;void&gt; | void</td> <td class="cellrowborder" width="50%">异步执行时返回Promise对象，同步执行时无返回值。Promise仅表示操作完成，无实际返回内容。</td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h3 id="cancel" device-type="phone,2in1,tablet,wearable,tv">cancel<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="cancel" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>cancel?(index: number): Promise&lt;void&gt; | void;</p> <p>取消从数据集中预取指定的元素。该方法可以为同步，也可为异步。</p> <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong> SystemCapability.ArkUI.ArkUI.Full</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.13.7.1.5.1.1" width="25%">参数名</th> <th align="left" class="cellrowborder" id="mcps1.3.13.7.1.5.1.2" width="25%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.13.7.1.5.1.3" width="25%">必填</th> <th align="left" class="cellrowborder" id="mcps1.3.13.7.1.5.1.4" width="25%">说明</th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="25%">index</td> <td class="cellrowborder" width="25%">number</td> <td class="cellrowborder" width="25%">是</td> <td class="cellrowborder" width="25%">取消预取数据项索引值。</td> </tr>  </tbody></table></div> </div> <p><strong>返回值：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.13.9.1.3.1.1" width="50%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.13.9.1.3.1.2" width="50%">说明</th> </tr><tr><td class="cellrowborder" width="50%">Promise&lt;void&gt; | void</td> <td class="cellrowborder" width="50%">异步执行时返回Promise对象，同步执行时无返回值。Promise仅表示操作完成，无实际返回内容。</td> </tr>  </tbody></table></div> </div> <p>列表内容移出屏幕时（比如列表快速滑动场景下），预取算法判断屏幕以外的Item可以被取消预取时，该方法即会被调用。例如，如果HTTP框架支持请求取消，则可以在此处取消在prefetch中发起的网络请求。</p> </div>  <div class="tiledSection"><h2 id="示例" device-type="phone,2in1,tablet,wearable,tv">示例<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="示例" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>下面示例展示了Prefetcher的预加载能力。该示例采用分页的方式，配合LazyForEach实现懒加载效果，并通过添加延时来模拟加载过程。</p> <div _ngcontent-ruc-c106="" class="highlight-div"><div _ngcontent-ruc-c106="" class="highlight-div-header"><div _ngcontent-ruc-c106="" class="highlight-div-header-left"><div _ngcontent-ruc-c106="" class="handle-button expand-button"><div _ngcontent-ruc-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ruc-c106="" class="highlight-div-header-right"><div _ngcontent-ruc-c106="" class="handle-button ai-button"></div><div _ngcontent-ruc-c106="" class="handle-button line-button"><div _ngcontent-ruc-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ruc-c106="" class="handle-button theme-button"><div _ngcontent-ruc-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ruc-c106="" class="handle-button copy-button"><div _ngcontent-ruc-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ruc-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BasicPrefetcher</span>, <span class="hljs-title class_">IDataSourcePrefetching</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span>;</li><li><span class="hljs-keyword">import</span> { image } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ImageKit'</span>;</li><li>
</li><li><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">ITEMS_ON_SCREEN</span> = <span class="hljs-number">8</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">PrefetcherDemoComponent</span> {</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">page</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">1</span>;</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">pageSize</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">50</span>;</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">breakPoint</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">25</span>;</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> <span class="hljs-attr">fetchDelayMs</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">500</span>;</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> dataSource = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyDataSource</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">page</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">pageSize</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">fetchDelayMs</span>);</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> prefetcher = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BasicPrefetcher</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">dataSource</span>);</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">List</span>() {</li><li>        <span class="hljs-title class_">LazyForEach</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">dataSource</span>, <span class="hljs-function">(<span class="hljs-params">item: PictureItem, index: <span class="hljs-built_in">number</span></span>) =&gt;</span> {</li><li>          <span class="hljs-title class_">ListItem</span>() {</li><li>            <span class="hljs-title class_">PictureItemComponent</span>({ <span class="hljs-attr">info</span>: item })</li><li>              .<span class="hljs-title function_">height</span>(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-number">100</span> / ITEMS_ON_SCREEN}</span>%`</span>)</li><li>          }</li><li>          .<span class="hljs-title function_">onAppear</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-keyword">if</span> (index &gt;= <span class="hljs-variable language_">this</span>.<span class="hljs-property">breakPoint</span>) {</li><li>              <span class="hljs-variable language_">this</span>.<span class="hljs-property">dataSource</span>.<span class="hljs-title function_">getHttpData</span>(++<span class="hljs-variable language_">this</span>.<span class="hljs-property">page</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">pageSize</span>);</li><li>              <span class="hljs-variable language_">this</span>.<span class="hljs-property">breakPoint</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">dataSource</span>.<span class="hljs-title function_">totalCount</span>() - <span class="hljs-variable language_">this</span>.<span class="hljs-property">pageSize</span> / <span class="hljs-number">2</span>;</li><li>            }</li><li>          })</li><li>        }, <span class="hljs-function">(<span class="hljs-params">item: PictureItem</span>) =&gt;</span> item.<span class="hljs-property">title</span>)</li><li>      }</li><li>      .<span class="hljs-title function_">onScrollIndex</span>(<span class="hljs-function">(<span class="hljs-params">start: <span class="hljs-built_in">number</span>, end: <span class="hljs-built_in">number</span></span>) =&gt;</span> {</li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">prefetcher</span>.<span class="hljs-title function_">visibleAreaChanged</span>(start, end);</li><li>      })</li><li>    }</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">PictureItemComponent</span> {</li><li>  <span class="hljs-meta">@ObjectLink</span> <span class="hljs-attr">info</span>: <span class="hljs-title class_">PictureItem</span>;</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Row</span>() {</li><li>      <span class="hljs-title class_">Image</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">info</span>.<span class="hljs-property">imagePixelMap</span>)</li><li>        .<span class="hljs-title function_">objectFit</span>(<span class="hljs-title class_">ImageFit</span>.<span class="hljs-property">Contain</span>)</li><li>        .<span class="hljs-title function_">width</span>(<span class="hljs-string">'40%'</span>)</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">info</span>.<span class="hljs-property">title</span>)</li><li>        .<span class="hljs-title function_">width</span>(<span class="hljs-string">'60%'</span>)</li><li>    }</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-meta">@Observed</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">PictureItem</span> {</li><li>  <span class="hljs-keyword">readonly</span> <span class="hljs-attr">color</span>: <span class="hljs-built_in">number</span>;</li><li>  <span class="hljs-attr">title</span>: <span class="hljs-built_in">string</span>;</li><li>  <span class="hljs-attr">imagePixelMap</span>: image.<span class="hljs-property">PixelMap</span> | <span class="hljs-literal">undefined</span>;</li><li>  <span class="hljs-attr">key</span>: <span class="hljs-built_in">string</span>;</li><li>
</li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">color: <span class="hljs-built_in">number</span>, title: <span class="hljs-built_in">string</span></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">color</span> = color;</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">title</span> = title;</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">key</span> = title;</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-keyword">type</span> <span class="hljs-title class_">ItemIndex</span> = <span class="hljs-built_in">number</span>;</li><li><span class="hljs-keyword">type</span> <span class="hljs-title class_">TimerId</span> = <span class="hljs-built_in">number</span>;</li><li>
</li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyDataSource</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">IDataSourcePrefetching</span> {</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> <span class="hljs-attr">items</span>: <span class="hljs-title class_">PictureItem</span>[];</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> <span class="hljs-attr">fetchDelayMs</span>: <span class="hljs-built_in">number</span>;</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> <span class="hljs-attr">fetches</span>: <span class="hljs-title class_">Map</span>&lt;<span class="hljs-title class_">ItemIndex</span>, <span class="hljs-title class_">TimerId</span>&gt; = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> <span class="hljs-attr">listeners</span>: <span class="hljs-title class_">DataChangeListener</span>[] = [];</li><li>
</li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">pageNum: <span class="hljs-built_in">number</span>, pageSize: <span class="hljs-built_in">number</span>, fetchDelayMs: <span class="hljs-built_in">number</span></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span> = [];</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">fetchDelayMs</span> = fetchDelayMs;</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getHttpData</span>(pageNum, pageSize);</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">async</span> <span class="hljs-title function_">prefetch</span>(<span class="hljs-attr">index</span>: <span class="hljs-built_in">number</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {</li><li>    <span class="hljs-keyword">const</span> item = <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span>[index];</li><li>    <span class="hljs-keyword">if</span> (item.<span class="hljs-property">imagePixelMap</span>) {</li><li>      <span class="hljs-keyword">return</span>;</li><li>    }</li><li>
</li><li>    <span class="hljs-comment">// 模拟高耗时操作</span></li><li>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt;(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> {</li><li>      <span class="hljs-keyword">const</span> timeoutId = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">async</span> () =&gt; {</li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">fetches</span>.<span class="hljs-title function_">delete</span>(index);</li><li>        <span class="hljs-keyword">const</span> bitmap = <span class="hljs-title function_">create10x10Bitmap</span>(item.<span class="hljs-property">color</span>);</li><li>        <span class="hljs-keyword">const</span> <span class="hljs-attr">imageSource</span>: image.<span class="hljs-property">ImageSource</span> = image.<span class="hljs-title function_">createImageSource</span>(bitmap);</li><li>        item.<span class="hljs-property">imagePixelMap</span> = <span class="hljs-keyword">await</span> imageSource.<span class="hljs-title function_">createPixelMap</span>();</li><li>        <span class="hljs-title function_">resolve</span>();</li><li>      }, <span class="hljs-variable language_">this</span>.<span class="hljs-property">fetchDelayMs</span>);</li><li>
</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">fetches</span>.<span class="hljs-title function_">set</span>(index, timeoutId)</li><li>    });</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">cancel</span>(<span class="hljs-attr">index</span>: <span class="hljs-built_in">number</span>): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-keyword">const</span> timerId = <span class="hljs-variable language_">this</span>.<span class="hljs-property">fetches</span>.<span class="hljs-title function_">get</span>(index);</li><li>    <span class="hljs-keyword">if</span> (timerId) {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">fetches</span>.<span class="hljs-title function_">delete</span>(index);</li><li>      <span class="hljs-built_in">clearTimeout</span>(timerId);</li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-comment">// 模拟分页方式加载数据</span></li><li>  <span class="hljs-title function_">getHttpData</span>(<span class="hljs-attr">pageNum</span>: <span class="hljs-built_in">number</span>, <span class="hljs-attr">pageSize</span>:<span class="hljs-built_in">number</span>): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-keyword">const</span> <span class="hljs-attr">newItems</span>: <span class="hljs-title class_">PictureItem</span>[] = [];</li><li>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = (pageNum - <span class="hljs-number">1</span>) * pageSize; i &lt; pageNum * pageSize; i++) {</li><li>      <span class="hljs-keyword">const</span> item = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PictureItem</span>(<span class="hljs-title function_">getRandomColor</span>(), <span class="hljs-string">`Item <span class="hljs-subst">${i}</span>`</span>);</li><li>      newItems.<span class="hljs-title function_">push</span>(item);</li><li>    }</li><li>    <span class="hljs-keyword">const</span> startIndex = <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span>.<span class="hljs-property">length</span>;</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span>.<span class="hljs-title function_">splice</span>(startIndex, <span class="hljs-number">0</span>, ...newItems);</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">notifyBatchUpdate</span>([</li><li>      {</li><li>        <span class="hljs-attr">type</span>: <span class="hljs-title class_">DataOperationType</span>.<span class="hljs-property">ADD</span>,</li><li>        <span class="hljs-attr">index</span>: startIndex,</li><li>        <span class="hljs-attr">count</span>: newItems.<span class="hljs-property">length</span>,</li><li>        <span class="hljs-attr">key</span>: newItems.<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item.<span class="hljs-property">title</span>)</li><li>      }</li><li>    ]);</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-title function_">notifyBatchUpdate</span>(<span class="hljs-params">operations: DataOperation[]</span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">listener: DataChangeListener</span>) =&gt;</span> {</li><li>      listener.<span class="hljs-title function_">onDatasetChange</span>(operations);</li><li>    });</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">totalCount</span>(): <span class="hljs-built_in">number</span> {</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span>.<span class="hljs-property">length</span>;</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">getData</span>(<span class="hljs-attr">index</span>: <span class="hljs-built_in">number</span>): <span class="hljs-title class_">PictureItem</span> {</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span>[index];</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">registerDataChangeListener</span>(<span class="hljs-attr">listener</span>: <span class="hljs-title class_">DataChangeListener</span>): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>.<span class="hljs-title function_">indexOf</span>(listener) &lt; <span class="hljs-number">0</span>) {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>.<span class="hljs-title function_">push</span>(listener);</li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">unregisterDataChangeListener</span>(<span class="hljs-attr">listener</span>: <span class="hljs-title class_">DataChangeListener</span>): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-keyword">const</span> pos = <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>.<span class="hljs-title function_">indexOf</span>(listener);</li><li>    <span class="hljs-keyword">if</span> (pos &gt;= <span class="hljs-number">0</span>) {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>.<span class="hljs-title function_">splice</span>(pos, <span class="hljs-number">1</span>);</li><li>    }</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">getRandomColor</span>(<span class="hljs-params"></span>): <span class="hljs-built_in">number</span> {</li><li>  <span class="hljs-keyword">const</span> maxColorCode = <span class="hljs-number">256</span>;</li><li>  <span class="hljs-keyword">const</span> r = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * maxColorCode);</li><li>  <span class="hljs-keyword">const</span> g = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * maxColorCode);</li><li>  <span class="hljs-keyword">const</span> b = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * maxColorCode);</li><li>
</li><li>  <span class="hljs-keyword">return</span> (r * <span class="hljs-number">256</span> + g) * <span class="hljs-number">256</span> + b;</li><li>}</li><li>
</li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">create10x10Bitmap</span>(<span class="hljs-params">color: <span class="hljs-built_in">number</span></span>): <span class="hljs-title class_">ArrayBuffer</span> {</li><li>  <span class="hljs-keyword">const</span> height = <span class="hljs-number">10</span>;</li><li>  <span class="hljs-keyword">const</span> width = <span class="hljs-number">10</span>;</li><li>
</li><li>  <span class="hljs-keyword">const</span> fileHeaderLength = <span class="hljs-number">14</span>;</li><li>  <span class="hljs-keyword">const</span> bitmapInfoLength = <span class="hljs-number">40</span>;</li><li>  <span class="hljs-keyword">const</span> headerLength = fileHeaderLength + bitmapInfoLength;</li><li>  <span class="hljs-keyword">const</span> pixelSize = (width * <span class="hljs-number">3</span> + <span class="hljs-number">2</span>) * height;</li><li>
</li><li>  <span class="hljs-keyword">let</span> length = pixelSize + headerLength;</li><li>
</li><li>  <span class="hljs-keyword">const</span> buffer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayBuffer</span>(length);</li><li>  <span class="hljs-keyword">const</span> view16 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint16Array</span>(buffer);</li><li>
</li><li>  view16[<span class="hljs-number">0</span>] = <span class="hljs-number">0x4D42</span>;</li><li>  view16[<span class="hljs-number">1</span>] = length &amp; <span class="hljs-number">0xffff</span>;</li><li>  view16[<span class="hljs-number">2</span>] = length &gt;&gt; <span class="hljs-number">16</span>;</li><li>  view16[<span class="hljs-number">5</span>] = headerLength;</li><li>
</li><li>  <span class="hljs-keyword">let</span> offset = <span class="hljs-number">7</span>;</li><li>  view16[offset++] = bitmapInfoLength &amp; <span class="hljs-number">0xffff</span>;</li><li>  view16[offset++] = bitmapInfoLength &gt;&gt; <span class="hljs-number">16</span>;</li><li>  view16[offset++] = width &amp; <span class="hljs-number">0xffff</span>;</li><li>  view16[offset++] = width &gt;&gt; <span class="hljs-number">16</span>;</li><li>  view16[offset++] = height &amp; <span class="hljs-number">0xffff</span>;</li><li>  view16[offset++] = height &gt;&gt; <span class="hljs-number">16</span>;</li><li>  view16[offset++] = <span class="hljs-number">1</span>;</li><li>  view16[offset++] = <span class="hljs-number">24</span>;</li><li>
</li><li>  <span class="hljs-keyword">const</span> b = color &amp; <span class="hljs-number">0xff</span>;</li><li>  <span class="hljs-keyword">const</span> g = (color &gt;&gt; <span class="hljs-number">8</span>) &amp; <span class="hljs-number">0xff</span>;</li><li>  <span class="hljs-keyword">const</span> r = color &gt;&gt; <span class="hljs-number">16</span>;</li><li>  offset = headerLength;</li><li>  <span class="hljs-keyword">const</span> view8 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(buffer);</li><li>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> y = <span class="hljs-number">0</span>; y &lt; height; y++) {</li><li>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> x = <span class="hljs-number">0</span>; x &lt; width; x++) {</li><li>      view8[offset++] = b;</li><li>      view8[offset++] = g;</li><li>      view8[offset++] = r;</li><li>    }</li><li>    offset += <span class="hljs-number">2</span>;</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">return</span> buffer;</li><li>}</li></ol></pre></div></div> <p>演示效果如下：</p> <p><span><img originheight="722" originwidth="360" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211115625.23436787307485895636307442669430:50001231000000:2800:35AC206128D9530B496B33A07E9E186A194C35CE79857C57D9418E7BFECF557F.gif" width="360" height="722"></span></p> </div>  <div class="tiledSection"><h2 id="补充说明" device-type="phone,2in1,tablet,wearable,tv">补充说明<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="补充说明" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>开发者也可使用HarmonyOS三方库<a href="https://ohpm.openharmony.cn/#/cn/detail/@netteam%2Fprefetcher" target="_blank">@netteam/prefetcher</a>开发预加载功能。该三方库提供了更多的接口，可以更加便捷有效地实现数据预加载。</p> </div> </div> <div></div></div>