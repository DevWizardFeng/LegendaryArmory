<h1 _ngcontent-kra-c119="" class="doc-title ng-star-inserted" title="@ohos.arkui.uiExtension (uiExtension)"> @ohos.arkui.uiExtension (uiExtension) </h1>

<div _ngcontent-kra-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p>用于EmbeddedUIExtensionAbility（或UIExtensionAbility）中获取宿主应用的窗口信息或对应的EmbeddedComponent组件的信息。</p>    <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">      <p>从API version 12开始支持。后续版本如有新增内容，则采用上角标单独标记该内容的起始版本。</p>     </div></div></div>    <div class="tiledSection">     <h2 id="导入模块" device-type="phone,2in1,tablet,wearable,tv">导入模块<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="导入模块" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><div _ngcontent-kra-c106="" class="highlight-div"><div _ngcontent-kra-c106="" class="highlight-div-header"><div _ngcontent-kra-c106="" class="highlight-div-header-left"><div _ngcontent-kra-c106="" class="handle-button expand-button"><div _ngcontent-kra-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kra-c106="" class="highlight-div-header-right"><div _ngcontent-kra-c106="" class="handle-button ai-button"></div><div _ngcontent-kra-c106="" class="handle-button line-button"><div _ngcontent-kra-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kra-c106="" class="handle-button theme-button"><div _ngcontent-kra-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kra-c106="" class="handle-button copy-button"><div _ngcontent-kra-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kra-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { uiExtension } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span>;</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="windowproxy" device-type="phone,2in1,tablet,wearable,tv">WindowProxy<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="windowproxy" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>UIExtension宿主窗代理。</p>    </div>    <div class="tiledSection">     <h3 id="属性" device-type="phone,2in1,tablet,wearable,tv" class="firsth2">属性<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="属性" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p><strong>系统能力：</strong> SystemCapability.ArkUI.ArkUI.Full</p>     <p><strong>元服务API：</strong> 从API version 14开始，该接口支持在元服务中使用</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.5.4.1.6.1.1" width="20%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.5.4.1.6.1.2" width="20%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.5.4.1.6.1.3" width="20%">只读</th>         <th align="left" class="cellrowborder" id="mcps1.3.5.4.1.6.1.4" width="20%">可选</th>         <th align="left" class="cellrowborder" id="mcps1.3.5.4.1.6.1.5" width="20%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">properties<sup>14+</sup></td>         <td class="cellrowborder" width="20%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-arkui-uiextension#windowproxyproperties14">WindowProxyProperties</a></td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">          <p>组件（EmbeddedComponent或UIExtensionComponent）的信息。</p>          <p><strong>约束：</strong> 由于架构约束，不建议在<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiextensionability#onsessioncreate">onSessionCreate</a>阶段同步获取该值，建议在收到<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-arkui-uiextension#onwindowsizechange">on('windowSizeChange')</a>回调之后获取。</p></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h3 id="getwindowavoidarea" device-type="phone,2in1,tablet,wearable,tv">getWindowAvoidArea<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getwindowavoidarea" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>getWindowAvoidArea(type: window.AvoidAreaType): window.AvoidArea</p>     <p>获取宿主应用窗口内容规避的区域；如系统栏区域、刘海屏区域、手势区域、软键盘区域等与宿主窗口内容重叠时，需要宿主窗口内容避让的区域。</p>     <p><strong>系统能力</strong>：SystemCapability.ArkUI.ArkUI.Full</p>     <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.6.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.6.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.6.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.6.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-window-e#avoidareatype7">window.AvoidAreaType</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">表示规避区类型。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.6.9.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.6.9.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-window-i#avoidarea7">window.AvoidArea</a></td>         <td class="cellrowborder" width="50%">宿主窗口内容规避区域。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.6.12.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.6.12.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1. Mandatory parameters are left unspecified; 2.Incorrect parameters types; 3. Parameter verification failed.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-kra-c106="" class="highlight-div"><div _ngcontent-kra-c106="" class="highlight-div-header"><div _ngcontent-kra-c106="" class="highlight-div-header-left"><div _ngcontent-kra-c106="" class="handle-button expand-button"><div _ngcontent-kra-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kra-c106="" class="highlight-div-header-right"><div _ngcontent-kra-c106="" class="handle-button ai-button"></div><div _ngcontent-kra-c106="" class="handle-button line-button"><div _ngcontent-kra-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kra-c106="" class="handle-button theme-button"><div _ngcontent-kra-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kra-c106="" class="handle-button copy-button"><div _ngcontent-kra-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kra-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// ExtensionProvider.ts</span></li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">EmbeddedUIExtensionAbility</span>, <span class="hljs-title class_">UIExtensionContentSession</span>, <span class="hljs-title class_">Want</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-variable language_">window</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">EmbeddedUIExtensionAbility</span> {</li><li>  <span class="hljs-title function_">onSessionCreate</span>(<span class="hljs-params">want: Want, session: UIExtensionContentSession</span>) {</li><li>    <span class="hljs-keyword">const</span> extensionWindow = session.<span class="hljs-title function_">getUIExtensionWindowProxy</span>();</li><li>    <span class="hljs-comment">// 获取宿主应用窗口的避让信息</span></li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">avoidArea</span>: <span class="hljs-variable language_">window</span>.<span class="hljs-property">AvoidArea</span> | <span class="hljs-literal">undefined</span> = extensionWindow?.<span class="hljs-title function_">getWindowAvoidArea</span>(<span class="hljs-variable language_">window</span>.<span class="hljs-property">AvoidAreaType</span>.<span class="hljs-property">TYPE_SYSTEM</span>);</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`avoidArea: <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(avoidArea)}</span>`</span>);</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="onavoidareachange" device-type="phone,2in1,tablet,wearable,tv">on('avoidAreaChange')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onavoidareachange" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>on(type: 'avoidAreaChange', callback: Callback&lt;AvoidAreaInfo&gt;): void</p>     <p>注册系统规避区变化的监听。</p>     <p><strong>系统能力</strong>：SystemCapability.ArkUI.ArkUI.Full</p>     <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.7.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.7.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.7.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.7.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">监听的事件类型，固定为'avoidAreaChange'，即系统规避区变化事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-base#callback">Callback</a>&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-arkui-uiextension#avoidareainfo">AvoidAreaInfo</a>&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数：入参用于接收当前规避区的信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.7.10.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.7.10.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1. Mandatory parameters are left unspecified; 2.Incorrect parameters types; 3. Parameter verification failed.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-kra-c106="" class="highlight-div"><div _ngcontent-kra-c106="" class="highlight-div-header"><div _ngcontent-kra-c106="" class="highlight-div-header-left"><div _ngcontent-kra-c106="" class="handle-button expand-button"><div _ngcontent-kra-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kra-c106="" class="highlight-div-header-right"><div _ngcontent-kra-c106="" class="handle-button ai-button"></div><div _ngcontent-kra-c106="" class="handle-button line-button"><div _ngcontent-kra-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kra-c106="" class="handle-button theme-button"><div _ngcontent-kra-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kra-c106="" class="handle-button copy-button"><div _ngcontent-kra-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kra-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// ExtensionProvider.ts</span></li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">EmbeddedUIExtensionAbility</span>, <span class="hljs-title class_">UIExtensionContentSession</span>, <span class="hljs-title class_">Want</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { uiExtension } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">EmbeddedUIExtensionAbility</span> {</li><li>  <span class="hljs-title function_">onSessionCreate</span>(<span class="hljs-params">want: Want, session: UIExtensionContentSession</span>) {</li><li>    <span class="hljs-keyword">const</span> extensionWindow = session.<span class="hljs-title function_">getUIExtensionWindowProxy</span>();</li><li>    <span class="hljs-comment">// 注册避让区变化的监听</span></li><li>    extensionWindow.<span class="hljs-title function_">on</span>(<span class="hljs-string">'avoidAreaChange'</span>, <span class="hljs-function">(<span class="hljs-params">info: uiExtension.AvoidAreaInfo</span>) =&gt;</span> {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`The avoid area of the host window is: <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(info.area)}</span>.`</span>);</li><li>    });</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="offavoidareachange" device-type="phone,2in1,tablet,wearable,tv">off('avoidAreaChange')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="offavoidareachange" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>off(type: 'avoidAreaChange', callback?: Callback&lt;AvoidAreaInfo&gt;): void</p>     <p>注销系统规避区变化的监听。</p>     <p><strong>系统能力</strong>：SystemCapability.ArkUI.ArkUI.Full</p>     <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.8.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.8.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.8.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.8.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">注销的事件类型，固定为'avoidAreaChange'，即系统规避区变化事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-base#callback">Callback</a>&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-arkui-uiextension#avoidareainfo">AvoidAreaInfo</a>&gt;</td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">回调函数：如果传入该参数，则关闭该监听。如果未传入参数，则关闭所有系统规避区变化的监听。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.8.10.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.8.10.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1. Mandatory parameters are left unspecified; 2.Incorrect parameters types; 3. Parameter verification failed.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-kra-c106="" class="highlight-div"><div _ngcontent-kra-c106="" class="highlight-div-header"><div _ngcontent-kra-c106="" class="highlight-div-header-left"><div _ngcontent-kra-c106="" class="handle-button expand-button"><div _ngcontent-kra-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kra-c106="" class="highlight-div-header-right"><div _ngcontent-kra-c106="" class="handle-button ai-button"></div><div _ngcontent-kra-c106="" class="handle-button line-button"><div _ngcontent-kra-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kra-c106="" class="handle-button theme-button"><div _ngcontent-kra-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kra-c106="" class="handle-button copy-button"><div _ngcontent-kra-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kra-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// ExtensionProvider.ts</span></li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">EmbeddedUIExtensionAbility</span>, <span class="hljs-title class_">UIExtensionContentSession</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">EmbeddedUIExtensionAbility</span> {</li><li>  <span class="hljs-title function_">onSessionDestroy</span>(<span class="hljs-params">session: UIExtensionContentSession</span>) {</li><li>    <span class="hljs-keyword">const</span> extensionWindow = session.<span class="hljs-title function_">getUIExtensionWindowProxy</span>();</li><li>    <span class="hljs-comment">// 注销所有避让区变化的监听</span></li><li>    extensionWindow.<span class="hljs-title function_">off</span>(<span class="hljs-string">'avoidAreaChange'</span>);</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="onwindowsizechange" device-type="phone,2in1,tablet,wearable,tv">on('windowSizeChange')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onwindowsizechange" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>on(type: 'windowSizeChange', callback: Callback&lt;window.Size&gt;): void</p>     <p>注册宿主应用窗口尺寸变化的监听。</p>     <p><strong>系统能力</strong>：SystemCapability.ArkUI.ArkUI.Full</p>     <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.9.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.9.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.9.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.9.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">监听的事件类型，固定为'windowSizeChange'，即窗口尺寸变化事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-base#callback">Callback</a>&lt;<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-window-i#size7">window.Size</a>&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数：入参用于接收当前窗口的尺寸。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.9.10.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.9.10.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1. Mandatory parameters are left unspecified; 2.Incorrect parameters types; 3. Parameter verification failed.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-kra-c106="" class="highlight-div"><div _ngcontent-kra-c106="" class="highlight-div-header"><div _ngcontent-kra-c106="" class="highlight-div-header-left"><div _ngcontent-kra-c106="" class="handle-button expand-button"><div _ngcontent-kra-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kra-c106="" class="highlight-div-header-right"><div _ngcontent-kra-c106="" class="handle-button ai-button"></div><div _ngcontent-kra-c106="" class="handle-button line-button"><div _ngcontent-kra-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kra-c106="" class="handle-button theme-button"><div _ngcontent-kra-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kra-c106="" class="handle-button copy-button"><div _ngcontent-kra-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kra-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// ExtensionProvider.ts</span></li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">EmbeddedUIExtensionAbility</span>, <span class="hljs-title class_">UIExtensionContentSession</span>, <span class="hljs-title class_">Want</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-variable language_">window</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">EmbeddedUIExtensionAbility</span> {</li><li>  <span class="hljs-title function_">onSessionCreate</span>(<span class="hljs-params">want: Want, session: UIExtensionContentSession</span>) {</li><li>    <span class="hljs-keyword">const</span> extensionWindow = session.<span class="hljs-title function_">getUIExtensionWindowProxy</span>();</li><li>    <span class="hljs-comment">// 注册宿主应用窗口大小变化的监听</span></li><li>    extensionWindow.<span class="hljs-title function_">on</span>(<span class="hljs-string">'windowSizeChange'</span>, <span class="hljs-function">(<span class="hljs-params">size: <span class="hljs-variable language_">window</span>.Size</span>) =&gt;</span> {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`The avoid area of the host window is: <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(size)}</span>.`</span>);</li><li>    });</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="offwindowsizechange" device-type="phone,2in1,tablet,wearable,tv">off('windowSizeChange')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="offwindowsizechange" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>off(type: 'windowSizeChange', callback?: Callback&lt;window.Size&gt;): void</p>     <p>注销宿主应用窗口尺寸变化的监听。</p>     <p><strong>系统能力</strong>：SystemCapability.ArkUI.ArkUI.Full</p>     <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.10.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.10.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.10.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.10.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">注销的事件类型，固定值：'windowSizeChange'，即窗口尺寸变化事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-base#callback">Callback</a>&lt;<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-window-i#size7">window.Size</a>&gt;</td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">回调函数。返回当前的组件（EmbeddedComponent或UIExtensionComponent）尺寸。如果传入该参数，则关闭该监听。如果未传入参数，则关闭组件（EmbeddedComponent或UIExtensionComponent）尺寸变化的监听。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.10.10.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.10.10.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1. Mandatory parameters are left unspecified; 2.Incorrect parameters types; 3. Parameter verification failed.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-kra-c106="" class="highlight-div"><div _ngcontent-kra-c106="" class="highlight-div-header"><div _ngcontent-kra-c106="" class="highlight-div-header-left"><div _ngcontent-kra-c106="" class="handle-button expand-button"><div _ngcontent-kra-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kra-c106="" class="highlight-div-header-right"><div _ngcontent-kra-c106="" class="handle-button ai-button"></div><div _ngcontent-kra-c106="" class="handle-button line-button"><div _ngcontent-kra-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kra-c106="" class="handle-button theme-button"><div _ngcontent-kra-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kra-c106="" class="handle-button copy-button"><div _ngcontent-kra-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kra-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// ExtensionProvider.ts</span></li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">EmbeddedUIExtensionAbility</span>, <span class="hljs-title class_">UIExtensionContentSession</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">EmbeddedUIExtensionAbility</span> {</li><li>  <span class="hljs-title function_">onSessionDestroy</span>(<span class="hljs-params">session: UIExtensionContentSession</span>) {</li><li>    <span class="hljs-keyword">const</span> extensionWindow = session.<span class="hljs-title function_">getUIExtensionWindowProxy</span>();</li><li>    <span class="hljs-comment">// 注销宿主应用窗口大小变化的监听</span></li><li>    extensionWindow.<span class="hljs-title function_">off</span>(<span class="hljs-string">'windowSizeChange'</span>);</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="onrectchange14" device-type="phone,2in1,tablet,wearable,tv">on('rectChange')<sup>14+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onrectchange14" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>on(type: 'rectChange', reasons: number, callback: Callback&lt;RectChangeOptions&gt;): void</p>     <p>注册组件（EmbeddedComponent或UIExtensionComponent）位置及尺寸变化的监听。</p>     <p><strong>系统能力：</strong> SystemCapability.ArkUI.ArkUI.Full</p>     <p><strong>元服务API：</strong> 从API version 14开始，该接口支持在元服务中使用。</p>     <p><strong>设备行为差异：</strong> 该接口在2in1设备中可正常调用，在其他设备中返回801错误码。</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.11.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.11.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.11.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.11.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">监听事件，固定为'rectChange'，即组件（EmbeddedComponent或UIExtensionComponent）矩形变化事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">reasons</td>         <td class="cellrowborder" width="25%">number</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">触发组件（EmbeddedComponent或UIExtensionComponent）位置及尺寸变化的原因，具体取值可参考<a href="/consumer/cn/doc/harmonyos-references/js-apis-arkui-uiextension#rectchangereason14">RectChangeReason</a>枚举值。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-base#callback">Callback</a>&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-arkui-uiextension#rectchangeoptions14">RectChangeOptions</a>&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。返回当前组件（EmbeddedComponent或UIExtensionComponent）矩形变化值及变化原因。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.11.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.11.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible cause: 1. Mandatory parameters are left unspecified; 2. Incorrect parameters types; 3. Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported. Failed to call the API due to limited device capabilities.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-kra-c106="" class="highlight-div"><div _ngcontent-kra-c106="" class="highlight-div-header"><div _ngcontent-kra-c106="" class="highlight-div-header-left"><div _ngcontent-kra-c106="" class="handle-button expand-button"><div _ngcontent-kra-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kra-c106="" class="highlight-div-header-right"><div _ngcontent-kra-c106="" class="handle-button ai-button"></div><div _ngcontent-kra-c106="" class="handle-button line-button"><div _ngcontent-kra-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kra-c106="" class="handle-button theme-button"><div _ngcontent-kra-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kra-c106="" class="handle-button copy-button"><div _ngcontent-kra-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kra-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// ExtensionProvider.ts</span></li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">EmbeddedUIExtensionAbility</span>, <span class="hljs-title class_">UIExtensionContentSession</span>, <span class="hljs-title class_">Want</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { uiExtension } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">EmbeddedUIExtensionAbility</span> {</li><li>  <span class="hljs-title function_">onSessionCreate</span>(<span class="hljs-params">want: Want, session: UIExtensionContentSession</span>) {</li><li>    <span class="hljs-keyword">const</span> extensionWindow = session.<span class="hljs-title function_">getUIExtensionWindowProxy</span>();</li><li>    <span class="hljs-comment">// 注册组件（EmbeddedComponent或UIExtensionComponent）位置及尺寸变化的监听</span></li><li>    extensionWindow.<span class="hljs-title function_">on</span>(<span class="hljs-string">'rectChange'</span>, uiExtension.<span class="hljs-property">RectChangeReason</span>.<span class="hljs-property">HOST_WINDOW_RECT_CHANGE</span>, <span class="hljs-function">(<span class="hljs-params">data: uiExtension.RectChangeOptions</span>) =&gt;</span> {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Succeeded window rect changes. Data: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data));</li><li>    });</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="offrectchange14" device-type="phone,2in1,tablet,wearable,tv">off('rectChange')<sup>14+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="offrectchange14" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>off(type: 'rectChange', callback?: Callback&lt;RectChangeOptions&gt;): void</p>     <p>注销组件（EmbeddedComponent或UIExtensionComponent）位置及尺寸变化的监听。</p>     <p><strong>系统能力：</strong> SystemCapability.ArkUI.ArkUI.Full</p>     <p><strong>元服务API：</strong> 从API version 14开始，该接口支持在元服务中使用。</p>     <p><strong>设备行为差异：</strong> 该接口在2in1设备中可正常调用，在其他设备中返回801错误码。</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.12.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.12.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.12.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.12.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">监听事件，固定为'rectChange'，即组件（EmbeddedComponent或UIExtensionComponent）矩形变化事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-base#callback">Callback</a>&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-arkui-uiextension#rectchangeoptions14">RectChangeOptions</a>&gt;</td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">回调函数。返回当前组件（EmbeddedComponent或UIExtensionComponent）矩形变化值及变化原因。如果传入参数，则关闭该监听。如果未传入参数，则关闭所有组件（EmbeddedComponent或UIExtensionComponent）矩形变化的监听。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.12.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.12.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible cause: 1. Mandatory parameters are left unspecified; 2. Incorrect parameters types; 3. Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported. Failed to call the API due to limited device capabilities.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-kra-c106="" class="highlight-div"><div _ngcontent-kra-c106="" class="highlight-div-header"><div _ngcontent-kra-c106="" class="highlight-div-header-left"><div _ngcontent-kra-c106="" class="handle-button expand-button"><div _ngcontent-kra-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kra-c106="" class="highlight-div-header-right"><div _ngcontent-kra-c106="" class="handle-button ai-button"></div><div _ngcontent-kra-c106="" class="handle-button line-button"><div _ngcontent-kra-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kra-c106="" class="handle-button theme-button"><div _ngcontent-kra-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kra-c106="" class="handle-button copy-button"><div _ngcontent-kra-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kra-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// ExtensionProvider.ts</span></li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">EmbeddedUIExtensionAbility</span>, <span class="hljs-title class_">UIExtensionContentSession</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">EmbeddedUIExtensionAbility</span> {</li><li>  <span class="hljs-title function_">onSessionDestroy</span>(<span class="hljs-params">session: UIExtensionContentSession</span>) {</li><li>    <span class="hljs-keyword">const</span> extensionWindow = session.<span class="hljs-title function_">getUIExtensionWindowProxy</span>();</li><li>    <span class="hljs-comment">// 注销组件（EmbeddedComponent或UIExtensionComponent）位置及尺寸变化的监听</span></li><li>    extensionWindow.<span class="hljs-title function_">off</span>(<span class="hljs-string">'rectChange'</span>);</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="createsubwindowwithoptions" device-type="phone,2in1,tablet,wearable,tv">createSubWindowWithOptions<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="createsubwindowwithoptions" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>createSubWindowWithOptions(name: string, subWindowOptions: window.SubWindowOptions): Promise&lt;window.Window&gt;</p>     <p>创建该WindowProxy实例下的子窗口，使用Promise异步回调。</p>     <p><strong>系统能力：</strong> SystemCapability.ArkUI.ArkUI.Full</p>     <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>模型约束：</strong> 此接口仅可在Stage模型下使用。</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.13.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.13.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.13.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.13.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">name</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">子窗口的名字。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">subWindowOptions</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-window-i#subwindowoptions11">window.SubWindowOptions</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">子窗口参数。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.13.10.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.13.10.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-window-window">window.Window</a>&gt;</td>         <td class="cellrowborder" width="50%">Promise对象。返回当前WindowProxy下创建的子窗口对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-window">窗口错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.13.13.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.13.13.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1. Mandatory parameters are left unspecified; 2.Incorrect parameters types; 3. Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported. Failed to call the API due to limited device capabilities.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">1300002</td>         <td class="cellrowborder" width="50%">This window state is abnormal.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-kra-c106="" class="highlight-div"><div _ngcontent-kra-c106="" class="highlight-div-header"><div _ngcontent-kra-c106="" class="highlight-div-header-left"><div _ngcontent-kra-c106="" class="handle-button expand-button"><div _ngcontent-kra-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kra-c106="" class="highlight-div-header-right"><div _ngcontent-kra-c106="" class="handle-button ai-button"></div><div _ngcontent-kra-c106="" class="handle-button line-button"><div _ngcontent-kra-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kra-c106="" class="handle-button theme-button"><div _ngcontent-kra-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kra-c106="" class="handle-button copy-button"><div _ngcontent-kra-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kra-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// ExtensionProvider.ts</span></li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">EmbeddedUIExtensionAbility</span>, <span class="hljs-title class_">UIExtensionContentSession</span>, <span class="hljs-title class_">Want</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-variable language_">window</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">EmbeddedUIExtensionAbility</span> {</li><li>  <span class="hljs-title function_">onSessionCreate</span>(<span class="hljs-params">want: Want, session: UIExtensionContentSession</span>) {</li><li>    <span class="hljs-keyword">const</span> extensionWindow = session.<span class="hljs-title function_">getUIExtensionWindowProxy</span>();</li><li>    <span class="hljs-keyword">const</span> <span class="hljs-attr">subWindowOpts</span>: <span class="hljs-variable language_">window</span>.<span class="hljs-property">SubWindowOptions</span> = {</li><li>      <span class="hljs-attr">title</span>: <span class="hljs-string">'This is a subwindow'</span>,</li><li>      <span class="hljs-attr">decorEnabled</span>: <span class="hljs-literal">true</span></li><li>    };</li><li>    <span class="hljs-comment">// 创建子窗口</span></li><li>    extensionWindow.<span class="hljs-title function_">createSubWindowWithOptions</span>(<span class="hljs-string">'subWindowForHost'</span>, subWindowOpts)</li><li>      .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">subWindow: <span class="hljs-variable language_">window</span>.Window</span>) =&gt;</span> {</li><li>        subWindow.<span class="hljs-title function_">setUIContent</span>(<span class="hljs-string">'pages/Index'</span>, <span class="hljs-function">(<span class="hljs-params">err, data</span>) =&gt;</span>{</li><li>          <span class="hljs-keyword">if</span> (err &amp;&amp; err.<span class="hljs-property">code</span> != <span class="hljs-number">0</span>) {</li><li>            <span class="hljs-keyword">return</span>;</li><li>          }</li><li>          subWindow?.<span class="hljs-title function_">resize</span>(<span class="hljs-number">300</span>, <span class="hljs-number">300</span>, <span class="hljs-function">(<span class="hljs-params">err, data</span>)=&gt;</span>{</li><li>            <span class="hljs-keyword">if</span> (err &amp;&amp; err.<span class="hljs-property">code</span> != <span class="hljs-number">0</span>) {</li><li>              <span class="hljs-keyword">return</span>;</li><li>            }</li><li>            subWindow?.<span class="hljs-title function_">moveWindowTo</span>(<span class="hljs-number">100</span>, <span class="hljs-number">100</span>, <span class="hljs-function">(<span class="hljs-params">err, data</span>)=&gt;</span>{</li><li>              <span class="hljs-keyword">if</span> (err &amp;&amp; err.<span class="hljs-property">code</span> != <span class="hljs-number">0</span>) {</li><li>                <span class="hljs-keyword">return</span>;</li><li>              }</li><li>              subWindow?.<span class="hljs-title function_">showWindow</span>(<span class="hljs-function">(<span class="hljs-params">err, data</span>) =&gt;</span> {</li><li>                <span class="hljs-keyword">if</span> (err &amp;&amp; err.<span class="hljs-property">code</span> == <span class="hljs-number">0</span>) {</li><li>                  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`The subwindow has been shown!`</span>);</li><li>                } <span class="hljs-keyword">else</span> {</li><li>                  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Failed to show the subwindow!`</span>);</li><li>                }</li><li>              });</li><li>            });</li><li>          });</li><li>        });</li><li>      }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error: BusinessError</span>) =&gt;</span> {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Create subwindow failed. Cause code: <span class="hljs-subst">${error.code}</span>, message: <span class="hljs-subst">${error.message}</span>`</span>);</li><li>      })</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="occupyevents18" device-type="phone,2in1,tablet,wearable,tv">occupyEvents<sup>18+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="occupyevents18" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>occupyEvents(eventFlags: number): Promise&lt;void&gt;</p>     <p>设置组件（EmbeddedComponent或UIExtensionComponent）占用事件，宿主将不响应组件区域内被占用的事件。</p>     <p><strong>系统能力：</strong> SystemCapability.ArkUI.ArkUI.Full</p>     <p><strong>元服务API：</strong> 从API version 18开始，该接口支持在元服务中使用。</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.14.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.14.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.14.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.14.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">eventFlags</td>         <td class="cellrowborder" width="25%">number</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">占用的事件类型，具体取值可见<a href="/consumer/cn/doc/harmonyos-references/js-apis-arkui-uiextension#eventflag18">EventFlag</a>枚举值。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.14.9.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.14.9.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">无返回结果的Promise对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-window">窗口错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.14.12.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.14.12.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible cause: 1. Mandatory parameters are left unspecified; 2. Incorrect parameters types; 3. Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">1300002</td>         <td class="cellrowborder" width="50%">This window state is abnormal.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">1300003</td>         <td class="cellrowborder" width="50%">This window manager service works abnormally.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-kra-c106="" class="highlight-div"><div _ngcontent-kra-c106="" class="highlight-div-header"><div _ngcontent-kra-c106="" class="highlight-div-header-left"><div _ngcontent-kra-c106="" class="handle-button expand-button"><div _ngcontent-kra-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kra-c106="" class="highlight-div-header-right"><div _ngcontent-kra-c106="" class="handle-button ai-button"></div><div _ngcontent-kra-c106="" class="handle-button line-button"><div _ngcontent-kra-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kra-c106="" class="handle-button theme-button"><div _ngcontent-kra-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kra-c106="" class="handle-button copy-button"><div _ngcontent-kra-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kra-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// ExtensionProvider.ts</span></li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">EmbeddedUIExtensionAbility</span>, <span class="hljs-title class_">UIExtensionContentSession</span>, <span class="hljs-title class_">Want</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { uiExtension } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">EmbeddedUIExtensionAbility</span> {</li><li>  <span class="hljs-title function_">onSessionCreate</span>(<span class="hljs-params">want: Want, session: UIExtensionContentSession</span>) {</li><li>    <span class="hljs-keyword">const</span> extensionWindow = session.<span class="hljs-title function_">getUIExtensionWindowProxy</span>();</li><li>    <span class="hljs-comment">// 占用事件</span></li><li>    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {</li><li>      <span class="hljs-keyword">try</span> {</li><li>        <span class="hljs-keyword">let</span> promise = extensionWindow.<span class="hljs-title function_">occupyEvents</span>(uiExtension.<span class="hljs-property">EventFlag</span>.<span class="hljs-property">EVENT_CLICK</span> | uiExtension.<span class="hljs-property">EventFlag</span>.<span class="hljs-property">EVENT_LONG_PRESS</span>);</li><li>        promise.<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`Successed in occupy events`</span>);</li><li>        }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Failed to occupy events. Cause code: <span class="hljs-subst">${err.code}</span>, message: <span class="hljs-subst">${err.message}</span>`</span>);</li><li>        });</li><li>      } <span class="hljs-keyword">catch</span> (e) {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Occupy events got exception code: <span class="hljs-subst">${e.code}</span>, message: <span class="hljs-subst">${e.message}</span>`</span>);</li><li>      }</li><li>    }, <span class="hljs-number">500</span>);</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="eventflag18" device-type="phone,2in1,tablet,wearable,tv">EventFlag<sup>18+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="eventflag18" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>事件类型枚举。</p>     <p><strong>系统能力：</strong> SystemCapability.ArkUI.ArkUI.Full</p>     <p><strong>元服务API：</strong> 从API version 18开始，该接口支持在元服务中使用。</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.15.5.1.4.1.1" width="33.33333333333333%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.15.5.1.4.1.2" width="33.33333333333333%">值</th>         <th align="left" class="cellrowborder" id="mcps1.3.15.5.1.4.1.3" width="33.33333333333333%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="33.33333333333333%">EVENT_NONE</td>         <td class="cellrowborder" width="33.33333333333333%">0x00000000</td>         <td class="cellrowborder" width="33.33333333333333%">无事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">EVENT_PAN_GESTURE_LEFT</td>         <td class="cellrowborder" width="33.33333333333333%">0x00000001</td>         <td class="cellrowborder" width="33.33333333333333%">左滑事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">EVENT_PAN_GESTURE_RIGHT</td>         <td class="cellrowborder" width="33.33333333333333%">0x00000002</td>         <td class="cellrowborder" width="33.33333333333333%">右滑事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">EVENT_PAN_GESTURE_UP</td>         <td class="cellrowborder" width="33.33333333333333%">0x00000004</td>         <td class="cellrowborder" width="33.33333333333333%">上滑事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">EVENT_PAN_GESTURE_DOWN</td>         <td class="cellrowborder" width="33.33333333333333%">0x00000008</td>         <td class="cellrowborder" width="33.33333333333333%">下滑事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">EVENT_CLICK</td>         <td class="cellrowborder" width="33.33333333333333%">0x00000100</td>         <td class="cellrowborder" width="33.33333333333333%">点击事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">EVENT_LONG_PRESS</td>         <td class="cellrowborder" width="33.33333333333333%">0x00000200</td>         <td class="cellrowborder" width="33.33333333333333%">长按事件。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="avoidareainfo" device-type="phone,2in1,tablet,wearable,tv">AvoidAreaInfo<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="avoidareainfo" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>用于表示窗口规避区的信息。</p>     <p><strong>系统能力</strong>：SystemCapability.ArkUI.ArkUI.Full</p>     <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.16.5.1.6.1.1" width="20%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.16.5.1.6.1.2" width="20%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.16.5.1.6.1.3" width="20%">只读</th>         <th align="left" class="cellrowborder" id="mcps1.3.16.5.1.6.1.4" width="20%">可选</th>         <th align="left" class="cellrowborder" id="mcps1.3.16.5.1.6.1.5" width="20%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">type</td>         <td class="cellrowborder" width="20%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-window-e#avoidareatype7">window.AvoidAreaType</a></td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">窗口规避区类型。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">area</td>         <td class="cellrowborder" width="20%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-window-i#avoidarea7">window.AvoidArea</a></td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">窗口内容规避区域。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="windowproxyproperties14" device-type="phone,2in1,tablet,wearable,tv">WindowProxyProperties<sup>14+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="windowproxyproperties14" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>用于表示组件的相关信息。</p>     <p><strong>系统能力：</strong> SystemCapability.ArkUI.ArkUI.Full</p>     <p><strong>元服务API：</strong> 从API version 14开始，该接口支持在元服务中使用。</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.17.5.1.6.1.1" width="20%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.17.5.1.6.1.2" width="20%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.17.5.1.6.1.3" width="20%">只读</th>         <th align="left" class="cellrowborder" id="mcps1.3.17.5.1.6.1.4" width="20%">可选</th>         <th align="left" class="cellrowborder" id="mcps1.3.17.5.1.6.1.5" width="20%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">uiExtensionHostWindowProxyRect</td>         <td class="cellrowborder" width="20%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-window-i#rect7">window.Rect</a></td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">组件（EmbeddedComponent或UIExtensionComponent）的位置和宽高。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="rectchangereason14" device-type="phone,2in1,tablet,wearable,tv">RectChangeReason<sup>14+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="rectchangereason14" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>组件（EmbeddedComponent或UIExtensionComponent）矩形（位置及尺寸）变化的原因。</p>     <p><strong>系统能力：</strong> SystemCapability.ArkUI.ArkUI.Full</p>     <p><strong>元服务API：</strong> 从API version 14开始，该接口支持在元服务中使用。</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.18.5.1.4.1.1" width="33.33333333333333%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.18.5.1.4.1.2" width="33.33333333333333%">值</th>         <th align="left" class="cellrowborder" id="mcps1.3.18.5.1.4.1.3" width="33.33333333333333%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="33.33333333333333%">HOST_WINDOW_RECT_CHANGE</td>         <td class="cellrowborder" width="33.33333333333333%">0x0001</td>         <td class="cellrowborder" width="33.33333333333333%">组件所在的宿主窗口矩形变化。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="rectchangeoptions14" device-type="phone,2in1,tablet,wearable,tv">RectChangeOptions<sup>14+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="rectchangeoptions14" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>组件（EmbeddedComponent或UIExtensionComponent）矩形（位置及尺寸）变化返回的值及变化原因。</p>     <p><strong>系统能力：</strong> SystemCapability.ArkUI.ArkUI.Full</p>     <p><strong>元服务API：</strong> 从API version 14开始，该接口支持在元服务中使用。</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.19.5.1.6.1.1" width="20%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.19.5.1.6.1.2" width="20%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.19.5.1.6.1.3" width="20%">只读</th>         <th align="left" class="cellrowborder" id="mcps1.3.19.5.1.6.1.4" width="20%">可选</th>         <th align="left" class="cellrowborder" id="mcps1.3.19.5.1.6.1.5" width="20%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">rect</td>         <td class="cellrowborder" width="20%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-window-i#rect7">window.Rect</a></td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">组件矩形变化后的值。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">reason</td>         <td class="cellrowborder" width="20%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-arkui-uiextension#rectchangereason14">RectChangeReason</a></td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">组件矩形变化的原因。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="完整示例" device-type="phone,2in1,tablet,wearable,tv">完整示例<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="完整示例" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>本示例展示文档中所有API在EmbeddedUIExtensionAbility中的基础使用方式，示例应用的bundleName为"com.example.embeddeddemo", 被拉起的EmbeddedUIExtensionAbility为"ExampleEmbeddedAbility"。</p>     <ul>      <li>       <p>示例应用中的EntryAbility(UIAbility)加载首页文件：pages/Index.ets，其中内容如下：</p>       <div _ngcontent-kra-c106="" class="highlight-div"><div _ngcontent-kra-c106="" class="highlight-div-header"><div _ngcontent-kra-c106="" class="highlight-div-header-left"><div _ngcontent-kra-c106="" class="handle-button expand-button"><div _ngcontent-kra-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kra-c106="" class="highlight-div-header-right"><div _ngcontent-kra-c106="" class="handle-button ai-button"></div><div _ngcontent-kra-c106="" class="handle-button line-button"><div _ngcontent-kra-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kra-c106="" class="handle-button theme-button"><div _ngcontent-kra-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kra-c106="" class="handle-button copy-button"><div _ngcontent-kra-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kra-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// pages/Index.ets -- UIAbility启动时加载此页面</span></li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Want</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'Message: '</span>;</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">want</span>: <span class="hljs-title class_">Want</span> = {</li><li>    <span class="hljs-attr">bundleName</span>: <span class="hljs-string">"com.example.embeddeddemo"</span>,</li><li>    <span class="hljs-attr">abilityName</span>: <span class="hljs-string">"ExampleEmbeddedAbility"</span>,</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Row</span>() {</li><li>      <span class="hljs-title class_">Column</span>() {</li><li>        <span class="hljs-title class_">Text</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span>).<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">30</span>)</li><li>        <span class="hljs-title class_">EmbeddedComponent</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">want</span>, <span class="hljs-title class_">EmbeddedType</span>.<span class="hljs-property">EMBEDDED_UI_EXTENSION</span>)</li><li>          .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>          .<span class="hljs-title function_">height</span>(<span class="hljs-string">'90%'</span>)</li><li>          .<span class="hljs-title function_">onTerminated</span>(<span class="hljs-function">(<span class="hljs-params">info</span>)=&gt;</span>{</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span> = <span class="hljs-string">'Termination: code = '</span> + info.<span class="hljs-property">code</span> + <span class="hljs-string">', want = '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(info.<span class="hljs-property">want</span>);</li><li>          })</li><li>          .<span class="hljs-title function_">onError</span>(<span class="hljs-function">(<span class="hljs-params">error</span>)=&gt;</span>{</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span> = <span class="hljs-string">'Error: code = '</span> + error.<span class="hljs-property">code</span>;</li><li>          })</li><li>      }</li><li>      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    }</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div></li>      <li>       <p>EmbeddedComponent拉起的EmbeddedUIExtensionAbility在ets/extensionAbility/ExampleEmbeddedAbility文件中实现，内容如下：</p>       <div _ngcontent-kra-c106="" class="highlight-div"><div _ngcontent-kra-c106="" class="highlight-div-header"><div _ngcontent-kra-c106="" class="highlight-div-header-left"><div _ngcontent-kra-c106="" class="handle-button expand-button"><div _ngcontent-kra-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kra-c106="" class="highlight-div-header-right"><div _ngcontent-kra-c106="" class="handle-button ai-button"></div><div _ngcontent-kra-c106="" class="handle-button line-button"><div _ngcontent-kra-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kra-c106="" class="handle-button theme-button"><div _ngcontent-kra-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kra-c106="" class="handle-button copy-button"><div _ngcontent-kra-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kra-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">EmbeddedUIExtensionAbility</span>, <span class="hljs-title class_">UIExtensionContentSession</span>, <span class="hljs-title class_">Want</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-keyword">const</span> <span class="hljs-attr">TAG</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'[ExampleEmbeddedAbility]'</span>;</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ExampleEmbeddedAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">EmbeddedUIExtensionAbility</span> {</li><li>  </li><li>  <span class="hljs-title function_">onCreate</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">`onCreate`</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">onForeground</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">`onForeground`</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">onBackground</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">`onBackground`</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">onDestroy</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">`onDestroy`</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">onSessionCreate</span>(<span class="hljs-params">want: Want, session: UIExtensionContentSession</span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">`onSessionCreate, want: <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(want)}</span>`</span>);</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">param</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-title class_">UIExtensionContentSession</span>&gt; = {</li><li>      <span class="hljs-string">'session'</span>: session</li><li>    };</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">storage</span>: <span class="hljs-title class_">LocalStorage</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LocalStorage</span>(param);</li><li>    session.<span class="hljs-title function_">loadContent</span>(<span class="hljs-string">'pages/extension'</span>, storage);</li><li>  }</li><li>}</li></ol></pre></div></div></li>      <li>       <p>EmbeddedUIExtensionAbility的入口页面文件pages/extension.ets内容如下：</p>       <div _ngcontent-kra-c106="" class="highlight-div"><div _ngcontent-kra-c106="" class="highlight-div-header"><div _ngcontent-kra-c106="" class="highlight-div-header-left"><div _ngcontent-kra-c106="" class="handle-button expand-button"><div _ngcontent-kra-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kra-c106="" class="highlight-div-header-right"><div _ngcontent-kra-c106="" class="handle-button ai-button"></div><div _ngcontent-kra-c106="" class="handle-button line-button"><div _ngcontent-kra-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kra-c106="" class="handle-button theme-button"><div _ngcontent-kra-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kra-c106="" class="handle-button copy-button"><div _ngcontent-kra-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kra-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIExtensionContentSession</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { uiExtension, <span class="hljs-variable language_">window</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span>()</li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Extension</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'EmbeddedUIExtensionAbility Index'</span>;</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">storage</span>: <span class="hljs-title class_">LocalStorage</span> | <span class="hljs-literal">undefined</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>()?.<span class="hljs-title function_">getSharedLocalStorage</span>();</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">session</span>: <span class="hljs-title class_">UIExtensionContentSession</span> | <span class="hljs-literal">undefined</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">storage</span>?.<span class="hljs-property">get</span>&lt;<span class="hljs-title class_">UIExtensionContentSession</span>&gt;(<span class="hljs-string">'session'</span>);</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">extensionWindow</span>: uiExtension.<span class="hljs-property">WindowProxy</span> | <span class="hljs-literal">undefined</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">session</span>?.<span class="hljs-title function_">getUIExtensionWindowProxy</span>();</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">subWindow</span>: <span class="hljs-variable language_">window</span>.<span class="hljs-property">Window</span> | <span class="hljs-literal">undefined</span> = <span class="hljs-literal">undefined</span>;</li><li>
</li><li>  <span class="hljs-title function_">aboutToAppear</span>(): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">extensionWindow</span>?.<span class="hljs-title function_">on</span>(<span class="hljs-string">'windowSizeChange'</span>, <span class="hljs-function">(<span class="hljs-params">size: <span class="hljs-variable language_">window</span>.Size</span>) =&gt;</span> {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`size = <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(size)}</span>`</span>);</li><li>    });</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">extensionWindow</span>?.<span class="hljs-title function_">on</span>(<span class="hljs-string">'rectChange'</span>, uiExtension.<span class="hljs-property">RectChangeReason</span>.<span class="hljs-property">HOST_WINDOW_RECT_CHANGE</span>, <span class="hljs-function">(<span class="hljs-params">data: uiExtension.RectChangeOptions</span>) =&gt;</span> {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Succeeded window rect changes. Data: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data));</li><li>    });</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">extensionWindow</span>?.<span class="hljs-title function_">on</span>(<span class="hljs-string">'avoidAreaChange'</span>, <span class="hljs-function">(<span class="hljs-params">info: uiExtension.AvoidAreaInfo</span>) =&gt;</span> {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`type = <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(info.<span class="hljs-keyword">type</span>)}</span>, area = <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(info.area)}</span>`</span>);</li><li>    });</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">aboutToDisappear</span>(): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">extensionWindow</span>?.<span class="hljs-title function_">off</span>(<span class="hljs-string">'windowSizeChange'</span>);</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">extensionWindow</span>?.<span class="hljs-title function_">off</span>(<span class="hljs-string">'rectChange'</span>);</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">extensionWindow</span>?.<span class="hljs-title function_">off</span>(<span class="hljs-string">'avoidAreaChange'</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span>)</li><li>        .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">20</span>)</li><li>        .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">"获取组件大小"</span>).<span class="hljs-title function_">width</span>(<span class="hljs-string">'90%'</span>).<span class="hljs-title function_">margin</span>({<span class="hljs-attr">top</span>: <span class="hljs-number">5</span>, <span class="hljs-attr">bottom</span>: <span class="hljs-number">5</span>}).<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">16</span>).<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>        <span class="hljs-keyword">let</span> rect = <span class="hljs-variable language_">this</span>.<span class="hljs-property">extensionWindow</span>?.<span class="hljs-property">properties</span>.<span class="hljs-property">uiExtensionHostWindowProxyRect</span>;</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`EmbeddedComponent的位置和尺寸信息: <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(rect)}</span>`</span>);</li><li>      })</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">"获取系统规避区信息"</span>).<span class="hljs-title function_">width</span>(<span class="hljs-string">'90%'</span>).<span class="hljs-title function_">margin</span>({<span class="hljs-attr">top</span>: <span class="hljs-number">5</span>, <span class="hljs-attr">bottom</span>: <span class="hljs-number">5</span>}).<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">16</span>).<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>        <span class="hljs-keyword">let</span> <span class="hljs-attr">avoidArea</span>: <span class="hljs-variable language_">window</span>.<span class="hljs-property">AvoidArea</span> | <span class="hljs-literal">undefined</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">extensionWindow</span>?.<span class="hljs-title function_">getWindowAvoidArea</span>(<span class="hljs-variable language_">window</span>.<span class="hljs-property">AvoidAreaType</span>.<span class="hljs-property">TYPE_SYSTEM</span>);</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`系统规避区: <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(avoidArea)}</span>`</span>);</li><li>      })</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">"创建子窗口"</span>).<span class="hljs-title function_">width</span>(<span class="hljs-string">'90%'</span>).<span class="hljs-title function_">margin</span>({<span class="hljs-attr">top</span>: <span class="hljs-number">5</span>, <span class="hljs-attr">bottom</span>: <span class="hljs-number">5</span>}).<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">16</span>).<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>        <span class="hljs-keyword">let</span> <span class="hljs-attr">subWindowOpts</span>: <span class="hljs-variable language_">window</span>.<span class="hljs-property">SubWindowOptions</span> = {</li><li>            <span class="hljs-string">'title'</span>: <span class="hljs-string">'This is a subwindow'</span>,</li><li>            <span class="hljs-attr">decorEnabled</span>: <span class="hljs-literal">true</span></li><li>        };</li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">extensionWindow</span>?.<span class="hljs-title function_">createSubWindowWithOptions</span>(<span class="hljs-string">'subWindowForHost'</span>, subWindowOpts)</li><li>            .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">subWindow: <span class="hljs-variable language_">window</span>.Window</span>) =&gt;</span> {</li><li>                <span class="hljs-variable language_">this</span>.<span class="hljs-property">subWindow</span> = subWindow;</li><li>                <span class="hljs-variable language_">this</span>.<span class="hljs-property">subWindow</span>.<span class="hljs-title function_">loadContent</span>(<span class="hljs-string">'pages/Index'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">storage</span>, <span class="hljs-function">(<span class="hljs-params">err, data</span>) =&gt;</span>{</li><li>                    <span class="hljs-keyword">if</span> (err &amp;&amp; err.<span class="hljs-property">code</span> != <span class="hljs-number">0</span>) {</li><li>                        <span class="hljs-keyword">return</span>;</li><li>                    }</li><li>                    <span class="hljs-variable language_">this</span>.<span class="hljs-property">subWindow</span>?.<span class="hljs-title function_">resize</span>(<span class="hljs-number">300</span>, <span class="hljs-number">300</span>, <span class="hljs-function">(<span class="hljs-params">err, data</span>)=&gt;</span>{</li><li>                        <span class="hljs-keyword">if</span> (err &amp;&amp; err.<span class="hljs-property">code</span> != <span class="hljs-number">0</span>) {</li><li>                            <span class="hljs-keyword">return</span>;</li><li>                        }</li><li>                        <span class="hljs-variable language_">this</span>.<span class="hljs-property">subWindow</span>?.<span class="hljs-title function_">moveWindowTo</span>(<span class="hljs-number">100</span>, <span class="hljs-number">100</span>, <span class="hljs-function">(<span class="hljs-params">err, data</span>)=&gt;</span>{</li><li>                            <span class="hljs-keyword">if</span> (err &amp;&amp; err.<span class="hljs-property">code</span> != <span class="hljs-number">0</span>) {</li><li>                                <span class="hljs-keyword">return</span>;</li><li>                            }</li><li>                            <span class="hljs-variable language_">this</span>.<span class="hljs-property">subWindow</span>?.<span class="hljs-title function_">showWindow</span>(<span class="hljs-function">(<span class="hljs-params">err, data</span>) =&gt;</span> {</li><li>                                <span class="hljs-keyword">if</span> (err &amp;&amp; err.<span class="hljs-property">code</span> == <span class="hljs-number">0</span>) {</li><li>                                    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`The subwindow has been shown!`</span>);</li><li>                                } <span class="hljs-keyword">else</span> {</li><li>                                    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Failed to show the subwindow!`</span>);</li><li>                                }</li><li>                            });</li><li>                        });</li><li>                    });</li><li>                });</li><li>            }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error: BusinessError</span>) =&gt;</span> {</li><li>                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Create subwindow failed. Cause code: <span class="hljs-subst">${error.code}</span>, message: <span class="hljs-subst">${error.message}</span>`</span>);</li><li>            })</li><li>      })</li><li>    }.<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>).<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div></li>      <li>       <p>最后，示例应用的module.json5中的"extensionAbilities"中需要增加一项，具体内容如下：</p>       <div _ngcontent-kra-c106="" class="highlight-div"><div _ngcontent-kra-c106="" class="highlight-div-header"><div _ngcontent-kra-c106="" class="highlight-div-header-left"><div _ngcontent-kra-c106="" class="handle-button expand-button"><div _ngcontent-kra-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kra-c106="" class="highlight-div-header-right"><div _ngcontent-kra-c106="" class="handle-button ai-button"></div><div _ngcontent-kra-c106="" class="handle-button line-button"><div _ngcontent-kra-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kra-c106="" class="handle-button theme-button"><div _ngcontent-kra-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kra-c106="" class="handle-button copy-button"><div _ngcontent-kra-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kra-c106="" class="highlight-scroll-div"><pre class="json prettyprint linenums hljs language-json" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-punctuation">{</span></li><li>  <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ExampleEmbeddedAbility"</span><span class="hljs-punctuation">,</span></li><li>  <span class="hljs-attr">"srcEntry"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"./ets/extensionAbility/ExampleEmbeddedAbility.ets"</span><span class="hljs-punctuation">,</span></li><li>  <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"embeddedUI"</span></li><li><span class="hljs-punctuation">}</span></li></ol></pre></div></div></li>     </ul>    </div>   </div>   <div></div></div>