<h1 _ngcontent-wue-c119="" class="doc-title ng-star-inserted" title="@ohos.bluetooth.ble (蓝牙ble模块)"> @ohos.bluetooth.ble (蓝牙ble模块) </h1>

<div _ngcontent-wue-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted renderOptimization" style="position: relative;">   <div>    <p>本模块提供了基于低功耗蓝牙（Bluetooth Low Energy，<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/terminology#ble" target="_blank">BLE</a>）技术的蓝牙能力，支持发起BLE扫描、发送BLE广播报文、以及基于通用属性协议（Generic Attribute Profile，<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/terminology#gatt" target="_blank">GATT</a>）的连接和传输数据。</p>    <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">      <ul>       <li>本模块首批接口从API version 10开始支持。后续版本的新增接口，采用上角标单独标记接口的起始版本。</li>       <li>接口中涉及的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/terminology#uuid" target="_blank">UUID</a>服务，可以通过工具函数<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-util#utilgeneraterandomuuid9">util.generateRandomUUID</a>生成。</li>      </ul>     </div></div></div>    <div class="tiledSection scroll-inwindow" style="contain-intrinsic-size: auto 247px;">     <h2 id="导入模块" device-type="phone,2in1,tablet,wearable,tv">导入模块<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="导入模块" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><div _ngcontent-wue-c106="" class="highlight-div"><div _ngcontent-wue-c106="" class="highlight-div-header"><div _ngcontent-wue-c106="" class="highlight-div-header-left"><div _ngcontent-wue-c106="" class="handle-button expand-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wue-c106="" class="highlight-div-header-right"><div _ngcontent-wue-c106="" class="handle-button ai-button"></div><div _ngcontent-wue-c106="" class="handle-button line-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wue-c106="" class="handle-button theme-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wue-c106="" class="handle-button copy-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wue-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { ble } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ConnectivityKit'</span>;</li></ol></pre></div></div>    </div>    <div class="tiledSection scroll-inwindow" style="contain-intrinsic-size: auto 449px;">     <h2 id="profileconnectionstate" device-type="phone,2in1,tablet,wearable,tv">ProfileConnectionState<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="profileconnectionstate" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>type ProfileConnectionState = constant.ProfileConnectionState</p>     <p>蓝牙设备的Profile协议连接状态。</p>     <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.4.6.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.4.6.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-constant#profileconnectionstate">constant.ProfileConnectionState</a></td>         <td class="cellrowborder" width="50%">蓝牙设备的profile连接状态。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection scroll-inwindow" style="contain-intrinsic-size: auto 730px;">     <h2 id="blecreategattserver" device-type="phone,2in1,tablet,wearable,tv">ble.createGattServer<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="blecreategattserver" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>createGattServer(): GattServer</p>     <p>创建<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#gattserver">GattServer</a>实例，表示GATT连接中的server端。</p>     <ul>      <li>通过该实例可以操作server端的行为，如添加服务<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#addservice">addService</a>、通知特征值变化<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#notifycharacteristicchanged">notifyCharacteristicChanged</a>等。</li>     </ul>     <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.5.8.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.5.8.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#gattserver">GattServer</a></td>         <td class="cellrowborder" width="50%">返回一个Gatt服务的实例。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wue-c106="" class="highlight-div"><div _ngcontent-wue-c106="" class="highlight-div-header"><div _ngcontent-wue-c106="" class="highlight-div-header-left"><div _ngcontent-wue-c106="" class="handle-button expand-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wue-c106="" class="highlight-div-header-right"><div _ngcontent-wue-c106="" class="handle-button ai-button"></div><div _ngcontent-wue-c106="" class="handle-button line-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wue-c106="" class="handle-button theme-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wue-c106="" class="handle-button copy-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wue-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">let</span> <span class="hljs-attr">gattServer</span>: ble.<span class="hljs-property">GattServer</span> = ble.<span class="hljs-title function_">createGattServer</span>();</li><li><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'gatt success'</span>);</li></ol></pre></div></div>    </div>    <div class="tiledSection scroll-inwindow" style="contain-intrinsic-size: auto 1427px;">     <h2 id="blecreategattclientdevice" device-type="phone,2in1,tablet,wearable,tv">ble.createGattClientDevice<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="blecreategattclientdevice" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>createGattClientDevice(deviceId: string): GattClientDevice</p>     <p>创建<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#gattclientdevice">GattClientDevice</a>实例，表示GATT连接中的client端。</p>     <ul>      <li>通过该实例可以操作client端行为，如调用<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#connect">connect</a>向对端设备发起连接，调用<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#getservices">getServices</a>获取对端设备支持的所有服务能力。</li>      <li>创建该实例所需要的设备地址表示server端设备。可以通过<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#blestartblescan">ble.startBLEScan</a>或<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#blescanner15">BleScanner</a>的<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#startscan15">startScan</a>接口获取server端设备地址，且需保证server端设备的BLE广播是可连接的。</li>     </ul>     <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.6.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.6.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.6.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.6.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">deviceId</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">对端设备地址， 例如："XX:XX:XX:XX:XX:XX"。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.6.10.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.6.10.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#gattclientdevice">GattClientDevice</a></td>         <td class="cellrowborder" width="50%">client端类，使用client端方法之前需要创建该类的实例进行操作。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码说明文档</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.6.13.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.6.13.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Invalid parameter. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types. 3. Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wue-c106="" class="highlight-div"><div _ngcontent-wue-c106="" class="highlight-div-header"><div _ngcontent-wue-c106="" class="highlight-div-header-left"><div _ngcontent-wue-c106="" class="handle-button expand-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wue-c106="" class="highlight-div-header-right"><div _ngcontent-wue-c106="" class="handle-button ai-button"></div><div _ngcontent-wue-c106="" class="handle-button line-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wue-c106="" class="handle-button theme-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wue-c106="" class="handle-button copy-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wue-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AsyncCallback</span>, <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">device</span>: ble.<span class="hljs-property">GattClientDevice</span> = ble.<span class="hljs-title function_">createGattClientDevice</span>(<span class="hljs-string">'XX:XX:XX:XX:XX:XX'</span>);</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1481px;">     <h2 id="blegetconnectedbledevices" device-type="phone,2in1,tablet,wearable,tv">ble.getConnectedBLEDevices<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="blegetconnectedbledevices" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>getConnectedBLEDevices(): Array&lt;string&gt;</p>     <p>获取和本机设备已连接GATT的BLE设备集合。</p>     <ul>      <li>建议给server端使用，client端使用返回的设备地址集合为空。</li>     </ul>     <p><strong>需要权限</strong>：ohos.permission.ACCESS_BLUETOOTH</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.7.8.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.7.8.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Array&lt;string&gt;</td>         <td class="cellrowborder" width="50%">          <p>返回和本机设备已建立GATT连接的BLE设备地址集合。</p>          <p>基于信息安全考虑，此处获取的设备地址为虚拟MAC地址。</p>          <p>- 若和该设备地址配对成功后，该地址不会变更。</p>          <p>- 若该设备重启蓝牙开关，重新获取到的虚拟地址会立即变更。</p>          <p>- 若取消配对，蓝牙子系统会根据该地址的实际使用情况，决策后续变更时机；若其他应用正在使用该地址，则不会立刻变更。</p>          <p>- 若要持久化保存该地址，可使用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-access#accessaddpersistentdeviceid16">access.addPersistentDeviceId</a>方法。</p></td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码说明文档</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-bluetoothmanager">蓝牙服务子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.7.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.7.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900001</td>         <td class="cellrowborder" width="50%">Service stopped.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900003</td>         <td class="cellrowborder" width="50%">Bluetooth disabled.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900099</td>         <td class="cellrowborder" width="50%">Operation failed.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wue-c106="" class="highlight-div"><div _ngcontent-wue-c106="" class="highlight-div-header"><div _ngcontent-wue-c106="" class="highlight-div-header-left"><div _ngcontent-wue-c106="" class="handle-button expand-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wue-c106="" class="highlight-div-header-right"><div _ngcontent-wue-c106="" class="handle-button ai-button"></div><div _ngcontent-wue-c106="" class="handle-button line-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wue-c106="" class="handle-button theme-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wue-c106="" class="handle-button copy-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wue-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AsyncCallback</span>, <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">result</span>: <span class="hljs-title class_">Array</span>&lt;string&gt; = ble.<span class="hljs-title function_">getConnectedBLEDevices</span>();</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1768px;">     <h2 id="blegetconnectedbledevices21" device-type="phone,2in1,tablet,wearable,tv">ble.getConnectedBLEDevices<sup>21+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="blegetconnectedbledevices21" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>getConnectedBLEDevices(profile: BleProfile): Array&lt;string&gt;</p>     <p>根据指定的本机设备Profile协议类型，获取和本机设备已连接GATT的BLE设备集合。</p>     <ul>      <li>若指定本机设备作为client端，则返回与本机设备连接的所有server端设备地址集合。</li>      <li>若指定本机设备作为server端，则返回与本机设备连接的所有client端设备地址集合。</li>      <li>若指定本机设备同时作为client端和server端，则返回与本机设备连接的所有client端和server端设备地址集合。</li>     </ul>     <p><strong>需要权限</strong>：ohos.permission.ACCESS_BLUETOOTH</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.8.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.8.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.8.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.8.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">profile</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#bleprofile21">BleProfile</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">          <p>当前设备的Profile协议类型，表明该设备在GATT链路中的通信角色。</p>          <p>- GATT_CLIENT表示指定本机设备为client端角色，与其建立GATT连接的所有对端设备为server端角色。</p></td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.8.10.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.8.10.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Array&lt;string&gt;</td>         <td class="cellrowborder" width="50%">          <p>返回和本机设备已建立GATT连接的BLE设备地址集合。</p>          <p>基于信息安全考虑，此处获取的设备地址为虚拟MAC地址。</p>          <p>- 若和该设备地址配对成功后，该地址不会变更。</p>          <p>- 取消配对该设备或蓝牙关闭后，若重新获取，该虚拟地址会变更。</p>          <p>- 若要持久化保存该地址，可使用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-access#accessaddpersistentdeviceid16">access.addPersistentDeviceId</a>方法</p></td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码说明文档</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-bluetoothmanager">蓝牙服务子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.8.13.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.8.13.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900001</td>         <td class="cellrowborder" width="50%">Service stopped.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900003</td>         <td class="cellrowborder" width="50%">Bluetooth disabled.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900099</td>         <td class="cellrowborder" width="50%">Operation failed.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wue-c106="" class="highlight-div"><div _ngcontent-wue-c106="" class="highlight-div-header"><div _ngcontent-wue-c106="" class="highlight-div-header-left"><div _ngcontent-wue-c106="" class="handle-button expand-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wue-c106="" class="highlight-div-header-right"><div _ngcontent-wue-c106="" class="handle-button ai-button"></div><div _ngcontent-wue-c106="" class="handle-button line-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wue-c106="" class="handle-button theme-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wue-c106="" class="handle-button copy-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wue-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">result</span>: <span class="hljs-title class_">Array</span>&lt;string&gt; = ble.<span class="hljs-title function_">getConnectedBLEDevices</span>(ble.<span class="hljs-property">BleProfile</span>.<span class="hljs-property">GATT_CLIENT</span>);</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 2033px;">     <h2 id="blestartblescan" device-type="phone,2in1,tablet,wearable,tv">ble.startBLEScan<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="blestartblescan" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>startBLEScan(filters: Array&lt;ScanFilter&gt;, options?: ScanOptions): void</p>     <p>发起BLE扫描流程。</p>     <ul>      <li>扫描结果会通过<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#bleonbledevicefind">ble.on('BLEDeviceFind')</a>的回调函数获取到。只能扫描BLE设备，调用<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#blestopblescan">ble.stopBLEScan</a>可以停止该方法开启的扫描流程。</li>      <li>该接口只支持单路扫描，即应用同时只能调用一次，下一次调用前，需要先调用<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#blestopblescan">ble.stopBLEScan</a>停止上一次的扫描流程。</li>      <li>若需要使用多路扫描，可使用<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#blescanner15">BleScanner</a>。</li>     </ul>     <p><strong>需要权限</strong>：ohos.permission.ACCESS_BLUETOOTH</p>     <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.9.9.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.9.9.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.9.9.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.9.9.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">filters</td>         <td class="cellrowborder" width="25%">Array&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#scanfilter">ScanFilter</a>&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">          <p>表示扫描结果过滤策略集合，符合过滤条件的设备发现会保留。</p>          <p>-若该参数设置为null，将扫描所有可发现的周边BLE设备，但是不建议使用此方式，可能扫描到非预期设备，并增加功耗。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="25%">options</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#scanoptions">ScanOptions</a></td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">表示扫描的参数配置。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码说明文档</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-bluetoothmanager">蓝牙服务子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.9.12.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.9.12.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Invalid parameter. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types. 3. Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900001</td>         <td class="cellrowborder" width="50%">Service stopped.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900003</td>         <td class="cellrowborder" width="50%">Bluetooth disabled.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900099</td>         <td class="cellrowborder" width="50%">Operation failed.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wue-c106="" class="highlight-div"><div _ngcontent-wue-c106="" class="highlight-div-header"><div _ngcontent-wue-c106="" class="highlight-div-header-left"><div _ngcontent-wue-c106="" class="handle-button expand-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wue-c106="" class="highlight-div-header-right"><div _ngcontent-wue-c106="" class="handle-button ai-button"></div><div _ngcontent-wue-c106="" class="handle-button line-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wue-c106="" class="handle-button theme-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wue-c106="" class="handle-button copy-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wue-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AsyncCallback</span>, <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">onReceiveEvent</span>(<span class="hljs-params">data: <span class="hljs-built_in">Array</span>&lt;ble.ScanResult&gt;</span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'BLE scan device find result = '</span>+ <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data));</li><li>}</li><li><span class="hljs-keyword">try</span> {</li><li>    ble.<span class="hljs-title function_">on</span>(<span class="hljs-string">"BLEDeviceFind"</span>, onReceiveEvent);</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">scanFilter</span>: ble.<span class="hljs-property">ScanFilter</span> = {</li><li>            <span class="hljs-attr">deviceId</span>:<span class="hljs-string">"XX:XX:XX:XX:XX:XX"</span>,</li><li>            <span class="hljs-attr">name</span>:<span class="hljs-string">"test"</span>,</li><li>            <span class="hljs-attr">serviceUuid</span>:<span class="hljs-string">"00001888-0000-1000-8000-00805f9b34fb"</span></li><li>        };</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">scanOptions</span>: ble.<span class="hljs-property">ScanOptions</span> = {</li><li>    <span class="hljs-attr">interval</span>: <span class="hljs-number">500</span>,</li><li>    <span class="hljs-attr">dutyMode</span>: ble.<span class="hljs-property">ScanDuty</span>.<span class="hljs-property">SCAN_MODE_LOW_POWER</span>,</li><li>    <span class="hljs-attr">matchMode</span>: ble.<span class="hljs-property">MatchMode</span>.<span class="hljs-property">MATCH_MODE_AGGRESSIVE</span></li><li>    }</li><li>    ble.<span class="hljs-title function_">startBLEScan</span>([scanFilter],scanOptions);</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1206px;">     <h2 id="blestopblescan" device-type="phone,2in1,tablet,wearable,tv">ble.stopBLEScan<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="blestopblescan" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>stopBLEScan(): void</p>     <p>停止BLE扫描流程。</p>     <ul>      <li>停止的BLE扫描由<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#blestartblescan">ble.startBLEScan</a>触发。</li>      <li>当应用不再需要扫描BLE设备时，需主动调用该方法停止扫描。</li>      <li>调用此接口后将不再收到扫描结果上报，重新开启BLE扫描即可再次扫到BLE设备。</li>     </ul>     <p><strong>需要权限</strong>：ohos.permission.ACCESS_BLUETOOTH</p>     <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码说明文档</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-bluetoothmanager">蓝牙服务子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.10.10.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.10.10.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900001</td>         <td class="cellrowborder" width="50%">Service stopped.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900003</td>         <td class="cellrowborder" width="50%">Bluetooth disabled.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900099</td>         <td class="cellrowborder" width="50%">Operation failed.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wue-c106="" class="highlight-div"><div _ngcontent-wue-c106="" class="highlight-div-header"><div _ngcontent-wue-c106="" class="highlight-div-header-left"><div _ngcontent-wue-c106="" class="handle-button expand-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wue-c106="" class="highlight-div-header-right"><div _ngcontent-wue-c106="" class="handle-button ai-button"></div><div _ngcontent-wue-c106="" class="handle-button line-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wue-c106="" class="handle-button theme-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wue-c106="" class="handle-button copy-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wue-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AsyncCallback</span>, <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">try</span> {</li><li>    ble.<span class="hljs-title function_">stopBLEScan</span>();</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 2540px;">     <h2 id="blestartadvertising" device-type="phone,2in1,tablet,wearable,tv">ble.startAdvertising<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="blestartadvertising" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>startAdvertising(setting: AdvertiseSetting, advData: AdvertiseData, advResponse?: AdvertiseData): void</p>     <p>开始发送BLE广播报文。</p>     <ul>      <li>当应用不再需要发送BLE广播报文时，需主动调用<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#blestopadvertising">ble.stopAdvertising</a>停止发送。</li>      <li>同步接口，不要和API version 11的<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#blestopadvertising11">ble.stopAdvertising</a>搭配使用。</li>     </ul>     <p><strong>需要权限</strong>：ohos.permission.ACCESS_BLUETOOTH</p>     <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.11.9.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.11.9.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.11.9.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.11.9.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">setting</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#advertisesetting">AdvertiseSetting</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">BLE广播的相关参数。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">advData</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#advertisedata">AdvertiseData</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">BLE广播报文内容。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">advResponse</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#advertisedata">AdvertiseData</a></td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">BLE扫描回复广播报文。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码说明文档</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-bluetoothmanager">蓝牙服务子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.11.12.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.11.12.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Invalid parameter. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types. 3. Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900001</td>         <td class="cellrowborder" width="50%">Service stopped.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900003</td>         <td class="cellrowborder" width="50%">Bluetooth disabled.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900010</td>         <td class="cellrowborder" width="50%">The number of advertising resources reaches the upper limit.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900099</td>         <td class="cellrowborder" width="50%">Operation failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2902054</td>         <td class="cellrowborder" width="50%">The length of the advertising data exceeds the upper limit.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wue-c106="" class="highlight-div"><div _ngcontent-wue-c106="" class="highlight-div-header"><div _ngcontent-wue-c106="" class="highlight-div-header-left"><div _ngcontent-wue-c106="" class="handle-button expand-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wue-c106="" class="highlight-div-header-right"><div _ngcontent-wue-c106="" class="handle-button ai-button"></div><div _ngcontent-wue-c106="" class="handle-button line-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wue-c106="" class="handle-button theme-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wue-c106="" class="handle-button copy-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wue-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AsyncCallback</span>, <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">let</span> manufactureValueBuffer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(<span class="hljs-number">4</span>);</li><li>manufactureValueBuffer[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>;</li><li>manufactureValueBuffer[<span class="hljs-number">1</span>] = <span class="hljs-number">2</span>;</li><li>manufactureValueBuffer[<span class="hljs-number">2</span>] = <span class="hljs-number">3</span>;</li><li>manufactureValueBuffer[<span class="hljs-number">3</span>] = <span class="hljs-number">4</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> serviceValueBuffer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(<span class="hljs-number">4</span>);</li><li>serviceValueBuffer[<span class="hljs-number">0</span>] = <span class="hljs-number">4</span>;</li><li>serviceValueBuffer[<span class="hljs-number">1</span>] = <span class="hljs-number">6</span>;</li><li>serviceValueBuffer[<span class="hljs-number">2</span>] = <span class="hljs-number">7</span>;</li><li>serviceValueBuffer[<span class="hljs-number">3</span>] = <span class="hljs-number">8</span>;</li><li><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'manufactureValueBuffer = '</span>+ <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(manufactureValueBuffer));</li><li><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'serviceValueBuffer = '</span>+ <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(serviceValueBuffer));</li><li><span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">setting</span>: ble.<span class="hljs-property">AdvertiseSetting</span> = {</li><li>        <span class="hljs-attr">interval</span>:<span class="hljs-number">150</span>,</li><li>        <span class="hljs-attr">txPower</span>:<span class="hljs-number">0</span>,</li><li>        <span class="hljs-attr">connectable</span>:<span class="hljs-literal">true</span></li><li>    };</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">manufactureDataUnit</span>: ble.<span class="hljs-property">ManufactureData</span> = {</li><li>        <span class="hljs-attr">manufactureId</span>:<span class="hljs-number">4567</span>,</li><li>        <span class="hljs-attr">manufactureValue</span>:manufactureValueBuffer.<span class="hljs-property">buffer</span></li><li>    };</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">serviceDataUnit</span>: ble.<span class="hljs-property">ServiceData</span> = {</li><li>        <span class="hljs-attr">serviceUuid</span>:<span class="hljs-string">"00001888-0000-1000-8000-00805f9b34fb"</span>,</li><li>        <span class="hljs-attr">serviceValue</span>:serviceValueBuffer.<span class="hljs-property">buffer</span></li><li>    };</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">advData</span>: ble.<span class="hljs-property">AdvertiseData</span> = {</li><li>        <span class="hljs-attr">serviceUuids</span>:[<span class="hljs-string">"00001888-0000-1000-8000-00805f9b34fb"</span>],</li><li>        <span class="hljs-attr">manufactureData</span>:[manufactureDataUnit],</li><li>        <span class="hljs-attr">serviceData</span>:[serviceDataUnit]</li><li>    };</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">advResponse</span>: ble.<span class="hljs-property">AdvertiseData</span> = {</li><li>        <span class="hljs-attr">serviceUuids</span>:[<span class="hljs-string">"00001888-0000-1000-8000-00805f9b34fb"</span>],</li><li>        <span class="hljs-attr">manufactureData</span>:[manufactureDataUnit],</li><li>        <span class="hljs-attr">serviceData</span>:[serviceDataUnit]</li><li>    };</li><li>    ble.<span class="hljs-title function_">startAdvertising</span>(setting, advData ,advResponse);</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1206px;">     <h2 id="blestopadvertising" device-type="phone,2in1,tablet,wearable,tv">ble.stopAdvertising<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="blestopadvertising" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>stopAdvertising(): void</p>     <p>停止发送BLE广播报文。</p>     <ul>      <li>停止的BLE广播是由<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#blestartadvertising">ble.startAdvertising</a>触发的。</li>      <li>不可以和API version 11的<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#blestartadvertising11">ble.startAdvertising</a>搭配使用。</li>      <li>当应用不再需要发送BLE广播报文时，需主动调用该方法停止发送。</li>     </ul>     <p><strong>需要权限</strong>：ohos.permission.ACCESS_BLUETOOTH</p>     <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码说明文档</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-bluetoothmanager">蓝牙服务子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.12.10.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.12.10.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900001</td>         <td class="cellrowborder" width="50%">Service stopped.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900003</td>         <td class="cellrowborder" width="50%">Bluetooth disabled.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900099</td>         <td class="cellrowborder" width="50%">Operation failed.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wue-c106="" class="highlight-div"><div _ngcontent-wue-c106="" class="highlight-div-header"><div _ngcontent-wue-c106="" class="highlight-div-header-left"><div _ngcontent-wue-c106="" class="handle-button expand-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wue-c106="" class="highlight-div-header-right"><div _ngcontent-wue-c106="" class="handle-button ai-button"></div><div _ngcontent-wue-c106="" class="handle-button line-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wue-c106="" class="handle-button theme-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wue-c106="" class="handle-button copy-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wue-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AsyncCallback</span>, <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">try</span> {</li><li>    ble.<span class="hljs-title function_">stopAdvertising</span>();</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 2919px;">     <h2 id="blestartadvertising11" device-type="phone,2in1,tablet,wearable,tv">ble.startAdvertising<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="blestartadvertising11" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>startAdvertising(advertisingParams: AdvertisingParams, callback: AsyncCallback&lt;number&gt;): void</p>     <p>首次启动发送BLE广播报文。使用Callback异步回调。</p>     <ul>      <li>启动成功后，蓝牙子系统会分配相关资源，并使用Callback异步返回该广播的标识。</li>      <li>若携带了发送广播持续时间，则一定时间后，广播会停止发送，但分配的广播资源还存在，可以通过<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#bleenableadvertising11">ble.enableAdvertising</a>重新启动发送该广播。</li>      <li>从API version 15开始，应用可多次调用，支持发起多路广播，每一路广播通过不同的ID标识管理。</li>      <li>当应用不再需要该广播时，需调用API version 11开始支持的<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#blestopadvertising11">ble.stopAdvertising</a>完全停止该广播，不要与API version 10开始支持的<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#blestopadvertising">ble.stopAdvertising</a>混用。</li>     </ul>     <p><strong>需要权限</strong>：ohos.permission.ACCESS_BLUETOOTH</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.13.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.13.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.13.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.13.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">advertisingParams</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#advertisingparams11">AdvertisingParams</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">启动BLE广播的相关参数。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;number&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">广播ID标识，通过注册回调函数获取。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码说明文档</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-bluetoothmanager">蓝牙服务子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.13.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.13.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Invalid parameter. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types. 3. Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900001</td>         <td class="cellrowborder" width="50%">Service stopped.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900003</td>         <td class="cellrowborder" width="50%">Bluetooth disabled.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900010</td>         <td class="cellrowborder" width="50%">The number of advertising resources reaches the upper limit.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900099</td>         <td class="cellrowborder" width="50%">Operation failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2902054</td>         <td class="cellrowborder" width="50%">The length of the advertising data exceeds the upper limit.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wue-c106="" class="highlight-div"><div _ngcontent-wue-c106="" class="highlight-div-header"><div _ngcontent-wue-c106="" class="highlight-div-header-left"><div _ngcontent-wue-c106="" class="handle-button expand-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wue-c106="" class="highlight-div-header-right"><div _ngcontent-wue-c106="" class="handle-button ai-button"></div><div _ngcontent-wue-c106="" class="handle-button line-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wue-c106="" class="handle-button theme-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wue-c106="" class="handle-button copy-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wue-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AsyncCallback</span>, <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">let</span> manufactureValueBuffer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(<span class="hljs-number">4</span>);</li><li>manufactureValueBuffer[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>;</li><li>manufactureValueBuffer[<span class="hljs-number">1</span>] = <span class="hljs-number">2</span>;</li><li>manufactureValueBuffer[<span class="hljs-number">2</span>] = <span class="hljs-number">3</span>;</li><li>manufactureValueBuffer[<span class="hljs-number">3</span>] = <span class="hljs-number">4</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> serviceValueBuffer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(<span class="hljs-number">4</span>);</li><li>serviceValueBuffer[<span class="hljs-number">0</span>] = <span class="hljs-number">4</span>;</li><li>serviceValueBuffer[<span class="hljs-number">1</span>] = <span class="hljs-number">6</span>;</li><li>serviceValueBuffer[<span class="hljs-number">2</span>] = <span class="hljs-number">7</span>;</li><li>serviceValueBuffer[<span class="hljs-number">3</span>] = <span class="hljs-number">8</span>;</li><li><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'manufactureValueBuffer = '</span>+ <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(manufactureValueBuffer));</li><li><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'serviceValueBuffer = '</span>+ <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(serviceValueBuffer));</li><li><span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">setting</span>: ble.<span class="hljs-property">AdvertiseSetting</span> = {</li><li>        <span class="hljs-attr">interval</span>:<span class="hljs-number">150</span>,</li><li>        <span class="hljs-attr">txPower</span>:<span class="hljs-number">0</span>,</li><li>        <span class="hljs-attr">connectable</span>:<span class="hljs-literal">true</span>,</li><li>    };</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">manufactureDataUnit</span>: ble.<span class="hljs-property">ManufactureData</span> = {</li><li>        <span class="hljs-attr">manufactureId</span>:<span class="hljs-number">4567</span>,</li><li>        <span class="hljs-attr">manufactureValue</span>:manufactureValueBuffer.<span class="hljs-property">buffer</span></li><li>    };</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">serviceDataUnit</span>: ble.<span class="hljs-property">ServiceData</span> = {</li><li>        <span class="hljs-attr">serviceUuid</span>:<span class="hljs-string">"00001888-0000-1000-8000-00805f9b34fb"</span>,</li><li>        <span class="hljs-attr">serviceValue</span>:serviceValueBuffer.<span class="hljs-property">buffer</span></li><li>    };</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">advData</span>: ble.<span class="hljs-property">AdvertiseData</span> = {</li><li>        <span class="hljs-attr">serviceUuids</span>:[<span class="hljs-string">"00001888-0000-1000-8000-00805f9b34fb"</span>],</li><li>        <span class="hljs-attr">manufactureData</span>:[manufactureDataUnit],</li><li>        <span class="hljs-attr">serviceData</span>:[serviceDataUnit]</li><li>    };</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">advResponse</span>: ble.<span class="hljs-property">AdvertiseData</span> = {</li><li>        <span class="hljs-attr">serviceUuids</span>:[<span class="hljs-string">"00001888-0000-1000-8000-00805f9b34fb"</span>],</li><li>        <span class="hljs-attr">manufactureData</span>:[manufactureDataUnit],</li><li>        <span class="hljs-attr">serviceData</span>:[serviceDataUnit]</li><li>    };</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">advertisingParams</span>: ble.<span class="hljs-property">AdvertisingParams</span> = {</li><li>        <span class="hljs-attr">advertisingSettings</span>: setting,</li><li>        <span class="hljs-attr">advertisingData</span>: advData,</li><li>        <span class="hljs-attr">advertisingResponse</span>: advResponse,</li><li>        <span class="hljs-attr">duration</span>: <span class="hljs-number">0</span></li><li>    }</li><li>    <span class="hljs-keyword">let</span> advHandle = <span class="hljs-number">0xFF</span>;</li><li>    ble.<span class="hljs-title function_">startAdvertising</span>(advertisingParams, <span class="hljs-function">(<span class="hljs-params">err, outAdvHandle</span>) =&gt;</span> {</li><li>        <span class="hljs-keyword">if</span> (err) {</li><li>            <span class="hljs-keyword">return</span>;</li><li>        } <span class="hljs-keyword">else</span> {</li><li>            advHandle = outAdvHandle;</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"advHandle: "</span> + advHandle);</li><li>        }</li><li>    });</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 2925px;">     <h2 id="blestartadvertising11-1" device-type="phone,2in1,tablet,wearable,tv">ble.startAdvertising<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="blestartadvertising11-1" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>startAdvertising(advertisingParams: AdvertisingParams): Promise&lt;number&gt;</p>     <p>首次启动发送BLE广播报文。使用Promise异步回调。</p>     <ul>      <li>启动成功后，蓝牙子系统会分配相关资源，并使用Promise异步返回该广播的标识。</li>      <li>若携带了发送广播持续时间，则一定时间后，广播会停止发送，但分配的广播资源还存在，可以通过<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#bleenableadvertising11">ble.enableAdvertising</a>重新启动发送该广播。</li>      <li>从API version 15开始，应用可多次调用，支持发起多路广播，每一路广播通过不同的ID标识管理。</li>      <li>当应用不再需要该广播时，需调用API version 11开始支持的<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#blestopadvertising11-1">ble.stopAdvertising</a>完全停止该广播，不要与API version 10开始支持的<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#blestopadvertising">ble.stopAdvertising</a>混用。</li>     </ul>     <p><strong>需要权限</strong>：ohos.permission.ACCESS_BLUETOOTH</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.14.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.14.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.14.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.14.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">advertisingParams</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#advertisingparams11">AdvertisingParams</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">启动BLE广播的相关参数。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.14.10.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.14.10.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;number&gt;</td>         <td class="cellrowborder" width="50%">广播ID标识，通过promise形式获取。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码说明文档</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-bluetoothmanager">蓝牙服务子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.14.13.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.14.13.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Invalid parameter. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types. 3. Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900001</td>         <td class="cellrowborder" width="50%">Service stopped.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900003</td>         <td class="cellrowborder" width="50%">Bluetooth disabled.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900010</td>         <td class="cellrowborder" width="50%">The number of advertising resources reaches the upper limit.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900099</td>         <td class="cellrowborder" width="50%">Operation failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2902054</td>         <td class="cellrowborder" width="50%">The length of the advertising data exceeds the upper limit.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wue-c106="" class="highlight-div"><div _ngcontent-wue-c106="" class="highlight-div-header"><div _ngcontent-wue-c106="" class="highlight-div-header-left"><div _ngcontent-wue-c106="" class="handle-button expand-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wue-c106="" class="highlight-div-header-right"><div _ngcontent-wue-c106="" class="handle-button ai-button"></div><div _ngcontent-wue-c106="" class="handle-button line-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wue-c106="" class="handle-button theme-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wue-c106="" class="handle-button copy-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wue-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AsyncCallback</span>, <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">let</span> manufactureValueBuffer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(<span class="hljs-number">4</span>);</li><li>manufactureValueBuffer[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>;</li><li>manufactureValueBuffer[<span class="hljs-number">1</span>] = <span class="hljs-number">2</span>;</li><li>manufactureValueBuffer[<span class="hljs-number">2</span>] = <span class="hljs-number">3</span>;</li><li>manufactureValueBuffer[<span class="hljs-number">3</span>] = <span class="hljs-number">4</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> serviceValueBuffer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(<span class="hljs-number">4</span>);</li><li>serviceValueBuffer[<span class="hljs-number">0</span>] = <span class="hljs-number">4</span>;</li><li>serviceValueBuffer[<span class="hljs-number">1</span>] = <span class="hljs-number">6</span>;</li><li>serviceValueBuffer[<span class="hljs-number">2</span>] = <span class="hljs-number">7</span>;</li><li>serviceValueBuffer[<span class="hljs-number">3</span>] = <span class="hljs-number">8</span>;</li><li><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'manufactureValueBuffer = '</span>+ <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(manufactureValueBuffer));</li><li><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'serviceValueBuffer = '</span>+ <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(serviceValueBuffer));</li><li><span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">setting</span>: ble.<span class="hljs-property">AdvertiseSetting</span> = {</li><li>        <span class="hljs-attr">interval</span>:<span class="hljs-number">150</span>,</li><li>        <span class="hljs-attr">txPower</span>:<span class="hljs-number">0</span>,</li><li>        <span class="hljs-attr">connectable</span>:<span class="hljs-literal">true</span></li><li>    };</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">manufactureDataUnit</span>: ble.<span class="hljs-property">ManufactureData</span> = {</li><li>        <span class="hljs-attr">manufactureId</span>:<span class="hljs-number">4567</span>,</li><li>        <span class="hljs-attr">manufactureValue</span>:manufactureValueBuffer.<span class="hljs-property">buffer</span></li><li>    };</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">serviceDataUnit</span>: ble.<span class="hljs-property">ServiceData</span> = {</li><li>        <span class="hljs-attr">serviceUuid</span>:<span class="hljs-string">"00001888-0000-1000-8000-00805f9b34fb"</span>,</li><li>        <span class="hljs-attr">serviceValue</span>:serviceValueBuffer.<span class="hljs-property">buffer</span></li><li>    };</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">advData</span>: ble.<span class="hljs-property">AdvertiseData</span> = {</li><li>        <span class="hljs-attr">serviceUuids</span>:[<span class="hljs-string">"00001888-0000-1000-8000-00805f9b34fb"</span>],</li><li>        <span class="hljs-attr">manufactureData</span>:[manufactureDataUnit],</li><li>        <span class="hljs-attr">serviceData</span>:[serviceDataUnit]</li><li>    };</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">advResponse</span>: ble.<span class="hljs-property">AdvertiseData</span> = {</li><li>        <span class="hljs-attr">serviceUuids</span>:[<span class="hljs-string">"00001888-0000-1000-8000-00805f9b34fb"</span>],</li><li>        <span class="hljs-attr">manufactureData</span>:[manufactureDataUnit],</li><li>        <span class="hljs-attr">serviceData</span>:[serviceDataUnit]</li><li>    };</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">advertisingParams</span>: ble.<span class="hljs-property">AdvertisingParams</span> = {</li><li>        <span class="hljs-attr">advertisingSettings</span>: setting,</li><li>        <span class="hljs-attr">advertisingData</span>: advData,</li><li>        <span class="hljs-attr">advertisingResponse</span>: advResponse,</li><li>        <span class="hljs-attr">duration</span>: <span class="hljs-number">0</span></li><li>    }</li><li>    <span class="hljs-keyword">let</span> advHandle = <span class="hljs-number">0xFF</span>;</li><li>    ble.<span class="hljs-title function_">startAdvertising</span>(advertisingParams)</li><li>        .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">outAdvHandle</span> =&gt;</span> {</li><li>            advHandle = outAdvHandle;</li><li>    });</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 3056px;">     <h2 id="bleenableadvertising11" device-type="phone,2in1,tablet,wearable,tv">ble.enableAdvertising<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="bleenableadvertising11" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>enableAdvertising(advertisingEnableParams: AdvertisingEnableParams, callback: AsyncCallback&lt;void&gt;): void</p>     <p>重新启动指定标识的BLE广播。使用Callback异步回调。</p>     <ul>      <li><a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#advertisingenableparams11">AdvertisingEnableParams</a>中advertisingId对应的广播资源已在<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#blestartadvertising11">ble.startAdvertising</a>首次启动广播时分配。</li>      <li>若<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#blestartadvertising11">ble.startAdvertising</a>首次启动广播时指定了广播持续时间，超时后广播自动停止，调用此接口可重新启动同一路BLE广播。</li>      <li>通过<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#bledisableadvertising11">ble.disableAdvertising</a>停止的广播，调用此接口可重新启动同一路BLE广播。</li>      <li>通过<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#bleonadvertisingstatechange11">ble.on('advertisingStateChange')</a>回调获取重新启动广播结果。</li>     </ul>     <p><strong>需要权限</strong>：ohos.permission.ACCESS_BLUETOOTH</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.15.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.15.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.15.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.15.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">advertisingEnableParams</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#advertisingenableparams11">AdvertisingEnableParams</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">临时启动BLE广播的相关参数。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;void&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码说明文档</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-bluetoothmanager">蓝牙服务子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.15.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.15.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Invalid parameter. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900001</td>         <td class="cellrowborder" width="50%">Service stopped.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900003</td>         <td class="cellrowborder" width="50%">Bluetooth disabled.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900099</td>         <td class="cellrowborder" width="50%">Operation failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2902055</td>         <td class="cellrowborder" width="50%">Invalid advertising id.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wue-c106="" class="highlight-div"><div _ngcontent-wue-c106="" class="highlight-div-header"><div _ngcontent-wue-c106="" class="highlight-div-header-left"><div _ngcontent-wue-c106="" class="handle-button expand-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wue-c106="" class="highlight-div-header-right"><div _ngcontent-wue-c106="" class="handle-button ai-button"></div><div _ngcontent-wue-c106="" class="handle-button line-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wue-c106="" class="handle-button theme-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wue-c106="" class="handle-button copy-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wue-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AsyncCallback</span>, <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">let</span> manufactureValueBuffer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(<span class="hljs-number">4</span>);</li><li>manufactureValueBuffer[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>;</li><li>manufactureValueBuffer[<span class="hljs-number">1</span>] = <span class="hljs-number">2</span>;</li><li>manufactureValueBuffer[<span class="hljs-number">2</span>] = <span class="hljs-number">3</span>;</li><li>manufactureValueBuffer[<span class="hljs-number">3</span>] = <span class="hljs-number">4</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> serviceValueBuffer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(<span class="hljs-number">4</span>);</li><li>serviceValueBuffer[<span class="hljs-number">0</span>] = <span class="hljs-number">4</span>;</li><li>serviceValueBuffer[<span class="hljs-number">1</span>] = <span class="hljs-number">6</span>;</li><li>serviceValueBuffer[<span class="hljs-number">2</span>] = <span class="hljs-number">7</span>;</li><li>serviceValueBuffer[<span class="hljs-number">3</span>] = <span class="hljs-number">8</span>;</li><li><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'manufactureValueBuffer = '</span>+ <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(manufactureValueBuffer));</li><li><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'serviceValueBuffer = '</span>+ <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(serviceValueBuffer));</li><li><span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">setting</span>: ble.<span class="hljs-property">AdvertiseSetting</span> = {</li><li>        <span class="hljs-attr">interval</span>:<span class="hljs-number">150</span>,</li><li>        <span class="hljs-attr">txPower</span>:<span class="hljs-number">0</span>,</li><li>        <span class="hljs-attr">connectable</span>:<span class="hljs-literal">true</span></li><li>    };</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">manufactureDataUnit</span>: ble.<span class="hljs-property">ManufactureData</span> = {</li><li>        <span class="hljs-attr">manufactureId</span>:<span class="hljs-number">4567</span>,</li><li>        <span class="hljs-attr">manufactureValue</span>:manufactureValueBuffer.<span class="hljs-property">buffer</span></li><li>    };</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">serviceDataUnit</span>: ble.<span class="hljs-property">ServiceData</span> = {</li><li>        <span class="hljs-attr">serviceUuid</span>:<span class="hljs-string">"00001888-0000-1000-8000-00805f9b34fb"</span>,</li><li>        <span class="hljs-attr">serviceValue</span>:serviceValueBuffer.<span class="hljs-property">buffer</span></li><li>    };</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">advData</span>: ble.<span class="hljs-property">AdvertiseData</span> = {</li><li>        <span class="hljs-attr">serviceUuids</span>:[<span class="hljs-string">"00001888-0000-1000-8000-00805f9b34fb"</span>],</li><li>        <span class="hljs-attr">manufactureData</span>:[manufactureDataUnit],</li><li>        <span class="hljs-attr">serviceData</span>:[serviceDataUnit]</li><li>    };</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">advResponse</span>: ble.<span class="hljs-property">AdvertiseData</span> = {</li><li>        <span class="hljs-attr">serviceUuids</span>:[<span class="hljs-string">"00001888-0000-1000-8000-00805f9b34fb"</span>],</li><li>        <span class="hljs-attr">manufactureData</span>:[manufactureDataUnit],</li><li>        <span class="hljs-attr">serviceData</span>:[serviceDataUnit]</li><li>    };</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">advertisingParams</span>: ble.<span class="hljs-property">AdvertisingParams</span> = {</li><li>        <span class="hljs-attr">advertisingSettings</span>: setting,</li><li>        <span class="hljs-attr">advertisingData</span>: advData,</li><li>        <span class="hljs-attr">advertisingResponse</span>: advResponse,</li><li>        <span class="hljs-attr">duration</span>: <span class="hljs-number">300</span></li><li>    }</li><li>    <span class="hljs-keyword">let</span> advHandle = <span class="hljs-number">0xFF</span>;</li><li>    ble.<span class="hljs-title function_">startAdvertising</span>(advertisingParams, <span class="hljs-function">(<span class="hljs-params">err, outAdvHandle</span>) =&gt;</span> {</li><li>        <span class="hljs-keyword">if</span> (err) {</li><li>            <span class="hljs-keyword">return</span>;</li><li>        } <span class="hljs-keyword">else</span> {</li><li>            advHandle = outAdvHandle;</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"advHandle: "</span> + advHandle);</li><li>        }</li><li>    });</li><li>
</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">advertisingEnableParams</span>: ble.<span class="hljs-property">AdvertisingEnableParams</span> = {</li><li>        <span class="hljs-attr">advertisingId</span>: advHandle,</li><li>        <span class="hljs-attr">duration</span>: <span class="hljs-number">0</span></li><li>    }</li><li>
</li><li>    <span class="hljs-comment">// after 3s, advertising disabled, then enable the advertising</span></li><li>    ble.<span class="hljs-title function_">enableAdvertising</span>(advertisingEnableParams, <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> {</li><li>        <span class="hljs-keyword">if</span> (err) {</li><li>            <span class="hljs-keyword">return</span>;</li><li>        }</li><li>    });</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 3158px;">     <h2 id="bleenableadvertising11-1" device-type="phone,2in1,tablet,wearable,tv">ble.enableAdvertising<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="bleenableadvertising11-1" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>enableAdvertising(advertisingEnableParams: AdvertisingEnableParams): Promise&lt;void&gt;</p>     <p>重新启动指定标识的BLE广播。使用Promise异步回调。</p>     <ul>      <li><a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#advertisingenableparams11">AdvertisingEnableParams</a>中advertisingId对应的广播资源已在<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#blestartadvertising11">ble.startAdvertising</a>首次启动广播时分配。</li>      <li>若<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#blestartadvertising11">ble.startAdvertising</a>首次启动广播时指定了广播持续时间，超时后广播自动停止，调用此接口可重新启动同一路BLE广播。</li>      <li>通过<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#bledisableadvertising11">ble.disableAdvertising</a>停止的广播，调用此接口可重新启动同一路BLE广播。</li>      <li>通过<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#bleonadvertisingstatechange11">ble.on('advertisingStateChange')</a>回调获取启动广播结果。</li>     </ul>     <p><strong>需要权限</strong>：ohos.permission.ACCESS_BLUETOOTH</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.16.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.16.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.16.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.16.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">advertisingEnableParams</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#advertisingenableparams11">AdvertisingEnableParams</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">临时启动BLE广播的相关参数。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.16.10.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.16.10.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">回调函数。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码说明文档</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-bluetoothmanager">蓝牙服务子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.16.13.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.16.13.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Invalid parameter. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900001</td>         <td class="cellrowborder" width="50%">Service stopped.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900003</td>         <td class="cellrowborder" width="50%">Bluetooth disabled.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900099</td>         <td class="cellrowborder" width="50%">Operation failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2902055</td>         <td class="cellrowborder" width="50%">Invalid advertising id.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wue-c106="" class="highlight-div"><div _ngcontent-wue-c106="" class="highlight-div-header"><div _ngcontent-wue-c106="" class="highlight-div-header-left"><div _ngcontent-wue-c106="" class="handle-button expand-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wue-c106="" class="highlight-div-header-right"><div _ngcontent-wue-c106="" class="handle-button ai-button"></div><div _ngcontent-wue-c106="" class="handle-button line-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wue-c106="" class="handle-button theme-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wue-c106="" class="handle-button copy-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wue-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AsyncCallback</span>, <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">let</span> manufactureValueBuffer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(<span class="hljs-number">4</span>);</li><li>manufactureValueBuffer[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>;</li><li>manufactureValueBuffer[<span class="hljs-number">1</span>] = <span class="hljs-number">2</span>;</li><li>manufactureValueBuffer[<span class="hljs-number">2</span>] = <span class="hljs-number">3</span>;</li><li>manufactureValueBuffer[<span class="hljs-number">3</span>] = <span class="hljs-number">4</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> serviceValueBuffer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(<span class="hljs-number">4</span>);</li><li>serviceValueBuffer[<span class="hljs-number">0</span>] = <span class="hljs-number">4</span>;</li><li>serviceValueBuffer[<span class="hljs-number">1</span>] = <span class="hljs-number">6</span>;</li><li>serviceValueBuffer[<span class="hljs-number">2</span>] = <span class="hljs-number">7</span>;</li><li>serviceValueBuffer[<span class="hljs-number">3</span>] = <span class="hljs-number">8</span>;</li><li><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'manufactureValueBuffer = '</span>+ <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(manufactureValueBuffer));</li><li><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'serviceValueBuffer = '</span>+ <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(serviceValueBuffer));</li><li><span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">setting</span>: ble.<span class="hljs-property">AdvertiseSetting</span> = {</li><li>        <span class="hljs-attr">interval</span>:<span class="hljs-number">150</span>,</li><li>        <span class="hljs-attr">txPower</span>:<span class="hljs-number">0</span>,</li><li>        <span class="hljs-attr">connectable</span>:<span class="hljs-literal">true</span></li><li>    };</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">manufactureDataUnit</span>: ble.<span class="hljs-property">ManufactureData</span> = {</li><li>        <span class="hljs-attr">manufactureId</span>:<span class="hljs-number">4567</span>,</li><li>        <span class="hljs-attr">manufactureValue</span>:manufactureValueBuffer.<span class="hljs-property">buffer</span></li><li>    };</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">serviceDataUnit</span>: ble.<span class="hljs-property">ServiceData</span> = {</li><li>        <span class="hljs-attr">serviceUuid</span>:<span class="hljs-string">"00001888-0000-1000-8000-00805f9b34fb"</span>,</li><li>        <span class="hljs-attr">serviceValue</span>:serviceValueBuffer.<span class="hljs-property">buffer</span></li><li>    };</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">advData</span>: ble.<span class="hljs-property">AdvertiseData</span> = {</li><li>        <span class="hljs-attr">serviceUuids</span>:[<span class="hljs-string">"00001888-0000-1000-8000-00805f9b34fb"</span>],</li><li>        <span class="hljs-attr">manufactureData</span>:[manufactureDataUnit],</li><li>        <span class="hljs-attr">serviceData</span>:[serviceDataUnit]</li><li>    };</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">advResponse</span>: ble.<span class="hljs-property">AdvertiseData</span> = {</li><li>        <span class="hljs-attr">serviceUuids</span>:[<span class="hljs-string">"00001888-0000-1000-8000-00805f9b34fb"</span>],</li><li>        <span class="hljs-attr">manufactureData</span>:[manufactureDataUnit],</li><li>        <span class="hljs-attr">serviceData</span>:[serviceDataUnit]</li><li>    };</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">advertisingParams</span>: ble.<span class="hljs-property">AdvertisingParams</span> = {</li><li>        <span class="hljs-attr">advertisingSettings</span>: setting,</li><li>        <span class="hljs-attr">advertisingData</span>: advData,</li><li>        <span class="hljs-attr">advertisingResponse</span>: advResponse,</li><li>        <span class="hljs-attr">duration</span>: <span class="hljs-number">300</span></li><li>    }</li><li>    <span class="hljs-keyword">let</span> advHandle = <span class="hljs-number">0xFF</span>;</li><li>    ble.<span class="hljs-title function_">startAdvertising</span>(advertisingParams, <span class="hljs-function">(<span class="hljs-params">err, outAdvHandle</span>) =&gt;</span> {</li><li>        <span class="hljs-keyword">if</span> (err) {</li><li>            <span class="hljs-keyword">return</span>;</li><li>        } <span class="hljs-keyword">else</span> {</li><li>            advHandle = outAdvHandle;</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"advHandle: "</span> + advHandle);</li><li>        }</li><li>    });</li><li>
</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">advertisingEnableParams</span>: ble.<span class="hljs-property">AdvertisingEnableParams</span> = {</li><li>        <span class="hljs-attr">advertisingId</span>: advHandle,</li><li>        <span class="hljs-attr">duration</span>: <span class="hljs-number">0</span></li><li>    }</li><li>
</li><li>    <span class="hljs-comment">// after 3s, advertising disabled, then enable the advertising</span></li><li>    ble.<span class="hljs-title function_">enableAdvertising</span>(advertisingEnableParams)</li><li>        .<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"enable success"</span>);</li><li>    });</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 2952px;">     <h2 id="bledisableadvertising11" device-type="phone,2in1,tablet,wearable,tv">ble.disableAdvertising<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="bledisableadvertising11" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>disableAdvertising(advertisingDisableParams: AdvertisingDisableParams, callback: AsyncCallback&lt;void&gt;): void</p>     <p>停止指定标识的BLE广播。使用Callback异步回调。</p>     <ul>      <li>停止BLE广播，但不释放已申请的广播资源，调用<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#bleenableadvertising11">ble.enableAdvertising</a>可重新启动此方法停止的广播。</li>      <li><a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#advertisingdisableparams11">AdvertisingDisableParams</a>中advertisingId对应的广播资源已在<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#blestartadvertising11">ble.startAdvertising</a>首次启动广播时分配。</li>      <li>通过<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#bleonadvertisingstatechange11">ble.on('advertisingStateChange')</a>回调获取停止广播结果。</li>     </ul>     <p><strong>需要权限</strong>：ohos.permission.ACCESS_BLUETOOTH</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.17.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.17.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.17.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.17.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">advertisingDisableParams</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#advertisingdisableparams11">AdvertisingDisableParams</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">临时关闭BLE广播的相关参数。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;void&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码说明文档</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-bluetoothmanager">蓝牙服务子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.17.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.17.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Invalid parameter. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900001</td>         <td class="cellrowborder" width="50%">Service stopped.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900003</td>         <td class="cellrowborder" width="50%">Bluetooth disabled.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900099</td>         <td class="cellrowborder" width="50%">Operation failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2902055</td>         <td class="cellrowborder" width="50%">Invalid advertising id.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wue-c106="" class="highlight-div"><div _ngcontent-wue-c106="" class="highlight-div-header"><div _ngcontent-wue-c106="" class="highlight-div-header-left"><div _ngcontent-wue-c106="" class="handle-button expand-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wue-c106="" class="highlight-div-header-right"><div _ngcontent-wue-c106="" class="handle-button ai-button"></div><div _ngcontent-wue-c106="" class="handle-button line-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wue-c106="" class="handle-button theme-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wue-c106="" class="handle-button copy-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wue-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AsyncCallback</span>, <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">let</span> manufactureValueBuffer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(<span class="hljs-number">4</span>);</li><li>manufactureValueBuffer[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>;</li><li>manufactureValueBuffer[<span class="hljs-number">1</span>] = <span class="hljs-number">2</span>;</li><li>manufactureValueBuffer[<span class="hljs-number">2</span>] = <span class="hljs-number">3</span>;</li><li>manufactureValueBuffer[<span class="hljs-number">3</span>] = <span class="hljs-number">4</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> serviceValueBuffer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(<span class="hljs-number">4</span>);</li><li>serviceValueBuffer[<span class="hljs-number">0</span>] = <span class="hljs-number">4</span>;</li><li>serviceValueBuffer[<span class="hljs-number">1</span>] = <span class="hljs-number">6</span>;</li><li>serviceValueBuffer[<span class="hljs-number">2</span>] = <span class="hljs-number">7</span>;</li><li>serviceValueBuffer[<span class="hljs-number">3</span>] = <span class="hljs-number">8</span>;</li><li><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'manufactureValueBuffer = '</span>+ <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(manufactureValueBuffer));</li><li><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'serviceValueBuffer = '</span>+ <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(serviceValueBuffer));</li><li><span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">setting</span>: ble.<span class="hljs-property">AdvertiseSetting</span> = {</li><li>        <span class="hljs-attr">interval</span>:<span class="hljs-number">150</span>,</li><li>        <span class="hljs-attr">txPower</span>:<span class="hljs-number">0</span>,</li><li>        <span class="hljs-attr">connectable</span>:<span class="hljs-literal">true</span></li><li>    };</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">manufactureDataUnit</span>: ble.<span class="hljs-property">ManufactureData</span> = {</li><li>        <span class="hljs-attr">manufactureId</span>:<span class="hljs-number">4567</span>,</li><li>        <span class="hljs-attr">manufactureValue</span>:manufactureValueBuffer.<span class="hljs-property">buffer</span></li><li>    };</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">serviceDataUnit</span>: ble.<span class="hljs-property">ServiceData</span> = {</li><li>        <span class="hljs-attr">serviceUuid</span>:<span class="hljs-string">"00001888-0000-1000-8000-00805f9b34fb"</span>,</li><li>        <span class="hljs-attr">serviceValue</span>:serviceValueBuffer.<span class="hljs-property">buffer</span></li><li>    };</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">advData</span>: ble.<span class="hljs-property">AdvertiseData</span> = {</li><li>        <span class="hljs-attr">serviceUuids</span>:[<span class="hljs-string">"00001888-0000-1000-8000-00805f9b34fb"</span>],</li><li>        <span class="hljs-attr">manufactureData</span>:[manufactureDataUnit],</li><li>        <span class="hljs-attr">serviceData</span>:[serviceDataUnit]</li><li>    };</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">advResponse</span>: ble.<span class="hljs-property">AdvertiseData</span> = {</li><li>        <span class="hljs-attr">serviceUuids</span>:[<span class="hljs-string">"00001888-0000-1000-8000-00805f9b34fb"</span>],</li><li>        <span class="hljs-attr">manufactureData</span>:[manufactureDataUnit],</li><li>        <span class="hljs-attr">serviceData</span>:[serviceDataUnit]</li><li>    };</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">advertisingParams</span>: ble.<span class="hljs-property">AdvertisingParams</span> = {</li><li>        <span class="hljs-attr">advertisingSettings</span>: setting,</li><li>        <span class="hljs-attr">advertisingData</span>: advData,</li><li>        <span class="hljs-attr">advertisingResponse</span>: advResponse,</li><li>        <span class="hljs-attr">duration</span>: <span class="hljs-number">0</span></li><li>    }</li><li>    <span class="hljs-keyword">let</span> advHandle = <span class="hljs-number">0xFF</span>;</li><li>    ble.<span class="hljs-title function_">startAdvertising</span>(advertisingParams, <span class="hljs-function">(<span class="hljs-params">err, outAdvHandle</span>) =&gt;</span> {</li><li>        <span class="hljs-keyword">if</span> (err) {</li><li>            <span class="hljs-keyword">return</span>;</li><li>        } <span class="hljs-keyword">else</span> {</li><li>            advHandle = outAdvHandle;</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"advHandle: "</span> + advHandle);</li><li>        }</li><li>    });</li><li>
</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">advertisingDisableParams</span>: ble.<span class="hljs-property">AdvertisingDisableParams</span> = {</li><li>        <span class="hljs-attr">advertisingId</span>: advHandle</li><li>    }</li><li>    ble.<span class="hljs-title function_">disableAdvertising</span>(advertisingDisableParams, <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> {</li><li>        <span class="hljs-keyword">if</span> (err) {</li><li>            <span class="hljs-keyword">return</span>;</li><li>        }</li><li>    });</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 3054px;">     <h2 id="bledisableadvertising11-1" device-type="phone,2in1,tablet,wearable,tv">ble.disableAdvertising<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="bledisableadvertising11-1" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>disableAdvertising(advertisingDisableParams: AdvertisingDisableParams): Promise&lt;void&gt;</p>     <p>停止指定标识的BLE广播。使用Promise异步回调。</p>     <ul>      <li>停止BLE广播，但不释放已申请的广播资源，调用<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#bleenableadvertising11">ble.enableAdvertising</a>可重新启动此方法停止的广播。</li>      <li><a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#advertisingdisableparams11">AdvertisingDisableParams</a>中advertisingId对应的广播资源已在<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#blestartadvertising11">ble.startAdvertising</a>首次启动广播时分配。</li>      <li>通过<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#bleonadvertisingstatechange11">ble.on('advertisingStateChange')</a>回调获取停止广播结果。</li>     </ul>     <p><strong>需要权限</strong>：ohos.permission.ACCESS_BLUETOOTH</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.18.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.18.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.18.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.18.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">advertisingDisableParams</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#advertisingdisableparams11">AdvertisingDisableParams</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">临时关闭BLE广播的相关参数。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.18.10.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.18.10.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">回调函数。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码说明文档</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-bluetoothmanager">蓝牙服务子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.18.13.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.18.13.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Invalid parameter. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900001</td>         <td class="cellrowborder" width="50%">Service stopped.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900003</td>         <td class="cellrowborder" width="50%">Bluetooth disabled.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900099</td>         <td class="cellrowborder" width="50%">Operation failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2902055</td>         <td class="cellrowborder" width="50%">Invalid advertising id.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wue-c106="" class="highlight-div"><div _ngcontent-wue-c106="" class="highlight-div-header"><div _ngcontent-wue-c106="" class="highlight-div-header-left"><div _ngcontent-wue-c106="" class="handle-button expand-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wue-c106="" class="highlight-div-header-right"><div _ngcontent-wue-c106="" class="handle-button ai-button"></div><div _ngcontent-wue-c106="" class="handle-button line-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wue-c106="" class="handle-button theme-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wue-c106="" class="handle-button copy-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wue-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AsyncCallback</span>, <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">let</span> manufactureValueBuffer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(<span class="hljs-number">4</span>);</li><li>manufactureValueBuffer[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>;</li><li>manufactureValueBuffer[<span class="hljs-number">1</span>] = <span class="hljs-number">2</span>;</li><li>manufactureValueBuffer[<span class="hljs-number">2</span>] = <span class="hljs-number">3</span>;</li><li>manufactureValueBuffer[<span class="hljs-number">3</span>] = <span class="hljs-number">4</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> serviceValueBuffer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(<span class="hljs-number">4</span>);</li><li>serviceValueBuffer[<span class="hljs-number">0</span>] = <span class="hljs-number">4</span>;</li><li>serviceValueBuffer[<span class="hljs-number">1</span>] = <span class="hljs-number">6</span>;</li><li>serviceValueBuffer[<span class="hljs-number">2</span>] = <span class="hljs-number">7</span>;</li><li>serviceValueBuffer[<span class="hljs-number">3</span>] = <span class="hljs-number">8</span>;</li><li><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'manufactureValueBuffer = '</span>+ <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(manufactureValueBuffer));</li><li><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'serviceValueBuffer = '</span>+ <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(serviceValueBuffer));</li><li><span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">setting</span>: ble.<span class="hljs-property">AdvertiseSetting</span> = {</li><li>        <span class="hljs-attr">interval</span>:<span class="hljs-number">150</span>,</li><li>        <span class="hljs-attr">txPower</span>:<span class="hljs-number">0</span>,</li><li>        <span class="hljs-attr">connectable</span>:<span class="hljs-literal">true</span></li><li>    };</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">manufactureDataUnit</span>: ble.<span class="hljs-property">ManufactureData</span> = {</li><li>        <span class="hljs-attr">manufactureId</span>:<span class="hljs-number">4567</span>,</li><li>        <span class="hljs-attr">manufactureValue</span>:manufactureValueBuffer.<span class="hljs-property">buffer</span></li><li>    };</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">serviceDataUnit</span>: ble.<span class="hljs-property">ServiceData</span> = {</li><li>        <span class="hljs-attr">serviceUuid</span>:<span class="hljs-string">"00001888-0000-1000-8000-00805f9b34fb"</span>,</li><li>        <span class="hljs-attr">serviceValue</span>:serviceValueBuffer.<span class="hljs-property">buffer</span></li><li>    };</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">advData</span>: ble.<span class="hljs-property">AdvertiseData</span> = {</li><li>        <span class="hljs-attr">serviceUuids</span>:[<span class="hljs-string">"00001888-0000-1000-8000-00805f9b34fb"</span>],</li><li>        <span class="hljs-attr">manufactureData</span>:[manufactureDataUnit],</li><li>        <span class="hljs-attr">serviceData</span>:[serviceDataUnit]</li><li>    };</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">advResponse</span>: ble.<span class="hljs-property">AdvertiseData</span> = {</li><li>        <span class="hljs-attr">serviceUuids</span>:[<span class="hljs-string">"00001888-0000-1000-8000-00805f9b34fb"</span>],</li><li>        <span class="hljs-attr">manufactureData</span>:[manufactureDataUnit],</li><li>        <span class="hljs-attr">serviceData</span>:[serviceDataUnit]</li><li>    };</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">advertisingParams</span>: ble.<span class="hljs-property">AdvertisingParams</span> = {</li><li>        <span class="hljs-attr">advertisingSettings</span>: setting,</li><li>        <span class="hljs-attr">advertisingData</span>: advData,</li><li>        <span class="hljs-attr">advertisingResponse</span>: advResponse,</li><li>        <span class="hljs-attr">duration</span>: <span class="hljs-number">0</span></li><li>    }</li><li>    <span class="hljs-keyword">let</span> advHandle = <span class="hljs-number">0xFF</span>;</li><li>    ble.<span class="hljs-title function_">startAdvertising</span>(advertisingParams, <span class="hljs-function">(<span class="hljs-params">err, outAdvHandle</span>) =&gt;</span> {</li><li>        <span class="hljs-keyword">if</span> (err) {</li><li>            <span class="hljs-keyword">return</span>;</li><li>        } <span class="hljs-keyword">else</span> {</li><li>            advHandle = outAdvHandle;</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"advHandle: "</span> + advHandle);</li><li>        }</li><li>    });</li><li>
</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">advertisingDisableParams</span>: ble.<span class="hljs-property">AdvertisingDisableParams</span> = {</li><li>        <span class="hljs-attr">advertisingId</span>: advHandle</li><li>    }</li><li>    ble.<span class="hljs-title function_">disableAdvertising</span>(advertisingDisableParams)</li><li>        .<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"enable success"</span>);</li><li>    });</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 2888px;">     <h2 id="blestopadvertising11" device-type="phone,2in1,tablet,wearable,tv">ble.stopAdvertising<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="blestopadvertising11" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>stopAdvertising(advertisingId: number, callback: AsyncCallback&lt;void&gt;): void</p>     <p>完全停止发送BLE广播。使用Callback异步回调。</p>     <ul>      <li>与API version 11开始支持的<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#blestartadvertising11">ble.startAdvertising</a>搭配使用，会释放已经申请的广播资源。</li>      <li><a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#blestartadvertising11">ble.startAdvertising</a>首次启动广播时分配的广播标识也将失效。</li>      <li>不可以和API version 10开始支持的<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#blestartadvertising">ble.startAdvertising</a>接口搭配使用。</li>      <li>通过<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#bleonadvertisingstatechange11">ble.on('advertisingStateChange')</a>回调获取完全停止广播结果。</li>     </ul>     <p><strong>需要权限</strong>：ohos.permission.ACCESS_BLUETOOTH</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.19.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.19.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.19.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.19.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">advertisingId</td>         <td class="cellrowborder" width="25%">number</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">需要停止的广播ID标识。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;void&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码说明文档</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-bluetoothmanager">蓝牙服务子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.19.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.19.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Invalid parameter. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900001</td>         <td class="cellrowborder" width="50%">Service stopped.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900003</td>         <td class="cellrowborder" width="50%">Bluetooth disabled.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900099</td>         <td class="cellrowborder" width="50%">Operation failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2902055</td>         <td class="cellrowborder" width="50%">Invalid advertising id.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wue-c106="" class="highlight-div"><div _ngcontent-wue-c106="" class="highlight-div-header"><div _ngcontent-wue-c106="" class="highlight-div-header-left"><div _ngcontent-wue-c106="" class="handle-button expand-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wue-c106="" class="highlight-div-header-right"><div _ngcontent-wue-c106="" class="handle-button ai-button"></div><div _ngcontent-wue-c106="" class="handle-button line-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wue-c106="" class="handle-button theme-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wue-c106="" class="handle-button copy-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wue-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AsyncCallback</span>, <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">let</span> manufactureValueBuffer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(<span class="hljs-number">4</span>);</li><li>manufactureValueBuffer[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>;</li><li>manufactureValueBuffer[<span class="hljs-number">1</span>] = <span class="hljs-number">2</span>;</li><li>manufactureValueBuffer[<span class="hljs-number">2</span>] = <span class="hljs-number">3</span>;</li><li>manufactureValueBuffer[<span class="hljs-number">3</span>] = <span class="hljs-number">4</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> serviceValueBuffer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(<span class="hljs-number">4</span>);</li><li>serviceValueBuffer[<span class="hljs-number">0</span>] = <span class="hljs-number">4</span>;</li><li>serviceValueBuffer[<span class="hljs-number">1</span>] = <span class="hljs-number">6</span>;</li><li>serviceValueBuffer[<span class="hljs-number">2</span>] = <span class="hljs-number">7</span>;</li><li>serviceValueBuffer[<span class="hljs-number">3</span>] = <span class="hljs-number">8</span>;</li><li><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'manufactureValueBuffer = '</span>+ <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(manufactureValueBuffer));</li><li><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'serviceValueBuffer = '</span>+ <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(serviceValueBuffer));</li><li><span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">setting</span>: ble.<span class="hljs-property">AdvertiseSetting</span> = {</li><li>        <span class="hljs-attr">interval</span>:<span class="hljs-number">150</span>,</li><li>        <span class="hljs-attr">txPower</span>:<span class="hljs-number">0</span>,</li><li>        <span class="hljs-attr">connectable</span>:<span class="hljs-literal">true</span></li><li>    };</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">manufactureDataUnit</span>: ble.<span class="hljs-property">ManufactureData</span> = {</li><li>        <span class="hljs-attr">manufactureId</span>:<span class="hljs-number">4567</span>,</li><li>        <span class="hljs-attr">manufactureValue</span>:manufactureValueBuffer.<span class="hljs-property">buffer</span></li><li>    };</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">serviceDataUnit</span>: ble.<span class="hljs-property">ServiceData</span> = {</li><li>        <span class="hljs-attr">serviceUuid</span>:<span class="hljs-string">"00001888-0000-1000-8000-00805f9b34fb"</span>,</li><li>        <span class="hljs-attr">serviceValue</span>:serviceValueBuffer.<span class="hljs-property">buffer</span></li><li>    };</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">advData</span>: ble.<span class="hljs-property">AdvertiseData</span> = {</li><li>        <span class="hljs-attr">serviceUuids</span>:[<span class="hljs-string">"00001888-0000-1000-8000-00805f9b34fb"</span>],</li><li>        <span class="hljs-attr">manufactureData</span>:[manufactureDataUnit],</li><li>        <span class="hljs-attr">serviceData</span>:[serviceDataUnit]</li><li>    };</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">advResponse</span>: ble.<span class="hljs-property">AdvertiseData</span> = {</li><li>        <span class="hljs-attr">serviceUuids</span>:[<span class="hljs-string">"00001888-0000-1000-8000-00805f9b34fb"</span>],</li><li>        <span class="hljs-attr">manufactureData</span>:[manufactureDataUnit],</li><li>        <span class="hljs-attr">serviceData</span>:[serviceDataUnit]</li><li>    };</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">advertisingParams</span>: ble.<span class="hljs-property">AdvertisingParams</span> = {</li><li>        <span class="hljs-attr">advertisingSettings</span>: setting,</li><li>        <span class="hljs-attr">advertisingData</span>: advData,</li><li>        <span class="hljs-attr">advertisingResponse</span>: advResponse,</li><li>        <span class="hljs-attr">duration</span>: <span class="hljs-number">0</span></li><li>    }</li><li>    <span class="hljs-keyword">let</span> advHandle = <span class="hljs-number">0xFF</span>;</li><li>    ble.<span class="hljs-title function_">startAdvertising</span>(advertisingParams, <span class="hljs-function">(<span class="hljs-params">err, outAdvHandle</span>) =&gt;</span> {</li><li>        <span class="hljs-keyword">if</span> (err) {</li><li>            <span class="hljs-keyword">return</span>;</li><li>        } <span class="hljs-keyword">else</span> {</li><li>            advHandle = outAdvHandle;</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"advHandle: "</span> + advHandle);</li><li>        }</li><li>    });</li><li>
</li><li>    ble.<span class="hljs-title function_">stopAdvertising</span>(advHandle, <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> {</li><li>        <span class="hljs-keyword">if</span> (err) {</li><li>            <span class="hljs-keyword">return</span>;</li><li>        }</li><li>    });</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 2990px;">     <h2 id="blestopadvertising11-1" device-type="phone,2in1,tablet,wearable,tv">ble.stopAdvertising<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="blestopadvertising11-1" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>stopAdvertising(advertisingId: number): Promise&lt;void&gt;</p>     <p>完全停止发送BLE广播。使用Promise异步回调。</p>     <ul>      <li>与API version 11开始支持的<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#blestartadvertising11">ble.startAdvertising</a>搭配使用，会释放已经申请的广播资源。</li>      <li><a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#blestartadvertising11">ble.startAdvertising</a>首次启动广播时分配的广播标识也将失效。</li>      <li>不可以和API version 10开始支持的<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#blestartadvertising">ble.startAdvertising</a>接口搭配使用。</li>      <li>通过<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#bleonadvertisingstatechange11">ble.on('advertisingStateChange')</a>回调获取完全停止广播结果。</li>     </ul>     <p><strong>需要权限</strong>：ohos.permission.ACCESS_BLUETOOTH</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.20.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.20.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.20.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.20.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">advertisingId</td>         <td class="cellrowborder" width="25%">number</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">需要停止的广播ID标识。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.20.10.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.20.10.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">回调函数。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码说明文档</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-bluetoothmanager">蓝牙服务子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.20.13.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.20.13.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Invalid parameter. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900001</td>         <td class="cellrowborder" width="50%">Service stopped.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900003</td>         <td class="cellrowborder" width="50%">Bluetooth disabled.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900099</td>         <td class="cellrowborder" width="50%">Operation failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2902055</td>         <td class="cellrowborder" width="50%">Invalid advertising id.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wue-c106="" class="highlight-div"><div _ngcontent-wue-c106="" class="highlight-div-header"><div _ngcontent-wue-c106="" class="highlight-div-header-left"><div _ngcontent-wue-c106="" class="handle-button expand-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wue-c106="" class="highlight-div-header-right"><div _ngcontent-wue-c106="" class="handle-button ai-button"></div><div _ngcontent-wue-c106="" class="handle-button line-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wue-c106="" class="handle-button theme-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wue-c106="" class="handle-button copy-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wue-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AsyncCallback</span>, <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">let</span> manufactureValueBuffer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(<span class="hljs-number">4</span>);</li><li>manufactureValueBuffer[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>;</li><li>manufactureValueBuffer[<span class="hljs-number">1</span>] = <span class="hljs-number">2</span>;</li><li>manufactureValueBuffer[<span class="hljs-number">2</span>] = <span class="hljs-number">3</span>;</li><li>manufactureValueBuffer[<span class="hljs-number">3</span>] = <span class="hljs-number">4</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> serviceValueBuffer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(<span class="hljs-number">4</span>);</li><li>serviceValueBuffer[<span class="hljs-number">0</span>] = <span class="hljs-number">4</span>;</li><li>serviceValueBuffer[<span class="hljs-number">1</span>] = <span class="hljs-number">6</span>;</li><li>serviceValueBuffer[<span class="hljs-number">2</span>] = <span class="hljs-number">7</span>;</li><li>serviceValueBuffer[<span class="hljs-number">3</span>] = <span class="hljs-number">8</span>;</li><li><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'manufactureValueBuffer = '</span>+ <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(manufactureValueBuffer));</li><li><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'serviceValueBuffer = '</span>+ <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(serviceValueBuffer));</li><li><span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">setting</span>: ble.<span class="hljs-property">AdvertiseSetting</span> = {</li><li>        <span class="hljs-attr">interval</span>:<span class="hljs-number">150</span>,</li><li>        <span class="hljs-attr">txPower</span>:<span class="hljs-number">0</span>,</li><li>        <span class="hljs-attr">connectable</span>:<span class="hljs-literal">true</span></li><li>    };</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">manufactureDataUnit</span>: ble.<span class="hljs-property">ManufactureData</span> = {</li><li>        <span class="hljs-attr">manufactureId</span>:<span class="hljs-number">4567</span>,</li><li>        <span class="hljs-attr">manufactureValue</span>:manufactureValueBuffer.<span class="hljs-property">buffer</span></li><li>    };</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">serviceDataUnit</span>: ble.<span class="hljs-property">ServiceData</span> = {</li><li>        <span class="hljs-attr">serviceUuid</span>:<span class="hljs-string">"00001888-0000-1000-8000-00805f9b34fb"</span>,</li><li>        <span class="hljs-attr">serviceValue</span>:serviceValueBuffer.<span class="hljs-property">buffer</span></li><li>    };</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">advData</span>: ble.<span class="hljs-property">AdvertiseData</span> = {</li><li>        <span class="hljs-attr">serviceUuids</span>:[<span class="hljs-string">"00001888-0000-1000-8000-00805f9b34fb"</span>],</li><li>        <span class="hljs-attr">manufactureData</span>:[manufactureDataUnit],</li><li>        <span class="hljs-attr">serviceData</span>:[serviceDataUnit]</li><li>    };</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">advResponse</span>: ble.<span class="hljs-property">AdvertiseData</span> = {</li><li>        <span class="hljs-attr">serviceUuids</span>:[<span class="hljs-string">"00001888-0000-1000-8000-00805f9b34fb"</span>],</li><li>        <span class="hljs-attr">manufactureData</span>:[manufactureDataUnit],</li><li>        <span class="hljs-attr">serviceData</span>:[serviceDataUnit]</li><li>    };</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">advertisingParams</span>: ble.<span class="hljs-property">AdvertisingParams</span> = {</li><li>        <span class="hljs-attr">advertisingSettings</span>: setting,</li><li>        <span class="hljs-attr">advertisingData</span>: advData,</li><li>        <span class="hljs-attr">advertisingResponse</span>: advResponse,</li><li>        <span class="hljs-attr">duration</span>: <span class="hljs-number">0</span></li><li>    }</li><li>    <span class="hljs-keyword">let</span> advHandle = <span class="hljs-number">0xFF</span>;</li><li>    ble.<span class="hljs-title function_">startAdvertising</span>(advertisingParams, <span class="hljs-function">(<span class="hljs-params">err, outAdvHandle</span>) =&gt;</span> {</li><li>        <span class="hljs-keyword">if</span> (err) {</li><li>            <span class="hljs-keyword">return</span>;</li><li>        } <span class="hljs-keyword">else</span> {</li><li>            advHandle = outAdvHandle;</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"advHandle: "</span> + advHandle);</li><li>        }</li><li>    });</li><li>
</li><li>    ble.<span class="hljs-title function_">stopAdvertising</span>(advHandle)</li><li>        .<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"enable success"</span>);</li><li>    });</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1547px;">     <h2 id="bleonadvertisingstatechange11" device-type="phone,2in1,tablet,wearable,tv">ble.on('advertisingStateChange')<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="bleonadvertisingstatechange11" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>on(type: 'advertisingStateChange', callback: Callback&lt;AdvertisingStateChangeInfo&gt;): void</p>     <p>订阅BLE广播状态。使用Callback异步回调。</p>     <p><strong>需要权限</strong>：ohos.permission.ACCESS_BLUETOOTH</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.21.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.21.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.21.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.21.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">          <p>事件回调类型，支持的事件为'advertisingStateChange'，表示广播状态事件。</p>          <p>当调用<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#blestartadvertising11">ble.startAdvertising</a>、<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#blestopadvertising11">ble.stopAdvertising</a>、<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#bleenableadvertising11">ble.enableAdvertising</a>、<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#bledisableadvertising11">ble.disableAdvertising</a>，广播状态改变时，均会触发该事件。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#advertisingstatechangeinfo11">AdvertisingStateChangeInfo</a>&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">指定订阅的回调函数，会携带广播状态信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码说明文档</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-bluetoothmanager">蓝牙服务子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.21.10.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.21.10.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Invalid parameter. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types. 3. Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900099</td>         <td class="cellrowborder" width="50%">Operation failed.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wue-c106="" class="highlight-div"><div _ngcontent-wue-c106="" class="highlight-div-header"><div _ngcontent-wue-c106="" class="highlight-div-header-left"><div _ngcontent-wue-c106="" class="handle-button expand-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wue-c106="" class="highlight-div-header-right"><div _ngcontent-wue-c106="" class="handle-button ai-button"></div><div _ngcontent-wue-c106="" class="handle-button line-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wue-c106="" class="handle-button theme-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wue-c106="" class="handle-button copy-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wue-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AsyncCallback</span>, <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">onReceiveEvent</span>(<span class="hljs-params">data: ble.AdvertisingStateChangeInfo</span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'bluetooth advertising state = '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data));</li><li>}</li><li><span class="hljs-keyword">try</span> {</li><li>    ble.<span class="hljs-title function_">on</span>(<span class="hljs-string">'advertisingStateChange'</span>, onReceiveEvent);</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1523px;">     <h2 id="bleoffadvertisingstatechange11" device-type="phone,2in1,tablet,wearable,tv">ble.off('advertisingStateChange')<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="bleoffadvertisingstatechange11" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>off(type: 'advertisingStateChange', callback?: Callback&lt;AdvertisingStateChangeInfo&gt;): void</p>     <p>取消订阅BLE广播状态。广播停止或启动将不再收到通知。</p>     <p><strong>需要权限</strong>：ohos.permission.ACCESS_BLUETOOTH</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.22.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.22.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.22.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.22.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">事件回调类型，支持的事件为'advertisingStateChange'，表示广播状态事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#advertisingstatechangeinfo11">AdvertisingStateChangeInfo</a>&gt;</td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">          <p>指定取消订阅的回调函数通知。</p>          <p>若传参，则需与<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#bleonadvertisingstatechange11">ble.on('advertisingStateChange')</a>中的回调函数一致；若无传参，则取消订阅该type对应的所有回调函数通知。</p></td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码说明文档</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-bluetoothmanager">蓝牙服务子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.22.10.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.22.10.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Invalid parameter. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types. 3. Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900099</td>         <td class="cellrowborder" width="50%">Operation failed.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wue-c106="" class="highlight-div"><div _ngcontent-wue-c106="" class="highlight-div-header"><div _ngcontent-wue-c106="" class="highlight-div-header-left"><div _ngcontent-wue-c106="" class="handle-button expand-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wue-c106="" class="highlight-div-header-right"><div _ngcontent-wue-c106="" class="handle-button ai-button"></div><div _ngcontent-wue-c106="" class="handle-button line-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wue-c106="" class="handle-button theme-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wue-c106="" class="handle-button copy-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wue-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AsyncCallback</span>, <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">onReceiveEvent</span>(<span class="hljs-params">data: ble.AdvertisingStateChangeInfo</span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'bluetooth advertising state = '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data));</li><li>}</li><li><span class="hljs-keyword">try</span> {</li><li>    ble.<span class="hljs-title function_">on</span>(<span class="hljs-string">'advertisingStateChange'</span>, onReceiveEvent);</li><li>    ble.<span class="hljs-title function_">off</span>(<span class="hljs-string">'advertisingStateChange'</span>, onReceiveEvent);</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1523px;">     <h2 id="bleonbledevicefind" device-type="phone,2in1,tablet,wearable,tv">ble.on('BLEDeviceFind')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="bleonbledevicefind" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>on(type: 'BLEDeviceFind', callback: Callback&lt;Array&lt;ScanResult&gt;&gt;): void</p>     <p>订阅BLE设备扫描结果上报事件。使用Callback异步回调。</p>     <p><strong>需要权限</strong>：ohos.permission.ACCESS_BLUETOOTH</p>     <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.23.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.23.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.23.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.23.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">          <p>事件回调类型，支持的事件为'BLEDeviceFind'，表示BLE设备扫描结果上报事件。</p>          <p>当调用<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#blestartblescan">ble.startBLEScan</a> 后，开始BLE扫描，若扫描到BLE设备，触发该事件。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;Array&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#scanresult">ScanResult</a>&gt;&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">指定订阅的回调函数，会携带扫描结果的集合。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码说明文档</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-bluetoothmanager">蓝牙服务子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.23.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.23.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Invalid parameter. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types. 3. Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900099</td>         <td class="cellrowborder" width="50%">Operation failed.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wue-c106="" class="highlight-div"><div _ngcontent-wue-c106="" class="highlight-div-header"><div _ngcontent-wue-c106="" class="highlight-div-header-left"><div _ngcontent-wue-c106="" class="handle-button expand-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wue-c106="" class="highlight-div-header-right"><div _ngcontent-wue-c106="" class="handle-button ai-button"></div><div _ngcontent-wue-c106="" class="handle-button line-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wue-c106="" class="handle-button theme-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wue-c106="" class="handle-button copy-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wue-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AsyncCallback</span>, <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">onReceiveEvent</span>(<span class="hljs-params">data: <span class="hljs-built_in">Array</span>&lt;ble.ScanResult&gt;</span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'bluetooth device find = '</span>+ <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data));</li><li>}</li><li><span class="hljs-keyword">try</span> {</li><li>    ble.<span class="hljs-title function_">on</span>(<span class="hljs-string">'BLEDeviceFind'</span>, onReceiveEvent);</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1643px;">     <h2 id="bleoffbledevicefind" device-type="phone,2in1,tablet,wearable,tv">ble.off('BLEDeviceFind')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="bleoffbledevicefind" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>off(type: 'BLEDeviceFind', callback?: Callback&lt;Array&lt;ScanResult&gt;&gt;): void</p>     <p>取消订阅BLE设备扫描结果上报事件。</p>     <ul>      <li>若不再需要扫描BLE设备，调用<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#blestopblescan">ble.stopBLEScan</a>方法后，需要调用此方法取消订阅。</li>     </ul>     <p><strong>需要权限</strong>：ohos.permission.ACCESS_BLUETOOTH</p>     <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.24.9.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.24.9.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.24.9.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.24.9.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">事件回调类型，支持的事件为'BLEDeviceFind'，表示BLE设备扫描结果上报事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;Array&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#scanresult">ScanResult</a>&gt;&gt;</td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">          <p>指定取消订阅的回调函数通知。</p>          <p>若传参，则需与<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#bleonbledevicefind">ble.on('BLEDeviceFind')</a>中的回调函数一致；若无传参，则取消订阅该type对应的所有回调函数通知。</p></td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码说明文档</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-bluetoothmanager">蓝牙服务子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.24.12.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.24.12.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Invalid parameter. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types. 3. Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900099</td>         <td class="cellrowborder" width="50%">Operation failed.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wue-c106="" class="highlight-div"><div _ngcontent-wue-c106="" class="highlight-div-header"><div _ngcontent-wue-c106="" class="highlight-div-header-left"><div _ngcontent-wue-c106="" class="handle-button expand-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wue-c106="" class="highlight-div-header-right"><div _ngcontent-wue-c106="" class="handle-button ai-button"></div><div _ngcontent-wue-c106="" class="handle-button line-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wue-c106="" class="handle-button theme-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wue-c106="" class="handle-button copy-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wue-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AsyncCallback</span>, <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">onReceiveEvent</span>(<span class="hljs-params">data: <span class="hljs-built_in">Array</span>&lt;ble.ScanResult&gt;</span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'bluetooth device find = '</span>+ <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data));</li><li>}</li><li><span class="hljs-keyword">try</span> {</li><li>    ble.<span class="hljs-title function_">on</span>(<span class="hljs-string">'BLEDeviceFind'</span>, onReceiveEvent);</li><li>    ble.<span class="hljs-title function_">off</span>(<span class="hljs-string">'BLEDeviceFind'</span>, onReceiveEvent);</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 262px;">     <h2 id="gattserver" device-type="phone,2in1,tablet,wearable,tv">GattServer<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="gattserver" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>GATT通信中的服务端类。</p>     <ul>      <li>通过<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#blecreategattserver">ble.createGattServer</a>方法可以构造server实例。</li>      <li>通过该实例可以操作server端的行为，如添加服务<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#addservice">addService</a>、通知特征值变化<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#notifycharacteristicchanged">notifyCharacteristicChanged</a>等。</li>     </ul>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 2044px;">     <h3 id="addservice" device-type="phone,2in1,tablet,wearable,tv" class="firsth2">addService<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="addservice" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>addService(service: GattService): void</p>     <p>server端添加服务。该操作会在蓝牙子系统中注册该服务，表示server端支持的能力。</p>     <p><strong>需要权限</strong>：ohos.permission.ACCESS_BLUETOOTH</p>     <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.26.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.26.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.26.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.26.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">service</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#gattservice">GattService</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">          <p>server端的service数据。表示支持的特定功能。</p>          <p>例如：00001800-0000-1000-8000-00805f9b34fb表示通用访问服务；00001801-0000-1000-8000-00805f9b34fb表示通用属性服务等。</p></td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码说明文档</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-bluetoothmanager">蓝牙服务子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.26.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.26.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Invalid parameter. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types. 3. Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900001</td>         <td class="cellrowborder" width="50%">Service stopped.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900003</td>         <td class="cellrowborder" width="50%">Bluetooth disabled.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900099</td>         <td class="cellrowborder" width="50%">Operation failed.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wue-c106="" class="highlight-div"><div _ngcontent-wue-c106="" class="highlight-div-header"><div _ngcontent-wue-c106="" class="highlight-div-header-left"><div _ngcontent-wue-c106="" class="handle-button expand-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wue-c106="" class="highlight-div-header-right"><div _ngcontent-wue-c106="" class="handle-button ai-button"></div><div _ngcontent-wue-c106="" class="handle-button line-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wue-c106="" class="handle-button theme-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wue-c106="" class="handle-button copy-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wue-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AsyncCallback</span>, <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-comment">// 创建descriptors。</span></li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">descriptors</span>: <span class="hljs-title class_">Array</span>&lt;ble.<span class="hljs-property">BLEDescriptor</span>&gt; = [];</li><li><span class="hljs-keyword">let</span> arrayBuffer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayBuffer</span>(<span class="hljs-number">2</span>);</li><li><span class="hljs-keyword">let</span> descV = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(arrayBuffer);</li><li>descV[<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>; <span class="hljs-comment">// 以Client Characteristic Configuration描述符为例，表示bit0、bit1均为0，notification和indication均不开启</span></li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">descriptor</span>: ble.<span class="hljs-property">BLEDescriptor</span> = {<span class="hljs-attr">serviceUuid</span>: <span class="hljs-string">'00001810-0000-1000-8000-00805F9B34FB'</span>,</li><li>  <span class="hljs-attr">characteristicUuid</span>: <span class="hljs-string">'00001820-0000-1000-8000-00805F9B34FB'</span>,</li><li>  <span class="hljs-attr">descriptorUuid</span>: <span class="hljs-string">'00002902-0000-1000-8000-00805F9B34FB'</span>, <span class="hljs-attr">descriptorValue</span>: arrayBuffer};</li><li>descriptors[<span class="hljs-number">0</span>] = descriptor;</li><li>
</li><li><span class="hljs-comment">// 创建characteristics。</span></li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">characteristics</span>: <span class="hljs-title class_">Array</span>&lt;ble.<span class="hljs-property">BLECharacteristic</span>&gt; = [];</li><li><span class="hljs-keyword">let</span> arrayBufferC = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayBuffer</span>(<span class="hljs-number">8</span>);</li><li><span class="hljs-keyword">let</span> cccV = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(arrayBufferC);</li><li>cccV[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">characteristic</span>: ble.<span class="hljs-property">BLECharacteristic</span> = {<span class="hljs-attr">serviceUuid</span>: <span class="hljs-string">'00001810-0000-1000-8000-00805F9B34FB'</span>,</li><li>  <span class="hljs-attr">characteristicUuid</span>: <span class="hljs-string">'00001820-0000-1000-8000-00805F9B34FB'</span>, <span class="hljs-attr">characteristicValue</span>: arrayBufferC, <span class="hljs-attr">descriptors</span>:descriptors};</li><li>characteristics[<span class="hljs-number">0</span>] = characteristic;</li><li>
</li><li><span class="hljs-comment">// 创建gattService。</span></li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">gattService</span>: ble.<span class="hljs-property">GattService</span> = {<span class="hljs-attr">serviceUuid</span>:<span class="hljs-string">'00001810-0000-1000-8000-00805F9B34FB'</span>, <span class="hljs-attr">isPrimary</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">characteristics</span>:characteristics, <span class="hljs-attr">includeServices</span>:[]};</li><li>
</li><li><span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">gattServer</span>: ble.<span class="hljs-property">GattServer</span> = ble.<span class="hljs-title function_">createGattServer</span>();</li><li>    gattServer.<span class="hljs-title function_">addService</span>(gattService);</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1539px;">     <h3 id="removeservice" device-type="phone,2in1,tablet,wearable,tv">removeService<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="removeservice" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>removeService(serviceUuid: string): void</p>     <p>删除server端已添加的服务。</p>     <ul>      <li>该服务曾通过<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#addservice">addService</a>添加。</li>     </ul>     <p><strong>需要权限</strong>：ohos.permission.ACCESS_BLUETOOTH</p>     <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.27.9.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.27.9.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.27.9.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.27.9.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">serviceUuid</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">即将删除的服务的UUID。例如：00001810-0000-1000-8000-00805F9B34FB。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码说明文档</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-bluetoothmanager">蓝牙服务子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.27.12.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.27.12.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Invalid parameter. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types. 3. Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900001</td>         <td class="cellrowborder" width="50%">Service stopped.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900003</td>         <td class="cellrowborder" width="50%">Bluetooth disabled.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900004</td>         <td class="cellrowborder" width="50%">Profile not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900099</td>         <td class="cellrowborder" width="50%">Operation failed.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wue-c106="" class="highlight-div"><div _ngcontent-wue-c106="" class="highlight-div-header"><div _ngcontent-wue-c106="" class="highlight-div-header-left"><div _ngcontent-wue-c106="" class="handle-button expand-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wue-c106="" class="highlight-div-header-right"><div _ngcontent-wue-c106="" class="handle-button ai-button"></div><div _ngcontent-wue-c106="" class="handle-button line-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wue-c106="" class="handle-button theme-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wue-c106="" class="handle-button copy-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wue-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AsyncCallback</span>, <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">server</span>: ble.<span class="hljs-property">GattServer</span> = ble.<span class="hljs-title function_">createGattServer</span>();</li><li><span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-comment">// 调用removeService接口前需要完成server端和client端的配对及连接。</span></li><li>    server.<span class="hljs-title function_">removeService</span>(<span class="hljs-string">'00001810-0000-1000-8000-00805F9B34FB'</span>);</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1110px;">     <h3 id="close" device-type="phone,2in1,tablet,wearable,tv">close<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="close" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>close(): void</p>     <p>销毁server端实例。销毁后，通过<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#blecreategattserver">ble.createGattServer</a>创建的实例将不可用。</p>     <p><strong>需要权限</strong>：ohos.permission.ACCESS_BLUETOOTH</p>     <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码说明文档</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-bluetoothmanager">蓝牙服务子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.28.9.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.28.9.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900001</td>         <td class="cellrowborder" width="50%">Service stopped.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900003</td>         <td class="cellrowborder" width="50%">Bluetooth disabled.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900099</td>         <td class="cellrowborder" width="50%">Operation failed.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wue-c106="" class="highlight-div"><div _ngcontent-wue-c106="" class="highlight-div-header"><div _ngcontent-wue-c106="" class="highlight-div-header-left"><div _ngcontent-wue-c106="" class="handle-button expand-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wue-c106="" class="highlight-div-header-right"><div _ngcontent-wue-c106="" class="handle-button ai-button"></div><div _ngcontent-wue-c106="" class="handle-button line-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wue-c106="" class="handle-button theme-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wue-c106="" class="handle-button copy-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wue-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AsyncCallback</span>, <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">server</span>: ble.<span class="hljs-property">GattServer</span> = ble.<span class="hljs-title function_">createGattServer</span>();</li><li><span class="hljs-keyword">try</span> {</li><li>    server.<span class="hljs-title function_">close</span>();</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 2126px;">     <h3 id="notifycharacteristicchanged" device-type="phone,2in1,tablet,wearable,tv">notifyCharacteristicChanged<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="notifycharacteristicchanged" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>notifyCharacteristicChanged(deviceId: string, notifyCharacteristic: NotifyCharacteristic, callback: AsyncCallback&lt;void&gt;): void</p>     <p>server端发送特征值变化通知或者指示给client端。使用Callback异步回调。</p>     <ul>      <li>建议该特征值的Client Characteristic Configuration描述符（UUID：00002902-0000-1000-8000-00805f9b34fb）notification（通知）或indication（指示）能力已被使能。</li>      <li>蓝牙标准协议规定Client Characteristic Configuration描述符的数据内容长度为2字节，bit0和bit1分别表示notification（通知）和indication（指示）能力是否使能，例如bit0 = 1表示notification enabled。</li>      <li>该特征值数据内容变化时调用。</li>      <li><a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#notifycharacteristic">notifyCharacteristic</a>入参的characteristicValue数据长度默认限制为（MTU-3）字节，MTU大小可从订阅的回调<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#onblemtuchange">on('BLEMtuChange')</a>获取。</li>     </ul>     <p><strong>需要权限</strong>：ohos.permission.ACCESS_BLUETOOTH</p>     <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.29.9.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.29.9.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.29.9.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.29.9.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">deviceId</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">接收通知的client设备地址。例如：“XX:XX:XX:XX:XX:XX”。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">notifyCharacteristic</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#notifycharacteristic">NotifyCharacteristic</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">通知给client的特征值数据对象。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;void&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。当通知成功，err为undefined，否则为错误对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码说明文档</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-bluetoothmanager">蓝牙服务子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.29.12.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.29.12.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Invalid parameter. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types. 3. Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900001</td>         <td class="cellrowborder" width="50%">Service stopped.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900003</td>         <td class="cellrowborder" width="50%">Bluetooth disabled.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900099</td>         <td class="cellrowborder" width="50%">Operation failed.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wue-c106="" class="highlight-div"><div _ngcontent-wue-c106="" class="highlight-div-header"><div _ngcontent-wue-c106="" class="highlight-div-header-left"><div _ngcontent-wue-c106="" class="handle-button expand-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wue-c106="" class="highlight-div-header-right"><div _ngcontent-wue-c106="" class="handle-button ai-button"></div><div _ngcontent-wue-c106="" class="handle-button line-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wue-c106="" class="handle-button theme-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wue-c106="" class="handle-button copy-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wue-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AsyncCallback</span>, <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">let</span> arrayBufferC = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayBuffer</span>(<span class="hljs-number">8</span>);</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">notifyCharacter</span>: ble.<span class="hljs-property">NotifyCharacteristic</span> = {</li><li>    <span class="hljs-attr">serviceUuid</span>: <span class="hljs-string">'00001810-0000-1000-8000-00805F9B34FB'</span>,</li><li>    <span class="hljs-attr">characteristicUuid</span>: <span class="hljs-string">'00001820-0000-1000-8000-00805F9B34FB'</span>,</li><li>    <span class="hljs-attr">characteristicValue</span>: arrayBufferC,</li><li>    <span class="hljs-attr">confirm</span>: <span class="hljs-literal">true</span></li><li>};</li><li><span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">gattServer</span>: ble.<span class="hljs-property">GattServer</span> = ble.<span class="hljs-title function_">createGattServer</span>();</li><li>    gattServer.<span class="hljs-title function_">notifyCharacteristicChanged</span>(<span class="hljs-string">'XX:XX:XX:XX:XX:XX'</span>, notifyCharacter, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>        <span class="hljs-keyword">if</span> (err) {</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'notifyCharacteristicChanged callback failed'</span>);</li><li>        } <span class="hljs-keyword">else</span> {</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'notifyCharacteristicChanged callback successful'</span>);</li><li>        }</li><li>    });</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 2028px;">     <h3 id="notifycharacteristicchanged-1" device-type="phone,2in1,tablet,wearable,tv">notifyCharacteristicChanged<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="notifycharacteristicchanged-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>notifyCharacteristicChanged(deviceId: string, notifyCharacteristic: NotifyCharacteristic): Promise&lt;void&gt;</p>     <p>server端发送特征值变化通知或者指示给对端设备。使用Promise异步回调。</p>     <ul>      <li>建议该特征值的Client Characteristic Configuration描述符notification（通知）或indication（指示）能力已被使能。</li>      <li>蓝牙标准协议规定Client Characteristic Configuration描述符的数据内容长度为2字节，bit0和bit1分别表示notification（通知）和indication（指示）能力是否使能，例如bit0 = 1表示notification enabled。</li>      <li>该特征值数据内容变化时调用。</li>     </ul>     <p><strong>需要权限</strong>：ohos.permission.ACCESS_BLUETOOTH</p>     <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.30.9.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.30.9.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.30.9.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.30.9.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">deviceId</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">接收通知的client设备地址。例如：“XX:XX:XX:XX:XX:XX”。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">notifyCharacteristic</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#notifycharacteristic">NotifyCharacteristic</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">通知给client的特征值数据对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.30.11.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.30.11.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">Promise对象。无返回结果的Promise对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码说明文档</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-bluetoothmanager">蓝牙服务子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.30.14.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.30.14.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Invalid parameter. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types. 3. Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900001</td>         <td class="cellrowborder" width="50%">Service stopped.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900003</td>         <td class="cellrowborder" width="50%">Bluetooth disabled.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900099</td>         <td class="cellrowborder" width="50%">Operation failed.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wue-c106="" class="highlight-div"><div _ngcontent-wue-c106="" class="highlight-div-header"><div _ngcontent-wue-c106="" class="highlight-div-header-left"><div _ngcontent-wue-c106="" class="handle-button expand-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wue-c106="" class="highlight-div-header-right"><div _ngcontent-wue-c106="" class="handle-button ai-button"></div><div _ngcontent-wue-c106="" class="handle-button line-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wue-c106="" class="handle-button theme-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wue-c106="" class="handle-button copy-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wue-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AsyncCallback</span>, <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">let</span> arrayBufferC = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayBuffer</span>(<span class="hljs-number">8</span>);</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">notifyCharacter</span>: ble.<span class="hljs-property">NotifyCharacteristic</span> = {</li><li>    <span class="hljs-attr">serviceUuid</span>: <span class="hljs-string">'00001810-0000-1000-8000-00805F9B34FB'</span>,</li><li>    <span class="hljs-attr">characteristicUuid</span>: <span class="hljs-string">'00001820-0000-1000-8000-00805F9B34FB'</span>,</li><li>    <span class="hljs-attr">characteristicValue</span>: arrayBufferC,</li><li>    <span class="hljs-attr">confirm</span>: <span class="hljs-literal">true</span></li><li>};</li><li><span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">gattServer</span>: ble.<span class="hljs-property">GattServer</span> = ble.<span class="hljs-title function_">createGattServer</span>();</li><li>    gattServer.<span class="hljs-title function_">notifyCharacteristicChanged</span>(<span class="hljs-string">'XX:XX:XX:XX:XX:XX'</span>, notifyCharacter).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'notifyCharacteristicChanged promise successful'</span>);</li><li>    });</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1844px;">     <h3 id="sendresponse" device-type="phone,2in1,tablet,wearable,tv">sendResponse<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="sendresponse" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>sendResponse(serverResponse: ServerResponse): void</p>     <p>server端收到client的请求操作后，需要调用此接口回复client，否则可能导致链路异常，超时后断连。</p>     <p>client请求是指通过下述接口订阅回调收到的请求消息：</p>     <ul>      <li><a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#oncharacteristicread">on('characteristicRead')</a></li>      <li><a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#oncharacteristicwrite">on('characteristicWrite')</a>，需根据<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#characteristicwriterequest">CharacteristicWriteRequest</a>中的needRsp决定是否需要回复。</li>      <li><a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#ondescriptorread">on('descriptorRead')</a></li>      <li><a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#ondescriptorwrite">on('descriptorWrite')</a>，需根据<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#descriptorwriterequest">DescriptorWriteRequest</a>中的needRsp决定是否需要回复。</li>     </ul>     <p><strong>需要权限</strong>：ohos.permission.ACCESS_BLUETOOTH</p>     <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.31.10.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.31.10.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.31.10.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.31.10.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">serverResponse</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#serverresponse">ServerResponse</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">server端回复client的响应数据。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码说明文档</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-bluetoothmanager">蓝牙服务子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.31.13.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.31.13.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Invalid parameter. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types. 3. Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900001</td>         <td class="cellrowborder" width="50%">Service stopped.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900003</td>         <td class="cellrowborder" width="50%">Bluetooth disabled.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900099</td>         <td class="cellrowborder" width="50%">Operation failed.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wue-c106="" class="highlight-div"><div _ngcontent-wue-c106="" class="highlight-div-header"><div _ngcontent-wue-c106="" class="highlight-div-header-left"><div _ngcontent-wue-c106="" class="handle-button expand-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wue-c106="" class="highlight-div-header-right"><div _ngcontent-wue-c106="" class="handle-button ai-button"></div><div _ngcontent-wue-c106="" class="handle-button line-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wue-c106="" class="handle-button theme-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wue-c106="" class="handle-button copy-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wue-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AsyncCallback</span>, <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-comment">/* send response */</span></li><li><span class="hljs-keyword">let</span> arrayBufferCCC = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayBuffer</span>(<span class="hljs-number">8</span>);</li><li><span class="hljs-keyword">let</span> cccValue = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(arrayBufferCCC);</li><li>cccValue[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">serverResponse</span>: ble.<span class="hljs-property">ServerResponse</span> = {</li><li>    <span class="hljs-attr">deviceId</span>: <span class="hljs-string">'XX:XX:XX:XX:XX:XX'</span>,</li><li>    <span class="hljs-attr">transId</span>: <span class="hljs-number">0</span>,</li><li>    <span class="hljs-attr">status</span>: <span class="hljs-number">0</span>,</li><li>    <span class="hljs-attr">offset</span>: <span class="hljs-number">0</span>,</li><li>    <span class="hljs-attr">value</span>: arrayBufferCCC</li><li>};</li><li><span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">gattServer</span>: ble.<span class="hljs-property">GattServer</span> = ble.<span class="hljs-title function_">createGattServer</span>();</li><li>    gattServer.<span class="hljs-title function_">sendResponse</span>(serverResponse);</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1700px;">     <h3 id="oncharacteristicread" device-type="phone,2in1,tablet,wearable,tv">on('characteristicRead')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="oncharacteristicread" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>on(type: 'characteristicRead', callback: Callback&lt;CharacteristicReadRequest&gt;): void</p>     <p>server端订阅client的特征值读请求事件，server端收到该事件后需要调用<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#sendresponse">sendResponse</a>接口回复client。使用Callback异步回调。</p>     <p><strong>需要权限</strong>：ohos.permission.ACCESS_BLUETOOTH</p>     <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.32.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.32.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.32.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.32.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">          <p>事件回调类型，支持的事件为'characteristicRead'，表示特征值读请求事件。</p>          <p>当收到client端设备的读取特征值请求时，触发该事件。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#characteristicreadrequest">CharacteristicReadRequest</a>&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">指定订阅的回调函数，会携带client端发送的读请求数据。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码说明文档</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.32.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.32.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Invalid parameter. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types. 3. Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wue-c106="" class="highlight-div"><div _ngcontent-wue-c106="" class="highlight-div-header"><div _ngcontent-wue-c106="" class="highlight-div-header-left"><div _ngcontent-wue-c106="" class="handle-button expand-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wue-c106="" class="highlight-div-header-right"><div _ngcontent-wue-c106="" class="handle-button ai-button"></div><div _ngcontent-wue-c106="" class="handle-button line-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wue-c106="" class="handle-button theme-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wue-c106="" class="handle-button copy-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wue-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AsyncCallback</span>, <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">let</span> arrayBufferCCC = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayBuffer</span>(<span class="hljs-number">8</span>);</li><li><span class="hljs-keyword">let</span> cccValue = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(arrayBufferCCC);</li><li>cccValue[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">gattServer</span>: ble.<span class="hljs-property">GattServer</span> = ble.<span class="hljs-title function_">createGattServer</span>();</li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">ReadCharacteristicReq</span>(<span class="hljs-params">characteristicReadRequest: ble.CharacteristicReadRequest</span>) {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">deviceId</span>: string = characteristicReadRequest.<span class="hljs-property">deviceId</span>;</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">transId</span>: number = characteristicReadRequest.<span class="hljs-property">transId</span>;</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">offset</span>: number = characteristicReadRequest.<span class="hljs-property">offset</span>;</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">characteristicUuid</span>: string = characteristicReadRequest.<span class="hljs-property">characteristicUuid</span>;</li><li>
</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">serverResponse</span>: ble.<span class="hljs-property">ServerResponse</span> = {<span class="hljs-attr">deviceId</span>: deviceId, <span class="hljs-attr">transId</span>: transId, <span class="hljs-attr">status</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">offset</span>: offset, <span class="hljs-attr">value</span>:arrayBufferCCC};</li><li>
</li><li>    <span class="hljs-keyword">try</span> {</li><li>        gattServer.<span class="hljs-title function_">sendResponse</span>(serverResponse);</li><li>    } <span class="hljs-keyword">catch</span> (err) {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>    }</li><li>}</li><li>gattServer.<span class="hljs-title function_">on</span>(<span class="hljs-string">'characteristicRead'</span>, <span class="hljs-title class_">ReadCharacteristicReq</span>);</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1436px;">     <h3 id="offcharacteristicread" device-type="phone,2in1,tablet,wearable,tv">off('characteristicRead')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="offcharacteristicread" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>off(type: 'characteristicRead', callback?: Callback&lt;CharacteristicReadRequest&gt;): void</p>     <p>server端取消订阅client的特征值读请求事件。</p>     <p><strong>需要权限</strong>：ohos.permission.ACCESS_BLUETOOTH</p>     <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.33.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.33.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.33.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.33.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">事件回调类型，支持的事件为'characteristicRead'，表示特征值读请求事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#characteristicreadrequest">CharacteristicReadRequest</a>&gt;</td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">          <p>指定取消订阅的回调函数通知。</p>          <p>若传参，则需与<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#oncharacteristicread">on('characteristicRead')</a>中的回调函数一致；若无传参，则取消订阅该type对应的所有回调函数通知。</p></td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码说明文档</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.33.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.33.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Invalid parameter. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types. 3. Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wue-c106="" class="highlight-div"><div _ngcontent-wue-c106="" class="highlight-div-header"><div _ngcontent-wue-c106="" class="highlight-div-header-left"><div _ngcontent-wue-c106="" class="handle-button expand-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wue-c106="" class="highlight-div-header-right"><div _ngcontent-wue-c106="" class="handle-button ai-button"></div><div _ngcontent-wue-c106="" class="handle-button line-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wue-c106="" class="handle-button theme-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wue-c106="" class="handle-button copy-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wue-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AsyncCallback</span>, <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">gattServer</span>: ble.<span class="hljs-property">GattServer</span> = ble.<span class="hljs-title function_">createGattServer</span>();</li><li>    gattServer.<span class="hljs-title function_">off</span>(<span class="hljs-string">'characteristicRead'</span>);</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"errCode:"</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">",errMessage:"</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1796px;">     <h3 id="oncharacteristicwrite" device-type="phone,2in1,tablet,wearable,tv">on('characteristicWrite')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="oncharacteristicwrite" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>on(type: 'characteristicWrite', callback: Callback&lt;CharacteristicWriteRequest&gt;): void</p>     <p>server端订阅client的特征值写请求事件，server端收到该事件后需要根据<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#characteristicwriterequest">CharacteristicWriteRequest</a>中的needRsp决定是否调用<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#sendresponse">sendResponse</a>接口回复client。</p>     <p><strong>需要权限</strong>：ohos.permission.ACCESS_BLUETOOTH</p>     <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.34.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.34.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.34.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.34.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">          <p>事件回调类型，支持的事件为'characteristicWrite'，表示特征值写请求事件。</p>          <p>当收到client端设备的写特征值请求时，触发该事件。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#characteristicwriterequest">CharacteristicWriteRequest</a>&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">指定订阅的回调函数，会携带client端发送的写请求数据。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码说明文档</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.34.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.34.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Invalid parameter. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types. 3. Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wue-c106="" class="highlight-div"><div _ngcontent-wue-c106="" class="highlight-div-header"><div _ngcontent-wue-c106="" class="highlight-div-header-left"><div _ngcontent-wue-c106="" class="handle-button expand-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wue-c106="" class="highlight-div-header-right"><div _ngcontent-wue-c106="" class="handle-button ai-button"></div><div _ngcontent-wue-c106="" class="handle-button line-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wue-c106="" class="handle-button theme-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wue-c106="" class="handle-button copy-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wue-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AsyncCallback</span>, <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">let</span> arrayBufferCCC = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayBuffer</span>(<span class="hljs-number">8</span>);</li><li><span class="hljs-keyword">let</span> cccValue = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(arrayBufferCCC);</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">gattServer</span>: ble.<span class="hljs-property">GattServer</span> = ble.<span class="hljs-title function_">createGattServer</span>();</li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">WriteCharacteristicReq</span>(<span class="hljs-params">characteristicWriteRequest: ble.CharacteristicWriteRequest</span>) {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">deviceId</span>: string = characteristicWriteRequest.<span class="hljs-property">deviceId</span>;</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">transId</span>: number = characteristicWriteRequest.<span class="hljs-property">transId</span>;</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">offset</span>: number = characteristicWriteRequest.<span class="hljs-property">offset</span>;</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">isPrepared</span>: boolean = characteristicWriteRequest.<span class="hljs-property">isPrepared</span>;</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">needRsp</span>: boolean = characteristicWriteRequest.<span class="hljs-property">needRsp</span>;</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">value</span>: <span class="hljs-title class_">Uint8Array</span> =  <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(characteristicWriteRequest.<span class="hljs-property">value</span>);</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">characteristicUuid</span>: string = characteristicWriteRequest.<span class="hljs-property">characteristicUuid</span>;</li><li>
</li><li>    cccValue[<span class="hljs-number">0</span>] = value[<span class="hljs-number">0</span>];</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">serverResponse</span>: ble.<span class="hljs-property">ServerResponse</span> = {<span class="hljs-attr">deviceId</span>: deviceId, <span class="hljs-attr">transId</span>: transId, <span class="hljs-attr">status</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">offset</span>: offset, <span class="hljs-attr">value</span>:arrayBufferCCC};</li><li>
</li><li>    <span class="hljs-keyword">try</span> {</li><li>        gattServer.<span class="hljs-title function_">sendResponse</span>(serverResponse);</li><li>    } <span class="hljs-keyword">catch</span> (err) {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>    }</li><li>}</li><li>gattServer.<span class="hljs-title function_">on</span>(<span class="hljs-string">'characteristicWrite'</span>, <span class="hljs-title class_">WriteCharacteristicReq</span>);</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1436px;">     <h3 id="offcharacteristicwrite" device-type="phone,2in1,tablet,wearable,tv">off('characteristicWrite')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="offcharacteristicwrite" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>off(type: 'characteristicWrite', callback?: Callback&lt;CharacteristicWriteRequest&gt;): void</p>     <p>server端取消订阅client的特征值写请求事件。</p>     <p><strong>需要权限</strong>：ohos.permission.ACCESS_BLUETOOTH</p>     <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.35.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.35.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.35.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.35.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">事件回调类型，支持的事件为'characteristicWrite'，表示特征值写请求事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#characteristicwriterequest">CharacteristicWriteRequest</a>&gt;</td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">          <p>指定取消订阅的回调函数通知。</p>          <p>若传参，则需与<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#oncharacteristicwrite">on('characteristicWrite')</a>中的回调函数一致；若无传参，则取消订阅该type对应的所有回调函数通知。</p></td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码说明文档</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.35.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.35.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Invalid parameter. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types. 3. Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wue-c106="" class="highlight-div"><div _ngcontent-wue-c106="" class="highlight-div-header"><div _ngcontent-wue-c106="" class="highlight-div-header-left"><div _ngcontent-wue-c106="" class="handle-button expand-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wue-c106="" class="highlight-div-header-right"><div _ngcontent-wue-c106="" class="handle-button ai-button"></div><div _ngcontent-wue-c106="" class="handle-button line-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wue-c106="" class="handle-button theme-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wue-c106="" class="handle-button copy-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wue-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AsyncCallback</span>, <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">gattServer</span>: ble.<span class="hljs-property">GattServer</span> = ble.<span class="hljs-title function_">createGattServer</span>();</li><li>    gattServer.<span class="hljs-title function_">off</span>(<span class="hljs-string">'characteristicWrite'</span>);</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"errCode:"</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">",errMessage:"</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1700px;">     <h3 id="ondescriptorread" device-type="phone,2in1,tablet,wearable,tv">on('descriptorRead')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="ondescriptorread" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>on(type: 'descriptorRead', callback: Callback&lt;DescriptorReadRequest&gt;): void</p>     <p>server端订阅client的描述符读请求事件，server端收到该事件后需要调用<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#sendresponse">sendResponse</a>接口回复client。</p>     <p><strong>需要权限</strong>：ohos.permission.ACCESS_BLUETOOTH</p>     <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.36.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.36.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.36.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.36.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">          <p>事件回调类型，支持的事件为'descriptorRead'，表示描述符读请求事件。</p>          <p>当收到client端设备的读取描述符请求时，触发该事件。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#descriptorreadrequest">DescriptorReadRequest</a>&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">指定订阅的回调函数，会携带client端发送的读请求数据。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码说明文档</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.36.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.36.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Invalid parameter. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types. 3. Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wue-c106="" class="highlight-div"><div _ngcontent-wue-c106="" class="highlight-div-header"><div _ngcontent-wue-c106="" class="highlight-div-header-left"><div _ngcontent-wue-c106="" class="handle-button expand-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wue-c106="" class="highlight-div-header-right"><div _ngcontent-wue-c106="" class="handle-button ai-button"></div><div _ngcontent-wue-c106="" class="handle-button line-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wue-c106="" class="handle-button theme-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wue-c106="" class="handle-button copy-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wue-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AsyncCallback</span>, <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">let</span> arrayBufferDesc = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayBuffer</span>(<span class="hljs-number">8</span>);</li><li><span class="hljs-keyword">let</span> descValue = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(arrayBufferDesc);</li><li>descValue[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">gattServer</span>: ble.<span class="hljs-property">GattServer</span> = ble.<span class="hljs-title function_">createGattServer</span>();</li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">ReadDescriptorReq</span>(<span class="hljs-params">descriptorReadRequest: ble.DescriptorReadRequest</span>) {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">deviceId</span>: string = descriptorReadRequest.<span class="hljs-property">deviceId</span>;</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">transId</span>: number = descriptorReadRequest.<span class="hljs-property">transId</span>;</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">offset</span>: number = descriptorReadRequest.<span class="hljs-property">offset</span>;</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">descriptorUuid</span>: string = descriptorReadRequest.<span class="hljs-property">descriptorUuid</span>;</li><li>
</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">serverResponse</span>: ble.<span class="hljs-property">ServerResponse</span> = {<span class="hljs-attr">deviceId</span>: deviceId, <span class="hljs-attr">transId</span>: transId, <span class="hljs-attr">status</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">offset</span>: offset, <span class="hljs-attr">value</span>:arrayBufferDesc};</li><li>
</li><li>    <span class="hljs-keyword">try</span> {</li><li>        gattServer.<span class="hljs-title function_">sendResponse</span>(serverResponse);</li><li>    } <span class="hljs-keyword">catch</span> (err) {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>    }</li><li>}</li><li>gattServer.<span class="hljs-title function_">on</span>(<span class="hljs-string">'descriptorRead'</span>, <span class="hljs-title class_">ReadDescriptorReq</span>);</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1436px;">     <h3 id="offdescriptorread" device-type="phone,2in1,tablet,wearable,tv">off('descriptorRead')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="offdescriptorread" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>off(type: 'descriptorRead', callback?: Callback&lt;DescriptorReadRequest&gt;): void</p>     <p>server端取消订阅client的描述符读请求事件。</p>     <p><strong>需要权限</strong>：ohos.permission.ACCESS_BLUETOOTH</p>     <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.37.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.37.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.37.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.37.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">事件回调类型，支持的事件为'descriptorRead'，表示描述符读请求事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#descriptorreadrequest">DescriptorReadRequest</a>&gt;</td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">          <p>指定取消订阅的回调函数通知。</p>          <p>若传参，则需与<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#ondescriptorread">on('descriptorRead')</a>中的回调函数一致；若无传参，则取消订阅该type对应的所有回调函数通知。</p></td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码说明文档</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.37.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.37.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Invalid parameter. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types. 3. Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wue-c106="" class="highlight-div"><div _ngcontent-wue-c106="" class="highlight-div-header"><div _ngcontent-wue-c106="" class="highlight-div-header-left"><div _ngcontent-wue-c106="" class="handle-button expand-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wue-c106="" class="highlight-div-header-right"><div _ngcontent-wue-c106="" class="handle-button ai-button"></div><div _ngcontent-wue-c106="" class="handle-button line-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wue-c106="" class="handle-button theme-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wue-c106="" class="handle-button copy-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wue-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AsyncCallback</span>, <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">gattServer</span>: ble.<span class="hljs-property">GattServer</span> = ble.<span class="hljs-title function_">createGattServer</span>();</li><li>    gattServer.<span class="hljs-title function_">off</span>(<span class="hljs-string">'descriptorRead'</span>);</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"errCode:"</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">",errMessage:"</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1796px;">     <h3 id="ondescriptorwrite" device-type="phone,2in1,tablet,wearable,tv">on('descriptorWrite')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="ondescriptorwrite" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>on(type: 'descriptorWrite', callback: Callback&lt;DescriptorWriteRequest&gt;): void</p>     <p>server端订阅client的描述符写请求事件，server端收到该事件后需要根据<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#descriptorwriterequest">DescriptorWriteRequest</a>里的needRsp决定是否调用<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#sendresponse">sendResponse</a>接口回复client。</p>     <p><strong>需要权限</strong>：ohos.permission.ACCESS_BLUETOOTH</p>     <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.38.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.38.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.38.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.38.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">          <p>事件回调类型，支持的事件为'descriptorWrite'，表示描述符写请求事件。</p>          <p>当收到client端设备的写描述符请求时，触发该事件。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#descriptorwriterequest">DescriptorWriteRequest</a>&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">指定订阅的回调函数，会携带client端发送的写请求数据。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码说明文档</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.38.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.38.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Invalid parameter. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types. 3. Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wue-c106="" class="highlight-div"><div _ngcontent-wue-c106="" class="highlight-div-header"><div _ngcontent-wue-c106="" class="highlight-div-header-left"><div _ngcontent-wue-c106="" class="handle-button expand-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wue-c106="" class="highlight-div-header-right"><div _ngcontent-wue-c106="" class="handle-button ai-button"></div><div _ngcontent-wue-c106="" class="handle-button line-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wue-c106="" class="handle-button theme-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wue-c106="" class="handle-button copy-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wue-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AsyncCallback</span>, <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">let</span> arrayBufferDesc = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayBuffer</span>(<span class="hljs-number">8</span>);</li><li><span class="hljs-keyword">let</span> descValue = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(arrayBufferDesc);</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">gattServer</span>: ble.<span class="hljs-property">GattServer</span> = ble.<span class="hljs-title function_">createGattServer</span>();</li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">WriteDescriptorReq</span>(<span class="hljs-params">descriptorWriteRequest: ble.DescriptorWriteRequest</span>) {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">deviceId</span>: string = descriptorWriteRequest.<span class="hljs-property">deviceId</span>;</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">transId</span>: number = descriptorWriteRequest.<span class="hljs-property">transId</span>;</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">offset</span>: number = descriptorWriteRequest.<span class="hljs-property">offset</span>;</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">isPrepared</span>: boolean = descriptorWriteRequest.<span class="hljs-property">isPrepared</span>;</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">needRsp</span>: boolean = descriptorWriteRequest.<span class="hljs-property">needRsp</span>;</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">value</span>: <span class="hljs-title class_">Uint8Array</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(descriptorWriteRequest.<span class="hljs-property">value</span>);</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">descriptorUuid</span>: string = descriptorWriteRequest.<span class="hljs-property">descriptorUuid</span>;</li><li>
</li><li>    descValue[<span class="hljs-number">0</span>] = value[<span class="hljs-number">0</span>];</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">serverResponse</span>: ble.<span class="hljs-property">ServerResponse</span> = {<span class="hljs-attr">deviceId</span>: deviceId, <span class="hljs-attr">transId</span>: transId, <span class="hljs-attr">status</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">offset</span>: offset, <span class="hljs-attr">value</span>:arrayBufferDesc};</li><li>
</li><li>    <span class="hljs-keyword">try</span> {</li><li>        gattServer.<span class="hljs-title function_">sendResponse</span>(serverResponse);</li><li>    } <span class="hljs-keyword">catch</span> (err) {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>    }</li><li>}</li><li>gattServer.<span class="hljs-title function_">on</span>(<span class="hljs-string">'descriptorWrite'</span>, <span class="hljs-title class_">WriteDescriptorReq</span>);</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1436px;">     <h3 id="offdescriptorwrite" device-type="phone,2in1,tablet,wearable,tv">off('descriptorWrite')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="offdescriptorwrite" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>off(type: 'descriptorWrite', callback?: Callback&lt;DescriptorWriteRequest&gt;): void</p>     <p>server端取消订阅client的描述符写请求事件。</p>     <p><strong>需要权限</strong>：ohos.permission.ACCESS_BLUETOOTH</p>     <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.39.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.39.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.39.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.39.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">事件回调类型，支持的事件为'descriptorWrite'，表示描述符写请求事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#descriptorwriterequest">DescriptorWriteRequest</a>&gt;</td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">          <p>指定取消订阅的回调函数通知。</p>          <p>若传参，则需与<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#ondescriptorwrite">on('descriptorWrite')</a>中的回调函数一致；若无传参，则取消订阅该type对应的所有回调函数通知。</p></td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码说明文档</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.39.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.39.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Invalid parameter. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types. 3. Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wue-c106="" class="highlight-div"><div _ngcontent-wue-c106="" class="highlight-div-header"><div _ngcontent-wue-c106="" class="highlight-div-header-left"><div _ngcontent-wue-c106="" class="handle-button expand-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wue-c106="" class="highlight-div-header-right"><div _ngcontent-wue-c106="" class="handle-button ai-button"></div><div _ngcontent-wue-c106="" class="handle-button line-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wue-c106="" class="handle-button theme-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wue-c106="" class="handle-button copy-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wue-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AsyncCallback</span>, <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">try</span> {</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">gattServer</span>: ble.<span class="hljs-property">GattServer</span> = ble.<span class="hljs-title function_">createGattServer</span>();</li><li>gattServer.<span class="hljs-title function_">off</span>(<span class="hljs-string">'descriptorWrite'</span>);</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"errCode:"</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">",errMessage:"</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1604px;">     <h3 id="onconnectionstatechange" device-type="phone,2in1,tablet,wearable,tv">on('connectionStateChange')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onconnectionstatechange" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>on(type: 'connectionStateChange', callback: Callback&lt;BLEConnectionChangeState&gt;): void</p>     <p>server端订阅GATT profile协议的连接状态变化事件。使用Callback异步回调。</p>     <p><strong>需要权限</strong>：ohos.permission.ACCESS_BLUETOOTH</p>     <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.40.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.40.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.40.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.40.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">          <p>事件回调类型，支持的事件为'connectionStateChange'，表示GATT profile连接状态发生变化的事件。</p>          <p>当client和server端之间的连接状态发生变化时，触发该事件。</p>          <p>例如：收到连接请求或者断连请求时，可能引起连接状态生变化。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#bleconnectionchangestate">BLEConnectionChangeState</a>&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">指定订阅的回调函数，会携带连接状态。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码说明文档</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.40.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.40.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Invalid parameter. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types. 3. Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wue-c106="" class="highlight-div"><div _ngcontent-wue-c106="" class="highlight-div-header"><div _ngcontent-wue-c106="" class="highlight-div-header-left"><div _ngcontent-wue-c106="" class="handle-button expand-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wue-c106="" class="highlight-div-header-right"><div _ngcontent-wue-c106="" class="handle-button ai-button"></div><div _ngcontent-wue-c106="" class="handle-button line-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wue-c106="" class="handle-button theme-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wue-c106="" class="handle-button copy-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wue-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { constant } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ConnectivityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-title function_">connected</span> = (<span class="hljs-params">bleConnectionChangeState: ble.BLEConnectionChangeState</span>) =&gt; {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">deviceId</span>: string = bleConnectionChangeState.<span class="hljs-property">deviceId</span>;</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">status</span>: constant.<span class="hljs-property">ProfileConnectionState</span> = bleConnectionChangeState.<span class="hljs-property">state</span>;</li><li>}</li><li><span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">gattServer</span>: ble.<span class="hljs-property">GattServer</span> = ble.<span class="hljs-title function_">createGattServer</span>();</li><li>    gattServer.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connectionStateChange'</span>, connected);</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"errCode:"</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">",errMessage:"</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1460px;">     <h3 id="offconnectionstatechange" device-type="phone,2in1,tablet,wearable,tv">off('connectionStateChange')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="offconnectionstatechange" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>off(type: 'connectionStateChange', callback?: Callback&lt;BLEConnectionChangeState&gt;): void</p>     <p>server端取消订阅GATT profile协议的连接状态变化事件。</p>     <p><strong>需要权限</strong>：ohos.permission.ACCESS_BLUETOOTH</p>     <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.41.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.41.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.41.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.41.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">事件回调类型，支持的事件为'connectionStateChange'，表示GATT profile连接状态发生变化的事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#bleconnectionchangestate">BLEConnectionChangeState</a>&gt;</td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">          <p>指定取消订阅的回调函数通知。</p>          <p>若传参，则需与<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#onconnectionstatechange">on('connectionStateChange')</a>中的回调函数一致；若无传参，则取消订阅该type对应的所有回调函数通知。</p></td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码说明文档</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.41.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.41.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Invalid parameter. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types. 3. Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wue-c106="" class="highlight-div"><div _ngcontent-wue-c106="" class="highlight-div-header"><div _ngcontent-wue-c106="" class="highlight-div-header-left"><div _ngcontent-wue-c106="" class="handle-button expand-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wue-c106="" class="highlight-div-header-right"><div _ngcontent-wue-c106="" class="handle-button ai-button"></div><div _ngcontent-wue-c106="" class="handle-button line-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wue-c106="" class="handle-button theme-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wue-c106="" class="handle-button copy-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wue-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AsyncCallback</span>, <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">gattServer</span>: ble.<span class="hljs-property">GattServer</span> = ble.<span class="hljs-title function_">createGattServer</span>();</li><li>    gattServer.<span class="hljs-title function_">off</span>(<span class="hljs-string">'connectionStateChange'</span>);</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"errCode:"</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">",errMessage:"</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1388px;">     <h3 id="onblemtuchange" device-type="phone,2in1,tablet,wearable,tv">on('BLEMtuChange')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onblemtuchange" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>on(type: 'BLEMtuChange', callback: Callback&lt;number&gt;): void</p>     <p>server端订阅MTU（最大传输单元）大小变更事件。使用Callback异步回调。</p>     <p><strong>需要权限</strong>：ohos.permission.ACCESS_BLUETOOTH</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.42.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.42.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.42.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.42.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">          <p>事件回调类型，支持的事件为'BLEMtuChange'，表示MTU状态变化事件。</p>          <p>当收到了client端发起了MTU协商请求时，触发该事件。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;number&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">指定订阅的回调函数，会携带协商后的MTU大小。单位：Byte。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码说明文档</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.42.10.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.42.10.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Invalid parameter. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types. 3. Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wue-c106="" class="highlight-div"><div _ngcontent-wue-c106="" class="highlight-div-header"><div _ngcontent-wue-c106="" class="highlight-div-header-left"><div _ngcontent-wue-c106="" class="handle-button expand-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wue-c106="" class="highlight-div-header-right"><div _ngcontent-wue-c106="" class="handle-button ai-button"></div><div _ngcontent-wue-c106="" class="handle-button line-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wue-c106="" class="handle-button theme-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wue-c106="" class="handle-button copy-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wue-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AsyncCallback</span>, <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">gattServer</span>: ble.<span class="hljs-property">GattServer</span> = ble.<span class="hljs-title function_">createGattServer</span>();</li><li>    gattServer.<span class="hljs-title function_">on</span>(<span class="hljs-string">'BLEMtuChange'</span>, <span class="hljs-function">(<span class="hljs-params">mtu: number</span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'BLEMtuChange, mtu: '</span> + mtu);</li><li>    });</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1388px;">     <h3 id="offblemtuchange" device-type="phone,2in1,tablet,wearable,tv">off('BLEMtuChange')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="offblemtuchange" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>off(type: 'BLEMtuChange', callback?: Callback&lt;number&gt;): void</p>     <p>server端取消订阅MTU（最大传输单元）大小变更事件。</p>     <p><strong>需要权限</strong>：ohos.permission.ACCESS_BLUETOOTH</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.43.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.43.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.43.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.43.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">事件回调类型，支持的事件为"BLEMtuChange"，表示MTU状态变化事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;number&gt;</td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">          <p>指定取消订阅的回调函数通知。</p>          <p>若传参，则需与<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#onblemtuchange">on('BLEMtuChange')</a>中的回调函数一致；若无传参，则取消订阅该type对应的所有回调函数通知。</p></td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码说明文档</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.43.10.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.43.10.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Invalid parameter. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types. 3. Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wue-c106="" class="highlight-div"><div _ngcontent-wue-c106="" class="highlight-div-header"><div _ngcontent-wue-c106="" class="highlight-div-header-left"><div _ngcontent-wue-c106="" class="handle-button expand-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wue-c106="" class="highlight-div-header-right"><div _ngcontent-wue-c106="" class="handle-button ai-button"></div><div _ngcontent-wue-c106="" class="handle-button line-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wue-c106="" class="handle-button theme-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wue-c106="" class="handle-button copy-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wue-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AsyncCallback</span>, <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">gattServer</span>: ble.<span class="hljs-property">GattServer</span> = ble.<span class="hljs-title function_">createGattServer</span>();</li><li>    gattServer.<span class="hljs-title function_">off</span>(<span class="hljs-string">'BLEMtuChange'</span>);</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 262px;">     <h2 id="gattclientdevice" device-type="phone,2in1,tablet,wearable,tv">GattClientDevice<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="gattclientdevice" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>GATT客户端类，提供了和服务端进行连接和数据传输等操作方法。</p>     <ul>      <li>使用该类的方法前，需通过<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#blecreategattclientdevice">createGattClientDevice</a>方法构造该类的实例。</li>      <li>通过创建不同的该类实例，可以管理多路GATT连接。</li>     </ul>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1174px;">     <h3 id="connect" device-type="phone,2in1,tablet,wearable,tv" class="firsth2">connect<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="connect" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>connect(): void</p>     <p>client端主动发起和server蓝牙设备的GATT协议连接。</p>     <ul>      <li>远端设备地址已通过<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#blecreategattclientdevice">createGattClientDevice</a>方法中的deviceId参数指定。</li>      <li>client可通过订阅<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#onbleconnectionstatechange">on('BLEConnectionStateChange')</a>事件来感知连接是否成功。</li>     </ul>     <p><strong>需要权限</strong>：ohos.permission.ACCESS_BLUETOOTH</p>     <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码说明文档</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-bluetoothmanager">蓝牙服务子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.45.10.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.45.10.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900001</td>         <td class="cellrowborder" width="50%">Service stopped.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900003</td>         <td class="cellrowborder" width="50%">Bluetooth disabled.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900099</td>         <td class="cellrowborder" width="50%">Operation failed.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wue-c106="" class="highlight-div"><div _ngcontent-wue-c106="" class="highlight-div-header"><div _ngcontent-wue-c106="" class="highlight-div-header-left"><div _ngcontent-wue-c106="" class="handle-button expand-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wue-c106="" class="highlight-div-header-right"><div _ngcontent-wue-c106="" class="handle-button ai-button"></div><div _ngcontent-wue-c106="" class="handle-button line-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wue-c106="" class="handle-button theme-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wue-c106="" class="handle-button copy-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wue-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AsyncCallback</span>, <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">device</span>: ble.<span class="hljs-property">GattClientDevice</span> = ble.<span class="hljs-title function_">createGattClientDevice</span>(<span class="hljs-string">'XX:XX:XX:XX:XX:XX'</span>);</li><li>    device.<span class="hljs-title function_">connect</span>();</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1158px;">     <h3 id="disconnect" device-type="phone,2in1,tablet,wearable,tv">disconnect<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="disconnect" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>disconnect(): void</p>     <p>client断开与远端蓝牙低功耗设备的连接。</p>     <ul>      <li>client可通过订阅<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#onbleconnectionstatechange">on('BLEConnectionStateChange')</a>事件来感知连接是否成功。</li>     </ul>     <p><strong>需要权限</strong>：ohos.permission.ACCESS_BLUETOOTH</p>     <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码说明文档</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-bluetoothmanager">蓝牙服务子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.46.10.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.46.10.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900001</td>         <td class="cellrowborder" width="50%">Service stopped.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900003</td>         <td class="cellrowborder" width="50%">Bluetooth disabled.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900099</td>         <td class="cellrowborder" width="50%">Operation failed.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wue-c106="" class="highlight-div"><div _ngcontent-wue-c106="" class="highlight-div-header"><div _ngcontent-wue-c106="" class="highlight-div-header-left"><div _ngcontent-wue-c106="" class="handle-button expand-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wue-c106="" class="highlight-div-header-right"><div _ngcontent-wue-c106="" class="handle-button ai-button"></div><div _ngcontent-wue-c106="" class="handle-button line-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wue-c106="" class="handle-button theme-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wue-c106="" class="handle-button copy-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wue-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AsyncCallback</span>, <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">device</span>: ble.<span class="hljs-property">GattClientDevice</span> = ble.<span class="hljs-title function_">createGattClientDevice</span>(<span class="hljs-string">'XX:XX:XX:XX:XX:XX'</span>);</li><li>    device.<span class="hljs-title function_">disconnect</span>();</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1110px;">     <h3 id="close-1" device-type="phone,2in1,tablet,wearable,tv">close<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="close-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>close(): void</p>     <p>销毁client端实例。销毁后，通过<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#gattclientdevice">GattClientDevice</a>创建的实例将不可用。</p>     <p><strong>需要权限</strong>：ohos.permission.ACCESS_BLUETOOTH</p>     <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码说明文档</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-bluetoothmanager">蓝牙服务子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.47.9.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.47.9.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900001</td>         <td class="cellrowborder" width="50%">Service stopped.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900003</td>         <td class="cellrowborder" width="50%">Bluetooth disabled.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900099</td>         <td class="cellrowborder" width="50%">Operation failed.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wue-c106="" class="highlight-div"><div _ngcontent-wue-c106="" class="highlight-div-header"><div _ngcontent-wue-c106="" class="highlight-div-header-left"><div _ngcontent-wue-c106="" class="handle-button expand-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wue-c106="" class="highlight-div-header-right"><div _ngcontent-wue-c106="" class="handle-button ai-button"></div><div _ngcontent-wue-c106="" class="handle-button line-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wue-c106="" class="handle-button theme-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wue-c106="" class="handle-button copy-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wue-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AsyncCallback</span>, <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">device</span>: ble.<span class="hljs-property">GattClientDevice</span> = ble.<span class="hljs-title function_">createGattClientDevice</span>(<span class="hljs-string">'XX:XX:XX:XX:XX:XX'</span>);</li><li>    device.<span class="hljs-title function_">close</span>();</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1645px;">     <h3 id="getdevicename" device-type="phone,2in1,tablet,wearable,tv">getDeviceName<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getdevicename" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>getDeviceName(callback: AsyncCallback&lt;string&gt;): void</p>     <p>client获取server端设备名称。使用Callback异步回调。</p>     <p><strong>需要权限</strong>：ohos.permission.ACCESS_BLUETOOTH</p>     <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.48.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.48.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.48.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.48.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;string&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。当读取成功，err为undefined，data为server端设备名称。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码说明文档</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-bluetoothmanager">蓝牙服务子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.48.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.48.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Invalid parameter. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900001</td>         <td class="cellrowborder" width="50%">Service stopped.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900099</td>         <td class="cellrowborder" width="50%">Operation failed.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wue-c106="" class="highlight-div"><div _ngcontent-wue-c106="" class="highlight-div-header"><div _ngcontent-wue-c106="" class="highlight-div-header-left"><div _ngcontent-wue-c106="" class="handle-button expand-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wue-c106="" class="highlight-div-header-right"><div _ngcontent-wue-c106="" class="handle-button ai-button"></div><div _ngcontent-wue-c106="" class="handle-button line-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wue-c106="" class="handle-button theme-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wue-c106="" class="handle-button copy-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wue-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { ble, constant } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ConnectivityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AsyncCallback</span>, <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">gattClient</span>: ble.<span class="hljs-property">GattClientDevice</span> = ble.<span class="hljs-title function_">createGattClientDevice</span>(<span class="hljs-string">"11:22:33:44:55:66"</span>);</li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">ConnectStateChanged</span>(<span class="hljs-params">state: ble.BLEConnectionChangeState</span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'bluetooth connect state changed'</span>);</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">connectState</span>: ble.<span class="hljs-property">ProfileConnectionState</span> = state.<span class="hljs-property">state</span>;</li><li>    <span class="hljs-keyword">if</span> (connectState == constant.<span class="hljs-property">ProfileConnectionState</span>.<span class="hljs-property">STATE_CONNECTED</span>) {</li><li>        gattClient.<span class="hljs-title function_">getDeviceName</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError, data: string</span>)=&gt;</span> {</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'device name err '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'device name'</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data));</li><li>        })</li><li>    }</li><li>}</li><li><span class="hljs-comment">// callback</span></li><li><span class="hljs-keyword">try</span> {</li><li>    gattClient.<span class="hljs-title function_">connect</span>();</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1617px;">     <h3 id="getdevicename-1" device-type="phone,2in1,tablet,wearable,tv">getDeviceName<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getdevicename-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>getDeviceName(): Promise&lt;string&gt;</p>     <p>client获取远端蓝牙低功耗设备的名称。使用Promise异步回调。</p>     <p><strong>需要权限</strong>：ohos.permission.ACCESS_BLUETOOTH</p>     <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.49.8.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.49.8.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;string&gt;</td>         <td class="cellrowborder" width="50%">Promise对象，携带server端设备名称。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码说明文档</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-bluetoothmanager">蓝牙服务子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.49.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.49.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Invalid parameter. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900001</td>         <td class="cellrowborder" width="50%">Service stopped.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900099</td>         <td class="cellrowborder" width="50%">Operation failed.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wue-c106="" class="highlight-div"><div _ngcontent-wue-c106="" class="highlight-div-header"><div _ngcontent-wue-c106="" class="highlight-div-header-left"><div _ngcontent-wue-c106="" class="handle-button expand-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wue-c106="" class="highlight-div-header-right"><div _ngcontent-wue-c106="" class="handle-button ai-button"></div><div _ngcontent-wue-c106="" class="handle-button line-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wue-c106="" class="handle-button theme-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wue-c106="" class="handle-button copy-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wue-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { ble, constant } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ConnectivityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AsyncCallback</span>, <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">gattClient</span>: ble.<span class="hljs-property">GattClientDevice</span> = ble.<span class="hljs-title function_">createGattClientDevice</span>(<span class="hljs-string">"11:22:33:44:55:66"</span>);</li><li>gattClient.<span class="hljs-title function_">on</span>(<span class="hljs-string">'BLEConnectionStateChange'</span>, <span class="hljs-title class_">ConnectStateChanged</span>);</li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">ConnectStateChanged</span>(<span class="hljs-params">state: ble.BLEConnectionChangeState</span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'bluetooth connect state changed'</span>);</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">connectState</span>: ble.<span class="hljs-property">ProfileConnectionState</span> = state.<span class="hljs-property">state</span>;</li><li>    <span class="hljs-keyword">if</span> (connectState == constant.<span class="hljs-property">ProfileConnectionState</span>.<span class="hljs-property">STATE_CONNECTED</span>) {</li><li>        gattClient.<span class="hljs-title function_">getDeviceName</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">data: string</span>) =&gt;</span> {</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'device name'</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data));</li><li>        })</li><li>    }</li><li>}</li><li><span class="hljs-comment">// promise</span></li><li><span class="hljs-keyword">try</span> {</li><li>    gattClient.<span class="hljs-title function_">connect</span>();</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 2141px;">     <h3 id="getservices" device-type="phone,2in1,tablet,wearable,tv">getServices<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getservices" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>getServices(callback: AsyncCallback&lt;Array&lt;GattService&gt;&gt;): void</p>     <p>client获取server端支持的所有服务能力，即服务发现流程。使用Callback异步回调。</p>     <p>应用调用该方法后，才能调用其他读写特征值、描述符等其他方法，且需确保server支持的服务能力中包含需要操作的特征值或描述符。包含接口如下所示：</p>     <ul>      <li><a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#readcharacteristicvalue">readCharacteristicValue</a></li>      <li><a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#readdescriptorvalue">readDescriptorValue</a></li>      <li><a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#writecharacteristicvalue">writeCharacteristicValue</a></li>      <li><a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#writedescriptorvalue">writeDescriptorValue</a></li>      <li><a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#setcharacteristicchangenotification">setCharacteristicChangeNotification</a></li>      <li><a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#setcharacteristicchangeindication">setCharacteristicChangeIndication</a></li>     </ul>     <p><strong>需要权限</strong>：ohos.permission.ACCESS_BLUETOOTH</p>     <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.50.10.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.50.10.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.50.10.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.50.10.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;Array&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#gattservice">GattService</a>&gt;&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。当读取成功，err为undefined，data为server端的服务列表。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码说明文档</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-bluetoothmanager">蓝牙服务子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.50.13.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.50.13.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Invalid parameter. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900001</td>         <td class="cellrowborder" width="50%">Service stopped.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900099</td>         <td class="cellrowborder" width="50%">Operation failed.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wue-c106="" class="highlight-div"><div _ngcontent-wue-c106="" class="highlight-div-header"><div _ngcontent-wue-c106="" class="highlight-div-header-left"><div _ngcontent-wue-c106="" class="handle-button expand-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wue-c106="" class="highlight-div-header-right"><div _ngcontent-wue-c106="" class="handle-button ai-button"></div><div _ngcontent-wue-c106="" class="handle-button line-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wue-c106="" class="handle-button theme-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wue-c106="" class="handle-button copy-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wue-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { ble, constant } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ConnectivityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AsyncCallback</span>, <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-comment">// callback 模式。</span></li><li><span class="hljs-keyword">let</span> <span class="hljs-title function_">getServices</span> = (<span class="hljs-params">code: BusinessError, gattServices: <span class="hljs-built_in">Array</span>&lt;ble.GattService&gt;</span>) =&gt; {</li><li>    <span class="hljs-keyword">if</span> (code &amp;&amp; code.<span class="hljs-property">code</span> != <span class="hljs-number">0</span>) {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'bluetooth code is '</span> + code.<span class="hljs-property">code</span>);</li><li>        <span class="hljs-keyword">return</span>;</li><li>    }</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">services</span>: <span class="hljs-title class_">Array</span>&lt;ble.<span class="hljs-property">GattService</span>&gt; = gattServices;</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'bluetooth services size is '</span>, services.<span class="hljs-property">length</span>);</li><li>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; services.<span class="hljs-property">length</span>; i++) {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'bluetooth serviceUuid is '</span> + services[i].<span class="hljs-property">serviceUuid</span>);</li><li>    }</li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">device</span>: ble.<span class="hljs-property">GattClientDevice</span> = ble.<span class="hljs-title function_">createGattClientDevice</span>(<span class="hljs-string">"11:22:33:44:55:66"</span>);</li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">ConnectStateChanged</span>(<span class="hljs-params">state: ble.BLEConnectionChangeState</span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'bluetooth connect state changed'</span>);</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">connectState</span>: ble.<span class="hljs-property">ProfileConnectionState</span> = state.<span class="hljs-property">state</span>;</li><li>    <span class="hljs-keyword">if</span> (connectState == constant.<span class="hljs-property">ProfileConnectionState</span>.<span class="hljs-property">STATE_CONNECTED</span>) {</li><li>        device.<span class="hljs-title function_">getServices</span>(getServices);</li><li>    }</li><li>}</li><li>
</li><li><span class="hljs-keyword">try</span> {</li><li>    device.<span class="hljs-title function_">connect</span>();</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1593px;">     <h3 id="getservices-1" device-type="phone,2in1,tablet,wearable,tv">getServices<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getservices-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>getServices(): Promise&lt;Array&lt;GattService&gt;&gt;</p>     <p>client端获取蓝牙低功耗设备的所有服务，即服务发现。使用Promise异步回调。</p>     <p><strong>需要权限</strong>：ohos.permission.ACCESS_BLUETOOTH</p>     <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.51.8.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.51.8.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;Array&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#gattservice">GattService</a>&gt;&gt;</td>         <td class="cellrowborder" width="50%">Promise对象，返回获取到的server端服务列表。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码说明文档</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-bluetoothmanager">蓝牙服务子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.51.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.51.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Invalid parameter. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types. 3. Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900001</td>         <td class="cellrowborder" width="50%">Service stopped.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900099</td>         <td class="cellrowborder" width="50%">Operation failed.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wue-c106="" class="highlight-div"><div _ngcontent-wue-c106="" class="highlight-div-header"><div _ngcontent-wue-c106="" class="highlight-div-header-left"><div _ngcontent-wue-c106="" class="handle-button expand-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wue-c106="" class="highlight-div-header-right"><div _ngcontent-wue-c106="" class="handle-button ai-button"></div><div _ngcontent-wue-c106="" class="handle-button line-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wue-c106="" class="handle-button theme-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wue-c106="" class="handle-button copy-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wue-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { ble, constant } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ConnectivityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AsyncCallback</span>, <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-comment">// Promise 模式。</span></li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">device</span>: ble.<span class="hljs-property">GattClientDevice</span> = ble.<span class="hljs-title function_">createGattClientDevice</span>(<span class="hljs-string">"11:22:33:44:55:66"</span>);</li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">ConnectStateChanged</span>(<span class="hljs-params">state: ble.BLEConnectionChangeState</span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'bluetooth connect state changed'</span>);</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">connectState</span>: ble.<span class="hljs-property">ProfileConnectionState</span> = state.<span class="hljs-property">state</span>;</li><li>    <span class="hljs-keyword">if</span> (connectState == constant.<span class="hljs-property">ProfileConnectionState</span>.<span class="hljs-property">STATE_CONNECTED</span>) {</li><li>        device.<span class="hljs-title function_">getServices</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">result: <span class="hljs-built_in">Array</span>&lt;ble.GattService&gt;</span>) =&gt;</span> {</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'getServices successfully:'</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(result));</li><li>        });</li><li>    }</li><li>}</li><li><span class="hljs-keyword">try</span> {</li><li>    device.<span class="hljs-title function_">connect</span>();</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 2619px;">     <h3 id="readcharacteristicvalue" device-type="phone,2in1,tablet,wearable,tv">readCharacteristicValue<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="readcharacteristicvalue" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>readCharacteristicValue(characteristic: BLECharacteristic, callback: AsyncCallback&lt;BLECharacteristic&gt;): void</p>     <p>client端从指定的server端特征值读取数据。使用Callback异步回调。</p>     <ul>      <li>       <p>需要先调用<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#getservices">getServices</a>，获取到server端所有支持的能力，且包含指定的入参特征值UUID；否则会读取失败。</p></li>      <li>       <p>异步回调结果返回后，才能调用下一次读取或者写入操作，如<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#readcharacteristicvalue">readCharacteristicValue</a>、<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#readdescriptorvalue">readDescriptorValue</a>、<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#writecharacteristicvalue">writeCharacteristicValue</a>、<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#writedescriptorvalue">writeDescriptorValue</a>、<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#setcharacteristicchangenotification">setCharacteristicChangeNotification</a>和<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#setcharacteristicchangeindication">setCharacteristicChangeIndication</a>。</p></li>      <li>读取特征值过程中，需确保<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#blecharacteristic">BLECharacteristic</a>入参特征值的serviceUuid、characteristicUuid准确。characteristicValue表示的数据内容长度可由用户任意指定，不会影响实际读取到的特征值数据内容。</li>     </ul>     <p><strong>需要权限</strong>：ohos.permission.ACCESS_BLUETOOTH</p>     <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.52.9.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.52.9.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.52.9.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.52.9.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">characteristic</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#blecharacteristic">BLECharacteristic</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">需要读取的特征值。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#blecharacteristic">BLECharacteristic</a>&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。当读取成功，err为undefined，data为获取到的特征值对象，包含读取到的数据内容；否则为错误对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码说明文档</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-bluetoothmanager">蓝牙服务子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.52.12.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.52.12.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Invalid parameter. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types. 3. Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900001</td>         <td class="cellrowborder" width="50%">Service stopped.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900011</td>         <td class="cellrowborder" width="50%">The operation is busy. The last operation is not complete.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900099</td>         <td class="cellrowborder" width="50%">Operation failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2901000</td>         <td class="cellrowborder" width="50%">Read forbidden.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2901003</td>         <td class="cellrowborder" width="50%">The connection is not established.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2901004</td>         <td class="cellrowborder" width="50%">The connection is congested.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2901005</td>         <td class="cellrowborder" width="50%">The connection is not encrypted.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2901006</td>         <td class="cellrowborder" width="50%">The connection is not authenticated.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2901007</td>         <td class="cellrowborder" width="50%">The connection is not authorized.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wue-c106="" class="highlight-div"><div _ngcontent-wue-c106="" class="highlight-div-header"><div _ngcontent-wue-c106="" class="highlight-div-header-left"><div _ngcontent-wue-c106="" class="handle-button expand-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wue-c106="" class="highlight-div-header-right"><div _ngcontent-wue-c106="" class="handle-button ai-button"></div><div _ngcontent-wue-c106="" class="handle-button line-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wue-c106="" class="handle-button theme-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wue-c106="" class="handle-button copy-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wue-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AsyncCallback</span>, <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">readCcc</span>(<span class="hljs-params">code: BusinessError, BLECharacteristic: ble.BLECharacteristic</span>) {</li><li>  <span class="hljs-keyword">if</span> (code.<span class="hljs-property">code</span> != <span class="hljs-number">0</span>) {</li><li>      <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'bluetooth characteristic uuid: '</span> + <span class="hljs-title class_">BLECharacteristic</span>.<span class="hljs-property">characteristicUuid</span>);</li><li>  <span class="hljs-keyword">let</span> value = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(<span class="hljs-title class_">BLECharacteristic</span>.<span class="hljs-property">characteristicValue</span>);</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'bluetooth characteristic value: '</span> + value[<span class="hljs-number">0</span>]);</li><li>}</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">descriptors</span>: <span class="hljs-title class_">Array</span>&lt;ble.<span class="hljs-property">BLEDescriptor</span>&gt; = [];</li><li><span class="hljs-keyword">let</span> bufferDesc = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayBuffer</span>(<span class="hljs-number">2</span>);</li><li><span class="hljs-keyword">let</span> descV = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(bufferDesc);</li><li>descV[<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>; <span class="hljs-comment">// 以Client Characteristic Configuration描述符为例，表示bit0、bit1均为0，notification和indication均不开启</span></li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">descriptor</span>: ble.<span class="hljs-property">BLEDescriptor</span> = {<span class="hljs-attr">serviceUuid</span>: <span class="hljs-string">'00001810-0000-1000-8000-00805F9B34FB'</span>,</li><li><span class="hljs-attr">characteristicUuid</span>: <span class="hljs-string">'00001820-0000-1000-8000-00805F9B34FB'</span>,</li><li><span class="hljs-attr">descriptorUuid</span>: <span class="hljs-string">'00002902-0000-1000-8000-00805F9B34FB'</span>, <span class="hljs-attr">descriptorValue</span>: bufferDesc};</li><li>descriptors[<span class="hljs-number">0</span>] = descriptor;</li><li>
</li><li><span class="hljs-keyword">let</span> bufferCCC = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayBuffer</span>(<span class="hljs-number">8</span>);</li><li><span class="hljs-keyword">let</span> cccV = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(bufferCCC);</li><li>cccV[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">characteristic</span>: ble.<span class="hljs-property">BLECharacteristic</span> = {<span class="hljs-attr">serviceUuid</span>: <span class="hljs-string">'00001810-0000-1000-8000-00805F9B34FB'</span>,</li><li><span class="hljs-attr">characteristicUuid</span>: <span class="hljs-string">'00001820-0000-1000-8000-00805F9B34FB'</span>,</li><li><span class="hljs-attr">characteristicValue</span>: bufferCCC, <span class="hljs-attr">descriptors</span>:descriptors};</li><li>
</li><li><span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">device</span>: ble.<span class="hljs-property">GattClientDevice</span> = ble.<span class="hljs-title function_">createGattClientDevice</span>(<span class="hljs-string">'XX:XX:XX:XX:XX:XX'</span>);</li><li>    device.<span class="hljs-title function_">readCharacteristicValue</span>(characteristic, readCcc);</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 2457px;">     <h3 id="readcharacteristicvalue-1" device-type="phone,2in1,tablet,wearable,tv">readCharacteristicValue<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="readcharacteristicvalue-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>readCharacteristicValue(characteristic: BLECharacteristic): Promise&lt;BLECharacteristic&gt;</p>     <p>client端从指定的server端特征值读取数据。使用Promise异步回调。</p>     <ul>      <li>       <p>需要先调用<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#getservices">getServices</a>，获取到server端所有支持的能力，且包含指定的入参特征值UUID；否则会读取失败。</p></li>      <li>       <p>异步回调结果返回后，才能调用下一次读取或者写入操作，如<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#readcharacteristicvalue">readCharacteristicValue</a>、<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#readdescriptorvalue">readDescriptorValue</a>、<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#writecharacteristicvalue">writeCharacteristicValue</a>、<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#writedescriptorvalue">writeDescriptorValue</a>、<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#setcharacteristicchangenotification">setCharacteristicChangeNotification</a>和<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#setcharacteristicchangeindication">setCharacteristicChangeIndication</a>。</p></li>      <li>读取特征值过程中，需确保<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#blecharacteristic">BLECharacteristic</a>入参特征值的serviceUuid、characteristicUuid准确。characteristicValue表示的数据内容长度可由用户任意指定，不会影响实际读取到的特征值数据内容。</li>     </ul>     <p><strong>需要权限</strong>：ohos.permission.ACCESS_BLUETOOTH</p>     <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.53.9.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.53.9.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.53.9.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.53.9.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">characteristic</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#blecharacteristic">BLECharacteristic</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">需要读取的特征值。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.53.11.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.53.11.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#blecharacteristic">BLECharacteristic</a>&gt;</td>         <td class="cellrowborder" width="50%">Promise对象，返回获取到的特征值对象，包含读取到的数据内容。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码说明文档</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-bluetoothmanager">蓝牙服务子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.53.14.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.53.14.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Invalid parameter. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types. 3. Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900001</td>         <td class="cellrowborder" width="50%">Service stopped.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900011</td>         <td class="cellrowborder" width="50%">The operation is busy. The last operation is not complete.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900099</td>         <td class="cellrowborder" width="50%">Operation failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2901000</td>         <td class="cellrowborder" width="50%">Read forbidden.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2901003</td>         <td class="cellrowborder" width="50%">The connection is not established.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2901004</td>         <td class="cellrowborder" width="50%">The connection is congested.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2901005</td>         <td class="cellrowborder" width="50%">The connection is not encrypted.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2901006</td>         <td class="cellrowborder" width="50%">The connection is not authenticated.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2901007</td>         <td class="cellrowborder" width="50%">The connection is not authorized.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wue-c106="" class="highlight-div"><div _ngcontent-wue-c106="" class="highlight-div-header"><div _ngcontent-wue-c106="" class="highlight-div-header-left"><div _ngcontent-wue-c106="" class="handle-button expand-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wue-c106="" class="highlight-div-header-right"><div _ngcontent-wue-c106="" class="handle-button ai-button"></div><div _ngcontent-wue-c106="" class="handle-button line-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wue-c106="" class="handle-button theme-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wue-c106="" class="handle-button copy-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wue-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AsyncCallback</span>, <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">descriptors</span>: <span class="hljs-title class_">Array</span>&lt;ble.<span class="hljs-property">BLEDescriptor</span>&gt; = [];</li><li><span class="hljs-keyword">let</span> bufferDesc = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayBuffer</span>(<span class="hljs-number">2</span>);</li><li><span class="hljs-keyword">let</span> descV = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(bufferDesc);</li><li>descV[<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>; <span class="hljs-comment">// 以Client Characteristic Configuration描述符为例，表示bit0、bit1均为0，notification和indication均不开启</span></li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">descriptor</span>: ble.<span class="hljs-property">BLEDescriptor</span> = {<span class="hljs-attr">serviceUuid</span>: <span class="hljs-string">'00001810-0000-1000-8000-00805F9B34FB'</span>,</li><li><span class="hljs-attr">characteristicUuid</span>: <span class="hljs-string">'00001820-0000-1000-8000-00805F9B34FB'</span>,</li><li><span class="hljs-attr">descriptorUuid</span>: <span class="hljs-string">'00002902-0000-1000-8000-00805F9B34FB'</span>, <span class="hljs-attr">descriptorValue</span>: bufferDesc};</li><li>descriptors[<span class="hljs-number">0</span>] = descriptor;</li><li>
</li><li><span class="hljs-keyword">let</span> bufferCCC = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayBuffer</span>(<span class="hljs-number">8</span>);</li><li><span class="hljs-keyword">let</span> cccV = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(bufferCCC);</li><li>cccV[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">characteristic</span>: ble.<span class="hljs-property">BLECharacteristic</span> = {<span class="hljs-attr">serviceUuid</span>: <span class="hljs-string">'00001810-0000-1000-8000-00805F9B34FB'</span>,</li><li><span class="hljs-attr">characteristicUuid</span>: <span class="hljs-string">'00001820-0000-1000-8000-00805F9B34FB'</span>,</li><li><span class="hljs-attr">characteristicValue</span>: bufferCCC, <span class="hljs-attr">descriptors</span>:descriptors};</li><li>
</li><li><span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">device</span>: ble.<span class="hljs-property">GattClientDevice</span> = ble.<span class="hljs-title function_">createGattClientDevice</span>(<span class="hljs-string">'XX:XX:XX:XX:XX:XX'</span>);</li><li>    device.<span class="hljs-title function_">readCharacteristicValue</span>(characteristic);</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 2451px;">     <h3 id="readdescriptorvalue" device-type="phone,2in1,tablet,wearable,tv">readDescriptorValue<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="readdescriptorvalue" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>readDescriptorValue(descriptor: BLEDescriptor, callback: AsyncCallback&lt;BLEDescriptor&gt;): void</p>     <p>client端从指定的server端描述符读取数据。使用Callback异步回调。</p>     <ul>      <li>       <p>需要先调用<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#getservices">getServices</a>，获取到server端所有支持的能力，且包含指定的入参描述符UUID；否则会读取失败。</p></li>      <li>异步回调结果返回后，才能调用下一次读取或者写入操作，如<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#readcharacteristicvalue">readCharacteristicValue</a>、<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#readdescriptorvalue">readDescriptorValue</a>、<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#writecharacteristicvalue">writeCharacteristicValue</a>、<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#writedescriptorvalue">writeDescriptorValue</a>、<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#setcharacteristicchangenotification">setCharacteristicChangeNotification</a>和<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#setcharacteristicchangeindication">setCharacteristicChangeIndication</a>。</li>      <li>读取描述符过程中，需确保<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#bledescriptor">BLEDescriptor</a>入参描述符的serviceUuid、characteristicUuid、descriptorUuid准确。descriptorValue表示的数据内容长度可由用户任意指定，不会影响实际读取到的描述符数据内容。</li>     </ul>     <p><strong>需要权限</strong>：ohos.permission.ACCESS_BLUETOOTH</p>     <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.54.9.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.54.9.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.54.9.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.54.9.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">descriptor</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#bledescriptor">BLEDescriptor</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">需要读取的描述符。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#bledescriptor">BLEDescriptor</a>&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。当读取成功，err为undefined，data为获取到的描述符对象，包含读取到的数据内容；否则为错误对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码说明文档</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-bluetoothmanager">蓝牙服务子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.54.12.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.54.12.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Invalid parameter. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types. 3. Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900001</td>         <td class="cellrowborder" width="50%">Service stopped.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900011</td>         <td class="cellrowborder" width="50%">The operation is busy. The last operation is not complete.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900099</td>         <td class="cellrowborder" width="50%">Operation failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2901000</td>         <td class="cellrowborder" width="50%">Read forbidden.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2901003</td>         <td class="cellrowborder" width="50%">The connection is not established.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2901004</td>         <td class="cellrowborder" width="50%">The connection is congested.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2901005</td>         <td class="cellrowborder" width="50%">The connection is not encrypted.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2901006</td>         <td class="cellrowborder" width="50%">The connection is not authenticated.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2901007</td>         <td class="cellrowborder" width="50%">The connection is not authorized.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wue-c106="" class="highlight-div"><div _ngcontent-wue-c106="" class="highlight-div-header"><div _ngcontent-wue-c106="" class="highlight-div-header-left"><div _ngcontent-wue-c106="" class="handle-button expand-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wue-c106="" class="highlight-div-header-right"><div _ngcontent-wue-c106="" class="handle-button ai-button"></div><div _ngcontent-wue-c106="" class="handle-button line-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wue-c106="" class="handle-button theme-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wue-c106="" class="handle-button copy-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wue-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AsyncCallback</span>, <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">readDesc</span>(<span class="hljs-params">code: BusinessError, BLEDescriptor: ble.BLEDescriptor</span>) {</li><li>    <span class="hljs-keyword">if</span> (code.<span class="hljs-property">code</span> != <span class="hljs-number">0</span>) {</li><li>        <span class="hljs-keyword">return</span>;</li><li>    }</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'bluetooth descriptor uuid: '</span> + <span class="hljs-title class_">BLEDescriptor</span>.<span class="hljs-property">descriptorUuid</span>);</li><li>    <span class="hljs-keyword">let</span> value = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(<span class="hljs-title class_">BLEDescriptor</span>.<span class="hljs-property">descriptorValue</span>);</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'bluetooth descriptor value: '</span> + value[<span class="hljs-number">0</span>]);</li><li>}</li><li>
</li><li><span class="hljs-keyword">let</span> bufferDesc = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayBuffer</span>(<span class="hljs-number">2</span>);</li><li><span class="hljs-keyword">let</span> descV = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(bufferDesc);</li><li>descV[<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>; <span class="hljs-comment">// 以Client Characteristic Configuration描述符为例，表示bit0、bit1均为0，notification和indication均不开启</span></li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">descriptor</span>: ble.<span class="hljs-property">BLEDescriptor</span> = {</li><li>    <span class="hljs-attr">serviceUuid</span>: <span class="hljs-string">'00001810-0000-1000-8000-00805F9B34FB'</span>,</li><li>    <span class="hljs-attr">characteristicUuid</span>: <span class="hljs-string">'00001820-0000-1000-8000-00805F9B34FB'</span>,</li><li>    <span class="hljs-attr">descriptorUuid</span>: <span class="hljs-string">'00002902-0000-1000-8000-00805F9B34FB'</span>,</li><li>    <span class="hljs-attr">descriptorValue</span>: bufferDesc</li><li>};</li><li><span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">device</span>: ble.<span class="hljs-property">GattClientDevice</span> = ble.<span class="hljs-title function_">createGattClientDevice</span>(<span class="hljs-string">'XX:XX:XX:XX:XX:XX'</span>);</li><li>    device.<span class="hljs-title function_">readDescriptorValue</span>(descriptor, readDesc);</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 2289px;">     <h3 id="readdescriptorvalue-1" device-type="phone,2in1,tablet,wearable,tv">readDescriptorValue<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="readdescriptorvalue-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>readDescriptorValue(descriptor: BLEDescriptor): Promise&lt;BLEDescriptor&gt;</p>     <p>client端从指定的server端描述符读取数据。使用Promise异步回调。</p>     <ul>      <li>       <p>需要先调用<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#getservices">getServices</a>，获取到server端所有支持的能力，且包含指定的入参描述符UUID；否则会读取失败。</p></li>      <li>       <p>异步回调结果返回后，才能调用下一次读取或者写入操作，如<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#readcharacteristicvalue">readCharacteristicValue</a>、<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#readdescriptorvalue">readDescriptorValue</a>、<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#writecharacteristicvalue">writeCharacteristicValue</a>、<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#writedescriptorvalue">writeDescriptorValue</a>、<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#setcharacteristicchangenotification">setCharacteristicChangeNotification</a>和<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#setcharacteristicchangeindication">setCharacteristicChangeIndication</a>。</p></li>      <li>读取描述符过程中，需确保<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#bledescriptor">BLEDescriptor</a>入参描述符的serviceUuid、characteristicUuid、descriptorUuid准确。descriptorValue表示的数据内容长度可由用户任意指定，不会影响实际读取到的描述符数据内容。</li>     </ul>     <p><strong>需要权限</strong>：ohos.permission.ACCESS_BLUETOOTH</p>     <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.55.9.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.55.9.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.55.9.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.55.9.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">descriptor</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#bledescriptor">BLEDescriptor</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">需要读取的描述符。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.55.11.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.55.11.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#bledescriptor">BLEDescriptor</a>&gt;</td>         <td class="cellrowborder" width="50%">Promise对象，返回获取到的描述符对象，包含读取到的数据内容。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码说明文档</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-bluetoothmanager">蓝牙服务子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.55.14.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.55.14.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Invalid parameter. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types. 3. Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900001</td>         <td class="cellrowborder" width="50%">Service stopped.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900011</td>         <td class="cellrowborder" width="50%">The operation is busy. The last operation is not complete.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900099</td>         <td class="cellrowborder" width="50%">Operation failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2901000</td>         <td class="cellrowborder" width="50%">Read forbidden.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2901003</td>         <td class="cellrowborder" width="50%">The connection is not established.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2901004</td>         <td class="cellrowborder" width="50%">The connection is congested.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2901005</td>         <td class="cellrowborder" width="50%">The connection is not encrypted.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2901006</td>         <td class="cellrowborder" width="50%">The connection is not authenticated.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2901007</td>         <td class="cellrowborder" width="50%">The connection is not authorized.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wue-c106="" class="highlight-div"><div _ngcontent-wue-c106="" class="highlight-div-header"><div _ngcontent-wue-c106="" class="highlight-div-header-left"><div _ngcontent-wue-c106="" class="handle-button expand-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wue-c106="" class="highlight-div-header-right"><div _ngcontent-wue-c106="" class="handle-button ai-button"></div><div _ngcontent-wue-c106="" class="handle-button line-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wue-c106="" class="handle-button theme-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wue-c106="" class="handle-button copy-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wue-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AsyncCallback</span>, <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">let</span> bufferDesc = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayBuffer</span>(<span class="hljs-number">2</span>);</li><li><span class="hljs-keyword">let</span> descV = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(bufferDesc);</li><li>descV[<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>; <span class="hljs-comment">// 以Client Characteristic Configuration描述符为例，表示bit0、bit1均为0，notification和indication均不开启</span></li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">descriptor</span>: ble.<span class="hljs-property">BLEDescriptor</span> = {</li><li>    <span class="hljs-attr">serviceUuid</span>: <span class="hljs-string">'00001810-0000-1000-8000-00805F9B34FB'</span>,</li><li>    <span class="hljs-attr">characteristicUuid</span>: <span class="hljs-string">'00001820-0000-1000-8000-00805F9B34FB'</span>,</li><li>    <span class="hljs-attr">descriptorUuid</span>: <span class="hljs-string">'00002902-0000-1000-8000-00805F9B34FB'</span>,</li><li>    <span class="hljs-attr">descriptorValue</span>: bufferDesc</li><li>};</li><li><span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">device</span>: ble.<span class="hljs-property">GattClientDevice</span> = ble.<span class="hljs-title function_">createGattClientDevice</span>(<span class="hljs-string">'XX:XX:XX:XX:XX:XX'</span>);</li><li>    device.<span class="hljs-title function_">readDescriptorValue</span>(descriptor);</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 2520px;">     <h3 id="writecharacteristicvalue" device-type="phone,2in1,tablet,wearable,tv">writeCharacteristicValue<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="writecharacteristicvalue" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>writeCharacteristicValue(characteristic: BLECharacteristic, writeType: GattWriteType, callback: AsyncCallback&lt;void&gt;): void</p>     <p>client端向指定的server端特征值写入数据。使用Callback异步回调。</p>     <ul>      <li>       <p>需要先调用<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#getservices">getServices</a>，获取到server端所有支持的能力，且包含指定的入参特征值UUID；否则会写入失败。</p></li>      <li>       <p>异步回调结果返回后，才能调用下一次读取或者写入操作，如<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#readcharacteristicvalue">readCharacteristicValue</a>、<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#readdescriptorvalue">readDescriptorValue</a>、<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#writecharacteristicvalue">writeCharacteristicValue</a>、<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#writedescriptorvalue">writeDescriptorValue</a>、<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#setcharacteristicchangenotification">setCharacteristicChangeNotification</a>和<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#setcharacteristicchangeindication">setCharacteristicChangeIndication</a>。</p></li>      <li>应用单次可写入的特征值数据长度默认限制为（MTU-3）字节，MTU大小可由<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#setblemtusize">setBLEMtuSize</a>接口指定。</li>     </ul>     <p><strong>需要权限</strong>：ohos.permission.ACCESS_BLUETOOTH</p>     <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.56.9.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.56.9.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.56.9.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.56.9.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">characteristic</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#blecharacteristic">BLECharacteristic</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">需要写入的特征值，包含写入的数据内容。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">writeType</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#gattwritetype">GattWriteType</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">写入特征值的方式。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;void&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。当写入成功，err为undefined，否则为错误对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码说明文档</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-bluetoothmanager">蓝牙服务子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.56.12.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.56.12.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Invalid parameter. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types. 3. Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900001</td>         <td class="cellrowborder" width="50%">Service stopped.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900011</td>         <td class="cellrowborder" width="50%">The operation is busy. The last operation is not complete.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900099</td>         <td class="cellrowborder" width="50%">Operation failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2901001</td>         <td class="cellrowborder" width="50%">Write forbidden.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2901003</td>         <td class="cellrowborder" width="50%">The connection is not established.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2901004</td>         <td class="cellrowborder" width="50%">The connection is congested.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2901005</td>         <td class="cellrowborder" width="50%">The connection is not encrypted.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2901006</td>         <td class="cellrowborder" width="50%">The connection is not authenticated.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2901007</td>         <td class="cellrowborder" width="50%">The connection is not authorized.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wue-c106="" class="highlight-div"><div _ngcontent-wue-c106="" class="highlight-div-header"><div _ngcontent-wue-c106="" class="highlight-div-header-left"><div _ngcontent-wue-c106="" class="handle-button expand-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wue-c106="" class="highlight-div-header-right"><div _ngcontent-wue-c106="" class="handle-button ai-button"></div><div _ngcontent-wue-c106="" class="handle-button line-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wue-c106="" class="handle-button theme-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wue-c106="" class="handle-button copy-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wue-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AsyncCallback</span>, <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">descriptors</span>: <span class="hljs-title class_">Array</span>&lt;ble.<span class="hljs-property">BLEDescriptor</span>&gt; = [];</li><li><span class="hljs-keyword">let</span> bufferDesc = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayBuffer</span>(<span class="hljs-number">2</span>);</li><li><span class="hljs-keyword">let</span> descV = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(bufferDesc);</li><li>descV[<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>; <span class="hljs-comment">// 以Client Characteristic Configuration描述符为例，表示bit0、bit1均为0，notification和indication均不开启</span></li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">descriptor</span>: ble.<span class="hljs-property">BLEDescriptor</span> = {<span class="hljs-attr">serviceUuid</span>: <span class="hljs-string">'00001810-0000-1000-8000-00805F9B34FB'</span>,</li><li>  <span class="hljs-attr">characteristicUuid</span>: <span class="hljs-string">'00001820-0000-1000-8000-00805F9B34FB'</span>,</li><li>  <span class="hljs-attr">descriptorUuid</span>: <span class="hljs-string">'00002902-0000-1000-8000-00805F9B34FB'</span>, <span class="hljs-attr">descriptorValue</span>: bufferDesc};</li><li>descriptors[<span class="hljs-number">0</span>] = descriptor;</li><li>
</li><li><span class="hljs-keyword">let</span> bufferCCC = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayBuffer</span>(<span class="hljs-number">8</span>);</li><li><span class="hljs-keyword">let</span> cccV = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(bufferCCC);</li><li>cccV[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">characteristic</span>: ble.<span class="hljs-property">BLECharacteristic</span> = {<span class="hljs-attr">serviceUuid</span>: <span class="hljs-string">'00001810-0000-1000-8000-00805F9B34FB'</span>,</li><li>  <span class="hljs-attr">characteristicUuid</span>: <span class="hljs-string">'00001820-0000-1000-8000-00805F9B34FB'</span>,</li><li>  <span class="hljs-attr">characteristicValue</span>: bufferCCC, <span class="hljs-attr">descriptors</span>:descriptors};</li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">writeCharacteristicValueCallBack</span>(<span class="hljs-params">code: BusinessError</span>) {</li><li>    <span class="hljs-keyword">if</span> (code != <span class="hljs-literal">null</span>) {</li><li>        <span class="hljs-keyword">return</span>;</li><li>    }</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'bluetooth writeCharacteristicValue success'</span>);</li><li>}</li><li><span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">device</span>: ble.<span class="hljs-property">GattClientDevice</span> = ble.<span class="hljs-title function_">createGattClientDevice</span>(<span class="hljs-string">'XX:XX:XX:XX:XX:XX'</span>);</li><li>    device.<span class="hljs-title function_">writeCharacteristicValue</span>(characteristic, ble.<span class="hljs-property">GattWriteType</span>.<span class="hljs-property">WRITE</span>, writeCharacteristicValueCallBack);</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 2454px;">     <h3 id="writecharacteristicvalue-1" device-type="phone,2in1,tablet,wearable,tv">writeCharacteristicValue<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="writecharacteristicvalue-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>writeCharacteristicValue(characteristic: BLECharacteristic, writeType: GattWriteType): Promise&lt;void&gt;</p>     <p>client端向指定的server端特征值写入数据。使用Promise异步回调。</p>     <ul>      <li>       <p>需要先调用<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#getservices">getServices</a>，获取到server端所有支持的能力，且包含指定的入参特征值UUID；否则会写入失败。</p></li>      <li>       <p>异步回调结果返回后，才能调用下一次读取或者写入操作，如<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#readcharacteristicvalue">readCharacteristicValue</a>、<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#readdescriptorvalue">readDescriptorValue</a>、<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#writecharacteristicvalue">writeCharacteristicValue</a>、<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#writedescriptorvalue">writeDescriptorValue</a>、<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#setcharacteristicchangenotification">setCharacteristicChangeNotification</a>和<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#setcharacteristicchangeindication">setCharacteristicChangeIndication</a>。</p></li>      <li>应用单次可写入的特征值数据长度默认限制为（MTU-3）字节，MTU大小可由<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#setblemtusize">setBLEMtuSize</a>接口指定。</li>     </ul>     <p><strong>需要权限</strong>：ohos.permission.ACCESS_BLUETOOTH</p>     <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.57.9.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.57.9.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.57.9.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.57.9.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">characteristic</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#blecharacteristic">BLECharacteristic</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">需要写入的特征值，包含写入的数据内容。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">writeType</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#gattwritetype">GattWriteType</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">写入特征值的方式。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.57.11.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.57.11.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">Promise对象。无返回结果的Promise对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码说明文档</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-bluetoothmanager">蓝牙服务子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.57.14.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.57.14.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Invalid parameter. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types. 3. Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900001</td>         <td class="cellrowborder" width="50%">Service stopped.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900011</td>         <td class="cellrowborder" width="50%">The operation is busy. The last operation is not complete.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900099</td>         <td class="cellrowborder" width="50%">Operation failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2901001</td>         <td class="cellrowborder" width="50%">Write forbidden.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2901003</td>         <td class="cellrowborder" width="50%">The connection is not established.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2901004</td>         <td class="cellrowborder" width="50%">The connection is congested.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2901005</td>         <td class="cellrowborder" width="50%">The connection is not encrypted.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2901006</td>         <td class="cellrowborder" width="50%">The connection is not authenticated.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2901007</td>         <td class="cellrowborder" width="50%">The connection is not authorized.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wue-c106="" class="highlight-div"><div _ngcontent-wue-c106="" class="highlight-div-header"><div _ngcontent-wue-c106="" class="highlight-div-header-left"><div _ngcontent-wue-c106="" class="handle-button expand-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wue-c106="" class="highlight-div-header-right"><div _ngcontent-wue-c106="" class="handle-button ai-button"></div><div _ngcontent-wue-c106="" class="handle-button line-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wue-c106="" class="handle-button theme-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wue-c106="" class="handle-button copy-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wue-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AsyncCallback</span>, <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">descriptors</span>: <span class="hljs-title class_">Array</span>&lt;ble.<span class="hljs-property">BLEDescriptor</span>&gt;  = [];</li><li><span class="hljs-keyword">let</span> bufferDesc = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayBuffer</span>(<span class="hljs-number">2</span>);</li><li><span class="hljs-keyword">let</span> descV = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(bufferDesc);</li><li>descV[<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>; <span class="hljs-comment">// 以Client Characteristic Configuration描述符为例，表示bit0、bit1均为0，notification和indication均不开启</span></li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">descriptor</span>: ble.<span class="hljs-property">BLEDescriptor</span> = {<span class="hljs-attr">serviceUuid</span>: <span class="hljs-string">'00001810-0000-1000-8000-00805F9B34FB'</span>,</li><li>  <span class="hljs-attr">characteristicUuid</span>: <span class="hljs-string">'00001820-0000-1000-8000-00805F9B34FB'</span>,</li><li>  <span class="hljs-attr">descriptorUuid</span>: <span class="hljs-string">'00002902-0000-1000-8000-00805F9B34FB'</span>, <span class="hljs-attr">descriptorValue</span>: bufferDesc};</li><li>descriptors[<span class="hljs-number">0</span>] = descriptor;</li><li>
</li><li><span class="hljs-keyword">let</span> bufferCCC = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayBuffer</span>(<span class="hljs-number">8</span>);</li><li><span class="hljs-keyword">let</span> cccV = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(bufferCCC);</li><li>cccV[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">characteristic</span>: ble.<span class="hljs-property">BLECharacteristic</span> = {<span class="hljs-attr">serviceUuid</span>: <span class="hljs-string">'00001810-0000-1000-8000-00805F9B34FB'</span>,</li><li>  <span class="hljs-attr">characteristicUuid</span>: <span class="hljs-string">'00001820-0000-1000-8000-00805F9B34FB'</span>,</li><li>  <span class="hljs-attr">characteristicValue</span>: bufferCCC, <span class="hljs-attr">descriptors</span>:descriptors};</li><li><span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">device</span>: ble.<span class="hljs-property">GattClientDevice</span> = ble.<span class="hljs-title function_">createGattClientDevice</span>(<span class="hljs-string">'XX:XX:XX:XX:XX:XX'</span>);</li><li>    device.<span class="hljs-title function_">writeCharacteristicValue</span>(characteristic, ble.<span class="hljs-property">GattWriteType</span>.<span class="hljs-property">WRITE</span>);</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 2411px;">     <h3 id="writedescriptorvalue" device-type="phone,2in1,tablet,wearable,tv">writeDescriptorValue<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="writedescriptorvalue" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>writeDescriptorValue(descriptor: BLEDescriptor, callback: AsyncCallback&lt;void&gt;): void</p>     <p>client端向指定的server端描述符写入数据。使用Callback异步回调。</p>     <ul>      <li>       <p>需要先调用<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#getservices">getServices</a>，获取到server端所有支持的能力，且包含指定的入参描述符UUID；否则会写入失败。</p></li>      <li>       <p>异步回调结果返回后，才能调用下一次读取或者写入操作，如<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#readcharacteristicvalue">readCharacteristicValue</a>、<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#readdescriptorvalue">readDescriptorValue</a>、<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#writecharacteristicvalue">writeCharacteristicValue</a>、<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#writedescriptorvalue">writeDescriptorValue</a>、<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#setcharacteristicchangenotification">setCharacteristicChangeNotification</a>和<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#setcharacteristicchangeindication">setCharacteristicChangeIndication</a>。</p></li>      <li>       <p>应用单次可写入的描述符数据长度默认限制为（MTU-3）字节，MTU大小可由<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#setblemtusize">setBLEMtuSize</a>接口指定。</p></li>      <li>Client Characteristic Configuration描述符（UUID：00002902-0000-1000-8000-00805f9b34fb）和 Server Characteristic Configuration描述符（UUID：00002903-0000-1000-8000-00805f9b34fb）较为特殊，蓝牙标准协议规定内容长度为2字节，写入内容长度应设置为2字节。</li>     </ul>     <p><strong>需要权限</strong>：ohos.permission.ACCESS_BLUETOOTH</p>     <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.58.9.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.58.9.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.58.9.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.58.9.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">descriptor</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#bledescriptor">BLEDescriptor</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">需要写入的描述符，包含写入的数据内容。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;void&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。当写入成功，err为undefined，否则为错误对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码说明文档</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-bluetoothmanager">蓝牙服务子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.58.12.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.58.12.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Invalid parameter. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types. 3. Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900001</td>         <td class="cellrowborder" width="50%">Service stopped.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900011</td>         <td class="cellrowborder" width="50%">The operation is busy. The last operation is not complete.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900099</td>         <td class="cellrowborder" width="50%">Operation failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2901001</td>         <td class="cellrowborder" width="50%">Write forbidden.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2901003</td>         <td class="cellrowborder" width="50%">The connection is not established.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2901004</td>         <td class="cellrowborder" width="50%">The connection is congested.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2901005</td>         <td class="cellrowborder" width="50%">The connection is not encrypted.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2901006</td>         <td class="cellrowborder" width="50%">The connection is not authenticated.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2901007</td>         <td class="cellrowborder" width="50%">The connection is not authorized.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wue-c106="" class="highlight-div"><div _ngcontent-wue-c106="" class="highlight-div-header"><div _ngcontent-wue-c106="" class="highlight-div-header-left"><div _ngcontent-wue-c106="" class="handle-button expand-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wue-c106="" class="highlight-div-header-right"><div _ngcontent-wue-c106="" class="handle-button ai-button"></div><div _ngcontent-wue-c106="" class="handle-button line-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wue-c106="" class="handle-button theme-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wue-c106="" class="handle-button copy-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wue-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AsyncCallback</span>, <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">let</span> bufferDesc = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayBuffer</span>(<span class="hljs-number">2</span>);</li><li><span class="hljs-keyword">let</span> descV = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(bufferDesc);</li><li>descV[<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>; <span class="hljs-comment">// 以Client Characteristic Configuration描述符为例，表示bit0、bit1均为0，notification和indication均不开启</span></li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">descriptor</span>: ble.<span class="hljs-property">BLEDescriptor</span> = {</li><li>    <span class="hljs-attr">serviceUuid</span>: <span class="hljs-string">'00001810-0000-1000-8000-00805F9B34FB'</span>,</li><li>    <span class="hljs-attr">characteristicUuid</span>: <span class="hljs-string">'00001820-0000-1000-8000-00805F9B34FB'</span>,</li><li>    <span class="hljs-attr">descriptorUuid</span>: <span class="hljs-string">'00002902-0000-1000-8000-00805F9B34FB'</span>,</li><li>    <span class="hljs-attr">descriptorValue</span>: bufferDesc</li><li>};</li><li><span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">device</span>: ble.<span class="hljs-property">GattClientDevice</span> = ble.<span class="hljs-title function_">createGattClientDevice</span>(<span class="hljs-string">'XX:XX:XX:XX:XX:XX'</span>);</li><li>    device.<span class="hljs-title function_">writeDescriptorValue</span>(descriptor, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>        <span class="hljs-keyword">if</span> (err) {</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'writeDescriptorValue callback failed'</span>);</li><li>        } <span class="hljs-keyword">else</span> {</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'writeDescriptorValue callback successful'</span>);</li><li>        }</li><li>    });</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 2393px;">     <h3 id="writedescriptorvalue-1" device-type="phone,2in1,tablet,wearable,tv">writeDescriptorValue<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="writedescriptorvalue-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>writeDescriptorValue(descriptor: BLEDescriptor): Promise&lt;void&gt;</p>     <p>client端向指定的server端描述符写入数据。使用Promise异步回调。</p>     <ul>      <li>       <p>需要先调用<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#getservices">getServices</a>，获取到server端所有支持的能力，且包含指定的入参描述符UUID；否则会写入失败。</p></li>      <li>       <p>异步回调结果返回后，才能调用下一次读取或者写入操作，如<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#readcharacteristicvalue">readCharacteristicValue</a>、<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#readdescriptorvalue">readDescriptorValue</a>、<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#writecharacteristicvalue">writeCharacteristicValue</a>、<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#writedescriptorvalue">writeDescriptorValue</a>、<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#setcharacteristicchangenotification">setCharacteristicChangeNotification</a>和<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#setcharacteristicchangeindication">setCharacteristicChangeIndication</a>。</p></li>      <li>       <p>应用单次可写入的描述符数据长度默认限制为（MTU-3）字节，MTU大小可由<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#setblemtusize">setBLEMtuSize</a>接口指定。</p></li>      <li>Client Characteristic Configuration描述符（UUID：00002902-0000-1000-8000-00805f9b34fb）和 Server Characteristic Configuration描述符（UUID：00002903-0000-1000-8000-00805f9b34fb）较为特殊，蓝牙标准协议规定内容长度为2字节，写入内容长度应设置为2字节。</li>     </ul>     <p><strong>需要权限</strong>：ohos.permission.ACCESS_BLUETOOTH</p>     <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.59.9.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.59.9.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.59.9.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.59.9.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">descriptor</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#bledescriptor">BLEDescriptor</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">需要写入的描述符，包含写入的数据内容。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.59.11.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.59.11.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">Promise对象。无返回结果的Promise对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码说明文档</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-bluetoothmanager">蓝牙服务子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.59.14.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.59.14.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Invalid parameter. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types. 3. Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900001</td>         <td class="cellrowborder" width="50%">Service stopped.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900011</td>         <td class="cellrowborder" width="50%">The operation is busy. The last operation is not complete.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900099</td>         <td class="cellrowborder" width="50%">Operation failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2901001</td>         <td class="cellrowborder" width="50%">Write forbidden.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2901003</td>         <td class="cellrowborder" width="50%">The connection is not established.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2901004</td>         <td class="cellrowborder" width="50%">The connection is congested.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2901005</td>         <td class="cellrowborder" width="50%">The connection is not encrypted.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2901006</td>         <td class="cellrowborder" width="50%">The connection is not authenticated.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2901007</td>         <td class="cellrowborder" width="50%">The connection is not authorized.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wue-c106="" class="highlight-div"><div _ngcontent-wue-c106="" class="highlight-div-header"><div _ngcontent-wue-c106="" class="highlight-div-header-left"><div _ngcontent-wue-c106="" class="handle-button expand-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wue-c106="" class="highlight-div-header-right"><div _ngcontent-wue-c106="" class="handle-button ai-button"></div><div _ngcontent-wue-c106="" class="handle-button line-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wue-c106="" class="handle-button theme-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wue-c106="" class="handle-button copy-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wue-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AsyncCallback</span>, <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">let</span> bufferDesc = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayBuffer</span>(<span class="hljs-number">2</span>);</li><li><span class="hljs-keyword">let</span> descV = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(bufferDesc);</li><li>descV[<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>; <span class="hljs-comment">// 以Client Characteristic Configuration描述符为例，表示bit0、bit1均为0，notification和indication均不开启</span></li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">descriptor</span>: ble.<span class="hljs-property">BLEDescriptor</span> = {</li><li>    <span class="hljs-attr">serviceUuid</span>: <span class="hljs-string">'00001810-0000-1000-8000-00805F9B34FB'</span>,</li><li>    <span class="hljs-attr">characteristicUuid</span>: <span class="hljs-string">'00001820-0000-1000-8000-00805F9B34FB'</span>,</li><li>    <span class="hljs-attr">descriptorUuid</span>: <span class="hljs-string">'00002902-0000-1000-8000-00805F9B34FB'</span>,</li><li>    <span class="hljs-attr">descriptorValue</span>: bufferDesc</li><li>};</li><li><span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">device</span>: ble.<span class="hljs-property">GattClientDevice</span> = ble.<span class="hljs-title function_">createGattClientDevice</span>(<span class="hljs-string">'XX:XX:XX:XX:XX:XX'</span>);</li><li>    device.<span class="hljs-title function_">writeDescriptorValue</span>(descriptor).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'writeDescriptorValue promise success'</span>);</li><li>    });</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1628px;">     <h3 id="getrssivalue" device-type="phone,2in1,tablet,wearable,tv">getRssiValue<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getrssivalue" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>getRssiValue(callback: AsyncCallback&lt;number&gt;): void</p>     <p>client端获取GATT连接链路信号强度 (Received Signal Strength Indication, RSSI)。使用Callback异步回调。</p>     <ul>      <li>需先调用<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#connect">connect</a>方法，等GATT profile连接成功后才能使用。</li>     </ul>     <p><strong>需要权限</strong>：ohos.permission.ACCESS_BLUETOOTH</p>     <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.60.9.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.60.9.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.60.9.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.60.9.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;number&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。获取链路信号强度成功，err为undefined，data为获取到的信号强度值，单位：dBm；否则为错误对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码说明文档</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-bluetoothmanager">蓝牙服务子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.60.12.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.60.12.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Invalid parameter. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types. 3. Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900011</td>         <td class="cellrowborder" width="50%">The operation is busy. The last operation is not complete.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900099</td>         <td class="cellrowborder" width="50%">Operation failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2901003</td>         <td class="cellrowborder" width="50%">The connection is not established.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wue-c106="" class="highlight-div"><div _ngcontent-wue-c106="" class="highlight-div-header"><div _ngcontent-wue-c106="" class="highlight-div-header-left"><div _ngcontent-wue-c106="" class="handle-button expand-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wue-c106="" class="highlight-div-header-right"><div _ngcontent-wue-c106="" class="handle-button ai-button"></div><div _ngcontent-wue-c106="" class="handle-button line-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wue-c106="" class="handle-button theme-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wue-c106="" class="handle-button copy-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wue-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AsyncCallback</span>, <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-comment">// callback</span></li><li><span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">gattClient</span>: ble.<span class="hljs-property">GattClientDevice</span> = ble.<span class="hljs-title function_">createGattClientDevice</span>(<span class="hljs-string">"XX:XX:XX:XX:XX:XX"</span>);</li><li>    gattClient.<span class="hljs-title function_">connect</span>();</li><li>    <span class="hljs-keyword">let</span> rssi = gattClient.<span class="hljs-title function_">getRssiValue</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError, data: number</span>)=&gt;</span> {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'rssi err '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'rssi value'</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data));</li><li>    })</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1504px;">     <h3 id="getrssivalue-1" device-type="phone,2in1,tablet,wearable,tv">getRssiValue<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getrssivalue-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>getRssiValue(): Promise&lt;number&gt;</p>     <p>client端获取GATT连接链路信号强度 (Received Signal Strength Indication, RSSI)。使用Promise异步回调。</p>     <ul>      <li>需先调用<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#connect">connect</a>方法，等GATT profile连接成功后才能使用。</li>     </ul>     <p><strong>需要权限</strong>：ohos.permission.ACCESS_BLUETOOTH</p>     <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.61.9.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.61.9.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;number&gt;</td>         <td class="cellrowborder" width="50%">Promise对象。返回链路的信号强度，单位：dBm。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码说明文档</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-bluetoothmanager">蓝牙服务子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.61.12.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.61.12.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Invalid parameter. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900011</td>         <td class="cellrowborder" width="50%">The operation is busy. The last operation is not complete.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900099</td>         <td class="cellrowborder" width="50%">Operation failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2901003</td>         <td class="cellrowborder" width="50%">The connection is not established.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wue-c106="" class="highlight-div"><div _ngcontent-wue-c106="" class="highlight-div-header"><div _ngcontent-wue-c106="" class="highlight-div-header-left"><div _ngcontent-wue-c106="" class="handle-button expand-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wue-c106="" class="highlight-div-header-right"><div _ngcontent-wue-c106="" class="handle-button ai-button"></div><div _ngcontent-wue-c106="" class="handle-button line-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wue-c106="" class="handle-button theme-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wue-c106="" class="handle-button copy-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wue-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AsyncCallback</span>, <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-comment">// promise</span></li><li><span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">gattClient</span>: ble.<span class="hljs-property">GattClientDevice</span> = ble.<span class="hljs-title function_">createGattClientDevice</span>(<span class="hljs-string">"XX:XX:XX:XX:XX:XX"</span>);</li><li>    gattClient.<span class="hljs-title function_">getRssiValue</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">data: number</span>) =&gt;</span> {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'rssi'</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data));</li><li>    })</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1469px;">     <h3 id="setblemtusize" device-type="phone,2in1,tablet,wearable,tv">setBLEMtuSize<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="setblemtusize" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>setBLEMtuSize(mtu: number): void</p>     <p>client端同server端协商<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/terminology#mtu" target="_blank">MTU</a>（最大传输单元）大小。</p>     <ul>      <li>       <p>需先调用<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#connect">connect</a>方法，等GATT profile连接成功后才能使用。</p></li>      <li>       <p>通过<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#onblemtuchange-1">on('BLEMtuChange')</a>，订阅MTU协商结果。</p></li>      <li>如果未协商，MTU大小默认为23字节。</li>     </ul>     <p><strong>需要权限</strong>：ohos.permission.ACCESS_BLUETOOTH</p>     <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.62.9.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.62.9.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.62.9.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.62.9.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">mtu</td>         <td class="cellrowborder" width="25%">number</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">需要协商的mtu大小，取值范围：[23, 517]，单位：Byte。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码说明文档</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-bluetoothmanager">蓝牙服务子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.62.12.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.62.12.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Invalid parameter. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types. 3. Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900001</td>         <td class="cellrowborder" width="50%">Service stopped.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900099</td>         <td class="cellrowborder" width="50%">Operation failed.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wue-c106="" class="highlight-div"><div _ngcontent-wue-c106="" class="highlight-div-header"><div _ngcontent-wue-c106="" class="highlight-div-header-left"><div _ngcontent-wue-c106="" class="handle-button expand-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wue-c106="" class="highlight-div-header-right"><div _ngcontent-wue-c106="" class="handle-button ai-button"></div><div _ngcontent-wue-c106="" class="handle-button line-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wue-c106="" class="handle-button theme-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wue-c106="" class="handle-button copy-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wue-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AsyncCallback</span>, <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">device</span>: ble.<span class="hljs-property">GattClientDevice</span> = ble.<span class="hljs-title function_">createGattClientDevice</span>(<span class="hljs-string">'XX:XX:XX:XX:XX:XX'</span>);</li><li>    device.<span class="hljs-title function_">setBLEMtuSize</span>(<span class="hljs-number">128</span>);</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 2397px;">     <h3 id="setcharacteristicchangenotification" device-type="phone,2in1,tablet,wearable,tv">setCharacteristicChangeNotification<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="setcharacteristicchangenotification" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>setCharacteristicChangeNotification(characteristic: BLECharacteristic, enable: boolean, callback: AsyncCallback&lt;void&gt;): void</p>     <p>client端启用或者禁用接收server端特征值内容变更通知的能力。使用Callback异步回调。</p>     <ul>      <li>       <p>需要先调用<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#getservices">getServices</a>，获取到server端所有支持的能力，且需包含指定的入参特征值UUID。</p></li>      <li>       <p>server端对应的特征值需包含标准协议定义的Client Characteristic Configuration描述符UUID（00002902-0000-1000-8000-00805f9b34fb），server端才能支持发送变更通知。</p></li>      <li>       <p>若启用该能力，系统蓝牙服务会自动往server端写Client Characteristic Configuration描述符，启用server端的通知能力。</p></li>      <li>       <p>若禁用该能力，系统蓝牙服务会自动往server端写Client Characteristic Configuration描述符，禁用server端的通知能力。</p></li>      <li>       <p>通过<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#onblecharacteristicchange">on('BLECharacteristicChange')</a>接收server端特征值内容变更通知。</p></li>      <li>若client端收到server端特征值内容变更通知后，无需回复确认。</li>      <li>异步回调结果返回后，才能调用下一次读取或者写入操作，如<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#readcharacteristicvalue">readCharacteristicValue</a>、<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#readdescriptorvalue">readDescriptorValue</a>、<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#writecharacteristicvalue">writeCharacteristicValue</a>、<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#writedescriptorvalue">writeDescriptorValue</a>、<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#setcharacteristicchangenotification">setCharacteristicChangeNotification</a>和<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#setcharacteristicchangeindication">setCharacteristicChangeIndication</a>。</li>     </ul>     <p><strong>需要权限</strong>：ohos.permission.ACCESS_BLUETOOTH</p>     <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.63.9.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.63.9.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.63.9.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.63.9.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">characteristic</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#blecharacteristic">BLECharacteristic</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">需要管理的server端特征值。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">enable</td>         <td class="cellrowborder" width="25%">boolean</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">          <p>是否启用接收server端特征值通知的能力。</p>          <p>true表示启用，false表示禁用。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;void&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。当调用成功，err为undefined，否则为错误对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码说明文档</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-bluetoothmanager">蓝牙服务子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.63.12.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.63.12.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Invalid parameter. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types. 3. Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900001</td>         <td class="cellrowborder" width="50%">Service stopped.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900011</td>         <td class="cellrowborder" width="50%">The operation is busy. The last operation is not complete.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900099</td>         <td class="cellrowborder" width="50%">Operation failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2901003</td>         <td class="cellrowborder" width="50%">The connection is not established.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wue-c106="" class="highlight-div"><div _ngcontent-wue-c106="" class="highlight-div-header"><div _ngcontent-wue-c106="" class="highlight-div-header-left"><div _ngcontent-wue-c106="" class="handle-button expand-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wue-c106="" class="highlight-div-header-right"><div _ngcontent-wue-c106="" class="handle-button ai-button"></div><div _ngcontent-wue-c106="" class="handle-button line-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wue-c106="" class="handle-button theme-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wue-c106="" class="handle-button copy-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wue-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AsyncCallback</span>, <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-comment">// 创建descriptors。</span></li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">descriptors</span>: <span class="hljs-title class_">Array</span>&lt;ble.<span class="hljs-property">BLEDescriptor</span>&gt; = [];</li><li><span class="hljs-keyword">let</span> arrayBuffer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayBuffer</span>(<span class="hljs-number">2</span>);</li><li><span class="hljs-keyword">let</span> descV = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(arrayBuffer);</li><li>descV[<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>; <span class="hljs-comment">// 以Client Characteristic Configuration描述符为例，表示bit0、bit1均为0，notification和indication均不开启</span></li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">descriptor</span>: ble.<span class="hljs-property">BLEDescriptor</span> = {<span class="hljs-attr">serviceUuid</span>: <span class="hljs-string">'00001810-0000-1000-8000-00805F9B34FB'</span>,</li><li>  <span class="hljs-attr">characteristicUuid</span>: <span class="hljs-string">'00001820-0000-1000-8000-00805F9B34FB'</span>,</li><li>  <span class="hljs-attr">descriptorUuid</span>: <span class="hljs-string">'00002902-0000-1000-8000-00805F9B34FB'</span>, <span class="hljs-attr">descriptorValue</span>: arrayBuffer};</li><li>descriptors[<span class="hljs-number">0</span>] = descriptor;</li><li><span class="hljs-keyword">let</span> arrayBufferC = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayBuffer</span>(<span class="hljs-number">8</span>);</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">characteristic</span>: ble.<span class="hljs-property">BLECharacteristic</span> = {<span class="hljs-attr">serviceUuid</span>: <span class="hljs-string">'00001810-0000-1000-8000-00805F9B34FB'</span>,</li><li>  <span class="hljs-attr">characteristicUuid</span>: <span class="hljs-string">'00001820-0000-1000-8000-00805F9B34FB'</span>, <span class="hljs-attr">characteristicValue</span>: arrayBufferC, <span class="hljs-attr">descriptors</span>:descriptors};</li><li><span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">device</span>: ble.<span class="hljs-property">GattClientDevice</span> = ble.<span class="hljs-title function_">createGattClientDevice</span>(<span class="hljs-string">'XX:XX:XX:XX:XX:XX'</span>);</li><li>    device.<span class="hljs-title function_">setCharacteristicChangeNotification</span>(characteristic, <span class="hljs-literal">false</span>, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>        <span class="hljs-keyword">if</span> (err) {</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'notifyCharacteristicChanged callback failed'</span>);</li><li>        } <span class="hljs-keyword">else</span> {</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'notifyCharacteristicChanged callback successful'</span>);</li><li>        }</li><li>    });</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 2331px;">     <h3 id="setcharacteristicchangenotification-1" device-type="phone,2in1,tablet,wearable,tv">setCharacteristicChangeNotification<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="setcharacteristicchangenotification-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>setCharacteristicChangeNotification(characteristic: BLECharacteristic, enable: boolean): Promise&lt;void&gt;</p>     <p>client端启用或者禁用接收server端特征值内容变更通知的能力。使用Promise异步回调。</p>     <ul>      <li>       <p>需要先调用<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#getservices">getServices</a>，获取到server端所有支持的能力，且需包含指定的入参特征值UUID。</p></li>      <li>       <p>server端对应的特征值需包含标准协议定义的Client Characteristic Configuration描述符UUID（00002902-0000-1000-8000-00805f9b34fb），server端才能支持发送变更通知。</p></li>      <li>       <p>若启用该能力，系统蓝牙服务会自动往server端写Client Characteristic Configuration描述符，启用server端的通知能力。</p></li>      <li>       <p>若禁用该能力，系统蓝牙服务会自动往server端写Client Characteristic Configuration描述符，禁用server端的通知能力。</p></li>      <li>       <p>通过<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#onblecharacteristicchange">on('BLECharacteristicChange')</a>接收server端特征值内容变更通知。</p></li>      <li>若client端收到server端特征值内容变更通知后，无需回复确认。</li>      <li>异步回调结果返回后，才能调用下一次读取或者写入操作，如<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#readcharacteristicvalue">readCharacteristicValue</a>、<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#readdescriptorvalue">readDescriptorValue</a>、<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#writecharacteristicvalue">writeCharacteristicValue</a>、<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#writedescriptorvalue">writeDescriptorValue</a>、<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#setcharacteristicchangenotification">setCharacteristicChangeNotification</a>和<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#setcharacteristicchangeindication">setCharacteristicChangeIndication</a>。</li>     </ul>     <p><strong>需要权限</strong>：ohos.permission.ACCESS_BLUETOOTH</p>     <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.64.9.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.64.9.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.64.9.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.64.9.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">characteristic</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#blecharacteristic">BLECharacteristic</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">需要管理的server端特征值。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">enable</td>         <td class="cellrowborder" width="25%">boolean</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">          <p>是否启用接收server端特征值通知的能力。</p>          <p>true表示启用，false表示禁用。</p></td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.64.11.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.64.11.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">Promise对象。无返回结果的Promise对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码说明文档</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-bluetoothmanager">蓝牙服务子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.64.14.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.64.14.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Invalid parameter. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types. 3. Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900001</td>         <td class="cellrowborder" width="50%">Service stopped.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900011</td>         <td class="cellrowborder" width="50%">The operation is busy. The last operation is not complete.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900099</td>         <td class="cellrowborder" width="50%">Operation failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2901003</td>         <td class="cellrowborder" width="50%">The connection is not established.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wue-c106="" class="highlight-div"><div _ngcontent-wue-c106="" class="highlight-div-header"><div _ngcontent-wue-c106="" class="highlight-div-header-left"><div _ngcontent-wue-c106="" class="handle-button expand-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wue-c106="" class="highlight-div-header-right"><div _ngcontent-wue-c106="" class="handle-button ai-button"></div><div _ngcontent-wue-c106="" class="handle-button line-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wue-c106="" class="handle-button theme-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wue-c106="" class="handle-button copy-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wue-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AsyncCallback</span>, <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-comment">// 创建descriptors。</span></li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">descriptors</span>: <span class="hljs-title class_">Array</span>&lt;ble.<span class="hljs-property">BLEDescriptor</span>&gt; = [];</li><li><span class="hljs-keyword">let</span> arrayBuffer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayBuffer</span>(<span class="hljs-number">2</span>);</li><li><span class="hljs-keyword">let</span> descV = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(arrayBuffer);</li><li>descV[<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>; <span class="hljs-comment">// 以Client Characteristic Configuration描述符为例，表示bit0、bit1均为0，notification和indication均不开启</span></li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">descriptor</span>: ble.<span class="hljs-property">BLEDescriptor</span> = {<span class="hljs-attr">serviceUuid</span>: <span class="hljs-string">'00001810-0000-1000-8000-00805F9B34FB'</span>,</li><li>  <span class="hljs-attr">characteristicUuid</span>: <span class="hljs-string">'00001820-0000-1000-8000-00805F9B34FB'</span>,</li><li>  <span class="hljs-attr">descriptorUuid</span>: <span class="hljs-string">'00002902-0000-1000-8000-00805F9B34FB'</span>, <span class="hljs-attr">descriptorValue</span>: arrayBuffer};</li><li>descriptors[<span class="hljs-number">0</span>] = descriptor;</li><li><span class="hljs-keyword">let</span> arrayBufferC = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayBuffer</span>(<span class="hljs-number">8</span>);</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">characteristic</span>: ble.<span class="hljs-property">BLECharacteristic</span> = {<span class="hljs-attr">serviceUuid</span>: <span class="hljs-string">'00001810-0000-1000-8000-00805F9B34FB'</span>,</li><li>  <span class="hljs-attr">characteristicUuid</span>: <span class="hljs-string">'00001820-0000-1000-8000-00805F9B34FB'</span>, <span class="hljs-attr">characteristicValue</span>: arrayBufferC, <span class="hljs-attr">descriptors</span>:descriptors};</li><li><span class="hljs-keyword">try</span> {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">device</span>: ble.<span class="hljs-property">GattClientDevice</span> = ble.<span class="hljs-title function_">createGattClientDevice</span>(<span class="hljs-string">'XX:XX:XX:XX:XX:XX'</span>);</li><li>  device.<span class="hljs-title function_">setCharacteristicChangeNotification</span>(characteristic, <span class="hljs-literal">false</span>);</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 2397px;">     <h3 id="setcharacteristicchangeindication" device-type="phone,2in1,tablet,wearable,tv">setCharacteristicChangeIndication<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="setcharacteristicchangeindication" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>setCharacteristicChangeIndication(characteristic: BLECharacteristic, enable: boolean, callback: AsyncCallback&lt;void&gt;): void</p>     <p>client端启用或者禁用接收server端特征值内容变更指示的能力。使用Callback异步回调。</p>     <ul>      <li>       <p>需要先调用<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#getservices">getServices</a>，获取到server端所有支持的能力，且需包含指定的入参特征值UUID。</p></li>      <li>       <p>server端对应的特征值需包含标准协议定义的Client Characteristic Configuration描述符UUID（00002902-0000-1000-8000-00805f9b34fb），server端才能支持发送变更指示。</p></li>      <li>       <p>若启用该能力，系统蓝牙服务会自动往server端写Client Characteristic Configuration描述符，启用server端的指示能力。</p></li>      <li>       <p>若禁用该能力，系统蓝牙服务会自动往server端写Client Characteristic Configuration描述符，禁用server端的指示能力。</p></li>      <li>       <p>通过<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#onblecharacteristicchange">on('BLECharacteristicChange')</a>接收server端特征值内容变更指示。</p></li>      <li>若client端收到server端特征值内容变更指示后，系统蓝牙服务会主动回复确认，应用无需关注。</li>      <li>异步回调结果返回后，才能调用下一次读取或者写入操作，如<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#readcharacteristicvalue">readCharacteristicValue</a>、<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#readdescriptorvalue">readDescriptorValue</a>、<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#writecharacteristicvalue">writeCharacteristicValue</a>、<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#writedescriptorvalue">writeDescriptorValue</a>、<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#setcharacteristicchangenotification">setCharacteristicChangeNotification</a>和<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#setcharacteristicchangeindication">setCharacteristicChangeIndication</a>。</li>     </ul>     <p><strong>需要权限</strong>：ohos.permission.ACCESS_BLUETOOTH</p>     <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.65.9.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.65.9.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.65.9.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.65.9.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">characteristic</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#blecharacteristic">BLECharacteristic</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">需要管理的server端特征值。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">enable</td>         <td class="cellrowborder" width="25%">boolean</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">          <p>是否启用接收server端特征值指示的能力。</p>          <p>true表示启用，false表示禁用。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;void&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。当调用成功，err为undefined，否则为错误对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码说明文档</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-bluetoothmanager">蓝牙服务子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.65.12.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.65.12.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Invalid parameter. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types. 3. Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900001</td>         <td class="cellrowborder" width="50%">Service stopped.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900011</td>         <td class="cellrowborder" width="50%">The operation is busy. The last operation is not complete.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900099</td>         <td class="cellrowborder" width="50%">Operation failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2901003</td>         <td class="cellrowborder" width="50%">The connection is not established.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wue-c106="" class="highlight-div"><div _ngcontent-wue-c106="" class="highlight-div-header"><div _ngcontent-wue-c106="" class="highlight-div-header-left"><div _ngcontent-wue-c106="" class="handle-button expand-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wue-c106="" class="highlight-div-header-right"><div _ngcontent-wue-c106="" class="handle-button ai-button"></div><div _ngcontent-wue-c106="" class="handle-button line-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wue-c106="" class="handle-button theme-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wue-c106="" class="handle-button copy-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wue-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AsyncCallback</span>, <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-comment">// 创建descriptors。</span></li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">descriptors</span>: <span class="hljs-title class_">Array</span>&lt;ble.<span class="hljs-property">BLEDescriptor</span>&gt; = [];</li><li><span class="hljs-keyword">let</span> arrayBuffer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayBuffer</span>(<span class="hljs-number">2</span>);</li><li><span class="hljs-keyword">let</span> descV = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(arrayBuffer);</li><li>descV[<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>; <span class="hljs-comment">// 以Client Characteristic Configuration描述符为例，表示bit0、bit1均为0，notification和indication均不开启</span></li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">descriptor</span>: ble.<span class="hljs-property">BLEDescriptor</span> = {<span class="hljs-attr">serviceUuid</span>: <span class="hljs-string">'00001810-0000-1000-8000-00805F9B34FB'</span>,</li><li>  <span class="hljs-attr">characteristicUuid</span>: <span class="hljs-string">'00001820-0000-1000-8000-00805F9B34FB'</span>,</li><li>  <span class="hljs-attr">descriptorUuid</span>: <span class="hljs-string">'00002902-0000-1000-8000-00805F9B34FB'</span>, <span class="hljs-attr">descriptorValue</span>: arrayBuffer};</li><li>descriptors[<span class="hljs-number">0</span>] = descriptor;</li><li><span class="hljs-keyword">let</span> arrayBufferC = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayBuffer</span>(<span class="hljs-number">8</span>);</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">characteristic</span>: ble.<span class="hljs-property">BLECharacteristic</span> = {<span class="hljs-attr">serviceUuid</span>: <span class="hljs-string">'00001810-0000-1000-8000-00805F9B34FB'</span>,</li><li>  <span class="hljs-attr">characteristicUuid</span>: <span class="hljs-string">'00001820-0000-1000-8000-00805F9B34FB'</span>, <span class="hljs-attr">characteristicValue</span>: arrayBufferC, <span class="hljs-attr">descriptors</span>:descriptors};</li><li><span class="hljs-keyword">try</span> {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">device</span>: ble.<span class="hljs-property">GattClientDevice</span> = ble.<span class="hljs-title function_">createGattClientDevice</span>(<span class="hljs-string">'XX:XX:XX:XX:XX:XX'</span>);</li><li>  device.<span class="hljs-title function_">setCharacteristicChangeIndication</span>(characteristic, <span class="hljs-literal">false</span>, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>    <span class="hljs-keyword">if</span> (err) {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'notifyCharacteristicChanged callback failed'</span>);</li><li>    } <span class="hljs-keyword">else</span> {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'notifyCharacteristicChanged callback successful'</span>);</li><li>    }</li><li>  });</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 2331px;">     <h3 id="setcharacteristicchangeindication-1" device-type="phone,2in1,tablet,wearable,tv">setCharacteristicChangeIndication<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="setcharacteristicchangeindication-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>setCharacteristicChangeIndication(characteristic: BLECharacteristic, enable: boolean): Promise&lt;void&gt;</p>     <p>client端启用或者禁用接收server端特征值内容变更指示的能力。使用Promise异步回调。</p>     <ul>      <li>       <p>需要先调用<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#getservices">getServices</a>，获取到server端所有支持的能力，且需包含指定的入参特征值UUID。</p></li>      <li>       <p>server端对应的特征值需包含标准协议定义的Client Characteristic Configuration描述符UUID（00002902-0000-1000-8000-00805f9b34fb），server端才能支持发送变更指示。</p></li>      <li>       <p>若启用该能力，系统蓝牙服务会自动往server端写Client Characteristic Configuration描述符，启用server端的指示能力。</p></li>      <li>       <p>若禁用该能力，系统蓝牙服务会自动往server端写Client Characteristic Configuration描述符，禁用server端的指示能力。</p></li>      <li>       <p>通过<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#onblecharacteristicchange">on('BLECharacteristicChange')</a>接收server端特征值内容变更指示。</p></li>      <li>若client端收到server端特征值内容变更指示后，系统蓝牙服务会主动回复确认，应用无需关注。</li>      <li>异步回调结果返回后，才能调用下一次读取或者写入操作，如<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#readcharacteristicvalue">readCharacteristicValue</a>、<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#readdescriptorvalue">readDescriptorValue</a>、<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#writecharacteristicvalue">writeCharacteristicValue</a>、<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#writedescriptorvalue">writeDescriptorValue</a>、<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#setcharacteristicchangenotification">setCharacteristicChangeNotification</a>和<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#setcharacteristicchangeindication">setCharacteristicChangeIndication</a>。</li>     </ul>     <p><strong>需要权限</strong>：ohos.permission.ACCESS_BLUETOOTH</p>     <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.66.9.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.66.9.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.66.9.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.66.9.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">characteristic</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#blecharacteristic">BLECharacteristic</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">需要管理的server端特征值。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">enable</td>         <td class="cellrowborder" width="25%">boolean</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">          <p>是否启用接收server端特征值指示的能力。</p>          <p>true表示启用，false表示禁用。</p></td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.66.11.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.66.11.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">Promise对象。无返回结果的Promise对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码说明文档</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-bluetoothmanager">蓝牙服务子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.66.14.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.66.14.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Invalid parameter. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types. 3. Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900001</td>         <td class="cellrowborder" width="50%">Service stopped.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900011</td>         <td class="cellrowborder" width="50%">The operation is busy. The last operation is not complete.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900099</td>         <td class="cellrowborder" width="50%">Operation failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2901003</td>         <td class="cellrowborder" width="50%">The connection is not established.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wue-c106="" class="highlight-div"><div _ngcontent-wue-c106="" class="highlight-div-header"><div _ngcontent-wue-c106="" class="highlight-div-header-left"><div _ngcontent-wue-c106="" class="handle-button expand-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wue-c106="" class="highlight-div-header-right"><div _ngcontent-wue-c106="" class="handle-button ai-button"></div><div _ngcontent-wue-c106="" class="handle-button line-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wue-c106="" class="handle-button theme-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wue-c106="" class="handle-button copy-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wue-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AsyncCallback</span>, <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-comment">// 创建descriptors。</span></li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">descriptors</span>: <span class="hljs-title class_">Array</span>&lt;ble.<span class="hljs-property">BLEDescriptor</span>&gt; = [];</li><li><span class="hljs-keyword">let</span> arrayBuffer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayBuffer</span>(<span class="hljs-number">2</span>);</li><li><span class="hljs-keyword">let</span> descV = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(arrayBuffer);</li><li>descV[<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>; <span class="hljs-comment">// 以Client Characteristic Configuration描述符为例，表示bit0、bit1均为0，notification和indication均不开启</span></li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">descriptor</span>: ble.<span class="hljs-property">BLEDescriptor</span> = {<span class="hljs-attr">serviceUuid</span>: <span class="hljs-string">'00001810-0000-1000-8000-00805F9B34FB'</span>,</li><li>  <span class="hljs-attr">characteristicUuid</span>: <span class="hljs-string">'00001820-0000-1000-8000-00805F9B34FB'</span>,</li><li>  <span class="hljs-attr">descriptorUuid</span>: <span class="hljs-string">'00002902-0000-1000-8000-00805F9B34FB'</span>, <span class="hljs-attr">descriptorValue</span>: arrayBuffer};</li><li>descriptors[<span class="hljs-number">0</span>] = descriptor;</li><li><span class="hljs-keyword">let</span> arrayBufferC = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayBuffer</span>(<span class="hljs-number">8</span>);</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">characteristic</span>: ble.<span class="hljs-property">BLECharacteristic</span> = {<span class="hljs-attr">serviceUuid</span>: <span class="hljs-string">'00001810-0000-1000-8000-00805F9B34FB'</span>,</li><li>  <span class="hljs-attr">characteristicUuid</span>: <span class="hljs-string">'00001820-0000-1000-8000-00805F9B34FB'</span>, <span class="hljs-attr">characteristicValue</span>: arrayBufferC, <span class="hljs-attr">descriptors</span>:descriptors};</li><li><span class="hljs-keyword">try</span> {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">device</span>: ble.<span class="hljs-property">GattClientDevice</span> = ble.<span class="hljs-title function_">createGattClientDevice</span>(<span class="hljs-string">'XX:XX:XX:XX:XX:XX'</span>);</li><li>  device.<span class="hljs-title function_">setCharacteristicChangeIndication</span>(characteristic, <span class="hljs-literal">false</span>);</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1628px;">     <h3 id="onblecharacteristicchange" device-type="phone,2in1,tablet,wearable,tv">on('BLECharacteristicChange')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onblecharacteristicchange" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>on(type: 'BLECharacteristicChange', callback: Callback&lt;BLECharacteristic&gt;): void</p>     <p>client端订阅server端特征值变化事件。使用Callback异步回调。</p>     <ul>      <li>需调用<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#setcharacteristicchangenotification">setCharacteristicChangeNotification</a>或者<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#setcharacteristicchangeindication">setCharacteristicChangeIndication</a>，且启用通知或者指示能力后，才能接收到server端的特征值内容变更通知或者指示。</li>     </ul>     <p><strong>需要权限</strong>：ohos.permission.ACCESS_BLUETOOTH</p>     <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.67.9.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.67.9.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.67.9.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.67.9.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">          <p>事件回调类型，支持的事件为'BLECharacteristicChange'，表示server端特征值变化事件。</p>          <p>当client端收到server端特征值内容变更的通知或者指示时，触发该事件。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#blecharacteristic">BLECharacteristic</a>&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">指定订阅的回调函数，会携带server端变化后的特征值内容。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码说明文档</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.67.12.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.67.12.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Invalid parameter. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types. 3. Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wue-c106="" class="highlight-div"><div _ngcontent-wue-c106="" class="highlight-div-header"><div _ngcontent-wue-c106="" class="highlight-div-header-left"><div _ngcontent-wue-c106="" class="handle-button expand-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wue-c106="" class="highlight-div-header-right"><div _ngcontent-wue-c106="" class="handle-button ai-button"></div><div _ngcontent-wue-c106="" class="handle-button line-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wue-c106="" class="handle-button theme-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wue-c106="" class="handle-button copy-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wue-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AsyncCallback</span>, <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">CharacteristicChange</span>(<span class="hljs-params">characteristicChangeReq: ble.BLECharacteristic</span>) {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">serviceUuid</span>: string = characteristicChangeReq.<span class="hljs-property">serviceUuid</span>;</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">characteristicUuid</span>: string = characteristicChangeReq.<span class="hljs-property">characteristicUuid</span>;</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">value</span>: <span class="hljs-title class_">Uint8Array</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(characteristicChangeReq.<span class="hljs-property">characteristicValue</span>);</li><li>}</li><li><span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">device</span>: ble.<span class="hljs-property">GattClientDevice</span> = ble.<span class="hljs-title function_">createGattClientDevice</span>(<span class="hljs-string">'XX:XX:XX:XX:XX:XX'</span>);</li><li>    device.<span class="hljs-title function_">on</span>(<span class="hljs-string">'BLECharacteristicChange'</span>, <span class="hljs-title class_">CharacteristicChange</span>);</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1460px;">     <h3 id="offblecharacteristicchange" device-type="phone,2in1,tablet,wearable,tv">off('BLECharacteristicChange')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="offblecharacteristicchange" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>off(type: 'BLECharacteristicChange', callback?: Callback&lt;BLECharacteristic&gt;): void</p>     <p>client端取消订阅server端特征值变化事件。</p>     <p><strong>需要权限</strong>：ohos.permission.ACCESS_BLUETOOTH</p>     <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.68.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.68.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.68.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.68.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">事件回调类型，支持的事件为'BLECharacteristicChange'，表示server端特征值变化事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#blecharacteristic">BLECharacteristic</a>&gt;</td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">          <p>指定取消订阅的回调函数通知。</p>          <p>若传参，则需与<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#onblecharacteristicchange">on('BLECharacteristicChange')</a>中的回调函数一致；若无传参，则取消订阅该type对应的所有回调函数通知。</p></td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码说明文档</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.68.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.68.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Invalid parameter. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types. 3. Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wue-c106="" class="highlight-div"><div _ngcontent-wue-c106="" class="highlight-div-header"><div _ngcontent-wue-c106="" class="highlight-div-header-left"><div _ngcontent-wue-c106="" class="handle-button expand-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wue-c106="" class="highlight-div-header-right"><div _ngcontent-wue-c106="" class="handle-button ai-button"></div><div _ngcontent-wue-c106="" class="handle-button line-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wue-c106="" class="handle-button theme-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wue-c106="" class="handle-button copy-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wue-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AsyncCallback</span>, <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">device</span>: ble.<span class="hljs-property">GattClientDevice</span> = ble.<span class="hljs-title function_">createGattClientDevice</span>(<span class="hljs-string">'XX:XX:XX:XX:XX:XX'</span>);</li><li>    device.<span class="hljs-title function_">off</span>(<span class="hljs-string">'BLECharacteristicChange'</span>);</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1580px;">     <h3 id="onbleconnectionstatechange" device-type="phone,2in1,tablet,wearable,tv">on('BLEConnectionStateChange')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onbleconnectionstatechange" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>on(type: 'BLEConnectionStateChange', callback: Callback&lt;BLEConnectionChangeState&gt;): void</p>     <p>client端订阅GATT profile协议的连接状态变化事件。使用Callback异步回调。</p>     <p><strong>需要权限</strong>：ohos.permission.ACCESS_BLUETOOTH</p>     <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.69.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.69.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.69.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.69.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">          <p>事件回调类型，支持的事件为'BLEConnectionStateChange'，表示连接状态变化事件。</p>          <p>client和server端之间的连接状态发生变化时，触发该事件。</p>          <p>当client端调用<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#connect">connect</a>或<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#disconnect">disconnect</a>时，可能引起连接状态生变化。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#bleconnectionchangestate">BLEConnectionChangeState</a>&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">指定订阅的回调函数，会携带连接状态信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码说明文档</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.69.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.69.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Invalid parameter. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types. 3. Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wue-c106="" class="highlight-div"><div _ngcontent-wue-c106="" class="highlight-div-header"><div _ngcontent-wue-c106="" class="highlight-div-header-left"><div _ngcontent-wue-c106="" class="handle-button expand-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wue-c106="" class="highlight-div-header-right"><div _ngcontent-wue-c106="" class="handle-button ai-button"></div><div _ngcontent-wue-c106="" class="handle-button line-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wue-c106="" class="handle-button theme-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wue-c106="" class="handle-button copy-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wue-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AsyncCallback</span>, <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">ConnectStateChanged</span>(<span class="hljs-params">state: ble.BLEConnectionChangeState</span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'bluetooth connect state changed'</span>);</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">connectState</span>: ble.<span class="hljs-property">ProfileConnectionState</span> = state.<span class="hljs-property">state</span>;</li><li>}</li><li><span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">device</span>: ble.<span class="hljs-property">GattClientDevice</span> = ble.<span class="hljs-title function_">createGattClientDevice</span>(<span class="hljs-string">'XX:XX:XX:XX:XX:XX'</span>);</li><li>    device.<span class="hljs-title function_">on</span>(<span class="hljs-string">'BLEConnectionStateChange'</span>, <span class="hljs-title class_">ConnectStateChanged</span>);</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1484px;">     <h3 id="offbleconnectionstatechange" device-type="phone,2in1,tablet,wearable,tv">off('BLEConnectionStateChange')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="offbleconnectionstatechange" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>off(type: 'BLEConnectionStateChange', callback?: Callback&lt;BLEConnectionChangeState&gt;): void</p>     <p>client端取消订阅GATT profile协议的连接状态变化事件。</p>     <p><strong>需要权限</strong>：ohos.permission.ACCESS_BLUETOOTH</p>     <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.70.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.70.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.70.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.70.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">事件回调类型，支持的事件为'BLEConnectionStateChange'，表示连接状态变化事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#bleconnectionchangestate">BLEConnectionChangeState</a>&gt;</td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">          <p>指定取消订阅的回调函数通知。</p>          <p>若传参，则需与<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#onbleconnectionstatechange">on('BLEConnectionStateChange')</a>中的回调函数一致；若无传参，则取消订阅该type对应的所有回调函数通知。</p></td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码说明文档</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.70.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.70.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Invalid parameter. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types. 3. Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wue-c106="" class="highlight-div"><div _ngcontent-wue-c106="" class="highlight-div-header"><div _ngcontent-wue-c106="" class="highlight-div-header-left"><div _ngcontent-wue-c106="" class="handle-button expand-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wue-c106="" class="highlight-div-header-right"><div _ngcontent-wue-c106="" class="handle-button ai-button"></div><div _ngcontent-wue-c106="" class="handle-button line-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wue-c106="" class="handle-button theme-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wue-c106="" class="handle-button copy-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wue-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AsyncCallback</span>, <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">device</span>: ble.<span class="hljs-property">GattClientDevice</span> = ble.<span class="hljs-title function_">createGattClientDevice</span>(<span class="hljs-string">'XX:XX:XX:XX:XX:XX'</span>);</li><li>    device.<span class="hljs-title function_">off</span>(<span class="hljs-string">'BLEConnectionStateChange'</span>);</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1460px;">     <h3 id="onblemtuchange-1" device-type="phone,2in1,tablet,wearable,tv">on('BLEMtuChange')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onblemtuchange-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>on(type: 'BLEMtuChange', callback: Callback&lt;number&gt;): void</p>     <p>client端订阅MTU（最大传输单元）大小变更事件。使用Callback异步回调。</p>     <p><strong>需要权限</strong>：ohos.permission.ACCESS_BLUETOOTH</p>     <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.71.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.71.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.71.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.71.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">          <p>事件回调类型，支持的事件为'BLEMtuChange'，表示MTU大小变更事件。</p>          <p>当调用<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#setblemtusize">setBLEMtuSize</a>方法，client端发起MTU大小协商后，会触发该事件。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;number&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">指定订阅的回调函数，会携带协商后的MTU大小。单位：Byte。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码说明文档</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.71.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.71.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Invalid parameter. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types. 3. Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wue-c106="" class="highlight-div"><div _ngcontent-wue-c106="" class="highlight-div-header"><div _ngcontent-wue-c106="" class="highlight-div-header-left"><div _ngcontent-wue-c106="" class="handle-button expand-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wue-c106="" class="highlight-div-header-right"><div _ngcontent-wue-c106="" class="handle-button ai-button"></div><div _ngcontent-wue-c106="" class="handle-button line-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wue-c106="" class="handle-button theme-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wue-c106="" class="handle-button copy-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wue-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AsyncCallback</span>, <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">gattClient</span>: ble.<span class="hljs-property">GattClientDevice</span> = ble.<span class="hljs-title function_">createGattClientDevice</span>(<span class="hljs-string">'XX:XX:XX:XX:XX:XX'</span>);</li><li>    gattClient.<span class="hljs-title function_">on</span>(<span class="hljs-string">'BLEMtuChange'</span>, <span class="hljs-function">(<span class="hljs-params">mtu: number</span>) =&gt;</span> {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'BLEMtuChange, mtu: '</span> + mtu);</li><li>    });</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1412px;">     <h3 id="offblemtuchange-1" device-type="phone,2in1,tablet,wearable,tv">off('BLEMtuChange')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="offblemtuchange-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>off(type: 'BLEMtuChange', callback?: Callback&lt;number&gt;): void</p>     <p>client端取消订阅MTU（最大传输单元）大小变更事件。</p>     <p><strong>需要权限</strong>：ohos.permission.ACCESS_BLUETOOTH</p>     <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.72.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.72.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.72.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.72.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">事件回调类型，支持的事件为'BLEMtuChange'，表示MTU大小变更事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;number&gt;</td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">指定取消订阅的回调函数通知。若传参，则需与<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#onblemtuchange-1">on('BLEMtuChange')</a>中的回调函数一致；若无传参，则取消订阅该type对应的所有回调函数通知。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码说明文档</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.72.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.72.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Invalid parameter. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types. 3. Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wue-c106="" class="highlight-div"><div _ngcontent-wue-c106="" class="highlight-div-header"><div _ngcontent-wue-c106="" class="highlight-div-header-left"><div _ngcontent-wue-c106="" class="handle-button expand-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wue-c106="" class="highlight-div-header-right"><div _ngcontent-wue-c106="" class="handle-button ai-button"></div><div _ngcontent-wue-c106="" class="handle-button line-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wue-c106="" class="handle-button theme-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wue-c106="" class="handle-button copy-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wue-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AsyncCallback</span>, <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">device</span>: ble.<span class="hljs-property">GattClientDevice</span> = ble.<span class="hljs-title function_">createGattClientDevice</span>(<span class="hljs-string">'XX:XX:XX:XX:XX:XX'</span>);</li><li>    device.<span class="hljs-title function_">off</span>(<span class="hljs-string">'BLEMtuChange'</span>);</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 730px;">     <h2 id="blecreateblescanner15" device-type="phone,2in1,tablet,wearable,tv">ble.createBleScanner<sup>15+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="blecreateblescanner15" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>createBleScanner(): BleScanner</p>     <p>创建一个<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#blescanner15">BleScanner</a>实例对象，可用于发起或停止BLE扫描等流程。</p>     <p><strong>元服务API</strong>: 从API version 15开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.73.7.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.73.7.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#blescanner15">BleScanner</a></td>         <td class="cellrowborder" width="50%">返回一个BleScanner的实例。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wue-c106="" class="highlight-div"><div _ngcontent-wue-c106="" class="highlight-div-header"><div _ngcontent-wue-c106="" class="highlight-div-header-left"><div _ngcontent-wue-c106="" class="handle-button expand-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wue-c106="" class="highlight-div-header-right"><div _ngcontent-wue-c106="" class="handle-button ai-button"></div><div _ngcontent-wue-c106="" class="handle-button line-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wue-c106="" class="handle-button theme-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wue-c106="" class="handle-button copy-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wue-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AsyncCallback</span>, <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { ble } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ConnectivityKit'</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">bleScanner</span>: ble.<span class="hljs-property">BleScanner</span> = ble.<span class="hljs-title function_">createBleScanner</span>();</li><li><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'create bleScanner success'</span>);</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 262px;">     <h2 id="blescanner15" device-type="phone,2in1,tablet,wearable,tv">BleScanner<sup>15+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="blescanner15" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>BLE扫描类，提供了扫描相关的操作方法。</p>     <ul>      <li>       <p>使用该类的方法前，需通过<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#blecreateblescanner15">createBleScanner</a>方法构造该类的实例。</p></li>      <li>通过创建不同的该类实例，可以管理多路不同的扫描流程。</li>     </ul>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 2698px;">     <h3 id="startscan15" device-type="phone,2in1,tablet,wearable,tv" class="firsth2">startScan<sup>15+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="startscan15" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>startScan(filters: Array&lt;ScanFilter&gt;, options?: ScanOptions): Promise&lt;void&gt;</p>     <p>发起BLE扫描流程。使用Promise异步回调。</p>     <ul>      <li>       <p>该接口只能扫描BLE设备。</p></li>      <li>       <p>扫描结果会通过<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#onbledevicefind15">on('BLEDeviceFind')</a>的回调函数获取到。</p></li>      <li>调用<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#stopscan15">stopScan</a>可以停止该方法开启的扫描流程。</li>     </ul>     <p><strong>需要权限</strong>：ohos.permission.ACCESS_BLUETOOTH</p>     <p><strong>元服务API</strong>：从API version 15开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.75.9.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.75.9.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.75.9.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.75.9.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">filters</td>         <td class="cellrowborder" width="25%">Array&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#scanfilter">ScanFilter</a>&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">          <p>扫描BLE广播的过滤条件集合，符合过滤条件的设备会被上报。</p>          <p>- 若该参数设置为null，将扫描所有可发现的周边BLE设备，但是不建议使用此方式，可能扫描到非预期设备，并增加功耗。</p>          <p>- 围栏模式下（<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#scanreportmode15">ScanReportMode</a>设置为FENCE_SENSITIVITY_LOW或FENCE_SENSITIVITY_HIGH时），该参数不可设置为null，需传入非空过滤器。</p>          <p>- 过滤器资源为所有应用共享，建议单个应用使用过滤器数量不超过3个，否则过滤器资源占满将导致开启扫描失败，返回2900009错误码。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="25%">options</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#scanoptions">ScanOptions</a></td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">扫描的配置参数。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.75.11.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.75.11.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">Promise对象。无返回结果的Promise对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-bluetoothmanager">蓝牙服务子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.75.14.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.75.14.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Invalid parameter. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types. 3. Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900001</td>         <td class="cellrowborder" width="50%">Service stopped.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900003</td>         <td class="cellrowborder" width="50%">Bluetooth disabled.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900009</td>         <td class="cellrowborder" width="50%">Fails to start scan as it is out of hardware resources.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900099</td>         <td class="cellrowborder" width="50%">Operation failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2902050</td>         <td class="cellrowborder" width="50%">Failed to start scan as Ble scan is already started by the app.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wue-c106="" class="highlight-div"><div _ngcontent-wue-c106="" class="highlight-div-header"><div _ngcontent-wue-c106="" class="highlight-div-header-left"><div _ngcontent-wue-c106="" class="handle-button expand-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wue-c106="" class="highlight-div-header-right"><div _ngcontent-wue-c106="" class="handle-button ai-button"></div><div _ngcontent-wue-c106="" class="handle-button line-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wue-c106="" class="handle-button theme-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wue-c106="" class="handle-button copy-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wue-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AsyncCallback</span>, <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { ble } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ConnectivityKit'</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">bleScanner</span>: ble.<span class="hljs-property">BleScanner</span> = ble.<span class="hljs-title function_">createBleScanner</span>();</li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">onReceiveEvent</span>(<span class="hljs-params">scanReport: ble.ScanReport</span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'BLE scan device find result = '</span>+ <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(scanReport));</li><li>}</li><li><span class="hljs-keyword">try</span> {</li><li>    bleScanner.<span class="hljs-title function_">on</span>(<span class="hljs-string">"BLEDeviceFind"</span>, onReceiveEvent);</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">scanFilter</span>: ble.<span class="hljs-property">ScanFilter</span> = {</li><li>            <span class="hljs-attr">deviceId</span>:<span class="hljs-string">"XX:XX:XX:XX:XX:XX"</span>,</li><li>            <span class="hljs-attr">name</span>:<span class="hljs-string">"test"</span>,</li><li>            <span class="hljs-attr">serviceUuid</span>:<span class="hljs-string">"00001888-0000-1000-8000-00805f9b34fb"</span></li><li>        };</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">scanOptions</span>: ble.<span class="hljs-property">ScanOptions</span> = {</li><li>        <span class="hljs-attr">interval</span>: <span class="hljs-number">500</span>,</li><li>        <span class="hljs-attr">dutyMode</span>: ble.<span class="hljs-property">ScanDuty</span>.<span class="hljs-property">SCAN_MODE_LOW_POWER</span>,</li><li>        <span class="hljs-attr">matchMode</span>: ble.<span class="hljs-property">MatchMode</span>.<span class="hljs-property">MATCH_MODE_AGGRESSIVE</span>,</li><li>        <span class="hljs-attr">reportMode</span>: ble.<span class="hljs-property">ScanReportMode</span>.<span class="hljs-property">FENCE_SENSITIVITY_LOW</span></li><li>    }</li><li>    bleScanner.<span class="hljs-title function_">startScan</span>([scanFilter],scanOptions);</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'startScan success'</span>);</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1409px;">     <h3 id="stopscan15" device-type="phone,2in1,tablet,wearable,tv">stopScan<sup>15+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="stopscan15" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>stopScan(): Promise&lt;void&gt;</p>     <p>停止正在进行的BLE扫描。使用Promise异步回调。</p>     <ul>      <li>       <p>停止的扫描是由<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#startscan15">startScan</a>触发的。</p></li>      <li>当应用不再需要扫描BLE设备时，需主动调用该方法停止扫描。</li>     </ul>     <p><strong>需要权限</strong>：ohos.permission.ACCESS_BLUETOOTH</p>     <p><strong>元服务API</strong>：从API version 15开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.76.9.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.76.9.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">Promise对象。无返回结果的Promise对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-bluetoothmanager">蓝牙服务子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.76.12.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.76.12.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900001</td>         <td class="cellrowborder" width="50%">Service stopped.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900003</td>         <td class="cellrowborder" width="50%">Bluetooth disabled.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900099</td>         <td class="cellrowborder" width="50%">Operation failed.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wue-c106="" class="highlight-div"><div _ngcontent-wue-c106="" class="highlight-div-header"><div _ngcontent-wue-c106="" class="highlight-div-header-left"><div _ngcontent-wue-c106="" class="handle-button expand-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wue-c106="" class="highlight-div-header-right"><div _ngcontent-wue-c106="" class="handle-button ai-button"></div><div _ngcontent-wue-c106="" class="handle-button line-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wue-c106="" class="handle-button theme-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wue-c106="" class="handle-button copy-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wue-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AsyncCallback</span>, <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { ble } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ConnectivityKit'</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">bleScanner</span>: ble.<span class="hljs-property">BleScanner</span> = ble.<span class="hljs-title function_">createBleScanner</span>();</li><li><span class="hljs-keyword">try</span> {</li><li>    bleScanner.<span class="hljs-title function_">stopScan</span>();</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'stopScan success'</span>);</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1563px;">     <h3 id="onbledevicefind15" device-type="phone,2in1,tablet,wearable,tv">on('BLEDeviceFind')<sup>15+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onbledevicefind15" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>on(type: 'BLEDeviceFind', callback: Callback&lt;ScanReport&gt;): void</p>     <p>订阅BLE设备扫描结果上报事件。使用Callback异步回调。</p>     <p><strong>需要权限</strong>：ohos.permission.ACCESS_BLUETOOTH</p>     <p><strong>元服务API</strong>：从API version 15开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.77.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.77.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.77.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.77.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">          <p>事件回调类型，支持的事件为'BLEDeviceFind'，表示BLE设备扫描结果上报事件。</p>          <p>当调用<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#startscan15">startScan</a> 后，开始BLE扫描，若扫描到BLE设备，触发该事件。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#scanreport15">ScanReport</a>&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">指定订阅的回调函数，会携带扫描结果的集合。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-bluetoothmanager">蓝牙服务子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.77.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.77.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Invalid parameter. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types. 3. Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900099</td>         <td class="cellrowborder" width="50%">Operation failed.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wue-c106="" class="highlight-div"><div _ngcontent-wue-c106="" class="highlight-div-header"><div _ngcontent-wue-c106="" class="highlight-div-header-left"><div _ngcontent-wue-c106="" class="handle-button expand-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wue-c106="" class="highlight-div-header-right"><div _ngcontent-wue-c106="" class="handle-button ai-button"></div><div _ngcontent-wue-c106="" class="handle-button line-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wue-c106="" class="handle-button theme-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wue-c106="" class="handle-button copy-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wue-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AsyncCallback</span>, <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { ble } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ConnectivityKit'</span>;</li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">onReceiveEvent</span>(<span class="hljs-params">scanReport: ble.ScanReport</span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'bluetooth device find = '</span>+ <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(scanReport));</li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">bleScanner</span>: ble.<span class="hljs-property">BleScanner</span> = ble.<span class="hljs-title function_">createBleScanner</span>();</li><li><span class="hljs-keyword">try</span> {</li><li>    bleScanner.<span class="hljs-title function_">on</span>(<span class="hljs-string">'BLEDeviceFind'</span>, onReceiveEvent);</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1683px;">     <h3 id="offbledevicefind15" device-type="phone,2in1,tablet,wearable,tv">off('BLEDeviceFind')<sup>15+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="offbledevicefind15" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>off(type: 'BLEDeviceFind', callback?: Callback&lt;ScanReport&gt;): void</p>     <p>取消订阅BLE设备扫描结果上报事件。</p>     <ul>      <li>若不再需要扫描BLE设备，调用<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#stopscan15">stopScan</a>方法后，需要调用此方法取消订阅。</li>     </ul>     <p><strong>需要权限</strong>：ohos.permission.ACCESS_BLUETOOTH</p>     <p><strong>元服务API</strong>：从API version 15开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.78.9.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.78.9.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.78.9.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.78.9.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">事件回调类型，支持的事件为'BLEDeviceFind'，表示BLE设备扫描结果上报事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#scanreport15">ScanReport</a>&gt;</td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">          <p>指定取消订阅的回调函数通知。</p>          <p>若传参，则需与<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#onbledevicefind15">on('BLEDeviceFind')</a>中的回调函数一致；若无传参，则取消订阅该type对应的所有回调函数通知。</p></td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-bluetoothmanager">蓝牙服务子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.78.12.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.78.12.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Invalid parameter. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types. 3. Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2900099</td>         <td class="cellrowborder" width="50%">Operation failed.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wue-c106="" class="highlight-div"><div _ngcontent-wue-c106="" class="highlight-div-header"><div _ngcontent-wue-c106="" class="highlight-div-header-left"><div _ngcontent-wue-c106="" class="handle-button expand-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wue-c106="" class="highlight-div-header-right"><div _ngcontent-wue-c106="" class="handle-button ai-button"></div><div _ngcontent-wue-c106="" class="handle-button line-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wue-c106="" class="handle-button theme-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wue-c106="" class="handle-button copy-button"><div _ngcontent-wue-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wue-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AsyncCallback</span>, <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { ble } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ConnectivityKit'</span>;</li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">onReceiveEvent</span>(<span class="hljs-params">scanReport: ble.ScanReport</span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'bluetooth device find = '</span>+ <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(scanReport));</li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">bleScanner</span>: ble.<span class="hljs-property">BleScanner</span> = ble.<span class="hljs-title function_">createBleScanner</span>();</li><li><span class="hljs-keyword">try</span> {</li><li>    bleScanner.<span class="hljs-title function_">on</span>(<span class="hljs-string">'BLEDeviceFind'</span>, onReceiveEvent);</li><li>    bleScanner.<span class="hljs-title function_">off</span>(<span class="hljs-string">'BLEDeviceFind'</span>, onReceiveEvent);</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 708px;">     <h2 id="gattservice" device-type="phone,2in1,tablet,wearable,tv">GattService<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="gattservice" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>GATT服务结构定义，可包含多个特征值<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#blecharacteristic">BLECharacteristic</a>和依赖的其他服务。</p>     <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.79.5.1.6.1.1" width="20%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.79.5.1.6.1.2" width="20%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.79.5.1.6.1.3" width="20%">只读</th>         <th align="left" class="cellrowborder" id="mcps1.3.79.5.1.6.1.4" width="20%">可选</th>         <th align="left" class="cellrowborder" id="mcps1.3.79.5.1.6.1.5" width="20%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">serviceUuid</td>         <td class="cellrowborder" width="20%">string</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">服务UUID，标识一个GATT服务。例如：00001888-0000-1000-8000-00805f9b34fb。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">isPrimary</td>         <td class="cellrowborder" width="20%">boolean</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是否是主服务。true表示是主服务，false表示是次要服务。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">characteristics</td>         <td class="cellrowborder" width="20%">Array&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#blecharacteristic">BLECharacteristic</a>&gt;</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">当前服务包含的特征值列表。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">includeServices</td>         <td class="cellrowborder" width="20%">Array&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#gattservice">GattService</a>&gt;</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">当前服务依赖的其它服务。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1611px;">     <h2 id="blecharacteristic" device-type="phone,2in1,tablet,wearable,tv">BLECharacteristic<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="blecharacteristic" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>GATT特征值结构定义，是服务<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#gattservice">GattService</a>的核心数据单元。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.80.4.1.6.1.1" width="20%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.80.4.1.6.1.2" width="20%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.80.4.1.6.1.3" width="20%">只读</th>         <th align="left" class="cellrowborder" id="mcps1.3.80.4.1.6.1.4" width="20%">可选</th>         <th align="left" class="cellrowborder" id="mcps1.3.80.4.1.6.1.5" width="20%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">serviceUuid</td>         <td class="cellrowborder" width="20%">string</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">          <p>特征值所属的服务UUID。例如：00001888-0000-1000-8000-00805f9b34fb。</p>          <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">characteristicUuid</td>         <td class="cellrowborder" width="20%">string</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">          <p>特征值UUID。例如：00002a11-0000-1000-8000-00805f9b34fb。</p>          <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">characteristicValue</td>         <td class="cellrowborder" width="20%">ArrayBuffer</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">          <p>特征值的数据内容。</p>          <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">descriptors</td>         <td class="cellrowborder" width="20%">Array&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#bledescriptor">BLEDescriptor</a>&gt;</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">          <p>特征值包含的描述符列表。</p>          <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">properties</td>         <td class="cellrowborder" width="20%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#gattproperties">GattProperties</a></td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">          <p>特征值支持的属性。</p>          <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">characteristicValueHandle<sup>18+</sup></td>         <td class="cellrowborder" width="20%">number</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">          <p>特征值的唯一标识句柄。当server端BLE蓝牙设备提供了多个相同UUID特征值时，可以通过此句柄区分不同的特征值。</p>          <p><strong>元服务API</strong>：从API version 18开始，该接口支持在元服务中使用。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">permissions<sup>20+</sup></td>         <td class="cellrowborder" width="20%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#gattpermissions20">GattPermissions</a></td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">          <p>特征值读写操作需要的权限。</p>          <p><strong>元服务API</strong>：从API version 20开始，该接口支持在元服务中使用。</p></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1542px;">     <h2 id="bledescriptor" device-type="phone,2in1,tablet,wearable,tv">BLEDescriptor<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="bledescriptor" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>GATT描述符结构定义，是特征值<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#blecharacteristic">BLECharacteristic</a>的数据单元，用于描述特征值的附加信息和属性。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.81.4.1.6.1.1" width="20%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.81.4.1.6.1.2" width="20%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.81.4.1.6.1.3" width="20%">只读</th>         <th align="left" class="cellrowborder" id="mcps1.3.81.4.1.6.1.4" width="20%">可选</th>         <th align="left" class="cellrowborder" id="mcps1.3.81.4.1.6.1.5" width="20%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">serviceUuid</td>         <td class="cellrowborder" width="20%">string</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">          <p>特征值所属的服务UUID。例如：00001888-0000-1000-8000-00805f9b34fb。</p>          <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">characteristicUuid</td>         <td class="cellrowborder" width="20%">string</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">          <p>描述符所属的特征值UUID。例如：00002a11-0000-1000-8000-00805f9b34fb。</p>          <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">descriptorUuid</td>         <td class="cellrowborder" width="20%">string</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">          <p>描述符UUID。例如：00002902-0000-1000-8000-00805f9b34fb。</p>          <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">descriptorValue</td>         <td class="cellrowborder" width="20%">ArrayBuffer</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">          <p>描述符的数据内容。</p>          <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">descriptorHandle<sup>18+</sup></td>         <td class="cellrowborder" width="20%">number</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">          <p>描述符的唯一标识句柄。当server端BLE蓝牙设备提供了多个相同UUID描述符时，可以通过此句柄区分不同的描述符。</p>          <p><strong>元服务API</strong>：从API version 18开始，该接口支持在元服务中使用。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">permissions<sup>20+</sup></td>         <td class="cellrowborder" width="20%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#gattpermissions20">GattPermissions</a></td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">          <p>描述符读写操作需要的权限。</p>          <p><strong>元服务API</strong>：从API version 20开始，该接口支持在元服务中使用。</p></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 828px;">     <h2 id="notifycharacteristic" device-type="phone,2in1,tablet,wearable,tv">NotifyCharacteristic<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="notifycharacteristic" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>描述server端特征值发生变化时，server端发送特征值通知的参数结构。</p>     <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.82.5.1.6.1.1" width="20%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.82.5.1.6.1.2" width="20%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.82.5.1.6.1.3" width="20%">只读</th>         <th align="left" class="cellrowborder" id="mcps1.3.82.5.1.6.1.4" width="20%">可选</th>         <th align="left" class="cellrowborder" id="mcps1.3.82.5.1.6.1.5" width="20%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">serviceUuid</td>         <td class="cellrowborder" width="20%">string</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">特征值所属的服务UUID。例如：00001888-0000-1000-8000-00805f9b34fb。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">characteristicUuid</td>         <td class="cellrowborder" width="20%">string</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">内容发生变化的特征值UUID。例如：00002a11-0000-1000-8000-00805f9b34fb。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">characteristicValue</td>         <td class="cellrowborder" width="20%">ArrayBuffer</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">特征值对应的数据内容。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">confirm</td>         <td class="cellrowborder" width="20%">boolean</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">true表示发送的是指示，需要client端回复确认。false表示发送的是通知，不需要client端回复确认。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 969px;">     <h2 id="characteristicreadrequest" device-type="phone,2in1,tablet,wearable,tv">CharacteristicReadRequest<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="characteristicreadrequest" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>描述server端订阅client端读特征值请求事件后，接收到的事件参数结构。</p>     <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.83.5.1.6.1.1" width="20%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.83.5.1.6.1.2" width="20%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.83.5.1.6.1.3" width="20%">只读</th>         <th align="left" class="cellrowborder" id="mcps1.3.83.5.1.6.1.4" width="20%">可选</th>         <th align="left" class="cellrowborder" id="mcps1.3.83.5.1.6.1.5" width="20%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">deviceId</td>         <td class="cellrowborder" width="20%">string</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">client端蓝牙设备地址。例如："XX:XX:XX:XX:XX:XX"。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">transId</td>         <td class="cellrowborder" width="20%">number</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">client端读请求的标识符，server端回复时需填写相同的transId。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">offset</td>         <td class="cellrowborder" width="20%">number</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">          <p>client端读数据的偏移值。例如：k表示从第k个字节开始读。</p>          <p>server端回复响应时需填写相同的offset。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">characteristicUuid</td>         <td class="cellrowborder" width="20%">string</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">client端需要读取的特征值UUID。例如：00002a11-0000-1000-8000-00805f9b34fb。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">serviceUuid</td>         <td class="cellrowborder" width="20%">string</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">特征值所属的服务UUID。例如：00001888-0000-1000-8000-00805f9b34fb。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1296px;">     <h2 id="characteristicwriterequest" device-type="phone,2in1,tablet,wearable,tv">CharacteristicWriteRequest<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="characteristicwriterequest" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>描述server端订阅client端写特征值请求事件后，接收到的事件参数结构。</p>     <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.84.5.1.6.1.1" width="20%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.84.5.1.6.1.2" width="20%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.84.5.1.6.1.3" width="20%">只读</th>         <th align="left" class="cellrowborder" id="mcps1.3.84.5.1.6.1.4" width="20%">可选</th>         <th align="left" class="cellrowborder" id="mcps1.3.84.5.1.6.1.5" width="20%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">deviceId</td>         <td class="cellrowborder" width="20%">string</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">client端蓝牙设备地址。例如："XX:XX:XX:XX:XX:XX"。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">transId</td>         <td class="cellrowborder" width="20%">number</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">client端写请求的标识符，server端回复时需填写相同的transId。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">offset</td>         <td class="cellrowborder" width="20%">number</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">          <p>client端写数据的偏移值。例如：k表示从第k个字节开始写。</p>          <p>server端回复时需填写相同的offset。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">isPrepared</td>         <td class="cellrowborder" width="20%">boolean</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">          <p>收到client端写请求后，是否立即回复。</p>          <p>true表示稍后回复，false表示立即回复。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">needRsp</td>         <td class="cellrowborder" width="20%">boolean</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">          <p>是否需要回复client端。</p>          <p>true表示需要回复，false表示不需要回复。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">value</td>         <td class="cellrowborder" width="20%">ArrayBuffer</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">client端需要给特征值写入的数据。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">characteristicUuid</td>         <td class="cellrowborder" width="20%">string</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">client端需要写入的特征值UUID。例如：00002a11-0000-1000-8000-00805f9b34fb。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">serviceUuid</td>         <td class="cellrowborder" width="20%">string</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">特征值所属的服务UUID。例如：00001888-0000-1000-8000-00805f9b34fb。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1110px;">     <h2 id="descriptorreadrequest" device-type="phone,2in1,tablet,wearable,tv">DescriptorReadRequest<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="descriptorreadrequest" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>描述server端订阅client端读描述符请求事件后，接收到的事件参数结构。</p>     <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.85.5.1.6.1.1" width="20%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.85.5.1.6.1.2" width="20%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.85.5.1.6.1.3" width="20%">只读</th>         <th align="left" class="cellrowborder" id="mcps1.3.85.5.1.6.1.4" width="20%">可选</th>         <th align="left" class="cellrowborder" id="mcps1.3.85.5.1.6.1.5" width="20%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">deviceId</td>         <td class="cellrowborder" width="20%">string</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">client端蓝牙设备地址。例如："XX:XX:XX:XX:XX:XX"。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">transId</td>         <td class="cellrowborder" width="20%">number</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">client端读请求的标识符，server端回复时需填写相同的transId。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">offset</td>         <td class="cellrowborder" width="20%">number</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">          <p>client端读数据的偏移值。例如：k表示从第k个字节开始读。</p>          <p>server端回复响应时需填写相同的offset。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">descriptorUuid</td>         <td class="cellrowborder" width="20%">string</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">client端需要读取的描述符UUID。例如：00002902-0000-1000-8000-00805f9b34fb。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">characteristicUuid</td>         <td class="cellrowborder" width="20%">string</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">描述符所属的特征值UUID。例如：00002a11-0000-1000-8000-00805f9b34fb。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">serviceUuid</td>         <td class="cellrowborder" width="20%">string</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">特征值所属的服务UUID。例如：00001888-0000-1000-8000-00805f9b34fb。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1437px;">     <h2 id="descriptorwriterequest" device-type="phone,2in1,tablet,wearable,tv">DescriptorWriteRequest<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="descriptorwriterequest" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>描述server端订阅client端写描述符请求事件后，接收到的事件参数结构。</p>     <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.86.5.1.6.1.1" width="20%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.86.5.1.6.1.2" width="20%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.86.5.1.6.1.3" width="20%">只读</th>         <th align="left" class="cellrowborder" id="mcps1.3.86.5.1.6.1.4" width="20%">可选</th>         <th align="left" class="cellrowborder" id="mcps1.3.86.5.1.6.1.5" width="20%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">deviceId</td>         <td class="cellrowborder" width="20%">string</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">client端蓝牙设备地址。例如："XX:XX:XX:XX:XX:XX"。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">transId</td>         <td class="cellrowborder" width="20%">number</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">client端写请求的标识符，server端回复时需填写相同的transId。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">offset</td>         <td class="cellrowborder" width="20%">number</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">          <p>client端写数据的偏移值。例如：k表示从第k个字节开始写。</p>          <p>server端回复时需填写相同的offset。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">isPrepared</td>         <td class="cellrowborder" width="20%">boolean</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">          <p>收到client端写请求后，是否立即回复。</p>          <p>true表示稍后回复，false表示立即回复。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">needRsp</td>         <td class="cellrowborder" width="20%">boolean</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">          <p>是否需要回复client端。</p>          <p>true表示需要回复，false表示不需要回复。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">value</td>         <td class="cellrowborder" width="20%">ArrayBuffer</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">client端需要给描述符写入的数据。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">descriptorUuid</td>         <td class="cellrowborder" width="20%">string</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">client端需要写入的描述符UUID。例如：00002902-0000-1000-8000-00805f9b34fb。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">characteristicUuid</td>         <td class="cellrowborder" width="20%">string</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">描述符所属的特征值UUID。例如：00002a11-0000-1000-8000-00805f9b34fb。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">serviceUuid</td>         <td class="cellrowborder" width="20%">string</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">特征值所属的服务UUID。例如：00001888-0000-1000-8000-00805f9b34fb。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 849px;">     <h2 id="serverresponse" device-type="phone,2in1,tablet,wearable,tv">ServerResponse<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="serverresponse" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>描述server端回复client端读或者写请求的响应参数结构。</p>     <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.87.5.1.6.1.1" width="20%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.87.5.1.6.1.2" width="20%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.87.5.1.6.1.3" width="20%">只读</th>         <th align="left" class="cellrowborder" id="mcps1.3.87.5.1.6.1.4" width="20%">可选</th>         <th align="left" class="cellrowborder" id="mcps1.3.87.5.1.6.1.5" width="20%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">deviceId</td>         <td class="cellrowborder" width="20%">string</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">client端蓝牙设备地址。例如："XX:XX:XX:XX:XX:XX"。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">transId</td>         <td class="cellrowborder" width="20%">number</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">收到client端请求的标识符，与订阅client端读或者写请求事件携带的transId保持一致。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">status</td>         <td class="cellrowborder" width="20%">number</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">响应的状态，设置为0即可，表示正常。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">offset</td>         <td class="cellrowborder" width="20%">number</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">client端读或者写请求的数据偏移值，与订阅client端读或者写请求事件携带的offset保持一致。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">value</td>         <td class="cellrowborder" width="20%">ArrayBuffer</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">回复的数据。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 927px;">     <h2 id="bleconnectionchangestate" device-type="phone,2in1,tablet,wearable,tv">BLEConnectionChangeState<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="bleconnectionchangestate" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>描述GATT profile协议连接状态。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.88.4.1.6.1.1" width="20%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.88.4.1.6.1.2" width="20%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.88.4.1.6.1.3" width="20%">只读</th>         <th align="left" class="cellrowborder" id="mcps1.3.88.4.1.6.1.4" width="20%">可选</th>         <th align="left" class="cellrowborder" id="mcps1.3.88.4.1.6.1.5" width="20%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">deviceId</td>         <td class="cellrowborder" width="20%">string</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">          <p>对端蓝牙设备地址。例如："XX:XX:XX:XX:XX:XX"。</p>          <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">state</td>         <td class="cellrowborder" width="20%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-constant#profileconnectionstate">ProfileConnectionState</a></td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">          <p>GATT profile连接状态。</p>          <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">reason<sup>20+</sup></td>         <td class="cellrowborder" width="20%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#gattdisconnectreason20">GattDisconnectReason</a></td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">          <p>GATT链路断连原因，仅在连接状态为 <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-constant#profileconnectionstate">STATE_DISCONNECTED</a> 时提供，其他连接状态下断连原因默认为undefined。</p>          <p><strong>元服务API</strong>：从API version 20开始，该接口支持在元服务中使用。</p></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1233px;">     <h2 id="scanresult" device-type="phone,2in1,tablet,wearable,tv">ScanResult<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="scanresult" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>扫描到符合过滤条件的广播报文后，上报的扫描数据。</p>     <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.89.5.1.6.1.1" width="20%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.89.5.1.6.1.2" width="20%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.89.5.1.6.1.3" width="20%">只读</th>         <th align="left" class="cellrowborder" id="mcps1.3.89.5.1.6.1.4" width="20%">可选</th>         <th align="left" class="cellrowborder" id="mcps1.3.89.5.1.6.1.5" width="20%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">deviceId</td>         <td class="cellrowborder" width="20%">string</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">          <p>扫描到的蓝牙设备地址。例如："XX:XX:XX:XX:XX:XX"。</p>          <p>基于信息安全考虑，此处获取的设备地址为虚拟MAC地址。</p>          <p>- 若和该设备地址配对成功后，该地址不会变更。</p>          <p>- 若该设备重启蓝牙开关，重新获取到的虚拟地址会立即变更。</p>          <p>- 若取消配对，蓝牙子系统会根据该地址的实际使用情况，决策后续变更时机；若其他应用正在使用该地址，则不会立刻变更。</p>          <p>- 若要持久化保存该地址，可使用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-access#accessaddpersistentdeviceid16">access.addPersistentDeviceId</a>方法。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">rssi</td>         <td class="cellrowborder" width="20%">number</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">扫描到的设备信号强度，单位：dBm。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">data</td>         <td class="cellrowborder" width="20%">ArrayBuffer</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">扫描到的设备发送的广播报文内容。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">deviceName</td>         <td class="cellrowborder" width="20%">string</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">扫描到的设备名称。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">connectable</td>         <td class="cellrowborder" width="20%">boolean</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">扫描到的设备是否可连接。true表示可连接，false表示不可连接。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 927px;">     <h2 id="advertisesetting" device-type="phone,2in1,tablet,wearable,tv">AdvertiseSetting<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="advertisesetting" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>描述BLE广播的发送参数。</p>     <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.90.5.1.6.1.1" width="20%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.90.5.1.6.1.2" width="20%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.90.5.1.6.1.3" width="20%">只读</th>         <th align="left" class="cellrowborder" id="mcps1.3.90.5.1.6.1.4" width="20%">可选</th>         <th align="left" class="cellrowborder" id="mcps1.3.90.5.1.6.1.5" width="20%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">interval</td>         <td class="cellrowborder" width="20%">number</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">          <p>广播发送间隔。</p>          <p>取值范围：[32, 16777215]，单位：slot（时间槽），一个slot代表0.625毫秒，默认值为1600。</p>          <p>其中传统广播的最大值是16384。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">txPower</td>         <td class="cellrowborder" width="20%">number</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">          <p>广播发送功率。取值范围：[-127, 1]，单位：dBm，默认值为-7。</p>          <p>考虑到发送广播的性能和功耗，建议高档取值为1，中档取为-7，低档取值为-15。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">connectable</td>         <td class="cellrowborder" width="20%">boolean</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">是否是可连接广播。true表示发送可连接广播，false表示发送不可连接广播，默认值为true。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1353px;">     <h2 id="advertisedata" device-type="phone,2in1,tablet,wearable,tv">AdvertiseData<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="advertisedata" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>描述BLE广播报文数据内容，也可以用作回复扫描请求的广播报文数据内容。当前只支持传统广播，因此报文最大长度为31个字节。若超出最大长度（31个字节）限制，会导致启动广播失败。若携带了所有参数，尤其是携带了蓝牙设备名称，需要注意广播报文长度。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.91.4.1.6.1.1" width="20%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.91.4.1.6.1.2" width="20%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.91.4.1.6.1.3" width="20%">只读</th>         <th align="left" class="cellrowborder" id="mcps1.3.91.4.1.6.1.4" width="20%">可选</th>         <th align="left" class="cellrowborder" id="mcps1.3.91.4.1.6.1.5" width="20%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">serviceUuids</td>         <td class="cellrowborder" width="20%">Array&lt;string&gt;</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">          <p>要携带的服务UUID。</p>          <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">manufactureData</td>         <td class="cellrowborder" width="20%">Array&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#manufacturedata">ManufactureData</a>&gt;</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">          <p>要携带的制造商数据内容。</p>          <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">serviceData</td>         <td class="cellrowborder" width="20%">Array&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#servicedata">ServiceData</a>&gt;</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">          <p>要携带的服务数据内容。</p>          <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">includeDeviceName</td>         <td class="cellrowborder" width="20%">boolean</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">          <p>是否携带蓝牙设备名称。true表示携带，false表示不携带，默认值为false。</p>          <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">includeTxPower<sup>18+</sup></td>         <td class="cellrowborder" width="20%">boolean</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">          <p>是否携带广播发送功率。</p>          <p>true表示携带广播发送功率，false表示不携带广播发送功率，默认值为false。</p>          <p>携带该值后，广播报文长度将多占用3个字节。</p>          <p><strong>元服务API</strong>：从API version 18开始，该接口支持在元服务中使用。</p></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 684px;">     <h2 id="advertisingparams11" device-type="phone,2in1,tablet,wearable,tv">AdvertisingParams<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="advertisingparams11" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>首次启动BLE广播时设置的参数。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.92.4.1.6.1.1" width="20%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.92.4.1.6.1.2" width="20%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.92.4.1.6.1.3" width="20%">只读</th>         <th align="left" class="cellrowborder" id="mcps1.3.92.4.1.6.1.4" width="20%">可选</th>         <th align="left" class="cellrowborder" id="mcps1.3.92.4.1.6.1.5" width="20%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">advertisingSettings<sup>11+</sup></td>         <td class="cellrowborder" width="20%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#advertisesetting">AdvertiseSetting</a></td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">广播的发送参数。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">advertisingData<sup>11+</sup></td>         <td class="cellrowborder" width="20%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#advertisedata">AdvertiseData</a></td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">需要发送的广播报文数据内容。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">advertisingResponse<sup>11+</sup></td>         <td class="cellrowborder" width="20%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#advertisedata">AdvertiseData</a></td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">回复扫描请求的广播报文数据内容。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">duration<sup>11+</sup></td>         <td class="cellrowborder" width="20%">number</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">          <p>发送广播的持续时间。取值范围：[1, 65535]，单位：10ms。</p>          <p>如果未指定此参数或者将其设置为0，则会持续发送广播。</p></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 546px;">     <h2 id="advertisingenableparams11" device-type="phone,2in1,tablet,wearable,tv">AdvertisingEnableParams<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="advertisingenableparams11" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>启动指定标识的BLE广播时设置的参数。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.93.4.1.6.1.1" width="20%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.93.4.1.6.1.2" width="20%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.93.4.1.6.1.3" width="20%">只读</th>         <th align="left" class="cellrowborder" id="mcps1.3.93.4.1.6.1.4" width="20%">可选</th>         <th align="left" class="cellrowborder" id="mcps1.3.93.4.1.6.1.5" width="20%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">advertisingId</td>         <td class="cellrowborder" width="20%">number</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">需要启动的广播标识。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">duration</td>         <td class="cellrowborder" width="20%">number</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">          <p>发送广播的持续时间。取值范围：[1, 65535]，单位：10ms。</p>          <p>如果未指定此参数或者将其设置为0，则会持续发送广播。</p></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 357px;">     <h2 id="advertisingdisableparams11" device-type="phone,2in1,tablet,wearable,tv">AdvertisingDisableParams<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="advertisingdisableparams11" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>停止指定标识的BLE广播时设置的参数。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.94.4.1.6.1.1" width="20%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.94.4.1.6.1.2" width="20%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.94.4.1.6.1.3" width="20%">只读</th>         <th align="left" class="cellrowborder" id="mcps1.3.94.4.1.6.1.4" width="20%">可选</th>         <th align="left" class="cellrowborder" id="mcps1.3.94.4.1.6.1.5" width="20%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">advertisingId</td>         <td class="cellrowborder" width="20%">number</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">需要停止的广播标识。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 450px;">     <h2 id="advertisingstatechangeinfo11" device-type="phone,2in1,tablet,wearable,tv">AdvertisingStateChangeInfo<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="advertisingstatechangeinfo11" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>描述BLE广播启动、停止的状态信息。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.95.4.1.6.1.1" width="20%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.95.4.1.6.1.2" width="20%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.95.4.1.6.1.3" width="20%">只读</th>         <th align="left" class="cellrowborder" id="mcps1.3.95.4.1.6.1.4" width="20%">可选</th>         <th align="left" class="cellrowborder" id="mcps1.3.95.4.1.6.1.5" width="20%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">advertisingId</td>         <td class="cellrowborder" width="20%">number</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">首次启动广播时会分配该值，后续用于标识当前操作的广播。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">state</td>         <td class="cellrowborder" width="20%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#advertisingstate11">AdvertisingState</a></td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">操作广播后，收到的BLE广播状态。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 450px;">     <h2 id="manufacturedata" device-type="phone,2in1,tablet,wearable,tv">ManufactureData<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="manufacturedata" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>描述BLE广播报文中制造商数据内容。</p>     <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.96.5.1.6.1.1" width="20%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.96.5.1.6.1.2" width="20%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.96.5.1.6.1.3" width="20%">只读</th>         <th align="left" class="cellrowborder" id="mcps1.3.96.5.1.6.1.4" width="20%">可选</th>         <th align="left" class="cellrowborder" id="mcps1.3.96.5.1.6.1.5" width="20%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">manufactureId</td>         <td class="cellrowborder" width="20%">number</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">制造商的标识，由蓝牙技术联盟分配。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">manufactureValue</td>         <td class="cellrowborder" width="20%">ArrayBuffer</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">制造商特定的数据。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 426px;">     <h2 id="servicedata" device-type="phone,2in1,tablet,wearable,tv">ServiceData<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="servicedata" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>描述BLE广播报文中的服务数据内容。</p>     <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.97.5.1.6.1.1" width="20%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.97.5.1.6.1.2" width="20%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.97.5.1.6.1.3" width="20%">只读</th>         <th align="left" class="cellrowborder" id="mcps1.3.97.5.1.6.1.4" width="20%">可选</th>         <th align="left" class="cellrowborder" id="mcps1.3.97.5.1.6.1.5" width="20%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">serviceUuid</td>         <td class="cellrowborder" width="20%">string</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">服务UUID。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">serviceValue</td>         <td class="cellrowborder" width="20%">ArrayBuffer</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">服务数据。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1863px;">     <h2 id="scanfilter" device-type="phone,2in1,tablet,wearable,tv">ScanFilter<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="scanfilter" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>扫描BLE广播的过滤条件，只有符合该条件的广播报文才会上报。</p>     <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.98.5.1.6.1.1" width="20%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.98.5.1.6.1.2" width="20%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.98.5.1.6.1.3" width="20%">只读</th>         <th align="left" class="cellrowborder" id="mcps1.3.98.5.1.6.1.4" width="20%">可选</th>         <th align="left" class="cellrowborder" id="mcps1.3.98.5.1.6.1.5" width="20%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">deviceId</td>         <td class="cellrowborder" width="20%">string</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">过滤该BLE设备地址的广播报文。例如："XX:XX:XX:XX:XX:XX"。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">name</td>         <td class="cellrowborder" width="20%">string</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">过滤该BLE设备名称的广播报文。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">serviceUuid</td>         <td class="cellrowborder" width="20%">string</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">过滤包含该服务UUID的广播报文。例如：00001888-0000-1000-8000-00805f9b34fb。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">serviceUuidMask</td>         <td class="cellrowborder" width="20%">string</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">搭配serviceUuid过滤器使用，可设置过滤部分服务UUID。例如：FFFFFFFF-FFFF-FFFF-FFFF-FFFFFFFFFFFF。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">serviceSolicitationUuid</td>         <td class="cellrowborder" width="20%">string</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">过滤包含该服务请求UUID的广播报文。例如：00001888-0000-1000-8000-00805F9B34FB。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">serviceSolicitationUuidMask</td>         <td class="cellrowborder" width="20%">string</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">搭配serviceSolicitationUuid过滤器使用，可设置过滤部分服务请求UUID。例如：FFFFFFFF-FFFF-FFFF-FFFF-FFFFFFFFFFFF。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">serviceData</td>         <td class="cellrowborder" width="20%">ArrayBuffer</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">过滤包含该服务数据的广播报文。例如：[0x90,0x00,0xF1,0xF2]。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">serviceDataMask</td>         <td class="cellrowborder" width="20%">ArrayBuffer</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">搭配serviceData过滤器使用，可设置过滤部分服务数据。例如：[0xFF,0xFF,0xFF,0xFF]。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">manufactureId</td>         <td class="cellrowborder" width="20%">number</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">过滤包含该制造商标识符的广播报文。例如：0x0006。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">manufactureData</td>         <td class="cellrowborder" width="20%">ArrayBuffer</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">搭配manufactureId过滤器使用，过滤包含该制造商数据的广播报文。例如：[0x1F,0x2F,0x3F]。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">manufactureDataMask</td>         <td class="cellrowborder" width="20%">ArrayBuffer</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">搭配manufactureData过滤器使用，可设置过滤部分制造商数据。例如：[0xFF,0xFF,0xFF]。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1785px;">     <h2 id="scanoptions" device-type="phone,2in1,tablet,wearable,tv">ScanOptions<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="scanoptions" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>BLE扫描的配置参数。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.99.4.1.6.1.1" width="20%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.99.4.1.6.1.2" width="20%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.99.4.1.6.1.3" width="20%">只读</th>         <th align="left" class="cellrowborder" id="mcps1.3.99.4.1.6.1.4" width="20%">可选</th>         <th align="left" class="cellrowborder" id="mcps1.3.99.4.1.6.1.5" width="20%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">interval</td>         <td class="cellrowborder" width="20%">number</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">          <p>扫描结果上报的延迟时间，单位：ms，默认值为0。搭配<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#scanreportmode15">ScanReportMode</a>使用。</p>          <p>- 在常规或围栏扫描上报模式下，该值不生效，扫描到符合过滤条件的广播报文后立即上报。</p>          <p>- 在批量扫描上报模式下，该值生效，扫描到符合过滤条件的广播报文后，会存入缓存队列，延迟上报。若不设置该值或设置在[0, 5000)范围内，蓝牙子系统会默认设置延迟时间为5000ms。延迟时间内，若符合过滤条件的广播报文数量超过硬件缓存能力，蓝牙子系统会提前上报扫描结果。</p>          <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">dutyMode</td>         <td class="cellrowborder" width="20%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#scanduty">ScanDuty</a></td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">          <p>扫描模式，默认值为SCAN_MODE_LOW_POWER。</p>          <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">matchMode</td>         <td class="cellrowborder" width="20%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#matchmode">MatchMode</a></td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">          <p>硬件的过滤匹配模式，默认值为MATCH_MODE_AGGRESSIVE。</p>          <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">phyType<sup>12+</sup></td>         <td class="cellrowborder" width="20%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#phytype12">PhyType</a></td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">          <p>扫描中使用的物理通道类型，默认值为PHY_LE_1M。</p>          <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">reportMode<sup>15+</sup></td>         <td class="cellrowborder" width="20%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#scanreportmode15">ScanReportMode</a></td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">          <p>扫描结果数据上报模式，默认值为NORMAL。</p>          <p><strong>元服务API</strong>：从API version 15开始，该接口支持在元服务中使用。</p></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 2616px;">     <h2 id="gattproperties" device-type="phone,2in1,tablet,wearable,tv">GattProperties<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="gattproperties" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>描述GATT特征值支持的属性。决定了特征值内容和描述符如何被使用和访问。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.100.4.1.6.1.1" width="20%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.100.4.1.6.1.2" width="20%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.100.4.1.6.1.3" width="20%">只读</th>         <th align="left" class="cellrowborder" id="mcps1.3.100.4.1.6.1.4" width="20%">可选</th>         <th align="left" class="cellrowborder" id="mcps1.3.100.4.1.6.1.5" width="20%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">write</td>         <td class="cellrowborder" width="20%">boolean</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">          <p>该特征值是否支持写入操作。</p>          <p>true表示支持，且被写入时需要回复对端设备，false表示不支持。默认值为true。</p>          <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">writeNoResponse</td>         <td class="cellrowborder" width="20%">boolean</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">          <p>该特征值是否支持写入操作。</p>          <p>true表示支持，且被写入时无需回复对端设备，false表示不支持。默认值为true。</p>          <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">read</td>         <td class="cellrowborder" width="20%">boolean</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">          <p>该特征值是否支持读取操作。</p>          <p>true表示支持，false表示不支持。默认值为true。</p>          <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">notify</td>         <td class="cellrowborder" width="20%">boolean</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">          <p>该特征值是否支持主动向对端设备通知特征值内容。</p>          <p>true表示支持，且对端设备不需要回复确认，false表示不支持。默认值为false。</p>          <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">indicate</td>         <td class="cellrowborder" width="20%">boolean</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">          <p>该特征值是否支持向对端设备指示特征值内容。</p>          <p>true表示支持，对端设备需要回复确认，false表示不支持。默认值为false。</p>          <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">broadcast<sup>20+</sup></td>         <td class="cellrowborder" width="20%">boolean</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">          <p>该特征值是否支持作为广播内容由server端发送。</p>          <p>true表示支持，server端可将特征值内容以<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#servicedata">ServiceData</a>类型在广播报文中携带，false表示不支持。默认值为false。</p>          <p><strong>元服务API</strong>：从API version 20开始，该接口支持在元服务中使用。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">authenticatedSignedWrite<sup>20+</sup></td>         <td class="cellrowborder" width="20%">boolean</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">          <p>该特征值是否支持签名写入操作，通过对写入内容进行签名校验替代加密流程。</p>          <p>true表示支持，且该特征值权限<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#gattpermissions20">GattPermissions</a>中的writeSigned或writeSignedMitm需设置为true，否则该属性不生效，false表示不支持。默认值为false。</p>          <p><strong>元服务API</strong>：从API version 20开始，该接口支持在元服务中使用。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">extendedProperties<sup>20+</sup></td>         <td class="cellrowborder" width="20%">boolean</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">          <p>该特征值是否存在扩展属性。</p>          <p>true表示存在扩展属性，false表示不存在。默认值为false。</p>          <p><strong>元服务API</strong>：从API version 20开始，该接口支持在元服务中使用。</p></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 2064px;">     <h2 id="gattpermissions20" device-type="phone,2in1,tablet,wearable,tv">GattPermissions<sup>20+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="gattpermissions20" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>描述读写GATT特征值或描述符需具备的权限。</p>     <p><strong>元服务API</strong>：从API version 20开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.101.5.1.6.1.1" width="20%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.101.5.1.6.1.2" width="20%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.101.5.1.6.1.3" width="20%">只读</th>         <th align="left" class="cellrowborder" id="mcps1.3.101.5.1.6.1.4" width="20%">可选</th>         <th align="left" class="cellrowborder" id="mcps1.3.101.5.1.6.1.5" width="20%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">read</td>         <td class="cellrowborder" width="20%">boolean</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">          <p>是否允许读取该特征值或描述符内容。</p>          <p>true表示允许，false表示不允许。默认值为true。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">readEncrypted</td>         <td class="cellrowborder" width="20%">boolean</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">          <p>读取该特征值或描述符内容是否需要加密。</p>          <p>true表示需要加密后，方可读取内容，false表示不需要普通方式加密。默认值为false。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">readEncryptedMitm</td>         <td class="cellrowborder" width="20%">boolean</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">          <p>读取该特征值或描述符内容是否需要防中间人攻击的加密。</p>          <p>防中间人攻击表示操作需要经过认证，防止数据被第三方篡改。true表示需要防中间人攻击的加密后才能读取内容，false表示不需要防中间人攻击的加密。默认值为false。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">write</td>         <td class="cellrowborder" width="20%">boolean</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">          <p>是否允许写入该特征值或描述符内容。</p>          <p>true表示允许，false表示不允许。默认值为true。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">writeEncrypted</td>         <td class="cellrowborder" width="20%">boolean</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">          <p>写入该特征值或描述符内容是否需要加密。</p>          <p>true表示需要加密后，方可写入内容，false表示不需要普通方式加密。默认值为false。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">writeEncryptedMitm</td>         <td class="cellrowborder" width="20%">boolean</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">          <p>写入该特征值或描述符内容是否需要防中间人攻击的加密。</p>          <p>true表示需要防中间人攻击的加密后才能写入内容，false表示不需要防中间人攻击的加密。默认值为false。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">writeSigned</td>         <td class="cellrowborder" width="20%">boolean</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">          <p>写入该特征值或描述符内容是否需要经过签名处理。</p>          <p>true表示内容需要签名处理后方可写入，false表示不需要签名处理。默认值为false。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">writeSignedMitm</td>         <td class="cellrowborder" width="20%">boolean</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">          <p>写入该特征值或描述符内容是否需要经过防中间人攻击方式的签名处理。</p>          <p>true表示需要防中间人攻击方式的签名处理后方可写入，false表示不需要以防中间人攻击方式签名处理。默认值为false。</p></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 474px;">     <h2 id="gattwritetype" device-type="phone,2in1,tablet,wearable,tv">GattWriteType<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="gattwritetype" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>枚举，写入特征值的方式（不同的取值，对端蓝牙设备的表现不一样）。</p>     <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.102.5.1.4.1.1" width="33.33333333333333%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.102.5.1.4.1.2" width="33.33333333333333%">值</th>         <th align="left" class="cellrowborder" id="mcps1.3.102.5.1.4.1.3" width="33.33333333333333%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="33.33333333333333%">WRITE</td>         <td class="cellrowborder" width="33.33333333333333%">1</td>         <td class="cellrowborder" width="33.33333333333333%">写入特征值后，对端蓝牙设备需要回复确认。</td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">WRITE_NO_RESPONSE</td>         <td class="cellrowborder" width="33.33333333333333%">2</td>         <td class="cellrowborder" width="33.33333333333333%">写入特征值后，对端蓝牙设备不需要回复。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 519px;">     <h2 id="scanduty" device-type="phone,2in1,tablet,wearable,tv">ScanDuty<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="scanduty" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>枚举，扫描模式，表示不同的扫描性能和功耗情况。</p>     <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.103.5.1.4.1.1" width="33.33333333333333%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.103.5.1.4.1.2" width="33.33333333333333%">值</th>         <th align="left" class="cellrowborder" id="mcps1.3.103.5.1.4.1.3" width="33.33333333333333%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="33.33333333333333%">SCAN_MODE_LOW_POWER</td>         <td class="cellrowborder" width="33.33333333333333%">0</td>         <td class="cellrowborder" width="33.33333333333333%">低功耗模式，扫描性能较低，功耗也较低。</td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">SCAN_MODE_BALANCED</td>         <td class="cellrowborder" width="33.33333333333333%">1</td>         <td class="cellrowborder" width="33.33333333333333%">均衡模式，平衡扫描性能和功耗。</td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">SCAN_MODE_LOW_LATENCY</td>         <td class="cellrowborder" width="33.33333333333333%">2</td>         <td class="cellrowborder" width="33.33333333333333%">低延迟模式，扫描性能较高，但功耗也较高。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 498px;">     <h2 id="matchmode" device-type="phone,2in1,tablet,wearable,tv">MatchMode<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="matchmode" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>枚举，硬件过滤匹配模式。</p>     <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.104.5.1.4.1.1" width="33.33333333333333%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.104.5.1.4.1.2" width="33.33333333333333%">值</th>         <th align="left" class="cellrowborder" id="mcps1.3.104.5.1.4.1.3" width="33.33333333333333%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="33.33333333333333%">MATCH_MODE_AGGRESSIVE</td>         <td class="cellrowborder" width="33.33333333333333%">1</td>         <td class="cellrowborder" width="33.33333333333333%">当广播报文信号强度较低或者短时间内广播报文的发送次数较少时，可以更快地上报。</td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">MATCH_MODE_STICKY</td>         <td class="cellrowborder" width="33.33333333333333%">2</td>         <td class="cellrowborder" width="33.33333333333333%">广播报文信号强度较高或者短时间内广播报文的发送次数较多时，才会上报。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 588px;">     <h2 id="advertisingstate11" device-type="phone,2in1,tablet,wearable,tv">AdvertisingState<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="advertisingstate11" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>枚举，不同操作对应的BLE广播状态。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.105.4.1.4.1.1" width="33.33333333333333%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.105.4.1.4.1.2" width="33.33333333333333%">值</th>         <th align="left" class="cellrowborder" id="mcps1.3.105.4.1.4.1.3" width="33.33333333333333%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="33.33333333333333%">STARTED<sup>11+</sup></td>         <td class="cellrowborder" width="33.33333333333333%">1</td>         <td class="cellrowborder" width="33.33333333333333%">调用<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#blestartadvertising11">startAdvertising</a>方法后，广播首次启动成功，且会分配相关资源。</td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">ENABLED<sup>11+</sup></td>         <td class="cellrowborder" width="33.33333333333333%">2</td>         <td class="cellrowborder" width="33.33333333333333%">调用<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#bleenableadvertising11">enableAdvertising</a>方法后，广播启动成功。</td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">DISABLED<sup>11+</sup></td>         <td class="cellrowborder" width="33.33333333333333%">3</td>         <td class="cellrowborder" width="33.33333333333333%">调用<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#bledisableadvertising11">disableAdvertising</a>方法后，广播停止成功。</td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">STOPPED<sup>11+</sup></td>         <td class="cellrowborder" width="33.33333333333333%">4</td>         <td class="cellrowborder" width="33.33333333333333%">调用<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#blestopadvertising11">stopAdvertising</a>方法后，广播停止成功，且会释放首次启动广播时分配的相关资源。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 426px;">     <h2 id="phytype12" device-type="phone,2in1,tablet,wearable,tv">PhyType<sup>12+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="phytype12" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>枚举，指定扫描过程中接收BLE广播报文的物理通道。</p>     <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.106.5.1.4.1.1" width="33.33333333333333%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.106.5.1.4.1.2" width="33.33333333333333%">值</th>         <th align="left" class="cellrowborder" id="mcps1.3.106.5.1.4.1.3" width="33.33333333333333%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="33.33333333333333%">PHY_LE_1M<sup>12+</sup></td>         <td class="cellrowborder" width="33.33333333333333%">1</td>         <td class="cellrowborder" width="33.33333333333333%">使用1M PHY类型扫描。</td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">PHY_LE_ALL_SUPPORTED<sup>12+</sup></td>         <td class="cellrowborder" width="33.33333333333333%">255</td>         <td class="cellrowborder" width="33.33333333333333%">使用所有支持的PHY类型扫描。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 474px;">     <h2 id="scanreport15" device-type="phone,2in1,tablet,wearable,tv">ScanReport<sup>15+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="scanreport15" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>上报的扫描数据。</p>     <p><strong>元服务API</strong>：从API version 15开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.107.5.1.6.1.1" width="20%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.107.5.1.6.1.2" width="20%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.107.5.1.6.1.3" width="20%">只读</th>         <th align="left" class="cellrowborder" id="mcps1.3.107.5.1.6.1.4" width="20%">可选</th>         <th align="left" class="cellrowborder" id="mcps1.3.107.5.1.6.1.5" width="20%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">reportType</td>         <td class="cellrowborder" width="20%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#scanreporttype15">ScanReportType</a></td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">扫描结果上报类型。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">scanResult</td>         <td class="cellrowborder" width="20%">Array&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#scanresult">ScanResult</a>&gt;</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">扫描到符合过滤条件的BLE广播报文后，上报的扫描数据。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 711px;">     <h2 id="scanreporttype15" device-type="phone,2in1,tablet,wearable,tv">ScanReportType<sup>15+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="scanreporttype15" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>枚举，扫描结果上报类型。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.108.4.1.4.1.1" width="33.33333333333333%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.108.4.1.4.1.2" width="33.33333333333333%">值</th>         <th align="left" class="cellrowborder" id="mcps1.3.108.4.1.4.1.3" width="33.33333333333333%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="33.33333333333333%">ON_FOUND</td>         <td class="cellrowborder" width="33.33333333333333%">1</td>         <td class="cellrowborder" width="33.33333333333333%">          <p>扫描到符合过滤条件的BLE广播报文时，触发上报，可搭配常规和围栏上报模式使用。</p>          <p><strong>元服务API</strong>：从API version 15开始，该接口支持在元服务中使用。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">ON_LOST</td>         <td class="cellrowborder" width="33.33333333333333%">2</td>         <td class="cellrowborder" width="33.33333333333333%">          <p>当不再扫描到符合过滤条件的BLE广播报文时，触发上报，只搭配围栏上报模式使用。</p>          <p><strong>元服务API</strong>：从API version 15开始，该接口支持在元服务中使用</p></td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">ON_BATCH<sup>19+</sup></td>         <td class="cellrowborder" width="33.33333333333333%">3</td>         <td class="cellrowborder" width="33.33333333333333%">          <p>扫描到符合过滤条件的BLE广播报文时，以<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#scanoptions">ScanOptions</a>中的interval字段为周期触发上报。</p>          <p><strong>元服务API</strong>：从API version 19开始，该接口支持在元服务中使用</p></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 516px;">     <h2 id="gattdisconnectreason20" device-type="phone,2in1,tablet,wearable,tv">GattDisconnectReason<sup>20+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="gattdisconnectreason20" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>枚举，指定GATT链路断开的原因。</p>     <p><strong>元服务API</strong>：从API version 20开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.109.5.1.4.1.1" width="33.33333333333333%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.109.5.1.4.1.2" width="33.33333333333333%">值</th>         <th align="left" class="cellrowborder" id="mcps1.3.109.5.1.4.1.3" width="33.33333333333333%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="33.33333333333333%">CONN_TIMEOUT</td>         <td class="cellrowborder" width="33.33333333333333%">1</td>         <td class="cellrowborder" width="33.33333333333333%">连接超时。</td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">CONN_TERMINATE_PEER_USER</td>         <td class="cellrowborder" width="33.33333333333333%">2</td>         <td class="cellrowborder" width="33.33333333333333%">对端设备主动断开连接。</td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">CONN_TERMINATE_LOCAL_HOST</td>         <td class="cellrowborder" width="33.33333333333333%">3</td>         <td class="cellrowborder" width="33.33333333333333%">本端设备主动断开连接。</td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">CONN_UNKNOWN</td>         <td class="cellrowborder" width="33.33333333333333%">4</td>         <td class="cellrowborder" width="33.33333333333333%">未知断连原因。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 447px;">     <h2 id="bleprofile21" device-type="phone,2in1,tablet,wearable,tv">BleProfile<sup>21+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="bleprofile21" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>枚举，指定当前设备的Profile协议类型。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.110.4.1.4.1.1" width="33.33333333333333%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.110.4.1.4.1.2" width="33.33333333333333%">值</th>         <th align="left" class="cellrowborder" id="mcps1.3.110.4.1.4.1.3" width="33.33333333333333%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="33.33333333333333%">GATT</td>         <td class="cellrowborder" width="33.33333333333333%">1</td>         <td class="cellrowborder" width="33.33333333333333%">当前设备在GATT链路中同时作为client端和server端。</td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">GATT_CLIENT</td>         <td class="cellrowborder" width="33.33333333333333%">2</td>         <td class="cellrowborder" width="33.33333333333333%">当前设备在GATT链路中作为client端。</td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">GATT_SERVER</td>         <td class="cellrowborder" width="33.33333333333333%">3</td>         <td class="cellrowborder" width="33.33333333333333%">当前设备在GATT链路中作为server端。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1236px;">     <h2 id="scanreportmode15" device-type="phone,2in1,tablet,wearable,tv">ScanReportMode<sup>15+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="scanreportmode15" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>枚举，扫描结果上报模式。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.Bluetooth.Core</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.111.4.1.4.1.1" width="33.33333333333333%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.111.4.1.4.1.2" width="33.33333333333333%">值</th>         <th align="left" class="cellrowborder" id="mcps1.3.111.4.1.4.1.3" width="33.33333333333333%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="33.33333333333333%">NORMAL</td>         <td class="cellrowborder" width="33.33333333333333%">1</td>         <td class="cellrowborder" width="33.33333333333333%">          <p>常规扫描上报模式，扫描到符合过滤条件的BLE广播报文后就会立刻上报。</p>          <p><strong>元服务API</strong>：从API version 15开始，该接口支持在元服务中使用。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">BATCH<sup>19+</sup></td>         <td class="cellrowborder" width="33.33333333333333%">2</td>         <td class="cellrowborder" width="33.33333333333333%">          <p>批量扫描上报模式。</p>          <p>- 该模式可通过降低蓝牙芯片上报扫描结果频率，使系统更长时间地保持在休眠状态，从而降低整机功耗。</p>          <p>- 该模式下，扫描到符合过滤条件的BLE广播报文后不会立刻上报，需要缓存一段时间（<a href="/consumer/cn/doc/harmonyos-references/js-apis-bluetooth-ble#scanoptions">ScanOptions</a>中的interval字段）后上报。</p>          <p><strong>元服务API</strong>：从API version 19开始，该接口支持在元服务中使用。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">FENCE_SENSITIVITY_LOW<sup>18+</sup></td>         <td class="cellrowborder" width="33.33333333333333%">10</td>         <td class="cellrowborder" width="33.33333333333333%">          <p>低灵敏度围栏上报模式。</p>          <p>- 围栏模式表示只在广播进入或离开围栏时上报。</p>          <p>- 扫描到的广播信号强度高且广播数量多时，可进入低灵敏度围栏。</p>          <p>- 首次扫描到广播即进入围栏，触发一次上报。</p>          <p>- 一段时间内扫描不到广播即离开围栏，触发一次上报。</p>          <p><strong>元服务API</strong>：从API version 18开始，该接口支持在元服务中使用。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">FENCE_SENSITIVITY_HIGH<sup>18+</sup></td>         <td class="cellrowborder" width="33.33333333333333%">11</td>         <td class="cellrowborder" width="33.33333333333333%">          <p>高灵敏度围栏上报模式。</p>          <p>- 围栏模式表示只在广播进入或离开围栏时上报。</p>          <p>- 扫描到的广播信号强度低且广播数量少时，可进入高灵敏度围栏。</p>          <p>- 首次扫描到广播即进入围栏，触发一次上报。</p>          <p>- 一段时间内扫描不到广播即离开围栏，触发一次上报。</p>          <p><strong>元服务API</strong>：从API version 18开始，该接口支持在元服务中使用。</p></td>        </tr>             </tbody></table></div>     </div>    </div>   </div>   <div></div></div>