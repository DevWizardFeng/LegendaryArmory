<h1 _ngcontent-qxc-c119="" class="doc-title ng-star-inserted" title="@ohos.distributedsched.linkEnhance (增强连接)"> @ohos.distributedsched.linkEnhance (增强连接) </h1>

<div _ngcontent-qxc-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p>linkEnhance模块提供高效的蓝牙连接和数据传输功能，增强设备间连接的稳定性。使用多通道合并算法，增加设备间连接数，提升跨设备数据传输能力，改善用户使用体验。</p>    <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">      <p>本模块首批接口从API version 20开始支持。后续版本的新增接口，采用上角标单独标记接口的起始版本。</p>     </div></div></div>    <div class="tiledSection">     <h2 id="导入模块" device-type="phone,2in1,tablet,wearable">导入模块<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="导入模块" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">Wearable</span></div><div _ngcontent-qxc-c106="" class="highlight-div"><div _ngcontent-qxc-c106="" class="highlight-div-header"><div _ngcontent-qxc-c106="" class="highlight-div-header-left"><div _ngcontent-qxc-c106="" class="handle-button expand-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-qxc-c106="" class="highlight-div-header-right"><div _ngcontent-qxc-c106="" class="handle-button ai-button"></div><div _ngcontent-qxc-c106="" class="handle-button line-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-qxc-c106="" class="handle-button theme-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-qxc-c106="" class="handle-button copy-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-qxc-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { linkEnhance } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.DistributedServiceKit'</span>;</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="linkenhancecreateserver" device-type="phone,2in1,tablet,wearable">linkEnhance.createServer<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="linkenhancecreateserver" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">Wearable</span></div><p>createServer(name: string): Server</p>     <p>在服务端设备上，应用创建服务。通过start()开启后，该设备可作为服务端被其他设备连接。</p>     <p><strong>需要权限</strong>：ohos.permission.DISTRIBUTED_DATASYNC</p>     <p><strong>系统能力</strong>：SystemCapability.DistributedSched.AppCollaboration</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.4.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.4.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.4.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.4.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">name</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">自定义的非空字符串，标识应用的服务名，最大长度255字节。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.4.9.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.4.9.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-link-enhance#server">Server</a></td>         <td class="cellrowborder" width="50%">创建成功的服务对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-link-enhance">增强连接错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.4.12.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.4.12.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">32390203</td>         <td class="cellrowborder" width="50%">Duplicate server name.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">32390206</td>         <td class="cellrowborder" width="50%">Invalid parameter.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-qxc-c106="" class="highlight-div"><div _ngcontent-qxc-c106="" class="highlight-div-header"><div _ngcontent-qxc-c106="" class="highlight-div-header-left"><div _ngcontent-qxc-c106="" class="handle-button expand-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-qxc-c106="" class="highlight-div-header-right"><div _ngcontent-qxc-c106="" class="handle-button ai-button"></div><div _ngcontent-qxc-c106="" class="handle-button line-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-qxc-c106="" class="handle-button theme-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-qxc-c106="" class="handle-button copy-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-qxc-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { linkEnhance } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.DistributedServiceKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li>
</li><li><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">TAG</span> = <span class="hljs-string">"testDemo"</span>;</li><li>
</li><li><span class="hljs-keyword">try</span> {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">"demo"</span>;</li><li>  hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'start sever name = '</span> + name);</li><li>  <span class="hljs-comment">// 使用服务名构造Server</span></li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">server</span>: linkEnhance.<span class="hljs-property">Server</span> = linkEnhance.<span class="hljs-title function_">createServer</span>(name);</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>  hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'start sever errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> +</li><li>  (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="linkenhancecreateconnection" device-type="phone,2in1,tablet,wearable">linkEnhance.createConnection<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="linkenhancecreateconnection" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">Wearable</span></div><p>createConnection(deviceId: string, name: string): Connection</p>     <p>作为客户端的设备创建连接对象，以便后续向服务端设备发起连接。</p>     <p><strong>需要权限</strong>：ohos.permission.DISTRIBUTED_DATASYNC</p>     <p><strong>系统能力</strong>：SystemCapability.DistributedSched.AppCollaboration</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.5.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.5.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.5.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.5.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">deviceId</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">连接的目标设备的deviceId，即对端设备的BLE MAC地址。BLE MAC的获取方法，请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ble-development-guide" target="_blank">查找设备</a>。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">name</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">连接的目标设备的服务名，非空字符串，最大长度255字节。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.5.9.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.5.9.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-link-enhance#connection">Connection</a></td>         <td class="cellrowborder" width="50%">创建成功的连接对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-link-enhance">增强连接错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.5.12.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.5.12.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">32390206</td>         <td class="cellrowborder" width="50%">Invalid parameter.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <p>在客户端设备上，应用需要主动调用createConnection()接口创建连接对象。</p>     <div _ngcontent-qxc-c106="" class="highlight-div"><div _ngcontent-qxc-c106="" class="highlight-div-header"><div _ngcontent-qxc-c106="" class="highlight-div-header-left"><div _ngcontent-qxc-c106="" class="handle-button expand-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-qxc-c106="" class="highlight-div-header-right"><div _ngcontent-qxc-c106="" class="handle-button ai-button"></div><div _ngcontent-qxc-c106="" class="handle-button line-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-qxc-c106="" class="handle-button theme-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-qxc-c106="" class="handle-button copy-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-qxc-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { linkEnhance } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.DistributedServiceKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li>
</li><li><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">TAG</span> = <span class="hljs-string">"testDemo"</span>;</li><li>
</li><li><span class="hljs-keyword">try</span> {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">peerDeviceId</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">"00:11:22:33:44:55"</span>;</li><li>  hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'connection sever deviceId = '</span> + peerDeviceId);</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">connection</span>: linkEnhance.<span class="hljs-property">Connection</span> = linkEnhance.<span class="hljs-title function_">createConnection</span>(peerDeviceId, <span class="hljs-string">"demo"</span>);</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>  hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> +</li><li>  (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="server" device-type="phone,2in1,tablet,wearable">Server<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="server" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">Wearable</span></div><p>服务对象，提供启动服务、停止服务、关闭服务、注册/取消注册服务端回调等方法。</p>     <p>以下方法，在服务端设备上执行。</p>    </div>    <div class="tiledSection">     <h3 id="start" device-type="phone,2in1,tablet,wearable" class="firsth2">start()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="start" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">Wearable</span></div><p>start(): void</p>     <p>创建服务成功后，需要调用start()开启该服务，方可被客户端连接，最大服务个数为10。</p>     <p><strong>需要权限</strong>：ohos.permission.DISTRIBUTED_DATASYNC</p>     <p><strong>系统能力</strong>：SystemCapability.DistributedSched.AppCollaboration</p>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-link-enhance">增强连接错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.7.8.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.7.8.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">32390202</td>         <td class="cellrowborder" width="50%">The number of servers exceeds the limit.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">32390300</td>         <td class="cellrowborder" width="50%">Internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-qxc-c106="" class="highlight-div"><div _ngcontent-qxc-c106="" class="highlight-div-header"><div _ngcontent-qxc-c106="" class="highlight-div-header-left"><div _ngcontent-qxc-c106="" class="handle-button expand-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-qxc-c106="" class="highlight-div-header-right"><div _ngcontent-qxc-c106="" class="handle-button ai-button"></div><div _ngcontent-qxc-c106="" class="handle-button line-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-qxc-c106="" class="handle-button theme-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-qxc-c106="" class="handle-button copy-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-qxc-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { linkEnhance } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.DistributedServiceKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li>
</li><li><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">TAG</span> = <span class="hljs-string">"testDemo"</span>;</li><li>
</li><li><span class="hljs-keyword">try</span> {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">"demo"</span>;</li><li>  hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'start sever name = '</span> + name);</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">server</span>: linkEnhance.<span class="hljs-property">Server</span> = linkEnhance.<span class="hljs-title function_">createServer</span>(name);</li><li>  server.<span class="hljs-title function_">start</span>();</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>  hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'start sever errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> +</li><li>  (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="stop" device-type="phone,2in1,tablet,wearable">stop()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="stop" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">Wearable</span></div><p>stop(): void</p>     <p>使用完服务时，调用stop停止服务，停止后可以调用start重新开启服务。</p>     <p><strong>需要权限</strong>：ohos.permission.DISTRIBUTED_DATASYNC</p>     <p><strong>系统能力</strong>：SystemCapability.DistributedSched.AppCollaboration</p>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-link-enhance">增强连接错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.8.8.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.8.8.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-qxc-c106="" class="highlight-div"><div _ngcontent-qxc-c106="" class="highlight-div-header"><div _ngcontent-qxc-c106="" class="highlight-div-header-left"><div _ngcontent-qxc-c106="" class="handle-button expand-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-qxc-c106="" class="highlight-div-header-right"><div _ngcontent-qxc-c106="" class="handle-button ai-button"></div><div _ngcontent-qxc-c106="" class="handle-button line-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-qxc-c106="" class="handle-button theme-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-qxc-c106="" class="handle-button copy-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-qxc-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { linkEnhance } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.DistributedServiceKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li>
</li><li><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">TAG</span> = <span class="hljs-string">"testDemo"</span>;</li><li>
</li><li><span class="hljs-keyword">try</span> {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">"demo"</span>;</li><li>  hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'start sever name = '</span> + name);</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">server</span>: linkEnhance.<span class="hljs-property">Server</span> = linkEnhance.<span class="hljs-title function_">createServer</span>(name);</li><li>  server.<span class="hljs-title function_">start</span>();</li><li>  server.<span class="hljs-title function_">stop</span>();</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>  hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'start sever errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> +</li><li>  (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="close" device-type="phone,2in1,tablet,wearable">close()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="close" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">Wearable</span></div><p>close(): void</p>     <p>当业务执行完毕，服务端清理资源时，调用close()方法，销毁Server对象，释放相关资源。之后如果再次与对端设备交互，需要重新创建Server对象。</p>     <p><strong>需要权限</strong>：ohos.permission.DISTRIBUTED_DATASYNC</p>     <p><strong>系统能力</strong>：SystemCapability.DistributedSched.AppCollaboration</p>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-link-enhance">增强连接错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.9.8.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.9.8.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-qxc-c106="" class="highlight-div"><div _ngcontent-qxc-c106="" class="highlight-div-header"><div _ngcontent-qxc-c106="" class="highlight-div-header-left"><div _ngcontent-qxc-c106="" class="handle-button expand-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-qxc-c106="" class="highlight-div-header-right"><div _ngcontent-qxc-c106="" class="handle-button ai-button"></div><div _ngcontent-qxc-c106="" class="handle-button line-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-qxc-c106="" class="handle-button theme-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-qxc-c106="" class="handle-button copy-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-qxc-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { linkEnhance } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.DistributedServiceKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li>
</li><li><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">TAG</span> = <span class="hljs-string">"testDemo"</span>;</li><li>
</li><li><span class="hljs-keyword">try</span> {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">"demo"</span>;</li><li>  hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'start sever name = '</span> + name);</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">server</span>: linkEnhance.<span class="hljs-property">Server</span> = linkEnhance.<span class="hljs-title function_">createServer</span>(name);</li><li>  server.<span class="hljs-title function_">start</span>();</li><li>  server.<span class="hljs-title function_">close</span>();</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>  hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'start sever errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> +</li><li>  (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="onconnectionaccepted" device-type="phone,2in1,tablet,wearable">on('connectionAccepted')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onconnectionaccepted" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">Wearable</span></div><p>on(type: 'connectionAccepted', callback: Callback&lt;Connection&gt;): void</p>     <p>创建服务成功后，注册connectionAccepted事件的回调监听，等待对端连接。使用callback异步回调。</p>     <p><strong>需要权限</strong>：ohos.permission.DISTRIBUTED_DATASYNC</p>     <p><strong>系统能力</strong>：SystemCapability.DistributedSched.AppCollaboration</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.10.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.10.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.10.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.10.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">事件回调类型，支持的事件为'connectionAccepted'，收到对端连接，触发该事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-link-enhance#connection">Connection</a>&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">注册的回调函数。<a href="/consumer/cn/doc/harmonyos-references/js-apis-link-enhance#connection">Connection</a>返回的连接对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-link-enhance">增强连接错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.10.10.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.10.10.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">32390206</td>         <td class="cellrowborder" width="50%">Parameter invalid.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-qxc-c106="" class="highlight-div"><div _ngcontent-qxc-c106="" class="highlight-div-header"><div _ngcontent-qxc-c106="" class="highlight-div-header-left"><div _ngcontent-qxc-c106="" class="handle-button expand-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-qxc-c106="" class="highlight-div-header-right"><div _ngcontent-qxc-c106="" class="handle-button ai-button"></div><div _ngcontent-qxc-c106="" class="handle-button line-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-qxc-c106="" class="handle-button theme-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-qxc-c106="" class="handle-button copy-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-qxc-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { linkEnhance } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.DistributedServiceKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li>
</li><li><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">TAG</span> = <span class="hljs-string">"testDemo"</span>;</li><li>
</li><li><span class="hljs-keyword">try</span> {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">"demo"</span>;</li><li>  hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'start sever name = '</span> + name);</li><li>  <span class="hljs-comment">// 使用服务名构造Server</span></li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">server</span>: linkEnhance.<span class="hljs-property">Server</span> = linkEnhance.<span class="hljs-title function_">createServer</span>(name);</li><li>
</li><li>  <span class="hljs-comment">// 订阅服务接收事件</span></li><li>  server.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connectionAccepted'</span>, (<span class="hljs-attr">connection</span>: linkEnhance.<span class="hljs-property">Connection</span>): <span class="hljs-function"><span class="hljs-params">void</span> =&gt;</span> {</li><li>    hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'serverOnCallback = '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(connection));</li><li>  });</li><li>  <span class="hljs-comment">// 启动服务</span></li><li>  server.<span class="hljs-title function_">start</span>();</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>  hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'start sever errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> +</li><li>  (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="offconnectionaccepted" device-type="phone,2in1,tablet,wearable">off('connectionAccepted')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="offconnectionaccepted" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">Wearable</span></div><p>off(type: 'connectionAccepted', callback?: Callback&lt;Connection&gt;): void</p>     <p>取消注册connectionAccepted事件的回调监听。使用callback异步回调。</p>     <p><strong>需要权限</strong>：ohos.permission.DISTRIBUTED_DATASYNC</p>     <p><strong>系统能力</strong>：SystemCapability.DistributedSched.AppCollaboration</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.11.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.11.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.11.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.11.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">事件回调类型，支持的事件为'connectionAccepted'，收到对端连接，触发该事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-link-enhance#connection">Connection</a>&gt;</td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">注册的回调函数。<a href="/consumer/cn/doc/harmonyos-references/js-apis-link-enhance#connection">Connection</a>返回的连接对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-link-enhance">增强连接错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.11.10.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.11.10.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">32390206</td>         <td class="cellrowborder" width="50%">Parameter invalid.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-qxc-c106="" class="highlight-div"><div _ngcontent-qxc-c106="" class="highlight-div-header"><div _ngcontent-qxc-c106="" class="highlight-div-header-left"><div _ngcontent-qxc-c106="" class="handle-button expand-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-qxc-c106="" class="highlight-div-header-right"><div _ngcontent-qxc-c106="" class="handle-button ai-button"></div><div _ngcontent-qxc-c106="" class="handle-button line-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-qxc-c106="" class="handle-button theme-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-qxc-c106="" class="handle-button copy-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-qxc-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { linkEnhance } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.DistributedServiceKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li>
</li><li><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">TAG</span> = <span class="hljs-string">"testDemo"</span>;</li><li>
</li><li><span class="hljs-keyword">try</span> {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">"demo"</span>;</li><li>  hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'start sever name = '</span> + name);</li><li>  <span class="hljs-comment">// 使用服务名构造Server</span></li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">server</span>: linkEnhance.<span class="hljs-property">Server</span> = linkEnhance.<span class="hljs-title function_">createServer</span>(name);</li><li>  server.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connectionAccepted'</span>, (<span class="hljs-attr">connection</span>: linkEnhance.<span class="hljs-property">Connection</span>): <span class="hljs-function"><span class="hljs-params">void</span> =&gt;</span> {</li><li>    hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'accpet new connection'</span>);</li><li>  });</li><li>  <span class="hljs-comment">// 取消订阅服务接收</span></li><li>  server.<span class="hljs-title function_">off</span>(<span class="hljs-string">'connectionAccepted'</span>, (<span class="hljs-attr">connection</span>: linkEnhance.<span class="hljs-property">Connection</span>): <span class="hljs-function"><span class="hljs-params">void</span> =&gt;</span> {</li><li>    hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'accpet new connection'</span>);</li><li>  });</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>  hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'start sever errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> +</li><li>  (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="onserverstopped" device-type="phone,2in1,tablet,wearable">on('serverStopped')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onserverstopped" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">Wearable</span></div><p>on(type: 'serverStopped', callback: Callback&lt;number&gt;): void</p>     <p>在创建服务成功后，注册serverStopped回调，监听服务异常停止。使用callback异步回调。</p>     <p><strong>需要权限</strong>：ohos.permission.DISTRIBUTED_DATASYNC</p>     <p><strong>系统能力</strong>：SystemCapability.DistributedSched.AppCollaboration</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.12.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.12.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.12.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.12.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">事件回调类型，支持的事件为'serverStopped'，底层服务异常时，触发该事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;number&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">注册的回调函数，number为返回的错误码。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-link-enhance">增强连接错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.12.10.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.12.10.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">32390206</td>         <td class="cellrowborder" width="50%">Parameter invalid.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-qxc-c106="" class="highlight-div"><div _ngcontent-qxc-c106="" class="highlight-div-header"><div _ngcontent-qxc-c106="" class="highlight-div-header-left"><div _ngcontent-qxc-c106="" class="handle-button expand-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-qxc-c106="" class="highlight-div-header-right"><div _ngcontent-qxc-c106="" class="handle-button ai-button"></div><div _ngcontent-qxc-c106="" class="handle-button line-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-qxc-c106="" class="handle-button theme-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-qxc-c106="" class="handle-button copy-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-qxc-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { linkEnhance } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.DistributedServiceKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li>
</li><li><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">TAG</span> = <span class="hljs-string">"testDemo"</span>;</li><li>
</li><li><span class="hljs-keyword">try</span> {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">"demo"</span>;</li><li>  hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'start sever name = '</span> + name);</li><li>  <span class="hljs-comment">// 使用服务名构造Server</span></li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">server</span>: linkEnhance.<span class="hljs-property">Server</span> = linkEnhance.<span class="hljs-title function_">createServer</span>(name);</li><li>
</li><li>  <span class="hljs-comment">// 订阅服务停止</span></li><li>  server.<span class="hljs-title function_">on</span>(<span class="hljs-string">'serverStopped'</span>, (<span class="hljs-attr">reason</span>: <span class="hljs-built_in">number</span>): <span class="hljs-function"><span class="hljs-params">void</span> =&gt;</span> {</li><li>    hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'serverStopped， reason= '</span> + reason);</li><li>  });</li><li>  <span class="hljs-comment">// 启动服务</span></li><li>  server.<span class="hljs-title function_">start</span>();</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>  hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'start sever errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> +</li><li>  (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="offserverstopped" device-type="phone,2in1,tablet,wearable">off('serverStopped')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="offserverstopped" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">Wearable</span></div><p>off(type: 'serverStopped', callback?: Callback&lt;number&gt;): void</p>     <p>取消注册serverStopped事件的回调监听。使用callback异步回调。</p>     <p><strong>需要权限</strong>：ohos.permission.DISTRIBUTED_DATASYNC</p>     <p><strong>系统能力</strong>：SystemCapability.DistributedSched.AppCollaboration</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.13.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.13.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.13.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.13.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">事件回调类型，支持的事件为'serverStopped'，底层服务异常时触发。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;number&gt;</td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">注册的回调函数，number为返回的错误码。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-link-enhance">增强连接错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.13.10.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.13.10.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">32390206</td>         <td class="cellrowborder" width="50%">Parameter invalid.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-qxc-c106="" class="highlight-div"><div _ngcontent-qxc-c106="" class="highlight-div-header"><div _ngcontent-qxc-c106="" class="highlight-div-header-left"><div _ngcontent-qxc-c106="" class="handle-button expand-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-qxc-c106="" class="highlight-div-header-right"><div _ngcontent-qxc-c106="" class="handle-button ai-button"></div><div _ngcontent-qxc-c106="" class="handle-button line-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-qxc-c106="" class="handle-button theme-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-qxc-c106="" class="handle-button copy-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-qxc-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { linkEnhance } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.DistributedServiceKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li>
</li><li><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">TAG</span> = <span class="hljs-string">"testDemo"</span>;</li><li>
</li><li><span class="hljs-keyword">try</span> {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">"demo"</span>;</li><li>  hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'start sever name = '</span> + name);</li><li>  <span class="hljs-comment">// 使用服务名构造Server</span></li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">server</span>: linkEnhance.<span class="hljs-property">Server</span> = linkEnhance.<span class="hljs-title function_">createServer</span>(name);</li><li>  server.<span class="hljs-title function_">on</span>(<span class="hljs-string">'serverStopped'</span>, (<span class="hljs-attr">reason</span>: <span class="hljs-built_in">number</span>): <span class="hljs-function"><span class="hljs-params">void</span> =&gt;</span> {</li><li>    hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'serverStopped， reason= '</span> + reason);</li><li>  });</li><li>  <span class="hljs-comment">// 取消订阅服务停止</span></li><li>  server.<span class="hljs-title function_">off</span>(<span class="hljs-string">'serverStopped'</span>, (<span class="hljs-attr">reason</span>: <span class="hljs-built_in">number</span>): <span class="hljs-function"><span class="hljs-params">void</span> =&gt;</span> {</li><li>    hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'serverStopped， reason= '</span> + reason);</li><li>  });</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>  hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'start sever errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> +</li><li>  (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="connectresult" device-type="phone,2in1,tablet,wearable">ConnectResult<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="connectresult" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">Wearable</span></div><p>客户端调用connect()后，返回的连接结果。</p>     <p><strong>系统能力</strong>：SystemCapability.DistributedSched.AppCollaboration</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.14.4.1.6.1.1" width="20%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.14.4.1.6.1.2" width="20%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.14.4.1.6.1.3" width="20%">只读</th>         <th align="left" class="cellrowborder" id="mcps1.3.14.4.1.6.1.4" width="20%">可选</th>         <th align="left" class="cellrowborder" id="mcps1.3.14.4.1.6.1.5" width="20%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">deviceId</td>         <td class="cellrowborder" width="20%">string</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">对端设备ID，成功返回对端设备的deviceId，失败返回空字符串。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">success</td>         <td class="cellrowborder" width="20%">boolean</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">连接结果，true表示连接成功，false表示连接失败。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">reason</td>         <td class="cellrowborder" width="20%">number</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">          <p>连接成功返回0，连接失败返回错误码：</p>          <p>- 32390200：表示客户端连接超时。</p>          <p>- 32390201：表示服务端服务未启动。</p>          <p>- 32390300：表示内部错误。</p>          <p>更多关于错误码的详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-link-enhance">增强连接错误码</a>。</p></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="connection" device-type="phone,2in1,tablet,wearable">Connection<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="connection" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">Wearable</span></div><p>连接对象，提供连接、断连、获取对端设备ID、发送数据、注册/取消注册回调等方法。</p>    </div>    <div class="tiledSection">     <h3 id="connect" device-type="phone,2in1,tablet,wearable" class="firsth2">connect()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="connect" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">Wearable</span></div><p>connect(): void</p>     <p>在客户端执行，向服务端设备发起连接，最大连接个数限制为10。</p>     <p><strong>需要权限</strong>：ohos.permission.DISTRIBUTED_DATASYNC</p>     <p><strong>系统能力</strong>：SystemCapability.DistributedSched.AppCollaboration</p>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-link-enhance">增强连接错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.16.8.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.16.8.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">32390204</td>         <td class="cellrowborder" width="50%">The number of connection exceeds the limit.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">32390300</td>         <td class="cellrowborder" width="50%">Internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <p>客户端设备上的应用在创建Connection对象成功后，调用connect()方法连接目标设备（即服务端）。</p>     <div _ngcontent-qxc-c106="" class="highlight-div"><div _ngcontent-qxc-c106="" class="highlight-div-header"><div _ngcontent-qxc-c106="" class="highlight-div-header-left"><div _ngcontent-qxc-c106="" class="handle-button expand-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-qxc-c106="" class="highlight-div-header-right"><div _ngcontent-qxc-c106="" class="handle-button ai-button"></div><div _ngcontent-qxc-c106="" class="handle-button line-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-qxc-c106="" class="handle-button theme-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-qxc-c106="" class="handle-button copy-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-qxc-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { linkEnhance } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.DistributedServiceKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li>
</li><li><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">TAG</span> = <span class="hljs-string">"testDemo"</span>;</li><li>
</li><li><span class="hljs-keyword">try</span> {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">peerDeviceId</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">"00:11:22:33:44:55"</span>;</li><li>  hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'connection sever deviceId = '</span> + peerDeviceId);</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">connection</span>: linkEnhance.<span class="hljs-property">Connection</span> = linkEnhance.<span class="hljs-title function_">createConnection</span>(peerDeviceId, <span class="hljs-string">"demo"</span>);</li><li>  <span class="hljs-comment">// 订阅连接结果</span></li><li>  connection.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connectResult'</span>, (<span class="hljs-attr">result</span>: linkEnhance.<span class="hljs-property">ConnectResult</span>): <span class="hljs-function"><span class="hljs-params">void</span> =&gt;</span> {</li><li>    hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'clientConnectResultCallback result = '</span> + result.<span class="hljs-property">success</span>);</li><li>  });</li><li>  <span class="hljs-comment">// 发起连接</span></li><li>  connection.<span class="hljs-title function_">connect</span>();</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>  hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> +</li><li>  (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="disconnect" device-type="phone,2in1,tablet,wearable">disconnect()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="disconnect" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">Wearable</span></div><p>disconnect(): void</p>     <p>业务执行完毕后，双端任意设备可调用该接口断开连接。创建的connection对象仍有效，需要时可调用connect()重新连接。</p>     <p><strong>需要权限</strong>：ohos.permission.DISTRIBUTED_DATASYNC</p>     <p><strong>系统能力</strong>：SystemCapability.DistributedSched.AppCollaboration</p>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-link-enhance">增强连接错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.17.8.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.17.8.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-qxc-c106="" class="highlight-div"><div _ngcontent-qxc-c106="" class="highlight-div-header"><div _ngcontent-qxc-c106="" class="highlight-div-header-left"><div _ngcontent-qxc-c106="" class="handle-button expand-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-qxc-c106="" class="highlight-div-header-right"><div _ngcontent-qxc-c106="" class="handle-button ai-button"></div><div _ngcontent-qxc-c106="" class="handle-button line-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-qxc-c106="" class="handle-button theme-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-qxc-c106="" class="handle-button copy-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-qxc-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { linkEnhance } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.DistributedServiceKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li>
</li><li><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">TAG</span> = <span class="hljs-string">"testDemo"</span>;</li><li>
</li><li><span class="hljs-keyword">try</span> {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">peerDeviceId</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">"00:11:22:33:44:55"</span>;</li><li>  hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'connection sever deviceId = '</span> + peerDeviceId);</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">connection</span>: linkEnhance.<span class="hljs-property">Connection</span> = linkEnhance.<span class="hljs-title function_">createConnection</span>(peerDeviceId, <span class="hljs-string">"demo"</span>);</li><li>  connection.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connectResult'</span>, (<span class="hljs-attr">result</span>: linkEnhance.<span class="hljs-property">ConnectResult</span>): <span class="hljs-function"><span class="hljs-params">void</span> =&gt;</span> {</li><li>    hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'clientConnectResultCallback result = '</span> + result.<span class="hljs-property">success</span>);</li><li>    <span class="hljs-keyword">if</span> (result.<span class="hljs-property">success</span>) {</li><li>      connection.<span class="hljs-title function_">disconnect</span>();</li><li>    }</li><li>  });</li><li>  connection.<span class="hljs-title function_">connect</span>();</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>  hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> +</li><li>  (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="close-1" device-type="phone,2in1,tablet,wearable">close()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="close-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">Wearable</span></div><p>close(): void</p>     <p>业务执行完毕后，任意设备可调用该接口销毁connection对象，释放资源。若需再次与对端设备交互，必须重新创建connection对象并调用connect()发起连接。</p>     <p><strong>需要权限</strong>：ohos.permission.DISTRIBUTED_DATASYNC</p>     <p><strong>系统能力</strong>：SystemCapability.DistributedSched.AppCollaboration</p>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-link-enhance">增强连接错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.18.8.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.18.8.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-qxc-c106="" class="highlight-div"><div _ngcontent-qxc-c106="" class="highlight-div-header"><div _ngcontent-qxc-c106="" class="highlight-div-header-left"><div _ngcontent-qxc-c106="" class="handle-button expand-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-qxc-c106="" class="highlight-div-header-right"><div _ngcontent-qxc-c106="" class="handle-button ai-button"></div><div _ngcontent-qxc-c106="" class="handle-button line-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-qxc-c106="" class="handle-button theme-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-qxc-c106="" class="handle-button copy-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-qxc-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { linkEnhance } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.DistributedServiceKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li>
</li><li><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">TAG</span> = <span class="hljs-string">"testDemo"</span>;</li><li>
</li><li><span class="hljs-keyword">try</span> {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">peerDeviceId</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">"00:11:22:33:44:55"</span>;</li><li>  hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'connection sever deviceId = '</span> + peerDeviceId);</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">connection</span>: linkEnhance.<span class="hljs-property">Connection</span> = linkEnhance.<span class="hljs-title function_">createConnection</span>(peerDeviceId, <span class="hljs-string">"demo"</span>);</li><li>  connection.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connectResult'</span>, (<span class="hljs-attr">result</span>: linkEnhance.<span class="hljs-property">ConnectResult</span>): <span class="hljs-function"><span class="hljs-params">void</span> =&gt;</span> {</li><li>    hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'clientConnectResultCallback result = '</span> + result.<span class="hljs-property">success</span>);</li><li>    <span class="hljs-keyword">if</span> (result.<span class="hljs-property">success</span>) {</li><li>      connection.<span class="hljs-title function_">close</span>();</li><li>    }</li><li>  });</li><li>  connection.<span class="hljs-title function_">connect</span>();</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>  hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> +</li><li>  (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="getpeerdeviceid" device-type="phone,2in1,tablet,wearable">getPeerDeviceId()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getpeerdeviceid" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">Wearable</span></div><p>getPeerDeviceId(): string</p>     <p>获取对端设备的deviceId，作为对端设备的标识符，连接成功后或者被连接成功后调用。</p>     <p><strong>需要权限</strong>：ohos.permission.DISTRIBUTED_DATASYNC</p>     <p><strong>系统能力</strong>：SystemCapability.DistributedSched.AppCollaboration</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.19.7.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.19.7.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">string</td>         <td class="cellrowborder" width="50%">对端设备的deviceId，即对端设备的BLE MAC地址。如果获取失败返回空字符串。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-link-enhance">增强连接错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.19.10.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.19.10.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-qxc-c106="" class="highlight-div"><div _ngcontent-qxc-c106="" class="highlight-div-header"><div _ngcontent-qxc-c106="" class="highlight-div-header-left"><div _ngcontent-qxc-c106="" class="handle-button expand-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-qxc-c106="" class="highlight-div-header-right"><div _ngcontent-qxc-c106="" class="handle-button ai-button"></div><div _ngcontent-qxc-c106="" class="handle-button line-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-qxc-c106="" class="handle-button theme-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-qxc-c106="" class="handle-button copy-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-qxc-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { linkEnhance } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.DistributedServiceKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li>
</li><li><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">TAG</span> = <span class="hljs-string">"testDemo"</span>;</li><li>
</li><li><span class="hljs-keyword">try</span> {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">peerDeviceId</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">"00:11:22:33:44:55"</span>;</li><li>  hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'connection sever deviceId = '</span> + peerDeviceId);</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">connection</span>: linkEnhance.<span class="hljs-property">Connection</span> = linkEnhance.<span class="hljs-title function_">createConnection</span>(peerDeviceId, <span class="hljs-string">"demo"</span>);</li><li>  connection.<span class="hljs-title function_">getPeerDeviceId</span>();</li><li>  hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">"peerDeviceId=%{public}s"</span> + connection.<span class="hljs-title function_">getPeerDeviceId</span>());</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>  hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> +</li><li>  (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="senddata" device-type="phone,2in1,tablet,wearable">sendData()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="senddata" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">Wearable</span></div><p>sendData(data: ArrayBuffer): void</p>     <p>客户端连接成功后，可以向服务端发送数据。服务端接收到连接回调时，也可以向客户端发送数据。</p>     <p><strong>需要权限</strong>：ohos.permission.DISTRIBUTED_DATASYNC</p>     <p><strong>系统能力</strong>：SystemCapability.DistributedSched.AppCollaboration</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.20.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.20.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.20.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.20.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">data</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arraybuffer-object" target="_blank">ArrayBuffer</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">需要发送的数据，最大发送长度为1024字节。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-link-enhance">增强连接错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.20.10.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.20.10.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">32390205</td>         <td class="cellrowborder" width="50%">Connection is not ready.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">32390206</td>         <td class="cellrowborder" width="50%">Invalid parameter.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">32390300</td>         <td class="cellrowborder" width="50%">Internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-qxc-c106="" class="highlight-div"><div _ngcontent-qxc-c106="" class="highlight-div-header"><div _ngcontent-qxc-c106="" class="highlight-div-header-left"><div _ngcontent-qxc-c106="" class="handle-button expand-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-qxc-c106="" class="highlight-div-header-right"><div _ngcontent-qxc-c106="" class="handle-button ai-button"></div><div _ngcontent-qxc-c106="" class="handle-button line-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-qxc-c106="" class="handle-button theme-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-qxc-c106="" class="handle-button copy-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-qxc-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { linkEnhance } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.DistributedServiceKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li>
</li><li><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">TAG</span> = <span class="hljs-string">"testDemo"</span>;</li><li>
</li><li><span class="hljs-keyword">try</span> {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">peerDeviceId</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">"00:11:22:33:44:55"</span>;</li><li>  hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'connection sever deviceId = '</span> + peerDeviceId);</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">connection</span>: linkEnhance.<span class="hljs-property">Connection</span> = linkEnhance.<span class="hljs-title function_">createConnection</span>(peerDeviceId, <span class="hljs-string">"demo"</span>);</li><li>  connection.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connectResult'</span>, (<span class="hljs-attr">result</span>: linkEnhance.<span class="hljs-property">ConnectResult</span>): <span class="hljs-function"><span class="hljs-params">void</span> =&gt;</span> {</li><li>    hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'clientConnectResultCallback result = '</span> + result.<span class="hljs-property">success</span>);</li><li>    <span class="hljs-keyword">if</span> (result.<span class="hljs-property">success</span>) {</li><li>      <span class="hljs-keyword">let</span> len = <span class="hljs-number">1</span>;</li><li>      <span class="hljs-keyword">let</span> arraybuffer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayBuffer</span>(len); <span class="hljs-comment">// 创建需要发送的数据</span></li><li>      connection.<span class="hljs-title function_">sendData</span>(arraybuffer);</li><li>      hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">"sendData data connection peerDeviceId=%{public}s"</span> + connection.<span class="hljs-title function_">getPeerDeviceId</span>());</li><li>      connection.<span class="hljs-title function_">disconnect</span>();</li><li>    }</li><li>  });</li><li>  connection.<span class="hljs-title function_">connect</span>();</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>  hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> +</li><li>  (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="onconnectresult" device-type="phone,2in1,tablet,wearable">on('connectResult')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onconnectresult" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">Wearable</span></div><p>on(type: 'connectResult', callback: Callback&lt;ConnectResult&gt;): void</p>     <p>注册connect事件的回调监听，通过回调函数获取连接结果。使用callback进行异步回调。</p>     <p><strong>需要权限</strong>：ohos.permission.DISTRIBUTED_DATASYNC</p>     <p><strong>系统能力</strong>：SystemCapability.DistributedSched.AppCollaboration</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.21.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.21.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.21.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.21.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">事件回调类型，支持的事件为'connectResult'，完成connect()调用，触发该事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-link-enhance#connectresult">ConnectResult</a>&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">注册的回调函数。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-link-enhance">增强连接错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.21.10.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.21.10.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">32390206</td>         <td class="cellrowborder" width="50%">Invalid parameter.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-qxc-c106="" class="highlight-div"><div _ngcontent-qxc-c106="" class="highlight-div-header"><div _ngcontent-qxc-c106="" class="highlight-div-header-left"><div _ngcontent-qxc-c106="" class="handle-button expand-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-qxc-c106="" class="highlight-div-header-right"><div _ngcontent-qxc-c106="" class="handle-button ai-button"></div><div _ngcontent-qxc-c106="" class="handle-button line-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-qxc-c106="" class="handle-button theme-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-qxc-c106="" class="handle-button copy-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-qxc-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { linkEnhance } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.DistributedServiceKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li>
</li><li><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">TAG</span> = <span class="hljs-string">"testDemo"</span>;</li><li>
</li><li><span class="hljs-keyword">try</span> {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">peerDeviceId</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">"00:11:22:33:44:55"</span>;</li><li>  hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'connection sever deviceId = '</span> + peerDeviceId);</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">connection</span>: linkEnhance.<span class="hljs-property">Connection</span> = linkEnhance.<span class="hljs-title function_">createConnection</span>(peerDeviceId, <span class="hljs-string">"demo"</span>);</li><li>  <span class="hljs-comment">// 订阅连接结果</span></li><li>  connection.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connectResult'</span>, (<span class="hljs-attr">result</span>: linkEnhance.<span class="hljs-property">ConnectResult</span>): <span class="hljs-function"><span class="hljs-params">void</span> =&gt;</span> {</li><li>    hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'clientConnectResultCallback result = '</span> + result.<span class="hljs-property">success</span>);</li><li>  });</li><li>
</li><li>  <span class="hljs-comment">// 发起连接</span></li><li>  connection.<span class="hljs-title function_">connect</span>();</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>  hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> +</li><li>  (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="offconnectresult" device-type="phone,2in1,tablet,wearable">off('connectResult')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="offconnectresult" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">Wearable</span></div><p>off(type: 'connectResult', callback?: Callback&lt;ConnectResult&gt;): void</p>     <p>取消connect事件的回调监听，使用callback异步回调。</p>     <p><strong>需要权限</strong>：ohos.permission.DISTRIBUTED_DATASYNC</p>     <p><strong>系统能力</strong>：SystemCapability.DistributedSched.AppCollaboration</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.22.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.22.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.22.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.22.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">事件回调类型，支持的事件为'connectResult'，完成connect()调用，触发该事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-link-enhance#connectresult">ConnectResult</a>&gt;</td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">注册的回调函数。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-link-enhance">增强连接错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.22.10.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.22.10.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">32390206</td>         <td class="cellrowborder" width="50%">Invalid parameter.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-qxc-c106="" class="highlight-div"><div _ngcontent-qxc-c106="" class="highlight-div-header"><div _ngcontent-qxc-c106="" class="highlight-div-header-left"><div _ngcontent-qxc-c106="" class="handle-button expand-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-qxc-c106="" class="highlight-div-header-right"><div _ngcontent-qxc-c106="" class="handle-button ai-button"></div><div _ngcontent-qxc-c106="" class="handle-button line-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-qxc-c106="" class="handle-button theme-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-qxc-c106="" class="handle-button copy-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-qxc-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { linkEnhance } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.DistributedServiceKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li>
</li><li><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">TAG</span> = <span class="hljs-string">"testDemo"</span>;</li><li>
</li><li><span class="hljs-keyword">try</span> {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">peerDeviceId</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">"00:11:22:33:44:55"</span>;</li><li>  hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'connection sever deviceId = '</span> + peerDeviceId);</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">connection</span>: linkEnhance.<span class="hljs-property">Connection</span> = linkEnhance.<span class="hljs-title function_">createConnection</span>(peerDeviceId, <span class="hljs-string">"demo"</span>);</li><li>  connection.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connectResult'</span>, (<span class="hljs-attr">result</span>: linkEnhance.<span class="hljs-property">ConnectResult</span>): <span class="hljs-function"><span class="hljs-params">void</span> =&gt;</span> {</li><li>    hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'clientConnectResultCallback result = '</span> + result.<span class="hljs-property">success</span>);</li><li>  });</li><li>  <span class="hljs-comment">// 取消订阅连接结果</span></li><li>  connection.<span class="hljs-title function_">off</span>(<span class="hljs-string">'connectResult'</span>, (<span class="hljs-attr">result</span>: linkEnhance.<span class="hljs-property">ConnectResult</span>): <span class="hljs-function"><span class="hljs-params">void</span> =&gt;</span> {</li><li>    hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'clientConnectResultCallback result = '</span> + result.<span class="hljs-property">success</span>);</li><li>  });</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>  hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> +</li><li>  (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="ondisconnected" device-type="phone,2in1,tablet,wearable">on('disconnected')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="ondisconnected" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">Wearable</span></div><p>on(type: 'disconnected', callback: Callback&lt;number&gt;): void</p>     <p>注册disconnected事件的回调监听，连接被动断开或者底层异常断开时触发该事件。使用callback异步回调。</p>     <p><strong>需要权限</strong>：ohos.permission.DISTRIBUTED_DATASYNC</p>     <p><strong>系统能力</strong>：SystemCapability.DistributedSched.AppCollaboration</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.23.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.23.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.23.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.23.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">事件回调类型，支持的事件为'disconnected'，连接被动断开或底层异常断开时，触发该事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;number&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">注册的回调函数，number为返回的错误码。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-link-enhance">增强连接错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.23.10.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.23.10.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">32390206</td>         <td class="cellrowborder" width="50%">Invalid parameter.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-qxc-c106="" class="highlight-div"><div _ngcontent-qxc-c106="" class="highlight-div-header"><div _ngcontent-qxc-c106="" class="highlight-div-header-left"><div _ngcontent-qxc-c106="" class="handle-button expand-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-qxc-c106="" class="highlight-div-header-right"><div _ngcontent-qxc-c106="" class="handle-button ai-button"></div><div _ngcontent-qxc-c106="" class="handle-button line-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-qxc-c106="" class="handle-button theme-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-qxc-c106="" class="handle-button copy-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-qxc-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { linkEnhance } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.DistributedServiceKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li>
</li><li><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">TAG</span> = <span class="hljs-string">"testDemo"</span>;</li><li>
</li><li><span class="hljs-keyword">try</span> {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">peerDeviceId</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">"00:11:22:33:44:55"</span>;</li><li>  hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'connection sever deviceId = '</span> + peerDeviceId);</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">connection</span>: linkEnhance.<span class="hljs-property">Connection</span> = linkEnhance.<span class="hljs-title function_">createConnection</span>(peerDeviceId, <span class="hljs-string">"demo"</span>);</li><li>  <span class="hljs-comment">// 订阅断连通知</span></li><li>  connection.<span class="hljs-title function_">on</span>(<span class="hljs-string">'disconnected'</span>, <span class="hljs-function">(<span class="hljs-params"><span class="hljs-built_in">number</span>: <span class="hljs-built_in">number</span></span>) =&gt;</span> {</li><li>    hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'connection disconnected reason = '</span> + <span class="hljs-built_in">number</span>);</li><li>  });</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>  hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> +</li><li>  (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="offdisconnected" device-type="phone,2in1,tablet,wearable">off('disconnected')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="offdisconnected" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">Wearable</span></div><p>off(type: 'disconnected', callback?: Callback&lt;number&gt;): void</p>     <p>取消注册disconnected事件的回调监听。连接被动断开或底层异常断开时触发该事件，使用callback异步回调。</p>     <p><strong>需要权限</strong>：ohos.permission.DISTRIBUTED_DATASYNC</p>     <p><strong>系统能力</strong>：SystemCapability.DistributedSched.AppCollaboration</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.24.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.24.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.24.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.24.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">事件回调类型，支持的事件为'disconnected'，连接被动断开或底层异常断开时，触发该事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;number&gt;</td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">注册的回调函数。number为返回的错误码。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-link-enhance">增强连接错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.24.10.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.24.10.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">32390206</td>         <td class="cellrowborder" width="50%">Invalid parameter.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-qxc-c106="" class="highlight-div"><div _ngcontent-qxc-c106="" class="highlight-div-header"><div _ngcontent-qxc-c106="" class="highlight-div-header-left"><div _ngcontent-qxc-c106="" class="handle-button expand-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-qxc-c106="" class="highlight-div-header-right"><div _ngcontent-qxc-c106="" class="handle-button ai-button"></div><div _ngcontent-qxc-c106="" class="handle-button line-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-qxc-c106="" class="handle-button theme-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-qxc-c106="" class="handle-button copy-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-qxc-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { linkEnhance } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.DistributedServiceKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li>
</li><li><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">TAG</span> = <span class="hljs-string">"testDemo"</span>;</li><li>
</li><li><span class="hljs-keyword">try</span> {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">peerDeviceId</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">"00:11:22:33:44:55"</span>;</li><li>  hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'connection sever deviceId = '</span> + peerDeviceId);</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">connection</span>: linkEnhance.<span class="hljs-property">Connection</span> = linkEnhance.<span class="hljs-title function_">createConnection</span>(peerDeviceId, <span class="hljs-string">"demo"</span>);</li><li>  connection.<span class="hljs-title function_">on</span>(<span class="hljs-string">'disconnected'</span>, <span class="hljs-function">(<span class="hljs-params"><span class="hljs-built_in">number</span>: <span class="hljs-built_in">number</span></span>) =&gt;</span> {</li><li>    hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'connection disconnected reason = '</span> + <span class="hljs-built_in">number</span>);</li><li>  });</li><li>  <span class="hljs-comment">// 取消订阅断连通知</span></li><li>  connection.<span class="hljs-title function_">off</span>(<span class="hljs-string">'disconnected'</span>, <span class="hljs-function">(<span class="hljs-params"><span class="hljs-built_in">number</span>: <span class="hljs-built_in">number</span></span>) =&gt;</span> {</li><li>    hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'connection disconnected reason = '</span> + <span class="hljs-built_in">number</span>);</li><li>  });</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>  hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> +</li><li>  (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="ondatareceived" device-type="phone,2in1,tablet,wearable">on('dataReceived')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="ondatareceived" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">Wearable</span></div><p>on(type: 'dataReceived', callback: Callback&lt;ArrayBuffer&gt;): void</p>     <p>注册dataReceived事件的回调监听。使用callback异步回调。</p>     <p><strong>需要权限</strong>：ohos.permission.DISTRIBUTED_DATASYNC</p>     <p><strong>系统能力</strong>：SystemCapability.DistributedSched.AppCollaboration</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.25.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.25.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.25.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.25.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">事件回调类型，支持的事件为'dataReceived'，收到数据时，触发该事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arraybuffer-object" target="_blank">ArrayBuffer</a>&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">注册的回调函数。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-link-enhance">增强连接错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.25.10.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.25.10.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">32390206</td>         <td class="cellrowborder" width="50%">Invalid parameter.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-qxc-c106="" class="highlight-div"><div _ngcontent-qxc-c106="" class="highlight-div-header"><div _ngcontent-qxc-c106="" class="highlight-div-header-left"><div _ngcontent-qxc-c106="" class="handle-button expand-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-qxc-c106="" class="highlight-div-header-right"><div _ngcontent-qxc-c106="" class="handle-button ai-button"></div><div _ngcontent-qxc-c106="" class="handle-button line-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-qxc-c106="" class="handle-button theme-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-qxc-c106="" class="handle-button copy-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-qxc-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { linkEnhance } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.DistributedServiceKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li>
</li><li><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">TAG</span> = <span class="hljs-string">"testDemo"</span>;</li><li>
</li><li><span class="hljs-keyword">try</span> {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">peerDeviceId</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">"00:11:22:33:44:55"</span>;</li><li>  hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'connection sever deviceId = '</span> + peerDeviceId);</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">connection</span>: linkEnhance.<span class="hljs-property">Connection</span> = linkEnhance.<span class="hljs-title function_">createConnection</span>(peerDeviceId, <span class="hljs-string">"demo"</span>);</li><li>  connection.<span class="hljs-title function_">connect</span>();</li><li>  connection.<span class="hljs-title function_">on</span>(<span class="hljs-string">'dataReceived'</span>, <span class="hljs-function">(<span class="hljs-params">data: <span class="hljs-built_in">ArrayBuffer</span></span>) =&gt;</span> {</li><li>    hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'recv dataLen = '</span> + data.<span class="hljs-property">byteLength</span>);</li><li>  });</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>  hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> +</li><li>  (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="offdatareceived" device-type="phone,2in1,tablet,wearable">off('dataReceived')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="offdatareceived" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">Wearable</span></div><p>off(type: 'dataReceived', callback?: Callback&lt;ArrayBuffer&gt;): void</p>     <p>取消dataReceived事件的回调监听，使用callback异步回调。</p>     <p><strong>需要权限</strong>：ohos.permission.DISTRIBUTED_DATASYNC</p>     <p><strong>系统能力</strong>：SystemCapability.DistributedSched.AppCollaboration</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.26.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.26.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.26.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.26.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">事件回调类型，支持的事件为'dataReceived'，收到数据时，触发该事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arraybuffer-object" target="_blank">ArrayBuffer</a>&gt;</td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">注册的回调函数。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-link-enhance">增强连接错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.26.10.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.26.10.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">32390206</td>         <td class="cellrowborder" width="50%">Invalid parameter.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-qxc-c106="" class="highlight-div"><div _ngcontent-qxc-c106="" class="highlight-div-header"><div _ngcontent-qxc-c106="" class="highlight-div-header-left"><div _ngcontent-qxc-c106="" class="handle-button expand-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-qxc-c106="" class="highlight-div-header-right"><div _ngcontent-qxc-c106="" class="handle-button ai-button"></div><div _ngcontent-qxc-c106="" class="handle-button line-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-qxc-c106="" class="handle-button theme-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-qxc-c106="" class="handle-button copy-button"><div _ngcontent-qxc-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-qxc-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { linkEnhance } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.DistributedServiceKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li>
</li><li><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">TAG</span> = <span class="hljs-string">"testDemo"</span>;</li><li>
</li><li><span class="hljs-keyword">try</span> {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">peerDeviceId</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">"00:11:22:33:44:55"</span>;</li><li>  hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'connection sever deviceId = '</span> + peerDeviceId);</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">connection</span>: linkEnhance.<span class="hljs-property">Connection</span> = linkEnhance.<span class="hljs-title function_">createConnection</span>(peerDeviceId, <span class="hljs-string">"demo"</span>);</li><li>  connection.<span class="hljs-title function_">on</span>(<span class="hljs-string">'dataReceived'</span>, <span class="hljs-function">(<span class="hljs-params">data: <span class="hljs-built_in">ArrayBuffer</span></span>) =&gt;</span> {</li><li>    hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'recv dataLen = '</span> + data.<span class="hljs-property">byteLength</span>);</li><li>  });</li><li>  connection.<span class="hljs-title function_">off</span>(<span class="hljs-string">'dataReceived'</span>, <span class="hljs-function">(<span class="hljs-params">data: <span class="hljs-built_in">ArrayBuffer</span></span>) =&gt;</span> {</li><li>    hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'recv dataLen = '</span> + data.<span class="hljs-property">byteLength</span>);</li><li>  });</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>  hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> +</li><li>  (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>    </div>   </div>   <div></div></div>