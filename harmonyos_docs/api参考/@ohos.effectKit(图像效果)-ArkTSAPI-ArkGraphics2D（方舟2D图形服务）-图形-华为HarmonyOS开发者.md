<h1 _ngcontent-xgu-c119="" class="doc-title ng-star-inserted" title="@ohos.effectKit (图像效果)"> @ohos.effectKit (图像效果) </h1>

<div _ngcontent-xgu-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p>图像效果模块提供了处理图像的基础能力，包括亮度调节、模糊化、灰度调节和智能取色等。effectKit用于离线处理图像（如pixelmap、png、jpeg）以获得视觉效果，而uiEffect则实时接入渲染服务，针对屏幕帧缓存进行处理以获得动态视觉效果。</p>    <p>该模块提供以下图像效果相关的常用功能：</p>    <ul>     <li><a href="/consumer/cn/doc/harmonyos-references/js-apis-effectkit#filter">Filter</a>：效果类，用于添加指定效果到图像源。</li>     <li><a href="/consumer/cn/doc/harmonyos-references/js-apis-effectkit#color">Color</a>：颜色类，用于保存取色的结果。</li>     <li><a href="/consumer/cn/doc/harmonyos-references/js-apis-effectkit#colorpicker">ColorPicker</a>：智能取色器。</li>    </ul>    <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">      <p>本模块首批接口从API version 9开始支持。后续版本的新增接口，采用上角标单独标记接口的起始版本。</p>     </div></div></div>    <div class="tiledSection">     <h2 id="导入模块" device-type="phone,2in1,tablet,wearable,tv">导入模块<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="导入模块" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><div _ngcontent-xgu-c106="" class="highlight-div"><div _ngcontent-xgu-c106="" class="highlight-div-header"><div _ngcontent-xgu-c106="" class="highlight-div-header-left"><div _ngcontent-xgu-c106="" class="handle-button expand-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xgu-c106="" class="highlight-div-header-right"><div _ngcontent-xgu-c106="" class="handle-button ai-button"></div><div _ngcontent-xgu-c106="" class="handle-button line-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xgu-c106="" class="handle-button theme-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xgu-c106="" class="handle-button copy-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xgu-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { effectKit } <span class="hljs-keyword">from</span> <span class="hljs-string">"@kit.ArkGraphics2D"</span>;</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="effectkitcreateeffect" device-type="phone,2in1,tablet,wearable,tv">effectKit.createEffect<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="effectkitcreateeffect" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>createEffect(source: image.PixelMap): Filter</p>     <p>通过传入的PixelMap创建Filter实例。</p>     <p><strong>卡片能力：</strong> 从API version 12开始，该接口支持在ArkTS卡片中使用。</p>     <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力：</strong> SystemCapability.Multimedia.Image.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.6.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.6.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.6.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.6.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">source</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-image-pixelmap">image.PixelMap</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">image模块创建的PixelMap实例。可通过图片解码或直接创建获得，具体可见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/image-overview" target="_blank">Image Kit简介</a>。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.6.10.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.6.10.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-effectkit#filter">Filter</a></td>         <td class="cellrowborder" width="50%">返回不带任何效果的Filter链表头节点，失败时返回null。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-xgu-c106="" class="highlight-div"><div _ngcontent-xgu-c106="" class="highlight-div-header"><div _ngcontent-xgu-c106="" class="highlight-div-header-left"><div _ngcontent-xgu-c106="" class="handle-button expand-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xgu-c106="" class="highlight-div-header-right"><div _ngcontent-xgu-c106="" class="handle-button ai-button"></div><div _ngcontent-xgu-c106="" class="handle-button line-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xgu-c106="" class="handle-button theme-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xgu-c106="" class="handle-button copy-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xgu-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { image } <span class="hljs-keyword">from</span> <span class="hljs-string">"@kit.ImageKit"</span>;</li><li><span class="hljs-keyword">import</span> { effectKit } <span class="hljs-keyword">from</span> <span class="hljs-string">"@kit.ArkGraphics2D"</span>;</li><li>
</li><li><span class="hljs-keyword">const</span> color = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayBuffer</span>(<span class="hljs-number">96</span>);</li><li><span class="hljs-keyword">let</span> opts : image.<span class="hljs-property">InitializationOptions</span> = {</li><li>  <span class="hljs-attr">editable</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-attr">pixelFormat</span>: <span class="hljs-number">3</span>,</li><li>  <span class="hljs-attr">size</span>: {</li><li>    <span class="hljs-attr">height</span>: <span class="hljs-number">4</span>,</li><li>    <span class="hljs-attr">width</span>: <span class="hljs-number">6</span></li><li>  }</li><li>}</li><li>image.<span class="hljs-title function_">createPixelMap</span>(color, opts).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">pixelMap</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">let</span> headFilter = effectKit.<span class="hljs-title function_">createEffect</span>(pixelMap);</li><li>})</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="effectkitcreatecolorpicker" device-type="phone,2in1,tablet,wearable,tv">effectKit.createColorPicker<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="effectkitcreatecolorpicker" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>createColorPicker(source: image.PixelMap): Promise&lt;ColorPicker&gt;</p>     <p>通过传入的PixelMap创建ColorPicker实例，使用Promise异步回调。</p>     <p><strong>卡片能力：</strong> 从API version 12开始，该接口支持在ArkTS卡片中使用。</p>     <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力：</strong> SystemCapability.Multimedia.Image.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.7.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.7.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.7.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.7.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">source</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-image-pixelmap">image.PixelMap</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">image模块创建的PixelMap实例。可通过图片解码或直接创建获得，具体可见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/image-overview" target="_blank">Image Kit简介</a>。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.7.10.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.7.10.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-effectkit#colorpicker">ColorPicker</a>&gt;</td>         <td class="cellrowborder" width="50%">Promise对象。返回创建的ColorPicker实例。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.7.13.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.7.13.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Input parameter error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-xgu-c106="" class="highlight-div"><div _ngcontent-xgu-c106="" class="highlight-div-header"><div _ngcontent-xgu-c106="" class="highlight-div-header-left"><div _ngcontent-xgu-c106="" class="handle-button expand-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xgu-c106="" class="highlight-div-header-right"><div _ngcontent-xgu-c106="" class="handle-button ai-button"></div><div _ngcontent-xgu-c106="" class="handle-button line-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xgu-c106="" class="handle-button theme-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xgu-c106="" class="handle-button copy-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xgu-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { image } <span class="hljs-keyword">from</span> <span class="hljs-string">"@kit.ImageKit"</span>;</li><li><span class="hljs-keyword">import</span> { effectKit } <span class="hljs-keyword">from</span> <span class="hljs-string">"@kit.ArkGraphics2D"</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@kit.BasicServicesKit"</span>;</li><li>
</li><li><span class="hljs-keyword">const</span> color = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayBuffer</span>(<span class="hljs-number">96</span>);</li><li><span class="hljs-keyword">let</span> opts : image.<span class="hljs-property">InitializationOptions</span> = {</li><li>  <span class="hljs-attr">editable</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-attr">pixelFormat</span>: <span class="hljs-number">3</span>,</li><li>  <span class="hljs-attr">size</span>: {</li><li>    <span class="hljs-attr">height</span>: <span class="hljs-number">4</span>,</li><li>    <span class="hljs-attr">width</span>: <span class="hljs-number">6</span></li><li>  }</li><li>}</li><li>
</li><li>image.<span class="hljs-title function_">createPixelMap</span>(color, opts).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">pixelMap</span>) =&gt;</span> {</li><li>  effectKit.<span class="hljs-title function_">createColorPicker</span>(pixelMap).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">colorPicker</span> =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"color picker="</span> + colorPicker);</li><li>  }).<span class="hljs-title function_">catch</span>( <span class="hljs-function">(<span class="hljs-params">reason : BusinessError</span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"error="</span> + reason.<span class="hljs-property">message</span>);</li><li>  })</li><li>})</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="effectkitcreatecolorpicker10" device-type="phone,2in1,tablet,wearable,tv">effectKit.createColorPicker<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="effectkitcreatecolorpicker10" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>createColorPicker(source: image.PixelMap, region: Array&lt;number&gt;): Promise&lt;ColorPicker&gt;</p>     <p>通过传入的PixelMap创建选定取色区域的ColorPicker实例，使用Promise异步回调。</p>     <p><strong>卡片能力：</strong> 从API version 12开始，该接口支持在ArkTS卡片中使用。</p>     <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力：</strong> SystemCapability.Multimedia.Image.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.8.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.8.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.8.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.8.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">source</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-image-pixelmap">image.PixelMap</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">image模块创建的PixelMap实例。可通过图片解码或直接创建获得，具体可见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/image-overview" target="_blank">Image Kit简介</a>。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">region</td>         <td class="cellrowborder" width="25%">Array&lt;number&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">          <p>指定图片的取色区域。</p>          <p>数组元素个数为4，取值范围为[0, 1]，分别表示图片区域的左、上、右、下位置，图片最左侧和最上侧对应位置0，最右侧和最下侧对应位置1。数组第三个元素需大于第一个元素，第四个元素需大于第二个元素。</p></td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.8.10.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.8.10.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-effectkit#colorpicker">ColorPicker</a>&gt;</td>         <td class="cellrowborder" width="50%">Promise对象。返回创建的ColorPicker实例。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.8.13.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.8.13.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Input parameter error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-xgu-c106="" class="highlight-div"><div _ngcontent-xgu-c106="" class="highlight-div-header"><div _ngcontent-xgu-c106="" class="highlight-div-header-left"><div _ngcontent-xgu-c106="" class="handle-button expand-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xgu-c106="" class="highlight-div-header-right"><div _ngcontent-xgu-c106="" class="handle-button ai-button"></div><div _ngcontent-xgu-c106="" class="handle-button line-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xgu-c106="" class="handle-button theme-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xgu-c106="" class="handle-button copy-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xgu-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { image } <span class="hljs-keyword">from</span> <span class="hljs-string">"@kit.ImageKit"</span>;</li><li><span class="hljs-keyword">import</span> { effectKit } <span class="hljs-keyword">from</span> <span class="hljs-string">"@kit.ArkGraphics2D"</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@kit.BasicServicesKit"</span>;</li><li>
</li><li><span class="hljs-keyword">const</span> color = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayBuffer</span>(<span class="hljs-number">96</span>);</li><li><span class="hljs-keyword">let</span> opts : image.<span class="hljs-property">InitializationOptions</span> = {</li><li>  <span class="hljs-attr">editable</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-attr">pixelFormat</span>: <span class="hljs-number">3</span>,</li><li>  <span class="hljs-attr">size</span>: {</li><li>    <span class="hljs-attr">height</span>: <span class="hljs-number">4</span>,</li><li>    <span class="hljs-attr">width</span>: <span class="hljs-number">6</span></li><li>  }</li><li>}</li><li>
</li><li>image.<span class="hljs-title function_">createPixelMap</span>(color, opts).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">pixelMap</span>) =&gt;</span> {</li><li>  effectKit.<span class="hljs-title function_">createColorPicker</span>(pixelMap, [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>]).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">colorPicker</span> =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"color picker="</span> + colorPicker);</li><li>  }).<span class="hljs-title function_">catch</span>( <span class="hljs-function">(<span class="hljs-params">reason : BusinessError</span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"error="</span> + reason.<span class="hljs-property">message</span>);</li><li>  })</li><li>})</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="effectkitcreatecolorpicker-1" device-type="phone,2in1,tablet,wearable,tv">effectKit.createColorPicker<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="effectkitcreatecolorpicker-1" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>createColorPicker(source: image.PixelMap, callback: AsyncCallback&lt;ColorPicker&gt;): void</p>     <p>通过传入的PixelMap创建ColorPicker实例，使用callback异步回调。</p>     <p><strong>卡片能力：</strong> 从API version 12开始，该接口支持在ArkTS卡片中使用。</p>     <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力：</strong> SystemCapability.Multimedia.Image.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.9.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.9.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.9.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.9.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">source</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-image-pixelmap">image.PixelMap</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">image模块创建的PixelMap实例。可通过图片解码或直接创建获得，具体可见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/image-overview" target="_blank">Image Kit简介</a>。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-effectkit#colorpicker">ColorPicker</a>&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。返回创建的ColorPicker实例。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.9.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.9.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Input parameter error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-xgu-c106="" class="highlight-div"><div _ngcontent-xgu-c106="" class="highlight-div-header"><div _ngcontent-xgu-c106="" class="highlight-div-header-left"><div _ngcontent-xgu-c106="" class="handle-button expand-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xgu-c106="" class="highlight-div-header-right"><div _ngcontent-xgu-c106="" class="handle-button ai-button"></div><div _ngcontent-xgu-c106="" class="handle-button line-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xgu-c106="" class="handle-button theme-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xgu-c106="" class="handle-button copy-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xgu-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { image } <span class="hljs-keyword">from</span> <span class="hljs-string">"@kit.ImageKit"</span>;</li><li><span class="hljs-keyword">import</span> { effectKit } <span class="hljs-keyword">from</span> <span class="hljs-string">"@kit.ArkGraphics2D"</span>;</li><li>
</li><li><span class="hljs-keyword">const</span> color = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayBuffer</span>(<span class="hljs-number">96</span>);</li><li><span class="hljs-keyword">let</span> opts : image.<span class="hljs-property">InitializationOptions</span> = {</li><li>  <span class="hljs-attr">editable</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-attr">pixelFormat</span>: <span class="hljs-number">3</span>,</li><li>  <span class="hljs-attr">size</span>: {</li><li>    <span class="hljs-attr">height</span>: <span class="hljs-number">4</span>,</li><li>    <span class="hljs-attr">width</span>: <span class="hljs-number">6</span></li><li>  }</li><li>}</li><li>image.<span class="hljs-title function_">createPixelMap</span>(color, opts).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">pixelMap</span>) =&gt;</span> {</li><li>  effectKit.<span class="hljs-title function_">createColorPicker</span>(pixelMap, <span class="hljs-function">(<span class="hljs-params">error, colorPicker</span>) =&gt;</span> {</li><li>    <span class="hljs-keyword">if</span> (error) {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'Failed to create color picker.'</span>);</li><li>    } <span class="hljs-keyword">else</span> {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Succeeded in creating color picker.'</span>);</li><li>    }</li><li>  })</li><li>})</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="effectkitcreatecolorpicker10-1" device-type="phone,2in1,tablet,wearable,tv">effectKit.createColorPicker<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="effectkitcreatecolorpicker10-1" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>createColorPicker(source: image.PixelMap, region:Array&lt;number&gt;, callback: AsyncCallback&lt;ColorPicker&gt;): void</p>     <p>通过传入的PixelMap创建选定取色区域的ColorPicker实例，使用callback异步回调。</p>     <p><strong>卡片能力：</strong> 从API version 12开始，该接口支持在ArkTS卡片中使用。</p>     <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力：</strong> SystemCapability.Multimedia.Image.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.10.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.10.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.10.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.10.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">source</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-image-pixelmap">image.PixelMap</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">image模块创建的PixelMap实例。可通过图片解码或直接创建获得，具体可见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/image-overview" target="_blank">Image Kit简介</a>。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">region</td>         <td class="cellrowborder" width="25%">Array&lt;number&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">          <p>指定图片的取色区域。</p>          <p>数组元素个数为4，取值范围为[0, 1]，数组元素分别表示图片区域的左、上、右、下位置，图片最左侧和最上侧对应位置0，最右侧和最下侧对应位置1。数组第三个元素需大于第一个元素，第四个元素需大于第二个元素。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-effectkit#colorpicker">ColorPicker</a>&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。返回创建的ColorPicker实例。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.10.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.10.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Input parameter error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-xgu-c106="" class="highlight-div"><div _ngcontent-xgu-c106="" class="highlight-div-header"><div _ngcontent-xgu-c106="" class="highlight-div-header-left"><div _ngcontent-xgu-c106="" class="handle-button expand-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xgu-c106="" class="highlight-div-header-right"><div _ngcontent-xgu-c106="" class="handle-button ai-button"></div><div _ngcontent-xgu-c106="" class="handle-button line-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xgu-c106="" class="handle-button theme-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xgu-c106="" class="handle-button copy-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xgu-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { image } <span class="hljs-keyword">from</span> <span class="hljs-string">"@kit.ImageKit"</span>;</li><li><span class="hljs-keyword">import</span> { effectKit } <span class="hljs-keyword">from</span> <span class="hljs-string">"@kit.ArkGraphics2D"</span>;</li><li>
</li><li><span class="hljs-keyword">const</span> color = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayBuffer</span>(<span class="hljs-number">96</span>);</li><li><span class="hljs-keyword">let</span> opts : image.<span class="hljs-property">InitializationOptions</span> = {</li><li>  <span class="hljs-attr">editable</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-attr">pixelFormat</span>: <span class="hljs-number">3</span>,</li><li>  <span class="hljs-attr">size</span>: {</li><li>    <span class="hljs-attr">height</span>: <span class="hljs-number">4</span>,</li><li>    <span class="hljs-attr">width</span>: <span class="hljs-number">6</span></li><li>  }</li><li>}</li><li>image.<span class="hljs-title function_">createPixelMap</span>(color, opts).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">pixelMap</span>) =&gt;</span> {</li><li>  effectKit.<span class="hljs-title function_">createColorPicker</span>(pixelMap, [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>], <span class="hljs-function">(<span class="hljs-params">error, colorPicker</span>) =&gt;</span> {</li><li>    <span class="hljs-keyword">if</span> (error) {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'Failed to create color picker.'</span>);</li><li>    } <span class="hljs-keyword">else</span> {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Succeeded in creating color picker.'</span>);</li><li>    }</li><li>  })</li><li>})</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="color" device-type="phone,2in1,tablet,wearable,tv">Color<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="color" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>颜色类，用于保存取色的结果。</p>     <p><strong>卡片能力：</strong> 从API version 12开始，该接口支持在ArkTS卡片中使用。</p>     <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力：</strong> SystemCapability.Multimedia.Image.Core</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.11.6.1.6.1.1" width="20%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.11.6.1.6.1.2" width="20%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.11.6.1.6.1.3" width="20%">只读</th>         <th align="left" class="cellrowborder" id="mcps1.3.11.6.1.6.1.4" width="20%">可选</th>         <th align="left" class="cellrowborder" id="mcps1.3.11.6.1.6.1.5" width="20%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">red</td>         <td class="cellrowborder" width="20%">number</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">红色分量值，取值范围[0x0, 0xFF]。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">green</td>         <td class="cellrowborder" width="20%">number</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">绿色分量值，取值范围[0x0, 0xFF]。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">blue</td>         <td class="cellrowborder" width="20%">number</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">蓝色分量值，取值范围[0x0, 0xFF]。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">alpha</td>         <td class="cellrowborder" width="20%">number</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">透明通道分量值，取值范围[0x0, 0xFF]。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="tilemode14" device-type="phone,2in1,tablet,wearable,tv">TileMode<sup>14+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="tilemode14" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>着色器效果平铺模式的枚举。</p>     <p><strong>系统能力：</strong> SystemCapability.Multimedia.Image.Core</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.12.4.1.4.1.1" width="33.33333333333333%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.12.4.1.4.1.2" width="33.33333333333333%">值</th>         <th align="left" class="cellrowborder" id="mcps1.3.12.4.1.4.1.3" width="33.33333333333333%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="33.33333333333333%">CLAMP</td>         <td class="cellrowborder" width="33.33333333333333%">0</td>         <td class="cellrowborder" width="33.33333333333333%">如果着色器效果超出其原始边界，剩余区域使用着色器的边缘颜色填充。</td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">REPEAT</td>         <td class="cellrowborder" width="33.33333333333333%">1</td>         <td class="cellrowborder" width="33.33333333333333%">在水平和垂直方向上重复着色器效果。</td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">MIRROR</td>         <td class="cellrowborder" width="33.33333333333333%">2</td>         <td class="cellrowborder" width="33.33333333333333%">在水平和垂直方向上重复着色器效果，交替镜像图像，以便相邻图像始终接合。</td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">DECAL</td>         <td class="cellrowborder" width="33.33333333333333%">3</td>         <td class="cellrowborder" width="33.33333333333333%">仅在其原始边界内渲染着色器效果。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="colorpicker" device-type="phone,2in1,tablet,wearable,tv">ColorPicker<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="colorpicker" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>取色类，用于从一张图像数据中获取它的主要颜色。在调用ColorPicker的方法前，需要先通过<a href="/consumer/cn/doc/harmonyos-references/js-apis-effectkit#effectkitcreatecolorpicker">createColorPicker</a>创建一个ColorPicker实例。</p>    </div>    <div class="tiledSection">     <h3 id="getmaincolor" device-type="phone,2in1,tablet,wearable,tv" class="firsth2">getMainColor<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getmaincolor" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>getMainColor(): Promise&lt;Color&gt;</p>     <p>读取图像主色的颜色值，结果写入<a href="/consumer/cn/doc/harmonyos-references/js-apis-effectkit#color">Color</a>里，使用Promise异步回调。该接口通过图像缩放算法，根据周围像素的加权计算，将原图缩小到1个像素以得到主色。</p>     <p><strong>卡片能力：</strong> 从API version 12开始，该接口支持在ArkTS卡片中使用。</p>     <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力：</strong> SystemCapability.Multimedia.Image.Core</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.14.8.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.14.8.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-effectkit#color">Color</a>&gt;</td>         <td class="cellrowborder" width="50%">Promise对象。返回图像主色对应的颜色值，失败时返回错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-xgu-c106="" class="highlight-div"><div _ngcontent-xgu-c106="" class="highlight-div-header"><div _ngcontent-xgu-c106="" class="highlight-div-header-left"><div _ngcontent-xgu-c106="" class="handle-button expand-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xgu-c106="" class="highlight-div-header-right"><div _ngcontent-xgu-c106="" class="handle-button ai-button"></div><div _ngcontent-xgu-c106="" class="handle-button line-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xgu-c106="" class="handle-button theme-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xgu-c106="" class="handle-button copy-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xgu-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { image } <span class="hljs-keyword">from</span> <span class="hljs-string">"@kit.ImageKit"</span>;</li><li><span class="hljs-keyword">import</span> { effectKit } <span class="hljs-keyword">from</span> <span class="hljs-string">"@kit.ArkGraphics2D"</span>;</li><li>
</li><li><span class="hljs-keyword">const</span> color = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayBuffer</span>(<span class="hljs-number">96</span>);</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">opts</span>: image.<span class="hljs-property">InitializationOptions</span> = {</li><li>  <span class="hljs-attr">editable</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-attr">pixelFormat</span>: <span class="hljs-number">3</span>,</li><li>  <span class="hljs-attr">size</span>: {</li><li>    <span class="hljs-attr">height</span>: <span class="hljs-number">4</span>,</li><li>    <span class="hljs-attr">width</span>: <span class="hljs-number">6</span></li><li>  }</li><li>}</li><li>image.<span class="hljs-title function_">createPixelMap</span>(color, opts).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">pixelMap</span>) =&gt;</span> {</li><li>  effectKit.<span class="hljs-title function_">createColorPicker</span>(pixelMap, <span class="hljs-function">(<span class="hljs-params">error, colorPicker</span>) =&gt;</span> {</li><li>    <span class="hljs-keyword">if</span> (error) {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'Failed to create color picker.'</span>);</li><li>     } <span class="hljs-keyword">else</span> {</li><li>       <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Succeeded in creating color picker.'</span>);</li><li>       colorPicker.<span class="hljs-title function_">getMainColor</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">color</span> =&gt;</span> {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Succeeded in getting main color.'</span>);</li><li>         <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`color[ARGB]=<span class="hljs-subst">${color.alpha}</span>,<span class="hljs-subst">${color.red}</span>,<span class="hljs-subst">${color.green}</span>,<span class="hljs-subst">${color.blue}</span>`</span>);</li><li>      })</li><li>    }</li><li>  })</li><li>})</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="getmaincolorsync" device-type="phone,2in1,tablet,wearable,tv">getMainColorSync<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getmaincolorsync" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>getMainColorSync(): Color</p>     <p>读取图像主色的颜色值，结果写入<a href="/consumer/cn/doc/harmonyos-references/js-apis-effectkit#color">Color</a>里，使用同步方式返回。该接口通过图像缩放算法，根据周围像素的加权计算，将原图缩小到1个像素以得到主色。</p>     <p><strong>卡片能力：</strong> 从API version 12开始，该接口支持在ArkTS卡片中使用。</p>     <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力：</strong> SystemCapability.Multimedia.Image.Core</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.15.8.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.15.8.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-effectkit#color">Color</a></td>         <td class="cellrowborder" width="50%">Color实例，即图像主色对应的颜色值，失败时返回null。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-xgu-c106="" class="highlight-div"><div _ngcontent-xgu-c106="" class="highlight-div-header"><div _ngcontent-xgu-c106="" class="highlight-div-header-left"><div _ngcontent-xgu-c106="" class="handle-button expand-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xgu-c106="" class="highlight-div-header-right"><div _ngcontent-xgu-c106="" class="handle-button ai-button"></div><div _ngcontent-xgu-c106="" class="handle-button line-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xgu-c106="" class="handle-button theme-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xgu-c106="" class="handle-button copy-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xgu-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { image } <span class="hljs-keyword">from</span> <span class="hljs-string">"@kit.ImageKit"</span>;</li><li><span class="hljs-keyword">import</span> { effectKit } <span class="hljs-keyword">from</span> <span class="hljs-string">"@kit.ArkGraphics2D"</span>;</li><li>
</li><li><span class="hljs-keyword">const</span> color = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayBuffer</span>(<span class="hljs-number">96</span>);</li><li><span class="hljs-keyword">let</span> opts : image.<span class="hljs-property">InitializationOptions</span> = {</li><li>  <span class="hljs-attr">editable</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-attr">pixelFormat</span>: <span class="hljs-number">3</span>,</li><li>  <span class="hljs-attr">size</span>: {</li><li>    <span class="hljs-attr">height</span>: <span class="hljs-number">4</span>,</li><li>    <span class="hljs-attr">width</span>: <span class="hljs-number">6</span></li><li>  }</li><li>}</li><li>image.<span class="hljs-title function_">createPixelMap</span>(color, opts).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">pixelMap</span>) =&gt;</span> {</li><li>  effectKit.<span class="hljs-title function_">createColorPicker</span>(pixelMap, <span class="hljs-function">(<span class="hljs-params">error, colorPicker</span>) =&gt;</span> {</li><li>    <span class="hljs-keyword">if</span> (error) {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'Failed to create color picker.'</span>);</li><li>    } <span class="hljs-keyword">else</span> {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Succeeded in creating color picker.'</span>);</li><li>      <span class="hljs-keyword">let</span> color = colorPicker.<span class="hljs-title function_">getMainColorSync</span>();</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'get main color ='</span> + color);</li><li>    }</li><li>  })</li><li>})</li></ol></pre></div></div>     <p><span><img originheight="232" originwidth="604" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211115126.62713684145681956478908202057827:50001231000000:2800:171DD4AF9B20433C6F606194503D53CA1B567837DC2020CE8FF1081D73EEB6FB.png" width="604" height="232"></span></p>    </div>    <div class="tiledSection">     <h3 id="getlargestproportioncolor10" device-type="phone,2in1,tablet,wearable,tv">getLargestProportionColor<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getlargestproportioncolor10" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>getLargestProportionColor(): Color</p>     <p>读取图像中占比最多的颜色值，结果写入<a href="/consumer/cn/doc/harmonyos-references/js-apis-effectkit#color">Color</a>里，使用同步方式返回。该接口使用中位切分算法划分颜色空间，获取占比最多的颜色空间的平均颜色。</p>     <p><strong>卡片能力：</strong> 从API version 12开始，该接口支持在ArkTS卡片中使用。</p>     <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力：</strong> SystemCapability.Multimedia.Image.Core</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.16.8.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.16.8.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-effectkit#color">Color</a></td>         <td class="cellrowborder" width="50%">Color实例，即图像占比最多的颜色值，失败时返回null。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-xgu-c106="" class="highlight-div"><div _ngcontent-xgu-c106="" class="highlight-div-header"><div _ngcontent-xgu-c106="" class="highlight-div-header-left"><div _ngcontent-xgu-c106="" class="handle-button expand-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xgu-c106="" class="highlight-div-header-right"><div _ngcontent-xgu-c106="" class="handle-button ai-button"></div><div _ngcontent-xgu-c106="" class="handle-button line-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xgu-c106="" class="handle-button theme-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xgu-c106="" class="handle-button copy-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xgu-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { image } <span class="hljs-keyword">from</span> <span class="hljs-string">"@kit.ImageKit"</span>;</li><li><span class="hljs-keyword">import</span> { effectKit } <span class="hljs-keyword">from</span> <span class="hljs-string">"@kit.ArkGraphics2D"</span>;</li><li>
</li><li><span class="hljs-keyword">const</span> color = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayBuffer</span>(<span class="hljs-number">96</span>);</li><li><span class="hljs-keyword">let</span> opts : image.<span class="hljs-property">InitializationOptions</span> = {</li><li>  <span class="hljs-attr">editable</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-attr">pixelFormat</span>: <span class="hljs-number">3</span>,</li><li>  <span class="hljs-attr">size</span>: {</li><li>    <span class="hljs-attr">height</span>: <span class="hljs-number">4</span>,</li><li>    <span class="hljs-attr">width</span>: <span class="hljs-number">6</span></li><li>  }</li><li>}</li><li>image.<span class="hljs-title function_">createPixelMap</span>(color, opts).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">pixelMap</span>) =&gt;</span> {</li><li>  effectKit.<span class="hljs-title function_">createColorPicker</span>(pixelMap, <span class="hljs-function">(<span class="hljs-params">error, colorPicker</span>) =&gt;</span> {</li><li>    <span class="hljs-keyword">if</span> (error) {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'Failed to create color picker.'</span>);</li><li>    } <span class="hljs-keyword">else</span> {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Succeeded in creating color picker.'</span>);</li><li>      <span class="hljs-keyword">let</span> color = colorPicker.<span class="hljs-title function_">getLargestProportionColor</span>();</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'get largest proportion color ='</span> + color);</li><li>    }</li><li>  })</li><li>})</li></ol></pre></div></div>     <p><span><img originheight="162" originwidth="668" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211115126.10103508674103412368713049226870:50001231000000:2800:1F47C582FAC4EB8B5ABE199911DE73DF29790268FB9C71E672D95A79010C0725.png" width="668" height="162"></span></p>    </div>    <div class="tiledSection">     <h3 id="gettopproportioncolors12" device-type="phone,2in1,tablet,wearable,tv">getTopProportionColors<sup>12+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="gettopproportioncolors12" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>getTopProportionColors(colorCount: number): Array&lt;Color | null&gt;</p>     <p>读取图像占比靠前的颜色值，个数由colorCount指定，结果写入<a href="/consumer/cn/doc/harmonyos-references/js-apis-effectkit#color">Color</a>的数组里，使用同步方式返回。</p>     <p><strong>卡片能力：</strong> 从API version 12开始，该接口支持在ArkTS卡片中使用。</p>     <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力：</strong> SystemCapability.Multimedia.Image.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.17.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.17.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.17.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.17.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">colorCount</td>         <td class="cellrowborder" width="25%">number</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">需要取主色的个数，取值范围为[1, 10]，向下取整。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.17.10.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.17.10.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Array&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-effectkit#color">Color</a> | null&gt;</td>         <td class="cellrowborder" width="50%">          <p>Color数组，即图像占比前colorCount的颜色值数组，按占比排序。</p>          <p>- 当实际读取的特征色个数小于colorCount时，数组大小为实际特征色个数。</p>          <p>- 取色失败或取色个数小于1返回[null]。</p>          <p>- 取色个数大于10视为取前10个。</p></td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-xgu-c106="" class="highlight-div"><div _ngcontent-xgu-c106="" class="highlight-div-header"><div _ngcontent-xgu-c106="" class="highlight-div-header-left"><div _ngcontent-xgu-c106="" class="handle-button expand-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xgu-c106="" class="highlight-div-header-right"><div _ngcontent-xgu-c106="" class="handle-button ai-button"></div><div _ngcontent-xgu-c106="" class="handle-button line-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xgu-c106="" class="handle-button theme-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xgu-c106="" class="handle-button copy-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xgu-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { image } <span class="hljs-keyword">from</span> <span class="hljs-string">"@kit.ImageKit"</span>;</li><li><span class="hljs-keyword">import</span> { effectKit } <span class="hljs-keyword">from</span> <span class="hljs-string">"@kit.ArkGraphics2D"</span>;</li><li>
</li><li><span class="hljs-keyword">const</span> color = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayBuffer</span>(<span class="hljs-number">96</span>);</li><li><span class="hljs-keyword">let</span> opts : image.<span class="hljs-property">InitializationOptions</span> = {</li><li>  <span class="hljs-attr">editable</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-attr">pixelFormat</span>: <span class="hljs-number">3</span>,</li><li>  <span class="hljs-attr">size</span>: {</li><li>    <span class="hljs-attr">height</span>: <span class="hljs-number">4</span>,</li><li>    <span class="hljs-attr">width</span>: <span class="hljs-number">6</span></li><li>  }</li><li>}</li><li>image.<span class="hljs-title function_">createPixelMap</span>(color, opts).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">pixelMap</span>) =&gt;</span> {</li><li>  effectKit.<span class="hljs-title function_">createColorPicker</span>(pixelMap, <span class="hljs-function">(<span class="hljs-params">error, colorPicker</span>) =&gt;</span> {</li><li>    <span class="hljs-keyword">if</span> (error) {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'Failed to create color picker.'</span>);</li><li>    } <span class="hljs-keyword">else</span> {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Succeeded in creating color picker.'</span>);</li><li>      <span class="hljs-keyword">let</span> colors = colorPicker.<span class="hljs-title function_">getTopProportionColors</span>(<span class="hljs-number">2</span>);</li><li>      <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> index = <span class="hljs-number">0</span>; index &lt; colors.<span class="hljs-property">length</span>; index++) {</li><li>        <span class="hljs-keyword">if</span> (colors[index]) {</li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'get top proportion colors: index '</span> + index + <span class="hljs-string">', color '</span> + colors[index]);</li><li>        }</li><li>      }</li><li>    }</li><li>  })</li><li>})</li></ol></pre></div></div>     <p><span><img originheight="162" originwidth="668" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211115126.08002902995483430244581785790367:50001231000000:2800:68714FECF798B31EEF669041E981E6585FBFF7C2BEAA0505ACDDED6FC9C7C8CD.png" width="668" height="162"></span></p>    </div>    <div class="tiledSection">     <h3 id="gethighestsaturationcolor10" device-type="phone,2in1,tablet,wearable,tv">getHighestSaturationColor<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="gethighestsaturationcolor10" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>getHighestSaturationColor(): Color</p>     <p>读取图像饱和度最高的颜色值，结果写入<a href="/consumer/cn/doc/harmonyos-references/js-apis-effectkit#color">Color</a>里，使用同步方式返回。</p>     <p><strong>卡片能力：</strong> 从API version 12开始，该接口支持在ArkTS卡片中使用。</p>     <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力：</strong> SystemCapability.Multimedia.Image.Core</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.18.8.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.18.8.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-effectkit#color">Color</a></td>         <td class="cellrowborder" width="50%">Color实例，即图像饱和度最高的颜色值，失败时返回null。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-xgu-c106="" class="highlight-div"><div _ngcontent-xgu-c106="" class="highlight-div-header"><div _ngcontent-xgu-c106="" class="highlight-div-header-left"><div _ngcontent-xgu-c106="" class="handle-button expand-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xgu-c106="" class="highlight-div-header-right"><div _ngcontent-xgu-c106="" class="handle-button ai-button"></div><div _ngcontent-xgu-c106="" class="handle-button line-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xgu-c106="" class="handle-button theme-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xgu-c106="" class="handle-button copy-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xgu-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { image } <span class="hljs-keyword">from</span> <span class="hljs-string">"@kit.ImageKit"</span>;</li><li><span class="hljs-keyword">import</span> { effectKit } <span class="hljs-keyword">from</span> <span class="hljs-string">"@kit.ArkGraphics2D"</span>;</li><li>
</li><li><span class="hljs-keyword">const</span> color = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayBuffer</span>(<span class="hljs-number">96</span>);</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">opts</span>: image.<span class="hljs-property">InitializationOptions</span> = {</li><li>  <span class="hljs-attr">editable</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-attr">pixelFormat</span>: <span class="hljs-number">3</span>,</li><li>  <span class="hljs-attr">size</span>: {</li><li>    <span class="hljs-attr">height</span>: <span class="hljs-number">4</span>,</li><li>    <span class="hljs-attr">width</span>: <span class="hljs-number">6</span></li><li>  }</li><li>}</li><li>image.<span class="hljs-title function_">createPixelMap</span>(color, opts).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">pixelMap</span>) =&gt;</span> {</li><li>  effectKit.<span class="hljs-title function_">createColorPicker</span>(pixelMap, <span class="hljs-function">(<span class="hljs-params">error, colorPicker</span>) =&gt;</span> {</li><li>    <span class="hljs-keyword">if</span> (error) {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'Failed to create color picker.'</span>);</li><li>    } <span class="hljs-keyword">else</span> {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Succeeded in creating color picker.'</span>);</li><li>      <span class="hljs-keyword">let</span> color = colorPicker.<span class="hljs-title function_">getHighestSaturationColor</span>();</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'get highest saturation color ='</span> + color);</li><li>    }</li><li>  })</li><li>})</li></ol></pre></div></div>     <p><span><img originheight="175" originwidth="673" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211115126.17636898036973628386671131135917:50001231000000:2800:44724956C67FC996FE0FBDFFDF91B76158493F45102F3C3F2055CA8A871B00FE.png" width="673" height="175"></span></p>    </div>    <div class="tiledSection">     <h3 id="getaveragecolor10" device-type="phone,2in1,tablet,wearable,tv">getAverageColor<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getaveragecolor10" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>getAverageColor(): Color</p>     <p>读取图像平均的颜色值，结果写入<a href="/consumer/cn/doc/harmonyos-references/js-apis-effectkit#color">Color</a>里，使用同步方式返回。</p>     <p><strong>卡片能力：</strong> 从API version 12开始，该接口支持在ArkTS卡片中使用。</p>     <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力：</strong> SystemCapability.Multimedia.Image.Core</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.19.8.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.19.8.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-effectkit#color">Color</a></td>         <td class="cellrowborder" width="50%">Color实例，即图像平均的颜色值，失败时返回null。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-xgu-c106="" class="highlight-div"><div _ngcontent-xgu-c106="" class="highlight-div-header"><div _ngcontent-xgu-c106="" class="highlight-div-header-left"><div _ngcontent-xgu-c106="" class="handle-button expand-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xgu-c106="" class="highlight-div-header-right"><div _ngcontent-xgu-c106="" class="handle-button ai-button"></div><div _ngcontent-xgu-c106="" class="handle-button line-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xgu-c106="" class="handle-button theme-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xgu-c106="" class="handle-button copy-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xgu-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { image } <span class="hljs-keyword">from</span> <span class="hljs-string">"@kit.ImageKit"</span>;</li><li><span class="hljs-keyword">import</span> { effectKit } <span class="hljs-keyword">from</span> <span class="hljs-string">"@kit.ArkGraphics2D"</span>;</li><li>
</li><li><span class="hljs-keyword">const</span> color = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayBuffer</span>(<span class="hljs-number">96</span>);</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">opts</span>: image.<span class="hljs-property">InitializationOptions</span> = {</li><li>  <span class="hljs-attr">editable</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-attr">pixelFormat</span>: <span class="hljs-number">3</span>,</li><li>  <span class="hljs-attr">size</span>: {</li><li>    <span class="hljs-attr">height</span>: <span class="hljs-number">4</span>,</li><li>    <span class="hljs-attr">width</span>: <span class="hljs-number">6</span></li><li>  }</li><li>}</li><li>image.<span class="hljs-title function_">createPixelMap</span>(color, opts).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">pixelMap</span>) =&gt;</span> {</li><li>  effectKit.<span class="hljs-title function_">createColorPicker</span>(pixelMap, <span class="hljs-function">(<span class="hljs-params">error, colorPicker</span>) =&gt;</span> {</li><li>    <span class="hljs-keyword">if</span> (error) {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'Failed to create color picker.'</span>);</li><li>    } <span class="hljs-keyword">else</span> {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Succeeded in creating color picker.'</span>);</li><li>      <span class="hljs-keyword">let</span> color = colorPicker.<span class="hljs-title function_">getAverageColor</span>();</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'get average color ='</span> + color);</li><li>    }</li><li>  })</li><li>})</li></ol></pre></div></div>     <p><span><img originheight="225" originwidth="679" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211115126.67345061352156572554277576464739:50001231000000:2800:ACD1779D037B7B3F6A630840520600A5EE2AA71B41B342EA729B5B18F1867C59.png" width="679" height="225"></span></p>    </div>    <div class="tiledSection">     <h3 id="isblackorwhiteorgraycolor10" device-type="phone,2in1,tablet,wearable,tv">isBlackOrWhiteOrGrayColor<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="isblackorwhiteorgraycolor10" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>isBlackOrWhiteOrGrayColor(color: number): boolean</p>     <p>判断图像是否为黑白灰颜色，返回true或false。</p>     <p><strong>卡片能力：</strong> 从API version 12开始，该接口支持在ArkTS卡片中使用。</p>     <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力：</strong> SystemCapability.Multimedia.Image.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.20.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.20.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.20.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.20.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">color</td>         <td class="cellrowborder" width="25%">number</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">需要判断是否黑白灰色的颜色值，取值范围[0x0, 0xFFFFFFFF]。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.20.10.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.20.10.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">boolean</td>         <td class="cellrowborder" width="50%">如果图像为黑白灰颜色，则返回true；否则返回false。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-xgu-c106="" class="highlight-div"><div _ngcontent-xgu-c106="" class="highlight-div-header"><div _ngcontent-xgu-c106="" class="highlight-div-header-left"><div _ngcontent-xgu-c106="" class="handle-button expand-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xgu-c106="" class="highlight-div-header-right"><div _ngcontent-xgu-c106="" class="handle-button ai-button"></div><div _ngcontent-xgu-c106="" class="handle-button line-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xgu-c106="" class="handle-button theme-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xgu-c106="" class="handle-button copy-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xgu-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { image } <span class="hljs-keyword">from</span> <span class="hljs-string">"@kit.ImageKit"</span>;</li><li><span class="hljs-keyword">import</span> { effectKit } <span class="hljs-keyword">from</span> <span class="hljs-string">"@kit.ArkGraphics2D"</span>;</li><li>
</li><li><span class="hljs-keyword">const</span> color = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayBuffer</span>(<span class="hljs-number">96</span>);</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">opts</span>: image.<span class="hljs-property">InitializationOptions</span> = {</li><li>  <span class="hljs-attr">editable</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-attr">pixelFormat</span>: <span class="hljs-number">3</span>,</li><li>  <span class="hljs-attr">size</span>: {</li><li>    <span class="hljs-attr">height</span>: <span class="hljs-number">4</span>,</li><li>    <span class="hljs-attr">width</span>: <span class="hljs-number">6</span></li><li>  }</li><li>}</li><li>image.<span class="hljs-title function_">createPixelMap</span>(color, opts).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">pixelMap</span>) =&gt;</span> {</li><li>  effectKit.<span class="hljs-title function_">createColorPicker</span>(pixelMap, <span class="hljs-function">(<span class="hljs-params">error, colorPicker</span>) =&gt;</span> {</li><li>    <span class="hljs-keyword">if</span> (error) {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'Failed to create color picker.'</span>);</li><li>    } <span class="hljs-keyword">else</span> {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Succeeded in creating color picker.'</span>);</li><li>      <span class="hljs-keyword">let</span> bJudge = colorPicker.<span class="hljs-title function_">isBlackOrWhiteOrGrayColor</span>(<span class="hljs-number">0xFFFFFFFF</span>);</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'is black or white or gray color[bool](white) ='</span> + bJudge);</li><li>    }</li><li>  })</li><li>})</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="filter" device-type="phone,2in1,tablet,wearable,tv">Filter<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="filter" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>图像效果类，用于将指定的效果添加到输入图像中。在调用Filter的方法前，需要先通过<a href="/consumer/cn/doc/harmonyos-references/js-apis-effectkit#effectkitcreateeffect">createEffect</a>创建一个Filter实例。</p>    </div>    <div class="tiledSection">     <h3 id="blur" device-type="phone,2in1,tablet,wearable,tv" class="firsth2">blur<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="blur" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>blur(radius: number): Filter</p>     <p>将模糊效果添加到效果链表中，返回链表的头节点。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>该接口为静态模糊接口，为静态图像提供模糊化效果，如果要对组件进行实时渲染的模糊，可以使用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-blur-effect" target="_blank">动态模糊</a>。</p>      </div></div></div>     <p><strong>卡片能力：</strong> 从API version 12开始，该接口支持在ArkTS卡片中使用。</p>     <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力：</strong> SystemCapability.Multimedia.Image.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.22.9.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.22.9.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.22.9.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.22.9.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">radius</td>         <td class="cellrowborder" width="25%">number</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">模糊半径，单位是像素。模糊效果与所设置的值成正比，值越大效果越明显。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.22.11.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.22.11.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-effectkit#filter">Filter</a></td>         <td class="cellrowborder" width="50%">返回已添加的图像效果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-xgu-c106="" class="highlight-div"><div _ngcontent-xgu-c106="" class="highlight-div-header"><div _ngcontent-xgu-c106="" class="highlight-div-header-left"><div _ngcontent-xgu-c106="" class="handle-button expand-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xgu-c106="" class="highlight-div-header-right"><div _ngcontent-xgu-c106="" class="handle-button ai-button"></div><div _ngcontent-xgu-c106="" class="handle-button line-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xgu-c106="" class="handle-button theme-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xgu-c106="" class="handle-button copy-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xgu-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { image } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ImageKit'</span>;</li><li><span class="hljs-keyword">import</span> { effectKit } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkGraphics2D'</span>;</li><li><span class="hljs-keyword">import</span> { common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-comment">// 传入读取的图片数据</span></li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">ImageBlur</span>(<span class="hljs-params">Image: <span class="hljs-built_in">ArrayBuffer</span></span>): <span class="hljs-title class_">Promise</span>&lt;image.<span class="hljs-property">PixelMap</span>&gt; {</li><li>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {</li><li>    <span class="hljs-keyword">let</span> imageSource = image.<span class="hljs-title function_">createImageSource</span>(<span class="hljs-title class_">Image</span>);</li><li>    imageSource.<span class="hljs-title function_">createPixelMap</span>().<span class="hljs-title function_">then</span>(<span class="hljs-keyword">async</span> (<span class="hljs-attr">pixelMap</span>: image.<span class="hljs-property">PixelMap</span>) =&gt; {</li><li>      <span class="hljs-keyword">let</span> radius = <span class="hljs-number">5</span>;</li><li>      <span class="hljs-keyword">let</span> headFilter = effectKit.<span class="hljs-title function_">createEffect</span>(pixelMap);</li><li>      <span class="hljs-keyword">if</span> (headFilter != <span class="hljs-literal">null</span>) {</li><li>        <span class="hljs-comment">// 对图片添加效果标识</span></li><li>        headFilter.<span class="hljs-title function_">blur</span>(radius);</li><li>      }</li><li>      <span class="hljs-comment">// 按照添加的效果标识对图片进行处理并且返回处理好的图片数据</span></li><li>      headFilter.<span class="hljs-title function_">getEffectPixelMap</span>(<span class="hljs-literal">false</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">imageData</span> =&gt;</span> {</li><li>        <span class="hljs-title function_">resolve</span>(imageData);</li><li>      })</li><li>    })</li><li>  })</li><li>}</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">imagePixelMap</span>: image.<span class="hljs-property">PixelMap</span> | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">imageBuffer</span>: <span class="hljs-title class_">ArrayBuffer</span> | <span class="hljs-literal">undefined</span> = <span class="hljs-literal">undefined</span>;</li><li>  <span class="hljs-comment">// 读取rawfile文件夹下的图片文件，也可根据需求更换读取方式，保证最终得到的是ArrayBuffer格式的图片数据即可</span></li><li>  <span class="hljs-keyword">async</span> <span class="hljs-title function_">getFileBuffer</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">ArrayBuffer</span> | <span class="hljs-literal">undefined</span>&gt; {</li><li>    <span class="hljs-keyword">try</span>{</li><li>      <span class="hljs-keyword">const</span> <span class="hljs-attr">context</span>: <span class="hljs-title class_">Context</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li>      <span class="hljs-keyword">const</span> <span class="hljs-attr">fileData</span>: <span class="hljs-title class_">Uint8Array</span> = <span class="hljs-keyword">await</span> context.<span class="hljs-property">resourceManager</span>.<span class="hljs-title function_">getRawFileContent</span>(<span class="hljs-string">'image.png'</span>);</li><li>      <span class="hljs-keyword">const</span> <span class="hljs-attr">buffer</span>: <span class="hljs-title class_">ArrayBuffer</span> = fileData.<span class="hljs-property">buffer</span>.<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>);</li><li>      <span class="hljs-keyword">return</span> buffer;</li><li>    }<span class="hljs-keyword">catch</span> (err){</li><li>      <span class="hljs-keyword">return</span> <span class="hljs-literal">undefined</span></li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">async</span> <span class="hljs-title function_">aboutToAppear</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt;{</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">imageBuffer</span> = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getFileBuffer</span>();</li><li>    <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">imageBuffer</span> == <span class="hljs-literal">undefined</span>){</li><li>      <span class="hljs-keyword">return</span>;</li><li>    }</li><li>    <span class="hljs-comment">// 图片处理为异步操作，可以依据是否需要拿到处理好的图片数据再进行下一步逻辑，按需添加await进行同步</span></li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">imagePixelMap</span> = <span class="hljs-keyword">await</span> <span class="hljs-title class_">ImageBlur</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">imageBuffer</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Image</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">imagePixelMap</span>)</li><li>        .<span class="hljs-title function_">width</span>(<span class="hljs-number">304</span>)</li><li>        .<span class="hljs-title function_">height</span>(<span class="hljs-number">305</span>)</li><li>    }</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div>     <p><span><img originheight="260" originwidth="660" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211115126.30710288318923148350399500282613:50001231000000:2800:F5BFC01F99F2A0ABB8C8DBF59508F42858A7A309D5495EAA4EEF3BEA0825D658.png" width="660" height="260"></span></p>    </div>    <div class="tiledSection">     <h3 id="blur14" device-type="phone,2in1,tablet,wearable,tv">blur<sup>14+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="blur14" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>blur(radius: number, tileMode: TileMode): Filter</p>     <p>将模糊效果添加到效果链表中，返回链表的头节点。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>该接口为静态模糊接口，为静态图像提供模糊化效果，如果要对组件进行实时渲染的模糊，可以使用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-blur-effect" target="_blank">动态模糊</a>。</p>      </div></div></div>     <p><strong>系统能力：</strong> SystemCapability.Multimedia.Image.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.23.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.23.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.23.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.23.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">radius</td>         <td class="cellrowborder" width="25%">number</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">模糊半径，单位是像素。模糊效果与所设置的值成正比，值越大效果越明显。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">tileMode</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-effectkit#tilemode14">TileMode</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">着色器效果平铺模式。影响图像边缘的模糊效果。目前仅支持CPU渲染，所以目前着色器平铺模式仅支持DECAL。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.23.9.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.23.9.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-effectkit#filter">Filter</a></td>         <td class="cellrowborder" width="50%">返回已添加的图像效果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-xgu-c106="" class="highlight-div"><div _ngcontent-xgu-c106="" class="highlight-div-header"><div _ngcontent-xgu-c106="" class="highlight-div-header-left"><div _ngcontent-xgu-c106="" class="handle-button expand-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xgu-c106="" class="highlight-div-header-right"><div _ngcontent-xgu-c106="" class="handle-button ai-button"></div><div _ngcontent-xgu-c106="" class="handle-button line-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xgu-c106="" class="handle-button theme-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xgu-c106="" class="handle-button copy-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xgu-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { image } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ImageKit'</span>;</li><li><span class="hljs-keyword">import</span> { effectKit } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkGraphics2D'</span>;</li><li><span class="hljs-keyword">import</span> { common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-comment">// 传入读取的图片数据</span></li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">ImageBlur</span>(<span class="hljs-params">Image: <span class="hljs-built_in">ArrayBuffer</span></span>): <span class="hljs-title class_">Promise</span>&lt;image.<span class="hljs-property">PixelMap</span>&gt; {</li><li>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {</li><li>    <span class="hljs-keyword">let</span> imageSource = image.<span class="hljs-title function_">createImageSource</span>(<span class="hljs-title class_">Image</span>);</li><li>    imageSource.<span class="hljs-title function_">createPixelMap</span>().<span class="hljs-title function_">then</span>(<span class="hljs-keyword">async</span> (<span class="hljs-attr">pixelMap</span>: image.<span class="hljs-property">PixelMap</span>) =&gt; {</li><li>      <span class="hljs-keyword">let</span> radius = <span class="hljs-number">30</span>;</li><li>      <span class="hljs-keyword">let</span> headFilter = effectKit.<span class="hljs-title function_">createEffect</span>(pixelMap);</li><li>      <span class="hljs-keyword">if</span> (headFilter != <span class="hljs-literal">null</span>) {</li><li>        <span class="hljs-comment">// 对图片添加效果标识</span></li><li>        headFilter.<span class="hljs-title function_">blur</span>(radius, effectKit.<span class="hljs-property">TileMode</span>.<span class="hljs-property">DECAL</span>);</li><li>      }</li><li>      <span class="hljs-comment">// 按照添加的效果标识对图片进行处理并且返回处理好的图片数据</span></li><li>      headFilter.<span class="hljs-title function_">getEffectPixelMap</span>(<span class="hljs-literal">false</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">imageData</span> =&gt;</span> {</li><li>        <span class="hljs-title function_">resolve</span>(imageData);</li><li>      })</li><li>    })</li><li>  })</li><li>}</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">imagePixelMap</span>: image.<span class="hljs-property">PixelMap</span> | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">imageBuffer</span>: <span class="hljs-title class_">ArrayBuffer</span> | <span class="hljs-literal">undefined</span> = <span class="hljs-literal">undefined</span>;</li><li>  <span class="hljs-comment">// 读取rawfile文件夹下的图片文件，也可根据需求更换读取方式，保证最终得到的是ArrayBuffer格式的图片数据即可</span></li><li>  <span class="hljs-keyword">async</span> <span class="hljs-title function_">getFileBuffer</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">ArrayBuffer</span> | <span class="hljs-literal">undefined</span>&gt; {</li><li>    <span class="hljs-keyword">try</span>{</li><li>      <span class="hljs-keyword">const</span> <span class="hljs-attr">context</span>: <span class="hljs-title class_">Context</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li>      <span class="hljs-keyword">const</span> <span class="hljs-attr">fileData</span>: <span class="hljs-title class_">Uint8Array</span> = <span class="hljs-keyword">await</span> context.<span class="hljs-property">resourceManager</span>.<span class="hljs-title function_">getRawFileContent</span>(<span class="hljs-string">'image.png'</span>);</li><li>      <span class="hljs-keyword">const</span> <span class="hljs-attr">buffer</span>: <span class="hljs-title class_">ArrayBuffer</span> = fileData.<span class="hljs-property">buffer</span>.<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>);</li><li>      <span class="hljs-keyword">return</span> buffer;</li><li>    }<span class="hljs-keyword">catch</span> (err){</li><li>      <span class="hljs-keyword">return</span> <span class="hljs-literal">undefined</span></li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">async</span> <span class="hljs-title function_">aboutToAppear</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt;{</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">imageBuffer</span> = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getFileBuffer</span>();</li><li>    <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">imageBuffer</span> == <span class="hljs-literal">undefined</span>){</li><li>      <span class="hljs-keyword">return</span>;</li><li>    }</li><li>    <span class="hljs-comment">// 图片处理为异步操作，可以依据是否需要拿到处理好的图片数据再进行下一步逻辑，按需添加await进行同步</span></li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">imagePixelMap</span> = <span class="hljs-keyword">await</span> <span class="hljs-title class_">ImageBlur</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">imageBuffer</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Image</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">imagePixelMap</span>)</li><li>        .<span class="hljs-title function_">width</span>(<span class="hljs-number">304</span>)</li><li>        .<span class="hljs-title function_">height</span>(<span class="hljs-number">305</span>)</li><li>    }</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div>     <p><span><img originheight="413" originwidth="976" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211115126.24389710640119780937701065510056:50001231000000:2800:BE4B8FF890D44A3FADAF119E67A04FAE15BA4BD5691EB0489BA0E844CB8412AA.png" width="920" height="389.3032786885246"></span></p>    </div>    <div class="tiledSection">     <h3 id="invert12" device-type="phone,2in1,tablet,wearable,tv">invert<sup>12+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="invert12" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>invert(): Filter</p>     <p>将反转效果添加到效果链表中，返回链表的头节点。</p>     <p><strong>系统能力：</strong> SystemCapability.Multimedia.Image.Core</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.24.6.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.24.6.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-effectkit#filter">Filter</a></td>         <td class="cellrowborder" width="50%">返回已添加的图像效果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-xgu-c106="" class="highlight-div"><div _ngcontent-xgu-c106="" class="highlight-div-header"><div _ngcontent-xgu-c106="" class="highlight-div-header-left"><div _ngcontent-xgu-c106="" class="handle-button expand-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xgu-c106="" class="highlight-div-header-right"><div _ngcontent-xgu-c106="" class="handle-button ai-button"></div><div _ngcontent-xgu-c106="" class="handle-button line-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xgu-c106="" class="handle-button theme-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xgu-c106="" class="handle-button copy-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xgu-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { image } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ImageKit'</span>;</li><li><span class="hljs-keyword">import</span> { effectKit } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkGraphics2D'</span>;</li><li><span class="hljs-keyword">import</span> { common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-comment">// 传入读取的图片数据</span></li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">ImageInvert</span>(<span class="hljs-params">Image: <span class="hljs-built_in">ArrayBuffer</span></span>): <span class="hljs-title class_">Promise</span>&lt;image.<span class="hljs-property">PixelMap</span>&gt; {</li><li>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {</li><li>    <span class="hljs-keyword">let</span> imageSource = image.<span class="hljs-title function_">createImageSource</span>(<span class="hljs-title class_">Image</span>);</li><li>    imageSource.<span class="hljs-title function_">createPixelMap</span>().<span class="hljs-title function_">then</span>(<span class="hljs-keyword">async</span> (<span class="hljs-attr">pixelMap</span>: image.<span class="hljs-property">PixelMap</span>) =&gt; {</li><li>      <span class="hljs-keyword">let</span> headFilter = effectKit.<span class="hljs-title function_">createEffect</span>(pixelMap);</li><li>      <span class="hljs-keyword">if</span> (headFilter != <span class="hljs-literal">null</span>) {</li><li>        <span class="hljs-comment">// 对图片添加效果标识</span></li><li>        headFilter.<span class="hljs-title function_">invert</span>();</li><li>      }</li><li>      <span class="hljs-comment">// 按照添加的效果标识对图片进行处理并且返回处理好的图片数据</span></li><li>      headFilter.<span class="hljs-title function_">getEffectPixelMap</span>(<span class="hljs-literal">false</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">imageData</span> =&gt;</span> {</li><li>        <span class="hljs-title function_">resolve</span>(imageData);</li><li>      })</li><li>    })</li><li>  })</li><li>}</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">imagePixelMap</span>: image.<span class="hljs-property">PixelMap</span> | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">imageBuffer</span>: <span class="hljs-title class_">ArrayBuffer</span> | <span class="hljs-literal">undefined</span> = <span class="hljs-literal">undefined</span>;</li><li>  <span class="hljs-comment">// 读取rawfile文件夹下的图片文件，也可根据需求更换读取方式，保证最终得到的是ArrayBuffer格式的图片数据即可</span></li><li>  <span class="hljs-keyword">async</span> <span class="hljs-title function_">getFileBuffer</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">ArrayBuffer</span> | <span class="hljs-literal">undefined</span>&gt; {</li><li>    <span class="hljs-keyword">try</span>{</li><li>      <span class="hljs-keyword">const</span> <span class="hljs-attr">context</span>: <span class="hljs-title class_">Context</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li>      <span class="hljs-keyword">const</span> <span class="hljs-attr">fileData</span>: <span class="hljs-title class_">Uint8Array</span> = <span class="hljs-keyword">await</span> context.<span class="hljs-property">resourceManager</span>.<span class="hljs-title function_">getRawFileContent</span>(<span class="hljs-string">'image.png'</span>);</li><li>      <span class="hljs-keyword">const</span> <span class="hljs-attr">buffer</span>: <span class="hljs-title class_">ArrayBuffer</span> = fileData.<span class="hljs-property">buffer</span>.<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>);</li><li>      <span class="hljs-keyword">return</span> buffer;</li><li>    }<span class="hljs-keyword">catch</span> (err){</li><li>      <span class="hljs-keyword">return</span> <span class="hljs-literal">undefined</span></li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">async</span> <span class="hljs-title function_">aboutToAppear</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt;{</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">imageBuffer</span> = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getFileBuffer</span>();</li><li>    <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">imageBuffer</span> == <span class="hljs-literal">undefined</span>){</li><li>      <span class="hljs-keyword">return</span>;</li><li>    }</li><li>    <span class="hljs-comment">// 图片处理为异步操作，可以依据是否需要拿到处理好的图片数据再进行下一步逻辑，按需添加await进行同步</span></li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">imagePixelMap</span> = <span class="hljs-keyword">await</span> <span class="hljs-title class_">ImageInvert</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">imageBuffer</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Image</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">imagePixelMap</span>)</li><li>        .<span class="hljs-title function_">width</span>(<span class="hljs-number">304</span>)</li><li>        .<span class="hljs-title function_">height</span>(<span class="hljs-number">305</span>)</li><li>    }</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div>     <p><span><img originheight="276" originwidth="884" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211115126.03886543538400279545679228900580:50001231000000:2800:0F374D1ED04722A2BCDFB467834598BFFDA066F0F8B4B5280A67EAA8A468FDD5.png" width="884" height="276"></span></p>    </div>    <div class="tiledSection">     <h3 id="setcolormatrix12" device-type="phone,2in1,tablet,wearable,tv">setColorMatrix<sup>12+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="setcolormatrix12" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>setColorMatrix(colorMatrix: Array&lt;number&gt;): Filter</p>     <p>将自定义效果添加到效果链表中，返回链表的头节点。</p>     <p><strong>系统能力：</strong> SystemCapability.Multimedia.Image.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.25.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.25.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.25.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.25.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">colorMatrix</td>         <td class="cellrowborder" width="25%">Array&lt;number&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">          <p>自定义颜色矩阵。</p>          <p>用于创建效果滤镜的 5x4 大小的矩阵，矩阵元素取值范围为[0, 1]，0和1代表的是矩阵中对应位置的颜色通道的权重，0代表该颜色通道不参与计算，1代表该颜色通道参与计算并保持原始权重。</p></td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.25.8.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.25.8.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-effectkit#filter">Filter</a></td>         <td class="cellrowborder" width="50%">返回已添加的图像效果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.25.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.25.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Input parameter error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-xgu-c106="" class="highlight-div"><div _ngcontent-xgu-c106="" class="highlight-div-header"><div _ngcontent-xgu-c106="" class="highlight-div-header-left"><div _ngcontent-xgu-c106="" class="handle-button expand-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xgu-c106="" class="highlight-div-header-right"><div _ngcontent-xgu-c106="" class="handle-button ai-button"></div><div _ngcontent-xgu-c106="" class="handle-button line-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xgu-c106="" class="handle-button theme-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xgu-c106="" class="handle-button copy-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xgu-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { image } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ImageKit'</span>;</li><li><span class="hljs-keyword">import</span> { effectKit } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkGraphics2D'</span>;</li><li><span class="hljs-keyword">import</span> { common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-comment">// 传入读取的图片数据</span></li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">ImageColorFilter</span>(<span class="hljs-params">Image: <span class="hljs-built_in">ArrayBuffer</span></span>): <span class="hljs-title class_">Promise</span>&lt;image.<span class="hljs-property">PixelMap</span>&gt; {</li><li>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {</li><li>    <span class="hljs-keyword">let</span> imageSource = image.<span class="hljs-title function_">createImageSource</span>(<span class="hljs-title class_">Image</span>);</li><li>    imageSource.<span class="hljs-title function_">createPixelMap</span>().<span class="hljs-title function_">then</span>(<span class="hljs-keyword">async</span> (<span class="hljs-attr">pixelMap</span>: image.<span class="hljs-property">PixelMap</span>) =&gt; {</li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">colorMatrix</span>:<span class="hljs-title class_">Array</span>&lt;<span class="hljs-built_in">number</span>&gt; = [</li><li>      <span class="hljs-number">0.2126</span>,<span class="hljs-number">0.7152</span>,<span class="hljs-number">0.0722</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,</li><li>      <span class="hljs-number">0.2126</span>,<span class="hljs-number">0.7152</span>,<span class="hljs-number">0.0722</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,</li><li>      <span class="hljs-number">0.2126</span>,<span class="hljs-number">0.7152</span>,<span class="hljs-number">0.0722</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,</li><li>      <span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span></li><li>      ];</li><li>      <span class="hljs-keyword">let</span> headFilter = effectKit.<span class="hljs-title function_">createEffect</span>(pixelMap);</li><li>      <span class="hljs-keyword">if</span> (headFilter != <span class="hljs-literal">null</span>) {</li><li>        <span class="hljs-comment">// 对图片添加效果标识</span></li><li>        headFilter.<span class="hljs-title function_">setColorMatrix</span>(colorMatrix);</li><li>      }</li><li>      <span class="hljs-comment">// 按照添加的效果标识对图片进行处理并且返回处理好的图片数据</span></li><li>      headFilter.<span class="hljs-title function_">getEffectPixelMap</span>(<span class="hljs-literal">false</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">imageData</span> =&gt;</span> {</li><li>        <span class="hljs-title function_">resolve</span>(imageData);</li><li>      })</li><li>    })</li><li>  })</li><li>}</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">imagePixelMap</span>: image.<span class="hljs-property">PixelMap</span> | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">imageBuffer</span>: <span class="hljs-title class_">ArrayBuffer</span> | <span class="hljs-literal">undefined</span> = <span class="hljs-literal">undefined</span>;</li><li>  <span class="hljs-comment">// 读取rawfile文件夹下的图片文件，也可根据需求更换读取方式，保证最终得到的是ArrayBuffer格式的图片数据即可</span></li><li>  <span class="hljs-keyword">async</span> <span class="hljs-title function_">getFileBuffer</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">ArrayBuffer</span> | <span class="hljs-literal">undefined</span>&gt; {</li><li>    <span class="hljs-keyword">try</span>{</li><li>      <span class="hljs-keyword">const</span> <span class="hljs-attr">context</span>: <span class="hljs-title class_">Context</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li>      <span class="hljs-keyword">const</span> <span class="hljs-attr">fileData</span>: <span class="hljs-title class_">Uint8Array</span> = <span class="hljs-keyword">await</span> context.<span class="hljs-property">resourceManager</span>.<span class="hljs-title function_">getRawFileContent</span>(<span class="hljs-string">'image.png'</span>);</li><li>      <span class="hljs-keyword">const</span> <span class="hljs-attr">buffer</span>: <span class="hljs-title class_">ArrayBuffer</span> = fileData.<span class="hljs-property">buffer</span>.<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>);</li><li>      <span class="hljs-keyword">return</span> buffer;</li><li>    }<span class="hljs-keyword">catch</span> (err){</li><li>      <span class="hljs-keyword">return</span> <span class="hljs-literal">undefined</span></li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">async</span> <span class="hljs-title function_">aboutToAppear</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt;{</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">imageBuffer</span> = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getFileBuffer</span>();</li><li>    <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">imageBuffer</span> == <span class="hljs-literal">undefined</span>){</li><li>      <span class="hljs-keyword">return</span>;</li><li>    }</li><li>    <span class="hljs-comment">// 图片处理为异步操作，可以依据是否需要拿到处理好的图片数据再进行下一步逻辑，按需添加await进行同步</span></li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">imagePixelMap</span> = <span class="hljs-keyword">await</span> <span class="hljs-title class_">ImageColorFilter</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">imageBuffer</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Image</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">imagePixelMap</span>)</li><li>        .<span class="hljs-title function_">width</span>(<span class="hljs-number">304</span>)</li><li>        .<span class="hljs-title function_">height</span>(<span class="hljs-number">305</span>)</li><li>    }</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="brightness" device-type="phone,2in1,tablet,wearable,tv">brightness<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="brightness" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>brightness(bright: number): Filter</p>     <p>将高亮效果添加到效果链表中，返回链表的头节点。</p>     <p><strong>卡片能力：</strong> 从API version 12开始，该接口支持在ArkTS卡片中使用。</p>     <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力：</strong> SystemCapability.Multimedia.Image.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.26.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.26.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.26.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.26.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">bright</td>         <td class="cellrowborder" width="25%">number</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">高亮程度，取值范围在0-1之间，取值为0时图像保持不变。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.26.10.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.26.10.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-effectkit#filter">Filter</a></td>         <td class="cellrowborder" width="50%">返回已添加的图像效果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-xgu-c106="" class="highlight-div"><div _ngcontent-xgu-c106="" class="highlight-div-header"><div _ngcontent-xgu-c106="" class="highlight-div-header-left"><div _ngcontent-xgu-c106="" class="handle-button expand-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xgu-c106="" class="highlight-div-header-right"><div _ngcontent-xgu-c106="" class="handle-button ai-button"></div><div _ngcontent-xgu-c106="" class="handle-button line-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xgu-c106="" class="handle-button theme-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xgu-c106="" class="handle-button copy-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xgu-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { image } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ImageKit'</span>;</li><li><span class="hljs-keyword">import</span> { effectKit } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkGraphics2D'</span>;</li><li><span class="hljs-keyword">import</span> { common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-comment">// 传入读取的图片数据</span></li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">ImageBrightness</span>(<span class="hljs-params">Image: <span class="hljs-built_in">ArrayBuffer</span></span>): <span class="hljs-title class_">Promise</span>&lt;image.<span class="hljs-property">PixelMap</span>&gt; {</li><li>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {</li><li>    <span class="hljs-keyword">let</span> imageSource = image.<span class="hljs-title function_">createImageSource</span>(<span class="hljs-title class_">Image</span>);</li><li>    imageSource.<span class="hljs-title function_">createPixelMap</span>().<span class="hljs-title function_">then</span>(<span class="hljs-keyword">async</span> (<span class="hljs-attr">pixelMap</span>: image.<span class="hljs-property">PixelMap</span>) =&gt; {</li><li>      <span class="hljs-keyword">let</span> bright = <span class="hljs-number">0.5</span>;</li><li>      <span class="hljs-keyword">let</span> headFilter = effectKit.<span class="hljs-title function_">createEffect</span>(pixelMap);</li><li>      <span class="hljs-keyword">if</span> (headFilter != <span class="hljs-literal">null</span>) {</li><li>        <span class="hljs-comment">// 对图片添加效果标识</span></li><li>        headFilter.<span class="hljs-title function_">brightness</span>(bright);</li><li>      }</li><li>      <span class="hljs-comment">// 按照添加的效果标识对图片进行处理并且返回处理好的图片数据</span></li><li>      headFilter.<span class="hljs-title function_">getEffectPixelMap</span>(<span class="hljs-literal">false</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">imageData</span> =&gt;</span> {</li><li>        <span class="hljs-title function_">resolve</span>(imageData);</li><li>      })</li><li>    })</li><li>  })</li><li>}</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">imagePixelMap</span>: image.<span class="hljs-property">PixelMap</span> | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">imageBuffer</span>: <span class="hljs-title class_">ArrayBuffer</span> | <span class="hljs-literal">undefined</span> = <span class="hljs-literal">undefined</span>;</li><li>  <span class="hljs-comment">// 读取rawfile文件夹下的图片文件，也可根据需求更换读取方式，保证最终得到的是ArrayBuffer格式的图片数据即可</span></li><li>  <span class="hljs-keyword">async</span> <span class="hljs-title function_">getFileBuffer</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">ArrayBuffer</span> | <span class="hljs-literal">undefined</span>&gt; {</li><li>    <span class="hljs-keyword">try</span>{</li><li>      <span class="hljs-keyword">const</span> <span class="hljs-attr">context</span>: <span class="hljs-title class_">Context</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li>      <span class="hljs-keyword">const</span> <span class="hljs-attr">fileData</span>: <span class="hljs-title class_">Uint8Array</span> = <span class="hljs-keyword">await</span> context.<span class="hljs-property">resourceManager</span>.<span class="hljs-title function_">getRawFileContent</span>(<span class="hljs-string">'image.png'</span>);</li><li>      <span class="hljs-keyword">const</span> <span class="hljs-attr">buffer</span>: <span class="hljs-title class_">ArrayBuffer</span> = fileData.<span class="hljs-property">buffer</span>.<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>);</li><li>      <span class="hljs-keyword">return</span> buffer;</li><li>    }<span class="hljs-keyword">catch</span> (err){</li><li>      <span class="hljs-keyword">return</span> <span class="hljs-literal">undefined</span></li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">async</span> <span class="hljs-title function_">aboutToAppear</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt;{</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">imageBuffer</span> = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getFileBuffer</span>();</li><li>    <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">imageBuffer</span> == <span class="hljs-literal">undefined</span>){</li><li>      <span class="hljs-keyword">return</span>;</li><li>    }</li><li>    <span class="hljs-comment">// 图片处理为异步操作，可以依据是否需要拿到处理好的图片数据再进行下一步逻辑，按需添加await进行同步</span></li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">imagePixelMap</span> = <span class="hljs-keyword">await</span> <span class="hljs-title class_">ImageBrightness</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">imageBuffer</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Image</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">imagePixelMap</span>)</li><li>        .<span class="hljs-title function_">width</span>(<span class="hljs-number">304</span>)</li><li>        .<span class="hljs-title function_">height</span>(<span class="hljs-number">305</span>)</li><li>    }</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div>     <p><span><img originheight="249" originwidth="630" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211115127.46830769459857110620820797490366:50001231000000:2800:38DE5DE1219E31C961AA3BFAD94F7B58496A64F8E50BB58B37E7099C309F6E47.png" width="630" height="249"></span></p>    </div>    <div class="tiledSection">     <h3 id="grayscale" device-type="phone,2in1,tablet,wearable,tv">grayscale<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="grayscale" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>grayscale(): Filter</p>     <p>将灰度效果添加到效果链表中，返回链表的头节点。</p>     <p><strong>卡片能力：</strong> 从API version 12开始，该接口支持在ArkTS卡片中使用。</p>     <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力：</strong> SystemCapability.Multimedia.Image.Core</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.27.8.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.27.8.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-effectkit#filter">Filter</a></td>         <td class="cellrowborder" width="50%">返回已添加的图像效果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-xgu-c106="" class="highlight-div"><div _ngcontent-xgu-c106="" class="highlight-div-header"><div _ngcontent-xgu-c106="" class="highlight-div-header-left"><div _ngcontent-xgu-c106="" class="handle-button expand-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xgu-c106="" class="highlight-div-header-right"><div _ngcontent-xgu-c106="" class="handle-button ai-button"></div><div _ngcontent-xgu-c106="" class="handle-button line-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xgu-c106="" class="handle-button theme-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xgu-c106="" class="handle-button copy-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xgu-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { image } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ImageKit'</span>;</li><li><span class="hljs-keyword">import</span> { effectKit } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkGraphics2D'</span>;</li><li><span class="hljs-keyword">import</span> { common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-comment">// 传入读取的图片数据</span></li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">ImageGrayscale</span>(<span class="hljs-params">Image: <span class="hljs-built_in">ArrayBuffer</span></span>): <span class="hljs-title class_">Promise</span>&lt;image.<span class="hljs-property">PixelMap</span>&gt; {</li><li>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {</li><li>    <span class="hljs-keyword">let</span> imageSource = image.<span class="hljs-title function_">createImageSource</span>(<span class="hljs-title class_">Image</span>);</li><li>    imageSource.<span class="hljs-title function_">createPixelMap</span>().<span class="hljs-title function_">then</span>(<span class="hljs-keyword">async</span> (<span class="hljs-attr">pixelMap</span>: image.<span class="hljs-property">PixelMap</span>) =&gt; {</li><li>      <span class="hljs-keyword">let</span> headFilter = effectKit.<span class="hljs-title function_">createEffect</span>(pixelMap);</li><li>      <span class="hljs-keyword">if</span> (headFilter != <span class="hljs-literal">null</span>) {</li><li>        <span class="hljs-comment">// 对图片添加效果标识</span></li><li>        headFilter.<span class="hljs-title function_">grayscale</span>();</li><li>      }</li><li>      <span class="hljs-comment">// 按照添加的效果标识对图片进行处理并且返回处理好的图片数据</span></li><li>      headFilter.<span class="hljs-title function_">getEffectPixelMap</span>(<span class="hljs-literal">false</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">imageData</span> =&gt;</span> {</li><li>        <span class="hljs-title function_">resolve</span>(imageData);</li><li>      })</li><li>    })</li><li>  })</li><li>}</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">imagePixelMap</span>: image.<span class="hljs-property">PixelMap</span> | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">imageBuffer</span>: <span class="hljs-title class_">ArrayBuffer</span> | <span class="hljs-literal">undefined</span> = <span class="hljs-literal">undefined</span>;</li><li>  <span class="hljs-comment">// 读取rawfile文件夹下的图片文件，也可根据需求更换读取方式，保证最终得到的是ArrayBuffer格式的图片数据即可</span></li><li>  <span class="hljs-keyword">async</span> <span class="hljs-title function_">getFileBuffer</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">ArrayBuffer</span> | <span class="hljs-literal">undefined</span>&gt; {</li><li>    <span class="hljs-keyword">try</span>{</li><li>      <span class="hljs-keyword">const</span> <span class="hljs-attr">context</span>: <span class="hljs-title class_">Context</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li>      <span class="hljs-keyword">const</span> <span class="hljs-attr">fileData</span>: <span class="hljs-title class_">Uint8Array</span> = <span class="hljs-keyword">await</span> context.<span class="hljs-property">resourceManager</span>.<span class="hljs-title function_">getRawFileContent</span>(<span class="hljs-string">'image.png'</span>);</li><li>      <span class="hljs-keyword">const</span> <span class="hljs-attr">buffer</span>: <span class="hljs-title class_">ArrayBuffer</span> = fileData.<span class="hljs-property">buffer</span>.<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>);</li><li>      <span class="hljs-keyword">return</span> buffer;</li><li>    }<span class="hljs-keyword">catch</span> (err){</li><li>      <span class="hljs-keyword">return</span> <span class="hljs-literal">undefined</span></li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">async</span> <span class="hljs-title function_">aboutToAppear</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt;{</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">imageBuffer</span> = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getFileBuffer</span>();</li><li>    <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">imageBuffer</span> == <span class="hljs-literal">undefined</span>){</li><li>      <span class="hljs-keyword">return</span>;</li><li>    }</li><li>    <span class="hljs-comment">// 图片处理为异步操作，可以依据是否需要拿到处理好的图片数据再进行下一步逻辑，按需添加await进行同步</span></li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">imagePixelMap</span> = <span class="hljs-keyword">await</span> <span class="hljs-title class_">ImageGrayscale</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">imageBuffer</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Image</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">imagePixelMap</span>)</li><li>        .<span class="hljs-title function_">width</span>(<span class="hljs-number">304</span>)</li><li>        .<span class="hljs-title function_">height</span>(<span class="hljs-number">305</span>)</li><li>    }</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div>     <p><span><img originheight="253" originwidth="603" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211115127.80127129897510659544569247802270:50001231000000:2800:01629FA703AFE44B727568A2CB63F90E52365F2845B0F3C7156218D11C86DEA7.png" width="603" height="253"></span></p>    </div>    <div class="tiledSection">     <h3 id="geteffectpixelmap11" device-type="phone,2in1,tablet,wearable,tv">getEffectPixelMap<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="geteffectpixelmap11" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>getEffectPixelMap(): Promise&lt;image.PixelMap&gt;</p>     <p>获取已添加链表效果的源图像的image.PixelMap，使用CPU渲染，使用Promise异步回调。</p>     <p><strong>卡片能力：</strong> 从API version 12开始，该接口支持在ArkTS卡片中使用。</p>     <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力：</strong> SystemCapability.Multimedia.Image.Core</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.28.8.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.28.8.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;image.PixelMap&gt;</td>         <td class="cellrowborder" width="50%">Promise对象。返回已添加链表效果的源图像的image.PixelMap。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-xgu-c106="" class="highlight-div"><div _ngcontent-xgu-c106="" class="highlight-div-header"><div _ngcontent-xgu-c106="" class="highlight-div-header-left"><div _ngcontent-xgu-c106="" class="handle-button expand-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xgu-c106="" class="highlight-div-header-right"><div _ngcontent-xgu-c106="" class="handle-button ai-button"></div><div _ngcontent-xgu-c106="" class="handle-button line-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xgu-c106="" class="handle-button theme-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xgu-c106="" class="handle-button copy-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xgu-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { image } <span class="hljs-keyword">from</span> <span class="hljs-string">"@kit.ImageKit"</span>;</li><li><span class="hljs-keyword">import</span> { effectKit } <span class="hljs-keyword">from</span> <span class="hljs-string">"@kit.ArkGraphics2D"</span>;</li><li>
</li><li><span class="hljs-keyword">const</span> color = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayBuffer</span>(<span class="hljs-number">96</span>);</li><li><span class="hljs-keyword">let</span> opts : image.<span class="hljs-property">InitializationOptions</span> = {</li><li>  <span class="hljs-attr">editable</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-attr">pixelFormat</span>: <span class="hljs-number">3</span>,</li><li>  <span class="hljs-attr">size</span>: {</li><li>    <span class="hljs-attr">height</span>: <span class="hljs-number">4</span>,</li><li>    <span class="hljs-attr">width</span>: <span class="hljs-number">6</span></li><li>  }</li><li>};</li><li>image.<span class="hljs-title function_">createPixelMap</span>(color, opts).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">pixelMap</span>) =&gt;</span> {</li><li>  effectKit.<span class="hljs-title function_">createEffect</span>(pixelMap).<span class="hljs-title function_">grayscale</span>().<span class="hljs-title function_">getEffectPixelMap</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">data</span> =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'getPixelBytesNumber = '</span>, data.<span class="hljs-title function_">getPixelBytesNumber</span>());</li><li>  })</li><li>})</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="geteffectpixelmap20" device-type="phone,2in1,tablet,wearable,tv">getEffectPixelMap<sup>20+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="geteffectpixelmap20" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>getEffectPixelMap(useCpuRender : boolean): Promise&lt;image.PixelMap&gt;</p>     <p>获取已添加链表效果的源图像的image.PixelMap，支持指定渲染模式（CPU渲染或者GPU渲染），使用Promise异步回调。</p>     <p><strong>卡片能力：</strong> 从API version 20开始，该接口支持在ArkTS卡片中使用。</p>     <p><strong>元服务API：</strong> 从API version 20开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力：</strong> SystemCapability.Multimedia.Image.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.29.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.29.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.29.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.29.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">useCpuRender</td>         <td class="cellrowborder" width="25%">boolean</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">指定渲染模式。true表示使用CPU渲染，false表示使用GPU渲染。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.29.10.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.29.10.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-image-pixelmap">image.PixelMap</a>&gt;</td>         <td class="cellrowborder" width="50%">Promise对象。返回已添加链表效果的源图像的image.PixelMap。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-xgu-c106="" class="highlight-div"><div _ngcontent-xgu-c106="" class="highlight-div-header"><div _ngcontent-xgu-c106="" class="highlight-div-header-left"><div _ngcontent-xgu-c106="" class="handle-button expand-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xgu-c106="" class="highlight-div-header-right"><div _ngcontent-xgu-c106="" class="handle-button ai-button"></div><div _ngcontent-xgu-c106="" class="handle-button line-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xgu-c106="" class="handle-button theme-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xgu-c106="" class="handle-button copy-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xgu-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { image } <span class="hljs-keyword">from</span> <span class="hljs-string">"@kit.ImageKit"</span>;</li><li><span class="hljs-keyword">import</span> { effectKit } <span class="hljs-keyword">from</span> <span class="hljs-string">"@kit.ArkGraphics2D"</span>;</li><li>
</li><li><span class="hljs-keyword">const</span> color = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayBuffer</span>(<span class="hljs-number">96</span>);</li><li><span class="hljs-keyword">let</span> opts : image.<span class="hljs-property">InitializationOptions</span> = {</li><li>  <span class="hljs-attr">editable</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-attr">pixelFormat</span>: <span class="hljs-number">3</span>,</li><li>  <span class="hljs-attr">size</span>: {</li><li>    <span class="hljs-attr">height</span>: <span class="hljs-number">4</span>,</li><li>    <span class="hljs-attr">width</span>: <span class="hljs-number">6</span></li><li>  }</li><li>};</li><li>image.<span class="hljs-title function_">createPixelMap</span>(color, opts).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">pixelMap</span>) =&gt;</span> {</li><li>  effectKit.<span class="hljs-title function_">createEffect</span>(pixelMap).<span class="hljs-title function_">grayscale</span>().<span class="hljs-title function_">getEffectPixelMap</span>(<span class="hljs-literal">false</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">data</span> =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'getPixelBytesNumber = '</span>, data.<span class="hljs-title function_">getPixelBytesNumber</span>());</li><li>  })</li><li>})</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="getpixelmapdeprecated" device-type="phone,2in1,tablet,wearable,tv">getPixelMap<sup>(deprecated)</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getpixelmapdeprecated" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>getPixelMap(): image.PixelMap</p>     <p>获取已添加链表效果的源图像的image.PixelMap。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>此接口从API version 9开始支持，从API version 11开始废弃，推荐使用<a href="/consumer/cn/doc/harmonyos-references/js-apis-effectkit#geteffectpixelmap11">getEffectPixelMap</a>。</p>      </div></div></div>     <p><strong>系统能力：</strong> SystemCapability.Multimedia.Image.Core</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.30.7.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.30.7.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-image-pixelmap">image.PixelMap</a></td>         <td class="cellrowborder" width="50%">已添加效果的源图像的image.PixelMap。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-xgu-c106="" class="highlight-div"><div _ngcontent-xgu-c106="" class="highlight-div-header"><div _ngcontent-xgu-c106="" class="highlight-div-header-left"><div _ngcontent-xgu-c106="" class="handle-button expand-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xgu-c106="" class="highlight-div-header-right"><div _ngcontent-xgu-c106="" class="handle-button ai-button"></div><div _ngcontent-xgu-c106="" class="handle-button line-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xgu-c106="" class="handle-button theme-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xgu-c106="" class="handle-button copy-button"><div _ngcontent-xgu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xgu-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { image } <span class="hljs-keyword">from</span> <span class="hljs-string">"@kit.ImageKit"</span>;</li><li><span class="hljs-keyword">import</span> { effectKit } <span class="hljs-keyword">from</span> <span class="hljs-string">"@kit.ArkGraphics2D"</span>;</li><li>
</li><li><span class="hljs-keyword">const</span> color = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayBuffer</span>(<span class="hljs-number">96</span>);</li><li><span class="hljs-keyword">let</span> opts : image.<span class="hljs-property">InitializationOptions</span> = {</li><li>  <span class="hljs-attr">editable</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-attr">pixelFormat</span>: <span class="hljs-number">3</span>,</li><li>  <span class="hljs-attr">size</span>: {</li><li>    <span class="hljs-attr">height</span>: <span class="hljs-number">4</span>,</li><li>    <span class="hljs-attr">width</span>: <span class="hljs-number">6</span></li><li>  }</li><li>};</li><li>image.<span class="hljs-title function_">createPixelMap</span>(color, opts).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">pixelMap</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">let</span> pixel = effectKit.<span class="hljs-title function_">createEffect</span>(pixelMap).<span class="hljs-title function_">grayscale</span>().<span class="hljs-title function_">getPixelMap</span>();</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'getPixelBytesNumber = '</span>, pixel.<span class="hljs-title function_">getPixelBytesNumber</span>());</li><li>})</li></ol></pre></div></div>    </div>   </div>   <div></div></div>