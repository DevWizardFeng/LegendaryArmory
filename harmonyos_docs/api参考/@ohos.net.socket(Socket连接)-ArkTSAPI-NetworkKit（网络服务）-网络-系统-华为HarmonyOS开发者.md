<h1 _ngcontent-fif-c119="" class="doc-title ng-star-inserted" title="@ohos.net.socket (Socket连接)"> @ohos.net.socket (Socket连接) </h1>

<div _ngcontent-fif-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted renderOptimization" style="position: relative;">   <div>    <p>本模块提供利用Socket进行数据传输的能力，支持TCPSocket、UDPSocket、WebSocket和TLSSocket。</p>    <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">      <p>本模块首批接口从API version 7开始支持。后续版本的新增接口，采用上角标单独标记接口的起始版本。</p>      <p>本模块API使用时建议放在worker线程或者taskpool中做网络操作，否则可能会导致UI线程卡顿。</p>     </div></div></div>    <div class="tiledSection scroll-inwindow" style="contain-intrinsic-size: auto 247px;">     <h2 id="导入模块" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">导入模块<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="导入模块" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li></ol></pre></div></div>    </div>    <div class="tiledSection scroll-inwindow" style="contain-intrinsic-size: auto 634px;">     <h2 id="socketconstructudpsocketinstance" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">socket.constructUDPSocketInstance<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="socketconstructudpsocketinstance" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>constructUDPSocketInstance(): UDPSocket</p>     <p>创建一个UDPSocket对象。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.4.6.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.4.6.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#udpsocket">UDPSocket</a></td>         <td class="cellrowborder" width="50%">返回一个UDPSocket对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">udp</span>: socket.<span class="hljs-property">UDPSocket</span> = socket.<span class="hljs-title function_">constructUDPSocketInstance</span>();</li></ol></pre></div></div>    </div>    <div class="tiledSection scroll-inwindow" style="contain-intrinsic-size: auto 182px;">     <h2 id="udpsocket" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">UDPSocket<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="udpsocket" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>UDPSocket连接。在调用UDPSocket的方法前，需要先通过<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#socketconstructudpsocketinstance">socket.constructUDPSocketInstance</a>创建UDPSocket对象。</p>    </div>    <div class="tiledSection scroll-inwindow" style="contain-intrinsic-size: auto 1317px;">     <h3 id="bind" device-type="phone,2in1,tablet,wearable,lite_wearable,tv" class="firsth2">bind<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="bind" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>bind(address: NetAddress, callback: AsyncCallback&lt;void&gt;): void</p>     <p>绑定IP地址和端口，端口可以由用户指定或由系统随机分配。使用callback方式作为异步方法。</p>     <p><strong>需要权限</strong>：ohos.permission.INTERNET</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.6.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.6.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.6.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.6.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">address</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#netaddress">NetAddress</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">本端地址信息，参考<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#netaddress">NetAddress</a>。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;void&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。成功返回空，失败返回错误码、错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.6.10.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.6.10.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">udp</span>: socket.<span class="hljs-property">UDPSocket</span> = socket.<span class="hljs-title function_">constructUDPSocketInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">bindAddr</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,  <span class="hljs-comment">// 本端地址</span></li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">1234</span></li><li>}</li><li>udp.<span class="hljs-title function_">bind</span>(bindAddr, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'bind fail'</span>);</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'bind success'</span>);</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1387px;">     <h3 id="bind-1" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">bind<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="bind-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>bind(address: NetAddress): Promise&lt;void&gt;</p>     <p>绑定IP地址和端口，端口可以由用户指定或由系统随机分配。使用Promise方式作为异步方法。</p>     <p><strong>需要权限</strong>：ohos.permission.INTERNET</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.7.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.7.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.7.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.7.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">address</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#netaddress">NetAddress</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">本端地址信息，参考<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#netaddress">NetAddress</a>。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.7.10.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.7.10.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.7.12.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.7.12.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">Promise对象。无返回结果的Promise对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">udp</span>: socket.<span class="hljs-property">UDPSocket</span> = socket.<span class="hljs-title function_">constructUDPSocketInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">bindAddr</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,  <span class="hljs-comment">// 本端地址</span></li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li>udp.<span class="hljs-title function_">bind</span>(bindAddr).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'bind success'</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'bind fail'</span>);</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 3297px;">     <h3 id="send" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">send<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="send" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>send(options: UDPSendOptions, callback: AsyncCallback&lt;void&gt;): void</p>     <p>通过UDPSocket连接发送数据。使用callback方式作为异步方法。</p>     <p>发送数据前，需要先调用<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#bind">UDPSocket.bind()</a>绑定IP地址和端口。该接口为耗时操作，请在Worker线程或taskpool线程调用该接口。</p>     <p><strong>需要权限</strong>：ohos.permission.INTERNET</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.8.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.8.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.8.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.8.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">options</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#udpsendoptions">UDPSendOptions</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">UDPSocket发送参数，参考<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#udpsendoptions">UDPSendOptions</a>。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;void&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。成功返回空，失败返回错误码、错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-net-socket">Socket错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.8.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.8.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301206</td>         <td class="cellrowborder" width="50%">Socks5 failed to connect to the proxy server.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301207</td>         <td class="cellrowborder" width="50%">Socks5 username or password is invalid.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301208</td>         <td class="cellrowborder" width="50%">Socks5 failed to connect to the remote server.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301209</td>         <td class="cellrowborder" width="50%">Socks5 failed to negotiate the authentication method.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301210</td>         <td class="cellrowborder" width="50%">Socks5 failed to send the message.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301211</td>         <td class="cellrowborder" width="50%">Socks5 failed to receive the message.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301212</td>         <td class="cellrowborder" width="50%">Socks5 serialization error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301213</td>         <td class="cellrowborder" width="50%">Socks5 deserialization error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">udp</span>: socket.<span class="hljs-property">UDPSocket</span> = socket.<span class="hljs-title function_">constructUDPSocketInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">bindAddr</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,  <span class="hljs-comment">// 本端地址</span></li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">1234</span></li><li>}</li><li>udp.<span class="hljs-title function_">bind</span>(bindAddr, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'bind fail'</span>);</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'bind success'</span>);</li><li>});</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">netAddress</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,  <span class="hljs-comment">// 对端地址</span></li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">sendOptions</span>: socket.<span class="hljs-property">UDPSendOptions</span> = {</li><li>  <span class="hljs-attr">data</span>: <span class="hljs-string">'Hello, server!'</span>,</li><li>  <span class="hljs-attr">address</span>: netAddress</li><li>}</li><li>udp.<span class="hljs-title function_">send</span>(sendOptions, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'send fail'</span>);</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'send success'</span>);</li><li>});</li></ol></pre></div></div>     <p><strong>示例（设置socket代理）：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">udp</span>: socket.<span class="hljs-property">UDPSocket</span> = socket.<span class="hljs-title function_">constructUDPSocketInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">bindAddr</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,  <span class="hljs-comment">// 本端地址</span></li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">1234</span></li><li>}</li><li>udp.<span class="hljs-title function_">bind</span>(bindAddr, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'bind fail'</span>);</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'bind success'</span>);</li><li>});</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">netAddress</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,  <span class="hljs-comment">// 对端地址</span></li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">socks5Server</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">proxyOptions</span>: socket.<span class="hljs-property">ProxyOptions</span> = {</li><li>  <span class="hljs-keyword">type</span> : <span class="hljs-number">1</span>,</li><li>  <span class="hljs-attr">address</span>: socks5Server,</li><li>  <span class="hljs-attr">username</span>: <span class="hljs-string">"xxx"</span>,</li><li>  <span class="hljs-attr">password</span>: <span class="hljs-string">"xxx"</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">sendOptions</span>: socket.<span class="hljs-property">UDPSendOptions</span> = {</li><li>  <span class="hljs-attr">data</span>: <span class="hljs-string">'Hello, server!'</span>,</li><li>  <span class="hljs-attr">address</span>: netAddress,</li><li>  <span class="hljs-attr">proxy</span>: proxyOptions,</li><li>}</li><li>udp.<span class="hljs-title function_">send</span>(sendOptions, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'send fail'</span>);</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'send success'</span>);</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 3255px;">     <h3 id="send-1" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">send<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="send-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>send(options: UDPSendOptions): Promise&lt;void&gt;</p>     <p>通过UDPSocket连接发送数据。使用Promise方式作为异步方法。</p>     <p>发送数据前，需要先调用<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#bind">UDPSocket.bind()</a>绑定IP地址和端口。该接口为耗时操作，请在Worker线程或taskpool线程调用该接口。</p>     <p><strong>需要权限</strong>：ohos.permission.INTERNET</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.9.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.9.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.9.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.9.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">options</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#udpsendoptions">UDPSendOptions</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">UDPSocket发送参数，参考<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#udpsendoptions">UDPSendOptions</a>。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-net-socket">Socket错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.9.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.9.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301206</td>         <td class="cellrowborder" width="50%">Socks5 failed to connect to the proxy server.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301207</td>         <td class="cellrowborder" width="50%">Socks5 username or password is invalid.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301208</td>         <td class="cellrowborder" width="50%">Socks5 failed to connect to the remote server.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301209</td>         <td class="cellrowborder" width="50%">Socks5 failed to negotiate the authentication method.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301210</td>         <td class="cellrowborder" width="50%">Socks5 failed to send the message.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301211</td>         <td class="cellrowborder" width="50%">Socks5 failed to receive the message.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301212</td>         <td class="cellrowborder" width="50%">Socks5 serialization error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301213</td>         <td class="cellrowborder" width="50%">Socks5 deserialization error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.9.13.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.9.13.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">Promise对象。无返回结果的Promise对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">udp</span>: socket.<span class="hljs-property">UDPSocket</span> = socket.<span class="hljs-title function_">constructUDPSocketInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">bindAddr</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>, <span class="hljs-comment">// 本端地址</span></li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li>udp.<span class="hljs-title function_">bind</span>(bindAddr).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'bind success'</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'bind fail'</span>);</li><li>  <span class="hljs-keyword">return</span>;</li><li>});</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">netAddress</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>, <span class="hljs-comment">// 对端地址</span></li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">sendOptions</span>: socket.<span class="hljs-property">UDPSendOptions</span> = {</li><li>  <span class="hljs-attr">data</span>: <span class="hljs-string">'Hello, server!'</span>,</li><li>  <span class="hljs-attr">address</span>: netAddress</li><li>}</li><li>udp.<span class="hljs-title function_">send</span>(sendOptions).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'send success'</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'send fail'</span>);</li><li>});</li></ol></pre></div></div>     <p><strong>示例（设置socket代理）：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">udp</span>: socket.<span class="hljs-property">UDPSocket</span> = socket.<span class="hljs-title function_">constructUDPSocketInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">bindAddr</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>, <span class="hljs-comment">// 本端地址</span></li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li>udp.<span class="hljs-title function_">bind</span>(bindAddr).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'bind success'</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'bind fail'</span>);</li><li>  <span class="hljs-keyword">return</span>;</li><li>});</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">netAddress</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>, <span class="hljs-comment">// 对端地址</span></li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">socks5Server</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">proxyOptions</span>: socket.<span class="hljs-property">ProxyOptions</span> = {</li><li>  <span class="hljs-keyword">type</span> : <span class="hljs-number">1</span>,</li><li>  <span class="hljs-attr">address</span>: socks5Server,</li><li>  <span class="hljs-attr">username</span>: <span class="hljs-string">"xxx"</span>,</li><li>  <span class="hljs-attr">password</span>: <span class="hljs-string">"xxx"</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">sendOptions</span>: socket.<span class="hljs-property">UDPSendOptions</span> = {</li><li>  <span class="hljs-attr">data</span>: <span class="hljs-string">'Hello, server!'</span>,</li><li>  <span class="hljs-attr">address</span>: netAddress,</li><li>  <span class="hljs-attr">proxy</span>: proxyOptions,</li><li>}</li><li>udp.<span class="hljs-title function_">send</span>(sendOptions).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'send success'</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'send fail'</span>);</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1113px;">     <h3 id="close" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">close<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="close" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>close(callback: AsyncCallback&lt;void&gt;): void</p>     <p>关闭UDPSocket连接。使用callback方式作为异步方法。</p>     <p><strong>需要权限</strong>：ohos.permission.INTERNET</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.10.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.10.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.10.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.10.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;void&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。关闭UDPSocket连接后触发回调函数。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.10.10.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.10.10.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">udp</span>: socket.<span class="hljs-property">UDPSocket</span> = socket.<span class="hljs-title function_">constructUDPSocketInstance</span>();</li><li>udp.<span class="hljs-title function_">close</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'close fail'</span>);</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'close success'</span>);</li><li>})</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1061px;">     <h3 id="close-1" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">close<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="close-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>close(): Promise&lt;void&gt;</p>     <p>关闭UDPSocket连接。使用Promise方式作为异步方法。</p>     <p><strong>需要权限</strong>：ohos.permission.INTERNET</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.11.8.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.11.8.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.11.10.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.11.10.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">Promise对象。无返回结果的Promise对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">udp</span>: socket.<span class="hljs-property">UDPSocket</span> = socket.<span class="hljs-title function_">constructUDPSocketInstance</span>();</li><li>udp.<span class="hljs-title function_">close</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'close success'</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'close fail'</span>);</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1493px;">     <h3 id="getstate" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">getState<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getstate" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>getState(callback: AsyncCallback&lt;SocketStateBase&gt;): void</p>     <p>获取UDPSocket状态。使用callback方式作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>bind方法调用成功后，才可调用此方法。</p>      </div></div></div>     <p><strong>需要权限</strong>：ohos.permission.INTERNET</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.12.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.12.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.12.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.12.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#socketstatebase">SocketStateBase</a>&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。成功返回UDPSocket状态信息，失败返回错误码、错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.12.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.12.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">udp</span>: socket.<span class="hljs-property">UDPSocket</span> = socket.<span class="hljs-title function_">constructUDPSocketInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">bindAddr</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li>udp.<span class="hljs-title function_">bind</span>(bindAddr, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'bind fail'</span>);</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'bind success'</span>);</li><li>  udp.<span class="hljs-title function_">getState</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError, data: socket.SocketStateBase</span>) =&gt;</span> {</li><li>    <span class="hljs-keyword">if</span> (err) {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'getState fail'</span>);</li><li>      <span class="hljs-keyword">return</span>;</li><li>    }</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'getState success:'</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data));</li><li>  })</li><li>})</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1417px;">     <h3 id="getstate-1" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">getState<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getstate-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>getState(): Promise&lt;SocketStateBase&gt;</p>     <p>获取UDPSocket状态。使用Promise方式作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>bind方法调用成功后，才可调用此方法。</p>      </div></div></div>     <p><strong>需要权限</strong>：ohos.permission.INTERNET</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.13.9.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.13.9.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.13.11.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.13.11.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#socketstatebase">SocketStateBase</a>&gt;</td>         <td class="cellrowborder" width="50%">以Promise形式返回获取UDPSocket状态的结果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">udp</span>: socket.<span class="hljs-property">UDPSocket</span> = socket.<span class="hljs-title function_">constructUDPSocketInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">bindAddr</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li>udp.<span class="hljs-title function_">bind</span>(bindAddr, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'bind fail'</span>);</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'bind success'</span>);</li><li>  udp.<span class="hljs-title function_">getState</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">data: socket.SocketStateBase</span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'getState success:'</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data));</li><li>  }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'getState fail'</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));</li><li>  });</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1809px;">     <h3 id="setextraoptions" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">setExtraOptions<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="setextraoptions" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>setExtraOptions(options: UDPExtraOptions, callback: AsyncCallback&lt;void&gt;): void</p>     <p>设置UDPSocket连接的其他属性。使用callback方式作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>bind方法调用成功后，才可调用此方法。</p>      </div></div></div>     <p><strong>需要权限</strong>：ohos.permission.INTERNET</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.14.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.14.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.14.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.14.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">options</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#udpextraoptions">UDPExtraOptions</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">UDPSocket连接的其他属性，参考<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#udpextraoptions">UDPExtraOptions</a>。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;void&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。成功返回空，失败返回错误码、错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.14.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.14.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">udp</span>: socket.<span class="hljs-property">UDPSocket</span> = socket.<span class="hljs-title function_">constructUDPSocketInstance</span>();</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">bindAddr</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li>udp.<span class="hljs-title function_">bind</span>(bindAddr, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'bind fail'</span>);</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'bind success'</span>);</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">udpextraoptions</span>: socket.<span class="hljs-property">UDPExtraOptions</span> = {</li><li>    <span class="hljs-attr">receiveBufferSize</span>: <span class="hljs-number">8192</span>,</li><li>    <span class="hljs-attr">sendBufferSize</span>: <span class="hljs-number">8192</span>,</li><li>    <span class="hljs-attr">reuseAddress</span>: <span class="hljs-literal">false</span>,</li><li>    <span class="hljs-attr">socketTimeout</span>: <span class="hljs-number">6000</span>,</li><li>    <span class="hljs-attr">broadcast</span>: <span class="hljs-literal">true</span></li><li>  }</li><li>  udp.<span class="hljs-title function_">setExtraOptions</span>(udpextraoptions, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>    <span class="hljs-keyword">if</span> (err) {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'setExtraOptions fail'</span>);</li><li>      <span class="hljs-keyword">return</span>;</li><li>    }</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'setExtraOptions success'</span>);</li><li>  })</li><li>})</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1863px;">     <h3 id="setextraoptions-1" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">setExtraOptions<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="setextraoptions-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>setExtraOptions(options: UDPExtraOptions): Promise&lt;void&gt;</p>     <p>设置UDPSocket连接的其他属性。使用Promise方式作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>bind方法调用成功后，才可调用此方法。</p>      </div></div></div>     <p><strong>需要权限</strong>：ohos.permission.INTERNET</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.15.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.15.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.15.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.15.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">options</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#udpextraoptions">UDPExtraOptions</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">UDPSocket连接的其他属性，参考<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#udpextraoptions">UDPExtraOptions</a>。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.15.10.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.15.10.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">Promise对象。无返回结果的Promise对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.15.13.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.15.13.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">udp</span>: socket.<span class="hljs-property">UDPSocket</span> = socket.<span class="hljs-title function_">constructUDPSocketInstance</span>();</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">bindAddr</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li>udp.<span class="hljs-title function_">bind</span>(bindAddr, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'bind fail'</span>);</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'bind success'</span>);</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">udpextraoptions</span>: socket.<span class="hljs-property">UDPExtraOptions</span> = {</li><li>    <span class="hljs-attr">receiveBufferSize</span>: <span class="hljs-number">8192</span>,</li><li>    <span class="hljs-attr">sendBufferSize</span>: <span class="hljs-number">8192</span>,</li><li>    <span class="hljs-attr">reuseAddress</span>: <span class="hljs-literal">false</span>,</li><li>    <span class="hljs-attr">socketTimeout</span>: <span class="hljs-number">6000</span>,</li><li>    <span class="hljs-attr">broadcast</span>: <span class="hljs-literal">true</span></li><li>  }</li><li>  udp.<span class="hljs-title function_">setExtraOptions</span>(udpextraoptions).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'setExtraOptions success'</span>);</li><li>  }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'setExtraOptions fail'</span>);</li><li>  });</li><li>})</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1455px;">     <h3 id="getlocaladdress12" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">getLocalAddress<sup>12+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getlocaladdress12" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>getLocalAddress(): Promise&lt;NetAddress&gt;</p>     <p>获取UDP连接的本地Socket地址。使用Promise方式作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>bind方法调用成功后，才可调用此方法。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.16.7.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.16.7.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#netaddress">NetAddress</a>&gt;</td>         <td class="cellrowborder" width="50%">以Promise形式返回获取本地socket地址的结果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-net-socket">Socket错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.16.10.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.16.10.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">2300002</td>         <td class="cellrowborder" width="50%">System internal error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301009</td>         <td class="cellrowborder" width="50%">Bad file descriptor.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303188</td>         <td class="cellrowborder" width="50%">Socket operation on non-socket.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">udp</span>: socket.<span class="hljs-property">UDPSocket</span> = socket.<span class="hljs-title function_">constructUDPSocketInstance</span>();</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">bindAddr</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li>udp.<span class="hljs-title function_">bind</span>(bindAddr).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'bind success'</span>);</li><li>  udp.<span class="hljs-title function_">getLocalAddress</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">localAddress: socket.NetAddress</span>) =&gt;</span> {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"UDP_Socket get SUCCESS! Address："</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(localAddress));</li><li>      }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"UDP_Socket get FAILED! Error: "</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));</li><li>      })</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'bind fail'</span>);</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1083px;">     <h3 id="onmessage" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">on('message')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onmessage" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>on(type: 'message', callback: Callback&lt;SocketMessageInfo&gt;): void</p>     <p>订阅UDPSocket连接的接收消息事件。使用callback方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.17.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.17.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.17.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.17.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">订阅的事件类型。'message'：接收消息事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#socketmessageinfo11">SocketMessageInfo</a>&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。返回订阅某类事件后UDPSocket连接成功的状态信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">udp</span>: socket.<span class="hljs-property">UDPSocket</span> = socket.<span class="hljs-title function_">constructUDPSocketInstance</span>();</li><li>
</li><li>udp.<span class="hljs-title function_">on</span>(<span class="hljs-string">'message'</span>, <span class="hljs-function">(<span class="hljs-params">value: socket.SocketMessageInfo</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">let</span> messageView = <span class="hljs-string">''</span>;</li><li>  <span class="hljs-keyword">let</span> uint8Array = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(value.<span class="hljs-property">message</span>);</li><li>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> <span class="hljs-attr">i</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>; i &lt; value.<span class="hljs-property">message</span>.<span class="hljs-property">byteLength</span>; i++) {</li><li>    <span class="hljs-keyword">let</span> messages = uint8Array[i];</li><li>    <span class="hljs-keyword">let</span> message = <span class="hljs-title class_">String</span>.<span class="hljs-title function_">fromCharCode</span>(messages);</li><li>    messageView += message;</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'on message message: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(messageView));</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'remoteInfo: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(value.<span class="hljs-property">remoteInfo</span>));</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1179px;">     <h3 id="offmessage" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">off('message')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="offmessage" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>off(type: 'message', callback?: Callback&lt;SocketMessageInfo&gt;): void</p>     <p>取消订阅UDPSocket连接的接收消息事件。使用callback方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.18.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.18.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.18.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.18.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">取消订阅的事件类型。'message'：接收消息事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#socketmessageinfo11">SocketMessageInfo</a>&gt;</td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">回调函数。可以指定传入on中的callback取消对应的订阅，也可以不指定callback清空所有订阅。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">udp</span>: socket.<span class="hljs-property">UDPSocket</span> = socket.<span class="hljs-title function_">constructUDPSocketInstance</span>();</li><li><span class="hljs-keyword">let</span> messageView = <span class="hljs-string">''</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-title function_">callback</span> = (<span class="hljs-params">value: socket.SocketMessageInfo</span>) =&gt; {</li><li>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> <span class="hljs-attr">i</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>; i &lt; value.<span class="hljs-property">message</span>.<span class="hljs-property">byteLength</span>; i++) {</li><li>    <span class="hljs-keyword">let</span> uint8Array = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(value.<span class="hljs-property">message</span>)</li><li>    <span class="hljs-keyword">let</span> messages = uint8Array[i]</li><li>    <span class="hljs-keyword">let</span> message = <span class="hljs-title class_">String</span>.<span class="hljs-title function_">fromCharCode</span>(messages);</li><li>    messageView += message;</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'on message message: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(messageView));</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'remoteInfo: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(value.<span class="hljs-property">remoteInfo</span>));</li><li>}</li><li>udp.<span class="hljs-title function_">on</span>(<span class="hljs-string">'message'</span>, callback);</li><li><span class="hljs-comment">// 可以指定传入on中的callback取消一个订阅，也可以不指定callback清空所有订阅。</span></li><li>udp.<span class="hljs-title function_">off</span>(<span class="hljs-string">'message'</span>, callback);</li><li>udp.<span class="hljs-title function_">off</span>(<span class="hljs-string">'message'</span>);</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 987px;">     <h3 id="onlistening--close" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">on('listening' | 'close')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onlistening--close" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>on(type: 'listening' | 'close', callback: Callback&lt;void&gt;): void</p>     <p>订阅UDPSocket连接的数据包消息事件或关闭事件。使用callback方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.19.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.19.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.19.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.19.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">          <p>订阅的事件类型。</p>          <p>- 'listening'：数据包消息事件。</p>          <p>- 'close'：关闭事件。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;void&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。UDPSocket连接的某类数据包消息事件或关闭事件发生变化后触发回调函数。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">udp</span>: socket.<span class="hljs-property">UDPSocket</span> = socket.<span class="hljs-title function_">constructUDPSocketInstance</span>();</li><li>udp.<span class="hljs-title function_">on</span>(<span class="hljs-string">'listening'</span>, <span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"on listening success"</span>);</li><li>});</li><li>udp.<span class="hljs-title function_">on</span>(<span class="hljs-string">'close'</span>, <span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"on close success"</span>);</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1179px;">     <h3 id="offlistening--close" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">off('listening' | 'close')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="offlistening--close" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>off(type: 'listening' | 'close', callback?: Callback&lt;void&gt;): void</p>     <p>取消订阅UDPSocket连接的数据包消息事件或关闭事件。使用callback方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.20.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.20.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.20.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.20.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">          <p>取消订阅事件类型。</p>          <p>- 'listening'：数据包消息事件。</p>          <p>- 'close'：关闭事件。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;void&gt;</td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">回调函数。可以指定传入on中的callback取消对应的订阅，也可以不指定callback清空所有订阅。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">udp</span>: socket.<span class="hljs-property">UDPSocket</span> = socket.<span class="hljs-title function_">constructUDPSocketInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-title function_">callback1</span> = (<span class="hljs-params"></span>) =&gt; {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"on listening, success"</span>);</li><li>}</li><li>udp.<span class="hljs-title function_">on</span>(<span class="hljs-string">'listening'</span>, callback1);</li><li><span class="hljs-comment">// 可以指定传入on中的callback取消一个订阅，也可以不指定callback清空所有订阅。</span></li><li>udp.<span class="hljs-title function_">off</span>(<span class="hljs-string">'listening'</span>, callback1);</li><li>udp.<span class="hljs-title function_">off</span>(<span class="hljs-string">'listening'</span>);</li><li><span class="hljs-keyword">let</span> <span class="hljs-title function_">callback2</span> = (<span class="hljs-params"></span>) =&gt; {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"on close, success"</span>);</li><li>}</li><li>udp.<span class="hljs-title function_">on</span>(<span class="hljs-string">'close'</span>, callback2);</li><li><span class="hljs-comment">// 可以指定传入on中的callback取消一个订阅，也可以不指定callback清空所有订阅。</span></li><li>udp.<span class="hljs-title function_">off</span>(<span class="hljs-string">'close'</span>, callback2);</li><li>udp.<span class="hljs-title function_">off</span>(<span class="hljs-string">'close'</span>);</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 843px;">     <h3 id="onerror" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">on('error')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onerror" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>on(type: 'error', callback: ErrorCallback): void</p>     <p>订阅UDPSocket连接的error事件。使用callback方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.21.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.21.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.21.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.21.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">订阅的事件类型。'error'：error事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">ErrorCallback</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。UDPSocket连接发生error事件后触发回调函数。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">udp</span>: socket.<span class="hljs-property">UDPSocket</span> = socket.<span class="hljs-title function_">constructUDPSocketInstance</span>();</li><li>udp.<span class="hljs-title function_">on</span>(<span class="hljs-string">'error'</span>, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"on error, err:"</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err))</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 963px;">     <h3 id="offerror" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">off('error')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="offerror" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>off(type: 'error', callback?: ErrorCallback): void</p>     <p>取消订阅UDPSocket连接的error事件。使用callback方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.22.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.22.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.22.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.22.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">取消订阅的事件类型。'error'：error事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">ErrorCallback</td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">回调函数。可以指定传入on中的callback取消对应的订阅，也可以不指定callback清空所有订阅。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">udp</span>: socket.<span class="hljs-property">UDPSocket</span> = socket.<span class="hljs-title function_">constructUDPSocketInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-title function_">callback</span> = (<span class="hljs-params">err: BusinessError</span>) =&gt; {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"on error, err:"</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));</li><li>}</li><li>udp.<span class="hljs-title function_">on</span>(<span class="hljs-string">'error'</span>, callback);</li><li><span class="hljs-comment">// 可以指定传入on中的callback取消一个订阅，也可以不指定callback清空所有订阅。</span></li><li>udp.<span class="hljs-title function_">off</span>(<span class="hljs-string">'error'</span>, callback);</li><li>udp.<span class="hljs-title function_">off</span>(<span class="hljs-string">'error'</span>);</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 759px;">     <h2 id="netaddress" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">NetAddress<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="netaddress" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>目标地址信息。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.23.4.1.6.1.1" width="20%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.23.4.1.6.1.2" width="20%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.23.4.1.6.1.3" width="20%">只读</th>         <th align="left" class="cellrowborder" id="mcps1.3.23.4.1.6.1.4" width="20%">可选</th>         <th align="left" class="cellrowborder" id="mcps1.3.23.4.1.6.1.5" width="20%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">address<sup>11+</sup></td>         <td class="cellrowborder" width="20%">string</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">本地绑定的ip地址。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">port</td>         <td class="cellrowborder" width="20%">number</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">端口号 ，范围0~65535。如果不指定系统随机分配端口。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">family</td>         <td class="cellrowborder" width="20%">number</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">          <p>网络协议类型，可选类型：</p>          <p>- 1：IPv4。默认为1。</p>          <p>- 2：IPv6。地址为IPV6类型，该字段必须被显式指定为2。</p>          <p>- 3：Domain<sup>18+</sup>。地址为Domain类型，该字段必须被显式指定为3。当前仅支持<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#connect">TCPSocket.connect</a>和<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#connect9">TLSSocket.connect</a>。</p></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 540px;">     <h2 id="proxyoptions18" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">ProxyOptions<sup>18+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="proxyoptions18" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>Socket代理信息。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.24.4.1.6.1.1" width="20%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.24.4.1.6.1.2" width="20%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.24.4.1.6.1.3" width="20%">只读</th>         <th align="left" class="cellrowborder" id="mcps1.3.24.4.1.6.1.4" width="20%">可选</th>         <th align="left" class="cellrowborder" id="mcps1.3.24.4.1.6.1.5" width="20%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">type</td>         <td class="cellrowborder" width="20%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#proxytypes18">ProxyTypes</a></td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">代理类型。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">address</td>         <td class="cellrowborder" width="20%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#netaddress">NetAddress</a></td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">代理地址信息。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">username</td>         <td class="cellrowborder" width="20%">string</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">指定用户名，如果使用用户密码验证方式。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">password</td>         <td class="cellrowborder" width="20%">string</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">指定密码，如果使用用户密码验证方式。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 378px;">     <h2 id="proxytypes18" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">ProxyTypes<sup>18+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="proxytypes18" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>Socket代理类型。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.25.4.1.4.1.1" width="33.33333333333333%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.25.4.1.4.1.2" width="33.33333333333333%">值</th>         <th align="left" class="cellrowborder" id="mcps1.3.25.4.1.4.1.3" width="33.33333333333333%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="33.33333333333333%">NONE</td>         <td class="cellrowborder" width="33.33333333333333%">0</td>         <td class="cellrowborder" width="33.33333333333333%">不使用代理。</td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">SOCKS5</td>         <td class="cellrowborder" width="33.33333333333333%">1</td>         <td class="cellrowborder" width="33.33333333333333%">使用Socks5代理。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 447px;">     <h2 id="udpsendoptions" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">UDPSendOptions<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="udpsendoptions" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>UDPSocket发送参数。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.26.4.1.6.1.1" width="20%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.26.4.1.6.1.2" width="20%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.26.4.1.6.1.3" width="20%">只读</th>         <th align="left" class="cellrowborder" id="mcps1.3.26.4.1.6.1.4" width="20%">可选</th>         <th align="left" class="cellrowborder" id="mcps1.3.26.4.1.6.1.5" width="20%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">data</td>         <td class="cellrowborder" width="20%">string | ArrayBuffer</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">发送的数据。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">address</td>         <td class="cellrowborder" width="20%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#netaddress">NetAddress</a></td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">目标地址信息。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">proxy<sup>18+</sup></td>         <td class="cellrowborder" width="20%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#proxyoptions18">ProxyOptions</a></td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">使用的代理信息，默认不使用代理。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 405px;">     <h2 id="udpextraoptions" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">UDPExtraOptions<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="udpextraoptions" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>UDPSocket连接的其他属性。继承自<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#extraoptionsbase7">ExtraOptionsBase</a>。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.27.4.1.6.1.1" width="20%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.27.4.1.6.1.2" width="20%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.27.4.1.6.1.3" width="20%">只读</th>         <th align="left" class="cellrowborder" id="mcps1.3.27.4.1.6.1.4" width="20%">可选</th>         <th align="left" class="cellrowborder" id="mcps1.3.27.4.1.6.1.5" width="20%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">broadcast</td>         <td class="cellrowborder" width="20%">boolean</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">是否可以发送广播。true表示可发送广播，false表示不可发送广播。默认为false。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 378px;">     <h2 id="socketmessageinfo11" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">SocketMessageInfo<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="socketmessageinfo11" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>socket连接信息</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.28.4.1.6.1.1" width="20%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.28.4.1.6.1.2" width="20%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.28.4.1.6.1.3" width="20%">只读</th>         <th align="left" class="cellrowborder" id="mcps1.3.28.4.1.6.1.4" width="20%">可选</th>         <th align="left" class="cellrowborder" id="mcps1.3.28.4.1.6.1.5" width="20%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">message</td>         <td class="cellrowborder" width="20%">ArrayBuffer</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">接收的事件消息。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">remoteInfo</td>         <td class="cellrowborder" width="20%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#socketremoteinfo">SocketRemoteInfo</a></td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">socket连接信息。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 495px;">     <h2 id="socketstatebase" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">SocketStateBase<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="socketstatebase" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>Socket的状态信息。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.29.4.1.6.1.1" width="20%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.29.4.1.6.1.2" width="20%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.29.4.1.6.1.3" width="20%">只读</th>         <th align="left" class="cellrowborder" id="mcps1.3.29.4.1.6.1.4" width="20%">可选</th>         <th align="left" class="cellrowborder" id="mcps1.3.29.4.1.6.1.5" width="20%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">isBound</td>         <td class="cellrowborder" width="20%">boolean</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是否绑定。true：绑定；false：不绑定。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">isClose</td>         <td class="cellrowborder" width="20%">boolean</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是否关闭。true：关闭；false：打开。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">isConnected</td>         <td class="cellrowborder" width="20%">boolean</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是否连接。true：连接；false：断开。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 612px;">     <h2 id="socketremoteinfo" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">SocketRemoteInfo<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="socketremoteinfo" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>Socket的连接信息。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.30.4.1.6.1.1" width="20%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.30.4.1.6.1.2" width="20%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.30.4.1.6.1.3" width="20%">只读</th>         <th align="left" class="cellrowborder" id="mcps1.3.30.4.1.6.1.4" width="20%">可选</th>         <th align="left" class="cellrowborder" id="mcps1.3.30.4.1.6.1.5" width="20%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">address</td>         <td class="cellrowborder" width="20%">string</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">本地绑定的ip地址。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">family</td>         <td class="cellrowborder" width="20%">'IPv4' | 'IPv6'</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">          <p>网络协议类型，可选类型：</p>          <p>- IPv4</p>          <p>- IPv6</p>          <p>默认为IPv4。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">port</td>         <td class="cellrowborder" width="20%">number</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">端口号，范围0~65535。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">size</td>         <td class="cellrowborder" width="20%">number</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">服务器响应信息的字节长度。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 230px;">     <h2 id="udp-错误码说明" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">UDP 错误码说明<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="udp-错误码说明" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>UDP 其余错误码映射形式为：2301000 + Linux内核错误码。</p>     <p>错误码的详细介绍参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-net-socket">Socket错误码</a>。</p>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 634px;">     <h2 id="socketconstructmulticastsocketinstance11" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">socket.constructMulticastSocketInstance<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="socketconstructmulticastsocketinstance11" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>constructMulticastSocketInstance(): MulticastSocket</p>     <p>创建一个MulticastSocket对象。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.32.6.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.32.6.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#multicastsocket11">MulticastSocket</a></td>         <td class="cellrowborder" width="50%">返回一个MulticastSocket对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">multicast</span>: socket.<span class="hljs-property">MulticastSocket</span> = socket.<span class="hljs-title function_">constructMulticastSocketInstance</span>();</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 206px;">     <h2 id="multicastsocket11" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">MulticastSocket<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="multicastsocket11" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>MulticastSocket连接。在调用MulticastSocket的方法前，需要先通过<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#socketconstructmulticastsocketinstance11">socket.constructMulticastSocketInstance</a>创建MulticastSocket对象。</p>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1574px;">     <h3 id="addmembership11" device-type="phone,2in1,tablet,wearable,lite_wearable,tv" class="firsth2">addMembership<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="addmembership11" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>addMembership(multicastAddress: NetAddress, callback: AsyncCallback&lt;void&gt;): void</p>     <p>加入多播组。使用callback方法作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>多播使用的IP地址属于特定的范围（例如224.0.0.0到239.255.255.255）。</p>       <p>加入多播组后，既可以是发送端，也可以是接收端，相互之间以广播的形式传递数据，不区分客户端或服务端。</p>      </div></div></div>     <p><strong>需要权限</strong>：ohos.permission.INTERNET</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.34.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.34.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.34.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.34.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">multicastAddress</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#netaddress">NetAddress</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">目标地址信息，参考<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#netaddress">NetAddress</a>。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;void&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。失败返回错误码、错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-net-socket">Socket错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.34.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.34.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301022</td>         <td class="cellrowborder" width="50%">Invalid argument.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301088</td>         <td class="cellrowborder" width="50%">Not a socket.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301098</td>         <td class="cellrowborder" width="50%">Address in use.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">multicast</span>: socket.<span class="hljs-property">MulticastSocket</span> = socket.<span class="hljs-title function_">constructMulticastSocketInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">addr</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'239.255.0.1'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li>multicast.<span class="hljs-title function_">addMembership</span>(addr, <span class="hljs-function">(<span class="hljs-params">err: <span class="hljs-built_in">Object</span></span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'add membership fail, err: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'add membership success'</span>);</li><li>})</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1613px;">     <h3 id="addmembership11-1" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">addMembership<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="addmembership11-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>addMembership(multicastAddress: NetAddress): Promise&lt;void&gt;</p>     <p>加入多播组。使用Promise方法作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>多播使用的IP地址属于特定的范围（例如224.0.0.0到239.255.255.255）。</p>       <p>加入多播组后，既可以是发送端，也可以是接收端，相互之间以广播的形式传递数据，不区分客户端或服务端。</p>      </div></div></div>     <p><strong>需要权限</strong>：ohos.permission.INTERNET</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.35.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.35.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.35.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.35.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">multicastAddress</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#netaddress">NetAddress</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">目标地址信息，参考<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#netaddress">NetAddress</a>。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.35.10.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.35.10.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">以Promise形式返回MulticastSocket加入多播组的行为结果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-net-socket">Socket错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.35.13.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.35.13.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301088</td>         <td class="cellrowborder" width="50%">Not a socket.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301098</td>         <td class="cellrowborder" width="50%">Address in use.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">multicast</span>: socket.<span class="hljs-property">MulticastSocket</span> = socket.<span class="hljs-title function_">constructMulticastSocketInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">addr</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'239.255.0.1'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li>multicast.<span class="hljs-title function_">addMembership</span>(addr).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'addMembership success'</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: <span class="hljs-built_in">Object</span></span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'addMembership fail'</span>);</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1535px;">     <h3 id="dropmembership11" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">dropMembership<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="dropmembership11" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>dropMembership(multicastAddress: NetAddress, callback: AsyncCallback&lt;void&gt;): void</p>     <p>退出多播组。使用callback方法作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>多播使用的IP地址属于特定的范围（例如224.0.0.0到239.255.255.255）。</p>       <p>从已加入的多播组中退出，必须在加入多播组 <a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#addmembership11">addMembership</a> 之后退出才有效。</p>      </div></div></div>     <p><strong>需要权限</strong>：ohos.permission.INTERNET</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.36.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.36.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.36.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.36.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">multicastAddress</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#netaddress">NetAddress</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">目标地址信息，参考<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#netaddress">NetAddress</a>。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;void&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。失败返回错误码、错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-net-socket">Socket错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.36.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.36.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301088</td>         <td class="cellrowborder" width="50%">Not a socket.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301098</td>         <td class="cellrowborder" width="50%">Address in use.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">multicast</span>: socket.<span class="hljs-property">MulticastSocket</span> = socket.<span class="hljs-title function_">constructMulticastSocketInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">addr</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'239.255.0.1'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li>multicast.<span class="hljs-title function_">dropMembership</span>(addr, <span class="hljs-function">(<span class="hljs-params">err: <span class="hljs-built_in">Object</span></span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'drop membership fail, err: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'drop membership success'</span>);</li><li>})</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1613px;">     <h3 id="dropmembership11-1" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">dropMembership<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="dropmembership11-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>dropMembership(multicastAddress: NetAddress): Promise&lt;void&gt;</p>     <p>退出多播组。使用Promise方法作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>多播使用的IP地址属于特定的范围（例如224.0.0.0到239.255.255.255）。</p>       <p>从已加入的多播组中退出，必须在加入多播组 <a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#addmembership11">addMembership</a> 之后退出才有效。</p>      </div></div></div>     <p><strong>需要权限</strong>：ohos.permission.INTERNET</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.37.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.37.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.37.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.37.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">multicastAddress</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#netaddress">NetAddress</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">目标地址信息，参考<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#netaddress">NetAddress</a>。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.37.10.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.37.10.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">以Promise形式返回MulticastSocket加入多播组的执行结果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-net-socket">Socket错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.37.13.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.37.13.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301088</td>         <td class="cellrowborder" width="50%">Not a socket.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301098</td>         <td class="cellrowborder" width="50%">Address in use.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">multicast</span>: socket.<span class="hljs-property">MulticastSocket</span> = socket.<span class="hljs-title function_">constructMulticastSocketInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">addr</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'239.255.0.1'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li>multicast.<span class="hljs-title function_">dropMembership</span>(addr).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'drop membership success'</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: <span class="hljs-built_in">Object</span></span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'drop membership fail'</span>);</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1432px;">     <h3 id="setmulticastttl11" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">setMulticastTTL<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="setmulticastttl11" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>setMulticastTTL(ttl: number, callback: AsyncCallback&lt;void&gt;): void</p>     <p>设置多播通信时数据包在网络传输过程中路由器最大跳数。使用callback方法作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>用于限制数据包在网络中传输时能够经过的最大路由器跳数的字段，TTL (Time to live)。</p>       <p>范围为 0～255，默认值为 1 。</p>       <p>如果一个多播数据包的 TTL 值为 1，那么它只能被直接连接到发送者的主机接收。如果 TTL 被设置为一个较大的值，那么数据包就能够被传送到更远的网络范围内。</p>       <p>在调用 <a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#addmembership11">addMembership</a> 之后，调用此接口才有效。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.38.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.38.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.38.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.38.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">ttl</td>         <td class="cellrowborder" width="25%">number</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">ttl设置数值，类型为数字number。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;void&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。失败返回错误码、错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-net-socket">Socket错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.38.10.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.38.10.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301022</td>         <td class="cellrowborder" width="50%">Invalid argument.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301088</td>         <td class="cellrowborder" width="50%">Not a socket.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">multicast</span>: socket.<span class="hljs-property">MulticastSocket</span> = socket.<span class="hljs-title function_">constructMulticastSocketInstance</span>();</li><li><span class="hljs-keyword">let</span> ttl = <span class="hljs-number">8</span></li><li>multicast.<span class="hljs-title function_">setMulticastTTL</span>(ttl, <span class="hljs-function">(<span class="hljs-params">err: <span class="hljs-built_in">Object</span></span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'set ttl fail, err: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'set ttl success'</span>);</li><li>})</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1462px;">     <h3 id="setmulticastttl11-1" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">setMulticastTTL<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="setmulticastttl11-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>setMulticastTTL(ttl: number): Promise&lt;void&gt;</p>     <p>设置多播通信时数据包在网络传输过程中路由器最大跳数。使用Promise方法作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>用于限制数据包在网络中传输时能够经过的最大路由器跳数的字段，TTL (Time to live)。</p>       <p>范围为 0～255，默认值为 1 。</p>       <p>如果一个多播数据包的 TTL 值为 1，那么它只能被直接连接到发送者的主机接收。如果 TTL 被设置为一个较大的值，那么数据包就能够被传送到更远的网络范围内。</p>       <p>在调用 <a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#addmembership11">addMembership</a> 之后，调用此接口才有效。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.39.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.39.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.39.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.39.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">ttl</td>         <td class="cellrowborder" width="25%">number</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">ttl设置数值，类型为数字Number。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.39.9.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.39.9.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">以Promise形式返回MulticastSocket设置TTL数值的结果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-net-socket">Socket错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.39.12.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.39.12.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301022</td>         <td class="cellrowborder" width="50%">Invalid argument.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301088</td>         <td class="cellrowborder" width="50%">Not a socket.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">multicast</span>: socket.<span class="hljs-property">MulticastSocket</span> = socket.<span class="hljs-title function_">constructMulticastSocketInstance</span>();</li><li>multicast.<span class="hljs-title function_">setMulticastTTL</span>(<span class="hljs-number">8</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'set ttl success'</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: <span class="hljs-built_in">Object</span></span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'set ttl failed'</span>);</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1284px;">     <h3 id="getmulticastttl11" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">getMulticastTTL<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getmulticastttl11" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>getMulticastTTL(callback: AsyncCallback&lt;number&gt;): void</p>     <p>获取数据包在网络传输过程中路由器最大跳数(TTL)的值。使用callback方法作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>用于限制数据包在网络中传输时能够经过的最大路由器跳数的字段，TTL (Time to live)。</p>       <p>范围为 0～255，默认值为 1 。</p>       <p>如果一个多播数据包的 TTL 值为 1，那么它只能被直接连接到发送者的主机接收。如果 TTL 被设置为一个较大的值，那么数据包就能够被传送到更远的网络范围内。</p>       <p>在调用 <a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#addmembership11">addMembership</a> 之后，调用此接口才有效。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.40.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.40.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.40.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.40.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;number&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。失败返回错误码、错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-net-socket">Socket错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.40.10.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.40.10.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301088</td>         <td class="cellrowborder" width="50%">Not a socket.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">multicast</span>: socket.<span class="hljs-property">MulticastSocket</span> = socket.<span class="hljs-title function_">constructMulticastSocketInstance</span>();</li><li>multicast.<span class="hljs-title function_">getMulticastTTL</span>(<span class="hljs-function">(<span class="hljs-params">err: <span class="hljs-built_in">Object</span>, value: <span class="hljs-built_in">Number</span></span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'set ttl fail, err: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'set ttl success, value: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(value));</li><li>})</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1232px;">     <h3 id="getmulticastttl11-1" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">getMulticastTTL<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getmulticastttl11-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>getMulticastTTL(): Promise&lt;number&gt;</p>     <p>获取数据包在网络传输过程中路由器最大跳数(TTL)的值。使用Promise方法作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>用于限制数据包在网络中传输时能够经过的最大路由器跳数的字段，TTL (Time to live)。</p>       <p>范围为 0～255，默认值为 1 。</p>       <p>如果一个多播数据包的 TTL 值为 1，那么它只能被直接连接到发送者的主机接收。如果 TTL 被设置为一个较大的值，那么数据包就能够被传送到更远的网络范围内。</p>       <p>在调用 <a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#addmembership11">addMembership</a> 之后，调用此接口才有效。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.41.7.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.41.7.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;number&gt;</td>         <td class="cellrowborder" width="50%">以Promise形式返回当前TTL数值。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-net-socket">Socket错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.41.10.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.41.10.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301088</td>         <td class="cellrowborder" width="50%">Not a socket.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">multicast</span>: socket.<span class="hljs-property">MulticastSocket</span> = socket.<span class="hljs-title function_">constructMulticastSocketInstance</span>();</li><li>multicast.<span class="hljs-title function_">getMulticastTTL</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">value: <span class="hljs-built_in">Number</span></span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'ttl: '</span>, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(value));</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: <span class="hljs-built_in">Object</span></span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'set ttl failed'</span>);</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1353px;">     <h3 id="setloopbackmode11" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">setLoopbackMode<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="setloopbackmode11" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>setLoopbackMode(flag: boolean, callback: AsyncCallback&lt;void&gt;): void</p>     <p>设置多播通信中的环回模式标志位。使用callback方法作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>用于设置环回模式，开启或关闭两种状态，默认为开启状态。</p>       <p>如果一个多播通信中环回模式设置值为 true，那么它允许主机在本地循环接收自己发送的多播数据包。如果为 false，则主机不会接收到自己发送的多播数据包。</p>       <p>在调用 <a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#addmembership11">addMembership</a> 之后，调用此接口才有效。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.42.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.42.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.42.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.42.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">flag</td>         <td class="cellrowborder" width="25%">boolean</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">是否开启环回模式。true表示环回模式开启，false表示环回模式关闭。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;void&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。失败返回错误码、错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-net-socket">Socket错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.42.10.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.42.10.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301088</td>         <td class="cellrowborder" width="50%">Not a socket.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">multicast</span>: socket.<span class="hljs-property">MulticastSocket</span> = socket.<span class="hljs-title function_">constructMulticastSocketInstance</span>();</li><li>multicast.<span class="hljs-title function_">setLoopbackMode</span>(<span class="hljs-literal">false</span>, <span class="hljs-function">(<span class="hljs-params">err: <span class="hljs-built_in">Object</span></span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'set loopback mode fail, err: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'set loopback mode success'</span>);</li><li>})</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1407px;">     <h3 id="setloopbackmode11-1" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">setLoopbackMode<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="setloopbackmode11-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>setLoopbackMode(flag: boolean): Promise&lt;void&gt;</p>     <p>设置多播通信中的环回模式标志位。使用Promise异步回调。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>用于设置环回模式，开启或关闭两种状态，默认为开启状态。</p>       <p>如果一个多播通信中环回模式设置值为 true，那么它允许主机在本地循环接收自己发送的多播数据包。如果为 false，则主机不会接收到自己发送的多播数据包。</p>       <p>在调用 <a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#addmembership11">addMembership</a> 之后，调用此接口才有效。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.43.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.43.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.43.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.43.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">flag</td>         <td class="cellrowborder" width="25%">boolean</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">是否开启环回模式。true表示环回模式开启，false表示环回模式关闭。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.43.9.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.43.9.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">以Promise形式返回MulticastSocket设置环回模式的结果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-net-socket">Socket错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.43.12.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.43.12.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301088</td>         <td class="cellrowborder" width="50%">Not a socket.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">multicast</span>: socket.<span class="hljs-property">MulticastSocket</span> = socket.<span class="hljs-title function_">constructMulticastSocketInstance</span>();</li><li>multicast.<span class="hljs-title function_">setLoopbackMode</span>(<span class="hljs-literal">false</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'set loopback mode success'</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: <span class="hljs-built_in">Object</span></span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'set loopback mode failed'</span>);</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1308px;">     <h3 id="getloopbackmode11" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">getLoopbackMode<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getloopbackmode11" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>getLoopbackMode(callback: AsyncCallback&lt;boolean&gt;): void</p>     <p>获取多播通信中的环回模式状态。使用callback异步回调。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>用于获取当前环回模式开启或关闭的状态。</p>       <p>如果获取的属性值为 true，表示环回模式是开启的状态，允许主机在本地循环接收自己发送的多播数据包。如果为 false，则表示环回模式是关闭的状态，主机不会接收到自己发送的多播数据包。</p>       <p>在调用 <a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#addmembership11">addMembership</a> 之后，调用此接口才有效。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.44.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.44.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.44.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.44.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;boolean&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。返回值为环回模式状态，true表示环回模式开启，false表示环回模式关闭。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-net-socket">Socket错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.44.10.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.44.10.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301088</td>         <td class="cellrowborder" width="50%">Not a socket.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">multicast</span>: socket.<span class="hljs-property">MulticastSocket</span> = socket.<span class="hljs-title function_">constructMulticastSocketInstance</span>();</li><li>multicast.<span class="hljs-title function_">getLoopbackMode</span>(<span class="hljs-function">(<span class="hljs-params">err: <span class="hljs-built_in">Object</span>, value: <span class="hljs-built_in">Boolean</span></span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'get loopback mode fail, err: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'get loopback mode success, value: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(value));</li><li>})</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1232px;">     <h3 id="getloopbackmode11-1" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">getLoopbackMode<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getloopbackmode11-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>getLoopbackMode(): Promise&lt;boolean&gt;</p>     <p>获取多播通信中的环回模式状态。使用Promise方法作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>用于获取当前环回模式开启或关闭的状态。</p>       <p>如果获取的属性值为 true，表示环回模式是开启的状态，允许主机在本地循环接收自己发送的多播数据包。如果为 false，则表示环回模式是关闭的状态，主机不会接收到自己发送的多播数据包。</p>       <p>在调用 <a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#addmembership11">addMembership</a> 之后，调用此接口才有效。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.45.7.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.45.7.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;boolean&gt;</td>         <td class="cellrowborder" width="50%">Promise对象。返回true表示环回模式开启，返回false表示环回模式关闭。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-net-socket">Socket错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.45.10.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.45.10.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301088</td>         <td class="cellrowborder" width="50%">Not a socket.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">multicast</span>: socket.<span class="hljs-property">MulticastSocket</span> = socket.<span class="hljs-title function_">constructMulticastSocketInstance</span>();</li><li>multicast.<span class="hljs-title function_">getLoopbackMode</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">value: <span class="hljs-built_in">Boolean</span></span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'loopback mode: '</span>, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(value));</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: <span class="hljs-built_in">Object</span></span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'get loopback mode failed'</span>);</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 634px;">     <h2 id="socketconstructtcpsocketinstance7" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">socket.constructTCPSocketInstance<sup>7+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="socketconstructtcpsocketinstance7" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>constructTCPSocketInstance(): TCPSocket</p>     <p>创建一个TCPSocket对象。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.46.6.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.46.6.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#tcpsocket">TCPSocket</a></td>         <td class="cellrowborder" width="50%">返回一个TCPSocket对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tcp</span>: socket.<span class="hljs-property">TCPSocket</span> = socket.<span class="hljs-title function_">constructTCPSocketInstance</span>();</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 182px;">     <h2 id="tcpsocket" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">TCPSocket<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="tcpsocket" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>TCPSocket连接。在调用TCPSocket的方法前，需要先通过<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#socketconstructtcpsocketinstance7">socket.constructTCPSocketInstance</a>创建TCPSocket对象。</p>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1481px;">     <h3 id="bind-2" device-type="phone,2in1,tablet,wearable,lite_wearable,tv" class="firsth2">bind<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="bind-2" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>bind(address: NetAddress, callback: AsyncCallback&lt;void&gt;): void</p>     <p>绑定IP地址和端口，端口可以指定为0由系统随机分配或由用户指定为其它非0端口。使用callback方法作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>bind方法如果因为端口冲突而执行失败，则会由系统随机分配端口号。</p>       <p>TCP客户端可先调用该接口(tcp.bind)显式绑定IP地址和端口号，再调用tcp.connect完成与服务端的连接；也可直接调用tcp.connect由系统自动绑定IP地址和端口号，完成与服务端的连接。</p>       <p>bind的IP为'localhost'或'127.0.0.1'时，只允许本地回环接口的连接，即服务端和客户端运行在同一台机器上。</p>      </div></div></div>     <p><strong>需要权限</strong>：ohos.permission.INTERNET</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.48.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.48.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.48.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.48.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">address</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#netaddress">NetAddress</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">本端地址信息，参考<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#netaddress">NetAddress</a>。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;void&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。失败返回错误、错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.48.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.48.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tcp</span>: socket.<span class="hljs-property">TCPSocket</span> = socket.<span class="hljs-title function_">constructTCPSocketInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">bindAddr</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li>tcp.<span class="hljs-title function_">bind</span>(bindAddr, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'bind fail'</span>);</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'bind success'</span>);</li><li>})</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1575px;">     <h3 id="bind-3" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">bind<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="bind-3" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>bind(address: NetAddress): Promise&lt;void&gt;</p>     <p>绑定IP地址和端口，端口可以指定为0由系统随机分配或由用户指定为其它非0端口。使用Promise方法作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>bind方法如果因为端口冲突而执行失败，则会由系统随机分配端口号。</p>       <p>TCP客户端可先调用该接口(tcp.bind)显式绑定IP地址和端口号，再调用tcp.connect完成与服务端的连接；也可直接调用tcp.connect由系统自动绑定IP地址和端口号，完成与服务端的连接。</p>       <p>bind的IP为'localhost'或'127.0.0.1'时，只允许本地回环接口的连接，即服务端和客户端运行在同一台机器上。</p>      </div></div></div>     <p><strong>需要权限</strong>：ohos.permission.INTERNET</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.49.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.49.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.49.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.49.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">address</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#netaddress">NetAddress</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">本端地址信息，参考<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#netaddress">NetAddress</a>。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.49.10.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.49.10.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">以Promise形式返回TCPSocket绑定本机的IP地址和端口的结果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.49.13.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.49.13.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tcp</span>: socket.<span class="hljs-property">TCPSocket</span> = socket.<span class="hljs-title function_">constructTCPSocketInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">bindAddr</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li>tcp.<span class="hljs-title function_">bind</span>(bindAddr).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'bind success'</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'bind fail'</span>);</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 2813px;">     <h3 id="connect" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">connect<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="connect" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>connect(options: TCPConnectOptions, callback: AsyncCallback&lt;void&gt;): void</p>     <p>连接到指定的IP地址和端口。使用callback方法作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>在没有执行tcp.bind的情况下，也可以直接调用该接口完成与TCP服务端的连接</p>      </div></div></div>     <p><strong>需要权限</strong>：ohos.permission.INTERNET</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.50.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.50.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.50.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.50.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">options</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#tcpconnectoptions">TCPConnectOptions</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">TCPSocket连接的参数，参考<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#tcpconnectoptions">TCPConnectOptions</a>。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;void&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。失败返回错误码、错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-net-socket">Socket错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.50.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.50.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301206</td>         <td class="cellrowborder" width="50%">Socks5 failed to connect to the proxy server.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301207</td>         <td class="cellrowborder" width="50%">Socks5 username or password is invalid.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301208</td>         <td class="cellrowborder" width="50%">Socks5 failed to connect to the remote server.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301209</td>         <td class="cellrowborder" width="50%">Socks5 failed to negotiate the authentication method.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301210</td>         <td class="cellrowborder" width="50%">Socks5 failed to send the message.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301211</td>         <td class="cellrowborder" width="50%">Socks5 failed to receive the message.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301212</td>         <td class="cellrowborder" width="50%">Socks5 serialization error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301213</td>         <td class="cellrowborder" width="50%">Socks5 deserialization error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tcp</span>: socket.<span class="hljs-property">TCPSocket</span> = socket.<span class="hljs-title function_">constructTCPSocketInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">netAddress</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tcpconnectoptions</span>: socket.<span class="hljs-property">TCPConnectOptions</span> = {</li><li>  <span class="hljs-attr">address</span>: netAddress,</li><li>  <span class="hljs-attr">timeout</span>: <span class="hljs-number">6000</span></li><li>}</li><li>tcp.<span class="hljs-title function_">connect</span>(tcpconnectoptions, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'connect fail'</span>);</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'connect success'</span>);</li><li>})</li></ol></pre></div></div>     <p><strong>示例（设置socket代理）：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tcp</span>: socket.<span class="hljs-property">TCPSocket</span> = socket.<span class="hljs-title function_">constructTCPSocketInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">netAddress</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">socks5Server</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">proxyOptions</span>: socket.<span class="hljs-property">ProxyOptions</span> = {</li><li>  <span class="hljs-keyword">type</span> : <span class="hljs-number">1</span>,</li><li>  <span class="hljs-attr">address</span>: socks5Server,</li><li>  <span class="hljs-attr">username</span>: <span class="hljs-string">"xxx"</span>,</li><li>  <span class="hljs-attr">password</span>: <span class="hljs-string">"xxx"</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tcpconnectoptions</span>: socket.<span class="hljs-property">TCPConnectOptions</span> = {</li><li>  <span class="hljs-attr">address</span>: netAddress,</li><li>  <span class="hljs-attr">timeout</span>: <span class="hljs-number">6000</span>,</li><li>  <span class="hljs-attr">proxy</span>: proxyOptions,</li><li>}</li><li>tcp.<span class="hljs-title function_">connect</span>(tcpconnectoptions, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'connect fail'</span>);</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'connect success'</span>);</li><li>})</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 2843px;">     <h3 id="connect-1" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">connect<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="connect-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>connect(options: TCPConnectOptions): Promise&lt;void&gt;</p>     <p>连接到指定的IP地址和端口。使用promise方法作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>在没有执行tcp.bind的情况下，也可以直接调用该接口完成与TCP服务端的连接。</p>      </div></div></div>     <p><strong>需要权限</strong>：ohos.permission.INTERNET</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.51.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.51.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.51.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.51.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">options</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#tcpconnectoptions">TCPConnectOptions</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">TCPSocket连接的参数，参考<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#tcpconnectoptions">TCPConnectOptions</a>。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.51.10.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.51.10.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">以Promise形式返回TCPSocket连接到指定的IP地址和端口的结果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-net-socket">Socket错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.51.13.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.51.13.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301206</td>         <td class="cellrowborder" width="50%">Socks5 failed to connect to the proxy server.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301207</td>         <td class="cellrowborder" width="50%">Socks5 username or password is invalid.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301208</td>         <td class="cellrowborder" width="50%">Socks5 failed to connect to the remote server.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301209</td>         <td class="cellrowborder" width="50%">Socks5 failed to negotiate the authentication method.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301210</td>         <td class="cellrowborder" width="50%">Socks5 failed to send the message.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301211</td>         <td class="cellrowborder" width="50%">Socks5 failed to receive the message.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301212</td>         <td class="cellrowborder" width="50%">Socks5 serialization error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301213</td>         <td class="cellrowborder" width="50%">Socks5 deserialization error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tcp</span>: socket.<span class="hljs-property">TCPSocket</span> = socket.<span class="hljs-title function_">constructTCPSocketInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">netAddress</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tcpconnectoptions</span>: socket.<span class="hljs-property">TCPConnectOptions</span> = {</li><li>  <span class="hljs-attr">address</span>: netAddress,</li><li>  <span class="hljs-attr">timeout</span>: <span class="hljs-number">6000</span></li><li>}</li><li>tcp.<span class="hljs-title function_">connect</span>(tcpconnectoptions).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'connect success'</span>)</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'connect fail'</span>);</li><li>});</li></ol></pre></div></div>     <p><strong>示例（设置socket代理）：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tcp</span>: socket.<span class="hljs-property">TCPSocket</span> = socket.<span class="hljs-title function_">constructTCPSocketInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">netAddress</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">socks5Server</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">proxyOptions</span>: socket.<span class="hljs-property">ProxyOptions</span> = {</li><li>  <span class="hljs-keyword">type</span> : <span class="hljs-number">1</span>,</li><li>  <span class="hljs-attr">address</span>: socks5Server,</li><li>  <span class="hljs-attr">username</span>: <span class="hljs-string">"xxx"</span>,</li><li>  <span class="hljs-attr">password</span>: <span class="hljs-string">"xxx"</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tcpconnectoptions</span>: socket.<span class="hljs-property">TCPConnectOptions</span> = {</li><li>  <span class="hljs-attr">address</span>: netAddress,</li><li>  <span class="hljs-attr">timeout</span>: <span class="hljs-number">6000</span>,</li><li>  <span class="hljs-attr">proxy</span>: proxyOptions,</li><li>}</li><li>tcp.<span class="hljs-title function_">connect</span>(tcpconnectoptions).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'connect success'</span>)</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'connect fail'</span>);</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1665px;">     <h3 id="send-2" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">send<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="send-2" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>send(options: TCPSendOptions, callback: AsyncCallback&lt;void&gt;): void</p>     <p>通过TCPSocket连接发送数据。使用callback方式作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>connect方法调用成功后，才可调用此方法。该接口为耗时操作，请在Worker线程或taskpool线程调用该接口。</p>      </div></div></div>     <p><strong>需要权限</strong>：ohos.permission.INTERNET</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.52.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.52.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.52.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.52.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">options</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#tcpsendoptions">TCPSendOptions</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">TCPSocket发送请求的参数，参考<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#tcpsendoptions">TCPSendOptions</a>。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;void&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。失败返回错误码、错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.52.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.52.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tcp</span>: socket.<span class="hljs-property">TCPSocket</span> = socket.<span class="hljs-title function_">constructTCPSocketInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">netAddress</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tcpconnectoptions</span>: socket.<span class="hljs-property">TCPConnectOptions</span> = {</li><li>  <span class="hljs-attr">address</span>: netAddress,</li><li>  <span class="hljs-attr">timeout</span>: <span class="hljs-number">6000</span></li><li>}</li><li>tcp.<span class="hljs-title function_">connect</span>(tcpconnectoptions, <span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'connect success'</span>);</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">tcpSendOptions</span>: socket.<span class="hljs-property">TCPSendOptions</span> = {</li><li>    <span class="hljs-attr">data</span>: <span class="hljs-string">'Hello, server!'</span></li><li>  }</li><li>  tcp.<span class="hljs-title function_">send</span>(tcpSendOptions, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>    <span class="hljs-keyword">if</span> (err) {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'send fail'</span>);</li><li>      <span class="hljs-keyword">return</span>;</li><li>    }</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'send success'</span>);</li><li>  })</li><li>})</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1719px;">     <h3 id="send-3" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">send<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="send-3" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>send(options: TCPSendOptions): Promise&lt;void&gt;</p>     <p>通过TCPSocket连接发送数据。使用Promise方式作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>connect方法调用成功后，才可调用此方法。该接口为耗时操作，请在Worker线程或taskpool线程调用该接口。</p>      </div></div></div>     <p><strong>需要权限</strong>：ohos.permission.INTERNET</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.53.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.53.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.53.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.53.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">options</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#tcpsendoptions">TCPSendOptions</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">TCPSocket发送请求的参数，参考<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#tcpsendoptions">TCPSendOptions</a>。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.53.10.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.53.10.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">Promise对象。无返回结果的Promise对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.53.13.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.53.13.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tcp</span>: socket.<span class="hljs-property">TCPSocket</span> = socket.<span class="hljs-title function_">constructTCPSocketInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">netAddress</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tcpconnectoptions</span>: socket.<span class="hljs-property">TCPConnectOptions</span> = {</li><li>  <span class="hljs-attr">address</span>: netAddress,</li><li>  <span class="hljs-attr">timeout</span>: <span class="hljs-number">6000</span></li><li>}</li><li>tcp.<span class="hljs-title function_">connect</span>(tcpconnectoptions, <span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'connect success'</span>);</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">tcpSendOptions</span>: socket.<span class="hljs-property">TCPSendOptions</span> = {</li><li>    <span class="hljs-attr">data</span>: <span class="hljs-string">'Hello, server!'</span></li><li>  }</li><li>  tcp.<span class="hljs-title function_">send</span>(tcpSendOptions).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'send success'</span>);</li><li>  }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'send fail'</span>);</li><li>  });</li><li>})</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1137px;">     <h3 id="close-2" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">close<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="close-2" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>close(callback: AsyncCallback&lt;void&gt;): void</p>     <p>关闭TCPSocket连接。使用callback方式作为异步方法。</p>     <p><strong>需要权限</strong>：ohos.permission.INTERNET</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.54.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.54.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.54.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.54.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;void&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。失败返回错误码、错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.54.10.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.54.10.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tcp</span>: socket.<span class="hljs-property">TCPSocket</span> = socket.<span class="hljs-title function_">constructTCPSocketInstance</span>();</li><li>
</li><li>tcp.<span class="hljs-title function_">close</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'close fail'</span>);</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'close success'</span>);</li><li>})</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1085px;">     <h3 id="close-3" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">close<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="close-3" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>close(): Promise&lt;void&gt;</p>     <p>关闭TCPSocket连接。使用Promise方式作为异步方法。</p>     <p><strong>需要权限</strong>：ohos.permission.INTERNET</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.55.7.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.55.7.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">Promise对象。无返回结果的Promise对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.55.10.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.55.10.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tcp</span>: socket.<span class="hljs-property">TCPSocket</span> = socket.<span class="hljs-title function_">constructTCPSocketInstance</span>();</li><li>
</li><li>tcp.<span class="hljs-title function_">close</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'close success'</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'close fail'</span>);</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1493px;">     <h3 id="getremoteaddress" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">getRemoteAddress<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getremoteaddress" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>getRemoteAddress(callback: AsyncCallback&lt;NetAddress&gt;): void</p>     <p>获取对端Socket地址。使用callback方式作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>connect方法调用成功后，才可调用此方法。</p>      </div></div></div>     <p><strong>需要权限</strong>：ohos.permission.INTERNET</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.56.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.56.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.56.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.56.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#netaddress">NetAddress</a>&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。成功时返回对端Socket地址，失败时返回错误码、错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.56.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.56.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tcp</span>: socket.<span class="hljs-property">TCPSocket</span> = socket.<span class="hljs-title function_">constructTCPSocketInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">netAddress</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tcpconnectoptions</span>: socket.<span class="hljs-property">TCPConnectOptions</span> = {</li><li>  <span class="hljs-attr">address</span>: netAddress,</li><li>  <span class="hljs-attr">timeout</span>: <span class="hljs-number">6000</span></li><li>}</li><li>tcp.<span class="hljs-title function_">connect</span>(tcpconnectoptions, <span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'connect success'</span>);</li><li>  tcp.<span class="hljs-title function_">getRemoteAddress</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError, data: socket.NetAddress</span>) =&gt;</span> {</li><li>    <span class="hljs-keyword">if</span> (err) {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'getRemoteAddressfail'</span>);</li><li>      <span class="hljs-keyword">return</span>;</li><li>    }</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'getRemoteAddresssuccess:'</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data));</li><li>  })</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1465px;">     <h3 id="getremoteaddress-1" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">getRemoteAddress<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getremoteaddress-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>getRemoteAddress(): Promise&lt;NetAddress&gt;</p>     <p>获取对端Socket地址。使用Promise方式作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>connect方法调用成功后，才可调用此方法。</p>      </div></div></div>     <p><strong>需要权限</strong>：ohos.permission.INTERNET</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.57.8.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.57.8.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#netaddress">NetAddress</a>&gt;</td>         <td class="cellrowborder" width="50%">以Promise形式返回获取对端socket地址的结果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.57.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.57.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tcp</span>: socket.<span class="hljs-property">TCPSocket</span> = socket.<span class="hljs-title function_">constructTCPSocketInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">netAddress</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tcpconnectoptions</span>: socket.<span class="hljs-property">TCPConnectOptions</span> = {</li><li>  <span class="hljs-attr">address</span>: netAddress,</li><li>  <span class="hljs-attr">timeout</span>: <span class="hljs-number">6000</span></li><li>}</li><li>tcp.<span class="hljs-title function_">connect</span>(tcpconnectoptions).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'connect success'</span>);</li><li>  tcp.<span class="hljs-title function_">getRemoteAddress</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'getRemoteAddress success'</span>);</li><li>  }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'getRemoteAddressfail'</span>);</li><li>  });</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'connect fail'</span>);</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1493px;">     <h3 id="getstate-2" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">getState<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getstate-2" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>getState(callback: AsyncCallback&lt;SocketStateBase&gt;): void</p>     <p>获取TCPSocket状态。使用callback方式作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>bind或connect方法调用成功后，才可调用此方法。</p>      </div></div></div>     <p><strong>需要权限</strong>：ohos.permission.INTERNET</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.58.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.58.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.58.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.58.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#socketstatebase">SocketStateBase</a>&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。成功时获取TCPSocket状态，失败时返回错误码、错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.58.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.58.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tcp</span>: socket.<span class="hljs-property">TCPSocket</span> = socket.<span class="hljs-title function_">constructTCPSocketInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">netAddress</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tcpconnectoptions</span>: socket.<span class="hljs-property">TCPConnectOptions</span> = {</li><li>  <span class="hljs-attr">address</span>: netAddress,</li><li>  <span class="hljs-attr">timeout</span>: <span class="hljs-number">6000</span></li><li>}</li><li>tcp.<span class="hljs-title function_">connect</span>(tcpconnectoptions, <span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'connect success'</span>);</li><li>  tcp.<span class="hljs-title function_">getState</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError, data: socket.SocketStateBase</span>) =&gt;</span> {</li><li>    <span class="hljs-keyword">if</span> (err) {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'getState fail'</span>);</li><li>      <span class="hljs-keyword">return</span>;</li><li>    }</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'getState success:'</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data));</li><li>  });</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1465px;">     <h3 id="getstate-3" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">getState<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getstate-3" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>getState(): Promise&lt;SocketStateBase&gt;</p>     <p>获取TCPSocket状态。使用Promise方式作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>bind或connect方法调用成功后，才可调用此方法。</p>      </div></div></div>     <p><strong>需要权限</strong>：ohos.permission.INTERNET</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.59.8.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.59.8.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#socketstatebase">SocketStateBase</a>&gt;</td>         <td class="cellrowborder" width="50%">以Promise形式返回获取TCPSocket状态的结果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.59.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.59.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tcp</span>: socket.<span class="hljs-property">TCPSocket</span> = socket.<span class="hljs-title function_">constructTCPSocketInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">netAddress</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tcpconnectoptions</span>: socket.<span class="hljs-property">TCPConnectOptions</span> = {</li><li>  <span class="hljs-attr">address</span>: netAddress,</li><li>  <span class="hljs-attr">timeout</span>: <span class="hljs-number">6000</span></li><li>}</li><li>tcp.<span class="hljs-title function_">connect</span>(tcpconnectoptions).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'connect success'</span>);</li><li>  tcp.<span class="hljs-title function_">getState</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'getState success'</span>);</li><li>  }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'getState fail'</span>);</li><li>  });</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'connect fail'</span>);</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1226px;">     <h3 id="getsocketfd10" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">getSocketFd<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getsocketfd10" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>getSocketFd(callback: AsyncCallback&lt;number&gt;): void</p>     <p>获取TCPSocket的文件描述符。使用callback方式作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>bind或connect方法调用成功后，才可调用此方法。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.60.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.60.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.60.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.60.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;number&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数，当成功时，返回socket的文件描述符，失败时，返回undefined。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tcp</span>: socket.<span class="hljs-property">TCPSocket</span> = socket.<span class="hljs-title function_">constructTCPSocketInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">bindAddr</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-comment">// 绑定指定网络接口</span></li><li>}</li><li>tcp.<span class="hljs-title function_">bind</span>(bindAddr)</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">netAddress</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tcpconnectoptions</span>: socket.<span class="hljs-property">TCPConnectOptions</span> = {</li><li>  <span class="hljs-attr">address</span>: netAddress,</li><li>  <span class="hljs-attr">timeout</span>: <span class="hljs-number">6000</span></li><li>}</li><li>tcp.<span class="hljs-title function_">connect</span>(tcpconnectoptions)</li><li>tcp.<span class="hljs-title function_">getSocketFd</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError, data: <span class="hljs-built_in">number</span></span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"getSocketFd failed: "</span> + err);</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"tunenlfd: "</span> + data);</li><li>})</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1174px;">     <h3 id="getsocketfd10-1" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">getSocketFd<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getsocketfd10-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>getSocketFd(): Promise&lt;number&gt;</p>     <p>获取TCPSocket的文件描述符。使用Promise方式作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>bind或connect方法调用成功后，才可调用此方法。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.61.7.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.61.7.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;number&gt;</td>         <td class="cellrowborder" width="50%">以Promise形式返回socket的文件描述符。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tcp</span>: socket.<span class="hljs-property">TCPSocket</span> = socket.<span class="hljs-title function_">constructTCPSocketInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">bindAddr</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>    <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-comment">// 绑定指定网络接口</span></li><li>}</li><li>tcp.<span class="hljs-title function_">bind</span>(bindAddr)</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">netAddress</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tcpconnectoptions</span>: socket.<span class="hljs-property">TCPConnectOptions</span> = {</li><li>  <span class="hljs-attr">address</span>: netAddress,</li><li>  <span class="hljs-attr">timeout</span>: <span class="hljs-number">6000</span></li><li>}</li><li>tcp.<span class="hljs-title function_">connect</span>(tcpconnectoptions)</li><li>tcp.<span class="hljs-title function_">getSocketFd</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">data: <span class="hljs-built_in">number</span></span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"tunenlfd: "</span> + data);</li><li>})</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 2001px;">     <h3 id="setextraoptions-2" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">setExtraOptions<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="setextraoptions-2" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>setExtraOptions(options: TCPExtraOptions, callback: AsyncCallback&lt;void&gt;): void</p>     <p>设置TCPSocket连接的其他属性。使用callback方式作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>bind或connect方法调用成功后，才可调用此方法。</p>      </div></div></div>     <p><strong>需要权限</strong>：ohos.permission.INTERNET</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.62.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.62.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.62.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.62.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">options</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#tcpextraoptions">TCPExtraOptions</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">TCPSocket连接的其他属性，参考<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#tcpextraoptions">TCPExtraOptions</a>。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;void&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。失败时返回错误码、错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.62.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.62.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tcp</span>: socket.<span class="hljs-property">TCPSocket</span> = socket.<span class="hljs-title function_">constructTCPSocketInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">netAddress</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tcpconnectoptions</span>: socket.<span class="hljs-property">TCPConnectOptions</span> = {</li><li>  <span class="hljs-attr">address</span>: netAddress,</li><li>  <span class="hljs-attr">timeout</span>: <span class="hljs-number">6000</span></li><li>}</li><li>
</li><li><span class="hljs-keyword">interface</span> <span class="hljs-title class_">SocketLinger</span> {</li><li>  <span class="hljs-attr">on</span>: <span class="hljs-built_in">boolean</span>;</li><li>  <span class="hljs-attr">linger</span>: <span class="hljs-built_in">number</span>;</li><li>}</li><li>
</li><li>tcp.<span class="hljs-title function_">connect</span>(tcpconnectoptions, <span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'connect success'</span>);</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">tcpExtraOptions</span>: socket.<span class="hljs-property">TCPExtraOptions</span> = {</li><li>    <span class="hljs-attr">keepAlive</span>: <span class="hljs-literal">true</span>,</li><li>    <span class="hljs-title class_">OOBInline</span>: <span class="hljs-literal">true</span>,</li><li>    <span class="hljs-title class_">TCPNoDelay</span>: <span class="hljs-literal">true</span>,</li><li>    <span class="hljs-attr">socketLinger</span>: { <span class="hljs-attr">on</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">linger</span>: <span class="hljs-number">10</span> } <span class="hljs-keyword">as</span> <span class="hljs-title class_">SocketLinger</span>,</li><li>    <span class="hljs-attr">receiveBufferSize</span>: <span class="hljs-number">8192</span>,</li><li>    <span class="hljs-attr">sendBufferSize</span>: <span class="hljs-number">8192</span>,</li><li>    <span class="hljs-attr">reuseAddress</span>: <span class="hljs-literal">true</span>,</li><li>    <span class="hljs-attr">socketTimeout</span>: <span class="hljs-number">3000</span></li><li>  }</li><li>  tcp.<span class="hljs-title function_">setExtraOptions</span>(tcpExtraOptions, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>    <span class="hljs-keyword">if</span> (err) {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'setExtraOptions fail'</span>);</li><li>      <span class="hljs-keyword">return</span>;</li><li>    }</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'setExtraOptions success'</span>);</li><li>  });</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 2055px;">     <h3 id="setextraoptions-3" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">setExtraOptions<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="setextraoptions-3" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>setExtraOptions(options: TCPExtraOptions): Promise&lt;void&gt;</p>     <p>设置TCPSocket连接的其他属性。使用Promise方式作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>bind或connect方法调用成功后，才可调用此方法。</p>      </div></div></div>     <p><strong>需要权限</strong>：ohos.permission.INTERNET</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.63.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.63.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.63.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.63.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">options</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#tcpextraoptions">TCPExtraOptions</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">TCPSocket连接的其他属性，参考<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#tcpextraoptions">TCPExtraOptions</a>。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.63.10.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.63.10.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">Promise对象。无返回结果的Promise对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.63.13.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.63.13.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tcp</span>: socket.<span class="hljs-property">TCPSocket</span> = socket.<span class="hljs-title function_">constructTCPSocketInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">netAddress</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tcpconnectoptions</span>: socket.<span class="hljs-property">TCPConnectOptions</span> = {</li><li>  <span class="hljs-attr">address</span>: netAddress,</li><li>  <span class="hljs-attr">timeout</span>: <span class="hljs-number">6000</span></li><li>}</li><li>
</li><li><span class="hljs-keyword">interface</span> <span class="hljs-title class_">SocketLinger</span> {</li><li>  <span class="hljs-attr">on</span>: <span class="hljs-built_in">boolean</span>;</li><li>  <span class="hljs-attr">linger</span>: <span class="hljs-built_in">number</span>;</li><li>}</li><li>
</li><li>tcp.<span class="hljs-title function_">connect</span>(tcpconnectoptions, <span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'connect success'</span>);</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">tcpExtraOptions</span>: socket.<span class="hljs-property">TCPExtraOptions</span> = {</li><li>    <span class="hljs-attr">keepAlive</span>: <span class="hljs-literal">true</span>,</li><li>    <span class="hljs-title class_">OOBInline</span>: <span class="hljs-literal">true</span>,</li><li>    <span class="hljs-title class_">TCPNoDelay</span>: <span class="hljs-literal">true</span>,</li><li>    <span class="hljs-attr">socketLinger</span>: { <span class="hljs-attr">on</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">linger</span>: <span class="hljs-number">10</span> } <span class="hljs-keyword">as</span> <span class="hljs-title class_">SocketLinger</span>,</li><li>    <span class="hljs-attr">receiveBufferSize</span>: <span class="hljs-number">8192</span>,</li><li>    <span class="hljs-attr">sendBufferSize</span>: <span class="hljs-number">8192</span>,</li><li>    <span class="hljs-attr">reuseAddress</span>: <span class="hljs-literal">true</span>,</li><li>    <span class="hljs-attr">socketTimeout</span>: <span class="hljs-number">3000</span></li><li>  }</li><li>  tcp.<span class="hljs-title function_">setExtraOptions</span>(tcpExtraOptions).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'setExtraOptions success'</span>);</li><li>  }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'setExtraOptions fail'</span>);</li><li>  });</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1431px;">     <h3 id="getlocaladdress12-1" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">getLocalAddress<sup>12+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getlocaladdress12-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>getLocalAddress(): Promise&lt;NetAddress&gt;</p>     <p>获取TCPSocket的本地Socket地址。使用Promise方式作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>bind方法调用成功后，才可调用此方法。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.64.7.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.64.7.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#netaddress">NetAddress</a>&gt;</td>         <td class="cellrowborder" width="50%">以Promise形式返回获取本地socket地址的结果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-net-socket">Socket错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.64.10.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.64.10.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">2300002</td>         <td class="cellrowborder" width="50%">System internal error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301009</td>         <td class="cellrowborder" width="50%">Bad file descriptor.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303188</td>         <td class="cellrowborder" width="50%">Socket operation on non-socket.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tcp</span>: socket.<span class="hljs-property">TCPSocket</span> = socket.<span class="hljs-title function_">constructTCPSocketInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">bindAddr</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">family</span>: <span class="hljs-number">1</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li>tcp.<span class="hljs-title function_">bind</span>(bindAddr).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  tcp.<span class="hljs-title function_">getLocalAddress</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">localAddress: socket.NetAddress</span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"SUCCESS! Address:"</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(localAddress));</li><li>  }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"FAILED! Error:"</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));</li><li>  })</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'bind fail'</span>);</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1035px;">     <h3 id="onmessage-1" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">on('message')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onmessage-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>on(type: 'message', callback: Callback&lt;SocketMessageInfo&gt;): void</p>     <p>订阅TCPSocket连接的接收消息事件。使用callback方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.65.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.65.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.65.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.65.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">订阅的事件类型。'message'：接收消息事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#socketmessageinfo11">SocketMessageInfo</a>&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。返回TCPSocket连接信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tcp</span>: socket.<span class="hljs-property">TCPSocket</span> = socket.<span class="hljs-title function_">constructTCPSocketInstance</span>();</li><li>tcp.<span class="hljs-title function_">on</span>(<span class="hljs-string">'message'</span>, <span class="hljs-function">(<span class="hljs-params">value: socket.SocketMessageInfo</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">let</span> messageView = <span class="hljs-string">''</span>;</li><li>  <span class="hljs-keyword">let</span> uint8Array = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(value.<span class="hljs-property">message</span>) ;</li><li>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> <span class="hljs-attr">i</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>; i &lt; value.<span class="hljs-property">message</span>.<span class="hljs-property">byteLength</span>; i++) {</li><li>    <span class="hljs-keyword">let</span> messages = uint8Array[i];</li><li>    <span class="hljs-keyword">let</span> message = <span class="hljs-title class_">String</span>.<span class="hljs-title function_">fromCharCode</span>(messages);</li><li>    messageView += message;</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'on message message: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(messageView));</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'remoteInfo: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(value.<span class="hljs-property">remoteInfo</span>));</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1179px;">     <h3 id="offmessage-1" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">off('message')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="offmessage-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>off(type: 'message', callback?: Callback&lt;SocketMessageInfo&gt;): void</p>     <p>取消订阅TCPSocket连接的接收消息事件。使用callback方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.66.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.66.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.66.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.66.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">取消订阅的事件类型。'message'：接收消息事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#socketmessageinfo11">SocketMessageInfo</a>&gt;</td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">回调函数。可以指定传入on中的callback取消对应的订阅，也可以不指定callback清空所有订阅。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tcp</span>: socket.<span class="hljs-property">TCPSocket</span> = socket.<span class="hljs-title function_">constructTCPSocketInstance</span>();</li><li><span class="hljs-keyword">let</span> messageView = <span class="hljs-string">''</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-title function_">callback</span> = (<span class="hljs-params">value: socket.SocketMessageInfo</span>) =&gt; {</li><li>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> <span class="hljs-attr">i</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>; i &lt; value.<span class="hljs-property">message</span>.<span class="hljs-property">byteLength</span>; i++) {</li><li>    <span class="hljs-keyword">let</span> uint8Array = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(value.<span class="hljs-property">message</span>)</li><li>    <span class="hljs-keyword">let</span> messages = uint8Array[i]</li><li>    <span class="hljs-keyword">let</span> message = <span class="hljs-title class_">String</span>.<span class="hljs-title function_">fromCharCode</span>(messages);</li><li>    messageView += message;</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'on message message: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(messageView));</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'remoteInfo: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(value.<span class="hljs-property">remoteInfo</span>));</li><li>}</li><li>tcp.<span class="hljs-title function_">on</span>(<span class="hljs-string">'message'</span>, callback);</li><li><span class="hljs-comment">// 可以指定传入on中的callback取消一个订阅，也可以不指定callback清空所有订阅。</span></li><li>tcp.<span class="hljs-title function_">off</span>(<span class="hljs-string">'message'</span>, callback);</li><li>tcp.<span class="hljs-title function_">off</span>(<span class="hljs-string">'message'</span>);</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 939px;">     <h3 id="onconnect--close" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">on('connect' | 'close')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onconnect--close" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>on(type: 'connect' | 'close', callback: Callback&lt;void&gt;): void</p>     <p>订阅TCPSocket的连接事件或关闭事件。使用callback方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.67.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.67.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.67.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.67.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">          <p>订阅的事件类型。</p>          <p>- 'connect'：连接事件。</p>          <p>- 'close'：关闭事件。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;void&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。TCPSocket的连接事件或关闭事件触发时调用回调函数。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tcp</span>: socket.<span class="hljs-property">TCPSocket</span> = socket.<span class="hljs-title function_">constructTCPSocketInstance</span>();</li><li>tcp.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connect'</span>, <span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"on connect success"</span>)</li><li>});</li><li>tcp.<span class="hljs-title function_">on</span>(<span class="hljs-string">'close'</span>, <span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"on close success"</span>)</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1155px;">     <h3 id="offconnect--close" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">off('connect' | 'close')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="offconnect--close" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>off(type: 'connect' | 'close', callback?: Callback&lt;void&gt;): void</p>     <p>取消订阅TCPSocket的连接事件或关闭事件。使用callback方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.68.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.68.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.68.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.68.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">          <p>取消订阅的事件类型。</p>          <p>- 'connect'：连接事件。</p>          <p>- 'close'：关闭事件。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;void&gt;</td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">回调函数。可以指定传入on中的callback取消对应的订阅，也可以不指定callback清空所有订阅。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tcp</span>: socket.<span class="hljs-property">TCPSocket</span> = socket.<span class="hljs-title function_">constructTCPSocketInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-title function_">callback1</span> = (<span class="hljs-params"></span>) =&gt; {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"on connect success"</span>);</li><li>}</li><li>tcp.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connect'</span>, callback1);</li><li><span class="hljs-comment">// 可以指定传入on中的callback取消一个订阅，也可以不指定callback清空所有订阅。</span></li><li>tcp.<span class="hljs-title function_">off</span>(<span class="hljs-string">'connect'</span>, callback1);</li><li>tcp.<span class="hljs-title function_">off</span>(<span class="hljs-string">'connect'</span>);</li><li><span class="hljs-keyword">let</span> <span class="hljs-title function_">callback2</span> = (<span class="hljs-params"></span>) =&gt; {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"on close success"</span>);</li><li>}</li><li>tcp.<span class="hljs-title function_">on</span>(<span class="hljs-string">'close'</span>, callback2);</li><li><span class="hljs-comment">// 可以指定传入on中的callback取消一个订阅，也可以不指定callback清空所有订阅。</span></li><li>tcp.<span class="hljs-title function_">off</span>(<span class="hljs-string">'close'</span>, callback2);</li><li>tcp.<span class="hljs-title function_">off</span>(<span class="hljs-string">'close'</span>);</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 843px;">     <h3 id="onerror-1" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">on('error')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onerror-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>on(type: 'error', callback: ErrorCallback): void</p>     <p>订阅TCPSocket连接的error事件。使用callback方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.69.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.69.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.69.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.69.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">订阅的事件类型。'error'：error事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">ErrorCallback</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。TCPSocket连接订阅的某类error事件触发时调用回调函数。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tcp</span>: socket.<span class="hljs-property">TCPSocket</span> = socket.<span class="hljs-title function_">constructTCPSocketInstance</span>();</li><li>tcp.<span class="hljs-title function_">on</span>(<span class="hljs-string">'error'</span>, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"on error, err:"</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err))</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 963px;">     <h3 id="offerror-1" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">off('error')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="offerror-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>off(type: 'error', callback?: ErrorCallback): void</p>     <p>取消订阅TCPSocket连接的error事件。使用callback方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.70.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.70.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.70.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.70.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">取消订阅的事件类型。'error'：error事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">ErrorCallback</td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">回调函数。可以指定传入on中的callback取消对应的订阅，也可以不指定callback清空所有订阅。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tcp</span>: socket.<span class="hljs-property">TCPSocket</span> = socket.<span class="hljs-title function_">constructTCPSocketInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-title function_">callback</span> = (<span class="hljs-params">err: BusinessError</span>) =&gt; {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"on error, err:"</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));</li><li>}</li><li>tcp.<span class="hljs-title function_">on</span>(<span class="hljs-string">'error'</span>, callback);</li><li><span class="hljs-comment">// 可以指定传入on中的callback取消一个订阅，也可以不指定callback清空所有订阅。</span></li><li>tcp.<span class="hljs-title function_">off</span>(<span class="hljs-string">'error'</span>, callback);</li><li>tcp.<span class="hljs-title function_">off</span>(<span class="hljs-string">'error'</span>);</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 519px;">     <h2 id="tcpconnectoptions" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">TCPConnectOptions<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="tcpconnectoptions" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>TCPSocket连接的参数。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.71.4.1.6.1.1" width="20%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.71.4.1.6.1.2" width="20%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.71.4.1.6.1.3" width="20%">只读</th>         <th align="left" class="cellrowborder" id="mcps1.3.71.4.1.6.1.4" width="20%">可选</th>         <th align="left" class="cellrowborder" id="mcps1.3.71.4.1.6.1.5" width="20%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">address</td>         <td class="cellrowborder" width="20%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#netaddress">NetAddress</a></td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">绑定的地址以及端口。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">timeout</td>         <td class="cellrowborder" width="20%">number</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">超时时间，单位毫秒（ms）。默认值为5000。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">proxy<sup>18+</sup></td>         <td class="cellrowborder" width="20%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#proxyoptions18">ProxyOptions</a></td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">使用的代理信息，默认不使用代理。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 474px;">     <h2 id="tcpsendoptions" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">TCPSendOptions<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="tcpsendoptions" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>TCPSocket发送请求的参数。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.72.4.1.6.1.1" width="20%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.72.4.1.6.1.2" width="20%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.72.4.1.6.1.3" width="20%">只读</th>         <th align="left" class="cellrowborder" id="mcps1.3.72.4.1.6.1.4" width="20%">可选</th>         <th align="left" class="cellrowborder" id="mcps1.3.72.4.1.6.1.5" width="20%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">data</td>         <td class="cellrowborder" width="20%">string| ArrayBuffer</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">发送的数据。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">encoding</td>         <td class="cellrowborder" width="20%">string</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">字符编码(UTF-8，UTF-16BE，UTF-16LE，UTF-16，US-AECII，ISO-8859-1)，默认为UTF-8。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 900px;">     <h2 id="tcpextraoptions" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">TCPExtraOptions<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="tcpextraoptions" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>TCPSocket连接的其他属性。继承自<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#extraoptionsbase7">ExtraOptionsBase</a>。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.73.4.1.6.1.1" width="20%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.73.4.1.6.1.2" width="20%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.73.4.1.6.1.3" width="20%">只读</th>         <th align="left" class="cellrowborder" id="mcps1.3.73.4.1.6.1.4" width="20%">可选</th>         <th align="left" class="cellrowborder" id="mcps1.3.73.4.1.6.1.5" width="20%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">keepAlive</td>         <td class="cellrowborder" width="20%">boolean</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">是否保持连接。默认为false。true：保持连接；false：断开连接。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">OOBInline</td>         <td class="cellrowborder" width="20%">boolean</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">是否为OOB内联。默认为false。true：是OOB内联；false：不是OOB内联。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">TCPNoDelay</td>         <td class="cellrowborder" width="20%">boolean</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">TCPSocket连接是否无时延。默认为false。true：无时延；false：有时延。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">socketLinger</td>         <td class="cellrowborder" width="20%">{on:boolean, linger:number}</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">          <p>socket是否继续逗留。</p>          <p>- on：是否逗留（true：逗留；false：不逗留）。</p>          <p>- linger：逗留时长，单位毫秒（ms），取值范围为0~65535。</p>          <p>当入参on设置为true时，才需要设置。</p></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 634px;">     <h2 id="socketconstructtcpsocketserverinstance10" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">socket.constructTCPSocketServerInstance<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="socketconstructtcpsocketserverinstance10" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>constructTCPSocketServerInstance(): TCPSocketServer</p>     <p>创建一个TCPSocketServer对象。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.74.6.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.74.6.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#tcpsocketserver10">TCPSocketServer</a></td>         <td class="cellrowborder" width="50%">返回一个TCPSocketServer对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tcpServer</span>: socket.<span class="hljs-property">TCPSocketServer</span> = socket.<span class="hljs-title function_">constructTCPSocketServerInstance</span>();</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 206px;">     <h2 id="tcpsocketserver10" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">TCPSocketServer<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="tcpsocketserver10" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>TCPSocketServer连接。在调用TCPSocketServer的方法前，需要先通过<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#socketconstructtcpsocketserverinstance10">socket.constructTCPSocketServerInstance</a>创建TCPSocketServer对象。</p>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1708px;">     <h3 id="listen10" device-type="phone,2in1,tablet,wearable,lite_wearable,tv" class="firsth2">listen<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="listen10" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>listen(address: NetAddress, callback: AsyncCallback&lt;void&gt;): void</p>     <p>绑定IP地址和端口，端口可以指定或由系统随机分配。监听并接受与此套接字建立的TCPSocket连接。该接口使用多线程并发处理客户端的数据。使用callback方法作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>服务端使用该方法完成bind，listen，accept操作，bind方法失败会由系统随机分配端口号。</p>      </div></div></div>     <p><strong>需要权限</strong>：ohos.permission.INTERNET</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.76.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.76.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.76.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.76.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">address</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#netaddress">NetAddress</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">目标地址信息。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;void&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。失败时返回错误码、错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-net-socket">Socket错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.76.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.76.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2300002</td>         <td class="cellrowborder" width="50%">System internal error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303109</td>         <td class="cellrowborder" width="50%">Bad file number.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303111</td>         <td class="cellrowborder" width="50%">Resource temporarily unavailable. Try again.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303198</td>         <td class="cellrowborder" width="50%">Address already in use.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303199</td>         <td class="cellrowborder" width="50%">Cannot assign requested address.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tcpServer</span>: socket.<span class="hljs-property">TCPSocketServer</span> = socket.<span class="hljs-title function_">constructTCPSocketServerInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">listenAddr</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>:  <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span>,</li><li>  <span class="hljs-attr">family</span>: <span class="hljs-number">1</span></li><li>}</li><li>tcpServer.<span class="hljs-title function_">listen</span>(listenAddr, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"listen fail"</span>);</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"listen success"</span>);</li><li>})</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1778px;">     <h3 id="listen10-1" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">listen<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="listen10-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>listen(address: NetAddress): Promise&lt;void&gt;</p>     <p>绑定IP地址和端口，端口可以指定或由系统随机分配。监听并接受与此套接字建立的TCPSocket连接。该接口使用多线程并发处理客户端的数据。使用Promise方法作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>服务端使用该方法完成bind，listen，accept操作，bind方法失败会由系统随机分配端口号。</p>      </div></div></div>     <p><strong>需要权限</strong>：ohos.permission.INTERNET</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.77.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.77.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.77.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.77.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">address</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#netaddress">NetAddress</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">目标地址信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.77.10.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.77.10.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">Promise对象。无返回结果的Promise对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-net-socket">Socket错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.77.13.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.77.13.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2300002</td>         <td class="cellrowborder" width="50%">System internal error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303109</td>         <td class="cellrowborder" width="50%">Bad file number.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303111</td>         <td class="cellrowborder" width="50%">Resource temporarily unavailable. Try again.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303198</td>         <td class="cellrowborder" width="50%">Address already in use.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303199</td>         <td class="cellrowborder" width="50%">Cannot assign requested address.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tcpServer</span>: socket.<span class="hljs-property">TCPSocketServer</span> = socket.<span class="hljs-title function_">constructTCPSocketServerInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">listenAddr</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>:  <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span>,</li><li>  <span class="hljs-attr">family</span>: <span class="hljs-number">1</span></li><li>}</li><li>tcpServer.<span class="hljs-title function_">listen</span>(listenAddr).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'listen success'</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'listen fail'</span>);</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1658px;">     <h3 id="getstate10" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">getState<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getstate10" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>getState(callback: AsyncCallback&lt;SocketStateBase&gt;): void</p>     <p>获取TCPSocketServer状态。使用callback方式作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>listen方法调用成功后，才可调用此方法。</p>      </div></div></div>     <p><strong>需要权限</strong>：ohos.permission.INTERNET</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.78.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.78.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.78.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.78.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#socketstatebase">SocketStateBase</a>&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。失败时返回错误码、错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-net-socket">Socket错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.78.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.78.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2300002</td>         <td class="cellrowborder" width="50%">System internal error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303188</td>         <td class="cellrowborder" width="50%">Socket operation on non-socket.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tcpServer</span>: socket.<span class="hljs-property">TCPSocketServer</span> = socket.<span class="hljs-title function_">constructTCPSocketServerInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">listenAddr</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>:  <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span>,</li><li>  <span class="hljs-attr">family</span>: <span class="hljs-number">1</span></li><li>}</li><li>tcpServer.<span class="hljs-title function_">listen</span>(listenAddr, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"listen fail"</span>);</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"listen success"</span>);</li><li>})</li><li>tcpServer.<span class="hljs-title function_">getState</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError, data: socket.SocketStateBase</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'getState fail'</span>);</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'getState success:'</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data));</li><li>})</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1551px;">     <h3 id="getstate10-1" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">getState<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getstate10-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>getState(): Promise&lt;SocketStateBase&gt;</p>     <p>获取TCPSocketServer状态。使用Promise方式作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>listen方法调用成功后，才可调用此方法。</p>      </div></div></div>     <p><strong>需要权限</strong>：ohos.permission.INTERNET</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.79.8.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.79.8.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#socketstatebase">SocketStateBase</a>&gt;</td>         <td class="cellrowborder" width="50%">以Promise形式返回获取TCPSocket状态的结果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-net-socket">Socket错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.79.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.79.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2300002</td>         <td class="cellrowborder" width="50%">System internal error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303188</td>         <td class="cellrowborder" width="50%">Socket operation on non-socket.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tcpServer</span>: socket.<span class="hljs-property">TCPSocketServer</span> = socket.<span class="hljs-title function_">constructTCPSocketServerInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">listenAddr</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>:  <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span>,</li><li>  <span class="hljs-attr">family</span>: <span class="hljs-number">1</span></li><li>}</li><li>tcpServer.<span class="hljs-title function_">listen</span>(listenAddr, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"listen fail"</span>);</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"listen success"</span>);</li><li>})</li><li>tcpServer.<span class="hljs-title function_">getState</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">data: socket.SocketStateBase</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'getState success'</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data));</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'getState fail'</span>);</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 2111px;">     <h3 id="setextraoptions10" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">setExtraOptions<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="setextraoptions10" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>setExtraOptions(options: TCPExtraOptions, callback: AsyncCallback&lt;void&gt;): void</p>     <p>设置TCPSocketServer连接的其他属性。使用callback方式作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>listen方法调用成功后，才可调用此方法。</p>      </div></div></div>     <p><strong>需要权限</strong>：ohos.permission.INTERNET</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.80.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.80.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.80.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.80.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">options</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#tcpextraoptions">TCPExtraOptions</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">TCPSocketServer连接的其他属性。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;void&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。失败时返回错误码、错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-net-socket">Socket错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.80.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.80.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2300002</td>         <td class="cellrowborder" width="50%">System internal error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303188</td>         <td class="cellrowborder" width="50%">Socket operation on non-socket.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tcpServer</span>: socket.<span class="hljs-property">TCPSocketServer</span> = socket.<span class="hljs-title function_">constructTCPSocketServerInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">listenAddr</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>:  <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span>,</li><li>  <span class="hljs-attr">family</span>: <span class="hljs-number">1</span></li><li>}</li><li>tcpServer.<span class="hljs-title function_">listen</span>(listenAddr, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"listen fail"</span>);</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"listen success"</span>);</li><li>})</li><li>
</li><li><span class="hljs-keyword">interface</span> <span class="hljs-title class_">SocketLinger</span> {</li><li>  <span class="hljs-attr">on</span>: <span class="hljs-built_in">boolean</span>;</li><li>  <span class="hljs-attr">linger</span>: <span class="hljs-built_in">number</span>;</li><li>}</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tcpExtraOptions</span>: socket.<span class="hljs-property">TCPExtraOptions</span> = {</li><li>  <span class="hljs-attr">keepAlive</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-title class_">OOBInline</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-title class_">TCPNoDelay</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-attr">socketLinger</span>: { <span class="hljs-attr">on</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">linger</span>: <span class="hljs-number">10</span> } <span class="hljs-keyword">as</span> <span class="hljs-title class_">SocketLinger</span>,</li><li>  <span class="hljs-attr">receiveBufferSize</span>: <span class="hljs-number">8192</span>,</li><li>  <span class="hljs-attr">sendBufferSize</span>: <span class="hljs-number">8192</span>,</li><li>  <span class="hljs-attr">reuseAddress</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-attr">socketTimeout</span>: <span class="hljs-number">3000</span></li><li>}</li><li>tcpServer.<span class="hljs-title function_">setExtraOptions</span>(tcpExtraOptions, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'setExtraOptions fail'</span>);</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'setExtraOptions success'</span>);</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 2189px;">     <h3 id="setextraoptions10-1" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">setExtraOptions<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="setextraoptions10-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>setExtraOptions(options: TCPExtraOptions): Promise&lt;void&gt;</p>     <p>设置TCPSocketServer连接的其他属性。使用Promise方式作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>listen方法调用成功后，才可调用此方法。</p>      </div></div></div>     <p><strong>需要权限</strong>：ohos.permission.INTERNET</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.81.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.81.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.81.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.81.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">options</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#tcpextraoptions">TCPExtraOptions</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">TCPSocketServer连接的其他属性。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.81.10.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.81.10.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">Promise对象。无返回结果的Promise对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-net-socket">Socket错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.81.13.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.81.13.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2300002</td>         <td class="cellrowborder" width="50%">System internal error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303188</td>         <td class="cellrowborder" width="50%">Socket operation on non-socket.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tcpServer</span>: socket.<span class="hljs-property">TCPSocketServer</span> = socket.<span class="hljs-title function_">constructTCPSocketServerInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">listenAddr</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>:  <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span>,</li><li>  <span class="hljs-attr">family</span>: <span class="hljs-number">1</span></li><li>}</li><li>
</li><li><span class="hljs-keyword">interface</span> <span class="hljs-title class_">SocketLinger</span> {</li><li>  <span class="hljs-attr">on</span>: <span class="hljs-built_in">boolean</span>;</li><li>  <span class="hljs-attr">linger</span>: <span class="hljs-built_in">number</span>;</li><li>}</li><li>
</li><li>tcpServer.<span class="hljs-title function_">listen</span>(listenAddr, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"listen fail"</span>);</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"listen success"</span>);</li><li>})</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tcpExtraOptions</span>: socket.<span class="hljs-property">TCPExtraOptions</span> = {</li><li>  <span class="hljs-attr">keepAlive</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-title class_">OOBInline</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-title class_">TCPNoDelay</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-attr">socketLinger</span>: { <span class="hljs-attr">on</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">linger</span>: <span class="hljs-number">10</span> } <span class="hljs-keyword">as</span> <span class="hljs-title class_">SocketLinger</span>,</li><li>  <span class="hljs-attr">receiveBufferSize</span>: <span class="hljs-number">8192</span>,</li><li>  <span class="hljs-attr">sendBufferSize</span>: <span class="hljs-number">8192</span>,</li><li>  <span class="hljs-attr">reuseAddress</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-attr">socketTimeout</span>: <span class="hljs-number">3000</span></li><li>}</li><li>tcpServer.<span class="hljs-title function_">setExtraOptions</span>(tcpExtraOptions).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'setExtraOptions success'</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'setExtraOptions fail'</span>);</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1431px;">     <h3 id="getlocaladdress12-2" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">getLocalAddress<sup>12+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getlocaladdress12-2" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>getLocalAddress(): Promise&lt;NetAddress&gt;</p>     <p>获取TCPSocketServer的本地Socket地址。使用Promise方式作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>listen方法调用成功后，才可调用此方法。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.82.7.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.82.7.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#netaddress">NetAddress</a>&gt;</td>         <td class="cellrowborder" width="50%">以Promise形式返回获取本地socket地址的结果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-net-socket">Socket错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.82.10.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.82.10.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">2300002</td>         <td class="cellrowborder" width="50%">System internal error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301009</td>         <td class="cellrowborder" width="50%">Bad file descriptor.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303188</td>         <td class="cellrowborder" width="50%">Socket operation on non-socket.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tcpServer</span>: socket.<span class="hljs-property">TCPSocketServer</span> = socket.<span class="hljs-title function_">constructTCPSocketServerInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">listenAddr</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span>,</li><li>  <span class="hljs-attr">family</span>: <span class="hljs-number">1</span></li><li>}</li><li>tcpServer.<span class="hljs-title function_">listen</span>(listenAddr).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  tcpServer.<span class="hljs-title function_">getLocalAddress</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">localAddress: socket.NetAddress</span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"SUCCESS! Address:"</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(localAddress));</li><li>  }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"FerrorAILED! Error:"</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));</li><li>  })</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'listen fail'</span>);</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1442px;">     <h3 id="onconnect10" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">on('connect')<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onconnect10" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>on(type: 'connect', callback: Callback&lt;TCPSocketConnection&gt;): void</p>     <p>订阅TCPSocketServer的连接事件。使用callback方式作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>listen方法调用成功后，才可调用此方法。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.83.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.83.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.83.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.83.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">订阅的事件类型。'connect'：连接事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#tcpsocketconnection10">TCPSocketConnection</a>&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。失败时返回错误码、错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.83.10.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.83.10.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tcpServer</span>: socket.<span class="hljs-property">TCPSocketServer</span> = socket.<span class="hljs-title function_">constructTCPSocketServerInstance</span>();</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">listenAddr</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>:  <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span>,</li><li>  <span class="hljs-attr">family</span>: <span class="hljs-number">1</span></li><li>}</li><li>tcpServer.<span class="hljs-title function_">listen</span>(listenAddr, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"listen fail"</span>);</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"listen success"</span>);</li><li>  tcpServer.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connect'</span>, <span class="hljs-function">(<span class="hljs-params">data: socket.TCPSocketConnection</span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data))</li><li>  });</li><li>})</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1494px;">     <h3 id="offconnect10" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">off('connect')<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="offconnect10" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>off(type: 'connect', callback?: Callback&lt;TCPSocketConnection&gt;): void</p>     <p>取消订阅TCPSocketServer的连接事件。使用callback方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.84.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.84.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.84.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.84.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">取消订阅的事件类型。'connect'：连接事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#tcpsocketconnection10">TCPSocketConnection</a>&gt;</td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">回调函数。可以指定传入on中的callback取消对应的订阅，也可以不指定callback清空所有订阅。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.84.9.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.84.9.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tcpServer</span>: socket.<span class="hljs-property">TCPSocketServer</span> = socket.<span class="hljs-title function_">constructTCPSocketServerInstance</span>();</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">listenAddr</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>:  <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span>,</li><li>  <span class="hljs-attr">family</span>: <span class="hljs-number">1</span></li><li>}</li><li>tcpServer.<span class="hljs-title function_">listen</span>(listenAddr, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"listen fail"</span>);</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"listen success"</span>);</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-title function_">callback</span> = (<span class="hljs-params">data: socket.TCPSocketConnection</span>) =&gt; {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'on connect message: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data));</li><li>  }</li><li>  tcpServer.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connect'</span>, callback);</li><li>  <span class="hljs-comment">// 可以指定传入on中的callback取消一个订阅，也可以不指定callback清空所有订阅。</span></li><li>  tcpServer.<span class="hljs-title function_">off</span>(<span class="hljs-string">'connect'</span>, callback);</li><li>  tcpServer.<span class="hljs-title function_">off</span>(<span class="hljs-string">'connect'</span>);</li><li>})</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1442px;">     <h3 id="onerror10" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">on('error')<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onerror10" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>on(type: 'error', callback: ErrorCallback): void</p>     <p>订阅TCPSocketServer连接的error事件。使用callback方式作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>listen方法调用成功后，才可调用此方法。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.85.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.85.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.85.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.85.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">订阅的事件类型。'error'：error事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">ErrorCallback</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。失败时返回错误码、错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.85.10.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.85.10.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tcpServer</span>: socket.<span class="hljs-property">TCPSocketServer</span> = socket.<span class="hljs-title function_">constructTCPSocketServerInstance</span>();</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">listenAddr</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>:  <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span>,</li><li>  <span class="hljs-attr">family</span>: <span class="hljs-number">1</span></li><li>}</li><li>tcpServer.<span class="hljs-title function_">listen</span>(listenAddr, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"listen fail"</span>);</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"listen success"</span>);</li><li>  tcpServer.<span class="hljs-title function_">on</span>(<span class="hljs-string">'error'</span>, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"on error, err:"</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err))</li><li>  });</li><li>})</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1494px;">     <h3 id="offerror10" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">off('error')<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="offerror10" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>off(type: 'error', callback?: ErrorCallback): void</p>     <p>取消订阅TCPSocketServer连接的error事件。使用callback方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.86.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.86.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.86.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.86.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">取消订阅的事件类型。'error'：error事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">ErrorCallback</td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">回调函数。可以指定传入on中的callback取消对应的订阅，也可以不指定callback清空所有订阅。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.86.9.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.86.9.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tcpServer</span>: socket.<span class="hljs-property">TCPSocketServer</span> = socket.<span class="hljs-title function_">constructTCPSocketServerInstance</span>();</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">listenAddr</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>:  <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span>,</li><li>  <span class="hljs-attr">family</span>: <span class="hljs-number">1</span></li><li>}</li><li>tcpServer.<span class="hljs-title function_">listen</span>(listenAddr, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"listen fail"</span>);</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"listen success"</span>);</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-title function_">callback</span> = (<span class="hljs-params">err: BusinessError</span>) =&gt; {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"on error, err:"</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));</li><li>  }</li><li>  tcpServer.<span class="hljs-title function_">on</span>(<span class="hljs-string">'error'</span>, callback);</li><li>  <span class="hljs-comment">// 可以指定传入on中的callback取消一个订阅，也可以不指定callback清空所有订阅。</span></li><li>  tcpServer.<span class="hljs-title function_">off</span>(<span class="hljs-string">'error'</span>, callback);</li><li>  tcpServer.<span class="hljs-title function_">off</span>(<span class="hljs-string">'error'</span>);</li><li>})</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1496px;">     <h3 id="close20" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">close<sup>20+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="close20" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>close(): Promise&lt;void&gt;</p>     <p>TCPSocketServer停止监听并释放通过<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#listen10">listen</a>方法绑定的端口。若多次调用<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#listen10">listen</a>方法，再调用此方法时会释放TCPSocketServer的所有监听端口。使用Promise异步回调。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>该方法不会关闭已有连接。如需关闭，请调用<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#tcpsocketconnection10">TCPSocketConnection</a>的<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#close10">close</a>方法。</p>      </div></div></div>     <p><strong>需要权限</strong>：ohos.permission.INTERNET</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.87.8.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.87.8.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">Promise对象，无返回结果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-net-socket">Socket错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.87.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.87.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2300002</td>         <td class="cellrowborder" width="50%">System internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tcpServer</span>: socket.<span class="hljs-property">TCPSocketServer</span> = socket.<span class="hljs-title function_">constructTCPSocketServerInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">listenAddr</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span>,</li><li>  <span class="hljs-attr">family</span>: <span class="hljs-number">1</span></li><li>}</li><li>tcpServer.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connect'</span>, <span class="hljs-function">(<span class="hljs-params">connection: socket.TCPSocketConnection</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"connection clientId: "</span> + connection.<span class="hljs-property">clientId</span>);</li><li>  <span class="hljs-comment">// 逻辑处理</span></li><li>  tcpServer.<span class="hljs-title function_">close</span>(); <span class="hljs-comment">// 停止监听</span></li><li>  connection.<span class="hljs-title function_">close</span>(); <span class="hljs-comment">// 关闭当前连接</span></li><li>});</li><li>tcpServer.<span class="hljs-title function_">listen</span>(listenAddr).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'listen success'</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'listen fail: '</span> + err.<span class="hljs-property">code</span>);</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 346px;">     <h2 id="tcpsocketconnection10" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">TCPSocketConnection<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="tcpsocketconnection10" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>TCPSocketConnection连接，即TCPSocket客户端与服务端的连接。在调用TCPSocketConnection的方法前，需要先获取TCPSocketConnection对象。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>客户端与服务端成功建立连接后，才能通过返回的TCPSocketConnection对象调用相应的接口。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 207px;">     <h3 id="属性" class="firsth2">属性<i class="anchor-icon anchor-icon-link" anchorid="属性" tips="复制节点链接"></i></h3>          <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.89.2.1.6.1.1" width="20%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.89.2.1.6.1.2" width="20%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.89.2.1.6.1.3" width="20%">只读</th>         <th align="left" class="cellrowborder" id="mcps1.3.89.2.1.6.1.4" width="20%">可选</th>         <th align="left" class="cellrowborder" id="mcps1.3.89.2.1.6.1.5" width="20%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">clientId</td>         <td class="cellrowborder" width="20%">number</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">客户端与TCPSocketServer建立连接的id。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1408px;">     <h3 id="send10" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">send<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="send10" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>send(options: TCPSendOptions, callback: AsyncCallback&lt;void&gt;): void</p>     <p>通过TCPSocketConnection连接发送数据。使用callback方式作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>与客户端建立连接后，才可调用此方法。</p>      </div></div></div>     <p><strong>需要权限</strong>：ohos.permission.INTERNET</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.90.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.90.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.90.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.90.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">options</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#tcpsendoptions">TCPSendOptions</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">TCPSocketConnection发送请求的参数。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;void&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。失败时返回错误码、错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-net-socket">Socket错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.90.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.90.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2300002</td>         <td class="cellrowborder" width="50%">System internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tcpServer</span>: socket.<span class="hljs-property">TCPSocketServer</span> = socket.<span class="hljs-title function_">constructTCPSocketServerInstance</span>();</li><li>
</li><li>tcpServer.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connect'</span>, <span class="hljs-function">(<span class="hljs-params">client: socket.TCPSocketConnection</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">tcpSendOption</span>: socket.<span class="hljs-property">TCPSendOptions</span> = {</li><li>    <span class="hljs-attr">data</span>: <span class="hljs-string">'Hello, client!'</span></li><li>  }</li><li>  client.<span class="hljs-title function_">send</span>(tcpSendOption, <span class="hljs-function">() =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'send success'</span>);</li><li>  });</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1582px;">     <h3 id="send10-1" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">send<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="send10-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>send(options: TCPSendOptions): Promise&lt;void&gt;</p>     <p>通过TCPSocketConnection连接发送数据。使用Promise方式作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>与客户端建立连接后，才可调用此方法。</p>      </div></div></div>     <p><strong>需要权限</strong>：ohos.permission.INTERNET</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.91.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.91.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.91.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.91.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">options</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#tcpsendoptions">TCPSendOptions</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">TCPSocketConnection发送请求的参数。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.91.10.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.91.10.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">Promise对象。无返回结果的Promise对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-net-socket">Socket错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.91.13.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.91.13.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2300002</td>         <td class="cellrowborder" width="50%">System internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tcpServer</span>: socket.<span class="hljs-property">TCPSocketServer</span> = socket.<span class="hljs-title function_">constructTCPSocketServerInstance</span>();</li><li>
</li><li>tcpServer.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connect'</span>, <span class="hljs-function">(<span class="hljs-params">client: socket.TCPSocketConnection</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">tcpSendOption</span>: socket.<span class="hljs-property">TCPSendOptions</span> = {</li><li>    <span class="hljs-attr">data</span>: <span class="hljs-string">'Hello, client!'</span></li><li>  }</li><li>  client.<span class="hljs-title function_">send</span>(tcpSendOption).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'send success'</span>);</li><li>  }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'send fail'</span>);</li><li>  });</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1295px;">     <h3 id="close10" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">close<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="close10" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>close(callback: AsyncCallback&lt;void&gt;): void</p>     <p>关闭一个与TCPSocket建立的连接。使用callback方式作为异步方法。</p>     <p><strong>需要权限</strong>：ohos.permission.INTERNET</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.92.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.92.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.92.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.92.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;void&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。失败时返回错误码、错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-net-socket">Socket错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.92.10.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.92.10.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2300002</td>         <td class="cellrowborder" width="50%">System internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tcpServer</span>: socket.<span class="hljs-property">TCPSocketServer</span> = socket.<span class="hljs-title function_">constructTCPSocketServerInstance</span>();</li><li>
</li><li>tcpServer.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connect'</span>, <span class="hljs-function">(<span class="hljs-params">client: socket.TCPSocketConnection</span>) =&gt;</span> {</li><li>  client.<span class="hljs-title function_">close</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>    <span class="hljs-keyword">if</span> (err) {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'close fail'</span>);</li><li>      <span class="hljs-keyword">return</span>;</li><li>    }</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'close success'</span>);</li><li>  });</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1164px;">     <h3 id="close10-1" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">close<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="close10-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>close(): Promise&lt;void&gt;</p>     <p>关闭一个与TCPSocket建立的连接。使用Promise方式作为异步方法。</p>     <p><strong>需要权限</strong>：ohos.permission.INTERNET</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.93.7.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.93.7.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">Promise对象。无返回结果的Promise对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-net-socket">Socket错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.93.10.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.93.10.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2300002</td>         <td class="cellrowborder" width="50%">System internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tcpServer</span>: socket.<span class="hljs-property">TCPSocketServer</span> = socket.<span class="hljs-title function_">constructTCPSocketServerInstance</span>();</li><li>tcpServer.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connect'</span>, <span class="hljs-function">(<span class="hljs-params">client: socket.TCPSocketConnection</span>) =&gt;</span> {</li><li>  client.<span class="hljs-title function_">close</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'close success'</span>);</li><li>  }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'close fail'</span>);</li><li>  });</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1418px;">     <h3 id="getremoteaddress10" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">getRemoteAddress<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getremoteaddress10" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>getRemoteAddress(callback: AsyncCallback&lt;NetAddress&gt;): void</p>     <p>获取对端Socket地址。使用callback方式作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>与客户端建立连接后，才可调用此方法。</p>      </div></div></div>     <p><strong>需要权限</strong>：ohos.permission.INTERNET</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.94.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.94.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.94.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.94.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#netaddress">NetAddress</a>&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。失败时返回错误码、错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-net-socket">Socket错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.94.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.94.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2300002</td>         <td class="cellrowborder" width="50%">System internal error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303188</td>         <td class="cellrowborder" width="50%">Socket operation on non-socket.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tcpServer</span>: socket.<span class="hljs-property">TCPSocketServer</span> = socket.<span class="hljs-title function_">constructTCPSocketServerInstance</span>();</li><li>tcpServer.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connect'</span>, <span class="hljs-function">(<span class="hljs-params">client: socket.TCPSocketConnection</span>) =&gt;</span> {</li><li>  client.<span class="hljs-title function_">getRemoteAddress</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError, data: socket.NetAddress</span>) =&gt;</span> {</li><li>    <span class="hljs-keyword">if</span> (err) {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'getRemoteAddress fail'</span>);</li><li>      <span class="hljs-keyword">return</span>;</li><li>    }</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'getRemoteAddress success:'</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data));</li><li>  });</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1311px;">     <h3 id="getremoteaddress10-1" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">getRemoteAddress<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getremoteaddress10-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>getRemoteAddress(): Promise&lt;NetAddress&gt;</p>     <p>获取对端Socket地址。使用Promise方式作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>与客户端建立连接后，才可调用此方法。</p>      </div></div></div>     <p><strong>需要权限</strong>：ohos.permission.INTERNET</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.95.8.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.95.8.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#netaddress">NetAddress</a>&gt;</td>         <td class="cellrowborder" width="50%">以Promise形式返回获取对端socket地址的结果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-net-socket">Socket错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.95.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.95.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2300002</td>         <td class="cellrowborder" width="50%">System internal error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303188</td>         <td class="cellrowborder" width="50%">Socket operation on non-socket.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tcpServer</span>: socket.<span class="hljs-property">TCPSocketServer</span> = socket.<span class="hljs-title function_">constructTCPSocketServerInstance</span>();</li><li>tcpServer.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connect'</span>, <span class="hljs-function">(<span class="hljs-params">client: socket.TCPSocketConnection</span>) =&gt;</span> {</li><li>  client.<span class="hljs-title function_">getRemoteAddress</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'getRemoteAddress success'</span>);</li><li>  }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'getRemoteAddress fail'</span>);</li><li>  });</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1723px;">     <h3 id="getlocaladdress12-3" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">getLocalAddress<sup>12+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getlocaladdress12-3" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>getLocalAddress(): Promise&lt;NetAddress&gt;</p>     <p>获取TCPSocketConnection连接的本地Socket地址。使用Promise方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.96.6.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.96.6.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#netaddress">NetAddress</a>&gt;</td>         <td class="cellrowborder" width="50%">以Promise形式返回获取本地socket地址的结果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-net-socket">Socket错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.96.9.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.96.9.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">2300002</td>         <td class="cellrowborder" width="50%">System internal error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301009</td>         <td class="cellrowborder" width="50%">Bad file descriptor.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303188</td>         <td class="cellrowborder" width="50%">Socket operation on non-socket.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tcpServer</span>: socket.<span class="hljs-property">TCPSocketServer</span> = socket.<span class="hljs-title function_">constructTCPSocketServerInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">listenAddr</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">"192.168.xx.xx"</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span>,</li><li>  <span class="hljs-attr">family</span>: <span class="hljs-number">1</span></li><li>}</li><li>tcpServer.<span class="hljs-title function_">listen</span>(listenAddr, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">tcp</span>: socket.<span class="hljs-property">TCPSocket</span> = socket.<span class="hljs-title function_">constructTCPSocketInstance</span>();</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">netAddress</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>    <span class="hljs-attr">address</span>: <span class="hljs-string">"192.168.xx.xx"</span>,</li><li>    <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>  }</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">options</span>: socket.<span class="hljs-property">TCPConnectOptions</span> = {</li><li>    <span class="hljs-attr">address</span>: netAddress,</li><li>    <span class="hljs-attr">timeout</span>: <span class="hljs-number">6000</span></li><li>  }</li><li>  tcp.<span class="hljs-title function_">connect</span>(options, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>    <span class="hljs-keyword">if</span> (err) {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'connect fail'</span>);</li><li>      <span class="hljs-keyword">return</span>;</li><li>    }</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'connect success!'</span>);</li><li>  })</li><li>  tcpServer.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connect'</span>, <span class="hljs-function">(<span class="hljs-params">client: socket.TCPSocketConnection</span>) =&gt;</span> {</li><li>    client.<span class="hljs-title function_">getLocalAddress</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">localAddress: socket.NetAddress</span>) =&gt;</span> {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"Family IP Port: "</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(localAddress));</li><li>    }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'Error:'</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));</li><li>    });</li><li>  })</li><li>})</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1326px;">     <h3 id="onmessage10" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">on('message')<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onmessage10" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>on(type: 'message', callback: Callback&lt;SocketMessageInfo&gt;): void</p>     <p>订阅TCPSocketConnection连接的接收消息事件。使用callback方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.97.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.97.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.97.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.97.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">订阅的事件类型。'message'：接收消息事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#socketmessageinfo11">SocketMessageInfo</a>&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。失败时返回错误码、错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.97.9.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.97.9.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tcpServer</span>: socket.<span class="hljs-property">TCPSocketServer</span> = socket.<span class="hljs-title function_">constructTCPSocketServerInstance</span>();</li><li>
</li><li>tcpServer.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connect'</span>, <span class="hljs-function">(<span class="hljs-params">client: socket.TCPSocketConnection</span>) =&gt;</span> {</li><li>  client.<span class="hljs-title function_">on</span>(<span class="hljs-string">'message'</span>, <span class="hljs-function">(<span class="hljs-params">value: socket.SocketMessageInfo</span>) =&gt;</span> {</li><li>    <span class="hljs-keyword">let</span> messageView = <span class="hljs-string">''</span>;</li><li>    <span class="hljs-keyword">let</span> uint8Array = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(value.<span class="hljs-property">message</span>);</li><li>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> <span class="hljs-attr">i</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>; i &lt; value.<span class="hljs-property">message</span>.<span class="hljs-property">byteLength</span>; i++) {</li><li>      <span class="hljs-keyword">let</span> messages = uint8Array[i];</li><li>      <span class="hljs-keyword">let</span> message = <span class="hljs-title class_">String</span>.<span class="hljs-title function_">fromCharCode</span>(messages);</li><li>      messageView += message;</li><li>    }</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'on message message: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(messageView));</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'remoteInfo: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(value.<span class="hljs-property">remoteInfo</span>));</li><li>  });</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1446px;">     <h3 id="offmessage10" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">off('message')<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="offmessage10" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>off(type: 'message', callback?: Callback&lt;SocketMessageInfo&gt;): void</p>     <p>取消订阅TCPSocketConnection连接的接收消息事件。使用callback方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.98.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.98.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.98.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.98.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">取消订阅的事件类型。'message'：接收消息事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#socketmessageinfo11">SocketMessageInfo</a>&gt;</td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">回调函数。可以指定传入on中的callback取消对应的订阅，也可以不指定callback清空所有订阅。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.98.9.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.98.9.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tcpServer</span>: socket.<span class="hljs-property">TCPSocketServer</span> = socket.<span class="hljs-title function_">constructTCPSocketServerInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-title function_">callback</span> = (<span class="hljs-params">value: socket.SocketMessageInfo</span>) =&gt; {</li><li>  <span class="hljs-keyword">let</span> messageView = <span class="hljs-string">''</span>;</li><li>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> <span class="hljs-attr">i</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>; i &lt; value.<span class="hljs-property">message</span>.<span class="hljs-property">byteLength</span>; i++) {</li><li>    <span class="hljs-keyword">let</span> uint8Array = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(value.<span class="hljs-property">message</span>)</li><li>    <span class="hljs-keyword">let</span> messages = uint8Array[i]</li><li>    <span class="hljs-keyword">let</span> message = <span class="hljs-title class_">String</span>.<span class="hljs-title function_">fromCharCode</span>(messages);</li><li>    messageView += message;</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'on message message: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(messageView));</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'remoteInfo: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(value.<span class="hljs-property">remoteInfo</span>));</li><li>}</li><li>tcpServer.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connect'</span>, <span class="hljs-function">(<span class="hljs-params">client: socket.TCPSocketConnection</span>) =&gt;</span> {</li><li>  client.<span class="hljs-title function_">on</span>(<span class="hljs-string">'message'</span>, callback);</li><li>  <span class="hljs-comment">// 可以指定传入on中的callback取消一个订阅，也可以不指定callback清空所有订阅。</span></li><li>  client.<span class="hljs-title function_">off</span>(<span class="hljs-string">'message'</span>, callback);</li><li>  client.<span class="hljs-title function_">off</span>(<span class="hljs-string">'message'</span>);</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1086px;">     <h3 id="onclose10" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">on('close')<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onclose10" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>on(type: 'close', callback: Callback&lt;void&gt;): void</p>     <p>订阅TCPSocketConnection的关闭事件。使用callback方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.99.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.99.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.99.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.99.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">订阅的事件类型。'close'：关闭事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;void&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。失败时返回错误码、错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.99.9.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.99.9.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tcpServer</span>: socket.<span class="hljs-property">TCPSocketServer</span> = socket.<span class="hljs-title function_">constructTCPSocketServerInstance</span>();</li><li>tcpServer.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connect'</span>, <span class="hljs-function">(<span class="hljs-params">client: socket.TCPSocketConnection</span>) =&gt;</span> {</li><li>  client.<span class="hljs-title function_">on</span>(<span class="hljs-string">'close'</span>, <span class="hljs-function">() =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"on close success"</span>)</li><li>  });</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1206px;">     <h3 id="offclose10" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">off('close')<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="offclose10" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>off(type: 'close', callback?: Callback&lt;void&gt;): void</p>     <p>取消订阅TCPSocketConnection的关闭事件。使用callback方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.100.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.100.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.100.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.100.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">取消订阅的事件类型。'close'：关闭事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;void&gt;</td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">回调函数。可以指定传入on中的callback取消对应的订阅，也可以不指定callback清空所有订阅。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.100.9.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.100.9.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tcpServer</span>: socket.<span class="hljs-property">TCPSocketServer</span> = socket.<span class="hljs-title function_">constructTCPSocketServerInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-title function_">callback</span> = (<span class="hljs-params"></span>) =&gt; {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"on close success"</span>);</li><li>}</li><li>tcpServer.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connect'</span>, <span class="hljs-function">(<span class="hljs-params">client: socket.TCPSocketConnection</span>) =&gt;</span> {</li><li>  client.<span class="hljs-title function_">on</span>(<span class="hljs-string">'close'</span>, callback);</li><li>  <span class="hljs-comment">// 可以指定传入on中的callback取消一个订阅，也可以不指定callback清空所有订阅。</span></li><li>  client.<span class="hljs-title function_">off</span>(<span class="hljs-string">'close'</span>, callback);</li><li>  client.<span class="hljs-title function_">off</span>(<span class="hljs-string">'close'</span>);</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1086px;">     <h3 id="onerror10-1" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">on('error')<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onerror10-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>on(type: 'error', callback: ErrorCallback): void</p>     <p>订阅TCPSocketConnection连接的error事件。使用callback方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.101.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.101.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.101.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.101.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">订阅的事件类型。'error'：error事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">ErrorCallback</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。失败时返回错误码、错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.101.9.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.101.9.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tcpServer</span>: socket.<span class="hljs-property">TCPSocketServer</span> = socket.<span class="hljs-title function_">constructTCPSocketServerInstance</span>();</li><li>tcpServer.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connect'</span>, <span class="hljs-function">(<span class="hljs-params">client: socket.TCPSocketConnection</span>) =&gt;</span> {</li><li>  client.<span class="hljs-title function_">on</span>(<span class="hljs-string">'error'</span>, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"on error, err:"</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err))</li><li>  });</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1230px;">     <h3 id="offerror10-1" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">off('error')<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="offerror10-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>off(type: 'error', callback?: ErrorCallback): void</p>     <p>取消订阅TCPSocketConnection连接的error事件。使用callback方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.102.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.102.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.102.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.102.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">取消订阅的事件类型。'error'：error事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">ErrorCallback</td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">回调函数。可以指定传入on中的callback取消对应的订阅，也可以不指定callback清空所有订阅。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.102.9.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.102.9.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-title function_">callback</span> = (<span class="hljs-params">err: BusinessError</span>) =&gt; {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"on error, err:"</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));</li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tcpServer</span>: socket.<span class="hljs-property">TCPSocketServer</span> = socket.<span class="hljs-title function_">constructTCPSocketServerInstance</span>();</li><li>tcpServer.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connect'</span>, <span class="hljs-function">(<span class="hljs-params">client: socket.TCPSocketConnection</span>) =&gt;</span> {</li><li>  client.<span class="hljs-title function_">on</span>(<span class="hljs-string">'error'</span>, callback);</li><li>  <span class="hljs-comment">// 可以指定传入on中的callback取消一个订阅，也可以不指定callback清空所有订阅。</span></li><li>  client.<span class="hljs-title function_">off</span>(<span class="hljs-string">'error'</span>, callback);</li><li>  client.<span class="hljs-title function_">off</span>(<span class="hljs-string">'error'</span>);</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 230px;">     <h2 id="tcp-错误码说明" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">TCP 错误码说明<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="tcp-错误码说明" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>TCP 其余错误码映射形式为：2301000 + Linux内核错误码。</p>     <p>错误码的详细介绍参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-net-socket">Socket错误码</a>。</p>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 634px;">     <h2 id="socketconstructlocalsocketinstance11" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">socket.constructLocalSocketInstance<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="socketconstructlocalsocketinstance11" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>constructLocalSocketInstance(): LocalSocket</p>     <p>创建一个LocalSocket对象。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.104.6.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.104.6.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#localsocket11">LocalSocket</a></td>         <td class="cellrowborder" width="50%">返回一个LocalSocket对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">client</span>: socket.<span class="hljs-property">LocalSocket</span> = socket.<span class="hljs-title function_">constructLocalSocketInstance</span>();</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 182px;">     <h2 id="localsocket11" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">LocalSocket<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="localsocket11" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>LocalSocket连接。在调用LocalSocket的方法前，需要先通过<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#socketconstructlocalsocketinstance11">socket.constructLocalSocketInstance</a>创建LocalSocket对象。</p>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1689px;">     <h3 id="bind11" device-type="phone,2in1,tablet,wearable,lite_wearable,tv" class="firsth2">bind<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="bind11" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>bind(address: LocalAddress): Promise&lt;void&gt;;</p>     <p>绑定本地套接字文件的路径。使用promise方法作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>bind方法可以使客户端确保有个明确的本地套接字路径，显式的绑定一个本地套接字文件。</p>       <p>bind方法在本地套接字通信中非必须。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.106.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.106.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.106.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.106.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">address</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#localaddress11">LocalAddress</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">本端地址信息，参考<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#localaddress11">LocalAddress</a>。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.106.9.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.106.9.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">Promise对象。无返回结果的Promise对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-net-socket">Socket错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.106.12.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.106.12.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301013</td>         <td class="cellrowborder" width="50%">Insufficient permissions.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301022</td>         <td class="cellrowborder" width="50%">Invalid argument.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301098</td>         <td class="cellrowborder" width="50%">Address already in use.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>在本文档的示例中，通过this.context来获取UIAbilityContext，其中this代表继承自UIAbility的UIAbility实例。如需在页面中使用UIAbilityContext提供的能力，请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/uiability-usage#获取uiability的上下文信息" target="_blank">获取UIAbility的上下文信息</a>。</p>      </div></div></div>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">client</span>: socket.<span class="hljs-property">LocalSocket</span> = socket.<span class="hljs-title function_">constructLocalSocketInstance</span>()</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">context</span>: common.<span class="hljs-property">UIAbilityContext</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">sandboxPath</span>: <span class="hljs-built_in">string</span> = context.<span class="hljs-property">filesDir</span> + <span class="hljs-string">'/testSocket'</span>;</li><li><span class="hljs-keyword">let</span> address : socket.<span class="hljs-property">LocalAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: sandboxPath</li><li>}</li><li>client.<span class="hljs-title function_">bind</span>(address).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'bind success'</span>)</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: <span class="hljs-built_in">Object</span></span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'failed to bind: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err))</li><li>})</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1832px;">     <h3 id="connect11" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">connect<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="connect11" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>connect(options: LocalConnectOptions): Promise&lt;void&gt;</p>     <p>连接到指定的套接字文件。使用promise方法作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>在没有执行localsocket.bind的情况下，也可以直接调用该接口完成与LocalSocket服务端的连接。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.107.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.107.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.107.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.107.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">options</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#localconnectoptions11">LocalConnectOptions</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">LocalSocket连接的参数，参考<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#localconnectoptions11">LocalConnectOptions</a>。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.107.9.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.107.9.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">以Promise形式返回LocalSocket连接服务端的结果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-net-socket">Socket错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.107.12.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.107.12.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301013</td>         <td class="cellrowborder" width="50%">Insufficient permissions.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301022</td>         <td class="cellrowborder" width="50%">Invalid argument.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301111</td>         <td class="cellrowborder" width="50%">Connection refused.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301099</td>         <td class="cellrowborder" width="50%">Cannot assign requested address.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>在本文档的示例中，通过this.context来获取UIAbilityContext，其中this代表继承自UIAbility的UIAbility实例。如需在页面中使用UIAbilityContext提供的能力，请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/uiability-usage#获取uiability的上下文信息" target="_blank">获取UIAbility的上下文信息</a>。</p>      </div></div></div>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">client</span>: socket.<span class="hljs-property">LocalSocket</span> = socket.<span class="hljs-title function_">constructLocalSocketInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">context</span>: common.<span class="hljs-property">UIAbilityContext</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">sandboxPath</span>: <span class="hljs-built_in">string</span> = context.<span class="hljs-property">filesDir</span> + <span class="hljs-string">'/testSocket'</span>;</li><li><span class="hljs-keyword">let</span> localAddress : socket.<span class="hljs-property">LocalAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: sandboxPath</li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">connectOpt</span>: socket.<span class="hljs-property">LocalConnectOptions</span> = {</li><li>  <span class="hljs-attr">address</span>: localAddress,</li><li>  <span class="hljs-attr">timeout</span>: <span class="hljs-number">6000</span></li><li>}</li><li>client.<span class="hljs-title function_">connect</span>(connectOpt).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'connect success'</span>)</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: <span class="hljs-built_in">Object</span></span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'connect fail: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1883px;">     <h3 id="send11" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">send<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="send11" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>send(options: LocalSendOptions): Promise&lt;void&gt;</p>     <p>通过LocalSocket连接发送数据。使用Promise方式作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>connect方法调用成功后，才可调用此方法。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.108.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.108.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.108.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.108.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">options</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#localsendoptions11">LocalSendOptions</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">LocalSocket发送请求的参数，参考<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#localsendoptions11">LocalSendOptions</a>。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.108.9.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.108.9.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">Promise对象。无返回结果的Promise对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-net-socket">Socket错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.108.12.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.108.12.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301011</td>         <td class="cellrowborder" width="50%">Operation would block.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>在本文档的示例中，通过this.context来获取UIAbilityContext，其中this代表继承自UIAbility的UIAbility实例。如需在页面中使用UIAbilityContext提供的能力，请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/uiability-usage#获取uiability的上下文信息" target="_blank">获取UIAbility的上下文信息</a>。</p>      </div></div></div>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">client</span>: socket.<span class="hljs-property">LocalSocket</span> = socket.<span class="hljs-title function_">constructLocalSocketInstance</span>()</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">context</span>: common.<span class="hljs-property">UIAbilityContext</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">sandboxPath</span>: <span class="hljs-built_in">string</span> = context.<span class="hljs-property">filesDir</span> + <span class="hljs-string">'/testSocket'</span>;</li><li><span class="hljs-keyword">let</span> localAddress : socket.<span class="hljs-property">LocalAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: sandboxPath</li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">connectOpt</span>: socket.<span class="hljs-property">LocalConnectOptions</span> = {</li><li>  <span class="hljs-attr">address</span>: localAddress,</li><li>  <span class="hljs-attr">timeout</span>: <span class="hljs-number">6000</span></li><li>}</li><li>client.<span class="hljs-title function_">connect</span>(connectOpt).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'connect success'</span>)</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: <span class="hljs-built_in">Object</span></span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'connect failed: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err))</li><li>})</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">sendOpt</span>: socket.<span class="hljs-property">LocalSendOptions</span> = {</li><li>  <span class="hljs-attr">data</span>: <span class="hljs-string">'Hello world!'</span></li><li>}</li><li>client.<span class="hljs-title function_">send</span>(sendOpt).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'send success'</span>)</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: <span class="hljs-built_in">Object</span></span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'send fail: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err))</li><li>})</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1013px;">     <h3 id="close11" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">close<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="close11" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>close(): Promise&lt;void&gt;</p>     <p>关闭LocalSocket连接。使用Promise方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.109.6.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.109.6.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">Promise对象。无返回结果的Promise对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-net-socket">Socket错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.109.9.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.109.9.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">2301009</td>         <td class="cellrowborder" width="50%">Bad file descriptor.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">client</span>: socket.<span class="hljs-property">LocalSocket</span> = socket.<span class="hljs-title function_">constructLocalSocketInstance</span>();</li><li>
</li><li>client.<span class="hljs-title function_">close</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'close success'</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: <span class="hljs-built_in">Object</span></span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'close fail: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1338px;">     <h3 id="getstate11" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">getState<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getstate11" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>getState(): Promise&lt;SocketStateBase&gt;</p>     <p>获取LocalSocket状态。使用Promise方式作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>bind或connect方法调用成功后，才可调用此方法。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.110.7.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.110.7.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#socketstatebase">SocketStateBase</a>&gt;</td>         <td class="cellrowborder" width="50%">以Promise形式返回获取LocalSocket状态的结果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>在本文档的示例中，通过this.context来获取UIAbilityContext，其中this代表继承自UIAbility的UIAbility实例。如需在页面中使用UIAbilityContext提供的能力，请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/uiability-usage#获取uiability的上下文信息" target="_blank">获取UIAbility的上下文信息</a>。</p>      </div></div></div>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">client</span>: socket.<span class="hljs-property">LocalSocket</span> = socket.<span class="hljs-title function_">constructLocalSocketInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">context</span>: common.<span class="hljs-property">UIAbilityContext</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">sandboxPath</span>: <span class="hljs-built_in">string</span> = context.<span class="hljs-property">filesDir</span> + <span class="hljs-string">'/testSocket'</span>;</li><li><span class="hljs-keyword">let</span> localAddress : socket.<span class="hljs-property">LocalAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: sandboxPath</li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">connectOpt</span>: socket.<span class="hljs-property">LocalConnectOptions</span> = {</li><li>  <span class="hljs-attr">address</span>: localAddress,</li><li>  <span class="hljs-attr">timeout</span>: <span class="hljs-number">6000</span></li><li>}</li><li>client.<span class="hljs-title function_">connect</span>(connectOpt).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'connect success'</span>);</li><li>  client.<span class="hljs-title function_">getState</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'getState success'</span>);</li><li>  }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: <span class="hljs-built_in">Object</span></span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'getState fail: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err))</li><li>  });</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: <span class="hljs-built_in">Object</span></span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'connect fail: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1362px;">     <h3 id="getsocketfd11" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">getSocketFd<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getsocketfd11" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>getSocketFd(): Promise&lt;number&gt;</p>     <p>获取LocalSocket的文件描述符。使用Promise方式作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>bind或connect方法调用成功后，才可调用此方法。</p>       <p>获取由系统内核分配的唯一文件描述符，用于标识当前使用的套接字。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.111.7.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.111.7.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;number&gt;</td>         <td class="cellrowborder" width="50%">以Promise形式返回socket的文件描述符。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>在本文档的示例中，通过this.context来获取UIAbilityContext，其中this代表继承自UIAbility的UIAbility实例。如需在页面中使用UIAbilityContext提供的能力，请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/uiability-usage#获取uiability的上下文信息" target="_blank">获取UIAbility的上下文信息</a>。</p>      </div></div></div>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">client</span>: socket.<span class="hljs-property">LocalSocket</span> = socket.<span class="hljs-title function_">constructLocalSocketInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">context</span>: common.<span class="hljs-property">UIAbilityContext</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">sandboxPath</span>: <span class="hljs-built_in">string</span> = context.<span class="hljs-property">filesDir</span> + <span class="hljs-string">'/testSocket'</span>;</li><li><span class="hljs-keyword">let</span> localAddress : socket.<span class="hljs-property">LocalAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: sandboxPath</li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">connectOpt</span>: socket.<span class="hljs-property">LocalConnectOptions</span> = {</li><li>  <span class="hljs-attr">address</span>: localAddress,</li><li>  <span class="hljs-attr">timeout</span>: <span class="hljs-number">6000</span></li><li>}</li><li>client.<span class="hljs-title function_">connect</span>(connectOpt).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'connect ok'</span>)</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: <span class="hljs-built_in">Object</span></span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'connect fail: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err))</li><li>})</li><li>client.<span class="hljs-title function_">getSocketFd</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">data: <span class="hljs-built_in">number</span></span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"fd: "</span> + data);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: <span class="hljs-built_in">Object</span></span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"getSocketFd faile: "</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));</li><li>})</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1931px;">     <h3 id="setextraoptions11" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">setExtraOptions<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="setextraoptions11" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>setExtraOptions(options: ExtraOptionsBase): Promise&lt;void&gt;</p>     <p>设置LocalSocket的套接字属性。使用Promise方式作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>bind或connect方法调用成功后，才可调用此方法。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.112.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.112.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.112.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.112.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">options</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#extraoptionsbase7">ExtraOptionsBase</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">LocalSocket连接的其他属性，参考<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#extraoptionsbase7">ExtraOptionsBase</a>。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.112.9.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.112.9.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">以Promise形式返回设置LocalSocket套接字属性的结果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-net-socket">Socket错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.112.12.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.112.12.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301009</td>         <td class="cellrowborder" width="50%">Bad file descriptor.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>在本文档的示例中，通过this.context来获取UIAbilityContext，其中this代表继承自UIAbility的UIAbility实例。如需在页面中使用UIAbilityContext提供的能力，请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/uiability-usage#获取uiability的上下文信息" target="_blank">获取UIAbility的上下文信息</a>。</p>      </div></div></div>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">client</span>: socket.<span class="hljs-property">LocalSocket</span> = socket.<span class="hljs-title function_">constructLocalSocketInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">context</span>: common.<span class="hljs-property">UIAbilityContext</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">sandboxPath</span>: <span class="hljs-built_in">string</span> = context.<span class="hljs-property">filesDir</span> + <span class="hljs-string">'/testSocket'</span>;</li><li><span class="hljs-keyword">let</span> localAddress : socket.<span class="hljs-property">LocalAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: sandboxPath</li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">connectOpt</span>: socket.<span class="hljs-property">LocalConnectOptions</span> = {</li><li>  <span class="hljs-attr">address</span>: localAddress,</li><li>  <span class="hljs-attr">timeout</span>: <span class="hljs-number">6000</span></li><li>}</li><li>client.<span class="hljs-title function_">connect</span>(connectOpt).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'connect success'</span>);</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">options</span>: socket.<span class="hljs-property">ExtraOptionsBase</span> = {</li><li>    <span class="hljs-attr">receiveBufferSize</span>: <span class="hljs-number">8192</span>,</li><li>    <span class="hljs-attr">sendBufferSize</span>: <span class="hljs-number">8192</span>,</li><li>    <span class="hljs-attr">socketTimeout</span>: <span class="hljs-number">3000</span></li><li>  }</li><li>  client.<span class="hljs-title function_">setExtraOptions</span>(options).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'setExtraOptions success'</span>);</li><li>  }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: <span class="hljs-built_in">Object</span></span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'setExtraOptions fail: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));</li><li>  });</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: <span class="hljs-built_in">Object</span></span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'connect fail: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1557px;">     <h3 id="getextraoptions11" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">getExtraOptions<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getextraoptions11" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>getExtraOptions(): Promise&lt;ExtraOptionsBase&gt;;</p>     <p>获取LocalSocket的套接字属性。使用Promise方式作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>bind或connect方法调用成功后，才可调用此方法。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.113.7.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.113.7.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#extraoptionsbase7">ExtraOptionsBase</a>&gt;</td>         <td class="cellrowborder" width="50%">以Promise形式返回设置LocalSocket套接字的属性。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-net-socket">Socket错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.113.10.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.113.10.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">2301009</td>         <td class="cellrowborder" width="50%">Bad file descriptor.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>在本文档的示例中，通过this.context来获取UIAbilityContext，其中this代表继承自UIAbility的UIAbility实例。如需在页面中使用UIAbilityContext提供的能力，请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/uiability-usage#获取uiability的上下文信息" target="_blank">获取UIAbility的上下文信息</a>。</p>      </div></div></div>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">client</span>: socket.<span class="hljs-property">LocalSocket</span> = socket.<span class="hljs-title function_">constructLocalSocketInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">context</span>: common.<span class="hljs-property">UIAbilityContext</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">sandboxPath</span>: <span class="hljs-built_in">string</span> = context.<span class="hljs-property">filesDir</span> + <span class="hljs-string">'/testSocket'</span>;</li><li><span class="hljs-keyword">let</span> localAddress : socket.<span class="hljs-property">LocalAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: sandboxPath</li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">connectOpt</span>: socket.<span class="hljs-property">LocalConnectOptions</span> = {</li><li>  <span class="hljs-attr">address</span>: localAddress,</li><li>  <span class="hljs-attr">timeout</span>: <span class="hljs-number">6000</span></li><li>}</li><li>client.<span class="hljs-title function_">connect</span>(connectOpt).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'connect success'</span>);</li><li>  client.<span class="hljs-title function_">getExtraOptions</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">options : socket.ExtraOptionsBase</span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'options: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(options));</li><li>  }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: <span class="hljs-built_in">Object</span></span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'setExtraOptions fail: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));</li><li>  });</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: <span class="hljs-built_in">Object</span></span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'connect fail: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1595px;">     <h3 id="getlocaladdress12-4" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">getLocalAddress<sup>12+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getlocaladdress12-4" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>getLocalAddress(): Promise&lt;string&gt;</p>     <p>获取LocalSocket的本地Socket地址。使用Promise方式作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>bind方法调用成功后，才可调用此方法。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.114.7.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.114.7.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;string&gt;</td>         <td class="cellrowborder" width="50%">以Promise形式返回获取本地socket地址的结果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-net-socket">Socket错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.114.10.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.114.10.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">2300002</td>         <td class="cellrowborder" width="50%">System internal error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301009</td>         <td class="cellrowborder" width="50%">Bad file descriptor.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303188</td>         <td class="cellrowborder" width="50%">Socket operation on non-socket.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>在本文档的示例中，通过this.context来获取UIAbilityContext，其中this代表继承自UIAbility的UIAbility实例。如需在页面中使用UIAbilityContext提供的能力，请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/uiability-usage#获取uiability的上下文信息" target="_blank">获取UIAbility的上下文信息</a>。</p>      </div></div></div>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">client</span>: socket.<span class="hljs-property">LocalSocket</span> = socket.<span class="hljs-title function_">constructLocalSocketInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">context</span>: common.<span class="hljs-property">UIAbilityContext</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">sandboxPath</span>: <span class="hljs-built_in">string</span> = context.<span class="hljs-property">filesDir</span> + <span class="hljs-string">'/testSocket'</span>;</li><li><span class="hljs-keyword">let</span> address : socket.<span class="hljs-property">LocalAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: sandboxPath</li><li>}</li><li>client.<span class="hljs-title function_">bind</span>(address).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'bind success'</span>);</li><li>  client.<span class="hljs-title function_">getLocalAddress</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">localPath: <span class="hljs-built_in">string</span></span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"SUCCESS "</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(localPath));</li><li>  }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"FAIL "</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));</li><li>  })</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: <span class="hljs-built_in">Object</span></span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'failed to bind: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));</li><li>})</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1182px;">     <h3 id="onmessage11" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">on('message')<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onmessage11" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>on(type: 'message', callback: Callback&lt;LocalSocketMessageInfo&gt;): void</p>     <p>订阅LocalSocket连接的接收消息事件。使用callback方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.115.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.115.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.115.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.115.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">订阅的事件类型。'message'：接收消息事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#localsocketmessageinfo11">LocalSocketMessageInfo</a>&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">以callback的形式异步返回接收的消息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.115.9.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.115.9.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">client</span>: socket.<span class="hljs-property">LocalSocket</span> = socket.<span class="hljs-title function_">constructLocalSocketInstance</span>();</li><li>client.<span class="hljs-title function_">on</span>(<span class="hljs-string">'message'</span>, <span class="hljs-function">(<span class="hljs-params">value: socket.LocalSocketMessageInfo</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">const</span> uintArray = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(value.<span class="hljs-property">message</span>)</li><li>  <span class="hljs-keyword">let</span> messageView = <span class="hljs-string">''</span>;</li><li>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; uintArray.<span class="hljs-property">length</span>; i++) {</li><li>    messageView += <span class="hljs-title class_">String</span>.<span class="hljs-title function_">fromCharCode</span>(uintArray[i]);</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'total: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(value));</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'message infomation: '</span> + messageView);</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1302px;">     <h3 id="offmessage11" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">off('message')<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="offmessage11" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>off(type: 'message', callback?: Callback&lt;LocalSocketMessageInfo&gt;): void</p>     <p>取消订阅LocalSocket连接的接收消息事件。使用callback方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.116.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.116.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.116.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.116.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">取消订阅的事件类型。'message'：接收消息事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#localsocketmessageinfo11">LocalSocketMessageInfo</a>&gt;</td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">回调函数。可以指定传入on中的callback取消对应的订阅，也可以不指定callback清空所有订阅。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.116.9.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.116.9.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">client</span>: socket.<span class="hljs-property">LocalSocket</span> = socket.<span class="hljs-title function_">constructLocalSocketInstance</span>();</li><li><span class="hljs-keyword">let</span> messageView = <span class="hljs-string">''</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-title function_">callback</span> = (<span class="hljs-params">value: socket.LocalSocketMessageInfo</span>) =&gt; {</li><li>  <span class="hljs-keyword">const</span> uintArray = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(value.<span class="hljs-property">message</span>)</li><li>  <span class="hljs-keyword">let</span> messageView = <span class="hljs-string">''</span>;</li><li>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; uintArray.<span class="hljs-property">length</span>; i++) {</li><li>    messageView += <span class="hljs-title class_">String</span>.<span class="hljs-title function_">fromCharCode</span>(uintArray[i]);</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'total: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(value));</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'message infomation: '</span> + messageView);</li><li>}</li><li>client.<span class="hljs-title function_">on</span>(<span class="hljs-string">'message'</span>, callback);</li><li>client.<span class="hljs-title function_">off</span>(<span class="hljs-string">'message'</span>);</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 990px;">     <h3 id="onconnect11" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">on('connect')<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onconnect11" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>on(type: 'connect', callback: Callback&lt;void&gt;): void</p>     <p>订阅LocalSocket的连接事件。使用callback方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.117.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.117.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.117.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.117.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">订阅的事件类型。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;void&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">以callback的形式异步返回与服务端连接的结果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.117.9.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.117.9.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">client</span>: socket.<span class="hljs-property">LocalSocket</span> = socket.<span class="hljs-title function_">constructLocalSocketInstance</span>();</li><li>client.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connect'</span>, <span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"on connect success"</span>)</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1182px;">     <h3 id="offconnect11" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">off('connect')<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="offconnect11" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>off(type: 'connect', callback?: Callback&lt;void&gt;): void</p>     <p>取消订阅LocalSocket的连接事件。使用callback方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.118.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.118.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.118.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.118.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">取消订阅的事件类型。'connect'：LocalSocket的connect事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;void&gt;</td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">回调函数。可以指定传入on中的callback取消对应的订阅，也可以不指定callback清空所有订阅。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.118.9.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.118.9.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">client</span>: socket.<span class="hljs-property">LocalSocket</span> = socket.<span class="hljs-title function_">constructLocalSocketInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-title function_">callback</span> = (<span class="hljs-params"></span>) =&gt; {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"on connect success"</span>);</li><li>}</li><li>client.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connect'</span>, callback);</li><li><span class="hljs-comment">// 可以指定传入on中的callback取消一个订阅，也可以不指定callback清空所有订阅。</span></li><li>client.<span class="hljs-title function_">off</span>(<span class="hljs-string">'connect'</span>, callback);</li><li>client.<span class="hljs-title function_">off</span>(<span class="hljs-string">'connect'</span>);</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1038px;">     <h3 id="onclose11" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">on('close')<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onclose11" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>on(type: 'close', callback: Callback&lt;void&gt;): void</p>     <p>订阅LocalSocket的关闭事件。使用callback方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.119.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.119.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.119.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.119.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">订阅LocalSocket的关闭事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;void&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">以callback的形式异步返回关闭localsocket的结果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.119.9.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.119.9.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">client</span>: socket.<span class="hljs-property">LocalSocket</span> = socket.<span class="hljs-title function_">constructLocalSocketInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-title function_">callback</span> = (<span class="hljs-params"></span>) =&gt; {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"on close success"</span>);</li><li>}</li><li>client.<span class="hljs-title function_">on</span>(<span class="hljs-string">'close'</span>, callback);</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1182px;">     <h3 id="offclose11" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">off('close')<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="offclose11" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>off(type: 'close', callback?: Callback&lt;void&gt;): void</p>     <p>取消订阅LocalSocket的关闭事件。使用callback方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.120.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.120.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.120.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.120.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">取消订阅的事件类型。'close'：LocalSocket的关闭事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;void&gt;</td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">回调函数。可以指定传入on中的callback取消对应的订阅，也可以不指定callback清空所有订阅。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.120.9.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.120.9.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">client</span>: socket.<span class="hljs-property">LocalSocket</span> = socket.<span class="hljs-title function_">constructLocalSocketInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-title function_">callback</span> = (<span class="hljs-params"></span>) =&gt; {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"on close success"</span>);</li><li>}</li><li>client.<span class="hljs-title function_">on</span>(<span class="hljs-string">'close'</span>, callback);</li><li><span class="hljs-comment">// 可以指定传入on中的callback取消一个订阅，也可以不指定callback清空所有订阅。</span></li><li>client.<span class="hljs-title function_">off</span>(<span class="hljs-string">'close'</span>, callback);</li><li>client.<span class="hljs-title function_">off</span>(<span class="hljs-string">'close'</span>);</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1014px;">     <h3 id="onerror11" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">on('error')<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onerror11" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>on(type: 'error', callback: ErrorCallback): void</p>     <p>订阅LocalSocket连接的error事件。使用callback方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.121.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.121.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.121.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.121.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">订阅LocalSocket的error事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">ErrorCallback</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">以callback的形式异步返回出现错误的结果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.121.9.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.121.9.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">client</span>: socket.<span class="hljs-property">LocalSocket</span> = socket.<span class="hljs-title function_">constructLocalSocketInstance</span>();</li><li>client.<span class="hljs-title function_">on</span>(<span class="hljs-string">'error'</span>, <span class="hljs-function">(<span class="hljs-params">err: <span class="hljs-built_in">Object</span></span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"on error, err:"</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err))</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1182px;">     <h3 id="offerror11" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">off('error')<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="offerror11" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>off(type: 'error', callback?: ErrorCallback): void</p>     <p>取消订阅LocalSocket连接的error事件。使用callback方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.122.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.122.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.122.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.122.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">取消订阅的事件类型。'error'：LocalSocket的error事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">ErrorCallback</td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">回调函数。可以指定传入on中的callback取消对应的订阅，也可以不指定callback清空所有订阅。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.122.9.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.122.9.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">client</span>: socket.<span class="hljs-property">LocalSocket</span> = socket.<span class="hljs-title function_">constructLocalSocketInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-title function_">callback</span> = (<span class="hljs-params">err: <span class="hljs-built_in">Object</span></span>) =&gt; {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"on error, err:"</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));</li><li>}</li><li>client.<span class="hljs-title function_">on</span>(<span class="hljs-string">'error'</span>, callback);</li><li><span class="hljs-comment">// 可以指定传入on中的callback取消一个订阅，也可以不指定callback清空所有订阅。</span></li><li>client.<span class="hljs-title function_">off</span>(<span class="hljs-string">'error'</span>, callback);</li><li>client.<span class="hljs-title function_">off</span>(<span class="hljs-string">'error'</span>);</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 447px;">     <h2 id="localsocketmessageinfo11" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">LocalSocketMessageInfo<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="localsocketmessageinfo11" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>LocalSocket客户端与服务端通信时接收的数据。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.123.4.1.6.1.1" width="20%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.123.4.1.6.1.2" width="20%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.123.4.1.6.1.3" width="20%">只读</th>         <th align="left" class="cellrowborder" id="mcps1.3.123.4.1.6.1.4" width="20%">可选</th>         <th align="left" class="cellrowborder" id="mcps1.3.123.4.1.6.1.5" width="20%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">message</td>         <td class="cellrowborder" width="20%">ArrayBuffer</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">收到的消息数据。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">address</td>         <td class="cellrowborder" width="20%">string</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">使用的本地套接字路径。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">size</td>         <td class="cellrowborder" width="20%">number</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">数据长度。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 333px;">     <h2 id="localaddress11" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">LocalAddress<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="localaddress11" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>LocalSocket本地套接字文件路径信息，在传入套接字路径进行绑定时，会在此路径下创建套接字文件。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.124.4.1.6.1.1" width="20%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.124.4.1.6.1.2" width="20%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.124.4.1.6.1.3" width="20%">只读</th>         <th align="left" class="cellrowborder" id="mcps1.3.124.4.1.6.1.4" width="20%">可选</th>         <th align="left" class="cellrowborder" id="mcps1.3.124.4.1.6.1.5" width="20%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">address</td>         <td class="cellrowborder" width="20%">string</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">本地套接字路径。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 498px;">     <h2 id="localconnectoptions11" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">LocalConnectOptions<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="localconnectoptions11" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>LocalSocket客户端在连接服务端时传入的参数信息。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.125.4.1.6.1.1" width="20%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.125.4.1.6.1.2" width="20%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.125.4.1.6.1.3" width="20%">只读</th>         <th align="left" class="cellrowborder" id="mcps1.3.125.4.1.6.1.4" width="20%">可选</th>         <th align="left" class="cellrowborder" id="mcps1.3.125.4.1.6.1.5" width="20%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">address</td>         <td class="cellrowborder" width="20%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#localaddress11">LocalAddress</a></td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">指定的本地套接字路径。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">timeout</td>         <td class="cellrowborder" width="20%">number</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">连接服务端的超时时间，单位为毫秒。默认值为0。需要应用手动设置一下，建议设置为5000。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 378px;">     <h2 id="localsendoptions11" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">LocalSendOptions<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="localsendoptions11" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>LocalSocket发送请求的参数。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.126.4.1.6.1.1" width="20%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.126.4.1.6.1.2" width="20%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.126.4.1.6.1.3" width="20%">只读</th>         <th align="left" class="cellrowborder" id="mcps1.3.126.4.1.6.1.4" width="20%">可选</th>         <th align="left" class="cellrowborder" id="mcps1.3.126.4.1.6.1.5" width="20%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">data</td>         <td class="cellrowborder" width="20%">string | ArrayBuffer</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">需要发送的数据。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">encoding</td>         <td class="cellrowborder" width="20%">string</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">字符编码。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 780px;">     <h2 id="extraoptionsbase7" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">ExtraOptionsBase<sup>7+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="extraoptionsbase7" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>Socket套接字的基础属性。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.127.4.1.6.1.1" width="20%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.127.4.1.6.1.2" width="20%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.127.4.1.6.1.3" width="20%">只读</th>         <th align="left" class="cellrowborder" id="mcps1.3.127.4.1.6.1.4" width="20%">可选</th>         <th align="left" class="cellrowborder" id="mcps1.3.127.4.1.6.1.5" width="20%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">receiveBufferSize</td>         <td class="cellrowborder" width="20%">number</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">接收缓冲区大小（单位：Byte），取值范围0~262144，不设置或设置的值超过取值范围则会默认为8192。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">sendBufferSize</td>         <td class="cellrowborder" width="20%">number</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">发送缓冲区大小（单位：Byte），取值范围0~262144，不设置或设置的值超过取值范围则会默认为8192。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">reuseAddress</td>         <td class="cellrowborder" width="20%">boolean</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">是否重用地址。true：重用地址；false：不重用地址。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">socketTimeout</td>         <td class="cellrowborder" width="20%">number</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">套接字超时时间，单位毫秒（ms）。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 634px;">     <h2 id="socketconstructlocalsocketserverinstance11" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">socket.constructLocalSocketServerInstance<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="socketconstructlocalsocketserverinstance11" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>constructLocalSocketServerInstance(): LocalSocketServer</p>     <p>创建一个LocalSocketServer对象。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.128.6.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.128.6.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#localsocketserver11">LocalSocketServer</a></td>         <td class="cellrowborder" width="50%">返回一个LocalSocketServer对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">server</span>: socket.<span class="hljs-property">LocalSocketServer</span> = socket.<span class="hljs-title function_">constructLocalSocketServerInstance</span>();</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 206px;">     <h2 id="localsocketserver11" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">LocalSocketServer<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="localsocketserver11" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>LocalSocketServer类。在调用LocalSocketServer的方法前，需要先通过<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#socketconstructlocalsocketserverinstance11">socket.constructLocalSocketServerInstance</a>创建LocalSocketServer对象。</p>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1744px;">     <h3 id="listen11" device-type="phone,2in1,tablet,wearable,lite_wearable,tv" class="firsth2">listen<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="listen11" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>listen(address: LocalAddress): Promise&lt;void&gt;</p>     <p>绑定本地套接字文件，监听并接受与此套接字建立的LocalSocket连接。该接口使用多线程并发处理客户端的数据。使用Promise方法作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>服务端使用该方法完成bind，listen，accept操作，传入套接字文件路径，调用此接口后会自动生成本地套接字文件。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.130.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.130.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.130.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.130.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">address</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#localaddress11">LocalAddress</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">目标地址信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.130.9.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.130.9.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">以Promise形式返回执行结果， 成功返回空，失败返回错误码错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-net-socket">Socket错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.130.12.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.130.12.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303109</td>         <td class="cellrowborder" width="50%">Bad file number.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301013</td>         <td class="cellrowborder" width="50%">Insufficient permissions.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301022</td>         <td class="cellrowborder" width="50%">Invalid argument.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301098</td>         <td class="cellrowborder" width="50%">Address already in use.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>在本文档的示例中，通过this.context来获取UIAbilityContext，其中this代表继承自UIAbility的UIAbility实例。如需在页面中使用UIAbilityContext提供的能力，请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/uiability-usage#获取uiability的上下文信息" target="_blank">获取UIAbility的上下文信息</a>。</p>      </div></div></div>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">server</span>: socket.<span class="hljs-property">LocalSocketServer</span> = socket.<span class="hljs-title function_">constructLocalSocketServerInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">context</span>: common.<span class="hljs-property">UIAbilityContext</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">sandboxPath</span>: <span class="hljs-built_in">string</span> = context.<span class="hljs-property">filesDir</span> + <span class="hljs-string">'/testSocket'</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">addr</span>: socket.<span class="hljs-property">LocalAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: sandboxPath</li><li>}</li><li>server.<span class="hljs-title function_">listen</span>(addr).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'listen success'</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: <span class="hljs-built_in">Object</span></span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'listen fail: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1266px;">     <h3 id="getstate11-1" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">getState<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getstate11-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>getState(): Promise&lt;SocketStateBase&gt;</p>     <p>获取LocalSocketServer状态。使用Promise方式作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>listen方法调用成功后，才可调用此方法。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.131.7.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.131.7.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#socketstatebase">SocketStateBase</a>&gt;</td>         <td class="cellrowborder" width="50%">以Promise形式返回获取LocalSocketServer状态的结果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>在本文档的示例中，通过this.context来获取UIAbilityContext，其中this代表继承自UIAbility的UIAbility实例。如需在页面中使用UIAbilityContext提供的能力，请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/uiability-usage#获取uiability的上下文信息" target="_blank">获取UIAbility的上下文信息</a>。</p>      </div></div></div>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">server</span>: socket.<span class="hljs-property">LocalSocketServer</span> = socket.<span class="hljs-title function_">constructLocalSocketServerInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">context</span>: common.<span class="hljs-property">UIAbilityContext</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">sandboxPath</span>: <span class="hljs-built_in">string</span> = context.<span class="hljs-property">filesDir</span> + <span class="hljs-string">'/testSocket'</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">listenAddr</span>: socket.<span class="hljs-property">LocalAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: sandboxPath</li><li>}</li><li>server.<span class="hljs-title function_">listen</span>(listenAddr).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"listen success"</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: <span class="hljs-built_in">Object</span></span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"listen fail: "</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));</li><li>})</li><li>server.<span class="hljs-title function_">getState</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">data: socket.SocketStateBase</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'getState success: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data));</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: <span class="hljs-built_in">Object</span></span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'getState fail: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1835px;">     <h3 id="setextraoptions11-1" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">setExtraOptions<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="setextraoptions11-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>setExtraOptions(options: ExtraOptionsBase): Promise&lt;void&gt;</p>     <p>设置LocalSocketServer连接的套接字属性。使用Promise方式作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>listen方法调用成功后，才可调用此方法。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.132.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.132.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.132.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.132.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">options</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#extraoptionsbase7">ExtraOptionsBase</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">LocalSocketServer连接的其他属性。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.132.9.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.132.9.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">Promise对象。无返回结果的Promise对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-net-socket">Socket错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.132.12.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.132.12.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301009</td>         <td class="cellrowborder" width="50%">Bad file descriptor.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>在本文档的示例中，通过this.context来获取UIAbilityContext，其中this代表继承自UIAbility的UIAbility实例。如需在页面中使用UIAbilityContext提供的能力，请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/uiability-usage#获取uiability的上下文信息" target="_blank">获取UIAbility的上下文信息</a>。</p>      </div></div></div>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">server</span>: socket.<span class="hljs-property">LocalSocketServer</span> = socket.<span class="hljs-title function_">constructLocalSocketServerInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">context</span>: common.<span class="hljs-property">UIAbilityContext</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">sandboxPath</span>: <span class="hljs-built_in">string</span> = context.<span class="hljs-property">filesDir</span> + <span class="hljs-string">'/testSocket'</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">listenAddr</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: sandboxPath</li><li>}</li><li>server.<span class="hljs-title function_">listen</span>(listenAddr).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"listen success"</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: <span class="hljs-built_in">Object</span></span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"listen fail: "</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));</li><li>})</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">options</span>: socket.<span class="hljs-property">ExtraOptionsBase</span> = {</li><li>  <span class="hljs-attr">receiveBufferSize</span>: <span class="hljs-number">8192</span>,</li><li>  <span class="hljs-attr">sendBufferSize</span>: <span class="hljs-number">8192</span>,</li><li>  <span class="hljs-attr">socketTimeout</span>: <span class="hljs-number">3000</span></li><li>}</li><li>server.<span class="hljs-title function_">setExtraOptions</span>(options).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'setExtraOptions success'</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: <span class="hljs-built_in">Object</span></span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'setExtraOptions fail: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1461px;">     <h3 id="getextraoptions11-1" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">getExtraOptions<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getextraoptions11-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>getExtraOptions(): Promise&lt;ExtraOptionsBase&gt;;</p>     <p>获取LocalSocketServer中连接的套接字的属性。使用Promise方式作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>listen方法调用成功后，才可调用此方法。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.133.7.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.133.7.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#extraoptionsbase7">ExtraOptionsBase</a>&gt;</td>         <td class="cellrowborder" width="50%">以Promise形式返回套接字的属性。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.133.10.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.133.10.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>在本文档的示例中，通过this.context来获取UIAbilityContext，其中this代表继承自UIAbility的UIAbility实例。如需在页面中使用UIAbilityContext提供的能力，请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/uiability-usage#获取uiability的上下文信息" target="_blank">获取UIAbility的上下文信息</a>。</p>      </div></div></div>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">server</span>: socket.<span class="hljs-property">LocalSocketServer</span> = socket.<span class="hljs-title function_">constructLocalSocketServerInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">context</span>: common.<span class="hljs-property">UIAbilityContext</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">sandboxPath</span>: <span class="hljs-built_in">string</span> = context.<span class="hljs-property">filesDir</span> + <span class="hljs-string">'/testSocket'</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">listenAddr</span>: socket.<span class="hljs-property">LocalAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: sandboxPath</li><li>}</li><li>server.<span class="hljs-title function_">listen</span>(listenAddr).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"listen success"</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: <span class="hljs-built_in">Object</span></span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"listen fail: "</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));</li><li>})</li><li>server.<span class="hljs-title function_">getExtraOptions</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">options: socket.ExtraOptionsBase</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'options: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(options));</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: <span class="hljs-built_in">Object</span></span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'getExtraOptions fail: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1595px;">     <h3 id="getlocaladdress12-5" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">getLocalAddress<sup>12+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getlocaladdress12-5" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>getLocalAddress(): Promise&lt;string&gt;</p>     <p>获取LocalSocketServer中本地Socket地址。使用Promise方式作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>listen方法调用成功后，才可调用此方法。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.134.7.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.134.7.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;string&gt;</td>         <td class="cellrowborder" width="50%">以Promise形式返回获取本地socket地址的结果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-net-socket">Socket错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.134.10.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.134.10.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">2300002</td>         <td class="cellrowborder" width="50%">System internal error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301009</td>         <td class="cellrowborder" width="50%">Bad file descriptor.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303188</td>         <td class="cellrowborder" width="50%">Socket operation on non-socket.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>在本文档的示例中，通过this.context来获取UIAbilityContext，其中this代表继承自UIAbility的UIAbility实例。如需在页面中使用UIAbilityContext提供的能力，请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/uiability-usage#获取uiability的上下文信息" target="_blank">获取UIAbility的上下文信息</a>。</p>      </div></div></div>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">server</span>: socket.<span class="hljs-property">LocalSocketServer</span> = socket.<span class="hljs-title function_">constructLocalSocketServerInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">context</span>: common.<span class="hljs-property">UIAbilityContext</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">sandboxPath</span>: <span class="hljs-built_in">string</span> = context.<span class="hljs-property">filesDir</span> + <span class="hljs-string">'/testSocket'</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">listenAddr</span>: socket.<span class="hljs-property">LocalAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: sandboxPath</li><li>}</li><li>server.<span class="hljs-title function_">listen</span>(listenAddr).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"listen success"</span>);</li><li>  server.<span class="hljs-title function_">getLocalAddress</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">localPath: <span class="hljs-built_in">string</span></span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"SUCCESS "</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(localPath));</li><li>  }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"FAIL "</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));</li><li>  })</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: <span class="hljs-built_in">Object</span></span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"listen fail: "</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));</li><li>})</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1154px;">     <h3 id="onconnect11-1" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">on('connect')<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onconnect11-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>on(type: 'connect', callback: Callback&lt;LocalSocketConnection&gt;): void</p>     <p>订阅LocalSocketServer的连接事件。使用callback方式作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>listen方法调用成功后，才可调用此方法。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.135.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.135.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.135.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.135.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">订阅的事件类型。'connect'：连接事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#localsocketconnection11">LocalSocketConnection</a>&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">以callback的形式异步返回接收到客户端连接的结果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.135.10.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.135.10.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">server</span>: socket.<span class="hljs-property">LocalSocketServer</span> = socket.<span class="hljs-title function_">constructLocalSocketServerInstance</span>();</li><li>server.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connect'</span>, <span class="hljs-function">(<span class="hljs-params">connection: socket.LocalSocketConnection</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (connection) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'accept a client'</span>)</li><li>  }</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1254px;">     <h3 id="offconnect11-1" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">off('connect')<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="offconnect11-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>off(type: 'connect', callback?: Callback&lt;LocalSocketConnection&gt;): void</p>     <p>取消订阅LocalSocketServer的连接事件。使用callback方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.136.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.136.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.136.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.136.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">取消订阅的事件类型。'connect'：LocalSocketServer的连接事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#localsocketconnection11">LocalSocketConnection</a>&gt;</td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">回调函数。可以指定传入on中的callback取消对应的订阅，也可以不指定callback清空所有订阅。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.136.9.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.136.9.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">server</span>: socket.<span class="hljs-property">LocalSocketServer</span> = socket.<span class="hljs-title function_">constructLocalSocketServerInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-title function_">callback</span> = (<span class="hljs-params">connection: socket.LocalSocketConnection</span>) =&gt; {</li><li>  <span class="hljs-keyword">if</span> (connection) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'accept a client'</span>)</li><li>  }</li><li>}</li><li>server.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connect'</span>, callback);</li><li><span class="hljs-comment">// 可以指定传入on中的callback取消一个订阅，也可以不指定callback清空所有订阅。</span></li><li>server.<span class="hljs-title function_">off</span>(<span class="hljs-string">'connect'</span>, callback);</li><li>server.<span class="hljs-title function_">off</span>(<span class="hljs-string">'connect'</span>);</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1106px;">     <h3 id="onerror11-1" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">on('error')<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onerror11-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>on(type: 'error', callback: ErrorCallback): void</p>     <p>订阅LocalSocketServer连接的error事件。使用callback方式作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>listen方法调用成功后，才可调用此方法。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.137.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.137.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.137.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.137.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">订阅的事件类型。'error'：error事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">ErrorCallback</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">以callback的形式异步返回出现错误的结果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.137.10.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.137.10.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">server</span>: socket.<span class="hljs-property">LocalSocketServer</span> = socket.<span class="hljs-title function_">constructLocalSocketServerInstance</span>();</li><li>server.<span class="hljs-title function_">on</span>(<span class="hljs-string">'error'</span>, <span class="hljs-function">(<span class="hljs-params">err: <span class="hljs-built_in">Object</span></span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"on error, err:"</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err))</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1158px;">     <h3 id="offerror11-1" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">off('error')<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="offerror11-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>off(type: 'error', callback?: ErrorCallback): void</p>     <p>取消订阅LocalSocketServer连接的error事件。使用callback方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.138.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.138.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.138.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.138.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">取消订阅的事件类型。'error'：error事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">ErrorCallback</td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">回调函数。可以指定传入on中的callback取消对应的订阅，也可以不指定callback清空所有订阅。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.138.9.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.138.9.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">server</span>: socket.<span class="hljs-property">LocalSocketServer</span> = socket.<span class="hljs-title function_">constructLocalSocketServerInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-title function_">callback</span> = (<span class="hljs-params">err: <span class="hljs-built_in">Object</span></span>) =&gt; {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"on error, err:"</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));</li><li>}</li><li>server.<span class="hljs-title function_">on</span>(<span class="hljs-string">'error'</span>, callback);</li><li><span class="hljs-comment">// 可以指定传入on中的callback取消一个订阅，也可以不指定callback清空所有订阅。</span></li><li>server.<span class="hljs-title function_">off</span>(<span class="hljs-string">'error'</span>, callback);</li><li>server.<span class="hljs-title function_">off</span>(<span class="hljs-string">'error'</span>);</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1509px;">     <h3 id="close20-1" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">close<sup>20+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="close20-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>close(): Promise&lt;void&gt;</p>     <p>LocalSocketServer停止监听并释放通过<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#listen11">listen</a>方法绑定的监听端口。使用Promise异步回调。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>该方法不会关闭已有连接。如需关闭，请调用<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#localsocketconnection11">LocalSocketConnection</a>的<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#close11-1">close</a>方法。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.139.7.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.139.7.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">Promise对象，无返回结果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-net-socket">Socket错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.139.10.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.139.10.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">2300002</td>         <td class="cellrowborder" width="50%">System internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>在本文档的示例中，通过this.context来获取UIAbilityContext，其中this代表继承自UIAbility的UIAbility实例。如需在页面中使用UIAbilityContext提供的能力，请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/uiability-usage#获取uiability的上下文信息" target="_blank">获取UIAbility的上下文信息</a>。</p>      </div></div></div>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">localserver</span>: socket.<span class="hljs-property">LocalSocketServer</span> = socket.<span class="hljs-title function_">constructLocalSocketServerInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">context</span>: common.<span class="hljs-property">UIAbilityContext</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">sandboxPath</span>: <span class="hljs-built_in">string</span> = context.<span class="hljs-property">filesDir</span> + <span class="hljs-string">'/testSocket'</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">addr</span>: socket.<span class="hljs-property">LocalAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: sandboxPath</li><li>}</li><li>localserver.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connect'</span>, <span class="hljs-function">(<span class="hljs-params">connection: socket.LocalSocketConnection</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"connection clientId: "</span> + connection.<span class="hljs-property">clientId</span>);</li><li>  <span class="hljs-comment">// 逻辑处理</span></li><li>  localserver.<span class="hljs-title function_">close</span>(); <span class="hljs-comment">// 停止监听</span></li><li>  connection.<span class="hljs-title function_">close</span>(); <span class="hljs-comment">// 关闭当前连接</span></li><li>});</li><li>localserver.<span class="hljs-title function_">listen</span>(addr).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'listen success'</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'listen fail: '</span> + err.<span class="hljs-property">code</span>);</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 346px;">     <h2 id="localsocketconnection11" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">LocalSocketConnection<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="localsocketconnection11" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>LocalSocketConnection连接，即LocalSocket客户端与服务端的会话连接。在调用LocalSocketConnection的方法前，需要先获取LocalSocketConnection对象。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>客户端与服务端成功建立连接后，才能通过返回的LocalSocketConnection对象调用相应的接口。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 183px;">     <h3 id="属性-1" class="firsth2">属性<i class="anchor-icon anchor-icon-link" anchorid="属性-1" tips="复制节点链接"></i></h3>          <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.141.2.1.6.1.1" width="20%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.141.2.1.6.1.2" width="20%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.141.2.1.6.1.3" width="20%">只读</th>         <th align="left" class="cellrowborder" id="mcps1.3.141.2.1.6.1.4" width="20%">可选</th>         <th align="left" class="cellrowborder" id="mcps1.3.141.2.1.6.1.5" width="20%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">clientId</td>         <td class="cellrowborder" width="20%">number</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">客户端与服务端建立的会话连接的id。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1479px;">     <h3 id="send11-1" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">send<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="send11-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>send(options: LocalSendOptions): Promise&lt;void&gt;</p>     <p>通过LocalSocketConnection连接对象发送数据。使用Promise方式作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>服务端与客户端建立连接后，服务端通过connect事件回调得到LocalSocketConnection连接对象后，才可使用连接对象调用此方法。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.142.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.142.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.142.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.142.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">options</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#localsendoptions11">LocalSendOptions</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">LocalSocketConnection发送请求的参数。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.142.9.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.142.9.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">Promise对象。无返回结果的Promise对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-net-socket">Socket错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.142.12.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.142.12.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301011</td>         <td class="cellrowborder" width="50%">Operation would block.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">server</span>: socket.<span class="hljs-property">LocalSocketServer</span> = socket.<span class="hljs-title function_">constructLocalSocketServerInstance</span>();</li><li>
</li><li>server.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connect'</span>, <span class="hljs-function">(<span class="hljs-params">connection: socket.LocalSocketConnection</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">sendOptions</span>: socket.<span class="hljs-property">LocalSendOptions</span> = {</li><li>    <span class="hljs-attr">data</span>: <span class="hljs-string">'Hello, client!'</span></li><li>  }</li><li>  connection.<span class="hljs-title function_">send</span>(sendOptions).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'send success'</span>);</li><li>  }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: <span class="hljs-built_in">Object</span></span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'send fail: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));</li><li>  });</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1037px;">     <h3 id="close11-1" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">close<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="close11-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>close(): Promise&lt;void&gt;</p>     <p>关闭一个LocalSocket客户端与服务端建立的连接。使用Promise方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.143.6.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.143.6.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">Promise对象。无返回结果的Promise对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-net-socket">Socket错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.143.9.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.143.9.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">2301009</td>         <td class="cellrowborder" width="50%">Bad file descriptor.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">server</span>: socket.<span class="hljs-property">LocalSocketServer</span> = socket.<span class="hljs-title function_">constructLocalSocketServerInstance</span>();</li><li>server.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connect'</span>, <span class="hljs-function">(<span class="hljs-params">connection: socket.LocalSocketConnection</span>) =&gt;</span> {</li><li>  connection.<span class="hljs-title function_">close</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'close success'</span>);</li><li>  }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: <span class="hljs-built_in">Object</span></span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'close fail: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));</li><li>  });</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1671px;">     <h3 id="getlocaladdress12-6" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">getLocalAddress<sup>12+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getlocaladdress12-6" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>getLocalAddress(): Promise&lt;string&gt;</p>     <p>获取LocalSocketConnection连接中的本地Socket地址。使用Promise方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.144.6.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.144.6.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;string&gt;</td>         <td class="cellrowborder" width="50%">以Promise形式返回获取本地socket地址的结果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-net-socket">Socket错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.144.9.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.144.9.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">2300002</td>         <td class="cellrowborder" width="50%">System internal error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301009</td>         <td class="cellrowborder" width="50%">Bad file descriptor.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303188</td>         <td class="cellrowborder" width="50%">Socket operation on non-socket.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>在本文档的示例中，通过this.context来获取UIAbilityContext，其中this代表继承自UIAbility的UIAbility实例。如需在页面中使用UIAbilityContext提供的能力，请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/uiability-usage#获取uiability的上下文信息" target="_blank">获取UIAbility的上下文信息</a>。</p>      </div></div></div>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">server</span>: socket.<span class="hljs-property">LocalSocketServer</span> = socket.<span class="hljs-title function_">constructLocalSocketServerInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">context</span>: common.<span class="hljs-property">UIAbilityContext</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">sandboxPath</span>: <span class="hljs-built_in">string</span> = context.<span class="hljs-property">filesDir</span> + <span class="hljs-string">'/testSocket'</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">localAddr</span>: socket.<span class="hljs-property">LocalAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: sandboxPath</li><li>}</li><li>server.<span class="hljs-title function_">listen</span>(localAddr).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'listen success'</span>);</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">client</span>: socket.<span class="hljs-property">LocalSocket</span> = socket.<span class="hljs-title function_">constructLocalSocketInstance</span>();</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">connectOpt</span>: socket.<span class="hljs-property">LocalConnectOptions</span> = {</li><li>    <span class="hljs-attr">address</span>: localAddr,</li><li>    <span class="hljs-attr">timeout</span>: <span class="hljs-number">6000</span></li><li>  }</li><li>  client.<span class="hljs-title function_">connect</span>(connectOpt).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>    server.<span class="hljs-title function_">getLocalAddress</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">localPath: <span class="hljs-built_in">string</span></span>) =&gt;</span> {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"success, localPath is"</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(localPath));</li><li>    }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"FAIL "</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));</li><li>    })</li><li>  }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: <span class="hljs-built_in">Object</span></span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'connect fail: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));</li><li>  });</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1610px;">     <h3 id="onmessage11-1" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">on('message')<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onmessage11-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>on(type: 'message', callback: Callback&lt;LocalSocketMessageInfo&gt;): void</p>     <p>订阅LocalSocketConnection连接的接收消息事件。使用callback方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.145.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.145.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.145.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.145.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">订阅的事件类型。'message'：接收消息事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#localsocketmessageinfo11">LocalSocketMessageInfo</a>&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">以callback的形式异步返回接收到的来自客户端的消息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.145.9.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.145.9.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>在本文档的示例中，通过this.context来获取UIAbilityContext，其中this代表继承自UIAbility的UIAbility实例。如需在页面中使用UIAbilityContext提供的能力，请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/uiability-usage#获取uiability的上下文信息" target="_blank">获取UIAbility的上下文信息</a>。</p>      </div></div></div>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">server</span>: socket.<span class="hljs-property">LocalSocketServer</span> = socket.<span class="hljs-title function_">constructLocalSocketServerInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">context</span>: common.<span class="hljs-property">UIAbilityContext</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">sandboxPath</span>: <span class="hljs-built_in">string</span> = context.<span class="hljs-property">filesDir</span> + <span class="hljs-string">'/testSocket'</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">listenAddr</span>: socket.<span class="hljs-property">LocalAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: sandboxPath</li><li>}</li><li>server.<span class="hljs-title function_">listen</span>(listenAddr).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"listen success"</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: <span class="hljs-built_in">Object</span></span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"listen fail: "</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));</li><li>});</li><li>server.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connect'</span>, <span class="hljs-function">(<span class="hljs-params">connection: socket.LocalSocketConnection</span>) =&gt;</span> {</li><li>  connection.<span class="hljs-title function_">on</span>(<span class="hljs-string">'message'</span>, <span class="hljs-function">(<span class="hljs-params">value: socket.LocalSocketMessageInfo</span>) =&gt;</span> {</li><li>    <span class="hljs-keyword">const</span> uintArray = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(value.<span class="hljs-property">message</span>);</li><li>    <span class="hljs-keyword">let</span> messageView = <span class="hljs-string">''</span>;</li><li>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; uintArray.<span class="hljs-property">length</span>; i++) {</li><li>      messageView += <span class="hljs-title class_">String</span>.<span class="hljs-title function_">fromCharCode</span>(uintArray[i]);</li><li>    }</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'total: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(value));</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'message infomation: '</span> + messageView);</li><li>  });</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1374px;">     <h3 id="offmessage11-1" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">off('message')<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="offmessage11-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>off(type: 'message', callback?: Callback&lt;LocalSocketMessageInfo&gt;): void</p>     <p>取消订阅LocalSocketConnection连接的接收消息事件。使用callback方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.146.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.146.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.146.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.146.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">取消订阅的事件类型。'message'：接收消息事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#localsocketmessageinfo11">LocalSocketMessageInfo</a>&gt;</td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">回调函数。可以指定传入on中的callback取消对应的订阅，也可以不指定callback清空所有订阅。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.146.9.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.146.9.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">server</span>: socket.<span class="hljs-property">LocalSocketServer</span> = socket.<span class="hljs-title function_">constructLocalSocketServerInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-title function_">callback</span> = (<span class="hljs-params">value: socket.LocalSocketMessageInfo</span>) =&gt; {</li><li>  <span class="hljs-keyword">const</span> uintArray = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(value.<span class="hljs-property">message</span>)</li><li>  <span class="hljs-keyword">let</span> messageView = <span class="hljs-string">''</span>;</li><li>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; uintArray.<span class="hljs-property">length</span>; i++) {</li><li>    messageView += <span class="hljs-title class_">String</span>.<span class="hljs-title function_">fromCharCode</span>(uintArray[i]);</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'total: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(value));</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'message infomation: '</span> + messageView);</li><li>}</li><li>server.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connect'</span>, <span class="hljs-function">(<span class="hljs-params">connection: socket.LocalSocketConnection</span>) =&gt;</span> {</li><li>  connection.<span class="hljs-title function_">on</span>(<span class="hljs-string">'message'</span>, callback);</li><li>  <span class="hljs-comment">// 可以指定传入on中的callback取消一个订阅，也可以不指定callback清空所有订阅。</span></li><li>  connection.<span class="hljs-title function_">off</span>(<span class="hljs-string">'message'</span>, callback);</li><li>  connection.<span class="hljs-title function_">off</span>(<span class="hljs-string">'message'</span>);</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1062px;">     <h3 id="onclose11-1" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">on('close')<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onclose11-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>on(type: 'close', callback: Callback&lt;void&gt;): void</p>     <p>订阅LocalSocketConnection的关闭事件。使用callback方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.147.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.147.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.147.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.147.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">订阅的事件类型。'close'：关闭事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;void&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">以callback的形式异步返回会话关闭的结果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.147.9.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.147.9.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">server</span>: socket.<span class="hljs-property">LocalSocketServer</span> = socket.<span class="hljs-title function_">constructLocalSocketServerInstance</span>();</li><li>server.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connect'</span>, <span class="hljs-function">(<span class="hljs-params">connection: socket.LocalSocketConnection</span>) =&gt;</span> {</li><li>  connection.<span class="hljs-title function_">on</span>(<span class="hljs-string">'close'</span>, <span class="hljs-function">() =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"on close success"</span>)</li><li>  });</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1206px;">     <h3 id="offclose11-1" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">off('close')<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="offclose11-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>off(type: 'close', callback?: Callback&lt;void&gt;): void</p>     <p>取消订阅LocalSocketConnection的关闭事件。使用callback方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.148.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.148.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.148.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.148.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">取消订阅的事件类型。'close'：关闭事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;void&gt;</td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">回调函数。可以指定传入on中的callback取消对应的订阅，也可以不指定callback清空所有订阅。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.148.9.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.148.9.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">server</span>: socket.<span class="hljs-property">LocalSocketServer</span> = socket.<span class="hljs-title function_">constructLocalSocketServerInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-title function_">callback</span> = (<span class="hljs-params"></span>) =&gt; {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"on close success"</span>);</li><li>}</li><li>server.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connect'</span>, <span class="hljs-function">(<span class="hljs-params">connection: socket.LocalSocketConnection</span>) =&gt;</span> {</li><li>  connection.<span class="hljs-title function_">on</span>(<span class="hljs-string">'close'</span>, callback);</li><li>  <span class="hljs-comment">// 可以指定传入on中的callback取消一个订阅，也可以不指定callback清空所有订阅。</span></li><li>  connection.<span class="hljs-title function_">off</span>(<span class="hljs-string">'close'</span>, callback);</li><li>  connection.<span class="hljs-title function_">off</span>(<span class="hljs-string">'close'</span>);</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1062px;">     <h3 id="onerror11-2" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">on('error')<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onerror11-2" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>on(type: 'error', callback: ErrorCallback): void</p>     <p>订阅LocalSocketConnection连接的error事件。使用callback方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.149.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.149.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.149.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.149.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">订阅的事件类型。'error'：error事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">ErrorCallback</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">以callback的形式异步返回出现错误的结果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.149.9.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.149.9.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">server</span>: socket.<span class="hljs-property">LocalSocketServer</span> = socket.<span class="hljs-title function_">constructLocalSocketServerInstance</span>();</li><li>server.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connect'</span>, <span class="hljs-function">(<span class="hljs-params">connection: socket.LocalSocketConnection</span>) =&gt;</span> {</li><li>  connection.<span class="hljs-title function_">on</span>(<span class="hljs-string">'error'</span>, <span class="hljs-function">(<span class="hljs-params">err: <span class="hljs-built_in">Object</span></span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"on error, err:"</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err))</li><li>  });</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1206px;">     <h3 id="offerror11-2" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">off('error')<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="offerror11-2" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>off(type: 'error', callback?: ErrorCallback): void</p>     <p>取消订阅LocalSocketConnection连接的error事件。使用callback方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.150.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.150.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.150.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.150.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">取消订阅的事件类型。'error'：error事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">ErrorCallback</td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">回调函数。可以指定传入on中的callback取消对应的订阅，也可以不指定callback清空所有订阅。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.150.9.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.150.9.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-title function_">callback</span> = (<span class="hljs-params">err: <span class="hljs-built_in">Object</span></span>) =&gt; {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"on error, err: "</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));</li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">server</span>: socket.<span class="hljs-property">LocalSocketServer</span> = socket.<span class="hljs-title function_">constructLocalSocketServerInstance</span>();</li><li>server.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connect'</span>, <span class="hljs-function">(<span class="hljs-params">connection: socket.LocalSocketConnection</span>) =&gt;</span> {</li><li>  connection.<span class="hljs-title function_">on</span>(<span class="hljs-string">'error'</span>, callback);</li><li>  <span class="hljs-comment">// 可以指定传入on中的callback取消一个订阅，也可以不指定callback清空所有订阅。</span></li><li>  connection.<span class="hljs-title function_">off</span>(<span class="hljs-string">'error'</span>, callback);</li><li>  connection.<span class="hljs-title function_">off</span>(<span class="hljs-string">'error'</span>);</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 230px;">     <h2 id="localsocket-错误码说明" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">LocalSocket 错误码说明<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="localsocket-错误码说明" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>LocalSocket 错误码映射形式为：2301000 + Linux内核错误码。</p>     <p>错误码的详细介绍参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-net-socket">Socket错误码</a>。</p>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 658px;">     <h2 id="socketconstructtlssocketinstance9" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">socket.constructTLSSocketInstance<sup>9+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="socketconstructtlssocketinstance9" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>constructTLSSocketInstance(): TLSSocket</p>     <p>创建并返回一个TLSSocket对象。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>返回值:</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.152.6.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.152.6.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#tlssocket9">TLSSocket</a></td>         <td class="cellrowborder" width="50%">返回一个TLSSocket对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tls</span>: socket.<span class="hljs-property">TLSSocket</span> = socket.<span class="hljs-title function_">constructTLSSocketInstance</span>();</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1813px;">     <h2 id="socketconstructtlssocketinstance12" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">socket.constructTLSSocketInstance<sup>12+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="socketconstructtlssocketinstance12" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>constructTLSSocketInstance(tcpSocket: TCPSocket): TLSSocket</p>     <p>将TCPSocket升级为TLSSocket，创建并返回一个TLSSocket对象。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>需要确保TCPSocket已连接，并且当前已经没有传输数据，再调用constructTLSSocketInstance升级TLSSocket。当升级成功后，无需对TCPSocket对象调用close方法。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.153.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.153.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.153.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.153.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">tcpSocket</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#tcpsocket">TCPSocket</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">需要进行升级的TCPSocket对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值:</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.153.9.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.153.9.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#tlssocket9">TLSSocket</a></td>         <td class="cellrowborder" width="50%">返回一个TLSSocket对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-net-socket">Socket错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.153.12.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.153.12.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2300002</td>         <td class="cellrowborder" width="50%">System internal error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303601</td>         <td class="cellrowborder" width="50%">Invalid socket FD.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303602</td>         <td class="cellrowborder" width="50%">Socket is not connected.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tcp</span>: socket.<span class="hljs-property">TCPSocket</span> = socket.<span class="hljs-title function_">constructTCPSocketInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">netAddress</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tcpconnectoptions</span>: socket.<span class="hljs-property">TCPConnectOptions</span> = {</li><li>  <span class="hljs-attr">address</span>: netAddress,</li><li>  <span class="hljs-attr">timeout</span>: <span class="hljs-number">6000</span></li><li>}</li><li>
</li><li>tcp.<span class="hljs-title function_">connect</span>(tcpconnectoptions, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'connect fail'</span>);</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'connect success'</span>);</li><li>
</li><li>  <span class="hljs-comment">// 确保TCPSocket已连接后，再升级TLSSocket</span></li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">tls</span>: socket.<span class="hljs-property">TLSSocket</span> = socket.<span class="hljs-title function_">constructTLSSocketInstance</span>(tcp);</li><li>})</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 182px;">     <h2 id="tlssocket9" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">TLSSocket<sup>9+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="tlssocket9" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>TLSSocket连接。在调用TLSSocket的方法前，需要先通过<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#socketconstructtlssocketinstance9">socket.constructTLSSocketInstance</a>创建TLSSocket对象。</p>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1567px;">     <h3 id="bind9" device-type="phone,2in1,tablet,wearable,lite_wearable,tv" class="firsth2">bind<sup>9+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="bind9" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>bind(address: NetAddress, callback: AsyncCallback&lt;void&gt;): void</p>     <p>绑定IP地址和端口。使用callback方法作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>如果TLSSocket对象是通过TCPSocket对象升级创建的，可以不用执行bind方法。</p>      </div></div></div>     <p><strong>需要权限</strong>：ohos.permission.INTERNET</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.155.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.155.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.155.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.155.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">address</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#netaddress">NetAddress</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">本端地址信息，参考<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#netaddress">NetAddress</a>。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;void&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。成功返回TLSSocket绑定本机的IP地址和端口的结果。失败返回错误码、错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-net-socket">Socket错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.155.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.155.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303198</td>         <td class="cellrowborder" width="50%">Address already in use.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2300002</td>         <td class="cellrowborder" width="50%">System internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tls</span>: socket.<span class="hljs-property">TLSSocket</span> = socket.<span class="hljs-title function_">constructTLSSocketInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">bindAddr</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li>tls.<span class="hljs-title function_">bind</span>(bindAddr, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'bind fail'</span>);</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'bind success'</span>);</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1613px;">     <h3 id="bind9-1" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">bind<sup>9+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="bind9-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>bind(address: NetAddress): Promise&lt;void&gt;</p>     <p>绑定IP地址和端口。使用Promise方法作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>如果TLSSocket对象是通过TCPSocket对象升级创建的，可以不用执行bind方法。</p>      </div></div></div>     <p><strong>需要权限</strong>：ohos.permission.INTERNET</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.156.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.156.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.156.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.156.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">address</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#netaddress">NetAddress</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">本端地址信息，参考<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#netaddress">NetAddress</a>。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.156.10.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.156.10.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">以Promise形式返回TLSSocket绑定本机的IP地址和端口的结果。失败返回错误码，错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-net-socket">Socket错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.156.13.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.156.13.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303198</td>         <td class="cellrowborder" width="50%">Address already in use.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2300002</td>         <td class="cellrowborder" width="50%">System internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tls</span>: socket.<span class="hljs-property">TLSSocket</span> = socket.<span class="hljs-title function_">constructTLSSocketInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">bindAddr</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li>tls.<span class="hljs-title function_">bind</span>(bindAddr).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'bind success'</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'bind fail'</span>);</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1408px;">     <h3 id="getstate9" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">getState<sup>9+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getstate9" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>getState(callback: AsyncCallback&lt;SocketStateBase&gt;): void</p>     <p>在TLSSocket的bind成功之后，获取TLSSocket状态。使用callback方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.157.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.157.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.157.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.157.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#socketstatebase">SocketStateBase</a>&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。成功返回TLSSocket状态，失败返回错误码、错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-net-socket">Socket错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.157.9.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.157.9.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">2303188</td>         <td class="cellrowborder" width="50%">Socket operation on non-socket.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2300002</td>         <td class="cellrowborder" width="50%">System internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tls</span>: socket.<span class="hljs-property">TLSSocket</span> = socket.<span class="hljs-title function_">constructTLSSocketInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">bindAddr</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li>tls.<span class="hljs-title function_">bind</span>(bindAddr, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'bind fail'</span>);</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'bind success'</span>);</li><li>});</li><li>tls.<span class="hljs-title function_">getState</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError, data: socket.SocketStateBase</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'getState fail'</span>);</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'getState success:'</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data));</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1356px;">     <h3 id="getstate9-1" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">getState<sup>9+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getstate9-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>getState(): Promise&lt;SocketStateBase&gt;</p>     <p>在TLSSocket的bind成功之后，获取TLSSocket状态。使用Promise方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.158.6.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.158.6.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#socketstatebase">SocketStateBase</a>&gt;</td>         <td class="cellrowborder" width="50%">以Promise形式返回获取TLSSocket状态的结果。失败返回错误码，错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-net-socket">Socket错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.158.9.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.158.9.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">2303188</td>         <td class="cellrowborder" width="50%">Socket operation on non-socket.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2300002</td>         <td class="cellrowborder" width="50%">System internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tls</span>: socket.<span class="hljs-property">TLSSocket</span> = socket.<span class="hljs-title function_">constructTLSSocketInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">bindAddr</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li>tls.<span class="hljs-title function_">bind</span>(bindAddr, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'bind fail'</span>);</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'bind success'</span>);</li><li>});</li><li>tls.<span class="hljs-title function_">getState</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'getState success'</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'getState fail'</span>);</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1964px;">     <h3 id="setextraoptions9" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">setExtraOptions<sup>9+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="setextraoptions9" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>setExtraOptions(options: TCPExtraOptions, callback: AsyncCallback&lt;void&gt;): void</p>     <p>在TLSSocket的bind成功之后，设置TCPSocket连接的其他属性。使用callback方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.159.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.159.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.159.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.159.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">options</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#tcpextraoptions">TCPExtraOptions</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">TCPSocket连接的其他属性，参考<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#tcpextraoptions">TCPExtraOptions</a>。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;void&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。成功返回设置TCPSocket连接的其他属性的结果，失败返回错误码、错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-net-socket">Socket错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.159.9.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.159.9.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303188</td>         <td class="cellrowborder" width="50%">Socket operation on non-socket.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2300002</td>         <td class="cellrowborder" width="50%">System internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tls</span>: socket.<span class="hljs-property">TLSSocket</span> = socket.<span class="hljs-title function_">constructTLSSocketInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">bindAddr</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li>tls.<span class="hljs-title function_">bind</span>(bindAddr, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'bind fail'</span>);</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'bind success'</span>);</li><li>});</li><li>
</li><li><span class="hljs-keyword">interface</span> <span class="hljs-title class_">SocketLinger</span> {</li><li>  <span class="hljs-attr">on</span>: <span class="hljs-built_in">boolean</span>;</li><li>  <span class="hljs-attr">linger</span>: <span class="hljs-built_in">number</span>;</li><li>}</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tcpExtraOptions</span>: socket.<span class="hljs-property">TCPExtraOptions</span> = {</li><li>  <span class="hljs-attr">keepAlive</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-title class_">OOBInline</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-title class_">TCPNoDelay</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-attr">socketLinger</span>: { <span class="hljs-attr">on</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">linger</span>: <span class="hljs-number">10</span> } <span class="hljs-keyword">as</span> <span class="hljs-title class_">SocketLinger</span>,</li><li>  <span class="hljs-attr">receiveBufferSize</span>: <span class="hljs-number">8192</span>,</li><li>  <span class="hljs-attr">sendBufferSize</span>: <span class="hljs-number">8192</span>,</li><li>  <span class="hljs-attr">reuseAddress</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-attr">socketTimeout</span>: <span class="hljs-number">3000</span></li><li>}</li><li>tls.<span class="hljs-title function_">setExtraOptions</span>(tcpExtraOptions, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'setExtraOptions fail'</span>);</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'setExtraOptions success'</span>);</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1970px;">     <h3 id="setextraoptions9-1" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">setExtraOptions<sup>9+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="setextraoptions9-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>setExtraOptions(options: TCPExtraOptions): Promise&lt;void&gt;</p>     <p>在TLSSocket的bind成功之后，设置TCPSocket连接的其他属性。使用Promise方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.160.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.160.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.160.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.160.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">options</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#tcpextraoptions">TCPExtraOptions</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">TCPSocket连接的其他属性，参考<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#tcpextraoptions">TCPExtraOptions</a>。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.160.8.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.160.8.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">Promise对象。无返回结果的Promise对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-net-socket">Socket错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.160.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.160.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303188</td>         <td class="cellrowborder" width="50%">Socket operation on non-socket.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2300002</td>         <td class="cellrowborder" width="50%">System internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tls</span>: socket.<span class="hljs-property">TLSSocket</span> = socket.<span class="hljs-title function_">constructTLSSocketInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">bindAddr</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li>tls.<span class="hljs-title function_">bind</span>(bindAddr, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'bind fail'</span>);</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'bind success'</span>);</li><li>});</li><li>
</li><li><span class="hljs-keyword">interface</span> <span class="hljs-title class_">SocketLinger</span> {</li><li>  <span class="hljs-attr">on</span>: <span class="hljs-built_in">boolean</span>;</li><li>  <span class="hljs-attr">linger</span>: <span class="hljs-built_in">number</span>;</li><li>}</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tcpExtraOptions</span>: socket.<span class="hljs-property">TCPExtraOptions</span> = {</li><li>  <span class="hljs-attr">keepAlive</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-title class_">OOBInline</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-title class_">TCPNoDelay</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-attr">socketLinger</span>: { <span class="hljs-attr">on</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">linger</span>: <span class="hljs-number">10</span> } <span class="hljs-keyword">as</span> <span class="hljs-title class_">SocketLinger</span>,</li><li>  <span class="hljs-attr">receiveBufferSize</span>: <span class="hljs-number">8192</span>,</li><li>  <span class="hljs-attr">sendBufferSize</span>: <span class="hljs-number">8192</span>,</li><li>  <span class="hljs-attr">reuseAddress</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-attr">socketTimeout</span>: <span class="hljs-number">3000</span></li><li>}</li><li>tls.<span class="hljs-title function_">setExtraOptions</span>(tcpExtraOptions).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'setExtraOptions success'</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'setExtraOptions fail'</span>);</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1658px;">     <h3 id="onmessage9" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">on('message')<sup>9+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onmessage9" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>on(type: 'message', callback: Callback&lt;SocketMessageInfo&gt;): void</p>     <p>订阅TLSSocket连接的接收消息事件。使用callback方式作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>bind方法调用成功后，才可调用此方法。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.161.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.161.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.161.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.161.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">订阅的事件类型。'message'：接收消息事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#socketmessageinfo11">SocketMessageInfo</a>&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。TLSSocket连接订阅某类接受消息事件触发的调用函数，返回TLSSocket连接信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.161.10.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.161.10.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tls</span>: socket.<span class="hljs-property">TLSSocket</span> = socket.<span class="hljs-title function_">constructTLSSocketInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">bindAddr</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li>tls.<span class="hljs-title function_">bind</span>(bindAddr, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'bind fail'</span>);</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'bind success'</span>);</li><li>  tls.<span class="hljs-title function_">on</span>(<span class="hljs-string">'message'</span>, <span class="hljs-function">(<span class="hljs-params">value: socket.SocketMessageInfo</span>) =&gt;</span> {</li><li>    <span class="hljs-keyword">let</span> messageView = <span class="hljs-string">''</span>;</li><li>    <span class="hljs-keyword">let</span> uint8Array = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(value.<span class="hljs-property">message</span>);</li><li>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> <span class="hljs-attr">i</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>; i &lt; value.<span class="hljs-property">message</span>.<span class="hljs-property">byteLength</span>; i++) {</li><li>      <span class="hljs-keyword">let</span> messages = uint8Array[i];</li><li>      <span class="hljs-keyword">let</span> message = <span class="hljs-title class_">String</span>.<span class="hljs-title function_">fromCharCode</span>(messages);</li><li>      messageView += message;</li><li>    }</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'on message message: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(messageView));</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'remoteInfo: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(value.<span class="hljs-property">remoteInfo</span>));</li><li>  });</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1326px;">     <h3 id="offmessage9" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">off('message')<sup>9+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="offmessage9" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>off(type: 'message', callback?: Callback&lt;SocketMessageInfo&gt;): void</p>     <p>取消订阅TLSSocket连接的接收消息事件。使用callback方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.162.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.162.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.162.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.162.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">订阅的事件类型。'message'：接收消息事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#socketmessageinfo11">SocketMessageInfo</a>&gt;</td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">回调函数。TLSSocket连接取消订阅某类接受消息事件触发的调用函数，返回TLSSocket连接信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.162.8.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.162.8.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tls</span>: socket.<span class="hljs-property">TLSSocket</span> = socket.<span class="hljs-title function_">constructTLSSocketInstance</span>();</li><li><span class="hljs-keyword">let</span> messageView = <span class="hljs-string">''</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-title function_">callback</span> = (<span class="hljs-params">value: socket.SocketMessageInfo</span>) =&gt; {</li><li>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> <span class="hljs-attr">i</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>; i &lt; value.<span class="hljs-property">message</span>.<span class="hljs-property">byteLength</span>; i++) {</li><li>    <span class="hljs-keyword">let</span> uint8Array = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(value.<span class="hljs-property">message</span>)</li><li>    <span class="hljs-keyword">let</span> messages = uint8Array[i]</li><li>    <span class="hljs-keyword">let</span> message = <span class="hljs-title class_">String</span>.<span class="hljs-title function_">fromCharCode</span>(messages);</li><li>    messageView += message;</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'on message message: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(messageView));</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'remoteInfo: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(value.<span class="hljs-property">remoteInfo</span>));</li><li>}</li><li>tls.<span class="hljs-title function_">on</span>(<span class="hljs-string">'message'</span>, callback);</li><li><span class="hljs-comment">// 可以指定传入on中的callback取消一个订阅，也可以不指定callback清空所有订阅。</span></li><li>tls.<span class="hljs-title function_">off</span>(<span class="hljs-string">'message'</span>, callback);</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1466px;">     <h3 id="onconnect--close9" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">on('connect' | 'close')<sup>9+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onconnect--close9" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>on(type: 'connect' | 'close', callback: Callback&lt;void&gt;): void</p>     <p>订阅TLSSocket的连接事件或关闭事件。使用callback方式作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>bind方法调用成功后，才可调用此方法。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.163.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.163.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.163.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.163.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">          <p>订阅的事件类型。</p>          <p>- 'connect'：连接事件。</p>          <p>- 'close'：关闭事件。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;void&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。TLSSocket连接订阅某类事件触发的调用函数。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.163.9.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.163.9.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tls</span>: socket.<span class="hljs-property">TLSSocket</span> = socket.<span class="hljs-title function_">constructTLSSocketInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">bindAddr</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li>tls.<span class="hljs-title function_">bind</span>(bindAddr, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'bind fail'</span>);</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'bind success'</span>);</li><li>  tls.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connect'</span>, <span class="hljs-function">() =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"on connect success"</span>)</li><li>  });</li><li>  tls.<span class="hljs-title function_">on</span>(<span class="hljs-string">'close'</span>, <span class="hljs-function">() =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"on close success"</span>)</li><li>  });</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1278px;">     <h3 id="offconnect--close9" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">off('connect' | 'close')<sup>9+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="offconnect--close9" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>off(type: 'connect' | 'close', callback?: Callback&lt;void&gt;): void</p>     <p>取消订阅TLSSocket的连接事件或关闭事件。使用callback方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.164.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.164.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.164.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.164.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">          <p>订阅的事件类型。</p>          <p>- 'connect'：连接事件。</p>          <p>- 'close'：关闭事件。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;void&gt;</td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">回调函数。TLSSocket连接订阅某类事件触发的调用函数。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.164.8.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.164.8.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tls</span>: socket.<span class="hljs-property">TLSSocket</span> = socket.<span class="hljs-title function_">constructTLSSocketInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-title function_">callback1</span> = (<span class="hljs-params"></span>) =&gt; {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"on connect success"</span>);</li><li>}</li><li>tls.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connect'</span>, callback1);</li><li><span class="hljs-comment">// 可以指定传入on中的callback取消一个订阅，也可以不指定callback清空所有订阅。</span></li><li>tls.<span class="hljs-title function_">off</span>(<span class="hljs-string">'connect'</span>, callback1);</li><li>tls.<span class="hljs-title function_">off</span>(<span class="hljs-string">'connect'</span>);</li><li><span class="hljs-keyword">let</span> <span class="hljs-title function_">callback2</span> = (<span class="hljs-params"></span>) =&gt; {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"on close success"</span>);</li><li>}</li><li>tls.<span class="hljs-title function_">on</span>(<span class="hljs-string">'close'</span>, callback2);</li><li><span class="hljs-comment">// 可以指定传入on中的callback取消一个订阅，也可以不指定callback清空所有订阅。</span></li><li>tls.<span class="hljs-title function_">off</span>(<span class="hljs-string">'close'</span>, callback2);</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1370px;">     <h3 id="onerror9" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">on('error')<sup>9+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onerror9" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>on(type: 'error', callback: ErrorCallback): void</p>     <p>订阅TLSSocket连接的error事件。使用callback方式作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>bind方法调用成功后，才可调用此方法。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.165.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.165.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.165.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.165.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">订阅的事件类型。'error'：error事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">ErrorCallback</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。TLSSocket连接订阅某类error事件触发的调用函数。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.165.9.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.165.9.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tls</span>: socket.<span class="hljs-property">TLSSocket</span> = socket.<span class="hljs-title function_">constructTLSSocketInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">bindAddr</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li>tls.<span class="hljs-title function_">bind</span>(bindAddr, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'bind fail'</span>);</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'bind success'</span>);</li><li>  tls.<span class="hljs-title function_">on</span>(<span class="hljs-string">'error'</span>, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"on error, err:"</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err))</li><li>  });</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1086px;">     <h3 id="offerror9" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">off('error')<sup>9+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="offerror9" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>off(type: 'error', callback?: ErrorCallback): void</p>     <p>取消订阅TLSSocket连接的error事件。使用callback方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.166.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.166.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.166.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.166.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">订阅的事件类型。'error'：error事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">ErrorCallback</td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">回调函数。TLSSocket连接取消订阅某类error事件触发的调用函数。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.166.8.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.166.8.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tls</span>: socket.<span class="hljs-property">TLSSocket</span> = socket.<span class="hljs-title function_">constructTLSSocketInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-title function_">callback</span> = (<span class="hljs-params">err: BusinessError</span>) =&gt; {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"on error, err:"</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));</li><li>}</li><li>tls.<span class="hljs-title function_">on</span>(<span class="hljs-string">'error'</span>, callback);</li><li><span class="hljs-comment">// 可以指定传入on中的callback取消一个订阅，也可以不指定callback清空所有订阅。</span></li><li>tls.<span class="hljs-title function_">off</span>(<span class="hljs-string">'error'</span>, callback);</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 5644px;">     <h3 id="connect9" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">connect<sup>9+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="connect9" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>connect(options: TLSConnectOptions, callback: AsyncCallback&lt;void&gt;): void</p>     <p>在TLSSocket上bind成功之后，进行通信连接，并创建和初始化TLS会话，实现建立连接过程，启动与服务器的TLS/SSL握手，实现数据传输功能，使用callback方式作为异步方法。需要注意options入参下secureOptions内的ca在API11及之前的版本为必填项，需填入服务端的ca证书(用于认证校验服务端的数字证书)，证书内容以"-----BEGIN CERTIFICATE-----"开头，以"-----END CERTIFICATE-----"结尾，自API12开始，为非必填项。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.167.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.167.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.167.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.167.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">options</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#tlsconnectoptions9">TLSConnectOptions</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">TLSSocket连接所需要的参数。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;void&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数，成功无返回，失败返回错误码、错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.167.8.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.167.8.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303104</td>         <td class="cellrowborder" width="50%">Interrupted system call.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303109</td>         <td class="cellrowborder" width="50%">Bad file number.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303111</td>         <td class="cellrowborder" width="50%">Resource temporarily unavailable. Try again.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303188</td>         <td class="cellrowborder" width="50%">Socket operation on non-socket.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303191</td>         <td class="cellrowborder" width="50%">Incorrect socket protocol type.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303198</td>         <td class="cellrowborder" width="50%">Address already in use.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303199</td>         <td class="cellrowborder" width="50%">Cannot assign requested address.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303210</td>         <td class="cellrowborder" width="50%">Connection timed out.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303501</td>         <td class="cellrowborder" width="50%">SSL is null.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303502</td>         <td class="cellrowborder" width="50%">An error occurred when reading data on the TLS socket.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303503</td>         <td class="cellrowborder" width="50%">An error occurred when writing data on the TLS socket.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303505</td>         <td class="cellrowborder" width="50%">An error occurred in the TLS system call.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303506</td>         <td class="cellrowborder" width="50%">Failed to close the TLS connection.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2300002</td>         <td class="cellrowborder" width="50%">System internal error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301206</td>         <td class="cellrowborder" width="50%">Socks5 failed to connect to the proxy server.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301207</td>         <td class="cellrowborder" width="50%">Socks5 username or password is invalid.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301208</td>         <td class="cellrowborder" width="50%">Socks5 failed to connect to the remote server.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301209</td>         <td class="cellrowborder" width="50%">Socks5 failed to negotiate the authentication method.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301210</td>         <td class="cellrowborder" width="50%">Socks5 failed to send the message.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301211</td>         <td class="cellrowborder" width="50%">Socks5 failed to receive the message.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301212</td>         <td class="cellrowborder" width="50%">Socks5 serialization error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301213</td>         <td class="cellrowborder" width="50%">Socks5 deserialization error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsTwoWay</span>: socket.<span class="hljs-property">TLSSocket</span> = socket.<span class="hljs-title function_">constructTLSSocketInstance</span>();  <span class="hljs-comment">// Two way authentication</span></li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">bindAddr</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>    <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-comment">// 绑定指定网络接口</span></li><li>}</li><li>tlsTwoWay.<span class="hljs-title function_">bind</span>(bindAddr, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'bind fail'</span>);</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'bind success'</span>);</li><li>});</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">twoWayNetAddr</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">twoWaySecureOptions</span>: socket.<span class="hljs-property">TLSSecureOptions</span> = {</li><li>  <span class="hljs-attr">key</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">cert</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">ca</span>: [<span class="hljs-string">"xxxx"</span>],</li><li>  <span class="hljs-attr">password</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">protocols</span>: socket.<span class="hljs-property">Protocol</span>.<span class="hljs-property">TLSv12</span>,</li><li>  <span class="hljs-attr">useRemoteCipherPrefer</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-attr">signatureAlgorithms</span>: <span class="hljs-string">"rsa_pss_rsae_sha256:ECDSA+SHA256"</span>,</li><li>  <span class="hljs-attr">cipherSuite</span>: <span class="hljs-string">"AES256-SHA256"</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsConnectOptions</span>: socket.<span class="hljs-property">TLSConnectOptions</span> = {</li><li>  <span class="hljs-attr">address</span>: twoWayNetAddr,</li><li>  <span class="hljs-attr">secureOptions</span>: twoWaySecureOptions,</li><li>  <span class="hljs-title class_">ALPNProtocols</span>: [<span class="hljs-string">"spdy/1"</span>, <span class="hljs-string">"http/1.1"</span>]</li><li>}</li><li>
</li><li>tlsTwoWay.<span class="hljs-title function_">connect</span>(tlsConnectOptions, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"connect callback error"</span> + err);</li><li>});</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsOneWay</span>: socket.<span class="hljs-property">TLSSocket</span> = socket.<span class="hljs-title function_">constructTLSSocketInstance</span>(); <span class="hljs-comment">// One way authentication</span></li><li>tlsOneWay.<span class="hljs-title function_">bind</span>(bindAddr, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'bind fail'</span>);</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'bind success'</span>);</li><li>});</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">oneWayNetAddr</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">oneWaySecureOptions</span>: socket.<span class="hljs-property">TLSSecureOptions</span> = {</li><li>  <span class="hljs-attr">ca</span>: [<span class="hljs-string">"xxxx"</span>, <span class="hljs-string">"xxxx"</span>],</li><li>  <span class="hljs-attr">cipherSuite</span>: <span class="hljs-string">"AES256-SHA256"</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsOneWayConnectOptions</span>: socket.<span class="hljs-property">TLSConnectOptions</span> = {</li><li>  <span class="hljs-attr">address</span>: oneWayNetAddr,</li><li>  <span class="hljs-attr">secureOptions</span>: oneWaySecureOptions</li><li>}</li><li>tlsOneWay.<span class="hljs-title function_">connect</span>(tlsOneWayConnectOptions, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"connect callback error"</span> + err);</li><li>});</li></ol></pre></div></div>     <p><strong>示例（设置socket代理）：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsTwoWay</span>: socket.<span class="hljs-property">TLSSocket</span> = socket.<span class="hljs-title function_">constructTLSSocketInstance</span>();  <span class="hljs-comment">// 双向认证</span></li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">bindAddr</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>   <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-comment">// 绑定指定网络接口</span></li><li>}</li><li>tlsTwoWay.<span class="hljs-title function_">bind</span>(bindAddr, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'bind fail'</span>);</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'bind success'</span>);</li><li>});</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">twoWayNetAddr</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">socks5Server</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">twoWaySecureOptions</span>: socket.<span class="hljs-property">TLSSecureOptions</span> = {</li><li>  <span class="hljs-attr">key</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">cert</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">ca</span>: [<span class="hljs-string">"xxxx"</span>],</li><li>  <span class="hljs-attr">password</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">protocols</span>: socket.<span class="hljs-property">Protocol</span>.<span class="hljs-property">TLSv12</span>,</li><li>  <span class="hljs-attr">useRemoteCipherPrefer</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-attr">signatureAlgorithms</span>: <span class="hljs-string">"rsa_pss_rsae_sha256:ECDSA+SHA256"</span>,</li><li>  <span class="hljs-attr">cipherSuite</span>: <span class="hljs-string">"AES256-SHA256"</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">proxyOptions</span>: socket.<span class="hljs-property">ProxyOptions</span> = {</li><li>  <span class="hljs-keyword">type</span> : <span class="hljs-number">1</span>,</li><li>  <span class="hljs-attr">address</span>: socks5Server,</li><li>  <span class="hljs-attr">username</span>: <span class="hljs-string">"xxx"</span>,</li><li>  <span class="hljs-attr">password</span>: <span class="hljs-string">"xxx"</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsConnectOptions</span>: socket.<span class="hljs-property">TLSConnectOptions</span> = {</li><li>  <span class="hljs-attr">address</span>: twoWayNetAddr,</li><li>  <span class="hljs-attr">secureOptions</span>: twoWaySecureOptions,</li><li>  <span class="hljs-title class_">ALPNProtocols</span>: [<span class="hljs-string">"spdy/1"</span>, <span class="hljs-string">"http/1.1"</span>],</li><li>  <span class="hljs-attr">proxy</span>: proxyOptions,</li><li>}</li><li>
</li><li>tlsTwoWay.<span class="hljs-title function_">connect</span>(tlsConnectOptions, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"connect callback error"</span> + err);</li><li>});</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsOneWay</span>: socket.<span class="hljs-property">TLSSocket</span> = socket.<span class="hljs-title function_">constructTLSSocketInstance</span>(); <span class="hljs-comment">// 单向认证</span></li><li>tlsOneWay.<span class="hljs-title function_">bind</span>(bindAddr, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'bind fail'</span>);</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'bind success'</span>);</li><li>});</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">oneWayNetAddr</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">oneWaySecureOptions</span>: socket.<span class="hljs-property">TLSSecureOptions</span> = {</li><li>  <span class="hljs-attr">ca</span>: [<span class="hljs-string">"xxxx"</span>, <span class="hljs-string">"xxxx"</span>],</li><li>  <span class="hljs-attr">cipherSuite</span>: <span class="hljs-string">"AES256-SHA256"</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">oneWayProxyOptions</span>: socket.<span class="hljs-property">ProxyOptions</span> = {</li><li>  <span class="hljs-keyword">type</span> : <span class="hljs-number">1</span>,</li><li>  <span class="hljs-attr">address</span>: socks5Server,</li><li>  <span class="hljs-attr">username</span>: <span class="hljs-string">"xxx"</span>,</li><li>  <span class="hljs-attr">password</span>: <span class="hljs-string">"xxx"</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsOneWayConnectOptions</span>: socket.<span class="hljs-property">TLSConnectOptions</span> = {</li><li>  <span class="hljs-attr">address</span>: oneWayNetAddr,</li><li>  <span class="hljs-attr">secureOptions</span>: oneWaySecureOptions,</li><li>  <span class="hljs-attr">proxy</span>: oneWayProxyOptions,</li><li>}</li><li>tlsOneWay.<span class="hljs-title function_">connect</span>(tlsOneWayConnectOptions, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"connect callback error"</span> + err);</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 5938px;">     <h3 id="connect9-1" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">connect<sup>9+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="connect9-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>connect(options: TLSConnectOptions): Promise&lt;void&gt;</p>     <p>在TLSSocket上bind成功之后，进行通信连接，并创建和初始化TLS会话，实现建立连接过程，启动与服务器的TLS/SSL握手，实现数据传输功能，该连接包括两种认证方式，单向认证与双向认证，使用Promise方式作为异步方法。需要注意options入参下secureOptions内的ca在API11及之前的版本为必填项，需填入服务端的ca证书(用于认证校验服务端的数字证书)，证书内容以"-----BEGIN CERTIFICATE-----"开头，以"-----END CERTIFICATE-----"结尾，自API12开始，为非必填项。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.168.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.168.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.168.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.168.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">options</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#tlsconnectoptions9">TLSConnectOptions</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">连接所需要的参数。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.168.8.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.168.8.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">以Promise形式返回，成功无返回，失败返回错误码，错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.168.10.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.168.10.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303104</td>         <td class="cellrowborder" width="50%">Interrupted system call.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303109</td>         <td class="cellrowborder" width="50%">Bad file number.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303111</td>         <td class="cellrowborder" width="50%">Resource temporarily unavailable. Try again.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303188</td>         <td class="cellrowborder" width="50%">Socket operation on non-socket.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303191</td>         <td class="cellrowborder" width="50%">Incorrect socket protocol type.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303198</td>         <td class="cellrowborder" width="50%">Address already in use.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303199</td>         <td class="cellrowborder" width="50%">Cannot assign requested address.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303210</td>         <td class="cellrowborder" width="50%">Connection timed out.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303501</td>         <td class="cellrowborder" width="50%">SSL is null.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303502</td>         <td class="cellrowborder" width="50%">An error occurred when reading data on the TLS socket.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303503</td>         <td class="cellrowborder" width="50%">An error occurred when writing data on the TLS socket.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303505</td>         <td class="cellrowborder" width="50%">An error occurred in the TLS system call.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303506</td>         <td class="cellrowborder" width="50%">Failed to close the TLS connection.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2300002</td>         <td class="cellrowborder" width="50%">System internal error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301206</td>         <td class="cellrowborder" width="50%">Socks5 failed to connect to the proxy server.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301207</td>         <td class="cellrowborder" width="50%">Socks5 username or password is invalid.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301208</td>         <td class="cellrowborder" width="50%">Socks5 failed to connect to the remote server.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301209</td>         <td class="cellrowborder" width="50%">Socks5 failed to negotiate the authentication method.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301210</td>         <td class="cellrowborder" width="50%">Socks5 failed to send the message.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301211</td>         <td class="cellrowborder" width="50%">Socks5 failed to receive the message.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301212</td>         <td class="cellrowborder" width="50%">Socks5 serialization error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301213</td>         <td class="cellrowborder" width="50%">Socks5 deserialization error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsTwoWay</span>: socket.<span class="hljs-property">TLSSocket</span> = socket.<span class="hljs-title function_">constructTLSSocketInstance</span>();  <span class="hljs-comment">// Two way authentication</span></li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">bindAddr</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>   <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-comment">// 绑定指定网络接口</span></li><li>}</li><li>tlsTwoWay.<span class="hljs-title function_">bind</span>(bindAddr, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'bind fail'</span>);</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'bind success'</span>);</li><li>});</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">twoWayNetAddr</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">twoWaySecureOptions</span>: socket.<span class="hljs-property">TLSSecureOptions</span> = {</li><li>  <span class="hljs-attr">key</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">cert</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">ca</span>: [<span class="hljs-string">"xxxx"</span>],</li><li>  <span class="hljs-attr">password</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">protocols</span>: socket.<span class="hljs-property">Protocol</span>.<span class="hljs-property">TLSv12</span>,</li><li>  <span class="hljs-attr">useRemoteCipherPrefer</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-attr">signatureAlgorithms</span>: <span class="hljs-string">"rsa_pss_rsae_sha256:ECDSA+SHA256"</span>,</li><li>  <span class="hljs-attr">cipherSuite</span>: <span class="hljs-string">"AES256-SHA256"</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsConnectOptions</span>: socket.<span class="hljs-property">TLSConnectOptions</span> = {</li><li>  <span class="hljs-attr">address</span>: twoWayNetAddr,</li><li>  <span class="hljs-attr">secureOptions</span>: twoWaySecureOptions,</li><li>  <span class="hljs-title class_">ALPNProtocols</span>: [<span class="hljs-string">"spdy/1"</span>, <span class="hljs-string">"http/1.1"</span>]</li><li>}</li><li>
</li><li>tlsTwoWay.<span class="hljs-title function_">connect</span>(tlsConnectOptions).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"connect successfully"</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"connect failed "</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));</li><li>});</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsOneWay</span>: socket.<span class="hljs-property">TLSSocket</span> = socket.<span class="hljs-title function_">constructTLSSocketInstance</span>(); <span class="hljs-comment">// One way authentication</span></li><li>tlsOneWay.<span class="hljs-title function_">bind</span>(bindAddr, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'bind fail'</span>);</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'bind success'</span>);</li><li>});</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">oneWayNetAddr</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">oneWaySecureOptions</span>: socket.<span class="hljs-property">TLSSecureOptions</span> = {</li><li>  <span class="hljs-attr">ca</span>: [<span class="hljs-string">"xxxx"</span>, <span class="hljs-string">"xxxx"</span>],</li><li>  <span class="hljs-attr">cipherSuite</span>: <span class="hljs-string">"AES256-SHA256"</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsOneWayConnectOptions</span>: socket.<span class="hljs-property">TLSConnectOptions</span> = {</li><li>  <span class="hljs-attr">address</span>: oneWayNetAddr,</li><li>  <span class="hljs-attr">secureOptions</span>: oneWaySecureOptions</li><li>}</li><li>tlsOneWay.<span class="hljs-title function_">connect</span>(tlsOneWayConnectOptions).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"connect successfully"</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"connect failed "</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));</li><li>});</li></ol></pre></div></div>     <p><strong>示例（设置socket代理）：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsTwoWay</span>: socket.<span class="hljs-property">TLSSocket</span> = socket.<span class="hljs-title function_">constructTLSSocketInstance</span>();  <span class="hljs-comment">// 双向认证</span></li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">bindAddr</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>   <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-comment">// 绑定指定网络接口</span></li><li>}</li><li>tlsTwoWay.<span class="hljs-title function_">bind</span>(bindAddr, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'bind fail'</span>);</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'bind success'</span>);</li><li>});</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">twoWayNetAddr</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">socks5Server</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">twoWaySecureOptions</span>: socket.<span class="hljs-property">TLSSecureOptions</span> = {</li><li>  <span class="hljs-attr">key</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">cert</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">ca</span>: [<span class="hljs-string">"xxxx"</span>],</li><li>  <span class="hljs-attr">password</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">protocols</span>: socket.<span class="hljs-property">Protocol</span>.<span class="hljs-property">TLSv12</span>,</li><li>  <span class="hljs-attr">useRemoteCipherPrefer</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-attr">signatureAlgorithms</span>: <span class="hljs-string">"rsa_pss_rsae_sha256:ECDSA+SHA256"</span>,</li><li>  <span class="hljs-attr">cipherSuite</span>: <span class="hljs-string">"AES256-SHA256"</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">proxyOptions</span>: socket.<span class="hljs-property">ProxyOptions</span> = {</li><li>  <span class="hljs-keyword">type</span> : <span class="hljs-number">1</span>,</li><li>  <span class="hljs-attr">address</span>: socks5Server,</li><li>  <span class="hljs-attr">username</span>: <span class="hljs-string">"xxx"</span>,</li><li>  <span class="hljs-attr">password</span>: <span class="hljs-string">"xxx"</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsConnectOptions</span>: socket.<span class="hljs-property">TLSConnectOptions</span> = {</li><li>  <span class="hljs-attr">address</span>: twoWayNetAddr,</li><li>  <span class="hljs-attr">secureOptions</span>: twoWaySecureOptions,</li><li>  <span class="hljs-title class_">ALPNProtocols</span>: [<span class="hljs-string">"spdy/1"</span>, <span class="hljs-string">"http/1.1"</span>],</li><li>  <span class="hljs-attr">proxy</span>: proxyOptions,</li><li>}</li><li>
</li><li>tlsTwoWay.<span class="hljs-title function_">connect</span>(tlsConnectOptions).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"connect successfully"</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"connect failed "</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));</li><li>});</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsOneWay</span>: socket.<span class="hljs-property">TLSSocket</span> = socket.<span class="hljs-title function_">constructTLSSocketInstance</span>(); <span class="hljs-comment">// 单向认证</span></li><li>tlsOneWay.<span class="hljs-title function_">bind</span>(bindAddr, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'bind fail'</span>);</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'bind success'</span>);</li><li>});</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">oneWayNetAddr</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">oneWaySecureOptions</span>: socket.<span class="hljs-property">TLSSecureOptions</span> = {</li><li>  <span class="hljs-attr">ca</span>: [<span class="hljs-string">"xxxx"</span>, <span class="hljs-string">"xxxx"</span>],</li><li>  <span class="hljs-attr">cipherSuite</span>: <span class="hljs-string">"AES256-SHA256"</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">oneWayProxyOptions</span>: socket.<span class="hljs-property">ProxyOptions</span> = {</li><li>  <span class="hljs-keyword">type</span> : <span class="hljs-number">1</span>,</li><li>  <span class="hljs-attr">address</span>: socks5Server,</li><li>  <span class="hljs-attr">username</span>: <span class="hljs-string">"xxx"</span>,</li><li>  <span class="hljs-attr">password</span>: <span class="hljs-string">"xxx"</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsOneWayConnectOptions</span>: socket.<span class="hljs-property">TLSConnectOptions</span> = {</li><li>  <span class="hljs-attr">address</span>: oneWayNetAddr,</li><li>  <span class="hljs-attr">secureOptions</span>: oneWaySecureOptions,</li><li>  <span class="hljs-attr">proxy</span>: oneWayProxyOptions,</li><li>}</li><li>tlsOneWay.<span class="hljs-title function_">connect</span>(tlsOneWayConnectOptions).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"connect successfully"</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"connect failed "</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1096px;">     <h3 id="getremoteaddress9" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">getRemoteAddress<sup>9+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getremoteaddress9" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>getRemoteAddress(callback: AsyncCallback&lt;NetAddress&gt;): void</p>     <p>在TLSSocket通信连接成功之后，获取对端Socket地址。使用callback方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.169.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.169.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.169.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.169.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#netaddress">NetAddress</a>&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。成功返回对端的socket地址，失败返回错误码、错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.169.8.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.169.8.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">2303188</td>         <td class="cellrowborder" width="50%">Socket operation on non-socket.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2300002</td>         <td class="cellrowborder" width="50%">System internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tls</span>: socket.<span class="hljs-property">TLSSocket</span> = socket.<span class="hljs-title function_">constructTLSSocketInstance</span>();</li><li>tls.<span class="hljs-title function_">getRemoteAddress</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError, data: socket.NetAddress</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'getRemoteAddress fail'</span>);</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'getRemoteAddress success:'</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data));</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1044px;">     <h3 id="getremoteaddress9-1" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">getRemoteAddress<sup>9+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getremoteaddress9-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>getRemoteAddress(): Promise&lt;NetAddress&gt;</p>     <p>在TLSSocket通信连接成功之后，获取对端Socket地址。使用Promise方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.170.6.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.170.6.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#netaddress">NetAddress</a>&gt;</td>         <td class="cellrowborder" width="50%">以Promise形式返回获取对端socket地址的结果。失败返回错误码，错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.170.8.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.170.8.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">2303188</td>         <td class="cellrowborder" width="50%">Socket operation on non-socket.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2300002</td>         <td class="cellrowborder" width="50%">System internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tls</span>: socket.<span class="hljs-property">TLSSocket</span> = socket.<span class="hljs-title function_">constructTLSSocketInstance</span>();</li><li>tls.<span class="hljs-title function_">getRemoteAddress</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'getRemoteAddress success'</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'getRemoteAddress fail'</span>);</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1151px;">     <h3 id="getcertificate9" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">getCertificate<sup>9+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getcertificate9" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>getCertificate(callback: AsyncCallback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#x509certrawdata9">X509CertRawData</a>&gt;): void</p>     <p>在TLSSocket通信连接成功之后，获取本地的数字证书，该接口只适用于双向认证时，使用callback方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.171.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.171.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.171.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.171.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#x509certrawdata9">X509CertRawData</a>&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数，成功返回本地的证书，失败返回错误码、错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.171.8.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.171.8.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">2303501</td>         <td class="cellrowborder" width="50%">SSL is null.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303504</td>         <td class="cellrowborder" width="50%">An error occurred when verifying the X.509 certificate.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2300002</td>         <td class="cellrowborder" width="50%">System internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tls</span>: socket.<span class="hljs-property">TLSSocket</span> = socket.<span class="hljs-title function_">constructTLSSocketInstance</span>();</li><li>tls.<span class="hljs-title function_">getCertificate</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError, data: socket.X509CertRawData</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"getCertificate callback error = "</span> + err);</li><li>  } <span class="hljs-keyword">else</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"getCertificate callback = "</span> + data);</li><li>  }</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1171px;">     <h3 id="getcertificate9-1" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">getCertificate<sup>9+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getcertificate9-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>getCertificate():Promise&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#x509certrawdata9">X509CertRawData</a>&gt;</p>     <p>在TLSSocket通信连接之后，获取本地的数字证书，该接口只适用于双向认证时，使用Promise方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.172.6.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.172.6.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#x509certrawdata9">X509CertRawData</a>&gt;</td>         <td class="cellrowborder" width="50%">以Promise形式返回本地的数字证书的结果。失败返回错误码，错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.172.8.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.172.8.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">2303501</td>         <td class="cellrowborder" width="50%">SSL is null.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303504</td>         <td class="cellrowborder" width="50%">An error occurred when verifying the X.509 certificate.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2300002</td>         <td class="cellrowborder" width="50%">System internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { util } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkTS'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tls</span>: socket.<span class="hljs-property">TLSSocket</span> = socket.<span class="hljs-title function_">constructTLSSocketInstance</span>();</li><li>tls.<span class="hljs-title function_">getCertificate</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">data: socket.X509CertRawData</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">const</span> decoder = util.<span class="hljs-property">TextDecoder</span>.<span class="hljs-title function_">create</span>();</li><li>  <span class="hljs-keyword">const</span> str = decoder.<span class="hljs-title function_">decodeToString</span>(data.<span class="hljs-property">data</span>);</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"getCertificate: "</span> + str);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"failed"</span> + err);</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1168px;">     <h3 id="getremotecertificate9" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">getRemoteCertificate<sup>9+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getremotecertificate9" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>getRemoteCertificate(callback: AsyncCallback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#x509certrawdata9">X509CertRawData</a>&gt;): void</p>     <p>在TLSSocket通信连接成功之后，获取服务端的数字证书，使用callback方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.173.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.173.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.173.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.173.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#x509certrawdata9">X509CertRawData</a>&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数，返回服务端的证书。失败返回错误码、错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.173.8.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.173.8.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">2303501</td>         <td class="cellrowborder" width="50%">SSL is null.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2300002</td>         <td class="cellrowborder" width="50%">System internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { util } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkTS'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tls</span>: socket.<span class="hljs-property">TLSSocket</span> = socket.<span class="hljs-title function_">constructTLSSocketInstance</span>();</li><li>tls.<span class="hljs-title function_">getRemoteCertificate</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError, data: socket.X509CertRawData</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"getRemoteCertificate callback error = "</span> + err);</li><li>  } <span class="hljs-keyword">else</span> {</li><li>    <span class="hljs-keyword">const</span> decoder = util.<span class="hljs-property">TextDecoder</span>.<span class="hljs-title function_">create</span>();</li><li>    <span class="hljs-keyword">const</span> str = decoder.<span class="hljs-title function_">decodeToString</span>(data.<span class="hljs-property">data</span>);</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"getRemoteCertificate callback = "</span> + str);</li><li>  }</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1116px;">     <h3 id="getremotecertificate9-1" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">getRemoteCertificate<sup>9+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getremotecertificate9-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>getRemoteCertificate():Promise&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#x509certrawdata9">X509CertRawData</a>&gt;</p>     <p>在TLSSocket通信连接成功之后，获取服务端的数字证书，使用Promise方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.174.6.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.174.6.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#x509certrawdata9">X509CertRawData</a>&gt;</td>         <td class="cellrowborder" width="50%">以Promise形式返回服务端的数字证书的结果。失败返回错误码，错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.174.8.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.174.8.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">2303501</td>         <td class="cellrowborder" width="50%">SSL is null.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2300002</td>         <td class="cellrowborder" width="50%">System internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { util } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkTS'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tls</span>: socket.<span class="hljs-property">TLSSocket</span> = socket.<span class="hljs-title function_">constructTLSSocketInstance</span>();</li><li>tls.<span class="hljs-title function_">getRemoteCertificate</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">data: socket.X509CertRawData</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">const</span> decoder = util.<span class="hljs-property">TextDecoder</span>.<span class="hljs-title function_">create</span>();</li><li>  <span class="hljs-keyword">const</span> str = decoder.<span class="hljs-title function_">decodeToString</span>(data.<span class="hljs-property">data</span>);</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"getRemoteCertificate:"</span> + str);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"failed"</span> + err);</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1151px;">     <h3 id="getprotocol9" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">getProtocol<sup>9+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getprotocol9" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>getProtocol(callback: AsyncCallback&lt;string&gt;): void</p>     <p>在TLSSocket通信连接成功之后，获取通信的协议版本，使用callback方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.175.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.175.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.175.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.175.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;string&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数，返回通信的协议。失败返回错误码、错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.175.8.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.175.8.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">2303501</td>         <td class="cellrowborder" width="50%">SSL is null.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303505</td>         <td class="cellrowborder" width="50%">An error occurred in the TLS system call.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2300002</td>         <td class="cellrowborder" width="50%">System internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tls</span>: socket.<span class="hljs-property">TLSSocket</span> = socket.<span class="hljs-title function_">constructTLSSocketInstance</span>();</li><li>tls.<span class="hljs-title function_">getProtocol</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError, data: <span class="hljs-built_in">string</span></span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"getProtocol callback error = "</span> + err);</li><li>  } <span class="hljs-keyword">else</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"getProtocol callback = "</span> + data);</li><li>  }</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1099px;">     <h3 id="getprotocol9-1" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">getProtocol<sup>9+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getprotocol9-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>getProtocol():Promise&lt;string&gt;</p>     <p>在TLSSocket通信连接成功之后，获取通信的协议版本，使用Promise方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.176.6.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.176.6.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;string&gt;</td>         <td class="cellrowborder" width="50%">以Promise形式返回通信的协议。失败返回错误码，错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.176.8.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.176.8.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">2303501</td>         <td class="cellrowborder" width="50%">SSL is null.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303505</td>         <td class="cellrowborder" width="50%">An error occurred in the TLS system call.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2300002</td>         <td class="cellrowborder" width="50%">System internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tls</span>: socket.<span class="hljs-property">TLSSocket</span> = socket.<span class="hljs-title function_">constructTLSSocketInstance</span>();</li><li>tls.<span class="hljs-title function_">getProtocol</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">data: <span class="hljs-built_in">string</span></span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(data);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"failed"</span> + err);</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1206px;">     <h3 id="getciphersuite9" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">getCipherSuite<sup>9+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getciphersuite9" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>getCipherSuite(callback: AsyncCallback&lt;Array&lt;string&gt;&gt;): void</p>     <p>在TLSSocket通信连接成功之后，获取通信双方协商后的加密套件，使用callback方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.177.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.177.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.177.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.177.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;Array&lt;string&gt;&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数，返回通信双方支持的加密套件。失败返回错误码、错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.177.8.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.177.8.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">2303501</td>         <td class="cellrowborder" width="50%">SSL is null.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303502</td>         <td class="cellrowborder" width="50%">An error occurred when reading data on the TLS socket.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303505</td>         <td class="cellrowborder" width="50%">An error occurred in the TLS system call.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2300002</td>         <td class="cellrowborder" width="50%">System internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tls</span>: socket.<span class="hljs-property">TLSSocket</span> = socket.<span class="hljs-title function_">constructTLSSocketInstance</span>();</li><li>tls.<span class="hljs-title function_">getCipherSuite</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError, data: <span class="hljs-built_in">Array</span>&lt;<span class="hljs-built_in">string</span>&gt;</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"getCipherSuite callback error = "</span> + err);</li><li>  } <span class="hljs-keyword">else</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"getCipherSuite callback = "</span> + data);</li><li>  }</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1154px;">     <h3 id="getciphersuite9-1" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">getCipherSuite<sup>9+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getciphersuite9-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>getCipherSuite(): Promise&lt;Array&lt;string&gt;&gt;</p>     <p>在TLSSocket通信连接成功之后，获取通信双方协商后的加密套件，使用Promise方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.178.6.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.178.6.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;Array&lt;string&gt;&gt;</td>         <td class="cellrowborder" width="50%">以Promise形式返回通信双方支持的加密套件。失败返回错误码，错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.178.8.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.178.8.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">2303501</td>         <td class="cellrowborder" width="50%">SSL is null.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303502</td>         <td class="cellrowborder" width="50%">An error occurred when reading data on the TLS socket.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303505</td>         <td class="cellrowborder" width="50%">An error occurred in the TLS system call.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2300002</td>         <td class="cellrowborder" width="50%">System internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tls</span>: socket.<span class="hljs-property">TLSSocket</span> = socket.<span class="hljs-title function_">constructTLSSocketInstance</span>();</li><li>tls.<span class="hljs-title function_">getCipherSuite</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">data: <span class="hljs-built_in">Array</span>&lt;<span class="hljs-built_in">string</span>&gt;</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'getCipherSuite success:'</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data));</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"failed"</span> + err);</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1072px;">     <h3 id="getsignaturealgorithms9" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">getSignatureAlgorithms<sup>9+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getsignaturealgorithms9" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>getSignatureAlgorithms(callback: AsyncCallback&lt;Array&lt;string&gt;&gt;): void</p>     <p>在TLSSocket通信连接成功之后，获取通信双方协商后签名算法，该接口只适配双向认证模式下，使用callback方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.179.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.179.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.179.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.179.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;Array&lt;string&gt;&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数，返回双方支持的签名算法。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.179.8.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.179.8.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">2303501</td>         <td class="cellrowborder" width="50%">SSL is null.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2300002</td>         <td class="cellrowborder" width="50%">System internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tls</span>: socket.<span class="hljs-property">TLSSocket</span> = socket.<span class="hljs-title function_">constructTLSSocketInstance</span>();</li><li>tls.<span class="hljs-title function_">getSignatureAlgorithms</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError, data: <span class="hljs-built_in">Array</span>&lt;<span class="hljs-built_in">string</span>&gt;</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"getSignatureAlgorithms callback error = "</span> + err);</li><li>  } <span class="hljs-keyword">else</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"getSignatureAlgorithms callback = "</span> + data);</li><li>  }</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1044px;">     <h3 id="getsignaturealgorithms9-1" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">getSignatureAlgorithms<sup>9+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getsignaturealgorithms9-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>getSignatureAlgorithms(): Promise&lt;Array&lt;string&gt;&gt;</p>     <p>在TLSSocket通信连接成功之后，获取通信双方协商后的签名算法，该接口只适配双向认证模式下，使用Promise方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.180.6.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.180.6.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;Array&lt;string&gt;&gt;</td>         <td class="cellrowborder" width="50%">以Promise形式返回获取到的双方支持的签名算法。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.180.8.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.180.8.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">2303501</td>         <td class="cellrowborder" width="50%">SSL is null.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2300002</td>         <td class="cellrowborder" width="50%">System internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tls</span>: socket.<span class="hljs-property">TLSSocket</span> = socket.<span class="hljs-title function_">constructTLSSocketInstance</span>();</li><li>tls.<span class="hljs-title function_">getSignatureAlgorithms</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">data: <span class="hljs-built_in">Array</span>&lt;<span class="hljs-built_in">string</span>&gt;</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"getSignatureAlgorithms success"</span> + data);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"failed"</span> + err);</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1167px;">     <h3 id="getlocaladdress12-7" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">getLocalAddress<sup>12+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getlocaladdress12-7" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>getLocalAddress(): Promise&lt;NetAddress&gt;</p>     <p>获取TLSSocket的本地Socket地址。使用Promise方式作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>在TLSSocketServer通信连接成功之后，才可调用此方法。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.181.7.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.181.7.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#netaddress">NetAddress</a>&gt;</td>         <td class="cellrowborder" width="50%">以Promise形式返回获取本地socket地址的结果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.181.9.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.181.9.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">2300002</td>         <td class="cellrowborder" width="50%">System internal error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301009</td>         <td class="cellrowborder" width="50%">Bad file descriptor.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303188</td>         <td class="cellrowborder" width="50%">Socket operation on non-socket.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tls</span>: socket.<span class="hljs-property">TLSSocket</span> = socket.<span class="hljs-title function_">constructTLSSocketInstance</span>();</li><li>tls.<span class="hljs-title function_">getLocalAddress</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">localAddress: socket.NetAddress</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"Get success: "</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(localAddress));</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"Get failed, error: "</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));</li><li>})</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1078px;">     <h3 id="getsocketfd16" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">getSocketFd<sup>16+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getsocketfd16" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>getSocketFd(): Promise&lt;number&gt;</p>     <p>获取TLSSocket的文件描述符。使用Promise异步回调。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>bind方法调用成功后，才可调用此方法。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.182.7.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.182.7.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;number&gt;</td>         <td class="cellrowborder" width="50%">以Promise形式返回socket的文件描述符。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tls</span>: socket.<span class="hljs-property">TLSSocket</span> = socket.<span class="hljs-title function_">constructTLSSocketInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">bindAddr</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li>tls.<span class="hljs-title function_">bind</span>(bindAddr, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'bind fail'</span>);</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'bind success'</span>);</li><li>});</li><li>tls.<span class="hljs-title function_">getSocketFd</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">data: <span class="hljs-built_in">number</span></span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"tls socket fd: "</span> + data);</li><li>})</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1361px;">     <h3 id="send9" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">send<sup>9+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="send9" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>send(data: string | ArrayBuffer, callback: AsyncCallback&lt;void&gt;): void</p>     <p>在TLSSocket通信连接成功之后，向服务端发送消息，使用callback方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.183.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.183.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.183.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.183.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">data</td>         <td class="cellrowborder" width="25%">string | ArrayBuffer</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">发送的数据内容。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;void&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数,返回TLSSocket发送数据的结果。失败返回错误码、错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.183.8.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.183.8.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303501</td>         <td class="cellrowborder" width="50%">SSL is null.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303503</td>         <td class="cellrowborder" width="50%">An error occurred when writing data on the TLS socket.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303505</td>         <td class="cellrowborder" width="50%">An error occurred in the TLS system call.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303506</td>         <td class="cellrowborder" width="50%">Failed to close the TLS connection.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2300002</td>         <td class="cellrowborder" width="50%">System internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tls</span>: socket.<span class="hljs-property">TLSSocket</span> = socket.<span class="hljs-title function_">constructTLSSocketInstance</span>();</li><li>tls.<span class="hljs-title function_">send</span>(<span class="hljs-string">"xxxx"</span>, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"send callback error = "</span> + err);</li><li>  } <span class="hljs-keyword">else</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"send success"</span>);</li><li>  }</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1415px;">     <h3 id="send9-1" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">send<sup>9+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="send9-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>send(data: string | ArrayBuffer): Promise&lt;void&gt;</p>     <p>在TLSSocket通信连接成功之后，向服务端发送消息，使用Promise方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.184.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.184.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.184.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.184.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">data</td>         <td class="cellrowborder" width="25%">string | ArrayBuffer</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">发送的数据内容。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.184.8.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.184.8.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303501</td>         <td class="cellrowborder" width="50%">SSL is null.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303503</td>         <td class="cellrowborder" width="50%">An error occurred when writing data on the TLS socket.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303505</td>         <td class="cellrowborder" width="50%">An error occurred in the TLS system call.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303506</td>         <td class="cellrowborder" width="50%">Failed to close the TLS connection.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2300002</td>         <td class="cellrowborder" width="50%">System internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.184.10.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.184.10.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">以Promise形式返回,返回TLSSocket发送数据的结果。失败返回错误码，错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tls</span>: socket.<span class="hljs-property">TLSSocket</span> = socket.<span class="hljs-title function_">constructTLSSocketInstance</span>();</li><li>tls.<span class="hljs-title function_">send</span>(<span class="hljs-string">"xxxx"</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"send success"</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"failed"</span> + err);</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1285px;">     <h3 id="close9" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">close<sup>9+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="close9" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>close(callback: AsyncCallback&lt;void&gt;): void</p>     <p>在TLSSocket通信连接成功之后，断开连接，使用callback方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.185.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.185.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.185.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.185.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;void&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数,成功返回TLSSocket关闭连接的结果。失败返回错误码、错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.185.8.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.185.8.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303501</td>         <td class="cellrowborder" width="50%">SSL is null.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303505</td>         <td class="cellrowborder" width="50%">An error occurred in the TLS system call.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303506</td>         <td class="cellrowborder" width="50%">Failed to close the TLS connection.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2300002</td>         <td class="cellrowborder" width="50%">System internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tls</span>: socket.<span class="hljs-property">TLSSocket</span> = socket.<span class="hljs-title function_">constructTLSSocketInstance</span>();</li><li>tls.<span class="hljs-title function_">close</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"close callback error = "</span> + err);</li><li>  } <span class="hljs-keyword">else</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"close success"</span>);</li><li>  }</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1209px;">     <h3 id="close9-1" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">close<sup>9+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="close9-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>close(): Promise&lt;void&gt;</p>     <p>在TLSSocket通信连接成功之后，断开连接，使用Promise方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.186.6.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.186.6.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">以Promise形式返回,返回TLSSocket关闭连接的结果。失败返回错误码，错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.186.8.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.186.8.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303501</td>         <td class="cellrowborder" width="50%">SSL is null.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303505</td>         <td class="cellrowborder" width="50%">An error occurred in the TLS system call.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303506</td>         <td class="cellrowborder" width="50%">Failed to close the TLS connection.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2300002</td>         <td class="cellrowborder" width="50%">System internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tls</span>: socket.<span class="hljs-property">TLSSocket</span> = socket.<span class="hljs-title function_">constructTLSSocketInstance</span>();</li><li>tls.<span class="hljs-title function_">close</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"close success"</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"failed"</span> + err);</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 753px;">     <h2 id="tlsconnectoptions9" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">TLSConnectOptions<sup>9+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="tlsconnectoptions9" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>TLS连接的操作。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.187.4.1.6.1.1" width="20%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.187.4.1.6.1.2" width="20%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.187.4.1.6.1.3" width="20%">只读</th>         <th align="left" class="cellrowborder" id="mcps1.3.187.4.1.6.1.4" width="20%">可选</th>         <th align="left" class="cellrowborder" id="mcps1.3.187.4.1.6.1.5" width="20%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">address</td>         <td class="cellrowborder" width="20%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#netaddress">NetAddress</a></td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">网关地址。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">secureOptions</td>         <td class="cellrowborder" width="20%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#tlssecureoptions9">TLSSecureOptions</a></td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">TLS安全相关操作。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">ALPNProtocols</td>         <td class="cellrowborder" width="20%">Array&lt;string&gt;</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">ALPN协议，支持["spdy/1", "http/1.1"]，默认为[]。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">skipRemoteValidation<sup>12+</sup></td>         <td class="cellrowborder" width="20%">boolean</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">是否跳过对服务端进行证书认证，默认为false。true：跳过对服务端进行证书认证；false：不跳过对服务端进行证书认证。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">proxy<sup>18+</sup></td>         <td class="cellrowborder" width="20%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#proxyoptions18">ProxyOptions</a></td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">使用的代理信息，默认不使用代理。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1101px;">     <h2 id="tlssecureoptions9" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">TLSSecureOptions<sup>9+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="tlssecureoptions9" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>TLS安全相关操作。当本地证书cert和私钥key不为空时，开启双向验证模式。cert和key其中一项为空时，开启单向验证模式。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.188.4.1.6.1.1" width="20%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.188.4.1.6.1.2" width="20%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.188.4.1.6.1.3" width="20%">只读</th>         <th align="left" class="cellrowborder" id="mcps1.3.188.4.1.6.1.4" width="20%">可选</th>         <th align="left" class="cellrowborder" id="mcps1.3.188.4.1.6.1.5" width="20%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">ca</td>         <td class="cellrowborder" width="20%">string | Array&lt;string&gt;</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">服务端的ca证书，用于认证校验服务端的数字证书。默认为系统预置CA证书<sup>12+</sup>。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">cert</td>         <td class="cellrowborder" width="20%">string</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">本地客户端的数字证书。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">key</td>         <td class="cellrowborder" width="20%">string</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">本地数字证书的私钥。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">password</td>         <td class="cellrowborder" width="20%">string</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">读取私钥的密码。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">protocols</td>         <td class="cellrowborder" width="20%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#protocol9">Protocol</a> |Array&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#protocol9">Protocol</a>&gt;</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">TLS的协议版本，默认为"TLSv1.2"。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">useRemoteCipherPrefer</td>         <td class="cellrowborder" width="20%">boolean</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">优先使用对等方的密码套件。true：优先使用对等方的密码套件；false：不优先使用对等方的密码套件。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">signatureAlgorithms</td>         <td class="cellrowborder" width="20%">string</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">通信过程中的签名算法，默认为"" 。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">cipherSuite</td>         <td class="cellrowborder" width="20%">string</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">通信过程中的加密套件，默认为"" 。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">isBidirectionalAuthentication<sup>12+</sup></td>         <td class="cellrowborder" width="20%">boolean</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">用于设置双向认证，默认为false。true：设置双向认证；false：不设置双向认证。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 378px;">     <h2 id="protocol9" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">Protocol<sup>9+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="protocol9" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>TLS通信的协议版本。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.189.4.1.4.1.1" width="33.33333333333333%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.189.4.1.4.1.2" width="33.33333333333333%">值</th>         <th align="left" class="cellrowborder" id="mcps1.3.189.4.1.4.1.3" width="33.33333333333333%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="33.33333333333333%">TLSv12</td>         <td class="cellrowborder" width="33.33333333333333%">"TLSv1.2"</td>         <td class="cellrowborder" width="33.33333333333333%">使用TLSv1.2协议通信。</td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">TLSv13</td>         <td class="cellrowborder" width="33.33333333333333%">"TLSv1.3"</td>         <td class="cellrowborder" width="33.33333333333333%">使用TLSv1.3协议通信。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 401px;">     <h2 id="x509certrawdata9" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">X509CertRawData<sup>9+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="x509certrawdata9" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>type X509CertRawData = cert.EncodingBlob</p>     <p>存储证书的数据。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.190.5.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.190.5.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">cert.EncodingBlob</td>         <td class="cellrowborder" width="50%">提供证书编码blob类型。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 682px;">     <h2 id="socketconstructtlssocketserverinstance10" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">socket.constructTLSSocketServerInstance<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="socketconstructtlssocketserverinstance10" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>constructTLSSocketServerInstance(): TLSSocketServer</p>     <p>创建并返回一个TLSSocketServer对象。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>返回值:</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.191.6.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.191.6.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#tlssocketserver10">TLSSocketServer</a></td>         <td class="cellrowborder" width="50%">返回一个TLSSocketServer对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsServer</span>: socket.<span class="hljs-property">TLSSocketServer</span> = socket.<span class="hljs-title function_">constructTLSSocketServerInstance</span>();</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 206px;">     <h2 id="tlssocketserver10" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">TLSSocketServer<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="tlssocketserver10" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>TLSSocketServer连接。在调用TLSSocketServer的方法前，需要先通过<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#socketconstructtlssocketserverinstance10">socket.constructTLSSocketServerInstance</a>创建TLSSocketServer对象。</p>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 2223px;">     <h3 id="listen10-2" device-type="phone,2in1,tablet,wearable,lite_wearable,tv" class="firsth2">listen<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="listen10-2" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>listen(options: TLSConnectOptions, callback: AsyncCallback&lt;void&gt;): void</p>     <p>绑定IP地址和端口，在TLSSocketServer上bind成功之后，监听客户端的连接，创建和初始化TLS会话，实现建立连接过程，加载证书秘钥并验证，使用callback方式作为异步方法。</p>     <div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content">       <p>IP地址设置为0.0.0.0时，可以监听本机所有地址。</p>      </div></div></div>     <p><strong>需要权限</strong>：ohos.permission.INTERNET</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.193.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.193.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.193.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.193.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">options</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#tlsconnectoptions9">TLSConnectOptions</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">TLSSocketServer连接所需要的参数。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;void&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数，成功返回空，失败返回错误码、错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.193.10.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.193.10.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2300002</td>         <td class="cellrowborder" width="50%">System internal error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303109</td>         <td class="cellrowborder" width="50%">Bad file number.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303111</td>         <td class="cellrowborder" width="50%">Resource temporarily unavailable. Try again.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303198</td>         <td class="cellrowborder" width="50%">Address already in use.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303199</td>         <td class="cellrowborder" width="50%">Cannot assign requested address.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303501</td>         <td class="cellrowborder" width="50%">SSL is null.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303502</td>         <td class="cellrowborder" width="50%">An error occurred when reading data on the TLS socket.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303503</td>         <td class="cellrowborder" width="50%">An error occurred when writing data on the TLS socket.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303505</td>         <td class="cellrowborder" width="50%">An error occurred in the TLS system call.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303506</td>         <td class="cellrowborder" width="50%">Failed to close the TLS connection.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsServer</span>: socket.<span class="hljs-property">TLSSocketServer</span> = socket.<span class="hljs-title function_">constructTLSSocketServerInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">netAddress</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsSecureOptions</span>: socket.<span class="hljs-property">TLSSecureOptions</span> = {</li><li>  <span class="hljs-attr">key</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">cert</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">ca</span>: [<span class="hljs-string">"xxxx"</span>],</li><li>  <span class="hljs-attr">password</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">protocols</span>: socket.<span class="hljs-property">Protocol</span>.<span class="hljs-property">TLSv12</span>,</li><li>  <span class="hljs-attr">useRemoteCipherPrefer</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-attr">signatureAlgorithms</span>: <span class="hljs-string">"rsa_pss_rsae_sha256:ECDSA+SHA256"</span>,</li><li>  <span class="hljs-attr">cipherSuite</span>: <span class="hljs-string">"AES256-SHA256"</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsConnectOptions</span>: socket.<span class="hljs-property">TLSConnectOptions</span> = {</li><li>  <span class="hljs-attr">address</span>: netAddress,</li><li>  <span class="hljs-attr">secureOptions</span>: tlsSecureOptions,</li><li>  <span class="hljs-title class_">ALPNProtocols</span>: [<span class="hljs-string">"spdy/1"</span>, <span class="hljs-string">"http/1.1"</span>],</li><li>  <span class="hljs-attr">skipRemoteValidation</span>: <span class="hljs-literal">false</span></li><li>}</li><li>tlsServer.<span class="hljs-title function_">listen</span>(tlsConnectOptions, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"listen callback error"</span> + err);</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 2297px;">     <h3 id="listen10-3" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">listen<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="listen10-3" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>listen(options: TLSConnectOptions): Promise&lt;void&gt;</p>     <p>绑定IP地址和端口，在TLSSocketServer上bind成功之后，监听客户端的连接，并创建和初始化TLS会话，实现建立连接过程，加载证书秘钥并验证，使用Promise方式作为异步方法。</p>     <p><strong>需要权限</strong>：ohos.permission.INTERNET</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.194.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.194.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.194.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.194.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">options</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#tlsconnectoptions9">TLSConnectOptions</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">连接所需要的参数。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.194.9.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.194.9.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">以Promise形式返回，成功返回空，失败返回错误码，错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.194.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.194.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2300002</td>         <td class="cellrowborder" width="50%">System internal error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303109</td>         <td class="cellrowborder" width="50%">Bad file number.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303111</td>         <td class="cellrowborder" width="50%">Resource temporarily unavailable. Try again.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303198</td>         <td class="cellrowborder" width="50%">Address already in use.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303199</td>         <td class="cellrowborder" width="50%">Cannot assign requested address.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303501</td>         <td class="cellrowborder" width="50%">SSL is null.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303502</td>         <td class="cellrowborder" width="50%">An error occurred when reading data on the TLS socket.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303503</td>         <td class="cellrowborder" width="50%">An error occurred when writing data on the TLS socket.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303505</td>         <td class="cellrowborder" width="50%">An error occurred in the TLS system call.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303506</td>         <td class="cellrowborder" width="50%">Failed to close the TLS connection.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsServer</span>: socket.<span class="hljs-property">TLSSocketServer</span> = socket.<span class="hljs-title function_">constructTLSSocketServerInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">netAddress</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsSecureOptions</span>: socket.<span class="hljs-property">TLSSecureOptions</span> = {</li><li>  <span class="hljs-attr">key</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">cert</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">ca</span>: [<span class="hljs-string">"xxxx"</span>],</li><li>  <span class="hljs-attr">password</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">protocols</span>: socket.<span class="hljs-property">Protocol</span>.<span class="hljs-property">TLSv12</span>,</li><li>  <span class="hljs-attr">useRemoteCipherPrefer</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-attr">signatureAlgorithms</span>: <span class="hljs-string">"rsa_pss_rsae_sha256:ECDSA+SHA256"</span>,</li><li>  <span class="hljs-attr">cipherSuite</span>: <span class="hljs-string">"AES256-SHA256"</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsConnectOptions</span>: socket.<span class="hljs-property">TLSConnectOptions</span> = {</li><li>  <span class="hljs-attr">address</span>: netAddress,</li><li>  <span class="hljs-attr">secureOptions</span>: tlsSecureOptions,</li><li>  <span class="hljs-title class_">ALPNProtocols</span>: [<span class="hljs-string">"spdy/1"</span>, <span class="hljs-string">"http/1.1"</span>],</li><li>  <span class="hljs-attr">skipRemoteValidation</span>: <span class="hljs-literal">false</span></li><li>}</li><li>tlsServer.<span class="hljs-title function_">listen</span>(tlsConnectOptions).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"listen callback success"</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"failed: "</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1819px;">     <h3 id="getstate10-2" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">getState<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getstate10-2" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>getState(callback: AsyncCallback&lt;SocketStateBase&gt;): void</p>     <p>在TLSSocketServer的listen成功之后，获取TLSSocketServer状态。使用callback方式作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>listen方法调用成功后，才可调用此方法。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.195.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.195.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.195.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.195.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#socketstatebase">SocketStateBase</a>&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。成功返回TLSSocketServer状态，失败返回错误码、错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.195.9.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.195.9.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303188</td>         <td class="cellrowborder" width="50%">Socket operation on non-socket.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2300002</td>         <td class="cellrowborder" width="50%">System internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsServer</span>: socket.<span class="hljs-property">TLSSocketServer</span> = socket.<span class="hljs-title function_">constructTLSSocketServerInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">netAddress</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsSecureOptions</span>: socket.<span class="hljs-property">TLSSecureOptions</span> = {</li><li>  <span class="hljs-attr">key</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">cert</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">ca</span>: [<span class="hljs-string">"xxxx"</span>],</li><li>  <span class="hljs-attr">password</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">protocols</span>: socket.<span class="hljs-property">Protocol</span>.<span class="hljs-property">TLSv12</span>,</li><li>  <span class="hljs-attr">useRemoteCipherPrefer</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-attr">signatureAlgorithms</span>: <span class="hljs-string">"rsa_pss_rsae_sha256:ECDSA+SHA256"</span>,</li><li>  <span class="hljs-attr">cipherSuite</span>: <span class="hljs-string">"AES256-SHA256"</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsConnectOptions</span>: socket.<span class="hljs-property">TLSConnectOptions</span> = {</li><li>  <span class="hljs-attr">address</span>: netAddress,</li><li>  <span class="hljs-attr">secureOptions</span>: tlsSecureOptions,</li><li>  <span class="hljs-title class_">ALPNProtocols</span>: [<span class="hljs-string">"spdy/1"</span>, <span class="hljs-string">"http/1.1"</span>]</li><li>}</li><li>tlsServer.<span class="hljs-title function_">listen</span>(tlsConnectOptions).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"listen callback success"</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"failed: "</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));</li><li>});</li><li>tlsServer.<span class="hljs-title function_">getState</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError, data: socket.SocketStateBase</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'getState fail'</span>);</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'getState success:'</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data));</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1712px;">     <h3 id="getstate10-3" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">getState<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getstate10-3" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>getState(): Promise&lt;SocketStateBase&gt;</p>     <p>在TLSSocketServer的listen成功之后，获取TLSSocketServer状态。使用Promise方式作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>listen方法调用成功后，才可调用此方法。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.196.7.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.196.7.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#socketstatebase">SocketStateBase</a>&gt;</td>         <td class="cellrowborder" width="50%">以Promise形式返回获取TLSSocketServer状态的结果。失败返回错误码，错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.196.9.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.196.9.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">2303188</td>         <td class="cellrowborder" width="50%">Socket operation on non-socket.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2300002</td>         <td class="cellrowborder" width="50%">System internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsServer</span>: socket.<span class="hljs-property">TLSSocketServer</span> = socket.<span class="hljs-title function_">constructTLSSocketServerInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">netAddress</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsSecureOptions</span>: socket.<span class="hljs-property">TLSSecureOptions</span> = {</li><li>  <span class="hljs-attr">key</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">cert</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">ca</span>: [<span class="hljs-string">"xxxx"</span>],</li><li>  <span class="hljs-attr">password</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">protocols</span>: socket.<span class="hljs-property">Protocol</span>.<span class="hljs-property">TLSv12</span>,</li><li>  <span class="hljs-attr">useRemoteCipherPrefer</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-attr">signatureAlgorithms</span>: <span class="hljs-string">"rsa_pss_rsae_sha256:ECDSA+SHA256"</span>,</li><li>  <span class="hljs-attr">cipherSuite</span>: <span class="hljs-string">"AES256-SHA256"</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsConnectOptions</span>: socket.<span class="hljs-property">TLSConnectOptions</span> = {</li><li>  <span class="hljs-attr">address</span>: netAddress,</li><li>  <span class="hljs-attr">secureOptions</span>: tlsSecureOptions,</li><li>  <span class="hljs-title class_">ALPNProtocols</span>: [<span class="hljs-string">"spdy/1"</span>, <span class="hljs-string">"http/1.1"</span>]</li><li>}</li><li>tlsServer.<span class="hljs-title function_">listen</span>(tlsConnectOptions).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"listen callback success"</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"failed: "</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));</li><li>});</li><li>tlsServer.<span class="hljs-title function_">getState</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'getState success'</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'getState fail'</span>);</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 2248px;">     <h3 id="setextraoptions10-2" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">setExtraOptions<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="setextraoptions10-2" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>setExtraOptions(options: TCPExtraOptions, callback: AsyncCallback&lt;void&gt;): void</p>     <p>在TLSSocketServer的listen成功之后，设置TLSSocketServer连接的其他属性。使用callback方式作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>listen方法调用成功后，才可调用此方法。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.197.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.197.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.197.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.197.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">options</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#tcpextraoptions">TCPExtraOptions</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">TLSSocketServer连接的其他属性。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;void&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。成功返回空，失败返回错误码、错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.197.9.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.197.9.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303188</td>         <td class="cellrowborder" width="50%">Socket operation on non-socket.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2300002</td>         <td class="cellrowborder" width="50%">System internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsServer</span>: socket.<span class="hljs-property">TLSSocketServer</span> = socket.<span class="hljs-title function_">constructTLSSocketServerInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">netAddress</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsSecureOptions</span>: socket.<span class="hljs-property">TLSSecureOptions</span> = {</li><li>  <span class="hljs-attr">key</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">cert</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">ca</span>: [<span class="hljs-string">"xxxx"</span>],</li><li>  <span class="hljs-attr">password</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">protocols</span>: socket.<span class="hljs-property">Protocol</span>.<span class="hljs-property">TLSv12</span>,</li><li>  <span class="hljs-attr">useRemoteCipherPrefer</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-attr">signatureAlgorithms</span>: <span class="hljs-string">"rsa_pss_rsae_sha256:ECDSA+SHA256"</span>,</li><li>  <span class="hljs-attr">cipherSuite</span>: <span class="hljs-string">"AES256-SHA256"</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsConnectOptions</span>: socket.<span class="hljs-property">TLSConnectOptions</span> = {</li><li>  <span class="hljs-attr">address</span>: netAddress,</li><li>  <span class="hljs-attr">secureOptions</span>: tlsSecureOptions,</li><li>  <span class="hljs-title class_">ALPNProtocols</span>: [<span class="hljs-string">"spdy/1"</span>, <span class="hljs-string">"http/1.1"</span>]</li><li>}</li><li>tlsServer.<span class="hljs-title function_">listen</span>(tlsConnectOptions).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"listen callback success"</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"failed: "</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));</li><li>});</li><li>
</li><li><span class="hljs-keyword">interface</span> <span class="hljs-title class_">SocketLinger</span> {</li><li>  <span class="hljs-attr">on</span>: <span class="hljs-built_in">boolean</span>;</li><li>  <span class="hljs-attr">linger</span>: <span class="hljs-built_in">number</span>;</li><li>}</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tcpExtraOptions</span>: socket.<span class="hljs-property">TCPExtraOptions</span> = {</li><li>  <span class="hljs-attr">keepAlive</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-title class_">OOBInline</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-title class_">TCPNoDelay</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-attr">socketLinger</span>: { <span class="hljs-attr">on</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">linger</span>: <span class="hljs-number">10</span> } <span class="hljs-keyword">as</span> <span class="hljs-title class_">SocketLinger</span>,</li><li>  <span class="hljs-attr">receiveBufferSize</span>: <span class="hljs-number">8192</span>,</li><li>  <span class="hljs-attr">sendBufferSize</span>: <span class="hljs-number">8192</span>,</li><li>  <span class="hljs-attr">reuseAddress</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-attr">socketTimeout</span>: <span class="hljs-number">3000</span></li><li>}</li><li>tlsServer.<span class="hljs-title function_">setExtraOptions</span>(tcpExtraOptions, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'setExtraOptions fail'</span>);</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'setExtraOptions success'</span>);</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 2326px;">     <h3 id="setextraoptions10-3" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">setExtraOptions<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="setextraoptions10-3" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>setExtraOptions(options: TCPExtraOptions): Promise&lt;void&gt;</p>     <p>在TLSSocketServer的listen成功之后，设置TLSSocketServer连接的其他属性，使用Promise方式作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>listen方法调用成功后，才可调用此方法。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.198.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.198.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.198.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.198.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">options</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#tcpextraoptions">TCPExtraOptions</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">TLSSocketServer连接的其他属性。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.198.9.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.198.9.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">以Promise形式返回，成功返回空，失败返回错误码，错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.198.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.198.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303188</td>         <td class="cellrowborder" width="50%">Socket operation on non-socket.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2300002</td>         <td class="cellrowborder" width="50%">System internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsServer</span>: socket.<span class="hljs-property">TLSSocketServer</span> = socket.<span class="hljs-title function_">constructTLSSocketServerInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">netAddress</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsSecureOptions</span>: socket.<span class="hljs-property">TLSSecureOptions</span> = {</li><li>  <span class="hljs-attr">key</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">cert</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">ca</span>: [<span class="hljs-string">"xxxx"</span>],</li><li>  <span class="hljs-attr">password</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">protocols</span>: socket.<span class="hljs-property">Protocol</span>.<span class="hljs-property">TLSv12</span>,</li><li>  <span class="hljs-attr">useRemoteCipherPrefer</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-attr">signatureAlgorithms</span>: <span class="hljs-string">"rsa_pss_rsae_sha256:ECDSA+SHA256"</span>,</li><li>  <span class="hljs-attr">cipherSuite</span>: <span class="hljs-string">"AES256-SHA256"</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsConnectOptions</span>: socket.<span class="hljs-property">TLSConnectOptions</span> = {</li><li>  <span class="hljs-attr">address</span>: netAddress,</li><li>  <span class="hljs-attr">secureOptions</span>: tlsSecureOptions,</li><li>  <span class="hljs-title class_">ALPNProtocols</span>: [<span class="hljs-string">"spdy/1"</span>, <span class="hljs-string">"http/1.1"</span>]</li><li>}</li><li>tlsServer.<span class="hljs-title function_">listen</span>(tlsConnectOptions).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"listen callback success"</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"failed: "</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));</li><li>});</li><li>
</li><li><span class="hljs-keyword">interface</span> <span class="hljs-title class_">SocketLinger</span> {</li><li>  <span class="hljs-attr">on</span>: <span class="hljs-built_in">boolean</span>;</li><li>  <span class="hljs-attr">linger</span>: <span class="hljs-built_in">number</span>;</li><li>}</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tcpExtraOptions</span>: socket.<span class="hljs-property">TCPExtraOptions</span> = {</li><li>  <span class="hljs-attr">keepAlive</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-title class_">OOBInline</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-title class_">TCPNoDelay</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-attr">socketLinger</span>: { <span class="hljs-attr">on</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">linger</span>: <span class="hljs-number">10</span> } <span class="hljs-keyword">as</span> <span class="hljs-title class_">SocketLinger</span>,</li><li>  <span class="hljs-attr">receiveBufferSize</span>: <span class="hljs-number">8192</span>,</li><li>  <span class="hljs-attr">sendBufferSize</span>: <span class="hljs-number">8192</span>,</li><li>  <span class="hljs-attr">reuseAddress</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-attr">socketTimeout</span>: <span class="hljs-number">3000</span></li><li>}</li><li>tlsServer.<span class="hljs-title function_">setExtraOptions</span>(tcpExtraOptions).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'setExtraOptions success'</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'setExtraOptions fail'</span>);</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1946px;">     <h3 id="getcertificate10" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">getCertificate<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getcertificate10" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>getCertificate(callback: AsyncCallback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#x509certrawdata9">X509CertRawData</a>&gt;): void</p>     <p>在TLSSocketServer通信连接成功之后，获取本地的数字证书，使用callback方式作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>listen方法调用成功后，才可调用此方法。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.199.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.199.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.199.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.199.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#x509certrawdata9">X509CertRawData</a>&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数，成功返回本地的证书，失败返回错误码、错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.199.9.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.199.9.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303501</td>         <td class="cellrowborder" width="50%">SSL is null.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303504</td>         <td class="cellrowborder" width="50%">An error occurred when verifying the X.509 certificate.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2300002</td>         <td class="cellrowborder" width="50%">System internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { util } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkTS'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsServer</span>: socket.<span class="hljs-property">TLSSocketServer</span> = socket.<span class="hljs-title function_">constructTLSSocketServerInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">netAddress</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsSecureOptions</span>: socket.<span class="hljs-property">TLSSecureOptions</span> = {</li><li>  <span class="hljs-attr">key</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">cert</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">ca</span>: [<span class="hljs-string">"xxxx"</span>],</li><li>  <span class="hljs-attr">password</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">protocols</span>: socket.<span class="hljs-property">Protocol</span>.<span class="hljs-property">TLSv12</span>,</li><li>  <span class="hljs-attr">useRemoteCipherPrefer</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-attr">signatureAlgorithms</span>: <span class="hljs-string">"rsa_pss_rsae_sha256:ECDSA+SHA256"</span>,</li><li>  <span class="hljs-attr">cipherSuite</span>: <span class="hljs-string">"AES256-SHA256"</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsConnectOptions</span>: socket.<span class="hljs-property">TLSConnectOptions</span> = {</li><li>  <span class="hljs-attr">address</span>: netAddress,</li><li>  <span class="hljs-attr">secureOptions</span>: tlsSecureOptions,</li><li>  <span class="hljs-title class_">ALPNProtocols</span>: [<span class="hljs-string">"spdy/1"</span>, <span class="hljs-string">"http/1.1"</span>]</li><li>}</li><li>tlsServer.<span class="hljs-title function_">listen</span>(tlsConnectOptions).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"listen callback success"</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"failed: "</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));</li><li>});</li><li>tlsServer.<span class="hljs-title function_">getCertificate</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError, data: socket.X509CertRawData</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"getCertificate callback error = "</span> + err);</li><li>  } <span class="hljs-keyword">else</span> {</li><li>    <span class="hljs-keyword">const</span> decoder = util.<span class="hljs-property">TextDecoder</span>.<span class="hljs-title function_">create</span>();</li><li>    <span class="hljs-keyword">const</span> str = decoder.<span class="hljs-title function_">decodeToString</span>(data.<span class="hljs-property">data</span>);</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"getCertificate callback: "</span> + str);</li><li>  }</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1839px;">     <h3 id="getcertificate10-1" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">getCertificate<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getcertificate10-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>getCertificate():Promise&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#x509certrawdata9">X509CertRawData</a>&gt;</p>     <p>在TLSSocketServer通信连接之后，获取本地的数字证书，使用Promise方式作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>listen方法调用成功后，才可调用此方法。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.200.7.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.200.7.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#x509certrawdata9">X509CertRawData</a>&gt;</td>         <td class="cellrowborder" width="50%">以Promise形式返回本地的数字证书的结果。失败返回错误码，错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.200.9.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.200.9.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">2303501</td>         <td class="cellrowborder" width="50%">SSL is null.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303504</td>         <td class="cellrowborder" width="50%">An error occurred when verifying the X.509 certificate.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2300002</td>         <td class="cellrowborder" width="50%">System internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { util } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkTS'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsServer</span>: socket.<span class="hljs-property">TLSSocketServer</span> = socket.<span class="hljs-title function_">constructTLSSocketServerInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">netAddress</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsSecureOptions</span>: socket.<span class="hljs-property">TLSSecureOptions</span> = {</li><li>  <span class="hljs-attr">key</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">cert</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">ca</span>: [<span class="hljs-string">"xxxx"</span>],</li><li>  <span class="hljs-attr">password</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">protocols</span>: socket.<span class="hljs-property">Protocol</span>.<span class="hljs-property">TLSv12</span>,</li><li>  <span class="hljs-attr">useRemoteCipherPrefer</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-attr">signatureAlgorithms</span>: <span class="hljs-string">"rsa_pss_rsae_sha256:ECDSA+SHA256"</span>,</li><li>  <span class="hljs-attr">cipherSuite</span>: <span class="hljs-string">"AES256-SHA256"</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsConnectOptions</span>: socket.<span class="hljs-property">TLSConnectOptions</span> = {</li><li>  <span class="hljs-attr">address</span>: netAddress,</li><li>  <span class="hljs-attr">secureOptions</span>: tlsSecureOptions,</li><li>  <span class="hljs-title class_">ALPNProtocols</span>: [<span class="hljs-string">"spdy/1"</span>, <span class="hljs-string">"http/1.1"</span>]</li><li>}</li><li>tlsServer.<span class="hljs-title function_">listen</span>(tlsConnectOptions).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"listen callback success"</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"failed: "</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));</li><li>});</li><li>tlsServer.<span class="hljs-title function_">getCertificate</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">data: socket.X509CertRawData</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">const</span> decoder = util.<span class="hljs-property">TextDecoder</span>.<span class="hljs-title function_">create</span>();</li><li>  <span class="hljs-keyword">const</span> str = decoder.<span class="hljs-title function_">decodeToString</span>(data.<span class="hljs-property">data</span>);</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"getCertificate: "</span> + str);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"failed"</span> + err);</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1874px;">     <h3 id="getprotocol10" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">getProtocol<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getprotocol10" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>getProtocol(callback: AsyncCallback&lt;string&gt;): void</p>     <p>在TLSSocketServer通信连接成功之后，获取通信的协议版本，使用callback方式作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>listen方法调用成功后，才可调用此方法。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.201.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.201.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.201.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.201.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;string&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数，返回通信的协议。失败返回错误码、错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.201.9.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.201.9.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303501</td>         <td class="cellrowborder" width="50%">SSL is null.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303505</td>         <td class="cellrowborder" width="50%">An error occurred in the TLS system call.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2300002</td>         <td class="cellrowborder" width="50%">System internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsServer</span>: socket.<span class="hljs-property">TLSSocketServer</span> = socket.<span class="hljs-title function_">constructTLSSocketServerInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">netAddress</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsSecureOptions</span>: socket.<span class="hljs-property">TLSSecureOptions</span> = {</li><li>  <span class="hljs-attr">key</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">cert</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">ca</span>: [<span class="hljs-string">"xxxx"</span>],</li><li>  <span class="hljs-attr">password</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">protocols</span>: socket.<span class="hljs-property">Protocol</span>.<span class="hljs-property">TLSv12</span>,</li><li>  <span class="hljs-attr">useRemoteCipherPrefer</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-attr">signatureAlgorithms</span>: <span class="hljs-string">"rsa_pss_rsae_sha256:ECDSA+SHA256"</span>,</li><li>  <span class="hljs-attr">cipherSuite</span>: <span class="hljs-string">"AES256-SHA256"</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsConnectOptions</span>: socket.<span class="hljs-property">TLSConnectOptions</span> = {</li><li>  <span class="hljs-attr">address</span>: netAddress,</li><li>  <span class="hljs-attr">secureOptions</span>: tlsSecureOptions,</li><li>  <span class="hljs-title class_">ALPNProtocols</span>: [<span class="hljs-string">"spdy/1"</span>, <span class="hljs-string">"http/1.1"</span>]</li><li>}</li><li>tlsServer.<span class="hljs-title function_">listen</span>(tlsConnectOptions).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"listen callback success"</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"failed: "</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));</li><li>});</li><li>tlsServer.<span class="hljs-title function_">getProtocol</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError, data: <span class="hljs-built_in">string</span></span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"getProtocol callback error = "</span> + err);</li><li>  } <span class="hljs-keyword">else</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"getProtocol callback = "</span> + data);</li><li>  }</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1767px;">     <h3 id="getprotocol10-1" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">getProtocol<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getprotocol10-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>getProtocol():Promise&lt;string&gt;</p>     <p>在TLSSocketServer通信连接成功之后，获取通信的协议版本，使用Promise方式作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>listen方法调用成功后，才可调用此方法。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.202.7.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.202.7.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;string&gt;</td>         <td class="cellrowborder" width="50%">以Promise形式返回通信的协议。失败返回错误码，错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.202.9.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.202.9.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">2303501</td>         <td class="cellrowborder" width="50%">SSL is null.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303505</td>         <td class="cellrowborder" width="50%">An error occurred in the TLS system call.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2300002</td>         <td class="cellrowborder" width="50%">System internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsServer</span>: socket.<span class="hljs-property">TLSSocketServer</span> = socket.<span class="hljs-title function_">constructTLSSocketServerInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">netAddress</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsSecureOptions</span>: socket.<span class="hljs-property">TLSSecureOptions</span> = {</li><li>  <span class="hljs-attr">key</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">cert</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">ca</span>: [<span class="hljs-string">"xxxx"</span>],</li><li>  <span class="hljs-attr">password</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">protocols</span>: socket.<span class="hljs-property">Protocol</span>.<span class="hljs-property">TLSv12</span>,</li><li>  <span class="hljs-attr">useRemoteCipherPrefer</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-attr">signatureAlgorithms</span>: <span class="hljs-string">"rsa_pss_rsae_sha256:ECDSA+SHA256"</span>,</li><li>  <span class="hljs-attr">cipherSuite</span>: <span class="hljs-string">"AES256-SHA256"</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsConnectOptions</span>: socket.<span class="hljs-property">TLSConnectOptions</span> = {</li><li>  <span class="hljs-attr">address</span>: netAddress,</li><li>  <span class="hljs-attr">secureOptions</span>: tlsSecureOptions,</li><li>  <span class="hljs-title class_">ALPNProtocols</span>: [<span class="hljs-string">"spdy/1"</span>, <span class="hljs-string">"http/1.1"</span>]</li><li>}</li><li>tlsServer.<span class="hljs-title function_">listen</span>(tlsConnectOptions).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"listen callback success"</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"failed: "</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));</li><li>});</li><li>tlsServer.<span class="hljs-title function_">getProtocol</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">data: <span class="hljs-built_in">string</span></span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(data);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"failed"</span> + err);</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1167px;">     <h3 id="getlocaladdress12-8" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">getLocalAddress<sup>12+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getlocaladdress12-8" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>getLocalAddress(): Promise&lt;NetAddress&gt;</p>     <p>获取TLSSocketServer的本地Socket地址。使用Promise方式作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>在TLSSocketServer通信连接成功之后，才可调用此方法。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.203.7.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.203.7.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#netaddress">NetAddress</a>&gt;</td>         <td class="cellrowborder" width="50%">以Promise形式返回获取本地socket地址的结果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.203.9.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.203.9.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">2300002</td>         <td class="cellrowborder" width="50%">System internal error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301009</td>         <td class="cellrowborder" width="50%">Bad file descriptor.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303188</td>         <td class="cellrowborder" width="50%">Socket operation on non-socket.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsServer</span>: socket.<span class="hljs-property">TLSSocket</span> = socket.<span class="hljs-title function_">constructTLSSocketServerInstance</span>();</li><li>tlsServer.<span class="hljs-title function_">getLocalAddress</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">localAddress: socket.NetAddress</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"Get success: "</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(localAddress));</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"Get failed, error: "</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));</li><li>})</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1658px;">     <h3 id="onconnect10-1" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">on('connect')<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onconnect10-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>on(type: 'connect', callback: Callback&lt;TLSSocketConnection&gt;): void</p>     <p>订阅TLSSocketServer的连接事件。使用callback方式作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>listen方法调用成功后，才可调用此方法。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.204.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.204.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.204.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.204.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">订阅的事件类型。'connect'：连接事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#tlssocketconnection10">TLSSocketConnection</a>&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。失败时返回错误码、错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.204.9.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.204.9.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsServer</span>: socket.<span class="hljs-property">TLSSocketServer</span> = socket.<span class="hljs-title function_">constructTLSSocketServerInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">netAddress</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsSecureOptions</span>: socket.<span class="hljs-property">TLSSecureOptions</span> = {</li><li>  <span class="hljs-attr">key</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">cert</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">ca</span>: [<span class="hljs-string">"xxxx"</span>],</li><li>  <span class="hljs-attr">password</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">protocols</span>: socket.<span class="hljs-property">Protocol</span>.<span class="hljs-property">TLSv12</span>,</li><li>  <span class="hljs-attr">useRemoteCipherPrefer</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-attr">signatureAlgorithms</span>: <span class="hljs-string">"rsa_pss_rsae_sha256:ECDSA+SHA256"</span>,</li><li>  <span class="hljs-attr">cipherSuite</span>: <span class="hljs-string">"AES256-SHA256"</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsConnectOptions</span>: socket.<span class="hljs-property">TLSConnectOptions</span> = {</li><li>  <span class="hljs-attr">address</span>: netAddress,</li><li>  <span class="hljs-attr">secureOptions</span>: tlsSecureOptions,</li><li>  <span class="hljs-title class_">ALPNProtocols</span>: [<span class="hljs-string">"spdy/1"</span>, <span class="hljs-string">"http/1.1"</span>]</li><li>}</li><li>tlsServer.<span class="hljs-title function_">listen</span>(tlsConnectOptions).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"listen callback success"</span>);</li><li>  tlsServer.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connect'</span>, <span class="hljs-function">(<span class="hljs-params">data: socket.TLSSocketConnection</span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data));</li><li>  });</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"failed: "</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1802px;">     <h3 id="offconnect10-1" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">off('connect')<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="offconnect10-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>off(type: 'connect', callback?: Callback&lt;TLSSocketConnection&gt;): void</p>     <p>取消订阅TLSSocketServer的连接事件。使用callback方式作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>listen方法调用成功后，才可调用此方法。</p>       <p>可以指定传入on中的callback取消一个订阅，也可以不指定callback清空所有订阅。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.205.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.205.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.205.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.205.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">订阅的事件类型。'connect'：连接事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#tlssocketconnection10">TLSSocketConnection</a>&gt;</td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">回调函数。失败时返回错误码、错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.205.9.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.205.9.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsServer</span>: socket.<span class="hljs-property">TLSSocketServer</span> = socket.<span class="hljs-title function_">constructTLSSocketServerInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">netAddress</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsSecureOptions</span>: socket.<span class="hljs-property">TLSSecureOptions</span> = {</li><li>  <span class="hljs-attr">key</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">cert</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">ca</span>: [<span class="hljs-string">"xxxx"</span>],</li><li>  <span class="hljs-attr">password</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">protocols</span>: socket.<span class="hljs-property">Protocol</span>.<span class="hljs-property">TLSv12</span>,</li><li>  <span class="hljs-attr">useRemoteCipherPrefer</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-attr">signatureAlgorithms</span>: <span class="hljs-string">"rsa_pss_rsae_sha256:ECDSA+SHA256"</span>,</li><li>  <span class="hljs-attr">cipherSuite</span>: <span class="hljs-string">"AES256-SHA256"</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsConnectOptions</span>: socket.<span class="hljs-property">TLSConnectOptions</span> = {</li><li>  <span class="hljs-attr">address</span>: netAddress,</li><li>  <span class="hljs-attr">secureOptions</span>: tlsSecureOptions,</li><li>  <span class="hljs-title class_">ALPNProtocols</span>: [<span class="hljs-string">"spdy/1"</span>, <span class="hljs-string">"http/1.1"</span>]</li><li>}</li><li>tlsServer.<span class="hljs-title function_">listen</span>(tlsConnectOptions).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"listen callback success"</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"failed: "</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));</li><li>});</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-title function_">callback</span> = (<span class="hljs-params">data: socket.TLSSocketConnection</span>) =&gt; {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'on connect message: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data));</li><li>}</li><li>tlsServer.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connect'</span>, callback);</li><li><span class="hljs-comment">// 可以指定传入on中的callback取消一个订阅，也可以不指定callback清空所有订阅。</span></li><li>tlsServer.<span class="hljs-title function_">off</span>(<span class="hljs-string">'connect'</span>, callback);</li><li>tlsServer.<span class="hljs-title function_">off</span>(<span class="hljs-string">'connect'</span>);</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1658px;">     <h3 id="onerror10-2" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">on('error')<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onerror10-2" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>on(type: 'error', callback: ErrorCallback): void</p>     <p>订阅TLSSocketServer连接的error事件。使用callback方式作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>listen方法调用成功后，才可调用此方法。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.206.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.206.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.206.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.206.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">订阅的事件类型。'error'：error事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">ErrorCallback</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。失败时返回错误码、错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.206.9.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.206.9.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsServer</span>: socket.<span class="hljs-property">TLSSocketServer</span> = socket.<span class="hljs-title function_">constructTLSSocketServerInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">netAddress</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsSecureOptions</span>: socket.<span class="hljs-property">TLSSecureOptions</span> = {</li><li>  <span class="hljs-attr">key</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">cert</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">ca</span>: [<span class="hljs-string">"xxxx"</span>],</li><li>  <span class="hljs-attr">password</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">protocols</span>: socket.<span class="hljs-property">Protocol</span>.<span class="hljs-property">TLSv12</span>,</li><li>  <span class="hljs-attr">useRemoteCipherPrefer</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-attr">signatureAlgorithms</span>: <span class="hljs-string">"rsa_pss_rsae_sha256:ECDSA+SHA256"</span>,</li><li>  <span class="hljs-attr">cipherSuite</span>: <span class="hljs-string">"AES256-SHA256"</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsConnectOptions</span>: socket.<span class="hljs-property">TLSConnectOptions</span> = {</li><li>  <span class="hljs-attr">address</span>: netAddress,</li><li>  <span class="hljs-attr">secureOptions</span>: tlsSecureOptions,</li><li>  <span class="hljs-title class_">ALPNProtocols</span>: [<span class="hljs-string">"spdy/1"</span>, <span class="hljs-string">"http/1.1"</span>]</li><li>}</li><li>tlsServer.<span class="hljs-title function_">listen</span>(tlsConnectOptions).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"listen callback success"</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"failed: "</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));</li><li>});</li><li>tlsServer.<span class="hljs-title function_">on</span>(<span class="hljs-string">'error'</span>, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"on error, err:"</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err))</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1802px;">     <h3 id="offerror10-2" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">off('error')<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="offerror10-2" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>off(type: 'error', callback?: ErrorCallback): void</p>     <p>取消订阅TLSSocketServer连接的error事件。使用callback方式作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>listen方法调用成功后，才可调用此方法。</p>       <p>可以指定传入on中的callback取消一个订阅，也可以不指定callback清空所有订阅。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.207.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.207.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.207.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.207.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">订阅的事件类型。'error'：error事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">ErrorCallback</td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">回调函数。失败时返回错误码、错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.207.9.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.207.9.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsServer</span>: socket.<span class="hljs-property">TLSSocketServer</span> = socket.<span class="hljs-title function_">constructTLSSocketServerInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">netAddress</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsSecureOptions</span>: socket.<span class="hljs-property">TLSSecureOptions</span> = {</li><li>  <span class="hljs-attr">key</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">cert</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">ca</span>: [<span class="hljs-string">"xxxx"</span>],</li><li>  <span class="hljs-attr">password</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">protocols</span>: socket.<span class="hljs-property">Protocol</span>.<span class="hljs-property">TLSv12</span>,</li><li>  <span class="hljs-attr">useRemoteCipherPrefer</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-attr">signatureAlgorithms</span>: <span class="hljs-string">"rsa_pss_rsae_sha256:ECDSA+SHA256"</span>,</li><li>  <span class="hljs-attr">cipherSuite</span>: <span class="hljs-string">"AES256-SHA256"</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsConnectOptions</span>: socket.<span class="hljs-property">TLSConnectOptions</span> = {</li><li>  <span class="hljs-attr">address</span>: netAddress,</li><li>  <span class="hljs-attr">secureOptions</span>: tlsSecureOptions,</li><li>  <span class="hljs-title class_">ALPNProtocols</span>: [<span class="hljs-string">"spdy/1"</span>, <span class="hljs-string">"http/1.1"</span>]</li><li>}</li><li>tlsServer.<span class="hljs-title function_">listen</span>(tlsConnectOptions).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"listen callback success"</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"failed: "</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));</li><li>});</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-title function_">callback</span> = (<span class="hljs-params">err: BusinessError</span>) =&gt; {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"on error, err:"</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));</li><li>}</li><li>tlsServer.<span class="hljs-title function_">on</span>(<span class="hljs-string">'error'</span>, callback);</li><li><span class="hljs-comment">// 可以指定传入on中的callback取消一个订阅，也可以不指定callback清空所有订阅。</span></li><li>tlsServer.<span class="hljs-title function_">off</span>(<span class="hljs-string">'error'</span>, callback);</li><li>tlsServer.<span class="hljs-title function_">off</span>(<span class="hljs-string">'error'</span>);</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1808px;">     <h3 id="close20-2" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">close<sup>20+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="close20-2" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>close(): Promise&lt;void&gt;</p>     <p>TLSSocketServer停止监听并释放通过<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#listen10-2">listen</a>方法绑定的端口。使用Promise异步回调。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>该方法不会关闭已有连接。如需关闭，请调用<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#tlssocketconnection10">TLSSocketConnection</a>的<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#close10-2">close</a>方法。</p>      </div></div></div>     <p><strong>需要权限</strong>：ohos.permission.INTERNET</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.208.8.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.208.8.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">Promise对象，无返回结果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-net-socket">Socket错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.208.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.208.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2300002</td>         <td class="cellrowborder" width="50%">System internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsServer</span>: socket.<span class="hljs-property">TLSSocketServer</span> = socket.<span class="hljs-title function_">constructTLSSocketServerInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">netAddress</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsSecureOptions</span>: socket.<span class="hljs-property">TLSSecureOptions</span> = {</li><li>  <span class="hljs-attr">key</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">cert</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">ca</span>: [<span class="hljs-string">"xxxx"</span>],</li><li>  <span class="hljs-attr">password</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">protocols</span>: socket.<span class="hljs-property">Protocol</span>.<span class="hljs-property">TLSv12</span>,</li><li>  <span class="hljs-attr">useRemoteCipherPrefer</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-attr">signatureAlgorithms</span>: <span class="hljs-string">"rsa_pss_rsae_sha256:ECDSA+SHA256"</span>,</li><li>  <span class="hljs-attr">cipherSuite</span>: <span class="hljs-string">"AES256-SHA256"</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsConnectOptions</span>: socket.<span class="hljs-property">TLSConnectOptions</span> = {</li><li>  <span class="hljs-attr">address</span>: netAddress,</li><li>  <span class="hljs-attr">secureOptions</span>: tlsSecureOptions,</li><li>  <span class="hljs-title class_">ALPNProtocols</span>: [<span class="hljs-string">"spdy/1"</span>, <span class="hljs-string">"http/1.1"</span>]</li><li>}</li><li>tlsServer.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connect'</span>, <span class="hljs-function">(<span class="hljs-params">connection: socket.TLSSocketConnection</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"connection clientId: "</span> + connection.<span class="hljs-property">clientId</span>);</li><li>  <span class="hljs-comment">// 逻辑处理</span></li><li>  tlsServer.<span class="hljs-title function_">close</span>(); <span class="hljs-comment">// 停止监听</span></li><li>  connection.<span class="hljs-title function_">close</span>(); <span class="hljs-comment">// 关闭当前连接</span></li><li>});</li><li>tlsServer.<span class="hljs-title function_">listen</span>(tlsConnectOptions).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"listen callback success"</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"listen failed: "</span> + err.<span class="hljs-property">code</span>);</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 346px;">     <h2 id="tlssocketconnection10" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">TLSSocketConnection<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="tlssocketconnection10" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>TLSSocketConnection连接，即TLSSocket客户端与服务端的连接。在调用TLSSocketConnection的方法前，需要先获取TLSSocketConnection对象。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>客户端与服务端成功建立连接后，才能通过返回的TLSSocketConnection对象调用相应的接口。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 207px;">     <h3 id="属性-2" class="firsth2">属性<i class="anchor-icon anchor-icon-link" anchorid="属性-2" tips="复制节点链接"></i></h3>          <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.210.2.1.6.1.1" width="20%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.210.2.1.6.1.2" width="20%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.210.2.1.6.1.3" width="20%">只读</th>         <th align="left" class="cellrowborder" id="mcps1.3.210.2.1.6.1.4" width="20%">可选</th>         <th align="left" class="cellrowborder" id="mcps1.3.210.2.1.6.1.5" width="20%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">clientId</td>         <td class="cellrowborder" width="20%">number</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">客户端与TLSSocketServer建立连接的id。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 2009px;">     <h3 id="send10-2" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">send<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="send10-2" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>send(data: string | ArrayBuffer, callback: AsyncCallback&lt;void&gt;): void</p>     <p>在TLSSocketServer通信连接成功之后，向客户端发送消息，使用callback方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.211.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.211.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.211.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.211.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">data</td>         <td class="cellrowborder" width="25%">string | ArrayBuffer</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">TLSSocketServer发送数据所需要的参数。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;void&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数，成功返回空，失败返回错误码、错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.211.8.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.211.8.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303501</td>         <td class="cellrowborder" width="50%">SSL is null.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303503</td>         <td class="cellrowborder" width="50%">An error occurred when writing data on the TLS socket.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303505</td>         <td class="cellrowborder" width="50%">An error occurred in the TLS system call.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303506</td>         <td class="cellrowborder" width="50%">Failed to close the TLS connection.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2300002</td>         <td class="cellrowborder" width="50%">System internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsServer</span>: socket.<span class="hljs-property">TLSSocketServer</span> = socket.<span class="hljs-title function_">constructTLSSocketServerInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">netAddress</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsSecureOptions</span>: socket.<span class="hljs-property">TLSSecureOptions</span> = {</li><li>  <span class="hljs-attr">key</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">cert</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">ca</span>: [<span class="hljs-string">"xxxx"</span>],</li><li>  <span class="hljs-attr">password</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">protocols</span>: socket.<span class="hljs-property">Protocol</span>.<span class="hljs-property">TLSv12</span>,</li><li>  <span class="hljs-attr">useRemoteCipherPrefer</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-attr">signatureAlgorithms</span>: <span class="hljs-string">"rsa_pss_rsae_sha256:ECDSA+SHA256"</span>,</li><li>  <span class="hljs-attr">cipherSuite</span>: <span class="hljs-string">"AES256-SHA256"</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsConnectOptions</span>: socket.<span class="hljs-property">TLSConnectOptions</span> = {</li><li>  <span class="hljs-attr">address</span>: netAddress,</li><li>  <span class="hljs-attr">secureOptions</span>: tlsSecureOptions,</li><li>  <span class="hljs-title class_">ALPNProtocols</span>: [<span class="hljs-string">"spdy/1"</span>, <span class="hljs-string">"http/1.1"</span>]</li><li>}</li><li>tlsServer.<span class="hljs-title function_">listen</span>(tlsConnectOptions).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"listen callback success"</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"failed"</span> + err);</li><li>});</li><li>
</li><li>tlsServer.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connect'</span>, <span class="hljs-function">(<span class="hljs-params">client: socket.TLSSocketConnection</span>) =&gt;</span> {</li><li>  client.<span class="hljs-title function_">send</span>(<span class="hljs-string">'Hello, client!'</span>, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>    <span class="hljs-keyword">if</span> (err) {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'send fail'</span>);</li><li>      <span class="hljs-keyword">return</span>;</li><li>    }</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'send success'</span>);</li><li>  });</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 2087px;">     <h3 id="send10-3" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">send<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="send10-3" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>send(data: string | ArrayBuffer): Promise&lt;void&gt;</p>     <p>在TLSSocketServer通信连接成功之后，向服务端发送消息，使用Promise方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.212.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.212.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.212.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.212.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">data</td>         <td class="cellrowborder" width="25%">string | ArrayBuffer</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">TLSSocketServer发送数据所需要的参数。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.212.8.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.212.8.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">以Promise形式返回，成功返回空，失败返回错误码，错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.212.10.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.212.10.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303501</td>         <td class="cellrowborder" width="50%">SSL is null.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303503</td>         <td class="cellrowborder" width="50%">An error occurred when writing data on the TLS socket.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303505</td>         <td class="cellrowborder" width="50%">An error occurred in the TLS system call.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303506</td>         <td class="cellrowborder" width="50%">Failed to close the TLS connection.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2300002</td>         <td class="cellrowborder" width="50%">System internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsServer</span>: socket.<span class="hljs-property">TLSSocketServer</span> = socket.<span class="hljs-title function_">constructTLSSocketServerInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">netAddress</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsSecureOptions</span>: socket.<span class="hljs-property">TLSSecureOptions</span> = {</li><li>  <span class="hljs-attr">key</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">cert</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">ca</span>: [<span class="hljs-string">"xxxx"</span>],</li><li>  <span class="hljs-attr">password</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">protocols</span>: socket.<span class="hljs-property">Protocol</span>.<span class="hljs-property">TLSv12</span>,</li><li>  <span class="hljs-attr">useRemoteCipherPrefer</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-attr">signatureAlgorithms</span>: <span class="hljs-string">"rsa_pss_rsae_sha256:ECDSA+SHA256"</span>,</li><li>  <span class="hljs-attr">cipherSuite</span>: <span class="hljs-string">"AES256-SHA256"</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsConnectOptions</span>: socket.<span class="hljs-property">TLSConnectOptions</span> = {</li><li>  <span class="hljs-attr">address</span>: netAddress,</li><li>  <span class="hljs-attr">secureOptions</span>: tlsSecureOptions,</li><li>  <span class="hljs-title class_">ALPNProtocols</span>: [<span class="hljs-string">"spdy/1"</span>, <span class="hljs-string">"http/1.1"</span>]</li><li>}</li><li>tlsServer.<span class="hljs-title function_">listen</span>(tlsConnectOptions).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"listen callback success"</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"failed"</span> + err);</li><li>});</li><li>
</li><li>tlsServer.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connect'</span>, <span class="hljs-function">(<span class="hljs-params">client: socket.TLSSocketConnection</span>) =&gt;</span> {</li><li>  client.<span class="hljs-title function_">send</span>(<span class="hljs-string">'Hello, client!'</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'send success'</span>);</li><li>  }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'send fail'</span>);</li><li>  });</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1885px;">     <h3 id="close10-2" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">close<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="close10-2" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>close(callback: AsyncCallback&lt;void&gt;): void</p>     <p>在与TLSSocketServer通信连接成功之后，断开连接，使用callback方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.213.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.213.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.213.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.213.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;void&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数，成功返回空，失败返回错误码、错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.213.8.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.213.8.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303501</td>         <td class="cellrowborder" width="50%">SSL is null.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303505</td>         <td class="cellrowborder" width="50%">An error occurred in the TLS system call.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303506</td>         <td class="cellrowborder" width="50%">Failed to close the TLS connection.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2300002</td>         <td class="cellrowborder" width="50%">System internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsServer</span>: socket.<span class="hljs-property">TLSSocketServer</span> = socket.<span class="hljs-title function_">constructTLSSocketServerInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">netAddress</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsSecureOptions</span>: socket.<span class="hljs-property">TLSSecureOptions</span> = {</li><li>  <span class="hljs-attr">key</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">cert</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">ca</span>: [<span class="hljs-string">"xxxx"</span>],</li><li>  <span class="hljs-attr">password</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">protocols</span>: socket.<span class="hljs-property">Protocol</span>.<span class="hljs-property">TLSv12</span>,</li><li>  <span class="hljs-attr">useRemoteCipherPrefer</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-attr">signatureAlgorithms</span>: <span class="hljs-string">"rsa_pss_rsae_sha256:ECDSA+SHA256"</span>,</li><li>  <span class="hljs-attr">cipherSuite</span>: <span class="hljs-string">"AES256-SHA256"</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsConnectOptions</span>: socket.<span class="hljs-property">TLSConnectOptions</span> = {</li><li>  <span class="hljs-attr">address</span>: netAddress,</li><li>  <span class="hljs-attr">secureOptions</span>: tlsSecureOptions,</li><li>  <span class="hljs-title class_">ALPNProtocols</span>: [<span class="hljs-string">"spdy/1"</span>, <span class="hljs-string">"http/1.1"</span>]</li><li>}</li><li>tlsServer.<span class="hljs-title function_">listen</span>(tlsConnectOptions).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"listen callback success"</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"failed"</span> + err);</li><li>});</li><li>
</li><li>tlsServer.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connect'</span>, <span class="hljs-function">(<span class="hljs-params">client: socket.TLSSocketConnection</span>) =&gt;</span> {</li><li>  client.<span class="hljs-title function_">close</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>    <span class="hljs-keyword">if</span> (err) {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'close fail'</span>);</li><li>      <span class="hljs-keyword">return</span>;</li><li>    }</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'close success'</span>);</li><li>  });</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1778px;">     <h3 id="close10-3" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">close<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="close10-3" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>close(): Promise&lt;void&gt;</p>     <p>在与TLSSocketServer通信连接成功之后，断开连接，使用Promise方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.214.6.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.214.6.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">以Promise形式返回，成功返回空。失败返回错误码，错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.214.8.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.214.8.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">2303501</td>         <td class="cellrowborder" width="50%">SSL is null.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303505</td>         <td class="cellrowborder" width="50%">An error occurred in the TLS system call.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303506</td>         <td class="cellrowborder" width="50%">Failed to close the TLS connection.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2300002</td>         <td class="cellrowborder" width="50%">System internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsServer</span>: socket.<span class="hljs-property">TLSSocketServer</span> = socket.<span class="hljs-title function_">constructTLSSocketServerInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">netAddress</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsSecureOptions</span>: socket.<span class="hljs-property">TLSSecureOptions</span> = {</li><li>  <span class="hljs-attr">key</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">cert</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">ca</span>: [<span class="hljs-string">"xxxx"</span>],</li><li>  <span class="hljs-attr">password</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">protocols</span>: socket.<span class="hljs-property">Protocol</span>.<span class="hljs-property">TLSv12</span>,</li><li>  <span class="hljs-attr">useRemoteCipherPrefer</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-attr">signatureAlgorithms</span>: <span class="hljs-string">"rsa_pss_rsae_sha256:ECDSA+SHA256"</span>,</li><li>  <span class="hljs-attr">cipherSuite</span>: <span class="hljs-string">"AES256-SHA256"</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsConnectOptions</span>: socket.<span class="hljs-property">TLSConnectOptions</span> = {</li><li>  <span class="hljs-attr">address</span>: netAddress,</li><li>  <span class="hljs-attr">secureOptions</span>: tlsSecureOptions,</li><li>  <span class="hljs-title class_">ALPNProtocols</span>: [<span class="hljs-string">"spdy/1"</span>, <span class="hljs-string">"http/1.1"</span>]</li><li>}</li><li>tlsServer.<span class="hljs-title function_">listen</span>(tlsConnectOptions).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"listen callback success"</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"failed"</span> + err);</li><li>});</li><li>tlsServer.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connect'</span>, <span class="hljs-function">(<span class="hljs-params">client: socket.TLSSocketConnection</span>) =&gt;</span> {</li><li>  client.<span class="hljs-title function_">close</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'close success'</span>);</li><li>  }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'close fail'</span>);</li><li>  });</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1775px;">     <h3 id="getremoteaddress10-2" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">getRemoteAddress<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getremoteaddress10-2" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>getRemoteAddress(callback: AsyncCallback&lt;NetAddress&gt;): void</p>     <p>在TLSSocketServer通信连接成功之后，获取对端Socket地址。使用callback方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.215.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.215.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.215.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.215.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#netaddress">NetAddress</a>&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。成功返回对端的socket地址，失败返回错误码、错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.215.8.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.215.8.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303188</td>         <td class="cellrowborder" width="50%">Socket operation on non-socket.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2300002</td>         <td class="cellrowborder" width="50%">System internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsServer</span>: socket.<span class="hljs-property">TLSSocketServer</span> = socket.<span class="hljs-title function_">constructTLSSocketServerInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">netAddress</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsSecureOptions</span>: socket.<span class="hljs-property">TLSSecureOptions</span> = {</li><li>  <span class="hljs-attr">key</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">cert</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">ca</span>: [<span class="hljs-string">"xxxx"</span>],</li><li>  <span class="hljs-attr">password</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">protocols</span>: socket.<span class="hljs-property">Protocol</span>.<span class="hljs-property">TLSv12</span>,</li><li>  <span class="hljs-attr">useRemoteCipherPrefer</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-attr">signatureAlgorithms</span>: <span class="hljs-string">"rsa_pss_rsae_sha256:ECDSA+SHA256"</span>,</li><li>  <span class="hljs-attr">cipherSuite</span>: <span class="hljs-string">"AES256-SHA256"</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsConnectOptions</span>: socket.<span class="hljs-property">TLSConnectOptions</span> = {</li><li>  <span class="hljs-attr">address</span>: netAddress,</li><li>  <span class="hljs-attr">secureOptions</span>: tlsSecureOptions,</li><li>  <span class="hljs-title class_">ALPNProtocols</span>: [<span class="hljs-string">"spdy/1"</span>, <span class="hljs-string">"http/1.1"</span>]</li><li>}</li><li>tlsServer.<span class="hljs-title function_">listen</span>(tlsConnectOptions).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"listen callback success"</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"failed"</span> + err);</li><li>});</li><li>tlsServer.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connect'</span>, <span class="hljs-function">(<span class="hljs-params">client: socket.TLSSocketConnection</span>) =&gt;</span> {</li><li>  client.<span class="hljs-title function_">getRemoteAddress</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError, data: socket.NetAddress</span>) =&gt;</span> {</li><li>    <span class="hljs-keyword">if</span> (err) {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'getRemoteAddress fail'</span>);</li><li>      <span class="hljs-keyword">return</span>;</li><li>    }</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'getRemoteAddress success:'</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data));</li><li>  });</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1668px;">     <h3 id="getremoteaddress10-3" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">getRemoteAddress<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getremoteaddress10-3" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>getRemoteAddress(): Promise&lt;NetAddress&gt;</p>     <p>在TLSSocketServer通信连接成功之后，获取对端Socket地址。使用Promise方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.216.6.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.216.6.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#netaddress">NetAddress</a>&gt;</td>         <td class="cellrowborder" width="50%">以Promise形式返回获取对端socket地址的结果。失败返回错误码，错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.216.8.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.216.8.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">2303188</td>         <td class="cellrowborder" width="50%">Socket operation on non-socket.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2300002</td>         <td class="cellrowborder" width="50%">System internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsServer</span>: socket.<span class="hljs-property">TLSSocketServer</span> = socket.<span class="hljs-title function_">constructTLSSocketServerInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">netAddress</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsSecureOptions</span>: socket.<span class="hljs-property">TLSSecureOptions</span> = {</li><li>  <span class="hljs-attr">key</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">cert</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">ca</span>: [<span class="hljs-string">"xxxx"</span>],</li><li>  <span class="hljs-attr">password</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">protocols</span>: socket.<span class="hljs-property">Protocol</span>.<span class="hljs-property">TLSv12</span>,</li><li>  <span class="hljs-attr">useRemoteCipherPrefer</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-attr">signatureAlgorithms</span>: <span class="hljs-string">"rsa_pss_rsae_sha256:ECDSA+SHA256"</span>,</li><li>  <span class="hljs-attr">cipherSuite</span>: <span class="hljs-string">"AES256-SHA256"</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsConnectOptions</span>: socket.<span class="hljs-property">TLSConnectOptions</span> = {</li><li>  <span class="hljs-attr">address</span>: netAddress,</li><li>  <span class="hljs-attr">secureOptions</span>: tlsSecureOptions,</li><li>  <span class="hljs-title class_">ALPNProtocols</span>: [<span class="hljs-string">"spdy/1"</span>, <span class="hljs-string">"http/1.1"</span>]</li><li>}</li><li>tlsServer.<span class="hljs-title function_">listen</span>(tlsConnectOptions).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"listen callback success"</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"failed"</span> + err);</li><li>});</li><li>tlsServer.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connect'</span>, <span class="hljs-function">(<span class="hljs-params">client: socket.TLSSocketConnection</span>) =&gt;</span> {</li><li>  client.<span class="hljs-title function_">getRemoteAddress</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">data: socket.NetAddress</span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'getRemoteAddress success:'</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data));</li><li>  }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"failed"</span> + err);</li><li>  });</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1871px;">     <h3 id="getremotecertificate10" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">getRemoteCertificate<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getremotecertificate10" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>getRemoteCertificate(callback: AsyncCallback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#x509certrawdata9">X509CertRawData</a>&gt;): void</p>     <p>在TLSSocketServer通信连接成功之后，获取对端的数字证书，该接口只适用于客户端向服务端发送证书时，使用callback方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.217.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.217.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.217.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.217.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#x509certrawdata9">X509CertRawData</a>&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数，返回对端的证书。失败返回错误码、错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.217.8.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.217.8.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303501</td>         <td class="cellrowborder" width="50%">SSL is null.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2300002</td>         <td class="cellrowborder" width="50%">System internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { util } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkTS'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsServer</span>: socket.<span class="hljs-property">TLSSocketServer</span> = socket.<span class="hljs-title function_">constructTLSSocketServerInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">netAddress</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsSecureOptions</span>: socket.<span class="hljs-property">TLSSecureOptions</span> = {</li><li>  <span class="hljs-attr">key</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">cert</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">ca</span>: [<span class="hljs-string">"xxxx"</span>],</li><li>  <span class="hljs-attr">password</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">protocols</span>: socket.<span class="hljs-property">Protocol</span>.<span class="hljs-property">TLSv12</span>,</li><li>  <span class="hljs-attr">useRemoteCipherPrefer</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-attr">signatureAlgorithms</span>: <span class="hljs-string">"rsa_pss_rsae_sha256:ECDSA+SHA256"</span>,</li><li>  <span class="hljs-attr">cipherSuite</span>: <span class="hljs-string">"AES256-SHA256"</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsConnectOptions</span>: socket.<span class="hljs-property">TLSConnectOptions</span> = {</li><li>  <span class="hljs-attr">address</span>: netAddress,</li><li>  <span class="hljs-attr">secureOptions</span>: tlsSecureOptions,</li><li>  <span class="hljs-title class_">ALPNProtocols</span>: [<span class="hljs-string">"spdy/1"</span>, <span class="hljs-string">"http/1.1"</span>]</li><li>}</li><li>tlsServer.<span class="hljs-title function_">listen</span>(tlsConnectOptions).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"listen callback success"</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"failed"</span> + err);</li><li>});</li><li>tlsServer.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connect'</span>, <span class="hljs-function">(<span class="hljs-params">client: socket.TLSSocketConnection</span>) =&gt;</span> {</li><li>  client.<span class="hljs-title function_">getRemoteCertificate</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError, data: socket.X509CertRawData</span>) =&gt;</span> {</li><li>    <span class="hljs-keyword">if</span> (err) {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"getRemoteCertificate callback error: "</span> + err);</li><li>    } <span class="hljs-keyword">else</span> {</li><li>      <span class="hljs-keyword">const</span> decoder = util.<span class="hljs-property">TextDecoder</span>.<span class="hljs-title function_">create</span>();</li><li>      <span class="hljs-keyword">const</span> str = decoder.<span class="hljs-title function_">decodeToString</span>(data.<span class="hljs-property">data</span>);</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"getRemoteCertificate callback: "</span> + str);</li><li>    }</li><li>  });</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1764px;">     <h3 id="getremotecertificate10-1" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">getRemoteCertificate<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getremotecertificate10-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>getRemoteCertificate():Promise&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#x509certrawdata9">X509CertRawData</a>&gt;</p>     <p>在TLSSocketServer通信连接成功之后，获取对端的数字证书，该接口只适用于客户端向服务端发送证书时，使用Promise方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.218.6.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.218.6.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#x509certrawdata9">X509CertRawData</a>&gt;</td>         <td class="cellrowborder" width="50%">以Promise形式返回对端的数字证书的结果。失败返回错误码，错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.218.8.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.218.8.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">2303501</td>         <td class="cellrowborder" width="50%">SSL is null.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2300002</td>         <td class="cellrowborder" width="50%">System internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { util } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkTS'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsServer</span>: socket.<span class="hljs-property">TLSSocketServer</span> = socket.<span class="hljs-title function_">constructTLSSocketServerInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">netAddress</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsSecureOptions</span>: socket.<span class="hljs-property">TLSSecureOptions</span> = {</li><li>  <span class="hljs-attr">key</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">cert</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">ca</span>: [<span class="hljs-string">"xxxx"</span>],</li><li>  <span class="hljs-attr">password</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">protocols</span>: socket.<span class="hljs-property">Protocol</span>.<span class="hljs-property">TLSv12</span>,</li><li>  <span class="hljs-attr">useRemoteCipherPrefer</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-attr">signatureAlgorithms</span>: <span class="hljs-string">"rsa_pss_rsae_sha256:ECDSA+SHA256"</span>,</li><li>  <span class="hljs-attr">cipherSuite</span>: <span class="hljs-string">"AES256-SHA256"</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsConnectOptions</span>: socket.<span class="hljs-property">TLSConnectOptions</span> = {</li><li>  <span class="hljs-attr">address</span>: netAddress,</li><li>  <span class="hljs-attr">secureOptions</span>: tlsSecureOptions,</li><li>  <span class="hljs-title class_">ALPNProtocols</span>: [<span class="hljs-string">"spdy/1"</span>, <span class="hljs-string">"http/1.1"</span>]</li><li>}</li><li>tlsServer.<span class="hljs-title function_">listen</span>(tlsConnectOptions).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"listen callback success"</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"failed"</span> + err);</li><li>});</li><li>tlsServer.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connect'</span>, <span class="hljs-function">(<span class="hljs-params">client: socket.TLSSocketConnection</span>) =&gt;</span> {</li><li>  client.<span class="hljs-title function_">getRemoteCertificate</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">data: socket.X509CertRawData</span>) =&gt;</span> {</li><li>    <span class="hljs-keyword">const</span> decoder = util.<span class="hljs-property">TextDecoder</span>.<span class="hljs-title function_">create</span>();</li><li>    <span class="hljs-keyword">const</span> str = decoder.<span class="hljs-title function_">decodeToString</span>(data.<span class="hljs-property">data</span>);</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"getRemoteCertificate success: "</span> + str);</li><li>  }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"failed"</span> + err);</li><li>  });</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1885px;">     <h3 id="getciphersuite10" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">getCipherSuite<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getciphersuite10" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>getCipherSuite(callback: AsyncCallback&lt;Array&lt;string&gt;&gt;): void</p>     <p>在TLSSocketServer通信连接成功之后，获取通信双方协商后的加密套件，使用callback方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.219.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.219.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.219.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.219.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;Array&lt;string&gt;&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数，返回通信双方支持的加密套件。失败返回错误码、错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.219.8.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.219.8.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303501</td>         <td class="cellrowborder" width="50%">SSL is null.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303502</td>         <td class="cellrowborder" width="50%">An error occurred when reading data on the TLS socket.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303505</td>         <td class="cellrowborder" width="50%">An error occurred in the TLS system call.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2300002</td>         <td class="cellrowborder" width="50%">System internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsServer</span>: socket.<span class="hljs-property">TLSSocketServer</span> = socket.<span class="hljs-title function_">constructTLSSocketServerInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">netAddress</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsSecureOptions</span>: socket.<span class="hljs-property">TLSSecureOptions</span> = {</li><li>  <span class="hljs-attr">key</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">cert</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">ca</span>: [<span class="hljs-string">"xxxx"</span>],</li><li>  <span class="hljs-attr">password</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">protocols</span>: socket.<span class="hljs-property">Protocol</span>.<span class="hljs-property">TLSv12</span>,</li><li>  <span class="hljs-attr">useRemoteCipherPrefer</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-attr">signatureAlgorithms</span>: <span class="hljs-string">"rsa_pss_rsae_sha256:ECDSA+SHA256"</span>,</li><li>  <span class="hljs-attr">cipherSuite</span>: <span class="hljs-string">"AES256-SHA256"</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsConnectOptions</span>: socket.<span class="hljs-property">TLSConnectOptions</span> = {</li><li>  <span class="hljs-attr">address</span>: netAddress,</li><li>  <span class="hljs-attr">secureOptions</span>: tlsSecureOptions,</li><li>  <span class="hljs-title class_">ALPNProtocols</span>: [<span class="hljs-string">"spdy/1"</span>, <span class="hljs-string">"http/1.1"</span>]</li><li>}</li><li>tlsServer.<span class="hljs-title function_">listen</span>(tlsConnectOptions).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"listen callback success"</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"failed"</span> + err);</li><li>});</li><li>tlsServer.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connect'</span>, <span class="hljs-function">(<span class="hljs-params">client: socket.TLSSocketConnection</span>) =&gt;</span> {</li><li>  client.<span class="hljs-title function_">getCipherSuite</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError, data: <span class="hljs-built_in">Array</span>&lt;<span class="hljs-built_in">string</span>&gt;</span>) =&gt;</span> {</li><li>    <span class="hljs-keyword">if</span> (err) {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"getCipherSuite callback error = "</span> + err);</li><li>    } <span class="hljs-keyword">else</span> {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"getCipherSuite callback = "</span> + data);</li><li>    }</li><li>  });</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1778px;">     <h3 id="getciphersuite10-1" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">getCipherSuite<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getciphersuite10-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>getCipherSuite(): Promise&lt;Array&lt;string&gt;&gt;</p>     <p>在TLSSocketServer通信连接成功之后，获取通信双方协商后的加密套件，使用Promise方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.220.6.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.220.6.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;Array&lt;string&gt;&gt;</td>         <td class="cellrowborder" width="50%">以Promise形式返回通信双方支持的加密套件。失败返回错误码，错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.220.8.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.220.8.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">2303501</td>         <td class="cellrowborder" width="50%">SSL is null.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303502</td>         <td class="cellrowborder" width="50%">An error occurred when reading data on the TLS socket.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303505</td>         <td class="cellrowborder" width="50%">An error occurred in the TLS system call.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2300002</td>         <td class="cellrowborder" width="50%">System internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsServer</span>: socket.<span class="hljs-property">TLSSocketServer</span> = socket.<span class="hljs-title function_">constructTLSSocketServerInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">netAddress</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsSecureOptions</span>: socket.<span class="hljs-property">TLSSecureOptions</span> = {</li><li>  <span class="hljs-attr">key</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">cert</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">ca</span>: [<span class="hljs-string">"xxxx"</span>],</li><li>  <span class="hljs-attr">password</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">protocols</span>: socket.<span class="hljs-property">Protocol</span>.<span class="hljs-property">TLSv12</span>,</li><li>  <span class="hljs-attr">useRemoteCipherPrefer</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-attr">signatureAlgorithms</span>: <span class="hljs-string">"rsa_pss_rsae_sha256:ECDSA+SHA256"</span>,</li><li>  <span class="hljs-attr">cipherSuite</span>: <span class="hljs-string">"AES256-SHA256"</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsConnectOptions</span>: socket.<span class="hljs-property">TLSConnectOptions</span> = {</li><li>  <span class="hljs-attr">address</span>: netAddress,</li><li>  <span class="hljs-attr">secureOptions</span>: tlsSecureOptions,</li><li>  <span class="hljs-title class_">ALPNProtocols</span>: [<span class="hljs-string">"spdy/1"</span>, <span class="hljs-string">"http/1.1"</span>]</li><li>}</li><li>tlsServer.<span class="hljs-title function_">listen</span>(tlsConnectOptions).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"listen callback success"</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"failed"</span> + err);</li><li>});</li><li>tlsServer.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connect'</span>, <span class="hljs-function">(<span class="hljs-params">client: socket.TLSSocketConnection</span>) =&gt;</span> {</li><li>  client.<span class="hljs-title function_">getCipherSuite</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">data: <span class="hljs-built_in">Array</span>&lt;<span class="hljs-built_in">string</span>&gt;</span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'getCipherSuite success:'</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data));</li><li>  }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"failed"</span> + err);</li><li>  });</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1751px;">     <h3 id="getsignaturealgorithms10" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">getSignatureAlgorithms<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getsignaturealgorithms10" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>getSignatureAlgorithms(callback: AsyncCallback&lt;Array&lt;string&gt;&gt;): void</p>     <p>在TLSSocketServer通信连接成功之后，获取通信双方协商后签名算法，使用callback方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.221.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.221.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.221.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.221.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;Array&lt;string&gt;&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数，返回双方支持的签名算法。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.221.8.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.221.8.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303501</td>         <td class="cellrowborder" width="50%">SSL is null.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2300002</td>         <td class="cellrowborder" width="50%">System internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsServer</span>: socket.<span class="hljs-property">TLSSocketServer</span> = socket.<span class="hljs-title function_">constructTLSSocketServerInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">netAddress</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsSecureOptions</span>: socket.<span class="hljs-property">TLSSecureOptions</span> = {</li><li>  <span class="hljs-attr">key</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">cert</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">ca</span>: [<span class="hljs-string">"xxxx"</span>],</li><li>  <span class="hljs-attr">password</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">protocols</span>: socket.<span class="hljs-property">Protocol</span>.<span class="hljs-property">TLSv12</span>,</li><li>  <span class="hljs-attr">useRemoteCipherPrefer</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-attr">signatureAlgorithms</span>: <span class="hljs-string">"rsa_pss_rsae_sha256:ECDSA+SHA256"</span>,</li><li>  <span class="hljs-attr">cipherSuite</span>: <span class="hljs-string">"AES256-SHA256"</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsConnectOptions</span>: socket.<span class="hljs-property">TLSConnectOptions</span> = {</li><li>  <span class="hljs-attr">address</span>: netAddress,</li><li>  <span class="hljs-attr">secureOptions</span>: tlsSecureOptions,</li><li>  <span class="hljs-title class_">ALPNProtocols</span>: [<span class="hljs-string">"spdy/1"</span>, <span class="hljs-string">"http/1.1"</span>]</li><li>}</li><li>tlsServer.<span class="hljs-title function_">listen</span>(tlsConnectOptions).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"listen callback success"</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"failed"</span> + err);</li><li>});</li><li>tlsServer.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connect'</span>, <span class="hljs-function">(<span class="hljs-params">client: socket.TLSSocketConnection</span>) =&gt;</span> {</li><li>  client.<span class="hljs-title function_">getSignatureAlgorithms</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError, data: <span class="hljs-built_in">Array</span>&lt;<span class="hljs-built_in">string</span>&gt;</span>) =&gt;</span> {</li><li>    <span class="hljs-keyword">if</span> (err) {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"getSignatureAlgorithms callback error = "</span> + err);</li><li>    } <span class="hljs-keyword">else</span> {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"getSignatureAlgorithms callback = "</span> + data);</li><li>    }</li><li>  });</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1644px;">     <h3 id="getsignaturealgorithms10-1" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">getSignatureAlgorithms<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getsignaturealgorithms10-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>getSignatureAlgorithms(): Promise&lt;Array&lt;string&gt;&gt;</p>     <p>在TLSSocketServer通信连接成功之后，获取通信双方协商后的签名算法，使用Promise方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.222.6.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.222.6.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;Array&lt;string&gt;&gt;</td>         <td class="cellrowborder" width="50%">以Promise形式返回获取到的双方支持的签名算法。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.222.8.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.222.8.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">2303501</td>         <td class="cellrowborder" width="50%">SSL is null.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2300002</td>         <td class="cellrowborder" width="50%">System internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsServer</span>: socket.<span class="hljs-property">TLSSocketServer</span> = socket.<span class="hljs-title function_">constructTLSSocketServerInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">netAddress</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsSecureOptions</span>: socket.<span class="hljs-property">TLSSecureOptions</span> = {</li><li>  <span class="hljs-attr">key</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">cert</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">ca</span>: [<span class="hljs-string">"xxxx"</span>],</li><li>  <span class="hljs-attr">password</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">protocols</span>: socket.<span class="hljs-property">Protocol</span>.<span class="hljs-property">TLSv12</span>,</li><li>  <span class="hljs-attr">useRemoteCipherPrefer</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-attr">signatureAlgorithms</span>: <span class="hljs-string">"rsa_pss_rsae_sha256:ECDSA+SHA256"</span>,</li><li>  <span class="hljs-attr">cipherSuite</span>: <span class="hljs-string">"AES256-SHA256"</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsConnectOptions</span>: socket.<span class="hljs-property">TLSConnectOptions</span> = {</li><li>  <span class="hljs-attr">address</span>: netAddress,</li><li>  <span class="hljs-attr">secureOptions</span>: tlsSecureOptions,</li><li>  <span class="hljs-title class_">ALPNProtocols</span>: [<span class="hljs-string">"spdy/1"</span>, <span class="hljs-string">"http/1.1"</span>]</li><li>}</li><li>tlsServer.<span class="hljs-title function_">listen</span>(tlsConnectOptions).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"listen callback success"</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"failed"</span> + err);</li><li>});</li><li>tlsServer.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connect'</span>, <span class="hljs-function">(<span class="hljs-params">client: socket.TLSSocketConnection</span>) =&gt;</span> {</li><li>  client.<span class="hljs-title function_">getSignatureAlgorithms</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">data: <span class="hljs-built_in">Array</span>&lt;<span class="hljs-built_in">string</span>&gt;</span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"getSignatureAlgorithms success"</span> + data);</li><li>  }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"failed"</span> + err);</li><li>  });</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1815px;">     <h3 id="getlocaladdress12-9" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">getLocalAddress<sup>12+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getlocaladdress12-9" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>getLocalAddress(): Promise&lt;NetAddress&gt;</p>     <p>获取TLSSocketConnection连接的本地Socket地址。使用Promise方式作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>在TLSSocketServer通信连接成功之后，才可调用此方法。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.223.7.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.223.7.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#netaddress">NetAddress</a>&gt;</td>         <td class="cellrowborder" width="50%">以Promise形式返回获取本地socket地址的结果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.223.9.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.223.9.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">2300002</td>         <td class="cellrowborder" width="50%">System internal error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2301009</td>         <td class="cellrowborder" width="50%">Bad file descriptor.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2303188</td>         <td class="cellrowborder" width="50%">Socket operation on non-socket.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsServer</span>: socket.<span class="hljs-property">TLSSocketServer</span> = socket.<span class="hljs-title function_">constructTLSSocketServerInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">netAddress</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsSecureOptions</span>: socket.<span class="hljs-property">TLSSecureOptions</span> = {</li><li>  <span class="hljs-attr">key</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">cert</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">ca</span>: [<span class="hljs-string">"xxxx"</span>],</li><li>  <span class="hljs-attr">password</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">protocols</span>: socket.<span class="hljs-property">Protocol</span>.<span class="hljs-property">TLSv12</span>,</li><li>  <span class="hljs-attr">useRemoteCipherPrefer</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-attr">signatureAlgorithms</span>: <span class="hljs-string">"rsa_pss_rsae_sha256:ECDSA+SHA256"</span>,</li><li>  <span class="hljs-attr">cipherSuite</span>: <span class="hljs-string">"AES256-SHA256"</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsConnectOptions</span>: socket.<span class="hljs-property">TLSConnectOptions</span> = {</li><li>  <span class="hljs-attr">address</span>: netAddress,</li><li>  <span class="hljs-attr">secureOptions</span>: tlsSecureOptions,</li><li>  <span class="hljs-title class_">ALPNProtocols</span>: [<span class="hljs-string">"spdy/1"</span>, <span class="hljs-string">"http/1.1"</span>]</li><li>}</li><li>tlsServer.<span class="hljs-title function_">listen</span>(tlsConnectOptions).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"listen callback success"</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"failed"</span> + err);</li><li>});</li><li>
</li><li>tlsServer.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connect'</span>, <span class="hljs-function">(<span class="hljs-params">client: socket.TLSSocketConnection</span>) =&gt;</span> {</li><li>  client.<span class="hljs-title function_">getLocalAddress</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">localAddress: socket.NetAddress</span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"Family IP Port: "</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(localAddress));</li><li>  }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"TLS Client Get Family IP Port failed, error: "</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));</li><li>  })</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1902px;">     <h3 id="onmessage10-1" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">on('message')<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onmessage10-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>on(type: 'message', callback: Callback&lt;SocketMessageInfo&gt;): void</p>     <p>订阅TLSSocketConnection连接的接收消息事件。使用callback方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.224.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.224.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.224.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.224.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">订阅的事件类型。'message'：接收消息事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#socketmessageinfo11">SocketMessageInfo</a>&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。成功时返回TLSSocketConnection连接信息，失败时返回错误码、错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.224.8.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.224.8.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsServer</span>: socket.<span class="hljs-property">TLSSocketServer</span> = socket.<span class="hljs-title function_">constructTLSSocketServerInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">netAddress</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsSecureOptions</span>: socket.<span class="hljs-property">TLSSecureOptions</span> = {</li><li>  <span class="hljs-attr">key</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">cert</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">ca</span>: [<span class="hljs-string">"xxxx"</span>],</li><li>  <span class="hljs-attr">password</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">protocols</span>: socket.<span class="hljs-property">Protocol</span>.<span class="hljs-property">TLSv12</span>,</li><li>  <span class="hljs-attr">useRemoteCipherPrefer</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-attr">signatureAlgorithms</span>: <span class="hljs-string">"rsa_pss_rsae_sha256:ECDSA+SHA256"</span>,</li><li>  <span class="hljs-attr">cipherSuite</span>: <span class="hljs-string">"AES256-SHA256"</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsConnectOptions</span>: socket.<span class="hljs-property">TLSConnectOptions</span> = {</li><li>  <span class="hljs-attr">address</span>: netAddress,</li><li>  <span class="hljs-attr">secureOptions</span>: tlsSecureOptions,</li><li>  <span class="hljs-title class_">ALPNProtocols</span>: [<span class="hljs-string">"spdy/1"</span>, <span class="hljs-string">"http/1.1"</span>]</li><li>}</li><li>tlsServer.<span class="hljs-title function_">listen</span>(tlsConnectOptions).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"listen callback success"</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"failed"</span> + err);</li><li>});</li><li>
</li><li>tlsServer.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connect'</span>, <span class="hljs-function">(<span class="hljs-params">client: socket.TLSSocketConnection</span>) =&gt;</span> {</li><li>  client.<span class="hljs-title function_">on</span>(<span class="hljs-string">'message'</span>, <span class="hljs-function">(<span class="hljs-params">value: socket.SocketMessageInfo</span>) =&gt;</span> {</li><li>    <span class="hljs-keyword">let</span> messageView = <span class="hljs-string">''</span>;</li><li>    <span class="hljs-keyword">let</span> uint8Array = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(value.<span class="hljs-property">message</span>);</li><li>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> <span class="hljs-attr">i</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>; i &lt; value.<span class="hljs-property">message</span>.<span class="hljs-property">byteLength</span>; i++) {</li><li>      <span class="hljs-keyword">let</span> messages = uint8Array[i];</li><li>      <span class="hljs-keyword">let</span> message = <span class="hljs-title class_">String</span>.<span class="hljs-title function_">fromCharCode</span>(messages);</li><li>      messageView += message;</li><li>    }</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'on message message: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(messageView));</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'remoteInfo: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(value.<span class="hljs-property">remoteInfo</span>));</li><li>  });</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1998px;">     <h3 id="offmessage10-1" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">off('message')<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="offmessage10-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>off(type: 'message', callback?: Callback&lt;SocketMessageInfo&gt;): void</p>     <p>取消订阅TLSSocketConnection连接的接收消息事件。使用callback方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.225.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.225.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.225.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.225.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">订阅的事件类型。'message'：接收消息事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-socket#socketmessageinfo11">SocketMessageInfo</a>&gt;</td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">回调函数。成功时返回TLSSocketConnection连接信息，失败时返回错误码、错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.225.8.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.225.8.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsServer</span>: socket.<span class="hljs-property">TLSSocketServer</span> = socket.<span class="hljs-title function_">constructTLSSocketServerInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">netAddress</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsSecureOptions</span>: socket.<span class="hljs-property">TLSSecureOptions</span> = {</li><li>  <span class="hljs-attr">key</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">cert</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">ca</span>: [<span class="hljs-string">"xxxx"</span>],</li><li>  <span class="hljs-attr">password</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">protocols</span>: socket.<span class="hljs-property">Protocol</span>.<span class="hljs-property">TLSv12</span>,</li><li>  <span class="hljs-attr">useRemoteCipherPrefer</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-attr">signatureAlgorithms</span>: <span class="hljs-string">"rsa_pss_rsae_sha256:ECDSA+SHA256"</span>,</li><li>  <span class="hljs-attr">cipherSuite</span>: <span class="hljs-string">"AES256-SHA256"</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsConnectOptions</span>: socket.<span class="hljs-property">TLSConnectOptions</span> = {</li><li>  <span class="hljs-attr">address</span>: netAddress,</li><li>  <span class="hljs-attr">secureOptions</span>: tlsSecureOptions,</li><li>  <span class="hljs-title class_">ALPNProtocols</span>: [<span class="hljs-string">"spdy/1"</span>, <span class="hljs-string">"http/1.1"</span>]</li><li>}</li><li>tlsServer.<span class="hljs-title function_">listen</span>(tlsConnectOptions).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"listen callback success"</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"failed"</span> + err);</li><li>});</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-title function_">callback</span> = (<span class="hljs-params">value: socket.SocketMessageInfo</span>) =&gt; {</li><li>  <span class="hljs-keyword">let</span> messageView = <span class="hljs-string">''</span>;</li><li>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> <span class="hljs-attr">i</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>; i &lt; value.<span class="hljs-property">message</span>.<span class="hljs-property">byteLength</span>; i++) {</li><li>    <span class="hljs-keyword">let</span> uint8Array = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(value.<span class="hljs-property">message</span>)</li><li>    <span class="hljs-keyword">let</span> messages = uint8Array[i]</li><li>    <span class="hljs-keyword">let</span> message = <span class="hljs-title class_">String</span>.<span class="hljs-title function_">fromCharCode</span>(messages);</li><li>    messageView += message;</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'on message message: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(messageView));</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'remoteInfo: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(value.<span class="hljs-property">remoteInfo</span>));</li><li>}</li><li>tlsServer.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connect'</span>, <span class="hljs-function">(<span class="hljs-params">client: socket.TLSSocketConnection</span>) =&gt;</span> {</li><li>  client.<span class="hljs-title function_">on</span>(<span class="hljs-string">'message'</span>, callback);</li><li>  <span class="hljs-comment">// 可以指定传入on中的callback取消一个订阅，也可以不指定callback清空所有订阅。</span></li><li>  client.<span class="hljs-title function_">off</span>(<span class="hljs-string">'message'</span>, callback);</li><li>  client.<span class="hljs-title function_">off</span>(<span class="hljs-string">'message'</span>);</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1638px;">     <h3 id="onclose10-1" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">on('close')<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onclose10-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>on(type: 'close', callback: Callback&lt;void&gt;): void</p>     <p>订阅TLSSocketConnection的关闭事件。使用callback方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.226.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.226.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.226.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.226.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">订阅的事件类型。'close'：关闭事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;void&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。成功时返回空，失败时返回错误码、错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.226.8.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.226.8.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsServer</span>: socket.<span class="hljs-property">TLSSocketServer</span> = socket.<span class="hljs-title function_">constructTLSSocketServerInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">netAddress</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsSecureOptions</span>: socket.<span class="hljs-property">TLSSecureOptions</span> = {</li><li>  <span class="hljs-attr">key</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">cert</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">ca</span>: [<span class="hljs-string">"xxxx"</span>],</li><li>  <span class="hljs-attr">password</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">protocols</span>: socket.<span class="hljs-property">Protocol</span>.<span class="hljs-property">TLSv12</span>,</li><li>  <span class="hljs-attr">useRemoteCipherPrefer</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-attr">signatureAlgorithms</span>: <span class="hljs-string">"rsa_pss_rsae_sha256:ECDSA+SHA256"</span>,</li><li>  <span class="hljs-attr">cipherSuite</span>: <span class="hljs-string">"AES256-SHA256"</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsConnectOptions</span>: socket.<span class="hljs-property">TLSConnectOptions</span> = {</li><li>  <span class="hljs-attr">address</span>: netAddress,</li><li>  <span class="hljs-attr">secureOptions</span>: tlsSecureOptions,</li><li>  <span class="hljs-title class_">ALPNProtocols</span>: [<span class="hljs-string">"spdy/1"</span>, <span class="hljs-string">"http/1.1"</span>]</li><li>}</li><li>tlsServer.<span class="hljs-title function_">listen</span>(tlsConnectOptions).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"listen callback success"</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"failed"</span> + err);</li><li>});</li><li>tlsServer.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connect'</span>, <span class="hljs-function">(<span class="hljs-params">client: socket.TLSSocketConnection</span>) =&gt;</span> {</li><li>  client.<span class="hljs-title function_">on</span>(<span class="hljs-string">'close'</span>, <span class="hljs-function">() =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"on close success"</span>)</li><li>  });</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1758px;">     <h3 id="offclose10-1" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">off('close')<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="offclose10-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>off(type: 'close', callback?: Callback&lt;void&gt;): void</p>     <p>取消订阅TLSSocketConnection的关闭事件。使用callback方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.227.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.227.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.227.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.227.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">订阅的事件类型。'close'：关闭事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;void&gt;</td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">回调函数。成功时返回空，失败时返回错误码、错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.227.8.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.227.8.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsServer</span>: socket.<span class="hljs-property">TLSSocketServer</span> = socket.<span class="hljs-title function_">constructTLSSocketServerInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">netAddress</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsSecureOptions</span>: socket.<span class="hljs-property">TLSSecureOptions</span> = {</li><li>  <span class="hljs-attr">key</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">cert</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">ca</span>: [<span class="hljs-string">"xxxx"</span>],</li><li>  <span class="hljs-attr">password</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">protocols</span>: socket.<span class="hljs-property">Protocol</span>.<span class="hljs-property">TLSv12</span>,</li><li>  <span class="hljs-attr">useRemoteCipherPrefer</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-attr">signatureAlgorithms</span>: <span class="hljs-string">"rsa_pss_rsae_sha256:ECDSA+SHA256"</span>,</li><li>  <span class="hljs-attr">cipherSuite</span>: <span class="hljs-string">"AES256-SHA256"</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsConnectOptions</span>: socket.<span class="hljs-property">TLSConnectOptions</span> = {</li><li>  <span class="hljs-attr">address</span>: netAddress,</li><li>  <span class="hljs-attr">secureOptions</span>: tlsSecureOptions,</li><li>  <span class="hljs-title class_">ALPNProtocols</span>: [<span class="hljs-string">"spdy/1"</span>, <span class="hljs-string">"http/1.1"</span>]</li><li>}</li><li>tlsServer.<span class="hljs-title function_">listen</span>(tlsConnectOptions).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"listen callback success"</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"failed"</span> + err);</li><li>});</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-title function_">callback</span> = (<span class="hljs-params"></span>) =&gt; {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"on close success"</span>);</li><li>}</li><li>tlsServer.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connect'</span>, <span class="hljs-function">(<span class="hljs-params">client: socket.TLSSocketConnection</span>) =&gt;</span> {</li><li>  client.<span class="hljs-title function_">on</span>(<span class="hljs-string">'close'</span>, callback);</li><li>  <span class="hljs-comment">// 可以指定传入on中的callback取消一个订阅，也可以不指定callback清空所有订阅。</span></li><li>  client.<span class="hljs-title function_">off</span>(<span class="hljs-string">'close'</span>, callback);</li><li>  client.<span class="hljs-title function_">off</span>(<span class="hljs-string">'close'</span>);</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1662px;">     <h3 id="onerror10-3" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">on('error')<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onerror10-3" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>on(type: 'error', callback: ErrorCallback): void</p>     <p>订阅TLSSocketConnection连接的error事件。使用callback方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.228.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.228.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.228.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.228.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">订阅的事件类型。'error'：error事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">ErrorCallback</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。成功时返回空，失败时返回错误码、错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.228.8.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.228.8.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsServer</span>: socket.<span class="hljs-property">TLSSocketServer</span> = socket.<span class="hljs-title function_">constructTLSSocketServerInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">netAddress</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsSecureOptions</span>: socket.<span class="hljs-property">TLSSecureOptions</span> = {</li><li>  <span class="hljs-attr">key</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">cert</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">ca</span>: [<span class="hljs-string">"xxxx"</span>],</li><li>  <span class="hljs-attr">password</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">protocols</span>: socket.<span class="hljs-property">Protocol</span>.<span class="hljs-property">TLSv12</span>,</li><li>  <span class="hljs-attr">useRemoteCipherPrefer</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-attr">signatureAlgorithms</span>: <span class="hljs-string">"rsa_pss_rsae_sha256:ECDSA+SHA256"</span>,</li><li>  <span class="hljs-attr">cipherSuite</span>: <span class="hljs-string">"AES256-SHA256"</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsConnectOptions</span>: socket.<span class="hljs-property">TLSConnectOptions</span> = {</li><li>  <span class="hljs-attr">address</span>: netAddress,</li><li>  <span class="hljs-attr">secureOptions</span>: tlsSecureOptions,</li><li>  <span class="hljs-title class_">ALPNProtocols</span>: [<span class="hljs-string">"spdy/1"</span>, <span class="hljs-string">"http/1.1"</span>]</li><li>}</li><li>tlsServer.<span class="hljs-title function_">listen</span>(tlsConnectOptions).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"listen callback success"</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"failed"</span> + err);</li><li>});</li><li>
</li><li>tlsServer.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connect'</span>, <span class="hljs-function">(<span class="hljs-params">client: socket.TLSSocketConnection</span>) =&gt;</span> {</li><li>  client.<span class="hljs-title function_">on</span>(<span class="hljs-string">'error'</span>, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"on error, err:"</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err))</li><li>  });</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1758px;">     <h3 id="offerror10-3" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">off('error')<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="offerror10-3" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>off(type: 'error', callback?: ErrorCallback): void</p>     <p>取消订阅TLSSocketConnection连接的error事件。使用callback方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.229.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.229.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.229.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.229.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">订阅的事件类型。'error'：error事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">ErrorCallback</td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">回调函数。成功时返回空，失败时返回错误码、错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.229.8.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.229.8.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-fif-c106="" class="highlight-div"><div _ngcontent-fif-c106="" class="highlight-div-header"><div _ngcontent-fif-c106="" class="highlight-div-header-left"><div _ngcontent-fif-c106="" class="handle-button expand-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fif-c106="" class="highlight-div-header-right"><div _ngcontent-fif-c106="" class="handle-button ai-button"></div><div _ngcontent-fif-c106="" class="handle-button line-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fif-c106="" class="handle-button theme-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fif-c106="" class="handle-button copy-button"><div _ngcontent-fif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { socket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsServer</span>: socket.<span class="hljs-property">TLSSocketServer</span> = socket.<span class="hljs-title function_">constructTLSSocketServerInstance</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">netAddress</span>: socket.<span class="hljs-property">NetAddress</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'192.168.xx.xxx'</span>,</li><li>  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsSecureOptions</span>: socket.<span class="hljs-property">TLSSecureOptions</span> = {</li><li>  <span class="hljs-attr">key</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">cert</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">ca</span>: [<span class="hljs-string">"xxxx"</span>],</li><li>  <span class="hljs-attr">password</span>: <span class="hljs-string">"xxxx"</span>,</li><li>  <span class="hljs-attr">protocols</span>: socket.<span class="hljs-property">Protocol</span>.<span class="hljs-property">TLSv12</span>,</li><li>  <span class="hljs-attr">useRemoteCipherPrefer</span>: <span class="hljs-literal">true</span>,</li><li>  <span class="hljs-attr">signatureAlgorithms</span>: <span class="hljs-string">"rsa_pss_rsae_sha256:ECDSA+SHA256"</span>,</li><li>  <span class="hljs-attr">cipherSuite</span>: <span class="hljs-string">"AES256-SHA256"</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">tlsConnectOptions</span>: socket.<span class="hljs-property">TLSConnectOptions</span> = {</li><li>  <span class="hljs-attr">address</span>: netAddress,</li><li>  <span class="hljs-attr">secureOptions</span>: tlsSecureOptions,</li><li>  <span class="hljs-title class_">ALPNProtocols</span>: [<span class="hljs-string">"spdy/1"</span>, <span class="hljs-string">"http/1.1"</span>]</li><li>}</li><li>tlsServer.<span class="hljs-title function_">listen</span>(tlsConnectOptions).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"listen callback success"</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"failed"</span> + err);</li><li>});</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-title function_">callback</span> = (<span class="hljs-params">err: BusinessError</span>) =&gt; {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"on error, err:"</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));</li><li>}</li><li>tlsServer.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connect'</span>, <span class="hljs-function">(<span class="hljs-params">client: socket.TLSSocketConnection</span>) =&gt;</span> {</li><li>  client.<span class="hljs-title function_">on</span>(<span class="hljs-string">'error'</span>, callback);</li><li>  <span class="hljs-comment">// 可以指定传入on中的callback取消一个订阅，也可以不指定callback清空所有订阅。</span></li><li>  client.<span class="hljs-title function_">off</span>(<span class="hljs-string">'error'</span>, callback);</li><li>  client.<span class="hljs-title function_">off</span>(<span class="hljs-string">'error'</span>);</li><li>});</li></ol></pre></div></div>    </div>   </div>   <div></div></div>