<h1 _ngcontent-xjf-c119="" class="doc-title ng-star-inserted" title="@ohos.net.webSocket (WebSocket连接)"> @ohos.net.webSocket (WebSocket连接) </h1>

<div _ngcontent-xjf-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted renderOptimization" style="position: relative;">   <div>    <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">      <p>本模块首批接口从API version 6开始支持。后续版本的新增接口，采用上角标单独标记接口的起始版本。</p>     </div></div></div>    <p>给第三方应用提供webSocket客户端和服务端服务器，实现客户端与服务端的双向连接，目前服务端仅支持智慧屏使用。</p>    <p>客户端：使用WebSocket建立服务器与客户端的双向连接，需要先通过<a href="/consumer/cn/doc/harmonyos-references/js-apis-websocket#websocketcreatewebsocket">createWebSocket</a>方法创建<a href="/consumer/cn/doc/harmonyos-references/js-apis-websocket#websocket">WebSocket</a>对象，然后通过<a href="/consumer/cn/doc/harmonyos-references/js-apis-websocket#connect">connect</a>方法连接到服务器。当连接成功后，客户端会收到<a href="/consumer/cn/doc/harmonyos-references/js-apis-websocket#onopen">open</a>事件的回调，之后客户端就可以通过<a href="/consumer/cn/doc/harmonyos-references/js-apis-websocket#send">send</a>方法与服务器进行通信。当服务器发信息给客户端时，客户端会收到<a href="/consumer/cn/doc/harmonyos-references/js-apis-websocket#onmessage">message</a>事件的回调。当客户端想要取消此连接时，通过调用<a href="/consumer/cn/doc/harmonyos-references/js-apis-websocket#close">close</a>方法主动断开连接后，客户端会收到<a href="/consumer/cn/doc/harmonyos-references/js-apis-websocket#onclose">close</a>事件的回调。若在上述任一过程中发生错误，客户端会收到<a href="/consumer/cn/doc/harmonyos-references/js-apis-websocket#onerror">error</a>事件的回调。</p>    <p>服务端：（目前服务端仅支持智慧屏使用）使用WebSocket建立服务器与客户端的双向连接，需要先通过<a href="/consumer/cn/doc/harmonyos-references/js-apis-websocket#websocketcreatewebsocketserver19">createWebSocketServer</a>方法创建<a href="/consumer/cn/doc/harmonyos-references/js-apis-websocket#websocketserver19">WebSocketServer</a>对象，然后通过<a href="/consumer/cn/doc/harmonyos-references/js-apis-websocket#start19">start</a>方法启动服务器，监听客户端的申请建链的消息。当连接成功后，服务端会收到<a href="/consumer/cn/doc/harmonyos-references/js-apis-websocket#onconnect19">connect</a>事件的回调，之后服务端可以通过<a href="/consumer/cn/doc/harmonyos-references/js-apis-websocket#send19">send</a>方法与客户端进行通信，或者通过<a href="/consumer/cn/doc/harmonyos-references/js-apis-websocket#listallconnections19">listAllConnections</a>方法列举出当前与服务端建链的所有客户端信息。当客户端给服务端发消息时，服务端会收到<a href="/consumer/cn/doc/harmonyos-references/js-apis-websocket#onmessagereceive19">messageReceive</a>事件回调。当服务端想断开与某个客户端的连接时，可以通过调用<a href="/consumer/cn/doc/harmonyos-references/js-apis-websocket#close19">close</a>方法主动断开与某个客户端的连接，之后服务端会收到<a href="/consumer/cn/doc/harmonyos-references/js-apis-websocket#onclose19">close</a>事件的回调。当服务端想停止service时，可以调用<a href="/consumer/cn/doc/harmonyos-references/js-apis-websocket#stop19">stop</a>方法。若在上述任一过程中发生错误，服务端会收到<a href="/consumer/cn/doc/harmonyos-references/js-apis-websocket#onerror19">error</a>事件的回调。</p>    <div class="tiledSection scroll-inwindow" style="contain-intrinsic-size: auto 247px;">     <h2 id="导入模块" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">导入模块<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="导入模块" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><div _ngcontent-xjf-c106="" class="highlight-div"><div _ngcontent-xjf-c106="" class="highlight-div-header"><div _ngcontent-xjf-c106="" class="highlight-div-header-left"><div _ngcontent-xjf-c106="" class="handle-button expand-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xjf-c106="" class="highlight-div-header-right"><div _ngcontent-xjf-c106="" class="handle-button ai-button"></div><div _ngcontent-xjf-c106="" class="handle-button line-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xjf-c106="" class="handle-button theme-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xjf-c106="" class="handle-button copy-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xjf-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { webSocket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li></ol></pre></div></div>    </div>    <div class="tiledSection scroll-inwindow" style="contain-intrinsic-size: auto 706px;">     <h2 id="websocketcreatewebsocket" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">webSocket.createWebSocket<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="websocketcreatewebsocket" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>createWebSocket(): WebSocket</p>     <p>创建一个WebSocket对象，里面包括建立连接、关闭连接、发送数据和订阅/取消订阅WebSocket连接的打开事件、接收到服务器消息事件、关闭事件和错误事件。</p>     <p><strong>元服务API：</strong> 从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.6.7.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.6.7.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-websocket#websocket">WebSocket</a></td>         <td class="cellrowborder" width="50%">返回一个WebSocket对象，里面包括connect、send、close、on和off方法。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-xjf-c106="" class="highlight-div"><div _ngcontent-xjf-c106="" class="highlight-div-header"><div _ngcontent-xjf-c106="" class="highlight-div-header-left"><div _ngcontent-xjf-c106="" class="handle-button expand-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xjf-c106="" class="highlight-div-header-right"><div _ngcontent-xjf-c106="" class="handle-button ai-button"></div><div _ngcontent-xjf-c106="" class="handle-button line-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xjf-c106="" class="handle-button theme-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xjf-c106="" class="handle-button copy-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xjf-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">let</span> <span class="hljs-attr">ws</span>: webSocket.<span class="hljs-property">WebSocket</span> = webSocket.<span class="hljs-title function_">createWebSocket</span>();</li></ol></pre></div></div>    </div>    <div class="tiledSection scroll-inwindow" style="contain-intrinsic-size: auto 182px;">     <h2 id="websocket" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">WebSocket<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="websocket" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>在调用WebSocket的方法前，需要先通过<a href="/consumer/cn/doc/harmonyos-references/js-apis-websocket#websocketcreatewebsocket">webSocket.createWebSocket</a>创建一个WebSocket。</p>    </div>    <div class="tiledSection scroll-inwindow" style="contain-intrinsic-size: auto 1824px;">     <h3 id="connect" device-type="phone,2in1,tablet,wearable,lite_wearable,tv" class="firsth2">connect<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="connect" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>connect(url: string, callback: AsyncCallback&lt;boolean&gt;): void</p>     <p>根据URL地址，建立一个WebSocket连接，使用callback方式作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>可通过监听error事件获得该接口的执行结果。</p>       <p>callback中返回的boolean值仅表示连接请求创建是否成功。如需感知WebSocket是否连接成功，需要在调用该接口前调用<a href="/consumer/cn/doc/harmonyos-references/js-apis-websocket#onopen">on('open')</a>订阅open事件。</p>      </div></div></div>     <p><strong>需要权限</strong>：ohos.permission.INTERNET</p>     <p><strong>元服务API：</strong> 从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content">       <p>URL地址长度不能超过1024个字符，否则会连接失败。从API15开始，URL地址长度限制由1024修改为2048。</p>      </div></div></div>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.8.10.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.8.10.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.8.10.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.8.10.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">url</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">建立WebSocket连接的URL地址。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;boolean&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。true:连接请求创建成功；false:连接请求创建失败。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-net-websocket">webSocket错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.8.13.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.8.13.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2302001</td>         <td class="cellrowborder" width="50%">Websocket url error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2302002</td>         <td class="cellrowborder" width="50%">Websocket certificate file does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2302003</td>         <td class="cellrowborder" width="50%">Websocket connection already exists.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2302998</td>         <td class="cellrowborder" width="50%">It is not allowed to access this domain.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2302999</td>         <td class="cellrowborder" width="50%">Internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-xjf-c106="" class="highlight-div"><div _ngcontent-xjf-c106="" class="highlight-div-header"><div _ngcontent-xjf-c106="" class="highlight-div-header-left"><div _ngcontent-xjf-c106="" class="handle-button expand-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xjf-c106="" class="highlight-div-header-right"><div _ngcontent-xjf-c106="" class="handle-button ai-button"></div><div _ngcontent-xjf-c106="" class="handle-button line-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xjf-c106="" class="handle-button theme-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xjf-c106="" class="handle-button copy-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xjf-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { webSocket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> ws = webSocket.<span class="hljs-title function_">createWebSocket</span>();</li><li><span class="hljs-keyword">let</span> url = <span class="hljs-string">"ws://"</span>;</li><li>ws.<span class="hljs-title function_">connect</span>(url, <span class="hljs-function">(<span class="hljs-params">err: BusinessError, value: <span class="hljs-built_in">boolean</span></span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (!err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"connect success"</span>)</li><li>  } <span class="hljs-keyword">else</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`connect fail. Code: <span class="hljs-subst">${err.code}</span>, message: <span class="hljs-subst">${err.message}</span>`</span>)</li><li>  }</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 2149px;">     <h3 id="connect-1" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">connect<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="connect-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>connect(url: string, options: WebSocketRequestOptions, callback: AsyncCallback&lt;boolean&gt;): void</p>     <p>根据URL地址，建立一个WebSocket连接，使用callback方式作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>可通过监听error事件获得该接口的执行结果，错误发生时会得到错误码：200。</p>       <p>callback中返回的boolean值仅表示连接请求创建是否成功。如需感知WebSocket是否连接成功，需要在调用该接口前调用<a href="/consumer/cn/doc/harmonyos-references/js-apis-websocket#onopen">on('open')</a>订阅open事件。</p>      </div></div></div>     <p><strong>需要权限</strong>：ohos.permission.INTERNET</p>     <p><strong>元服务API：</strong> 从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content">       <p>URL地址长度不能超过1024个字符，否则会连接失败。</p>      </div></div></div>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.9.10.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.9.10.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.9.10.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.9.10.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">url</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">建立WebSocket连接的URL地址。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">options</td>         <td class="cellrowborder" width="25%">WebSocketRequestOptions</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">参考<a href="/consumer/cn/doc/harmonyos-references/js-apis-websocket#websocketrequestoptions">WebSocketRequestOptions</a>。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;boolean&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。true:连接请求创建成功；false:连接请求创建失败。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-net-websocket">webSocket错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.9.13.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.9.13.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2302001</td>         <td class="cellrowborder" width="50%">Websocket url error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2302002</td>         <td class="cellrowborder" width="50%">Websocket certificate file does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2302003</td>         <td class="cellrowborder" width="50%">Websocket connection already exists.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2302998</td>         <td class="cellrowborder" width="50%">It is not allowed to access this domain.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2302999</td>         <td class="cellrowborder" width="50%">Internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-xjf-c106="" class="highlight-div"><div _ngcontent-xjf-c106="" class="highlight-div-header"><div _ngcontent-xjf-c106="" class="highlight-div-header-left"><div _ngcontent-xjf-c106="" class="handle-button expand-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xjf-c106="" class="highlight-div-header-right"><div _ngcontent-xjf-c106="" class="handle-button ai-button"></div><div _ngcontent-xjf-c106="" class="handle-button line-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xjf-c106="" class="handle-button theme-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xjf-c106="" class="handle-button copy-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xjf-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { webSocket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> ws = webSocket.<span class="hljs-title function_">createWebSocket</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">options</span>: webSocket.<span class="hljs-property">WebSocketRequestOptions</span> | <span class="hljs-literal">undefined</span>;</li><li><span class="hljs-keyword">if</span> (options !=<span class="hljs-literal">undefined</span>) {</li><li>  options.<span class="hljs-property">header</span> = {</li><li>     <span class="hljs-attr">name1</span>: <span class="hljs-string">"value1"</span>,</li><li>     <span class="hljs-attr">name2</span>: <span class="hljs-string">"value2"</span>,</li><li>     <span class="hljs-attr">name3</span>: <span class="hljs-string">"value3"</span></li><li>  };</li><li>  options.<span class="hljs-property">caPath</span> = <span class="hljs-string">""</span>;</li><li>}</li><li><span class="hljs-keyword">let</span> url = <span class="hljs-string">"ws://"</span></li><li>ws.<span class="hljs-title function_">connect</span>(url, options, <span class="hljs-function">(<span class="hljs-params">err: BusinessError, value: <span class="hljs-built_in">Object</span></span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (!err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"connect success"</span>)</li><li>  } <span class="hljs-keyword">else</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`connect fail. Code: <span class="hljs-subst">${err.code}</span>, message: <span class="hljs-subst">${err.message}</span>`</span>)</li><li>  }</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1987px;">     <h3 id="connect-2" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">connect<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="connect-2" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>connect(url: string, options?: WebSocketRequestOptions): Promise&lt;boolean&gt;</p>     <p>根据URL地址和header，建立一个WebSocket连接。使用Promise异步回调。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>可通过监听error事件获得该接口的执行结果，错误发生时会得到错误码：200。</p>       <p>callback中返回的boolean值仅表示连接请求创建是否成功。如需感知WebSocket是否连接成功，需要在调用该接口前调用<a href="/consumer/cn/doc/harmonyos-references/js-apis-websocket#onopen">on('open')</a>订阅open事件。</p>      </div></div></div>     <p><strong>需要权限</strong>：ohos.permission.INTERNET</p>     <p><strong>元服务API：</strong> 从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content">       <p>URL地址长度不能超过1024个字符，否则会连接失败。</p>      </div></div></div>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.10.10.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.10.10.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.10.10.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.10.10.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">url</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">建立WebSocket连接的URL地址。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">options</td>         <td class="cellrowborder" width="25%">WebSocketRequestOptions</td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">参考<a href="/consumer/cn/doc/harmonyos-references/js-apis-websocket#websocketrequestoptions">WebSocketRequestOptions</a>。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.10.12.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.10.12.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;boolean&gt;</td>         <td class="cellrowborder" width="50%">回调函数。true:连接请求创建成功；false:连接请求创建失败。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-net-websocket">webSocket错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.10.15.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.10.15.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2302001</td>         <td class="cellrowborder" width="50%">Websocket url error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2302002</td>         <td class="cellrowborder" width="50%">Websocket certificate file does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2302003</td>         <td class="cellrowborder" width="50%">Websocket connection already exists.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2302998</td>         <td class="cellrowborder" width="50%">It is not allowed to access this domain.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2302999</td>         <td class="cellrowborder" width="50%">Internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-xjf-c106="" class="highlight-div"><div _ngcontent-xjf-c106="" class="highlight-div-header"><div _ngcontent-xjf-c106="" class="highlight-div-header-left"><div _ngcontent-xjf-c106="" class="handle-button expand-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xjf-c106="" class="highlight-div-header-right"><div _ngcontent-xjf-c106="" class="handle-button ai-button"></div><div _ngcontent-xjf-c106="" class="handle-button line-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xjf-c106="" class="handle-button theme-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xjf-c106="" class="handle-button copy-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xjf-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { webSocket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> ws = webSocket.<span class="hljs-title function_">createWebSocket</span>();</li><li><span class="hljs-keyword">let</span> url = <span class="hljs-string">"ws://"</span></li><li><span class="hljs-keyword">let</span> promise = ws.<span class="hljs-title function_">connect</span>(url);</li><li>promise.<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">value: <span class="hljs-built_in">boolean</span></span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"connect success"</span>)</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err:<span class="hljs-built_in">string</span></span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"connect fail, error:"</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err))</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1900px;">     <h3 id="send" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">send<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="send" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>send(data: string | ArrayBuffer, callback: AsyncCallback&lt;boolean&gt;): void</p>     <p>通过WebSocket连接发送数据，使用callback方式作为异步方法。</p>     <p><strong>需要权限</strong>：ohos.permission.INTERNET</p>     <p><strong>元服务API：</strong> 从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.11.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.11.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.11.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.11.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">data</td>         <td class="cellrowborder" width="25%">string | ArrayBuffer</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">          <p>发送的数据。</p>          <p>API 6及更早版本仅支持string类型。API 8起同时支持string和ArrayBuffer类型。最大支持发送5242864字节数据(即5 * 1024 * 1024 - 16)，超过该大小会返回401错误码。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;boolean&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。true:发送请求创建成功；false:发送请求创建失败。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.11.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.11.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-xjf-c106="" class="highlight-div"><div _ngcontent-xjf-c106="" class="highlight-div-header"><div _ngcontent-xjf-c106="" class="highlight-div-header-left"><div _ngcontent-xjf-c106="" class="handle-button expand-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xjf-c106="" class="highlight-div-header-right"><div _ngcontent-xjf-c106="" class="handle-button ai-button"></div><div _ngcontent-xjf-c106="" class="handle-button line-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xjf-c106="" class="handle-button theme-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xjf-c106="" class="handle-button copy-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xjf-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { webSocket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> ws = webSocket.<span class="hljs-title function_">createWebSocket</span>();</li><li><span class="hljs-keyword">let</span> url = <span class="hljs-string">"ws://"</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">OutValue</span> {</li><li>  <span class="hljs-attr">status</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span></li><li>  <span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">""</span></li><li>}</li><li>ws.<span class="hljs-title function_">connect</span>(url, <span class="hljs-function">(<span class="hljs-params">err: BusinessError, value: <span class="hljs-built_in">boolean</span></span>) =&gt;</span> {</li><li>    <span class="hljs-keyword">if</span> (!err) {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"connect success"</span>)</li><li>    } <span class="hljs-keyword">else</span> {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`connect fail. Code: <span class="hljs-subst">${err.code}</span>, message: <span class="hljs-subst">${err.message}</span>`</span>)</li><li>    }</li><li>});</li><li>ws.<span class="hljs-title function_">on</span>(<span class="hljs-string">'open'</span>, <span class="hljs-function">(<span class="hljs-params">err: BusinessError, value: <span class="hljs-built_in">Object</span></span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"on open, status:"</span> + (value <span class="hljs-keyword">as</span> <span class="hljs-title class_">OutValue</span>).<span class="hljs-property">status</span> + <span class="hljs-string">", message:"</span> + (value <span class="hljs-keyword">as</span> <span class="hljs-title class_">OutValue</span>).<span class="hljs-property">message</span>)</li><li>    ws.<span class="hljs-title function_">send</span>(<span class="hljs-string">"Hello, server!"</span>, <span class="hljs-function">(<span class="hljs-params">err: BusinessError, value: <span class="hljs-built_in">boolean</span></span>) =&gt;</span> {</li><li>    <span class="hljs-keyword">if</span> (!err) {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"send success"</span>)</li><li>    } <span class="hljs-keyword">else</span> {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`send fail. Code: <span class="hljs-subst">${err.code}</span>, message: <span class="hljs-subst">${err.message}</span>`</span>)</li><li>    }</li><li>  });</li><li>});</li></ol></pre></div></div>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>send接口必须在监听到open事件后才可以调用。</p>      </div></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 2002px;">     <h3 id="send-1" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">send<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="send-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>send(data: string | ArrayBuffer): Promise&lt;boolean&gt;</p>     <p>通过WebSocket连接发送数据。使用Promise异步回调。</p>     <p><strong>需要权限</strong>：ohos.permission.INTERNET</p>     <p><strong>元服务API：</strong> 从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.12.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.12.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.12.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.12.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">data</td>         <td class="cellrowborder" width="25%">string | ArrayBuffer</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">          <p>发送的数据。</p>          <p>API 6及更早版本仅支持string类型。API 8起同时支持string和ArrayBuffer类型。最大支持发送5242864字节数据(即5 * 1024 * 1024 - 16)，超过该大小会返回401错误码。</p></td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.12.10.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.12.10.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;boolean&gt;</td>         <td class="cellrowborder" width="50%">以Promise形式返回发送数据的结果。true:发送请求创建成功；false:发送请求创建失败。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.12.13.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.12.13.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-xjf-c106="" class="highlight-div"><div _ngcontent-xjf-c106="" class="highlight-div-header"><div _ngcontent-xjf-c106="" class="highlight-div-header-left"><div _ngcontent-xjf-c106="" class="handle-button expand-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xjf-c106="" class="highlight-div-header-right"><div _ngcontent-xjf-c106="" class="handle-button ai-button"></div><div _ngcontent-xjf-c106="" class="handle-button line-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xjf-c106="" class="handle-button theme-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xjf-c106="" class="handle-button copy-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xjf-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { webSocket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> ws = webSocket.<span class="hljs-title function_">createWebSocket</span>();</li><li><span class="hljs-keyword">let</span> url = <span class="hljs-string">"ws://"</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">OutValue</span> {</li><li>  <span class="hljs-attr">status</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span></li><li>  <span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">""</span></li><li>}</li><li>ws.<span class="hljs-title function_">connect</span>(url, <span class="hljs-function">(<span class="hljs-params">err: BusinessError, value: <span class="hljs-built_in">boolean</span></span>) =&gt;</span> {</li><li>    <span class="hljs-keyword">if</span> (!err) {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"connect success"</span>)</li><li>    } <span class="hljs-keyword">else</span> {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"connect fail. Code: ${err.code}, message: ${err.message}"</span>)</li><li>    }</li><li>});</li><li>
</li><li>ws.<span class="hljs-title function_">on</span>(<span class="hljs-string">'open'</span>, <span class="hljs-function">(<span class="hljs-params">err: BusinessError, value: <span class="hljs-built_in">Object</span></span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"on open, status:"</span> + (value <span class="hljs-keyword">as</span> <span class="hljs-title class_">OutValue</span>).<span class="hljs-property">status</span> + <span class="hljs-string">", message:"</span> + (value <span class="hljs-keyword">as</span> <span class="hljs-title class_">OutValue</span>).<span class="hljs-property">message</span>)</li><li>  <span class="hljs-keyword">let</span> promise = ws.<span class="hljs-title function_">send</span>(<span class="hljs-string">"Hello, server!"</span>);</li><li>  promise.<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">value: <span class="hljs-built_in">boolean</span></span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"send success"</span>)</li><li>  }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err:<span class="hljs-built_in">string</span></span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"send fail, error:"</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err))</li><li>  });</li><li>});</li></ol></pre></div></div>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>send接口必须在监听到open事件后才可以调用。</p>      </div></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1240px;">     <h3 id="close" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">close<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="close" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>close(callback: AsyncCallback&lt;boolean&gt;): void</p>     <p>关闭WebSocket连接，使用callback方式作为异步方法。</p>     <p><strong>需要权限</strong>：ohos.permission.INTERNET</p>     <p><strong>元服务API：</strong> 从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.13.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.13.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.13.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.13.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;boolean&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。true:关闭请求创建成功；false:关闭请求创建失败。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.13.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.13.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-xjf-c106="" class="highlight-div"><div _ngcontent-xjf-c106="" class="highlight-div-header"><div _ngcontent-xjf-c106="" class="highlight-div-header-left"><div _ngcontent-xjf-c106="" class="handle-button expand-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xjf-c106="" class="highlight-div-header-right"><div _ngcontent-xjf-c106="" class="handle-button ai-button"></div><div _ngcontent-xjf-c106="" class="handle-button line-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xjf-c106="" class="handle-button theme-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xjf-c106="" class="handle-button copy-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xjf-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { webSocket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> ws = webSocket.<span class="hljs-title function_">createWebSocket</span>();</li><li>ws.<span class="hljs-title function_">close</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (!err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"close success"</span>)</li><li>  } <span class="hljs-keyword">else</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`close fail. Code: <span class="hljs-subst">${err.code}</span>, message: <span class="hljs-subst">${err.message}</span>`</span>)</li><li>  }</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1453px;">     <h3 id="close-1" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">close<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="close-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>close(options: WebSocketCloseOptions, callback: AsyncCallback&lt;boolean&gt;): void</p>     <p>根据参数options，关闭WebSocket连接，使用callback方式作为异步方法。</p>     <p><strong>需要权限</strong>：ohos.permission.INTERNET</p>     <p><strong>元服务API：</strong> 从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.14.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.14.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.14.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.14.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">options</td>         <td class="cellrowborder" width="25%">WebSocketCloseOptions</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">参考<a href="/consumer/cn/doc/harmonyos-references/js-apis-websocket#websocketcloseoptions">WebSocketCloseOptions</a>。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;boolean&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。true:关闭请求创建成功；false:关闭请求创建失败。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.14.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.14.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-xjf-c106="" class="highlight-div"><div _ngcontent-xjf-c106="" class="highlight-div-header"><div _ngcontent-xjf-c106="" class="highlight-div-header-left"><div _ngcontent-xjf-c106="" class="handle-button expand-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xjf-c106="" class="highlight-div-header-right"><div _ngcontent-xjf-c106="" class="handle-button ai-button"></div><div _ngcontent-xjf-c106="" class="handle-button line-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xjf-c106="" class="handle-button theme-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xjf-c106="" class="handle-button copy-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xjf-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { webSocket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> ws = webSocket.<span class="hljs-title function_">createWebSocket</span>();</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">options</span>: webSocket.<span class="hljs-property">WebSocketCloseOptions</span> | <span class="hljs-literal">undefined</span>;</li><li><span class="hljs-keyword">if</span> (options != <span class="hljs-literal">undefined</span>) {</li><li>    options.<span class="hljs-property">code</span> = <span class="hljs-number">1000</span></li><li>    options.<span class="hljs-property">reason</span> = <span class="hljs-string">"your reason"</span></li><li>}</li><li>ws.<span class="hljs-title function_">close</span>(options, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>    <span class="hljs-keyword">if</span> (!err) {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"close success"</span>)</li><li>    } <span class="hljs-keyword">else</span> {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`close fail. Code: <span class="hljs-subst">${err.code}</span>, message: <span class="hljs-subst">${err.message}</span>`</span>)</li><li>    }</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1483px;">     <h3 id="close-2" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">close<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="close-2" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>close(options?: WebSocketCloseOptions): Promise&lt;boolean&gt;</p>     <p>根据可选参数code和reason，关闭WebSocket连接。使用Promise异步回调。</p>     <p><strong>需要权限</strong>：ohos.permission.INTERNET</p>     <p><strong>元服务API：</strong> 从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.15.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.15.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.15.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.15.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">options</td>         <td class="cellrowborder" width="25%">WebSocketCloseOptions</td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">参考<a href="/consumer/cn/doc/harmonyos-references/js-apis-websocket#websocketcloseoptions">WebSocketCloseOptions</a>。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.15.10.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.15.10.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;boolean&gt;</td>         <td class="cellrowborder" width="50%">以Promise形式返回关闭连接的结果。true:关闭请求创建成功；false:关闭请求创建失败。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.15.13.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.15.13.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-xjf-c106="" class="highlight-div"><div _ngcontent-xjf-c106="" class="highlight-div-header"><div _ngcontent-xjf-c106="" class="highlight-div-header-left"><div _ngcontent-xjf-c106="" class="handle-button expand-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xjf-c106="" class="highlight-div-header-right"><div _ngcontent-xjf-c106="" class="handle-button ai-button"></div><div _ngcontent-xjf-c106="" class="handle-button line-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xjf-c106="" class="handle-button theme-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xjf-c106="" class="handle-button copy-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xjf-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { webSocket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> ws = webSocket.<span class="hljs-title function_">createWebSocket</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">options</span>: webSocket.<span class="hljs-property">WebSocketCloseOptions</span> | <span class="hljs-literal">undefined</span>;</li><li><span class="hljs-keyword">if</span> (options != <span class="hljs-literal">undefined</span>) {</li><li>    options.<span class="hljs-property">code</span> = <span class="hljs-number">1000</span></li><li>    options.<span class="hljs-property">reason</span> = <span class="hljs-string">"your reason"</span></li><li>}</li><li><span class="hljs-keyword">let</span> promise = ws.<span class="hljs-title function_">close</span>();</li><li>promise.<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">value: <span class="hljs-built_in">boolean</span></span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"close success"</span>)</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err:<span class="hljs-built_in">string</span></span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"close fail, error:"</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err))</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 963px;">     <h3 id="onopen" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">on('open')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onopen" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>on(type: 'open', callback: AsyncCallback&lt;Object&gt;): void</p>     <p>订阅WebSocket的打开事件，使用callback方式作为异步方法。该事件用于指示WebSocket是否连接成功。该接口需要在调用<a href="/consumer/cn/doc/harmonyos-references/js-apis-websocket#connect">connect</a>发起连接请求前调用。</p>     <p><strong>元服务API：</strong> 从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.16.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.16.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.16.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.16.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">订阅的事件类型。'open'：WebSocket的打开事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;Object&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-xjf-c106="" class="highlight-div"><div _ngcontent-xjf-c106="" class="highlight-div-header"><div _ngcontent-xjf-c106="" class="highlight-div-header-left"><div _ngcontent-xjf-c106="" class="handle-button expand-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xjf-c106="" class="highlight-div-header-right"><div _ngcontent-xjf-c106="" class="handle-button ai-button"></div><div _ngcontent-xjf-c106="" class="handle-button line-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xjf-c106="" class="handle-button theme-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xjf-c106="" class="handle-button copy-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xjf-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { webSocket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span>, <span class="hljs-title class_">Callback</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> ws= webSocket.<span class="hljs-title function_">createWebSocket</span>();</li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">OutValue</span> {</li><li>  <span class="hljs-attr">status</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span></li><li>  <span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">""</span></li><li>}</li><li>ws.<span class="hljs-title function_">on</span>(<span class="hljs-string">'open'</span>, <span class="hljs-function">(<span class="hljs-params">err: BusinessError, value: <span class="hljs-built_in">Object</span></span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"on open, status:"</span> + (value <span class="hljs-keyword">as</span> <span class="hljs-title class_">OutValue</span>).<span class="hljs-property">status</span> + <span class="hljs-string">", message:"</span> + (value <span class="hljs-keyword">as</span> <span class="hljs-title class_">OutValue</span>).<span class="hljs-property">message</span>)</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1127px;">     <h3 id="offopen" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">off('open')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="offopen" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>off(type: 'open', callback?: AsyncCallback&lt;Object&gt;): void</p>     <p>取消订阅WebSocket的打开事件，使用callback方式作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>可以指定传入on中的callback取消一个订阅，也可以不指定callback清空所有订阅。</p>      </div></div></div>     <p><strong>元服务API：</strong> 从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.17.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.17.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.17.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.17.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">取消订阅的事件类型。'open'：WebSocket的打开事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;Object&gt;</td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">回调函数。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-xjf-c106="" class="highlight-div"><div _ngcontent-xjf-c106="" class="highlight-div-header"><div _ngcontent-xjf-c106="" class="highlight-div-header-left"><div _ngcontent-xjf-c106="" class="handle-button expand-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xjf-c106="" class="highlight-div-header-right"><div _ngcontent-xjf-c106="" class="handle-button ai-button"></div><div _ngcontent-xjf-c106="" class="handle-button line-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xjf-c106="" class="handle-button theme-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xjf-c106="" class="handle-button copy-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xjf-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { webSocket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> ws = webSocket.<span class="hljs-title function_">createWebSocket</span>();</li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">OutValue</span> {</li><li>  <span class="hljs-attr">status</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span></li><li>  <span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">""</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-title function_">callback1</span> = (<span class="hljs-params">err: BusinessError, value: <span class="hljs-built_in">Object</span></span>) =&gt; {</li><li> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"on open, status:"</span> + ((value <span class="hljs-keyword">as</span> <span class="hljs-title class_">OutValue</span>).<span class="hljs-property">status</span> + <span class="hljs-string">", message:"</span> + (value <span class="hljs-keyword">as</span> <span class="hljs-title class_">OutValue</span>).<span class="hljs-property">message</span>))</li><li>}</li><li>ws.<span class="hljs-title function_">on</span>(<span class="hljs-string">'open'</span>, callback1);</li><li><span class="hljs-comment">// 可以指定传入on中的callback取消一个订阅，也可以不指定callback清空所有订阅。</span></li><li>ws.<span class="hljs-title function_">off</span>(<span class="hljs-string">'open'</span>, callback1);</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 983px;">     <h3 id="onmessage" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">on('message')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onmessage" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>on(type: 'message', callback: AsyncCallback&lt;string | ArrayBuffer&gt;): void</p>     <p>订阅WebSocket的接收服务器消息事件，使用callback方式作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>AsyncCallback中的数据可以是字符串（API version 6开始支持）或ArrayBuffer（API version 8开始支持）。</p>      </div></div></div>     <p><strong>元服务API：</strong> 从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.18.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.18.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.18.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.18.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">订阅的事件类型。'message'：WebSocket的接收服务器消息事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;string | ArrayBuffer <sup>8+</sup>&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-xjf-c106="" class="highlight-div"><div _ngcontent-xjf-c106="" class="highlight-div-header"><div _ngcontent-xjf-c106="" class="highlight-div-header-left"><div _ngcontent-xjf-c106="" class="handle-button expand-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xjf-c106="" class="highlight-div-header-right"><div _ngcontent-xjf-c106="" class="handle-button ai-button"></div><div _ngcontent-xjf-c106="" class="handle-button line-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xjf-c106="" class="handle-button theme-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xjf-c106="" class="handle-button copy-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xjf-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { webSocket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> ws = webSocket.<span class="hljs-title function_">createWebSocket</span>();</li><li>ws.<span class="hljs-title function_">on</span>(<span class="hljs-string">'message'</span>, <span class="hljs-function">(<span class="hljs-params">err: BusinessError&lt;<span class="hljs-built_in">void</span>&gt;, value: <span class="hljs-built_in">string</span> | <span class="hljs-built_in">ArrayBuffer</span></span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"on message, message:"</span> + value)</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 935px;">     <h3 id="offmessage" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">off('message')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="offmessage" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>off(type: 'message', callback?: AsyncCallback&lt;string | ArrayBuffer&gt;): void</p>     <p>取消订阅WebSocket的接收服务器消息事件，使用callback方式作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>AsyncCallback中的数据可以是字符串(API 6)或ArrayBuffer(API 8)。</p>       <p>可以指定传入on中的callback取消一个订阅，也可以不指定callback清空所有订阅。</p>      </div></div></div>     <p><strong>元服务API：</strong> 从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.19.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.19.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.19.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.19.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">取消订阅的事件类型。'message'：WebSocket的接收到服务器消息事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;string |ArrayBuffer <sup>8+</sup>&gt;</td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">回调函数。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-xjf-c106="" class="highlight-div"><div _ngcontent-xjf-c106="" class="highlight-div-header"><div _ngcontent-xjf-c106="" class="highlight-div-header-left"><div _ngcontent-xjf-c106="" class="handle-button expand-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xjf-c106="" class="highlight-div-header-right"><div _ngcontent-xjf-c106="" class="handle-button ai-button"></div><div _ngcontent-xjf-c106="" class="handle-button line-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xjf-c106="" class="handle-button theme-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xjf-c106="" class="handle-button copy-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xjf-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { webSocket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> ws = webSocket.<span class="hljs-title function_">createWebSocket</span>();</li><li>ws.<span class="hljs-title function_">off</span>(<span class="hljs-string">'message'</span>);</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 891px;">     <h3 id="onclose" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">on('close')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onclose" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>on(type: 'close', callback: AsyncCallback&lt;CloseResult&gt;): void</p>     <p>订阅WebSocket的关闭事件，使用callback方式作为异步方法。</p>     <p><strong>元服务API：</strong> 从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.20.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.20.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.20.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.20.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">订阅的事件类型。'close'：WebSocket的关闭事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;CloseResult&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">          <p>回调函数。</p>          <p>close：close错误码，reason：错误码说明</p></td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-xjf-c106="" class="highlight-div"><div _ngcontent-xjf-c106="" class="highlight-div-header"><div _ngcontent-xjf-c106="" class="highlight-div-header-left"><div _ngcontent-xjf-c106="" class="handle-button expand-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xjf-c106="" class="highlight-div-header-right"><div _ngcontent-xjf-c106="" class="handle-button ai-button"></div><div _ngcontent-xjf-c106="" class="handle-button line-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xjf-c106="" class="handle-button theme-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xjf-c106="" class="handle-button copy-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xjf-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { webSocket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> ws = webSocket.<span class="hljs-title function_">createWebSocket</span>();</li><li>ws.<span class="hljs-title function_">on</span>(<span class="hljs-string">'close'</span>, <span class="hljs-function">(<span class="hljs-params">err: BusinessError, value: webSocket.CloseResult</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"on close, code is "</span> + value.<span class="hljs-property">code</span> + <span class="hljs-string">", reason is "</span> + value.<span class="hljs-property">reason</span>)</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 935px;">     <h3 id="offclose" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">off('close')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="offclose" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>off(type: 'close', callback?: AsyncCallback&lt;CloseResult&gt;): void</p>     <p>取消订阅WebSocket的关闭事件，使用callback方式作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>可以指定传入on中的callback取消一个订阅，也可以不指定callback清空所有订阅。</p>      </div></div></div>     <p><strong>元服务API：</strong> 从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.21.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.21.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.21.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.21.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">取消订阅的事件类型。'close'：WebSocket的关闭事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;CloseResult&gt;</td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">          <p>回调函数。</p>          <p>close：close错误码，reason：错误码说明</p></td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-xjf-c106="" class="highlight-div"><div _ngcontent-xjf-c106="" class="highlight-div-header"><div _ngcontent-xjf-c106="" class="highlight-div-header-left"><div _ngcontent-xjf-c106="" class="handle-button expand-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xjf-c106="" class="highlight-div-header-right"><div _ngcontent-xjf-c106="" class="handle-button ai-button"></div><div _ngcontent-xjf-c106="" class="handle-button line-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xjf-c106="" class="handle-button theme-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xjf-c106="" class="handle-button copy-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xjf-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { webSocket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> ws = webSocket.<span class="hljs-title function_">createWebSocket</span>();</li><li>ws.<span class="hljs-title function_">off</span>(<span class="hljs-string">'close'</span>);</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 843px;">     <h3 id="onerror" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">on('error')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onerror" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>on(type: 'error', callback: ErrorCallback): void</p>     <p>订阅WebSocket的Error事件，使用callback方式作为异步方法。</p>     <p><strong>元服务API：</strong> 从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.22.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.22.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.22.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.22.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">订阅的事件类型。'error'：WebSocket的Error事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">ErrorCallback</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-xjf-c106="" class="highlight-div"><div _ngcontent-xjf-c106="" class="highlight-div-header"><div _ngcontent-xjf-c106="" class="highlight-div-header-left"><div _ngcontent-xjf-c106="" class="handle-button expand-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xjf-c106="" class="highlight-div-header-right"><div _ngcontent-xjf-c106="" class="handle-button ai-button"></div><div _ngcontent-xjf-c106="" class="handle-button line-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xjf-c106="" class="handle-button theme-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xjf-c106="" class="handle-button copy-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xjf-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { webSocket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> ws = webSocket.<span class="hljs-title function_">createWebSocket</span>();</li><li>ws.<span class="hljs-title function_">on</span>(<span class="hljs-string">'error'</span>, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`on error. Code: <span class="hljs-subst">${err.code}</span>, message: <span class="hljs-subst">${err.message}</span>`</span>)</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 887px;">     <h3 id="offerror" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">off('error')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="offerror" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>off(type: 'error', callback?: ErrorCallback): void</p>     <p>取消订阅WebSocket的Error事件，使用callback方式作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>可以指定传入on中的callback取消一个订阅，也可以不指定callback清空所有订阅。</p>      </div></div></div>     <p><strong>元服务API：</strong> 从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.23.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.23.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.23.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.23.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">取消订阅的事件类型。'error'：WebSocket的Error事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">ErrorCallback</td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">回调函数。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-xjf-c106="" class="highlight-div"><div _ngcontent-xjf-c106="" class="highlight-div-header"><div _ngcontent-xjf-c106="" class="highlight-div-header-left"><div _ngcontent-xjf-c106="" class="handle-button expand-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xjf-c106="" class="highlight-div-header-right"><div _ngcontent-xjf-c106="" class="handle-button ai-button"></div><div _ngcontent-xjf-c106="" class="handle-button line-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xjf-c106="" class="handle-button theme-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xjf-c106="" class="handle-button copy-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xjf-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { webSocket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> ws = webSocket.<span class="hljs-title function_">createWebSocket</span>();</li><li>ws.<span class="hljs-title function_">off</span>(<span class="hljs-string">'error'</span>);</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 795px;">     <h3 id="ondataend11" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">on('dataEnd')<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="ondataend11" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>on(type: 'dataEnd', callback: Callback&lt;void&gt;): void</p>     <p>订阅WebSocket的数据接收结束事件，使用callback方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.24.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.24.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.24.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.24.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">订阅的事件类型。'dataEnd'：WebSocket的数据接收结束事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;void&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-xjf-c106="" class="highlight-div"><div _ngcontent-xjf-c106="" class="highlight-div-header"><div _ngcontent-xjf-c106="" class="highlight-div-header-left"><div _ngcontent-xjf-c106="" class="handle-button expand-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xjf-c106="" class="highlight-div-header-right"><div _ngcontent-xjf-c106="" class="handle-button ai-button"></div><div _ngcontent-xjf-c106="" class="handle-button line-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xjf-c106="" class="handle-button theme-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xjf-c106="" class="handle-button copy-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xjf-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { webSocket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> ws = webSocket.<span class="hljs-title function_">createWebSocket</span>();</li><li>ws.<span class="hljs-title function_">on</span>(<span class="hljs-string">'dataEnd'</span>, <span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"on dataEnd"</span>)</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 839px;">     <h3 id="offdataend11" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">off('dataEnd')<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="offdataend11" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>off(type: 'dataEnd', callback?: Callback&lt;void&gt;): void</p>     <p>取消订阅WebSocket的数据接收结束事件，使用callback方式作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>可以指定传入on中的callback取消一个订阅，也可以不指定callback清空所有订阅。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.25.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.25.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.25.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.25.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">取消订阅的事件类型。'dataEnd'：WebSocket的数据接收结束事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;void&gt;</td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">回调函数。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-xjf-c106="" class="highlight-div"><div _ngcontent-xjf-c106="" class="highlight-div-header"><div _ngcontent-xjf-c106="" class="highlight-div-header-left"><div _ngcontent-xjf-c106="" class="handle-button expand-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xjf-c106="" class="highlight-div-header-right"><div _ngcontent-xjf-c106="" class="handle-button ai-button"></div><div _ngcontent-xjf-c106="" class="handle-button line-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xjf-c106="" class="handle-button theme-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xjf-c106="" class="handle-button copy-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xjf-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { webSocket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> ws = webSocket.<span class="hljs-title function_">createWebSocket</span>();</li><li>ws.<span class="hljs-title function_">off</span>(<span class="hljs-string">'dataEnd'</span>);</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 843px;">     <h3 id="onheaderreceive12" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">on('headerReceive')<sup>12+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onheaderreceive12" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>on(type: 'headerReceive', callback: Callback&lt;ResponseHeaders&gt;): void</p>     <p>订阅HTTP Response Header事件，使用callback方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.26.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.26.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.26.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.26.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">订阅的事件类型。'headerReceive'：WebSocket的headerReceive事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;ResponseHeaders&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数，返回订阅事件。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-xjf-c106="" class="highlight-div"><div _ngcontent-xjf-c106="" class="highlight-div-header"><div _ngcontent-xjf-c106="" class="highlight-div-header-left"><div _ngcontent-xjf-c106="" class="handle-button expand-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xjf-c106="" class="highlight-div-header-right"><div _ngcontent-xjf-c106="" class="handle-button ai-button"></div><div _ngcontent-xjf-c106="" class="handle-button line-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xjf-c106="" class="handle-button theme-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xjf-c106="" class="handle-button copy-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xjf-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { webSocket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> ws = webSocket.<span class="hljs-title function_">createWebSocket</span>();</li><li>ws.<span class="hljs-title function_">on</span>(<span class="hljs-string">'headerReceive'</span>, <span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"on headerReceive "</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data))</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 887px;">     <h3 id="offheaderreceive12" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">off('headerReceive')<sup>12+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="offheaderreceive12" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>off(type: 'headerReceive', callback?: Callback&lt;ResponseHeaders&gt;): void</p>     <p>取消订阅HTTP Response Header事件，使用callback方式作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>可以指定传入on中的callback取消一个订阅，也可以不指定callback清空所有订阅。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.27.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.27.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.27.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.27.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">取消订阅的事件类型。'headerReceive'：WebSocket的headerReceive事件。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;ResponseHeaders&gt;</td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">回调函数，返回订阅事件。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-xjf-c106="" class="highlight-div"><div _ngcontent-xjf-c106="" class="highlight-div-header"><div _ngcontent-xjf-c106="" class="highlight-div-header-left"><div _ngcontent-xjf-c106="" class="handle-button expand-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xjf-c106="" class="highlight-div-header-right"><div _ngcontent-xjf-c106="" class="handle-button ai-button"></div><div _ngcontent-xjf-c106="" class="handle-button line-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xjf-c106="" class="handle-button theme-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xjf-c106="" class="handle-button copy-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xjf-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { webSocket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> ws = webSocket.<span class="hljs-title function_">createWebSocket</span>();</li><li>ws.<span class="hljs-title function_">off</span>(<span class="hljs-string">'headerReceive'</span>);</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 750px;">     <h2 id="websocketcreatewebsocketserver19" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">webSocket.createWebSocketServer<sup>19+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="websocketcreatewebsocketserver19" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>createWebSocketServer(): WebSocketServer</p>     <p>创建一个WebSocketServer对象，包括启动服务、发送数据、关闭连接、列出客户端信息、停止服务，订阅/取消订阅webSocket连接的连接事件、接收到客户端消息事件、关闭事件和错误事件。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>目前该接口在TV中可正常调用，在其他设备中无效果，返回nullptr。</p>      </div></div></div>     <p><strong>系统能力</strong>: SystemCapability.Communication.NetStack</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.28.7.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.28.7.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-websocket#websocketserver19">WebSocketServer</a></td>         <td class="cellrowborder" width="50%">返回一个WebSocketServer对象，里面包括start、listAllConnections、send、close、stop、on和off方法。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-xjf-c106="" class="highlight-div"><div _ngcontent-xjf-c106="" class="highlight-div-header"><div _ngcontent-xjf-c106="" class="highlight-div-header-left"><div _ngcontent-xjf-c106="" class="handle-button expand-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xjf-c106="" class="highlight-div-header-right"><div _ngcontent-xjf-c106="" class="handle-button ai-button"></div><div _ngcontent-xjf-c106="" class="handle-button line-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xjf-c106="" class="handle-button theme-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xjf-c106="" class="handle-button copy-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xjf-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">let</span> <span class="hljs-attr">ws</span>: webSocket.<span class="hljs-property">WebSocketServer</span> = webSocket.<span class="hljs-title function_">createWebSocketServer</span>();</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 182px;">     <h2 id="websocketserver19" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">WebSocketServer<sup>19+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="websocketserver19" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>在调用WebSocketServer方法前，需要先通过<a href="/consumer/cn/doc/harmonyos-references/js-apis-websocket#websocketcreatewebsocketserver19">webSocket.createWebSocketServer</a>创建一个WebSocketServer。</p>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1820px;">     <h3 id="start19" device-type="phone,2in1,tablet,wearable,lite_wearable,tv" class="firsth2">start<sup>19+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="start19" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>start(config: WebSocketServerConfig): Promise&lt;boolean&gt;</p>     <p>配置config参数，启动服务端service。使用Promise异步回调。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>可通过监听error事件获得该接口的执行结果，错误码说明参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-net-websocket">webSocket错误码</a>。</p>      </div></div></div>     <p><strong>需要权限</strong>: ohos.permission.INTERNET</p>     <p><strong>系统能力</strong>: SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.30.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.30.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.30.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.30.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">config</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-websocket#websocketserverconfig19">WebSocketServerConfig</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">启动websocketServer服务器。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.30.10.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.30.10.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;boolean&gt;</td>         <td class="cellrowborder" width="50%">promise对象。返回true表示服务器启动成功；返回false表示服务启动失败。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-net-websocket">webSocket错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.30.13.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.30.13.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2302002</td>         <td class="cellrowborder" width="50%">Websocket certificate file does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2302004</td>         <td class="cellrowborder" width="50%">Can't listen on the given NIC.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2302005</td>         <td class="cellrowborder" width="50%">Can't listen on the given Port.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2302999</td>         <td class="cellrowborder" width="50%">Websocket other unknown error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-xjf-c106="" class="highlight-div"><div _ngcontent-xjf-c106="" class="highlight-div-header"><div _ngcontent-xjf-c106="" class="highlight-div-header-left"><div _ngcontent-xjf-c106="" class="handle-button expand-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xjf-c106="" class="highlight-div-header-right"><div _ngcontent-xjf-c106="" class="handle-button ai-button"></div><div _ngcontent-xjf-c106="" class="handle-button line-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xjf-c106="" class="handle-button theme-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xjf-c106="" class="handle-button copy-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xjf-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { webSocket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">localServer</span>: webSocket.<span class="hljs-property">WebSocketServer</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">config</span>: webSocket.<span class="hljs-property">WebSocketServerConfig</span> = {</li><li>  <span class="hljs-attr">serverPort</span>: <span class="hljs-number">8080</span>, <span class="hljs-comment">// 监听端口</span></li><li>  <span class="hljs-attr">maxConcurrentClientsNumber</span>: <span class="hljs-number">10</span>,</li><li>  <span class="hljs-attr">maxConnectionsForOneClient</span>: <span class="hljs-number">10</span>,</li><li>}</li><li>
</li><li>localServer = webSocket.<span class="hljs-title function_">createWebSocketServer</span>();</li><li>localServer.<span class="hljs-title function_">start</span>(config).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">success: <span class="hljs-built_in">boolean</span></span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (success) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'webSocket server start success'</span>);</li><li>  } <span class="hljs-keyword">else</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'websocket server start failed'</span>);</li><li>  }</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Failed to start. Code: <span class="hljs-subst">${error.code}</span>, message: <span class="hljs-subst">${error.message}</span>`</span>);</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 2172px;">     <h3 id="send19" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">send<sup>19+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="send19" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>send(data: string | ArrayBuffer, connection: WebSocketConnection): Promise&lt;boolean&gt;</p>     <p>通过WebSocket连接发送数据。使用Promise异步回调。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>send接口必须在监听到connect事件后才可以调用。</p>      </div></div></div>     <p><strong>需要权限</strong>: ohos.permission.INTERNET</p>     <p><strong>系统能力</strong>: SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.31.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.31.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.31.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.31.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">data</td>         <td class="cellrowborder" width="25%">string | ArrayBuffer</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">服务端发送消息的数据，同时支持string（字符串）和ArrayBuffer（二进制）类型。最大支持发送5242864字节数据(即5 * 1024 * 1024 - 16)，超过该大小会返回401错误码。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">connection</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-websocket#websocketconnection19">WebSocketConnection</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">发送的客户端信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.31.10.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.31.10.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;boolean&gt;</td>         <td class="cellrowborder" width="50%">promise对象。返回true表示发送请求创建成功；返回false表示发送请求创建失败。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-net-websocket">webSocket错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.31.13.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.31.13.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2302006</td>         <td class="cellrowborder" width="50%">websocket connection does not exist.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-xjf-c106="" class="highlight-div"><div _ngcontent-xjf-c106="" class="highlight-div-header"><div _ngcontent-xjf-c106="" class="highlight-div-header-left"><div _ngcontent-xjf-c106="" class="handle-button expand-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xjf-c106="" class="highlight-div-header-right"><div _ngcontent-xjf-c106="" class="handle-button ai-button"></div><div _ngcontent-xjf-c106="" class="handle-button line-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xjf-c106="" class="handle-button theme-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xjf-c106="" class="handle-button copy-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xjf-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { webSocket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">localServer</span>: webSocket.<span class="hljs-property">WebSocketServer</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">config</span>: webSocket.<span class="hljs-property">WebSocketServerConfig</span> = {</li><li>  <span class="hljs-attr">serverPort</span>: <span class="hljs-number">8080</span>, <span class="hljs-comment">// 监听端口</span></li><li>  <span class="hljs-attr">maxConcurrentClientsNumber</span>: <span class="hljs-number">10</span>,</li><li>  <span class="hljs-attr">maxConnectionsForOneClient</span>: <span class="hljs-number">10</span>,</li><li>}</li><li>
</li><li>localServer = webSocket.<span class="hljs-title function_">createWebSocketServer</span>();</li><li>localServer.<span class="hljs-title function_">start</span>(config).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">success: <span class="hljs-built_in">boolean</span></span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (success) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'webSocket server start success'</span>);</li><li>  } <span class="hljs-keyword">else</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'websocket server start failed'</span>);</li><li>  }</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Failed to start. Code: <span class="hljs-subst">${error.code}</span>, message: <span class="hljs-subst">${error.message}</span>`</span>);</li><li>});</li><li>
</li><li>localServer.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connect'</span>, <span class="hljs-keyword">async</span> (<span class="hljs-attr">connection</span>: webSocket.<span class="hljs-property">WebSocketConnection</span>) =&gt; {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`New client connected! Client ip: <span class="hljs-subst">${connection.clientIP}</span>, Client port: <span class="hljs-subst">${connection.clientPort}</span>`</span>);</li><li>  <span class="hljs-comment">// 当收到on('connect')事件时，可以通过send()方法与客户端进行通信</span></li><li>  localServer.<span class="hljs-title function_">send</span>(<span class="hljs-string">"Hello, I'm server!"</span>, connection).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">success: <span class="hljs-built_in">boolean</span></span>) =&gt;</span> {</li><li>    <span class="hljs-keyword">if</span> (success) {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'message send successfully'</span>);</li><li>    } <span class="hljs-keyword">else</span> {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'message send failed'</span>);</li><li>    }</li><li>  }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error: BusinessError</span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`message send failed, Code: <span class="hljs-subst">${error.code}</span>, message: <span class="hljs-subst">${error.message}</span>`</span>);</li><li>  });</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1685px;">     <h3 id="listallconnections19" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">listAllConnections<sup>19+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="listallconnections19" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>listAllConnections(): WebSocketConnection[]</p>     <p>获取与服务端连接的所有客户端信息。</p>     <p><strong>需要权限</strong>: ohos.permission.INTERNET</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.32.7.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.32.7.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-websocket#websocketconnection19">WebSocketConnection[]</a></td>         <td class="cellrowborder" width="50%">以字符串数组形式返回所有客户端的信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.32.10.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.32.10.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-xjf-c106="" class="highlight-div"><div _ngcontent-xjf-c106="" class="highlight-div-header"><div _ngcontent-xjf-c106="" class="highlight-div-header-left"><div _ngcontent-xjf-c106="" class="handle-button expand-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xjf-c106="" class="highlight-div-header-right"><div _ngcontent-xjf-c106="" class="handle-button ai-button"></div><div _ngcontent-xjf-c106="" class="handle-button line-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xjf-c106="" class="handle-button theme-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xjf-c106="" class="handle-button copy-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xjf-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { webSocket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">connections</span>: webSocket.<span class="hljs-property">WebSocketConnection</span>[] = [];</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">localServer</span>: webSocket.<span class="hljs-property">WebSocketServer</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">config</span>: webSocket.<span class="hljs-property">WebSocketServerConfig</span> = {</li><li>  <span class="hljs-attr">serverPort</span>: <span class="hljs-number">8080</span>, <span class="hljs-comment">// 监听端口</span></li><li>  <span class="hljs-attr">maxConcurrentClientsNumber</span>: <span class="hljs-number">10</span>,</li><li>  <span class="hljs-attr">maxConnectionsForOneClient</span>: <span class="hljs-number">10</span>,</li><li>}</li><li>
</li><li>localServer = webSocket.<span class="hljs-title function_">createWebSocketServer</span>();</li><li>localServer.<span class="hljs-title function_">start</span>(config).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">success: <span class="hljs-built_in">boolean</span></span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (success) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'webSocket server start success'</span>);</li><li>  } <span class="hljs-keyword">else</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'websocket server start failed'</span>);</li><li>  }</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Failed to start. Code: <span class="hljs-subst">${error.code}</span>, message: <span class="hljs-subst">${error.message}</span>`</span>);</li><li>});</li><li>
</li><li>localServer.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connect'</span>, <span class="hljs-keyword">async</span> (<span class="hljs-attr">connection</span>: webSocket.<span class="hljs-property">WebSocketConnection</span>) =&gt; {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`New client connected! Client ip: <span class="hljs-subst">${connection.clientIP}</span>, Client port: <span class="hljs-subst">${connection.clientPort}</span>`</span>);</li><li>  <span class="hljs-keyword">try</span> {</li><li>    connections = <span class="hljs-keyword">await</span> localServer.<span class="hljs-title function_">listAllConnections</span>();</li><li>    <span class="hljs-keyword">if</span> (connections.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'client list is empty'</span>);</li><li>    } <span class="hljs-keyword">else</span> {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`client list cnt: <span class="hljs-subst">${connections.length}</span>, client connections list is: <span class="hljs-subst">${connections}</span>`</span>);</li><li>    }</li><li>  } <span class="hljs-keyword">catch</span> (error) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Failed to listAllConnections. Code: <span class="hljs-subst">${error.code}</span>, message: <span class="hljs-subst">${error.message}</span>`</span>);</li><li>  }</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1984px;">     <h3 id="close19" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">close<sup>19+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="close19" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>close(connection: WebSocketConnection, options?: webSocket.WebSocketCloseOptions): Promise&lt;boolean&gt;</p>     <p>关闭指定websocket连接。使用Promise异步回调。</p>     <p><strong>需要权限</strong>：ohos.permission.INTERNET</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.33.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.33.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.33.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.33.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">connection</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-websocket#websocketconnection19">WebSocketConnection</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">客户端信息，包括客户端的ip地址和端口号port。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">options</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-websocket#websocketcloseoptions">webSocket.WebSocketCloseOptions</a></td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">          <p>关闭WebSocket连接时，可选参数的类型和说明。</p>          <p>- 错误码默认：200。原因值默认：Websocket connect failed。</p></td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.33.9.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.33.9.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;boolean&gt;</td>         <td class="cellrowborder" width="50%">promise对象。返回true表示关闭请求创建成功；返回false表示关闭请求创建失败。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-net-websocket">webSocket错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.33.12.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.33.12.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">2302006</td>         <td class="cellrowborder" width="50%">websocket connection does not exist.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-xjf-c106="" class="highlight-div"><div _ngcontent-xjf-c106="" class="highlight-div-header"><div _ngcontent-xjf-c106="" class="highlight-div-header-left"><div _ngcontent-xjf-c106="" class="handle-button expand-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xjf-c106="" class="highlight-div-header-right"><div _ngcontent-xjf-c106="" class="handle-button ai-button"></div><div _ngcontent-xjf-c106="" class="handle-button line-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xjf-c106="" class="handle-button theme-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xjf-c106="" class="handle-button copy-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xjf-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { webSocket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">localServer</span>: webSocket.<span class="hljs-property">WebSocketServer</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">config</span>: webSocket.<span class="hljs-property">WebSocketServerConfig</span> = {</li><li>  <span class="hljs-attr">serverPort</span>: <span class="hljs-number">8080</span>, <span class="hljs-comment">// 监听端口</span></li><li>  <span class="hljs-attr">maxConcurrentClientsNumber</span>: <span class="hljs-number">10</span>,</li><li>  <span class="hljs-attr">maxConnectionsForOneClient</span>: <span class="hljs-number">10</span>,</li><li>}</li><li>
</li><li>localServer = webSocket.<span class="hljs-title function_">createWebSocketServer</span>();</li><li>localServer.<span class="hljs-title function_">start</span>(config).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">success: <span class="hljs-built_in">boolean</span></span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (success) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'webSocket server start success'</span>);</li><li>  } <span class="hljs-keyword">else</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'websocket server start failed'</span>);</li><li>  }</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Failed to start. Code: <span class="hljs-subst">${error.code}</span>, message: <span class="hljs-subst">${error.message}</span>`</span>);</li><li>});</li><li>
</li><li>localServer.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connect'</span>, <span class="hljs-function">(<span class="hljs-params">connection: webSocket.WebSocketConnection</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`New client connected! Client ip: <span class="hljs-subst">${connection.clientIP}</span>, Client port: <span class="hljs-subst">${connection.clientPort}</span>`</span>);</li><li>  localServer.<span class="hljs-title function_">close</span>(connection).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">success: <span class="hljs-built_in">boolean</span></span>) =&gt;</span> {</li><li>    <span class="hljs-keyword">if</span> (success) {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'close client successfully'</span>);</li><li>    } <span class="hljs-keyword">else</span> {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'close client failed'</span>);</li><li>    }</li><li>  });</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1541px;">     <h3 id="stop19" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">stop<sup>19+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="stop19" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>stop(): Promise&lt;boolean&gt;</p>     <p>停止服务端服务。使用Promise异步回调。</p>     <p><strong>需要权限</strong>：ohos.permission.INTERNET</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.34.7.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.34.7.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;boolean&gt;</td>         <td class="cellrowborder" width="50%">promise对象。返回true表示停止服务端service请求创建成功；返回false表示停止服务端service请求创建失败。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.34.10.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.34.10.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-xjf-c106="" class="highlight-div"><div _ngcontent-xjf-c106="" class="highlight-div-header"><div _ngcontent-xjf-c106="" class="highlight-div-header-left"><div _ngcontent-xjf-c106="" class="handle-button expand-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xjf-c106="" class="highlight-div-header-right"><div _ngcontent-xjf-c106="" class="handle-button ai-button"></div><div _ngcontent-xjf-c106="" class="handle-button line-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xjf-c106="" class="handle-button theme-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xjf-c106="" class="handle-button copy-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xjf-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { webSocket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">localServer</span>: webSocket.<span class="hljs-property">WebSocketServer</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">config</span>: webSocket.<span class="hljs-property">WebSocketServerConfig</span> = {</li><li>  <span class="hljs-attr">serverPort</span>: <span class="hljs-number">8080</span>, <span class="hljs-comment">// 监听端口</span></li><li>  <span class="hljs-attr">maxConcurrentClientsNumber</span>: <span class="hljs-number">10</span>,</li><li>  <span class="hljs-attr">maxConnectionsForOneClient</span>: <span class="hljs-number">10</span>,</li><li>}</li><li>
</li><li>localServer = webSocket.<span class="hljs-title function_">createWebSocketServer</span>();</li><li>localServer.<span class="hljs-title function_">start</span>(config).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">success: <span class="hljs-built_in">boolean</span></span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (success) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'webSocket server start success'</span>);</li><li>  } <span class="hljs-keyword">else</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'websocket server start failed'</span>);</li><li>  }</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Failed to start. Code: <span class="hljs-subst">${error.code}</span>, message: <span class="hljs-subst">${error.message}</span>`</span>);</li><li>});</li><li>
</li><li>localServer.<span class="hljs-title function_">stop</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">success: <span class="hljs-built_in">boolean</span></span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (success) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'server stop service successfully'</span>);</li><li>  } <span class="hljs-keyword">else</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'server stop service failed'</span>);</li><li>  }</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 867px;">     <h3 id="onconnect19" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">on('connect')<sup>19+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onconnect19" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>on(type: 'connect', callback: Callback&lt;WebSocketConnection&gt;): void</p>     <p>订阅WebSocketServer的连接事件（客户端与服务端建链成功），使用callback方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.35.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.35.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.35.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.35.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">事件回调类型，支持的事件为'connect'，当onconnect()调用完成，客户端与服务端建链成功。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-websocket#websocketconnection19">WebSocketConnection</a>&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。连接的客户端信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-xjf-c106="" class="highlight-div"><div _ngcontent-xjf-c106="" class="highlight-div-header"><div _ngcontent-xjf-c106="" class="highlight-div-header-left"><div _ngcontent-xjf-c106="" class="handle-button expand-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xjf-c106="" class="highlight-div-header-right"><div _ngcontent-xjf-c106="" class="handle-button ai-button"></div><div _ngcontent-xjf-c106="" class="handle-button line-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xjf-c106="" class="handle-button theme-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xjf-c106="" class="handle-button copy-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xjf-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { webSocket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span>, <span class="hljs-title class_">Callback</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> localServer = webSocket.<span class="hljs-title function_">createWebSocketServer</span>();</li><li>localServer.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connect'</span>, <span class="hljs-function">(<span class="hljs-params">connection: webSocket.WebSocketConnection</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`New client connected! Client ip: <span class="hljs-subst">${connection.clientIP}</span>, Client port: <span class="hljs-subst">${connection.clientPort}</span>`</span>);</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 911px;">     <h3 id="offconnect19" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">off('connect')<sup>19+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="offconnect19" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>off(type: 'connect', callback?: Callback&lt;WebSocketConnection&gt;): void</p>     <p>取消订阅WebSocketServer的连接事件（客户端与服务端建链成功），使用callback方式作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>可以指定传入on中的callback取消一个订阅，也可以不指定callback清空所有订阅。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.36.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.36.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.36.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.36.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">事件回调类型，支持的事件为'connect'，当offconnect()调用完成，取消监听连接事件成功。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-websocket#websocketconnection19">WebSocketConnection</a>&gt;</td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">回调函数。连接的客户端信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-xjf-c106="" class="highlight-div"><div _ngcontent-xjf-c106="" class="highlight-div-header"><div _ngcontent-xjf-c106="" class="highlight-div-header-left"><div _ngcontent-xjf-c106="" class="handle-button expand-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xjf-c106="" class="highlight-div-header-right"><div _ngcontent-xjf-c106="" class="handle-button ai-button"></div><div _ngcontent-xjf-c106="" class="handle-button line-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xjf-c106="" class="handle-button theme-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xjf-c106="" class="handle-button copy-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xjf-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { webSocket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> localServer = webSocket.<span class="hljs-title function_">createWebSocketServer</span>();</li><li>localServer.<span class="hljs-title function_">off</span>(<span class="hljs-string">'connect'</span>);</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 939px;">     <h3 id="onmessagereceive19" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">on('messageReceive')<sup>19+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onmessagereceive19" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>on(type: 'messageReceive', callback: Callback&lt;WebSocketMessage&gt;): void</p>     <p>订阅WebSocketServer的接收客户端消息的事件，使用callback方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.37.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.37.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.37.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.37.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">事件回调类型，支持的事件为'messageReceive'，当onmessageReceive()调用完成，接收到客户端消息成功。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-websocket#websocketmessage19">WebSocketMessage</a>&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">          <p>回调函数。</p>          <p>clientconnection:客户端信息，data:客户端发送的数据消息。</p></td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-xjf-c106="" class="highlight-div"><div _ngcontent-xjf-c106="" class="highlight-div-header"><div _ngcontent-xjf-c106="" class="highlight-div-header-left"><div _ngcontent-xjf-c106="" class="handle-button expand-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xjf-c106="" class="highlight-div-header-right"><div _ngcontent-xjf-c106="" class="handle-button ai-button"></div><div _ngcontent-xjf-c106="" class="handle-button line-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xjf-c106="" class="handle-button theme-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xjf-c106="" class="handle-button copy-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xjf-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { webSocket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span>, <span class="hljs-title class_">Callback</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> localServer = webSocket.<span class="hljs-title function_">createWebSocketServer</span>();</li><li>localServer.<span class="hljs-title function_">on</span>(<span class="hljs-string">'messageReceive'</span>, <span class="hljs-function">(<span class="hljs-params">message: webSocket.WebSocketMessage</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`on message received, client: <span class="hljs-subst">${message.clientConnection}</span>, data: <span class="hljs-subst">${message.data}</span>`</span>);</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1055px;">     <h3 id="offmessagereceive19" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">off('messageReceive')<sup>19+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="offmessagereceive19" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>off(type: 'messageReceive', callback?: Callback&lt;WebSocketMessage&gt;): void</p>     <p>取消订阅WebSocketServer的接收到客户端消息事件，使用callback方式作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>可以指定传入on中的callback取消一个订阅，也可以不指定callback清空所有订阅。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.38.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.38.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.38.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.38.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">事件回调类型，支持的事件为'messageReceive'，当offmessageReceive()调用完成，取消订阅接收客户端消息成功。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-websocket#websocketmessage19">WebSocketMessage</a>&gt;</td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">          <p>从指定客户端接收到的消息，包括客户端的信息和数据。</p>          <p>- clientconnection：客户端信息。</p>          <p>- data：客户端发送的消息。</p></td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-xjf-c106="" class="highlight-div"><div _ngcontent-xjf-c106="" class="highlight-div-header"><div _ngcontent-xjf-c106="" class="highlight-div-header-left"><div _ngcontent-xjf-c106="" class="handle-button expand-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xjf-c106="" class="highlight-div-header-right"><div _ngcontent-xjf-c106="" class="handle-button ai-button"></div><div _ngcontent-xjf-c106="" class="handle-button line-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xjf-c106="" class="handle-button theme-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xjf-c106="" class="handle-button copy-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xjf-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { webSocket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span>, <span class="hljs-title class_">Callback</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> localServer = webSocket.<span class="hljs-title function_">createWebSocketServer</span>();</li><li>localServer.<span class="hljs-title function_">off</span>(<span class="hljs-string">'messageReceive'</span>);</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 867px;">     <h3 id="onclose19" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">on('close')<sup>19+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onclose19" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>on(type: 'close', callback: ClientConnectionCloseCallback): void</p>     <p>订阅WebSocketServer的关闭事件，使用callback方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.39.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.39.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.39.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.39.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">事件回调类型，支持的事件为'close'，当onclose()调用完成，连接关闭成功。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-websocket#clientconnectionclosecallback19">ClientConnectionCloseCallback</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">          <p>回调函数。</p>          <p>close：close错误码；reason：错误码说明。</p></td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-xjf-c106="" class="highlight-div"><div _ngcontent-xjf-c106="" class="highlight-div-header"><div _ngcontent-xjf-c106="" class="highlight-div-header-left"><div _ngcontent-xjf-c106="" class="handle-button expand-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xjf-c106="" class="highlight-div-header-right"><div _ngcontent-xjf-c106="" class="handle-button ai-button"></div><div _ngcontent-xjf-c106="" class="handle-button line-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xjf-c106="" class="handle-button theme-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xjf-c106="" class="handle-button copy-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xjf-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { webSocket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> localServer = webSocket.<span class="hljs-title function_">createWebSocketServer</span>();</li><li>localServer.<span class="hljs-title function_">on</span>(<span class="hljs-string">'close'</span>, <span class="hljs-function">(<span class="hljs-params">clientConnection: webSocket.WebSocketConnection, closeReason: webSocket.CloseResult</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`client close, client: <span class="hljs-subst">${clientConnection}</span>, closeReason: Code: <span class="hljs-subst">${closeReason.code}</span>, reason: <span class="hljs-subst">${closeReason.reason}</span>`</span>);</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 935px;">     <h3 id="offclose19" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">off('close')<sup>19+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="offclose19" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>off(type: 'close', callback?: ClientConnectionCloseCallback): void</p>     <p>取消订阅WebSocketServer的关闭事件，使用callback方式作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>可以指定传入on中的callback取消一个订阅，也可以不指定callback清空所有订阅。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.40.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.40.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.40.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.40.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">事件回调类型，支持的事件为'close'，当offclose()调用完成，取消订阅连接关闭事件成功。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-websocket#clientconnectionclosecallback19">ClientConnectionCloseCallback</a></td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">          <p>回调函数。</p>          <p>close：close错误码；reason：错误码说明。</p></td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-xjf-c106="" class="highlight-div"><div _ngcontent-xjf-c106="" class="highlight-div-header"><div _ngcontent-xjf-c106="" class="highlight-div-header-left"><div _ngcontent-xjf-c106="" class="handle-button expand-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xjf-c106="" class="highlight-div-header-right"><div _ngcontent-xjf-c106="" class="handle-button ai-button"></div><div _ngcontent-xjf-c106="" class="handle-button line-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xjf-c106="" class="handle-button theme-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xjf-c106="" class="handle-button copy-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xjf-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { webSocket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> localServer = webSocket.<span class="hljs-title function_">createWebSocketServer</span>();</li><li>localServer.<span class="hljs-title function_">off</span>(<span class="hljs-string">'close'</span>);</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 819px;">     <h3 id="onerror19" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">on('error')<sup>19+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onerror19" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>on(type: 'error', callback: ErrorCallback): void</p>     <p>订阅WebSocketServer的Error事件，使用callback方式作为异步方法。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.41.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.41.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.41.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.41.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">事件回调类型，支持的事件为'error'，当onerror()调用完成，error事件发生。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-base#errorcallback">ErrorCallback</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-xjf-c106="" class="highlight-div"><div _ngcontent-xjf-c106="" class="highlight-div-header"><div _ngcontent-xjf-c106="" class="highlight-div-header-left"><div _ngcontent-xjf-c106="" class="handle-button expand-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xjf-c106="" class="highlight-div-header-right"><div _ngcontent-xjf-c106="" class="handle-button ai-button"></div><div _ngcontent-xjf-c106="" class="handle-button line-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xjf-c106="" class="handle-button theme-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xjf-c106="" class="handle-button copy-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xjf-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { webSocket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">wsServer</span>: webSocket.<span class="hljs-property">WebSocketServer</span> = webSocket.<span class="hljs-title function_">createWebSocketServer</span>();</li><li>wsServer.<span class="hljs-title function_">on</span>(<span class="hljs-string">'error'</span>, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`error. Code: <span class="hljs-subst">${err.code}</span>, message: <span class="hljs-subst">${err.message}</span>`</span>);</li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 887px;">     <h3 id="offerror19" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">off('error')<sup>19+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="offerror19" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>off(type: 'error', callback?: ErrorCallback): void</p>     <p>取消订阅WebSocketServer的Error事件，使用callback方式作为异步方法。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>可以指定传入on中的callback取消一个订阅，也可以不指定callback清空所有订阅。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.42.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.42.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.42.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.42.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">事件回调类型，支持的事件为'error'，当offerror()调用完成，取消订阅error事件成功。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-base#errorcallback">ErrorCallback</a></td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">回调函数。默认值：200。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-xjf-c106="" class="highlight-div"><div _ngcontent-xjf-c106="" class="highlight-div-header"><div _ngcontent-xjf-c106="" class="highlight-div-header-left"><div _ngcontent-xjf-c106="" class="handle-button expand-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xjf-c106="" class="highlight-div-header-right"><div _ngcontent-xjf-c106="" class="handle-button ai-button"></div><div _ngcontent-xjf-c106="" class="handle-button line-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xjf-c106="" class="handle-button theme-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xjf-c106="" class="handle-button copy-button"><div _ngcontent-xjf-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xjf-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { webSocket } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> localServer = webSocket.<span class="hljs-title function_">createWebSocketServer</span>();</li><li>localServer.<span class="hljs-title function_">off</span>(<span class="hljs-string">'error'</span>);</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1848px;">     <h2 id="websocketrequestoptions" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">WebSocketRequestOptions<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="websocketrequestoptions" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>建立WebSocket连接时，可选参数的类型和说明。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.43.4.1.6.1.1" width="20%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.43.4.1.6.1.2" width="20%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.43.4.1.6.1.3" width="20%">只读</th>         <th align="left" class="cellrowborder" id="mcps1.3.43.4.1.6.1.4" width="20%">可选</th>         <th align="left" class="cellrowborder" id="mcps1.3.43.4.1.6.1.5" width="20%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">header</td>         <td class="cellrowborder" width="20%">Object</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">          <p>建立WebSocket连接可选参数，代表建立连接时携带的HTTP头信息。参数内容自定义，也可以不指定。</p>          <p><strong>元服务API：</strong> 从API version 11开始，该接口支持在元服务中使用。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">caPath<sup>11+</sup></td>         <td class="cellrowborder" width="20%">string</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">如果设置了此参数，系统将使用用户指定路径的CA证书，(开发者需保证该路径下CA证书的可访问性)，否则将使用系统预设CA证书，系统预设CA证书位置：/etc/ssl/certs/cacert.pem。证书路径为沙箱映射路径（开发者可通过UIAbilityContext提供的能力获取应用沙箱路径）。目前仅支持格式为pem的文本证书。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">clientCert<sup>11+</sup></td>         <td class="cellrowborder" width="20%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-websocket#clientcert11">ClientCert</a></td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">支持传输客户端证书。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">proxy<sup>12+</sup></td>         <td class="cellrowborder" width="20%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-websocket#proxyconfiguration12">ProxyConfiguration</a></td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">通信过程中的代理信息，默认使用系统网络代理。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">protocol<sup>12+</sup></td>         <td class="cellrowborder" width="20%">string</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">自定义Sec-WebSocket-Protocol字段，默认为""。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">skipServerCertVerification<sup>20+</sup></td>         <td class="cellrowborder" width="20%">boolean</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">是否跳过服务器证书验证。true表示跳过服务器证书验证，false表示不跳过服务器证书验证。默认为false。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">pingInterval<sup>21+</sup></td>         <td class="cellrowborder" width="20%">number</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">自定义<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/websocket-connection#场景介绍" target="_blank">心跳检测</a>时间，默认为30s。每pingInterval周期会发起心跳检测，设置为0则表示关闭心跳检测。最大值：30000s，最小值：0s。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">pongTimeout<sup>21+</sup></td>         <td class="cellrowborder" width="20%">number</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">自定义发起心跳检测后，超时断开时间，默认为30s。发起心跳检测后若pongTimeout时间未响应则断开连接。最大值：30000s，最小值：0s。pongTimeout须小于等于pingInterval。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 447px;">     <h2 id="clientcert11" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">ClientCert<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="clientcert11" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>客户端证书类型。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.44.4.1.6.1.1" width="20%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.44.4.1.6.1.2" width="20%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.44.4.1.6.1.3" width="20%">只读</th>         <th align="left" class="cellrowborder" id="mcps1.3.44.4.1.6.1.4" width="20%">可选</th>         <th align="left" class="cellrowborder" id="mcps1.3.44.4.1.6.1.5" width="20%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">certPath</td>         <td class="cellrowborder" width="20%">string</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">证书路径。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">keyPath</td>         <td class="cellrowborder" width="20%">string</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">证书密钥的路径。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">keyPassword</td>         <td class="cellrowborder" width="20%">string</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">证书密钥的密码。缺省为空字符串。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 511px;">     <h2 id="proxyconfiguration12" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">ProxyConfiguration<sup>12+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="proxyconfiguration12" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>type ProxyConfiguration = 'system' | 'no-proxy' | HttpProxy</p>     <p>网络代理配置信息</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.45.5.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.45.5.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">'system'</td>         <td class="cellrowborder" width="50%">使用系统默认网络代理。</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">'no-proxy'</td>         <td class="cellrowborder" width="50%">不使用网络代理。</td>        </tr>        <tr>         <td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-net-connection#httpproxy10">HttpProxy</a></td>         <td class="cellrowborder" width="50%">使用指定的网络代理。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 642px;">     <h2 id="websocketcloseoptions" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">WebSocketCloseOptions<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="websocketcloseoptions" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>关闭WebSocket连接时，可选参数的类型和说明。</p>     <p><strong>元服务API：</strong> 从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.46.5.1.6.1.1" width="20%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.46.5.1.6.1.2" width="20%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.46.5.1.6.1.3" width="20%">只读</th>         <th align="left" class="cellrowborder" id="mcps1.3.46.5.1.6.1.4" width="20%">可选</th>         <th align="left" class="cellrowborder" id="mcps1.3.46.5.1.6.1.5" width="20%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">code</td>         <td class="cellrowborder" width="20%">number</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">错误码，关闭WebSocket连接时的可选参数，可根据实际情况来填。传入值需为正整数，默认值为1000。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">reason</td>         <td class="cellrowborder" width="20%">string</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">原因值，关闭WebSocket连接时的可选参数，可根据实际情况来填。默认值为空字符串（""）。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 522px;">     <h2 id="closeresult10" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">CloseResult<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="closeresult10" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>关闭WebSocket连接时，订阅close事件得到的关闭结果。</p>     <p><strong>元服务API：</strong> 从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.47.5.1.6.1.1" width="20%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.47.5.1.6.1.2" width="20%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.47.5.1.6.1.3" width="20%">只读</th>         <th align="left" class="cellrowborder" id="mcps1.3.47.5.1.6.1.4" width="20%">可选</th>         <th align="left" class="cellrowborder" id="mcps1.3.47.5.1.6.1.5" width="20%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">code</td>         <td class="cellrowborder" width="20%">number</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">错误码，订阅close事件得到的关闭连接的错误码。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">reason</td>         <td class="cellrowborder" width="20%">string</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">原因值，订阅close事件得到的关闭连接的错误原因。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 549px;">     <h2 id="responseheaders12" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">ResponseHeaders<sup>12+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="responseheaders12" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>type ResponseHeaders = {</p>     <p>[k: string]: string | string[] | undefined;</p>     <p>}</p>     <p>服务器发送的响应头。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.48.7.1.5.1.1" width="25%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.48.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.48.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.48.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">[k:string]</td>         <td class="cellrowborder" width="25%">string | string[] | undefined</td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">键值对形式存储。其键的类型为字符，可取任意值，其值的类型为字符、字符数组或undefined。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 573px;">     <h2 id="close错误码说明" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">close错误码说明<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="close错误码说明" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>发送给服务端的错误码可以自行定义，下面的列表仅供参考。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.49.4.1.3.1.1" width="50%">值</th>         <th align="left" class="cellrowborder" id="mcps1.3.49.4.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">1000</td>         <td class="cellrowborder" width="50%">正常关闭。</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">1001</td>         <td class="cellrowborder" width="50%">服务器主动关闭。</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">1002</td>         <td class="cellrowborder" width="50%">协议错误。</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">1003</td>         <td class="cellrowborder" width="50%">无法处理的数据类型。</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">1004~1015</td>         <td class="cellrowborder" width="50%">保留值。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 401px;">     <h2 id="httpproxy12" device-type="phone,2in1,tablet,wearable,tv">HttpProxy<sup>12+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="httpproxy12" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>type HttpProxy = connection.HttpProxy</p>     <p>网络全局代理配置信息。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetManager.Core</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.50.5.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.50.5.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">connection.HttpProxy</td>         <td class="cellrowborder" width="50%">使用指定的网络代理。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 822px;">     <h2 id="websocketserverconfig19" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">WebSocketServerConfig<sup>19+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="websocketserverconfig19" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>启动服务端的service时，需要输入的配置信息和说明。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.51.4.1.6.1.1" width="20%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.51.4.1.6.1.2" width="20%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.51.4.1.6.1.3" width="20%">只读</th>         <th align="left" class="cellrowborder" id="mcps1.3.51.4.1.6.1.4" width="20%">可选</th>         <th align="left" class="cellrowborder" id="mcps1.3.51.4.1.6.1.5" width="20%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">serverIP</td>         <td class="cellrowborder" width="20%">string</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">服务端监听特定ip地址，默认是"0.0.0.0"。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">serverPort</td>         <td class="cellrowborder" width="20%">number</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">服务端监听的端口号。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">serverCert</td>         <td class="cellrowborder" width="20%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-websocket#servercert19">ServerCert</a></td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">指定服务端证书的信息，包括服务端证书文件路径和服务端证书的私钥文件路径。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">protocol</td>         <td class="cellrowborder" width="20%">string</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">自定义协议。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">maxConcurrentClientsNumber</td>         <td class="cellrowborder" width="20%">number</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">最大并发客户端数量，当到达最大数时，服务端拒绝新连接。默认最大数量为10。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">maxConnectionsForOneClient</td>         <td class="cellrowborder" width="20%">number</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">单个客户端的最大连接数。默认最大数量为10。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 426px;">     <h2 id="servercert19" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">ServerCert<sup>19+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="servercert19" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>指定服务端证书的信息，包括服务端证书文件路径和服务端证书的私钥文件路径。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.52.4.1.6.1.1" width="20%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.52.4.1.6.1.2" width="20%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.52.4.1.6.1.3" width="20%">只读</th>         <th align="left" class="cellrowborder" id="mcps1.3.52.4.1.6.1.4" width="20%">可选</th>         <th align="left" class="cellrowborder" id="mcps1.3.52.4.1.6.1.5" width="20%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">certPath</td>         <td class="cellrowborder" width="20%">string</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">服务端证书文件路径。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">keyPath</td>         <td class="cellrowborder" width="20%">string</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">服务端证书的私钥文件路径。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 450px;">     <h2 id="websocketmessage19" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">WebSocketMessage<sup>19+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="websocketmessage19" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>从指定客户端接收到的消息，包括客户端的信息和数据。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.53.4.1.6.1.1" width="20%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.53.4.1.6.1.2" width="20%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.53.4.1.6.1.3" width="20%">只读</th>         <th align="left" class="cellrowborder" id="mcps1.3.53.4.1.6.1.4" width="20%">可选</th>         <th align="left" class="cellrowborder" id="mcps1.3.53.4.1.6.1.5" width="20%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">data</td>         <td class="cellrowborder" width="20%">string |ArrayBuffer</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">接收到的客户端发的消息数据。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">clientConnection</td>         <td class="cellrowborder" width="20%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-websocket#websocketconnection19">WebSocketConnection</a></td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">客户端信息，包括客户端的ip地址和端口号port。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 402px;">     <h2 id="websocketconnection19" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">WebSocketConnection<sup>19+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="websocketconnection19" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>客户端信息，包括客户端的ip地址和端口号port。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.54.4.1.6.1.1" width="20%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.54.4.1.6.1.2" width="20%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.54.4.1.6.1.3" width="20%">只读</th>         <th align="left" class="cellrowborder" id="mcps1.3.54.4.1.6.1.4" width="20%">可选</th>         <th align="left" class="cellrowborder" id="mcps1.3.54.4.1.6.1.5" width="20%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">clientIP</td>         <td class="cellrowborder" width="20%">string</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">客户端的ip地址。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">clientPort</td>         <td class="cellrowborder" width="20%">number</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">客户端的端口号port。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 546px;">     <h2 id="clientconnectionclosecallback19" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">ClientConnectionCloseCallback<sup>19+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="clientconnectionclosecallback19" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>type ClientConnectionCloseCallback = (clientConnection: WebSocketConnection, closeReason: CloseResult) =&gt; void</p>     <p>关闭WebSocketServer连接时，订阅close事件得到的指定客户端的关闭结果。</p>     <p><strong>系统能力</strong>：SystemCapability.Communication.NetStack</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.55.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.55.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.55.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.55.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">clientConnection</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-websocket#websocketconnection19">WebSocketConnection</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">客户端信息，包括客户端的ip地址和端口号port。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">closeReason</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-websocket#closeresult10">CloseResult</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">关闭WebSocket连接时，订阅close事件得到的关闭结果。</td>        </tr>             </tbody></table></div>     </div>    </div>   </div>   <div></div></div>