<h1 _ngcontent-vqe-c119="" class="doc-title ng-star-inserted" title="@ohos.resourceschedule.backgroundTaskManager (后台任务管理)"> @ohos.resourceschedule.backgroundTaskManager (后台任务管理) </h1>

<div _ngcontent-vqe-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p>本模块提供申请后台任务的接口。当应用退至后台时，开发者可以通过本模块接口为应用申请短时、长时任务，避免应用进程被终止或挂起。开发指导请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/continuous-task" target="_blank">长时任务开发指南</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/transient-task" target="_blank">短时任务开发指南</a>。</p>    <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">      <p>本模块首批接口从API version 9开始支持。后续版本的新增接口，采用上角标单独标记接口的起始版本。</p>     </div></div></div>    <div class="tiledSection">     <h2 id="导入模块" device-type="phone,2in1,tablet,wearable,tv">导入模块<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="导入模块" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><div _ngcontent-vqe-c106="" class="highlight-div"><div _ngcontent-vqe-c106="" class="highlight-div-header"><div _ngcontent-vqe-c106="" class="highlight-div-header-left"><div _ngcontent-vqe-c106="" class="handle-button expand-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-vqe-c106="" class="highlight-div-header-right"><div _ngcontent-vqe-c106="" class="handle-button ai-button"></div><div _ngcontent-vqe-c106="" class="handle-button line-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-vqe-c106="" class="handle-button theme-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-vqe-c106="" class="handle-button copy-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-vqe-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { backgroundTaskManager } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BackgroundTasksKit'</span>;</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="backgroundtaskmanagerrequestsuspenddelay" device-type="phone,2in1,tablet,wearable,tv">backgroundTaskManager.requestSuspendDelay<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="backgroundtaskmanagerrequestsuspenddelay" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>requestSuspendDelay(reason: string, callback: Callback&lt;void&gt;): DelaySuspendInfo</p>     <p>申请短时任务。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>短时任务的申请和使用过程中的约束与限制请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/transient-task#约束与限制" target="_blank">指南</a>。</p>      </div></div></div>     <p><strong>系统能力:</strong> SystemCapability.ResourceSchedule.BackgroundTaskManager.TransientTask</p>     <p><strong>参数</strong>：</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.4.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.4.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.4.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.4.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">reason</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">申请短时任务的原因。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;void&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">短时任务即将超时的回调函数，一般在超时前6秒，通过此回调通知应用。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值</strong>：</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.4.9.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.4.9.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-resourceschedule-backgroundtaskmanager#delaysuspendinfo">DelaySuspendInfo</a></td>         <td class="cellrowborder" width="50%">返回短时任务信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-backgroundtaskmgr">backgroundTaskManager错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.4.12.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.4.12.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1. Mandatory parameters are left unspecified; 2. Incorrect parameters types.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800001</td>         <td class="cellrowborder" width="50%">Memory operation failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800002</td>         <td class="cellrowborder" width="50%">Failed to write data into parcel. Possible reasons: 1. Invalid parameters; 2. Failed to apply for memory.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800003</td>         <td class="cellrowborder" width="50%">Internal transaction failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800004</td>         <td class="cellrowborder" width="50%">System service operation failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9900001</td>         <td class="cellrowborder" width="50%">Caller information verification failed for a transient task.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9900002</td>         <td class="cellrowborder" width="50%">Transient task verification failed.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例</strong>：</p>     <div _ngcontent-vqe-c106="" class="highlight-div"><div _ngcontent-vqe-c106="" class="highlight-div-header"><div _ngcontent-vqe-c106="" class="highlight-div-header-left"><div _ngcontent-vqe-c106="" class="handle-button expand-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-vqe-c106="" class="highlight-div-header-right"><div _ngcontent-vqe-c106="" class="handle-button ai-button"></div><div _ngcontent-vqe-c106="" class="handle-button line-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-vqe-c106="" class="handle-button theme-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-vqe-c106="" class="handle-button copy-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-vqe-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { backgroundTaskManager } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BackgroundTasksKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> myReason = <span class="hljs-string">'test requestSuspendDelay'</span>;</li><li><span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">let</span> delayInfo = backgroundTaskManager.<span class="hljs-title function_">requestSuspendDelay</span>(myReason, <span class="hljs-function">() =&gt;</span> {</li><li>    <span class="hljs-comment">// 回调函数。应用申请的短时任务即将超时，通过此函数回调应用，执行一些清理和标注工作，并取消短时任务</span></li><li>    <span class="hljs-comment">// 此处回调与应用的业务功能不耦合，短时任务申请成功后，正常执行应用本身的业务</span></li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"Request suspension delay will time out."</span>);</li><li>    })</li><li>    <span class="hljs-keyword">let</span> id = delayInfo.<span class="hljs-property">requestId</span>;</li><li>    <span class="hljs-keyword">let</span> time = delayInfo.<span class="hljs-property">actualDelayTime</span>;</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"The requestId is: "</span> + id);</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"The actualDelayTime is: "</span> + time);</li><li>} <span class="hljs-keyword">catch</span> (error) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`requestSuspendDelay failed. code is <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> BusinessError).code}</span> message is <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> BusinessError).message}</span>`</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="backgroundtaskmanagergetremainingdelaytime" device-type="phone,2in1,tablet,wearable,tv">backgroundTaskManager.getRemainingDelayTime<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="backgroundtaskmanagergetremainingdelaytime" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>getRemainingDelayTime(requestId: number, callback: AsyncCallback&lt;number&gt;): void</p>     <p>获取本次短时任务的剩余时间，使用callback异步回调。</p>     <p><strong>系统能力:</strong> SystemCapability.ResourceSchedule.BackgroundTaskManager.TransientTask</p>     <p><strong>参数</strong>：</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.5.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.5.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.5.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.5.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">requestId</td>         <td class="cellrowborder" width="25%">number</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">短时任务的请求ID。通过申请短时任务<a href="/consumer/cn/doc/harmonyos-references/js-apis-resourceschedule-backgroundtaskmanager#backgroundtaskmanagerrequestsuspenddelay">requestSuspendDelay</a>接口获取。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;number&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数，返回本次短时任务的剩余时间，单位：ms。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-backgroundtaskmgr">backgroundTaskManager错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.5.9.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.5.9.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1. Mandatory parameters are left unspecified; 2. Incorrect parameters types; 3. Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800001</td>         <td class="cellrowborder" width="50%">Memory operation failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800002</td>         <td class="cellrowborder" width="50%">Failed to write data into parcel. Possible reasons: 1. Invalid parameters; 2. Failed to apply for memory.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800003</td>         <td class="cellrowborder" width="50%">Internal transaction failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800004</td>         <td class="cellrowborder" width="50%">System service operation failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9900001</td>         <td class="cellrowborder" width="50%">Caller information verification failed for a transient task.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9900002</td>         <td class="cellrowborder" width="50%">Transient task verification failed.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例</strong>：</p>     <div _ngcontent-vqe-c106="" class="highlight-div"><div _ngcontent-vqe-c106="" class="highlight-div-header"><div _ngcontent-vqe-c106="" class="highlight-div-header-left"><div _ngcontent-vqe-c106="" class="handle-button expand-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-vqe-c106="" class="highlight-div-header-right"><div _ngcontent-vqe-c106="" class="handle-button ai-button"></div><div _ngcontent-vqe-c106="" class="handle-button line-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-vqe-c106="" class="handle-button theme-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-vqe-c106="" class="handle-button copy-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-vqe-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { backgroundTaskManager } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BackgroundTasksKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> id = <span class="hljs-number">1</span>;</li><li>backgroundTaskManager.<span class="hljs-title function_">getRemainingDelayTime</span>(id, <span class="hljs-function">(<span class="hljs-params">error: BusinessError, res: <span class="hljs-built_in">number</span></span>) =&gt;</span> {</li><li>    <span class="hljs-keyword">if</span>(error) {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`callback =&gt; Operation getRemainingDelayTime failed. code is <span class="hljs-subst">${error.code}</span> message is <span class="hljs-subst">${error.message}</span>`</span>);</li><li>    } <span class="hljs-keyword">else</span> {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'callback =&gt; Operation getRemainingDelayTime succeeded. Data: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(res));</li><li>    }</li><li>})</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="backgroundtaskmanagergetremainingdelaytime-1" device-type="phone,2in1,tablet,wearable,tv">backgroundTaskManager.getRemainingDelayTime<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="backgroundtaskmanagergetremainingdelaytime-1" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>getRemainingDelayTime(requestId: number): Promise&lt;number&gt;</p>     <p>获取本次短时任务的剩余时间，使用Promise异步回调。</p>     <p><strong>系统能力:</strong> SystemCapability.ResourceSchedule.BackgroundTaskManager.TransientTask</p>     <p><strong>参数</strong>：</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.6.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.6.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.6.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.6.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">requestId</td>         <td class="cellrowborder" width="25%">number</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">短时任务的请求ID。通过申请短时任务<a href="/consumer/cn/doc/harmonyos-references/js-apis-resourceschedule-backgroundtaskmanager#backgroundtaskmanagerrequestsuspenddelay">requestSuspendDelay</a>接口获取。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值</strong>：</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.6.8.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.6.8.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;number&gt;</td>         <td class="cellrowborder" width="50%">Promise对象，返回本次短时任务的剩余时间，单位：ms。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-backgroundtaskmgr">backgroundTaskManager错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.6.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.6.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1. Mandatory parameters are left unspecified; 2. Incorrect parameters types; 3. Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800001</td>         <td class="cellrowborder" width="50%">Memory operation failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800002</td>         <td class="cellrowborder" width="50%">Failed to write data into parcel. Possible reasons: 1. Invalid parameters; 2. Failed to apply for memory.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800003</td>         <td class="cellrowborder" width="50%">Internal transaction failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800004</td>         <td class="cellrowborder" width="50%">System service operation failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9900001</td>         <td class="cellrowborder" width="50%">Caller information verification failed for a transient task.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9900002</td>         <td class="cellrowborder" width="50%">Transient task verification failed.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例</strong>：</p>     <div _ngcontent-vqe-c106="" class="highlight-div"><div _ngcontent-vqe-c106="" class="highlight-div-header"><div _ngcontent-vqe-c106="" class="highlight-div-header-left"><div _ngcontent-vqe-c106="" class="handle-button expand-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-vqe-c106="" class="highlight-div-header-right"><div _ngcontent-vqe-c106="" class="handle-button ai-button"></div><div _ngcontent-vqe-c106="" class="handle-button line-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-vqe-c106="" class="handle-button theme-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-vqe-c106="" class="handle-button copy-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-vqe-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { backgroundTaskManager } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BackgroundTasksKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> id = <span class="hljs-number">1</span>;</li><li>backgroundTaskManager.<span class="hljs-title function_">getRemainingDelayTime</span>(id).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">res: <span class="hljs-built_in">number</span></span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'promise =&gt; Operation getRemainingDelayTime succeeded. Data: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(res));</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error: BusinessError</span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`promise =&gt; Operation getRemainingDelayTime failed. code is <span class="hljs-subst">${error.code}</span> message is <span class="hljs-subst">${error.message}</span>`</span>);</li><li>})</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="backgroundtaskmanagercancelsuspenddelay" device-type="phone,2in1,tablet,wearable,tv">backgroundTaskManager.cancelSuspendDelay<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="backgroundtaskmanagercancelsuspenddelay" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>cancelSuspendDelay(requestId: number): void</p>     <p>取消短时任务。</p>     <p><strong>系统能力:</strong> SystemCapability.ResourceSchedule.BackgroundTaskManager.TransientTask</p>     <p><strong>参数</strong>：</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.7.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.7.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.7.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.7.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">requestId</td>         <td class="cellrowborder" width="25%">number</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">短时任务的请求ID。通过申请短时任务<a href="/consumer/cn/doc/harmonyos-references/js-apis-resourceschedule-backgroundtaskmanager#backgroundtaskmanagerrequestsuspenddelay">requestSuspendDelay</a>接口获取。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-backgroundtaskmgr">backgroundTaskManager错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.7.9.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.7.9.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1. Mandatory parameters are left unspecified; 2. Incorrect parameters types; 3. Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800001</td>         <td class="cellrowborder" width="50%">Memory operation failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800002</td>         <td class="cellrowborder" width="50%">Failed to write data into parcel. Possible reasons: 1. Invalid parameters; 2. Failed to apply for memory.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800003</td>         <td class="cellrowborder" width="50%">Internal transaction failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800004</td>         <td class="cellrowborder" width="50%">System service operation failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9900001</td>         <td class="cellrowborder" width="50%">Caller information verification failed for a transient task.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9900002</td>         <td class="cellrowborder" width="50%">Transient task verification failed.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例</strong>：</p>     <div _ngcontent-vqe-c106="" class="highlight-div"><div _ngcontent-vqe-c106="" class="highlight-div-header"><div _ngcontent-vqe-c106="" class="highlight-div-header-left"><div _ngcontent-vqe-c106="" class="handle-button expand-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-vqe-c106="" class="highlight-div-header-right"><div _ngcontent-vqe-c106="" class="handle-button ai-button"></div><div _ngcontent-vqe-c106="" class="handle-button line-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-vqe-c106="" class="handle-button theme-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-vqe-c106="" class="handle-button copy-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-vqe-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { backgroundTaskManager } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BackgroundTasksKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> id = <span class="hljs-number">1</span>;</li><li><span class="hljs-keyword">try</span> {</li><li>  backgroundTaskManager.<span class="hljs-title function_">cancelSuspendDelay</span>(id);</li><li>} <span class="hljs-keyword">catch</span> (error) {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`cancelSuspendDelay failed. code is <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> BusinessError).code}</span> message is <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> BusinessError).message}</span>`</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="backgroundtaskmanagergettransienttaskinfo20" device-type="phone,2in1,tablet,wearable,tv">backgroundTaskManager.getTransientTaskInfo<sup>20+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="backgroundtaskmanagergettransienttaskinfo20" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>getTransientTaskInfo(): Promise&lt;TransientTaskInfo&gt;</p>     <p>获取所有短时任务信息，如当日剩余总配额等，使用Promise异步回调。</p>     <p><strong>系统能力</strong>: SystemCapability.ResourceSchedule.BackgroundTaskManager.TransientTask</p>     <p><strong>返回值</strong>：</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.8.6.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.8.6.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-resourceschedule-backgroundtaskmanager#transienttaskinfo20">TransientTaskInfo</a>&gt;</td>         <td class="cellrowborder" width="50%">Promise对象，返回所有短时任务信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-backgroundtaskmgr">backgroundTaskManager错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.8.9.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.8.9.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">9900001</td>         <td class="cellrowborder" width="50%">Caller information verification failed for a transient task.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9900003</td>         <td class="cellrowborder" width="50%">Failed to write data into parcel. Possible reasons: 1. Invalid parameters; 2. Failed to apply for memory.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9900004</td>         <td class="cellrowborder" width="50%">System service operation failed.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例</strong>：</p>     <div _ngcontent-vqe-c106="" class="highlight-div"><div _ngcontent-vqe-c106="" class="highlight-div-header"><div _ngcontent-vqe-c106="" class="highlight-div-header-left"><div _ngcontent-vqe-c106="" class="handle-button expand-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-vqe-c106="" class="highlight-div-header-right"><div _ngcontent-vqe-c106="" class="handle-button ai-button"></div><div _ngcontent-vqe-c106="" class="handle-button line-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-vqe-c106="" class="handle-button theme-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-vqe-c106="" class="handle-button copy-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-vqe-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { backgroundTaskManager } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BackgroundTasksKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">try</span> {</li><li>    backgroundTaskManager.<span class="hljs-title function_">getTransientTaskInfo</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">res: backgroundTaskManager.TransientTaskInfo</span>) =&gt;</span> {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`Operation getTransientTaskInfo succeeded. data: `</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(res));</li><li>    }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error : BusinessError</span>) =&gt;</span> {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Operation getTransientTaskInfo failed. code is <span class="hljs-subst">${error.code}</span> message is <span class="hljs-subst">${error.message}</span>`</span>);</li><li>    });</li><li>} <span class="hljs-keyword">catch</span> (error) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Operation getTransientTaskInfo failed. code is <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> BusinessError).code}</span> message is <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> BusinessError).message}</span>`</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="backgroundtaskmanagerstartbackgroundrunning" device-type="phone,2in1,tablet,wearable,tv">backgroundTaskManager.startBackgroundRunning<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="backgroundtaskmanagerstartbackgroundrunning" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>startBackgroundRunning(context: Context, bgMode: BackgroundMode, wantAgent: WantAgent, callback: AsyncCallback&lt;void&gt;): void</p>     <p>申请长时任务，支持申请一种类型，使用callback异步回调。长时任务申请成功后，会有通知栏消息，没有提示音。一个UIAbility（FA模型则为ServiceAbility）同一时刻仅支持通过本接口支持申请一个长时任务，可以通过API version 21新增接口<a href="/consumer/cn/doc/harmonyos-references/js-apis-resourceschedule-backgroundtaskmanager#backgroundtaskmanagerstartbackgroundrunning21">startBackgroundRunning</a>申请多个长时任务。</p>     <p><strong>需要权限:</strong> ohos.permission.KEEP_BACKGROUND_RUNNING</p>     <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力:</strong> SystemCapability.ResourceSchedule.BackgroundTaskManager.ContinuousTask</p>     <p><strong>参数</strong>：</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.9.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.9.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.9.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.9.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">context</td>         <td class="cellrowborder" width="25%">Context</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">          <p>应用运行的上下文。</p>          <p>FA模型的应用Context定义见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-app-context">Context</a>。</p>          <p>Stage模型的应用Context定义见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-context">Context</a>。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="25%">bgMode</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-resourceschedule-backgroundtaskmanager#backgroundmode">BackgroundMode</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">长时任务类型。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">wantAgent</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-wantagent">WantAgent</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">通知参数，用于指定点击长时任务通知后跳转的界面。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;void&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数，申请长时任务成功时，err为undefined，否则为错误对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-backgroundtaskmgr">backgroundTaskManager错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.9.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.9.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">202</td>         <td class="cellrowborder" width="50%">Not System App.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1. Mandatory parameters are left unspecified; 2. Incorrect parameters types; 3. Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800001</td>         <td class="cellrowborder" width="50%">Memory operation failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800002</td>         <td class="cellrowborder" width="50%">Failed to write data into parcel. Possible reasons: 1. Invalid parameters; 2. Failed to apply for memory.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800003</td>         <td class="cellrowborder" width="50%">Internal transaction failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800004</td>         <td class="cellrowborder" width="50%">System service operation failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800005</td>         <td class="cellrowborder" width="50%">Continuous task verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800006</td>         <td class="cellrowborder" width="50%">Notification verification failed for a continuous task.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800007</td>         <td class="cellrowborder" width="50%">Continuous task storage failed.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例</strong>：</p>     <div _ngcontent-vqe-c106="" class="highlight-div"><div _ngcontent-vqe-c106="" class="highlight-div-header"><div _ngcontent-vqe-c106="" class="highlight-div-header-left"><div _ngcontent-vqe-c106="" class="handle-button expand-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-vqe-c106="" class="highlight-div-header-right"><div _ngcontent-vqe-c106="" class="handle-button ai-button"></div><div _ngcontent-vqe-c106="" class="handle-button line-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-vqe-c106="" class="handle-button theme-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-vqe-c106="" class="handle-button copy-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-vqe-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { backgroundTaskManager } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BackgroundTasksKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AbilityConstant</span>, <span class="hljs-title class_">UIAbility</span>, <span class="hljs-title class_">Want</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { wantAgent, <span class="hljs-title class_">WantAgent</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-comment">// 在元服务中，请删除WantAgent导入</span></li><li>
</li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">callback</span>(<span class="hljs-params">error: BusinessError, data: <span class="hljs-keyword">void</span></span>) {</li><li>    <span class="hljs-keyword">if</span> (error) {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Operation startBackgroundRunning failed. code is <span class="hljs-subst">${error.code}</span> message is <span class="hljs-subst">${error.message}</span>`</span>);</li><li>    } <span class="hljs-keyword">else</span> {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"Operation startBackgroundRunning succeeded"</span>);</li><li>    }</li><li>}</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>    <span class="hljs-title function_">onCreate</span>(<span class="hljs-params">want: Want, launchParam: AbilityConstant.LaunchParam</span>) {</li><li>        <span class="hljs-keyword">let</span> <span class="hljs-attr">wantAgentInfo</span>: wantAgent.<span class="hljs-property">WantAgentInfo</span> = {</li><li>            <span class="hljs-comment">// 点击通知后，将要执行的动作列表</span></li><li>            <span class="hljs-attr">wants</span>: [</li><li>                {</li><li>                    <span class="hljs-attr">bundleName</span>: <span class="hljs-string">"com.example.myapplication"</span>,</li><li>                    <span class="hljs-attr">abilityName</span>: <span class="hljs-string">"EntryAbility"</span></li><li>                }</li><li>            ],</li><li>            <span class="hljs-comment">// 点击通知后，动作类型</span></li><li>            <span class="hljs-attr">actionType</span>: wantAgent.<span class="hljs-property">OperationType</span>.<span class="hljs-property">START_ABILITY</span>,</li><li>            <span class="hljs-comment">// 使用者自定义的一个私有值</span></li><li>            <span class="hljs-attr">requestCode</span>: <span class="hljs-number">0</span>,</li><li>            <span class="hljs-comment">// 点击通知后，动作执行属性</span></li><li>            <span class="hljs-attr">wantAgentFlags</span>: [wantAgent.<span class="hljs-property">WantAgentFlags</span>.<span class="hljs-property">UPDATE_PRESENT_FLAG</span>]</li><li>        };</li><li>
</li><li>        <span class="hljs-keyword">try</span> {</li><li>            <span class="hljs-comment">// 通过wantAgent模块下getWantAgent方法获取WantAgent对象</span></li><li>            <span class="hljs-comment">// 在元服务中，请使用wantAgent.getWantAgent(wantAgentInfo).then((wantAgentObj: object) =&gt; {替换下面一行代码</span></li><li>            wantAgent.<span class="hljs-title function_">getWantAgent</span>(wantAgentInfo).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">wantAgentObj: WantAgent</span>) =&gt;</span> {</li><li>                <span class="hljs-keyword">try</span> {</li><li>                    backgroundTaskManager.<span class="hljs-title function_">startBackgroundRunning</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>,</li><li>                        backgroundTaskManager.<span class="hljs-property">BackgroundMode</span>.<span class="hljs-property">AUDIO_PLAYBACK</span>, wantAgentObj, callback)</li><li>                } <span class="hljs-keyword">catch</span> (error) {</li><li>                    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Operation startBackgroundRunning failed. code is <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> BusinessError).code}</span> message is <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> BusinessError).message}</span>`</span>);</li><li>                }</li><li>            });</li><li>        } <span class="hljs-keyword">catch</span> (error) {</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Operation getWantAgent failed. code is <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> BusinessError).code}</span> message is <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> BusinessError).message}</span>`</span>);</li><li>        }</li><li>    }</li><li>};</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="backgroundtaskmanagerstartbackgroundrunning-1" device-type="phone,2in1,tablet,wearable,tv">backgroundTaskManager.startBackgroundRunning<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="backgroundtaskmanagerstartbackgroundrunning-1" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>startBackgroundRunning(context: Context, bgMode: BackgroundMode, wantAgent: WantAgent): Promise&lt;void&gt;</p>     <p>申请长时任务，支持申请一种类型，使用Promise异步回调。长时任务申请成功后，会有通知栏消息，没有提示音。一个UIAbility（FA模型则为ServiceAbility）同一时刻仅支持通过本接口支持申请一个长时任务，可以通过API version 21新增接口<a href="/consumer/cn/doc/harmonyos-references/js-apis-resourceschedule-backgroundtaskmanager#backgroundtaskmanagerstartbackgroundrunning21">startBackgroundRunning</a>申请多个长时任务。</p>     <p><strong>需要权限:</strong> ohos.permission.KEEP_BACKGROUND_RUNNING</p>     <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力:</strong> SystemCapability.ResourceSchedule.BackgroundTaskManager.ContinuousTask</p>     <p><strong>参数</strong>：</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.10.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.10.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.10.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.10.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">context</td>         <td class="cellrowborder" width="25%">Context</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">          <p>应用运行的上下文。</p>          <p>FA模型的应用Context定义见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-app-context">Context</a>。</p>          <p>Stage模型的应用Context定义见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-context">Context</a>。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="25%">bgMode</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-resourceschedule-backgroundtaskmanager#backgroundmode">BackgroundMode</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">长时任务类型。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">wantAgent</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-wantagent">WantAgent</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">通知参数，用于指定点击长时任务通知后跳转的界面。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值</strong>：</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.10.10.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.10.10.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">无返回结果的Promise对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-backgroundtaskmgr">backgroundTaskManager错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.10.13.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.10.13.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">202</td>         <td class="cellrowborder" width="50%">Not System App.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1. Mandatory parameters are left unspecified; 2. Incorrect parameters types; 3. Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800001</td>         <td class="cellrowborder" width="50%">Memory operation failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800002</td>         <td class="cellrowborder" width="50%">Failed to write data into parcel. Possible reasons: 1. Invalid parameters; 2. Failed to apply for memory.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800003</td>         <td class="cellrowborder" width="50%">Internal transaction failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800004</td>         <td class="cellrowborder" width="50%">System service operation failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800005</td>         <td class="cellrowborder" width="50%">Continuous task verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800006</td>         <td class="cellrowborder" width="50%">Notification verification failed for a continuous task.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800007</td>         <td class="cellrowborder" width="50%">Continuous task storage failed.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例</strong>：</p>     <div _ngcontent-vqe-c106="" class="highlight-div"><div _ngcontent-vqe-c106="" class="highlight-div-header"><div _ngcontent-vqe-c106="" class="highlight-div-header-left"><div _ngcontent-vqe-c106="" class="handle-button expand-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-vqe-c106="" class="highlight-div-header-right"><div _ngcontent-vqe-c106="" class="handle-button ai-button"></div><div _ngcontent-vqe-c106="" class="handle-button line-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-vqe-c106="" class="handle-button theme-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-vqe-c106="" class="handle-button copy-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-vqe-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { backgroundTaskManager } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BackgroundTasksKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AbilityConstant</span>, <span class="hljs-title class_">UIAbility</span>, <span class="hljs-title class_">Want</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { wantAgent, <span class="hljs-title class_">WantAgent</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-comment">// 在元服务中，请删除WantAgent导入</span></li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>    <span class="hljs-title function_">onCreate</span>(<span class="hljs-params">want: Want, launchParam: AbilityConstant.LaunchParam</span>) {</li><li>        <span class="hljs-keyword">let</span> <span class="hljs-attr">wantAgentInfo</span>: wantAgent.<span class="hljs-property">WantAgentInfo</span> = {</li><li>            <span class="hljs-comment">// 点击通知后，将要执行的动作列表</span></li><li>            <span class="hljs-attr">wants</span>: [</li><li>                {</li><li>                    <span class="hljs-attr">bundleName</span>: <span class="hljs-string">"com.example.myapplication"</span>,</li><li>                    <span class="hljs-attr">abilityName</span>: <span class="hljs-string">"EntryAbility"</span></li><li>                }</li><li>            ],</li><li>            <span class="hljs-comment">// 点击通知后，动作类型</span></li><li>            <span class="hljs-attr">actionType</span>: wantAgent.<span class="hljs-property">OperationType</span>.<span class="hljs-property">START_ABILITY</span>,</li><li>            <span class="hljs-comment">// 使用者自定义的一个私有值</span></li><li>            <span class="hljs-attr">requestCode</span>: <span class="hljs-number">0</span>,</li><li>            <span class="hljs-comment">// 点击通知后，动作执行属性</span></li><li>            <span class="hljs-attr">wantAgentFlags</span>: [wantAgent.<span class="hljs-property">WantAgentFlags</span>.<span class="hljs-property">UPDATE_PRESENT_FLAG</span>]</li><li>        };</li><li>
</li><li>        <span class="hljs-keyword">try</span> {</li><li>            <span class="hljs-comment">// 通过wantAgent模块下getWantAgent方法获取WantAgent对象</span></li><li>            <span class="hljs-comment">// 在元服务中，请使用wantAgent.getWantAgent(wantAgentInfo).then((wantAgentObj: object) =&gt; {替换下面一行代码</span></li><li>            wantAgent.<span class="hljs-title function_">getWantAgent</span>(wantAgentInfo).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">wantAgentObj: WantAgent</span>) =&gt;</span> {</li><li>                <span class="hljs-keyword">try</span> {</li><li>                    backgroundTaskManager.<span class="hljs-title function_">startBackgroundRunning</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>,</li><li>                        backgroundTaskManager.<span class="hljs-property">BackgroundMode</span>.<span class="hljs-property">AUDIO_PLAYBACK</span>, wantAgentObj).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>                        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"Operation startBackgroundRunning succeeded"</span>);</li><li>                    }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error: BusinessError</span>) =&gt;</span> {</li><li>                        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Operation startBackgroundRunning failed. code is <span class="hljs-subst">${error.code}</span> message is <span class="hljs-subst">${error.message}</span>`</span>);</li><li>                    });</li><li>                } <span class="hljs-keyword">catch</span> (error) {</li><li>                    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Operation startBackgroundRunning failed. code is <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> BusinessError).code}</span> message is <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> BusinessError).message}</span>`</span>);</li><li>                }</li><li>            });</li><li>        } <span class="hljs-keyword">catch</span> (error) {</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Operation getWantAgent failed. code is <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> BusinessError).code}</span> message is <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> BusinessError).message}</span>`</span>);</li><li>        }</li><li>    }</li><li>};</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="backgroundtaskmanagerstopbackgroundrunning" device-type="phone,2in1,tablet,wearable,tv">backgroundTaskManager.stopBackgroundRunning<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="backgroundtaskmanagerstopbackgroundrunning" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>stopBackgroundRunning(context: Context, callback: AsyncCallback&lt;void&gt;): void</p>     <p>取消当前UIAbility（FA模型则为ServiceAbility）下所有长时任务，使用callback异步回调。也可以通过<a href="/consumer/cn/doc/harmonyos-references/js-apis-resourceschedule-backgroundtaskmanager#backgroundtaskmanagerstopbackgroundrunning21">stopBackgroundRunning</a>接口取消指定Id的长时任务。</p>     <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力:</strong> SystemCapability.ResourceSchedule.BackgroundTaskManager.ContinuousTask</p>     <p><strong>参数</strong>：</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.11.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.11.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.11.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.11.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">context</td>         <td class="cellrowborder" width="25%">Context</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">          <p>应用运行的上下文。</p>          <p>FA模型的应用Context定义见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-app-context">Context</a>。</p>          <p>Stage模型的应用Context定义见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-context">Context</a>。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;void&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数，取消长时任务成功时，err为undefined，否则为错误对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-backgroundtaskmgr">backgroundTaskManager错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.11.10.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.11.10.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1. Mandatory parameters are left unspecified.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800001</td>         <td class="cellrowborder" width="50%">Memory operation failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800002</td>         <td class="cellrowborder" width="50%">Failed to write data into parcel. Possible reasons: 1. Invalid parameters; 2. Failed to apply for memory.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800003</td>         <td class="cellrowborder" width="50%">Internal transaction failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800004</td>         <td class="cellrowborder" width="50%">System service operation failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800005</td>         <td class="cellrowborder" width="50%">Continuous task verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800006</td>         <td class="cellrowborder" width="50%">Notification verification failed for a continuous task.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800007</td>         <td class="cellrowborder" width="50%">Continuous task storage failed.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例</strong>：</p>     <div _ngcontent-vqe-c106="" class="highlight-div"><div _ngcontent-vqe-c106="" class="highlight-div-header"><div _ngcontent-vqe-c106="" class="highlight-div-header-left"><div _ngcontent-vqe-c106="" class="handle-button expand-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-vqe-c106="" class="highlight-div-header-right"><div _ngcontent-vqe-c106="" class="handle-button ai-button"></div><div _ngcontent-vqe-c106="" class="handle-button line-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-vqe-c106="" class="handle-button theme-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-vqe-c106="" class="handle-button copy-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-vqe-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { backgroundTaskManager } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BackgroundTasksKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AbilityConstant</span>, <span class="hljs-title class_">UIAbility</span>, <span class="hljs-title class_">Want</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">callback</span>(<span class="hljs-params">error: BusinessError, data: <span class="hljs-keyword">void</span></span>) {</li><li>    <span class="hljs-keyword">if</span> (error) {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Operation stopBackgroundRunning failed. code is <span class="hljs-subst">${error.code}</span> message is <span class="hljs-subst">${error.message}</span>`</span>);</li><li>    } <span class="hljs-keyword">else</span> {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"Operation stopBackgroundRunning succeeded"</span>);</li><li>    }</li><li>}</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>    <span class="hljs-title function_">onCreate</span>(<span class="hljs-params">want: Want, launchParam: AbilityConstant.LaunchParam</span>) {</li><li>        <span class="hljs-keyword">try</span> {</li><li>            backgroundTaskManager.<span class="hljs-title function_">stopBackgroundRunning</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>, callback);</li><li>        } <span class="hljs-keyword">catch</span> (error) {</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Operation stopBackgroundRunning failed. code is <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> BusinessError).code}</span> message is <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> BusinessError).message}</span>`</span>);</li><li>        }</li><li>    }</li><li>};</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="backgroundtaskmanagerstopbackgroundrunning-1" device-type="phone,2in1,tablet,wearable,tv">backgroundTaskManager.stopBackgroundRunning<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="backgroundtaskmanagerstopbackgroundrunning-1" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>stopBackgroundRunning(context: Context): Promise&lt;void&gt;</p>     <p>取消当前UIAbility（FA模型则为ServiceAbility）下所有长时任务，使用Promise异步回调。也可以通过<a href="/consumer/cn/doc/harmonyos-references/js-apis-resourceschedule-backgroundtaskmanager#backgroundtaskmanagerstopbackgroundrunning21">stopBackgroundRunning</a>接口取消指定Id的长时任务。</p>     <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力:</strong> SystemCapability.ResourceSchedule.BackgroundTaskManager.ContinuousTask</p>     <p><strong>参数</strong>：</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.12.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.12.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.12.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.12.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">context</td>         <td class="cellrowborder" width="25%">Context</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">          <p>应用运行的上下文。</p>          <p>FA模型的应用Context定义见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-app-context">Context</a>。</p>          <p>Stage模型的应用Context定义见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-context">Context</a>。</p></td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值</strong>：</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.12.9.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.12.9.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">无返回结果的Promise对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-backgroundtaskmgr">backgroundTaskManager错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.12.12.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.12.12.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1. Mandatory parameters are left unspecified.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800001</td>         <td class="cellrowborder" width="50%">Memory operation failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800002</td>         <td class="cellrowborder" width="50%">Failed to write data into parcel. Possible reasons: 1. Invalid parameters; 2. Failed to apply for memory.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800003</td>         <td class="cellrowborder" width="50%">Internal transaction failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800004</td>         <td class="cellrowborder" width="50%">System service operation failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800005</td>         <td class="cellrowborder" width="50%">Continuous task verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800006</td>         <td class="cellrowborder" width="50%">Notification verification failed for a continuous task.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800007</td>         <td class="cellrowborder" width="50%">Continuous task storage failed.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例</strong>：</p>     <div _ngcontent-vqe-c106="" class="highlight-div"><div _ngcontent-vqe-c106="" class="highlight-div-header"><div _ngcontent-vqe-c106="" class="highlight-div-header-left"><div _ngcontent-vqe-c106="" class="handle-button expand-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-vqe-c106="" class="highlight-div-header-right"><div _ngcontent-vqe-c106="" class="handle-button ai-button"></div><div _ngcontent-vqe-c106="" class="handle-button line-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-vqe-c106="" class="handle-button theme-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-vqe-c106="" class="handle-button copy-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-vqe-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { backgroundTaskManager } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BackgroundTasksKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AbilityConstant</span>, <span class="hljs-title class_">UIAbility</span>, <span class="hljs-title class_">Want</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>    <span class="hljs-title function_">onCreate</span>(<span class="hljs-params">want: Want, launchParam: AbilityConstant.LaunchParam</span>) {</li><li>        <span class="hljs-keyword">try</span> {</li><li>            backgroundTaskManager.<span class="hljs-title function_">stopBackgroundRunning</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"Operation stopBackgroundRunning succeeded"</span>);</li><li>            }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error: BusinessError</span>) =&gt;</span> {</li><li>                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Operation stopBackgroundRunning failed. code is <span class="hljs-subst">${error.code}</span> message is <span class="hljs-subst">${error.message}</span>`</span>);</li><li>            });</li><li>        } <span class="hljs-keyword">catch</span> (error) {</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Operation stopBackgroundRunning failed. code is <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> BusinessError).code}</span> message is <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> BusinessError).message}</span>`</span>);</li><li>        }</li><li>    }</li><li>};</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="backgroundtaskmanagerstartbackgroundrunning12" device-type="phone,2in1,tablet,wearable,tv">backgroundTaskManager.startBackgroundRunning<sup>12+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="backgroundtaskmanagerstartbackgroundrunning12" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>startBackgroundRunning(context: Context, bgModes: string[], wantAgent: WantAgent): Promise&lt;ContinuousTaskNotification&gt;</p>     <p>申请长时任务，支持申请多种类型，使用Promise异步回调。长时任务申请成功后，会有通知栏消息，没有提示音。一个UIAbility（FA模型则为ServiceAbility）同一时刻仅支持通过本接口支持申请一个长时任务，可以通过API version 21新增接口<a href="/consumer/cn/doc/harmonyos-references/js-apis-resourceschedule-backgroundtaskmanager#backgroundtaskmanagerstartbackgroundrunning21">startBackgroundRunning</a>申请多个长时任务。</p>     <p><strong>需要权限:</strong> ohos.permission.KEEP_BACKGROUND_RUNNING</p>     <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力:</strong> SystemCapability.ResourceSchedule.BackgroundTaskManager.ContinuousTask</p>     <p><strong>参数</strong>：</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.13.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.13.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.13.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.13.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">context</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-context">Context</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">应用运行的上下文。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">bgModes</td>         <td class="cellrowborder" width="25%">string[]</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">          <p>长时任务类型，取值范围请参考长时任务类型中的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/continuous-task#使用场景" target="_blank">配置项</a>。</p>          <p><strong>说明：</strong> 支持传入一个或多个类型。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="25%">wantAgent</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-wantagent">WantAgent</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">通知参数，用于指定点击长时任务通知后跳转的界面。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值</strong>：</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.13.10.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.13.10.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-resourceschedule-backgroundtaskmanager#continuoustasknotification12">ContinuousTaskNotification</a>&gt;</td>         <td class="cellrowborder" width="50%">Promise对象，返回<a href="/consumer/cn/doc/harmonyos-references/js-apis-resourceschedule-backgroundtaskmanager#continuoustasknotification12">ContinuousTaskNotification</a>类型对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-backgroundtaskmgr">backgroundTaskManager错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.13.13.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.13.13.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1. Mandatory parameters are left unspecified; 2. Incorrect parameters types; 3. Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800001</td>         <td class="cellrowborder" width="50%">Memory operation failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800002</td>         <td class="cellrowborder" width="50%">Failed to write data into parcel. Possible reasons: 1. Invalid parameters; 2. Failed to apply for memory.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800003</td>         <td class="cellrowborder" width="50%">Internal transaction failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800004</td>         <td class="cellrowborder" width="50%">System service operation failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800005</td>         <td class="cellrowborder" width="50%">Continuous task verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800006</td>         <td class="cellrowborder" width="50%">Notification verification failed for a continuous task.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800007</td>         <td class="cellrowborder" width="50%">Continuous task storage failed.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例</strong>：</p>     <div _ngcontent-vqe-c106="" class="highlight-div"><div _ngcontent-vqe-c106="" class="highlight-div-header"><div _ngcontent-vqe-c106="" class="highlight-div-header-left"><div _ngcontent-vqe-c106="" class="handle-button expand-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-vqe-c106="" class="highlight-div-header-right"><div _ngcontent-vqe-c106="" class="handle-button ai-button"></div><div _ngcontent-vqe-c106="" class="handle-button line-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-vqe-c106="" class="handle-button theme-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-vqe-c106="" class="handle-button copy-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-vqe-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { backgroundTaskManager } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BackgroundTasksKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AbilityConstant</span>, <span class="hljs-title class_">UIAbility</span>, <span class="hljs-title class_">Want</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { notificationManager } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NotificationKit'</span>;</li><li><span class="hljs-keyword">import</span> { wantAgent, <span class="hljs-title class_">WantAgent</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-comment">// 在元服务中，请删除WantAgent导入</span></li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-attr">id</span>: number = <span class="hljs-number">0</span>; <span class="hljs-comment">// 保存通知id</span></li><li>
</li><li>  <span class="hljs-title function_">onCreate</span>(<span class="hljs-params">want: Want, launchParam: AbilityConstant.LaunchParam</span>) {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">wantAgentInfo</span>: wantAgent.<span class="hljs-property">WantAgentInfo</span> = {</li><li>      <span class="hljs-comment">// 点击通知后，将要执行的动作列表</span></li><li>      <span class="hljs-attr">wants</span>: [</li><li>        {</li><li>          <span class="hljs-attr">bundleName</span>: <span class="hljs-string">"com.example.myapplication"</span>,</li><li>          <span class="hljs-attr">abilityName</span>: <span class="hljs-string">"EntryAbility"</span></li><li>        }</li><li>      ],</li><li>      <span class="hljs-comment">// 点击通知后，动作类型</span></li><li>      <span class="hljs-attr">actionType</span>: wantAgent.<span class="hljs-property">OperationType</span>.<span class="hljs-property">START_ABILITY</span>,</li><li>      <span class="hljs-comment">// 使用者自定义的一个私有值</span></li><li>      <span class="hljs-attr">requestCode</span>: <span class="hljs-number">0</span>,</li><li>      <span class="hljs-comment">// 点击通知后，动作执行属性</span></li><li>      <span class="hljs-attr">wantAgentFlags</span>: [wantAgent.<span class="hljs-property">WantAgentFlags</span>.<span class="hljs-property">UPDATE_PRESENT_FLAG</span>]</li><li>    };</li><li>
</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-comment">// 通过wantAgent模块下getWantAgent方法获取WantAgent对象</span></li><li>      <span class="hljs-comment">// 在元服务中，请使用wantAgent.getWantAgent(wantAgentInfo).then((wantAgentObj: object) =&gt; {替换下面一行代码</span></li><li>      wantAgent.<span class="hljs-title function_">getWantAgent</span>(wantAgentInfo).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">wantAgentObj: WantAgent</span>) =&gt;</span> {</li><li>        <span class="hljs-keyword">try</span> {</li><li>          <span class="hljs-keyword">let</span> <span class="hljs-attr">list</span>: <span class="hljs-title class_">Array</span>&lt;string&gt; = [<span class="hljs-string">"dataTransfer"</span>];</li><li>          <span class="hljs-comment">// 在元服务中，let list: Array&lt;string&gt; = ["audioPlayback"];</span></li><li>          backgroundTaskManager.<span class="hljs-title function_">startBackgroundRunning</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>, list, wantAgentObj).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">res: backgroundTaskManager.ContinuousTaskNotification</span>) =&gt;</span> {</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"Operation startBackgroundRunning succeeded"</span>);</li><li>            <span class="hljs-comment">// 对于上传下载类的长时任务，应用可以使用res中返回的notificationId来更新通知，比如发送带进度条的模板通知</span></li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">id</span> = res.<span class="hljs-property">notificationId</span>;</li><li>          }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error: BusinessError</span>) =&gt;</span> {</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Operation startBackgroundRunning failed. code is <span class="hljs-subst">${error.code}</span> message is <span class="hljs-subst">${error.message}</span>`</span>);</li><li>          });</li><li>        } <span class="hljs-keyword">catch</span> (error) {</li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Operation startBackgroundRunning failed. code is <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> BusinessError).code}</span> message is <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> BusinessError).message}</span>`</span>);</li><li>        }</li><li>      });</li><li>    } <span class="hljs-keyword">catch</span> (error) {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Operation getWantAgent failed. code is <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> BusinessError).code}</span> message is <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> BusinessError).message}</span>`</span>);</li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-comment">// 应用更新进度</span></li><li>  <span class="hljs-title function_">updateProcess</span>(<span class="hljs-params">process: number</span>) {</li><li>    <span class="hljs-comment">// 定义通知类型，更新进度时的通知类型必须为实况窗</span></li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">downLoadTemplate</span>: notificationManager.<span class="hljs-property">NotificationTemplate</span> = {</li><li>      <span class="hljs-attr">name</span>: <span class="hljs-string">'downloadTemplate'</span>, <span class="hljs-comment">// 当前只支持downloadTemplate，保持不变</span></li><li>      <span class="hljs-attr">data</span>: {</li><li>        <span class="hljs-attr">title</span>: <span class="hljs-string">'文件下载：music.mp4'</span>, <span class="hljs-comment">// 必填</span></li><li>        <span class="hljs-attr">fileName</span>: <span class="hljs-string">'senTemplate'</span>, <span class="hljs-comment">// 必填</span></li><li>        <span class="hljs-attr">progressValue</span>: process, <span class="hljs-comment">// 应用更新进度值，自定义</span></li><li>      }</li><li>    };</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">request</span>: notificationManager.<span class="hljs-property">NotificationRequest</span> = {</li><li>      <span class="hljs-attr">content</span>: {</li><li>        <span class="hljs-comment">// 系统实况类型，保持不变</span></li><li>        <span class="hljs-attr">notificationContentType</span>: notificationManager.<span class="hljs-property">ContentType</span>.<span class="hljs-property">NOTIFICATION_CONTENT_SYSTEM_LIVE_VIEW</span>,</li><li>        <span class="hljs-attr">systemLiveView</span>: {</li><li>          <span class="hljs-attr">typeCode</span>: <span class="hljs-number">8</span>, <span class="hljs-comment">// 上传下载类型需要填写 8，当前仅支持此类型。保持不变</span></li><li>          <span class="hljs-attr">title</span>: <span class="hljs-string">"test"</span>, <span class="hljs-comment">// 应用自定义</span></li><li>          <span class="hljs-attr">text</span>: <span class="hljs-string">"test"</span>, <span class="hljs-comment">// 应用自定义</span></li><li>        }</li><li>      },</li><li>      <span class="hljs-attr">id</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">id</span>, <span class="hljs-comment">// 必须是申请长时任务返回的id，否则应用更新通知失败</span></li><li>      <span class="hljs-attr">notificationSlotType</span>: notificationManager.<span class="hljs-property">SlotType</span>.<span class="hljs-property">LIVE_VIEW</span>, <span class="hljs-comment">// 实况窗类型，保持不变</span></li><li>      <span class="hljs-attr">template</span>: downLoadTemplate <span class="hljs-comment">// 应用需要设置的模版名称</span></li><li>    };</li><li>
</li><li>    <span class="hljs-keyword">try</span> {</li><li>      notificationManager.<span class="hljs-title function_">publish</span>(request).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"publish success, id= "</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">id</span>);</li><li>      }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`publish fail: <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(err)}</span>`</span>);</li><li>      });</li><li>    } <span class="hljs-keyword">catch</span> (err) {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`publish fail: <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(err)}</span>`</span>);</li><li>    }</li><li>  }</li><li>};</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="backgroundtaskmanagerupdatebackgroundrunning12" device-type="phone,2in1,tablet,wearable,tv">backgroundTaskManager.updateBackgroundRunning<sup>12+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="backgroundtaskmanagerupdatebackgroundrunning12" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>updateBackgroundRunning(context: Context, bgModes: string[]): Promise&lt;ContinuousTaskNotification&gt;</p>     <p>更新长时任务类型，使用Promise异步回调。长时任务更新成功后，会有通知栏消息，没有提示音。</p>     <p>更新长时任务前，可以通过<a href="/consumer/cn/doc/harmonyos-references/js-apis-resourceschedule-backgroundtaskmanager#backgroundtaskmanagergetallcontinuoustasks20">getAllContinuousTasks</a>接口获取当前所有长时任务信息，如果当前没有已经存在的长时任务，会更新失败。</p>     <p>该接口仅支持更新如下三个接口申请的长时任务：</p>     <p><a href="/consumer/cn/doc/harmonyos-references/js-apis-resourceschedule-backgroundtaskmanager#backgroundtaskmanagerstartbackgroundrunning">startBackgroundRunning(context: Context, bgMode: BackgroundMode, wantAgent: WantAgent, callback: AsyncCallback&lt;void&gt;): void</a></p>     <p><a href="/consumer/cn/doc/harmonyos-references/js-apis-resourceschedule-backgroundtaskmanager#backgroundtaskmanagerstartbackgroundrunning-1">startBackgroundRunning(context: Context, bgMode: BackgroundMode, wantAgent: WantAgent): Promise&lt;void&gt;</a></p>     <p><a href="/consumer/cn/doc/harmonyos-references/js-apis-resourceschedule-backgroundtaskmanager#backgroundtaskmanagerstartbackgroundrunning12">startBackgroundRunning(context: Context, bgModes: string[], wantAgent: WantAgent): Promise&lt;ContinuousTaskNotification&gt;</a></p>     <p><strong>需要权限:</strong> ohos.permission.KEEP_BACKGROUND_RUNNING</p>     <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力:</strong> SystemCapability.ResourceSchedule.BackgroundTaskManager.ContinuousTask</p>     <p><strong>参数</strong>：</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.14.13.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.14.13.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.14.13.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.14.13.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">context</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-context">Context</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">应用运行的上下文。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">bgModes</td>         <td class="cellrowborder" width="25%">string[]</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">          <p>更新后的长时任务类型，取值范围请参考长时任务类型中的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/continuous-task#使用场景" target="_blank">配置项</a>。</p>          <p><strong>说明：</strong> 支持传入一个或多个类型。</p></td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值</strong>：</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.14.15.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.14.15.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-resourceschedule-backgroundtaskmanager#continuoustasknotification12">ContinuousTaskNotification</a>&gt;</td>         <td class="cellrowborder" width="50%">Promise对象，返回<a href="/consumer/cn/doc/harmonyos-references/js-apis-resourceschedule-backgroundtaskmanager#continuoustasknotification12">ContinuousTaskNotification</a>类型对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-backgroundtaskmgr">backgroundTaskManager错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.14.18.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.14.18.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1. Mandatory parameters are left unspecified; 2. Incorrect parameters types; 3. Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800001</td>         <td class="cellrowborder" width="50%">Memory operation failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800002</td>         <td class="cellrowborder" width="50%">Failed to write data into parcel. Possible reasons: 1. Invalid parameters; 2. Failed to apply for memory.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800003</td>         <td class="cellrowborder" width="50%">Internal transaction failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800004</td>         <td class="cellrowborder" width="50%">System service operation failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800005</td>         <td class="cellrowborder" width="50%">Continuous task verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800006</td>         <td class="cellrowborder" width="50%">Notification verification failed for a continuous task.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800007</td>         <td class="cellrowborder" width="50%">Continuous task storage failed.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例</strong>：</p>     <div _ngcontent-vqe-c106="" class="highlight-div"><div _ngcontent-vqe-c106="" class="highlight-div-header"><div _ngcontent-vqe-c106="" class="highlight-div-header-left"><div _ngcontent-vqe-c106="" class="handle-button expand-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-vqe-c106="" class="highlight-div-header-right"><div _ngcontent-vqe-c106="" class="handle-button ai-button"></div><div _ngcontent-vqe-c106="" class="handle-button line-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-vqe-c106="" class="handle-button theme-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-vqe-c106="" class="handle-button copy-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-vqe-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { backgroundTaskManager } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BackgroundTasksKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AbilityConstant</span>, <span class="hljs-title class_">UIAbility</span>, <span class="hljs-title class_">Want</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>    <span class="hljs-title function_">onCreate</span>(<span class="hljs-params">want: Want, launchParam: AbilityConstant.LaunchParam</span>) {</li><li>        <span class="hljs-keyword">try</span> {</li><li>            <span class="hljs-comment">// 必须先执行startBackgroundRunning，才能调用updateBackgroundRunning，这里假设已经申请过</span></li><li>            <span class="hljs-keyword">let</span> <span class="hljs-attr">list</span>: <span class="hljs-title class_">Array</span>&lt;string&gt; = [<span class="hljs-string">"audioPlayback"</span>];</li><li>            backgroundTaskManager.<span class="hljs-title function_">updateBackgroundRunning</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>, list).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"Operation updateBackgroundRunning succeeded"</span>);</li><li>            }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error: BusinessError</span>) =&gt;</span> {</li><li>                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Operation updateBackgroundRunning failed. code is <span class="hljs-subst">${error.code}</span> message is <span class="hljs-subst">${error.message}</span>`</span>);</li><li>            });</li><li>        } <span class="hljs-keyword">catch</span> (error) {</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Operation updateBackgroundRunning failed. code is <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> BusinessError).code}</span> message is <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> BusinessError).message}</span>`</span>);</li><li>        }</li><li>    }</li><li>};</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="backgroundtaskmanagergetallcontinuoustasks20" device-type="phone,2in1,tablet,wearable,tv">backgroundTaskManager.getAllContinuousTasks<sup>20+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="backgroundtaskmanagergetallcontinuoustasks20" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>getAllContinuousTasks(context: Context): Promise&lt;ContinuousTaskInfo[]&gt;</p>     <p>获取所有长时任务信息，如长时任务ID、长时任务类型等，使用Promise异步回调。</p>     <p><strong>需要权限</strong>: ohos.permission.KEEP_BACKGROUND_RUNNING</p>     <p><strong>系统能力</strong>: SystemCapability.ResourceSchedule.BackgroundTaskManager.ContinuousTask</p>     <p><strong>参数</strong>：</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.15.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.15.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.15.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.15.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">context</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-context">Context</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">应用运行的上下文。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值</strong>：</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.15.9.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.15.9.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-resourceschedule-backgroundtaskmanager#continuoustaskinfo20">ContinuousTaskInfo</a>[]&gt;</td>         <td class="cellrowborder" width="50%">Promise对象，返回所有长时任务信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-backgroundtaskmgr">backgroundTaskManager错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.15.12.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.15.12.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800002</td>         <td class="cellrowborder" width="50%">Failed to write data into parcel. Possible reasons: 1. Invalid parameters; 2. Failed to apply for memory.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800004</td>         <td class="cellrowborder" width="50%">System service operation failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800005</td>         <td class="cellrowborder" width="50%">Continuous task verification failed.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例</strong>：</p>     <div _ngcontent-vqe-c106="" class="highlight-div"><div _ngcontent-vqe-c106="" class="highlight-div-header"><div _ngcontent-vqe-c106="" class="highlight-div-header-left"><div _ngcontent-vqe-c106="" class="handle-button expand-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-vqe-c106="" class="highlight-div-header-right"><div _ngcontent-vqe-c106="" class="handle-button ai-button"></div><div _ngcontent-vqe-c106="" class="handle-button line-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-vqe-c106="" class="handle-button theme-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-vqe-c106="" class="handle-button copy-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-vqe-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { backgroundTaskManager } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BackgroundTasksKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AbilityConstant</span>, <span class="hljs-title class_">UIAbility</span>, <span class="hljs-title class_">Want</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>    <span class="hljs-title function_">onCreate</span>(<span class="hljs-params">want: Want, launchParam: AbilityConstant.LaunchParam</span>) {</li><li>        <span class="hljs-keyword">try</span> {</li><li>            <span class="hljs-comment">// 如果当前没有申请长时任务，则获取到一个空数组</span></li><li>            backgroundTaskManager.<span class="hljs-title function_">getAllContinuousTasks</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">res: backgroundTaskManager.ContinuousTaskInfo[]</span>) =&gt;</span> {</li><li>                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`Operation getAllContinuousTasks succeeded. data: `</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(res));</li><li>            }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error: BusinessError</span>) =&gt;</span> {</li><li>                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Operation getAllContinuousTasks failed. code is <span class="hljs-subst">${error.code}</span> message is <span class="hljs-subst">${error.message}</span>`</span>);</li><li>            });</li><li>        } <span class="hljs-keyword">catch</span> (error) {</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Operation getAllContinuousTasks failed. code is <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> BusinessError).code}</span> message is <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> BusinessError).message}</span>`</span>);</li><li>        }</li><li>    }</li><li>};</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="backgroundtaskmanagergetallcontinuoustasks20-1" device-type="phone,2in1,tablet,wearable,tv">backgroundTaskManager.getAllContinuousTasks<sup>20+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="backgroundtaskmanagergetallcontinuoustasks20-1" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>getAllContinuousTasks(context: Context, includeSuspended: boolean): Promise&lt;ContinuousTaskInfo[]&gt;</p>     <p>获取所有长时任务信息，如长时任务ID、长时任务类型等。可选择是否获取暂停的长时任务信息，使用Promise异步回调。</p>     <p><strong>需要权限</strong>: ohos.permission.KEEP_BACKGROUND_RUNNING</p>     <p><strong>系统能力</strong>: SystemCapability.ResourceSchedule.BackgroundTaskManager.ContinuousTask</p>     <p><strong>参数</strong>：</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.16.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.16.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.16.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.16.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">context</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-context">Context</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">应用运行的上下文。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">includeSuspended</td>         <td class="cellrowborder" width="25%">boolean</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">是否获取暂停的长时任务信息， true表示获取， false表示不获取。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值</strong>：</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.16.9.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.16.9.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-resourceschedule-backgroundtaskmanager#continuoustaskinfo20">ContinuousTaskInfo</a>[]&gt;</td>         <td class="cellrowborder" width="50%">Promise对象，返回所有长时任务信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-backgroundtaskmgr">backgroundTaskManager错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.16.12.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.16.12.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800002</td>         <td class="cellrowborder" width="50%">Failed to write data into parcel. Possible reasons: 1. Invalid parameters; 2. Failed to apply for memory.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800004</td>         <td class="cellrowborder" width="50%">System service operation failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800005</td>         <td class="cellrowborder" width="50%">Continuous task verification failed.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例</strong>：</p>     <div _ngcontent-vqe-c106="" class="highlight-div"><div _ngcontent-vqe-c106="" class="highlight-div-header"><div _ngcontent-vqe-c106="" class="highlight-div-header-left"><div _ngcontent-vqe-c106="" class="handle-button expand-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-vqe-c106="" class="highlight-div-header-right"><div _ngcontent-vqe-c106="" class="handle-button ai-button"></div><div _ngcontent-vqe-c106="" class="handle-button line-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-vqe-c106="" class="handle-button theme-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-vqe-c106="" class="handle-button copy-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-vqe-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { backgroundTaskManager } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BackgroundTasksKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AbilityConstant</span>, <span class="hljs-title class_">UIAbility</span>, <span class="hljs-title class_">Want</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>    <span class="hljs-title function_">onCreate</span>(<span class="hljs-params">want: Want, launchParam: AbilityConstant.LaunchParam</span>) {</li><li>        <span class="hljs-keyword">try</span> {</li><li>            <span class="hljs-comment">// 如果当前没有申请长时任务，则获取到一个空数组</span></li><li>            backgroundTaskManager.<span class="hljs-title function_">getAllContinuousTasks</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>, <span class="hljs-literal">false</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">res: backgroundTaskManager.ContinuousTaskInfo[]</span>) =&gt;</span> {</li><li>                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`Operation getAllContinuousTasks succeeded. data: `</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(res));</li><li>            }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error: BusinessError</span>) =&gt;</span> {</li><li>                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Operation getAllContinuousTasks failed. code is <span class="hljs-subst">${error.code}</span> message is <span class="hljs-subst">${error.message}</span>`</span>);</li><li>            });</li><li>        } <span class="hljs-keyword">catch</span> (error) {</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Operation getAllContinuousTasks failed. code is <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> BusinessError).code}</span> message is <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> BusinessError).message}</span>`</span>);</li><li>        }</li><li>    }</li><li>};</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="backgroundtaskmanageroncontinuoustaskcancel15" device-type="phone,2in1,tablet,wearable,tv">backgroundTaskManager.on('continuousTaskCancel')<sup>15+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="backgroundtaskmanageroncontinuoustaskcancel15" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>on(type: 'continuousTaskCancel', callback: Callback&lt;ContinuousTaskCancelInfo&gt;): void</p>     <p>注册长时任务取消的监听，使用callback异步回调。</p>     <p><strong>需要权限:</strong> ohos.permission.KEEP_BACKGROUND_RUNNING</p>     <p><strong>系统能力:</strong> SystemCapability.ResourceSchedule.BackgroundTaskManager.ContinuousTask</p>     <p><strong>参数</strong>：</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.17.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.17.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.17.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.17.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">事件回调类型，固定取值为'continuousTaskCancel'，表示长时任务取消。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-resourceschedule-backgroundtaskmanager#continuoustaskcancelinfo15">ContinuousTaskCancelInfo</a>&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数，返回长时任务取消原因等信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.17.10.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.17.10.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible cause: 1. Callback parameter error; 2. Register a exist callback type; 3. Parameter verification failed.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例</strong>：</p>     <div _ngcontent-vqe-c106="" class="highlight-div"><div _ngcontent-vqe-c106="" class="highlight-div-header"><div _ngcontent-vqe-c106="" class="highlight-div-header-left"><div _ngcontent-vqe-c106="" class="handle-button expand-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-vqe-c106="" class="highlight-div-header-right"><div _ngcontent-vqe-c106="" class="handle-button ai-button"></div><div _ngcontent-vqe-c106="" class="handle-button line-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-vqe-c106="" class="handle-button theme-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-vqe-c106="" class="handle-button copy-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-vqe-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { backgroundTaskManager } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BackgroundTasksKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AbilityConstant</span>, <span class="hljs-title class_">UIAbility</span>, <span class="hljs-title class_">Want</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">callback</span>(<span class="hljs-params">info: backgroundTaskManager.ContinuousTaskCancelInfo</span>) {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'continuousTaskCancel callback id '</span> + info.<span class="hljs-property">id</span>);</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'continuousTaskCancel callback reason '</span> + info.<span class="hljs-property">reason</span>);</li><li>}</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>    <span class="hljs-title function_">onCreate</span>(<span class="hljs-params">want: Want, launchParam: AbilityConstant.LaunchParam</span>) {</li><li>        <span class="hljs-keyword">try</span> {</li><li>            backgroundTaskManager.<span class="hljs-title function_">on</span>(<span class="hljs-string">"continuousTaskCancel"</span>, callback);</li><li>        } <span class="hljs-keyword">catch</span> (error) {</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Operation onContinuousTaskCancel failed. code is <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> BusinessError).code}</span> message is <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> BusinessError).message}</span>`</span>);</li><li>        }</li><li>    }</li><li>};</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="backgroundtaskmanageroffcontinuoustaskcancel15" device-type="phone,2in1,tablet,wearable,tv">backgroundTaskManager.off('continuousTaskCancel')<sup>15+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="backgroundtaskmanageroffcontinuoustaskcancel15" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>off(type: 'continuousTaskCancel', callback?: Callback&lt;ContinuousTaskCancelInfo&gt;): void</p>     <p>解除长时任务取消的监听，使用callback异步回调。</p>     <p><strong>需要权限:</strong> ohos.permission.KEEP_BACKGROUND_RUNNING</p>     <p><strong>系统能力:</strong> SystemCapability.ResourceSchedule.BackgroundTaskManager.ContinuousTask</p>     <p><strong>参数</strong>：</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.18.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.18.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.18.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.18.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">取消长时任务，固定取值为'continuousTaskCancel'。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-resourceschedule-backgroundtaskmanager#continuoustaskcancelinfo15">ContinuousTaskCancelInfo</a>&gt;</td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">需要取消监听的回调函数，未传入则取消所有注册回调。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.18.10.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.18.10.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible cause: 1. Callback parameter error; 2. Unregister type has not register; 3. Parameter verification failed.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例</strong>：</p>     <div _ngcontent-vqe-c106="" class="highlight-div"><div _ngcontent-vqe-c106="" class="highlight-div-header"><div _ngcontent-vqe-c106="" class="highlight-div-header-left"><div _ngcontent-vqe-c106="" class="handle-button expand-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-vqe-c106="" class="highlight-div-header-right"><div _ngcontent-vqe-c106="" class="handle-button ai-button"></div><div _ngcontent-vqe-c106="" class="handle-button line-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-vqe-c106="" class="handle-button theme-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-vqe-c106="" class="handle-button copy-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-vqe-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { backgroundTaskManager } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BackgroundTasksKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AbilityConstant</span>, <span class="hljs-title class_">UIAbility</span>, <span class="hljs-title class_">Want</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">callback</span>(<span class="hljs-params">info: backgroundTaskManager.ContinuousTaskCancelInfo</span>) {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'continuousTaskCancel callback id '</span> + info.<span class="hljs-property">id</span>);</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'continuousTaskCancel callback reason '</span> + info.<span class="hljs-property">reason</span>);</li><li>}</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>    <span class="hljs-title function_">onCreate</span>(<span class="hljs-params">want: Want, launchParam: AbilityConstant.LaunchParam</span>) {</li><li>        <span class="hljs-keyword">try</span> {</li><li>            backgroundTaskManager.<span class="hljs-title function_">off</span>(<span class="hljs-string">"continuousTaskCancel"</span>, callback);</li><li>        } <span class="hljs-keyword">catch</span> (error) {</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Operation onContinuousTaskCancel failed. code is <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> BusinessError).code}</span> message is <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> BusinessError).message}</span>`</span>);</li><li>        }</li><li>    }</li><li>};</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="backgroundtaskmanageroncontinuoustasksuspend20" device-type="phone,2in1,tablet,wearable,tv">backgroundTaskManager.on('continuousTaskSuspend')<sup>20+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="backgroundtaskmanageroncontinuoustasksuspend20" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>on(type: 'continuousTaskSuspend', callback: Callback&lt;ContinuousTaskSuspendInfo&gt;): void</p>     <p>注册长时任务暂停的监听，使用callback异步回调。注册该回调后，如果系统首次检测到应用未执行相应的业务，不会直接取消长时任务，而是将长时任务标记为暂停状态，如果连续检测失败，仍会取消长时任务。</p>     <p>长时任务处于暂停状态时，应用退后台会被挂起，回前台自动激活。</p>     <p><strong>需要权限:</strong> ohos.permission.KEEP_BACKGROUND_RUNNING</p>     <p><strong>系统能力:</strong> SystemCapability.ResourceSchedule.BackgroundTaskManager.ContinuousTask</p>     <p><strong>参数</strong>：</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.19.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.19.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.19.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.19.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">事件回调类型，固定取值为'continuousTaskSuspend'，表示长时任务暂停。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-resourceschedule-backgroundtaskmanager#continuoustasksuspendinfo20">ContinuousTaskSuspendInfo</a>&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数，返回长时任务暂停原因等信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-backgroundtaskmgr">backgroundTaskManager错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.19.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.19.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800005</td>         <td class="cellrowborder" width="50%">Continuous task verification failed.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例</strong>：</p>     <div _ngcontent-vqe-c106="" class="highlight-div"><div _ngcontent-vqe-c106="" class="highlight-div-header"><div _ngcontent-vqe-c106="" class="highlight-div-header-left"><div _ngcontent-vqe-c106="" class="handle-button expand-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-vqe-c106="" class="highlight-div-header-right"><div _ngcontent-vqe-c106="" class="handle-button ai-button"></div><div _ngcontent-vqe-c106="" class="handle-button line-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-vqe-c106="" class="handle-button theme-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-vqe-c106="" class="handle-button copy-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-vqe-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { backgroundTaskManager } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BackgroundTasksKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AbilityConstant</span>, <span class="hljs-title class_">UIAbility</span>, <span class="hljs-title class_">Want</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">callback</span>(<span class="hljs-params">info: backgroundTaskManager.ContinuousTaskSuspendInfo</span>) {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'continuousTaskSuspend callback continuousTaskId: '</span> + info.<span class="hljs-property">continuousTaskId</span>);</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'continuousTaskSuspend callback suspendState: '</span> + info.<span class="hljs-property">suspendState</span>);</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'continuousTaskSuspend callback suspendReason: '</span> + info.<span class="hljs-property">suspendReason</span>);</li><li>}</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>    <span class="hljs-title function_">onCreate</span>(<span class="hljs-params">want: Want, launchParam: AbilityConstant.LaunchParam</span>) {</li><li>        <span class="hljs-keyword">try</span> {</li><li>            backgroundTaskManager.<span class="hljs-title function_">on</span>(<span class="hljs-string">"continuousTaskSuspend"</span>, callback);</li><li>        } <span class="hljs-keyword">catch</span> (error) {</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Operation onContinuousTaskSuspend failed. code is <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> BusinessError).code}</span> message is <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> BusinessError).message}</span>`</span>);</li><li>        }</li><li>    }</li><li>};</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="backgroundtaskmanageroffcontinuoustasksuspend20" device-type="phone,2in1,tablet,wearable,tv">backgroundTaskManager.off('continuousTaskSuspend')<sup>20+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="backgroundtaskmanageroffcontinuoustasksuspend20" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>off(type: 'continuousTaskSuspend', callback?: Callback&lt;ContinuousTaskSuspendInfo&gt;): void</p>     <p>取消长时任务暂停的监听，使用callback异步回调。</p>     <p><strong>需要权限:</strong> ohos.permission.KEEP_BACKGROUND_RUNNING</p>     <p><strong>系统能力:</strong> SystemCapability.ResourceSchedule.BackgroundTaskManager.ContinuousTask</p>     <p><strong>参数</strong>：</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.20.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.20.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.20.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.20.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">事件回调类型，固定取值为'continuousTaskSuspend'，表示长时任务暂停。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-resourceschedule-backgroundtaskmanager#continuoustasksuspendinfo20">ContinuousTaskSuspendInfo</a>&gt;</td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">需要取消监听的回调函数，未传入则取消所有注册的暂停回调。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-backgroundtaskmgr">backgroundTaskManager错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.20.10.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.20.10.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800005</td>         <td class="cellrowborder" width="50%">Continuous task verification failed.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例</strong>：</p>     <div _ngcontent-vqe-c106="" class="highlight-div"><div _ngcontent-vqe-c106="" class="highlight-div-header"><div _ngcontent-vqe-c106="" class="highlight-div-header-left"><div _ngcontent-vqe-c106="" class="handle-button expand-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-vqe-c106="" class="highlight-div-header-right"><div _ngcontent-vqe-c106="" class="handle-button ai-button"></div><div _ngcontent-vqe-c106="" class="handle-button line-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-vqe-c106="" class="handle-button theme-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-vqe-c106="" class="handle-button copy-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-vqe-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { backgroundTaskManager } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BackgroundTasksKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AbilityConstant</span>, <span class="hljs-title class_">UIAbility</span>, <span class="hljs-title class_">Want</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">callback</span>(<span class="hljs-params">info: backgroundTaskManager.ContinuousTaskSuspendInfo</span>) {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'continuousTaskSuspend callback continuousTaskId: '</span> + info.<span class="hljs-property">continuousTaskId</span>);</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'continuousTaskSuspend callback suspendState: '</span> + info.<span class="hljs-property">suspendState</span>);</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'continuousTaskSuspend callback suspendReason: '</span> + info.<span class="hljs-property">suspendReason</span>);</li><li>}</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>    <span class="hljs-title function_">onCreate</span>(<span class="hljs-params">want: Want, launchParam: AbilityConstant.LaunchParam</span>) {</li><li>        <span class="hljs-keyword">try</span> {</li><li>            backgroundTaskManager.<span class="hljs-title function_">off</span>(<span class="hljs-string">"continuousTaskSuspend"</span>, callback);</li><li>        } <span class="hljs-keyword">catch</span> (error) {</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Operation offContinuousTaskSuspend failed. code is <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> BusinessError).code}</span> message is <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> BusinessError).message}</span>`</span>);</li><li>        }</li><li>    }</li><li>};</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="backgroundtaskmanageroncontinuoustaskactive20" device-type="phone,2in1,tablet,wearable,tv">backgroundTaskManager.on('continuousTaskActive')<sup>20+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="backgroundtaskmanageroncontinuoustaskactive20" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>on(type: 'continuousTaskActive', callback: Callback&lt;ContinuousTaskActiveInfo&gt;): void</p>     <p>注册长时任务激活的监听，使用callback异步回调。应用回前台激活暂停的长时任务。</p>     <p><strong>需要权限:</strong> ohos.permission.KEEP_BACKGROUND_RUNNING</p>     <p><strong>系统能力:</strong> SystemCapability.ResourceSchedule.BackgroundTaskManager.ContinuousTask</p>     <p><strong>参数</strong>：</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.21.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.21.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.21.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.21.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">事件回调类型，固定取值为'continuousTaskActive'，表示长时任务激活。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-resourceschedule-backgroundtaskmanager#continuoustaskactiveinfo20">ContinuousTaskActiveInfo</a>&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数，返回长时任务激活相关信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-backgroundtaskmgr">backgroundTaskManager错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.21.10.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.21.10.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800005</td>         <td class="cellrowborder" width="50%">Continuous task verification failed.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例</strong>：</p>     <div _ngcontent-vqe-c106="" class="highlight-div"><div _ngcontent-vqe-c106="" class="highlight-div-header"><div _ngcontent-vqe-c106="" class="highlight-div-header-left"><div _ngcontent-vqe-c106="" class="handle-button expand-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-vqe-c106="" class="highlight-div-header-right"><div _ngcontent-vqe-c106="" class="handle-button ai-button"></div><div _ngcontent-vqe-c106="" class="handle-button line-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-vqe-c106="" class="handle-button theme-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-vqe-c106="" class="handle-button copy-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-vqe-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { backgroundTaskManager } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BackgroundTasksKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AbilityConstant</span>, <span class="hljs-title class_">UIAbility</span>, <span class="hljs-title class_">Want</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">callback</span>(<span class="hljs-params">info: backgroundTaskManager.ContinuousTaskActiveInfo</span>) {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'continuousTaskActive callback id: '</span> + info.<span class="hljs-property">id</span>);</li><li>}</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>    <span class="hljs-title function_">onCreate</span>(<span class="hljs-params">want: Want, launchParam: AbilityConstant.LaunchParam</span>) {</li><li>        <span class="hljs-keyword">try</span> {</li><li>            backgroundTaskManager.<span class="hljs-title function_">on</span>(<span class="hljs-string">"continuousTaskActive"</span>, callback);</li><li>        } <span class="hljs-keyword">catch</span> (error) {</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Operation onContinuousTaskActive failed. code is <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> BusinessError).code}</span> message is <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> BusinessError).message}</span>`</span>);</li><li>        }</li><li>    }</li><li>};</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="backgroundtaskmanageroffcontinuoustaskactive20" device-type="phone,2in1,tablet,wearable,tv">backgroundTaskManager.off('continuousTaskActive')<sup>20+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="backgroundtaskmanageroffcontinuoustaskactive20" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>off(type: 'continuousTaskActive', callback?: Callback&lt;ContinuousTaskActiveInfo&gt;): void</p>     <p>取消长时任务激活的监听，使用callback异步回调。</p>     <p><strong>需要权限:</strong> ohos.permission.KEEP_BACKGROUND_RUNNING</p>     <p><strong>系统能力:</strong> SystemCapability.ResourceSchedule.BackgroundTaskManager.ContinuousTask</p>     <p><strong>参数</strong>：</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.22.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.22.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.22.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.22.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">事件回调类型，固定取值为'continuousTaskActive'，表示长时任务激活。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Callback&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-resourceschedule-backgroundtaskmanager#continuoustaskactiveinfo20">ContinuousTaskActiveInfo</a>&gt;</td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">需要取消监听的回调函数，未传入则取消所有注册的激活回调。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-backgroundtaskmgr">backgroundTaskManager错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.22.10.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.22.10.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800005</td>         <td class="cellrowborder" width="50%">Continuous task verification failed.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例</strong>：</p>     <div _ngcontent-vqe-c106="" class="highlight-div"><div _ngcontent-vqe-c106="" class="highlight-div-header"><div _ngcontent-vqe-c106="" class="highlight-div-header-left"><div _ngcontent-vqe-c106="" class="handle-button expand-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-vqe-c106="" class="highlight-div-header-right"><div _ngcontent-vqe-c106="" class="handle-button ai-button"></div><div _ngcontent-vqe-c106="" class="handle-button line-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-vqe-c106="" class="handle-button theme-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-vqe-c106="" class="handle-button copy-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-vqe-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { backgroundTaskManager } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BackgroundTasksKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AbilityConstant</span>, <span class="hljs-title class_">UIAbility</span>, <span class="hljs-title class_">Want</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">callback</span>(<span class="hljs-params">info: backgroundTaskManager.ContinuousTaskActiveInfo</span>) {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'continuousTaskActive callback id: '</span> + info.<span class="hljs-property">id</span>);</li><li>}</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>    <span class="hljs-title function_">onCreate</span>(<span class="hljs-params">want: Want, launchParam: AbilityConstant.LaunchParam</span>) {</li><li>        <span class="hljs-keyword">try</span> {</li><li>            backgroundTaskManager.<span class="hljs-title function_">off</span>(<span class="hljs-string">"continuousTaskActive"</span>, callback);</li><li>        } <span class="hljs-keyword">catch</span> (error) {</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Operation offContinuousTaskActive failed. code is <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> BusinessError).code}</span> message is <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> BusinessError).message}</span>`</span>);</li><li>        }</li><li>    }</li><li>};</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="backgroundtaskmanagerstartbackgroundrunning21" device-type="phone,2in1,tablet,wearable,tv">backgroundTaskManager.startBackgroundRunning<sup>21+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="backgroundtaskmanagerstartbackgroundrunning21" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>startBackgroundRunning(context: Context, request: ContinuousTaskRequest): Promise&lt;ContinuousTaskNotification&gt;</p>     <p>申请长时任务，一个UIAbility（FA模型则为ServiceAbility）下支持通过本接口申请多个长时任务，使用Promise异步回调。通过本接口申请长时任务时，支持与已存在的长时任务合并通知，具体请参考<a href="/consumer/cn/doc/harmonyos-references/js-apis-resourceschedule-backgroundtaskmanager#continuoustaskrequest21">ContinuousTaskRequest</a>。</p>     <p>同一时间最多可存在10个长时任务，长时任务申请成功后，会有通知栏消息，没有提示音。</p>     <p>如果通过本接口申请的一个长时任务中同时包含多种类型，且包含数据传输类型，则在通知栏会发送2个长时任务通知，一个为数据传输类型，另一个为其他类型的合并通知。任意一个通知被移除时，长时任务取消，且另一个通知也会同步移除。接口返回的长时任务通知Id为数据传输类型的Id，主要用于数据传输的进度更新。</p>     <p><strong>需要权限:</strong> ohos.permission.KEEP_BACKGROUND_RUNNING</p>     <p><strong>系统能力:</strong> SystemCapability.ResourceSchedule.BackgroundTaskManager.ContinuousTask</p>     <p><strong>参数</strong>：</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.23.9.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.23.9.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.23.9.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.23.9.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">context</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-context">Context</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">应用运行的上下文。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">request</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-resourceschedule-backgroundtaskmanager#continuoustaskrequest21">ContinuousTaskRequest</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">长时任务请求信息，包括长时任务主类型、子类型等。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值</strong>：</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.23.11.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.23.11.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-resourceschedule-backgroundtaskmanager#continuoustasknotification12">ContinuousTaskNotification</a>&gt;</td>         <td class="cellrowborder" width="50%">Promise对象，返回长时任务通知信息，包括长时任务ID等。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-backgroundtaskmgr">backgroundTaskManager错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.23.14.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.23.14.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800001</td>         <td class="cellrowborder" width="50%">Memory operation failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800004</td>         <td class="cellrowborder" width="50%">System service operation failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800005</td>         <td class="cellrowborder" width="50%">Continuous task verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800006</td>         <td class="cellrowborder" width="50%">Notification verification failed for a continuous task.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800007</td>         <td class="cellrowborder" width="50%">Continuous task storage failed.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例</strong>：</p>     <div _ngcontent-vqe-c106="" class="highlight-div"><div _ngcontent-vqe-c106="" class="highlight-div-header"><div _ngcontent-vqe-c106="" class="highlight-div-header-left"><div _ngcontent-vqe-c106="" class="handle-button expand-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-vqe-c106="" class="highlight-div-header-right"><div _ngcontent-vqe-c106="" class="handle-button ai-button"></div><div _ngcontent-vqe-c106="" class="handle-button line-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-vqe-c106="" class="handle-button theme-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-vqe-c106="" class="handle-button copy-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-vqe-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { backgroundTaskManager } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BackgroundTasksKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AbilityConstant</span>, <span class="hljs-title class_">UIAbility</span>, <span class="hljs-title class_">Want</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { wantAgent, <span class="hljs-title class_">WantAgent</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-attr">notificationId</span>: number = <span class="hljs-number">0</span>; <span class="hljs-comment">// 保存通知id</span></li><li>  <span class="hljs-attr">continuousTaskId</span>: number | <span class="hljs-literal">undefined</span> = -<span class="hljs-number">1</span>;</li><li>  <span class="hljs-title function_">onCreate</span>(<span class="hljs-params">want: Want, launchParam: AbilityConstant.LaunchParam</span>) {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">wantAgentInfo</span>: wantAgent.<span class="hljs-property">WantAgentInfo</span> = {</li><li>      <span class="hljs-comment">// 请开发者替换为实际被拉起应用的bundleName和abilityName</span></li><li>      <span class="hljs-attr">wants</span>: [</li><li>        {</li><li>          <span class="hljs-attr">bundleName</span>: <span class="hljs-string">"com.example.myapplication"</span>,</li><li>          <span class="hljs-attr">abilityName</span>: <span class="hljs-string">"EntryAbility"</span></li><li>        }</li><li>      ],</li><li>      <span class="hljs-comment">// 设置点击通知后的动作类型</span></li><li>      <span class="hljs-attr">actionType</span>: wantAgent.<span class="hljs-property">OperationType</span>.<span class="hljs-property">START_ABILITY</span>,</li><li>      <span class="hljs-comment">// 开发者自定义的请求码，用于标识将被执行的动作</span></li><li>      <span class="hljs-attr">requestCode</span>: <span class="hljs-number">0</span>,</li><li>      <span class="hljs-comment">// 设置点击通知后的动作执行属性</span></li><li>      <span class="hljs-attr">wantAgentFlags</span>: [wantAgent.<span class="hljs-property">WantAgentFlags</span>.<span class="hljs-property">UPDATE_PRESENT_FLAG</span>]</li><li>    };</li><li>
</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-comment">// 通过wantAgent模块下getWantAgent方法获取WantAgent对象</span></li><li>      wantAgent.<span class="hljs-title function_">getWantAgent</span>(wantAgentInfo).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">wantAgentObj: WantAgent</span>) =&gt;</span> {</li><li>        <span class="hljs-keyword">try</span> {</li><li>          <span class="hljs-comment">// 如果要合并通知，主类型和子类型都必须相同，combinedTaskNotification为true，continuousTaskId必须存在且合法</span></li><li>          <span class="hljs-comment">// 申请主类型为MODE_LOCATION的长时任务</span></li><li>          <span class="hljs-keyword">let</span> <span class="hljs-attr">modeList</span>: <span class="hljs-title class_">Array</span>&lt;number&gt; = [backgroundTaskManager.<span class="hljs-property">BackgroundTaskMode</span>.<span class="hljs-property">MODE_LOCATION</span>];</li><li>          <span class="hljs-keyword">let</span> <span class="hljs-attr">subModeList</span>: <span class="hljs-title class_">Array</span>&lt;number&gt; = [backgroundTaskManager.<span class="hljs-property">BackgroundTaskSubmode</span>.<span class="hljs-property">SUBMODE_NORMAL_NOTIFICATION</span>];</li><li>          <span class="hljs-keyword">let</span> continuousTaskRequest = <span class="hljs-keyword">new</span> backgroundTaskManager.<span class="hljs-title class_">ContinuousTaskRequest</span>();</li><li>          continuousTaskRequest.<span class="hljs-property">backgroundTaskModes</span> =  modeList;</li><li>          continuousTaskRequest.<span class="hljs-property">backgroundTaskSubmodes</span> = subModeList;</li><li>          continuousTaskRequest.<span class="hljs-property">wantAgent</span> = wantAgentObj;</li><li>          continuousTaskRequest.<span class="hljs-property">combinedTaskNotification</span> = <span class="hljs-literal">false</span>;</li><li>          continuousTaskRequest.<span class="hljs-property">continuousTaskId</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">continuousTaskId</span>;</li><li>          backgroundTaskManager.<span class="hljs-title function_">startBackgroundRunning</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>, continuousTaskRequest).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">res: backgroundTaskManager.ContinuousTaskNotification</span>) =&gt;</span> {</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`Operation startBackgroundRunning succeeded. notificationId is <span class="hljs-subst">${res.notificationId}</span> continuousTaskId is <span class="hljs-subst">${res.continuousTaskId}</span>`</span>);</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">notificationId</span> = res.<span class="hljs-property">notificationId</span>;</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">continuousTaskId</span> = res.<span class="hljs-property">continuousTaskId</span>;</li><li>          }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error: BusinessError</span>) =&gt;</span> {</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Operation startBackgroundRunning failed. code is <span class="hljs-subst">${error.code}</span> message is <span class="hljs-subst">${error.message}</span>`</span>);</li><li>          });</li><li>        } <span class="hljs-keyword">catch</span> (error) {</li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Operation startBackgroundRunning failed. code is <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> BusinessError).code}</span> message is <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> BusinessError).message}</span>`</span>);</li><li>        }</li><li>      });</li><li>    } <span class="hljs-keyword">catch</span> (error) {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Operation getWantAgent failed. code is <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> BusinessError).code}</span> message is <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> BusinessError).message}</span>`</span>);</li><li>    }</li><li>  }</li><li>};</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="backgroundtaskmanagerupdatebackgroundrunning21" device-type="phone,2in1,tablet,wearable,tv">backgroundTaskManager.updateBackgroundRunning<sup>21+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="backgroundtaskmanagerupdatebackgroundrunning21" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>updateBackgroundRunning(context: Context, request: ContinuousTaskRequest): Promise&lt;ContinuousTaskNotification&gt;</p>     <p>更新长时任务，使用Promise异步回调。长时任务更新成功后，会有通知栏消息，没有提示音。</p>     <p>更新长时任务还存在如下约束限制：</p>     <ol>      <li>本接口仅支持更新如下接口申请的长时任务：<a href="/consumer/cn/doc/harmonyos-references/js-apis-resourceschedule-backgroundtaskmanager#backgroundtaskmanagerstartbackgroundrunning21">startBackgroundRunning(context: Context, request: ContinuousTaskRequest): Promise&lt;ContinuousTaskNotification&gt;</a>。</li>      <li>已经合并的长时任务，且后台任务主类型和子类型均相同，仅支持更新ContinuousTaskRequest.wantAgent中的wants信息（abilityName等），如果类型不同，更新失败。</li>      <li>如果待更新的长时任务或指定的更新类型中包含数据传输类型，直接返回失败。</li>     </ol>     <p><strong>需要权限:</strong> ohos.permission.KEEP_BACKGROUND_RUNNING</p>     <p><strong>系统能力:</strong> SystemCapability.ResourceSchedule.BackgroundTaskManager.ContinuousTask</p>     <p><strong>参数</strong>：</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.24.9.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.24.9.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.24.9.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.24.9.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">context</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-context">Context</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">应用运行的上下文。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">request</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-resourceschedule-backgroundtaskmanager#continuoustaskrequest21">ContinuousTaskRequest</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">长时任务请求信息, 包括待更新的长时任务ID等。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值</strong>：</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.24.11.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.24.11.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;<a href="/consumer/cn/doc/harmonyos-references/js-apis-resourceschedule-backgroundtaskmanager#continuoustasknotification12">ContinuousTaskNotification</a>&gt;</td>         <td class="cellrowborder" width="50%">Promise对象，返回更新后的长时任务通知信息，包括长时任务ID等。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-backgroundtaskmgr">backgroundTaskManager错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.24.14.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.24.14.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800001</td>         <td class="cellrowborder" width="50%">Memory operation failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800004</td>         <td class="cellrowborder" width="50%">System service operation failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800005</td>         <td class="cellrowborder" width="50%">Continuous task verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800006</td>         <td class="cellrowborder" width="50%">Notification verification failed for a continuous task.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800007</td>         <td class="cellrowborder" width="50%">Continuous task storage failed.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例</strong>：</p>     <div _ngcontent-vqe-c106="" class="highlight-div"><div _ngcontent-vqe-c106="" class="highlight-div-header"><div _ngcontent-vqe-c106="" class="highlight-div-header-left"><div _ngcontent-vqe-c106="" class="handle-button expand-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-vqe-c106="" class="highlight-div-header-right"><div _ngcontent-vqe-c106="" class="handle-button ai-button"></div><div _ngcontent-vqe-c106="" class="handle-button line-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-vqe-c106="" class="handle-button theme-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-vqe-c106="" class="handle-button copy-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-vqe-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { backgroundTaskManager } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BackgroundTasksKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AbilityConstant</span>, <span class="hljs-title class_">UIAbility</span>, <span class="hljs-title class_">Want</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { wantAgent, <span class="hljs-title class_">WantAgent</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-attr">notificationId</span>: number = <span class="hljs-number">0</span>; <span class="hljs-comment">// 保存通知id</span></li><li>  <span class="hljs-attr">continuousTaskId</span>: number | <span class="hljs-literal">undefined</span> = -<span class="hljs-number">1</span>; <span class="hljs-comment">//长时任务ID</span></li><li>  <span class="hljs-title function_">onCreate</span>(<span class="hljs-params">want: Want, launchParam: AbilityConstant.LaunchParam</span>) {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">wantAgentInfo</span>: wantAgent.<span class="hljs-property">WantAgentInfo</span> = {</li><li>      <span class="hljs-comment">// 添加需要被拉起应用的bundleName和abilityName, 请开发者替换为实际的bundleName和abilityName</span></li><li>      <span class="hljs-attr">wants</span>: [</li><li>        {</li><li>          <span class="hljs-attr">bundleName</span>: <span class="hljs-string">"com.example.myapplication"</span>,</li><li>          <span class="hljs-attr">abilityName</span>: <span class="hljs-string">"EntryAbility"</span></li><li>        }</li><li>      ],</li><li>      <span class="hljs-comment">// 设置点击通知后的动作类型</span></li><li>      <span class="hljs-attr">actionType</span>: wantAgent.<span class="hljs-property">OperationType</span>.<span class="hljs-property">START_ABILITY</span>,</li><li>      <span class="hljs-comment">// 开发者自定义的请求码，用于标识将被执行的动作</span></li><li>      <span class="hljs-attr">requestCode</span>: <span class="hljs-number">0</span>,</li><li>      <span class="hljs-comment">// 设置点击通知后的动作执行属性</span></li><li>      <span class="hljs-attr">wantAgentFlags</span>: [wantAgent.<span class="hljs-property">WantAgentFlags</span>.<span class="hljs-property">UPDATE_PRESENT_FLAG</span>]</li><li>    };</li><li>
</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-comment">// 通过wantAgent模块下getWantAgent方法获取WantAgent对象</span></li><li>      wantAgent.<span class="hljs-title function_">getWantAgent</span>(wantAgentInfo).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">wantAgentObj: WantAgent</span>) =&gt;</span> {</li><li>        <span class="hljs-keyword">try</span> {</li><li>          <span class="hljs-comment">// 必须先执行startBackgroundRunning，才能调用updateBackgroundRunning，请开发者提前申请长时任务</span></li><li>          <span class="hljs-keyword">let</span> <span class="hljs-attr">modeList</span>: <span class="hljs-title class_">Array</span>&lt;number&gt; = [backgroundTaskManager.<span class="hljs-property">BackgroundTaskMode</span>.<span class="hljs-property">MODE_LOCATION</span>];</li><li>          <span class="hljs-keyword">let</span> <span class="hljs-attr">subModeList</span>: <span class="hljs-title class_">Array</span>&lt;number&gt; = [backgroundTaskManager.<span class="hljs-property">BackgroundTaskSubmode</span>.<span class="hljs-property">SUBMODE_NORMAL_NOTIFICATION</span>];</li><li>          <span class="hljs-keyword">let</span> continuousTaskRequest = <span class="hljs-keyword">new</span> backgroundTaskManager.<span class="hljs-title class_">ContinuousTaskRequest</span>();</li><li>          continuousTaskRequest.<span class="hljs-property">backgroundTaskModes</span> =  modeList;</li><li>          continuousTaskRequest.<span class="hljs-property">backgroundTaskSubmodes</span> = subModeList;</li><li>          continuousTaskRequest.<span class="hljs-property">wantAgent</span> = wantAgentObj;</li><li>          continuousTaskRequest.<span class="hljs-property">combinedTaskNotification</span> = <span class="hljs-literal">false</span>;</li><li>          continuousTaskRequest.<span class="hljs-property">continuousTaskId</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">continuousTaskId</span>; <span class="hljs-comment">//对于更新接口，长时任务ID必须要传且为存在的ID，否则更新失败</span></li><li>          backgroundTaskManager.<span class="hljs-title function_">updateBackgroundRunning</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>, continuousTaskRequest).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">res: backgroundTaskManager.ContinuousTaskNotification</span>) =&gt;</span> {</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"Operation updateBackgroundRunning succeeded"</span>);</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">notificationId</span> = res.<span class="hljs-property">notificationId</span>;</li><li>          }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error: BusinessError</span>) =&gt;</span> {</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Operation updateBackgroundRunning failed. code is <span class="hljs-subst">${error.code}</span> message is <span class="hljs-subst">${error.message}</span>`</span>);</li><li>          });</li><li>        } <span class="hljs-keyword">catch</span> (error) {</li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Operation updateBackgroundRunning failed. code is <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> BusinessError).code}</span> message is <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> BusinessError).message}</span>`</span>);</li><li>        }</li><li>      });</li><li>    } <span class="hljs-keyword">catch</span> (error) {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Operation getWantAgent failed. code is <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> BusinessError).code}</span> message is <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> BusinessError).message}</span>`</span>);</li><li>    }</li><li>  }</li><li>};</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="backgroundtaskmanagerstopbackgroundrunning21" device-type="phone,2in1,tablet,wearable,tv">backgroundTaskManager.stopBackgroundRunning<sup>21+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="backgroundtaskmanagerstopbackgroundrunning21" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>stopBackgroundRunning(context: Context, continuousTaskId: number): Promise&lt;void&gt;</p>     <p>取消指定Id的长时任务，使用Promise异步回调。也可以通过<a href="/consumer/cn/doc/harmonyos-references/js-apis-resourceschedule-backgroundtaskmanager#backgroundtaskmanagerstopbackgroundrunning">stopBackgroundRunning</a>取消当前UIAbility下所有长时任务。</p>     <p><strong>系统能力:</strong> SystemCapability.ResourceSchedule.BackgroundTaskManager.ContinuousTask</p>     <p><strong>参数</strong>：</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.25.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.25.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.25.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.25.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">context</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-context">Context</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">应用运行的上下文。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">continuousTaskId</td>         <td class="cellrowborder" width="25%">number</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">          <p>长时任务ID。</p>          <p><strong>说明 :</strong> 可以通过<a href="/consumer/cn/doc/harmonyos-references/js-apis-resourceschedule-backgroundtaskmanager#backgroundtaskmanagerstartbackgroundrunning21">startBackgroundRunning</a>接口的返回值获取当前申请的长时任务ID，或者通过<a href="/consumer/cn/doc/harmonyos-references/js-apis-resourceschedule-backgroundtaskmanager#backgroundtaskmanagergetallcontinuoustasks20-1">getAllContinuousTasks</a>接口获取所有长时任务信息。</p></td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值</strong>：</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.25.8.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.25.8.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">无返回结果的Promise对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-backgroundtaskmgr">backgroundTaskManager错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.25.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.25.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">9800001</td>         <td class="cellrowborder" width="50%">Memory operation failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800004</td>         <td class="cellrowborder" width="50%">System service operation failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800005</td>         <td class="cellrowborder" width="50%">Continuous task verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800006</td>         <td class="cellrowborder" width="50%">Notification verification failed for a continuous task.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800007</td>         <td class="cellrowborder" width="50%">Continuous task storage failed.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例</strong>：</p>     <div _ngcontent-vqe-c106="" class="highlight-div"><div _ngcontent-vqe-c106="" class="highlight-div-header"><div _ngcontent-vqe-c106="" class="highlight-div-header-left"><div _ngcontent-vqe-c106="" class="handle-button expand-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-vqe-c106="" class="highlight-div-header-right"><div _ngcontent-vqe-c106="" class="handle-button ai-button"></div><div _ngcontent-vqe-c106="" class="handle-button line-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-vqe-c106="" class="handle-button theme-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-vqe-c106="" class="handle-button copy-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-vqe-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { backgroundTaskManager } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BackgroundTasksKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AbilityConstant</span>, <span class="hljs-title class_">UIAbility</span>, <span class="hljs-title class_">Want</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-attr">continuousTaskId</span>: number = <span class="hljs-number">0</span>;</li><li>  <span class="hljs-title function_">onCreate</span>(<span class="hljs-params">want: Want, launchParam: AbilityConstant.LaunchParam</span>) {</li><li>    <span class="hljs-keyword">try</span> {</li><li>        backgroundTaskManager.<span class="hljs-title function_">stopBackgroundRunning</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">continuousTaskId</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"Operation stopBackgroundRunning succeeded"</span>);</li><li>        }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error: BusinessError</span>) =&gt;</span> {</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Operation stopBackgroundRunning failed. code is <span class="hljs-subst">${error.code}</span> message is <span class="hljs-subst">${error.message}</span>`</span>);</li><li>        });</li><li>    } <span class="hljs-keyword">catch</span> (error) {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Operation stopBackgroundRunning failed. code is <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> BusinessError).code}</span> message is <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> BusinessError).message}</span>`</span>);</li><li>    }</li><li>  }</li><li>};</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="delaysuspendinfo" device-type="phone,2in1,tablet,wearable,tv">DelaySuspendInfo<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="delaysuspendinfo" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>短时任务信息。</p>     <p><strong>系统能力:</strong> SystemCapability.ResourceSchedule.BackgroundTaskManager.TransientTask</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.26.4.1.6.1.1" width="20%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.26.4.1.6.1.2" width="20%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.26.4.1.6.1.3" width="20%">只读</th>         <th align="left" class="cellrowborder" id="mcps1.3.26.4.1.6.1.4" width="20%">可选</th>         <th align="left" class="cellrowborder" id="mcps1.3.26.4.1.6.1.5" width="20%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">requestId</td>         <td class="cellrowborder" width="20%">number</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">短时任务的请求ID。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">actualDelayTime</td>         <td class="cellrowborder" width="20%">number</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">          <p>应用实际申请的短时任务时间，单位：ms。</p>          <p><strong>说明</strong> ：申请时间最长为3分钟，<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-battery-info">低电量</a>时最长为1分钟。</p></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="transienttaskinfo20" device-type="phone,2in1,tablet,wearable,tv">TransientTaskInfo<sup>20+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="transienttaskinfo20" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>所有短时任务信息。</p>     <p><strong>系统能力</strong>: SystemCapability.ResourceSchedule.BackgroundTaskManager.TransientTask</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.27.4.1.6.1.1" width="20%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.27.4.1.6.1.2" width="20%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.27.4.1.6.1.3" width="20%">只读</th>         <th align="left" class="cellrowborder" id="mcps1.3.27.4.1.6.1.4" width="20%">可选</th>         <th align="left" class="cellrowborder" id="mcps1.3.27.4.1.6.1.5" width="20%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">remainingQuota</td>         <td class="cellrowborder" width="20%">number</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">应用当日所剩余总配额，单位：ms。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">transientTasks</td>         <td class="cellrowborder" width="20%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-resourceschedule-backgroundtaskmanager#delaysuspendinfo">DelaySuspendInfo</a>[]</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">当前已申请的所有短时任务信息。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="backgroundmode" device-type="phone,2in1,tablet,wearable,tv">BackgroundMode<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="backgroundmode" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>长时任务类型。</p>     <p><strong>系统能力:</strong> SystemCapability.ResourceSchedule.BackgroundTaskManager.ContinuousTask</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.28.4.1.4.1.1" width="33.33333333333333%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.28.4.1.4.1.2" width="33.33333333333333%">值</th>         <th align="left" class="cellrowborder" id="mcps1.3.28.4.1.4.1.3" width="33.33333333333333%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="33.33333333333333%">DATA_TRANSFER</td>         <td class="cellrowborder" width="33.33333333333333%">1</td>         <td class="cellrowborder" width="33.33333333333333%">          <p>数据传输。</p>          <p><strong>说明：</strong> 在数据传输时，应用需要更新进度，如果进度长时间（超过10分钟）未更新，数据传输的长时任务会被取消。</p>          <p>更新进度的通知类型必须为实况窗，具体实现可参考<a href="/consumer/cn/doc/harmonyos-references/js-apis-resourceschedule-backgroundtaskmanager#backgroundtaskmanagerstartbackgroundrunning12">startBackgroundRunning()</a>中的示例。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">AUDIO_PLAYBACK</td>         <td class="cellrowborder" width="33.33333333333333%">2</td>         <td class="cellrowborder" width="33.33333333333333%">          <p>音视频播放。</p>          <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p>          <p><strong>说明：</strong> 从API version 20开始，申请/更新AUDIO_PLAYBACK类型长时任务但不接入AVSession，申请/更新长时任务成功后会在通知栏显示通知。</p>          <p>接入AVSession后，后台任务模块不会发送通知栏通知，由AVSession发送通知。</p>          <p>对于API version 19及之前的版本，后台任务模块不会在通知栏显示通知。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">AUDIO_RECORDING</td>         <td class="cellrowborder" width="33.33333333333333%">3</td>         <td class="cellrowborder" width="33.33333333333333%">录制。</td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">LOCATION</td>         <td class="cellrowborder" width="33.33333333333333%">4</td>         <td class="cellrowborder" width="33.33333333333333%">定位导航。</td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">BLUETOOTH_INTERACTION</td>         <td class="cellrowborder" width="33.33333333333333%">5</td>         <td class="cellrowborder" width="33.33333333333333%">蓝牙相关业务。</td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">MULTI_DEVICE_CONNECTION</td>         <td class="cellrowborder" width="33.33333333333333%">6</td>         <td class="cellrowborder" width="33.33333333333333%">          <p>多设备互联。</p>          <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">VOIP<sup>13+</sup></td>         <td class="cellrowborder" width="33.33333333333333%">8</td>         <td class="cellrowborder" width="33.33333333333333%">音视频通话。</td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">TASK_KEEPING</td>         <td class="cellrowborder" width="33.33333333333333%">9</td>         <td class="cellrowborder" width="33.33333333333333%">          <p>计算任务（仅对2in1设备开放）。</p>          <p><strong>说明：</strong> 从API version 21开始，对PC/2in1设备、非PC/2in1设备但申请了ACL权限为<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/restricted-permissions#ohospermissionkeep_background_running_system" target="_blank">ohos.permission.KEEP_BACKGROUND_RUNNING_SYSTEM</a>的应用开放。 API version 20及之前版本，仅对PC/2in1设备开放。</p></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="continuoustasknotification12" device-type="phone,2in1,tablet,wearable,tv">ContinuousTaskNotification<sup>12+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="continuoustasknotification12" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>长时任务通知信息。</p>     <p><strong>系统能力:</strong> SystemCapability.ResourceSchedule.BackgroundTaskManager.ContinuousTask</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.29.4.1.6.1.1" width="20%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.29.4.1.6.1.2" width="20%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.29.4.1.6.1.3" width="20%">只读</th>         <th align="left" class="cellrowborder" id="mcps1.3.29.4.1.6.1.4" width="20%">可选</th>         <th align="left" class="cellrowborder" id="mcps1.3.29.4.1.6.1.5" width="20%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">slotType</td>         <td class="cellrowborder" width="20%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-notificationmanager#slottype">notificationManager.SlotType</a></td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">          <p>长时任务通知的渠道类型。</p>          <p><strong>说明：</strong> 长时任务申请或更新成功后不支持提示音。</p>          <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">contentType</td>         <td class="cellrowborder" width="20%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-notificationmanager#contenttype">notificationManager.ContentType</a></td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">          <p>长时任务通知的内容类型。</p>          <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">notificationId</td>         <td class="cellrowborder" width="20%">number</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">          <p>长时任务通知 Id。</p>          <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">continuousTaskId<sup>15+</sup></td>         <td class="cellrowborder" width="20%">number</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">长时任务 Id。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="continuoustaskcancelinfo15" device-type="phone,2in1,tablet,wearable,tv">ContinuousTaskCancelInfo<sup>15+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="continuoustaskcancelinfo15" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>长时任务取消信息。</p>     <p><strong>系统能力:</strong> SystemCapability.ResourceSchedule.BackgroundTaskManager.ContinuousTask</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.30.4.1.6.1.1" width="20%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.30.4.1.6.1.2" width="20%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.30.4.1.6.1.3" width="20%">只读</th>         <th align="left" class="cellrowborder" id="mcps1.3.30.4.1.6.1.4" width="20%">可选</th>         <th align="left" class="cellrowborder" id="mcps1.3.30.4.1.6.1.5" width="20%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">reason</td>         <td class="cellrowborder" width="20%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-resourceschedule-backgroundtaskmanager#continuoustaskcancelreason15">ContinuousTaskCancelReason</a></td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">长时任务取消原因。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">id</td>         <td class="cellrowborder" width="20%">number</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">被取消的长时任务 Id。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="continuoustaskcancelreason15" device-type="phone,2in1,tablet,wearable,tv">ContinuousTaskCancelReason<sup>15+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="continuoustaskcancelreason15" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>长时任务取消原因。</p>     <p><strong>系统能力:</strong> SystemCapability.ResourceSchedule.BackgroundTaskManager.ContinuousTask</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.31.4.1.4.1.1" width="33.33333333333333%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.31.4.1.4.1.2" width="33.33333333333333%">值</th>         <th align="left" class="cellrowborder" id="mcps1.3.31.4.1.4.1.3" width="33.33333333333333%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="33.33333333333333%">USER_CANCEL</td>         <td class="cellrowborder" width="33.33333333333333%">1</td>         <td class="cellrowborder" width="33.33333333333333%">用户取消。</td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">SYSTEM_CANCEL</td>         <td class="cellrowborder" width="33.33333333333333%">2</td>         <td class="cellrowborder" width="33.33333333333333%">系统取消。</td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">USER_CANCEL_REMOVE_NOTIFICATION</td>         <td class="cellrowborder" width="33.33333333333333%">3</td>         <td class="cellrowborder" width="33.33333333333333%">用户移除通知。预留接口，暂未启用。</td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">SYSTEM_CANCEL_DATA_TRANSFER_LOW_SPEED</td>         <td class="cellrowborder" width="33.33333333333333%">4</td>         <td class="cellrowborder" width="33.33333333333333%">申请DATA_TRANSFER类型长时任务，但是数据传输速率低。预留接口，暂未启用。</td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">SYSTEM_CANCEL_AUDIO_PLAYBACK_NOT_USE_AVSESSION</td>         <td class="cellrowborder" width="33.33333333333333%">5</td>         <td class="cellrowborder" width="33.33333333333333%">申请AUDIO_PLAYBACK类型长时任务，但是未接入<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/avsession-overview" target="_blank">AVSession</a>。预留接口，暂未启用。</td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">SYSTEM_CANCEL_AUDIO_PLAYBACK_NOT_RUNNING</td>         <td class="cellrowborder" width="33.33333333333333%">6</td>         <td class="cellrowborder" width="33.33333333333333%">申请AUDIO_PLAYBACK类型长时任务，但是未播放音视频。预留接口，暂未启用。</td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">SYSTEM_CANCEL_AUDIO_RECORDING_NOT_RUNNING</td>         <td class="cellrowborder" width="33.33333333333333%">7</td>         <td class="cellrowborder" width="33.33333333333333%">申请AUDIO_RECORDING类型长时任务，但是未录制。预留接口，暂未启用。</td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">SYSTEM_CANCEL_NOT_USE_LOCATION</td>         <td class="cellrowborder" width="33.33333333333333%">8</td>         <td class="cellrowborder" width="33.33333333333333%">申请LOCATION类型长时任务，但是未使用定位导航。预留接口，暂未启用。</td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">SYSTEM_CANCEL_NOT_USE_BLUETOOTH</td>         <td class="cellrowborder" width="33.33333333333333%">9</td>         <td class="cellrowborder" width="33.33333333333333%">申请BLUETOOTH_INTERACTION类型长时任务，但是未使用蓝牙相关业务。预留接口，暂未启用。</td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">SYSTEM_CANCEL_NOT_USE_MULTI_DEVICE</td>         <td class="cellrowborder" width="33.33333333333333%">10</td>         <td class="cellrowborder" width="33.33333333333333%">申请MULTI_DEVICE_CONNECTION类型长时任务，但是未使用多设备互联。预留接口，暂未启用。</td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">SYSTEM_CANCEL_USE_ILLEGALLY</td>         <td class="cellrowborder" width="33.33333333333333%">11</td>         <td class="cellrowborder" width="33.33333333333333%">使用非法类型的长时任务，如申请AUDIO_PLAYBACK类型长时任务，但是使用音视频播放及定位导航业务。预留接口，暂未启用。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="backgroundsubmode16" device-type="phone,2in1,tablet,wearable,tv">BackgroundSubMode<sup>16+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="backgroundsubmode16" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>长时任务子类型。</p>     <p><strong>系统能力:</strong> SystemCapability.ResourceSchedule.BackgroundTaskManager.ContinuousTask</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.32.4.1.4.1.1" width="33.33333333333333%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.32.4.1.4.1.2" width="33.33333333333333%">值</th>         <th align="left" class="cellrowborder" id="mcps1.3.32.4.1.4.1.3" width="33.33333333333333%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="33.33333333333333%">CAR_KEY</td>         <td class="cellrowborder" width="33.33333333333333%">1</td>         <td class="cellrowborder" width="33.33333333333333%">          <p>车钥匙。</p>          <p><strong>说明：</strong> 只有申请BLUETOOTH_INTERACTION类型的长时任务，车钥匙子类型才能生效。</p></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="backgroundmodetype16" device-type="phone,2in1,tablet,wearable,tv">BackgroundModeType<sup>16+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="backgroundmodetype16" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>长时任务类型类别。</p>     <p><strong>系统能力:</strong> SystemCapability.ResourceSchedule.BackgroundTaskManager.ContinuousTask</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.33.4.1.4.1.1" width="33.33333333333333%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.33.4.1.4.1.2" width="33.33333333333333%">值</th>         <th align="left" class="cellrowborder" id="mcps1.3.33.4.1.4.1.3" width="33.33333333333333%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="33.33333333333333%">SUB_MODE</td>         <td class="cellrowborder" width="33.33333333333333%">'subMode'</td>         <td class="cellrowborder" width="33.33333333333333%">子类型。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="continuoustasksuspendinfo20" device-type="phone,2in1,tablet,wearable,tv">ContinuousTaskSuspendInfo<sup>20+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="continuoustasksuspendinfo20" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>长时任务暂停信息。</p>     <p><strong>系统能力:</strong> SystemCapability.ResourceSchedule.BackgroundTaskManager.ContinuousTask</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.34.4.1.6.1.1" width="20%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.34.4.1.6.1.2" width="20%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.34.4.1.6.1.3" width="20%">只读</th>         <th align="left" class="cellrowborder" id="mcps1.3.34.4.1.6.1.4" width="20%">可选</th>         <th align="left" class="cellrowborder" id="mcps1.3.34.4.1.6.1.5" width="20%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">continuousTaskId</td>         <td class="cellrowborder" width="20%">number</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">被暂停的长时任务 Id。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">suspendState</td>         <td class="cellrowborder" width="20%">boolean</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">长时任务状态，false表示激活，true表示暂停。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">suspendReason</td>         <td class="cellrowborder" width="20%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-resourceschedule-backgroundtaskmanager#continuoustasksuspendreason20">ContinuousTaskSuspendReason</a></td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">长时任务暂停原因。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="continuoustasksuspendreason20" device-type="phone,2in1,tablet,wearable,tv">ContinuousTaskSuspendReason<sup>20+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="continuoustasksuspendreason20" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>长时任务暂停原因。</p>     <p><strong>系统能力:</strong> SystemCapability.ResourceSchedule.BackgroundTaskManager.ContinuousTask</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.35.4.1.4.1.1" width="33.33333333333333%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.35.4.1.4.1.2" width="33.33333333333333%">值</th>         <th align="left" class="cellrowborder" id="mcps1.3.35.4.1.4.1.3" width="33.33333333333333%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="33.33333333333333%">SYSTEM_SUSPEND_DATA_TRANSFER_LOW_SPEED</td>         <td class="cellrowborder" width="33.33333333333333%">4</td>         <td class="cellrowborder" width="33.33333333333333%">申请DATA_TRANSFER类型长时任务，但是数据传输速率低。</td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">SYSTEM_SUSPEND_AUDIO_PLAYBACK_NOT_USE_AVSESSION</td>         <td class="cellrowborder" width="33.33333333333333%">5</td>         <td class="cellrowborder" width="33.33333333333333%">申请AUDIO_PLAYBACK类型长时任务，但是未接入<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/avsession-overview" target="_blank">AVSession</a>。</td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">SYSTEM_SUSPEND_AUDIO_PLAYBACK_NOT_RUNNING</td>         <td class="cellrowborder" width="33.33333333333333%">6</td>         <td class="cellrowborder" width="33.33333333333333%">申请AUDIO_PLAYBACK类型长时任务，但是未播放音视频。</td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">SYSTEM_SUSPEND_AUDIO_RECORDING_NOT_RUNNING</td>         <td class="cellrowborder" width="33.33333333333333%">7</td>         <td class="cellrowborder" width="33.33333333333333%">申请AUDIO_RECORDING类型长时任务，但是未录制。</td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">SYSTEM_SUSPEND_LOCATION_NOT_USED</td>         <td class="cellrowborder" width="33.33333333333333%">8</td>         <td class="cellrowborder" width="33.33333333333333%">申请LOCATION类型长时任务，但是未使用定位导航。</td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">SYSTEM_SUSPEND_BLUETOOTH_NOT_USED</td>         <td class="cellrowborder" width="33.33333333333333%">9</td>         <td class="cellrowborder" width="33.33333333333333%">申请BLUETOOTH_INTERACTION类型长时任务，但是未使用蓝牙相关业务。</td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">SYSTEM_SUSPEND_MULTI_DEVICE_NOT_USED</td>         <td class="cellrowborder" width="33.33333333333333%">10</td>         <td class="cellrowborder" width="33.33333333333333%">申请MULTI_DEVICE_CONNECTION类型长时任务，但是未使用多设备互联。</td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">SYSTEM_SUSPEND_USED_ILLEGALLY</td>         <td class="cellrowborder" width="33.33333333333333%">11</td>         <td class="cellrowborder" width="33.33333333333333%">使用非法类型的长时任务，如申请AUDIO_PLAYBACK类型长时任务，但是使用音视频播放及定位导航业务。预留接口，暂未启用。</td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">SYSTEM_SUSPEND_SYSTEM_LOAD_WARNING</td>         <td class="cellrowborder" width="33.33333333333333%">12</td>         <td class="cellrowborder" width="33.33333333333333%">系统高负载暂停长时任务。预留接口，暂未启用。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="continuoustaskactiveinfo20" device-type="phone,2in1,tablet,wearable,tv">ContinuousTaskActiveInfo<sup>20+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="continuoustaskactiveinfo20" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>长时任务激活信息。</p>     <p><strong>系统能力:</strong> SystemCapability.ResourceSchedule.BackgroundTaskManager.ContinuousTask</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.36.4.1.6.1.1" width="20%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.36.4.1.6.1.2" width="20%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.36.4.1.6.1.3" width="20%">只读</th>         <th align="left" class="cellrowborder" id="mcps1.3.36.4.1.6.1.4" width="20%">可选</th>         <th align="left" class="cellrowborder" id="mcps1.3.36.4.1.6.1.5" width="20%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">id</td>         <td class="cellrowborder" width="20%">number</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">被激活的长时任务 Id。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="continuoustaskinfo20" device-type="phone,2in1,tablet,wearable,tv">ContinuousTaskInfo<sup>20+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="continuoustaskinfo20" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>长时任务信息。</p>     <p><strong>系统能力</strong>: SystemCapability.ResourceSchedule.BackgroundTaskManager.ContinuousTask</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.37.4.1.6.1.1" width="20%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.37.4.1.6.1.2" width="20%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.37.4.1.6.1.3" width="20%">只读</th>         <th align="left" class="cellrowborder" id="mcps1.3.37.4.1.6.1.4" width="20%">可选</th>         <th align="left" class="cellrowborder" id="mcps1.3.37.4.1.6.1.5" width="20%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">abilityName</td>         <td class="cellrowborder" width="20%">string</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">UIAbility名称。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">uid</td>         <td class="cellrowborder" width="20%">number</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">应用的UID。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">pid</td>         <td class="cellrowborder" width="20%">number</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">应用进程的PID。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">isFromWebView</td>         <td class="cellrowborder" width="20%">boolean</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是否通过Webview方式申请，即通过系统代理应用申请长时任务。true表示通过Webview方式申请，false表示不通过Webview方式申请。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-resourceschedule-backgroundtaskmanager#backgroundmode">backgroundModes</a></td>         <td class="cellrowborder" width="20%">string[]</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">长时任务类型。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-resourceschedule-backgroundtaskmanager#backgroundsubmode16">backgroundSubModes</a></td>         <td class="cellrowborder" width="20%">string[]</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">长时任务子类型。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">notificationId</td>         <td class="cellrowborder" width="20%">number</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">通知 Id。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">continuousTaskId</td>         <td class="cellrowborder" width="20%">number</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">长时任务ID。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">abilityId</td>         <td class="cellrowborder" width="20%">number</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">UIAbility Id。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">wantAgentBundleName</td>         <td class="cellrowborder" width="20%">string</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-wantagent">WantAgent</a> 配置的包名。WantAgent为通知参数，用于指定点击长时任务通知后跳转的界面，在申请长时任务时作为参数传入。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">wantAgentAbilityName</td>         <td class="cellrowborder" width="20%">string</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-wantagent">WantAgent</a> 配置的ability名称。WantAgent为通知参数，用于指定点击长时任务通知后跳转的界面，在申请长时任务时作为参数传入。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">suspendState</td>         <td class="cellrowborder" width="20%">boolean</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">申请的长时任务是否处于暂停状态。true表示处于暂停状态，false表示处于激活状态。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="continuoustaskrequest21" device-type="phone,2in1,tablet,wearable,tv">ContinuousTaskRequest<sup>21+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="continuoustaskrequest21" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>通常作为<a href="/consumer/cn/doc/harmonyos-references/js-apis-resourceschedule-backgroundtaskmanager#backgroundtaskmanagerstartbackgroundrunning21">startBackgroundRunning()</a>和<a href="/consumer/cn/doc/harmonyos-references/js-apis-resourceschedule-backgroundtaskmanager#backgroundtaskmanagerupdatebackgroundrunning21">updateBackgroundRunning</a>接口的入参，用于指定申请或更新的长时任务信息。其中：</p>     <ol>      <li>通过<a href="/consumer/cn/doc/harmonyos-references/js-apis-resourceschedule-backgroundtaskmanager#backgroundtaskmanagerstartbackgroundrunning21">startBackgroundRunning()</a>接口申请长时任务时，如果待申请长时任务与当前应用下已存在长时任务，两者的主类型和子类型均相同，且combinedTaskNotification均取值为true，则会合并通知。否则不会合并通知。</li>      <li>如果长时任务本身没有通知，则不会合并，长时任务类型是否会通知请参考<a href="/consumer/cn/doc/harmonyos-references/js-apis-resourceschedule-backgroundtaskmanager#backgroundtaskmode21">BackgroundTaskMode</a>。</li>      <li>如果长时任务类型中包含数据传输类型，则不会合并通知。</li>      <li>通知合并后不能取消合并，已合并的不能更新成不合并。</li>      <li>通知合并后，点击通知栏消息，会跳转到第一个申请的长时任务对应的UIAbility，如果调用了更新接口，则跳转到最后一次更新的长时任务对应的UIAbility。</li>      <li>通过<a href="/consumer/cn/doc/harmonyos-references/js-apis-resourceschedule-backgroundtaskmanager#backgroundtaskmanagerupdatebackgroundrunning21">updateBackgroundRunning</a>接口更新长时任务时，传入的continuousTaskId必须存在，否则更新失败。</li>     </ol>    </div>    <div class="tiledSection">     <h3 id="属性" device-type="phone,2in1,tablet,wearable,tv" class="firsth2">属性<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="属性" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p><strong>系统能力:</strong> SystemCapability.ResourceSchedule.BackgroundTaskManager.ContinuousTask</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.39.3.1.6.1.1" width="20%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.39.3.1.6.1.2" width="20%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.39.3.1.6.1.3" width="20%">只读</th>         <th align="left" class="cellrowborder" id="mcps1.3.39.3.1.6.1.4" width="20%">可选</th>         <th align="left" class="cellrowborder" id="mcps1.3.39.3.1.6.1.5" width="20%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">backgroundTaskModes</td>         <td class="cellrowborder" width="20%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-resourceschedule-backgroundtaskmanager#backgroundtaskmode21">BackgroundTaskMode</a>[]</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">          <p>长时任务主类型。</p>          <p><strong>说明：</strong> 主类型与子类型必须匹配。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">backgroundTaskSubmodes</td>         <td class="cellrowborder" width="20%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-resourceschedule-backgroundtaskmanager#backgroundtasksubmode21">BackgroundTaskSubmode</a>[]</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">          <p>长时任务子类型。</p>          <p><strong>说明：</strong> 主类型与子类型必须匹配。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">wantAgent</td>         <td class="cellrowborder" width="20%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-wantagent#wantagent">WantAgent</a></td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">通知参数，用于指定点击长时任务通知后跳转的界面。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">combinedTaskNotification</td>         <td class="cellrowborder" width="20%">boolean</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">          <p>是否合并通知，true表示合并，false表示不合并，默认为false。</p>          <p><strong>说明：</strong> 该属性在<a href="/consumer/cn/doc/harmonyos-references/js-apis-resourceschedule-backgroundtaskmanager#backgroundtaskmanagerupdatebackgroundrunning21">updateBackgroundRunning</a>接口中不生效，如需在已有任务上合并通知，请重新申请该任务，并在申请时设置为支持合并。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">continuousTaskId</td>         <td class="cellrowborder" width="20%">number</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">          <p>长时任务ID，默认值为-1。</p>          <p><strong>说明：</strong> 如果combinedTaskNotification取值为true，则该值为必填项，且必须是存在的ID。</p>          <p>作为<a href="/consumer/cn/doc/harmonyos-references/js-apis-resourceschedule-backgroundtaskmanager#backgroundtaskmanagerupdatebackgroundrunning21">updateBackgroundRunning</a>接口入参时，该属性必填，且必须是存在的ID。</p>          <p>可以通过<a href="/consumer/cn/doc/harmonyos-references/js-apis-resourceschedule-backgroundtaskmanager#backgroundtaskmanagergetallcontinuoustasks20-1">getAllContinuousTasks</a>接口查看当前所有长时任务信息。</p></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h3 id="ismodesupported21" device-type="phone,2in1,tablet,wearable,tv">isModeSupported<sup>21+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="ismodesupported21" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>isModeSupported(): boolean</p>     <p>查询当前<a href="/consumer/cn/doc/harmonyos-references/js-apis-resourceschedule-backgroundtaskmanager#continuoustaskrequest21">ContinuousTaskRequest</a>设置的长时任务主类型，是否支持申请长时任务。是否支持申请长时任务请参考<a href="/consumer/cn/doc/harmonyos-references/js-apis-resourceschedule-backgroundtaskmanager#backgroundtaskmode21">BackgroundTaskMode</a>的说明。</p>     <p><strong>需要权限:</strong> ohos.permission.KEEP_BACKGROUND_RUNNING</p>     <p><strong>系统能力:</strong> SystemCapability.ResourceSchedule.BackgroundTaskManager.ContinuousTask</p>     <p><strong>返回值</strong>：</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.40.7.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.40.7.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">boolean</td>         <td class="cellrowborder" width="50%">返回长时任务主类型是否支持。true表示支持，false表示不支持。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-backgroundtaskmgr">backgroundTaskManager错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.40.10.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.40.10.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">Permission denied.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">9800005</td>         <td class="cellrowborder" width="50%">Continuous task verification failed.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例</strong>：</p>     <div _ngcontent-vqe-c106="" class="highlight-div"><div _ngcontent-vqe-c106="" class="highlight-div-header"><div _ngcontent-vqe-c106="" class="highlight-div-header-left"><div _ngcontent-vqe-c106="" class="handle-button expand-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-vqe-c106="" class="highlight-div-header-right"><div _ngcontent-vqe-c106="" class="handle-button ai-button"></div><div _ngcontent-vqe-c106="" class="handle-button line-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-vqe-c106="" class="handle-button theme-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-vqe-c106="" class="handle-button copy-button"><div _ngcontent-vqe-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-vqe-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { backgroundTaskManager } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BackgroundTasksKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AbilityConstant</span>, <span class="hljs-title class_">UIAbility</span>, <span class="hljs-title class_">Want</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onCreate</span>(<span class="hljs-params">want: Want, launchParam: AbilityConstant.LaunchParam</span>) {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">isModeSupported</span>: boolean = <span class="hljs-literal">false</span>;</li><li>    <span class="hljs-keyword">let</span> continuousTaskRequest = <span class="hljs-keyword">new</span> backgroundTaskManager.<span class="hljs-title class_">ContinuousTaskRequest</span>();</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">modeList</span>: <span class="hljs-title class_">Array</span>&lt;number&gt; = [backgroundTaskManager.<span class="hljs-property">BackgroundTaskMode</span>.<span class="hljs-property">MODE_TASK_KEEPING</span>];</li><li>    continuousTaskRequest.<span class="hljs-property">backgroundTaskModes</span> = modeList;</li><li>    <span class="hljs-keyword">try</span> {</li><li>      isModeSupported = continuousTaskRequest.<span class="hljs-title function_">isModeSupported</span>();</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`Operation isModeSupported succeeded. isModeSupported is <span class="hljs-subst">${isModeSupported}</span>`</span>);</li><li>    } <span class="hljs-keyword">catch</span> (error) {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Operation startBackgroundRunning failed. code is <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> BusinessError).code}</span> message is <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> BusinessError).message}</span>`</span>);</li><li>    }</li><li>  }</li><li>};</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="backgroundtaskmode21" device-type="phone,2in1,tablet,wearable,tv">BackgroundTaskMode<sup>21+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="backgroundtaskmode21" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>长时任务主类型。通常与长时任务子类型<a href="/consumer/cn/doc/harmonyos-references/js-apis-resourceschedule-backgroundtaskmanager#backgroundtasksubmode21">BackgroundTaskSubmode</a>配合使用，对照关系请参考长时任务主类型与子类型对照表，两者共同作为API version 21新增的<a href="/consumer/cn/doc/harmonyos-references/js-apis-resourceschedule-backgroundtaskmanager#backgroundtaskmanagerstartbackgroundrunning21">申请</a>、<a href="/consumer/cn/doc/harmonyos-references/js-apis-resourceschedule-backgroundtaskmanager#backgroundtaskmanagerupdatebackgroundrunning21">更新</a>长时任务接口入参，用于指定长时任务类型。</p>     <p><strong>系统能力</strong>: SystemCapability.ResourceSchedule.BackgroundTaskManager.ContinuousTask</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.41.4.1.4.1.1" width="33.33333333333333%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.41.4.1.4.1.2" width="33.33333333333333%">值</th>         <th align="left" class="cellrowborder" id="mcps1.3.41.4.1.4.1.3" width="33.33333333333333%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="33.33333333333333%">MODE_DATA_TRANSFER</td>         <td class="cellrowborder" width="33.33333333333333%">1</td>         <td class="cellrowborder" width="33.33333333333333%">          <p>数据传输。</p>          <p><strong>说明：</strong> 在数据传输时，应用需要更新进度，如果进度长时间（超过10分钟）未更新，数据传输的长时任务会被取消。</p>          <p>更新进度的通知类型必须为实况窗，具体实现可参考<a href="/consumer/cn/doc/harmonyos-references/js-apis-resourceschedule-backgroundtaskmanager#backgroundtaskmanagerstartbackgroundrunning12">startBackgroundRunning()</a>中的示例。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">MODE_AUDIO_PLAYBACK</td>         <td class="cellrowborder" width="33.33333333333333%">2</td>         <td class="cellrowborder" width="33.33333333333333%">          <p>音视频播放。</p>          <p><strong>说明：</strong> 申请/更新MODE_AUDIO_PLAYBACK类型长时任务但不接入AVSession，申请/更新长时任务成功后会在通知栏显示通知。</p>          <p>接入AVSession后，后台任务模块不会发送通知栏通知，由AVSession发送通知。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">MODE_AUDIO_RECORDING</td>         <td class="cellrowborder" width="33.33333333333333%">3</td>         <td class="cellrowborder" width="33.33333333333333%">录制。</td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">MODE_LOCATION</td>         <td class="cellrowborder" width="33.33333333333333%">4</td>         <td class="cellrowborder" width="33.33333333333333%">定位导航。</td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">MODE_BLUETOOTH_INTERACTION</td>         <td class="cellrowborder" width="33.33333333333333%">5</td>         <td class="cellrowborder" width="33.33333333333333%">蓝牙相关业务。</td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">MODE_MULTI_DEVICE_CONNECTION</td>         <td class="cellrowborder" width="33.33333333333333%">6</td>         <td class="cellrowborder" width="33.33333333333333%">多设备互联。</td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">MODE_VOIP</td>         <td class="cellrowborder" width="33.33333333333333%">8</td>         <td class="cellrowborder" width="33.33333333333333%">音视频通话。</td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">MODE_TASK_KEEPING</td>         <td class="cellrowborder" width="33.33333333333333%">9</td>         <td class="cellrowborder" width="33.33333333333333%">计算任务（仅对PC/2in1设备开放，或者非PC/2in1设备但申请了ACL权限为<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/restricted-permissions#ohospermissionkeep_background_running_system" target="_blank">ohos.permission.KEEP_BACKGROUND_RUNNING_SYSTEM</a>的应用开放）。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="backgroundtasksubmode21" device-type="phone,2in1,tablet,wearable,tv">BackgroundTaskSubmode<sup>21+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="backgroundtasksubmode21" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>长时任务子类型。通常与长时任务主类型<a href="/consumer/cn/doc/harmonyos-references/js-apis-resourceschedule-backgroundtaskmanager#backgroundtaskmode21">BackgroundTaskMode</a>配合使用，对照关系请参考长时任务主类型与子类型对照表，两者共同作为API version 21新增的申请、更新长时任务接口入参，用于指定长时任务类型。</p>     <p><strong>系统能力</strong>: SystemCapability.ResourceSchedule.BackgroundTaskManager.ContinuousTask</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.42.4.1.4.1.1" width="33.33333333333333%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.42.4.1.4.1.2" width="33.33333333333333%">值</th>         <th align="left" class="cellrowborder" id="mcps1.3.42.4.1.4.1.3" width="33.33333333333333%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="33.33333333333333%">SUBMODE_CAR_KEY_NORMAL_NOTIFICATION</td>         <td class="cellrowborder" width="33.33333333333333%">1</td>         <td class="cellrowborder" width="33.33333333333333%">车钥匙类型通知。</td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">SUBMODE_NORMAL_NOTIFICATION</td>         <td class="cellrowborder" width="33.33333333333333%">2</td>         <td class="cellrowborder" width="33.33333333333333%">普通通知。</td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">SUBMODE_LIVE_VIEW_NOTIFICATION</td>         <td class="cellrowborder" width="33.33333333333333%">3</td>         <td class="cellrowborder" width="33.33333333333333%">实况窗通知。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>长时任务主类型与子类型对照表：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.42.6.1.3.1.1" width="50%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-resourceschedule-backgroundtaskmanager#backgroundtaskmode21">长时任务主类型</a></th>         <th align="left" class="cellrowborder" id="mcps1.3.42.6.1.3.1.2" width="50%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-resourceschedule-backgroundtaskmanager#backgroundtasksubmode21">长时任务子类型</a></th>        </tr><tr>         <td class="cellrowborder" width="50%">MODE_DATA_TRANSFER</td>         <td class="cellrowborder" width="50%">SUBMODE_LIVE_VIEW_NOTIFICATION</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">MODE_AUDIO_PLAYBACK</td>         <td class="cellrowborder" width="50%">SUBMODE_NORMAL_NOTIFICATION</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">MODE_AUDIO_RECORDING</td>         <td class="cellrowborder" width="50%">SUBMODE_NORMAL_NOTIFICATION</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">MODE_LOCATION</td>         <td class="cellrowborder" width="50%">SUBMODE_NORMAL_NOTIFICATION</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">MODE_BLUETOOTH_INTERACTION</td>         <td class="cellrowborder" width="50%">          <p>SUBMODE_NORMAL_NOTIFICATION</p>          <p>SUBMODE_CAR_KEY_NORMAL_NOTIFICATION</p></td>        </tr>        <tr>         <td class="cellrowborder" width="50%">MODE_MULTI_DEVICE_CONNECTION</td>         <td class="cellrowborder" width="50%">SUBMODE_NORMAL_NOTIFICATION</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">MODE_VOIP</td>         <td class="cellrowborder" width="50%">SUBMODE_NORMAL_NOTIFICATION</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">MODE_TASK_KEEPING</td>         <td class="cellrowborder" width="50%">SUBMODE_NORMAL_NOTIFICATION</td>        </tr>             </tbody></table></div>     </div>    </div>   </div>   <div></div></div>