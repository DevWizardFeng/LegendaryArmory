<h1 _ngcontent-osy-c119="" class="doc-title ng-star-inserted" title="@system.fetch (数据请求)（已废弃）"> @system.fetch (数据请求)（已废弃） </h1>

<div _ngcontent-osy-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div><div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"> <ul><li><p>从API Version 6开始，该接口不再维护，推荐使用新接口<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-http">@ohos.net.http</a>。</p>  </li><li><p>本模块首批接口从API version 3开始支持。后续版本的新增接口，采用上角标单独标记接口的起始版本。</p>  </li></ul>  </div></div></div>  <div class="tiledSection"><h2 id="导入模块" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">导入模块<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="导入模块" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><div _ngcontent-osy-c106="" class="highlight-div"><div _ngcontent-osy-c106="" class="highlight-div-header"><div _ngcontent-osy-c106="" class="highlight-div-header-left"><div _ngcontent-osy-c106="" class="handle-button expand-button"><div _ngcontent-osy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-osy-c106="" class="highlight-div-header-right"><div _ngcontent-osy-c106="" class="handle-button ai-button"></div><div _ngcontent-osy-c106="" class="handle-button line-button"><div _ngcontent-osy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-osy-c106="" class="handle-button theme-button"><div _ngcontent-osy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-osy-c106="" class="handle-button copy-button"><div _ngcontent-osy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-osy-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> fetch <span class="hljs-keyword">from</span> <span class="hljs-string">'@system.fetch'</span>;</li></ol></pre></div></div> </div>  <div class="tiledSection"><h2 id="fetchfetch3" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">fetch.fetch<sup>3+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="fetchfetch3" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p>fetch(options:{ </p> <p>  url: string;</p> <p>  data?: string | object;</p> <p>  header?: Object;</p> <p>  method?: string;</p> <p>  responseType?: string;</p> <p>  success?: (data: FetchResponse) =&gt; void;</p> <p>  fail?: (data: any, code: number) =&gt; void;</p> <p>  complete?: () =&gt; void;</p> <p> } ): void</p> <p>通过网络获取数据。</p> <p><strong>系统能力：</strong> SystemCapability.Communication.NetStack </p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.3.15.1.5.1.1" width="25%">参数名</th> <th align="left" class="cellrowborder" id="mcps1.3.3.15.1.5.1.2" width="25%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.3.15.1.5.1.3" width="25%">必填</th> <th align="left" class="cellrowborder" id="mcps1.3.3.15.1.5.1.4" width="25%">说明</th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="25%">url</td> <td class="cellrowborder" width="25%">string</td> <td class="cellrowborder" width="25%">是</td> <td class="cellrowborder" width="25%">资源地址。</td> </tr> <tr><td class="cellrowborder" width="25%">data</td> <td class="cellrowborder" width="25%">string | Object</td> <td class="cellrowborder" width="25%">否</td> <td class="cellrowborder" width="25%">请求的参数，可选类型是字符串或者json对象。详见表 data与Content-Type关系。</td> </tr> <tr><td class="cellrowborder" width="25%">header</td> <td class="cellrowborder" width="25%">Object</td> <td class="cellrowborder" width="25%">否</td> <td class="cellrowborder" width="25%">设置请求的header。</td> </tr> <tr><td class="cellrowborder" width="25%">method</td> <td class="cellrowborder" width="25%">string</td> <td class="cellrowborder" width="25%">否</td> <td class="cellrowborder" width="25%">请求方法默认为GET，可选值为：OPTIONS、GET、HEAD、POST、PUT、DELETE、TRACE。</td> </tr> <tr><td class="cellrowborder" width="25%">responseType</td> <td class="cellrowborder" width="25%">string</td> <td class="cellrowborder" width="25%">否</td> <td class="cellrowborder" width="25%">默认会根据服务器返回header中的Content-Type确定返回类型，支持文本和json格式。详见success返回值。</td> </tr> <tr><td class="cellrowborder" width="25%">success</td> <td class="cellrowborder" width="25%">Function</td> <td class="cellrowborder" width="25%">否</td> <td class="cellrowborder" width="25%">接口调用成功的回调函数，返回值为<a href="/consumer/cn/doc/harmonyos-references/js-apis-system-fetch#fetchresponse3">FetchResponse</a>。</td> </tr> <tr><td class="cellrowborder" width="25%">fail</td> <td class="cellrowborder" width="25%">Function</td> <td class="cellrowborder" width="25%">否</td> <td class="cellrowborder" width="25%">接口调用失败的回调函数。</td> </tr> <tr><td class="cellrowborder" width="25%">complete</td> <td class="cellrowborder" width="25%">Function</td> <td class="cellrowborder" width="25%">否</td> <td class="cellrowborder" width="25%">接口调用结束的回调函数。</td> </tr>  </tbody></table></div> </div> <p><strong>表1</strong> data与Content-Type关系</p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.3.17.1.4.1.1" width="33.33333333333333%">data</th> <th align="left" class="cellrowborder" id="mcps1.3.3.17.1.4.1.2" width="33.33333333333333%">Content-Type</th> <th align="left" class="cellrowborder" id="mcps1.3.3.17.1.4.1.3" width="33.33333333333333%">说明</th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="33.33333333333333%">string</td> <td class="cellrowborder" width="33.33333333333333%">不设置</td> <td class="cellrowborder" width="33.33333333333333%">Content-Type默认为 text/plain，data值作为请求的body。</td> </tr> <tr><td class="cellrowborder" width="33.33333333333333%">string</td> <td class="cellrowborder" width="33.33333333333333%">任意 Type</td> <td class="cellrowborder" width="33.33333333333333%">data值作为请求的body。</td> </tr> <tr><td class="cellrowborder" width="33.33333333333333%">Object</td> <td class="cellrowborder" width="33.33333333333333%">不设置</td> <td class="cellrowborder" width="33.33333333333333%">Content-Type默认为application/x-www-form-urlencoded，data按照资源地址规则进行encode拼接作为请求的body。</td> </tr> <tr><td class="cellrowborder" width="33.33333333333333%">Object</td> <td class="cellrowborder" width="33.33333333333333%">application/x-www-form-urlencoded</td> <td class="cellrowborder" width="33.33333333333333%">data按照资源地址规则进行encode拼接作为请求的body。</td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h2 id="fetchresponse3" device-type="phone,2in1,tablet,wearable,lite_wearable,tv">FetchResponse<sup>3+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="fetchresponse3" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span><span class="support-device-item">Lite Wearable</span></div><p><strong>系统能力：</strong> SystemCapability.Communication.NetStack </p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.4.3.1.6.1.1" width="20%">名称</th> <th align="left" class="cellrowborder" id="mcps1.3.4.3.1.6.1.2" width="20%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.4.3.1.6.1.3" width="20%">只读</th> <th align="left" class="cellrowborder" id="mcps1.3.4.3.1.6.1.4" width="20%">可选</th> <th align="left" class="cellrowborder" id="mcps1.3.4.3.1.6.1.5" width="20%">说明</th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="20%">code</td> <td class="cellrowborder" width="20%">number</td> <td class="cellrowborder" width="20%">否</td> <td class="cellrowborder" width="20%">否</td> <td class="cellrowborder" width="20%">表示服务器的状态code。</td> </tr> <tr><td class="cellrowborder" width="20%">data</td> <td class="cellrowborder" width="20%">string | Object</td> <td class="cellrowborder" width="20%">否</td> <td class="cellrowborder" width="20%">否</td> <td class="cellrowborder" width="20%">返回数据类型由responseType确定，详见表 responseType与success中data关系。</td> </tr> <tr><td class="cellrowborder" width="20%">headers</td> <td class="cellrowborder" width="20%">Object</td> <td class="cellrowborder" width="20%">否</td> <td class="cellrowborder" width="20%">否</td> <td class="cellrowborder" width="20%">表示服务器response的所有header。</td> </tr>  </tbody></table></div> </div> <p><strong>表2</strong> responseType与success中data关系</p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.4.5.1.4.1.1" width="33.33333333333333%">responseType</th> <th align="left" class="cellrowborder" id="mcps1.3.4.5.1.4.1.2" width="33.33333333333333%">data</th> <th align="left" class="cellrowborder" id="mcps1.3.4.5.1.4.1.3" width="33.33333333333333%">说明</th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="33.33333333333333%">无</td> <td class="cellrowborder" width="33.33333333333333%">string</td> <td class="cellrowborder" width="33.33333333333333%">服务器返回的header中的type如果是text/*或application/json、application/javascript、application/xml，值为文本内容。</td> </tr> <tr><td class="cellrowborder" width="33.33333333333333%">text</td> <td class="cellrowborder" width="33.33333333333333%">string</td> <td class="cellrowborder" width="33.33333333333333%">返回文本内容。</td> </tr> <tr><td class="cellrowborder" width="33.33333333333333%">json</td> <td class="cellrowborder" width="33.33333333333333%">Object</td> <td class="cellrowborder" width="33.33333333333333%">返回json格式的对象。</td> </tr>  </tbody></table></div> </div> <p><strong>示例：</strong></p> <div _ngcontent-osy-c106="" class="highlight-div"><div _ngcontent-osy-c106="" class="highlight-div-header"><div _ngcontent-osy-c106="" class="highlight-div-header-left"><div _ngcontent-osy-c106="" class="handle-button expand-button"><div _ngcontent-osy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-osy-c106="" class="highlight-div-header-right"><div _ngcontent-osy-c106="" class="handle-button ai-button"></div><div _ngcontent-osy-c106="" class="handle-button line-button"><div _ngcontent-osy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-osy-c106="" class="handle-button theme-button"><div _ngcontent-osy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-osy-c106="" class="handle-button copy-button"><div _ngcontent-osy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-osy-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-variable">export</span> <span class="hljs-variable">default</span> {</li><li>  <span class="hljs-variable">data</span>: {</li><li>    <span class="hljs-variable">responseData</span>: <span class="hljs-string">'NA'</span>,</li><li>    <span class="hljs-variable">url</span>: <span class="hljs-string">"test_url"</span>,</li><li>  },</li><li>  <span class="hljs-variable">fetch</span>: <span class="hljs-title class_">function</span> () {</li><li>    <span class="hljs-keyword">var</span> <span class="hljs-variable">that</span> = <span class="hljs-keyword">this</span>;</li><li>    <span class="hljs-variable">fetch</span>.<span class="hljs-title function_">fetch</span>({</li><li>      <span class="hljs-variable">url</span>: <span class="hljs-title class_">that</span>.<span class="hljs-title class_">url</span>,</li><li>      <span class="hljs-variable">success</span>: <span class="hljs-title class_">function</span>(<span class="hljs-title class_">response</span>) {</li><li>        <span class="hljs-variable">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"fetch success"</span>);</li><li>        <span class="hljs-variable">that</span>.<span class="hljs-variable">responseData</span> = <span class="hljs-variable">JSON</span>.<span class="hljs-title function_">stringify</span>(<span class="hljs-variable">response</span>);</li><li>      },</li><li>      <span class="hljs-variable">fail</span>: <span class="hljs-title class_">function</span>() {</li><li>        <span class="hljs-variable">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"fetch fail"</span>);</li><li>      }</li><li>    });</li><li>  }</li><li>}</li></ol></pre></div></div> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"> <p>  默认支持https，如果要支持http，需要在config.json里增加network标签，属性标识 "cleartextTraffic":  true。即：</p>  <div _ngcontent-osy-c106="" class="highlight-div"><div _ngcontent-osy-c106="" class="highlight-div-header"><div _ngcontent-osy-c106="" class="highlight-div-header-left"><div _ngcontent-osy-c106="" class="handle-button expand-button"><div _ngcontent-osy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-osy-c106="" class="highlight-div-header-right"><div _ngcontent-osy-c106="" class="handle-button ai-button"></div><div _ngcontent-osy-c106="" class="handle-button line-button"><div _ngcontent-osy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-osy-c106="" class="handle-button theme-button"><div _ngcontent-osy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-osy-c106="" class="handle-button copy-button"><div _ngcontent-osy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-osy-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" data-highlighted="yes"><ol class="linenums"><li>{</li><li>  <span class="hljs-string">"deviceConfig"</span>: {</li><li>    <span class="hljs-string">"default"</span>: {</li><li>      <span class="hljs-string">"network"</span>: {</li><li>        <span class="hljs-string">"cleartextTraffic"</span>: <span class="hljs-keyword">true</span></li><li>      }</li><li>      ... <span class="hljs-comment">// 用户的其它配置信息</span></li><li>    }</li><li>  }</li><li>  ... <span class="hljs-comment">// 用户的其它配置信息</span></li><li>}</li></ol></pre></div></div>  </div></div></div> </div> </div> <div></div></div>