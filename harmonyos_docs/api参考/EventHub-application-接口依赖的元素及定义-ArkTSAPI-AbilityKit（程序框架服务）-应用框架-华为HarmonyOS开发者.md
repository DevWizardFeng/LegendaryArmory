<h1 _ngcontent-seq-c119="" class="doc-title ng-star-inserted" title="EventHub"> EventHub </h1>

<div _ngcontent-seq-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p>EventHub是系统提供的基于发布-订阅模式实现的事件通信机制。通过事件名，实现了发送方和订阅方之间的解耦，支持不同业务模块间的高效数据传递和状态同步。</p>    <p>主要用于<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/uiability-data-sync-with-ui" target="_blank">UIAbility组件与UI的数据通信</a>。</p>    <p>不同的Context对象拥有不同的EventHub对象，不同EventHub对象之间无法直接通信。事件的订阅、取消订阅、触发都作用在某一个具体的EventHub对象上。</p>    <p>由于Worker、Taskpool通过Actor模型实现<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/multi-thread-concurrency-overview#多线程并发模型" target="_blank">多线程并发</a>，不同虚拟机实例之间拥有独占的内存，因此EventHub对象不能用于线程间的数据通信。</p>    <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">      <ul>       <li>本模块首批接口从API version 9开始支持。后续版本的新增接口，采用上角标单独标记接口的起始版本。</li>       <li>本模块接口仅可在Stage模型下使用。</li>      </ul>     </div></div></div>    <div class="tiledSection">     <h2 id="约束限制" device-type="phone,2in1,tablet,wearable,tv">约束限制<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="约束限制" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><ul>      <li>不支持在进程间通过Eventhub对象进行数据通信。</li>      <li>不支持在Worker、TaskPool线程间通过EventHub对象进行数据通信。如需进行跨线程通信，参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/itc-with-emitter" target="_blank">使用Emitter进行线程间通信</a>。</li>      <li>不支持同一线程内不同Context对象的EventHub对象间进行数据通信。</li>      <li>通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-sendablecontextmanager">sendableContextManager</a>转换后的Context对象与原先的Context对象属于不同Context对象，不支持其EventHub对象间的数据通信。</li>     </ul>    </div>    <div class="tiledSection">     <h2 id="导入模块" device-type="phone,2in1,tablet,wearable,tv">导入模块<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="导入模块" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><div _ngcontent-seq-c106="" class="highlight-div"><div _ngcontent-seq-c106="" class="highlight-div-header"><div _ngcontent-seq-c106="" class="highlight-div-header-left"><div _ngcontent-seq-c106="" class="handle-button expand-button"><div _ngcontent-seq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-seq-c106="" class="highlight-div-header-right"><div _ngcontent-seq-c106="" class="handle-button ai-button"></div><div _ngcontent-seq-c106="" class="handle-button line-button"><div _ngcontent-seq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-seq-c106="" class="handle-button theme-button"><div _ngcontent-seq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-seq-c106="" class="handle-button copy-button"><div _ngcontent-seq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-seq-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="使用说明" device-type="phone,2in1,tablet,wearable,tv">使用说明<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="使用说明" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>开发者需要通过Context对象获取EventHub。以下示例通过UIAbility实例的Context对象获取其EventHub对象。</p>     <div _ngcontent-seq-c106="" class="highlight-div"><div _ngcontent-seq-c106="" class="highlight-div-header"><div _ngcontent-seq-c106="" class="highlight-div-header-left"><div _ngcontent-seq-c106="" class="handle-button expand-button"><div _ngcontent-seq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-seq-c106="" class="highlight-div-header-right"><div _ngcontent-seq-c106="" class="handle-button ai-button"></div><div _ngcontent-seq-c106="" class="handle-button line-button"><div _ngcontent-seq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-seq-c106="" class="handle-button theme-button"><div _ngcontent-seq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-seq-c106="" class="handle-button copy-button"><div _ngcontent-seq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-seq-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { common, <span class="hljs-title class_">UIAbility</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">eventFunc</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'eventFunc is called'</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">onCreate</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-comment">// 调用方式一（推荐）</span></li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-property">eventHub</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">'myEvent'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">eventFunc</span>);</li><li>
</li><li>    <span class="hljs-comment">// 调用方式二</span></li><li>    <span class="hljs-keyword">let</span> eventhub = <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-property">eventHub</span> <span class="hljs-keyword">as</span> common.<span class="hljs-property">EventHub</span>;</li><li>    eventhub.<span class="hljs-title function_">on</span>(<span class="hljs-string">'myEvent'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">eventFunc</span>);</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="eventhubon" device-type="phone,2in1,tablet,wearable,tv">EventHub.on<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="eventhubon" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>on(event: string, callback: Function): void;</p>     <p>订阅指定事件。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>callback被emit触发时，调用方是EventHub对象，如果要修改callback中this的指向，可以使用箭头函数。</p>      </div></div></div>     <p><strong>元服务API</strong>：从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.9.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.9.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.9.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.9.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">event</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">事件名称。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Function</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">事件回调，事件触发后调用。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.9.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.9.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1. Mandatory parameters are left unspecified; 2. Incorrect parameter types; 3. Parameter verification failed.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例1：</strong></p>     <p>callback被emit触发时，调用方是EventHub对象。EventHub对象没有value属性，因此结果是undefined。</p>     <div _ngcontent-seq-c106="" class="highlight-div"><div _ngcontent-seq-c106="" class="highlight-div-header"><div _ngcontent-seq-c106="" class="highlight-div-header-left"><div _ngcontent-seq-c106="" class="handle-button expand-button"><div _ngcontent-seq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-seq-c106="" class="highlight-div-header-right"><div _ngcontent-seq-c106="" class="handle-button ai-button"></div><div _ngcontent-seq-c106="" class="handle-button line-button"><div _ngcontent-seq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-seq-c106="" class="handle-button theme-button"><div _ngcontent-seq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-seq-c106="" class="handle-button copy-button"><div _ngcontent-seq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-seq-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-attr">value</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">12</span>;</li><li>
</li><li>  <span class="hljs-title function_">onCreate</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-property">eventHub</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">'myEvent'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">eventFunc</span>);</li><li>    } <span class="hljs-keyword">catch</span> (e) {</li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">code</span>: <span class="hljs-built_in">number</span> = (e <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span>;</li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">msg</span>: <span class="hljs-built_in">string</span> = (e <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>;</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`EventHub emit error, code: <span class="hljs-subst">${code}</span>, msg: <span class="hljs-subst">${msg}</span>`</span>);</li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">onForeground</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-comment">// 结果：</span></li><li>      <span class="hljs-comment">// eventFunc is called, value: undefined</span></li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-property">eventHub</span>.<span class="hljs-title function_">emit</span>(<span class="hljs-string">'myEvent'</span>);</li><li>    } <span class="hljs-keyword">catch</span> (e) {</li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">code</span>: <span class="hljs-built_in">number</span> = (e <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span>;</li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">msg</span>: <span class="hljs-built_in">string</span> = (e <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>;</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`EventHub emit error, code: <span class="hljs-subst">${code}</span>, msg: <span class="hljs-subst">${msg}</span>`</span>);</li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">eventFunc</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`eventFunc is called, value: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.value}</span>`</span>);</li><li>  }</li><li>}</li></ol></pre></div></div>     <p><strong>示例2：</strong></p>     <p>callback使用箭头函数时，调用方是EntryAbility对象。EntryAbility对象里存在value属性，因此结果是12。</p>     <div _ngcontent-seq-c106="" class="highlight-div"><div _ngcontent-seq-c106="" class="highlight-div-header"><div _ngcontent-seq-c106="" class="highlight-div-header-left"><div _ngcontent-seq-c106="" class="handle-button expand-button"><div _ngcontent-seq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-seq-c106="" class="highlight-div-header-right"><div _ngcontent-seq-c106="" class="handle-button ai-button"></div><div _ngcontent-seq-c106="" class="handle-button line-button"><div _ngcontent-seq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-seq-c106="" class="handle-button theme-button"><div _ngcontent-seq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-seq-c106="" class="handle-button copy-button"><div _ngcontent-seq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-seq-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-attr">value</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">12</span>;</li><li>
</li><li>  <span class="hljs-title function_">onCreate</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-comment">// 支持使用匿名函数订阅事件</span></li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-property">eventHub</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">'myEvent'</span>, <span class="hljs-function">() =&gt;</span> {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`anonymous eventFunc is called, value: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.value}</span>`</span>);</li><li>      });</li><li>    } <span class="hljs-keyword">catch</span> (e) {</li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">code</span>: <span class="hljs-built_in">number</span> = (e <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span>;</li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">msg</span>: <span class="hljs-built_in">string</span> = (e <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>;</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`EventHub emit error, code: <span class="hljs-subst">${code}</span>, msg: <span class="hljs-subst">${msg}</span>`</span>);</li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">onForeground</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-comment">// 结果：</span></li><li>      <span class="hljs-comment">// anonymous eventFunc is called, value: 12</span></li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-property">eventHub</span>.<span class="hljs-title function_">emit</span>(<span class="hljs-string">'myEvent'</span>);</li><li>    } <span class="hljs-keyword">catch</span> (e) {</li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">code</span>: <span class="hljs-built_in">number</span> = (e <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span>;</li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">msg</span>: <span class="hljs-built_in">string</span> = (e <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>;</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`EventHub emit error, code: <span class="hljs-subst">${code}</span>, msg: <span class="hljs-subst">${msg}</span>`</span>);</li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">eventFunc</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`eventFunc is called, value: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.value}</span>`</span>);</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="eventhuboff" device-type="phone,2in1,tablet,wearable,tv">EventHub.off<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="eventhuboff" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>off(event: string, callback?: Function): void;</p>     <p>取消订阅指定事件。</p>     <ul>      <li>传入callback：取消指定的callback对指定事件的订阅，当该事件触发后，将不会回调该callback。</li>      <li>不传callback：取消所有callback对指定事件的订阅。</li>     </ul>     <p><strong>元服务API</strong>：从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.10.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.10.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.10.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.10.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">event</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">事件名称。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">Function</td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">事件回调。如果不传callback，则取消订阅该事件下所有callback。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.10.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.10.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1. Mandatory parameters are left unspecified; 2. Incorrect parameter types; 3. Parameter verification failed.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-seq-c106="" class="highlight-div"><div _ngcontent-seq-c106="" class="highlight-div-header"><div _ngcontent-seq-c106="" class="highlight-div-header-left"><div _ngcontent-seq-c106="" class="handle-button expand-button"><div _ngcontent-seq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-seq-c106="" class="highlight-div-header-right"><div _ngcontent-seq-c106="" class="handle-button ai-button"></div><div _ngcontent-seq-c106="" class="handle-button line-button"><div _ngcontent-seq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-seq-c106="" class="handle-button theme-button"><div _ngcontent-seq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-seq-c106="" class="handle-button copy-button"><div _ngcontent-seq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-seq-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onCreate</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-property">eventHub</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">'myEvent'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">eventFunc1</span>);</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-property">eventHub</span>.<span class="hljs-title function_">off</span>(<span class="hljs-string">'myEvent'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">eventFunc1</span>); <span class="hljs-comment">// 取消eventFunc1对myEvent事件的订阅</span></li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-property">eventHub</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">'myEvent'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">eventFunc1</span>);</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-property">eventHub</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">'myEvent'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">eventFunc2</span>);</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-property">eventHub</span>.<span class="hljs-title function_">off</span>(<span class="hljs-string">'myEvent'</span>); <span class="hljs-comment">// 取消eventFunc1和eventFunc2对myEvent事件的订阅</span></li><li>    } <span class="hljs-keyword">catch</span> (e) {</li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">code</span>: <span class="hljs-built_in">number</span> = (e <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span>;</li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">msg</span>: <span class="hljs-built_in">string</span> = (e <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>;</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`EventHub emit error, code: <span class="hljs-subst">${code}</span>, msg: <span class="hljs-subst">${msg}</span>`</span>);</li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">eventFunc1</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'eventFunc1 is called'</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">eventFunc2</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'eventFunc2 is called'</span>);</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="eventhubemit" device-type="phone,2in1,tablet,wearable,tv">EventHub.emit<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="eventhubemit" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>emit(event: string, ...args: Object[]): void;</p>     <p>触发指定事件。</p>     <p><strong>元服务API</strong>：从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.11.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.11.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.11.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.11.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">event</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">事件名称。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">...args</td>         <td class="cellrowborder" width="25%">Object[]</td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">可变参数，事件触发时，传递给回调函数的参数。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.11.10.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.11.10.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1. Mandatory parameters are left unspecified; 2. Incorrect parameter types; 3. Parameter verification failed.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-seq-c106="" class="highlight-div"><div _ngcontent-seq-c106="" class="highlight-div-header"><div _ngcontent-seq-c106="" class="highlight-div-header-left"><div _ngcontent-seq-c106="" class="handle-button expand-button"><div _ngcontent-seq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-seq-c106="" class="highlight-div-header-right"><div _ngcontent-seq-c106="" class="handle-button ai-button"></div><div _ngcontent-seq-c106="" class="handle-button line-button"><div _ngcontent-seq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-seq-c106="" class="handle-button theme-button"><div _ngcontent-seq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-seq-c106="" class="handle-button copy-button"><div _ngcontent-seq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-seq-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onCreate</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-property">eventHub</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">'myEvent'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">eventFunc</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">onDestroy</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-comment">// 结果：</span></li><li>      <span class="hljs-comment">// eventFunc is called,undefined,undefined</span></li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-property">eventHub</span>.<span class="hljs-title function_">emit</span>(<span class="hljs-string">'myEvent'</span>);</li><li>      <span class="hljs-comment">// 结果：</span></li><li>      <span class="hljs-comment">// eventFunc is called,1,undefined</span></li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-property">eventHub</span>.<span class="hljs-title function_">emit</span>(<span class="hljs-string">'myEvent'</span>, <span class="hljs-number">1</span>);</li><li>      <span class="hljs-comment">// 结果：</span></li><li>      <span class="hljs-comment">// eventFunc is called,1,2</span></li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-property">eventHub</span>.<span class="hljs-title function_">emit</span>(<span class="hljs-string">'myEvent'</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>);</li><li>    } <span class="hljs-keyword">catch</span> (e) {</li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">code</span>: <span class="hljs-built_in">number</span> = (e <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span>;</li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">msg</span>: <span class="hljs-built_in">string</span> = (e <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>;</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`EventHub emit error, code: <span class="hljs-subst">${code}</span>, msg: <span class="hljs-subst">${msg}</span>`</span>);</li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">eventFunc</span>(<span class="hljs-params">argOne: <span class="hljs-built_in">number</span>, argTwo: <span class="hljs-built_in">number</span></span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`eventFunc is called, <span class="hljs-subst">${argOne}</span>, <span class="hljs-subst">${argTwo}</span>`</span>);</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>   </div>   <div></div></div>