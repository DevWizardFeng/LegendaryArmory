<h1 _ngcontent-lor-c119="" class="doc-title ng-star-inserted" title="GuardService（屏幕时间守护服务）"> GuardService（屏幕时间守护服务） </h1>

<div _ngcontent-lor-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div><p>本模块提供管控Screen Time Guard Kit对外开放能力，包括应用授权能力、使用时长管控、应用访问限制等功能。</p> <p><strong>模型约束：</strong>此接口仅可在Stage模型下使用。</p> <p><strong>系统能力：</strong>SystemCapability.ScreenTimeGuard.GuardService</p> <p><strong>起始版本：</strong>6.0.0(20)</p> <div class="tiledSection"><h2 id="section6355204817532" device-type="phone,tablet">导入模块<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section6355204817532" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">Tablet</span></div><div _ngcontent-lor-c106="" class="highlight-div"><div _ngcontent-lor-c106="" class="highlight-div-header"><div _ngcontent-lor-c106="" class="highlight-div-header-left"><div _ngcontent-lor-c106="" class="handle-button expand-button"><div _ngcontent-lor-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-lor-c106="" class="highlight-div-header-right"><div _ngcontent-lor-c106="" class="handle-button ai-button"></div><div _ngcontent-lor-c106="" class="handle-button line-button"><div _ngcontent-lor-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-lor-c106="" class="handle-button theme-button"><div _ngcontent-lor-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-lor-c106="" class="handle-button copy-button"><div _ngcontent-lor-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-lor-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { guardService } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ScreenTimeGuardKit'</span>;</li></ol></pre></div></div> </div> <div class="tiledSection"><h2 id="section7913052143518" device-type="phone,tablet">GuardServiceErrorCode<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section7913052143518" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">Tablet</span></div><p>该枚举定义了Screen Time Guard Kit屏幕时间守护服务错误码。</p> <p><strong>模型约束：</strong>此枚举仅可在Stage模型下使用。</p> <p><strong>系统能力：</strong>SystemCapability.ScreenTimeGuard.GuardService</p> <p><strong>起始版本：</strong>6.0.0(20)</p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.6.6.1.4.1.1" width="41.91%"><p><strong>名称</strong></p> </th> <th align="left" class="cellrowborder" id="mcps1.3.6.6.1.4.1.2" width="20.880000000000003%"><p><strong>值</strong></p> </th> <th align="left" class="cellrowborder" id="mcps1.3.6.6.1.4.1.3" width="37.21%"><p><strong>说明</strong></p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="41.91%"><p>INTERNAL_ERROR</p> </td> <td class="cellrowborder" width="20.880000000000003%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/screentimeguard-error-code#section146742215461">1019000001</a></p> </td> <td class="cellrowborder" width="37.21%"><p>内部错误。</p> </td> </tr> <tr><td class="cellrowborder" width="41.91%"><p>USER_NOT_AUTHORIZED</p> </td> <td class="cellrowborder" width="20.880000000000003%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/screentimeguard-error-code#section20689133216551">1019000002</a></p> </td> <td class="cellrowborder" width="37.21%"><p>用户未授权。</p> </td> </tr> <tr><td class="cellrowborder" width="41.91%"><p>USER_CANCELED</p> </td> <td class="cellrowborder" width="20.880000000000003%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/screentimeguard-error-code#section133431336165512">1019000003</a></p> </td> <td class="cellrowborder" width="37.21%"><p>用户取消。</p> </td> </tr> <tr><td class="cellrowborder" width="41.91%"><p>STRATEGIES_EXCEED_LIMIT</p> </td> <td class="cellrowborder" width="20.880000000000003%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/screentimeguard-error-code#section53113406554">1019000004</a></p> </td> <td class="cellrowborder" width="37.21%"><p>策略数量超限。</p> </td> </tr> <tr><td class="cellrowborder" width="41.91%"><p>STRATEGY_NAME_ALREADY_EXIST</p> </td> <td class="cellrowborder" width="20.880000000000003%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/screentimeguard-error-code#section166061643165510">1019000005</a></p> </td> <td class="cellrowborder" width="37.21%"><p>策略名称重复。</p> </td> </tr> <tr><td class="cellrowborder" width="41.91%"><p>NONEXISTENT_STRATEGY</p> </td> <td class="cellrowborder" width="20.880000000000003%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/screentimeguard-error-code#section15125164745520">1019000006</a></p> </td> <td class="cellrowborder" width="37.21%"><p>策略不存在。</p> </td> </tr> <tr><td class="cellrowborder" width="41.91%"><p>STRATEGY_ALREADY_EXECUTED</p> </td> <td class="cellrowborder" width="20.880000000000003%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/screentimeguard-error-code#section1826085035513">1019000007</a></p> </td> <td class="cellrowborder" width="37.21%"><p>策略重复执行。</p> </td> </tr> <tr><td class="cellrowborder" width="41.91%"><p>STRATEGY_NOT_STARTED</p> </td> <td class="cellrowborder" width="20.880000000000003%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/screentimeguard-error-code#section730515419559">1019000008</a></p> </td> <td class="cellrowborder" width="37.21%"><p>策略未执行。</p> </td> </tr>  </tbody></table></div> </div> </div> <div class="tiledSection"><h2 id="section24022538179" device-type="phone,tablet">requestUserAuth<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section24022538179" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">Tablet</span></div><p>requestUserAuth(context: common.UIAbilityContext): Promise&lt;void&gt;</p> <p>请求用户授权访问Screen Time Guard Kit的所有管控接口，使用Promise异步回调。</p> <p><strong>模型约束：</strong>此接口仅可在Stage模型下使用。</p> <p><strong>需要权限：</strong>ohos.permission.MANAGE_SCREEN_TIME_GUARD</p> <p><strong>系统能力：</strong>SystemCapability.ScreenTimeGuard.GuardService</p> <p><strong>设备行为差异：</strong>该接口在Phone、Tablet设备中可正常调用，在其他设备中返回801错误码。</p> <p><strong>起始版本：</strong>6.0.0(20)</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.7.10.1.5.1.1" width="10.67%"><p>参数名</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.7.10.1.5.1.2" width="27.52%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.7.10.1.5.1.3" width="9.64%"><p>必填</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.7.10.1.5.1.4" width="52.17%"><p>说明</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="10.67%"><p>context</p> </td> <td class="cellrowborder" width="27.52%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext" target="_blank">common.UIAbilityContext</a></p> </td> <td class="cellrowborder" width="9.64%"><p>是</p> </td> <td class="cellrowborder" width="52.17%"><p>UIAbility的上下文环境。</p> </td> </tr>  </tbody></table></div> </div> <div class="p"><strong>返回值：</strong> <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.7.11.2.1.3.1.1" width="28.050000000000004%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.7.11.2.1.3.1.2" width="71.95%"><p>说明</p> </th> </tr><tr><td class="cellrowborder" width="28.050000000000004%"><p>Promise&lt;void&gt;</p> </td> <td class="cellrowborder" width="71.95%"><p>Promise对象。无返回结果的Promise对象。</p> </td> </tr>  </tbody></table></div> </div> </div> <p><strong>错误码：</strong></p> <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/screentimeguard-error-code">ArkTS API错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal" target="_blank">通用错误码</a>。</p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.7.14.1.3.1.1" width="24.279999999999998%"><p>错误码ID</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.7.14.1.3.1.2" width="75.72%"><p>错误信息</p> </th> </tr><tr><td class="cellrowborder" width="24.279999999999998%"><p>201</p> </td> <td class="cellrowborder" width="75.72%"><p>Permission verification failed. The application does not have the permission required to call the API.</p> </td> </tr> <tr><td class="cellrowborder" width="24.279999999999998%"><p>401</p> </td> <td class="cellrowborder" width="75.72%"><p>Parameter error. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types. 3.Parameter verification failed.</p> </td> </tr> <tr><td class="cellrowborder" width="24.279999999999998%"><p>801</p> </td> <td class="cellrowborder" width="75.72%"><p>Capability not supported. function requestUserAuth can not work correctly due to limited device capabilities.</p> </td> </tr> <tr><td class="cellrowborder" width="24.279999999999998%"><p>1019000001</p> </td> <td class="cellrowborder" width="75.72%"><p>Internal error.</p> </td> </tr> <tr><td class="cellrowborder" width="24.279999999999998%"><p>1019000002</p> </td> <td class="cellrowborder" width="75.72%"><p>The user has not authorized the application to access this interface.</p> </td> </tr>  </tbody></table></div> </div> <p><strong>示例：</strong></p> <div _ngcontent-lor-c106="" class="highlight-div"><div _ngcontent-lor-c106="" class="highlight-div-header"><div _ngcontent-lor-c106="" class="highlight-div-header-left"><div _ngcontent-lor-c106="" class="handle-button expand-button"><div _ngcontent-lor-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-lor-c106="" class="highlight-div-header-right"><div _ngcontent-lor-c106="" class="handle-button ai-button"></div><div _ngcontent-lor-c106="" class="handle-button line-button"><div _ngcontent-lor-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-lor-c106="" class="handle-button theme-button"><div _ngcontent-lor-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-lor-c106="" class="handle-button copy-button"><div _ngcontent-lor-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-lor-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { guardService } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ScreenTimeGuardKit'</span>;</li><li>
</li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">TestPage</span> {</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>      <span class="hljs-title class_">Column</span>() {</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">"TestRequestUserAuth"</span>)</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-keyword">async</span> () =&gt; {</li><li>            <span class="hljs-keyword">try</span> {</li><li>              <span class="hljs-keyword">await</span> guardService.<span class="hljs-title function_">requestUserAuth</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>);</li><li>              <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'requestUserAuth invoke success'</span>);</li><li>            } <span class="hljs-keyword">catch</span> (e) {</li><li>              <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'requestUserAuth invoke failure. code: '</span> + e.<span class="hljs-property">code</span> + <span class="hljs-string">' message: '</span> + e.<span class="hljs-property">message</span>);</li><li>            }</li><li>        })</li><li>      }</li><li>  }</li><li>}</li></ol></pre></div></div> </div> <div class="tiledSection"><h2 id="section10875605199" device-type="phone,tablet">revokeUserAuth<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section10875605199" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">Tablet</span></div><p>revokeUserAuth(): Promise&lt;void&gt;</p> <p>取消用户授权访问Screen Time Guard Kit的相关管控接口，使用Promise异步回调。</p> <p><strong>模型约束：</strong>此接口仅可在Stage模型下使用。</p> <p><strong>需要权限：</strong>ohos.permission.MANAGE_SCREEN_TIME_GUARD</p> <p><strong>系统能力：</strong>SystemCapability.ScreenTimeGuard.GuardService</p> <p><strong>设备行为差异：</strong>该接口在Phone、Tablet设备中可正常调用，在其他设备中返回801错误码。</p> <p><strong>起始版本：</strong>6.0.0(20)</p> <div class="p"><strong>返回值：</strong> <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.8.9.2.1.3.1.1" width="28.050000000000004%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.8.9.2.1.3.1.2" width="71.95%"><p>说明</p> </th> </tr><tr><td class="cellrowborder" width="28.050000000000004%"><p>Promise&lt;void&gt;</p> </td> <td class="cellrowborder" width="71.95%"><p>Promise对象。无返回结果的Promise对象。</p> </td> </tr>  </tbody></table></div> </div> </div> <p><strong>错误码：</strong></p> <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/screentimeguard-error-code">ArkTS API错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal" target="_blank">通用错误码</a>。</p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.8.12.1.3.1.1" width="24.279999999999998%"><p>错误码ID</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.8.12.1.3.1.2" width="75.72%"><p>错误信息</p> </th> </tr><tr><td class="cellrowborder" width="24.279999999999998%"><p>201</p> </td> <td class="cellrowborder" width="75.72%"><p>Permission verification failed. The application does not have the permission required to call the API.</p> </td> </tr> <tr><td class="cellrowborder" width="24.279999999999998%"><p>801</p> </td> <td class="cellrowborder" width="75.72%"><p>Capability not supported. function revokeUserAuth can not work correctly due to limited device capabilities.</p> </td> </tr> <tr><td class="cellrowborder" width="24.279999999999998%"><p>1019000001</p> </td> <td class="cellrowborder" width="75.72%"><p>Internal error.</p> </td> </tr>  </tbody></table></div> </div> <p><strong>示例：</strong></p> <div _ngcontent-lor-c106="" class="highlight-div"><div _ngcontent-lor-c106="" class="highlight-div-header"><div _ngcontent-lor-c106="" class="highlight-div-header-left"><div _ngcontent-lor-c106="" class="handle-button expand-button"><div _ngcontent-lor-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-lor-c106="" class="highlight-div-header-right"><div _ngcontent-lor-c106="" class="handle-button ai-button"></div><div _ngcontent-lor-c106="" class="handle-button line-button"><div _ngcontent-lor-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-lor-c106="" class="handle-button theme-button"><div _ngcontent-lor-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-lor-c106="" class="handle-button copy-button"><div _ngcontent-lor-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-lor-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { guardService } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ScreenTimeGuardKit'</span>;</li><li>
</li><li><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">testUserAuth</span>(<span class="hljs-params"></span>) {</li><li>  <span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">await</span> guardService.<span class="hljs-title function_">revokeUserAuth</span>();</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'revokeUserAuth invoke success.'</span>);</li><li>  } <span class="hljs-keyword">catch</span> (e) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'revokeUserAuth invoke failure. code: '</span> + e.<span class="hljs-property">code</span> + <span class="hljs-string">' message: '</span> + e.<span class="hljs-property">message</span>);</li><li>  }</li><li>}</li></ol></pre></div></div> </div> <div class="tiledSection"><h2 id="section12377142072717" device-type="phone,tablet">getUserAuthStatus<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section12377142072717" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">Tablet</span></div><p>getUserAuthStatus(): Promise&lt;AuthStatus&gt;</p> <p>获取用户授权状态，使用Promise异步回调。</p> <p><strong>模型约束：</strong>此接口仅可在Stage模型下使用。</p> <p><strong>需要权限：</strong>ohos.permission.MANAGE_SCREEN_TIME_GUARD</p> <p><strong>系统能力：</strong>SystemCapability.ScreenTimeGuard.GuardService</p> <p><strong>设备行为差异：</strong>该接口在Phone、Tablet设备中可正常调用，在其他设备中返回801错误码。</p> <p><strong>起始版本：</strong>6.0.0(20)</p> <div class="p"><strong>返回值：</strong> <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.9.9.2.1.3.1.1" width="28.050000000000004%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.9.9.2.1.3.1.2" width="71.95%"><p>说明</p> </th> </tr><tr><td class="cellrowborder" width="28.050000000000004%"><p>Promise&lt;<a href="/consumer/cn/doc/harmonyos-references/screentimeguard-guardservice#section92636497495">AuthStatus</a>&gt;</p> </td> <td class="cellrowborder" width="71.95%"><p>Promise对象，初始未申请授权时的状态为AUTH_INIT，用户同意授权时为AUTH_GRANTED，用户拒绝授权时为AUTH_DENIED。</p> </td> </tr>  </tbody></table></div> </div> </div> <p><strong>错误码：</strong></p> <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/screentimeguard-error-code">ArkTS API错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal" target="_blank">通用错误码</a>。</p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.9.12.1.3.1.1" width="24.279999999999998%"><p>错误码ID</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.9.12.1.3.1.2" width="75.72%"><p>错误信息</p> </th> </tr><tr><td class="cellrowborder" width="24.279999999999998%"><p>201</p> </td> <td class="cellrowborder" width="75.72%"><p>Permission verification failed. The application does not have the permission required to call the API.</p> </td> </tr> <tr><td class="cellrowborder" width="24.279999999999998%"><p>801</p> </td> <td class="cellrowborder" width="75.72%"><p>Capability not supported. function getUserAuthStatus can not work correctly due to limited device capabilities.</p> </td> </tr> <tr><td class="cellrowborder" width="24.279999999999998%"><p>1019000001</p> </td> <td class="cellrowborder" width="75.72%"><p>Internal error.</p> </td> </tr>  </tbody></table></div> </div> <p><strong>示例：</strong></p> <div _ngcontent-lor-c106="" class="highlight-div"><div _ngcontent-lor-c106="" class="highlight-div-header"><div _ngcontent-lor-c106="" class="highlight-div-header-left"><div _ngcontent-lor-c106="" class="handle-button expand-button"><div _ngcontent-lor-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-lor-c106="" class="highlight-div-header-right"><div _ngcontent-lor-c106="" class="handle-button ai-button"></div><div _ngcontent-lor-c106="" class="handle-button line-button"><div _ngcontent-lor-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-lor-c106="" class="handle-button theme-button"><div _ngcontent-lor-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-lor-c106="" class="handle-button copy-button"><div _ngcontent-lor-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-lor-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { guardService } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ScreenTimeGuardKit'</span>;</li><li><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">testUserAuth</span>(<span class="hljs-params"></span>) {</li><li>  <span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">const</span> status = <span class="hljs-keyword">await</span> guardService.<span class="hljs-title function_">getUserAuthStatus</span>();</li><li>    <span class="hljs-keyword">const</span> statusToMsg = [<span class="hljs-string">'AUTH_INIT'</span>, <span class="hljs-string">'AUTH_GRANTED'</span>, <span class="hljs-string">'AUTH_DENIED'</span>];</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'getUserAuthStatus invoke success. '</span> + statusToMsg[status + <span class="hljs-number">1</span>]);</li><li>  } <span class="hljs-keyword">catch</span> (e) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'getUserAuthStatus invoke failure. code: '</span> + e.<span class="hljs-property">code</span> + <span class="hljs-string">' message: '</span> + e.<span class="hljs-property">message</span>);</li><li>  }</li><li>}</li></ol></pre></div></div> </div> <div class="tiledSection"><h2 id="section92636497495" device-type="phone,tablet">AuthStatus<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section92636497495" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">Tablet</span></div><p>用户授权状态类型的枚举。</p> <p><strong>模型约束：</strong>此枚举仅可在Stage模型下使用。</p> <p><strong>系统能力：</strong>SystemCapability.ScreenTimeGuard.GuardService</p> <p><strong>起始版本：</strong>6.0.0(20)</p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.10.6.1.4.1.1" width="33.33333333333333%"><p>名称</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.10.6.1.4.1.2" width="33.33333333333333%"><p>值</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.10.6.1.4.1.3" width="33.33333333333333%"><p>说明</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="33.33333333333333%"><p>AUTH_INIT</p> </td> <td class="cellrowborder" width="33.33333333333333%"><p>-1</p> </td> <td class="cellrowborder" width="33.33333333333333%"><p>初始状态</p> </td> </tr> <tr><td class="cellrowborder" width="33.33333333333333%"><p>AUTH_GRANTED</p> </td> <td class="cellrowborder" width="33.33333333333333%"><p>0</p> </td> <td class="cellrowborder" width="33.33333333333333%"><p>用户已授权</p> </td> </tr> <tr><td class="cellrowborder" width="33.33333333333333%"><p>AUTH_DENIED</p> </td> <td class="cellrowborder" width="33.33333333333333%"><p>1</p> </td> <td class="cellrowborder" width="33.33333333333333%"><p>用户已拒绝</p> </td> </tr>  </tbody></table></div> </div> </div> <div class="tiledSection"><h2 id="section76401996131" device-type="phone,tablet">AppInfo<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section76401996131" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">Tablet</span></div><p>该接口为应用token信息。</p> <p><strong>模型约束：</strong>此接口仅可在Stage模型下使用。</p> <p><strong>系统能力：</strong>SystemCapability.ScreenTimeGuard.GuardService</p> <p><strong>起始版本：</strong>6.0.0(20)</p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.11.6.1.6.1.1" width="20.09%"><p><strong>名称</strong></p> </th> <th align="left" class="cellrowborder" id="mcps1.3.11.6.1.6.1.2" width="13.63%"><p><strong>类型</strong></p> </th> <th align="left" class="cellrowborder" id="mcps1.3.11.6.1.6.1.3" width="7.5200000000000005%"><p>只读</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.11.6.1.6.1.4" width="20.72%"><p>可选</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.11.6.1.6.1.5" width="38.04%"><p><strong>说明</strong></p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="20.09%"><p>appTokens</p> </td> <td class="cellrowborder" width="13.63%"><p>string[]</p> </td> <td class="cellrowborder" width="7.5200000000000005%"><p>否</p> </td> <td class="cellrowborder" width="20.72%"><p>否</p> </td> <td class="cellrowborder" width="38.04%"><p>应用token数组。</p> <p>数组数量上限：100。</p> <div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content"><ol><li>token数组中存在错误的tokens，若只是部分错误，则取其中正常的tokens做显示和应用。</li><li>该数组可以为空数组，即用户不设置任何应用在禁止/允许清单中，是正常场景。</li></ol> </div></div></div> </td> </tr>  </tbody></table></div> </div> </div> <div class="tiledSection"><h2 id="section26135455267" device-type="phone,tablet">addGuardStrategy<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section26135455267" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">Tablet</span></div><p>addGuardStrategy(guardStrategy: GuardStrategy): Promise&lt;void&gt;</p> <p>添加屏幕时间管控策略，使用Promise异步回调。</p> <p><strong>模型约束：</strong>此接口仅可在Stage模型下使用。</p> <p><strong>需要权限：</strong>ohos.permission.MANAGE_SCREEN_TIME_GUARD</p> <p><strong>系统能力：</strong>SystemCapability.ScreenTimeGuard.GuardService</p> <p><strong>设备行为差异：</strong>该接口在Phone、Tablet设备中可正常调用，在其他设备中返回801错误码。</p> <p><strong>起始版本：</strong>6.0.0(20)</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.12.10.1.5.1.1" width="9.071525489435937%"><p>参数名</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.12.10.1.5.1.2" width="9.391354913742973%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.12.10.1.5.1.3" width="6.7842605156037985%"><p>必填</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.12.10.1.5.1.4" width="74.75285908121728%"><p>说明</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="9.071525489435937%"><p>guardStrategy</p> </td> <td class="cellrowborder" width="9.391354913742973%"><p><a href="/consumer/cn/doc/harmonyos-references/screentimeguard-guardservice#section188761911193713">GuardStrategy</a></p> </td> <td class="cellrowborder" width="6.7842605156037985%"><p>是</p> </td> <td class="cellrowborder" width="74.75285908121728%"><p>管控策略。</p> <div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content"><p>添加管控策略时策略数量的上限为50条。</p> </div></div></div> </td> </tr>  </tbody></table></div> </div> <div class="p"><strong>返回值：</strong> <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.12.11.2.1.3.1.1" width="9.91%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.12.11.2.1.3.1.2" width="90.09%"><p>说明</p> </th> </tr><tr><td class="cellrowborder" width="9.91%"><p>Promise&lt;void&gt;</p> </td> <td class="cellrowborder" width="90.09%"><p>Promise对象。无返回结果的Promise对象。</p> </td> </tr>  </tbody></table></div> </div> </div> <p><strong>错误码：</strong></p> <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/screentimeguard-error-code">ArkTS API错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal" target="_blank">通用错误码</a>。</p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.12.14.1.3.1.1" width="24.279999999999998%"><p>错误码ID</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.12.14.1.3.1.2" width="75.72%"><p>错误信息</p> </th> </tr><tr><td class="cellrowborder" width="24.279999999999998%"><p>201</p> </td> <td class="cellrowborder" width="75.72%"><p>Permission verification failed. The application does not have the permission required to call the API.</p> </td> </tr> <tr><td class="cellrowborder" width="24.279999999999998%"><p>401</p> </td> <td class="cellrowborder" width="75.72%"><p>Parameter error. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types. 3.Parameter verification failed.</p> </td> </tr> <tr><td class="cellrowborder" width="24.279999999999998%"><p>801</p> </td> <td class="cellrowborder" width="75.72%"><p>Capability not supported. function addGuardStrategy can not work correctly due to limited device capabilities.</p> </td> </tr> <tr><td class="cellrowborder" width="24.279999999999998%"><p>1019000001</p> </td> <td class="cellrowborder" width="75.72%"><p>Internal error.</p> </td> </tr> <tr><td class="cellrowborder" width="24.279999999999998%"><p>1019000002</p> </td> <td class="cellrowborder" width="75.72%"><p>The user has not authorized the application to access this interface.</p> </td> </tr> <tr><td class="cellrowborder" width="24.279999999999998%"><p>1019000004</p> </td> <td class="cellrowborder" width="75.72%"><p>The number of strategies exceeds the upper limit.</p> </td> </tr> <tr><td class="cellrowborder" width="24.279999999999998%"><p>1019000005</p> </td> <td class="cellrowborder" width="75.72%"><p>The strategy name is already existed.</p> </td> </tr>  </tbody></table></div> </div> <p><strong>示例：</strong></p> <div _ngcontent-lor-c106="" class="highlight-div"><div _ngcontent-lor-c106="" class="highlight-div-header"><div _ngcontent-lor-c106="" class="highlight-div-header-left"><div _ngcontent-lor-c106="" class="handle-button expand-button"><div _ngcontent-lor-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-lor-c106="" class="highlight-div-header-right"><div _ngcontent-lor-c106="" class="handle-button ai-button"></div><div _ngcontent-lor-c106="" class="handle-button line-button"><div _ngcontent-lor-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-lor-c106="" class="handle-button theme-button"><div _ngcontent-lor-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-lor-c106="" class="handle-button copy-button"><div _ngcontent-lor-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-lor-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-variable">guardService</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ScreenTimeGuardKit'</span>;</li><li>
</li><li><span class="hljs-variable">async</span> <span class="hljs-variable">function</span> <span class="hljs-title function_">testGuardService</span>() {</li><li>  <span class="hljs-keyword">const</span> <span class="hljs-variable">time</span>: <span class="hljs-title class_">guardService</span>.<span class="hljs-title class_">TimeStrategy</span> = {</li><li>    <span class="hljs-keyword">type</span>: <span class="hljs-title class_">guardService</span>.<span class="hljs-title class_">TimeStrategyType</span>.<span class="hljs-title class_">START_END_TIME_TYPE</span>,</li><li>    <span class="hljs-variable">startTime</span>: <span class="hljs-string">"08:00"</span>,</li><li>    <span class="hljs-variable">endTime</span>: <span class="hljs-string">"19:00"</span>,</li><li>    <span class="hljs-variable">repeat</span>: [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>]</li><li>  }</li><li>  <span class="hljs-keyword">const</span> <span class="hljs-variable">info</span>: <span class="hljs-title class_">guardService</span>.<span class="hljs-title class_">AppInfo</span> = {</li><li>    <span class="hljs-variable">appTokens</span>: []</li><li>  }</li><li>  <span class="hljs-keyword">const</span> <span class="hljs-variable">strategy</span>: <span class="hljs-title class_">guardService</span>.<span class="hljs-title class_">GuardStrategy</span> = {</li><li>    <span class="hljs-variable">name</span>: <span class="hljs-string">"TestStrategy"</span>,</li><li>    <span class="hljs-variable">timeStrategy</span>: <span class="hljs-title class_">time</span>,</li><li>    <span class="hljs-variable">appInfo</span>: <span class="hljs-title class_">info</span>,</li><li>    <span class="hljs-variable">appRestrictionType</span>: <span class="hljs-title class_">guardService</span>.<span class="hljs-title class_">RestrictionType</span>.<span class="hljs-title class_">BLOCKLIST_TYPE</span></li><li>  }</li><li>  <span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-variable">await</span> <span class="hljs-variable">guardService</span>.<span class="hljs-title function_">addGuardStrategy</span>(<span class="hljs-variable">strategy</span>);</li><li>  } <span class="hljs-keyword">catch</span> (<span class="hljs-variable">e</span>) {</li><li>    <span class="hljs-variable">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'addGuardStrategy invoke failure. code: '</span> + <span class="hljs-variable">e</span>.<span class="hljs-variable">code</span> + <span class="hljs-string">' message: '</span> + <span class="hljs-variable">e</span>.<span class="hljs-variable">message</span>);</li><li>  }</li><li>}</li></ol></pre></div></div> </div> <div class="tiledSection"><h2 id="section188761911193713" device-type="phone,tablet">GuardStrategy<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section188761911193713" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">Tablet</span></div><p>该接口为守护策略对象。</p> <p><strong>模型约束：</strong>此接口仅可在Stage模型下使用。</p> <p><strong>系统能力：</strong>SystemCapability.ScreenTimeGuard.GuardService</p> <p><strong>起始版本：</strong>6.0.0(20)</p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.13.6.1.6.1.1" width="10.63%"><p><strong>名称</strong></p> </th> <th align="left" class="cellrowborder" id="mcps1.3.13.6.1.6.1.2" width="8.94%"><p><strong>类型</strong></p> </th> <th align="left" class="cellrowborder" id="mcps1.3.13.6.1.6.1.3" width="7.5200000000000005%"><p>只读</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.13.6.1.6.1.4" width="6.2700000000000005%"><p>可选</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.13.6.1.6.1.5" width="66.64%"><p><strong>说明</strong></p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="10.63%"><p>name</p> </td> <td class="cellrowborder" width="8.94%"><p>string</p> </td> <td class="cellrowborder" width="7.5200000000000005%"><p>否</p> </td> <td class="cellrowborder" width="6.2700000000000005%"><p>否</p> </td> <td class="cellrowborder" width="66.64%"><p>策略名称。</p> <div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content"><p>长度不超过64字符，仅支持字母、数字和下划线。</p> </div></div></div> </td> </tr> <tr><td class="cellrowborder" width="10.63%"><p>timeStrategy</p> </td> <td class="cellrowborder" width="8.94%"><p><a href="/consumer/cn/doc/harmonyos-references/screentimeguard-guardservice#section7640121574612">TimeStrategy</a></p> </td> <td class="cellrowborder" width="7.5200000000000005%"><p>否</p> </td> <td class="cellrowborder" width="6.2700000000000005%"><p>否</p> </td> <td class="cellrowborder" width="66.64%"><p>时间策略。</p> </td> </tr> <tr><td class="cellrowborder" width="10.63%"><p>appInfo</p> </td> <td class="cellrowborder" width="8.94%"><p><a href="/consumer/cn/doc/harmonyos-references/screentimeguard-guardservice#section76401996131">AppInfo</a></p> </td> <td class="cellrowborder" width="7.5200000000000005%"><p>否</p> </td> <td class="cellrowborder" width="6.2700000000000005%"><p>否</p> </td> <td class="cellrowborder" width="66.64%"><p>应用信息。</p> </td> </tr> <tr><td class="cellrowborder" width="10.63%"><p>appRestrictionType</p> </td> <td class="cellrowborder" width="8.94%"><p><a href="/consumer/cn/doc/harmonyos-references/screentimeguard-guardservice#section119174813532">RestrictionType</a></p> </td> <td class="cellrowborder" width="7.5200000000000005%"><p>否</p> </td> <td class="cellrowborder" width="6.2700000000000005%"><p>否</p> </td> <td class="cellrowborder" width="66.64%"><p>限制类型。</p> </td> </tr>  </tbody></table></div> </div> </div> <div class="tiledSection"><h2 id="section7640121574612" device-type="phone,tablet">TimeStrategy<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section7640121574612" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">Tablet</span></div><p>该接口为时间策略对象。</p> <p><strong>模型约束：</strong>此接口仅可在Stage模型下使用。</p> <p><strong>系统能力：</strong>SystemCapability.ScreenTimeGuard.GuardService</p> <p><strong>起始版本：</strong>6.0.0(20)</p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.14.6.1.6.1.1" width="7.9799999999999995%"><p><strong>名称</strong></p> </th> <th align="left" class="cellrowborder" id="mcps1.3.14.6.1.6.1.2" width="9.36%"><p><strong>类型</strong></p> </th> <th align="left" class="cellrowborder" id="mcps1.3.14.6.1.6.1.3" width="7.829999999999999%"><p>只读</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.14.6.1.6.1.4" width="7.960000000000001%"><p>可选</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.14.6.1.6.1.5" width="66.86999999999999%"><p><strong>说明</strong></p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="7.9799999999999995%"><p>type</p> </td> <td class="cellrowborder" width="9.36%"><p><a href="/consumer/cn/doc/harmonyos-references/screentimeguard-guardservice#section133401616145119">TimeStrategyType</a></p> </td> <td class="cellrowborder" width="7.829999999999999%"><p>否</p> </td> <td class="cellrowborder" width="7.960000000000001%"><p>否</p> </td> <td class="cellrowborder" width="66.86999999999999%"><p>时间管控策略类型。</p> </td> </tr> <tr><td class="cellrowborder" width="7.9799999999999995%"><p>startTime</p> </td> <td class="cellrowborder" width="9.36%"><p>string</p> </td> <td class="cellrowborder" width="7.829999999999999%"><p>否</p> </td> <td class="cellrowborder" width="7.960000000000001%"><p>是</p> </td> <td class="cellrowborder" width="66.86999999999999%"><p>起始时间，以"HH:mm"的形式。参数范围："00:00"-"23:59"。</p> <div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content"><p>若TimeStrategyType为START_END_TIME_TYPE，则此参数必填。</p> </div></div></div> </td> </tr> <tr><td class="cellrowborder" width="7.9799999999999995%"><p>endTime</p> </td> <td class="cellrowborder" width="9.36%"><p>string</p> </td> <td class="cellrowborder" width="7.829999999999999%"><p>否</p> </td> <td class="cellrowborder" width="7.960000000000001%"><p>是</p> </td> <td class="cellrowborder" width="66.86999999999999%"><p>结束时间，以"HH:mm"的形式。参数范围："00:00"-"23:59"。</p> <div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content"><p>若TimeStrategyType为START_END_TIME_TYPE，则此参数必填。</p> </div></div></div> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p>1. 若结束时间小于起始时间，则代表的是次日。</p> <p>2. startTime与endTime的值不能相同。</p> </div></div></div> </td> </tr> <tr><td class="cellrowborder" width="7.9799999999999995%"><p>totalDuration</p> </td> <td class="cellrowborder" width="9.36%"><p>number</p> </td> <td class="cellrowborder" width="7.829999999999999%"><p>否</p> </td> <td class="cellrowborder" width="7.960000000000001%"><p>是</p> </td> <td class="cellrowborder" width="66.86999999999999%"><p>总时长，单位是分钟。参数范围：0-1440。</p> <div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content"><p>若TimeStrategyType为TOTAL_DURATION_TYPE，则此参数必填。</p> </div></div></div> </td> </tr> <tr><td class="cellrowborder" width="7.9799999999999995%"><p>repeat</p> </td> <td class="cellrowborder" width="9.36%"><p>number[]</p> </td> <td class="cellrowborder" width="7.829999999999999%"><p>否</p> </td> <td class="cellrowborder" width="7.960000000000001%"><p>是</p> </td> <td class="cellrowborder" width="66.86999999999999%"><p>重复执行时间，支持填写1~7，代表周一到周日。</p> <p>如果传入的是空数组则表示只执行一次。</p> <div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content"><p>TimeStrategyType为START_END_TIME_TYPE时此参数才生效。</p> </div></div></div> </td> </tr>  </tbody></table></div> </div> </div> <div class="tiledSection"><h2 id="section133401616145119" device-type="phone,tablet">TimeStrategyType<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section133401616145119" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">Tablet</span></div><p>时长策略类型的枚举。</p> <p><strong>模型约束：</strong>此枚举仅可在Stage模型下使用。</p> <p><strong>系统能力：</strong>SystemCapability.ScreenTimeGuard.GuardService</p> <p><strong>起始版本：</strong>6.0.0(20)</p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.15.6.1.4.1.1" width="15.185830429732869%"><p>名称</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.15.6.1.4.1.2" width="6.775067750677506%"><p>值</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.15.6.1.4.1.3" width="78.03910181958962%"><p>说明</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="15.185830429732869%"><p>START_END_TIME_TYPE</p> </td> <td class="cellrowborder" width="6.775067750677506%"><p>1</p> </td> <td class="cellrowborder" width="78.03910181958962%"><p>起始时间策略类型，表示策略在配置的起始时间和结束时间内生效。如果为此类型，则startTime、endTime必填，totalDuration非必填。</p> </td> </tr> <tr><td class="cellrowborder" width="15.185830429732869%"><p>TOTAL_DURATION_TYPE</p> </td> <td class="cellrowborder" width="6.775067750677506%"><p>2</p> </td> <td class="cellrowborder" width="78.03910181958962%"><p>总时长策略类型，表示策略生效的总时长，从调用<a href="/consumer/cn/doc/harmonyos-references/screentimeguard-guardservice#section18918313999">startGuardStrategy</a>接口成功后开始计时。如果为此类型，则startTime、endTime非必填，totalDuration必填。</p> </td> </tr>  </tbody></table></div> </div> </div> <div class="tiledSection"><h2 id="section119174813532" device-type="phone,tablet">RestrictionType<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section119174813532" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">Tablet</span></div><p>限制类型的枚举。</p> <p><strong>模型约束：</strong>此枚举仅可在Stage模型下使用。</p> <p><strong>系统能力：</strong>SystemCapability.ScreenTimeGuard.GuardService</p> <p><strong>起始版本：</strong>6.0.0(20)</p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.16.6.1.4.1.1" width="33.33333333333333%"><p>名称</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.16.6.1.4.1.2" width="33.33333333333333%"><p>值</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.16.6.1.4.1.3" width="33.33333333333333%"><p>说明</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="33.33333333333333%"><p>TRUSTLIST_TYPE</p> </td> <td class="cellrowborder" width="33.33333333333333%"><p>1</p> </td> <td class="cellrowborder" width="33.33333333333333%"><p>按允许清单做限制。</p> </td> </tr> <tr><td class="cellrowborder" width="33.33333333333333%"><p>BLOCKLIST_TYPE</p> </td> <td class="cellrowborder" width="33.33333333333333%"><p>2</p> </td> <td class="cellrowborder" width="33.33333333333333%"><p>按禁止清单做限制。</p> </td> </tr>  </tbody></table></div> </div> </div> <div class="tiledSection"><h2 id="section1863133395413" device-type="phone,tablet">updateGuardStrategy<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section1863133395413" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">Tablet</span></div><p>updateGuardStrategy(strategyName: string, guardStrategy: GuardStrategy): Promise&lt;void&gt;</p> <p>修改屏幕时间管控策略，使用Promise异步回调。</p> <p><strong>模型约束：</strong>此接口仅可在Stage模型下使用。</p> <p><strong>需要权限：</strong>ohos.permission.MANAGE_SCREEN_TIME_GUARD</p> <p><strong>系统能力：</strong>SystemCapability.ScreenTimeGuard.GuardService</p> <p><strong>设备行为差异：</strong>该接口在Phone、Tablet设备中可正常调用，在其他设备中返回801错误码。</p> <p><strong>起始版本：</strong>6.0.0(20)</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.17.10.1.5.1.1" width="9.139368094591974%"><p>参数名</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.17.10.1.5.1.2" width="9.09090909090909%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.17.10.1.5.1.3" width="6.7842605156037985%"><p>必填</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.17.10.1.5.1.4" width="74.98546229889513%"><p>说明</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="9.139368094591974%"><p>strategyName</p> </td> <td class="cellrowborder" width="9.09090909090909%"><p>string</p> </td> <td class="cellrowborder" width="6.7842605156037985%"><p>是</p> </td> <td class="cellrowborder" width="74.98546229889513%"><p>待更新的时间管控策略名称。</p> <div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content"><p>长度不超过64字符，仅支持字母、数字和下划线。</p> </div></div></div> </td> </tr> <tr><td class="cellrowborder" width="9.139368094591974%"><p>guardStrategy</p> </td> <td class="cellrowborder" width="9.09090909090909%"><p><a href="/consumer/cn/doc/harmonyos-references/screentimeguard-guardservice#section188761911193713">GuardStrategy</a></p> </td> <td class="cellrowborder" width="6.7842605156037985%"><p>是</p> </td> <td class="cellrowborder" width="74.98546229889513%"><p>新的时间管控策略。</p> <div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content"><p>如想修改策略名称，可以在guardStrategy的name属性中传入新名称。但不能是已存在的名称，如果名称已存在则返回401错误码。</p> </div></div></div> </td> </tr>  </tbody></table></div> </div> <div class="p"><strong>返回值：</strong> <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.17.11.2.1.3.1.1" width="28.050000000000004%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.17.11.2.1.3.1.2" width="71.95%"><p>说明</p> </th> </tr><tr><td class="cellrowborder" width="28.050000000000004%"><p>Promise&lt;void&gt;</p> </td> <td class="cellrowborder" width="71.95%"><p>Promise对象。无返回结果的Promise对象。</p> </td> </tr>  </tbody></table></div> </div> </div> <p><strong>错误码：</strong></p> <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/screentimeguard-error-code">ArkTS API错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal" target="_blank">通用错误码</a>。</p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.17.14.1.3.1.1" width="8.37%"><p>错误码ID</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.17.14.1.3.1.2" width="91.63%"><p>错误信息</p> </th> </tr><tr><td class="cellrowborder" width="8.37%"><p>201</p> </td> <td class="cellrowborder" width="91.63%"><p>Permission verification failed. The application does not have the permission required to call the API.</p> </td> </tr> <tr><td class="cellrowborder" width="8.37%"><p>401</p> </td> <td class="cellrowborder" width="91.63%"><p>Parameter error. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types. 3.Parameter verification failed.</p> </td> </tr> <tr><td class="cellrowborder" width="8.37%"><p>801</p> </td> <td class="cellrowborder" width="91.63%"><p>Capability not supported. function updateGuardStrategy can not work correctly due to limited device capabilities.</p> </td> </tr> <tr><td class="cellrowborder" width="8.37%"><p>1019000001</p> </td> <td class="cellrowborder" width="91.63%"><p>Internal error.</p> </td> </tr> <tr><td class="cellrowborder" width="8.37%"><p>1019000002</p> </td> <td class="cellrowborder" width="91.63%"><p>The user has not authorized the application to access this interface.</p> </td> </tr> <tr><td class="cellrowborder" width="8.37%"><p>1019000006</p> </td> <td class="cellrowborder" width="91.63%"><p>Nonexistent strategy.</p> </td> </tr>  </tbody></table></div> </div> <p><strong>示例：</strong></p> <div _ngcontent-lor-c106="" class="highlight-div"><div _ngcontent-lor-c106="" class="highlight-div-header"><div _ngcontent-lor-c106="" class="highlight-div-header-left"><div _ngcontent-lor-c106="" class="handle-button expand-button"><div _ngcontent-lor-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-lor-c106="" class="highlight-div-header-right"><div _ngcontent-lor-c106="" class="handle-button ai-button"></div><div _ngcontent-lor-c106="" class="handle-button line-button"><div _ngcontent-lor-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-lor-c106="" class="handle-button theme-button"><div _ngcontent-lor-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-lor-c106="" class="handle-button copy-button"><div _ngcontent-lor-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-lor-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-variable">guardService</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ScreenTimeGuardKit'</span>;</li><li>
</li><li><span class="hljs-variable">async</span> <span class="hljs-variable">function</span> <span class="hljs-title function_">testGuardService</span>() {</li><li>  <span class="hljs-keyword">const</span> <span class="hljs-variable">time</span>: <span class="hljs-title class_">guardService</span>.<span class="hljs-title class_">TimeStrategy</span> = {</li><li>    <span class="hljs-keyword">type</span>: <span class="hljs-title class_">guardService</span>.<span class="hljs-title class_">TimeStrategyType</span>.<span class="hljs-title class_">START_END_TIME_TYPE</span>,</li><li>    <span class="hljs-variable">startTime</span>: <span class="hljs-string">"08:00"</span>,</li><li>    <span class="hljs-variable">endTime</span>: <span class="hljs-string">"19:00"</span>,</li><li>    <span class="hljs-variable">repeat</span>: [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>]</li><li>  }</li><li>  <span class="hljs-keyword">const</span> <span class="hljs-variable">info</span>: <span class="hljs-title class_">guardService</span>.<span class="hljs-title class_">AppInfo</span> = {</li><li>    <span class="hljs-variable">appTokens</span>: []</li><li>  }</li><li>  <span class="hljs-keyword">const</span> <span class="hljs-variable">strategy</span>: <span class="hljs-title class_">guardService</span>.<span class="hljs-title class_">GuardStrategy</span> = {</li><li>    <span class="hljs-variable">name</span>: <span class="hljs-string">"TestStrategy"</span>,</li><li>    <span class="hljs-variable">timeStrategy</span>: <span class="hljs-title class_">time</span>,</li><li>    <span class="hljs-variable">appInfo</span>: <span class="hljs-title class_">info</span>,</li><li>    <span class="hljs-variable">appRestrictionType</span>: <span class="hljs-title class_">guardService</span>.<span class="hljs-title class_">RestrictionType</span>.<span class="hljs-title class_">BLOCKLIST_TYPE</span></li><li>  }</li><li>  <span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-variable">await</span> <span class="hljs-variable">guardService</span>.<span class="hljs-title function_">updateGuardStrategy</span>(<span class="hljs-string">"TestStrategyChanged"</span>, <span class="hljs-variable">strategy</span>);</li><li>  } <span class="hljs-keyword">catch</span> (<span class="hljs-variable">e</span>) {</li><li>    <span class="hljs-variable">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'updateGuardStrategy invoke failure. code: '</span> + <span class="hljs-variable">e</span>.<span class="hljs-variable">code</span> + <span class="hljs-string">' message: '</span> + <span class="hljs-variable">e</span>.<span class="hljs-variable">message</span>);</li><li>  }</li><li>}</li></ol></pre></div></div> </div> <div class="tiledSection"><h2 id="section1812105318579" device-type="phone,tablet">queryGuardStrategies<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section1812105318579" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">Tablet</span></div><p>queryGuardStrategies(): Promise&lt;GuardStrategy[]&gt;</p> <p>查询该应用下的所有管控策略，使用Promise异步回调。</p> <p><strong>模型约束：</strong>此接口仅可在Stage模型下使用。</p> <p><strong>需要权限：</strong>ohos.permission.MANAGE_SCREEN_TIME_GUARD</p> <p><strong>系统能力：</strong>SystemCapability.ScreenTimeGuard.GuardService</p> <p><strong>设备行为差异：</strong>该接口在Phone、Tablet设备中可正常调用，在其他设备中返回801错误码。</p> <p><strong>起始版本：</strong>6.0.0(20)</p> <div class="p"><strong>返回值：</strong> <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.18.9.2.1.3.1.1" width="28.050000000000004%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.18.9.2.1.3.1.2" width="71.95%"><p>说明</p> </th> </tr><tr><td class="cellrowborder" width="28.050000000000004%"><p>Promise&lt;<a href="/consumer/cn/doc/harmonyos-references/screentimeguard-guardservice#section188761911193713">GuardStrategy[]</a>&gt;</p> </td> <td class="cellrowborder" width="71.95%"><p>Promise对象。返回GuardStrategy[]，该应用下所有管控策略的数组。</p> </td> </tr>  </tbody></table></div> </div> </div> <p><strong>错误码：</strong></p> <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/screentimeguard-error-code">ArkTS API错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal" target="_blank">通用错误码</a>。</p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.18.12.1.3.1.1" width="24.279999999999998%"><p>错误码ID</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.18.12.1.3.1.2" width="75.72%"><p>错误信息</p> </th> </tr><tr><td class="cellrowborder" width="24.279999999999998%"><p>201</p> </td> <td class="cellrowborder" width="75.72%"><p>Permission verification failed. The application does not have the permission required to call the API.</p> </td> </tr> <tr><td class="cellrowborder" width="24.279999999999998%"><p>801</p> </td> <td class="cellrowborder" width="75.72%"><p>Capability not supported.  function queryGuardStrategies can not work correctly due to limited device capabilities.</p> </td> </tr> <tr><td class="cellrowborder" width="24.279999999999998%"><p>1019000001</p> </td> <td class="cellrowborder" width="75.72%"><p>Internal error.</p> </td> </tr> <tr><td class="cellrowborder" width="24.279999999999998%"><p>1019000002</p> </td> <td class="cellrowborder" width="75.72%"><p>The user has not authorized the application to access this interface.</p> </td> </tr>  </tbody></table></div> </div> <p><strong>示例：</strong></p> <div _ngcontent-lor-c106="" class="highlight-div"><div _ngcontent-lor-c106="" class="highlight-div-header"><div _ngcontent-lor-c106="" class="highlight-div-header-left"><div _ngcontent-lor-c106="" class="handle-button expand-button"><div _ngcontent-lor-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-lor-c106="" class="highlight-div-header-right"><div _ngcontent-lor-c106="" class="handle-button ai-button"></div><div _ngcontent-lor-c106="" class="handle-button line-button"><div _ngcontent-lor-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-lor-c106="" class="handle-button theme-button"><div _ngcontent-lor-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-lor-c106="" class="handle-button copy-button"><div _ngcontent-lor-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-lor-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { guardService } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ScreenTimeGuardKit'</span>;</li><li>
</li><li><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">testGuardService</span>(<span class="hljs-params"></span>) {</li><li>  <span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">guardStrategy</span>: guardService.<span class="hljs-property">GuardStrategy</span>[] = <span class="hljs-keyword">await</span> guardService.<span class="hljs-title function_">queryGuardStrategies</span>();</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'queryGuardStrategies invoke success, GuardStrategies: '</span> + guardStrategy);</li><li>  } <span class="hljs-keyword">catch</span> (e) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'queryGuardStrategies invoke failure. code: '</span> + e.<span class="hljs-property">code</span> + <span class="hljs-string">' message: '</span> + e.<span class="hljs-property">message</span>);</li><li>  }</li><li>}</li></ol></pre></div></div> </div> <div class="tiledSection"><h2 id="section116125615419" device-type="phone,tablet">removeGuardStrategy<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section116125615419" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">Tablet</span></div><p>removeGuardStrategy(strategyName: string): Promise&lt;void&gt;</p> <p>删除管控策略，使用Promise异步回调。</p> <p><strong>模型约束：</strong>此接口仅可在Stage模型下使用。</p> <p><strong>需要权限：</strong>ohos.permission.MANAGE_SCREEN_TIME_GUARD</p> <p><strong>系统能力：</strong>SystemCapability.ScreenTimeGuard.GuardService</p> <p><strong>设备行为差异：</strong>该接口在Phone、Tablet设备中可正常调用，在其他设备中返回801错误码。</p> <p><strong>起始版本：</strong>6.0.0(20)</p> <div class="p"><strong>参数：</strong> <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.19.9.2.1.5.1.1" width="10.67%"><p>参数名</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.19.9.2.1.5.1.2" width="27.52%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.19.9.2.1.5.1.3" width="9.64%"><p>必填</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.19.9.2.1.5.1.4" width="52.17%"><p>说明</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="10.67%"><p>strategyName</p> </td> <td class="cellrowborder" width="27.52%"><p>string</p> </td> <td class="cellrowborder" width="9.64%"><p>是</p> </td> <td class="cellrowborder" width="52.17%"><p>时间管控策略名称。</p> <div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content"><p>长度不超过64字符，仅支持字母、数字和下划线。</p> </div></div></div> </td> </tr>  </tbody></table></div> </div> </div> <div class="p"><strong>返回值：</strong> <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.19.10.2.1.3.1.1" width="28.050000000000004%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.19.10.2.1.3.1.2" width="71.95%"><p>说明</p> </th> </tr><tr><td class="cellrowborder" width="28.050000000000004%"><p>Promise&lt;void&gt;</p> </td> <td class="cellrowborder" width="71.95%"><p>Promise对象。无返回结果的Promise对象。</p> </td> </tr>  </tbody></table></div> </div> </div> <p><strong>错误码：</strong></p> <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/screentimeguard-error-code">ArkTS API错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal" target="_blank">通用错误码</a>。</p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.19.13.1.3.1.1" width="24.279999999999998%"><p>错误码ID</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.19.13.1.3.1.2" width="75.72%"><p>错误信息</p> </th> </tr><tr><td class="cellrowborder" width="24.279999999999998%"><p>201</p> </td> <td class="cellrowborder" width="75.72%"><p>Permission verification failed.  The application does not have the permission required to call the API.</p> </td> </tr> <tr><td class="cellrowborder" width="24.279999999999998%"><p>401</p> </td> <td class="cellrowborder" width="75.72%"><p>Parameter error. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types. 3.Parameter verification failed.</p> </td> </tr> <tr><td class="cellrowborder" width="24.279999999999998%"><p>801</p> </td> <td class="cellrowborder" width="75.72%"><p>Capability not supported. function removeGuardStrategy can not work correctly due to limited device capabilities.</p> </td> </tr> <tr><td class="cellrowborder" width="24.279999999999998%"><p>1019000001</p> </td> <td class="cellrowborder" width="75.72%"><p>Internal error.</p> </td> </tr> <tr><td class="cellrowborder" width="24.279999999999998%"><p>1019000002</p> </td> <td class="cellrowborder" width="75.72%"><p>The user has not authorized the application to access this interface.</p> </td> </tr> <tr><td class="cellrowborder" width="24.279999999999998%"><p>1019000006</p> </td> <td class="cellrowborder" width="75.72%"><p>Nonexistent strategy.</p> </td> </tr>  </tbody></table></div> </div> <p><strong>示例：</strong></p> <div _ngcontent-lor-c106="" class="highlight-div"><div _ngcontent-lor-c106="" class="highlight-div-header"><div _ngcontent-lor-c106="" class="highlight-div-header-left"><div _ngcontent-lor-c106="" class="handle-button expand-button"><div _ngcontent-lor-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-lor-c106="" class="highlight-div-header-right"><div _ngcontent-lor-c106="" class="handle-button ai-button"></div><div _ngcontent-lor-c106="" class="handle-button line-button"><div _ngcontent-lor-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-lor-c106="" class="handle-button theme-button"><div _ngcontent-lor-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-lor-c106="" class="handle-button copy-button"><div _ngcontent-lor-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-lor-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { guardService } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ScreenTimeGuardKit'</span>;</li><li>
</li><li><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">testGuardService</span>(<span class="hljs-params"></span>) {</li><li>  <span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">await</span> guardService.<span class="hljs-title function_">removeGuardStrategy</span>(<span class="hljs-string">"TestStrategy"</span>);</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'removeGuardStrategy invoke success'</span>);</li><li>  } <span class="hljs-keyword">catch</span> (e) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'removeGuardStrategy invoke failure. code: '</span> + e.<span class="hljs-property">code</span> + <span class="hljs-string">' message: '</span> + e.<span class="hljs-property">message</span>);</li><li>  }</li><li>}</li></ol></pre></div></div> </div> <div class="tiledSection"><h2 id="section18918313999" device-type="phone,tablet">startGuardStrategy<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section18918313999" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">Tablet</span></div><p>startGuardStrategy(strategyName: string): Promise&lt;void&gt;</p> <p>根据策略名称，立即启动指定的管控策略，使用Promise异步回调。</p> <p><strong>模型约束：</strong>此接口仅可在Stage模型下使用。</p> <p><strong>需要权限：</strong>ohos.permission.MANAGE_SCREEN_TIME_GUARD</p> <p><strong>系统能力：</strong>SystemCapability.ScreenTimeGuard.GuardService</p> <p><strong>设备行为差异：</strong>该接口在Phone、Tablet设备中可正常调用，在其他设备中返回801错误码。</p> <p><strong>起始版本：</strong>6.0.0(20)</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.20.10.1.5.1.1" width="10.67%"><p>参数名</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.20.10.1.5.1.2" width="27.52%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.20.10.1.5.1.3" width="9.64%"><p>必填</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.20.10.1.5.1.4" width="52.17%"><p>说明</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="10.67%"><p>strategyName</p> </td> <td class="cellrowborder" width="27.52%"><p>string</p> </td> <td class="cellrowborder" width="9.64%"><p>是</p> </td> <td class="cellrowborder" width="52.17%"><p>时间管控策略名称。</p> <div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content"><p>长度不超过64字符，仅支持字母、数字和下划线。</p> </div></div></div> </td> </tr>  </tbody></table></div> </div> <div class="p"><strong>返回值：</strong> <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.20.11.2.1.3.1.1" width="28.050000000000004%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.20.11.2.1.3.1.2" width="71.95%"><p>说明</p> </th> </tr><tr><td class="cellrowborder" width="28.050000000000004%"><p>Promise&lt;void&gt;</p> </td> <td class="cellrowborder" width="71.95%"><p>Promise对象。无返回结果的Promise对象。</p> </td> </tr>  </tbody></table></div> </div> </div> <p><strong>错误码：</strong></p> <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/screentimeguard-error-code">ArkTS API错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal" target="_blank">通用错误码</a>。</p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.20.14.1.3.1.1" width="24.279999999999998%"><p>错误码ID</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.20.14.1.3.1.2" width="75.72%"><p>错误信息</p> </th> </tr><tr><td class="cellrowborder" width="24.279999999999998%"><p>201</p> </td> <td class="cellrowborder" width="75.72%"><p>Permission verification failed.  The application does not have the permission required to call the API.</p> </td> </tr> <tr><td class="cellrowborder" width="24.279999999999998%"><p>401</p> </td> <td class="cellrowborder" width="75.72%"><p>Parameter error. Possible causes:  1. Mandatory parameters are left unspecified. 2. Incorrect parameter types. 3.Parameter verification failed.</p> </td> </tr> <tr><td class="cellrowborder" width="24.279999999999998%"><p>801</p> </td> <td class="cellrowborder" width="75.72%"><p>Capability not supported. function startGuardStrategy can not work correctly due to limited device capabilities.</p> </td> </tr> <tr><td class="cellrowborder" width="24.279999999999998%"><p>1019000001</p> </td> <td class="cellrowborder" width="75.72%"><p>Internal error.</p> </td> </tr> <tr><td class="cellrowborder" width="24.279999999999998%"><p>1019000002</p> </td> <td class="cellrowborder" width="75.72%"><p>The user has not authorized the application to access this interface.</p> </td> </tr> <tr><td class="cellrowborder" width="24.279999999999998%"><p>1019000006</p> </td> <td class="cellrowborder" width="75.72%"><p>Nonexistent strategy.</p> </td> </tr> <tr><td class="cellrowborder" width="24.279999999999998%"><p>1019000007</p> </td> <td class="cellrowborder" width="75.72%"><p>The strategy is already being executed.</p> </td> </tr>  </tbody></table></div> </div> <p><strong>示例：</strong></p> <div _ngcontent-lor-c106="" class="highlight-div"><div _ngcontent-lor-c106="" class="highlight-div-header"><div _ngcontent-lor-c106="" class="highlight-div-header-left"><div _ngcontent-lor-c106="" class="handle-button expand-button"><div _ngcontent-lor-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-lor-c106="" class="highlight-div-header-right"><div _ngcontent-lor-c106="" class="handle-button ai-button"></div><div _ngcontent-lor-c106="" class="handle-button line-button"><div _ngcontent-lor-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-lor-c106="" class="handle-button theme-button"><div _ngcontent-lor-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-lor-c106="" class="handle-button copy-button"><div _ngcontent-lor-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-lor-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { guardService } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ScreenTimeGuardKit'</span>;</li><li>
</li><li><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">testGuardService</span>(<span class="hljs-params"></span>) {</li><li>  <span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">await</span> guardService.<span class="hljs-title function_">startGuardStrategy</span>(<span class="hljs-string">"TestStrategy"</span>);</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'startGuardStrategy invoke success'</span>);</li><li>  } <span class="hljs-keyword">catch</span> (e) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'startGuardStrategy invoke failure. code: '</span> + e.<span class="hljs-property">code</span> + <span class="hljs-string">' message: '</span> + e.<span class="hljs-property">message</span>);</li><li>  }</li><li>}</li></ol></pre></div></div> </div> <div class="tiledSection"><h2 id="section10788197141416" device-type="phone,tablet">stopGuardStrategy<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section10788197141416" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">Tablet</span></div><p>stopGuardStrategy(strategyName: string): Promise&lt;void&gt;</p> <p>根据策略名称，立即停止指定的管控策略，使用Promise异步回调。</p> <p><strong>模型约束：</strong>此接口仅可在Stage模型下使用。</p> <p><strong>需要权限：</strong>ohos.permission.MANAGE_SCREEN_TIME_GUARD</p> <p><strong>系统能力：</strong>SystemCapability.ScreenTimeGuard.GuardService</p> <p><strong>设备行为差异：</strong>该接口在Phone、Tablet设备中可正常调用，在其他设备中返回801错误码。</p> <p><strong>起始版本：</strong>6.0.0(20)</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.21.10.1.5.1.1" width="10.67%"><p>参数名</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.21.10.1.5.1.2" width="27.52%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.21.10.1.5.1.3" width="9.64%"><p>必填</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.21.10.1.5.1.4" width="52.17%"><p>说明</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="10.67%"><p>strategyName</p> </td> <td class="cellrowborder" width="27.52%"><p>string</p> </td> <td class="cellrowborder" width="9.64%"><p>是</p> </td> <td class="cellrowborder" width="52.17%"><p>时间管控策略名称。</p> <div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content"><p>长度不超过64字符，仅支持字母、数字和下划线。</p> </div></div></div> </td> </tr>  </tbody></table></div> </div> <div class="p"><strong>返回值：</strong> <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.21.11.2.1.3.1.1" width="28.050000000000004%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.21.11.2.1.3.1.2" width="71.95%"><p>说明</p> </th> </tr><tr><td class="cellrowborder" width="28.050000000000004%"><p>Promise&lt;void&gt;</p> </td> <td class="cellrowborder" width="71.95%"><p>Promise对象。无返回结果的Promise对象。</p> </td> </tr>  </tbody></table></div> </div> </div> <p><strong>错误码：</strong></p> <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/screentimeguard-error-code">ArkTS API错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal" target="_blank">通用错误码</a>。</p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.21.14.1.3.1.1" width="24.279999999999998%"><p>错误码ID</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.21.14.1.3.1.2" width="75.72%"><p>错误信息</p> </th> </tr><tr><td class="cellrowborder" width="24.279999999999998%"><p>201</p> </td> <td class="cellrowborder" width="75.72%"><p>Permission verification failed. The application does not have the permission required to call the API.</p> </td> </tr> <tr><td class="cellrowborder" width="24.279999999999998%"><p>401</p> </td> <td class="cellrowborder" width="75.72%"><p>Parameter error.  Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types. 3.Parameter verification failed.</p> </td> </tr> <tr><td class="cellrowborder" width="24.279999999999998%"><p>801</p> </td> <td class="cellrowborder" width="75.72%"><p>Capability not supported. function stopGuardStrategy can not work correctly due to limited device capabilities.</p> </td> </tr> <tr><td class="cellrowborder" width="24.279999999999998%"><p>1019000001</p> </td> <td class="cellrowborder" width="75.72%"><p>Internal error.</p> </td> </tr> <tr><td class="cellrowborder" width="24.279999999999998%"><p>1019000002</p> </td> <td class="cellrowborder" width="75.72%"><p>The user has not authorized the application to access this interface.</p> </td> </tr> <tr><td class="cellrowborder" width="24.279999999999998%"><p>1019000006</p> </td> <td class="cellrowborder" width="75.72%"><p>Nonexistent strategy.</p> </td> </tr> <tr><td class="cellrowborder" width="24.279999999999998%"><p>1019000008</p> </td> <td class="cellrowborder" width="75.72%"><p>This strategy has not been started yet.</p> </td> </tr>  </tbody></table></div> </div> <p><strong>示例：</strong></p> <div _ngcontent-lor-c106="" class="highlight-div"><div _ngcontent-lor-c106="" class="highlight-div-header"><div _ngcontent-lor-c106="" class="highlight-div-header-left"><div _ngcontent-lor-c106="" class="handle-button expand-button"><div _ngcontent-lor-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-lor-c106="" class="highlight-div-header-right"><div _ngcontent-lor-c106="" class="handle-button ai-button"></div><div _ngcontent-lor-c106="" class="handle-button line-button"><div _ngcontent-lor-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-lor-c106="" class="handle-button theme-button"><div _ngcontent-lor-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-lor-c106="" class="handle-button copy-button"><div _ngcontent-lor-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-lor-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { guardService } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ScreenTimeGuardKit'</span>;</li><li>
</li><li><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">testGuardService</span>(<span class="hljs-params"></span>) {</li><li>  <span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">await</span> guardService.<span class="hljs-title function_">stopGuardStrategy</span>(<span class="hljs-string">"TestStrategy"</span>);</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'stopGuardStrategy invoke success'</span>);</li><li>  } <span class="hljs-keyword">catch</span> (e) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'stopGuardStrategy invoke failure. code: '</span> + e.<span class="hljs-property">code</span> + <span class="hljs-string">' message: '</span> + e.<span class="hljs-property">message</span>);</li><li>  }</li><li>}</li></ol></pre></div></div> </div> <div class="tiledSection"><h2 id="section48957119226" device-type="phone,tablet">setAppsRestriction<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section48957119226" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">Tablet</span></div><p>setAppsRestriction(appInfo: AppInfo, restrictionType: RestrictionType): Promise&lt;void&gt;</p> <p>可根据传入应用token数组，以及限制类型（黑/允许清单），实现对相应的应用添加访问限制，使用Promise异步回调。</p> <p><strong>模型约束：</strong>此接口仅可在Stage模型下使用。</p> <p><strong>需要权限：</strong>ohos.permission.MANAGE_SCREEN_TIME_GUARD</p> <p><strong>系统能力：</strong>SystemCapability.ScreenTimeGuard.GuardService</p> <p><strong>设备行为差异：</strong>该接口在Phone、Tablet设备中可正常调用，在其他设备中返回801错误码。</p> <p><strong>起始版本：</strong>6.0.0(20)</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.22.10.1.5.1.1" width="10.66%"><p>参数名</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.22.10.1.5.1.2" width="27.529999999999998%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.22.10.1.5.1.3" width="9.64%"><p>必填</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.22.10.1.5.1.4" width="52.17%"><p>说明</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="10.66%"><p>appInfo</p> </td> <td class="cellrowborder" width="27.529999999999998%"><p><a href="/consumer/cn/doc/harmonyos-references/screentimeguard-guardservice#section76401996131">AppInfo</a></p> </td> <td class="cellrowborder" width="9.64%"><p>是</p> </td> <td class="cellrowborder" width="52.17%"><p>被选择的应用token集合，是一个字符串数组。</p> </td> </tr> <tr><td class="cellrowborder" width="10.66%"><p>restrictionType</p> </td> <td class="cellrowborder" width="27.529999999999998%"><p><a href="/consumer/cn/doc/harmonyos-references/screentimeguard-guardservice#section119174813532">RestrictionType</a></p> </td> <td class="cellrowborder" width="9.64%"><p>是</p> </td> <td class="cellrowborder" width="52.17%"><p>限制类型</p> <p>TRUSTLIST_TYPE表示对appInfo外的应用进行限制，BLOCKLIST_TYPE表示对appInfo内的应用进行限制。</p> </td> </tr>  </tbody></table></div> </div> <div class="p"><strong>返回值：</strong> <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.22.11.2.1.3.1.1" width="28.050000000000004%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.22.11.2.1.3.1.2" width="71.95%"><p>说明</p> </th> </tr><tr><td class="cellrowborder" width="28.050000000000004%"><p>Promise&lt;void&gt;</p> </td> <td class="cellrowborder" width="71.95%"><p>Promise对象。无返回结果的Promise对象。</p> </td> </tr>  </tbody></table></div> </div> </div> <p><strong>错误码：</strong></p> <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/screentimeguard-error-code">ArkTS API错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal" target="_blank">通用错误码</a>。</p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.22.14.1.3.1.1" width="24.279999999999998%"><p>错误码ID</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.22.14.1.3.1.2" width="75.72%"><p>错误信息</p> </th> </tr><tr><td class="cellrowborder" width="24.279999999999998%"><p>201</p> </td> <td class="cellrowborder" width="75.72%"><p>Permission verification failed. The application does not have the permission required to call the API.</p> </td> </tr> <tr><td class="cellrowborder" width="24.279999999999998%"><p>401</p> </td> <td class="cellrowborder" width="75.72%"><p>Parameter error. Possible causes: 1. Mandatory parameters are left unspecified. 2. Incorrect parameter types. 3.Parameter verification failed.</p> </td> </tr> <tr><td class="cellrowborder" width="24.279999999999998%"><p>801</p> </td> <td class="cellrowborder" width="75.72%"><p>Capability not supported. function setAppsRestriction can not work correctly due to limited device capabilities.</p> </td> </tr> <tr><td class="cellrowborder" width="24.279999999999998%"><p>1019000001</p> </td> <td class="cellrowborder" width="75.72%"><p>Internal error.</p> </td> </tr> <tr><td class="cellrowborder" width="24.279999999999998%"><p>1019000002</p> </td> <td class="cellrowborder" width="75.72%"><p>The user has not authorized the application to access this interface.</p> </td> </tr>  </tbody></table></div> </div> <p><strong>示例：</strong></p> <div _ngcontent-lor-c106="" class="highlight-div"><div _ngcontent-lor-c106="" class="highlight-div-header"><div _ngcontent-lor-c106="" class="highlight-div-header-left"><div _ngcontent-lor-c106="" class="handle-button expand-button"><div _ngcontent-lor-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-lor-c106="" class="highlight-div-header-right"><div _ngcontent-lor-c106="" class="handle-button ai-button"></div><div _ngcontent-lor-c106="" class="handle-button line-button"><div _ngcontent-lor-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-lor-c106="" class="handle-button theme-button"><div _ngcontent-lor-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-lor-c106="" class="handle-button copy-button"><div _ngcontent-lor-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-lor-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { appPicker, guardService } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ScreenTimeGuardKit'</span>;</li><li>
</li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">TestPage</span> {</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>      <span class="hljs-title class_">Column</span>() {</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">"TestSetAppsRestriction"</span>)</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-keyword">async</span> () =&gt; {</li><li>            <span class="hljs-comment">// 调用startAppPicker获取对应应用的token</span></li><li>            <span class="hljs-keyword">let</span> <span class="hljs-attr">selectedTokens</span>:<span class="hljs-built_in">string</span>[] = [];</li><li>            appPicker.<span class="hljs-title function_">startAppPicker</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>(), { <span class="hljs-attr">appTokens</span>: [] })</li><li>              .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">tokens</span>) =&gt;</span> {</li><li>                selectedTokens = [...tokens];</li><li>              })</li><li>            <span class="hljs-comment">// 调用setAppsRestriction对相应应用进行管控</span></li><li>            <span class="hljs-keyword">let</span> <span class="hljs-attr">appInfo</span>: guardService.<span class="hljs-property">AppInfo</span> = { <span class="hljs-attr">appTokens</span>: selectedTokens };</li><li>            <span class="hljs-keyword">let</span> <span class="hljs-attr">restrictionType</span>: guardService.<span class="hljs-property">RestrictionType</span> = guardService.<span class="hljs-property">RestrictionType</span>.<span class="hljs-property">BLOCKLIST_TYPE</span>;</li><li>            <span class="hljs-keyword">try</span> {</li><li>              <span class="hljs-keyword">await</span> guardService.<span class="hljs-title function_">setAppsRestriction</span>(appInfo, restrictionType);</li><li>              <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'setAppsRestriction invoke success'</span>);</li><li>            } <span class="hljs-keyword">catch</span> (e) {</li><li>              <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'setAppsRestriction invoke failure. code: '</span> + e.<span class="hljs-property">code</span> + <span class="hljs-string">' message: '</span> + e.<span class="hljs-property">message</span>);</li><li>            }</li><li>        })</li><li>      }</li><li>  }</li><li>}</li></ol></pre></div></div> </div> <div class="tiledSection"><h2 id="section0894037112812" device-type="phone,tablet">releaseAppsRestriction<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section0894037112812" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">Tablet</span></div><p>releaseAppsRestriction(appInfo: AppInfo, restrictionType: RestrictionType): Promise&lt;void&gt;</p> <p>可根据传入应用token数组，以及限制类型（黑/允许清单），实现对相应的应用解除访问限制，使用Promise异步回调。</p> <p><strong>模型约束：</strong>此接口仅可在Stage模型下使用。</p> <p><strong>需要权限：</strong>ohos.permission.MANAGE_SCREEN_TIME_GUARD</p> <p><strong>系统能力：</strong>SystemCapability.ScreenTimeGuard.GuardService</p> <p><strong>设备行为差异：</strong>该接口在Phone、Tablet设备中可正常调用，在其他设备中返回801错误码。</p> <p><strong>起始版本：</strong>6.0.0(20)</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.23.10.1.5.1.1" width="10.66%"><p>参数名</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.23.10.1.5.1.2" width="27.529999999999998%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.23.10.1.5.1.3" width="9.64%"><p>必填</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.23.10.1.5.1.4" width="52.17%"><p>说明</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="10.66%"><p>appInfo</p> </td> <td class="cellrowborder" width="27.529999999999998%"><p><a href="/consumer/cn/doc/harmonyos-references/screentimeguard-guardservice#section76401996131">AppInfo</a></p> </td> <td class="cellrowborder" width="9.64%"><p>是</p> </td> <td class="cellrowborder" width="52.17%"><p>被选择的应用token集合，是一个字符串数组。</p> </td> </tr> <tr><td class="cellrowborder" width="10.66%"><p>restrictionType</p> </td> <td class="cellrowborder" width="27.529999999999998%"><p><a href="/consumer/cn/doc/harmonyos-references/screentimeguard-guardservice#section119174813532">RestrictionType</a></p> </td> <td class="cellrowborder" width="9.64%"><p>是</p> </td> <td class="cellrowborder" width="52.17%"><p>限制类型</p> <p>TRUSTLIST_TYPE表示对appInfo外的应用进行限制，BLOCKLIST_TYPE表示对appInfo内的应用进行限制。</p> </td> </tr>  </tbody></table></div> </div> <div class="p"><strong>返回值：</strong> <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.23.11.2.1.3.1.1" width="28.050000000000004%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.23.11.2.1.3.1.2" width="71.95%"><p>说明</p> </th> </tr><tr><td class="cellrowborder" width="28.050000000000004%"><p>Promise&lt;void&gt;</p> </td> <td class="cellrowborder" width="71.95%"><p>Promise对象。无返回结果的Promise对象。</p> </td> </tr>  </tbody></table></div> </div> </div> <p><strong>错误码：</strong></p> <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/screentimeguard-error-code">ArkTS API错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal" target="_blank">通用错误码</a>。</p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.23.14.1.3.1.1" width="24.26%"><p>错误码ID</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.23.14.1.3.1.2" width="75.74%"><p>错误信息</p> </th> </tr><tr><td class="cellrowborder" width="24.26%"><p>201</p> </td> <td class="cellrowborder" width="75.74%"><p>Permission verification failed. The application does not have the permission required to call the API.</p> </td> </tr> <tr><td class="cellrowborder" width="24.26%"><p>401</p> </td> <td class="cellrowborder" width="75.74%"><p>Parameter error. Possible causes:  1. Mandatory parameters are left unspecified. 2. Incorrect parameter types. 3.Parameter verification failed.</p> </td> </tr> <tr><td class="cellrowborder" width="24.26%"><p>801</p> </td> <td class="cellrowborder" width="75.74%"><p>Capability not supported. function releaseAppsRestriction can not work correctly due to limited device capabilities.</p> </td> </tr> <tr><td class="cellrowborder" width="24.26%"><p>1019000001</p> </td> <td class="cellrowborder" width="75.74%"><p>Internal error.</p> </td> </tr> <tr><td class="cellrowborder" width="24.26%"><p>1019000002</p> </td> <td class="cellrowborder" width="75.74%"><p>The user has not authorized the application to access this interface.</p> </td> </tr>  </tbody></table></div> </div> <p><strong>示例：</strong></p> <div _ngcontent-lor-c106="" class="highlight-div"><div _ngcontent-lor-c106="" class="highlight-div-header"><div _ngcontent-lor-c106="" class="highlight-div-header-left"><div _ngcontent-lor-c106="" class="handle-button expand-button"><div _ngcontent-lor-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-lor-c106="" class="highlight-div-header-right"><div _ngcontent-lor-c106="" class="handle-button ai-button"></div><div _ngcontent-lor-c106="" class="handle-button line-button"><div _ngcontent-lor-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-lor-c106="" class="handle-button theme-button"><div _ngcontent-lor-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-lor-c106="" class="handle-button copy-button"><div _ngcontent-lor-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-lor-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { appPicker, guardService } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ScreenTimeGuardKit'</span>;</li><li>
</li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">TestPage</span> {</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>      <span class="hljs-title class_">Column</span>() {</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">"TestReleaseAppsRestriction"</span>)</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-keyword">async</span> () =&gt; {</li><li>            <span class="hljs-comment">// 调用startAppPicker获取对应应用的token</span></li><li>            <span class="hljs-keyword">let</span> <span class="hljs-attr">selectedTokens</span>:<span class="hljs-built_in">string</span>[] = [];</li><li>            appPicker.<span class="hljs-title function_">startAppPicker</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>(), { <span class="hljs-attr">appTokens</span>: [] })</li><li>              .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">tokens</span>) =&gt;</span> {</li><li>                selectedTokens = [...tokens];</li><li>              })</li><li>            <span class="hljs-comment">// 调用releaseAppsRestriction对相应应用进行管控</span></li><li>            <span class="hljs-keyword">let</span> <span class="hljs-attr">appInfo</span>: guardService.<span class="hljs-property">AppInfo</span> = { <span class="hljs-attr">appTokens</span>: selectedTokens };</li><li>            <span class="hljs-keyword">let</span> <span class="hljs-attr">restrictionType</span>: guardService.<span class="hljs-property">RestrictionType</span> = guardService.<span class="hljs-property">RestrictionType</span>.<span class="hljs-property">BLOCKLIST_TYPE</span>;</li><li>            <span class="hljs-keyword">try</span> {</li><li>              <span class="hljs-keyword">await</span> guardService.<span class="hljs-title function_">releaseAppsRestriction</span>(appInfo, restrictionType);</li><li>              <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'releaseAppsRestriction invoke success'</span>);</li><li>            } <span class="hljs-keyword">catch</span> (e) {</li><li>              <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'releaseAppsRestriction invoke failure. code: '</span> + e.<span class="hljs-property">code</span> + <span class="hljs-string">' message: '</span> + e.<span class="hljs-property">message</span>);</li><li>            }</li><li>        })</li><li>      }</li><li>  }</li><li>}</li></ol></pre></div></div> </div> </div> <div></div></div>