<h1 _ngcontent-wqx-c119="" class="doc-title ng-star-inserted" title="Interface (MediaKeySession)"> Interface (MediaKeySession) </h1>

<div _ngcontent-wqx-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div><div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"> <p>本模块首批接口从API version 11开始支持。后续版本的新增接口，采用上角标单独标记接口的起始版本。</p>  </div></div></div> <p>支持媒体密钥管理。在调用MediaKeySession方法之前，必须使用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-drm-mediakeysystem#createmediakeysession">createMediaKeySession</a>获取一个MediaKeySession实例。</p>  <div class="tiledSection"><h2 id="导入模块" device-type="phone,2in1,tablet,wearable">导入模块<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="导入模块" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">Wearable</span></div><div _ngcontent-wqx-c106="" class="highlight-div"><div _ngcontent-wqx-c106="" class="highlight-div-header"><div _ngcontent-wqx-c106="" class="highlight-div-header-left"><div _ngcontent-wqx-c106="" class="handle-button expand-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wqx-c106="" class="highlight-div-header-right"><div _ngcontent-wqx-c106="" class="handle-button ai-button"></div><div _ngcontent-wqx-c106="" class="handle-button line-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wqx-c106="" class="handle-button theme-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wqx-c106="" class="handle-button copy-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wqx-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { drm } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.DrmKit'</span>;</li></ol></pre></div></div> </div>  <div class="tiledSection"><h2 id="generatemediakeyrequest" device-type="phone,2in1,tablet,wearable">generateMediaKeyRequest<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="generatemediakeyrequest" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">Wearable</span></div><p>generateMediaKeyRequest(mimeType: string, initData: Uint8Array, mediaKeyType: number, options?: OptionsData[]): Promise&lt;MediaKeyRequest&gt;</p> <p>生成媒体密钥请求。使用Promise异步回调。</p> <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong> SystemCapability.Multimedia.Drm.Core</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.4.7.1.5.1.1" width="25%">参数名</th> <th align="left" class="cellrowborder" id="mcps1.3.4.7.1.5.1.2" width="25%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.4.7.1.5.1.3" width="25%">必填</th> <th align="left" class="cellrowborder" id="mcps1.3.4.7.1.5.1.4" width="25%">说明</th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="25%">mimeType</td> <td class="cellrowborder" width="25%">string</td> <td class="cellrowborder" width="25%">是</td> <td class="cellrowborder" width="25%">媒体类型，DRM解决方案名称，可通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-drm-f#drmismediakeysystemsupported-1">isMediaKeySystemSupported</a>查询。</td> </tr> <tr><td class="cellrowborder" width="25%">initData</td> <td class="cellrowborder" width="25%">Uint8Array</td> <td class="cellrowborder" width="25%">是</td> <td class="cellrowborder" width="25%">初始数据。</td> </tr> <tr><td class="cellrowborder" width="25%">mediaKeyType</td> <td class="cellrowborder" width="25%">number</td> <td class="cellrowborder" width="25%">是</td> <td class="cellrowborder" width="25%">媒体密钥类型。0表示在线，1表示离线。</td> </tr> <tr><td class="cellrowborder" width="25%">options</td> <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-drm-i#optionsdata">OptionsData[]</a></td> <td class="cellrowborder" width="25%">否</td> <td class="cellrowborder" width="25%">可选数据。</td> </tr>  </tbody></table></div> </div> <p><strong>返回值：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.4.9.1.3.1.1" width="50%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.4.9.1.3.1.2" width="50%">说明</th> </tr><tr><td class="cellrowborder" width="50%">Promise&lt;<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-drm-i#mediakeyrequest">MediaKeyRequest</a>&gt;</td> <td class="cellrowborder" width="50%">Promise对象，媒体密钥请求。</td> </tr>  </tbody></table></div> </div> <p><strong>错误码：</strong></p> <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-drm">DRM错误码</a>。</p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.4.12.1.3.1.1" width="50%">错误码ID</th> <th align="left" class="cellrowborder" id="mcps1.3.4.12.1.3.1.2" width="50%">错误信息</th> </tr><tr><td class="cellrowborder" width="50%">401</td> <td class="cellrowborder" width="50%">The parameter check failed. Possibly because: 1.Mandatory parameters are left unspecified or too many parameters. 2.Incorrect parameter types. 3.Parameter verification failed.</td> </tr> <tr><td class="cellrowborder" width="50%">24700101</td> <td class="cellrowborder" width="50%">All unknown errors</td> </tr> <tr><td class="cellrowborder" width="50%">24700201</td> <td class="cellrowborder" width="50%">Fatal service error, for example, service died</td> </tr>  </tbody></table></div> </div> <p><strong>示例：</strong></p> <div _ngcontent-wqx-c106="" class="highlight-div"><div _ngcontent-wqx-c106="" class="highlight-div-header"><div _ngcontent-wqx-c106="" class="highlight-div-header-left"><div _ngcontent-wqx-c106="" class="handle-button expand-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wqx-c106="" class="highlight-div-header-right"><div _ngcontent-wqx-c106="" class="handle-button ai-button"></div><div _ngcontent-wqx-c106="" class="handle-button line-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wqx-c106="" class="handle-button theme-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wqx-c106="" class="handle-button copy-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wqx-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { drm } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.DrmKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">mediaKeySystem</span>: drm.<span class="hljs-property">MediaKeySystem</span> = drm.<span class="hljs-title function_">createMediaKeySystem</span>(<span class="hljs-string">"com.wiseplay.drm"</span>);</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">mediaKeySession</span>: drm.<span class="hljs-property">MediaKeySession</span> = mediaKeySystem.<span class="hljs-title function_">createMediaKeySession</span>();</li><li><span class="hljs-comment">// pssh数据为版权保护系统描述头，封装在加密码流中，mp4文件中位于pssh box、dash码流中位于mpd及mp4的pssh box、hls+ts的码流位于m3u8及每个ts片段中，请按实际值传入。</span></li><li><span class="hljs-keyword">let</span> uint8pssh = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>([<span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>]);</li><li>mediaKeySession.<span class="hljs-title function_">generateMediaKeyRequest</span>(<span class="hljs-string">"video/avc"</span>, uint8pssh, drm.<span class="hljs-property">MediaKeyType</span>.<span class="hljs-property">MEDIA_KEY_TYPE_ONLINE</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">mediaKeyRequest: drm.MediaKeyRequest</span>) =&gt;</span>{</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'generateMediaKeyRequest'</span> + mediaKeyRequest);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`generateMediaKeyRequest: ERROR: <span class="hljs-subst">${err}</span>`</span>);</li><li>});</li></ol></pre></div></div> </div>  <div class="tiledSection"><h2 id="processmediakeyresponse" device-type="phone,2in1,tablet,wearable">processMediaKeyResponse<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="processmediakeyresponse" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">Wearable</span></div><p>processMediaKeyResponse(response: Uint8Array): Promise&lt;Uint8Array&gt;</p> <p>处理媒体密钥响应。使用Promise异步回调。</p> <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong> SystemCapability.Multimedia.Drm.Core</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.5.7.1.5.1.1" width="25%">参数名</th> <th align="left" class="cellrowborder" id="mcps1.3.5.7.1.5.1.2" width="25%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.5.7.1.5.1.3" width="25%">必填</th> <th align="left" class="cellrowborder" id="mcps1.3.5.7.1.5.1.4" width="25%">说明</th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="25%">response</td> <td class="cellrowborder" width="25%">Uint8Array</td> <td class="cellrowborder" width="25%">是</td> <td class="cellrowborder" width="25%">媒体密钥响应。</td> </tr>  </tbody></table></div> </div> <p><strong>返回值：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.5.9.1.3.1.1" width="50%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.5.9.1.3.1.2" width="50%">说明</th> </tr><tr><td class="cellrowborder" width="50%">Promise&lt;Uint8Array&gt;</td> <td class="cellrowborder" width="50%">Promise对象，媒体密钥标识。</td> </tr>  </tbody></table></div> </div> <p><strong>错误码：</strong></p> <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-drm">DRM错误码</a>。</p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.5.12.1.3.1.1" width="50%">错误码ID</th> <th align="left" class="cellrowborder" id="mcps1.3.5.12.1.3.1.2" width="50%">错误信息</th> </tr><tr><td class="cellrowborder" width="50%">401</td> <td class="cellrowborder" width="50%">The parameter check failed. Possibly because: 1.Mandatory parameters are left unspecified. 2.Incorrect parameter types. 3.Parameter verification failed.</td> </tr> <tr><td class="cellrowborder" width="50%">24700101</td> <td class="cellrowborder" width="50%">All unknown errors</td> </tr> <tr><td class="cellrowborder" width="50%">24700201</td> <td class="cellrowborder" width="50%">Fatal service error, for example, service died</td> </tr>  </tbody></table></div> </div> <p><strong>示例：</strong></p> <div _ngcontent-wqx-c106="" class="highlight-div"><div _ngcontent-wqx-c106="" class="highlight-div-header"><div _ngcontent-wqx-c106="" class="highlight-div-header-left"><div _ngcontent-wqx-c106="" class="handle-button expand-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wqx-c106="" class="highlight-div-header-right"><div _ngcontent-wqx-c106="" class="handle-button ai-button"></div><div _ngcontent-wqx-c106="" class="handle-button line-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wqx-c106="" class="handle-button theme-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wqx-c106="" class="handle-button copy-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wqx-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { drm } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.DrmKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">mediaKeySystem</span>: drm.<span class="hljs-property">MediaKeySystem</span> = drm.<span class="hljs-title function_">createMediaKeySystem</span>(<span class="hljs-string">"com.wiseplay.drm"</span>);</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">mediaKeySession</span>: drm.<span class="hljs-property">MediaKeySession</span> = mediaKeySystem.<span class="hljs-title function_">createMediaKeySession</span>();</li><li><span class="hljs-comment">// mediaKeyResponse是从DRM服务获取的媒体密钥响应，按实际值填入。</span></li><li><span class="hljs-keyword">let</span> mediaKeyResponse = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>([<span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>]);</li><li>mediaKeySession.<span class="hljs-title function_">processMediaKeyResponse</span>(mediaKeyResponse).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">mediaKeyId: <span class="hljs-built_in">Uint8Array</span></span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'processMediaKeyResponse:'</span> + mediaKeyId);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`processMediaKeyResponse: ERROR: <span class="hljs-subst">${err}</span>`</span>);</li><li>});</li></ol></pre></div></div> </div>  <div class="tiledSection"><h2 id="checkmediakeystatus" device-type="phone,2in1,tablet,wearable">checkMediaKeyStatus<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="checkmediakeystatus" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">Wearable</span></div><p> checkMediaKeyStatus(): MediaKeyStatus[]</p> <p>检查当前媒体密钥状态。</p> <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong> SystemCapability.Multimedia.Drm.Core</p> <p><strong>返回值：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.6.7.1.3.1.1" width="50%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.6.7.1.3.1.2" width="50%">说明</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-drm-i#mediakeystatus">MediaKeyStatus[]</a></td> <td class="cellrowborder" width="50%">当前媒体密钥状态值。</td> </tr>  </tbody></table></div> </div> <p><strong>错误码：</strong></p> <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-drm">DRM错误码</a>。</p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.6.10.1.3.1.1" width="50%">错误码ID</th> <th align="left" class="cellrowborder" id="mcps1.3.6.10.1.3.1.2" width="50%">错误信息</th> </tr><tr><td class="cellrowborder" width="50%">24700101</td> <td class="cellrowborder" width="50%">All unknown errors</td> </tr> <tr><td class="cellrowborder" width="50%">24700201</td> <td class="cellrowborder" width="50%">Fatal service error, for example, service died</td> </tr>  </tbody></table></div> </div> <p><strong>示例：</strong></p> <div _ngcontent-wqx-c106="" class="highlight-div"><div _ngcontent-wqx-c106="" class="highlight-div-header"><div _ngcontent-wqx-c106="" class="highlight-div-header-left"><div _ngcontent-wqx-c106="" class="handle-button expand-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wqx-c106="" class="highlight-div-header-right"><div _ngcontent-wqx-c106="" class="handle-button ai-button"></div><div _ngcontent-wqx-c106="" class="handle-button line-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wqx-c106="" class="handle-button theme-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wqx-c106="" class="handle-button copy-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wqx-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { drm } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.DrmKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">mediaKeySystem</span>: drm.<span class="hljs-property">MediaKeySystem</span> = drm.<span class="hljs-title function_">createMediaKeySystem</span>(<span class="hljs-string">"com.wiseplay.drm"</span>);</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">mediaKeySession</span>: drm.<span class="hljs-property">MediaKeySession</span> = mediaKeySystem.<span class="hljs-title function_">createMediaKeySession</span>();</li><li><span class="hljs-keyword">try</span> {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">keyStatus</span>: drm.<span class="hljs-property">MediaKeyStatus</span>[] =  mediaKeySession.<span class="hljs-title function_">checkMediaKeyStatus</span>();</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>  <span class="hljs-keyword">let</span> error = err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>;</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`checkMediaKeyStatus ERROR: <span class="hljs-subst">${error}</span>`</span>);</li><li>}</li></ol></pre></div></div> </div>  <div class="tiledSection"><h2 id="clearmediakeys" device-type="phone,2in1,tablet,wearable">clearMediaKeys<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="clearmediakeys" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">Wearable</span></div><p>clearMediaKeys(): void</p> <p>清除当前媒体密钥。</p> <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong> SystemCapability.Multimedia.Drm.Core</p> <p><strong>错误码：</strong></p> <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-drm">DRM错误码</a>。</p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.7.8.1.3.1.1" width="50%">错误码ID</th> <th align="left" class="cellrowborder" id="mcps1.3.7.8.1.3.1.2" width="50%">错误信息</th> </tr><tr><td class="cellrowborder" width="50%">24700101</td> <td class="cellrowborder" width="50%">All unknown errors</td> </tr> <tr><td class="cellrowborder" width="50%">24700201</td> <td class="cellrowborder" width="50%">Fatal service error, for example, service died</td> </tr>  </tbody></table></div> </div> <p><strong>示例：</strong></p> <div _ngcontent-wqx-c106="" class="highlight-div"><div _ngcontent-wqx-c106="" class="highlight-div-header"><div _ngcontent-wqx-c106="" class="highlight-div-header-left"><div _ngcontent-wqx-c106="" class="handle-button expand-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wqx-c106="" class="highlight-div-header-right"><div _ngcontent-wqx-c106="" class="handle-button ai-button"></div><div _ngcontent-wqx-c106="" class="handle-button line-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wqx-c106="" class="handle-button theme-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wqx-c106="" class="handle-button copy-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wqx-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { drm } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.DrmKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">mediaKeySystem</span>: drm.<span class="hljs-property">MediaKeySystem</span> = drm.<span class="hljs-title function_">createMediaKeySystem</span>(<span class="hljs-string">"com.wiseplay.drm"</span>);</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">mediaKeySession</span>: drm.<span class="hljs-property">MediaKeySession</span> = mediaKeySystem.<span class="hljs-title function_">createMediaKeySession</span>();</li><li><span class="hljs-comment">// mediaKeyResponse是从DRM服务获取的媒体密钥响应，按实际值填入。</span></li><li><span class="hljs-keyword">let</span> mediaKeyResponse = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>([<span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>]);</li><li>mediaKeySession.<span class="hljs-title function_">processMediaKeyResponse</span>(mediaKeyResponse).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">mediaKeyId: <span class="hljs-built_in">Uint8Array</span></span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'processMediaKeyResponse:'</span> + mediaKeyId);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`processMediaKeyResponse: ERROR: <span class="hljs-subst">${err}</span>`</span>);</li><li>});</li><li><span class="hljs-keyword">try</span> {</li><li>  mediaKeySession.<span class="hljs-title function_">clearMediaKeys</span>();</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>  <span class="hljs-keyword">let</span> error = err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>;</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`clearMediaKeys ERROR: <span class="hljs-subst">${error}</span>`</span>);</li><li>}</li></ol></pre></div></div> </div>  <div class="tiledSection"><h2 id="generateofflinereleaserequest" device-type="phone,2in1,tablet,wearable">generateOfflineReleaseRequest<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="generateofflinereleaserequest" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">Wearable</span></div><p>generateOfflineReleaseRequest(mediaKeyId: Uint8Array): Promise&lt;Uint8Array&gt;</p> <p>生成离线媒体密钥释放请求。使用Promise异步回调。</p> <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong> SystemCapability.Multimedia.Drm.Core</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.8.7.1.5.1.1" width="25%">参数名</th> <th align="left" class="cellrowborder" id="mcps1.3.8.7.1.5.1.2" width="25%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.8.7.1.5.1.3" width="25%">必填</th> <th align="left" class="cellrowborder" id="mcps1.3.8.7.1.5.1.4" width="25%">说明</th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="25%">mediaKeyId</td> <td class="cellrowborder" width="25%">Uint8Array</td> <td class="cellrowborder" width="25%">是</td> <td class="cellrowborder" width="25%">离线媒体密钥标识。</td> </tr>  </tbody></table></div> </div> <p><strong>返回值：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.8.9.1.3.1.1" width="50%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.8.9.1.3.1.2" width="50%">说明</th> </tr><tr><td class="cellrowborder" width="50%">Promise&lt;Uint8Array&gt;</td> <td class="cellrowborder" width="50%">Promise对象，设备上的DRM解决方案支持离线媒体密钥释放处理，则返回离线媒体密钥释放请求。</td> </tr>  </tbody></table></div> </div> <p><strong>错误码：</strong></p> <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-drm">DRM错误码</a>。</p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.8.12.1.3.1.1" width="50%">错误码ID</th> <th align="left" class="cellrowborder" id="mcps1.3.8.12.1.3.1.2" width="50%">错误信息</th> </tr><tr><td class="cellrowborder" width="50%">401</td> <td class="cellrowborder" width="50%">The parameter check failed. Possibly because: 1.Mandatory parameters are left unspecified or too many parameters. 2.Incorrect parameter types. 3.Parameter verification failed.</td> </tr> <tr><td class="cellrowborder" width="50%">24700101</td> <td class="cellrowborder" width="50%">All unknown errors</td> </tr> <tr><td class="cellrowborder" width="50%">24700201</td> <td class="cellrowborder" width="50%">Fatal service error, for example, service died</td> </tr>  </tbody></table></div> </div> <p><strong>示例：</strong></p> <div _ngcontent-wqx-c106="" class="highlight-div"><div _ngcontent-wqx-c106="" class="highlight-div-header"><div _ngcontent-wqx-c106="" class="highlight-div-header-left"><div _ngcontent-wqx-c106="" class="handle-button expand-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wqx-c106="" class="highlight-div-header-right"><div _ngcontent-wqx-c106="" class="handle-button ai-button"></div><div _ngcontent-wqx-c106="" class="handle-button line-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wqx-c106="" class="handle-button theme-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wqx-c106="" class="handle-button copy-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wqx-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { drm } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.DrmKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">mediaKeySystem</span>: drm.<span class="hljs-property">MediaKeySystem</span> = drm.<span class="hljs-title function_">createMediaKeySystem</span>(<span class="hljs-string">"com.wiseplay.drm"</span>);</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">mediaKeySession</span>: drm.<span class="hljs-property">MediaKeySession</span> = mediaKeySystem.<span class="hljs-title function_">createMediaKeySession</span>();</li><li><span class="hljs-comment">// mediaKeyId是processMediaKeyResponse或getOfflineMediaKeyIds接口返回的媒体密钥标识，请按实际值传入。</span></li><li><span class="hljs-keyword">let</span> mediaKeyId = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>([<span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>]);</li><li>mediaKeySession.<span class="hljs-title function_">generateOfflineReleaseRequest</span>(mediaKeyId).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">offlineReleaseRequest: <span class="hljs-built_in">Uint8Array</span></span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'generateOfflineReleaseRequest:'</span> + offlineReleaseRequest);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`generateOfflineReleaseRequest: ERROR: <span class="hljs-subst">${err}</span>`</span>);</li><li>});</li></ol></pre></div></div> </div>  <div class="tiledSection"><h2 id="processofflinereleaseresponse" device-type="phone,2in1,tablet,wearable">processOfflineReleaseResponse<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="processofflinereleaseresponse" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">Wearable</span></div><p>processOfflineReleaseResponse(mediaKeyId: Uint8Array, response: Uint8Array): Promise&lt;void&gt;</p> <p>处理离线媒体密钥释放响应。使用Promise异步回调。</p> <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong> SystemCapability.Multimedia.Drm.Core</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.9.7.1.5.1.1" width="25%">参数名</th> <th align="left" class="cellrowborder" id="mcps1.3.9.7.1.5.1.2" width="25%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.9.7.1.5.1.3" width="25%">必填</th> <th align="left" class="cellrowborder" id="mcps1.3.9.7.1.5.1.4" width="25%">说明</th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="25%">mediaKeyId</td> <td class="cellrowborder" width="25%">Uint8Array</td> <td class="cellrowborder" width="25%">是</td> <td class="cellrowborder" width="25%">离线媒体密钥标识。</td> </tr> <tr><td class="cellrowborder" width="25%">response</td> <td class="cellrowborder" width="25%">Uint8Array</td> <td class="cellrowborder" width="25%">是</td> <td class="cellrowborder" width="25%">离线媒体密钥释放响应。</td> </tr>  </tbody></table></div> </div> <p><strong>返回值：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.9.9.1.3.1.1" width="50%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.9.9.1.3.1.2" width="50%">说明</th> </tr><tr><td class="cellrowborder" width="50%">Promise&lt;void&gt;</td> <td class="cellrowborder" width="50%">Promise对象，设备上的DRM解决方案支持离线媒体密钥释放处理，则返回。</td> </tr>  </tbody></table></div> </div> <p><strong>错误码：</strong></p> <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-drm">DRM错误码</a>。</p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.9.12.1.3.1.1" width="50%">错误码ID</th> <th align="left" class="cellrowborder" id="mcps1.3.9.12.1.3.1.2" width="50%">错误信息</th> </tr><tr><td class="cellrowborder" width="50%">401</td> <td class="cellrowborder" width="50%">The parameter check failed. Possibly because: 1.Mandatory parameters are left unspecified or too many parameters. 2.Incorrect parameter types. 3.Parameter verification failed.</td> </tr> <tr><td class="cellrowborder" width="50%">24700101</td> <td class="cellrowborder" width="50%">All unknown errors</td> </tr> <tr><td class="cellrowborder" width="50%">24700201</td> <td class="cellrowborder" width="50%">Fatal service error, for example, service died</td> </tr>  </tbody></table></div> </div> <p><strong>示例：</strong></p> <div _ngcontent-wqx-c106="" class="highlight-div"><div _ngcontent-wqx-c106="" class="highlight-div-header"><div _ngcontent-wqx-c106="" class="highlight-div-header-left"><div _ngcontent-wqx-c106="" class="handle-button expand-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wqx-c106="" class="highlight-div-header-right"><div _ngcontent-wqx-c106="" class="handle-button ai-button"></div><div _ngcontent-wqx-c106="" class="handle-button line-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wqx-c106="" class="handle-button theme-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wqx-c106="" class="handle-button copy-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wqx-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { drm } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.DrmKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">mediaKeySystem</span>: drm.<span class="hljs-property">MediaKeySystem</span> = drm.<span class="hljs-title function_">createMediaKeySystem</span>(<span class="hljs-string">"com.wiseplay.drm"</span>);</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">mediaKeySession</span>: drm.<span class="hljs-property">MediaKeySession</span> = mediaKeySystem.<span class="hljs-title function_">createMediaKeySession</span>();</li><li><span class="hljs-comment">// mediaKeyId是processMediaKeyResponse或getOfflineMediaKeyIds接口返回的媒体密钥标识，请按实际长度申请内存。</span></li><li><span class="hljs-keyword">let</span> mediaKeyId = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>([<span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>]);</li><li>mediaKeySession.<span class="hljs-title function_">generateOfflineReleaseRequest</span>(mediaKeyId).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">offlineReleaseRequest: <span class="hljs-built_in">Uint8Array</span></span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'generateOfflineReleaseRequest:'</span> + offlineReleaseRequest);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`generateOfflineReleaseRequest: ERROR: <span class="hljs-subst">${err}</span>`</span>);</li><li>});</li><li><span class="hljs-comment">// offlineReleaseResponse是从DRM服务获取的离线媒体密钥释放响应，请按实际长度申请内存。</span></li><li><span class="hljs-keyword">let</span> offlineReleaseResponse = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>([<span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>]);</li><li>mediaKeySession.<span class="hljs-title function_">processOfflineReleaseResponse</span>(mediaKeyId, offlineReleaseResponse).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'processOfflineReleaseResponse'</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`processOfflineReleaseResponse: ERROR: <span class="hljs-subst">${err}</span>`</span>);</li><li>});</li></ol></pre></div></div> </div>  <div class="tiledSection"><h2 id="restoreofflinemediakeys" device-type="phone,2in1,tablet,wearable">restoreOfflineMediaKeys<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="restoreofflinemediakeys" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">Wearable</span></div><p>restoreOfflineMediaKeys(mediaKeyId: Uint8Array): Promise&lt;void&gt;</p> <p>恢复离线媒体密钥。使用Promise异步回调。</p> <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong> SystemCapability.Multimedia.Drm.Core</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.10.7.1.5.1.1" width="25%">参数名</th> <th align="left" class="cellrowborder" id="mcps1.3.10.7.1.5.1.2" width="25%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.10.7.1.5.1.3" width="25%">必填</th> <th align="left" class="cellrowborder" id="mcps1.3.10.7.1.5.1.4" width="25%">说明</th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="25%">mediaKeyId</td> <td class="cellrowborder" width="25%">Uint8Array</td> <td class="cellrowborder" width="25%">是</td> <td class="cellrowborder" width="25%">离线媒体密钥标识。</td> </tr>  </tbody></table></div> </div> <p><strong>返回值：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.10.9.1.3.1.1" width="50%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.10.9.1.3.1.2" width="50%">说明</th> </tr><tr><td class="cellrowborder" width="50%">Promise&lt;void&gt;</td> <td class="cellrowborder" width="50%">Promise对象。</td> </tr>  </tbody></table></div> </div> <p><strong>错误码：</strong></p> <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-drm">DRM错误码</a>。</p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.10.12.1.3.1.1" width="50%">错误码ID</th> <th align="left" class="cellrowborder" id="mcps1.3.10.12.1.3.1.2" width="50%">错误信息</th> </tr><tr><td class="cellrowborder" width="50%">401</td> <td class="cellrowborder" width="50%">The parameter check failed. Possibly because: 1.Mandatory parameters are left unspecified or too many parameters. 2.Incorrect parameter types. 3.Parameter verification failed.</td> </tr> <tr><td class="cellrowborder" width="50%">24700101</td> <td class="cellrowborder" width="50%">All unknown errors</td> </tr> <tr><td class="cellrowborder" width="50%">24700201</td> <td class="cellrowborder" width="50%">Fatal service error, for example, service died</td> </tr>  </tbody></table></div> </div> <p><strong>示例：</strong></p> <div _ngcontent-wqx-c106="" class="highlight-div"><div _ngcontent-wqx-c106="" class="highlight-div-header"><div _ngcontent-wqx-c106="" class="highlight-div-header-left"><div _ngcontent-wqx-c106="" class="handle-button expand-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wqx-c106="" class="highlight-div-header-right"><div _ngcontent-wqx-c106="" class="handle-button ai-button"></div><div _ngcontent-wqx-c106="" class="handle-button line-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wqx-c106="" class="handle-button theme-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wqx-c106="" class="handle-button copy-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wqx-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { drm } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.DrmKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">mediaKeySystem</span>: drm.<span class="hljs-property">MediaKeySystem</span> = drm.<span class="hljs-title function_">createMediaKeySystem</span>(<span class="hljs-string">"com.wiseplay.drm"</span>);</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">mediaKeySession</span>: drm.<span class="hljs-property">MediaKeySession</span> = mediaKeySystem.<span class="hljs-title function_">createMediaKeySession</span>();</li><li><span class="hljs-comment">// mediaKeyId是processMediaKeyResponse或getOfflineMediaKeyIds接口返回的媒体密钥标识，请按实际数据传入。</span></li><li><span class="hljs-keyword">let</span> mediaKeyId = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>([<span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>]);</li><li>mediaKeySession.<span class="hljs-title function_">restoreOfflineMediaKeys</span>(mediaKeyId).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"restoreOfflineMediaKeys"</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`restoreOfflineMediaKeys: ERROR: <span class="hljs-subst">${err}</span>`</span>);</li><li>});</li></ol></pre></div></div> </div>  <div class="tiledSection"><h2 id="getcontentprotectionlevel" device-type="phone,2in1,tablet,wearable">getContentProtectionLevel<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getcontentprotectionlevel" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">Wearable</span></div><p>getContentProtectionLevel(): ContentProtectionLevel</p> <p>获取当前会话的内容保护级别。</p> <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong> SystemCapability.Multimedia.Drm.Core</p> <p><strong>返回值：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.11.7.1.3.1.1" width="50%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.11.7.1.3.1.2" width="50%">说明</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-drm-e#contentprotectionlevel">ContentProtectionLevel</a></td> <td class="cellrowborder" width="50%">返回当前会话内容保护级别。</td> </tr>  </tbody></table></div> </div> <p><strong>错误码：</strong></p> <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-drm">DRM错误码</a>。</p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.11.10.1.3.1.1" width="50%">错误码ID</th> <th align="left" class="cellrowborder" id="mcps1.3.11.10.1.3.1.2" width="50%">错误信息</th> </tr><tr><td class="cellrowborder" width="50%">24700101</td> <td class="cellrowborder" width="50%">All unknown errors</td> </tr> <tr><td class="cellrowborder" width="50%">24700201</td> <td class="cellrowborder" width="50%">Fatal service error, for example, service died</td> </tr>  </tbody></table></div> </div> <p><strong>示例：</strong></p> <div _ngcontent-wqx-c106="" class="highlight-div"><div _ngcontent-wqx-c106="" class="highlight-div-header"><div _ngcontent-wqx-c106="" class="highlight-div-header-left"><div _ngcontent-wqx-c106="" class="handle-button expand-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wqx-c106="" class="highlight-div-header-right"><div _ngcontent-wqx-c106="" class="handle-button ai-button"></div><div _ngcontent-wqx-c106="" class="handle-button line-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wqx-c106="" class="handle-button theme-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wqx-c106="" class="handle-button copy-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wqx-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { drm } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.DrmKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">mediaKeySystem</span>: drm.<span class="hljs-property">MediaKeySystem</span> = drm.<span class="hljs-title function_">createMediaKeySystem</span>(<span class="hljs-string">"com.wiseplay.drm"</span>);</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">mediaKeySession</span>: drm.<span class="hljs-property">MediaKeySession</span> = mediaKeySystem.<span class="hljs-title function_">createMediaKeySession</span>();</li><li><span class="hljs-keyword">try</span> {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">contentProtectionLevel</span>: drm.<span class="hljs-property">ContentProtectionLevel</span> = mediaKeySession.<span class="hljs-title function_">getContentProtectionLevel</span>();</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>  <span class="hljs-keyword">let</span> error = err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>;</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`getContentProtectionLevel ERROR: <span class="hljs-subst">${error}</span>`</span>);</li><li>}</li></ol></pre></div></div> </div>  <div class="tiledSection"><h2 id="requiresecuredecodermodule" device-type="phone,2in1,tablet,wearable">requireSecureDecoderModule<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="requiresecuredecodermodule" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">Wearable</span></div><p>requireSecureDecoderModule(mimeType: string): boolean</p> <p>是否需要安全解码。</p> <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong> SystemCapability.Multimedia.Drm.Core</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.12.7.1.5.1.1" width="25%">参数名</th> <th align="left" class="cellrowborder" id="mcps1.3.12.7.1.5.1.2" width="25%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.12.7.1.5.1.3" width="25%">必填</th> <th align="left" class="cellrowborder" id="mcps1.3.12.7.1.5.1.4" width="25%">说明</th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="25%">mimeType</td> <td class="cellrowborder" width="25%">string</td> <td class="cellrowborder" width="25%">是</td> <td class="cellrowborder" width="25%">媒体类型，支持的媒体类型取决于DRM解决方案，可通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-drm-f#drmismediakeysystemsupported-1">isMediaKeySystemSupported</a>查询。</td> </tr>  </tbody></table></div> </div> <p><strong>返回值：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.12.9.1.3.1.1" width="50%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.12.9.1.3.1.2" width="50%">说明</th> </tr><tr><td class="cellrowborder" width="50%">boolean</td> <td class="cellrowborder" width="50%">是否需要安全解码，true表示需要安全解码，false表示不需要安全解码。</td> </tr>  </tbody></table></div> </div> <p><strong>错误码：</strong></p> <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-drm">DRM错误码</a>。</p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.12.12.1.3.1.1" width="50%">错误码ID</th> <th align="left" class="cellrowborder" id="mcps1.3.12.12.1.3.1.2" width="50%">错误信息</th> </tr><tr><td class="cellrowborder" width="50%">401</td> <td class="cellrowborder" width="50%">The parameter check failed. Possibly because: 1.Mandatory parameters are left unspecified or too many parameters. 2.Incorrect parameter types. 3.Parameter verification failed.</td> </tr> <tr><td class="cellrowborder" width="50%">24700101</td> <td class="cellrowborder" width="50%">All unknown errors</td> </tr> <tr><td class="cellrowborder" width="50%">24700201</td> <td class="cellrowborder" width="50%">Fatal service error, for example, service died</td> </tr>  </tbody></table></div> </div> <p><strong>示例：</strong></p> <div _ngcontent-wqx-c106="" class="highlight-div"><div _ngcontent-wqx-c106="" class="highlight-div-header"><div _ngcontent-wqx-c106="" class="highlight-div-header-left"><div _ngcontent-wqx-c106="" class="handle-button expand-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wqx-c106="" class="highlight-div-header-right"><div _ngcontent-wqx-c106="" class="handle-button ai-button"></div><div _ngcontent-wqx-c106="" class="handle-button line-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wqx-c106="" class="handle-button theme-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wqx-c106="" class="handle-button copy-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wqx-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { drm } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.DrmKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">mediaKeySystem</span>: drm.<span class="hljs-property">MediaKeySystem</span> = drm.<span class="hljs-title function_">createMediaKeySystem</span>(<span class="hljs-string">"com.wiseplay.drm"</span>);</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">mediaKeySession</span>: drm.<span class="hljs-property">MediaKeySession</span> = mediaKeySystem.<span class="hljs-title function_">createMediaKeySession</span>();</li><li><span class="hljs-keyword">try</span> {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">status</span>: <span class="hljs-built_in">boolean</span> = mediaKeySession.requireSecureDecoderModule(<span class="hljs-string">"video/avc"</span>);</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>  <span class="hljs-keyword">let</span> error = err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>;</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`requireSecureDecoderModule ERROR: <span class="hljs-subst">${error}</span>`</span>);</li><li>}</li></ol></pre></div></div> </div>  <div class="tiledSection"><h2 id="onkeyrequired" device-type="phone,2in1,tablet,wearable">on('keyRequired')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onkeyrequired" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">Wearable</span></div><p>on(type: 'keyRequired', callback: (eventInfo: EventInfo) =&gt; void): void</p> <p>监听密钥请求事件。使用callback异步回调。</p> <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong> SystemCapability.Multimedia.Drm.Core</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.13.7.1.5.1.1" width="25%">参数名</th> <th align="left" class="cellrowborder" id="mcps1.3.13.7.1.5.1.2" width="25%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.13.7.1.5.1.3" width="25%">必填</th> <th align="left" class="cellrowborder" id="mcps1.3.13.7.1.5.1.4" width="25%">说明</th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="25%">type</td> <td class="cellrowborder" width="25%">string</td> <td class="cellrowborder" width="25%">是</td> <td class="cellrowborder" width="25%">事件类型，固定为'keyRequired'，当播放DRM节目需要获取媒体密钥时触发。</td> </tr> <tr><td class="cellrowborder" width="25%">callback</td> <td class="cellrowborder" width="25%">(eventInfo: <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-drm-i#eventinfo">EventInfo</a>) =&gt; void</td> <td class="cellrowborder" width="25%">是</td> <td class="cellrowborder" width="25%">回调函数，返回事件信息。</td> </tr>  </tbody></table></div> </div> <p><strong>错误码：</strong></p> <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-drm">DRM错误码</a>。</p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.13.10.1.3.1.1" width="50%">错误码ID</th> <th align="left" class="cellrowborder" id="mcps1.3.13.10.1.3.1.2" width="50%">错误信息</th> </tr><tr><td class="cellrowborder" width="50%">401</td> <td class="cellrowborder" width="50%">The parameter check failed. Possibly because: 1.Mandatory parameters are left unspecified or too many parameters. 2.Incorrect parameter types. 3.Parameter verification failed.</td> </tr> <tr><td class="cellrowborder" width="50%">24700101</td> <td class="cellrowborder" width="50%">All unknown errors</td> </tr>  </tbody></table></div> </div> <p><strong>示例：</strong></p> <div _ngcontent-wqx-c106="" class="highlight-div"><div _ngcontent-wqx-c106="" class="highlight-div-header"><div _ngcontent-wqx-c106="" class="highlight-div-header-left"><div _ngcontent-wqx-c106="" class="handle-button expand-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wqx-c106="" class="highlight-div-header-right"><div _ngcontent-wqx-c106="" class="handle-button ai-button"></div><div _ngcontent-wqx-c106="" class="handle-button line-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wqx-c106="" class="handle-button theme-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wqx-c106="" class="handle-button copy-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wqx-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { drm } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.DrmKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">mediaKeySystem</span>: drm.<span class="hljs-property">MediaKeySystem</span> = drm.<span class="hljs-title function_">createMediaKeySystem</span>(<span class="hljs-string">"com.wiseplay.drm"</span>);</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">mediaKeySession</span>: drm.<span class="hljs-property">MediaKeySession</span> = mediaKeySystem.<span class="hljs-title function_">createMediaKeySession</span>();</li><li>mediaKeySession.<span class="hljs-title function_">on</span>(<span class="hljs-string">'keyRequired'</span>, <span class="hljs-function">(<span class="hljs-params">eventInfo: drm.EventInfo</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'keyRequired '</span> + <span class="hljs-string">'extra: '</span> + eventInfo.<span class="hljs-property">extraInfo</span> + <span class="hljs-string">'data: '</span> + eventInfo.<span class="hljs-property">info</span>);</li><li>});</li></ol></pre></div></div> </div>  <div class="tiledSection"><h2 id="offkeyrequired" device-type="phone,2in1,tablet,wearable">off('keyRequired')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="offkeyrequired" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">Wearable</span></div><p>off(type: 'keyRequired', callback?: (eventInfo: EventInfo) =&gt; void): void</p> <p>注销密钥请求事件监听。使用callback异步回调。</p> <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong> SystemCapability.Multimedia.Drm.Core</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.14.7.1.5.1.1" width="25%">参数名</th> <th align="left" class="cellrowborder" id="mcps1.3.14.7.1.5.1.2" width="25%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.14.7.1.5.1.3" width="25%">必填</th> <th align="left" class="cellrowborder" id="mcps1.3.14.7.1.5.1.4" width="25%">说明</th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="25%">type</td> <td class="cellrowborder" width="25%">string</td> <td class="cellrowborder" width="25%">是</td> <td class="cellrowborder" width="25%">监听事件类型，固定为'keyRequired'。</td> </tr> <tr><td class="cellrowborder" width="25%">callback</td> <td class="cellrowborder" width="25%">(eventInfo: <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-drm-i#eventinfo">EventInfo</a>) =&gt; void</td> <td class="cellrowborder" width="25%">否</td> <td class="cellrowborder" width="25%">回调函数，返回事件信息。可选。</td> </tr>  </tbody></table></div> </div> <p><strong>错误码：</strong></p> <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-drm">DRM错误码</a>。</p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.14.10.1.3.1.1" width="50%">错误码ID</th> <th align="left" class="cellrowborder" id="mcps1.3.14.10.1.3.1.2" width="50%">错误信息</th> </tr><tr><td class="cellrowborder" width="50%">401</td> <td class="cellrowborder" width="50%">The parameter check failed. Possibly because: 1.Mandatory parameters are left unspecified or too many parameters. 2.Incorrect parameter types. 3.Parameter verification failed.</td> </tr> <tr><td class="cellrowborder" width="50%">24700101</td> <td class="cellrowborder" width="50%">All unknown errors</td> </tr>  </tbody></table></div> </div> <p><strong>示例：</strong></p> <div _ngcontent-wqx-c106="" class="highlight-div"><div _ngcontent-wqx-c106="" class="highlight-div-header"><div _ngcontent-wqx-c106="" class="highlight-div-header-left"><div _ngcontent-wqx-c106="" class="handle-button expand-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wqx-c106="" class="highlight-div-header-right"><div _ngcontent-wqx-c106="" class="handle-button ai-button"></div><div _ngcontent-wqx-c106="" class="handle-button line-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wqx-c106="" class="handle-button theme-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wqx-c106="" class="handle-button copy-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wqx-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { drm } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.DrmKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">mediaKeySystem</span>: drm.<span class="hljs-property">MediaKeySystem</span> = drm.<span class="hljs-title function_">createMediaKeySystem</span>(<span class="hljs-string">"com.wiseplay.drm"</span>);</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">mediaKeySession</span>: drm.<span class="hljs-property">MediaKeySession</span> = mediaKeySystem.<span class="hljs-title function_">createMediaKeySession</span>();</li><li>mediaKeySession.<span class="hljs-title function_">off</span>(<span class="hljs-string">'keyRequired'</span>);</li></ol></pre></div></div> </div>  <div class="tiledSection"><h2 id="onkeyexpired" device-type="phone,2in1,tablet,wearable">on('keyExpired')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onkeyexpired" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">Wearable</span></div><p>on(type: 'keyExpired', callback: (eventInfo: EventInfo) =&gt; void): void</p> <p>监听密钥过期事件。使用callback异步回调。</p> <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong> SystemCapability.Multimedia.Drm.Core</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.15.7.1.5.1.1" width="25%">参数名</th> <th align="left" class="cellrowborder" id="mcps1.3.15.7.1.5.1.2" width="25%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.15.7.1.5.1.3" width="25%">必填</th> <th align="left" class="cellrowborder" id="mcps1.3.15.7.1.5.1.4" width="25%">说明</th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="25%">type</td> <td class="cellrowborder" width="25%">string</td> <td class="cellrowborder" width="25%">是</td> <td class="cellrowborder" width="25%">监听事件类型，固定为'keyExpired'。密钥过期时触发。</td> </tr> <tr><td class="cellrowborder" width="25%">callback</td> <td class="cellrowborder" width="25%">(eventInfo: <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-drm-i#eventinfo">EventInfo</a>) =&gt; void</td> <td class="cellrowborder" width="25%">是</td> <td class="cellrowborder" width="25%">回调函数，返回事件信息。</td> </tr>  </tbody></table></div> </div> <p><strong>错误码：</strong></p> <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-drm">DRM错误码</a>。</p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.15.10.1.3.1.1" width="50%">错误码ID</th> <th align="left" class="cellrowborder" id="mcps1.3.15.10.1.3.1.2" width="50%">错误信息</th> </tr><tr><td class="cellrowborder" width="50%">401</td> <td class="cellrowborder" width="50%">The parameter check failed. Possibly because: 1.Mandatory parameters are left unspecified or too many parameters. 2.Incorrect parameter types. 3.Parameter verification failed.</td> </tr> <tr><td class="cellrowborder" width="50%">24700101</td> <td class="cellrowborder" width="50%">All unknown errors</td> </tr>  </tbody></table></div> </div> <p><strong>示例：</strong></p> <div _ngcontent-wqx-c106="" class="highlight-div"><div _ngcontent-wqx-c106="" class="highlight-div-header"><div _ngcontent-wqx-c106="" class="highlight-div-header-left"><div _ngcontent-wqx-c106="" class="handle-button expand-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wqx-c106="" class="highlight-div-header-right"><div _ngcontent-wqx-c106="" class="handle-button ai-button"></div><div _ngcontent-wqx-c106="" class="handle-button line-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wqx-c106="" class="handle-button theme-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wqx-c106="" class="handle-button copy-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wqx-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { drm } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.DrmKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">mediaKeySystem</span>: drm.<span class="hljs-property">MediaKeySystem</span> = drm.<span class="hljs-title function_">createMediaKeySystem</span>(<span class="hljs-string">"com.wiseplay.drm"</span>);</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">mediaKeySession</span>: drm.<span class="hljs-property">MediaKeySession</span> = mediaKeySystem.<span class="hljs-title function_">createMediaKeySession</span>();</li><li>mediaKeySession.<span class="hljs-title function_">on</span>(<span class="hljs-string">'keyExpired'</span>, <span class="hljs-function">(<span class="hljs-params">eventInfo: drm.EventInfo</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'keyExpired '</span> + <span class="hljs-string">'extra: '</span> + eventInfo.<span class="hljs-property">extraInfo</span> + <span class="hljs-string">'data: '</span> + eventInfo.<span class="hljs-property">info</span>);</li><li>});</li></ol></pre></div></div> </div>  <div class="tiledSection"><h2 id="offkeyexpired" device-type="phone,2in1,tablet,wearable">off('keyExpired')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="offkeyexpired" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">Wearable</span></div><p>off(type: 'keyExpired', callback?: (eventInfo: EventInfo) =&gt; void): void</p> <p>注销密钥过期事件监听。使用callback异步回调。</p> <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong> SystemCapability.Multimedia.Drm.Core</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.16.7.1.5.1.1" width="25%">参数名</th> <th align="left" class="cellrowborder" id="mcps1.3.16.7.1.5.1.2" width="25%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.16.7.1.5.1.3" width="25%">必填</th> <th align="left" class="cellrowborder" id="mcps1.3.16.7.1.5.1.4" width="25%">说明</th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="25%">type</td> <td class="cellrowborder" width="25%">string</td> <td class="cellrowborder" width="25%">是</td> <td class="cellrowborder" width="25%">监听事件类型，固定为'keyExpired'。</td> </tr> <tr><td class="cellrowborder" width="25%">callback</td> <td class="cellrowborder" width="25%">(eventInfo: <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-drm-i#eventinfo">EventInfo</a>) =&gt; void</td> <td class="cellrowborder" width="25%">否</td> <td class="cellrowborder" width="25%">回调函数，返回事件信息。可选。</td> </tr>  </tbody></table></div> </div> <p><strong>错误码：</strong></p> <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-drm">DRM错误码</a>。</p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.16.10.1.3.1.1" width="50%">错误码ID</th> <th align="left" class="cellrowborder" id="mcps1.3.16.10.1.3.1.2" width="50%">错误信息</th> </tr><tr><td class="cellrowborder" width="50%">401</td> <td class="cellrowborder" width="50%">The parameter check failed. Possibly because: 1.Mandatory parameters are left unspecified or too many parameters. 2.Incorrect parameter types. 3.Parameter verification failed.</td> </tr> <tr><td class="cellrowborder" width="50%">24700101</td> <td class="cellrowborder" width="50%">All unknown errors</td> </tr>  </tbody></table></div> </div> <p><strong>示例：</strong></p> <div _ngcontent-wqx-c106="" class="highlight-div"><div _ngcontent-wqx-c106="" class="highlight-div-header"><div _ngcontent-wqx-c106="" class="highlight-div-header-left"><div _ngcontent-wqx-c106="" class="handle-button expand-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wqx-c106="" class="highlight-div-header-right"><div _ngcontent-wqx-c106="" class="handle-button ai-button"></div><div _ngcontent-wqx-c106="" class="handle-button line-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wqx-c106="" class="handle-button theme-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wqx-c106="" class="handle-button copy-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wqx-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { drm } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.DrmKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">mediaKeySystem</span>: drm.<span class="hljs-property">MediaKeySystem</span> = drm.<span class="hljs-title function_">createMediaKeySystem</span>(<span class="hljs-string">"com.wiseplay.drm"</span>);</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">mediaKeySession</span>: drm.<span class="hljs-property">MediaKeySession</span> = mediaKeySystem.<span class="hljs-title function_">createMediaKeySession</span>();</li><li>mediaKeySession.<span class="hljs-title function_">off</span>(<span class="hljs-string">'keyExpired'</span>);</li></ol></pre></div></div> </div>  <div class="tiledSection"><h2 id="onvendordefined" device-type="phone,2in1,tablet,wearable">on('vendorDefined')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onvendordefined" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">Wearable</span></div><p>on(type: 'vendorDefined', callback: (eventInfo: EventInfo) =&gt; void): void</p> <p>监听DRM解决方案自定义事件。使用callback异步回调。</p> <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong> SystemCapability.Multimedia.Drm.Core</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.17.7.1.5.1.1" width="25%">参数名</th> <th align="left" class="cellrowborder" id="mcps1.3.17.7.1.5.1.2" width="25%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.17.7.1.5.1.3" width="25%">必填</th> <th align="left" class="cellrowborder" id="mcps1.3.17.7.1.5.1.4" width="25%">说明</th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="25%">type</td> <td class="cellrowborder" width="25%">string</td> <td class="cellrowborder" width="25%">是</td> <td class="cellrowborder" width="25%">监听事件，固定为'vendorDefined'。自定义事件发生时触发。</td> </tr> <tr><td class="cellrowborder" width="25%">callback</td> <td class="cellrowborder" width="25%">(eventInfo: <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-drm-i#eventinfo">EventInfo</a>) =&gt; void</td> <td class="cellrowborder" width="25%">是</td> <td class="cellrowborder" width="25%">回调函数，返回事件信息。</td> </tr>  </tbody></table></div> </div> <p><strong>错误码：</strong></p> <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-drm">DRM错误码</a>。</p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.17.10.1.3.1.1" width="50%">错误码ID</th> <th align="left" class="cellrowborder" id="mcps1.3.17.10.1.3.1.2" width="50%">错误信息</th> </tr><tr><td class="cellrowborder" width="50%">401</td> <td class="cellrowborder" width="50%">The parameter check failed. Possibly because: 1.Mandatory parameters are left unspecified or too many parameters. 2.Incorrect parameter types. 3.Parameter verification failed.</td> </tr> <tr><td class="cellrowborder" width="50%">24700101</td> <td class="cellrowborder" width="50%">All unknown errors</td> </tr>  </tbody></table></div> </div> <p><strong>示例：</strong></p> <div _ngcontent-wqx-c106="" class="highlight-div"><div _ngcontent-wqx-c106="" class="highlight-div-header"><div _ngcontent-wqx-c106="" class="highlight-div-header-left"><div _ngcontent-wqx-c106="" class="handle-button expand-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wqx-c106="" class="highlight-div-header-right"><div _ngcontent-wqx-c106="" class="handle-button ai-button"></div><div _ngcontent-wqx-c106="" class="handle-button line-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wqx-c106="" class="handle-button theme-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wqx-c106="" class="handle-button copy-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wqx-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { drm } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.DrmKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">mediaKeySystem</span>: drm.<span class="hljs-property">MediaKeySystem</span> = drm.<span class="hljs-title function_">createMediaKeySystem</span>(<span class="hljs-string">"com.wiseplay.drm"</span>);</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">mediaKeySession</span>: drm.<span class="hljs-property">MediaKeySession</span> = mediaKeySystem.<span class="hljs-title function_">createMediaKeySession</span>();</li><li>mediaKeySession.<span class="hljs-title function_">on</span>(<span class="hljs-string">'vendorDefined'</span>, <span class="hljs-function">(<span class="hljs-params">eventInfo: drm.EventInfo</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'vendorDefined '</span> + <span class="hljs-string">'extra: '</span> + eventInfo.<span class="hljs-property">extraInfo</span> + <span class="hljs-string">'data: '</span> + eventInfo.<span class="hljs-property">info</span>);</li><li>});</li></ol></pre></div></div> </div>  <div class="tiledSection"><h2 id="offvendordefined" device-type="phone,2in1,tablet,wearable">off('vendorDefined')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="offvendordefined" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">Wearable</span></div><p>off(type: 'vendorDefined', callback?: (eventInfo: EventInfo) =&gt; void): void</p> <p>注销DRM解决方案自定义事件监听。使用callback异步回调。</p> <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong> SystemCapability.Multimedia.Drm.Core</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.18.7.1.5.1.1" width="25%">参数名</th> <th align="left" class="cellrowborder" id="mcps1.3.18.7.1.5.1.2" width="25%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.18.7.1.5.1.3" width="25%">必填</th> <th align="left" class="cellrowborder" id="mcps1.3.18.7.1.5.1.4" width="25%">说明</th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="25%">type</td> <td class="cellrowborder" width="25%">string</td> <td class="cellrowborder" width="25%">是</td> <td class="cellrowborder" width="25%">监听事件，固定为'vendorDefined'。</td> </tr> <tr><td class="cellrowborder" width="25%">callback</td> <td class="cellrowborder" width="25%">(eventInfo: <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-drm-i#eventinfo">EventInfo</a>) =&gt; void</td> <td class="cellrowborder" width="25%">否</td> <td class="cellrowborder" width="25%">回调函数，返回事件信息。可选。</td> </tr>  </tbody></table></div> </div> <p><strong>错误码：</strong></p> <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-drm">DRM错误码</a>。</p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.18.10.1.3.1.1" width="50%">错误码ID</th> <th align="left" class="cellrowborder" id="mcps1.3.18.10.1.3.1.2" width="50%">错误信息</th> </tr><tr><td class="cellrowborder" width="50%">401</td> <td class="cellrowborder" width="50%">The parameter check failed. Possibly because: 1.Mandatory parameters are left unspecified or too many parameters. 2.Incorrect parameter types. 3.Parameter verification failed.</td> </tr> <tr><td class="cellrowborder" width="50%">24700101</td> <td class="cellrowborder" width="50%">All unknown errors</td> </tr>  </tbody></table></div> </div> <p><strong>示例：</strong></p> <div _ngcontent-wqx-c106="" class="highlight-div"><div _ngcontent-wqx-c106="" class="highlight-div-header"><div _ngcontent-wqx-c106="" class="highlight-div-header-left"><div _ngcontent-wqx-c106="" class="handle-button expand-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wqx-c106="" class="highlight-div-header-right"><div _ngcontent-wqx-c106="" class="handle-button ai-button"></div><div _ngcontent-wqx-c106="" class="handle-button line-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wqx-c106="" class="handle-button theme-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wqx-c106="" class="handle-button copy-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wqx-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { drm } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.DrmKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">mediaKeySystem</span>: drm.<span class="hljs-property">MediaKeySystem</span> = drm.<span class="hljs-title function_">createMediaKeySystem</span>(<span class="hljs-string">"com.wiseplay.drm"</span>);</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">mediaKeySession</span>: drm.<span class="hljs-property">MediaKeySession</span> = mediaKeySystem.<span class="hljs-title function_">createMediaKeySession</span>();</li><li>mediaKeySession.<span class="hljs-title function_">off</span>(<span class="hljs-string">'vendorDefined'</span>);</li></ol></pre></div></div> </div>  <div class="tiledSection"><h2 id="onexpirationupdate" device-type="phone,2in1,tablet,wearable">on('expirationUpdate')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onexpirationupdate" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">Wearable</span></div><p>on(type: 'expirationUpdate', callback: (eventInfo: EventInfo) =&gt; void): void</p> <p>监听密钥过期更新事件。使用callback异步回调。</p> <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong> SystemCapability.Multimedia.Drm.Core</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.19.7.1.5.1.1" width="25%">参数名</th> <th align="left" class="cellrowborder" id="mcps1.3.19.7.1.5.1.2" width="25%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.19.7.1.5.1.3" width="25%">必填</th> <th align="left" class="cellrowborder" id="mcps1.3.19.7.1.5.1.4" width="25%">说明</th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="25%">type</td> <td class="cellrowborder" width="25%">string</td> <td class="cellrowborder" width="25%">是</td> <td class="cellrowborder" width="25%">监听事件类型，固定为'expirationUpdate'。密钥过期更新时触发。</td> </tr> <tr><td class="cellrowborder" width="25%">callback</td> <td class="cellrowborder" width="25%">(eventInfo: <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-drm-i#eventinfo">EventInfo</a>) =&gt; void</td> <td class="cellrowborder" width="25%">是</td> <td class="cellrowborder" width="25%">回调函数，返回事件信息。</td> </tr>  </tbody></table></div> </div> <p><strong>错误码：</strong></p> <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-drm">DRM错误码</a>。</p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.19.10.1.3.1.1" width="50%">错误码ID</th> <th align="left" class="cellrowborder" id="mcps1.3.19.10.1.3.1.2" width="50%">错误信息</th> </tr><tr><td class="cellrowborder" width="50%">401</td> <td class="cellrowborder" width="50%">The parameter check failed. Possibly because: 1.Mandatory parameters are left unspecified or too many parameters. 2.Incorrect parameter types. 3.Parameter verification failed.</td> </tr> <tr><td class="cellrowborder" width="50%">24700101</td> <td class="cellrowborder" width="50%">All unknown errors</td> </tr>  </tbody></table></div> </div> <p><strong>示例：</strong></p> <div _ngcontent-wqx-c106="" class="highlight-div"><div _ngcontent-wqx-c106="" class="highlight-div-header"><div _ngcontent-wqx-c106="" class="highlight-div-header-left"><div _ngcontent-wqx-c106="" class="handle-button expand-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wqx-c106="" class="highlight-div-header-right"><div _ngcontent-wqx-c106="" class="handle-button ai-button"></div><div _ngcontent-wqx-c106="" class="handle-button line-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wqx-c106="" class="handle-button theme-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wqx-c106="" class="handle-button copy-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wqx-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { drm } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.DrmKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">mediaKeySystem</span>: drm.<span class="hljs-property">MediaKeySystem</span> = drm.<span class="hljs-title function_">createMediaKeySystem</span>(<span class="hljs-string">"com.wiseplay.drm"</span>);</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">mediaKeySession</span>: drm.<span class="hljs-property">MediaKeySession</span> = mediaKeySystem.<span class="hljs-title function_">createMediaKeySession</span>();</li><li>mediaKeySession.<span class="hljs-title function_">on</span>(<span class="hljs-string">'expirationUpdate'</span>, <span class="hljs-function">(<span class="hljs-params">eventInfo: drm.EventInfo</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'expirationUpdate '</span> + <span class="hljs-string">'extra: '</span> + eventInfo.<span class="hljs-property">extraInfo</span> + <span class="hljs-string">'data: '</span> + eventInfo.<span class="hljs-property">info</span>);</li><li>});</li></ol></pre></div></div> </div>  <div class="tiledSection"><h2 id="offexpirationupdate" device-type="phone,2in1,tablet,wearable">off('expirationUpdate')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="offexpirationupdate" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">Wearable</span></div><p>off(type: 'expirationUpdate', callback?: (eventInfo: EventInfo) =&gt; void): void</p> <p>注销过期更新事件监听。使用callback异步回调。</p> <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong> SystemCapability.Multimedia.Drm.Core</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.20.7.1.5.1.1" width="25%">参数名</th> <th align="left" class="cellrowborder" id="mcps1.3.20.7.1.5.1.2" width="25%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.20.7.1.5.1.3" width="25%">必填</th> <th align="left" class="cellrowborder" id="mcps1.3.20.7.1.5.1.4" width="25%">说明</th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="25%">type</td> <td class="cellrowborder" width="25%">string</td> <td class="cellrowborder" width="25%">是</td> <td class="cellrowborder" width="25%">监听事件类型，固定为'expirationUpdate'。</td> </tr> <tr><td class="cellrowborder" width="25%">callback</td> <td class="cellrowborder" width="25%">(eventInfo: <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-drm-i#eventinfo">EventInfo</a>) =&gt; void</td> <td class="cellrowborder" width="25%">否</td> <td class="cellrowborder" width="25%">回调函数，返回事件信息。可选。</td> </tr>  </tbody></table></div> </div> <p><strong>错误码：</strong></p> <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-drm">DRM错误码</a>。</p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.20.10.1.3.1.1" width="50%">错误码ID</th> <th align="left" class="cellrowborder" id="mcps1.3.20.10.1.3.1.2" width="50%">错误信息</th> </tr><tr><td class="cellrowborder" width="50%">401</td> <td class="cellrowborder" width="50%">The parameter check failed. Possibly because: 1.Mandatory parameters are left unspecified or too many parameters. 2.Incorrect parameter types. 3.Parameter verification failed.</td> </tr> <tr><td class="cellrowborder" width="50%">24700101</td> <td class="cellrowborder" width="50%">All unknown errors</td> </tr>  </tbody></table></div> </div> <p><strong>示例：</strong></p> <div _ngcontent-wqx-c106="" class="highlight-div"><div _ngcontent-wqx-c106="" class="highlight-div-header"><div _ngcontent-wqx-c106="" class="highlight-div-header-left"><div _ngcontent-wqx-c106="" class="handle-button expand-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wqx-c106="" class="highlight-div-header-right"><div _ngcontent-wqx-c106="" class="handle-button ai-button"></div><div _ngcontent-wqx-c106="" class="handle-button line-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wqx-c106="" class="handle-button theme-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wqx-c106="" class="handle-button copy-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wqx-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { drm } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.DrmKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">mediaKeySystem</span>: drm.<span class="hljs-property">MediaKeySystem</span> = drm.<span class="hljs-title function_">createMediaKeySystem</span>(<span class="hljs-string">"com.wiseplay.drm"</span>);</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">mediaKeySession</span>: drm.<span class="hljs-property">MediaKeySession</span> = mediaKeySystem.<span class="hljs-title function_">createMediaKeySession</span>();</li><li>mediaKeySession.<span class="hljs-title function_">off</span>(<span class="hljs-string">'expirationUpdate'</span>);</li></ol></pre></div></div> </div>  <div class="tiledSection"><h2 id="onkeyschange" device-type="phone,2in1,tablet,wearable">on('keysChange')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onkeyschange" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">Wearable</span></div><p>on(type: 'keysChange', callback: (keyInfo: KeysInfo[], newKeyAvailable: boolean) =&gt; void): void</p> <p>监听密钥变化事件。使用callback异步回调。</p> <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong> SystemCapability.Multimedia.Drm.Core</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.21.7.1.5.1.1" width="25%">参数名</th> <th align="left" class="cellrowborder" id="mcps1.3.21.7.1.5.1.2" width="25%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.21.7.1.5.1.3" width="25%">必填</th> <th align="left" class="cellrowborder" id="mcps1.3.21.7.1.5.1.4" width="25%">说明</th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="25%">type</td> <td class="cellrowborder" width="25%">string</td> <td class="cellrowborder" width="25%">是</td> <td class="cellrowborder" width="25%">监听事件类型，固定为'keysChange'。密钥变化时触发。</td> </tr> <tr><td class="cellrowborder" width="25%">callback</td> <td class="cellrowborder" width="25%">(keyInfo: <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-drm-i#keysinfo">KeysInfo[]</a>, newKeyAvailable: boolean) =&gt; void</td> <td class="cellrowborder" width="25%">是</td> <td class="cellrowborder" width="25%">回调函数，返回事件信息，包含密钥标识和密钥状态描述的列表及密钥是否可用。</td> </tr>  </tbody></table></div> </div> <p><strong>错误码：</strong></p> <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-drm">DRM错误码</a>。</p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.21.10.1.3.1.1" width="50%">错误码ID</th> <th align="left" class="cellrowborder" id="mcps1.3.21.10.1.3.1.2" width="50%">错误信息</th> </tr><tr><td class="cellrowborder" width="50%">401</td> <td class="cellrowborder" width="50%">The parameter check failed. Possibly because: 1.Mandatory parameters are left unspecified or too many parameters. 2.Incorrect parameter types. 3.Parameter verification failed.</td> </tr> <tr><td class="cellrowborder" width="50%">24700101</td> <td class="cellrowborder" width="50%">All unknown errors</td> </tr>  </tbody></table></div> </div> <p><strong>示例：</strong></p> <div _ngcontent-wqx-c106="" class="highlight-div"><div _ngcontent-wqx-c106="" class="highlight-div-header"><div _ngcontent-wqx-c106="" class="highlight-div-header-left"><div _ngcontent-wqx-c106="" class="handle-button expand-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wqx-c106="" class="highlight-div-header-right"><div _ngcontent-wqx-c106="" class="handle-button ai-button"></div><div _ngcontent-wqx-c106="" class="handle-button line-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wqx-c106="" class="handle-button theme-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wqx-c106="" class="handle-button copy-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wqx-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { drm } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.DrmKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">mediaKeySystem</span>: drm.<span class="hljs-property">MediaKeySystem</span> = drm.<span class="hljs-title function_">createMediaKeySystem</span>(<span class="hljs-string">"com.wiseplay.drm"</span>);</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">mediaKeySession</span>: drm.<span class="hljs-property">MediaKeySession</span> = mediaKeySystem.<span class="hljs-title function_">createMediaKeySession</span>();</li><li>mediaKeySession.<span class="hljs-title function_">on</span>(<span class="hljs-string">'keysChange'</span>, <span class="hljs-function">(<span class="hljs-params">keyInfo: drm.KeysInfo[], newKeyAvailable: <span class="hljs-built_in">boolean</span></span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; keyInfo.<span class="hljs-property">length</span>; i++) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'keysChange'</span> + <span class="hljs-string">'keyId:'</span> + keyInfo[i].<span class="hljs-property">keyId</span> + <span class="hljs-string">' data:'</span> + keyInfo[i].<span class="hljs-property">value</span>);</li><li>  }</li><li>});</li></ol></pre></div></div> </div>  <div class="tiledSection"><h2 id="offkeyschange" device-type="phone,2in1,tablet,wearable">off('keysChange')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="offkeyschange" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">Wearable</span></div><p>off(type: 'keysChange', callback?: (keyInfo: KeysInfo[], newKeyAvailable: boolean) =&gt; void): void</p> <p>注销密钥变化事件监听。使用callback异步回调。</p> <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong> SystemCapability.Multimedia.Drm.Core</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.22.7.1.5.1.1" width="25%">参数名</th> <th align="left" class="cellrowborder" id="mcps1.3.22.7.1.5.1.2" width="25%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.22.7.1.5.1.3" width="25%">必填</th> <th align="left" class="cellrowborder" id="mcps1.3.22.7.1.5.1.4" width="25%">说明</th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="25%">type</td> <td class="cellrowborder" width="25%">string</td> <td class="cellrowborder" width="25%">是</td> <td class="cellrowborder" width="25%">监听事件类型，固定为'keysChange'。</td> </tr> <tr><td class="cellrowborder" width="25%">callback</td> <td class="cellrowborder" width="25%">(keyInfo: <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-drm-i#keysinfo">KeysInfo[]</a>, newKeyAvailable: boolean) =&gt; void</td> <td class="cellrowborder" width="25%">否</td> <td class="cellrowborder" width="25%">回调函数，返回事件信息，包含密钥标识和密钥状态描述的列表及密钥是否可用。</td> </tr>  </tbody></table></div> </div> <p><strong>错误码：</strong></p> <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-drm">DRM错误码</a>。</p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.22.10.1.3.1.1" width="50%">错误码ID</th> <th align="left" class="cellrowborder" id="mcps1.3.22.10.1.3.1.2" width="50%">错误信息</th> </tr><tr><td class="cellrowborder" width="50%">401</td> <td class="cellrowborder" width="50%">The parameter check failed. Possibly because: 1.Mandatory parameters are left unspecified or too many parameters. 2.Incorrect parameter types. 3.Parameter verification failed.</td> </tr> <tr><td class="cellrowborder" width="50%">24700101</td> <td class="cellrowborder" width="50%">All unknown errors</td> </tr>  </tbody></table></div> </div> <p><strong>示例：</strong></p> <div _ngcontent-wqx-c106="" class="highlight-div"><div _ngcontent-wqx-c106="" class="highlight-div-header"><div _ngcontent-wqx-c106="" class="highlight-div-header-left"><div _ngcontent-wqx-c106="" class="handle-button expand-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wqx-c106="" class="highlight-div-header-right"><div _ngcontent-wqx-c106="" class="handle-button ai-button"></div><div _ngcontent-wqx-c106="" class="handle-button line-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wqx-c106="" class="handle-button theme-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wqx-c106="" class="handle-button copy-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wqx-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { drm } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.DrmKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">mediaKeySystem</span>: drm.<span class="hljs-property">MediaKeySystem</span> = drm.<span class="hljs-title function_">createMediaKeySystem</span>(<span class="hljs-string">"com.wiseplay.drm"</span>);</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">mediaKeySession</span>: drm.<span class="hljs-property">MediaKeySession</span> = mediaKeySystem.<span class="hljs-title function_">createMediaKeySession</span>();</li><li>mediaKeySession.<span class="hljs-title function_">off</span>(<span class="hljs-string">'keysChange'</span>);</li></ol></pre></div></div> </div>  <div class="tiledSection"><h2 id="destroy" device-type="phone,2in1,tablet,wearable">destroy<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="destroy" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">Wearable</span></div><p>destroy(): void</p> <p>销毁MediaKeySession实例。</p> <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong> SystemCapability.Multimedia.Drm.Core</p> <p><strong>错误码：</strong></p> <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-drm">DRM错误码</a>。</p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.23.8.1.3.1.1" width="50%">错误码ID</th> <th align="left" class="cellrowborder" id="mcps1.3.23.8.1.3.1.2" width="50%">错误信息</th> </tr><tr><td class="cellrowborder" width="50%">24700101</td> <td class="cellrowborder" width="50%">All unknown errors</td> </tr> <tr><td class="cellrowborder" width="50%">24700201</td> <td class="cellrowborder" width="50%">Fatal service error, for example, service died</td> </tr>  </tbody></table></div> </div> <p><strong>示例：</strong></p> <div _ngcontent-wqx-c106="" class="highlight-div"><div _ngcontent-wqx-c106="" class="highlight-div-header"><div _ngcontent-wqx-c106="" class="highlight-div-header-left"><div _ngcontent-wqx-c106="" class="handle-button expand-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wqx-c106="" class="highlight-div-header-right"><div _ngcontent-wqx-c106="" class="handle-button ai-button"></div><div _ngcontent-wqx-c106="" class="handle-button line-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wqx-c106="" class="handle-button theme-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wqx-c106="" class="handle-button copy-button"><div _ngcontent-wqx-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wqx-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { drm } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.DrmKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">mediaKeySystem</span>: drm.<span class="hljs-property">MediaKeySystem</span> = drm.<span class="hljs-title function_">createMediaKeySystem</span>(<span class="hljs-string">"com.wiseplay.drm"</span>);</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">mediaKeySession</span>: drm.<span class="hljs-property">MediaKeySession</span> = mediaKeySystem.<span class="hljs-title function_">createMediaKeySession</span>();</li><li><span class="hljs-keyword">try</span> {</li><li>  mediaKeySession.<span class="hljs-title function_">destroy</span>();</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>  <span class="hljs-keyword">let</span> error = err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>;</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`mediaKeySession destroy ERROR: <span class="hljs-subst">${error}</span>`</span>);</li><li>}</li></ol></pre></div></div> </div> </div> <div></div></div>