<h1 _ngcontent-lbs-c119="" class="doc-title ng-star-inserted" title="OpenSL ES"> OpenSL ES </h1>

<div _ngcontent-lbs-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">      <p>HarmonyOS上的OpenSL ES接口，是早期SDK8版本开始提供，用于支持应用Native层音频开发的接口。但随着版本演进，接口定义的可扩展性不足，不再能满足音频系统的能力拓展，因此当前已不再推荐应用开发者继续使用此接口进行音频功能开发，</p>      <p>请开发者<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/replace-opensles-by-ohaudio" target="_blank">从OpenSL ES切换到OHAudio</a>。</p>     </div></div></div>    <div class="tiledSection">     <h2 id="简介">简介<i class="anchor-icon anchor-icon-link" anchorid="简介" tips="复制节点链接"></i></h2>          <p>OpenSL ES（Open Sound Library for Embedded System）即嵌入式音频加速标准。为开发者提供了标准化、高性能以及低响应时间的音频功能开发的对象和接口。相对于开源免费的OpenSL ES，HarmonyOS基于<a href="https://www.khronos.org/opensles/" target="_blank">OpenSL ES</a> 1.0.1 API规范实现了部分Native API，相关接口开放情况如表<a href="/consumer/cn/doc/harmonyos-references/opensles#支持的api">支持的API</a>所示。</p>    </div>    <div class="tiledSection">     <h2 id="引入opensl-es能力">引入OpenSL ES能力<i class="anchor-icon anchor-icon-link" anchorid="引入opensl-es能力" tips="复制节点链接"></i></h2>          <p>如果开发者需要使用OpenSL ES相关功能，首先请添加头文件：</p>     <div _ngcontent-lbs-c106="" class="highlight-div"><div _ngcontent-lbs-c106="" class="highlight-div-header"><div _ngcontent-lbs-c106="" class="highlight-div-header-left"><div _ngcontent-lbs-c106="" class="handle-button expand-button"><div _ngcontent-lbs-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-lbs-c106="" class="highlight-div-header-right"><div _ngcontent-lbs-c106="" class="handle-button ai-button"></div><div _ngcontent-lbs-c106="" class="handle-button line-button"><div _ngcontent-lbs-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-lbs-c106="" class="handle-button theme-button"><div _ngcontent-lbs-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-lbs-c106="" class="handle-button copy-button"><div _ngcontent-lbs-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-lbs-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;SLES/OpenSLES.h&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;SLES/OpenSLES_OpenHarmony.h&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;SLES/OpenSLES_Platform.h&gt;</span></span></li></ol></pre></div></div>     <p>其次在CMakeLists.txt中添加以下链接动态库：</p>     <div _ngcontent-lbs-c106="" class="highlight-div"><div _ngcontent-lbs-c106="" class="highlight-div-header"><div _ngcontent-lbs-c106="" class="highlight-div-header-left"><div _ngcontent-lbs-c106="" class="handle-button expand-button"><div _ngcontent-lbs-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-lbs-c106="" class="highlight-div-header-right"><div _ngcontent-lbs-c106="" class="handle-button ai-button"></div><div _ngcontent-lbs-c106="" class="handle-button line-button"><div _ngcontent-lbs-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-lbs-c106="" class="handle-button theme-button"><div _ngcontent-lbs-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-lbs-c106="" class="handle-button copy-button"><div _ngcontent-lbs-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-lbs-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-undefined" data-highlighted="yes"><ol class="linenums"><li>libOpenSLES.so</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="支持的api">支持的API<i class="anchor-icon anchor-icon-link" anchorid="支持的api" tips="复制节点链接"></i></h2>          <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.4.2.1.6.1.1" width="20%">对象</th>         <th align="left" class="cellrowborder" id="mcps1.3.4.2.1.6.1.2" width="20%">对外接口</th>         <th align="left" class="cellrowborder" id="mcps1.3.4.2.1.6.1.3" width="20%">接口调用详情</th>         <th align="left" class="cellrowborder" id="mcps1.3.4.2.1.6.1.4" width="20%">是否支持</th>         <th align="left" class="cellrowborder" id="mcps1.3.4.2.1.6.1.5" width="20%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">SLEngineItf</td>         <td class="cellrowborder" width="20%">CreateAudioPlayer</td>         <td class="cellrowborder" width="20%">CreateAudioPlayer(SLEngineItf self, SLObjectItf *pPlayer, SLDataSource *pAudioSrc, SLDataSink *pAudioSnk, SLuint32 numInterfaces, const SLInterfaceID *pInterfaceIds, const SLboolean *pInterfaceRequired)</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">创建音频播放机。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">SLEngineItf</td>         <td class="cellrowborder" width="20%">CreateAudioRecorder</td>         <td class="cellrowborder" width="20%">CreateAudioRecorder(SLEngineItf self, SLObjectItf *pRecorder, SLDataSource *pAudioSrc, SLDataSink *pAudioSnk, SLuint32 numInterfaces, const SLInterfaceID *pInterfaceIds, const SLboolean *pInterfaceRequired)</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">创建音频录制器。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">SLEngineItf</td>         <td class="cellrowborder" width="20%">CreateAudioOutputMix</td>         <td class="cellrowborder" width="20%">CreateOutputMix(SLEngineItf self, SLObjectItf *pMix, SLuint32 numInterfaces, const SLInterfaceID *pInterfaceIds, const SLboolean *pInterfaceRequired)</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">创建混音器。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">SLObjectItf</td>         <td class="cellrowborder" width="20%">Realize</td>         <td class="cellrowborder" width="20%">Realize(SLObjectItf self, SLboolean async)</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">创建音频播放机。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">SLObjectItf</td>         <td class="cellrowborder" width="20%">getState</td>         <td class="cellrowborder" width="20%">GetState(SLObjectItf self, SLuint32 *pState)</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">获取状态。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">SLObjectItf</td>         <td class="cellrowborder" width="20%">getInterface</td>         <td class="cellrowborder" width="20%">GetInterface(SLObjectItf self, const SLInterfaceID iid, void *pInterface)</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">获取接口。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">SLObjectItf</td>         <td class="cellrowborder" width="20%">Destroy</td>         <td class="cellrowborder" width="20%">Destroy(SLObjectItf self)</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">销毁对象。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">SLOHBufferQueueItf</td>         <td class="cellrowborder" width="20%">Enqueue</td>         <td class="cellrowborder" width="20%">Enqueue(SLOHBufferQueueItf self, const void *pBuffer, SLuint32 size)</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">将buffer加入实际队列中。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">SLOHBufferQueueItf</td>         <td class="cellrowborder" width="20%">clear</td>         <td class="cellrowborder" width="20%">Clear(SLOHBufferQueueItf self)</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">释放buffer队列</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">SLOHBufferQueueItf</td>         <td class="cellrowborder" width="20%">getState</td>         <td class="cellrowborder" width="20%">GetState(SLOHBufferQueueItf self, SLOHBufferQueueState *pState)</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">获取BufferQueue状态。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">SLOHBufferQueueItf</td>         <td class="cellrowborder" width="20%">getBuffer</td>         <td class="cellrowborder" width="20%">GetBuffer(SLOHBufferQueueItf self, SLuint8 **buffer, SLuint32 *size)</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">获取buffer。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">SLOHBufferQueueItf</td>         <td class="cellrowborder" width="20%">RegisterCallback</td>         <td class="cellrowborder" width="20%">RegisterCallback(SLOHBufferQueueItf self, SlOHBufferQueueCallback callback, void *pContext)</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">注册回调函数。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">SLPlayItf</td>         <td class="cellrowborder" width="20%">SetPlayState</td>         <td class="cellrowborder" width="20%">SetPlayState(SLPlayItf self, SLuint32 state)</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">设置播放状态。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">SLPlayItf</td>         <td class="cellrowborder" width="20%">GetPlayState</td>         <td class="cellrowborder" width="20%">GetPlayState(SLPlayItf self, SLuint32 *pState)</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">获取播放状态。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">SLRecordItf</td>         <td class="cellrowborder" width="20%">SetRecordState</td>         <td class="cellrowborder" width="20%">SetRecordState(SLRecordItf self, SLuint32 state)</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">设置录制状态。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">SLRecordItf</td>         <td class="cellrowborder" width="20%">GetRecordState</td>         <td class="cellrowborder" width="20%">GetRecordState(SLRecordItf self, SLuint32 *pState)</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">获取录制状态。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">SLVolumeItf</td>         <td class="cellrowborder" width="20%">SetVolumeLevel</td>         <td class="cellrowborder" width="20%">SetVolumeLevel(SLVolumeItf self, SLmillibel level)</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">设置音量。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">SLVolumeItf</td>         <td class="cellrowborder" width="20%">GetVolumeLevel</td>         <td class="cellrowborder" width="20%">GetVolumeLevel(SLVolumeItf self, SLmillibel *pLevel)</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">获取音量。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">SLVolumeItf</td>         <td class="cellrowborder" width="20%">GetMaxVolumeLevel</td>         <td class="cellrowborder" width="20%">GetMaxVolumeLevel(SLVolumeItf self, SLmillibel *pMaxLevel)</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">获取最大音量。</td>        </tr>             </tbody></table></div>     </div>    </div>   </div></div>