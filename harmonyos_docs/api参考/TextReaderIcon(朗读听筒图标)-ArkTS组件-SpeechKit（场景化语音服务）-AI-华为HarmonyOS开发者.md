<h1 _ngcontent-tap-c119="" class="doc-title ng-star-inserted" title="TextReaderIcon (朗读听筒图标)"> TextReaderIcon (朗读听筒图标) </h1>

<div _ngcontent-tap-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div><p>朗读听筒图标，可以作为动态组件加载，并配置成为播放面板的主入口。</p> <p><strong>起始版本：</strong>5.0.0(12)</p> <div class="tiledSection"><h2 id="section10727191484112" device-type="phone,2in1,tablet">导入模块<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section10727191484112" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><div _ngcontent-tap-c106="" class="highlight-div"><div _ngcontent-tap-c106="" class="highlight-div-header"><div _ngcontent-tap-c106="" class="highlight-div-header-left"><div _ngcontent-tap-c106="" class="handle-button expand-button"><div _ngcontent-tap-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-tap-c106="" class="highlight-div-header-right"><div _ngcontent-tap-c106="" class="handle-button ai-button"></div><div _ngcontent-tap-c106="" class="handle-button line-button"><div _ngcontent-tap-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-tap-c106="" class="handle-button theme-button"><div _ngcontent-tap-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-tap-c106="" class="handle-button copy-button"><div _ngcontent-tap-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-tap-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">TextReaderIcon</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.SpeechKit'</span>;</li></ol></pre></div></div> </div> <div class="tiledSection"><h2 id="section71306437290" device-type="phone,2in1,tablet">TextReaderIcon<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section71306437290" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><p>朗读听筒图标，可以作为动态组件加载。设置onClick回调，在用户点击听筒图标时启动朗读控件。</p> <p><strong>装饰器类型：</strong>@Component</p> <p><strong>元服务API：</strong> 从版本5.0.3(15)开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong>SystemCapability.AI.Component.TextReader</p> <p><strong>起始版本：</strong>5.0.0(12)</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.4.8.1.6.1.1" width="29.87%"><p>名称</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.4.8.1.6.1.2" width="24.64%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.4.8.1.6.1.3" width="7.5200000000000005%"><p>必填</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.4.8.1.6.1.4" width="15.110000000000001%"><p>装饰器类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.4.8.1.6.1.5" width="22.86%"><p>说明</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="29.87%"><p>readState</p> </td> <td class="cellrowborder" width="24.64%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/speech-readstatecode">ReadStateCode</a></p> </td> <td class="cellrowborder" width="7.5200000000000005%"><p>是</p> </td> <td class="cellrowborder" width="15.110000000000001%"><p>@Link</p> </td> <td class="cellrowborder" width="22.86%"><p>播报状态</p> <p><strong>说明：</strong></p> <p>ReadState使用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-link" target="_blank">@Link装饰器：父子双向同步</a></p> </td> </tr>  </tbody></table></div> </div> </div> <div class="tiledSection"><h3 id="section3184723135019" device-type="phone,2in1,tablet" class="firsth2">build<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section3184723135019" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><p>build(): void</p> <p>用于创建<a href="/consumer/cn/doc/harmonyos-references/speech-textreadericon#section71306437290">TextReaderIcon</a>对象的构造函数。</p> <p><strong>元服务API：</strong> 从版本5.0.3(15)开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong>SystemCapability.AI.Component.TextReader</p> <p><strong>起始版本：</strong>5.0.0(12)</p> </div> <div class="p"><strong>示例：</strong><div _ngcontent-tap-c106="" class="highlight-div"><div _ngcontent-tap-c106="" class="highlight-div-header"><div _ngcontent-tap-c106="" class="highlight-div-header-left"><div _ngcontent-tap-c106="" class="handle-button expand-button"><div _ngcontent-tap-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-tap-c106="" class="highlight-div-header-right"><div _ngcontent-tap-c106="" class="handle-button ai-button"></div><div _ngcontent-tap-c106="" class="handle-button line-button"><div _ngcontent-tap-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-tap-c106="" class="handle-button theme-button"><div _ngcontent-tap-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-tap-c106="" class="handle-button copy-button"><div _ngcontent-tap-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-tap-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">TextReader</span>, <span class="hljs-title class_">TextReaderIcon</span>, <span class="hljs-title class_">ReadStateCode</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.SpeechKit'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>
</li><li>  <span class="hljs-comment">/**</span></li><li><span class="hljs-comment">   * 待加载的文章</span></li><li><span class="hljs-comment">   */</span></li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">readInfoList</span>: <span class="hljs-title class_">TextReader</span>.<span class="hljs-property">ReadInfo</span>[] = [];</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">selectedReadInfo</span>: <span class="hljs-title class_">TextReader</span>.<span class="hljs-property">ReadInfo</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">readInfoList</span>[<span class="hljs-number">0</span>];</li><li>
</li><li>  <span class="hljs-comment">/**</span></li><li><span class="hljs-comment">   * 播放状态</span></li><li><span class="hljs-comment">   */</span></li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">readState</span>: <span class="hljs-title class_">ReadStateCode</span> = <span class="hljs-title class_">ReadStateCode</span>.<span class="hljs-property">WAITING</span>;</li><li>
</li><li>  <span class="hljs-comment">/**</span></li><li><span class="hljs-comment">   * 用于显示当前页的按钮状态</span></li><li><span class="hljs-comment">   */</span></li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">isInit</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">false</span>;</li><li>
</li><li>  <span class="hljs-keyword">async</span> <span class="hljs-title function_">aboutToAppear</span>(<span class="hljs-params"></span>){</li><li>    <span class="hljs-comment">/**</span></li><li><span class="hljs-comment">     * 加载数据</span></li><li><span class="hljs-comment">     */</span></li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">readInfoList</span>: <span class="hljs-title class_">TextReader</span>.<span class="hljs-property">ReadInfo</span>[] = [{</li><li>      <span class="hljs-attr">id</span>: <span class="hljs-string">'001'</span>,</li><li>      <span class="hljs-attr">title</span>: {</li><li>        <span class="hljs-attr">text</span>:<span class="hljs-string">'水调歌头.明月几时有'</span>,</li><li>        <span class="hljs-attr">isClickable</span>:<span class="hljs-literal">true</span></li><li>      },</li><li>      <span class="hljs-attr">author</span>:{</li><li>        <span class="hljs-attr">text</span>:<span class="hljs-string">'宋.苏轼'</span>,</li><li>        <span class="hljs-attr">isClickable</span>:<span class="hljs-literal">true</span></li><li>      },</li><li>      <span class="hljs-attr">date</span>: {</li><li>        <span class="hljs-attr">text</span>:<span class="hljs-string">'2024/01/01'</span>,</li><li>        <span class="hljs-attr">isClickable</span>:<span class="hljs-literal">false</span></li><li>      },</li><li>      <span class="hljs-attr">bodyInfo</span>: <span class="hljs-string">'明月几时有？把酒问青天。'</span></li><li>    }];</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">readInfoList</span> = readInfoList;</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">selectedReadInfo</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">readInfoList</span>[<span class="hljs-number">0</span>];</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">init</span>();</li><li>  }</li><li>
</li><li>  <span class="hljs-comment">/**</span></li><li><span class="hljs-comment">   * 初始化</span></li><li><span class="hljs-comment">   */</span></li><li>  <span class="hljs-keyword">async</span> <span class="hljs-title function_">init</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">const</span> <span class="hljs-attr">readerParam</span>: <span class="hljs-title class_">TextReader</span>.<span class="hljs-property">ReaderParam</span> = {</li><li>      <span class="hljs-attr">isVoiceBrandVisible</span>: <span class="hljs-literal">true</span>,</li><li>      <span class="hljs-attr">businessBrandInfo</span>: {</li><li>        <span class="hljs-attr">panelName</span>: <span class="hljs-string">'小艺朗读'</span>,</li><li>        <span class="hljs-attr">panelIcon</span>: $r(<span class="hljs-string">'app.media.startIcon'</span>)</li><li>      }</li><li>    }</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">context</span>: <span class="hljs-title class_">Context</span> | <span class="hljs-literal">undefined</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>()</li><li>      <span class="hljs-keyword">if</span> (context) {</li><li>        <span class="hljs-keyword">await</span> <span class="hljs-title class_">TextReader</span>.<span class="hljs-title function_">init</span>(context, readerParam);</li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">isInit</span> = <span class="hljs-literal">true</span>;</li><li>      }</li><li>    } <span class="hljs-keyword">catch</span> (err) {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`TextReader failed to init. Code: <span class="hljs-subst">${err.code}</span>, message: <span class="hljs-subst">${err.message}</span>`</span>);</li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-comment">// 设置操作监听</span></li><li>  <span class="hljs-title function_">setActionListener</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">TextReader</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">'stateChange'</span>, <span class="hljs-function">(<span class="hljs-params">state: TextReader.ReadState</span>) =&gt;</span> {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">onStateChanged</span>(state)</li><li>    });</li><li>    <span class="hljs-title class_">TextReader</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">'requestMore'</span>, <span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">onStateChanged</span>);</li><li>  }</li><li>
</li><li>  onStateChanged = <span class="hljs-function">(<span class="hljs-params">state: TextReader.ReadState</span>) =&gt;</span> {</li><li>    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">selectedReadInfo</span>?.<span class="hljs-property">id</span> === state.<span class="hljs-property">id</span>) {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">readState</span> = state.<span class="hljs-property">state</span>;</li><li>    } <span class="hljs-keyword">else</span> {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">readState</span> = <span class="hljs-title class_">ReadStateCode</span>.<span class="hljs-property">WAITING</span>;</li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">TextReaderIcon</span>({ <span class="hljs-attr">readState</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">readState</span> })</li><li>        .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">right</span>: <span class="hljs-number">20</span> })</li><li>        .<span class="hljs-title function_">width</span>(<span class="hljs-number">32</span>)</li><li>        .<span class="hljs-title function_">height</span>(<span class="hljs-number">32</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-keyword">async</span> () =&gt; {</li><li>          <span class="hljs-keyword">try</span> {</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setActionListener</span>();</li><li>            <span class="hljs-keyword">await</span> <span class="hljs-title class_">TextReader</span>.<span class="hljs-title function_">start</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">readInfoList</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">selectedReadInfo</span>?.<span class="hljs-property">id</span>);</li><li>          } <span class="hljs-keyword">catch</span> (err) {</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`TextReader failed to start. Code: <span class="hljs-subst">${err.code}</span>, message: <span class="hljs-subst">${err.message}</span>`</span>);</li><li>          }</li><li>        })</li><li>    }</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div> </div> <p></p> </div> <div></div></div>