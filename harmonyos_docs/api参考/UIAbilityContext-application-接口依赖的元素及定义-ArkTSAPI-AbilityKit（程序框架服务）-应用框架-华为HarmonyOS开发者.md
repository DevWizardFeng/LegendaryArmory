<h1 _ngcontent-gnv-c119="" class="doc-title ng-star-inserted" title="UIAbilityContext"> UIAbilityContext </h1>

<div _ngcontent-gnv-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted renderOptimization" style="position: relative;">   <div>    <p>UIAbilityContext是<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability">UIAbility</a>组件的上下文，继承自<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-context">Context</a>。各类Context之间的关联与差异详见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/application-context-stage" target="_blank">应用上下文Context</a>。</p>    <p>每个UIAbility组件实例化时，系统都会自动创建对应的UIAbilityContext。开发者可以通过UIAbilityContext获取组件信息AbilityInfo、获取应用信息ApplicationInfo、拉起其他UIAbility、连接系统服务、销毁UIAbility等。</p>    <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">      <ul>       <li>本模块首批接口从API version 9开始支持。后续版本的新增接口，采用上角标单独标记接口的起始版本。</li>       <li>本模块接口仅可在Stage模型下使用。</li>       <li>在本文档的示例中，通过this.context来获取UIAbilityContext，其中this代表继承自UIAbility的实例。</li>      </ul>     </div></div></div>    <div class="tiledSection scroll-inwindow" style="contain-intrinsic-size: auto 247px;">     <h2 id="导入模块" device-type="phone,2in1,tablet,wearable,tv">导入模块<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="导入模块" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><div _ngcontent-gnv-c106="" class="highlight-div"><div _ngcontent-gnv-c106="" class="highlight-div-header"><div _ngcontent-gnv-c106="" class="highlight-div-header-left"><div _ngcontent-gnv-c106="" class="handle-button expand-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gnv-c106="" class="highlight-div-header-right"><div _ngcontent-gnv-c106="" class="handle-button ai-button"></div><div _ngcontent-gnv-c106="" class="handle-button line-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gnv-c106="" class="handle-button theme-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gnv-c106="" class="handle-button copy-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gnv-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li></ol></pre></div></div>    </div>    <div class="tiledSection scroll-inwindow" style="contain-intrinsic-size: auto 146px;">     <h2 id="uiabilitycontext-1" device-type="phone,2in1,tablet,wearable,tv">UIAbilityContext<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="uiabilitycontext-1" tips="复制节点链接"></i></h2>         <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div></div>    <div class="tiledSection scroll-inwindow" style="contain-intrinsic-size: auto 900px;">     <h3 id="属性" device-type="phone,2in1,tablet,wearable,tv" class="firsth2">属性<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="属性" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.Core</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.6.3.1.6.1.1" width="20%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.6.3.1.6.1.2" width="20%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.6.3.1.6.1.3" width="20%">只读</th>         <th align="left" class="cellrowborder" id="mcps1.3.6.3.1.6.1.4" width="20%">可选</th>         <th align="left" class="cellrowborder" id="mcps1.3.6.3.1.6.1.5" width="20%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">abilityInfo</td>         <td class="cellrowborder" width="20%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-bundlemanager-abilityinfo">AbilityInfo</a></td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">          <p>UIAbility的相关信息。</p>          <p><strong>元服务API</strong>：从API version 11开始，该接口支持在元服务中使用。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">currentHapModuleInfo</td>         <td class="cellrowborder" width="20%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-bundlemanager-hapmoduleinfo">HapModuleInfo</a></td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">          <p>当前UIAbility所属HAP的信息。</p>          <p><strong>元服务API</strong>：从API version 11开始，该接口支持在元服务中使用。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">config</td>         <td class="cellrowborder" width="20%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-configuration">Configuration</a></td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">          <p>应用运行时的环境变量，如语言、颜色模式等。</p>          <p><strong>元服务API</strong>：从API version 11开始，该接口支持在元服务中使用。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">windowStage<sup>12+</sup></td>         <td class="cellrowborder" width="20%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-window-windowstage">window.WindowStage</a></td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">          <p>当前WindowStage对象。仅支持在主线程调用。</p>          <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection scroll-inwindow" style="contain-intrinsic-size: auto 3256px;">     <h3 id="startability" device-type="phone,2in1,tablet,wearable,tv">startAbility<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="startability" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>startAbility(want: Want, callback: AsyncCallback&lt;void&gt;): void</p>     <p>启动一个UIAbility。使用callback异步回调。仅支持在主线程调用。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>组件启动规则详见：<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/component-startup-rules" target="_blank">组件启动规则（Stage模型）</a>。</p>      </div></div></div>     <p><strong>元服务API</strong>：从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.7.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.7.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.7.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.7.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">want</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-want">Want</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">启动UIAbility的必要信息。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;void&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数，当接口调用成功，err中code为0，message为空字符串；否则err会返回对应的错误码和错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-ability">元能力子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.7.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.7.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">The application does not have permission to call the interface.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1.Mandatory parameters are left unspecified. 2.Incorrect parameter types.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000001</td>         <td class="cellrowborder" width="50%">The specified ability does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000002</td>         <td class="cellrowborder" width="50%">Incorrect ability type.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000004</td>         <td class="cellrowborder" width="50%">Cannot start an invisible component.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000005</td>         <td class="cellrowborder" width="50%">The specified process does not have the permission.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000006</td>         <td class="cellrowborder" width="50%">Cross-user operations are not allowed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000008</td>         <td class="cellrowborder" width="50%">The crowdtesting application expires.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000009</td>         <td class="cellrowborder" width="50%">An ability cannot be started or stopped in Wukong mode.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000010</td>         <td class="cellrowborder" width="50%">The call with the continuation and prepare continuation flag is forbidden.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000011</td>         <td class="cellrowborder" width="50%">The context does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000012</td>         <td class="cellrowborder" width="50%">The application is controlled.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000013</td>         <td class="cellrowborder" width="50%">The application is controlled by EDM.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000018</td>         <td class="cellrowborder" width="50%">Redirection to a third-party application is not allowed in API version greater than 11.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000019</td>         <td class="cellrowborder" width="50%">No matching ability is found.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000050</td>         <td class="cellrowborder" width="50%">Internal error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000053</td>         <td class="cellrowborder" width="50%">The ability is not on the top of the UI.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000055</td>         <td class="cellrowborder" width="50%">Installation-free timed out.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000071</td>         <td class="cellrowborder" width="50%">App clone is not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000072</td>         <td class="cellrowborder" width="50%">App clone or multi-instance is not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000073</td>         <td class="cellrowborder" width="50%">The app clone index is invalid.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000076</td>         <td class="cellrowborder" width="50%">The app instance key is invalid.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000077</td>         <td class="cellrowborder" width="50%">The number of app instances reaches the limit.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000078</td>         <td class="cellrowborder" width="50%">The multi-instance is not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000079</td>         <td class="cellrowborder" width="50%">The APP_INSTANCE_KEY cannot be specified.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000080</td>         <td class="cellrowborder" width="50%">Creating a new instance is not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16200001</td>         <td class="cellrowborder" width="50%">The caller has been released.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-gnv-c106="" class="highlight-div"><div _ngcontent-gnv-c106="" class="highlight-div-header"><div _ngcontent-gnv-c106="" class="highlight-div-header-left"><div _ngcontent-gnv-c106="" class="handle-button expand-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gnv-c106="" class="highlight-div-header-right"><div _ngcontent-gnv-c106="" class="handle-button ai-button"></div><div _ngcontent-gnv-c106="" class="handle-button line-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gnv-c106="" class="handle-button theme-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gnv-c106="" class="handle-button copy-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gnv-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span>, <span class="hljs-title class_">Want</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onForeground</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">want</span>: <span class="hljs-title class_">Want</span> = {</li><li>      <span class="hljs-attr">bundleName</span>: <span class="hljs-string">'com.example.myapplication'</span>,</li><li>      <span class="hljs-attr">abilityName</span>: <span class="hljs-string">'EntryAbility'</span></li><li>    };</li><li>
</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">startAbility</span>(want, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>        <span class="hljs-keyword">if</span> (err.<span class="hljs-property">code</span>) {</li><li>          <span class="hljs-comment">// 处理业务逻辑错误</span></li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`startAbility failed, code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>          <span class="hljs-keyword">return</span>;</li><li>        }</li><li>        <span class="hljs-comment">// 执行正常业务</span></li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'startAbility succeed'</span>);</li><li>      });</li><li>    } <span class="hljs-keyword">catch</span> (err) {</li><li>      <span class="hljs-comment">// 处理入参错误异常</span></li><li>      <span class="hljs-keyword">let</span> code = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span>;</li><li>      <span class="hljs-keyword">let</span> message = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>;</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`startAbility failed, code is <span class="hljs-subst">${code}</span>, message is <span class="hljs-subst">${message}</span>`</span>);</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 3507px;">     <h3 id="startability-1" device-type="phone,2in1,tablet,wearable,tv">startAbility<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="startability-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>startAbility(want: Want, options: StartOptions, callback: AsyncCallback&lt;void&gt;): void</p>     <p>启动一个UIAbility。使用callback异步回调。仅支持在主线程调用。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>组件启动规则详见：<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/component-startup-rules" target="_blank">组件启动规则（Stage模型）</a>。</p>      </div></div></div>     <p><strong>元服务API</strong>：从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.8.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.8.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.8.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.8.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">want</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-want">Want</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">启动UIAbility的必要信息。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">options</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-startoptions">StartOptions</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">启动UIAbility所携带的参数。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;void&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数，当接口调用成功，err中code为0，message为空字符串；否则err会返回对应的错误码和错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-ability">元能力子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.8.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.8.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">The application does not have permission to call the interface.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1.Mandatory parameters are left unspecified. 2.Incorrect parameter types.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not support.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000001</td>         <td class="cellrowborder" width="50%">The specified ability does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000004</td>         <td class="cellrowborder" width="50%">Cannot start an invisible component.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000005</td>         <td class="cellrowborder" width="50%">The specified process does not have the permission.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000006</td>         <td class="cellrowborder" width="50%">Cross-user operations are not allowed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000008</td>         <td class="cellrowborder" width="50%">The crowdtesting application expires.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000009</td>         <td class="cellrowborder" width="50%">An ability cannot be started or stopped in Wukong mode.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000011</td>         <td class="cellrowborder" width="50%">The context does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000012</td>         <td class="cellrowborder" width="50%">The application is controlled.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000013</td>         <td class="cellrowborder" width="50%">The application is controlled by EDM.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000018</td>         <td class="cellrowborder" width="50%">Redirection to a third-party application is not allowed in API version greater than 11.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000019</td>         <td class="cellrowborder" width="50%">No matching ability is found.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000050</td>         <td class="cellrowborder" width="50%">Internal error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000053</td>         <td class="cellrowborder" width="50%">The ability is not on the top of the UI.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000055</td>         <td class="cellrowborder" width="50%">Installation-free timed out.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000067</td>         <td class="cellrowborder" width="50%">The StartOptions check failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000068</td>         <td class="cellrowborder" width="50%">The ability is already running.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16300003</td>         <td class="cellrowborder" width="50%">The target application is not the current application.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000071</td>         <td class="cellrowborder" width="50%">App clone is not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000072</td>         <td class="cellrowborder" width="50%">App clone or multi-instance is not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000073</td>         <td class="cellrowborder" width="50%">The app clone index is invalid.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000076</td>         <td class="cellrowborder" width="50%">The app instance key is invalid.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000077</td>         <td class="cellrowborder" width="50%">The number of app instances reaches the limit.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000078</td>         <td class="cellrowborder" width="50%">The multi-instance is not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000079</td>         <td class="cellrowborder" width="50%">The APP_INSTANCE_KEY cannot be specified.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000080</td>         <td class="cellrowborder" width="50%">Creating a new instance is not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16200001</td>         <td class="cellrowborder" width="50%">The caller has been released.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-gnv-c106="" class="highlight-div"><div _ngcontent-gnv-c106="" class="highlight-div-header"><div _ngcontent-gnv-c106="" class="highlight-div-header-left"><div _ngcontent-gnv-c106="" class="handle-button expand-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gnv-c106="" class="highlight-div-header-right"><div _ngcontent-gnv-c106="" class="handle-button ai-button"></div><div _ngcontent-gnv-c106="" class="handle-button line-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gnv-c106="" class="handle-button theme-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gnv-c106="" class="handle-button copy-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gnv-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span>, <span class="hljs-title class_">Want</span>, <span class="hljs-title class_">StartOptions</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onForeground</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">want</span>: <span class="hljs-title class_">Want</span> = {</li><li>      <span class="hljs-attr">deviceId</span>: <span class="hljs-string">''</span>,</li><li>      <span class="hljs-attr">bundleName</span>: <span class="hljs-string">'com.example.myapplication'</span>,</li><li>      <span class="hljs-attr">abilityName</span>: <span class="hljs-string">'EntryAbility'</span></li><li>    };</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">options</span>: <span class="hljs-title class_">StartOptions</span> = {</li><li>      <span class="hljs-attr">displayId</span>: <span class="hljs-number">0</span></li><li>    };</li><li>
</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">startAbility</span>(want, options, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>        <span class="hljs-keyword">if</span> (err.<span class="hljs-property">code</span>) {</li><li>          <span class="hljs-comment">// 处理业务逻辑错误</span></li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`startAbility failed, code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>          <span class="hljs-keyword">return</span>;</li><li>        }</li><li>        <span class="hljs-comment">// 执行正常业务</span></li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'startAbility succeed'</span>);</li><li>      });</li><li>    } <span class="hljs-keyword">catch</span> (err) {</li><li>      <span class="hljs-comment">// 处理入参错误异常</span></li><li>      <span class="hljs-keyword">let</span> code = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span>;</li><li>      <span class="hljs-keyword">let</span> message = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>;</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`startAbility failed, code is <span class="hljs-subst">${code}</span>, message is <span class="hljs-subst">${message}</span>`</span>);</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 3647px;">     <h3 id="startability-2" device-type="phone,2in1,tablet,wearable,tv">startAbility<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="startability-2" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>startAbility(want: Want, options?: StartOptions): Promise&lt;void&gt;</p>     <p>启动一个UIAbility。使用Promise异步回调。仅支持在主线程调用。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>组件启动规则详见：<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/component-startup-rules" target="_blank">组件启动规则（Stage模型）</a>。</p>      </div></div></div>     <p><strong>元服务API</strong>：从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.9.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.9.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.9.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.9.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">want</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-want">Want</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">启动UIAbility的必要信息。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">options</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-startoptions">StartOptions</a></td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">启动UIAbility所携带的参数。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.9.10.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.9.10.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">Promise对象，无返回结果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-ability">元能力子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.9.13.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.9.13.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">The application does not have permission to call the interface.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1.Mandatory parameters are left unspecified. 2.Incorrect parameter types.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not support.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000001</td>         <td class="cellrowborder" width="50%">The specified ability does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000002</td>         <td class="cellrowborder" width="50%">Incorrect ability type.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000004</td>         <td class="cellrowborder" width="50%">Cannot start an invisible component.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000005</td>         <td class="cellrowborder" width="50%">The specified process does not have the permission.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000006</td>         <td class="cellrowborder" width="50%">Cross-user operations are not allowed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000008</td>         <td class="cellrowborder" width="50%">The crowdtesting application expires.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000009</td>         <td class="cellrowborder" width="50%">An ability cannot be started or stopped in Wukong mode.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000010</td>         <td class="cellrowborder" width="50%">The call with the continuation and prepare continuation flag is forbidden.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000011</td>         <td class="cellrowborder" width="50%">The context does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000012</td>         <td class="cellrowborder" width="50%">The application is controlled.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000013</td>         <td class="cellrowborder" width="50%">The application is controlled by EDM.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000018</td>         <td class="cellrowborder" width="50%">Redirection to a third-party application is not allowed in API version greater than 11.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000019</td>         <td class="cellrowborder" width="50%">No matching ability is found.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000050</td>         <td class="cellrowborder" width="50%">Internal error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000053</td>         <td class="cellrowborder" width="50%">The ability is not on the top of the UI.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000055</td>         <td class="cellrowborder" width="50%">Installation-free timed out.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000067</td>         <td class="cellrowborder" width="50%">The StartOptions check failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000068</td>         <td class="cellrowborder" width="50%">The ability is already running.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16300003</td>         <td class="cellrowborder" width="50%">The target application is not the current application.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000071</td>         <td class="cellrowborder" width="50%">App clone is not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000072</td>         <td class="cellrowborder" width="50%">App clone or multi-instance is not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000073</td>         <td class="cellrowborder" width="50%">The app clone index is invalid.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000076</td>         <td class="cellrowborder" width="50%">The app instance key is invalid.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000077</td>         <td class="cellrowborder" width="50%">The number of app instances reaches the limit.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000078</td>         <td class="cellrowborder" width="50%">The multi-instance is not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000079</td>         <td class="cellrowborder" width="50%">The APP_INSTANCE_KEY cannot be specified.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000080</td>         <td class="cellrowborder" width="50%">Creating a new instance is not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16200001</td>         <td class="cellrowborder" width="50%">The caller has been released.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-gnv-c106="" class="highlight-div"><div _ngcontent-gnv-c106="" class="highlight-div-header"><div _ngcontent-gnv-c106="" class="highlight-div-header-left"><div _ngcontent-gnv-c106="" class="handle-button expand-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gnv-c106="" class="highlight-div-header-right"><div _ngcontent-gnv-c106="" class="handle-button ai-button"></div><div _ngcontent-gnv-c106="" class="handle-button line-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gnv-c106="" class="handle-button theme-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gnv-c106="" class="handle-button copy-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gnv-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span>, <span class="hljs-title class_">Want</span>, <span class="hljs-title class_">StartOptions</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onForeground</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">want</span>: <span class="hljs-title class_">Want</span> = {</li><li>      <span class="hljs-attr">bundleName</span>: <span class="hljs-string">'com.example.myapplication'</span>,</li><li>      <span class="hljs-attr">abilityName</span>: <span class="hljs-string">'EntryAbility'</span></li><li>    };</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">options</span>: <span class="hljs-title class_">StartOptions</span> = {</li><li>      <span class="hljs-attr">displayId</span>: <span class="hljs-number">0</span></li><li>    };</li><li>
</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">startAbility</span>(want, options)</li><li>        .<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-comment">// 执行正常业务</span></li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'startAbility succeed'</span>);</li><li>        })</li><li>        .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>          <span class="hljs-comment">// 处理业务逻辑错误</span></li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`startAbility failed, code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>        });</li><li>    } <span class="hljs-keyword">catch</span> (err) {</li><li>      <span class="hljs-comment">// 处理入参错误异常</span></li><li>      <span class="hljs-keyword">let</span> code = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span>;</li><li>      <span class="hljs-keyword">let</span> message = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>;</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`startAbility failed, code is <span class="hljs-subst">${code}</span>, message is <span class="hljs-subst">${message}</span>`</span>);</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 3488px;">     <h3 id="startabilityforresult" device-type="phone,2in1,tablet,wearable,tv">startAbilityForResult<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="startabilityforresult" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>startAbilityForResult(want: Want, callback: AsyncCallback&lt;AbilityResult&gt;): void</p>     <p>启动一个UIAbility，并通过回调函数接收被拉起的UIAbility退出时的返回结果。使用callback异步回调。仅支持在主线程调用。</p>     <p>UIAbility被启动后，有如下情况：</p>     <ul>      <li>正常情况下可以通过调用<a href="/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext#terminateselfwithresult">terminateSelfWithResult</a>接口销毁自身，并将结果返回给调用方。</li>      <li>异常情况下比如杀死UIAbility会将异常结果返回给调用方，异常结果中resultCode为-1。</li>      <li>如果被启动的UIAbility是<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/uiability-launch-type#singleton启动模式" target="_blank">单实例模式</a>，且这个UIAbility被不同应用多次调用该接口启动，当这个UIAbility调用<a href="/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext#terminateselfwithresult">terminateSelfWithResult</a>接口销毁自身时，只将正常结果返回给最后一个调用方，其它调用方返回异常结果，异常结果中resultCode为-1。</li>     </ul>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>组件启动规则详见：<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/component-startup-rules" target="_blank">组件启动规则（Stage模型）</a>。</p>      </div></div></div>     <p><strong>元服务API</strong>：从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.10.10.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.10.10.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.10.10.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.10.10.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">want</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-want">Want</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">启动Ability的必要信息。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-ability-abilityresult">AbilityResult</a>&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数，当接口调用成功，err中code为0，data为被拉起方退出时的结果码和数据；否则err会返回对应的错误码和错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-ability">元能力子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.10.13.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.10.13.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">The application does not have permission to call the interface.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1.Mandatory parameters are left unspecified. 2.Incorrect parameter types.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000001</td>         <td class="cellrowborder" width="50%">The specified ability does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000002</td>         <td class="cellrowborder" width="50%">Incorrect ability type.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000004</td>         <td class="cellrowborder" width="50%">Cannot start an invisible component.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000005</td>         <td class="cellrowborder" width="50%">The specified process does not have the permission.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000006</td>         <td class="cellrowborder" width="50%">Cross-user operations are not allowed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000008</td>         <td class="cellrowborder" width="50%">The crowdtesting application expires.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000009</td>         <td class="cellrowborder" width="50%">An ability cannot be started or stopped in Wukong mode.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000010</td>         <td class="cellrowborder" width="50%">The call with the continuation and prepare continuation flag is forbidden.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000011</td>         <td class="cellrowborder" width="50%">The context does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000012</td>         <td class="cellrowborder" width="50%">The application is controlled.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000013</td>         <td class="cellrowborder" width="50%">The application is controlled by EDM.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000018</td>         <td class="cellrowborder" width="50%">Redirection to a third-party application is not allowed in API version greater than 11.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000019</td>         <td class="cellrowborder" width="50%">No matching ability is found.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000050</td>         <td class="cellrowborder" width="50%">Internal error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000053</td>         <td class="cellrowborder" width="50%">The ability is not on the top of the UI.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000055</td>         <td class="cellrowborder" width="50%">Installation-free timed out.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000071</td>         <td class="cellrowborder" width="50%">App clone is not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000072</td>         <td class="cellrowborder" width="50%">App clone or multi-instance is not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000073</td>         <td class="cellrowborder" width="50%">The app clone index is invalid.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000076</td>         <td class="cellrowborder" width="50%">The app instance key is invalid.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000077</td>         <td class="cellrowborder" width="50%">The number of app instances reaches the limit.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000078</td>         <td class="cellrowborder" width="50%">The multi-instance is not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000079</td>         <td class="cellrowborder" width="50%">The APP_INSTANCE_KEY cannot be specified.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000080</td>         <td class="cellrowborder" width="50%">Creating a new instance is not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16200001</td>         <td class="cellrowborder" width="50%">The caller has been released.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-gnv-c106="" class="highlight-div"><div _ngcontent-gnv-c106="" class="highlight-div-header"><div _ngcontent-gnv-c106="" class="highlight-div-header-left"><div _ngcontent-gnv-c106="" class="handle-button expand-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gnv-c106="" class="highlight-div-header-right"><div _ngcontent-gnv-c106="" class="handle-button ai-button"></div><div _ngcontent-gnv-c106="" class="handle-button line-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gnv-c106="" class="handle-button theme-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gnv-c106="" class="handle-button copy-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gnv-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span>, <span class="hljs-title class_">Want</span>, common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onForeground</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">want</span>: <span class="hljs-title class_">Want</span> = {</li><li>      <span class="hljs-attr">deviceId</span>: <span class="hljs-string">''</span>,</li><li>      <span class="hljs-attr">bundleName</span>: <span class="hljs-string">'com.example.myapplication'</span>,</li><li>      <span class="hljs-attr">abilityName</span>: <span class="hljs-string">'EntryAbility'</span></li><li>    };</li><li>
</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">startAbilityForResult</span>(want, <span class="hljs-function">(<span class="hljs-params">err: BusinessError, result: common.AbilityResult</span>) =&gt;</span> {</li><li>        <span class="hljs-keyword">if</span> (err.<span class="hljs-property">code</span>) {</li><li>          <span class="hljs-comment">// 处理业务逻辑错误</span></li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`startAbilityForResult failed, code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>          <span class="hljs-keyword">return</span>;</li><li>        }</li><li>        <span class="hljs-comment">// 执行正常业务</span></li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'startAbilityForResult succeed'</span>);</li><li>      });</li><li>    } <span class="hljs-keyword">catch</span> (err) {</li><li>      <span class="hljs-comment">// 处理入参错误异常</span></li><li>      <span class="hljs-keyword">let</span> code = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span>;</li><li>      <span class="hljs-keyword">let</span> message = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>;</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`startAbilityForResult failed, code is <span class="hljs-subst">${code}</span>, message is <span class="hljs-subst">${message}</span>`</span>);</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 3471px;">     <h3 id="startabilityforresult-1" device-type="phone,2in1,tablet,wearable,tv">startAbilityForResult<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="startabilityforresult-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>startAbilityForResult(want: Want, options: StartOptions, callback: AsyncCallback&lt;AbilityResult&gt;): void</p>     <p>启动一个UIAbility，并通过回调函数接收被拉起的UIAbility退出时的返回结果。使用callback异步回调。仅支持在主线程调用。</p>     <p>UIAbility被启动后，有如下情况：</p>     <ul>      <li>正常情况下可以通过调用<a href="/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext#terminateselfwithresult">terminateSelfWithResult</a>接口销毁自身，并将结果返回给调用方。</li>      <li>异常情况下比如杀死UIAbility会将异常结果返回给调用方，异常结果中resultCode为-1。</li>      <li>如果被启动的UIAbility是<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/uiability-launch-type#singleton启动模式" target="_blank">单实例模式</a>，且这个UIAbility被不同应用多次调用该接口启动，当这个UIAbility调用<a href="/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext#terminateselfwithresult">terminateSelfWithResult</a>接口销毁自身时，只将正常结果返回给最后一个调用方，其它调用方返回异常结果，异常结果中resultCode为-1。</li>     </ul>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>组件启动规则详见：<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/component-startup-rules" target="_blank">组件启动规则（Stage模型）</a>。</p>      </div></div></div>     <p><strong>元服务API</strong>：从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.11.10.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.11.10.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.11.10.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.11.10.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">want</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-want">Want</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">启动Ability的必要信息。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">options</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-startoptions">StartOptions</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">启动Ability所携带的参数。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-ability-abilityresult">AbilityResult</a>&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数，当接口调用成功，err中code为0，data为被拉起方退出时的结果码和数据；否则err会返回对应的错误码和错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-ability">元能力子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.11.13.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.11.13.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">The application does not have permission to call the interface.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1.Mandatory parameters are left unspecified. 2.Incorrect parameter types.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000001</td>         <td class="cellrowborder" width="50%">The specified ability does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000004</td>         <td class="cellrowborder" width="50%">Cannot start an invisible component.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000005</td>         <td class="cellrowborder" width="50%">The specified process does not have the permission.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000006</td>         <td class="cellrowborder" width="50%">Cross-user operations are not allowed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000008</td>         <td class="cellrowborder" width="50%">The crowdtesting application expires.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000009</td>         <td class="cellrowborder" width="50%">An ability cannot be started or stopped in Wukong mode.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000011</td>         <td class="cellrowborder" width="50%">The context does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000012</td>         <td class="cellrowborder" width="50%">The application is controlled.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000013</td>         <td class="cellrowborder" width="50%">The application is controlled by EDM.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000018</td>         <td class="cellrowborder" width="50%">Redirection to a third-party application is not allowed in API version greater than 11.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000019</td>         <td class="cellrowborder" width="50%">No matching ability is found.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000050</td>         <td class="cellrowborder" width="50%">Internal error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000053</td>         <td class="cellrowborder" width="50%">The ability is not on the top of the UI.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000055</td>         <td class="cellrowborder" width="50%">Installation-free timed out.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000071</td>         <td class="cellrowborder" width="50%">App clone is not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000072</td>         <td class="cellrowborder" width="50%">App clone or multi-instance is not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000073</td>         <td class="cellrowborder" width="50%">The app clone index is invalid.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000076</td>         <td class="cellrowborder" width="50%">The app instance key is invalid.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000077</td>         <td class="cellrowborder" width="50%">The number of app instances reaches the limit.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000078</td>         <td class="cellrowborder" width="50%">The multi-instance is not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000079</td>         <td class="cellrowborder" width="50%">The APP_INSTANCE_KEY cannot be specified.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000080</td>         <td class="cellrowborder" width="50%">Creating a new instance is not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16200001</td>         <td class="cellrowborder" width="50%">The caller has been released.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-gnv-c106="" class="highlight-div"><div _ngcontent-gnv-c106="" class="highlight-div-header"><div _ngcontent-gnv-c106="" class="highlight-div-header-left"><div _ngcontent-gnv-c106="" class="handle-button expand-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gnv-c106="" class="highlight-div-header-right"><div _ngcontent-gnv-c106="" class="handle-button ai-button"></div><div _ngcontent-gnv-c106="" class="handle-button line-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gnv-c106="" class="handle-button theme-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gnv-c106="" class="handle-button copy-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gnv-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span>, <span class="hljs-title class_">Want</span>, common, <span class="hljs-title class_">StartOptions</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onForeground</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">want</span>: <span class="hljs-title class_">Want</span> = {</li><li>      <span class="hljs-attr">deviceId</span>: <span class="hljs-string">''</span>,</li><li>      <span class="hljs-attr">bundleName</span>: <span class="hljs-string">'com.example.myapplication'</span>,</li><li>      <span class="hljs-attr">abilityName</span>: <span class="hljs-string">'EntryAbility'</span></li><li>    };</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">options</span>: <span class="hljs-title class_">StartOptions</span> = {</li><li>      <span class="hljs-attr">displayId</span>: <span class="hljs-number">0</span></li><li>    };</li><li>
</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">startAbilityForResult</span>(want, options, <span class="hljs-function">(<span class="hljs-params">err: BusinessError, result: common.AbilityResult</span>) =&gt;</span> {</li><li>        <span class="hljs-keyword">if</span> (err.<span class="hljs-property">code</span>) {</li><li>          <span class="hljs-comment">// 处理业务逻辑错误</span></li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`startAbilityForResult failed, code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>          <span class="hljs-keyword">return</span>;</li><li>        }</li><li>        <span class="hljs-comment">// 执行正常业务</span></li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'startAbilityForResult succeed'</span>);</li><li>      });</li><li>    } <span class="hljs-keyword">catch</span> (err) {</li><li>      <span class="hljs-comment">// 处理入参错误异常</span></li><li>      <span class="hljs-keyword">let</span> code = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span>;</li><li>      <span class="hljs-keyword">let</span> message = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>;</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`startAbilityForResult failed, code is <span class="hljs-subst">${code}</span>, message is <span class="hljs-subst">${message}</span>`</span>);</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 3611px;">     <h3 id="startabilityforresult-2" device-type="phone,2in1,tablet,wearable,tv">startAbilityForResult<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="startabilityforresult-2" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>startAbilityForResult(want: Want, options?: StartOptions): Promise&lt;AbilityResult&gt;</p>     <p>启动一个UIAbility，并通过回调函数接收被拉起的UIAbility退出时的返回结果。使用Promise异步回调。仅支持在主线程调用。</p>     <p>UIAbility被启动后，有如下情况：</p>     <ul>      <li>正常情况下可以通过调用<a href="/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext#terminateselfwithresult">terminateSelfWithResult</a>接口销毁自身，并将结果返回给调用方。</li>      <li>异常情况下比如杀死UIAbility会将异常结果返回给调用方，异常结果中resultCode为-1。</li>      <li>如果被启动的UIAbility是<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/uiability-launch-type#singleton启动模式" target="_blank">单实例模式</a>，且这个UIAbility被不同应用多次调用该接口启动，当这个UIAbility调用<a href="/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext#terminateselfwithresult">terminateSelfWithResult</a>接口销毁自身时，只将正常结果返回给最后一个调用方，其它调用方返回异常结果，异常结果中resultCode为-1。</li>     </ul>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>组件启动规则详见：<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/component-startup-rules" target="_blank">组件启动规则（Stage模型）</a>。</p>      </div></div></div>     <p><strong>元服务API</strong>：从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.12.10.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.12.10.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.12.10.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.12.10.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">want</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-want">Want</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">启动Ability的必要信息。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">options</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-startoptions">StartOptions</a></td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">启动Ability所携带的参数。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.12.12.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.12.12.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-ability-abilityresult">AbilityResult</a>&gt;</td>         <td class="cellrowborder" width="50%">Promise对象，包含返回给拉起方的信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-ability">元能力子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.12.15.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.12.15.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">The application does not have permission to call the interface.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1.Mandatory parameters are left unspecified. 2.Incorrect parameter types.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000001</td>         <td class="cellrowborder" width="50%">The specified ability does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000002</td>         <td class="cellrowborder" width="50%">Incorrect ability type.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000004</td>         <td class="cellrowborder" width="50%">Cannot start an invisible component.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000005</td>         <td class="cellrowborder" width="50%">The specified process does not have the permission.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000006</td>         <td class="cellrowborder" width="50%">Cross-user operations are not allowed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000008</td>         <td class="cellrowborder" width="50%">The crowdtesting application expires.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000009</td>         <td class="cellrowborder" width="50%">An ability cannot be started or stopped in Wukong mode.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000010</td>         <td class="cellrowborder" width="50%">The call with the continuation and prepare continuation flag is forbidden.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000011</td>         <td class="cellrowborder" width="50%">The context does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000012</td>         <td class="cellrowborder" width="50%">The application is controlled.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000013</td>         <td class="cellrowborder" width="50%">The application is controlled by EDM.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000018</td>         <td class="cellrowborder" width="50%">Redirection to a third-party application is not allowed in API version greater than 11.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000019</td>         <td class="cellrowborder" width="50%">No matching ability is found.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000050</td>         <td class="cellrowborder" width="50%">Internal error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000053</td>         <td class="cellrowborder" width="50%">The ability is not on the top of the UI.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000055</td>         <td class="cellrowborder" width="50%">Installation-free timed out.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000071</td>         <td class="cellrowborder" width="50%">App clone is not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000072</td>         <td class="cellrowborder" width="50%">App clone or multi-instance is not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000073</td>         <td class="cellrowborder" width="50%">The app clone index is invalid.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000076</td>         <td class="cellrowborder" width="50%">The app instance key is invalid.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000077</td>         <td class="cellrowborder" width="50%">The number of app instances reaches the limit.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000078</td>         <td class="cellrowborder" width="50%">The multi-instance is not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000079</td>         <td class="cellrowborder" width="50%">The APP_INSTANCE_KEY cannot be specified.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000080</td>         <td class="cellrowborder" width="50%">Creating a new instance is not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16200001</td>         <td class="cellrowborder" width="50%">The caller has been released.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-gnv-c106="" class="highlight-div"><div _ngcontent-gnv-c106="" class="highlight-div-header"><div _ngcontent-gnv-c106="" class="highlight-div-header-left"><div _ngcontent-gnv-c106="" class="handle-button expand-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gnv-c106="" class="highlight-div-header-right"><div _ngcontent-gnv-c106="" class="handle-button ai-button"></div><div _ngcontent-gnv-c106="" class="handle-button line-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gnv-c106="" class="handle-button theme-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gnv-c106="" class="handle-button copy-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gnv-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span>, <span class="hljs-title class_">Want</span>, common, <span class="hljs-title class_">StartOptions</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onForeground</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">want</span>: <span class="hljs-title class_">Want</span> = {</li><li>      <span class="hljs-attr">bundleName</span>: <span class="hljs-string">'com.example.myapplication'</span>,</li><li>      <span class="hljs-attr">abilityName</span>: <span class="hljs-string">'EntryAbility'</span></li><li>    };</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">options</span>: <span class="hljs-title class_">StartOptions</span> = {</li><li>      <span class="hljs-attr">displayId</span>: <span class="hljs-number">0</span></li><li>    };</li><li>
</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">startAbilityForResult</span>(want, options)</li><li>        .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">result: common.AbilityResult</span>) =&gt;</span> {</li><li>          <span class="hljs-comment">// 执行正常业务</span></li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'startAbilityForResult succeed'</span>);</li><li>        })</li><li>        .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>          <span class="hljs-comment">// 处理业务逻辑错误</span></li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`startAbilityForResult failed, code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>        });</li><li>    } <span class="hljs-keyword">catch</span> (err) {</li><li>      <span class="hljs-comment">// 处理入参错误异常</span></li><li>      <span class="hljs-keyword">let</span> code = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span>;</li><li>      <span class="hljs-keyword">let</span> message = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>;</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`startAbilityForResult failed, code is <span class="hljs-subst">${code}</span>, message is <span class="hljs-subst">${message}</span>`</span>);</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 2182px;">     <h3 id="terminateself" device-type="phone,2in1,tablet,wearable,tv">terminateSelf<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="terminateself" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>terminateSelf(callback: AsyncCallback&lt;void&gt;): void</p>     <p>销毁UIAbility自身。使用callback异步回调。仅支持在主线程调用。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>调用该接口后，任务中心的任务默认不会清理，如需清理，需要配置<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/module-configuration-file#abilities标签" target="_blank">removeMissionAfterTerminate</a>为true。</p>      </div></div></div>     <p><strong>元服务API</strong>：从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.13.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.13.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.13.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.13.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;void&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数，当销毁UIAbility自身成功，err中code为0；否则err会返回对应的错误码和错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-ability">元能力子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.13.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.13.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1.Mandatory parameters are left unspecified. 2.Incorrect parameter types.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000009</td>         <td class="cellrowborder" width="50%">An ability cannot be started or stopped in Wukong mode.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000011</td>         <td class="cellrowborder" width="50%">The context does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000050</td>         <td class="cellrowborder" width="50%">Internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <ol>      <li>       <p>使用terminateSelf接口停止UIAbility示例代码如下，默认情况下应用会在最近任务列表中保留快照。</p>       <div _ngcontent-gnv-c106="" class="highlight-div"><div _ngcontent-gnv-c106="" class="highlight-div-header"><div _ngcontent-gnv-c106="" class="highlight-div-header-left"><div _ngcontent-gnv-c106="" class="handle-button expand-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gnv-c106="" class="highlight-div-header-right"><div _ngcontent-gnv-c106="" class="handle-button ai-button"></div><div _ngcontent-gnv-c106="" class="handle-button line-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gnv-c106="" class="handle-button theme-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gnv-c106="" class="handle-button copy-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gnv-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onForeground</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">terminateSelf</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>        <span class="hljs-keyword">if</span> (err.<span class="hljs-property">code</span>) {</li><li>          <span class="hljs-comment">// 处理业务逻辑错误</span></li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`terminateSelf failed, code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>          <span class="hljs-keyword">return</span>;</li><li>        }</li><li>        <span class="hljs-comment">// 执行正常业务</span></li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'terminateSelf succeed'</span>);</li><li>      });</li><li>    } <span class="hljs-keyword">catch</span> (err) {</li><li>      <span class="hljs-comment">// 捕获同步的参数错误</span></li><li>      <span class="hljs-keyword">let</span> code = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span>;</li><li>      <span class="hljs-keyword">let</span> message = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>;</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`terminateSelf failed, code is <span class="hljs-subst">${code}</span>, message is <span class="hljs-subst">${message}</span>`</span>);</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div></li>      <li>       <p>（可选）如果需要在停止UIAbility时，清理任务中心的相关任务（即不保留最近任务列表中的快照），需要在<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/module-configuration-file" target="_blank">module.json5</a>配置文件中将removeMissionAfterTerminate字段取值配置为true。</p>       <div _ngcontent-gnv-c106="" class="highlight-div"><div _ngcontent-gnv-c106="" class="highlight-div-header"><div _ngcontent-gnv-c106="" class="highlight-div-header-left"><div _ngcontent-gnv-c106="" class="handle-button expand-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gnv-c106="" class="highlight-div-header-right"><div _ngcontent-gnv-c106="" class="handle-button ai-button"></div><div _ngcontent-gnv-c106="" class="handle-button line-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gnv-c106="" class="handle-button theme-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gnv-c106="" class="handle-button copy-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gnv-c106="" class="highlight-scroll-div"><pre class="json prettyprint linenums hljs language-json" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-punctuation">{</span></li><li>  <span class="hljs-attr">"module"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>    <span class="hljs-comment">// ...</span></li><li>    <span class="hljs-attr">"abilities"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span></li><li>      <span class="hljs-punctuation">{</span></li><li>        <span class="hljs-comment">// ...</span></li><li>        <span class="hljs-attr">"removeMissionAfterTerminate"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span></li><li>      <span class="hljs-punctuation">}</span></li><li>    <span class="hljs-punctuation">]</span></li><li>  <span class="hljs-punctuation">}</span></li><li><span class="hljs-punctuation">}</span></li></ol></pre></div></div></li>     </ol>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 2051px;">     <h3 id="terminateself-1" device-type="phone,2in1,tablet,wearable,tv">terminateSelf<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="terminateself-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>terminateSelf(): Promise&lt;void&gt;</p>     <p>销毁UIAbility自身。使用Promise异步回调。仅支持在主线程调用。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>调用该接口后，任务中心的任务默认不会清理，如需清理，需要配置<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/module-configuration-file#abilities标签" target="_blank">removeMissionAfterTerminate</a>为true。</p>      </div></div></div>     <p><strong>元服务API</strong>：从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.Core</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.14.8.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.14.8.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">Promise对象，无返回结果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-ability">元能力子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.14.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.14.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">16000009</td>         <td class="cellrowborder" width="50%">An ability cannot be started or stopped in Wukong mode.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000011</td>         <td class="cellrowborder" width="50%">The context does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000050</td>         <td class="cellrowborder" width="50%">Internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <ol>      <li>       <p>使用terminateSelf接口停止UIAbility示例代码如下，默认情况下应用会在最近任务列表中保留快照。</p>       <div _ngcontent-gnv-c106="" class="highlight-div"><div _ngcontent-gnv-c106="" class="highlight-div-header"><div _ngcontent-gnv-c106="" class="highlight-div-header-left"><div _ngcontent-gnv-c106="" class="handle-button expand-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gnv-c106="" class="highlight-div-header-right"><div _ngcontent-gnv-c106="" class="handle-button ai-button"></div><div _ngcontent-gnv-c106="" class="handle-button line-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gnv-c106="" class="handle-button theme-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gnv-c106="" class="handle-button copy-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gnv-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onForeground</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">terminateSelf</span>()</li><li>        .<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-comment">// 执行正常业务</span></li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'terminateSelf succeed'</span>);</li><li>        })</li><li>        .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>          <span class="hljs-comment">// 处理业务逻辑错误</span></li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`terminateSelf failed, code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>        });</li><li>    } <span class="hljs-keyword">catch</span> (err) {</li><li>      <span class="hljs-comment">// 捕获同步的参数错误</span></li><li>      <span class="hljs-keyword">let</span> code = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span>;</li><li>      <span class="hljs-keyword">let</span> message = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>;</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`terminateSelf failed, code is <span class="hljs-subst">${code}</span>, message is <span class="hljs-subst">${message}</span>`</span>);</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div></li>      <li>       <p>（可选）如果需要在停止UIAbility时，清理任务中心的相关任务（即不保留最近任务列表中的快照），需要在<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/module-configuration-file" target="_blank">module.json5</a>配置文件中将removeMissionAfterTerminate字段取值配置为true。</p>       <div _ngcontent-gnv-c106="" class="highlight-div"><div _ngcontent-gnv-c106="" class="highlight-div-header"><div _ngcontent-gnv-c106="" class="highlight-div-header-left"><div _ngcontent-gnv-c106="" class="handle-button expand-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gnv-c106="" class="highlight-div-header-right"><div _ngcontent-gnv-c106="" class="handle-button ai-button"></div><div _ngcontent-gnv-c106="" class="handle-button line-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gnv-c106="" class="handle-button theme-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gnv-c106="" class="handle-button copy-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gnv-c106="" class="highlight-scroll-div"><pre class="json prettyprint linenums hljs language-json" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-punctuation">{</span></li><li>  <span class="hljs-attr">"module"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>    <span class="hljs-comment">// ...</span></li><li>    <span class="hljs-attr">"abilities"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span></li><li>      <span class="hljs-punctuation">{</span></li><li>        <span class="hljs-comment">// ...</span></li><li>        <span class="hljs-attr">"removeMissionAfterTerminate"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span></li><li>      <span class="hljs-punctuation">}</span></li><li>    <span class="hljs-punctuation">]</span></li><li>  <span class="hljs-punctuation">}</span></li><li><span class="hljs-punctuation">}</span></li></ol></pre></div></div></li>     </ol>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 2111px;">     <h3 id="terminateselfwithresult" device-type="phone,2in1,tablet,wearable,tv">terminateSelfWithResult<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="terminateselfwithresult" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>terminateSelfWithResult(parameter: AbilityResult, callback: AsyncCallback&lt;void&gt;): void</p>     <p>销毁UIAbility自身。使用callback异步回调。仅支持在主线程调用。</p>     <p>仅当UIAbility通过<a href="/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext#startabilityforresult">startAbilityForResult</a>接口拉起时，调用terminateSelfWithResult接口销毁UIAbility，才会返回结果给调用方。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>调用该接口后，任务中心的任务默认不会清理，如需清理，需要配置<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/module-configuration-file#abilities标签" target="_blank">removeMissionAfterTerminate</a>为true。</p>      </div></div></div>     <p><strong>元服务API</strong>：从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.15.9.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.15.9.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.15.9.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.15.9.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">parameter</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-ability-abilityresult">AbilityResult</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">返回给startAbilityForResult 接口调用方的相关信息。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;void&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数，当销毁UIAbility自身成功，err中code为0；否则err会返回对应的错误码和错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-ability">元能力子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.15.12.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.15.12.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1.Mandatory parameters are left unspecified. 2.Incorrect parameter types.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000009</td>         <td class="cellrowborder" width="50%">An ability cannot be started or stopped in Wukong mode.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000011</td>         <td class="cellrowborder" width="50%">The context does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000050</td>         <td class="cellrowborder" width="50%">Internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-gnv-c106="" class="highlight-div"><div _ngcontent-gnv-c106="" class="highlight-div-header"><div _ngcontent-gnv-c106="" class="highlight-div-header-left"><div _ngcontent-gnv-c106="" class="handle-button expand-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gnv-c106="" class="highlight-div-header-right"><div _ngcontent-gnv-c106="" class="handle-button ai-button"></div><div _ngcontent-gnv-c106="" class="handle-button line-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gnv-c106="" class="handle-button theme-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gnv-c106="" class="handle-button copy-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gnv-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span>, <span class="hljs-title class_">Want</span>, common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onForeground</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">want</span>: <span class="hljs-title class_">Want</span> = {</li><li>      <span class="hljs-attr">bundleName</span>: <span class="hljs-string">'com.example.myapplication'</span>,</li><li>      <span class="hljs-attr">abilityName</span>: <span class="hljs-string">'EntryAbility'</span></li><li>    };</li><li>    <span class="hljs-keyword">let</span> resultCode = <span class="hljs-number">100</span>;</li><li>    <span class="hljs-comment">// 返回给接口调用方AbilityResult信息</span></li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">abilityResult</span>: common.<span class="hljs-property">AbilityResult</span> = {</li><li>      want,</li><li>      resultCode</li><li>    };</li><li>
</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">terminateSelfWithResult</span>(abilityResult, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>        <span class="hljs-keyword">if</span> (err.<span class="hljs-property">code</span>) {</li><li>          <span class="hljs-comment">// 处理业务逻辑错误</span></li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`terminateSelfWithResult failed, code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>          <span class="hljs-keyword">return</span>;</li><li>        }</li><li>        <span class="hljs-comment">// 执行正常业务</span></li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'terminateSelfWithResult succeed'</span>);</li><li>      });</li><li>    } <span class="hljs-keyword">catch</span> (err) {</li><li>      <span class="hljs-comment">// 处理入参错误异常</span></li><li>      <span class="hljs-keyword">let</span> code = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span>;</li><li>      <span class="hljs-keyword">let</span> message = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>;</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`terminateSelfWithResult failed, code is <span class="hljs-subst">${code}</span>, message is <span class="hljs-subst">${message}</span>`</span>);</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 2165px;">     <h3 id="terminateselfwithresult-1" device-type="phone,2in1,tablet,wearable,tv">terminateSelfWithResult<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="terminateselfwithresult-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>terminateSelfWithResult(parameter: AbilityResult): Promise&lt;void&gt;</p>     <p>销毁UIAbility自身。使用Promise异步回调。仅支持在主线程调用。</p>     <p>仅当UIAbility通过<a href="/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext#startabilityforresult">startAbilityForResult</a>接口拉起时，调用terminateSelfWithResult接口销毁UIAbility，才会返回结果给调用方。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>调用该接口后，任务中心的任务默认不会清理，如需清理，需要配置<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/module-configuration-file#abilities标签" target="_blank">removeMissionAfterTerminate</a>为true。</p>      </div></div></div>     <p><strong>元服务API</strong>：从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.16.9.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.16.9.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.16.9.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.16.9.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">parameter</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-ability-abilityresult">AbilityResult</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">返回给startAbilityForResult 接口调用方的信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.16.11.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.16.11.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">Promise对象，无返回结果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-ability">元能力子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.16.14.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.16.14.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1.Mandatory parameters are left unspecified. 2.Incorrect parameter types.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000009</td>         <td class="cellrowborder" width="50%">An ability cannot be started or stopped in Wukong mode.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000011</td>         <td class="cellrowborder" width="50%">The context does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000050</td>         <td class="cellrowborder" width="50%">Internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-gnv-c106="" class="highlight-div"><div _ngcontent-gnv-c106="" class="highlight-div-header"><div _ngcontent-gnv-c106="" class="highlight-div-header-left"><div _ngcontent-gnv-c106="" class="handle-button expand-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gnv-c106="" class="highlight-div-header-right"><div _ngcontent-gnv-c106="" class="handle-button ai-button"></div><div _ngcontent-gnv-c106="" class="handle-button line-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gnv-c106="" class="handle-button theme-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gnv-c106="" class="handle-button copy-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gnv-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span>, <span class="hljs-title class_">Want</span>, common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onForeground</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">want</span>: <span class="hljs-title class_">Want</span> = {</li><li>      <span class="hljs-attr">bundleName</span>: <span class="hljs-string">'com.example.myapplication'</span>,</li><li>      <span class="hljs-attr">abilityName</span>: <span class="hljs-string">'EntryAbility'</span></li><li>    };</li><li>    <span class="hljs-keyword">let</span> resultCode = <span class="hljs-number">100</span>;</li><li>    <span class="hljs-comment">// 返回给接口调用方AbilityResult信息</span></li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">abilityResult</span>: common.<span class="hljs-property">AbilityResult</span> = {</li><li>      want,</li><li>      resultCode</li><li>    };</li><li>
</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">terminateSelfWithResult</span>(abilityResult)</li><li>        .<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-comment">// 执行正常业务</span></li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'terminateSelfWithResult succeed'</span>);</li><li>        })</li><li>        .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>          <span class="hljs-comment">// 处理业务逻辑错误</span></li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`terminateSelfWithResult failed, code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>        });</li><li>    } <span class="hljs-keyword">catch</span> (err) {</li><li>      <span class="hljs-comment">// 处理入参错误异常</span></li><li>      <span class="hljs-keyword">let</span> code = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span>;</li><li>      <span class="hljs-keyword">let</span> message = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>;</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`terminateSelfWithResult failed, code is <span class="hljs-subst">${code}</span>, message is <span class="hljs-subst">${message}</span>`</span>);</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 2746px;">     <h3 id="connectserviceextensionability" device-type="phone,2in1,tablet,wearable,tv">connectServiceExtensionAbility<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="connectserviceextensionability" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>connectServiceExtensionAbility(want: Want, options: ConnectOptions): number</p>     <p>将当前UIAbility连接到一个<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/extensionability-overview" target="_blank">ServiceExtensionAbility</a>，通过返回的proxy与ServiceExtensionAbility进行通信，以使用ServiceExtensionAbility对外提供的能力。仅支持在主线程调用。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>组件启动规则详见：<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/component-startup-rules" target="_blank">组件启动规则（Stage模型）</a>。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.17.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.17.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.17.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.17.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">want</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-want">Want</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">连接ServiceExtensionAbility的Want信息。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">options</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-ability-connectoptions">ConnectOptions</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调对象，返回服务连接成功、连接失败、断开的信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.17.9.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.17.9.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">number</td>         <td class="cellrowborder" width="50%">返回连接id，调用方可以通过<a href="/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext#disconnectserviceextensionability">disconnectServiceExtensionAbility</a>传入该连接id来断开连接。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-ability">元能力子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.17.12.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.17.12.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">The application does not have permission to call the interface.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1.Mandatory parameters are left unspecified. 2.Incorrect parameter types.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000001</td>         <td class="cellrowborder" width="50%">The specified ability does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000002</td>         <td class="cellrowborder" width="50%">Incorrect ability type.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000004</td>         <td class="cellrowborder" width="50%">Cannot start an invisible component.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000005</td>         <td class="cellrowborder" width="50%">The specified process does not have the permission.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000006</td>         <td class="cellrowborder" width="50%">Cross-user operations are not allowed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000008</td>         <td class="cellrowborder" width="50%">The crowdtesting application expires.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000011</td>         <td class="cellrowborder" width="50%">The context does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000050</td>         <td class="cellrowborder" width="50%">Internal error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000053</td>         <td class="cellrowborder" width="50%">The ability is not on the top of the UI.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000055</td>         <td class="cellrowborder" width="50%">Installation-free timed out.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-gnv-c106="" class="highlight-div"><div _ngcontent-gnv-c106="" class="highlight-div-header"><div _ngcontent-gnv-c106="" class="highlight-div-header-left"><div _ngcontent-gnv-c106="" class="handle-button expand-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gnv-c106="" class="highlight-div-header-right"><div _ngcontent-gnv-c106="" class="handle-button ai-button"></div><div _ngcontent-gnv-c106="" class="handle-button line-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gnv-c106="" class="handle-button theme-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gnv-c106="" class="handle-button copy-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gnv-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span>, <span class="hljs-title class_">Want</span>, common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { rpc } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.IPCKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onForeground</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">want</span>: <span class="hljs-title class_">Want</span> = {</li><li>      <span class="hljs-attr">deviceId</span>: <span class="hljs-string">''</span>,</li><li>      <span class="hljs-attr">bundleName</span>: <span class="hljs-string">'com.example.myapplication'</span>,</li><li>      <span class="hljs-attr">abilityName</span>: <span class="hljs-string">'ServiceExtensionAbility'</span></li><li>    };</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">commRemote</span>: rpc.<span class="hljs-property">IRemoteObject</span>;</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">options</span>: common.<span class="hljs-property">ConnectOptions</span> = {</li><li>      <span class="hljs-title function_">onConnect</span>(<span class="hljs-params">elementName, remote</span>) {</li><li>        commRemote = remote;</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'onConnect...'</span>);</li><li>      },</li><li>      <span class="hljs-title function_">onDisconnect</span>(<span class="hljs-params">elementName</span>) {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'onDisconnect...'</span>);</li><li>      },</li><li>      <span class="hljs-title function_">onFailed</span>(<span class="hljs-params">code</span>) {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'onFailed...'</span>);</li><li>      }</li><li>    };</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">connection</span>: <span class="hljs-built_in">number</span>;</li><li>
</li><li>    <span class="hljs-keyword">try</span> {</li><li>      connection = <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">connectServiceExtensionAbility</span>(want, options);</li><li>    } <span class="hljs-keyword">catch</span> (err) {</li><li>      <span class="hljs-comment">// 处理入参错误异常</span></li><li>      <span class="hljs-keyword">let</span> code = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span>;</li><li>      <span class="hljs-keyword">let</span> message = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>;</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`connectServiceExtensionAbility failed, code is <span class="hljs-subst">${code}</span>, message is <span class="hljs-subst">${message}</span>`</span>);</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1874px;">     <h3 id="disconnectserviceextensionability" device-type="phone,2in1,tablet,wearable,tv">disconnectServiceExtensionAbility<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="disconnectserviceextensionability" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>disconnectServiceExtensionAbility(connection: number): Promise&lt;void&gt;</p>     <p>断开与<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/extensionability-overview" target="_blank">ServiceExtensionAbility</a>的连接，断开连接之后开发者需要将连接成功时返回的remote对象置空。使用Promise异步回调。仅支持在主线程调用。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.18.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.18.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.18.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.18.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">connection</td>         <td class="cellrowborder" width="25%">number</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">连接的ServiceExtensionAbility的标识id，即<a href="/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext#connectserviceextensionability">connectServiceExtensionAbility</a>返回的connectionId。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.18.8.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.18.8.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">Promise对象，无返回结果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-ability">元能力子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.18.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.18.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1.Mandatory parameters are left unspecified. 2.Incorrect parameter types.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000011</td>         <td class="cellrowborder" width="50%">The context does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000050</td>         <td class="cellrowborder" width="50%">Internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-gnv-c106="" class="highlight-div"><div _ngcontent-gnv-c106="" class="highlight-div-header"><div _ngcontent-gnv-c106="" class="highlight-div-header-left"><div _ngcontent-gnv-c106="" class="handle-button expand-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gnv-c106="" class="highlight-div-header-right"><div _ngcontent-gnv-c106="" class="handle-button ai-button"></div><div _ngcontent-gnv-c106="" class="handle-button line-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gnv-c106="" class="handle-button theme-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gnv-c106="" class="handle-button copy-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gnv-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { rpc } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.IPCKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onForeground</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-comment">// connection为connectServiceExtensionAbility中的返回值</span></li><li>    <span class="hljs-keyword">let</span> connection = <span class="hljs-number">1</span>;</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">commRemote</span>: rpc.<span class="hljs-property">IRemoteObject</span> | <span class="hljs-literal">null</span>;</li><li>
</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">disconnectServiceExtensionAbility</span>(connection).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>        commRemote = <span class="hljs-literal">null</span>;</li><li>        <span class="hljs-comment">// 执行正常业务</span></li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'disconnectServiceExtensionAbility succeed'</span>);</li><li>      }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>        <span class="hljs-comment">// 处理业务逻辑错误</span></li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`disconnectServiceExtensionAbility failed, code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>      });</li><li>    } <span class="hljs-keyword">catch</span> (err) {</li><li>      commRemote = <span class="hljs-literal">null</span>;</li><li>      <span class="hljs-comment">// 处理入参错误异常</span></li><li>      <span class="hljs-keyword">let</span> code = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span>;</li><li>      <span class="hljs-keyword">let</span> message = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>;</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`disconnectServiceExtensionAbility failed, code is <span class="hljs-subst">${code}</span>, message is <span class="hljs-subst">${message}</span>`</span>);</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1868px;">     <h3 id="disconnectserviceextensionability-1" device-type="phone,2in1,tablet,wearable,tv">disconnectServiceExtensionAbility<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="disconnectserviceextensionability-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>disconnectServiceExtensionAbility(connection: number, callback: AsyncCallback&lt;void&gt;): void</p>     <p>断开与<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/extensionability-overview" target="_blank">ServiceExtensionAbility</a>的连接，断开连接之后开发者需要将连接成功时返回的remote对象置空。使用callback异步回调。仅支持在主线程调用。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.19.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.19.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.19.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.19.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">connection</td>         <td class="cellrowborder" width="25%">number</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">连接的ServiceExtensionAbility的标识id，即<a href="/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext#connectserviceextensionability">connectServiceExtensionAbility</a>返回的connectionId。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;void&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。当断开与ServiceExtensionAbility的连接成功，err为undefined；否则为错误对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-ability">元能力子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.19.9.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.19.9.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1.Mandatory parameters are left unspecified. 2.Incorrect parameter types.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000011</td>         <td class="cellrowborder" width="50%">The context does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000050</td>         <td class="cellrowborder" width="50%">Internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-gnv-c106="" class="highlight-div"><div _ngcontent-gnv-c106="" class="highlight-div-header"><div _ngcontent-gnv-c106="" class="highlight-div-header-left"><div _ngcontent-gnv-c106="" class="handle-button expand-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gnv-c106="" class="highlight-div-header-right"><div _ngcontent-gnv-c106="" class="handle-button ai-button"></div><div _ngcontent-gnv-c106="" class="handle-button line-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gnv-c106="" class="handle-button theme-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gnv-c106="" class="handle-button copy-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gnv-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { rpc } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.IPCKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onForeground</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-comment">// connection为connectServiceExtensionAbility中的返回值</span></li><li>    <span class="hljs-keyword">let</span> connection = <span class="hljs-number">1</span>;</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">commRemote</span>: rpc.<span class="hljs-property">IRemoteObject</span> | <span class="hljs-literal">null</span>;</li><li>
</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">disconnectServiceExtensionAbility</span>(connection, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>        commRemote = <span class="hljs-literal">null</span>;</li><li>        <span class="hljs-keyword">if</span> (err.<span class="hljs-property">code</span>) {</li><li>          <span class="hljs-comment">// 处理业务逻辑错误</span></li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`disconnectServiceExtensionAbility failed, code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>          <span class="hljs-keyword">return</span>;</li><li>        }</li><li>        <span class="hljs-comment">// 执行正常业务</span></li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'disconnectServiceExtensionAbility succeed'</span>);</li><li>      });</li><li>    } <span class="hljs-keyword">catch</span> (err) {</li><li>      commRemote = <span class="hljs-literal">null</span>;</li><li>      <span class="hljs-comment">// 处理入参错误异常</span></li><li>      <span class="hljs-keyword">let</span> code = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span>;</li><li>      <span class="hljs-keyword">let</span> message = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>;</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`disconnectServiceExtensionAbility failed, code is <span class="hljs-subst">${code}</span>, message is <span class="hljs-subst">${message}</span>`</span>);</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 4589px;">     <h3 id="startabilitybycall" device-type="phone,2in1,tablet,wearable,tv">startAbilityByCall<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="startabilitybycall" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>startAbilityByCall(want: Want): Promise&lt;Caller&gt;</p>     <p>该接口用于获取<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability#caller">Caller</a>通信对象，以便于与<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability#callee">callee</a>进行通信。如果指定UIAbility未启动，则会将UIAbility启动至前台或后台。使用Promise异步回调。仅支持在主线程调用。</p>     <p>该接口不支持拉起启动模式为<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/uiability-launch-type#specified启动模式" target="_blank">specified模式</a>的UIAbility。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <ul>        <li>         <p>跨设备场景下，调用方与目标方必须为同一应用，且具备ohos.permission.DISTRIBUTED_DATASYNC权限，才能启动成功。</p></li>        <li>         <p>同设备场景下，调用方与目标方必须为不同应用，且具备ohos.permission.ABILITY_BACKGROUND_COMMUNICATION权限（该权限仅系统应用可申请），才能启动成功。</p></li>        <li>         <p>如果调用方位于后台，还需要具备ohos.permission.START_ABILITIES_FROM_BACKGROUND（该权限仅系统应用可申请）。更多的组件启动规则详见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/component-startup-rules" target="_blank">组件启动规则（Stage模型）</a>。</p></li>       </ul>      </div></div></div>     <p><strong>需要权限</strong>：ohos.permission.DISTRIBUTED_DATASYNC</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>API version 11之前的版本，该接口需要申请权限ohos.permission.ABILITY_BACKGROUND_COMMUNICATION（该权限仅系统应用可申请）。从API version 11开始，该接口需要申请的权限变更为ohos.permission.DISTRIBUTED_DATASYNC权限。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.20.10.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.20.10.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.20.10.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.20.10.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">want</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-want">Want</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">传入需要启动的UIAbility信息，包含abilityName、moduleName、bundleName、deviceId、parameters（可选）。将parameters中的'ohos.aafwk.param.callAbilityToForeground'配置为true可将UIAbility拉起到前台；否则表示将UIAbility拉起到后台。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.20.12.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.20.12.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability#caller">Caller</a>&gt;</td>         <td class="cellrowborder" width="50%">Promise对象，获取要通讯的caller对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-ability">元能力子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.20.15.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.20.15.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">The application does not have permission to call the interface.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1.Mandatory parameters are left unspecified. 2.Incorrect parameter types.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000001</td>         <td class="cellrowborder" width="50%">The specified ability does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000002</td>         <td class="cellrowborder" width="50%">Incorrect ability type.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000004</td>         <td class="cellrowborder" width="50%">Cannot start an invisible component.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000006</td>         <td class="cellrowborder" width="50%">Cross-user operations are not allowed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000008</td>         <td class="cellrowborder" width="50%">The crowdtesting application expires.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000011</td>         <td class="cellrowborder" width="50%">The context does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000012</td>         <td class="cellrowborder" width="50%">The application is controlled.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000013</td>         <td class="cellrowborder" width="50%">The application is controlled by EDM.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000018</td>         <td class="cellrowborder" width="50%">Redirection to a third-party application is not allowed in API version greater than 11.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000050</td>         <td class="cellrowborder" width="50%">Internal error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000071</td>         <td class="cellrowborder" width="50%">App clone is not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000072</td>         <td class="cellrowborder" width="50%">App clone or multi-instance is not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000073</td>         <td class="cellrowborder" width="50%">The app clone index is invalid.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000076</td>         <td class="cellrowborder" width="50%">The app instance key is invalid.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000077</td>         <td class="cellrowborder" width="50%">The number of app instances reaches the limit.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000078</td>         <td class="cellrowborder" width="50%">The multi-instance is not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000079</td>         <td class="cellrowborder" width="50%">The APP_INSTANCE_KEY cannot be specified.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000080</td>         <td class="cellrowborder" width="50%">Creating a new instance is not supported.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <p>后台启动：</p>     <div _ngcontent-gnv-c106="" class="highlight-div"><div _ngcontent-gnv-c106="" class="highlight-div-header"><div _ngcontent-gnv-c106="" class="highlight-div-header-left"><div _ngcontent-gnv-c106="" class="handle-button expand-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gnv-c106="" class="highlight-div-header-right"><div _ngcontent-gnv-c106="" class="handle-button ai-button"></div><div _ngcontent-gnv-c106="" class="handle-button line-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gnv-c106="" class="handle-button theme-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gnv-c106="" class="handle-button copy-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gnv-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span>, <span class="hljs-title class_">Caller</span>, <span class="hljs-title class_">Want</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onForeground</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">caller</span>: <span class="hljs-title class_">Caller</span>;</li><li>    <span class="hljs-comment">// 后台启动Ability，不配置parameters</span></li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">wantBackground</span>: <span class="hljs-title class_">Want</span> = {</li><li>      <span class="hljs-attr">bundleName</span>: <span class="hljs-string">'com.example.myapplication'</span>,</li><li>      <span class="hljs-attr">moduleName</span>: <span class="hljs-string">'entry'</span>,</li><li>      <span class="hljs-attr">abilityName</span>: <span class="hljs-string">'EntryAbility'</span>,</li><li>      <span class="hljs-attr">deviceId</span>: <span class="hljs-string">''</span></li><li>    };</li><li>
</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">startAbilityByCall</span>(wantBackground)</li><li>        .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">obj: Caller</span>) =&gt;</span> {</li><li>          <span class="hljs-comment">// 执行正常业务</span></li><li>          caller = obj;</li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'startAbilityByCall succeed'</span>);</li><li>        }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>        <span class="hljs-comment">// 处理业务逻辑错误</span></li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`startAbilityByCall failed, code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>      });</li><li>    } <span class="hljs-keyword">catch</span> (err) {</li><li>      <span class="hljs-comment">// 处理入参错误异常</span></li><li>      <span class="hljs-keyword">let</span> code = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span>;</li><li>      <span class="hljs-keyword">let</span> message = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>;</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`startAbilityByCall failed, code is <span class="hljs-subst">${code}</span>, message is <span class="hljs-subst">${message}</span>`</span>);</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>     <p>前台启动：</p>     <div _ngcontent-gnv-c106="" class="highlight-div"><div _ngcontent-gnv-c106="" class="highlight-div-header"><div _ngcontent-gnv-c106="" class="highlight-div-header-left"><div _ngcontent-gnv-c106="" class="handle-button expand-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gnv-c106="" class="highlight-div-header-right"><div _ngcontent-gnv-c106="" class="handle-button ai-button"></div><div _ngcontent-gnv-c106="" class="handle-button line-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gnv-c106="" class="handle-button theme-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gnv-c106="" class="handle-button copy-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gnv-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span>, <span class="hljs-title class_">Caller</span>, <span class="hljs-title class_">Want</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onForeground</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">caller</span>: <span class="hljs-title class_">Caller</span>;</li><li>    <span class="hljs-comment">// 前台启动Ability，将parameters中的'ohos.aafwk.param.callAbilityToForeground'配置为true</span></li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">wantForeground</span>: <span class="hljs-title class_">Want</span> = {</li><li>      <span class="hljs-attr">bundleName</span>: <span class="hljs-string">'com.example.myapplication'</span>,</li><li>      <span class="hljs-attr">moduleName</span>: <span class="hljs-string">'entry'</span>,</li><li>      <span class="hljs-attr">abilityName</span>: <span class="hljs-string">'EntryAbility'</span>,</li><li>      <span class="hljs-attr">deviceId</span>: <span class="hljs-string">''</span>,</li><li>      <span class="hljs-attr">parameters</span>: {</li><li>        <span class="hljs-string">'ohos.aafwk.param.callAbilityToForeground'</span>: <span class="hljs-literal">true</span></li><li>      }</li><li>    };</li><li>
</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">startAbilityByCall</span>(wantForeground)</li><li>        .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">obj: Caller</span>) =&gt;</span> {</li><li>          <span class="hljs-comment">// 执行正常业务</span></li><li>          caller = obj;</li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'startAbilityByCall succeed'</span>);</li><li>        }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>        <span class="hljs-comment">// 处理业务逻辑错误</span></li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`startAbilityByCall failed, code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>      });</li><li>    } <span class="hljs-keyword">catch</span> (err) {</li><li>      <span class="hljs-comment">// 处理入参错误异常</span></li><li>      <span class="hljs-keyword">let</span> code = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span>;</li><li>      <span class="hljs-keyword">let</span> message = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>;</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`startAbilityByCall failed, code is <span class="hljs-subst">${code}</span>, message is <span class="hljs-subst">${message}</span>`</span>);</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1340px;">     <h3 id="setmissionlabel" device-type="phone,2in1,tablet,wearable,tv">setMissionLabel<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="setmissionlabel" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>setMissionLabel(label: string, callback: AsyncCallback&lt;void&gt;): void</p>     <p>设置UIAbility在多任务界面中显示的名称。使用callback异步回调。</p>     <p><strong>元服务API</strong>：从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.21.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.21.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.21.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.21.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">label</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">任务的名称。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;void&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数，当设置UIAbility在多任务界面中显示的名称成功，err中code为0；否则err会返回对应的错误码和错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-ability">元能力子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.21.10.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.21.10.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1.Mandatory parameters are left unspecified. 2.Incorrect parameter types.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000011</td>         <td class="cellrowborder" width="50%">The context does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000050</td>         <td class="cellrowborder" width="50%">Internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-gnv-c106="" class="highlight-div"><div _ngcontent-gnv-c106="" class="highlight-div-header"><div _ngcontent-gnv-c106="" class="highlight-div-header-left"><div _ngcontent-gnv-c106="" class="handle-button expand-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gnv-c106="" class="highlight-div-header-right"><div _ngcontent-gnv-c106="" class="handle-button ai-button"></div><div _ngcontent-gnv-c106="" class="handle-button line-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gnv-c106="" class="handle-button theme-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gnv-c106="" class="handle-button copy-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gnv-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span>, <span class="hljs-title class_">AbilityConstant</span>, <span class="hljs-title class_">Want</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onCreate</span>(<span class="hljs-params">want: Want, launchParam: AbilityConstant.LaunchParam</span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">setMissionLabel</span>(<span class="hljs-string">'test'</span>, <span class="hljs-function">(<span class="hljs-params">result: BusinessError</span>) =&gt;</span> {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`setMissionLabel: <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(result)}</span>`</span>);</li><li>    });</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1466px;">     <h3 id="setmissionlabel-1" device-type="phone,2in1,tablet,wearable,tv">setMissionLabel<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="setmissionlabel-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>setMissionLabel(label: string): Promise&lt;void&gt;</p>     <p>设置UIAbility在多任务界面中显示的名称。使用Promise异步回调。</p>     <p><strong>元服务API</strong>：从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.22.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.22.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.22.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.22.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">label</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">任务的名称。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.22.9.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.22.9.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">Promise对象，包含接口执行结果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-ability">元能力子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.22.12.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.22.12.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1.Mandatory parameters are left unspecified. 2.Incorrect parameter types.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000011</td>         <td class="cellrowborder" width="50%">The context does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000050</td>         <td class="cellrowborder" width="50%">Internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-gnv-c106="" class="highlight-div"><div _ngcontent-gnv-c106="" class="highlight-div-header"><div _ngcontent-gnv-c106="" class="highlight-div-header-left"><div _ngcontent-gnv-c106="" class="handle-button expand-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gnv-c106="" class="highlight-div-header-right"><div _ngcontent-gnv-c106="" class="handle-button ai-button"></div><div _ngcontent-gnv-c106="" class="handle-button line-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gnv-c106="" class="handle-button theme-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gnv-c106="" class="handle-button copy-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gnv-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span>, <span class="hljs-title class_">AbilityConstant</span>, <span class="hljs-title class_">Want</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onCreate</span>(<span class="hljs-params">want: Want, launchParam: AbilityConstant.LaunchParam</span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">setMissionLabel</span>(<span class="hljs-string">'test'</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'success'</span>);</li><li>    }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>      <span class="hljs-keyword">let</span> code = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span>;</li><li>      <span class="hljs-keyword">let</span> message = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>;</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`setMissionLabel failed, code is <span class="hljs-subst">${code}</span>, message is <span class="hljs-subst">${message}</span>`</span>);</li><li>    });</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1340px;">     <h3 id="setmissioncontinuestate10" device-type="phone,2in1,tablet,wearable,tv">setMissionContinueState<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="setmissioncontinuestate10" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>setMissionContinueState(state: AbilityConstant.ContinueState, callback: AsyncCallback&lt;void&gt;): void</p>     <p>设置UIAbility任务的流转状态。使用callback异步回调。</p>     <p><strong>元服务API</strong>：从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.23.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.23.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.23.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.23.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">state</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-abilityconstant#continuestate10">AbilityConstant.ContinueState</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">流转状态。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;void&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数，当设置UIAbility任务的流转状态成功，err中code为0；否则err会返回对应的错误码和错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-ability">元能力子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.23.10.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.23.10.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1.Mandatory parameters are left unspecified. 2.Incorrect parameter types.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000011</td>         <td class="cellrowborder" width="50%">The context does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000050</td>         <td class="cellrowborder" width="50%">Internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-gnv-c106="" class="highlight-div"><div _ngcontent-gnv-c106="" class="highlight-div-header"><div _ngcontent-gnv-c106="" class="highlight-div-header-left"><div _ngcontent-gnv-c106="" class="handle-button expand-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gnv-c106="" class="highlight-div-header-right"><div _ngcontent-gnv-c106="" class="handle-button ai-button"></div><div _ngcontent-gnv-c106="" class="handle-button line-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gnv-c106="" class="handle-button theme-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gnv-c106="" class="handle-button copy-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gnv-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span>, <span class="hljs-title class_">AbilityConstant</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onForeground</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">setMissionContinueState</span>(<span class="hljs-title class_">AbilityConstant</span>.<span class="hljs-property">ContinueState</span>.<span class="hljs-property">INACTIVE</span>, <span class="hljs-function">(<span class="hljs-params">result: BusinessError</span>) =&gt;</span> {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`setMissionContinueState: <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(result)}</span>`</span>);</li><li>    });</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1442px;">     <h3 id="setmissioncontinuestate10-1" device-type="phone,2in1,tablet,wearable,tv">setMissionContinueState<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="setmissioncontinuestate10-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>setMissionContinueState(state: AbilityConstant.ContinueState): Promise&lt;void&gt;</p>     <p>设置UIAbility任务的流转状态。使用Promise异步回调。</p>     <p><strong>元服务API</strong>：从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.24.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.24.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.24.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.24.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">state</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-abilityconstant#continuestate10">AbilityConstant.ContinueState</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">流转状态。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.24.9.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.24.9.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">Promise对象，包含接口执行结果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-ability">元能力子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.24.12.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.24.12.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1.Mandatory parameters are left unspecified. 2.Incorrect parameter types.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000011</td>         <td class="cellrowborder" width="50%">The context does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000050</td>         <td class="cellrowborder" width="50%">Internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-gnv-c106="" class="highlight-div"><div _ngcontent-gnv-c106="" class="highlight-div-header"><div _ngcontent-gnv-c106="" class="highlight-div-header-left"><div _ngcontent-gnv-c106="" class="handle-button expand-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gnv-c106="" class="highlight-div-header-right"><div _ngcontent-gnv-c106="" class="handle-button ai-button"></div><div _ngcontent-gnv-c106="" class="handle-button line-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gnv-c106="" class="handle-button theme-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gnv-c106="" class="handle-button copy-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gnv-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span>, <span class="hljs-title class_">AbilityConstant</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onForeground</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">setMissionContinueState</span>(<span class="hljs-title class_">AbilityConstant</span>.<span class="hljs-property">ContinueState</span>.<span class="hljs-property">INACTIVE</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'success'</span>);</li><li>    }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`setMissionContinueState failed, code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>    });</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1175px;">     <h3 id="restorewindowstage" device-type="phone,2in1,tablet,wearable,tv">restoreWindowStage<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="restorewindowstage" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>restoreWindowStage(localStorage: LocalStorage): void</p>     <p>恢复UIAbility中的WindowStage数据。仅支持在主线程调用。</p>     <p><strong>元服务API</strong>：从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.25.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.25.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.25.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.25.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">localStorage</td>         <td class="cellrowborder" width="25%">LocalStorage</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">用于恢复window stage的存储数据。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-ability">元能力子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.25.10.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.25.10.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1.Mandatory parameters are left unspecified. 2.Incorrect parameter types.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000011</td>         <td class="cellrowborder" width="50%">The context does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000050</td>         <td class="cellrowborder" width="50%">Internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-gnv-c106="" class="highlight-div"><div _ngcontent-gnv-c106="" class="highlight-div-header"><div _ngcontent-gnv-c106="" class="highlight-div-header-left"><div _ngcontent-gnv-c106="" class="handle-button expand-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gnv-c106="" class="highlight-div-header-right"><div _ngcontent-gnv-c106="" class="handle-button ai-button"></div><div _ngcontent-gnv-c106="" class="handle-button line-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gnv-c106="" class="handle-button theme-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gnv-c106="" class="handle-button copy-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gnv-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onForeground</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">let</span> storage = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LocalStorage</span>();</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">restoreWindowStage</span>(storage);</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1061px;">     <h3 id="isterminating" device-type="phone,2in1,tablet,wearable,tv">isTerminating<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="isterminating" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>isTerminating(): boolean</p>     <p>查询UIAbility是否处于消亡中状态。</p>     <p><strong>元服务API</strong>：从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.Core</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.26.7.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.26.7.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">boolean</td>         <td class="cellrowborder" width="50%">表示是否处于消亡中状态。true表示处于消亡中状态，false表示不处于消亡中状态。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-ability">元能力子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.26.10.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.26.10.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">16000011</td>         <td class="cellrowborder" width="50%">The context does not exist.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-gnv-c106="" class="highlight-div"><div _ngcontent-gnv-c106="" class="highlight-div-header"><div _ngcontent-gnv-c106="" class="highlight-div-header-left"><div _ngcontent-gnv-c106="" class="handle-button expand-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gnv-c106="" class="highlight-div-header-right"><div _ngcontent-gnv-c106="" class="handle-button ai-button"></div><div _ngcontent-gnv-c106="" class="handle-button line-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gnv-c106="" class="handle-button theme-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gnv-c106="" class="handle-button copy-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gnv-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onForeground</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">isTerminating</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">isTerminating</span>();</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`ability state is <span class="hljs-subst">${isTerminating}</span>`</span>);</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 2754px;">     <h3 id="requestdialogservice" device-type="phone,2in1,tablet,wearable,tv">requestDialogService<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="requestdialogservice" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>requestDialogService(want: Want, result: AsyncCallback&lt;dialogRequest.RequestResult&gt;): void</p>     <p>启动一个支持模态弹框的ServiceExtensionAbility。ServiceExtensionAbility被启动后，应用弹出模态弹框，通过调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-dialogrequest#requestcallbacksetrequestresult">setRequestResult</a>接口返回结果给调用者。使用callback异步回调。仅支持在主线程调用。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>组件启动规则详见：<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/component-startup-rules" target="_blank">组件启动规则（Stage模型）</a>。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.27.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.27.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.27.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.27.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">want</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-want">Want</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">启动ServiceExtensionAbility的Want信息。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">result</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-dialogrequest#requestresult">dialogRequest.RequestResult</a>&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数，当启动一个支持模态弹框的ServiceExtensionAbility成功，err中code为0，data为模态弹框请求结果；否则err会返回对应的错误码和错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-ability">元能力子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.27.10.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.27.10.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">The application does not have permission to call the interface.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1.Mandatory parameters are left unspecified. 2.Incorrect parameter types.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000001</td>         <td class="cellrowborder" width="50%">The specified ability does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000002</td>         <td class="cellrowborder" width="50%">Incorrect ability type.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000004</td>         <td class="cellrowborder" width="50%">Cannot start an invisible component.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000005</td>         <td class="cellrowborder" width="50%">The specified process does not have the permission.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000006</td>         <td class="cellrowborder" width="50%">Cross-user operations are not allowed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000008</td>         <td class="cellrowborder" width="50%">The crowdtesting application expires.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000009</td>         <td class="cellrowborder" width="50%">An ability cannot be started or stopped in Wukong mode.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000010</td>         <td class="cellrowborder" width="50%">The call with the continuation and prepare continuation flag is forbidden.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000011</td>         <td class="cellrowborder" width="50%">The context does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000012</td>         <td class="cellrowborder" width="50%">The application is controlled.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000013</td>         <td class="cellrowborder" width="50%">The application is controlled by EDM.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000050</td>         <td class="cellrowborder" width="50%">Internal error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000053</td>         <td class="cellrowborder" width="50%">The ability is not on the top of the UI.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000055</td>         <td class="cellrowborder" width="50%">Installation-free timed out.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16200001</td>         <td class="cellrowborder" width="50%">The caller has been released.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-gnv-c106="" class="highlight-div"><div _ngcontent-gnv-c106="" class="highlight-div-header"><div _ngcontent-gnv-c106="" class="highlight-div-header-left"><div _ngcontent-gnv-c106="" class="handle-button expand-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gnv-c106="" class="highlight-div-header-right"><div _ngcontent-gnv-c106="" class="handle-button ai-button"></div><div _ngcontent-gnv-c106="" class="handle-button line-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gnv-c106="" class="handle-button theme-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gnv-c106="" class="handle-button copy-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gnv-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span>, <span class="hljs-title class_">Want</span>, dialogRequest } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onForeground</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">want</span>: <span class="hljs-title class_">Want</span> = {</li><li>      <span class="hljs-attr">deviceId</span>: <span class="hljs-string">''</span>,</li><li>      <span class="hljs-attr">bundleName</span>: <span class="hljs-string">'com.example.myapplication'</span>,</li><li>      <span class="hljs-attr">abilityName</span>: <span class="hljs-string">'AuthAccountServiceExtension'</span></li><li>    };</li><li>
</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">requestDialogService</span>(want, <span class="hljs-function">(<span class="hljs-params">err: BusinessError, result: dialogRequest.RequestResult</span>) =&gt;</span> {</li><li>        <span class="hljs-keyword">if</span> (err.<span class="hljs-property">code</span>) {</li><li>          <span class="hljs-comment">// 处理业务逻辑错误</span></li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`requestDialogService failed, code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>          <span class="hljs-keyword">return</span>;</li><li>        }</li><li>        <span class="hljs-comment">// 执行正常业务</span></li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`requestDialogService succeed, result = <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(result)}</span>`</span>);</li><li>      });</li><li>    } <span class="hljs-keyword">catch</span> (err) {</li><li>      <span class="hljs-comment">// 处理入参错误异常</span></li><li>      <span class="hljs-keyword">let</span> code = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span>;</li><li>      <span class="hljs-keyword">let</span> message = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>;</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`requestDialogService failed, code is <span class="hljs-subst">${code}</span>, message is <span class="hljs-subst">${message}</span>`</span>);</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 2712px;">     <h3 id="requestdialogservice-1" device-type="phone,2in1,tablet,wearable,tv">requestDialogService<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="requestdialogservice-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>requestDialogService(want: Want): Promise&lt;dialogRequest.RequestResult&gt;</p>     <p>启动一个支持模态弹框的ServiceExtensionAbility。ServiceExtensionAbility被启动后，应用弹出模态弹框，通过调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-dialogrequest#requestcallbacksetrequestresult">setRequestResult</a>接口返回结果给调用者。使用Promise异步回调。仅支持在主线程调用。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>组件启动规则详见：<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/component-startup-rules" target="_blank">组件启动规则（Stage模型）</a>。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.28.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.28.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.28.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.28.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">want</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-want">Want</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">启动ServiceExtensionAbility的Want信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.28.9.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.28.9.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-dialogrequest#requestresult">dialogRequest.RequestResult</a>&gt;</td>         <td class="cellrowborder" width="50%">Promise对象，包含接口执行结果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-ability">元能力子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.28.12.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.28.12.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">The application does not have permission to call the interface.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1.Mandatory parameters are left unspecified. 2.Incorrect parameter types.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000001</td>         <td class="cellrowborder" width="50%">The specified ability does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000002</td>         <td class="cellrowborder" width="50%">Incorrect ability type.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000004</td>         <td class="cellrowborder" width="50%">Cannot start an invisible component.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000005</td>         <td class="cellrowborder" width="50%">The specified process does not have the permission.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000006</td>         <td class="cellrowborder" width="50%">Cross-user operations are not allowed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000008</td>         <td class="cellrowborder" width="50%">The crowdtesting application expires.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000009</td>         <td class="cellrowborder" width="50%">An ability cannot be started or stopped in Wukong mode.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000010</td>         <td class="cellrowborder" width="50%">The call with the continuation and prepare continuation flag is forbidden.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000011</td>         <td class="cellrowborder" width="50%">The context does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000012</td>         <td class="cellrowborder" width="50%">The application is controlled.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000013</td>         <td class="cellrowborder" width="50%">The application is controlled by EDM.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000050</td>         <td class="cellrowborder" width="50%">Internal error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000053</td>         <td class="cellrowborder" width="50%">The ability is not on the top of the UI.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000055</td>         <td class="cellrowborder" width="50%">Installation-free timed out.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16200001</td>         <td class="cellrowborder" width="50%">The caller has been released.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-gnv-c106="" class="highlight-div"><div _ngcontent-gnv-c106="" class="highlight-div-header"><div _ngcontent-gnv-c106="" class="highlight-div-header-left"><div _ngcontent-gnv-c106="" class="handle-button expand-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gnv-c106="" class="highlight-div-header-right"><div _ngcontent-gnv-c106="" class="handle-button ai-button"></div><div _ngcontent-gnv-c106="" class="handle-button line-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gnv-c106="" class="handle-button theme-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gnv-c106="" class="handle-button copy-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gnv-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span>, <span class="hljs-title class_">Want</span>, dialogRequest } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onForeground</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">want</span>: <span class="hljs-title class_">Want</span> = {</li><li>      <span class="hljs-attr">bundleName</span>: <span class="hljs-string">'com.example.myapplication'</span>,</li><li>      <span class="hljs-attr">abilityName</span>: <span class="hljs-string">'AuthAccountServiceExtension'</span></li><li>    };</li><li>
</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">requestDialogService</span>(want)</li><li>        .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">result: dialogRequest.RequestResult</span>) =&gt;</span> {</li><li>          <span class="hljs-comment">// 执行正常业务</span></li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`requestDialogService succeed, result = <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(result)}</span>`</span>);</li><li>        })</li><li>        .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>          <span class="hljs-comment">// 处理业务逻辑错误</span></li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`requestDialogService failed, code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>        });</li><li>    } <span class="hljs-keyword">catch</span> (err) {</li><li>      <span class="hljs-comment">// 处理入参错误异常</span></li><li>      <span class="hljs-keyword">let</span> code = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span>;</li><li>      <span class="hljs-keyword">let</span> message = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>;</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`requestDialogService failed, code is <span class="hljs-subst">${code}</span>, message is <span class="hljs-subst">${message}</span>`</span>);</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1720px;">     <h3 id="reportdrawncompleted10" device-type="phone,2in1,tablet,wearable,tv">reportDrawnCompleted<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="reportdrawncompleted10" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>reportDrawnCompleted(callback: AsyncCallback&lt;void&gt;): void</p>     <p>用于通知系统UIAbility对应的窗口内容已经绘制完成。使用callback异步回调。</p>     <p><strong>元服务API</strong>：从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.29.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.29.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.29.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.29.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;void&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数，当通知系统UIAbility对应的窗口内容已经绘制完成的操作成功，err中code为0；否则err会返回对应的错误码和错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-ability">元能力子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.29.10.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.29.10.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">16000011</td>         <td class="cellrowborder" width="50%">The context does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000050</td>         <td class="cellrowborder" width="50%">Internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-gnv-c106="" class="highlight-div"><div _ngcontent-gnv-c106="" class="highlight-div-header"><div _ngcontent-gnv-c106="" class="highlight-div-header-left"><div _ngcontent-gnv-c106="" class="handle-button expand-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gnv-c106="" class="highlight-div-header-right"><div _ngcontent-gnv-c106="" class="handle-button ai-button"></div><div _ngcontent-gnv-c106="" class="handle-button line-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gnv-c106="" class="handle-button theme-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gnv-c106="" class="handle-button copy-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gnv-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-variable language_">window</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onWindowStageCreate</span>(<span class="hljs-params">windowStage: <span class="hljs-variable language_">window</span>.WindowStage</span>) {</li><li>    windowStage.<span class="hljs-title function_">loadContent</span>(<span class="hljs-string">'pages/Index'</span>, <span class="hljs-function">(<span class="hljs-params">err, data</span>) =&gt;</span> {</li><li>      <span class="hljs-keyword">if</span> (err.<span class="hljs-property">code</span>) {</li><li>        <span class="hljs-keyword">return</span>;</li><li>      }</li><li>
</li><li>      <span class="hljs-keyword">try</span> {</li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">reportDrawnCompleted</span>(<span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> {</li><li>          <span class="hljs-keyword">if</span> (err.<span class="hljs-property">code</span>) {</li><li>            <span class="hljs-comment">// 处理业务逻辑错误</span></li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`reportDrawnCompleted failed, code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>            <span class="hljs-keyword">return</span>;</li><li>          }</li><li>          <span class="hljs-comment">// 执行正常业务</span></li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'reportDrawnCompleted succeed'</span>);</li><li>        });</li><li>      } <span class="hljs-keyword">catch</span> (err) {</li><li>        <span class="hljs-comment">// 捕获同步的参数错误</span></li><li>        <span class="hljs-keyword">let</span> code = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span>;</li><li>        <span class="hljs-keyword">let</span> message = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>;</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`reportDrawnCompleted failed, code is <span class="hljs-subst">${code}</span>, message is <span class="hljs-subst">${message}</span>`</span>);</li><li>      }</li><li>    });</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"MainAbility onWindowStageCreate"</span>);</li><li>  }</li><li>};</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1831px;">     <h3 id="startabilitybytype11" device-type="phone,2in1,tablet,wearable,tv">startAbilityByType<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="startabilitybytype11" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>startAbilityByType(type: string, wantParam: Record&lt;string, Object&gt;,</p>     <p>abilityStartCallback: AbilityStartCallback, callback: AsyncCallback&lt;void&gt;) : void</p>     <p>通过type隐式启动<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiextensionability">UIExtensionAbility</a>。使用callback异步回调。仅支持在主线程调用，仅支持处于前台的应用调用。</p>     <p><strong>元服务API</strong>：从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.30.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.30.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.30.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.30.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">启动的UIExtensionAbility类型，取值详见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/start-intent-panel#匹配规则" target="_blank">通过startAbilityByType接口拉起垂类面板</a>。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">wantParam</td>         <td class="cellrowborder" width="25%">Record&lt;string, Object&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">表示扩展参数。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">abilityStartCallback</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-abilitystartcallback">AbilityStartCallback</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数，返回启动失败后的详细错误信息。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;void&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数，当接口调用成功，err为undefined；否则为错误对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-ability">元能力子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.30.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.30.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1.Mandatory parameters are left unspecified. 2.Incorrect parameter types.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000050</td>         <td class="cellrowborder" width="50%">Internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-gnv-c106="" class="highlight-div"><div _ngcontent-gnv-c106="" class="highlight-div-header"><div _ngcontent-gnv-c106="" class="highlight-div-header-left"><div _ngcontent-gnv-c106="" class="handle-button expand-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gnv-c106="" class="highlight-div-header-right"><div _ngcontent-gnv-c106="" class="handle-button ai-button"></div><div _ngcontent-gnv-c106="" class="handle-button line-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gnv-c106="" class="handle-button theme-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gnv-c106="" class="handle-button copy-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gnv-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span>, common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onForeground</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">wantParam</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-title class_">Object</span>&gt; = {</li><li>      <span class="hljs-string">'time'</span>: <span class="hljs-string">'2023-10-23 20:45'</span></li><li>    };</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">abilityStartCallback</span>: common.<span class="hljs-property">AbilityStartCallback</span> = {</li><li>      <span class="hljs-attr">onError</span>: <span class="hljs-function">(<span class="hljs-params">code: <span class="hljs-built_in">number</span>, name: <span class="hljs-built_in">string</span>, message: <span class="hljs-built_in">string</span></span>) =&gt;</span> {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`code:`</span> + code + <span class="hljs-string">`name:`</span> + name + <span class="hljs-string">`message:`</span> + message);</li><li>      },</li><li>      <span class="hljs-attr">onResult</span>: <span class="hljs-function">(<span class="hljs-params">abilityResult: common.AbilityResult</span>) =&gt;</span> {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`resultCode:`</span> + abilityResult.<span class="hljs-property">resultCode</span> + <span class="hljs-string">`bundleName:`</span> + abilityResult.<span class="hljs-property">want</span>?.<span class="hljs-property">bundleName</span>);</li><li>      }</li><li>    };</li><li>
</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">startAbilityByType</span>(<span class="hljs-string">"photoEditor"</span>, wantParam, abilityStartCallback, <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> {</li><li>      <span class="hljs-keyword">if</span> (err) {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`startAbilityByType fail, err: <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(err)}</span>`</span>);</li><li>      } <span class="hljs-keyword">else</span> {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`success`</span>);</li><li>      }</li><li>    });</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1885px;">     <h3 id="startabilitybytype11-1" device-type="phone,2in1,tablet,wearable,tv">startAbilityByType<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="startabilitybytype11-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>startAbilityByType(type: string, wantParam: Record&lt;string, Object&gt;,</p>     <p>abilityStartCallback: AbilityStartCallback) : Promise&lt;void&gt;</p>     <p>通过type隐式启动<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiextensionability">UIExtensionAbility</a>。使用Promise异步回调。仅支持在主线程调用，仅支持处于前台的应用调用。</p>     <p><strong>元服务API</strong>：从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.31.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.31.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.31.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.31.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">type</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">启动的UIExtensionAbility类型，取值详见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/start-intent-panel#匹配规则" target="_blank">通过startAbilityByType接口拉起垂类面板</a>。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">wantParam</td>         <td class="cellrowborder" width="25%">Record&lt;string, Object&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">表示扩展参数。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">abilityStartCallback</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-abilitystartcallback">AbilityStartCallback</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数，返回启动失败后的详细错误信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.31.10.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.31.10.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">Promise对象，包含接口执行结果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-ability">元能力子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.31.13.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.31.13.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1.Mandatory parameters are left unspecified. 2.Incorrect parameter types.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000050</td>         <td class="cellrowborder" width="50%">Internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-gnv-c106="" class="highlight-div"><div _ngcontent-gnv-c106="" class="highlight-div-header"><div _ngcontent-gnv-c106="" class="highlight-div-header-left"><div _ngcontent-gnv-c106="" class="handle-button expand-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gnv-c106="" class="highlight-div-header-right"><div _ngcontent-gnv-c106="" class="handle-button ai-button"></div><div _ngcontent-gnv-c106="" class="handle-button line-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gnv-c106="" class="handle-button theme-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gnv-c106="" class="handle-button copy-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gnv-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span>, common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onForeground</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">wantParam</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-title class_">Object</span>&gt; = {</li><li>      <span class="hljs-string">'time'</span>: <span class="hljs-string">'2023-10-23 20:45'</span></li><li>    };</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">abilityStartCallback</span>: common.<span class="hljs-property">AbilityStartCallback</span> = {</li><li>      <span class="hljs-attr">onError</span>: <span class="hljs-function">(<span class="hljs-params">code: <span class="hljs-built_in">number</span>, name: <span class="hljs-built_in">string</span>, message: <span class="hljs-built_in">string</span></span>) =&gt;</span> {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`code:`</span> + code + <span class="hljs-string">`name:`</span> + name + <span class="hljs-string">`message:`</span> + message);</li><li>      },</li><li>      <span class="hljs-attr">onResult</span>: <span class="hljs-function">(<span class="hljs-params">abilityResult: common.AbilityResult</span>) =&gt;</span> {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`resultCode:`</span> + abilityResult.<span class="hljs-property">resultCode</span> + <span class="hljs-string">`bundleName:`</span> + abilityResult.<span class="hljs-property">want</span>?.<span class="hljs-property">bundleName</span>);</li><li>      }</li><li>    };</li><li>
</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">startAbilityByType</span>(<span class="hljs-string">"photoEditor"</span>, wantParam, abilityStartCallback).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`startAbilityByType success`</span>);</li><li>    }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`startAbilityByType fail, err: <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(err)}</span>`</span>);</li><li>    });</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 2647px;">     <h3 id="showability12" device-type="phone,2in1,tablet,wearable,tv">showAbility<sup>12+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="showability12" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>showAbility(): Promise&lt;void&gt;</p>     <p>显示当前UIAbility。使用Promise异步回调。仅支持在主线程调用。</p>     <p>调用此接口前要求确保应用已添加至状态栏。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.Core</p>     <p><strong>设备行为差异</strong>：该接口仅在2in1和Tablet设备中可正常调用，在其他设备中返回801错误码。</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.32.8.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.32.8.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">Promise对象，包含接口执行结果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-ability">元能力子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.32.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.32.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not support.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000050</td>         <td class="cellrowborder" width="50%">Internal error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000067</td>         <td class="cellrowborder" width="50%">The StartOptions check failed.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-gnv-c106="" class="highlight-div"><div _ngcontent-gnv-c106="" class="highlight-div-header"><div _ngcontent-gnv-c106="" class="highlight-div-header-left"><div _ngcontent-gnv-c106="" class="handle-button expand-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gnv-c106="" class="highlight-div-header-right"><div _ngcontent-gnv-c106="" class="handle-button ai-button"></div><div _ngcontent-gnv-c106="" class="handle-button line-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gnv-c106="" class="handle-button theme-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gnv-c106="" class="handle-button copy-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gnv-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// Index.ets</span></li><li><span class="hljs-keyword">import</span> { common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">showAbility</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'showAbility'</span></li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Row</span>() {</li><li>      <span class="hljs-title class_">Column</span>() {</li><li>        <span class="hljs-title class_">Text</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">showAbility</span>)</li><li>          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">30</span>)</li><li>          .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-keyword">let</span> context = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li>
</li><li>            context.<span class="hljs-title function_">showAbility</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>              <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`showAbility success`</span>);</li><li>            }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>              <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`showAbility fail, err: <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(err)}</span>`</span>);</li><li>            });</li><li>          });</li><li>      }</li><li>      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    }</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div>     <div _ngcontent-gnv-c106="" class="highlight-div"><div _ngcontent-gnv-c106="" class="highlight-div-header"><div _ngcontent-gnv-c106="" class="highlight-div-header-left"><div _ngcontent-gnv-c106="" class="handle-button expand-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gnv-c106="" class="highlight-div-header-right"><div _ngcontent-gnv-c106="" class="handle-button ai-button"></div><div _ngcontent-gnv-c106="" class="handle-button line-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gnv-c106="" class="handle-button theme-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gnv-c106="" class="handle-button copy-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gnv-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// EntryAbility.ts</span></li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span>, <span class="hljs-title class_">Want</span>, <span class="hljs-title class_">StartOptions</span>, contextConstant } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onForeground</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">want</span>: <span class="hljs-title class_">Want</span> = {</li><li>      <span class="hljs-attr">deviceId</span>: <span class="hljs-string">''</span>,</li><li>      <span class="hljs-attr">bundleName</span>: <span class="hljs-string">'com.example.myapplication'</span>,</li><li>      <span class="hljs-attr">abilityName</span>: <span class="hljs-string">'EntryAbility'</span></li><li>    };</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">options</span>: <span class="hljs-title class_">StartOptions</span> = {</li><li>      <span class="hljs-attr">displayId</span>: <span class="hljs-number">0</span>,</li><li>      <span class="hljs-attr">processMode</span>: contextConstant.<span class="hljs-property">ProcessMode</span>.<span class="hljs-property">NEW_PROCESS_ATTACH_TO_STATUS_BAR_ITEM</span>,</li><li>      <span class="hljs-attr">startupVisibility</span>: contextConstant.<span class="hljs-property">StartupVisibility</span>.<span class="hljs-property">STARTUP_SHOW</span></li><li>    };</li><li>
</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">startAbility</span>(want, options, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>        <span class="hljs-keyword">if</span> (err.<span class="hljs-property">code</span>) {</li><li>          <span class="hljs-comment">// 处理业务逻辑错误</span></li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`startAbility failed, code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>          <span class="hljs-keyword">return</span>;</li><li>        }</li><li>        <span class="hljs-comment">// 执行正常业务</span></li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'startAbility succeed'</span>);</li><li>      });</li><li>    } <span class="hljs-keyword">catch</span> (err) {</li><li>      <span class="hljs-comment">// 处理入参错误异常</span></li><li>      <span class="hljs-keyword">let</span> code = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span>;</li><li>      <span class="hljs-keyword">let</span> message = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>;</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`startAbility failed, code is <span class="hljs-subst">${code}</span>, message is <span class="hljs-subst">${message}</span>`</span>);</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 2647px;">     <h3 id="hideability12" device-type="phone,2in1,tablet,wearable,tv">hideAbility<sup>12+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="hideability12" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>hideAbility(): Promise&lt;void&gt;</p>     <p>隐藏当前UIAbility。使用Promise异步回调。仅支持在主线程调用。</p>     <p>调用此接口前要求确保应用已添加至状态栏。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.Core</p>     <p><strong>设备行为差异</strong>：该接口仅在2in1和Tablet设备中可正常调用，在其他设备中返回801错误码。</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.33.8.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.33.8.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">Promise对象，包含接口执行结果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-ability">元能力子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.33.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.33.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not support.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000050</td>         <td class="cellrowborder" width="50%">Internal error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000067</td>         <td class="cellrowborder" width="50%">The StartOptions check failed.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-gnv-c106="" class="highlight-div"><div _ngcontent-gnv-c106="" class="highlight-div-header"><div _ngcontent-gnv-c106="" class="highlight-div-header-left"><div _ngcontent-gnv-c106="" class="handle-button expand-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gnv-c106="" class="highlight-div-header-right"><div _ngcontent-gnv-c106="" class="handle-button ai-button"></div><div _ngcontent-gnv-c106="" class="handle-button line-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gnv-c106="" class="handle-button theme-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gnv-c106="" class="handle-button copy-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gnv-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// Index.ets</span></li><li><span class="hljs-keyword">import</span> { common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">hideAbility</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'hideAbility'</span></li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Row</span>() {</li><li>      <span class="hljs-title class_">Column</span>() {</li><li>        <span class="hljs-title class_">Text</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">hideAbility</span>)</li><li>          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">30</span>)</li><li>          .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-keyword">let</span> context = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li>
</li><li>            context.<span class="hljs-title function_">hideAbility</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>              <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`hideAbility success`</span>);</li><li>            }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>              <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`hideAbility fail, err: <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(err)}</span>`</span>);</li><li>            });</li><li>          });</li><li>      }</li><li>      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    }</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div>     <div _ngcontent-gnv-c106="" class="highlight-div"><div _ngcontent-gnv-c106="" class="highlight-div-header"><div _ngcontent-gnv-c106="" class="highlight-div-header-left"><div _ngcontent-gnv-c106="" class="handle-button expand-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gnv-c106="" class="highlight-div-header-right"><div _ngcontent-gnv-c106="" class="handle-button ai-button"></div><div _ngcontent-gnv-c106="" class="handle-button line-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gnv-c106="" class="handle-button theme-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gnv-c106="" class="handle-button copy-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gnv-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// EntryAbility.ts</span></li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span>, <span class="hljs-title class_">Want</span>, <span class="hljs-title class_">StartOptions</span>, contextConstant } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onForeground</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">want</span>: <span class="hljs-title class_">Want</span> = {</li><li>      <span class="hljs-attr">deviceId</span>: <span class="hljs-string">''</span>,</li><li>      <span class="hljs-attr">bundleName</span>: <span class="hljs-string">'com.example.myapplication'</span>,</li><li>      <span class="hljs-attr">abilityName</span>: <span class="hljs-string">'EntryAbility'</span></li><li>    };</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">options</span>: <span class="hljs-title class_">StartOptions</span> = {</li><li>      <span class="hljs-attr">displayId</span>: <span class="hljs-number">0</span>,</li><li>      <span class="hljs-attr">processMode</span>: contextConstant.<span class="hljs-property">ProcessMode</span>.<span class="hljs-property">NEW_PROCESS_ATTACH_TO_STATUS_BAR_ITEM</span>,</li><li>      <span class="hljs-attr">startupVisibility</span>: contextConstant.<span class="hljs-property">StartupVisibility</span>.<span class="hljs-property">STARTUP_HIDE</span></li><li>    };</li><li>
</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">startAbility</span>(want, options, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>        <span class="hljs-keyword">if</span> (err.<span class="hljs-property">code</span>) {</li><li>          <span class="hljs-comment">// 处理业务逻辑错误</span></li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`startAbility failed, code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>          <span class="hljs-keyword">return</span>;</li><li>        }</li><li>        <span class="hljs-comment">// 执行正常业务</span></li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'startAbility succeed'</span>);</li><li>      });</li><li>    } <span class="hljs-keyword">catch</span> (err) {</li><li>      <span class="hljs-comment">// 处理入参错误异常</span></li><li>      <span class="hljs-keyword">let</span> code = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span>;</li><li>      <span class="hljs-keyword">let</span> message = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>;</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`startAbility failed, code is <span class="hljs-subst">${code}</span>, message is <span class="hljs-subst">${message}</span>`</span>);</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1985px;">     <h3 id="moveabilitytobackground12" device-type="phone,2in1,tablet,wearable,tv">moveAbilityToBackground<sup>12+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="moveabilitytobackground12" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>moveAbilityToBackground(): Promise&lt;void&gt;</p>     <p>将处于前台的UIAbility移动到后台。使用Promise异步回调。仅支持在主线程调用。</p>     <p>该接口仅支持手机和平板设备。</p>     <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.Core</p>     <p><strong>设备行为差异</strong>：</p>     <ul>      <li>从API version 12开始，该接口仅在Phone、Wearable和TV设备中可正常调用，在其他设备上返回16000061错误码。</li>      <li>从API version 13开始，该接口仅在Phone、Tablet、Wearable和TV设备中可正常调用，在其他设备上返回16000061错误码。</li>     </ul>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.34.10.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.34.10.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">Promise对象，包含接口执行结果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-ability">元能力子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.34.13.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.34.13.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">16000011</td>         <td class="cellrowborder" width="50%">The context does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000050</td>         <td class="cellrowborder" width="50%">Internal error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000061</td>         <td class="cellrowborder" width="50%">Operation not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000065</td>         <td class="cellrowborder" width="50%">The API can be called only when the ability is running in the foreground.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000066</td>         <td class="cellrowborder" width="50%">An ability cannot switch to the foreground or background in Wukong mode.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-gnv-c106="" class="highlight-div"><div _ngcontent-gnv-c106="" class="highlight-div-header"><div _ngcontent-gnv-c106="" class="highlight-div-header-left"><div _ngcontent-gnv-c106="" class="handle-button expand-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gnv-c106="" class="highlight-div-header-right"><div _ngcontent-gnv-c106="" class="handle-button ai-button"></div><div _ngcontent-gnv-c106="" class="handle-button line-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gnv-c106="" class="handle-button theme-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gnv-c106="" class="handle-button copy-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gnv-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">moveAbilityToBackground</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'Move To Background'</span></li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Row</span>() {</li><li>      <span class="hljs-title class_">Column</span>() {</li><li>        <span class="hljs-title class_">Text</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">moveAbilityToBackground</span>)</li><li>          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">30</span>)</li><li>          .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-keyword">let</span> context = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li>
</li><li>            context.<span class="hljs-title function_">moveAbilityToBackground</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>              <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`moveAbilityToBackground success.`</span>);</li><li>            }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>              <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`moveAbilityToBackground error: <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(err)}</span>.`</span>);</li><li>            });</li><li>          });</li><li>      }</li><li>      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    }</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 2532px;">     <h3 id="openatomicservice12" device-type="phone,2in1,tablet,wearable,tv">openAtomicService<sup>12+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="openatomicservice12" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>openAtomicService(appId: string, options?: AtomicServiceOptions): Promise&lt;AbilityResult&gt;</p>     <p>启动一个独立窗口的元服务。使用Promise异步回调。仅支持在主线程调用。</p>     <p>元服务被启动后，有如下情况：</p>     <ul>      <li>正常情况下元服务可以通过<a href="/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext#terminateselfwithresult">terminateSelfWithResult</a>接口销毁自身，并且返回结果给调用方。</li>      <li>异常情况下比如杀死元服务会返回异常结果给调用方，异常结果的resultCode为-1。</li>      <li>如果不同应用多次调用该接口启动同一个元服务，当这个元服务调用<a href="/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext#terminateselfwithresult">terminateSelfWithResult</a>接口销毁自身时，只将正常结果返回给最后一个调用方, 其它调用方返回异常结果，异常结果中resultCode为-1。</li>     </ul>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>组件启动规则详见：<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/component-startup-rules" target="_blank">组件启动规则（Stage模型）</a>。</p>      </div></div></div>     <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.35.10.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.35.10.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.35.10.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.35.10.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">appId</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">应用的唯一标识，由云端统一分配。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">options</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-atomicserviceoptions">AtomicServiceOptions</a></td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">启动元服务所携带的参数。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.35.12.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.35.12.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-ability-abilityresult">AbilityResult</a>&gt;</td>         <td class="cellrowborder" width="50%">Promise对象，包含返回给拉起方的信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-ability">元能力子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.35.15.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.35.15.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1.Mandatory parameters are left unspecified. 2.Incorrect parameter types.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000002</td>         <td class="cellrowborder" width="50%">Incorrect ability type.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000003</td>         <td class="cellrowborder" width="50%">The specified ID does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000004</td>         <td class="cellrowborder" width="50%">Cannot start an invisible component.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000011</td>         <td class="cellrowborder" width="50%">The context does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000012</td>         <td class="cellrowborder" width="50%">The application is controlled.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000050</td>         <td class="cellrowborder" width="50%">Internal error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000053</td>         <td class="cellrowborder" width="50%">The ability is not on the top of the UI.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000055</td>         <td class="cellrowborder" width="50%">Installation-free timed out.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16200001</td>         <td class="cellrowborder" width="50%">The caller has been released.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-gnv-c106="" class="highlight-div"><div _ngcontent-gnv-c106="" class="highlight-div-header"><div _ngcontent-gnv-c106="" class="highlight-div-header-left"><div _ngcontent-gnv-c106="" class="handle-button expand-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gnv-c106="" class="highlight-div-header-right"><div _ngcontent-gnv-c106="" class="handle-button ai-button"></div><div _ngcontent-gnv-c106="" class="handle-button line-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gnv-c106="" class="handle-button theme-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gnv-c106="" class="handle-button copy-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gnv-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span>, common, <span class="hljs-title class_">AtomicServiceOptions</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onForeground</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">appId</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'6918661953712445909'</span>;</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">options</span>: <span class="hljs-title class_">AtomicServiceOptions</span> = {</li><li>      <span class="hljs-attr">displayId</span>: <span class="hljs-number">0</span></li><li>    };</li><li>
</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">openAtomicService</span>(appId, options)</li><li>        .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">result: common.AbilityResult</span>) =&gt;</span> {</li><li>          <span class="hljs-comment">// 执行正常业务</span></li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'openAtomicService succeed'</span>);</li><li>        })</li><li>        .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>          <span class="hljs-comment">// 处理业务逻辑错误</span></li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`openAtomicService failed, code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>        });</li><li>    } <span class="hljs-keyword">catch</span> (err) {</li><li>      <span class="hljs-comment">// 处理入参错误异常</span></li><li>      <span class="hljs-keyword">let</span> code = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span>;</li><li>      <span class="hljs-keyword">let</span> message = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>;</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`openAtomicService failed, code is <span class="hljs-subst">${code}</span>, message is <span class="hljs-subst">${message}</span>`</span>);</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 3531px;">     <h3 id="openlink12" device-type="phone,2in1,tablet,wearable,tv">openLink<sup>12+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="openlink12" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>openLink(link: string, options?: OpenLinkOptions, callback?: AsyncCallback&lt;AbilityResult&gt;): Promise&lt;void&gt;</p>     <p>通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/app-linking-startup" target="_blank">App Linking</a>或<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/deep-linking-startup" target="_blank">Deep Linking</a>方式启动UIAbility，并通过回调函数接收被拉起的UIAbility退出时的返回结果。使用Promise异步回调。仅支持在主线程调用。</p>     <p>通过在link字段中传入标准格式的URL，基于隐式want匹配规则拉起目标UIAbility。目标方必须同时具备以下过滤器特征，才能处理App Linking链接：</p>     <ul>      <li>"actions"列表中包含"ohos.want.action.viewData"。</li>      <li>"entities"列表中包含"entity.system.browsable"。</li>      <li>"uris"列表中包含"scheme"为"https"且"domainVerify"为true的元素。</li>     </ul>     <p>如果希望获取被拉起方终止后的结果，可以设置callback参数，此参数的使用可参照<a href="/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext#startabilityforresult">startAbilityForResult</a>接口。</p>     <p>传入的参数不合法时，如未设置必选参数或link字符串不是标准格式的URL，接口会直接抛出异常。参数校验通过，拉起目标方时出现的错误通过promise返回错误信息。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>组件启动规则详见：<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/component-startup-rules" target="_blank">组件启动规则（Stage模型）</a>。</p>      </div></div></div>     <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.36.12.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.36.12.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.36.12.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.36.12.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">link</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">指示要打开的标准格式URL。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">options</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-openlinkoptions">OpenLinkOptions</a></td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">打开URL的选项参数。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-ability-abilityresult">AbilityResult</a>&gt;</td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">回调函数，包含返回给拉起方的信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.36.14.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.36.14.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">Promise对象，包含接口执行结果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-ability">元能力子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.36.17.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.36.17.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">The application does not have permission to call the interface.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1.Mandatory parameters are left unspecified. 2.Incorrect parameter types.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000001</td>         <td class="cellrowborder" width="50%">The specified ability does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000002</td>         <td class="cellrowborder" width="50%">Incorrect ability type.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000004</td>         <td class="cellrowborder" width="50%">Cannot start an invisible component.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000005</td>         <td class="cellrowborder" width="50%">The specified process does not have the permission.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000006</td>         <td class="cellrowborder" width="50%">Cross-user operations are not allowed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000008</td>         <td class="cellrowborder" width="50%">The crowdtesting application expires.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000009</td>         <td class="cellrowborder" width="50%">An ability cannot be started or stopped in Wukong mode.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000010</td>         <td class="cellrowborder" width="50%">The call with the continuation and prepare continuation flag is forbidden.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000011</td>         <td class="cellrowborder" width="50%">The context does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000012</td>         <td class="cellrowborder" width="50%">The application is controlled.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000013</td>         <td class="cellrowborder" width="50%">The application is controlled by EDM.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000019</td>         <td class="cellrowborder" width="50%">No matching ability is found.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16200001</td>         <td class="cellrowborder" width="50%">The caller has been released.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000053</td>         <td class="cellrowborder" width="50%">The ability is not on the top of the UI.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-gnv-c106="" class="highlight-div"><div _ngcontent-gnv-c106="" class="highlight-div-header"><div _ngcontent-gnv-c106="" class="highlight-div-header-left"><div _ngcontent-gnv-c106="" class="handle-button expand-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gnv-c106="" class="highlight-div-header-right"><div _ngcontent-gnv-c106="" class="handle-button ai-button"></div><div _ngcontent-gnv-c106="" class="handle-button line-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gnv-c106="" class="handle-button theme-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gnv-c106="" class="handle-button copy-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gnv-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { common, <span class="hljs-title class_">OpenLinkOptions</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">DOMAIN</span> = <span class="hljs-number">0xeeee</span>;</li><li><span class="hljs-keyword">const</span> <span class="hljs-attr">TAG</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'[openLinkDemo]'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">RelativeContainer</span>() {</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">"Call StartAbilityForResult"</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-keyword">let</span> context = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li>          <span class="hljs-keyword">let</span> <span class="hljs-attr">link</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'https://www.example.com'</span>;</li><li>          <span class="hljs-keyword">let</span> <span class="hljs-attr">openLinkOptions</span>: <span class="hljs-title class_">OpenLinkOptions</span> = {</li><li>            <span class="hljs-attr">appLinkingOnly</span>: <span class="hljs-literal">true</span>,</li><li>            <span class="hljs-attr">parameters</span>: { <span class="hljs-attr">demo_key</span>: <span class="hljs-string">'demo_value'</span> }</li><li>          };</li><li>
</li><li>          <span class="hljs-keyword">try</span> {</li><li>            context.<span class="hljs-title function_">openLink</span>(</li><li>              link,</li><li>              openLinkOptions,</li><li>              <span class="hljs-function">(<span class="hljs-params">err, result</span>) =&gt;</span> {</li><li>                hilog.<span class="hljs-title function_">error</span>(<span class="hljs-variable constant_">DOMAIN</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">`openLink callback error.code: <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(err)}</span>`</span>);</li><li>                hilog.<span class="hljs-title function_">info</span>(<span class="hljs-variable constant_">DOMAIN</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">`openLink callback result: <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(result.resultCode)}</span>`</span>);</li><li>                hilog.<span class="hljs-title function_">info</span>(<span class="hljs-variable constant_">DOMAIN</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">`openLink callback result data: <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(result.want)}</span>`</span>);</li><li>              }</li><li>            ).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>              hilog.<span class="hljs-title function_">info</span>(<span class="hljs-variable constant_">DOMAIN</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">`open link success.`</span>);</li><li>            }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>              hilog.<span class="hljs-title function_">error</span>(<span class="hljs-variable constant_">DOMAIN</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">`open link failed, errCode <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(err.code)}</span>`</span>);</li><li>            });</li><li>          }</li><li>          <span class="hljs-keyword">catch</span> (e) {</li><li>            hilog.<span class="hljs-title function_">error</span>(<span class="hljs-variable constant_">DOMAIN</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">`exception occured, errCode <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(e.code)}</span>`</span>);</li><li>          }</li><li>        })</li><li>    }</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 4191px;">     <h3 id="backtocallerabilitywithresult12" device-type="phone,2in1,tablet,wearable,tv">backToCallerAbilityWithResult<sup>12+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="backtocallerabilitywithresult12" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>backToCallerAbilityWithResult(abilityResult: AbilityResult, requestCode: string): Promise&lt;void&gt;</p>     <p>当通过<a href="/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext#startabilityforresult">startAbilityForResult</a>或<a href="/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext#openlink12">openLink</a>拉起目标方UIAbility，且需要目标方返回结果时，目标方可以通过该接口将结果返回并拉起调用方。与<a href="/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext#terminateselfwithresult">terminateSelfWithResult</a>不同的是，本接口在返回时不会销毁当前UIAbility。使用Promise异步回调。</p>     <p><strong>元服务API</strong>：从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.37.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.37.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.37.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.37.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">abilityResult</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-ability-abilityresult">AbilityResult</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">包含目标方返回给拉起方的结果。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">requestCode</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">通过<a href="/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext#startabilityforresult">startAbilityForResult</a>或<a href="/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext#openlink12">openLink</a>拉起目标方Ability且需要目标方返回结果时，系统生成的用于标识本次调用的requestCode。该值可以通过want中的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-wantconstant">CALLER_REQUEST_CODE</a>字段获取。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.37.9.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.37.9.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">Promise对象，包含接口执行结果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-ability">元能力子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.37.12.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.37.12.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">The application does not have permission to call the interface.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1.Mandatory parameters are left unspecified. 2.Incorrect parameter types.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000009</td>         <td class="cellrowborder" width="50%">An ability cannot be started or stopped in Wukong mode.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000011</td>         <td class="cellrowborder" width="50%">The context does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000050</td>         <td class="cellrowborder" width="50%">Internal error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000074</td>         <td class="cellrowborder" width="50%">The caller does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000075</td>         <td class="cellrowborder" width="50%">BackToCaller is not supported.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <p>调用方通过startAbilityForResult接口拉起目标方, 目标方再调用backToCallerAbilityWithResult接口返回到调用方。</p>     <div _ngcontent-gnv-c106="" class="highlight-div"><div _ngcontent-gnv-c106="" class="highlight-div-header"><div _ngcontent-gnv-c106="" class="highlight-div-header-left"><div _ngcontent-gnv-c106="" class="handle-button expand-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gnv-c106="" class="highlight-div-header-right"><div _ngcontent-gnv-c106="" class="handle-button ai-button"></div><div _ngcontent-gnv-c106="" class="handle-button line-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gnv-c106="" class="handle-button theme-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gnv-c106="" class="handle-button copy-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gnv-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 调用方</span></li><li><span class="hljs-comment">// index.ets</span></li><li><span class="hljs-keyword">import</span> { common, <span class="hljs-title class_">Want</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@ohos.base'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'Hello World'</span>;</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Row</span>() {</li><li>      <span class="hljs-title class_">Column</span>() {</li><li>        <span class="hljs-title class_">Text</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span>)</li><li>          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">30</span>)</li><li>          .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)</li><li>
</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">"Call StartAbilityForResult"</span>)</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-keyword">let</span> <span class="hljs-attr">context</span>: common.<span class="hljs-property">UIAbilityContext</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li>            <span class="hljs-keyword">let</span> <span class="hljs-attr">want</span>: <span class="hljs-title class_">Want</span> = {</li><li>              <span class="hljs-attr">bundleName</span>: <span class="hljs-string">'com.example.demo2'</span>,</li><li>              <span class="hljs-attr">abilityName</span>: <span class="hljs-string">'EntryAbility'</span></li><li>            };</li><li>
</li><li>            <span class="hljs-keyword">try</span> {</li><li>              <span class="hljs-comment">// 通过startAbilityForResult拉起目标应用</span></li><li>              context.<span class="hljs-title function_">startAbilityForResult</span>(want, <span class="hljs-function">(<span class="hljs-params">err: BusinessError, result: common.AbilityResult</span>) =&gt;</span> {</li><li>                <span class="hljs-keyword">if</span> (err.<span class="hljs-property">code</span>) {</li><li>                  <span class="hljs-comment">// 处理业务逻辑错误</span></li><li>                  hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">`startAbilityForResult failed, code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>                  <span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span> = <span class="hljs-string">`startAbilityForResult failed: code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span></li><li>                  <span class="hljs-keyword">return</span>;</li><li>                }</li><li>                <span class="hljs-comment">// 执行正常业务</span></li><li>                hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">`startAbilityForResult succeed`</span>);</li><li>                hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">`AbilityResult is <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(result)}</span>`</span>);</li><li>                <span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span> = <span class="hljs-string">`AbilityResult.resultCode: <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(result.resultCode)}</span>`</span></li><li>              });</li><li>            } <span class="hljs-keyword">catch</span> (err) {</li><li>              <span class="hljs-comment">// 处理入参错误异常</span></li><li>              <span class="hljs-keyword">let</span> code = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span>;</li><li>              <span class="hljs-keyword">let</span> message = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>;</li><li>              hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">`startAbilityForResult failed, code is <span class="hljs-subst">${code}</span>, message is <span class="hljs-subst">${message}</span>`</span>);</li><li>              <span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span> = <span class="hljs-string">`startAbilityForResult failed, code is <span class="hljs-subst">${code}</span>, message is <span class="hljs-subst">${message}</span>`</span>;</li><li>            }</li><li>          })</li><li>      }</li><li>      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    }</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div>     <div _ngcontent-gnv-c106="" class="highlight-div"><div _ngcontent-gnv-c106="" class="highlight-div-header"><div _ngcontent-gnv-c106="" class="highlight-div-header-left"><div _ngcontent-gnv-c106="" class="handle-button expand-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gnv-c106="" class="highlight-div-header-right"><div _ngcontent-gnv-c106="" class="handle-button ai-button"></div><div _ngcontent-gnv-c106="" class="handle-button line-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gnv-c106="" class="handle-button theme-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gnv-c106="" class="handle-button copy-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gnv-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 目标方</span></li><li><span class="hljs-comment">// EntryAbility.ets</span></li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AbilityConstant</span>, common, <span class="hljs-title class_">UIAbility</span>, <span class="hljs-title class_">Want</span>, wantConstant } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onCreate</span>(<span class="hljs-attr">want</span>: <span class="hljs-title class_">Want</span>, <span class="hljs-attr">launchParam</span>: <span class="hljs-title class_">AbilityConstant</span>.<span class="hljs-property">LaunchParam</span>): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-comment">// 从want中获取调用方的CALLER_REQUEST_CODE，并保存</span></li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">callerRequestCode</span>: <span class="hljs-built_in">string</span> = want?.<span class="hljs-property">parameters</span>?.[wantConstant.<span class="hljs-property">Params</span>.<span class="hljs-property">CALLER_REQUEST_CODE</span>] <span class="hljs-keyword">as</span> <span class="hljs-built_in">string</span>;</li><li>    <span class="hljs-title class_">AppStorage</span>.<span class="hljs-property">setOrCreate</span>&lt;<span class="hljs-built_in">string</span>&gt;(<span class="hljs-string">"callerRequestCode"</span>, callerRequestCode)</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">onNewWant</span>(<span class="hljs-attr">want</span>: <span class="hljs-title class_">Want</span>, <span class="hljs-attr">launchParam</span>: <span class="hljs-title class_">AbilityConstant</span>.<span class="hljs-property">LaunchParam</span>): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">callerRequestCode</span>: <span class="hljs-built_in">string</span> = want?.<span class="hljs-property">parameters</span>?.[wantConstant.<span class="hljs-property">Params</span>.<span class="hljs-property">CALLER_REQUEST_CODE</span>] <span class="hljs-keyword">as</span> <span class="hljs-built_in">string</span>;</li><li>    <span class="hljs-title class_">AppStorage</span>.<span class="hljs-property">setOrCreate</span>&lt;<span class="hljs-built_in">string</span>&gt;(<span class="hljs-string">"callerRequestCode"</span>, callerRequestCode)</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">onForeground</span>(): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-comment">// 获取保存的CALLER_REQUEST_CODE</span></li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">callerRequestCode</span>: <span class="hljs-built_in">string</span> = <span class="hljs-title class_">AppStorage</span>.<span class="hljs-property">get</span>&lt;<span class="hljs-built_in">string</span>&gt;(<span class="hljs-string">"callerRequestCode"</span>) <span class="hljs-keyword">as</span> <span class="hljs-built_in">string</span>;</li><li>    hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">`callerRequestCode is <span class="hljs-subst">${callerRequestCode}</span>`</span>);</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">want</span>: <span class="hljs-title class_">Want</span> = {};</li><li>    <span class="hljs-keyword">let</span> resultCode = <span class="hljs-number">100</span>;</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">abilityResult</span>: common.<span class="hljs-property">AbilityResult</span> = {</li><li>      want,</li><li>      resultCode</li><li>    };</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-comment">// 将结果信息返回给调用方</span></li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">backToCallerAbilityWithResult</span>(abilityResult, callerRequestCode)</li><li>        .<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-comment">// 执行正常业务</span></li><li>          hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">'backToCallerAbilityWithResult succeed'</span>);</li><li>        })</li><li>        .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>          <span class="hljs-comment">// 处理业务逻辑错误</span></li><li>          hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">`backToCallerAbilityWithResult failed, code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>        });</li><li>    } <span class="hljs-keyword">catch</span> (err) {</li><li>      <span class="hljs-comment">// 捕获同步的参数错误</span></li><li>      <span class="hljs-keyword">let</span> code = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span>;</li><li>      <span class="hljs-keyword">let</span> message = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>;</li><li>      hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">`backToCallerAbilityWithResult failed, code is <span class="hljs-subst">${code}</span>, message is <span class="hljs-subst">${message}</span>`</span>);</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1264px;">     <h3 id="setrestoreenabled14" device-type="phone,2in1,tablet,wearable,tv">setRestoreEnabled<sup>14+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="setrestoreenabled14" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>setRestoreEnabled(enabled: boolean): void</p>     <p>设置UIAbility是否启用备份恢复。</p>     <p><strong>元服务API</strong>：从API version 14开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.38.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.38.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.38.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.38.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">enabled</td>         <td class="cellrowborder" width="25%">boolean</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">表示是否启用恢复。true表示启用，false表示不启用。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-ability">元能力子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.38.10.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.38.10.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">If the input parameter is not valid parameter.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000011</td>         <td class="cellrowborder" width="50%">The context does not exist.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-gnv-c106="" class="highlight-div"><div _ngcontent-gnv-c106="" class="highlight-div-header"><div _ngcontent-gnv-c106="" class="highlight-div-header-left"><div _ngcontent-gnv-c106="" class="handle-button expand-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gnv-c106="" class="highlight-div-header-right"><div _ngcontent-gnv-c106="" class="handle-button ai-button"></div><div _ngcontent-gnv-c106="" class="handle-button line-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gnv-c106="" class="handle-button theme-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gnv-c106="" class="handle-button copy-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gnv-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span>, <span class="hljs-title class_">AbilityConstant</span>, <span class="hljs-title class_">Want</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onCreate</span>(<span class="hljs-attr">want</span>: <span class="hljs-title class_">Want</span>, <span class="hljs-attr">launchParam</span>: <span class="hljs-title class_">AbilityConstant</span>.<span class="hljs-property">LaunchParam</span>): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-keyword">let</span> enabled = <span class="hljs-literal">true</span>;</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">setRestoreEnabled</span>(enabled);</li><li>    } <span class="hljs-keyword">catch</span> (paramError) {</li><li>      <span class="hljs-keyword">let</span> code = (paramError <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span>;</li><li>      <span class="hljs-keyword">let</span> message = (paramError <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>;</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`setRestoreEnabled failed, err code: <span class="hljs-subst">${code}</span>, err msg: <span class="hljs-subst">${message}</span>`</span>);</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 2715px;">     <h3 id="startuiserviceextensionability14" device-type="phone,2in1,tablet,wearable,tv">startUIServiceExtensionAbility<sup>14+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="startuiserviceextensionability14" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>startUIServiceExtensionAbility(want: Want): Promise&lt;void&gt;</p>     <p>启动一个UIServiceExtensionAbility。使用Promise异步回调。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>组件启动规则详见：<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/component-startup-rules" target="_blank">组件启动规则（Stage模型）</a>。</p>      </div></div></div>     <p><strong>元服务API</strong>：从API version 14开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.39.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.39.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.39.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.39.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">want</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-want">Want</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">启动UIServiceExtensionAbility的必要信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.39.10.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.39.10.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">Promise对象，包含接口执行结果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-ability">元能力子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.39.13.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.39.13.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">The application does not have permission to call the interface.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1. Mandatory parameters are left unspecified; 2. Incorrect parameter types; 3. Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000001</td>         <td class="cellrowborder" width="50%">The specified ability does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000002</td>         <td class="cellrowborder" width="50%">Incorrect ability type.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000004</td>         <td class="cellrowborder" width="50%">Cannot start an invisible component.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000005</td>         <td class="cellrowborder" width="50%">The specified process does not have the permission.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000008</td>         <td class="cellrowborder" width="50%">The crowdtesting application expires.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000011</td>         <td class="cellrowborder" width="50%">The context does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000012</td>         <td class="cellrowborder" width="50%">The application is controlled.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000013</td>         <td class="cellrowborder" width="50%">The application is controlled by EDM.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000019</td>         <td class="cellrowborder" width="50%">No matching ability is found.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000050</td>         <td class="cellrowborder" width="50%">Internal error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16200001</td>         <td class="cellrowborder" width="50%">The caller has been released.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-gnv-c106="" class="highlight-div"><div _ngcontent-gnv-c106="" class="highlight-div-header"><div _ngcontent-gnv-c106="" class="highlight-div-header-left"><div _ngcontent-gnv-c106="" class="handle-button expand-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gnv-c106="" class="highlight-div-header-right"><div _ngcontent-gnv-c106="" class="handle-button ai-button"></div><div _ngcontent-gnv-c106="" class="handle-button line-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gnv-c106="" class="handle-button theme-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gnv-c106="" class="handle-button copy-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gnv-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { common, <span class="hljs-title class_">Want</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Row</span>() {</li><li>        <span class="hljs-comment">// 创建启动按钮</span></li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">'start ability'</span>)</li><li>          .<span class="hljs-title function_">enabled</span>(<span class="hljs-literal">true</span>)</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-keyword">let</span> context = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li>            <span class="hljs-keyword">let</span> <span class="hljs-attr">startWant</span>: <span class="hljs-title class_">Want</span> = {</li><li>              <span class="hljs-attr">bundleName</span>: <span class="hljs-string">'com.acts.uiserviceextensionability'</span>,</li><li>              <span class="hljs-attr">abilityName</span>: <span class="hljs-string">'UiServiceExtAbility'</span>,</li><li>            };</li><li>            <span class="hljs-keyword">try</span> {</li><li>              <span class="hljs-comment">// 启动UIServiceExtensionAbility</span></li><li>              context.<span class="hljs-title function_">startUIServiceExtensionAbility</span>(startWant).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'startUIServiceExtensionAbility success'</span>);</li><li>              }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error: BusinessError</span>) =&gt;</span> {</li><li>                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'startUIServiceExtensionAbility error'</span>, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(error));</li><li>              })</li><li>            } <span class="hljs-keyword">catch</span> (err) {</li><li>              <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'startUIServiceExtensionAbility failed'</span>, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));</li><li>            }</li><li>          })</li><li>      }</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 3394px;">     <h3 id="connectuiserviceextensionability14" device-type="phone,2in1,tablet,wearable,tv">connectUIServiceExtensionAbility<sup>14+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="connectuiserviceextensionability14" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>connectUIServiceExtensionAbility(want: Want, callback: UIServiceExtensionConnectCallback) : Promise&lt;UIServiceProxy&gt;</p>     <p>连接一个UIServiceExtensionAbility。使用Promise异步回调。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>组件启动规则详见：<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/component-startup-rules" target="_blank">组件启动规则（Stage模型）</a>。</p>      </div></div></div>     <p><strong>元服务API</strong>：从API version 14开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.40.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.40.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.40.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.40.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">want</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-want">Want</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">连接UIServiceExtensionAbility的必要信息。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/nner-application-uiserviceextensionconnectcallback">UIServiceExtensionConnectCallback</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">连接UIServiceExtensionAbility回调。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.40.10.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.40.10.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;UIServiceProxy&gt;</td>         <td class="cellrowborder" width="50%">Promise对象，包含connectUIServiceExtensionAbility执行后返回的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiserviceproxy">UIServiceProxy</a>对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-ability">元能力子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.40.13.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.40.13.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">The application does not have permission to call the interface.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1. Mandatory parameters are left unspecified; 2. Incorrect parameter types; 3. Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000001</td>         <td class="cellrowborder" width="50%">The specified ability does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000002</td>         <td class="cellrowborder" width="50%">Incorrect ability type.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000004</td>         <td class="cellrowborder" width="50%">Cannot start an invisible component.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000005</td>         <td class="cellrowborder" width="50%">The specified process does not have the permission.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000008</td>         <td class="cellrowborder" width="50%">The crowdtesting application expires.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000011</td>         <td class="cellrowborder" width="50%">The context does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000013</td>         <td class="cellrowborder" width="50%">The application is controlled by EDM.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000050</td>         <td class="cellrowborder" width="50%">Internal error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000055</td>         <td class="cellrowborder" width="50%">Installation-free timed out.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-gnv-c106="" class="highlight-div"><div _ngcontent-gnv-c106="" class="highlight-div-header"><div _ngcontent-gnv-c106="" class="highlight-div-header-left"><div _ngcontent-gnv-c106="" class="handle-button expand-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gnv-c106="" class="highlight-div-header-right"><div _ngcontent-gnv-c106="" class="handle-button ai-button"></div><div _ngcontent-gnv-c106="" class="handle-button line-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gnv-c106="" class="handle-button theme-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gnv-c106="" class="handle-button copy-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gnv-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { common, <span class="hljs-title class_">Want</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">const</span> <span class="hljs-attr">TAG</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'[Extension] '</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">UIServiceExtensionAbility</span> {</li><li>  dataCallBack : common.<span class="hljs-property">UIServiceExtensionConnectCallback</span> = {</li><li>    <span class="hljs-comment">// 接收数据</span></li><li>    <span class="hljs-attr">onData</span>: <span class="hljs-function">(<span class="hljs-params">data: Record&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">Object</span>&gt;</span>) =&gt;</span> {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`dataCallBack received data`</span>, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data));</li><li>    },</li><li>    <span class="hljs-comment">// 连接断开</span></li><li>    <span class="hljs-attr">onDisconnect</span>: <span class="hljs-function">() =&gt;</span> {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`dataCallBack onDisconnect`</span>);</li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">async</span> <span class="hljs-title function_">myConnect</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-comment">// 获取上下文</span></li><li>    <span class="hljs-keyword">let</span> context = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">startWant</span>: <span class="hljs-title class_">Want</span> = {</li><li>      <span class="hljs-attr">deviceId</span>: <span class="hljs-string">''</span>,</li><li>      <span class="hljs-attr">bundleName</span>: <span class="hljs-string">'com.example.myapplication'</span>,</li><li>      <span class="hljs-attr">abilityName</span>: <span class="hljs-string">'UiServiceExtAbility'</span></li><li>    };</li><li>
</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-comment">// 连接服务</span></li><li>      context.<span class="hljs-title function_">connectUIServiceExtensionAbility</span>(startWant, <span class="hljs-variable language_">this</span>.<span class="hljs-property">dataCallBack</span>)</li><li>        .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">proxy: common.UIServiceProxy</span>) =&gt;</span> {</li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-variable constant_">TAG</span> + <span class="hljs-string">`try to connectUIServiceExtensionAbility`</span>, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(proxy));</li><li>        }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: <span class="hljs-built_in">Error</span></span>) =&gt;</span> {</li><li>        <span class="hljs-keyword">let</span> code = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span>;</li><li>        <span class="hljs-keyword">let</span> message = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>;</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-variable constant_">TAG</span> + <span class="hljs-string">`connectUIServiceExtensionAbility failed, code is <span class="hljs-subst">${code}</span>, message is <span class="hljs-subst">${message}</span>`</span>);</li><li>      });</li><li>    } <span class="hljs-keyword">catch</span> (err) {</li><li>      <span class="hljs-keyword">let</span> code = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span>;</li><li>      <span class="hljs-keyword">let</span> message = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>;</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-variable constant_">TAG</span> + <span class="hljs-string">`connectUIServiceExtensionAbility failed, code is <span class="hljs-subst">${code}</span>, message is <span class="hljs-subst">${message}</span>`</span>);</li><li>    };</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">RelativeContainer</span>() {</li><li>      <span class="hljs-comment">// 创建连接按钮</span></li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'connectServiceExtensionAbility'</span>, { <span class="hljs-attr">type</span>: <span class="hljs-title class_">ButtonType</span>.<span class="hljs-property">Capsule</span>, <span class="hljs-attr">stateEffect</span>: <span class="hljs-literal">true</span> })</li><li>        .<span class="hljs-title function_">alignRules</span>({</li><li>          <span class="hljs-attr">center</span>: { <span class="hljs-attr">anchor</span>: <span class="hljs-string">'__container__'</span>, <span class="hljs-attr">align</span>: <span class="hljs-title class_">VerticalAlign</span>.<span class="hljs-property">Center</span> },</li><li>          <span class="hljs-attr">middle</span>: { <span class="hljs-attr">anchor</span>: <span class="hljs-string">'__container__'</span>, <span class="hljs-attr">align</span>: <span class="hljs-title class_">HorizontalAlign</span>.<span class="hljs-property">Center</span> }</li><li>        })</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">myConnect</span>()</li><li>        });</li><li>    }</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 2566px;">     <h3 id="disconnectuiserviceextensionability14" device-type="phone,2in1,tablet,wearable,tv">disconnectUIServiceExtensionAbility<sup>14+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="disconnectuiserviceextensionability14" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>disconnectUIServiceExtensionAbility(proxy: UIServiceProxy): Promise&lt;void&gt;</p>     <p>断开与UIServiceExtensionAbility的连接。使用Promise异步回调。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>组件启动规则详见：<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/component-startup-rules" target="_blank">组件启动规则（Stage模型）</a>。</p>      </div></div></div>     <p><strong>元服务API</strong>：从API version 14开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.41.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.41.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.41.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.41.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">proxy</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiserviceproxy">UIServiceProxy</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext#connectuiserviceextensionability14">connectUIServiceExtensionAbility</a>执行返回的Proxy。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.41.10.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.41.10.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">Promise对象，包含接口执行结果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-ability">元能力子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.41.13.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.41.13.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1. Mandatory parameters are left unspecified; 2. Incorrect parameter types; 3. Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000011</td>         <td class="cellrowborder" width="50%">The context does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000050</td>         <td class="cellrowborder" width="50%">Internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-gnv-c106="" class="highlight-div"><div _ngcontent-gnv-c106="" class="highlight-div-header"><div _ngcontent-gnv-c106="" class="highlight-div-header-left"><div _ngcontent-gnv-c106="" class="handle-button expand-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gnv-c106="" class="highlight-div-header-right"><div _ngcontent-gnv-c106="" class="handle-button ai-button"></div><div _ngcontent-gnv-c106="" class="handle-button line-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gnv-c106="" class="handle-button theme-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gnv-c106="" class="handle-button copy-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gnv-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">const</span> <span class="hljs-attr">TAG</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'[Extension] '</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">UIServiceExtensionAbility</span> {</li><li>  <span class="hljs-attr">comProxy</span>: common.<span class="hljs-property">UIServiceProxy</span> | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Scroll</span>() {</li><li>      <span class="hljs-title class_">Column</span>() {</li><li>        <span class="hljs-comment">// 创建断开连接的按钮</span></li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">'disconnectUIServiceExtensionAbility'</span>, { <span class="hljs-attr">type</span>: <span class="hljs-title class_">ButtonType</span>.<span class="hljs-property">Capsule</span>, <span class="hljs-attr">stateEffect</span>: <span class="hljs-literal">true</span> })</li><li>          .<span class="hljs-title function_">margin</span>({</li><li>            <span class="hljs-attr">top</span>: <span class="hljs-number">5</span>,</li><li>            <span class="hljs-attr">left</span>: <span class="hljs-number">10</span>,</li><li>            <span class="hljs-attr">right</span>: <span class="hljs-number">10</span>,</li><li>            <span class="hljs-attr">bottom</span>: <span class="hljs-number">5</span></li><li>          })</li><li>          .<span class="hljs-title function_">alignRules</span>({</li><li>            <span class="hljs-attr">center</span>: { <span class="hljs-attr">anchor</span>: <span class="hljs-string">'__container__'</span>, <span class="hljs-attr">align</span>: <span class="hljs-title class_">VerticalAlign</span>.<span class="hljs-property">Center</span> },</li><li>            <span class="hljs-attr">middle</span>: { <span class="hljs-attr">anchor</span>: <span class="hljs-string">'__container__'</span>, <span class="hljs-attr">align</span>: <span class="hljs-title class_">HorizontalAlign</span>.<span class="hljs-property">Center</span> }</li><li>          })</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">myDisconnectUIServiceExtensionAbility</span>()</li><li>          });</li><li>      }</li><li>      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    }</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">myDisconnectUIServiceExtensionAbility</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">let</span> context = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li>
</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-comment">// 断开UIServiceExtension连接</span></li><li>      context.<span class="hljs-title function_">disconnectUIServiceExtensionAbility</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">comProxy</span>)</li><li>        .<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-variable constant_">TAG</span> + <span class="hljs-string">`disconnectUIServiceExtensionAbility succeed <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.comProxy}</span>`</span>);</li><li>        }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: <span class="hljs-built_in">Error</span></span>) =&gt;</span> {</li><li>        <span class="hljs-keyword">let</span> code = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span>;</li><li>        <span class="hljs-keyword">let</span> message = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>;</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-variable constant_">TAG</span> + <span class="hljs-string">`disconnectUIServiceExtensionAbility failed, code is <span class="hljs-subst">${code}</span>, message is <span class="hljs-subst">${message}</span>`</span>);</li><li>      });</li><li>    } <span class="hljs-keyword">catch</span> (err) {</li><li>      <span class="hljs-keyword">let</span> code = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span>;</li><li>      <span class="hljs-keyword">let</span> message = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>;</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-variable constant_">TAG</span> + <span class="hljs-string">`disconnectUIServiceExtensionAbility failed, code is <span class="hljs-subst">${code}</span>, message is <span class="hljs-subst">${message}</span>`</span>);</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 2293px;">     <h3 id="setabilityinstanceinfo15" device-type="phone,2in1,tablet,wearable,tv">setAbilityInstanceInfo<sup>15+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="setabilityinstanceinfo15" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>setAbilityInstanceInfo(label: string, icon: image.PixelMap) : Promise&lt;void&gt;</p>     <p>设置当前UIAbility实例的图标和标签信息。图标与标签信息可在任务中心和快捷栏的界面中显示。使用Promise异步回调。</p>     <p><strong>需要权限</strong>： ohos.permission.SET_ABILITY_INSTANCE_INFO</p>     <p><strong>系统能力</strong>： SystemCapability.Ability.AbilityRuntime.Core</p>     <p><strong>设备行为差异</strong>：该接口仅在2in1设备中可正常调用，在其他设备中返回801错误码。</p>     <p><strong>参数</strong>：</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.42.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.42.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.42.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.42.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">label</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">新的图标标签。标签长度不超过1024字节，且不可为空字符串。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">icon</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-image-pixelmap">image.PixelMap</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">新的图标。建议图标大小为512px*512px。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值</strong>：</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.42.10.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.42.10.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">Promise对象，包含接口执行结果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-ability">元能力子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.42.13.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.42.13.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">The application does not have permission to call the interface.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1. Mandatory parameters are left unspecified; 2. Incorrect parameter types; 3. Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000011</td>         <td class="cellrowborder" width="50%">The context does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000050</td>         <td class="cellrowborder" width="50%">Internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例</strong>：</p>     <div _ngcontent-gnv-c106="" class="highlight-div"><div _ngcontent-gnv-c106="" class="highlight-div-header"><div _ngcontent-gnv-c106="" class="highlight-div-header-left"><div _ngcontent-gnv-c106="" class="handle-button expand-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gnv-c106="" class="highlight-div-header-right"><div _ngcontent-gnv-c106="" class="handle-button ai-button"></div><div _ngcontent-gnv-c106="" class="handle-button line-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gnv-c106="" class="handle-button theme-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gnv-c106="" class="handle-button copy-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gnv-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { image } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ImageKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-variable language_">window</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onWindowStageCreate</span>(<span class="hljs-attr">windowStage</span>: <span class="hljs-variable language_">window</span>.<span class="hljs-property">WindowStage</span>): <span class="hljs-built_in">void</span> {</li><li>    windowStage.<span class="hljs-title function_">loadContent</span>(<span class="hljs-string">'pages/Index'</span>, <span class="hljs-keyword">async</span> (err, data) =&gt; {</li><li>      <span class="hljs-keyword">if</span> (err.<span class="hljs-property">code</span>) {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`loadContent failed, code is <span class="hljs-subst">${err.code}</span>`</span>);</li><li>        <span class="hljs-keyword">return</span>;</li><li>      }</li><li>
</li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">newLabel</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'instance label'</span>;</li><li>      <span class="hljs-keyword">let</span> color = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayBuffer</span>(<span class="hljs-number">512</span> * <span class="hljs-number">512</span> * <span class="hljs-number">4</span>); <span class="hljs-comment">// 创建一个ArrayBuffer对象，用于存储图像像素。该对象的大小为（height * width * 4）字节。</span></li><li>      <span class="hljs-keyword">let</span> bufferArr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(color);</li><li>      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; bufferArr.<span class="hljs-property">length</span>; i += <span class="hljs-number">4</span>) {</li><li>        bufferArr[i] = <span class="hljs-number">255</span>;</li><li>        bufferArr[i+<span class="hljs-number">1</span>] = <span class="hljs-number">0</span>;</li><li>        bufferArr[i+<span class="hljs-number">2</span>] = <span class="hljs-number">122</span>;</li><li>        bufferArr[i+<span class="hljs-number">3</span>] = <span class="hljs-number">255</span>;</li><li>      }</li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">opts</span>: image.<span class="hljs-property">InitializationOptions</span> = {</li><li>        <span class="hljs-attr">editable</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">pixelFormat</span>: image.<span class="hljs-property">PixelMapFormat</span>.<span class="hljs-property">RGBA_8888</span>, <span class="hljs-attr">size</span>: { <span class="hljs-attr">height</span>: <span class="hljs-number">512</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">512</span> }</li><li>      };</li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">imagePixelMap</span>: image.<span class="hljs-property">PixelMap</span> = <span class="hljs-keyword">await</span> image.<span class="hljs-title function_">createPixelMap</span>(color, opts);</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">setAbilityInstanceInfo</span>(newLabel, imagePixelMap)</li><li>        .<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'setAbilityInstanceInfo success'</span>);</li><li>        }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`setAbilityInstanceInfo failed, code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>      });</li><li>    });</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 2176px;">     <h3 id="revokedelegator17" device-type="phone,2in1,tablet,wearable,tv">revokeDelegator<sup>17+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="revokedelegator17" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>revokeDelegator() : Promise&lt;void&gt;</p>     <p>如果Module下首个UIAbility启动时期望重定向到另一个UIAbility，该重定向的UIAbility被称为“DelegatorAbility”。DelegatorAbility的设置详见当前接口示例的步骤1。</p>     <p>当DelegatorAbility完成特定操作时，可以使用该接口回到首个UIAbility。使用Promise异步回调。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>当接口调用成功后，DelegatorAbility中的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-window">Window</a>方法会失效。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.Core</p>     <p><strong>返回值</strong>：</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.43.8.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.43.8.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">Promise对象，包含接口执行结果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-ability">元能力子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.43.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.43.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not support.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000011</td>         <td class="cellrowborder" width="50%">The context does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000050</td>         <td class="cellrowborder" width="50%">Internal error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000065</td>         <td class="cellrowborder" width="50%">The API can be called only when the ability is running in the foreground.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000084</td>         <td class="cellrowborder" width="50%">Only DelegatorAbility is allowed to call this API, and only once.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000085</td>         <td class="cellrowborder" width="50%">An error occurred during the interaction between the ability and window.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例</strong>：</p>     <ol>      <li>       <p>设置DelegatorAbility。</p>       <p>在<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/module-configuration-file" target="_blank">module.json5</a>配置文件标签中配置abilitySrcEntryDelegator和abilityStageSrcEntryDelegator。当Module下首个UIAbility冷启动时，系统优先启动abilitySrcEntryDelegator指向的UIAbility。</p>       <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">         <ul>          <li>当UIAbility是通过<a href="/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext#startabilitybycall">startAbilityByCall</a>启动时，系统会忽略在<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/module-configuration-file" target="_blank">module.json5</a>配置文件标签中配置的abilitySrcEntryDelegator和abilityStageSrcEntryDelegator。</li>          <li>abilityStageSrcEntryDelegator指定的ModuleName不能与当前ModuleName相同。</li>         </ul>        </div></div></div>       <div _ngcontent-gnv-c106="" class="highlight-div"><div _ngcontent-gnv-c106="" class="highlight-div-header"><div _ngcontent-gnv-c106="" class="highlight-div-header-left"><div _ngcontent-gnv-c106="" class="handle-button expand-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gnv-c106="" class="highlight-div-header-right"><div _ngcontent-gnv-c106="" class="handle-button ai-button"></div><div _ngcontent-gnv-c106="" class="handle-button line-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gnv-c106="" class="handle-button theme-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gnv-c106="" class="handle-button copy-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gnv-c106="" class="highlight-scroll-div"><pre class="json prettyprint linenums hljs language-json" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-punctuation">{</span></li><li>  <span class="hljs-attr">"module"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>    <span class="hljs-comment">// ...</span></li><li>    <span class="hljs-attr">"abilityStageSrcEntryDelegator"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"xxxModuleName"</span><span class="hljs-punctuation">,</span></li><li>    <span class="hljs-attr">"abilitySrcEntryDelegator"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"xxxAbilityName"</span><span class="hljs-punctuation">,</span></li><li>    <span class="hljs-comment">// ...</span></li><li>  <span class="hljs-punctuation">}</span></li><li><span class="hljs-punctuation">}</span></li></ol></pre></div></div></li>      <li>       <p>取消DelegatorAbility。</p>       <div _ngcontent-gnv-c106="" class="highlight-div"><div _ngcontent-gnv-c106="" class="highlight-div-header"><div _ngcontent-gnv-c106="" class="highlight-div-header-left"><div _ngcontent-gnv-c106="" class="handle-button expand-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gnv-c106="" class="highlight-div-header-right"><div _ngcontent-gnv-c106="" class="handle-button ai-button"></div><div _ngcontent-gnv-c106="" class="handle-button line-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gnv-c106="" class="handle-button theme-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gnv-c106="" class="handle-button copy-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gnv-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DelegatorAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onForeground</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-comment">// DelegatorAbility完成特定操作后，调用revokeDelegator回到首个UIAbility</span></li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">revokeDelegator</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'revokeDelegator success'</span>);</li><li>    }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`revokeDelegator failed, code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>    });</li><li>  }</li><li>}</li></ol></pre></div></div></li>     </ol>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1589px;">     <h3 id="setcolormode18" device-type="phone,2in1,tablet,wearable,tv">setColorMode<sup>18+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="setcolormode18" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>setColorMode(colorMode: ConfigurationConstant.ColorMode): void</p>     <p>设置UIAbility的深浅色模式。调用该接口前需要保证该UIAbility对应页面已完成加载。仅支持主线程调用。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <ul>        <li>调用该接口前，需要确保窗口已完成创建、且UIAbility对应的页面已完成加载，即在<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability#onwindowstagecreate">onWindowStageCreate()</a>生命周期中通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-window-windowstage#loadcontent9">loadContent</a>方法加载页面之后调用。</li>        <li>调用该接口后会创建新的资源管理器对象，如果此前有缓存资源管理器，需要进行更新。</li>        <li>深浅色模式生效的优先级：UIAbility的深浅色模式 &gt; 应用的深浅色模式（<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-applicationcontext#applicationcontextsetcolormode11">ApplicationContext.setColorMode</a>）&gt; 系统的深浅色模式。</li>       </ul>      </div></div></div>     <p><strong>元服务API</strong>：从API version 18开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.Core</p>     <p><strong>参数</strong>：</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.44.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.44.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.44.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.44.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">colorMode</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-configurationconstant">ConfigurationConstant.ColorMode</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">          <p>设置颜色模式，包括:</p>          <p>- COLOR_MODE_DARK：深色模式</p>          <p>- COLOR_MODE_LIGHT：浅色模式</p>          <p>- COLOR_MODE_NOT_SET：不设置（跟随系统或应用）</p></td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-ability">元能力子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.44.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.44.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">16000011</td>         <td class="cellrowborder" width="50%">The context does not exist.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例</strong>：</p>     <div _ngcontent-gnv-c106="" class="highlight-div"><div _ngcontent-gnv-c106="" class="highlight-div-header"><div _ngcontent-gnv-c106="" class="highlight-div-header-left"><div _ngcontent-gnv-c106="" class="handle-button expand-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gnv-c106="" class="highlight-div-header-right"><div _ngcontent-gnv-c106="" class="handle-button ai-button"></div><div _ngcontent-gnv-c106="" class="handle-button line-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gnv-c106="" class="handle-button theme-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gnv-c106="" class="handle-button copy-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gnv-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span>, <span class="hljs-title class_">ConfigurationConstant</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-variable language_">window</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onWindowStageCreate</span>(<span class="hljs-params">windowStage: <span class="hljs-variable language_">window</span>.WindowStage</span>) {</li><li>    windowStage.<span class="hljs-title function_">loadContent</span>(<span class="hljs-string">'pages/Index'</span>, <span class="hljs-function">(<span class="hljs-params">err, data</span>) =&gt;</span> {</li><li>      <span class="hljs-keyword">if</span> (err.<span class="hljs-property">code</span>) {</li><li>        hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">'Failed to load the content.'</span>);</li><li>        <span class="hljs-keyword">return</span>;</li><li>      }</li><li>      <span class="hljs-keyword">let</span> uiAbilityContext = <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>;</li><li>      uiAbilityContext.<span class="hljs-title function_">setColorMode</span>(<span class="hljs-title class_">ConfigurationConstant</span>.<span class="hljs-property">ColorMode</span>.<span class="hljs-property">COLOR_MODE_DARK</span>);</li><li>    });</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 2540px;">     <h3 id="startappserviceextensionability20" device-type="phone,2in1,tablet,wearable,tv">startAppServiceExtensionAbility<sup>20+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="startappserviceextensionability20" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>startAppServiceExtensionAbility(want: Want): Promise&lt;void&gt;</p>     <p>启动<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-appserviceextensionability">AppServiceExtensionAbility</a>实例。使用Promise异步回调。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>该接口的调用方必须为<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-appserviceextensionability">AppServiceExtensionAbility</a>所属应用或者在AppServiceExtensionAbility支持的应用清单（即<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/module-configuration-file#extensionabilities标签" target="_blank">extensionAbilities标签</a>的appIdentifierAllowList属性）中的应用。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.Core</p>     <p><strong>设备行为差异</strong>：该接口仅在2in1设备中可正常调用，在其他设备中返回801错误码。</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.45.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.45.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.45.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.45.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">want</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-want">Want</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">启动<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-appserviceextensionability">AppServiceExtensionAbility</a>的Want信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值</strong>：</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.45.10.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.45.10.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">Promise对象。无返回结果的Promise对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-ability">元能力子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.45.13.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.45.13.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000001</td>         <td class="cellrowborder" width="50%">The specified ability does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000002</td>         <td class="cellrowborder" width="50%">Incorrect ability type.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000004</td>         <td class="cellrowborder" width="50%">Cannot start an invisible component.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000005</td>         <td class="cellrowborder" width="50%">The specified process does not have the permission.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000006</td>         <td class="cellrowborder" width="50%">Cross-user operations are not allowed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000008</td>         <td class="cellrowborder" width="50%">The crowdtesting application expires.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000011</td>         <td class="cellrowborder" width="50%">The context does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000012</td>         <td class="cellrowborder" width="50%">The application is controlled.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000013</td>         <td class="cellrowborder" width="50%">The application is controlled by EDM.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000019</td>         <td class="cellrowborder" width="50%">No matching ability is found.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000050</td>         <td class="cellrowborder" width="50%">Internal error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000200</td>         <td class="cellrowborder" width="50%">The caller is not in the appIdentifierAllowList of the target application.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-gnv-c106="" class="highlight-div"><div _ngcontent-gnv-c106="" class="highlight-div-header"><div _ngcontent-gnv-c106="" class="highlight-div-header-left"><div _ngcontent-gnv-c106="" class="handle-button expand-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gnv-c106="" class="highlight-div-header-right"><div _ngcontent-gnv-c106="" class="handle-button ai-button"></div><div _ngcontent-gnv-c106="" class="handle-button line-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gnv-c106="" class="handle-button theme-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gnv-c106="" class="handle-button copy-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gnv-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span>, <span class="hljs-title class_">Want</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onForeground</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">want</span>: <span class="hljs-title class_">Want</span> = {</li><li>      <span class="hljs-attr">deviceId</span>: <span class="hljs-string">''</span>,</li><li>      <span class="hljs-attr">bundleName</span>: <span class="hljs-string">'com.example.myapplication'</span>,</li><li>      <span class="hljs-attr">abilityName</span>: <span class="hljs-string">'AppServiceExtensionAbility'</span></li><li>    };</li><li>
</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">startAppServiceExtensionAbility</span>(want)</li><li>        .<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-comment">// 执行正常业务</span></li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'startAppServiceExtensionAbility succeed'</span>);</li><li>        })</li><li>        .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>          <span class="hljs-comment">// 处理业务逻辑错误</span></li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`startAppServiceExtensionAbility failed, code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>        });</li><li>    } <span class="hljs-keyword">catch</span> (err) {</li><li>      <span class="hljs-comment">// 处理入参错误异常</span></li><li>      <span class="hljs-keyword">let</span> code = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span>;</li><li>      <span class="hljs-keyword">let</span> message = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>;</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`startAppServiceExtensionAbility failed, code is <span class="hljs-subst">${code}</span>, message is <span class="hljs-subst">${message}</span>`</span>);</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 2320px;">     <h3 id="stopappserviceextensionability20" device-type="phone,2in1,tablet,wearable,tv">stopAppServiceExtensionAbility<sup>20+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="stopappserviceextensionability20" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>stopAppServiceExtensionAbility(want: Want): Promise&lt;void&gt;</p>     <p>停止<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-appserviceextensionability">AppServiceExtensionAbility</a>实例。使用Promise异步回调。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>该接口的调用方必须为<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-appserviceextensionability">AppServiceExtensionAbility</a>所属应用或者在AppServiceExtensionAbility支持的应用清单（即<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/module-configuration-file#extensionabilities标签" target="_blank">extensionAbilities标签</a>的appIdentifierAllowList属性）中的应用。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.Core</p>     <p><strong>设备行为差异</strong>：该接口仅在2in1设备中可正常调用，在其他设备中返回801错误码。</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.46.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.46.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.46.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.46.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">want</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-want">Want</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">停止<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-appserviceextensionability">AppServiceExtensionAbility</a>的Want信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值</strong>：</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.46.10.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.46.10.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">Promise对象。无返回结果的Promise对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-ability">元能力子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.46.13.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.46.13.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000001</td>         <td class="cellrowborder" width="50%">The specified ability does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000002</td>         <td class="cellrowborder" width="50%">Incorrect ability type.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000004</td>         <td class="cellrowborder" width="50%">Cannot start an invisible component.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000005</td>         <td class="cellrowborder" width="50%">The specified process does not have the permission.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000006</td>         <td class="cellrowborder" width="50%">Cross-user operations are not allowed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000011</td>         <td class="cellrowborder" width="50%">The context does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000050</td>         <td class="cellrowborder" width="50%">Internal error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000200</td>         <td class="cellrowborder" width="50%">The caller is not in the appIdentifierAllowList of the target application.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-gnv-c106="" class="highlight-div"><div _ngcontent-gnv-c106="" class="highlight-div-header"><div _ngcontent-gnv-c106="" class="highlight-div-header-left"><div _ngcontent-gnv-c106="" class="handle-button expand-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gnv-c106="" class="highlight-div-header-right"><div _ngcontent-gnv-c106="" class="handle-button ai-button"></div><div _ngcontent-gnv-c106="" class="handle-button line-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gnv-c106="" class="handle-button theme-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gnv-c106="" class="handle-button copy-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gnv-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span>, <span class="hljs-title class_">Want</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onForeground</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">want</span>: <span class="hljs-title class_">Want</span> = {</li><li>      <span class="hljs-attr">deviceId</span>: <span class="hljs-string">''</span>,</li><li>      <span class="hljs-attr">bundleName</span>: <span class="hljs-string">'com.example.myapplication'</span>,</li><li>      <span class="hljs-attr">abilityName</span>: <span class="hljs-string">'AppServiceExtensionAbility'</span></li><li>    };</li><li>
</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">stopAppServiceExtensionAbility</span>(want)</li><li>        .<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-comment">// 执行正常业务</span></li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'stopAppServiceExtensionAbility succeed'</span>);</li><li>        })</li><li>        .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>          <span class="hljs-comment">// 处理业务逻辑错误</span></li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`stopAppServiceExtensionAbility failed, code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>        });</li><li>    } <span class="hljs-keyword">catch</span> (err) {</li><li>      <span class="hljs-comment">// 处理入参错误异常</span></li><li>      <span class="hljs-keyword">let</span> code = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span>;</li><li>      <span class="hljs-keyword">let</span> message = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>;</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`stopAppServiceExtensionAbility failed, code is <span class="hljs-subst">${code}</span>, message is <span class="hljs-subst">${message}</span>`</span>);</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 2660px;">     <h3 id="connectappserviceextensionability20" device-type="phone,2in1,tablet,wearable,tv">connectAppServiceExtensionAbility<sup>20+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="connectappserviceextensionability20" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>connectAppServiceExtensionAbility(want: Want, callback: ConnectOptions): number</p>     <p>将当前UIAbility连接到<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-appserviceextensionability">AppServiceExtensionAbility</a>。通过返回的proxy与AppServiceExtensionAbility进行通信，以使用AppServiceExtensionAbility对外提供的能力。仅支持在主线程调用。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>如果<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-appserviceextensionability">AppServiceExtensionAbility</a>实例未启动，该接口的调用方必须为AppServiceExtensionAbility所属应用或者在AppServiceExtensionAbility支持的应用清单（即<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/module-configuration-file#extensionabilities标签" target="_blank">extensionAbilities标签</a>的appIdentifierAllowList属性）中的应用。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.Core</p>     <p><strong>设备行为差异</strong>：该接口仅在2in1设备中可正常调用，在其他设备中返回801错误码。</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.47.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.47.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.47.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.47.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">want</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-want">Want</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">连接<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-appserviceextensionability">AppServiceExtensionAbility</a>的Want信息。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-ability-connectoptions">ConnectOptions</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">ConnectOptions类型的回调函数，返回服务连接成功、连接失败、断开的信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.47.10.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.47.10.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">number</td>         <td class="cellrowborder" width="50%">返回连接id，<a href="/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext#disconnectappserviceextensionability20">disconnectAppServiceExtensionAbility</a>根据该连接id断开连接。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-ability">元能力子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.47.13.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.47.13.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000001</td>         <td class="cellrowborder" width="50%">The specified ability does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000002</td>         <td class="cellrowborder" width="50%">Incorrect ability type.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000004</td>         <td class="cellrowborder" width="50%">Cannot start an invisible component.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000005</td>         <td class="cellrowborder" width="50%">The specified process does not have the permission.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000006</td>         <td class="cellrowborder" width="50%">Cross-user operations are not allowed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000008</td>         <td class="cellrowborder" width="50%">The crowdtesting application expires.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000011</td>         <td class="cellrowborder" width="50%">The context does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000050</td>         <td class="cellrowborder" width="50%">Internal error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000201</td>         <td class="cellrowborder" width="50%">The target service has not been started yet.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-gnv-c106="" class="highlight-div"><div _ngcontent-gnv-c106="" class="highlight-div-header"><div _ngcontent-gnv-c106="" class="highlight-div-header-left"><div _ngcontent-gnv-c106="" class="handle-button expand-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gnv-c106="" class="highlight-div-header-right"><div _ngcontent-gnv-c106="" class="handle-button ai-button"></div><div _ngcontent-gnv-c106="" class="handle-button line-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gnv-c106="" class="handle-button theme-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gnv-c106="" class="handle-button copy-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gnv-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span>, <span class="hljs-title class_">Want</span>, common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { rpc } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.IPCKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onForeground</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">want</span>: <span class="hljs-title class_">Want</span> = {</li><li>      <span class="hljs-attr">deviceId</span>: <span class="hljs-string">''</span>,</li><li>      <span class="hljs-attr">bundleName</span>: <span class="hljs-string">'com.example.myapplication'</span>,</li><li>      <span class="hljs-attr">abilityName</span>: <span class="hljs-string">'AppServiceExtensionAbility'</span></li><li>    };</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">commRemote</span>: rpc.<span class="hljs-property">IRemoteObject</span>;</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">callback</span>: common.<span class="hljs-property">ConnectOptions</span> = {</li><li>      <span class="hljs-title function_">onConnect</span>(<span class="hljs-params">elementName, remote</span>) {</li><li>        commRemote = remote;</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'onConnect...'</span>);</li><li>      },</li><li>      <span class="hljs-title function_">onDisconnect</span>(<span class="hljs-params">elementName</span>) {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'onDisconnect...'</span>);</li><li>      },</li><li>      <span class="hljs-title function_">onFailed</span>(<span class="hljs-params">code</span>) {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'onFailed...'</span>);</li><li>      }</li><li>    };</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">connection</span>: <span class="hljs-built_in">number</span>;</li><li>
</li><li>    <span class="hljs-keyword">try</span> {</li><li>      connection = <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">connectAppServiceExtensionAbility</span>(want, callback);</li><li>    } <span class="hljs-keyword">catch</span> (err) {</li><li>      <span class="hljs-comment">// 处理入参错误异常</span></li><li>      <span class="hljs-keyword">let</span> code = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span>;</li><li>      <span class="hljs-keyword">let</span> message = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>;</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`connectAppServiceExtensionAbility failed, code is <span class="hljs-subst">${code}</span>, message is <span class="hljs-subst">${message}</span>`</span>);</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1874px;">     <h3 id="disconnectappserviceextensionability20" device-type="phone,2in1,tablet,wearable,tv">disconnectAppServiceExtensionAbility<sup>20+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="disconnectappserviceextensionability20" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>disconnectAppServiceExtensionAbility(connection: number): Promise&lt;void&gt;</p>     <p>断开与<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-appserviceextensionability">AppServiceExtensionAbility</a>的连接。仅支持在主线程调用。使用Promise异步回调。</p>     <p>断开连接之后，为了防止使用可能失效的remote对象进行通信，建议将连接成功时返回的remote对象设置为null。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.Core</p>     <p><strong>设备行为差异</strong>：该接口仅在2in1设备中可正常调用，在其他设备中返回801错误码。</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.48.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.48.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.48.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.48.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">connection</td>         <td class="cellrowborder" width="25%">number</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">在<a href="/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext#connectappserviceextensionability20">connectAppServiceExtensionAbility</a>返回的连接id。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.48.10.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.48.10.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">Promise对象。无返回结果的Promise对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-ability">元能力子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.48.13.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.48.13.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000011</td>         <td class="cellrowborder" width="50%">The context does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000050</td>         <td class="cellrowborder" width="50%">Internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-gnv-c106="" class="highlight-div"><div _ngcontent-gnv-c106="" class="highlight-div-header"><div _ngcontent-gnv-c106="" class="highlight-div-header-left"><div _ngcontent-gnv-c106="" class="handle-button expand-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gnv-c106="" class="highlight-div-header-right"><div _ngcontent-gnv-c106="" class="handle-button ai-button"></div><div _ngcontent-gnv-c106="" class="handle-button line-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gnv-c106="" class="handle-button theme-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gnv-c106="" class="handle-button copy-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gnv-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { rpc } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.IPCKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onForeground</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-comment">// connection为connectAppServiceExtensionAbility中的返回值</span></li><li>    <span class="hljs-keyword">let</span> connection = <span class="hljs-number">1</span>;</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">commRemote</span>: rpc.<span class="hljs-property">IRemoteObject</span> | <span class="hljs-literal">null</span>;</li><li>
</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">disconnectAppServiceExtensionAbility</span>(connection).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>        commRemote = <span class="hljs-literal">null</span>;</li><li>        <span class="hljs-comment">// 执行正常业务</span></li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'disconnectAppServiceExtensionAbility succeed'</span>);</li><li>      }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>        <span class="hljs-comment">// 处理业务逻辑错误</span></li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`disconnectAppServiceExtensionAbility failed, code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>      });</li><li>    } <span class="hljs-keyword">catch</span> (err) {</li><li>      commRemote = <span class="hljs-literal">null</span>;</li><li>      <span class="hljs-comment">// 处理入参错误异常</span></li><li>      <span class="hljs-keyword">let</span> code = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span>;</li><li>      <span class="hljs-keyword">let</span> message = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>;</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`disconnectAppServiceExtensionAbility failed, code is <span class="hljs-subst">${code}</span>, message is <span class="hljs-subst">${message}</span>`</span>);</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1736px;">     <h3 id="setonnewwantskipscenarios20" device-type="phone,2in1,tablet,wearable,tv">setOnNewWantSkipScenarios<sup>20+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="setonnewwantskipscenarios20" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>setOnNewWantSkipScenarios(scenarios: number): Promise&lt;void&gt;</p>     <p>在特定场景下拉起UIAbility时，如果不需要触发<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability#onnewwant">onNewWant</a>生命周期回调，可以通过该接口设置。仅支持在主线程调用。使用Promise异步回调。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>该接口通常用于<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability#oncreate">onCreate</a>生命周期回调中。入参取值建议包含所有的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-contextconstant#scenarios20">Scenarios</a>枚举值。详见下方示例代码。</p>      </div></div></div>     <p><strong>元服务API</strong>：从API version 20开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.49.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.49.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.49.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.49.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">scenarios</td>         <td class="cellrowborder" width="25%">number</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">取值范围请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-contextconstant#scenarios20">Scenarios</a>。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.49.10.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.49.10.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">Promise对象。无返回结果的Promise对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-ability">元能力子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.49.13.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.49.13.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">16000050</td>         <td class="cellrowborder" width="50%">Internal error. Possible causes: Connection to service failed.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-gnv-c106="" class="highlight-div"><div _ngcontent-gnv-c106="" class="highlight-div-header"><div _ngcontent-gnv-c106="" class="highlight-div-header-left"><div _ngcontent-gnv-c106="" class="handle-button expand-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gnv-c106="" class="highlight-div-header-right"><div _ngcontent-gnv-c106="" class="handle-button ai-button"></div><div _ngcontent-gnv-c106="" class="handle-button line-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gnv-c106="" class="handle-button theme-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gnv-c106="" class="handle-button copy-button"><div _ngcontent-gnv-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gnv-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AbilityConstant</span>, contextConstant, <span class="hljs-title class_">UIAbility</span>, <span class="hljs-title class_">Want</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onCreate</span>(<span class="hljs-params">want: Want, launchParam: AbilityConstant.LaunchParam</span>) {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">scenarios</span>: <span class="hljs-built_in">number</span> = contextConstant.<span class="hljs-property">Scenarios</span>.<span class="hljs-property">SCENARIO_MOVE_MISSION_TO_FRONT</span> |</li><li>      contextConstant.<span class="hljs-property">Scenarios</span>.<span class="hljs-property">SCENARIO_SHOW_ABILITY</span> |</li><li>      contextConstant.<span class="hljs-property">Scenarios</span>.<span class="hljs-property">SCENARIO_BACK_TO_CALLER_ABILITY_WITH_RESULT</span>;</li><li>
</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">setOnNewWantSkipScenarios</span>(scenarios).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>        <span class="hljs-comment">// 执行正常业务</span></li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'setOnNewWantSkipScenarios succeed'</span>);</li><li>      }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>        <span class="hljs-comment">// 处理业务逻辑错误</span></li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`setOnNewWantSkipScenarios failed, code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>      });</li><li>    } <span class="hljs-keyword">catch</span> (err) {</li><li>      <span class="hljs-comment">// 处理入参错误异常</span></li><li>      <span class="hljs-keyword">let</span> code = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span>;</li><li>      <span class="hljs-keyword">let</span> message = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>;</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`setOnNewWantSkipScenarios failed, code is <span class="hljs-subst">${code}</span>, message is <span class="hljs-subst">${message}</span>`</span>);</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>   </div>   <div></div></div>