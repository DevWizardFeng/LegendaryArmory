<h1 _ngcontent-cks-c119="" class="doc-title ng-star-inserted" title="UIExtensionContext"> UIExtensionContext </h1>

<div _ngcontent-cks-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p>UIExtensionContext是<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiextensionability">UIExtensionAbility</a>的上下文环境，继承自<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-extensioncontext">ExtensionContext</a>，提供<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiextensionability">UIExtensionAbility</a>的相关配置信息以及操作<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability">UIAbility</a>的方法，如启动<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability">UIAbility</a>等。</p>    <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">      <ul>       <li>本模块首批接口从API version 10开始支持。后续版本的新增接口，采用上角标单独标记接口的起始版本。</li>       <li>本模块接口仅可在Stage模型下使用。</li>       <li>本模块接口需要在主线程中使用，不要在Worker、TaskPool等子线程中使用。</li>      </ul>     </div></div></div>    <div class="tiledSection">     <h2 id="导入模块" device-type="phone,2in1,tablet,wearable,tv">导入模块<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="导入模块" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><div _ngcontent-cks-c106="" class="highlight-div"><div _ngcontent-cks-c106="" class="highlight-div-header"><div _ngcontent-cks-c106="" class="highlight-div-header-left"><div _ngcontent-cks-c106="" class="handle-button expand-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-cks-c106="" class="highlight-div-header-right"><div _ngcontent-cks-c106="" class="handle-button ai-button"></div><div _ngcontent-cks-c106="" class="handle-button line-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-cks-c106="" class="handle-button theme-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-cks-c106="" class="handle-button copy-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-cks-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="uiextensioncontext-1" device-type="phone,2in1,tablet,wearable,tv">UIExtensionContext<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="uiextensioncontext-1" tips="复制节点链接"></i></h2>         <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div></div>    <div class="tiledSection">     <h3 id="startability" device-type="phone,2in1,tablet,wearable,tv" class="firsth2">startAbility<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="startability" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>startAbility(want: Want, callback: AsyncCallback&lt;void&gt;): void</p>     <p>启动一个UIAbility。使用callback异步回调。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>组件启动规则详见：<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/component-startup-rules" target="_blank">组件启动规则（Stage模型）</a>。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.5.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.5.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.5.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.5.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">want</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-want">Want</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">启动UIAbility时必要的Want，包含待启动UIAbility的名称等信息。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;void&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。当启动UIAbility成功时，err为undefined，否则为错误对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-ability">元能力子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.5.10.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.5.10.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">The application does not have permission to call the interface.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1.Mandatory parameters are left unspecified. 2.Incorrect parameter types.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000001</td>         <td class="cellrowborder" width="50%">The specified ability does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000002</td>         <td class="cellrowborder" width="50%">Incorrect ability type.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000004</td>         <td class="cellrowborder" width="50%">Cannot start an invisible component.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000005</td>         <td class="cellrowborder" width="50%">The specified process does not have the permission.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000006</td>         <td class="cellrowborder" width="50%">Cross-user operations are not allowed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000008</td>         <td class="cellrowborder" width="50%">The crowdtesting application expires.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000009</td>         <td class="cellrowborder" width="50%">An ability cannot be started or stopped in Wukong mode.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000010</td>         <td class="cellrowborder" width="50%">The call with the continuation and prepare continuation flag is forbidden.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000011</td>         <td class="cellrowborder" width="50%">The context does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000012</td>         <td class="cellrowborder" width="50%">The application is controlled.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000013</td>         <td class="cellrowborder" width="50%">The application is controlled by EDM.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000018</td>         <td class="cellrowborder" width="50%">Redirection to a third-party application is not allowed in API version greater than 11.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000019</td>         <td class="cellrowborder" width="50%">No matching ability is found.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000050</td>         <td class="cellrowborder" width="50%">Internal error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000053</td>         <td class="cellrowborder" width="50%">The ability is not on the top of the UI.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000055</td>         <td class="cellrowborder" width="50%">Installation-free timed out.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000069</td>         <td class="cellrowborder" width="50%">The extension cannot start the third party application.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000070</td>         <td class="cellrowborder" width="50%">The extension cannot start the service.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000071</td>         <td class="cellrowborder" width="50%">App clone is not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000072</td>         <td class="cellrowborder" width="50%">App clone or multi-instance is not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000073</td>         <td class="cellrowborder" width="50%">The app clone index is invalid.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000076</td>         <td class="cellrowborder" width="50%">The app instance key is invalid.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000077</td>         <td class="cellrowborder" width="50%">The number of app instances reaches the limit.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000078</td>         <td class="cellrowborder" width="50%">The multi-instance is not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000079</td>         <td class="cellrowborder" width="50%">The APP_INSTANCE_KEY cannot be specified.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000080</td>         <td class="cellrowborder" width="50%">Creating a new instance is not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16200001</td>         <td class="cellrowborder" width="50%">The caller has been released.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-cks-c106="" class="highlight-div"><div _ngcontent-cks-c106="" class="highlight-div-header"><div _ngcontent-cks-c106="" class="highlight-div-header-left"><div _ngcontent-cks-c106="" class="handle-button expand-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-cks-c106="" class="highlight-div-header-right"><div _ngcontent-cks-c106="" class="handle-button ai-button"></div><div _ngcontent-cks-c106="" class="handle-button line-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-cks-c106="" class="handle-button theme-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-cks-c106="" class="handle-button copy-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-cks-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// UIExtensionAbility不支持三方应用直接继承，故以派生类ShareExtensionAbility举例说明。</span></li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">ShareExtensionAbility</span>, <span class="hljs-title class_">Want</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ShareExtAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">ShareExtensionAbility</span> {</li><li>
</li><li>  <span class="hljs-title function_">onForeground</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">want</span>: <span class="hljs-title class_">Want</span> = {</li><li>      <span class="hljs-attr">bundleName</span>: <span class="hljs-string">'com.example.myapplication'</span>,</li><li>      <span class="hljs-attr">abilityName</span>: <span class="hljs-string">'EntryAbility'</span></li><li>    };</li><li>
</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">startAbility</span>(want, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>        <span class="hljs-keyword">if</span> (err.<span class="hljs-property">code</span>) {</li><li>          <span class="hljs-comment">// 处理业务逻辑错误</span></li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`startAbility failed, code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>          <span class="hljs-keyword">return</span>;</li><li>        }</li><li>        <span class="hljs-comment">// 执行正常业务</span></li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'startAbility succeed'</span>);</li><li>      });</li><li>    } <span class="hljs-keyword">catch</span> (err) {</li><li>      <span class="hljs-comment">// 处理入参错误异常</span></li><li>      <span class="hljs-keyword">let</span> code = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span>;</li><li>      <span class="hljs-keyword">let</span> message = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>;</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`startAbility failed, code is <span class="hljs-subst">${code}</span>, message is <span class="hljs-subst">${message}</span>`</span>);</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="startability-1" device-type="phone,2in1,tablet,wearable,tv">startAbility<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="startability-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>startAbility(want: Want, options: StartOptions, callback: AsyncCallback&lt;void&gt;): void</p>     <p>启动一个UIAbility。使用callback异步回调。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>组件启动规则详见：<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/component-startup-rules" target="_blank">组件启动规则（Stage模型）</a>。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.6.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.6.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.6.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.6.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">want</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-want">Want</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">启动UIAbility时必要的Want，包含待启动UIAbility的名称等信息。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">options</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-startoptions">StartOptions</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">启动UIAbility所携带的额外参数。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;void&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。当启动UIAbility成功时，err为undefined，否则为错误对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-ability">元能力子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.6.10.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.6.10.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">The application does not have permission to call the interface.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1.Mandatory parameters are left unspecified. 2.Incorrect parameter types.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000001</td>         <td class="cellrowborder" width="50%">The specified ability does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000004</td>         <td class="cellrowborder" width="50%">Cannot start an invisible component.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000005</td>         <td class="cellrowborder" width="50%">The specified process does not have the permission.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000006</td>         <td class="cellrowborder" width="50%">Cross-user operations are not allowed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000008</td>         <td class="cellrowborder" width="50%">The crowdtesting application expires.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000009</td>         <td class="cellrowborder" width="50%">An ability cannot be started or stopped in Wukong mode.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000011</td>         <td class="cellrowborder" width="50%">The context does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000012</td>         <td class="cellrowborder" width="50%">The application is controlled.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000013</td>         <td class="cellrowborder" width="50%">The application is controlled by EDM.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000018</td>         <td class="cellrowborder" width="50%">Redirection to a third-party application is not allowed in API version greater than 11.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000019</td>         <td class="cellrowborder" width="50%">No matching ability is found.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000050</td>         <td class="cellrowborder" width="50%">Internal error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000053</td>         <td class="cellrowborder" width="50%">The ability is not on the top of the UI.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000055</td>         <td class="cellrowborder" width="50%">Installation-free timed out.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000069</td>         <td class="cellrowborder" width="50%">The extension cannot start the third party application.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000070</td>         <td class="cellrowborder" width="50%">The extension cannot start the service.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000071</td>         <td class="cellrowborder" width="50%">App clone is not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000072</td>         <td class="cellrowborder" width="50%">App clone or multi-instance is not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000073</td>         <td class="cellrowborder" width="50%">The app clone index is invalid.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000076</td>         <td class="cellrowborder" width="50%">The app instance key is invalid.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000077</td>         <td class="cellrowborder" width="50%">The number of app instances reaches the limit.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000078</td>         <td class="cellrowborder" width="50%">The multi-instance is not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000079</td>         <td class="cellrowborder" width="50%">The APP_INSTANCE_KEY cannot be specified.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000080</td>         <td class="cellrowborder" width="50%">Creating a new instance is not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16200001</td>         <td class="cellrowborder" width="50%">The caller has been released.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-cks-c106="" class="highlight-div"><div _ngcontent-cks-c106="" class="highlight-div-header"><div _ngcontent-cks-c106="" class="highlight-div-header-left"><div _ngcontent-cks-c106="" class="handle-button expand-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-cks-c106="" class="highlight-div-header-right"><div _ngcontent-cks-c106="" class="handle-button ai-button"></div><div _ngcontent-cks-c106="" class="handle-button line-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-cks-c106="" class="handle-button theme-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-cks-c106="" class="handle-button copy-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-cks-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// UIExtensionAbility不支持三方应用直接继承，故以派生类ShareExtensionAbility举例说明。</span></li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">ShareExtensionAbility</span>, <span class="hljs-title class_">Want</span>, <span class="hljs-title class_">StartOptions</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ShareExtAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">ShareExtensionAbility</span> {</li><li>  <span class="hljs-title function_">onForeground</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">want</span>: <span class="hljs-title class_">Want</span> = {</li><li>      <span class="hljs-attr">deviceId</span>: <span class="hljs-string">''</span>,</li><li>      <span class="hljs-attr">bundleName</span>: <span class="hljs-string">'com.example.myapplication'</span>,</li><li>      <span class="hljs-attr">abilityName</span>: <span class="hljs-string">'EntryAbility'</span></li><li>    };</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">options</span>: <span class="hljs-title class_">StartOptions</span> = {</li><li>      <span class="hljs-attr">displayId</span>: <span class="hljs-number">0</span></li><li>    };</li><li>
</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">startAbility</span>(want, options, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>        <span class="hljs-keyword">if</span> (err.<span class="hljs-property">code</span>) {</li><li>          <span class="hljs-comment">// 处理业务逻辑错误</span></li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`startAbility failed, code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>          <span class="hljs-keyword">return</span>;</li><li>        }</li><li>        <span class="hljs-comment">// 执行正常业务</span></li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'startAbility succeed'</span>);</li><li>      });</li><li>    } <span class="hljs-keyword">catch</span> (err) {</li><li>      <span class="hljs-comment">// 处理入参错误异常</span></li><li>      <span class="hljs-keyword">let</span> code = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span>;</li><li>      <span class="hljs-keyword">let</span> message = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>;</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`startAbility failed, code is <span class="hljs-subst">${code}</span>, message is <span class="hljs-subst">${message}</span>`</span>);</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="startability-2" device-type="phone,2in1,tablet,wearable,tv">startAbility<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="startability-2" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>startAbility(want: Want, options?: StartOptions): Promise&lt;void&gt;</p>     <p>启动一个UIAbility。使用Promise异步回调。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>组件启动规则详见：<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/component-startup-rules" target="_blank">组件启动规则（Stage模型）</a>。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.7.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.7.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.7.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.7.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">want</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-want">Want</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">启动UIAbility时必要的Want，包含待启动UIAbility的名称等信息。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">options</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-startoptions">StartOptions</a></td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">启动UIAbility所携带的额外参数。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.7.9.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.7.9.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">Promise对象，无返回结果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-ability">元能力子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.7.12.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.7.12.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">The application does not have permission to call the interface.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1.Mandatory parameters are left unspecified. 2.Incorrect parameter types.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000001</td>         <td class="cellrowborder" width="50%">The specified ability does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000002</td>         <td class="cellrowborder" width="50%">Incorrect ability type.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000004</td>         <td class="cellrowborder" width="50%">Cannot start an invisible component.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000005</td>         <td class="cellrowborder" width="50%">The specified process does not have the permission.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000006</td>         <td class="cellrowborder" width="50%">Cross-user operations are not allowed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000008</td>         <td class="cellrowborder" width="50%">The crowdtesting application expires.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000009</td>         <td class="cellrowborder" width="50%">An ability cannot be started or stopped in Wukong mode.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000010</td>         <td class="cellrowborder" width="50%">The call with the continuation and prepare continuation flag is forbidden.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000011</td>         <td class="cellrowborder" width="50%">The context does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000012</td>         <td class="cellrowborder" width="50%">The application is controlled.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000013</td>         <td class="cellrowborder" width="50%">The application is controlled by EDM.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000018</td>         <td class="cellrowborder" width="50%">Redirection to a third-party application is not allowed in API version greater than 11.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000019</td>         <td class="cellrowborder" width="50%">No matching ability is found.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000050</td>         <td class="cellrowborder" width="50%">Internal error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000053</td>         <td class="cellrowborder" width="50%">The ability is not on the top of the UI.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000055</td>         <td class="cellrowborder" width="50%">Installation-free timed out.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000069</td>         <td class="cellrowborder" width="50%">The extension cannot start the third party application.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000070</td>         <td class="cellrowborder" width="50%">The extension cannot start the service.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000071</td>         <td class="cellrowborder" width="50%">App clone is not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000072</td>         <td class="cellrowborder" width="50%">App clone or multi-instance is not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000073</td>         <td class="cellrowborder" width="50%">The app clone index is invalid.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000076</td>         <td class="cellrowborder" width="50%">The app instance key is invalid.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000077</td>         <td class="cellrowborder" width="50%">The number of app instances reaches the limit.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000078</td>         <td class="cellrowborder" width="50%">The multi-instance is not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000079</td>         <td class="cellrowborder" width="50%">The APP_INSTANCE_KEY cannot be specified.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000080</td>         <td class="cellrowborder" width="50%">Creating a new instance is not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16200001</td>         <td class="cellrowborder" width="50%">The caller has been released.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-cks-c106="" class="highlight-div"><div _ngcontent-cks-c106="" class="highlight-div-header"><div _ngcontent-cks-c106="" class="highlight-div-header-left"><div _ngcontent-cks-c106="" class="handle-button expand-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-cks-c106="" class="highlight-div-header-right"><div _ngcontent-cks-c106="" class="handle-button ai-button"></div><div _ngcontent-cks-c106="" class="handle-button line-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-cks-c106="" class="handle-button theme-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-cks-c106="" class="handle-button copy-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-cks-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// UIExtensionAbility不支持三方应用直接继承，故以派生类ShareExtensionAbility举例说明。</span></li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">ShareExtensionAbility</span>, <span class="hljs-title class_">Want</span>, <span class="hljs-title class_">StartOptions</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ShareExtAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">ShareExtensionAbility</span> {</li><li>  <span class="hljs-title function_">onForeground</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">want</span>: <span class="hljs-title class_">Want</span> = {</li><li>      <span class="hljs-attr">bundleName</span>: <span class="hljs-string">'com.example.myapplication'</span>,</li><li>      <span class="hljs-attr">abilityName</span>: <span class="hljs-string">'EntryAbility'</span></li><li>    };</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">options</span>: <span class="hljs-title class_">StartOptions</span> = {</li><li>      <span class="hljs-attr">displayId</span>: <span class="hljs-number">0</span>,</li><li>    };</li><li>
</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">startAbility</span>(want, options)</li><li>        .<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-comment">// 执行正常业务</span></li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'startAbility succeed'</span>);</li><li>        })</li><li>        .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>          <span class="hljs-comment">// 处理业务逻辑错误</span></li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`startAbility failed, code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>        });</li><li>    } <span class="hljs-keyword">catch</span> (err) {</li><li>      <span class="hljs-comment">// 处理入参错误异常</span></li><li>      <span class="hljs-keyword">let</span> code = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span>;</li><li>      <span class="hljs-keyword">let</span> message = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>;</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`startAbility failed, code is <span class="hljs-subst">${code}</span>, message is <span class="hljs-subst">${message}</span>`</span>);</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="startabilityforresult" device-type="phone,2in1,tablet,wearable,tv">startAbilityForResult<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="startabilityforresult" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>startAbilityForResult(want: Want, callback: AsyncCallback&lt;AbilityResult&gt;): void</p>     <p>启动一个UIAbility，开发者可以通过回调函数接收被拉起的UIAbility退出时的返回结果。使用callback异步回调。UIAbility被启动后，有如下情况:</p>     <ul>      <li>正常情况下可通过调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext#terminateselfwithresult">terminateSelfWithResult</a>接口使之终止并且返回结果给调用方。</li>      <li>异常情况下比如杀死UIAbility会返回异常信息给调用方, 异常信息中resultCode为-1。</li>      <li>如果被启动的UIAbility模式是单实例模式, 不同应用多次调用该接口启动这个UIAbility，当这个UIAbility调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext#terminateselfwithresult">terminateSelfWithResult</a>接口使之终止时，只将正常结果返回给最后一个调用方, 其它调用方返回异常信息, 异常信息中resultCode为-1。</li>     </ul>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>组件启动规则详见：<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/component-startup-rules" target="_blank">组件启动规则（Stage模型）</a>。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.8.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.8.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.8.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.8.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">want</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-want">Want</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">启动UIAbility时必要的Want，包含待启动UIAbility的名称等信息。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-ability-abilityresult">AbilityResult</a>&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数，包含返回给拉起方的信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-ability">元能力子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.8.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.8.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">The application does not have permission to call the interface.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1.Mandatory parameters are left unspecified. 2.Incorrect parameter types.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000001</td>         <td class="cellrowborder" width="50%">The specified ability does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000002</td>         <td class="cellrowborder" width="50%">Incorrect ability type.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000004</td>         <td class="cellrowborder" width="50%">Cannot start an invisible component.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000005</td>         <td class="cellrowborder" width="50%">The specified process does not have the permission.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000006</td>         <td class="cellrowborder" width="50%">Cross-user operations are not allowed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000008</td>         <td class="cellrowborder" width="50%">The crowdtesting application expires.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000009</td>         <td class="cellrowborder" width="50%">An ability cannot be started or stopped in Wukong mode.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000010</td>         <td class="cellrowborder" width="50%">The call with the continuation and prepare continuation flag is forbidden.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000011</td>         <td class="cellrowborder" width="50%">The context does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000012</td>         <td class="cellrowborder" width="50%">The application is controlled.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000013</td>         <td class="cellrowborder" width="50%">The application is controlled by EDM.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000018</td>         <td class="cellrowborder" width="50%">Redirection to a third-party application is not allowed in API version greater than 11.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000019</td>         <td class="cellrowborder" width="50%">No matching ability is found.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000050</td>         <td class="cellrowborder" width="50%">Internal error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000053</td>         <td class="cellrowborder" width="50%">The ability is not on the top of the UI.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000055</td>         <td class="cellrowborder" width="50%">Installation-free timed out.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000069</td>         <td class="cellrowborder" width="50%">The extension cannot start the third party application.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000070</td>         <td class="cellrowborder" width="50%">The extension cannot start the service.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000071</td>         <td class="cellrowborder" width="50%">App clone is not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000072</td>         <td class="cellrowborder" width="50%">App clone or multi-instance is not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000073</td>         <td class="cellrowborder" width="50%">The app clone index is invalid.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000076</td>         <td class="cellrowborder" width="50%">The app instance key is invalid.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000077</td>         <td class="cellrowborder" width="50%">The number of app instances reaches the limit.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000078</td>         <td class="cellrowborder" width="50%">The multi-instance is not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000079</td>         <td class="cellrowborder" width="50%">The APP_INSTANCE_KEY cannot be specified.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000080</td>         <td class="cellrowborder" width="50%">Creating a new instance is not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16200001</td>         <td class="cellrowborder" width="50%">The caller has been released.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-cks-c106="" class="highlight-div"><div _ngcontent-cks-c106="" class="highlight-div-header"><div _ngcontent-cks-c106="" class="highlight-div-header-left"><div _ngcontent-cks-c106="" class="handle-button expand-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-cks-c106="" class="highlight-div-header-right"><div _ngcontent-cks-c106="" class="handle-button ai-button"></div><div _ngcontent-cks-c106="" class="handle-button line-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-cks-c106="" class="handle-button theme-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-cks-c106="" class="handle-button copy-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-cks-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// UIExtensionAbility不支持三方应用直接继承，故以派生类ShareExtensionAbility举例说明。</span></li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">ShareExtensionAbility</span>, <span class="hljs-title class_">Want</span>, common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ShareExtAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">ShareExtensionAbility</span> {</li><li>  <span class="hljs-title function_">onForeground</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">want</span>: <span class="hljs-title class_">Want</span> = {</li><li>      <span class="hljs-attr">deviceId</span>: <span class="hljs-string">''</span>,</li><li>      <span class="hljs-attr">bundleName</span>: <span class="hljs-string">'com.example.myapplication'</span>,</li><li>    };</li><li>
</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">startAbilityForResult</span>(want, <span class="hljs-function">(<span class="hljs-params">err: BusinessError, result: common.AbilityResult</span>) =&gt;</span> {</li><li>        <span class="hljs-keyword">if</span> (err.<span class="hljs-property">code</span>) {</li><li>          <span class="hljs-comment">// 处理业务逻辑错误</span></li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`startAbilityForResult failed, code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>          <span class="hljs-keyword">return</span>;</li><li>        }</li><li>        <span class="hljs-comment">// 执行正常业务</span></li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'startAbilityForResult succeed'</span>);</li><li>      });</li><li>    } <span class="hljs-keyword">catch</span> (err) {</li><li>      <span class="hljs-comment">// 处理入参错误异常</span></li><li>      <span class="hljs-keyword">let</span> code = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span>;</li><li>      <span class="hljs-keyword">let</span> message = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>;</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`startAbilityForResult failed, code is <span class="hljs-subst">${code}</span>, message is <span class="hljs-subst">${message}</span>`</span>);</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="startabilityforresult-1" device-type="phone,2in1,tablet,wearable,tv">startAbilityForResult<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="startabilityforresult-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>startAbilityForResult(want: Want, options: StartOptions, callback: AsyncCallback&lt;AbilityResult&gt;): void</p>     <p>启动一个UIAbility，开发者可以通过回调函数接收被拉起的UIAbility退出时的返回结果。使用callback异步回调。UIAbility被启动后，有如下情况:</p>     <ul>      <li>正常情况下可通过调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext#terminateselfwithresult">terminateSelfWithResult</a>接口使之终止并且返回结果给调用方。</li>      <li>异常情况下比如杀死UIAbility会返回异常信息给调用方，异常信息中resultCode为-1。</li>      <li>如果被启动的UIAbility模式是单实例模式, 不同应用多次调用该接口启动这个UIAbility，当这个UIAbility调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext#terminateselfwithresult">terminateSelfWithResult</a>接口使之终止时，只将正常结果返回给最后一个调用方，其它调用方返回异常信息, 异常信息中resultCode为-1。</li>     </ul>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>组件启动规则详见：<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/component-startup-rules" target="_blank">组件启动规则（Stage模型）</a>。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.9.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.9.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.9.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.9.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">want</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-want">Want</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">启动UIAbility时必要的Want，包含待启动UIAbility的名称等信息。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">options</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-startoptions">StartOptions</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">启动UIAbility所携带的额外参数。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-ability-abilityresult">AbilityResult</a>&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数，包含返回给拉起方的信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-ability">元能力子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.9.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.9.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">The application does not have permission to call the interface.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1.Mandatory parameters are left unspecified. 2.Incorrect parameter types.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000001</td>         <td class="cellrowborder" width="50%">The specified ability does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000004</td>         <td class="cellrowborder" width="50%">Cannot start an invisible component.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000005</td>         <td class="cellrowborder" width="50%">The specified process does not have the permission.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000006</td>         <td class="cellrowborder" width="50%">Cross-user operations are not allowed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000008</td>         <td class="cellrowborder" width="50%">The crowdtesting application expires.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000009</td>         <td class="cellrowborder" width="50%">An ability cannot be started or stopped in Wukong mode.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000011</td>         <td class="cellrowborder" width="50%">The context does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000012</td>         <td class="cellrowborder" width="50%">The application is controlled.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000013</td>         <td class="cellrowborder" width="50%">The application is controlled by EDM.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000018</td>         <td class="cellrowborder" width="50%">Redirection to a third-party application is not allowed in API version greater than 11.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000019</td>         <td class="cellrowborder" width="50%">No matching ability is found.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000050</td>         <td class="cellrowborder" width="50%">Internal error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000053</td>         <td class="cellrowborder" width="50%">The ability is not on the top of the UI.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000055</td>         <td class="cellrowborder" width="50%">Installation-free timed out.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000069</td>         <td class="cellrowborder" width="50%">The extension cannot start the third party application.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000070</td>         <td class="cellrowborder" width="50%">The extension cannot start the service.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000071</td>         <td class="cellrowborder" width="50%">App clone is not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000072</td>         <td class="cellrowborder" width="50%">App clone or multi-instance is not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000073</td>         <td class="cellrowborder" width="50%">The app clone index is invalid.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000076</td>         <td class="cellrowborder" width="50%">The app instance key is invalid.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000077</td>         <td class="cellrowborder" width="50%">The number of app instances reaches the limit.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000078</td>         <td class="cellrowborder" width="50%">The multi-instance is not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000079</td>         <td class="cellrowborder" width="50%">The APP_INSTANCE_KEY cannot be specified.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000080</td>         <td class="cellrowborder" width="50%">Creating a new instance is not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16200001</td>         <td class="cellrowborder" width="50%">The caller has been released.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-cks-c106="" class="highlight-div"><div _ngcontent-cks-c106="" class="highlight-div-header"><div _ngcontent-cks-c106="" class="highlight-div-header-left"><div _ngcontent-cks-c106="" class="handle-button expand-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-cks-c106="" class="highlight-div-header-right"><div _ngcontent-cks-c106="" class="handle-button ai-button"></div><div _ngcontent-cks-c106="" class="handle-button line-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-cks-c106="" class="handle-button theme-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-cks-c106="" class="handle-button copy-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-cks-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// UIExtensionAbility不支持三方应用直接继承，故以派生类ShareExtensionAbility举例说明。</span></li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">ShareExtensionAbility</span>, <span class="hljs-title class_">Want</span>, common, <span class="hljs-title class_">StartOptions</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ShareExtAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">ShareExtensionAbility</span> {</li><li>  <span class="hljs-title function_">onForeground</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">want</span>: <span class="hljs-title class_">Want</span> = {</li><li>      <span class="hljs-attr">deviceId</span>: <span class="hljs-string">''</span>,</li><li>      <span class="hljs-attr">bundleName</span>: <span class="hljs-string">'com.example.myapplication'</span>,</li><li>      <span class="hljs-attr">abilityName</span>: <span class="hljs-string">'EntryAbility'</span></li><li>    };</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">options</span>: <span class="hljs-title class_">StartOptions</span> = {</li><li>      <span class="hljs-attr">displayId</span>: <span class="hljs-number">0</span>,</li><li>    };</li><li>
</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">startAbilityForResult</span>(want, options, <span class="hljs-function">(<span class="hljs-params">err: BusinessError, result: common.AbilityResult</span>) =&gt;</span> {</li><li>        <span class="hljs-keyword">if</span> (err.<span class="hljs-property">code</span>) {</li><li>          <span class="hljs-comment">// 处理业务逻辑错误</span></li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`startAbilityForResult failed, code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>          <span class="hljs-keyword">return</span>;</li><li>        }</li><li>        <span class="hljs-comment">// 执行正常业务</span></li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'startAbilityForResult succeed'</span>);</li><li>      });</li><li>    } <span class="hljs-keyword">catch</span> (err) {</li><li>      <span class="hljs-comment">// 处理入参错误异常</span></li><li>      <span class="hljs-keyword">let</span> code = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span>;</li><li>      <span class="hljs-keyword">let</span> message = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>;</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`startAbilityForResult failed, code is <span class="hljs-subst">${code}</span>, message is <span class="hljs-subst">${message}</span>`</span>);</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="startabilityforresult-2" device-type="phone,2in1,tablet,wearable,tv">startAbilityForResult<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="startabilityforresult-2" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>startAbilityForResult(want: Want, options?: StartOptions): Promise&lt;AbilityResult&gt;</p>     <p>启动一个UIAbility，开发者可以通过回调函数接收被拉起的UIAbility退出时的返回结果。使用Promise异步回调。UIAbility被启动后，有如下情况:</p>     <ul>      <li>正常情况下可通过调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext#terminateselfwithresult">terminateSelfWithResult</a>接口使之终止并且返回结果给调用方。</li>      <li>异常情况下比如杀死UIAbility会返回异常信息给调用方, 异常信息中resultCode为-1。</li>      <li>如果被启动的UIAbility模式是单实例模式, 不同应用多次调用该接口启动这个UIAbility，当这个UIAbility调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext#terminateselfwithresult">terminateSelfWithResult</a>接口使之终止时，只将正常结果返回给最后一个调用方, 其它调用方返回异常信息, 异常信息中resultCode为-1。</li>     </ul>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>组件启动规则详见：<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/component-startup-rules" target="_blank">组件启动规则（Stage模型）</a>。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.10.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.10.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.10.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.10.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">want</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-want">Want</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">启动UIAbility时必要的Want，包含待启动UIAbility的名称等信息。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">options</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-startoptions">StartOptions</a></td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">启动UIAbility所携带的额外参数。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.10.10.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.10.10.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-ability-abilityresult">AbilityResult</a>&gt;</td>         <td class="cellrowborder" width="50%">Promise对象，返回被拉起的UIAbility退出时的返回结果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-ability">元能力子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.10.13.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.10.13.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">The application does not have permission to call the interface.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1.Mandatory parameters are left unspecified. 2.Incorrect parameter types.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000001</td>         <td class="cellrowborder" width="50%">The specified ability does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000002</td>         <td class="cellrowborder" width="50%">Incorrect ability type.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000004</td>         <td class="cellrowborder" width="50%">Cannot start an invisible component.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000005</td>         <td class="cellrowborder" width="50%">The specified process does not have the permission.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000006</td>         <td class="cellrowborder" width="50%">Cross-user operations are not allowed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000008</td>         <td class="cellrowborder" width="50%">The crowdtesting application expires.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000009</td>         <td class="cellrowborder" width="50%">An ability cannot be started or stopped in Wukong mode.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000010</td>         <td class="cellrowborder" width="50%">The call with the continuation and prepare continuation flag is forbidden.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000011</td>         <td class="cellrowborder" width="50%">The context does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000012</td>         <td class="cellrowborder" width="50%">The application is controlled.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000013</td>         <td class="cellrowborder" width="50%">The application is controlled by EDM.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000018</td>         <td class="cellrowborder" width="50%">Redirection to a third-party application is not allowed in API version greater than 11.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000019</td>         <td class="cellrowborder" width="50%">No matching ability is found.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000050</td>         <td class="cellrowborder" width="50%">Internal error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000053</td>         <td class="cellrowborder" width="50%">The ability is not on the top of the UI.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000055</td>         <td class="cellrowborder" width="50%">Installation-free timed out.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000069</td>         <td class="cellrowborder" width="50%">The extension cannot start the third party application.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000070</td>         <td class="cellrowborder" width="50%">The extension cannot start the service.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000071</td>         <td class="cellrowborder" width="50%">App clone is not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000072</td>         <td class="cellrowborder" width="50%">App clone or multi-instance is not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000073</td>         <td class="cellrowborder" width="50%">The app clone index is invalid.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000076</td>         <td class="cellrowborder" width="50%">The app instance key is invalid.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000077</td>         <td class="cellrowborder" width="50%">The number of app instances reaches the limit.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000078</td>         <td class="cellrowborder" width="50%">The multi-instance is not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000079</td>         <td class="cellrowborder" width="50%">The APP_INSTANCE_KEY cannot be specified.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000080</td>         <td class="cellrowborder" width="50%">Creating a new instance is not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16200001</td>         <td class="cellrowborder" width="50%">The caller has been released.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-cks-c106="" class="highlight-div"><div _ngcontent-cks-c106="" class="highlight-div-header"><div _ngcontent-cks-c106="" class="highlight-div-header-left"><div _ngcontent-cks-c106="" class="handle-button expand-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-cks-c106="" class="highlight-div-header-right"><div _ngcontent-cks-c106="" class="handle-button ai-button"></div><div _ngcontent-cks-c106="" class="handle-button line-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-cks-c106="" class="handle-button theme-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-cks-c106="" class="handle-button copy-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-cks-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// UIExtensionAbility不支持三方应用直接继承，故以派生类ShareExtensionAbility举例说明。</span></li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">ShareExtensionAbility</span>, <span class="hljs-title class_">Want</span>, common, <span class="hljs-title class_">StartOptions</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ShareExtAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">ShareExtensionAbility</span> {</li><li>  <span class="hljs-title function_">onForeground</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">want</span>: <span class="hljs-title class_">Want</span> = {</li><li>      <span class="hljs-attr">bundleName</span>: <span class="hljs-string">'com.example.myapplication'</span>,</li><li>      <span class="hljs-attr">abilityName</span>: <span class="hljs-string">'EntryAbility'</span></li><li>    };</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">options</span>: <span class="hljs-title class_">StartOptions</span> = {</li><li>      <span class="hljs-attr">displayId</span>: <span class="hljs-number">0</span>,</li><li>    };</li><li>
</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">startAbilityForResult</span>(want, options)</li><li>        .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">result: common.AbilityResult</span>) =&gt;</span> {</li><li>          <span class="hljs-comment">// 执行正常业务</span></li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'startAbilityForResult succeed'</span>);</li><li>        })</li><li>        .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>          <span class="hljs-comment">// 处理业务逻辑错误</span></li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`startAbilityForResult failed, code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>        });</li><li>    } <span class="hljs-keyword">catch</span> (err) {</li><li>      <span class="hljs-comment">// 处理入参错误异常</span></li><li>      <span class="hljs-keyword">let</span> code = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span>;</li><li>      <span class="hljs-keyword">let</span> message = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>;</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`startAbilityForResult failed, code is <span class="hljs-subst">${code}</span>, message is <span class="hljs-subst">${message}</span>`</span>);</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="connectserviceextensionability" device-type="phone,2in1,tablet,wearable,tv">connectServiceExtensionAbility<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="connectserviceextensionability" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>connectServiceExtensionAbility(want: Want, options: ConnectOptions): number</p>     <p>将当前UIExtensionAbility连接到一个ServiceExtensionAbility，通过返回的proxy与ServiceExtensionAbility进行通信，以使用ServiceExtensionAbility对外提供的能力。</p>     <p>ServiceExtensionAbility是一类特殊的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/extensionability-overview" target="_blank">ExtensionAbility</a>组件，这类组件由系统提供，通常用于提供指定场景后台服务能力，不支持开发者自定义。ServiceExtensionAbility可以被其他组件连接，并根据调用者的请求信息在后台处理相关事务。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>组件启动规则详见：<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/component-startup-rules" target="_blank">组件启动规则（Stage模型）</a>。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.11.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.11.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.11.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.11.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">want</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-want">Want</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">连接ServiceExtensionAbility的Want信息，包括Ability名称，Bundle名称等。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">options</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-ability-connectoptions">ConnectOptions</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">ConnectOptions类型的回调函数，返回服务连接成功、连接失败、断开的信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.11.10.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.11.10.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">number</td>         <td class="cellrowborder" width="50%">返回连接id，客户端可以通过<a href="/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiextensioncontext#disconnectserviceextensionability">disconnectServiceExtensionAbility</a>传入该连接id来断开连接。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-ability">元能力子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.11.13.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.11.13.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">The application does not have permission to call the interface.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1.Mandatory parameters are left unspecified. 2.Incorrect parameter types.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000001</td>         <td class="cellrowborder" width="50%">The specified ability does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000002</td>         <td class="cellrowborder" width="50%">Incorrect ability type.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000004</td>         <td class="cellrowborder" width="50%">Cannot start an invisible component.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000005</td>         <td class="cellrowborder" width="50%">The specified process does not have the permission.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000006</td>         <td class="cellrowborder" width="50%">Cross-user operations are not allowed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000008</td>         <td class="cellrowborder" width="50%">The crowdtesting application expires.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000011</td>         <td class="cellrowborder" width="50%">The context does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000050</td>         <td class="cellrowborder" width="50%">Internal error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000053</td>         <td class="cellrowborder" width="50%">The ability is not on the top of the UI.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000055</td>         <td class="cellrowborder" width="50%">Installation-free timed out.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000070</td>         <td class="cellrowborder" width="50%">The extension cannot start the service.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-cks-c106="" class="highlight-div"><div _ngcontent-cks-c106="" class="highlight-div-header"><div _ngcontent-cks-c106="" class="highlight-div-header-left"><div _ngcontent-cks-c106="" class="handle-button expand-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-cks-c106="" class="highlight-div-header-right"><div _ngcontent-cks-c106="" class="handle-button ai-button"></div><div _ngcontent-cks-c106="" class="handle-button line-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-cks-c106="" class="handle-button theme-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-cks-c106="" class="handle-button copy-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-cks-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// UIExtensionAbility不支持三方应用直接继承，故以派生类ShareExtensionAbility举例说明。</span></li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">ShareExtensionAbility</span>, <span class="hljs-title class_">Want</span>, common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { rpc } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.IPCKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ShareExtAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">ShareExtensionAbility</span> {</li><li>  <span class="hljs-title function_">onForeground</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">want</span>: <span class="hljs-title class_">Want</span> = {</li><li>      <span class="hljs-attr">deviceId</span>: <span class="hljs-string">''</span>,</li><li>      <span class="hljs-attr">bundleName</span>: <span class="hljs-string">'com.example.myapplication'</span>,</li><li>      <span class="hljs-attr">abilityName</span>: <span class="hljs-string">'ServiceExtensionAbility'</span></li><li>    };</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">commRemote</span>: rpc.<span class="hljs-property">IRemoteObject</span>;</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">options</span>: common.<span class="hljs-property">ConnectOptions</span> = {</li><li>      <span class="hljs-title function_">onConnect</span>(<span class="hljs-params">elementName, remote</span>) {</li><li>        commRemote = remote;</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'onConnect...'</span>);</li><li>      },</li><li>      <span class="hljs-title function_">onDisconnect</span>(<span class="hljs-params">elementName</span>) {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'onDisconnect...'</span>);</li><li>      },</li><li>      <span class="hljs-title function_">onFailed</span>(<span class="hljs-params">code</span>) {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`onFailed, err code: <span class="hljs-subst">${code}</span>.`</span>);</li><li>      }</li><li>    };</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">connection</span>: <span class="hljs-built_in">number</span>;</li><li>    <span class="hljs-keyword">try</span> {</li><li>      connection = <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">connectServiceExtensionAbility</span>(want, options);</li><li>    } <span class="hljs-keyword">catch</span> (err) {</li><li>      <span class="hljs-comment">// 处理入参错误异常</span></li><li>      <span class="hljs-keyword">let</span> code = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span>;</li><li>      <span class="hljs-keyword">let</span> message = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>;</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`connectServiceExtensionAbility failed, code is <span class="hljs-subst">${code}</span>, message is <span class="hljs-subst">${message}</span>`</span>);</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="disconnectserviceextensionability" device-type="phone,2in1,tablet,wearable,tv">disconnectServiceExtensionAbility<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="disconnectserviceextensionability" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>disconnectServiceExtensionAbility(connection: number): Promise&lt;void&gt;</p>     <p>断开与ServiceExtensionAbility的连接，断开连接之后开发者需要将连接成功时返回的remote对象置空。使用Promise异步回调。</p>     <p>ServiceExtensionAbility是一类特殊的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/extensionability-overview" target="_blank">ExtensionAbility</a>组件，这类组件由系统提供，通常用于提供指定场景后台服务能力，不支持开发者自定义。ServiceExtensionAbility可以被其他组件连接，并根据调用者的请求信息在后台处理相关事务。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.12.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.12.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.12.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.12.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">connection</td>         <td class="cellrowborder" width="25%">number</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">连接的ServiceExtensionAbility的标识Id，即<a href="/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiextensioncontext#connectserviceextensionability">connectServiceExtensionAbility</a>返回的connectionId。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.12.9.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.12.9.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">Promise对象，无返回结果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-ability">元能力子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.12.12.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.12.12.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1.Mandatory parameters are left unspecified. 2.Incorrect parameter types.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000011</td>         <td class="cellrowborder" width="50%">The context does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000050</td>         <td class="cellrowborder" width="50%">Internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-cks-c106="" class="highlight-div"><div _ngcontent-cks-c106="" class="highlight-div-header"><div _ngcontent-cks-c106="" class="highlight-div-header-left"><div _ngcontent-cks-c106="" class="handle-button expand-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-cks-c106="" class="highlight-div-header-right"><div _ngcontent-cks-c106="" class="handle-button ai-button"></div><div _ngcontent-cks-c106="" class="handle-button line-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-cks-c106="" class="handle-button theme-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-cks-c106="" class="handle-button copy-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-cks-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// UIExtensionAbility不支持三方应用直接继承，故以派生类ShareExtensionAbility举例说明。</span></li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">ShareExtensionAbility</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { rpc } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.IPCKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ShareExtAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">ShareExtensionAbility</span> {</li><li>  <span class="hljs-title function_">onForeground</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-comment">// connection为connectServiceExtensionAbility中的返回值</span></li><li>    <span class="hljs-keyword">let</span> connection = <span class="hljs-number">1</span>;</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">commRemote</span>: rpc.<span class="hljs-property">IRemoteObject</span> | <span class="hljs-literal">null</span>;</li><li>
</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">disconnectServiceExtensionAbility</span>(connection).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>        commRemote = <span class="hljs-literal">null</span>;</li><li>        <span class="hljs-comment">// 执行正常业务</span></li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'disconnectServiceExtensionAbility succeed'</span>);</li><li>      }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>        <span class="hljs-comment">// 处理业务逻辑错误</span></li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`disconnectServiceExtensionAbility failed, code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>      })</li><li>    } <span class="hljs-keyword">catch</span> (err) {</li><li>      commRemote = <span class="hljs-literal">null</span>;</li><li>      <span class="hljs-comment">// 处理入参错误异常</span></li><li>      <span class="hljs-keyword">let</span> code = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span>;</li><li>      <span class="hljs-keyword">let</span> message = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>;</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`disconnectServiceExtensionAbility failed, code is <span class="hljs-subst">${code}</span>, message is <span class="hljs-subst">${message}</span>`</span>);</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="disconnectserviceextensionability-1" device-type="phone,2in1,tablet,wearable,tv">disconnectServiceExtensionAbility<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="disconnectserviceextensionability-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>disconnectServiceExtensionAbility(connection: number, callback: AsyncCallback&lt;void&gt;): void</p>     <p>断开与ServiceExtensionAbility的连接，断开连接之后开发者需要将连接成功时返回的remote对象置空。使用callback异步回调。</p>     <p>ServiceExtensionAbility是一类特殊的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/extensionability-overview" target="_blank">ExtensionAbility</a>组件，这类组件由系统提供，通常用于提供指定场景后台服务能力，不支持开发者自定义。ServiceExtensionAbility可以被其他组件连接，并根据调用者的请求信息在后台处理相关事务。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.13.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.13.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.13.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.13.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">connection</td>         <td class="cellrowborder" width="25%">number</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">连接的ServiceExtensionAbility的标识Id，即connectServiceExtensionAbility返回的connectionId。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;void&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。当断开与ServiceExtensionAbility的连接成功，err为undefined，否则为错误对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-ability">元能力子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.13.10.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.13.10.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1.Mandatory parameters are left unspecified. 2.Incorrect parameter types.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000011</td>         <td class="cellrowborder" width="50%">The context does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000050</td>         <td class="cellrowborder" width="50%">Internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-cks-c106="" class="highlight-div"><div _ngcontent-cks-c106="" class="highlight-div-header"><div _ngcontent-cks-c106="" class="highlight-div-header-left"><div _ngcontent-cks-c106="" class="handle-button expand-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-cks-c106="" class="highlight-div-header-right"><div _ngcontent-cks-c106="" class="handle-button ai-button"></div><div _ngcontent-cks-c106="" class="handle-button line-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-cks-c106="" class="handle-button theme-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-cks-c106="" class="handle-button copy-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-cks-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// UIExtensionAbility不支持三方应用直接继承，故以派生类ShareExtensionAbility举例说明。</span></li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">ShareExtensionAbility</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { rpc } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.IPCKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ShareExtAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">ShareExtensionAbility</span> {</li><li>  <span class="hljs-title function_">onForeground</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-comment">// connection为connectServiceExtensionAbility中的返回值</span></li><li>    <span class="hljs-keyword">let</span> connection = <span class="hljs-number">1</span>;</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">commRemote</span>: rpc.<span class="hljs-property">IRemoteObject</span> | <span class="hljs-literal">null</span>;</li><li>
</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">disconnectServiceExtensionAbility</span>(connection, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>        commRemote = <span class="hljs-literal">null</span>;</li><li>        <span class="hljs-keyword">if</span> (err.<span class="hljs-property">code</span>) {</li><li>          <span class="hljs-comment">// 处理业务逻辑错误</span></li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`disconnectServiceExtensionAbility failed, code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>          <span class="hljs-keyword">return</span>;</li><li>        }</li><li>        <span class="hljs-comment">// 执行正常业务</span></li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'disconnectServiceExtensionAbility succeed'</span>);</li><li>      });</li><li>    } <span class="hljs-keyword">catch</span> (err) {</li><li>      commRemote = <span class="hljs-literal">null</span>;</li><li>      <span class="hljs-comment">// 处理入参错误异常</span></li><li>      <span class="hljs-keyword">let</span> code = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span>;</li><li>      <span class="hljs-keyword">let</span> message = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>;</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`disconnectServiceExtensionAbility failed, code is <span class="hljs-subst">${code}</span>, message is <span class="hljs-subst">${message}</span>`</span>);</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="terminateself12" device-type="phone,2in1,tablet,wearable,tv">terminateSelf<sup>12+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="terminateself12" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>terminateSelf(callback: AsyncCallback&lt;void&gt;): void</p>     <p>销毁UIExtensionAbility自身，同时关闭对应的窗口界面。使用callback异步回调。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.14.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.14.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.14.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.14.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;void&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。UIExtensionAbility停止成功时，err为undefined，否则为错误对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.14.9.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.14.9.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1.Mandatory parameters are left unspecified. 2.Incorrect parameter types.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-cks-c106="" class="highlight-div"><div _ngcontent-cks-c106="" class="highlight-div-header"><div _ngcontent-cks-c106="" class="highlight-div-header-left"><div _ngcontent-cks-c106="" class="handle-button expand-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-cks-c106="" class="highlight-div-header-right"><div _ngcontent-cks-c106="" class="handle-button ai-button"></div><div _ngcontent-cks-c106="" class="handle-button line-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-cks-c106="" class="handle-button theme-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-cks-c106="" class="handle-button copy-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-cks-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// UIExtensionAbility不支持三方应用直接继承，故以派生类ShareExtensionAbility举例说明。</span></li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">ShareExtensionAbility</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ShareExtAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">ShareExtensionAbility</span> {</li><li>  <span class="hljs-title function_">onForeground</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">terminateSelf</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>        <span class="hljs-keyword">if</span> (err.<span class="hljs-property">code</span>) {</li><li>          <span class="hljs-comment">// 处理业务逻辑错误</span></li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`terminateSelf failed, code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>          <span class="hljs-keyword">return</span>;</li><li>        }</li><li>        <span class="hljs-comment">// 执行正常业务</span></li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'terminateSelf succeed'</span>);</li><li>      });</li><li>    } <span class="hljs-keyword">catch</span> (err) {</li><li>      <span class="hljs-comment">// 捕获同步的参数错误</span></li><li>      <span class="hljs-keyword">let</span> code = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span>;</li><li>      <span class="hljs-keyword">let</span> message = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>;</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`terminateSelf failed, code is <span class="hljs-subst">${code}</span>, message is <span class="hljs-subst">${message}</span>`</span>);</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="terminateself12-1" device-type="phone,2in1,tablet,wearable,tv">terminateSelf<sup>12+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="terminateself12-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>terminateSelf(): Promise&lt;void&gt;</p>     <p>销毁UIExtensionAbility自身，同时关闭对应的窗口界面。使用Promise异步回调。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.Core</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.15.6.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.15.6.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">Promise对象，无返回结果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-cks-c106="" class="highlight-div"><div _ngcontent-cks-c106="" class="highlight-div-header"><div _ngcontent-cks-c106="" class="highlight-div-header-left"><div _ngcontent-cks-c106="" class="handle-button expand-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-cks-c106="" class="highlight-div-header-right"><div _ngcontent-cks-c106="" class="handle-button ai-button"></div><div _ngcontent-cks-c106="" class="handle-button line-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-cks-c106="" class="handle-button theme-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-cks-c106="" class="handle-button copy-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-cks-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// UIExtensionAbility不支持三方应用直接继承，故以派生类ShareExtensionAbility举例说明。</span></li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">ShareExtensionAbility</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ShareExtAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">ShareExtensionAbility</span> {</li><li>  <span class="hljs-title function_">onForeground</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">terminateSelf</span>()</li><li>        .<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-comment">// 执行正常业务</span></li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'terminateSelf succeed'</span>);</li><li>        })</li><li>        .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>          <span class="hljs-comment">// 处理业务逻辑错误</span></li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`terminateSelf failed, code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>        });</li><li>    } <span class="hljs-keyword">catch</span> (err) {</li><li>      <span class="hljs-comment">// 捕获同步的参数错误</span></li><li>      <span class="hljs-keyword">let</span> code = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span>;</li><li>      <span class="hljs-keyword">let</span> message = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>;</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`terminateSelf failed, code is <span class="hljs-subst">${code}</span>, message is <span class="hljs-subst">${message}</span>`</span>);</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="terminateselfwithresult12" device-type="phone,2in1,tablet,wearable,tv">terminateSelfWithResult<sup>12+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="terminateselfwithresult12" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>terminateSelfWithResult(parameter: AbilityResult, callback: AsyncCallback&lt;void&gt;): void</p>     <p>销毁UIExtensionAbility自身，同时关闭对应的窗口界面，并将结果返回给UIExtensionAbility的拉起方，拉起方通常为系统服务。使用callback异步回调。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.16.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.16.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.16.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.16.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">parameter</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-ability-abilityresult">AbilityResult</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">返回给UIExtensionAbility拉起方的信息。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;void&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。UIExtensionAbility停止成功时，err为undefined，否则为错误对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.16.9.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.16.9.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1.Mandatory parameters are left unspecified. 2.Incorrect parameter types.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-cks-c106="" class="highlight-div"><div _ngcontent-cks-c106="" class="highlight-div-header"><div _ngcontent-cks-c106="" class="highlight-div-header-left"><div _ngcontent-cks-c106="" class="handle-button expand-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-cks-c106="" class="highlight-div-header-right"><div _ngcontent-cks-c106="" class="handle-button ai-button"></div><div _ngcontent-cks-c106="" class="handle-button line-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-cks-c106="" class="handle-button theme-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-cks-c106="" class="handle-button copy-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-cks-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// UIExtensionAbility不支持三方应用直接继承，故以派生类ShareExtensionAbility举例说明。</span></li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">ShareExtensionAbility</span>, <span class="hljs-title class_">Want</span>, common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ShareExtAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">ShareExtensionAbility</span> {</li><li>  <span class="hljs-title function_">onForeground</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">want</span>: <span class="hljs-title class_">Want</span> = {</li><li>      <span class="hljs-attr">bundleName</span>: <span class="hljs-string">'com.example.myapplication'</span>,</li><li>      <span class="hljs-attr">abilityName</span>: <span class="hljs-string">'EntryAbility'</span></li><li>    };</li><li>    <span class="hljs-keyword">let</span> resultCode = <span class="hljs-number">100</span>;</li><li>    <span class="hljs-comment">// 返回给接口调用方AbilityResult信息</span></li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">abilityResult</span>: common.<span class="hljs-property">AbilityResult</span> = {</li><li>      want,</li><li>      resultCode</li><li>    };</li><li>
</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">terminateSelfWithResult</span>(abilityResult, <span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>        <span class="hljs-keyword">if</span> (err.<span class="hljs-property">code</span>) {</li><li>          <span class="hljs-comment">// 处理业务逻辑错误</span></li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`terminateSelfWithResult failed, code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>          <span class="hljs-keyword">return</span>;</li><li>        }</li><li>        <span class="hljs-comment">// 执行正常业务</span></li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'terminateSelfWithResult succeed'</span>);</li><li>      });</li><li>    } <span class="hljs-keyword">catch</span> (err) {</li><li>      <span class="hljs-comment">// 处理入参错误异常</span></li><li>      <span class="hljs-keyword">let</span> code = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span>;</li><li>      <span class="hljs-keyword">let</span> message = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>;</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`terminateSelfWithResult failed, code is <span class="hljs-subst">${code}</span>, message is <span class="hljs-subst">${message}</span>`</span>);</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="terminateselfwithresult12-1" device-type="phone,2in1,tablet,wearable,tv">terminateSelfWithResult<sup>12+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="terminateselfwithresult12-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>terminateSelfWithResult(parameter: AbilityResult): Promise&lt;void&gt;</p>     <p>销毁UIExtensionAbility自身，同时关闭对应的窗口界面，并将结果返回给UIExtensionAbility的拉起方，拉起方通常为系统服务。使用Promise异步回调。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.17.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.17.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.17.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.17.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">parameter</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-ability-abilityresult">AbilityResult</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">返回给UIExtensionAbility拉起方的信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.17.8.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.17.8.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">Promise对象，无返回结果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.17.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.17.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1.Mandatory parameters are left unspecified. 2.Incorrect parameter types.</td>        </tr>             </tbody></table></div>     </div>     <div _ngcontent-cks-c106="" class="highlight-div"><div _ngcontent-cks-c106="" class="highlight-div-header"><div _ngcontent-cks-c106="" class="highlight-div-header-left"><div _ngcontent-cks-c106="" class="handle-button expand-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-cks-c106="" class="highlight-div-header-right"><div _ngcontent-cks-c106="" class="handle-button ai-button"></div><div _ngcontent-cks-c106="" class="handle-button line-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-cks-c106="" class="handle-button theme-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-cks-c106="" class="handle-button copy-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-cks-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// UIExtensionAbility不支持三方应用直接继承，故以派生类ShareExtensionAbility举例说明。</span></li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">ShareExtensionAbility</span>, <span class="hljs-title class_">Want</span>, common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ShareExtAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">ShareExtensionAbility</span> {</li><li>  <span class="hljs-title function_">onForeground</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">want</span>: <span class="hljs-title class_">Want</span> = {</li><li>      <span class="hljs-attr">bundleName</span>: <span class="hljs-string">'com.example.myapplication'</span>,</li><li>      <span class="hljs-attr">abilityName</span>: <span class="hljs-string">'EntryAbility'</span></li><li>    };</li><li>    <span class="hljs-keyword">let</span> resultCode = <span class="hljs-number">100</span>;</li><li>    <span class="hljs-comment">// 返回给接口调用方AbilityResult信息</span></li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">abilityResult</span>: common.<span class="hljs-property">AbilityResult</span> = {</li><li>      want,</li><li>      resultCode</li><li>    };</li><li>
</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">terminateSelfWithResult</span>(abilityResult)</li><li>        .<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-comment">// 执行正常业务</span></li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'terminateSelfWithResult succeed'</span>);</li><li>        })</li><li>        .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>          <span class="hljs-comment">// 处理业务逻辑错误</span></li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`terminateSelfWithResult failed, code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>        });</li><li>    } <span class="hljs-keyword">catch</span> (err) {</li><li>      <span class="hljs-comment">// 处理入参错误异常</span></li><li>      <span class="hljs-keyword">let</span> code = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span>;</li><li>      <span class="hljs-keyword">let</span> message = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>;</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`terminateSelfWithResult failed, code is <span class="hljs-subst">${code}</span>, message is <span class="hljs-subst">${message}</span>`</span>);</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="reportdrawncompleted12" device-type="phone,2in1,tablet,wearable,tv">reportDrawnCompleted<sup>12+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="reportdrawncompleted12" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>reportDrawnCompleted(callback: AsyncCallback&lt;void&gt;): void</p>     <p>用于应用通知系统UIExtensionAbility对应的窗口内容已绘制完成。系统会根据开发者调用的时机进行资源分配优化等，以优化应用启动及显示时间。使用callback异步回调。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.18.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.18.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.18.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.18.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;void&gt;</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">回调函数。当打点成功，err为undefined，否则为错误对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-ability">元能力子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.18.9.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.18.9.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">16000011</td>         <td class="cellrowborder" width="50%">The context does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000050</td>         <td class="cellrowborder" width="50%">Internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-cks-c106="" class="highlight-div"><div _ngcontent-cks-c106="" class="highlight-div-header"><div _ngcontent-cks-c106="" class="highlight-div-header-left"><div _ngcontent-cks-c106="" class="handle-button expand-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-cks-c106="" class="highlight-div-header-right"><div _ngcontent-cks-c106="" class="handle-button ai-button"></div><div _ngcontent-cks-c106="" class="handle-button line-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-cks-c106="" class="handle-button theme-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-cks-c106="" class="handle-button copy-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-cks-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// UIExtensionAbility不支持三方应用直接继承，故以派生类ShareExtensionAbility举例说明。</span></li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">ShareExtensionAbility</span>, <span class="hljs-title class_">Want</span>, <span class="hljs-title class_">UIExtensionContentSession</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">const</span> <span class="hljs-attr">TAG</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'[testTag] ShareExtAbility'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ShareExtAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">ShareExtensionAbility</span> {</li><li>  <span class="hljs-title function_">onSessionCreate</span>(<span class="hljs-params">want: Want, session: UIExtensionContentSession</span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">`onSessionCreate, want: <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(want)}</span>`</span>);</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">data</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-title class_">UIExtensionContentSession</span>&gt; = {</li><li>      <span class="hljs-string">'session'</span>: session</li><li>    };</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">storage</span>: <span class="hljs-title class_">LocalStorage</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LocalStorage</span>(data);</li><li>    session.<span class="hljs-title function_">loadContent</span>(<span class="hljs-string">'pages/extension'</span>, storage);</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">reportDrawnCompleted</span>(<span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> {</li><li>        <span class="hljs-keyword">if</span> (err.<span class="hljs-property">code</span>) {</li><li>          <span class="hljs-comment">// 处理业务逻辑错误</span></li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`reportDrawnCompleted failed, code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>          <span class="hljs-keyword">return</span>;</li><li>        }</li><li>        <span class="hljs-comment">// 执行正常业务</span></li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'reportDrawnCompleted succeed'</span>);</li><li>      });</li><li>    } <span class="hljs-keyword">catch</span> (err) {</li><li>      <span class="hljs-comment">// 捕获同步的参数错误</span></li><li>      <span class="hljs-keyword">let</span> code = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span>;</li><li>      <span class="hljs-keyword">let</span> message = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>;</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`reportDrawnCompleted failed, code is <span class="hljs-subst">${code}</span>, message is <span class="hljs-subst">${message}</span>`</span>);</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="openatomicservice12" device-type="phone,2in1,tablet,wearable,tv">openAtomicService<sup>12+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="openatomicservice12" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>openAtomicService(appId: string, options?: AtomicServiceOptions): Promise&lt;AbilityResult&gt;</p>     <p>打开一个独立窗口的元服务，并返回结果。使用Promise异步回调。</p>     <p>分为以下几种情况：</p>     <ul>      <li>正常情况下可通过调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext#terminateselfwithresult">terminateSelfWithResult</a>接口使之终止并且返回结果给调用方。</li>      <li>异常情况下比如杀死元服务会返回异常信息给调用方，异常信息中resultCode为-1。</li>      <li>如果不同应用多次调用该接口启动同一个元服务，当这个元服务调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext#terminateselfwithresult">terminateSelfWithResult</a>接口使之终止时，只将正常结果返回给最后一个调用方, 其它调用方返回异常信息，异常信息中resultCode为-1。</li>     </ul>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>组件启动规则详见：<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/component-startup-rules" target="_blank">组件启动规则（Stage模型）</a>。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.19.9.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.19.9.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.19.9.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.19.9.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">appId</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">应用的唯一标识，由云端统一分配。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">options</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-atomicserviceoptions">AtomicServiceOptions</a></td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">启动元服务所携带的参数。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.19.11.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.19.11.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-ability-abilityresult">AbilityResult</a>&gt;</td>         <td class="cellrowborder" width="50%">Promise对象。返回给拉起方的信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-ability">元能力子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.19.14.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.19.14.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1.Mandatory parameters are left unspecified. 2.Incorrect parameter types.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000002</td>         <td class="cellrowborder" width="50%">Incorrect ability type.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000003</td>         <td class="cellrowborder" width="50%">The specified ID does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000004</td>         <td class="cellrowborder" width="50%">Cannot start an invisible component.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000011</td>         <td class="cellrowborder" width="50%">The context does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000012</td>         <td class="cellrowborder" width="50%">The application is controlled.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000050</td>         <td class="cellrowborder" width="50%">Internal error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000069</td>         <td class="cellrowborder" width="50%">The extension cannot start the third party application.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16200001</td>         <td class="cellrowborder" width="50%">The caller has been released.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-cks-c106="" class="highlight-div"><div _ngcontent-cks-c106="" class="highlight-div-header"><div _ngcontent-cks-c106="" class="highlight-div-header-left"><div _ngcontent-cks-c106="" class="handle-button expand-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-cks-c106="" class="highlight-div-header-right"><div _ngcontent-cks-c106="" class="handle-button ai-button"></div><div _ngcontent-cks-c106="" class="handle-button line-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-cks-c106="" class="handle-button theme-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-cks-c106="" class="handle-button copy-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-cks-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// UIExtensionAbility不支持三方应用直接继承，故以派生类ShareExtensionAbility举例说明。</span></li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">ShareExtensionAbility</span>, common, <span class="hljs-title class_">AtomicServiceOptions</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ShareExtAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">ShareExtensionAbility</span> {</li><li>  <span class="hljs-title function_">onForeground</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">appId</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'6918661953712445909'</span>;</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">options</span>: <span class="hljs-title class_">AtomicServiceOptions</span> = {</li><li>      <span class="hljs-attr">displayId</span>: <span class="hljs-number">0</span>,</li><li>    };</li><li>
</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">openAtomicService</span>(appId, options)</li><li>        .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">result: common.AbilityResult</span>) =&gt;</span> {</li><li>          <span class="hljs-comment">// 执行正常业务</span></li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'openAtomicService succeed'</span>);</li><li>        })</li><li>        .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>          <span class="hljs-comment">// 处理业务逻辑错误</span></li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`openAtomicService failed, code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>        });</li><li>    } <span class="hljs-keyword">catch</span> (err) {</li><li>      <span class="hljs-comment">// 处理入参错误异常</span></li><li>      <span class="hljs-keyword">let</span> code = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span>;</li><li>      <span class="hljs-keyword">let</span> message = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>;</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`openAtomicService failed, code is <span class="hljs-subst">${code}</span>, message is <span class="hljs-subst">${message}</span>`</span>);</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="openlink12" device-type="phone,2in1,tablet,wearable,tv">openLink<sup>12+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="openlink12" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>openLink(link:string, options?: OpenLinkOptions, callback?: AsyncCallback&lt;AbilityResult&gt;): Promise&lt;void&gt;</p>     <p>通过App Linking或Deep Linking方式启动UIAbility。使用Promise异步回调。</p>     <p>通过在link字段中传入标准格式的URL，基于隐式want匹配规则拉起目标UIAbility。目标方必须具备以下过滤器特征，才能处理App Linking链接：</p>     <ul>      <li>"actions"列表中包含"ohos.want.action.viewData"。</li>      <li>"entities"列表中包含"entity.system.browsable"。</li>      <li>"uris"列表中包含"scheme"为"https"且"domainVerify"为true的元素。</li>     </ul>     <p>如果希望获取被拉起方终止后的结果，可以设置callback参数，此参数的使用可参照<a href="/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiextensioncontext#startabilityforresult">startAbilityForResult</a>接口。</p>     <p>传入的参数不合法时，如未设置必选参数或link字符串不是标准格式的URL，接口会直接抛出异常。参数校验通过，拉起目标方时出现的错误通过promise返回错误信息。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>组件启动规则详见：<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/component-startup-rules" target="_blank">组件启动规则（Stage模型）</a>。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.20.11.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.20.11.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.20.11.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.20.11.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">link</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">指示要打开的标准格式URL。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">options</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-openlinkoptions">OpenLinkOptions</a></td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">打开URL的选项参数。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%">AsyncCallback&lt;<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-ability-abilityresult">AbilityResult</a>&gt;</td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">回调函数，包含返回给拉起方的信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.20.13.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.20.13.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">无返回结果的Promise对象。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-ability">元能力子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.20.16.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.20.16.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">The application does not have permission to call the interface.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1.Mandatory parameters are left unspecified. 2.Incorrect parameter types.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000001</td>         <td class="cellrowborder" width="50%">The specified ability does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000002</td>         <td class="cellrowborder" width="50%">Incorrect ability type.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000004</td>         <td class="cellrowborder" width="50%">Cannot start an invisible component.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000005</td>         <td class="cellrowborder" width="50%">The specified process does not have the permission.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000006</td>         <td class="cellrowborder" width="50%">Cross-user operations are not allowed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000008</td>         <td class="cellrowborder" width="50%">The crowdtesting application expires.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000009</td>         <td class="cellrowborder" width="50%">An ability cannot be started or stopped in Wukong mode.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000010</td>         <td class="cellrowborder" width="50%">The call with the continuation and prepare continuation flag is forbidden.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000011</td>         <td class="cellrowborder" width="50%">The context does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000012</td>         <td class="cellrowborder" width="50%">The application is controlled.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000013</td>         <td class="cellrowborder" width="50%">The application is controlled by EDM.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000019</td>         <td class="cellrowborder" width="50%">No matching ability is found.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000069</td>         <td class="cellrowborder" width="50%">The extension cannot start the third party application.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16200001</td>         <td class="cellrowborder" width="50%">The caller has been released.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000053</td>         <td class="cellrowborder" width="50%">The ability is not on the top of the UI.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-cks-c106="" class="highlight-div"><div _ngcontent-cks-c106="" class="highlight-div-header"><div _ngcontent-cks-c106="" class="highlight-div-header-left"><div _ngcontent-cks-c106="" class="handle-button expand-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-cks-c106="" class="highlight-div-header-right"><div _ngcontent-cks-c106="" class="handle-button ai-button"></div><div _ngcontent-cks-c106="" class="handle-button line-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-cks-c106="" class="handle-button theme-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-cks-c106="" class="handle-button copy-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-cks-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// UIExtensionAbility不支持三方应用直接继承，故以派生类ShareExtensionAbility举例说明。</span></li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">ShareExtensionAbility</span>, <span class="hljs-title class_">Want</span>, <span class="hljs-title class_">UIExtensionContentSession</span>, <span class="hljs-title class_">OpenLinkOptions</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ShareExtAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">ShareExtensionAbility</span> {</li><li>  <span class="hljs-title function_">onCreate</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`UIExtAbility onCreate`</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">onForeground</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`UIExtAbility onForeground`</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">onBackground</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`UIExtAbility onBackground`</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">onDestroy</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`UIExtAbility onDestroy`</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">onSessionCreate</span>(<span class="hljs-params">want: Want, session: UIExtensionContentSession</span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`UIExtAbility onSessionCreate`</span>);</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`UIExtAbility onSessionCreate, want: <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(want)}</span>`</span>);</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">record</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-title class_">UIExtensionContentSession</span>&gt; = {</li><li>      <span class="hljs-string">'session'</span>: session</li><li>    };</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">storage</span>: <span class="hljs-title class_">LocalStorage</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LocalStorage</span>(record);</li><li>    session.<span class="hljs-title function_">loadContent</span>(<span class="hljs-string">'pages/UIExtensionIndex'</span>, storage);</li><li>
</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">link</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'https://www.example.com'</span>;</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">openLinkOptions</span>: <span class="hljs-title class_">OpenLinkOptions</span> = {</li><li>      <span class="hljs-attr">appLinkingOnly</span>: <span class="hljs-literal">true</span></li><li>    };</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">openLink</span>(</li><li>        link,</li><li>        openLinkOptions,</li><li>        <span class="hljs-function">(<span class="hljs-params">err, result</span>) =&gt;</span> {</li><li>          <span class="hljs-keyword">if</span> (err) {</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`openLink callback failed, err code: <span class="hljs-subst">${err.code}</span>, err msg: <span class="hljs-subst">${err.message}</span>.`</span>);</li><li>            <span class="hljs-keyword">return</span>;</li><li>          }</li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`openLink success, result code: <span class="hljs-subst">${result.resultCode}</span> result data: <span class="hljs-subst">${result.want}</span>.`</span>);</li><li>        }</li><li>      ).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`open link success.`</span>);</li><li>      }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`open link failed, err code: <span class="hljs-subst">${err.code}</span>, err msg: <span class="hljs-subst">${err.message}</span>.`</span>);</li><li>      });</li><li>    } <span class="hljs-keyword">catch</span> (err) {</li><li>      <span class="hljs-keyword">let</span> code = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span>;</li><li>      <span class="hljs-keyword">let</span> msg = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>;</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`openLink failed, err code: <span class="hljs-subst">${code}</span>, err msg: <span class="hljs-subst">${msg}</span>.`</span>);</li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">onSessionDestroy</span>(<span class="hljs-params">session: UIExtensionContentSession</span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`UIExtAbility onSessionDestroy`</span>);</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="startuiserviceextensionability14" device-type="phone,2in1,tablet,wearable,tv">startUIServiceExtensionAbility<sup>14+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="startuiserviceextensionability14" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>startUIServiceExtensionAbility(want: Want): Promise&lt;void&gt;</p>     <p>启动一个UIServiceExtensionAbility。使用Promise异步回调。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>组件启动规则详见：<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/component-startup-rules" target="_blank">组件启动规则（Stage模型）</a>。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.21.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.21.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.21.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.21.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">want</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-want">Want</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">启动UIServiceExtensionAbility的Want。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.21.9.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.21.9.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">Promise对象，无返回结果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-ability">元能力子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.21.12.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.21.12.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">The application does not have permission to call the interface.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1. Mandatory parameters are left unspecified; 2. Incorrect parameter types; 3. Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000001</td>         <td class="cellrowborder" width="50%">The specified ability does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000002</td>         <td class="cellrowborder" width="50%">Incorrect ability type.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000004</td>         <td class="cellrowborder" width="50%">Cannot start an invisible component.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000005</td>         <td class="cellrowborder" width="50%">The specified process does not have the permission.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000008</td>         <td class="cellrowborder" width="50%">The crowdtesting application expires.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000011</td>         <td class="cellrowborder" width="50%">The context does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000012</td>         <td class="cellrowborder" width="50%">The application is controlled.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000013</td>         <td class="cellrowborder" width="50%">The application is controlled by EDM.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000019</td>         <td class="cellrowborder" width="50%">No matching ability is found.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000050</td>         <td class="cellrowborder" width="50%">Internal error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16200001</td>         <td class="cellrowborder" width="50%">The caller has been released.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-cks-c106="" class="highlight-div"><div _ngcontent-cks-c106="" class="highlight-div-header"><div _ngcontent-cks-c106="" class="highlight-div-header-left"><div _ngcontent-cks-c106="" class="handle-button expand-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-cks-c106="" class="highlight-div-header-right"><div _ngcontent-cks-c106="" class="handle-button ai-button"></div><div _ngcontent-cks-c106="" class="handle-button line-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-cks-c106="" class="handle-button theme-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-cks-c106="" class="handle-button copy-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-cks-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { common, <span class="hljs-title class_">Want</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Row</span>() {</li><li>        <span class="hljs-comment">// 创建启动按钮</span></li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">'start ability'</span>)</li><li>          .<span class="hljs-title function_">enabled</span>(<span class="hljs-literal">true</span>)</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-keyword">let</span> context = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIExtensionContext</span>;</li><li>            <span class="hljs-keyword">let</span> <span class="hljs-attr">startWant</span>: <span class="hljs-title class_">Want</span> = {</li><li>              <span class="hljs-attr">bundleName</span>: <span class="hljs-string">'com.acts.uiserviceextensionability'</span>,</li><li>              <span class="hljs-attr">abilityName</span>: <span class="hljs-string">'UiServiceExtAbility'</span>,</li><li>            };</li><li>            <span class="hljs-keyword">try</span> {</li><li>              <span class="hljs-comment">// 启动UIServiceExtensionAbility</span></li><li>              context.<span class="hljs-title function_">startUIServiceExtensionAbility</span>(startWant).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`startUIServiceExtensionAbility success.`</span>);</li><li>              }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error: BusinessError</span>) =&gt;</span> {</li><li>                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`startUIServiceExtensionAbility failed, err code: <span class="hljs-subst">${error.code}</span>, err msg: <span class="hljs-subst">${error.message}</span>.`</span>);</li><li>              })</li><li>            } <span class="hljs-keyword">catch</span> (err) {</li><li>              <span class="hljs-keyword">let</span> code = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span>;</li><li>              <span class="hljs-keyword">let</span> msg = (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>;</li><li>              <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`startUIServiceExtensionAbility failed, err code: <span class="hljs-subst">${code}</span>, err msg: <span class="hljs-subst">${msg}</span>.`</span>);</li><li>            }</li><li>          })</li><li>      }</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="connectuiserviceextensionability14" device-type="phone,2in1,tablet,wearable,tv">connectUIServiceExtensionAbility<sup>14+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="connectuiserviceextensionability14" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>connectUIServiceExtensionAbility(want: Want, callback: UIServiceExtensionConnectCallback) : Promise&lt;UIServiceProxy&gt;</p>     <p>连接到一个UIServiceExtensionAbility。使用Promise异步回调。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>组件启动规则详见：<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/component-startup-rules" target="_blank">组件启动规则（Stage模型）</a>。</p>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.22.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.22.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.22.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.22.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">want</td>         <td class="cellrowborder" width="25%">Want</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">用于连接的Want信息。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/nner-application-uiserviceextensionconnectcallback">UIServiceExtensionConnectCallback</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">连接UIServiceExtensionAbility回调。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.22.9.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.22.9.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;UIServiceProxy&gt;</td>         <td class="cellrowborder" width="50%">Promise对象，连接UIServiceExtensionAbility成功时，返回<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiserviceproxy">UIServiceProxy</a>对象，借助该对象可以往UIServiceExtensionAbility发送数据。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-ability">元能力子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.22.12.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.22.12.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">201</td>         <td class="cellrowborder" width="50%">The application does not have permission to call the interface.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1. Mandatory parameters are left unspecified; 2. Incorrect parameter types; 3. Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">801</td>         <td class="cellrowborder" width="50%">Capability not supported.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000001</td>         <td class="cellrowborder" width="50%">The specified ability does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000002</td>         <td class="cellrowborder" width="50%">Incorrect ability type.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000004</td>         <td class="cellrowborder" width="50%">Cannot start an invisible component.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000005</td>         <td class="cellrowborder" width="50%">The specified process does not have the permission.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000008</td>         <td class="cellrowborder" width="50%">The crowdtesting application expires.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000011</td>         <td class="cellrowborder" width="50%">The context does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000013</td>         <td class="cellrowborder" width="50%">The application is controlled by EDM.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000050</td>         <td class="cellrowborder" width="50%">Internal error.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000055</td>         <td class="cellrowborder" width="50%">Installation-free timed out.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-cks-c106="" class="highlight-div"><div _ngcontent-cks-c106="" class="highlight-div-header"><div _ngcontent-cks-c106="" class="highlight-div-header-left"><div _ngcontent-cks-c106="" class="handle-button expand-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-cks-c106="" class="highlight-div-header-right"><div _ngcontent-cks-c106="" class="handle-button ai-button"></div><div _ngcontent-cks-c106="" class="handle-button line-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-cks-c106="" class="handle-button theme-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-cks-c106="" class="handle-button copy-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-cks-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { common, <span class="hljs-title class_">Want</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Page</span>_UIServiceExtensionAbility {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">uiServiceProxy</span>: common.<span class="hljs-property">UIServiceProxy</span> | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-comment">//...</span></li><li>      <span class="hljs-title class_">Row</span>() {</li><li>        <span class="hljs-comment">//...</span></li><li>      }.<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>        <span class="hljs-keyword">const</span> context = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIExtensionContext</span>;</li><li>        <span class="hljs-keyword">const</span> <span class="hljs-attr">want</span>: <span class="hljs-title class_">Want</span> = {</li><li>          <span class="hljs-attr">deviceId</span>: <span class="hljs-string">''</span>,</li><li>          <span class="hljs-attr">bundleName</span>: <span class="hljs-string">'com.example.myapplication'</span>,</li><li>          <span class="hljs-attr">abilityName</span>: <span class="hljs-string">''</span></li><li>        };</li><li>        <span class="hljs-comment">// 定义回调</span></li><li>        <span class="hljs-keyword">const</span> <span class="hljs-attr">callback</span>: common.<span class="hljs-property">UIServiceExtensionConnectCallback</span> = {</li><li>          <span class="hljs-attr">onData</span>: (<span class="hljs-attr">data</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-title class_">Object</span>&gt;): <span class="hljs-function"><span class="hljs-params">void</span> =&gt;</span> {</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`onData, data: <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(data)}</span>.`</span>);</li><li>          },</li><li>          <span class="hljs-attr">onDisconnect</span>: (): <span class="hljs-function"><span class="hljs-params">void</span> =&gt;</span> {</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`onDisconnect`</span>);</li><li>          }</li><li>        };</li><li>        <span class="hljs-comment">// 连接UIServiceExtensionAbility</span></li><li>        context.<span class="hljs-title function_">connectUIServiceExtensionAbility</span>(want, callback).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">uiServiceProxy: common.UIServiceProxy</span>) =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">uiServiceProxy</span> = uiServiceProxy;</li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`connectUIServiceExtensionAbility success`</span>);</li><li>        }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error: BusinessError</span>) =&gt;</span> {</li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`connectUIServiceExtensionAbility failed, err code: <span class="hljs-subst">${error.code}</span>, err msg: <span class="hljs-subst">${error.message}</span>.`</span>);</li><li>        })</li><li>      })</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="disconnectuiserviceextensionability14" device-type="phone,2in1,tablet,wearable,tv">disconnectUIServiceExtensionAbility<sup>14+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="disconnectuiserviceextensionability14" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>disconnectUIServiceExtensionAbility(proxy: UIServiceProxy): Promise&lt;void&gt;</p>     <p>断开UIServiceExtensionAbility。使用Promise异步回调。</p>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.Core</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.23.6.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.23.6.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.23.6.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.23.6.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">proxy</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiserviceproxy">UIServiceProxy</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiextensioncontext#connectuiserviceextensionability14">connectUIServiceExtensionAbility</a>返回的Proxy。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.23.8.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.23.8.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Promise&lt;void&gt;</td>         <td class="cellrowborder" width="50%">Promise对象，无返回结果。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal">通用错误码</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-ability">元能力子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.23.11.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.23.11.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">401</td>         <td class="cellrowborder" width="50%">Parameter error. Possible causes: 1. Mandatory parameters are left unspecified; 2. Incorrect parameter types; 3. Parameter verification failed.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000011</td>         <td class="cellrowborder" width="50%">The context does not exist.</td>        </tr>        <tr>         <td class="cellrowborder" width="50%">16000050</td>         <td class="cellrowborder" width="50%">Internal error.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-cks-c106="" class="highlight-div"><div _ngcontent-cks-c106="" class="highlight-div-header"><div _ngcontent-cks-c106="" class="highlight-div-header-left"><div _ngcontent-cks-c106="" class="handle-button expand-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-cks-c106="" class="highlight-div-header-right"><div _ngcontent-cks-c106="" class="handle-button ai-button"></div><div _ngcontent-cks-c106="" class="handle-button line-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-cks-c106="" class="handle-button theme-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-cks-c106="" class="handle-button copy-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-cks-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Page</span>_UIServiceExtensionAbility {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">uiServiceProxy</span>: common.<span class="hljs-property">UIServiceProxy</span> | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-comment">//...</span></li><li>      <span class="hljs-title class_">Row</span>() {</li><li>        <span class="hljs-comment">//...</span></li><li>      }.<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>        <span class="hljs-keyword">const</span> context = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIExtensionContext</span>;</li><li>        <span class="hljs-comment">// this.uiServiceProxy是连接时保存的proxy对象</span></li><li>        context.<span class="hljs-title function_">disconnectUIServiceExtensionAbility</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">uiServiceProxy</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`disconnectUIServiceExtensionAbility success.`</span>);</li><li>        }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error: BusinessError</span>) =&gt;</span> {</li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`disconnectUIServiceExtensionAbility failed, err code: <span class="hljs-subst">${error.code}</span>, err msg: <span class="hljs-subst">${error.message}</span>.`</span>);</li><li>        })</li><li>      })</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="setcolormode18" device-type="phone,2in1,tablet,wearable,tv">setColorMode<sup>18+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="setcolormode18" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>setColorMode(colorMode: ConfigurationConstant.ColorMode): void</p>     <p>设置UIExtensionAbility的深浅色模式。调用该接口前需要保证该UIExtensionContext对应页面已完成加载。仅支持主线程调用。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <ul>        <li>调用该接口后会创建新的资源管理器对象，如果此前有缓存资源管理器，需要进行更新。</li>        <li>深浅色模式生效的优先级：UIExtensionAbility的深浅色模式 &gt; 应用的深浅色模式（<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-applicationcontext#applicationcontextsetcolormode11">ApplicationContext.setColorMode</a>）&gt; 系统的深浅色模式。</li>       </ul>      </div></div></div>     <p><strong>系统能力</strong>：SystemCapability.Ability.AbilityRuntime.Core</p>     <p><strong>参数</strong>：</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.24.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.24.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.24.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.24.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">colorMode</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-configurationconstant#colormode">ConfigurationConstant.ColorMode</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">          <p>设置颜色模式，包括：</p>          <p>- COLOR_MODE_DARK：深色模式</p>          <p>- COLOR_MODE_LIGHT：浅色模式</p>          <p>- COLOR_MODE_NOT_SET：不设置（跟随系统或应用）</p></td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码</strong>：</p>     <p>以下错误码详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-ability">元能力子系统错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.24.10.1.3.1.1" width="50%">错误码ID</th>         <th align="left" class="cellrowborder" id="mcps1.3.24.10.1.3.1.2" width="50%">错误信息</th>        </tr><tr>         <td class="cellrowborder" width="50%">16000011</td>         <td class="cellrowborder" width="50%">The context does not exist.</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例</strong>：</p>     <div _ngcontent-cks-c106="" class="highlight-div"><div _ngcontent-cks-c106="" class="highlight-div-header"><div _ngcontent-cks-c106="" class="highlight-div-header-left"><div _ngcontent-cks-c106="" class="handle-button expand-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-cks-c106="" class="highlight-div-header-right"><div _ngcontent-cks-c106="" class="handle-button ai-button"></div><div _ngcontent-cks-c106="" class="handle-button line-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-cks-c106="" class="handle-button theme-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-cks-c106="" class="handle-button copy-button"><div _ngcontent-cks-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-cks-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// UIExtensionAbility不支持三方应用直接继承，故以派生类ShareExtensionAbility举例说明。</span></li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">ShareExtensionAbility</span>, <span class="hljs-title class_">ConfigurationConstant</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">ShareExtensionAbility</span> {</li><li>  <span class="hljs-title function_">onForeground</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">let</span> uiExtensionContext = <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>;</li><li>    uiExtensionContext.<span class="hljs-title function_">setColorMode</span>(<span class="hljs-title class_">ConfigurationConstant</span>.<span class="hljs-property">ColorMode</span>.<span class="hljs-property">COLOR_MODE_DARK</span>);</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>   </div>   <div></div></div>