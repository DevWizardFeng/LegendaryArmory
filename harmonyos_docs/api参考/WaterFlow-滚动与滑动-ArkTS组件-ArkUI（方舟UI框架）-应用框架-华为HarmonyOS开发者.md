<h1 _ngcontent-fiw-c119="" class="doc-title ng-star-inserted" title="WaterFlow"> WaterFlow </h1>

<div _ngcontent-fiw-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted renderOptimization" style="position: relative;">   <div>    <p>瀑布流容器，由“行”和“列”分割的单元格所组成，通过容器自身的排列规则，将不同大小的“项目”自上而下，如瀑布般紧密布局。</p>    <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">      <p>该组件从API version 9 开始支持。后续版本如有新增内容，则采用上角标单独标记该内容的起始版本。</p>      <p>WaterFlow组件支持展示瀑布流布局，不支持编辑模式和子元素拖动功能。</p>      <p>组件内部已绑定手势实现跟手滚动等功能，需要增加自定义手势操作时请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-gesture-blocking-enhancement">手势拦截增强</a>进行处理。</p>     </div></div></div>    <div class="tiledSection scroll-inwindow" style="contain-intrinsic-size: auto 538px;">     <h2 id="子组件" device-type="phone,2in1,tablet,wearable,tv">子组件<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="子组件" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>仅支持<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-flowitem">FlowItem</a>子组件和自定义组件。自定义组件在WaterFlow下使用时，建议使用FlowItem作为自定组件的顶层组件，不建议给自定义组件设置属性和事件方法。</p>     <p>支持通过渲染控制类型（<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-rendering-control-ifelse" target="_blank">if/else</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-rendering-control-foreach" target="_blank">ForEach</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-rendering-control-lazyforeach" target="_blank">LazyForEach</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-new-rendering-control-repeat" target="_blank">Repeat</a>）动态生成子组件，更推荐使用LazyForEach或Repeat以优化性能。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>WaterFlow子组件的visibility属性设置为None时不显示，但该子组件周围的columnsGap、rowsGap、margin仍会生效。</p>       <p>在涉及大量子组件的情况下，建议采用懒加载、缓存数据、组件复用、固定宽高以及布局优化等方法，以提升性能和减少内存占用。最佳实践请参考<a href="https://developer.huawei.com/consumer/cn/doc/best-practices/bpta-waterflow-performance-optimization" target="_blank">优化瀑布流加载慢丢帧问题</a>。</p>       <p>纵向布局时，WaterFlow会计算每一列中已放置子组件的累计高度，并将新子组件放入累计高度最小的那一列，以保持整体布局紧凑。</p>       <p>若多个列的高度相同，优先放入最左边的列。在RTL模式下，优先放入最右边的列。</p>       <p>从API version 21开始，WaterFlow单个子组件的宽高最大为16777216px；API version 20及之前，WaterFlow单个子组件的宽高最大为1000000px。子组件超出该大小可能导致滚动或显示异常。</p>      </div></div></div>    </div>    <div class="tiledSection scroll-inwindow" style="contain-intrinsic-size: auto 477px;">     <h2 id="接口" device-type="phone,2in1,tablet,wearable,tv">接口<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="接口" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>WaterFlow(options?: WaterFlowOptions)</p>     <p>创建瀑布流容器。</p>     <p><strong>元服务API：</strong> 从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力：</strong> SystemCapability.ArkUI.ArkUI.Full</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.4.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.4.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.4.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.4.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">options</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/ts-container-waterflow#waterflowoptions对象说明">WaterFlowOptions</a></td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">瀑布流组件参数。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection scroll-inwindow" style="contain-intrinsic-size: auto 1905px;">     <h2 id="waterflowoptions对象说明" device-type="phone,2in1,tablet,wearable,tv">WaterFlowOptions对象说明<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="waterflowoptions对象说明" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>瀑布流组件参数对象。</p>     <p><strong>系统能力：</strong> SystemCapability.ArkUI.ArkUI.Full</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.5.4.1.6.1.1" width="20%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.5.4.1.6.1.2" width="20%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.5.4.1.6.1.3" width="20%">只读</th>         <th align="left" class="cellrowborder" id="mcps1.3.5.4.1.6.1.4" width="20%">可选</th>         <th align="left" class="cellrowborder" id="mcps1.3.5.4.1.6.1.5" width="20%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">footer</td>         <td class="cellrowborder" width="20%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-types#custombuilder8">CustomBuilder</a></td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">          <p>设置WaterFlow尾部组件。</p>          <p><strong>说明：</strong></p>          <p>使用方法参见<a href="/consumer/cn/doc/harmonyos-references/ts-container-waterflow#示例1使用基本瀑布流">示例1</a>。</p>          <p><strong>元服务API：</strong> 从API version 11开始，该接口支持在元服务中使用。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">footerContent<sup>18+</sup></td>         <td class="cellrowborder" width="20%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-arkui-componentcontent">ComponentContent</a></td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">          <p>设置WaterFlow尾部组件。</p>          <p>该参数的优先级高于参数footer，即同时设置footer和footerContent时，以footerContent设置的组件为准。</p>          <p><strong>元服务API：</strong> 从API version 18开始，该接口支持在元服务中使用。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">scroller</td>         <td class="cellrowborder" width="20%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-scroll#scroller">Scroller</a></td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">          <p>可滚动组件的控制器，与可滚动组件绑定。</p>          <p><strong>说明：</strong></p>          <p>不允许和其他滚动类组件，如：<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-arclist">ArcList</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-list">List</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-grid">Grid</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-scroll">Scroll</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-waterflow">WaterFlow</a>绑定同一个滚动控制对象。</p>          <p><strong>元服务API：</strong> 从API version 11开始，该接口支持在元服务中使用。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">sections<sup>12+</sup></td>         <td class="cellrowborder" width="20%"><a href="/consumer/cn/doc/harmonyos-references/ts-container-waterflow#sections12">WaterFlowSections</a></td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">          <p>设置FlowItem分组，实现同一个瀑布流组件内部各分组使用不同列数混合布局。</p>          <p><strong>说明：</strong></p>          <p>1. 使用分组混合布局时会忽略<a href="/consumer/cn/doc/harmonyos-references/ts-container-waterflow#columnstemplate">columnsTemplate</a>和<a href="/consumer/cn/doc/harmonyos-references/ts-container-waterflow#rowstemplate">rowsTemplate</a>属性。</p>          <p>2. 使用分组混合布局时不支持单独设置footer，可以使用最后一个分组作为尾部组件。</p>          <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">layoutMode<sup>12+</sup></td>         <td class="cellrowborder" width="20%"><a href="/consumer/cn/doc/harmonyos-references/ts-container-waterflow#waterflowlayoutmode12枚举说明">WaterFlowLayoutMode</a></td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">          <p>设置WaterFlow的布局模式，根据使用场景选择更切合的模式。</p>          <p><strong>说明：</strong></p>          <p>默认值：<a href="/consumer/cn/doc/harmonyos-references/ts-container-waterflow#waterflowlayoutmode12枚举说明">ALWAYS_TOP_DOWN</a>。</p>          <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 298px;">     <h2 id="sections12" device-type="phone,2in1,tablet,wearable,tv">WaterFlowSections<sup>12+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="sections12" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>瀑布流分组信息。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>使用splice、push、update修改分组信息后需要保证所有分组子节点总数与瀑布流实际子节点总数一致，否则会出现瀑布流因为不能正常布局而无法滑动的问题。</p>      </div></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 302px;">     <h3 id="constructor" device-type="phone,2in1,tablet,wearable,tv" class="firsth2">constructor<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="constructor" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>constructor()</p>     <p>创建一个瀑布流分组。</p>     <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力：</strong> SystemCapability.ArkUI.ArkUI.Full</p>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1402px;">     <h3 id="splice12" device-type="phone,2in1,tablet,wearable,tv">splice<sup>12+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="splice12" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>splice(start: number, deleteCount?: number, sections?: Array&lt;SectionOptions&gt;): boolean</p>     <p>移除或者替换已存在的分组和/或添加新分组。</p>     <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力：</strong> SystemCapability.ArkUI.ArkUI.Full</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.8.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.8.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.8.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.8.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">start</td>         <td class="cellrowborder" width="25%">number</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">          <p>从0开始计算的索引，会转换为整数，表示要开始改变分组的位置。</p>          <p><strong>说明：</strong></p>          <p>1. 如果索引是负数，则从末尾开始计算，使用start + WaterFlowSections.length()。</p>          <p>2. 如果 start &lt; -WaterFlowSections.length()，则使用0。</p>          <p>3. 如果 start &gt;= WaterFlowSections.length()，则在最后添加新分组。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="25%">deleteCount</td>         <td class="cellrowborder" width="25%">number</td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">          <p>表示要从start开始删除的分组数量。</p>          <p><strong>说明：</strong></p>          <p>1. 如果省略了deleteCount，或者其值大于或等于由start指定的位置到WaterFlowSections末尾的分组数量，那么从start到WaterFlowSections末尾的所有分组将被删除。</p>          <p>2. 如果deleteCount是0或者负数，则不会删除任何分组。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="25%">sections</td>         <td class="cellrowborder" width="25%">Array&lt;<a href="/consumer/cn/doc/harmonyos-references/ts-container-waterflow#sectionoptions12对象说明">SectionOptions</a>&gt;</td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">表示要从start开始加入的分组。如果不指定，splice()将只从瀑布流中删除分组。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.8.9.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.8.9.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">boolean</td>         <td class="cellrowborder" width="50%">分组修改成功返回true；修改失败（要加入的分组中有任意分组的itemsCount不是非负数）返回false。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 664px;">     <h3 id="push12" device-type="phone,2in1,tablet,wearable,tv">push<sup>12+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="push12" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>push(section: SectionOptions): boolean</p>     <p>将指定分组添加到瀑布流末尾。</p>     <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力：</strong> SystemCapability.ArkUI.ArkUI.Full</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.9.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.9.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.9.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.9.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">section</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/ts-container-waterflow#sectionoptions12对象说明">SectionOptions</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">添加到瀑布流末尾的分组。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.9.9.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.9.9.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">boolean</td>         <td class="cellrowborder" width="50%">分组添加成功返回true，添加失败（新分组的itemsCount不是非负数）返回false。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1045px;">     <h3 id="update12" device-type="phone,2in1,tablet,wearable,tv">update<sup>12+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="update12" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>update(sectionIndex: number, section: SectionOptions): boolean</p>     <p>修改指定索引分组的配置信息。</p>     <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力：</strong> SystemCapability.ArkUI.ArkUI.Full</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.10.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.10.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.10.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.10.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">sectionIndex</td>         <td class="cellrowborder" width="25%">number</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">          <p>从0开始计算的索引，会转换为整数，表示要修改的分组的位置。</p>          <p><strong>说明：</strong></p>          <p>1. 如果索引是负数，则从末尾开始计算，使用sectionIndex + WaterFlowSections.length()。</p>          <p>2. 如果sectionIndex &lt; -WaterFlowSections.length()，则使用0。</p>          <p>3. 如果sectionIndex &gt;= WaterFlowSections.length()，则在最后添加新分组。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="25%">section</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/ts-container-waterflow#sectionoptions12对象说明">SectionOptions</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">新的分组信息。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.10.9.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.10.9.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">boolean</td>         <td class="cellrowborder" width="50%">分组是否更新成功，新分组的itemsCount不是非负数时返回false。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 489px;">     <h3 id="values12" device-type="phone,2in1,tablet,wearable,tv">values<sup>12+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="values12" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>values(): Array&lt;SectionOptions&gt;</p>     <p>获取瀑布流中所有分组配置信息。</p>     <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力：</strong> SystemCapability.ArkUI.ArkUI.Full</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.11.7.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.11.7.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">Array&lt;<a href="/consumer/cn/doc/harmonyos-references/ts-container-waterflow#sectionoptions12对象说明">SectionOptions</a>&gt;</td>         <td class="cellrowborder" width="50%">瀑布流中所有分组配置信息。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 489px;">     <h3 id="length12" device-type="phone,2in1,tablet,wearable,tv">length<sup>12+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="length12" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>length(): number</p>     <p>获取瀑布流中分组数量。</p>     <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力：</strong> SystemCapability.ArkUI.ArkUI.Full</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.12.7.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.12.7.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">number</td>         <td class="cellrowborder" width="50%">瀑布流中分组数量。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 2022px;">     <h2 id="sectionoptions12对象说明" device-type="phone,2in1,tablet,wearable,tv">SectionOptions<sup>12+</sup>对象说明<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="sectionoptions12对象说明" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>FlowItem分组配置信息。</p>     <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力：</strong> SystemCapability.ArkUI.ArkUI.Full</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.13.5.1.6.1.1" width="20%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.13.5.1.6.1.2" width="20%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.13.5.1.6.1.3" width="20%">只读</th>         <th align="left" class="cellrowborder" id="mcps1.3.13.5.1.6.1.4" width="20%">可选</th>         <th align="left" class="cellrowborder" id="mcps1.3.13.5.1.6.1.5" width="20%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">itemsCount</td>         <td class="cellrowborder" width="20%">number</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">分组中FlowItem数量，必须是非负数。若splice、push、update方法收到的分组中有分组的itemsCount小于0，则不会执行该方法。 避免使用itemsCount为0的分组，这可能导致布局计算异常。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">crossCount</td>         <td class="cellrowborder" width="20%">number</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">纵向布局时为列数，横向布局时为行数，默认值：1。小于1的按默认值处理。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">columnsGap</td>         <td class="cellrowborder" width="20%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-types#dimension10">Dimension</a></td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">该分组的列间距，不设置时使用瀑布流的columnsGap，设置非法值时使用0vp。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">rowsGap</td>         <td class="cellrowborder" width="20%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-types#dimension10">Dimension</a></td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">该分组的行间距，不设置时使用瀑布流的rowsGap，设置非法值时使用0vp。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">margin</td>         <td class="cellrowborder" width="20%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-types#margin">Margin</a> | <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-types#dimension10">Dimension</a></td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">          <p>该分组的外边距参数为Length类型时，四个方向外边距同时生效。</p>          <p>默认值：0</p>          <p>单位：vp</p>          <p>margin设置百分比时，上下左右外边距均以瀑布流的width作为基础值。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">onGetItemMainSizeByIndex</td>         <td class="cellrowborder" width="20%"><a href="/consumer/cn/doc/harmonyos-references/ts-container-waterflow#getitemmainsizebyindex12">GetItemMainSizeByIndex</a></td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">是</td>         <td class="cellrowborder" width="20%">          <p>瀑布流组件布局过程中获取指定index的FlowItem的主轴大小，纵向瀑布流时为高度，横向瀑布流时为宽度，单位vp。</p>          <p><strong>说明：</strong></p>          <p>1. 同时使用onGetItemMainSizeByIndex和FlowItem的宽高属性时，主轴大小以onGetItemMainSizeByIndex返回结果为准，onGetItemMainSizeByIndex会覆盖FlowItem的主轴长度。</p>          <p>2. 使用onGetItemMainSizeByIndex可以提高瀑布流跳转到指定位置或index时的效率，避免混用设置onGetItemMainSizeByIndex和未设置的分组，会导致布局异常。</p>          <p>3. onGetItemMainSizeByIndex返回负数时FlowItem高度为0。</p></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 744px;">     <h2 id="getitemmainsizebyindex12" device-type="phone,2in1,tablet,wearable,tv">GetItemMainSizeByIndex<sup>12+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="getitemmainsizebyindex12" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>type GetItemMainSizeByIndex = (index: number) =&gt; number</p>     <p>根据index获取指定Item的主轴大小。</p>     <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力：</strong> SystemCapability.ArkUI.ArkUI.Full</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.14.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.14.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.14.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.14.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">index</td>         <td class="cellrowborder" width="25%">number</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">          <p>FlowItem在WaterFlow中的索引。</p>          <p>取值范围：[0, 子节点总数-1]</p></td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.14.9.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.14.9.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">number</td>         <td class="cellrowborder" width="50%">指定index的FlowItem的主轴大小，纵向瀑布流时为高度，横向瀑布流时为宽度，单位vp。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1660px;">     <h2 id="waterflowlayoutmode12枚举说明" device-type="phone,2in1,tablet,wearable,tv">WaterFlowLayoutMode<sup>12+</sup>枚举说明<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="waterflowlayoutmode12枚举说明" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>瀑布流组件布局模式枚举。</p>     <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力：</strong> SystemCapability.ArkUI.ArkUI.Full</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.15.5.1.4.1.1" width="33.33333333333333%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.15.5.1.4.1.2" width="33.33333333333333%">值</th>         <th align="left" class="cellrowborder" id="mcps1.3.15.5.1.4.1.3" width="33.33333333333333%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="33.33333333333333%">ALWAYS_TOP_DOWN</td>         <td class="cellrowborder" width="33.33333333333333%">0</td>         <td class="cellrowborder" width="33.33333333333333%">默认的从上到下的布局模式。视窗内的FlowItem依赖视窗上方所有FlowItem的布局信息。因此跳转或切换列数时，需要计算出上方所有的FlowItem的布局信息。</td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">SLIDING_WINDOW</td>         <td class="cellrowborder" width="33.33333333333333%">1</td>         <td class="cellrowborder" width="33.33333333333333%">          <p>移动窗口式的布局模式。只考虑视窗内的布局信息，对视窗上方的FlowItem没有依赖关系，因此向后跳转或切换列数时只需要布局视窗内的FlowItem。建议优先采用该模式，尤其在应用需要支持屏幕旋转或动态切换列数的场景下。</p>          <p><strong>说明：</strong></p>          <p>1. 无动画跳转到较远的位置时，会以目标位置为基准，向前或向后布局FlowItem。这之后如果滑回跳转前的位置，内容的布局效果可能和之前不一致。 这个效果会导致跳转后回滑到顶部时，顶部节点可能不对齐。所以该布局模式下会在滑动到顶部后自动调整布局，保证顶部对齐。在有多个分组的情况下，会在滑动结束时调整在视窗内的分组。</p>          <p>2. <a href="/consumer/cn/doc/harmonyos-references/ts-container-waterflow#waterflowoptions对象说明">scroller</a>的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-scroll#currentoffset">currentOffset</a>接口返回的总偏移量在触发跳转或数据更新后不准确，在回滑到顶部时会重新校准。</p>          <p>3. 如果在同一帧内调用跳转（如无动画的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-scroll#scrolltoindex">scrollToIndex</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-scroll#scrolledge">scrollEdge</a>）和输入偏移量（如滑动手势或滚动动画），两者都会生效。</p>          <p>4. 调用无动画的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-scroll#scrolltoindex">scrollToIndex</a>进行跳转，如果跳转到较远位置（超过视窗内的FlowItem数量的位置）时，移动窗口模式对总偏移量进行估算。</p>          <p>5. 仅在API version 18及以上版本中支持滚动条<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-scrollable-common#scrollbar11">scrollBar</a>显示。低于此版本时，设置滚动条将不显示。</p></td>        </tr>             </tbody></table></div>     </div>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.15.6.1.4.1.1" width="33.33333333333333%">对比维度</th>         <th align="left" class="cellrowborder" id="mcps1.3.15.6.1.4.1.2" width="33.33333333333333%">ALWAYS_TOP_DOWN (默认)</th>         <th align="left" class="cellrowborder" id="mcps1.3.15.6.1.4.1.3" width="33.33333333333333%">SLIDING_WINDOW</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="33.33333333333333%">适用场景</td>         <td class="cellrowborder" width="33.33333333333333%">固定列数、简单瀑布流</td>         <td class="cellrowborder" width="33.33333333333333%">动态列数、大数据量、屏幕旋转</td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">布局策略</td>         <td class="cellrowborder" width="33.33333333333333%">从顶部开始完整布局</td>         <td class="cellrowborder" width="33.33333333333333%">滑动窗口式布局</td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">性能特点</td>         <td class="cellrowborder" width="33.33333333333333%">依赖上方所有 FlowItem</td>         <td class="cellrowborder" width="33.33333333333333%">只考虑视窗内布局</td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">跳转效率</td>         <td class="cellrowborder" width="33.33333333333333%">需要计算上方所有布局</td>         <td class="cellrowborder" width="33.33333333333333%">快速跳转，无需完整计算</td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">列数切换</td>         <td class="cellrowborder" width="33.33333333333333%">需要重新计算全部布局</td>         <td class="cellrowborder" width="33.33333333333333%">只重新布局视窗内容</td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">屏幕旋转</td>         <td class="cellrowborder" width="33.33333333333333%">支持，但性能较差</td>         <td class="cellrowborder" width="33.33333333333333%">支持，性能好</td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">滚动条显示</td>         <td class="cellrowborder" width="33.33333333333333%">始终支持</td>         <td class="cellrowborder" width="33.33333333333333%">API 18+ 支持</td>        </tr>        <tr>         <td class="cellrowborder" width="33.33333333333333%">布局一致性</td>         <td class="cellrowborder" width="33.33333333333333%">始终保持一致</td>         <td class="cellrowborder" width="33.33333333333333%">跳转后可能不一致</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 322px;">     <h2 id="属性" device-type="phone,2in1,tablet,wearable,tv">属性<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="属性" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>除支持<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-component-general-attributes">通用属性</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-scrollable-common#属性">滚动组件通用属性</a>外，还支持以下属性：</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>WaterFlow组件使用通用属性<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-universal-attributes-sharp-clipping#clip12">clip<sup>12+</sup></a>和通用属性<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-universal-attributes-sharp-clipping#clip18">clip<sup>18+</sup></a>时默认值都为true。</p>       <p>WaterFlow组件内容裁剪模式<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-scrollable-common#contentclipmode14枚举说明">ContentClipMode<sup>14+</sup>枚举说明</a>为ContentClipMode.CONTENT_ONLY，padding区域会被裁剪不显示。</p>      </div></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 621px;">     <h3 id="columnstemplate" device-type="phone,2in1,tablet,wearable,tv" class="firsth2">columnsTemplate<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="columnstemplate" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>columnsTemplate(value: string)</p>     <p>设置当前瀑布流组件布局列的数量，不设置时默认1列。</p>     <p>例如，'1fr 1fr 2fr' 是将父组件分3列，将父组件允许的宽分为4等份，第1列占1份，第2列占1份，第3列占2份。</p>     <p>可使用columnsTemplate('repeat(auto-fill,track-size)')根据给定的列宽track-size自动计算列数，其中repeat、auto-fill为关键字，track-size为可设置的宽度，支持的单位包括px、vp、%或有效数字，默认单位为vp，使用方法参见<a href="/consumer/cn/doc/harmonyos-references/ts-container-waterflow#示例2自动计算列数">示例2</a>。</p>     <p><strong>元服务API：</strong> 从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力：</strong> SystemCapability.ArkUI.ArkUI.Full</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.17.9.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.17.9.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.17.9.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.17.9.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">value</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">          <p>当前瀑布流组件布局列的数量。</p>          <p>默认值：'1fr'</p></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 637px;">     <h3 id="rowstemplate" device-type="phone,2in1,tablet,wearable,tv">rowsTemplate<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="rowstemplate" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>rowsTemplate(value: string)</p>     <p>设置当前瀑布流组件布局行的数量，不设置时默认1行。</p>     <p>例如，'1fr 1fr 2fr'是将父组件分3行，将父组件允许的高分为4等份，第1行占1份，第2行占1份，第3行占2份。</p>     <p>可使用rowsTemplate('repeat(auto-fill,track-size)')根据给定的行高track-size自动计算行数，其中repeat、auto-fill为关键字，track-size为可设置的高度，支持的单位包括px、vp、%或有效数字，默认单位为vp。</p>     <p><strong>元服务API：</strong> 从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力：</strong> SystemCapability.ArkUI.ArkUI.Full</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.18.9.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.18.9.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.18.9.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.18.9.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">value</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">          <p>当前瀑布流组件布局行的数量。</p>          <p>默认值：'1fr'</p></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 949px;">     <h3 id="itemconstraintsize" device-type="phone,2in1,tablet,wearable,tv">itemConstraintSize<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="itemconstraintsize" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>itemConstraintSize(value: ConstraintSizeOptions)</p>     <p>设置约束尺寸，子组件布局时，进行尺寸范围限制。使用方法参考<a href="/consumer/cn/doc/harmonyos-references/ts-container-waterflow#示例1使用基本瀑布流">示例1</a>。</p>     <p><strong>元服务API：</strong> 从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力：</strong> SystemCapability.ArkUI.ArkUI.Full</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.19.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.19.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.19.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.19.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">value</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-types#constraintsizeoptions">ConstraintSizeOptions</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">          <p>约束尺寸。设置小于0的值，参数不生效。</p>          <p><strong>说明：</strong></p>          <p>1.同时设置itemConstraintSize和FlowItem的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-universal-attributes-size#constraintsize">constraintSize</a>属性时，minWidth/minHeight会取其中的最大值，maxWidth/maxHeight会取其中的最小值，调整后的值作为FlowItem的constraintSize处理。</p>          <p>2.只设置itemConstraintSize时，相当于对WaterFlow所有子组件设置了相同的constraintSize。</p>          <p>3.itemConstraintSize通过以上两种方式转换成FlowItem的constraintSize后的生效规则与通用属性<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-universal-attributes-size#constraintsize">constraintSize</a>相同。</p></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 517px;">     <h3 id="columnsgap" device-type="phone,2in1,tablet,wearable,tv">columnsGap<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="columnsgap" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>columnsGap(value: Length)</p>     <p>设置列与列的间距。</p>     <p><strong>元服务API：</strong> 从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力：</strong> SystemCapability.ArkUI.ArkUI.Full</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.20.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.20.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.20.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.20.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">value</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-types#length">Length</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">          <p>列与列的间距。</p>          <p>默认值：0</p>          <p>取值范围：[0, +∞)</p></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 517px;">     <h3 id="rowsgap" device-type="phone,2in1,tablet,wearable,tv">rowsGap<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="rowsgap" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>rowsGap(value: Length)</p>     <p>设置行与行的间距。</p>     <p><strong>元服务API：</strong> 从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力：</strong> SystemCapability.ArkUI.ArkUI.Full</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.21.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.21.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.21.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.21.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">value</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-types#length">Length</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">          <p>行与行的间距。</p>          <p>默认值：0</p>          <p>取值范围：[0, +∞)</p></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 845px;">     <h3 id="layoutdirection" device-type="phone,2in1,tablet,wearable,tv">layoutDirection<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="layoutdirection" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>layoutDirection(value: FlexDirection)</p>     <p>设置布局的主轴方向。</p>     <p><strong>元服务API：</strong> 从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力：</strong> SystemCapability.ArkUI.ArkUI.Full</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.22.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.22.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.22.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.22.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">value</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-appendix-enums#flexdirection">FlexDirection</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">          <p>布局的主轴方向。</p>          <p>默认值：FlexDirection.Column</p></td>        </tr>             </tbody></table></div>     </div>     <p>layoutDirection优先级高于rowsTemplate和columnsTemplate。根据layoutDirection设置情况，分为以下三种设置模式：</p>     <ul>      <li>       <p>layoutDirection设置纵向布局（FlexDirection.Column 或 FlexDirection.ColumnReverse）</p>       <p>此时columnsTemplate有效（如果未设置，取默认值）。例如columnsTemplate设置为'1fr 1fr'、rowsTemplate设置为'1fr 1fr 1fr'时，瀑布流组件纵向布局，辅轴均分成横向2列。</p></li>      <li>       <p>layoutDirection设置横向布局（FlexDirection.Row 或 FlexDirection.RowReverse）</p>       <p>此时rowsTemplate有效（如果未设置，取默认值）。例如columnsTemplate设置为'1fr 1fr'、rowsTemplate设置为'1fr 1fr 1fr'时，瀑布流组件横向布局，辅轴均分成纵向3列。</p></li>      <li>       <p>layoutDirection未设置布局方向</p>       <p>布局方向为layoutDirection的默认值：FlexDirection.Column，此时columnsTemplate有效。例如columnsTemplate设置为'1fr 1fr'、rowsTemplate设置为'1fr 1fr 1fr'时，瀑布流组件纵向布局，辅轴均分成横向2列。</p></li>     </ul>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 705px;">     <h3 id="enablescrollinteraction10" device-type="phone,2in1,tablet,wearable,tv">enableScrollInteraction<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="enablescrollinteraction10" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>enableScrollInteraction(value: boolean)</p>     <p>设置是否支持滚动手势。</p>     <p><strong>元服务API：</strong> 从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力：</strong> SystemCapability.ArkUI.ArkUI.Full</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.23.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.23.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.23.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.23.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">value</td>         <td class="cellrowborder" width="25%">boolean</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">          <p>是否支持滚动手势。设置为true时可以通过手指或者鼠标滚动，设置为false时无法通过手指或者鼠标滚动，但不影响控制器<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-scroll#scroller">Scroller</a>的滚动接口。</p>          <p>默认值：true</p></td>        </tr>             </tbody></table></div>     </div>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>组件无法通过鼠标按下拖动操作进行滚动。</p>      </div></div></div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 469px;">     <h3 id="nestedscroll10" device-type="phone,2in1,tablet,wearable,tv">nestedScroll<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="nestedscroll10" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>nestedScroll(value: NestedScrollOptions)</p>     <p>设置前后两个方向的嵌套滚动模式，实现与父组件的滚动联动。使用方法参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-scroll#示例3嵌套滚动实现方式二">嵌套滚动实现方式二</a>。</p>     <p><strong>元服务API：</strong> 从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力：</strong> SystemCapability.ArkUI.ArkUI.Full</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.24.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.24.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.24.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.24.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">value</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-scrollable-common#nestedscrolloptions10对象说明">NestedScrollOptions</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">嵌套滚动选项。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 685px;">     <h3 id="friction10" device-type="phone,2in1,tablet,wearable,tv">friction<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="friction10" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>friction(value: number | Resource)</p>     <p>设置摩擦系数，手动划动滚动区域时生效，仅影响惯性滚动过程，对惯性滚动过程中的链式效果有间接影响。</p>     <p><strong>元服务API：</strong> 从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力：</strong> SystemCapability.ArkUI.ArkUI.Full</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.25.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.25.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.25.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.25.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">value</td>         <td class="cellrowborder" width="25%">number | <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-types#resource">Resource</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">          <p>摩擦系数。</p>          <p>默认值：非可穿戴设备为0.6，可穿戴设备为0.9。</p>          <p>从API version 11开始，非可穿戴设备默认值为0.7。</p>          <p>从API version 12开始，非可穿戴设备默认值为0.75。</p>          <p>取值范围：(0, +∞)，设置为小于等于0的值时，按默认值处理。</p></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 637px;">     <h3 id="cachedcount11" device-type="phone,2in1,tablet,wearable,tv">cachedCount<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="cachedcount11" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>cachedCount(value: number)</p>     <p>设置预加载的FlowItem数量。</p>     <p>只在<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-rendering-control-lazyforeach" target="_blank">LazyForEach</a>和开启了<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-rendering-control-repeat#virtualscroll">virtualScroll</a>开关的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-new-rendering-control-repeat" target="_blank">Repeat</a>中生效，超出显示及缓存范围的FlowItem会被释放。</p>     <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力：</strong> SystemCapability.ArkUI.ArkUI.Full</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.26.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.26.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.26.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.26.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">value</td>         <td class="cellrowborder" width="25%">number</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">          <p>预加载的FlowItem的数量。</p>          <p>默认值：根据屏幕内显示的节点个数设置，最大值为16。</p>          <p>取值范围：[0, +∞)，设置为小于0的值时，按1处理。</p></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 850px;">     <h3 id="cachedcount14" device-type="phone,2in1,tablet,wearable,tv">cachedCount<sup>14+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="cachedcount14" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>cachedCount(count: number, show: boolean)</p>     <p>设置预加载的FlowItem数量，并配置是否显示预加载节点。</p>     <p>配合<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-universal-attributes-sharp-clipping#clip12">clip</a>或<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-scrollable-common#clipcontent14">clipContent</a>属性可以显示出预加载节点。</p>     <p>只在<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-rendering-control-lazyforeach" target="_blank">LazyForEach</a>和开启了virtualScroll开关的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-new-rendering-control-repeat" target="_blank">Repeat</a>中生效，超出显示及缓存范围的FlowItem会被释放。</p>     <p><strong>元服务API：</strong> 从API version 14开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力：</strong> SystemCapability.ArkUI.ArkUI.Full</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.27.9.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.27.9.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.27.9.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.27.9.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">count</td>         <td class="cellrowborder" width="25%">number</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">          <p>预加载的FlowItem的数量。</p>          <p>默认值：根据屏幕内显示的节点个数设置，最大值为16。</p>          <p>取值范围：[0, +∞)，设置为小于0的值时，按1处理。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="25%">show</td>         <td class="cellrowborder" width="25%">boolean</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">          <p>被预加载的FlowItem是否需要显示。设置为true时显示预加载的FlowItem，设置为false时不显示预加载的FlowItem。</p>          <p>默认值：false</p></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 733px;">     <h3 id="syncload20" device-type="phone,2in1,tablet,wearable,tv">syncLoad<sup>20+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="syncload20" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>syncLoad(enable: boolean)</p>     <p>设置是否同步加载WaterFlow区域内所有子组件。</p>     <p><strong>元服务API：</strong> 从API version 20开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力：</strong> SystemCapability.ArkUI.ArkUI.Full</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.28.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.28.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.28.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.28.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">enable</td>         <td class="cellrowborder" width="25%">boolean</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">          <p>是否同步加载WaterFlow区域内所有子组件。</p>          <p>true表示同步加载，false表示异步加载。</p>          <p>默认值：true。</p>          <p><strong>说明：</strong></p>          <p>设置为false时，在首次显示、不带动画<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-scroll#scrolltoindex">scrollToIndex</a>跳转场景，若当帧布局耗时超过50ms，会将WaterFlow区域内尚未布局的子组件延后到下一帧进行布局。</p></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 182px;">     <h2 id="事件" device-type="phone,2in1,tablet,wearable,tv">事件<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="事件" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>除支持<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-component-general-events">通用事件</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-scrollable-common#事件">滚动组件通用事件</a>外，还支持以下事件：</p>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 477px;">     <h3 id="onreachstart" device-type="phone,2in1,tablet,wearable,tv" class="firsth2">onReachStart<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onreachstart" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>onReachStart(event: () =&gt; void)</p>     <p>瀑布流内容到达起始位置时触发。</p>     <p><strong>元服务API：</strong> 从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力：</strong> SystemCapability.ArkUI.ArkUI.Full</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.30.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.30.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.30.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.30.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">event</td>         <td class="cellrowborder" width="25%">() =&gt; void</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">瀑布流内容到达起始位置时触发的回调。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 493px;">     <h3 id="onreachend" device-type="phone,2in1,tablet,wearable,tv">onReachEnd<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onreachend" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>onReachEnd(event: () =&gt; void)</p>     <p>瀑布流内容到达末尾位置时触发。</p>     <p><strong>元服务API：</strong> 从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力：</strong> SystemCapability.ArkUI.ArkUI.Full</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.31.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.31.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.31.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.31.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">event</td>         <td class="cellrowborder" width="25%">() =&gt; void</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">瀑布流内容到达末尾位置时触发的回调。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 837px;">     <h3 id="onscrollframebegin10" device-type="phone,2in1,tablet,wearable,tv">onScrollFrameBegin<sup>10+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onscrollframebegin10" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>onScrollFrameBegin(event: OnScrollFrameBeginCallback)</p>     <p>该接口回调时，事件参数传入即将发生的滑动量，事件处理函数中可根据应用场景计算实际需要的滑动量并作为事件处理函数的返回值返回，瀑布流将按照返回值的实际滑动量进行滑动。</p>     <p>满足以下任一条件时触发该事件：</p>     <ol>      <li>用户交互（如手指滑动、键鼠操作等）触发滚动。</li>      <li>WaterFlow惯性滚动。</li>      <li>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-scroll#fling12">fling</a>接口触发滚动。</li>     </ol>     <p>不触发该事件的条件：</p>     <ol>      <li>调用除<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-scroll#fling12">fling</a>接口外的其他滚动控制接口。</li>      <li>越界回弹。</li>      <li>拖动滚动条。</li>     </ol>     <p><strong>元服务API：</strong> 从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力：</strong> SystemCapability.ArkUI.ArkUI.Full</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.32.11.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.32.11.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.32.11.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.32.11.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">event</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-scroll#onscrollframebegincallback18">OnScrollFrameBeginCallback</a></td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">每帧滚动开始回调函数。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 1111px;">     <h3 id="onscrollindex11" device-type="phone,2in1,tablet,wearable,tv">onScrollIndex<sup>11+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onscrollindex11" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>onScrollIndex(event: (first: number, last: number) =&gt; void)</p>     <p>当前瀑布流显示的起始位置/终止位置的子组件发生变化时触发。瀑布流初始化时会触发一次。</p>     <p>瀑布流显示区域上第一个子组件/最后一个组件的索引值有变化就会触发。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>从API version 20开始，该接口支持在<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-universal-attributes-attribute-modifier#attributemodifier">attributeModifier</a>中调用。</p>      </div></div></div>     <p><strong>元服务API：</strong> 从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力：</strong> SystemCapability.ArkUI.ArkUI.Full</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.33.9.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.33.9.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.33.9.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.33.9.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">first</td>         <td class="cellrowborder" width="25%">number</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">          <p>当前显示的瀑布流起始位置的索引值。</p>          <p>取值范围：[0, 子节点总数-1]</p></td>        </tr>        <tr>         <td class="cellrowborder" width="25%">last</td>         <td class="cellrowborder" width="25%">number</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">          <p>当前显示的瀑布流终止位置的索引值。</p>          <p>取值范围：[0, 子节点总数-1]</p></td>        </tr>             </tbody></table></div>     </div>     <p>通过last参数可以判断是否“继续加载数据”，参考<a href="/consumer/cn/doc/harmonyos-references/ts-container-waterflow#示例3使用分组">示例3使用分组</a>中“即将触底时提前增加数据”的处理逻辑。</p>     <p>当WaterFlow列表为空时，使用不同的WaterFlowOptions参数会导致onScrollIndex事件的返回值有所不同。具体差异请参见下表：</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.33.12.1.5.1.1" width="25%">layoutMode</th>         <th align="left" class="cellrowborder" id="mcps1.3.33.12.1.5.1.2" width="25%">sections</th>         <th align="left" class="cellrowborder" id="mcps1.3.33.12.1.5.1.3" width="25%">first</th>         <th align="left" class="cellrowborder" id="mcps1.3.33.12.1.5.1.4" width="25%">last</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">ALWAYS_TOP_DOWN</td>         <td class="cellrowborder" width="25%">无</td>         <td class="cellrowborder" width="25%">0</td>         <td class="cellrowborder" width="25%">0</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">ALWAYS_TOP_DOWN</td>         <td class="cellrowborder" width="25%">有</td>         <td class="cellrowborder" width="25%">0</td>         <td class="cellrowborder" width="25%">-1</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">SLIDING_WINDOW</td>         <td class="cellrowborder" width="25%">可选</td>         <td class="cellrowborder" width="25%">1000000</td>         <td class="cellrowborder" width="25%">-1</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 230px;">     <h2 id="uiwaterflowevent19" device-type="phone,2in1,tablet,wearable,tv">UIWaterFlowEvent<sup>19+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="uiwaterflowevent19" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>frameNode中<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-arkui-framenode#geteventwaterflow19">getEvent('WaterFlow')</a>方法的返回值，可用于给WaterFlow节点设置滚动事件。</p>     <p>UIWaterFlowEvent继承于<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-scrollable-common#uiscrollablecommonevent19">UIScrollableCommonEvent</a>。</p>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 525px;">     <h3 id="setonwillscroll19" device-type="phone,2in1,tablet,wearable,tv" class="firsth2">setOnWillScroll<sup>19+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="setonwillscroll19" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>setOnWillScroll(callback: OnWillScrollCallback | undefined): void</p>     <p>设置<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-scrollable-common#onwillscroll12">onWillScroll</a>事件的回调。</p>     <p>方法入参为undefined时，会重置事件回调。</p>     <p><strong>元服务API：</strong> 从API version 19开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力：</strong> SystemCapability.ArkUI.ArkUI.Full</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.35.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.35.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.35.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.35.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-scrollable-common#onwillscrollcallback12">OnWillScrollCallback</a> | undefined</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">onWillScroll事件的回调函数。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 541px;">     <h3 id="setondidscroll19" device-type="phone,2in1,tablet,wearable,tv">setOnDidScroll<sup>19+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="setondidscroll19" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>setOnDidScroll(callback: OnScrollCallback | undefined): void</p>     <p>设置<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-scrollable-common#ondidscroll12">onDidScroll</a>事件的回调。</p>     <p>方法入参为undefined时，会重置事件回调。</p>     <p><strong>元服务API：</strong> 从API version 19开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力：</strong> SystemCapability.ArkUI.ArkUI.Full</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.36.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.36.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.36.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.36.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-scrollable-common#onscrollcallback12">OnScrollCallback</a> | undefined</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">onDidScroll事件的回调函数。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 541px;">     <h3 id="setonscrollindex19" device-type="phone,2in1,tablet,wearable,tv">setOnScrollIndex<sup>19+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="setonscrollindex19" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>setOnScrollIndex(callback: OnWaterFlowScrollIndexCallback | undefined): void</p>     <p>设置<a href="/consumer/cn/doc/harmonyos-references/ts-container-waterflow#onscrollindex11">onScrollIndex</a>事件的回调。</p>     <p>方法入参为undefined时，会重置事件回调。</p>     <p><strong>元服务API：</strong> 从API version 19开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力：</strong> SystemCapability.ArkUI.ArkUI.Full</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.37.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.37.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.37.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.37.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">callback</td>         <td class="cellrowborder" width="25%"><a href="/consumer/cn/doc/harmonyos-references/ts-container-waterflow#onwaterflowscrollindexcallback19">OnWaterFlowScrollIndexCallback</a> | undefined</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">onScrollIndex事件的回调函数。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 570px;">     <h2 id="onwaterflowscrollindexcallback19" device-type="phone,2in1,tablet,wearable,tv">OnWaterFlowScrollIndexCallback<sup>19+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="onwaterflowscrollindexcallback19" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>type OnWaterFlowScrollIndexCallback = (first: number, last: number) =&gt; void</p>     <p>WaterFlow组件可见区域item变化事件的回调类型。</p>     <p><strong>元服务API：</strong> 从API version 19开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力：</strong> SystemCapability.ArkUI.ArkUI.Full</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.38.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.38.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.38.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.38.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">first</td>         <td class="cellrowborder" width="25%">number</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">当前显示的瀑布流起始位置的索引值。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">last</td>         <td class="cellrowborder" width="25%">number</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">当前显示的瀑布流终止位置的索引值。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 146px;">     <h2 id="示例" device-type="phone,2in1,tablet,wearable,tv">示例<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="示例" tips="复制节点链接"></i></h2>         <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div></div>    <div class="tiledSection" style="contain-intrinsic-size: auto 7729px;">     <h3 id="示例1使用基本瀑布流" class="firsth2">示例1（使用基本瀑布流）<i class="anchor-icon anchor-icon-link" anchorid="示例1使用基本瀑布流" tips="复制节点链接"></i></h3>          <p>该示例展示了WaterFlow组件数据加载处理、属性设置和事件回调等基本使用场景。</p>     <p>WaterFlowDataSource实现了LazyForEach数据源接口<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-rendering-control-lazyforeach#idatasource">IDataSource</a>，用于通过LazyForEach给WaterFlow提供子组件。</p>     <div _ngcontent-fiw-c106="" class="highlight-div"><div _ngcontent-fiw-c106="" class="highlight-div-header"><div _ngcontent-fiw-c106="" class="highlight-div-header-left"><div _ngcontent-fiw-c106="" class="handle-button expand-button"><div _ngcontent-fiw-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fiw-c106="" class="highlight-div-header-right"><div _ngcontent-fiw-c106="" class="handle-button ai-button"></div><div _ngcontent-fiw-c106="" class="handle-button line-button"><div _ngcontent-fiw-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fiw-c106="" class="handle-button theme-button"><div _ngcontent-fiw-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fiw-c106="" class="handle-button copy-button"><div _ngcontent-fiw-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fiw-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// WaterFlowDataSource.ets</span></li><li>
</li><li><span class="hljs-comment">// 实现IDataSource接口的对象，用于瀑布流组件加载数据</span></li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WaterFlowDataSource</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">IDataSource</span> {</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">dataArray</span>: <span class="hljs-built_in">number</span>[] = [];</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">listeners</span>: <span class="hljs-title class_">DataChangeListener</span>[] = [];</li><li>
</li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100</span>; i++) {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">dataArray</span>.<span class="hljs-title function_">push</span>(i);</li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-comment">// 获取索引对应的数据</span></li><li>  <span class="hljs-keyword">public</span> <span class="hljs-title function_">getData</span>(<span class="hljs-attr">index</span>: <span class="hljs-built_in">number</span>): <span class="hljs-built_in">number</span> {</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">dataArray</span>[index];</li><li>  }</li><li>
</li><li>  <span class="hljs-comment">// 通知控制器数据重新加载</span></li><li>  <span class="hljs-title function_">notifyDataReload</span>(): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">listener</span> =&gt;</span> {</li><li>      listener.<span class="hljs-title function_">onDataReloaded</span>();</li><li>    })</li><li>  }</li><li>
</li><li>  <span class="hljs-comment">// 通知控制器数据增加</span></li><li>  <span class="hljs-title function_">notifyDataAdd</span>(<span class="hljs-attr">index</span>: <span class="hljs-built_in">number</span>): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">listener</span> =&gt;</span> {</li><li>      listener.<span class="hljs-title function_">onDataAdd</span>(index);</li><li>    })</li><li>  }</li><li>
</li><li>  <span class="hljs-comment">// 通知控制器数据变化</span></li><li>  <span class="hljs-title function_">notifyDataChange</span>(<span class="hljs-attr">index</span>: <span class="hljs-built_in">number</span>): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">listener</span> =&gt;</span> {</li><li>      listener.<span class="hljs-title function_">onDataChange</span>(index);</li><li>    })</li><li>  }</li><li>
</li><li>  <span class="hljs-comment">// 通知控制器数据删除</span></li><li>  <span class="hljs-title function_">notifyDataDelete</span>(<span class="hljs-attr">index</span>: <span class="hljs-built_in">number</span>): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">listener</span> =&gt;</span> {</li><li>      listener.<span class="hljs-title function_">onDataDelete</span>(index);</li><li>    })</li><li>  }</li><li>
</li><li>  <span class="hljs-comment">// 通知控制器数据位置变化</span></li><li>  <span class="hljs-title function_">notifyDataMove</span>(<span class="hljs-attr">from</span>: <span class="hljs-built_in">number</span>, <span class="hljs-attr">to</span>: <span class="hljs-built_in">number</span>): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">listener</span> =&gt;</span> {</li><li>      listener.<span class="hljs-title function_">onDataMove</span>(<span class="hljs-keyword">from</span>, to);</li><li>    })</li><li>  }</li><li>
</li><li>  <span class="hljs-comment">//通知控制器数据批量修改</span></li><li>  <span class="hljs-title function_">notifyDatasetChange</span>(<span class="hljs-attr">operations</span>: <span class="hljs-title class_">DataOperation</span>[]): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">listener</span> =&gt;</span> {</li><li>      listener.<span class="hljs-title function_">onDatasetChange</span>(operations);</li><li>    })</li><li>  }</li><li>
</li><li>  <span class="hljs-comment">// 获取数据总数</span></li><li>  <span class="hljs-keyword">public</span> <span class="hljs-title function_">totalCount</span>(): <span class="hljs-built_in">number</span> {</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">dataArray</span>.<span class="hljs-property">length</span>;</li><li>  }</li><li>
</li><li>  <span class="hljs-comment">// 注册改变数据的控制器</span></li><li>  <span class="hljs-title function_">registerDataChangeListener</span>(<span class="hljs-attr">listener</span>: <span class="hljs-title class_">DataChangeListener</span>): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>.<span class="hljs-title function_">indexOf</span>(listener) &lt; <span class="hljs-number">0</span>) {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>.<span class="hljs-title function_">push</span>(listener);</li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-comment">// 注销改变数据的控制器</span></li><li>  <span class="hljs-title function_">unregisterDataChangeListener</span>(<span class="hljs-attr">listener</span>: <span class="hljs-title class_">DataChangeListener</span>): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-keyword">const</span> pos = <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>.<span class="hljs-title function_">indexOf</span>(listener);</li><li>    <span class="hljs-keyword">if</span> (pos &gt;= <span class="hljs-number">0</span>) {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">listeners</span>.<span class="hljs-title function_">splice</span>(pos, <span class="hljs-number">1</span>);</li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-comment">// 增加数据</span></li><li>  <span class="hljs-keyword">public</span> <span class="hljs-title function_">add1stItem</span>(): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">dataArray</span>.<span class="hljs-title function_">splice</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">dataArray</span>.<span class="hljs-property">length</span>);</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">notifyDataAdd</span>(<span class="hljs-number">0</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-comment">// 在数据尾部增加一个元素</span></li><li>  <span class="hljs-keyword">public</span> <span class="hljs-title function_">addLastItem</span>(): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">dataArray</span>.<span class="hljs-title function_">splice</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">dataArray</span>.<span class="hljs-property">length</span>, <span class="hljs-number">0</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">dataArray</span>.<span class="hljs-property">length</span>);</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">notifyDataAdd</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">dataArray</span>.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-comment">// 在指定索引位置增加一个元素</span></li><li>  <span class="hljs-keyword">public</span> <span class="hljs-title function_">addItem</span>(<span class="hljs-attr">index</span>: <span class="hljs-built_in">number</span>): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">dataArray</span>.<span class="hljs-title function_">splice</span>(index, <span class="hljs-number">0</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">dataArray</span>.<span class="hljs-property">length</span>);</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">notifyDataAdd</span>(index);</li><li>  }</li><li>
</li><li>  <span class="hljs-comment">// 删除第一个元素</span></li><li>  <span class="hljs-keyword">public</span> <span class="hljs-title function_">delete1stItem</span>(): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">dataArray</span>.<span class="hljs-title function_">splice</span>(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>);</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">notifyDataDelete</span>(<span class="hljs-number">0</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-comment">// 删除第二个元素</span></li><li>  <span class="hljs-keyword">public</span> <span class="hljs-title function_">delete2ndItem</span>(): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">dataArray</span>.<span class="hljs-title function_">splice</span>(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>);</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">notifyDataDelete</span>(<span class="hljs-number">1</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-comment">// 删除最后一个元素</span></li><li>  <span class="hljs-keyword">public</span> <span class="hljs-title function_">deleteLastItem</span>(): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">dataArray</span>.<span class="hljs-title function_">splice</span>(-<span class="hljs-number">1</span>, <span class="hljs-number">1</span>);</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">notifyDataDelete</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">dataArray</span>.<span class="hljs-property">length</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-comment">// 在指定索引位置删除一个元素</span></li><li>  <span class="hljs-keyword">public</span> <span class="hljs-title function_">deleteItem</span>(<span class="hljs-attr">index</span>: <span class="hljs-built_in">number</span>): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">dataArray</span>.<span class="hljs-title function_">splice</span>(index, <span class="hljs-number">1</span>);</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">notifyDataDelete</span>(index);</li><li>  }</li><li>
</li><li>  <span class="hljs-comment">// 重新加载数据</span></li><li>  <span class="hljs-keyword">public</span> <span class="hljs-title function_">reload</span>(): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">dataArray</span>.<span class="hljs-title function_">splice</span>(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>);</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">dataArray</span>.<span class="hljs-title function_">splice</span>(<span class="hljs-number">3</span>, <span class="hljs-number">2</span>);</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">notifyDataReload</span>();</li><li>  }</li><li>
</li><li>  <span class="hljs-comment">// 在数据尾部增加count个元素</span></li><li>  <span class="hljs-keyword">public</span> <span class="hljs-title function_">addNewItems</span>(<span class="hljs-attr">count</span>: <span class="hljs-built_in">number</span>): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-keyword">let</span> len = <span class="hljs-variable language_">this</span>.<span class="hljs-property">dataArray</span>.<span class="hljs-property">length</span>;</li><li>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; count; i++) {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">dataArray</span>.<span class="hljs-title function_">push</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">dataArray</span>[len - <span class="hljs-number">1</span>] + i + <span class="hljs-number">1</span>);</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">notifyDataAdd</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">dataArray</span>.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>);</li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-comment">// 刷新所有元素</span></li><li>  <span class="hljs-keyword">public</span> <span class="hljs-title function_">refreshItems</span>(): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">newDataArray</span>: <span class="hljs-built_in">number</span>[] = [];</li><li>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100</span>; i++) {</li><li>      newDataArray.<span class="hljs-title function_">push</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">dataArray</span>[<span class="hljs-number">0</span>] + i + <span class="hljs-number">1000</span>);</li><li>    }</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">dataArray</span> = newDataArray;</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">notifyDataReload</span>();</li><li>  }</li><li>}</li></ol></pre></div></div>     <div _ngcontent-fiw-c106="" class="highlight-div"><div _ngcontent-fiw-c106="" class="highlight-div-header"><div _ngcontent-fiw-c106="" class="highlight-div-header-left"><div _ngcontent-fiw-c106="" class="handle-button expand-button"><div _ngcontent-fiw-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fiw-c106="" class="highlight-div-header-right"><div _ngcontent-fiw-c106="" class="handle-button ai-button"></div><div _ngcontent-fiw-c106="" class="handle-button line-button"><div _ngcontent-fiw-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fiw-c106="" class="handle-button theme-button"><div _ngcontent-fiw-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fiw-c106="" class="handle-button copy-button"><div _ngcontent-fiw-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fiw-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// Index.ets</span></li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">WaterFlowDataSource</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./WaterFlowDataSource'</span>;</li><li>
</li><li><span class="hljs-keyword">enum</span> <span class="hljs-title class_">FooterState</span> {</li><li>  <span class="hljs-title class_">Loading</span> = <span class="hljs-number">0</span>,</li><li>  <span class="hljs-title class_">End</span> = <span class="hljs-number">1</span></li><li>}</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">WaterFlowDemo</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">minSize</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">80</span>;</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">maxSize</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">180</span>;</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">colors</span>: <span class="hljs-built_in">number</span>[] = [<span class="hljs-number">0xFFC0CB</span>, <span class="hljs-number">0xDA70D6</span>, <span class="hljs-number">0x6B8E23</span>, <span class="hljs-number">0x6A5ACD</span>, <span class="hljs-number">0x00FFFF</span>, <span class="hljs-number">0x00FF7F</span>];</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">footerState</span>: <span class="hljs-title class_">FooterState</span> = <span class="hljs-title class_">FooterState</span>.<span class="hljs-property">Loading</span>;</li><li>  <span class="hljs-attr">scroller</span>: <span class="hljs-title class_">Scroller</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scroller</span>();</li><li>  <span class="hljs-attr">dataSource</span>: <span class="hljs-title class_">WaterFlowDataSource</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WaterFlowDataSource</span>();</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">itemWidthArray</span>: <span class="hljs-built_in">number</span>[] = [];</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">itemHeightArray</span>: <span class="hljs-built_in">number</span>[] = [];</li><li>
</li><li>  <span class="hljs-comment">// 计算FlowItem宽/高</span></li><li>  <span class="hljs-title function_">getSize</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">let</span> ret = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-variable language_">this</span>.<span class="hljs-property">maxSize</span>);</li><li>    <span class="hljs-keyword">return</span> (ret &gt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">minSize</span> ? ret : <span class="hljs-variable language_">this</span>.<span class="hljs-property">minSize</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-comment">// 设置FlowItem的宽/高数组</span></li><li>  <span class="hljs-title function_">setItemSizeArray</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100</span>; i++) {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">itemWidthArray</span>.<span class="hljs-title function_">push</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getSize</span>());</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">itemHeightArray</span>.<span class="hljs-title function_">push</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getSize</span>());</li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-comment">// 组件生命周期：在组件即将出现时初始化尺寸数组</span></li><li>  <span class="hljs-title function_">aboutToAppear</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setItemSizeArray</span>();</li><li>  }</li><li>
</li><li>  <span class="hljs-meta">@Builder</span></li><li>  <span class="hljs-title function_">itemFoot</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-comment">// 注意：不要直接用IfElse节点作为footer的根节点</span></li><li>    <span class="hljs-comment">// 必须在外面使用(Column/Row/Stack等)容器包裹，确保布局正确</span></li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">footerState</span> == <span class="hljs-title class_">FooterState</span>.<span class="hljs-property">Loading</span>) {</li><li>        <span class="hljs-title class_">Text</span>(<span class="hljs-string">`加载中...`</span>)</li><li>          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">10</span>)</li><li>          .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Red</span>)</li><li>          .<span class="hljs-title function_">width</span>(<span class="hljs-number">50</span>)</li><li>          .<span class="hljs-title function_">height</span>(<span class="hljs-number">50</span>)</li><li>          .<span class="hljs-title function_">align</span>(<span class="hljs-title class_">Alignment</span>.<span class="hljs-property">Center</span>)</li><li>          .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">2</span> })</li><li>      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">footerState</span> == <span class="hljs-title class_">FooterState</span>.<span class="hljs-property">End</span>) {</li><li>        <span class="hljs-title class_">Text</span>(<span class="hljs-string">`到底啦...`</span>)</li><li>          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">10</span>)</li><li>          .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Red</span>)</li><li>          .<span class="hljs-title function_">width</span>(<span class="hljs-number">50</span>)</li><li>          .<span class="hljs-title function_">height</span>(<span class="hljs-number">50</span>)</li><li>          .<span class="hljs-title function_">align</span>(<span class="hljs-title class_">Alignment</span>.<span class="hljs-property">Center</span>)</li><li>          .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">2</span> })</li><li>      } <span class="hljs-keyword">else</span> {</li><li>        <span class="hljs-title class_">Text</span>(<span class="hljs-string">`Footer`</span>)</li><li>          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">10</span>)</li><li>          .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Red</span>)</li><li>          .<span class="hljs-title function_">width</span>(<span class="hljs-number">50</span>)</li><li>          .<span class="hljs-title function_">height</span>(<span class="hljs-number">50</span>)</li><li>          .<span class="hljs-title function_">align</span>(<span class="hljs-title class_">Alignment</span>.<span class="hljs-property">Center</span>)</li><li>          .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">2</span> })</li><li>      }</li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>({ <span class="hljs-attr">space</span>: <span class="hljs-number">2</span> }) {</li><li>      <span class="hljs-title class_">WaterFlow</span>({ <span class="hljs-attr">footer</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">itemFoot</span>() }) {</li><li>        <span class="hljs-title class_">LazyForEach</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">dataSource</span>, <span class="hljs-function">(<span class="hljs-params">item: <span class="hljs-built_in">number</span></span>) =&gt;</span> {</li><li>          <span class="hljs-title class_">FlowItem</span>() {</li><li>            <span class="hljs-title class_">Column</span>() {</li><li>              <span class="hljs-title class_">Text</span>(<span class="hljs-string">'N'</span> + item).<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">12</span>).<span class="hljs-title function_">height</span>(<span class="hljs-string">'16'</span>)</li><li>              <span class="hljs-comment">// 注意：需要确保对应的jpg文件存在才会正常显示</span></li><li>              <span class="hljs-title class_">Image</span>(<span class="hljs-string">'res/waterFlowTest('</span> + item % <span class="hljs-number">5</span> + <span class="hljs-string">').jpg'</span>)</li><li>                .<span class="hljs-title function_">objectFit</span>(<span class="hljs-title class_">ImageFit</span>.<span class="hljs-property">Fill</span>)</li><li>                .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>                .<span class="hljs-title function_">layoutWeight</span>(<span class="hljs-number">1</span>)</li><li>            }</li><li>          }</li><li>          .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>          .<span class="hljs-title function_">height</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">itemHeightArray</span>[item % <span class="hljs-number">100</span>])</li><li>          .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">colors</span>[item % <span class="hljs-variable language_">this</span>.<span class="hljs-property">colors</span>.<span class="hljs-property">length</span>])</li><li>        }, <span class="hljs-function">(<span class="hljs-params">item: <span class="hljs-built_in">string</span></span>) =&gt;</span> item)</li><li>      }</li><li>      .<span class="hljs-title function_">columnsTemplate</span>(<span class="hljs-string">'1fr 1fr'</span>)    <span class="hljs-comment">// 设置2列等宽布局</span></li><li>      .<span class="hljs-title function_">columnsGap</span>(<span class="hljs-number">10</span>)</li><li>      .<span class="hljs-title function_">rowsGap</span>(<span class="hljs-number">5</span>)</li><li>      .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-number">0xFAEEE0</span>)</li><li>      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>      .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>      .<span class="hljs-title function_">itemConstraintSize</span>({<span class="hljs-attr">minWidth</span>:<span class="hljs-number">80</span>,<span class="hljs-attr">maxWidth</span>:<span class="hljs-number">180</span>,<span class="hljs-attr">minHeight</span>:<span class="hljs-number">80</span>,<span class="hljs-attr">maxHeight</span>:<span class="hljs-number">180</span>})</li><li>      <span class="hljs-comment">// 触底加载数据：滚动到底部时触发分页加载</span></li><li>      .<span class="hljs-title function_">onReachEnd</span>(<span class="hljs-function">() =&gt;</span> {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'onReachEnd'</span>)</li><li>
</li><li>        <span class="hljs-comment">// 模拟分页加载：当数据超过200条时停止加载</span></li><li>        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">dataSource</span>.<span class="hljs-title function_">totalCount</span>() &gt; <span class="hljs-number">200</span>) {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">footerState</span> = <span class="hljs-title class_">FooterState</span>.<span class="hljs-property">End</span>;</li><li>          <span class="hljs-keyword">return</span>;</li><li>        }</li><li>        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100</span>; i++) {</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">dataSource</span>.<span class="hljs-title function_">addLastItem</span>();</li><li>          }</li><li>        }, <span class="hljs-number">1000</span>)</li><li>      })</li><li>      .<span class="hljs-title function_">onReachStart</span>(<span class="hljs-function">() =&gt;</span> {</li><li>        <span class="hljs-comment">// 滚动到顶部时触发</span></li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'waterFlow reach start'</span>);</li><li>      })</li><li>      .<span class="hljs-title function_">onScrollStart</span>(<span class="hljs-function">() =&gt;</span> {</li><li>        <span class="hljs-comment">// 开始滚动时触发</span></li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'waterFlow scroll start'</span>);</li><li>      })</li><li>      .<span class="hljs-title function_">onScrollStop</span>(<span class="hljs-function">() =&gt;</span> {</li><li>        <span class="hljs-comment">// 停止滚动时触发</span></li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'waterFlow scroll stop'</span>);</li><li>      })</li><li>      .<span class="hljs-title function_">onScrollFrameBegin</span>(<span class="hljs-function">(<span class="hljs-params">offset: <span class="hljs-built_in">number</span>, state: ScrollState</span>) =&gt;</span> {</li><li>        <span class="hljs-comment">// 滚动帧开始时触发：可以控制滚动行为</span></li><li>        <span class="hljs-comment">// offset：滚动偏移量，state：滚动状态</span></li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'waterFlow scrollFrameBegin offset: '</span> + offset + <span class="hljs-string">' state: '</span> + state.<span class="hljs-title function_">toString</span>());</li><li>        <span class="hljs-keyword">return</span> { <span class="hljs-attr">offsetRemain</span>: offset };  <span class="hljs-comment">// 返回开发者期望的实际滚动偏移量</span></li><li>      })</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>     <p><span><img originheight="629" originwidth="318" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211115648.99251744217241424180458175283651:50001231000000:2800:4738C0F7808B68E3FA2C7F097DF918004C79D974CC1CDB0FA09EA6D81779E36C.gif" width="318" height="629"></span></p>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 2433px;">     <h3 id="示例2自动计算列数">示例2（自动计算列数）<i class="anchor-icon anchor-icon-link" anchorid="示例2自动计算列数" tips="复制节点链接"></i></h3>          <p>该示例通过auto-fill实现了自动计算列数的效果。</p>     <p>WaterFlowDataSource说明及完整代码参考<a href="/consumer/cn/doc/harmonyos-references/ts-container-waterflow#示例1使用基本瀑布流">示例1使用基本瀑布流</a>。</p>     <div _ngcontent-fiw-c106="" class="highlight-div"><div _ngcontent-fiw-c106="" class="highlight-div-header"><div _ngcontent-fiw-c106="" class="highlight-div-header-left"><div _ngcontent-fiw-c106="" class="handle-button expand-button"><div _ngcontent-fiw-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fiw-c106="" class="highlight-div-header-right"><div _ngcontent-fiw-c106="" class="handle-button ai-button"></div><div _ngcontent-fiw-c106="" class="handle-button line-button"><div _ngcontent-fiw-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fiw-c106="" class="handle-button theme-button"><div _ngcontent-fiw-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fiw-c106="" class="handle-button copy-button"><div _ngcontent-fiw-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fiw-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// Index.ets</span></li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">WaterFlowDataSource</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./WaterFlowDataSource'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">WaterFlowDemo</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">minSize</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">80</span>;</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">maxSize</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">180</span>;</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">colors</span>: <span class="hljs-built_in">number</span>[] = [<span class="hljs-number">0xFFC0CB</span>, <span class="hljs-number">0xDA70D6</span>, <span class="hljs-number">0x6B8E23</span>, <span class="hljs-number">0x6A5ACD</span>, <span class="hljs-number">0x00FFFF</span>, <span class="hljs-number">0x00FF7F</span>];</li><li>  <span class="hljs-attr">dataSource</span>: <span class="hljs-title class_">WaterFlowDataSource</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WaterFlowDataSource</span>();</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">itemWidthArray</span>: <span class="hljs-built_in">number</span>[] = [];</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">itemHeightArray</span>: <span class="hljs-built_in">number</span>[] = [];</li><li>
</li><li>  <span class="hljs-comment">// 计算FlowItem宽/高</span></li><li>  <span class="hljs-title function_">getSize</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">let</span> ret = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-variable language_">this</span>.<span class="hljs-property">maxSize</span>);</li><li>    <span class="hljs-keyword">return</span> (ret &gt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">minSize</span> ? ret : <span class="hljs-variable language_">this</span>.<span class="hljs-property">minSize</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-comment">// 设置FlowItem宽/高数组</span></li><li>  <span class="hljs-title function_">setItemSizeArray</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100</span>; i++) {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">itemWidthArray</span>.<span class="hljs-title function_">push</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getSize</span>());</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">itemHeightArray</span>.<span class="hljs-title function_">push</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getSize</span>());</li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-comment">// 组件生命周期：在组件即将出现时初始化尺寸数组</span></li><li>  <span class="hljs-title function_">aboutToAppear</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setItemSizeArray</span>();</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>({ <span class="hljs-attr">space</span>: <span class="hljs-number">2</span> }) {</li><li>      <span class="hljs-title class_">WaterFlow</span>() {</li><li>        <span class="hljs-title class_">LazyForEach</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">dataSource</span>, <span class="hljs-function">(<span class="hljs-params">item: <span class="hljs-built_in">number</span></span>) =&gt;</span> {</li><li>          <span class="hljs-title class_">FlowItem</span>() {</li><li>            <span class="hljs-title class_">Column</span>() {</li><li>              <span class="hljs-title class_">Text</span>(<span class="hljs-string">'N'</span> + item).<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">12</span>).<span class="hljs-title function_">height</span>(<span class="hljs-string">'16'</span>)</li><li>              <span class="hljs-comment">// 存在对应的jpg文件才会显示图片</span></li><li>              <span class="hljs-title class_">Image</span>(<span class="hljs-string">'res/waterFlowTest('</span> + item % <span class="hljs-number">5</span> + <span class="hljs-string">').jpg'</span>)</li><li>            }</li><li>          }</li><li>          .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>          .<span class="hljs-title function_">height</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">itemHeightArray</span>[item % <span class="hljs-number">100</span>])</li><li>          .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">colors</span>[item % <span class="hljs-variable language_">this</span>.<span class="hljs-property">colors</span>.<span class="hljs-property">length</span>])</li><li>        }, <span class="hljs-function">(<span class="hljs-params">item: <span class="hljs-built_in">string</span></span>) =&gt;</span> item)</li><li>      }</li><li>      <span class="hljs-comment">// auto-fill自动计算列数</span></li><li>      <span class="hljs-comment">// 'repeat(auto-fill,80)' 表示：根据容器宽度自动计算能放下多少个80px宽的列</span></li><li>      <span class="hljs-comment">// 例如：容器宽度400px，则自动计算为5列（400÷80=5）</span></li><li>      .<span class="hljs-title function_">columnsTemplate</span>(<span class="hljs-string">'repeat(auto-fill,80)'</span>)</li><li>      .<span class="hljs-title function_">columnsGap</span>(<span class="hljs-number">10</span>)</li><li>      .<span class="hljs-title function_">rowsGap</span>(<span class="hljs-number">5</span>)</li><li>      .<span class="hljs-title function_">padding</span>({<span class="hljs-attr">left</span>:<span class="hljs-number">5</span>})</li><li>      .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-number">0xFAEEE0</span>)</li><li>      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>      .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>     <p><span><img originheight="705" originwidth="355" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211115648.04559185720120343968517925137295:50001231000000:2800:3D3F327D6AF62D9942C2B5F957562A75230B4AD737364450E33343973C1ADA47.png" width="355" height="705"></span></p>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 6715px;">     <h3 id="示例3使用分组">示例3（使用分组）<i class="anchor-icon anchor-icon-link" anchorid="示例3使用分组" tips="复制节点链接"></i></h3>          <p>该示例展示了分组的初始化以及splice、push、update、values、length等接口的不同效果。</p>     <p>如果配合状态管理V2使用，详情见：<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-v1-v2-migration-application-and-others#滑动组件" target="_blank">WaterFlow与makeObserved</a>。</p>     <p>WaterFlowDataSource说明及完整代码参考<a href="/consumer/cn/doc/harmonyos-references/ts-container-waterflow#示例1使用基本瀑布流">示例1使用基本瀑布流</a>。</p>     <div _ngcontent-fiw-c106="" class="highlight-div"><div _ngcontent-fiw-c106="" class="highlight-div-header"><div _ngcontent-fiw-c106="" class="highlight-div-header-left"><div _ngcontent-fiw-c106="" class="handle-button expand-button"><div _ngcontent-fiw-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fiw-c106="" class="highlight-div-header-right"><div _ngcontent-fiw-c106="" class="handle-button ai-button"></div><div _ngcontent-fiw-c106="" class="handle-button line-button"><div _ngcontent-fiw-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fiw-c106="" class="handle-button theme-button"><div _ngcontent-fiw-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fiw-c106="" class="handle-button copy-button"><div _ngcontent-fiw-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fiw-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// Index.ets</span></li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">WaterFlowDataSource</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./WaterFlowDataSource'</span>;</li><li>
</li><li><span class="hljs-comment">// 可复用组件：优化性能，减少组件创建销毁开销</span></li><li><span class="hljs-meta">@Reusable</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">ReusableFlowItem</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">item</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;</li><li>
</li><li>  <span class="hljs-comment">// 组件复用生命周期：从复用缓存中取出时调用</span></li><li>  <span class="hljs-comment">// 用于更新组件状态，显示新的内容</span></li><li>  <span class="hljs-title function_">aboutToReuse</span>(<span class="hljs-params">params: Record&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">number</span>&gt;</span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">item</span> = params.<span class="hljs-property">item</span>;</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Reuse item:'</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">item</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-comment">// 组件生命周期：初始化尺寸数组和分组配置</span></li><li>  <span class="hljs-title function_">aboutToAppear</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'new item:'</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">item</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-comment">// 注意：需要确保对应的jpg文件存在才会正常显示</span></li><li>      <span class="hljs-title class_">Image</span>(<span class="hljs-string">'res/waterFlowTest('</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">item</span> % <span class="hljs-number">5</span> + <span class="hljs-string">').jpg'</span>)</li><li>        .<span class="hljs-title function_">overlay</span>(<span class="hljs-string">'N'</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">item</span>, { <span class="hljs-attr">align</span>: <span class="hljs-title class_">Alignment</span>.<span class="hljs-property">Top</span> })</li><li>        .<span class="hljs-title function_">objectFit</span>(<span class="hljs-title class_">ImageFit</span>.<span class="hljs-property">Fill</span>)</li><li>        .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>        .<span class="hljs-title function_">layoutWeight</span>(<span class="hljs-number">1</span>)</li><li>    }</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">WaterFlowDemo</span> {</li><li>  <span class="hljs-attr">minSize</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">80</span>;</li><li>  <span class="hljs-attr">maxSize</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">180</span>;</li><li>  <span class="hljs-attr">colors</span>: <span class="hljs-built_in">number</span>[] = [<span class="hljs-number">0xFFC0CB</span>, <span class="hljs-number">0xDA70D6</span>, <span class="hljs-number">0x6B8E23</span>, <span class="hljs-number">0x6A5ACD</span>, <span class="hljs-number">0x00FFFF</span>, <span class="hljs-number">0x00FF7F</span>];</li><li>  <span class="hljs-attr">scroller</span>: <span class="hljs-title class_">Scroller</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scroller</span>();</li><li>  <span class="hljs-attr">dataSource</span>: <span class="hljs-title class_">WaterFlowDataSource</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WaterFlowDataSource</span>();</li><li>  <span class="hljs-attr">dataCount</span>: <span class="hljs-built_in">number</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">dataSource</span>.<span class="hljs-title function_">totalCount</span>();</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">itemWidthArray</span>: <span class="hljs-built_in">number</span>[] = [];</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">itemHeightArray</span>: <span class="hljs-built_in">number</span>[] = [];</li><li>  <span class="hljs-comment">// 分组管理：WaterFlow的核心特性，支持不同区域使用不同列数</span></li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">sections</span>: <span class="hljs-title class_">WaterFlowSections</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WaterFlowSections</span>();</li><li>  <span class="hljs-comment">// 分组边距配置：统一的外边距设置</span></li><li>  <span class="hljs-attr">sectionMargin</span>: <span class="hljs-title class_">Margin</span> = { <span class="hljs-attr">top</span>: <span class="hljs-number">10</span>, <span class="hljs-attr">left</span>: <span class="hljs-number">5</span>, <span class="hljs-attr">bottom</span>: <span class="hljs-number">10</span>, <span class="hljs-attr">right</span>: <span class="hljs-number">5</span> };</li><li>
</li><li>  <span class="hljs-attr">oneColumnSection</span>: <span class="hljs-title class_">SectionOptions</span> = {</li><li>    <span class="hljs-attr">itemsCount</span>: <span class="hljs-number">4</span>,                     <span class="hljs-comment">// 该分组包含4个FlowItem</span></li><li>    <span class="hljs-attr">crossCount</span>: <span class="hljs-number">1</span>,                     <span class="hljs-comment">// 使用1列布局</span></li><li>    <span class="hljs-attr">columnsGap</span>: <span class="hljs-string">'5vp'</span>,</li><li>    <span class="hljs-attr">rowsGap</span>: <span class="hljs-number">10</span>,</li><li>    <span class="hljs-attr">margin</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">sectionMargin</span>,</li><li>    <span class="hljs-comment">// 回调函数：动态设置每个item的高度</span></li><li>    <span class="hljs-attr">onGetItemMainSizeByIndex</span>: <span class="hljs-function">(<span class="hljs-params">index: <span class="hljs-built_in">number</span></span>) =&gt;</span> {</li><li>      <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">itemHeightArray</span>[index % <span class="hljs-number">100</span>];</li><li>    }</li><li>  };</li><li>
</li><li>  <span class="hljs-comment">// 第二种分组：双列布局，适合展示列表内容</span></li><li>  <span class="hljs-attr">twoColumnSection</span>: <span class="hljs-title class_">SectionOptions</span> = {</li><li>    <span class="hljs-attr">itemsCount</span>: <span class="hljs-number">2</span>,                     <span class="hljs-comment">// 该分组包含2个FlowItem</span></li><li>    <span class="hljs-attr">crossCount</span>: <span class="hljs-number">2</span>,                     <span class="hljs-comment">// 使用2列布局</span></li><li>    <span class="hljs-comment">// 回调函数：固定高度100px</span></li><li>    <span class="hljs-attr">onGetItemMainSizeByIndex</span>: <span class="hljs-function">(<span class="hljs-params">index: <span class="hljs-built_in">number</span></span>) =&gt;</span> {</li><li>      <span class="hljs-keyword">return</span> <span class="hljs-number">100</span>;</li><li>    }</li><li>  };</li><li>
</li><li>  <span class="hljs-comment">// 最后一个分组：用于处理剩余数据</span></li><li>  <span class="hljs-attr">lastSection</span>: <span class="hljs-title class_">SectionOptions</span> = {</li><li>    <span class="hljs-attr">itemsCount</span>: <span class="hljs-number">20</span>,                    <span class="hljs-comment">// 该分组包含20个FlowItem</span></li><li>    <span class="hljs-attr">crossCount</span>: <span class="hljs-number">2</span>,                     <span class="hljs-comment">// 使用2列布局</span></li><li>    <span class="hljs-comment">// 回调函数：使用随机高度</span></li><li>    <span class="hljs-attr">onGetItemMainSizeByIndex</span>: <span class="hljs-function">(<span class="hljs-params">index: <span class="hljs-built_in">number</span></span>) =&gt;</span> {</li><li>      <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">itemHeightArray</span>[index % <span class="hljs-number">100</span>];</li><li>    }</li><li>  };</li><li>
</li><li>  <span class="hljs-comment">// 计算FlowItem高度</span></li><li>  <span class="hljs-title function_">getSize</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">let</span> ret = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-variable language_">this</span>.<span class="hljs-property">maxSize</span>);</li><li>    <span class="hljs-keyword">return</span> (ret &gt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">minSize</span> ? ret : <span class="hljs-variable language_">this</span>.<span class="hljs-property">minSize</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-comment">// 设置FlowItem的高度数组</span></li><li>  <span class="hljs-title function_">setItemSizeArray</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100</span>; i++) {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">itemHeightArray</span>.<span class="hljs-title function_">push</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getSize</span>());</li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-comment">// 组件生命周期：初始化数据和恢复上次的列数设置</span></li><li>  <span class="hljs-title function_">aboutToAppear</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setItemSizeArray</span>();</li><li>
</li><li>    <span class="hljs-comment">// 初始化瀑布流分组信息：交替使用单列和双列布局</span></li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">sectionOptions</span>: <span class="hljs-title class_">SectionOptions</span>[] = [];</li><li>    <span class="hljs-keyword">let</span> count = <span class="hljs-number">0</span>;                     <span class="hljs-comment">// 已分配的FlowItem数量计数</span></li><li>    <span class="hljs-keyword">let</span> oneOrTwo = <span class="hljs-number">0</span>;                  <span class="hljs-comment">// 用于交替选择分组类型</span></li><li>
</li><li>    <span class="hljs-keyword">while</span> (count &lt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">dataCount</span>) {</li><li>      <span class="hljs-comment">// 剩余数据不足20个时，使用最后一个分组处理</span></li><li>      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">dataCount</span> - count &lt; <span class="hljs-number">20</span>) {</li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">lastSection</span>.<span class="hljs-property">itemsCount</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">dataCount</span> - count;</li><li>        sectionOptions.<span class="hljs-title function_">push</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">lastSection</span>);</li><li>        <span class="hljs-keyword">break</span>;</li><li>      }</li><li>
</li><li>      <span class="hljs-comment">// 交替使用单列和双列布局</span></li><li>      <span class="hljs-keyword">if</span> (oneOrTwo++ % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>) {</li><li>        sectionOptions.<span class="hljs-title function_">push</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">oneColumnSection</span>);</li><li>        count += <span class="hljs-variable language_">this</span>.<span class="hljs-property">oneColumnSection</span>.<span class="hljs-property">itemsCount</span>;</li><li>      } <span class="hljs-keyword">else</span> {</li><li>        sectionOptions.<span class="hljs-title function_">push</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">twoColumnSection</span>);</li><li>        count += <span class="hljs-variable language_">this</span>.<span class="hljs-property">twoColumnSection</span>.<span class="hljs-property">itemsCount</span>;</li><li>      }</li><li>    }</li><li>
</li><li>    <span class="hljs-comment">// 将配置好的分组添加到WaterFlow中</span></li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">sections</span>.<span class="hljs-title function_">splice</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, sectionOptions);</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>({ <span class="hljs-attr">space</span>: <span class="hljs-number">2</span> }) {</li><li>      <span class="hljs-title class_">Row</span>() {</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">'splice'</span>)</li><li>          .<span class="hljs-title function_">height</span>(<span class="hljs-string">'5%'</span>)</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-comment">// 重要：必须保证LazyForEach中数据数量和新分组itemsCount累计总数保持一致</span></li><li>            <span class="hljs-keyword">let</span> <span class="hljs-attr">totalCount</span>: <span class="hljs-built_in">number</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">dataSource</span>.<span class="hljs-title function_">totalCount</span>();</li><li>            <span class="hljs-keyword">let</span> <span class="hljs-attr">newSection</span>: <span class="hljs-title class_">SectionOptions</span> = {</li><li>              <span class="hljs-attr">itemsCount</span>: totalCount,</li><li>              <span class="hljs-attr">crossCount</span>: <span class="hljs-number">2</span>,</li><li>              <span class="hljs-attr">onGetItemMainSizeByIndex</span>: <span class="hljs-function">(<span class="hljs-params">index: <span class="hljs-built_in">number</span></span>) =&gt;</span> {</li><li>                <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">itemHeightArray</span>[index % <span class="hljs-number">100</span>];</li><li>              }</li><li>            };</li><li>            <span class="hljs-keyword">let</span> <span class="hljs-attr">oldLength</span>: <span class="hljs-built_in">number</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">sections</span>.<span class="hljs-title function_">length</span>();</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">sections</span>.<span class="hljs-title function_">splice</span>(<span class="hljs-number">0</span>, oldLength, [newSection]);  <span class="hljs-comment">// 替换所有分组</span></li><li>          })</li><li>          .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">10</span>, <span class="hljs-attr">left</span>: <span class="hljs-number">20</span> })</li><li>
</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">'update'</span>)</li><li>          .<span class="hljs-title function_">height</span>(<span class="hljs-string">'5%'</span>)</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-comment">// 在第一个分组中增加4个FlowItem</span></li><li>            <span class="hljs-comment">// 重要：必须保证数据源和分组itemsCount同步更新</span></li><li>            <span class="hljs-keyword">const</span> <span class="hljs-attr">sections</span>: <span class="hljs-title class_">Array</span>&lt;<span class="hljs-title class_">SectionOptions</span>&gt; = <span class="hljs-variable language_">this</span>.<span class="hljs-property">sections</span>.<span class="hljs-title function_">values</span>();</li><li>            <span class="hljs-keyword">let</span> <span class="hljs-attr">newSection</span>: <span class="hljs-title class_">SectionOptions</span> = sections[<span class="hljs-number">0</span>];</li><li>
</li><li>            <span class="hljs-comment">// 先在数据源中添加4个新数据</span></li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">dataSource</span>.<span class="hljs-title function_">addItem</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">oneColumnSection</span>.<span class="hljs-property">itemsCount</span>);</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">dataSource</span>.<span class="hljs-title function_">addItem</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">oneColumnSection</span>.<span class="hljs-property">itemsCount</span> + <span class="hljs-number">1</span>);</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">dataSource</span>.<span class="hljs-title function_">addItem</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">oneColumnSection</span>.<span class="hljs-property">itemsCount</span> + <span class="hljs-number">2</span>);</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">dataSource</span>.<span class="hljs-title function_">addItem</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">oneColumnSection</span>.<span class="hljs-property">itemsCount</span> + <span class="hljs-number">3</span>);</li><li>
</li><li>            <span class="hljs-comment">// 然后更新分组的itemsCount</span></li><li>            newSection.<span class="hljs-property">itemsCount</span> += <span class="hljs-number">4</span>;</li><li>            <span class="hljs-keyword">const</span> <span class="hljs-attr">result</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">sections</span>.<span class="hljs-title function_">update</span>(<span class="hljs-number">0</span>, newSection);</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'update:'</span> + result);</li><li>          })</li><li>          .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">10</span>, <span class="hljs-attr">left</span>: <span class="hljs-number">20</span> })</li><li>
</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">'delete'</span>)</li><li>          .<span class="hljs-title function_">height</span>(<span class="hljs-string">'5%'</span>)</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-comment">// 在第一个分组中减少4个FlowItem</span></li><li>            <span class="hljs-comment">// 重要：必须保证数据源和分组itemsCount同步更新</span></li><li>            <span class="hljs-keyword">const</span> <span class="hljs-attr">sections</span>: <span class="hljs-title class_">Array</span>&lt;<span class="hljs-title class_">SectionOptions</span>&gt; = <span class="hljs-variable language_">this</span>.<span class="hljs-property">sections</span>.<span class="hljs-title function_">values</span>();</li><li>            <span class="hljs-keyword">let</span> <span class="hljs-attr">newSection</span>: <span class="hljs-title class_">SectionOptions</span> = sections[<span class="hljs-number">0</span>];</li><li>
</li><li>            <span class="hljs-comment">// 检查是否有足够的item可以删除</span></li><li>            <span class="hljs-keyword">if</span> (newSection.<span class="hljs-property">itemsCount</span> &lt; <span class="hljs-number">4</span>) {</li><li>              <span class="hljs-keyword">return</span>;</li><li>            }</li><li>
</li><li>            <span class="hljs-comment">// 先从数据源中删除4条数据</span></li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">dataSource</span>.<span class="hljs-title function_">deleteItem</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">oneColumnSection</span>.<span class="hljs-property">itemsCount</span> - <span class="hljs-number">1</span>);</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">dataSource</span>.<span class="hljs-title function_">deleteItem</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">oneColumnSection</span>.<span class="hljs-property">itemsCount</span> - <span class="hljs-number">2</span>);</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">dataSource</span>.<span class="hljs-title function_">deleteItem</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">oneColumnSection</span>.<span class="hljs-property">itemsCount</span> - <span class="hljs-number">3</span>);</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">dataSource</span>.<span class="hljs-title function_">deleteItem</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">oneColumnSection</span>.<span class="hljs-property">itemsCount</span> - <span class="hljs-number">4</span>);</li><li>
</li><li>            <span class="hljs-comment">// 更新分组的itemsCount</span></li><li>            newSection.<span class="hljs-property">itemsCount</span> -= <span class="hljs-number">4</span>;</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">sections</span>.<span class="hljs-title function_">update</span>(<span class="hljs-number">0</span>, newSection);</li><li>          })</li><li>          .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">10</span>, <span class="hljs-attr">left</span>: <span class="hljs-number">20</span> })</li><li>
</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">'values'</span>)</li><li>          .<span class="hljs-title function_">height</span>(<span class="hljs-string">'5%'</span>)</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-keyword">const</span> <span class="hljs-attr">sections</span>: <span class="hljs-title class_">Array</span>&lt;<span class="hljs-title class_">SectionOptions</span>&gt; = <span class="hljs-variable language_">this</span>.<span class="hljs-property">sections</span>.<span class="hljs-title function_">values</span>();</li><li>            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> value <span class="hljs-keyword">of</span> sections) {</li><li>              <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(value));</li><li>            }</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'count:'</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">sections</span>.<span class="hljs-title function_">length</span>());</li><li>          })</li><li>          .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">10</span>, <span class="hljs-attr">left</span>: <span class="hljs-number">20</span> })</li><li>      }.<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">bottom</span>: <span class="hljs-number">20</span> })</li><li>
</li><li>      <span class="hljs-title class_">WaterFlow</span>({ <span class="hljs-attr">scroller</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">scroller</span>, <span class="hljs-attr">sections</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">sections</span> }) {</li><li>        <span class="hljs-title class_">LazyForEach</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">dataSource</span>, <span class="hljs-function">(<span class="hljs-params">item: <span class="hljs-built_in">number</span></span>) =&gt;</span> {</li><li>          <span class="hljs-title class_">FlowItem</span>() {</li><li>            <span class="hljs-comment">// 使用可复用组件，提升性能</span></li><li>            <span class="hljs-title class_">ReusableFlowItem</span>({ <span class="hljs-attr">item</span>: item })</li><li>          }</li><li>          .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>          <span class="hljs-comment">// 注意：同时设置onGetItemMainSizeByIndex和height属性时，</span></li><li>          <span class="hljs-comment">// 主轴大小以onGetItemMainSizeByIndex返回结果为准</span></li><li>          .<span class="hljs-title function_">height</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">itemHeightArray</span>[item % <span class="hljs-number">100</span>])</li><li>          .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">colors</span>[item % <span class="hljs-variable language_">this</span>.<span class="hljs-property">colors</span>.<span class="hljs-property">length</span>])</li><li>        }, <span class="hljs-function">(<span class="hljs-params">item: <span class="hljs-built_in">string</span></span>) =&gt;</span> item)</li><li>      }</li><li>      .<span class="hljs-title function_">columnsTemplate</span>(<span class="hljs-string">'1fr 1fr'</span>)</li><li>      .<span class="hljs-title function_">columnsGap</span>(<span class="hljs-number">10</span>)</li><li>      .<span class="hljs-title function_">rowsGap</span>(<span class="hljs-number">5</span>)</li><li>      .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-number">0xFAEEE0</span>)</li><li>      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>      .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>      .<span class="hljs-title function_">layoutWeight</span>(<span class="hljs-number">1</span>)</li><li>      .<span class="hljs-title function_">onScrollIndex</span>(<span class="hljs-function">(<span class="hljs-params">first: <span class="hljs-built_in">number</span>, last: <span class="hljs-built_in">number</span></span>) =&gt;</span> {</li><li>        <span class="hljs-comment">// 滚动监听：即将触底时提前加载更多数据</span></li><li>        <span class="hljs-keyword">if</span> (last + <span class="hljs-number">20</span> &gt;= <span class="hljs-variable language_">this</span>.<span class="hljs-property">dataSource</span>.<span class="hljs-title function_">totalCount</span>()) {</li><li>          <span class="hljs-comment">// 添加100个新数据到数据源</span></li><li>          <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100</span>; i++) {</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">dataSource</span>.<span class="hljs-title function_">addLastItem</span>();</li><li>          }</li><li>
</li><li>          <span class="hljs-comment">// 重要：更新数据源后必须同步更新sections</span></li><li>          <span class="hljs-comment">// 修改最后一个section的FlowItem数量</span></li><li>          <span class="hljs-keyword">const</span> <span class="hljs-attr">sections</span>: <span class="hljs-title class_">Array</span>&lt;<span class="hljs-title class_">SectionOptions</span>&gt; = <span class="hljs-variable language_">this</span>.<span class="hljs-property">sections</span>.<span class="hljs-title function_">values</span>();</li><li>          <span class="hljs-keyword">let</span> <span class="hljs-attr">newSection</span>: <span class="hljs-title class_">SectionOptions</span> = sections[<span class="hljs-variable language_">this</span>.<span class="hljs-property">sections</span>.<span class="hljs-title function_">length</span>() - <span class="hljs-number">1</span>];</li><li>          newSection.<span class="hljs-property">itemsCount</span> += <span class="hljs-number">100</span>;</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">sections</span>.<span class="hljs-title function_">update</span>(-<span class="hljs-number">1</span>, newSection);  <span class="hljs-comment">// -1表示最后一个分组</span></li><li>        }</li><li>      })</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>     <p><span><img originheight="595" originwidth="370" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211115648.90915501097801959040665870548627:50001231000000:2800:4B68AF81B6AB155E118FD82082F8654A01617B6CB47B179E26700C2E89CE80B4.png" width="370" height="595"></span></p>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 5478px;">     <h3 id="示例4双指缩放改变列数">示例4（双指缩放改变列数）<i class="anchor-icon anchor-icon-link" anchorid="示例4双指缩放改变列数" tips="复制节点链接"></i></h3>          <p>该示例通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-gesture-settings#prioritygesture">priorityGesture</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-basic-gestures-pinchgesture">PinchGesture</a>实现了双指缩放改变列数效果。</p>     <p>WaterFlowDataSource说明及完整代码参考<a href="/consumer/cn/doc/harmonyos-references/ts-container-waterflow#示例1使用基本瀑布流">示例1使用基本瀑布流</a>。</p>     <div _ngcontent-fiw-c106="" class="highlight-div"><div _ngcontent-fiw-c106="" class="highlight-div-header"><div _ngcontent-fiw-c106="" class="highlight-div-header-left"><div _ngcontent-fiw-c106="" class="handle-button expand-button"><div _ngcontent-fiw-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fiw-c106="" class="highlight-div-header-right"><div _ngcontent-fiw-c106="" class="handle-button ai-button"></div><div _ngcontent-fiw-c106="" class="handle-button line-button"><div _ngcontent-fiw-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fiw-c106="" class="handle-button theme-button"><div _ngcontent-fiw-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fiw-c106="" class="handle-button copy-button"><div _ngcontent-fiw-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fiw-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// Index.ets</span></li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">WaterFlowDataSource</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./WaterFlowDataSource'</span>;</li><li><span class="hljs-keyword">import</span> { image } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ImageKit'</span>;</li><li>
</li><li><span class="hljs-comment">// 可复用组件：优化性能，减少组件创建销毁开销</span></li><li><span class="hljs-meta">@Reusable</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">ReusableFlowItem</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">item</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;</li><li>
</li><li>  <span class="hljs-comment">// 从复用缓存中加入到组件树之前调用，可在此处更新组件的状态变量以展示正确的内容</span></li><li>  <span class="hljs-title function_">aboutToReuse</span>(<span class="hljs-params">params: Record&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">number</span>&gt;</span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">item</span> = params.<span class="hljs-property">item</span>;</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">'N'</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">item</span>).<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">12</span>).<span class="hljs-title function_">height</span>(<span class="hljs-string">'16'</span>)</li><li>      <span class="hljs-comment">// 注意：需要确保对应的jpg文件存在才会正常显示</span></li><li>      <span class="hljs-title class_">Image</span>(<span class="hljs-string">'res/waterFlow('</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">item</span> % <span class="hljs-number">5</span> + <span class="hljs-string">').jpg'</span>)</li><li>        .<span class="hljs-title function_">objectFit</span>(<span class="hljs-title class_">ImageFit</span>.<span class="hljs-property">Fill</span>)</li><li>        .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>        .<span class="hljs-title function_">layoutWeight</span>(<span class="hljs-number">1</span>)</li><li>    }</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">WaterFlowDemo</span> {</li><li>  <span class="hljs-attr">minSize</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">80</span>;</li><li>  <span class="hljs-attr">maxSize</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">180</span>;</li><li>  <span class="hljs-attr">colors</span>: <span class="hljs-built_in">number</span>[] = [<span class="hljs-number">0xFFC0CB</span>, <span class="hljs-number">0xDA70D6</span>, <span class="hljs-number">0x6B8E23</span>, <span class="hljs-number">0x6A5ACD</span>, <span class="hljs-number">0x00FFFF</span>, <span class="hljs-number">0x00FF7F</span>];</li><li>  <span class="hljs-attr">dataSource</span>: <span class="hljs-title class_">WaterFlowDataSource</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WaterFlowDataSource</span>();</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">itemWidthArray</span>: <span class="hljs-built_in">number</span>[] = [];</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">itemHeightArray</span>: <span class="hljs-built_in">number</span>[] = [];</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">columns</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">2</span>;</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">waterFlowScale</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">1</span>;</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">imageScale</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">1</span>;</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">waterFlowOpacity</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">1</span>;</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">waterFlowSnapshot</span>: image.<span class="hljs-property">PixelMap</span> | <span class="hljs-literal">undefined</span> = <span class="hljs-literal">undefined</span>;</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">columnChanged</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">false</span>;</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">oldColumn</span>: <span class="hljs-built_in">number</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">columns</span>;</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">pinchTime</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;</li><li>
</li><li>  <span class="hljs-comment">// 计算FlowItem宽/高</span></li><li>  <span class="hljs-title function_">getSize</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">let</span> ret = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-variable language_">this</span>.<span class="hljs-property">maxSize</span>);</li><li>    <span class="hljs-keyword">return</span> (ret &gt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">minSize</span> ? ret : <span class="hljs-variable language_">this</span>.<span class="hljs-property">minSize</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-comment">// 设置FlowItem的宽/高数组</span></li><li>  <span class="hljs-title function_">setItemSizeArray</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100</span>; i++) {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">itemWidthArray</span>.<span class="hljs-title function_">push</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getSize</span>());</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">itemHeightArray</span>.<span class="hljs-title function_">push</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getSize</span>());</li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-comment">// 组件生命周期：初始化数据和恢复上次的列数设置</span></li><li>  <span class="hljs-title function_">aboutToAppear</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-comment">// 读取上次最后切换到的列数</span></li><li>    <span class="hljs-keyword">let</span> lastCount = <span class="hljs-title class_">AppStorage</span>.<span class="hljs-property">get</span>&lt;<span class="hljs-built_in">number</span>&gt;(<span class="hljs-string">'columnsCount'</span>);</li><li>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> lastCount != <span class="hljs-string">'undefined'</span>) {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">columns</span> = lastCount;</li><li>    }</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setItemSizeArray</span>();</li><li>  }</li><li>
</li><li>  <span class="hljs-comment">// 根据缩放阈值改变列数，触发WaterFlow重新布局</span></li><li>  <span class="hljs-title function_">changeColumns</span>(<span class="hljs-params">scale: <span class="hljs-built_in">number</span></span>) {</li><li>    <span class="hljs-keyword">if</span> (scale &gt; (<span class="hljs-variable language_">this</span>.<span class="hljs-property">columns</span> / (<span class="hljs-variable language_">this</span>.<span class="hljs-property">columns</span> - <span class="hljs-number">0.5</span>)) &amp;&amp; <span class="hljs-variable language_">this</span>.<span class="hljs-property">columns</span> &gt; <span class="hljs-number">1</span>) {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">columns</span>--;</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">columnChanged</span> = <span class="hljs-literal">true</span>;</li><li>    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (scale &lt; <span class="hljs-number">1</span> &amp;&amp; <span class="hljs-variable language_">this</span>.<span class="hljs-property">columns</span> &lt; <span class="hljs-number">4</span>) {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">columns</span>++;</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">columnChanged</span> = <span class="hljs-literal">true</span>;</li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>({ <span class="hljs-attr">space</span>: <span class="hljs-number">2</span> }) {</li><li>      <span class="hljs-title class_">Row</span>() {</li><li>        <span class="hljs-title class_">Text</span>(<span class="hljs-string">'双指缩放改变列数'</span>)</li><li>          .<span class="hljs-title function_">height</span>(<span class="hljs-string">'5%'</span>)</li><li>          .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">10</span>, <span class="hljs-attr">left</span>: <span class="hljs-number">20</span> })</li><li>      }</li><li>
</li><li>      <span class="hljs-title class_">Stack</span>() {</li><li>        <span class="hljs-comment">// 用于展示缩放前的WaterFlow截图</span></li><li>        <span class="hljs-title class_">Image</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">waterFlowSnapshot</span>)</li><li>          .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>          .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>          .<span class="hljs-title function_">scale</span>({</li><li>            <span class="hljs-attr">x</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">imageScale</span>,</li><li>            <span class="hljs-attr">y</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">imageScale</span>,</li><li>            <span class="hljs-attr">centerX</span>: <span class="hljs-number">0</span>,</li><li>            <span class="hljs-attr">centerY</span>: <span class="hljs-number">0</span></li><li>          })</li><li>        </li><li>        <span class="hljs-title class_">WaterFlow</span>() {</li><li>          <span class="hljs-title class_">LazyForEach</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">dataSource</span>, <span class="hljs-function">(<span class="hljs-params">item: <span class="hljs-built_in">number</span></span>) =&gt;</span> {</li><li>            <span class="hljs-title class_">FlowItem</span>() {</li><li>              <span class="hljs-comment">// 使用可复用组件，提升性能</span></li><li>              <span class="hljs-title class_">ReusableFlowItem</span>({ <span class="hljs-attr">item</span>: item })</li><li>            }</li><li>            .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>            .<span class="hljs-title function_">aspectRatio</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">itemHeightArray</span>[item % <span class="hljs-number">100</span>] / <span class="hljs-variable language_">this</span>.<span class="hljs-property">itemWidthArray</span>[item%<span class="hljs-number">100</span>])</li><li>            .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">colors</span>[item % <span class="hljs-variable language_">this</span>.<span class="hljs-property">colors</span>.<span class="hljs-property">length</span>])</li><li>          }, <span class="hljs-function">(<span class="hljs-params">item: <span class="hljs-built_in">string</span></span>) =&gt;</span> item)</li><li>        }</li><li>        .<span class="hljs-title function_">id</span>(<span class="hljs-string">'waterflow'</span>) <span class="hljs-comment">// 设置id用于截图</span></li><li>        .<span class="hljs-title function_">columnsTemplate</span>(<span class="hljs-string">'1fr '</span>.<span class="hljs-title function_">repeat</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">columns</span>))  <span class="hljs-comment">// 动态生成列模板，如：'1fr 1fr 1fr'表示3列等宽</span></li><li>        .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-number">0xFAEEE0</span>)</li><li>        .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>        .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>        .<span class="hljs-title function_">layoutWeight</span>(<span class="hljs-number">1</span>)</li><li>        .<span class="hljs-title function_">opacity</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">waterFlowOpacity</span>)</li><li>        .<span class="hljs-title function_">scale</span>({</li><li>          <span class="hljs-attr">x</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">waterFlowScale</span>,</li><li>          <span class="hljs-attr">y</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">waterFlowScale</span>,</li><li>          <span class="hljs-attr">centerX</span>: <span class="hljs-number">0</span>,</li><li>          <span class="hljs-attr">centerY</span>: <span class="hljs-number">0</span></li><li>        })</li><li>        .<span class="hljs-title function_">priorityGesture</span>(</li><li>          <span class="hljs-title class_">PinchGesture</span>()</li><li>            .<span class="hljs-title function_">onActionStart</span>(<span class="hljs-function">(<span class="hljs-params">event: GestureEvent</span>) =&gt;</span> {</li><li>              <span class="hljs-comment">// 双指捏合手势识别成功时截图</span></li><li>              <span class="hljs-variable language_">this</span>.<span class="hljs-property">pinchTime</span> = event.<span class="hljs-property">timestamp</span>;</li><li>              <span class="hljs-variable language_">this</span>.<span class="hljs-property">columnChanged</span> = <span class="hljs-literal">false</span>;</li><li>              <span class="hljs-variable language_">this</span>.<span class="hljs-property">oldColumn</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">columns</span>;</li><li>              <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getComponentSnapshot</span>().<span class="hljs-title function_">get</span>(<span class="hljs-string">'waterflow'</span>, <span class="hljs-function">(<span class="hljs-params">error: <span class="hljs-built_in">Error</span>, pixmap: image.PixelMap</span>) =&gt;</span> {</li><li>                <span class="hljs-keyword">if</span> (error) {</li><li>                  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'error:'</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(error));</li><li>                  <span class="hljs-keyword">return</span>;</li><li>                }</li><li>                <span class="hljs-variable language_">this</span>.<span class="hljs-property">waterFlowSnapshot</span> = pixmap;</li><li>              })</li><li>            })</li><li>            .<span class="hljs-title function_">onActionUpdate</span>(<span class="hljs-function">(<span class="hljs-params">event: GestureEvent</span>) =&gt;</span> {</li><li>              <span class="hljs-comment">// 手势更新：处理缩放逻辑和视觉效果</span></li><li>              <span class="hljs-comment">// 边界限制：防止超出列数范围时继续缩放</span></li><li>              <span class="hljs-keyword">if</span> ((<span class="hljs-variable language_">this</span>.<span class="hljs-property">oldColumn</span> === <span class="hljs-number">1</span> &amp;&amp; event.<span class="hljs-property">scale</span> &gt; <span class="hljs-number">1</span>) || (<span class="hljs-variable language_">this</span>.<span class="hljs-property">oldColumn</span> === <span class="hljs-number">4</span> &amp;&amp; event.<span class="hljs-property">scale</span> &lt; <span class="hljs-number">1</span>)) {</li><li>                <span class="hljs-keyword">return</span>;</li><li>              }</li><li>
</li><li>              <span class="hljs-comment">// 节流处理：避免过于频繁的更新，提升性能</span></li><li>              <span class="hljs-keyword">if</span> (event.<span class="hljs-property">timestamp</span> - <span class="hljs-variable language_">this</span>.<span class="hljs-property">pinchTime</span> &lt; <span class="hljs-number">10000000</span>) {</li><li>                <span class="hljs-keyword">return</span>;</li><li>              }</li><li>              <span class="hljs-variable language_">this</span>.<span class="hljs-property">pinchTime</span> = event.<span class="hljs-property">timestamp</span>;</li><li>
</li><li>              <span class="hljs-variable language_">this</span>.<span class="hljs-property">waterFlowScale</span> = event.<span class="hljs-property">scale</span>;</li><li>              <span class="hljs-variable language_">this</span>.<span class="hljs-property">imageScale</span> = event.<span class="hljs-property">scale</span>;</li><li>              <span class="hljs-comment">// 根据缩放比例设置WaterFlow透明度</span></li><li>              <span class="hljs-variable language_">this</span>.<span class="hljs-property">waterFlowOpacity</span> = (<span class="hljs-variable language_">this</span>.<span class="hljs-property">waterFlowScale</span> &gt; <span class="hljs-number">1</span>) ? (<span class="hljs-variable language_">this</span>.<span class="hljs-property">waterFlowScale</span> - <span class="hljs-number">1</span>) : (<span class="hljs-number">1</span> - <span class="hljs-variable language_">this</span>.<span class="hljs-property">waterFlowScale</span>);</li><li>              <span class="hljs-variable language_">this</span>.<span class="hljs-property">waterFlowOpacity</span> *= <span class="hljs-number">3</span>;</li><li>              <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">columnChanged</span>) {</li><li>                <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">changeColumns</span>(event.<span class="hljs-property">scale</span>);</li><li>              }</li><li>
</li><li>              <span class="hljs-comment">// 列数改变后的缩放比例调整：避免出现空白区域</span></li><li>              <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">columnChanged</span>) {</li><li>                <span class="hljs-variable language_">this</span>.<span class="hljs-property">waterFlowScale</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">imageScale</span> * <span class="hljs-variable language_">this</span>.<span class="hljs-property">columns</span> / <span class="hljs-variable language_">this</span>.<span class="hljs-property">oldColumn</span>;</li><li>
</li><li>                <span class="hljs-comment">// 限制缩放范围，确保视觉效果自然</span></li><li>                <span class="hljs-keyword">if</span> (event.<span class="hljs-property">scale</span> &lt; <span class="hljs-number">1</span>) {</li><li>                  <span class="hljs-variable language_">this</span>.<span class="hljs-property">waterFlowScale</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">waterFlowScale</span> &gt; <span class="hljs-number">1</span> ? <span class="hljs-variable language_">this</span>.<span class="hljs-property">waterFlowScale</span> : <span class="hljs-number">1</span>;</li><li>                } <span class="hljs-keyword">else</span> {</li><li>                  <span class="hljs-variable language_">this</span>.<span class="hljs-property">waterFlowScale</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">waterFlowScale</span> &lt; <span class="hljs-number">1</span> ? <span class="hljs-variable language_">this</span>.<span class="hljs-property">waterFlowScale</span> : <span class="hljs-number">1</span>;</li><li>                }</li><li>              }</li><li>            })</li><li>            .<span class="hljs-title function_">onActionEnd</span>(<span class="hljs-function">(<span class="hljs-params">event: GestureEvent</span>) =&gt;</span> {</li><li>              <span class="hljs-comment">// 手势结束：执行归位动画并保存状态</span></li><li>              <span class="hljs-comment">// 执行归位动画：平滑过渡到正常状态</span></li><li>              <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>()?.<span class="hljs-title function_">animateTo</span>({ <span class="hljs-attr">duration</span>: <span class="hljs-number">300</span> }, <span class="hljs-function">() =&gt;</span> {</li><li>                <span class="hljs-variable language_">this</span>.<span class="hljs-property">waterFlowScale</span> = <span class="hljs-number">1</span>;</li><li>                <span class="hljs-variable language_">this</span>.<span class="hljs-property">waterFlowOpacity</span> = <span class="hljs-number">1</span>;</li><li>              })</li><li>
</li><li>              <span class="hljs-comment">// 持久化保存当前列数：下次启动时恢复</span></li><li>              <span class="hljs-title class_">AppStorage</span>.<span class="hljs-property">setOrCreate</span>&lt;<span class="hljs-built_in">number</span>&gt;(<span class="hljs-string">'columnsCount'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">columns</span>);</li><li>            })</li><li>        )</li><li>      }</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>     <p><span><img originheight="678" originwidth="329" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211115648.35368766930972319701255368488955:50001231000000:2800:1C711F3F979C42984E4F8915E894035CF8D37EBED2381960CA06204456D4B8BB.gif" width="329" height="678"></span></p>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 2260px;">     <h3 id="示例5设置边缘渐隐效果">示例5（设置边缘渐隐效果）<i class="anchor-icon anchor-icon-link" anchorid="示例5设置边缘渐隐效果" tips="复制节点链接"></i></h3>          <p>该示例通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-scrollable-common#fadingedge14">fadingEdge</a>实现了WaterFlow组件开启边缘渐隐效果，并通过fadingEdgeLength参数设置边缘渐隐长度。</p>     <p>WaterFlowDataSource说明及完整代码参考<a href="/consumer/cn/doc/harmonyos-references/ts-container-waterflow#示例1使用基本瀑布流">示例1使用基本瀑布流</a>。</p>     <div _ngcontent-fiw-c106="" class="highlight-div"><div _ngcontent-fiw-c106="" class="highlight-div-header"><div _ngcontent-fiw-c106="" class="highlight-div-header-left"><div _ngcontent-fiw-c106="" class="handle-button expand-button"><div _ngcontent-fiw-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fiw-c106="" class="highlight-div-header-right"><div _ngcontent-fiw-c106="" class="handle-button ai-button"></div><div _ngcontent-fiw-c106="" class="handle-button line-button"><div _ngcontent-fiw-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fiw-c106="" class="handle-button theme-button"><div _ngcontent-fiw-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fiw-c106="" class="handle-button copy-button"><div _ngcontent-fiw-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fiw-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// Index.ets</span></li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">LengthMetrics</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">WaterFlowDataSource</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./WaterFlowDataSource'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">WaterFlowDemo</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">minSize</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">80</span>;</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">maxSize</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">180</span>;</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">colors</span>: <span class="hljs-built_in">number</span>[] = [<span class="hljs-number">0xFFC0CB</span>, <span class="hljs-number">0xDA70D6</span>, <span class="hljs-number">0x6B8E23</span>, <span class="hljs-number">0x6A5ACD</span>, <span class="hljs-number">0x00FFFF</span>, <span class="hljs-number">0x00FF7F</span>];</li><li>  <span class="hljs-attr">dataSource</span>: <span class="hljs-title class_">WaterFlowDataSource</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WaterFlowDataSource</span>();</li><li>  <span class="hljs-attr">scroller</span>: <span class="hljs-title class_">Scroller</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scroller</span>();</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">itemWidthArray</span>: <span class="hljs-built_in">number</span>[] = [];</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">itemHeightArray</span>: <span class="hljs-built_in">number</span>[] = [];</li><li>
</li><li>  <span class="hljs-comment">// 计算FlowItem宽/高</span></li><li>  <span class="hljs-title function_">getSize</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">let</span> ret = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-variable language_">this</span>.<span class="hljs-property">maxSize</span>);</li><li>    <span class="hljs-keyword">return</span> (ret &gt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">minSize</span> ? ret : <span class="hljs-variable language_">this</span>.<span class="hljs-property">minSize</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-comment">// 设置FlowItem宽/高数组</span></li><li>  <span class="hljs-title function_">setItemSizeArray</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100</span>; i++) {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">itemWidthArray</span>.<span class="hljs-title function_">push</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getSize</span>());</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">itemHeightArray</span>.<span class="hljs-title function_">push</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getSize</span>());</li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-comment">// 组件生命周期：在组件即将出现时初始化尺寸数组</span></li><li>  <span class="hljs-title function_">aboutToAppear</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setItemSizeArray</span>();</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>({ <span class="hljs-attr">space</span>: <span class="hljs-number">2</span> }) {</li><li>      <span class="hljs-title class_">WaterFlow</span>({ <span class="hljs-attr">scroller</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">scroller</span> }) {</li><li>        <span class="hljs-title class_">LazyForEach</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">dataSource</span>, <span class="hljs-function">(<span class="hljs-params">item: <span class="hljs-built_in">number</span></span>) =&gt;</span> {</li><li>          <span class="hljs-title class_">FlowItem</span>() {</li><li>            <span class="hljs-title class_">Column</span>() {</li><li>              <span class="hljs-title class_">Text</span>(<span class="hljs-string">'N'</span> + item).<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">12</span>).<span class="hljs-title function_">height</span>(<span class="hljs-string">'16'</span>)</li><li>            }</li><li>          }</li><li>          .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>          .<span class="hljs-title function_">height</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">itemHeightArray</span>[item % <span class="hljs-number">100</span>])</li><li>          .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">colors</span>[item % <span class="hljs-number">5</span>])</li><li>        }, <span class="hljs-function">(<span class="hljs-params">item: <span class="hljs-built_in">string</span></span>) =&gt;</span> item)</li><li>      }</li><li>      <span class="hljs-comment">// auto-fill自动计算列数：根据容器宽度自动计算能放下多少个80px宽的列</span></li><li>      .<span class="hljs-title function_">columnsTemplate</span>(<span class="hljs-string">'repeat(auto-fill,80)'</span>)</li><li>      .<span class="hljs-title function_">columnsGap</span>(<span class="hljs-number">10</span>)</li><li>      .<span class="hljs-title function_">rowsGap</span>(<span class="hljs-number">5</span>)</li><li>      .<span class="hljs-title function_">height</span>(<span class="hljs-string">'90%'</span>)</li><li>      .<span class="hljs-title function_">scrollBar</span>(<span class="hljs-title class_">BarState</span>.<span class="hljs-property">On</span>)</li><li>      <span class="hljs-comment">// 边缘渐隐效果：在滚动边缘创建渐隐过渡效果</span></li><li>      <span class="hljs-comment">// true：启用渐隐效果</span></li><li>      <span class="hljs-comment">// fadingEdgeLength: LengthMetrics.vp(80)：渐隐区域长度为80vp</span></li><li>      <span class="hljs-comment">// 效果：在瀑布流顶部和底部边缘会有80vp的渐隐过渡区域</span></li><li>      .<span class="hljs-title function_">fadingEdge</span>(<span class="hljs-literal">true</span>, { <span class="hljs-attr">fadingEdgeLength</span>: <span class="hljs-title class_">LengthMetrics</span>.<span class="hljs-title function_">vp</span>(<span class="hljs-number">80</span>) })</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>     <p><span><img originheight="508" originwidth="238" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211115648.74279542503723657891552118406150:50001231000000:2800:885C67A4D11178263696CB022277A9CA476B95B0FC7B2DABABAD25FB33F7402D.gif" class="notEnlarge" width="238" height="508"></span></p>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 2220px;">     <h3 id="示例6单边边缘效果">示例6（单边边缘效果）<i class="anchor-icon anchor-icon-link" anchorid="示例6单边边缘效果" tips="复制节点链接"></i></h3>          <p>该示例通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-scrollable-common#edgeeffect11">edgeEffect</a>接口，实现了WaterFlow组件设置单边边缘效果。</p>     <p>WaterFlowDataSource说明及完整代码参考<a href="/consumer/cn/doc/harmonyos-references/ts-container-waterflow#示例1使用基本瀑布流">示例1使用基本瀑布流</a>。</p>     <div _ngcontent-fiw-c106="" class="highlight-div"><div _ngcontent-fiw-c106="" class="highlight-div-header"><div _ngcontent-fiw-c106="" class="highlight-div-header-left"><div _ngcontent-fiw-c106="" class="handle-button expand-button"><div _ngcontent-fiw-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fiw-c106="" class="highlight-div-header-right"><div _ngcontent-fiw-c106="" class="handle-button ai-button"></div><div _ngcontent-fiw-c106="" class="handle-button line-button"><div _ngcontent-fiw-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fiw-c106="" class="handle-button theme-button"><div _ngcontent-fiw-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fiw-c106="" class="handle-button copy-button"><div _ngcontent-fiw-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fiw-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// Index.ets</span></li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">WaterFlowDataSource</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./WaterFlowDataSource'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">WaterFlowDemo</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">minSize</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">80</span>;</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">maxSize</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">180</span>;</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">colors</span>: <span class="hljs-built_in">number</span>[] = [<span class="hljs-number">0xFFC0CB</span>, <span class="hljs-number">0xDA70D6</span>, <span class="hljs-number">0x6B8E23</span>, <span class="hljs-number">0x6A5ACD</span>, <span class="hljs-number">0x00FFFF</span>, <span class="hljs-number">0x00FF7F</span>];</li><li>  <span class="hljs-attr">dataSource</span>: <span class="hljs-title class_">WaterFlowDataSource</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WaterFlowDataSource</span>();</li><li>  <span class="hljs-attr">scroller</span>: <span class="hljs-title class_">Scroller</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scroller</span>();</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">itemWidthArray</span>: <span class="hljs-built_in">number</span>[] = [];</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">itemHeightArray</span>: <span class="hljs-built_in">number</span>[] = [];</li><li>
</li><li>  <span class="hljs-comment">// 计算FlowItem宽/高</span></li><li>  <span class="hljs-title function_">getSize</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">let</span> ret = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-variable language_">this</span>.<span class="hljs-property">maxSize</span>);</li><li>    <span class="hljs-keyword">return</span> (ret &gt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">minSize</span> ? ret : <span class="hljs-variable language_">this</span>.<span class="hljs-property">minSize</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-comment">// 设置FlowItem宽/高数组</span></li><li>  <span class="hljs-title function_">setItemSizeArray</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100</span>; i++) {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">itemWidthArray</span>.<span class="hljs-title function_">push</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getSize</span>());</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">itemHeightArray</span>.<span class="hljs-title function_">push</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getSize</span>());</li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-comment">// 组件生命周期：在组件即将出现时初始化尺寸数组</span></li><li>  <span class="hljs-title function_">aboutToAppear</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setItemSizeArray</span>();</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>({ <span class="hljs-attr">space</span>: <span class="hljs-number">2</span> }) {</li><li>      <span class="hljs-title class_">WaterFlow</span>({ <span class="hljs-attr">scroller</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">scroller</span> }) {</li><li>        <span class="hljs-title class_">LazyForEach</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">dataSource</span>, <span class="hljs-function">(<span class="hljs-params">item: <span class="hljs-built_in">number</span></span>) =&gt;</span> {</li><li>          <span class="hljs-title class_">FlowItem</span>() {</li><li>            <span class="hljs-title class_">Column</span>() {</li><li>              <span class="hljs-title class_">Text</span>(<span class="hljs-string">'N'</span> + item).<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">12</span>).<span class="hljs-title function_">height</span>(<span class="hljs-string">'16'</span>)</li><li>            }</li><li>          }</li><li>          .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>          .<span class="hljs-title function_">height</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">itemHeightArray</span>[item % <span class="hljs-number">100</span>])</li><li>          .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">colors</span>[item % <span class="hljs-number">5</span>])</li><li>        }, <span class="hljs-function">(<span class="hljs-params">item: <span class="hljs-built_in">number</span></span>) =&gt;</span> item.<span class="hljs-title function_">toString</span>())</li><li>      }</li><li>      <span class="hljs-comment">// auto-fill自动计算列数：根据容器宽度自动计算能放下多少个80px宽的列</span></li><li>      .<span class="hljs-title function_">columnsTemplate</span>(<span class="hljs-string">'repeat(auto-fill,80)'</span>)</li><li>      .<span class="hljs-title function_">columnsGap</span>(<span class="hljs-number">10</span>)</li><li>      .<span class="hljs-title function_">rowsGap</span>(<span class="hljs-number">5</span>)</li><li>      .<span class="hljs-title function_">height</span>(<span class="hljs-string">'90%'</span>)</li><li>      <span class="hljs-comment">// 单边边缘效果：设置弹簧效果，仅在顶部生效</span></li><li>      <span class="hljs-comment">// EdgeEffect.Spring：弹簧回弹效果，滑动到边界时会有弹性回弹</span></li><li>      <span class="hljs-comment">// alwaysEnabled: true：始终启用边缘效果，即使内容不足以滚动</span></li><li>      <span class="hljs-comment">// effectEdge: EffectEdge.START：仅在起始边缘（顶部）生效</span></li><li>      <span class="hljs-comment">// 效果：只有向上滑动到顶部时才会有弹簧回弹效果，向下滑动到底部不会有效果</span></li><li>      .<span class="hljs-title function_">edgeEffect</span>(<span class="hljs-title class_">EdgeEffect</span>.<span class="hljs-property">Spring</span>, { <span class="hljs-attr">alwaysEnabled</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">effectEdge</span>: <span class="hljs-title class_">EffectEdge</span>.<span class="hljs-property">START</span> })</li><li>
</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>     <p><span><img originheight="468" originwidth="232" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211115648.21326702419346881861724359085862:50001231000000:2800:B859868FD5B56EC2E2A10459DB2E9506B8CD2AE74BC112517D4BA7D1BB67B205.gif" class="notEnlarge" width="232" height="468"></span></p>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 3412px;">     <h3 id="示例7waterflow组件设置和改变尾部组件">示例7（WaterFlow组件设置和改变尾部组件）<i class="anchor-icon anchor-icon-link" anchorid="示例7waterflow组件设置和改变尾部组件" tips="复制节点链接"></i></h3>          <p>从API version 18开始，该示例通过<a href="/consumer/cn/doc/harmonyos-references/ts-container-waterflow#waterflowoptions对象说明">WaterFlowOptions对象说明</a>的footerContent接口，实现了WaterFlow组件设置尾部组件。通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-arkui-componentcontent">ComponentContent</a>的update函数更新尾部组件。</p>     <p>WaterFlowDataSource说明及完整代码参考<a href="/consumer/cn/doc/harmonyos-references/ts-container-waterflow#示例1使用基本瀑布流">示例1使用基本瀑布流</a>。</p>     <div _ngcontent-fiw-c106="" class="highlight-div"><div _ngcontent-fiw-c106="" class="highlight-div-header"><div _ngcontent-fiw-c106="" class="highlight-div-header-left"><div _ngcontent-fiw-c106="" class="handle-button expand-button"><div _ngcontent-fiw-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fiw-c106="" class="highlight-div-header-right"><div _ngcontent-fiw-c106="" class="handle-button ai-button"></div><div _ngcontent-fiw-c106="" class="handle-button line-button"><div _ngcontent-fiw-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fiw-c106="" class="handle-button theme-button"><div _ngcontent-fiw-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fiw-c106="" class="handle-button copy-button"><div _ngcontent-fiw-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fiw-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// Index.ets</span></li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">ComponentContent</span>, <span class="hljs-title class_">UIContext</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">WaterFlowDataSource</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./WaterFlowDataSource'</span>;</li><li>
</li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Params</span> {</li><li>  <span class="hljs-attr">text</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">''</span>;</li><li>
</li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">text: <span class="hljs-built_in">string</span></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">text</span> = text;</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-comment">// Builder函数：构建尾部组件的UI结构</span></li><li><span class="hljs-meta">@Builder</span></li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">buildText</span>(<span class="hljs-params">params: Params</span>) {</li><li>  <span class="hljs-title class_">Column</span>() {</li><li>    <span class="hljs-title class_">Text</span>(params.<span class="hljs-property">text</span>)</li><li>      .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">20</span>)</li><li>      .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)</li><li>      .<span class="hljs-title function_">margin</span>(<span class="hljs-number">20</span>)</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">message1</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'已经到底了'</span>;</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">message2</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'加载更多'</span>;</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">colors</span>: <span class="hljs-built_in">number</span>[] = [<span class="hljs-number">0xD5D5D5</span>, <span class="hljs-number">0x7F7F7F</span>, <span class="hljs-number">0xF7F7F7</span>];</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">minSize</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">80</span>;</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">maxSize</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">180</span>;</li><li>
</li><li>  <span class="hljs-comment">// UI上下文：用于创建ComponentContent</span></li><li>  <span class="hljs-attr">context</span>: <span class="hljs-title class_">UIContext</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>();</li><li>
</li><li>  <span class="hljs-comment">// 动态尾部组件：使用ComponentContent创建可更新的尾部组件</span></li><li>  <span class="hljs-comment">// ComponentContent&lt;Params&gt;：泛型指定参数类型</span></li><li>  <span class="hljs-comment">// wrapBuilder&lt;[Params]&gt;(buildText)：包装Builder函数</span></li><li>  <span class="hljs-comment">// new Params(this.message1)：初始参数，显示'已经到底了'</span></li><li>  <span class="hljs-attr">footerContent</span>: <span class="hljs-title class_">ComponentContent</span>&lt;<span class="hljs-title class_">Params</span>&gt; = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ComponentContent</span>&lt;<span class="hljs-title class_">Params</span>&gt;(</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>,</li><li>    wrapBuilder&lt;[<span class="hljs-title class_">Params</span>]&gt;(buildText),</li><li>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">Params</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">message1</span>)</li><li>  );</li><li>
</li><li>  <span class="hljs-attr">dataSource</span>: <span class="hljs-title class_">WaterFlowDataSource</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WaterFlowDataSource</span>();</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">itemWidthArray</span>: <span class="hljs-built_in">number</span>[] = [];</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">itemHeightArray</span>: <span class="hljs-built_in">number</span>[] = [];</li><li>
</li><li>  <span class="hljs-comment">// 计算FlowItem宽/高</span></li><li>  <span class="hljs-title function_">getSize</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">let</span> ret = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-variable language_">this</span>.<span class="hljs-property">maxSize</span>);</li><li>    <span class="hljs-keyword">return</span> (ret &gt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">minSize</span> ? ret : <span class="hljs-variable language_">this</span>.<span class="hljs-property">minSize</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-comment">// 设置FlowItem宽/高数组</span></li><li>  <span class="hljs-title function_">setItemSizeArray</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100</span>; i++) {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">itemWidthArray</span>.<span class="hljs-title function_">push</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getSize</span>());</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">itemHeightArray</span>.<span class="hljs-title function_">push</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getSize</span>());</li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-comment">// 组件生命周期：在组件即将出现时初始化尺寸数组</span></li><li>  <span class="hljs-title function_">aboutToAppear</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setItemSizeArray</span>();</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Row</span>() {</li><li>      <span class="hljs-title class_">Column</span>() {</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">'更新footer'</span>).<span class="hljs-title function_">width</span>(<span class="hljs-string">'90%'</span>).<span class="hljs-title function_">margin</span>(<span class="hljs-number">20</span>)</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">(<span class="hljs-params">event?: ClickEvent</span>) =&gt;</span> {</li><li>            <span class="hljs-comment">// 调用ComponentContent的update方法更新尾部组件</span></li><li>            <span class="hljs-comment">// 传入新的Params对象，文本内容从'已经到底了'变为'加载更多'</span></li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">footerContent</span>.<span class="hljs-title function_">update</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Params</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">message2</span>));</li><li>          })</li><li>        <span class="hljs-title class_">WaterFlow</span>({ <span class="hljs-attr">footerContent</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">footerContent</span> }) {</li><li>          <span class="hljs-title class_">LazyForEach</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">dataSource</span>, <span class="hljs-function">(<span class="hljs-params">item: <span class="hljs-built_in">number</span></span>) =&gt;</span> {</li><li>            <span class="hljs-title class_">FlowItem</span>() {</li><li>              <span class="hljs-title class_">Column</span>() {</li><li>                <span class="hljs-title class_">Text</span>(<span class="hljs-string">'N'</span> + item).<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">12</span>).<span class="hljs-title function_">height</span>(<span class="hljs-string">'16'</span>)</li><li>              }</li><li>              .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>              .<span class="hljs-title function_">height</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">itemHeightArray</span>[item % <span class="hljs-number">100</span>])</li><li>              .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">colors</span>[item % <span class="hljs-number">3</span>])</li><li>              .<span class="hljs-title function_">justifyContent</span>(<span class="hljs-title class_">FlexAlign</span>.<span class="hljs-property">Center</span>)</li><li>              .<span class="hljs-title function_">alignItems</span>(<span class="hljs-title class_">HorizontalAlign</span>.<span class="hljs-property">Center</span>)</li><li>            }</li><li>          }, <span class="hljs-function">(<span class="hljs-params">item: <span class="hljs-built_in">number</span></span>) =&gt;</span> item.<span class="hljs-title function_">toString</span>())</li><li>        }</li><li>        .<span class="hljs-title function_">columnsTemplate</span>(<span class="hljs-string">'1fr'</span>)</li><li>        .<span class="hljs-title function_">height</span>(<span class="hljs-string">'90%'</span>)</li><li>      }</li><li>      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>      .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>    }</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div>     <p><span><img originheight="724" originwidth="340" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211115649.56668157699134160031781813109571:50001231000000:2800:D3CB0E66E07F91D28731588CE9E248E3C503443D9845C3D355BA702A175CA2AC.gif" width="340" height="724"></span></p>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 2821px;">     <h3 id="示例8waterflow组件实现下拉刷新">示例8（WaterFlow组件实现下拉刷新）<i class="anchor-icon anchor-icon-link" anchorid="示例8waterflow组件实现下拉刷新" tips="复制节点链接"></i></h3>          <p>该示例通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-refresh">Refresh</a>组件和WaterFlow组件，实现了下拉刷新瀑布流组件数据源。</p>     <p>WaterFlowDataSource说明及完整代码参考<a href="/consumer/cn/doc/harmonyos-references/ts-container-waterflow#示例1使用基本瀑布流">示例1使用基本瀑布流</a>。</p>     <div _ngcontent-fiw-c106="" class="highlight-div"><div _ngcontent-fiw-c106="" class="highlight-div-header"><div _ngcontent-fiw-c106="" class="highlight-div-header-left"><div _ngcontent-fiw-c106="" class="handle-button expand-button"><div _ngcontent-fiw-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fiw-c106="" class="highlight-div-header-right"><div _ngcontent-fiw-c106="" class="handle-button ai-button"></div><div _ngcontent-fiw-c106="" class="handle-button line-button"><div _ngcontent-fiw-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fiw-c106="" class="handle-button theme-button"><div _ngcontent-fiw-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fiw-c106="" class="handle-button copy-button"><div _ngcontent-fiw-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fiw-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// Index.ets</span></li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">WaterFlowDataSource</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./WaterFlowDataSource'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">WaterFlowDemo</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">minSize</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">80</span>;</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">maxSize</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">180</span>;</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">colors</span>: <span class="hljs-built_in">number</span>[] = [<span class="hljs-number">0xFFC0CB</span>, <span class="hljs-number">0xDA70D6</span>, <span class="hljs-number">0x6B8E23</span>, <span class="hljs-number">0x6A5ACD</span>, <span class="hljs-number">0x00FFFF</span>, <span class="hljs-number">0x00FF7F</span>];</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">isRefreshing</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">false</span>;</li><li>  <span class="hljs-attr">dataSource</span>: <span class="hljs-title class_">WaterFlowDataSource</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">WaterFlowDataSource</span>();</li><li>  <span class="hljs-attr">scroller</span>: <span class="hljs-title class_">Scroller</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scroller</span>();</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">itemWidthArray</span>: <span class="hljs-built_in">number</span>[] = [];</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">itemHeightArray</span>: <span class="hljs-built_in">number</span>[] = [];</li><li>
</li><li>  <span class="hljs-comment">// 计算FlowItem宽/高</span></li><li>  <span class="hljs-title function_">getSize</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">let</span> ret = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-variable language_">this</span>.<span class="hljs-property">maxSize</span>);</li><li>    <span class="hljs-keyword">return</span> (ret &gt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">minSize</span> ? ret : <span class="hljs-variable language_">this</span>.<span class="hljs-property">minSize</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-comment">// 设置FlowItem宽/高数组</span></li><li>  <span class="hljs-title function_">setItemSizeArray</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100</span>; i++) {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">itemWidthArray</span>.<span class="hljs-title function_">push</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getSize</span>());</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">itemHeightArray</span>.<span class="hljs-title function_">push</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getSize</span>());</li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-comment">// 组件生命周期：在组件即将出现时初始化尺寸数组</span></li><li>  <span class="hljs-title function_">aboutToAppear</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setItemSizeArray</span>();</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>({ <span class="hljs-attr">space</span>: <span class="hljs-number">2</span> }) {</li><li>      <span class="hljs-comment">// refreshing: $$this.isRefreshing：双向绑定刷新状态</span></li><li>      <span class="hljs-title class_">Refresh</span>({ <span class="hljs-attr">refreshing</span>: $$this.<span class="hljs-property">isRefreshing</span> }) {</li><li>        <span class="hljs-title class_">WaterFlow</span>({ <span class="hljs-attr">scroller</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">scroller</span> }) {</li><li>          <span class="hljs-title class_">LazyForEach</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">dataSource</span>, <span class="hljs-function">(<span class="hljs-params">item: <span class="hljs-built_in">number</span></span>) =&gt;</span> {</li><li>            <span class="hljs-title class_">FlowItem</span>() {</li><li>              <span class="hljs-title class_">Column</span>() {</li><li>                <span class="hljs-title class_">Text</span>(<span class="hljs-string">'N'</span> + item).<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">12</span>).<span class="hljs-title function_">height</span>(<span class="hljs-string">'16'</span>)</li><li>              }</li><li>            }</li><li>            .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>            .<span class="hljs-title function_">height</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">itemHeightArray</span>[item % <span class="hljs-number">100</span>])</li><li>            .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">colors</span>[item % <span class="hljs-variable language_">this</span>.<span class="hljs-property">colors</span>.<span class="hljs-property">length</span>])</li><li>          }, <span class="hljs-function">(<span class="hljs-params">item: <span class="hljs-built_in">number</span></span>) =&gt;</span> item.<span class="hljs-title function_">toString</span>())</li><li>        }</li><li>        <span class="hljs-comment">// auto-fill自动计算列数：根据容器宽度自动计算能放下多少个80px宽的列</span></li><li>        .<span class="hljs-title function_">columnsTemplate</span>(<span class="hljs-string">'repeat(auto-fill,80)'</span>)</li><li>        .<span class="hljs-title function_">columnsGap</span>(<span class="hljs-number">10</span>)</li><li>        .<span class="hljs-title function_">rowsGap</span>(<span class="hljs-number">5</span>)</li><li>        .<span class="hljs-title function_">height</span>(<span class="hljs-string">'90%'</span>)</li><li>        <span class="hljs-comment">// 边缘效果：弹簧回弹效果</span></li><li>        .<span class="hljs-title function_">edgeEffect</span>(<span class="hljs-title class_">EdgeEffect</span>.<span class="hljs-property">Spring</span>, { <span class="hljs-attr">alwaysEnabled</span>: <span class="hljs-literal">true</span> })</li><li>        .<span class="hljs-title function_">onReachEnd</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-comment">// 触底加载更多数据：滚动到底部时触发</span></li><li>          <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">dataSource</span>.<span class="hljs-title function_">addNewItems</span>(<span class="hljs-number">100</span>);</li><li>          }, <span class="hljs-number">1000</span>)</li><li>        })</li><li>      }</li><li>      .<span class="hljs-title function_">onStateChange</span>(<span class="hljs-function">(<span class="hljs-params">refreshStatus: RefreshStatus</span>) =&gt;</span> {</li><li>        <span class="hljs-comment">// 刷新状态变化监听：处理不同的刷新状态</span></li><li>        <span class="hljs-keyword">if</span> (refreshStatus === <span class="hljs-title class_">RefreshStatus</span>.<span class="hljs-property">Done</span>) {</li><li>          <span class="hljs-comment">// 刷新完成时：调用数据源的刷新方法，更新所有数据</span></li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">dataSource</span>.<span class="hljs-title function_">refreshItems</span>();</li><li>        }</li><li>      })</li><li>      .<span class="hljs-title function_">onRefreshing</span>(<span class="hljs-function">() =&gt;</span> {</li><li>        <span class="hljs-comment">// 正在刷新时的回调：模拟刷新过程</span></li><li>        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">isRefreshing</span> = <span class="hljs-literal">false</span>;</li><li>        }, <span class="hljs-number">1000</span>)</li><li>      })</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>     <p><span><img originheight="637" originwidth="344" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211115649.84579837557027680572675330906843:50001231000000:2800:B8FC96F46A17E388729368D20FA037BBE84381012A74F967086597158CB624DF.gif" width="344" height="637"></span></p>    </div>    <div class="tiledSection" style="contain-intrinsic-size: auto 2741px;">     <h3 id="示例9设置滚动事件">示例9（设置滚动事件）<i class="anchor-icon anchor-icon-link" anchorid="示例9设置滚动事件" tips="复制节点链接"></i></h3>          <p>该示例通过FrameNode中的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-arkui-framenode#geteventwaterflow19">getEvent('WaterFlow')</a>获取<a href="/consumer/cn/doc/harmonyos-references/ts-container-waterflow#uiwaterflowevent19">UIWaterFlowEvent</a>，并为WaterFlow设置滚动事件回调，用于事件监听方因无法直接修改页面代码而无法使用声明式接口设置回调的场景。</p>     <p>从API version 19开始，新增UIWaterFlowEvent接口。</p>     <div _ngcontent-fiw-c106="" class="highlight-div"><div _ngcontent-fiw-c106="" class="highlight-div-header"><div _ngcontent-fiw-c106="" class="highlight-div-header-left"><div _ngcontent-fiw-c106="" class="handle-button expand-button"><div _ngcontent-fiw-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fiw-c106="" class="highlight-div-header-right"><div _ngcontent-fiw-c106="" class="handle-button ai-button"></div><div _ngcontent-fiw-c106="" class="handle-button line-button"><div _ngcontent-fiw-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fiw-c106="" class="handle-button theme-button"><div _ngcontent-fiw-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fiw-c106="" class="handle-button copy-button"><div _ngcontent-fiw-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fiw-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">NodeController</span>, <span class="hljs-title class_">FrameNode</span>, typeNode } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span>;</li><li>
</li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyNodeController</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">NodeController</span> {</li><li>  <span class="hljs-keyword">public</span> <span class="hljs-attr">rootNode</span>: <span class="hljs-title class_">FrameNode</span> | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;</li><li>
</li><li>  <span class="hljs-title function_">makeNode</span>(<span class="hljs-attr">uiContext</span>: <span class="hljs-title class_">UIContext</span>): <span class="hljs-title class_">FrameNode</span> | <span class="hljs-literal">null</span> {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">rootNode</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">FrameNode</span>(uiContext);</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">rootNode</span>.<span class="hljs-property">commonAttribute</span>.<span class="hljs-title function_">width</span>(<span class="hljs-number">100</span>);</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">rootNode</span>;</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">addCommonEvent</span>(<span class="hljs-params">frameNode: FrameNode</span>) {</li><li>    <span class="hljs-comment">// 获取WaterFlow事件</span></li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">waterFlowEvent</span>: <span class="hljs-title class_">UIWaterFlowEvent</span> | <span class="hljs-literal">undefined</span> = typeNode.<span class="hljs-title function_">getEvent</span>(frameNode, <span class="hljs-string">'WaterFlow'</span>);</li><li>
</li><li>    <span class="hljs-comment">// 设置OnWillScroll事件</span></li><li>    waterFlowEvent?.<span class="hljs-title function_">setOnWillScroll</span>(<span class="hljs-function">(<span class="hljs-params">scrollOffset: <span class="hljs-built_in">number</span>, scrollState: ScrollState, scrollSource: ScrollSource</span>) =&gt;</span> {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'onWillScroll scrollOffset = ${scrollOffset}, scrollState = ${scrollState}, scrollSource = ${scrollSource}'</span>);</li><li>    });</li><li>
</li><li>    <span class="hljs-comment">// 设置OnDidScroll事件</span></li><li>    waterFlowEvent?.<span class="hljs-title function_">setOnDidScroll</span>(<span class="hljs-function">(<span class="hljs-params">scrollOffset: <span class="hljs-built_in">number</span>, scrollState: ScrollState</span>) =&gt;</span> {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'onDidScroll scrollOffset = ${scrollOffset}, scrollState = ${scrollState}'</span>);</li><li>    });</li><li>
</li><li>    <span class="hljs-comment">// 设置OnReachStart事件</span></li><li>    waterFlowEvent?.<span class="hljs-title function_">setOnReachStart</span>(<span class="hljs-function">() =&gt;</span> {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'onReachStart'</span>);</li><li>    });</li><li>
</li><li>    <span class="hljs-comment">// 设置OnReachEnd事件</span></li><li>    waterFlowEvent?.<span class="hljs-title function_">setOnReachEnd</span>(<span class="hljs-function">() =&gt;</span> {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'onReachEnd'</span>);</li><li>    });</li><li>
</li><li>    <span class="hljs-comment">// 设置OnScrollStart事件</span></li><li>    waterFlowEvent?.<span class="hljs-title function_">setOnScrollStart</span>(<span class="hljs-function">() =&gt;</span> {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'onScrollStart'</span>);</li><li>    });</li><li>
</li><li>    <span class="hljs-comment">// 设置OnScrollStop事件</span></li><li>    waterFlowEvent?.<span class="hljs-title function_">setOnScrollStop</span>(<span class="hljs-function">() =&gt;</span> {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'onScrollStop'</span>);</li><li>    });</li><li>
</li><li>    <span class="hljs-comment">// 设置OnScrollFrameBegin事件</span></li><li>    waterFlowEvent?.<span class="hljs-title function_">setOnScrollFrameBegin</span>(<span class="hljs-function">(<span class="hljs-params">offset: <span class="hljs-built_in">number</span>, state: ScrollState</span>) =&gt;</span> {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'onScrollFrameBegin offset = ${offset}, state = ${state}'</span>);</li><li>      <span class="hljs-keyword">return</span> <span class="hljs-literal">undefined</span>;</li><li>    });</li><li>
</li><li>    <span class="hljs-comment">// 设置OnScrollIndex事件</span></li><li>    waterFlowEvent?.<span class="hljs-title function_">setOnScrollIndex</span>(<span class="hljs-function">(<span class="hljs-params">first: <span class="hljs-built_in">number</span>, last: <span class="hljs-built_in">number</span></span>) =&gt;</span> {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'onScrollIndex start = ${first}, end = ${last}'</span>);</li><li>    });</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">index</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">myNodeController</span>: <span class="hljs-title class_">MyNodeController</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyNodeController</span>();</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">numbers</span>: <span class="hljs-built_in">string</span>[] = [];</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">heights</span>: <span class="hljs-built_in">number</span>[] = [];</li><li>
</li><li>  <span class="hljs-title function_">aboutToAppear</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">30</span>; i++) {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">numbers</span>.<span class="hljs-title function_">push</span>(<span class="hljs-string">'${i+1}'</span>);</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">heights</span>.<span class="hljs-title function_">push</span>(<span class="hljs-number">70</span> + <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">60</span>));</li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'add CommonEvent to WaterFlow'</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">myNodeController</span>!.<span class="hljs-title function_">addCommonEvent</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">myNodeController</span>!.<span class="hljs-property">rootNode</span>!.<span class="hljs-title function_">getParent</span>()!.<span class="hljs-title function_">getPreviousSibling</span>()!)</li><li>        })</li><li>      <span class="hljs-title class_">WaterFlow</span>() {</li><li>        <span class="hljs-title class_">ForEach</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">numbers</span>, <span class="hljs-function">(<span class="hljs-params">day: <span class="hljs-built_in">string</span>, index: <span class="hljs-built_in">number</span></span>) =&gt;</span> {</li><li>          <span class="hljs-title class_">FlowItem</span>() {</li><li>            <span class="hljs-title class_">Text</span>(day)</li><li>              .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">16</span>)</li><li>              .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-number">0xF9CF93</span>)</li><li>              .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>              .<span class="hljs-title function_">height</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">heights</span>[index])</li><li>              .<span class="hljs-title function_">textAlign</span>(<span class="hljs-title class_">TextAlign</span>.<span class="hljs-property">Center</span>)</li><li>          }</li><li>          .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>        }, <span class="hljs-function">(<span class="hljs-params">day: <span class="hljs-built_in">string</span>, index: <span class="hljs-built_in">number</span></span>) =&gt;</span> index.<span class="hljs-title function_">toString</span>() + day)</li><li>      }</li><li>      .<span class="hljs-title function_">columnsTemplate</span>(<span class="hljs-string">'1fr 1fr'</span>)</li><li>      .<span class="hljs-title function_">columnsGap</span>(<span class="hljs-number">10</span>)</li><li>      .<span class="hljs-title function_">rowsGap</span>(<span class="hljs-number">10</span>)</li><li>      .<span class="hljs-title function_">enableScrollInteraction</span>(<span class="hljs-literal">true</span>)</li><li>      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'90%'</span>)</li><li>      .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-number">0xFAEEE0</span>)</li><li>      .<span class="hljs-title function_">height</span>(<span class="hljs-number">300</span>)</li><li>      <span class="hljs-title class_">NodeContainer</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">myNodeController</span>)</li><li>    }.<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>   </div>   <div></div></div>