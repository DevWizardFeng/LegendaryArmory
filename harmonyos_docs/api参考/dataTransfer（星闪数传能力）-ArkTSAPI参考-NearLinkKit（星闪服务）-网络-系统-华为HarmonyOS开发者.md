<h1 _ngcontent-dvd-c119="" class="doc-title ng-star-inserted" title="dataTransfer（星闪数传能力）"> dataTransfer（星闪数传能力） </h1>

<div _ngcontent-dvd-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p>本模块提供了星闪数据传输的功能。</p>    <p><strong>起始版本：</strong>5.1.0(18)</p>    <div class="tiledSection">     <h2 id="section89301358134818" device-type="phone,2in1,tv,tablet,wearable">导入模块<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section89301358134818" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><div _ngcontent-dvd-c106="" class="highlight-div"><div _ngcontent-dvd-c106="" class="highlight-div-header"><div _ngcontent-dvd-c106="" class="highlight-div-header-left"><div _ngcontent-dvd-c106="" class="handle-button expand-button"><div _ngcontent-dvd-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-dvd-c106="" class="highlight-div-header-right"><div _ngcontent-dvd-c106="" class="handle-button ai-button"></div><div _ngcontent-dvd-c106="" class="handle-button line-button"><div _ngcontent-dvd-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-dvd-c106="" class="handle-button theme-button"><div _ngcontent-dvd-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-dvd-c106="" class="handle-button copy-button"><div _ngcontent-dvd-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-dvd-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { dataTransfer } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NearLinkKit'</span>;</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="section14942121015417" device-type="phone,2in1,tv,tablet,wearable">ConnectionState<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section14942121015417" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>type ConnectionState = <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/nearlink-constant#section14942121015417">constant.ConnectionState</a></p>     <p>表示和远端设备的连接状态，为枚举值。</p>     <p><strong>系统能力：</strong>SystemCapability.Communication.NearLink.Core</p>     <p><strong>起始版本：</strong>5.1.0(18)</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.4.6.1.3.1.1" width="26.179999999999996%">          <p>类型</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.4.6.1.3.1.2" width="73.82%">          <p>说明</p></th>        </tr><tr>         <td class="cellrowborder" width="26.179999999999996%">          <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/nearlink-constant#section14942121015417">constant.ConnectionState</a></p></td>         <td class="cellrowborder" width="73.82%">          <p>和远端设备的连接状态。</p></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="section19932155019" device-type="phone,2in1,tv,tablet,wearable">createPort<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section19932155019" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>createPort(uuid: string): void</p>     <p>注册端口通道。</p>     <p><strong>需要权限：</strong>ohos.permission.ACCESS_NEARLINK</p>     <p><strong>系统能力：</strong>SystemCapability.Communication.NearLink.Core</p>     <p><strong>起始版本：</strong>5.1.0(18)</p>     <div class="p">      <strong>参数：</strong>      <div class="tablenoborder">       <div class="tbBox"><table>        <thead>         <tr>          <th align="left" class="cellrowborder" id="mcps1.3.5.7.2.1.5.1.1" width="13.320000000000002%">           <p>参数名</p></th>          <th align="left" class="cellrowborder" id="mcps1.3.5.7.2.1.5.1.2" width="25.319999999999997%">           <p>类型</p></th>          <th align="left" class="cellrowborder" id="mcps1.3.5.7.2.1.5.1.3" width="7.12%">           <p>必填</p></th>          <th align="left" class="cellrowborder" id="mcps1.3.5.7.2.1.5.1.4" width="54.24%">           <p>说明</p></th>         </tr>        </thead>                 <tbody><tr>          <td class="cellrowborder" width="13.320000000000002%">           <p>uuid</p></td>          <td class="cellrowborder" width="25.319999999999997%">           <p>string</p></td>          <td class="cellrowborder" width="7.12%">           <p>是</p></td>          <td class="cellrowborder" width="54.24%">           <p>可填写16字节星闪服务UUID，或填写2字节支持数传的星闪标准服务UUID。UUID格式参考“<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/nearlink-faq#section1263634155618" target="_blank">星闪标准服务标识</a>”。</p></td>         </tr>               </tbody></table></div>      </div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/nearlink-error-code">ArkTS API错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.5.10.1.3.1.1" style="border: none;" width="49.419999999999995%">          <p>错误码ID</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.5.10.1.3.1.2" style="border: none;" width="50.580000000000005%">          <p>错误信息</p></th>        </tr><tr>         <td class="cellrowborder" style="border: none;" width="49.419999999999995%">          <p>201</p></td>         <td class="cellrowborder" style="border: none;" width="50.580000000000005%">          <p>Permission denied</p></td>        </tr>        <tr>         <td class="cellrowborder" style="border: none;" width="49.419999999999995%">          <p>401</p></td>         <td class="cellrowborder" style="border: none;" width="50.580000000000005%">          <p>Invalid parameter</p></td>        </tr>        <tr>         <td class="cellrowborder" style="border: none;" width="49.419999999999995%">          <p>801</p></td>         <td class="cellrowborder" style="border: none;" width="50.580000000000005%">          <p>Capability not supported</p></td>        </tr>        <tr>         <td class="cellrowborder" style="border: none;" width="49.419999999999995%">          <p>1009700003</p></td>         <td class="cellrowborder" style="border: none;" width="50.580000000000005%">          <p>Nearlink is off</p></td>        </tr>        <tr>         <td class="cellrowborder" style="border: none;" width="49.419999999999995%">          <p>1009700020</p></td>         <td class="cellrowborder" style="border: none;" width="50.580000000000005%">          <p>The UUID is already registered</p></td>        </tr>        <tr>         <td class="cellrowborder" style="border: none;" width="49.419999999999995%">          <p>1009700021</p></td>         <td class="cellrowborder" style="border: none;" width="50.580000000000005%">          <p>Port is exceeds the upper limit</p></td>        </tr>        <tr>         <td class="cellrowborder" style="border: none;" width="49.419999999999995%">          <p>1009700099</p></td>         <td class="cellrowborder" style="border: none;" width="50.580000000000005%">          <p>Operation failed</p></td>        </tr>             </tbody></table></div>     </div>     <div class="p">      <strong>示例：</strong>      <div _ngcontent-dvd-c106="" class="highlight-div"><div _ngcontent-dvd-c106="" class="highlight-div-header"><div _ngcontent-dvd-c106="" class="highlight-div-header-left"><div _ngcontent-dvd-c106="" class="handle-button expand-button"><div _ngcontent-dvd-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-dvd-c106="" class="highlight-div-header-right"><div _ngcontent-dvd-c106="" class="handle-button ai-button"></div><div _ngcontent-dvd-c106="" class="handle-button line-button"><div _ngcontent-dvd-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-dvd-c106="" class="handle-button theme-button"><div _ngcontent-dvd-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-dvd-c106="" class="handle-button copy-button"><div _ngcontent-dvd-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-dvd-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { dataTransfer} <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NearLinkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">try</span> {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">uuid</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'FFFFFFFF-FC70-11EA-B720-000078951234'</span>; <span class="hljs-comment">// 星闪服务UUID</span></li><li>  dataTransfer.<span class="hljs-title function_">createPort</span>(uuid);</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'create port success'</span>);</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>     </div>    </div>    <div class="tiledSection">     <h2 id="section3370134820197" device-type="phone,2in1,tv,tablet,wearable">destroyPort<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section3370134820197" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>destroyPort(uuid: string): void</p>     <p>销毁端口通道。</p>     <p><strong>需要权限：</strong>ohos.permission.ACCESS_NEARLINK</p>     <p><strong>系统能力：</strong>SystemCapability.Communication.NearLink.Core</p>     <p><strong>起始版本：</strong>5.1.0(18)</p>     <div class="p">      <strong>参数：</strong>      <div class="tablenoborder">       <div class="tbBox"><table>        <thead>         <tr>          <th align="left" class="cellrowborder" id="mcps1.3.6.7.2.1.5.1.1" width="13.320000000000002%">           <p>参数名</p></th>          <th align="left" class="cellrowborder" id="mcps1.3.6.7.2.1.5.1.2" width="25.319999999999997%">           <p>类型</p></th>          <th align="left" class="cellrowborder" id="mcps1.3.6.7.2.1.5.1.3" width="7.12%">           <p>必填</p></th>          <th align="left" class="cellrowborder" id="mcps1.3.6.7.2.1.5.1.4" width="54.24%">           <p>说明</p></th>         </tr>        </thead>                 <tbody><tr>          <td class="cellrowborder" width="13.320000000000002%">           <p>uuid</p></td>          <td class="cellrowborder" width="25.319999999999997%">           <p>string</p></td>          <td class="cellrowborder" width="7.12%">           <p>是</p></td>          <td class="cellrowborder" width="54.24%">           <p>可填写16字节星闪服务UUID，或填写2字节支持数传的星闪标准服务UUID。UUID格式参考“<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/nearlink-faq#section1263634155618" target="_blank">星闪标准服务</a>”。</p></td>         </tr>               </tbody></table></div>      </div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/nearlink-error-code">ArkTS API错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.6.10.1.3.1.1" style="border: none;" width="49.419999999999995%">          <p>错误码ID</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.6.10.1.3.1.2" style="border: none;" width="50.580000000000005%">          <p>错误信息</p></th>        </tr><tr>         <td class="cellrowborder" style="border: none;" width="49.419999999999995%">          <p>201</p></td>         <td class="cellrowborder" style="border: none;" width="50.580000000000005%">          <p>Permission denied</p></td>        </tr>        <tr>         <td class="cellrowborder" style="border: none;" width="49.419999999999995%">          <p>401</p></td>         <td class="cellrowborder" style="border: none;" width="50.580000000000005%">          <p>Invalid parameter</p></td>        </tr>        <tr>         <td class="cellrowborder" style="border: none;" width="49.419999999999995%">          <p>801</p></td>         <td class="cellrowborder" style="border: none;" width="50.580000000000005%">          <p>Capability not supported</p></td>        </tr>        <tr>         <td class="cellrowborder" style="border: none;" width="49.419999999999995%">          <p>1009700003</p></td>         <td class="cellrowborder" style="border: none;" width="50.580000000000005%">          <p>Nearlink is off</p></td>        </tr>        <tr>         <td class="cellrowborder" style="border: none;" width="49.419999999999995%">          <p>1009700022</p></td>         <td class="cellrowborder" style="border: none;" width="50.580000000000005%">          <p>The UUID is not registered</p></td>        </tr>        <tr>         <td class="cellrowborder" style="border: none;" width="49.419999999999995%">          <p>1009700099</p></td>         <td class="cellrowborder" style="border: none;" width="50.580000000000005%">          <p>Operation failed</p></td>        </tr>             </tbody></table></div>     </div>     <div class="p">      <strong>示例：</strong>      <div _ngcontent-dvd-c106="" class="highlight-div"><div _ngcontent-dvd-c106="" class="highlight-div-header"><div _ngcontent-dvd-c106="" class="highlight-div-header-left"><div _ngcontent-dvd-c106="" class="handle-button expand-button"><div _ngcontent-dvd-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-dvd-c106="" class="highlight-div-header-right"><div _ngcontent-dvd-c106="" class="handle-button ai-button"></div><div _ngcontent-dvd-c106="" class="handle-button line-button"><div _ngcontent-dvd-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-dvd-c106="" class="handle-button theme-button"><div _ngcontent-dvd-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-dvd-c106="" class="handle-button copy-button"><div _ngcontent-dvd-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-dvd-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { dataTransfer} <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NearLinkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">try</span> {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">uuid</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'FFFFFFFF-FC70-11EA-B720-000078951234'</span>; <span class="hljs-comment">// 星闪服务UUID</span></li><li>  dataTransfer.<span class="hljs-title function_">destroyPort</span>(uuid);</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'destroy port success'</span>);</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>     </div>    </div>    <div class="tiledSection">     <h2 id="section1047122612211" device-type="phone,2in1,tv,tablet,wearable">connect<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section1047122612211" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>connect(params: ConnectionParams): Promise&lt;void&gt;</p>     <p>连接远端设备，建立端口通道。使用Promise异步回调。</p>     <p><strong>需要权限：</strong>ohos.permission.ACCESS_NEARLINK</p>     <p><strong>系统能力：</strong>SystemCapability.Communication.NearLink.Core</p>     <p><strong>起始版本：</strong>5.1.0(18)</p>     <div class="p">      <strong>参数：</strong>      <div class="tablenoborder">       <div class="tbBox"><table>        <thead>         <tr>          <th align="left" class="cellrowborder" id="mcps1.3.7.7.2.1.5.1.1" width="13.320000000000002%">           <p>参数名</p></th>          <th align="left" class="cellrowborder" id="mcps1.3.7.7.2.1.5.1.2" width="25.319999999999997%">           <p>类型</p></th>          <th align="left" class="cellrowborder" id="mcps1.3.7.7.2.1.5.1.3" width="7.12%">           <p>必填</p></th>          <th align="left" class="cellrowborder" id="mcps1.3.7.7.2.1.5.1.4" width="54.24%">           <p>说明</p></th>         </tr>        </thead>                 <tbody><tr>          <td class="cellrowborder" width="13.320000000000002%">           <p>params</p></td>          <td class="cellrowborder" width="25.319999999999997%">           <p><a href="/consumer/cn/doc/harmonyos-references/nearlink-data-transfer-api#section85111632162516">ConnectionParams</a></p></td>          <td class="cellrowborder" width="7.12%">           <p>是</p></td>          <td class="cellrowborder" width="54.24%">           <p>指明端口的连接参数。</p></td>         </tr>               </tbody></table></div>      </div>     </div>     <div class="p">      <strong>返回值：</strong>      <div class="tablenoborder">       <div class="tbBox"><table class="tableClass2_t">                         <tbody><tr class="firstRow">          <th align="left" class="cellrowborder" id="mcps1.3.7.8.2.1.3.1.1" width="28.050000000000004%">           <p>类型</p></th>          <th align="left" class="cellrowborder" id="mcps1.3.7.8.2.1.3.1.2" width="71.95%">           <p>说明</p></th>         </tr><tr>          <td class="cellrowborder" width="28.050000000000004%">           <p>Promise&lt;void&gt;</p></td>          <td class="cellrowborder" width="71.95%">           <p>Promise对象，无返回值。</p></td>         </tr>               </tbody></table></div>      </div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/nearlink-error-code">ArkTS API错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.7.11.1.3.1.1" style="border: none;" width="49.419999999999995%">          <p>错误码ID</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.7.11.1.3.1.2" style="border: none;" width="50.580000000000005%">          <p>错误信息</p></th>        </tr><tr>         <td class="cellrowborder" style="border: none;" width="49.419999999999995%">          <p>201</p></td>         <td class="cellrowborder" style="border: none;" width="50.580000000000005%">          <p>Permission denied</p></td>        </tr>        <tr>         <td class="cellrowborder" style="border: none;" width="49.419999999999995%">          <p>401</p></td>         <td class="cellrowborder" style="border: none;" width="50.580000000000005%">          <p>Invalid parameter</p></td>        </tr>        <tr>         <td class="cellrowborder" style="border: none;" width="49.419999999999995%">          <p>801</p></td>         <td class="cellrowborder" style="border: none;" width="50.580000000000005%">          <p>Capability not supported</p></td>        </tr>        <tr>         <td class="cellrowborder" style="border: none;" width="49.419999999999995%">          <p>1009700003</p></td>         <td class="cellrowborder" style="border: none;" width="50.580000000000005%">          <p>Nearlink is off</p></td>        </tr>        <tr>         <td class="cellrowborder" style="border: none;" width="49.419999999999995%">          <p>1009700099</p></td>         <td class="cellrowborder" style="border: none;" width="50.580000000000005%">          <p>Operation failed</p></td>        </tr>             </tbody></table></div>     </div>     <div class="p">      <strong>示例：</strong>      <div _ngcontent-dvd-c106="" class="highlight-div"><div _ngcontent-dvd-c106="" class="highlight-div-header"><div _ngcontent-dvd-c106="" class="highlight-div-header-left"><div _ngcontent-dvd-c106="" class="handle-button expand-button"><div _ngcontent-dvd-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-dvd-c106="" class="highlight-div-header-right"><div _ngcontent-dvd-c106="" class="handle-button ai-button"></div><div _ngcontent-dvd-c106="" class="handle-button line-button"><div _ngcontent-dvd-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-dvd-c106="" class="handle-button theme-button"><div _ngcontent-dvd-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-dvd-c106="" class="handle-button copy-button"><div _ngcontent-dvd-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-dvd-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { dataTransfer} <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NearLinkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">try</span> {</li><li>  <span class="hljs-comment">// 构造端口通道建立的参数</span></li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">connectionParams</span>:dataTransfer.<span class="hljs-property">ConnectionParams</span> = {</li><li>    <span class="hljs-attr">address</span>: <span class="hljs-string">'01:02:03:04:05:06'</span>, <span class="hljs-comment">// 星闪远端设备地址</span></li><li>    <span class="hljs-attr">uuid</span>: <span class="hljs-string">'37BEA880-FC70-11EA-B720-00000000060D'</span>, <span class="hljs-comment">// 星闪服务UUID</span></li><li>    <span class="hljs-attr">mtu</span>: <span class="hljs-number">1024</span>, <span class="hljs-comment">// 期望发送数据包的字节大小,可选参数</span></li><li>  };</li><li>  dataTransfer.<span class="hljs-title function_">connect</span>(connectionParams).<span class="hljs-title function_">then</span>(<span class="hljs-function">()=&gt;</span>{</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'connect success'</span>);</li><li>  });</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>     </div>    </div>    <div class="tiledSection">     <h2 id="section14880194212257" device-type="phone,2in1,tv,tablet,wearable">disconnect<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section14880194212257" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>disconnect(params: ConnectionParams): Promise&lt;void&gt;</p>     <p>断连远端设备，销毁端口通道。使用Promise异步回调。</p>     <p><strong>需要权限：</strong>ohos.permission.ACCESS_NEARLINK</p>     <p><strong>系统能力：</strong>SystemCapability.Communication.NearLink.Core</p>     <p><strong>起始版本：</strong>5.1.0(18)</p>     <div class="p">      <strong>参数：</strong>      <div class="tablenoborder">       <div class="tbBox"><table>        <thead>         <tr>          <th align="left" class="cellrowborder" id="mcps1.3.8.7.2.1.5.1.1" width="13.320000000000002%">           <p>参数名</p></th>          <th align="left" class="cellrowborder" id="mcps1.3.8.7.2.1.5.1.2" width="25.319999999999997%">           <p>类型</p></th>          <th align="left" class="cellrowborder" id="mcps1.3.8.7.2.1.5.1.3" width="7.12%">           <p>必填</p></th>          <th align="left" class="cellrowborder" id="mcps1.3.8.7.2.1.5.1.4" width="54.24%">           <p>说明</p></th>         </tr>        </thead>                 <tbody><tr>          <td class="cellrowborder" width="13.320000000000002%">           <p>params</p></td>          <td class="cellrowborder" width="25.319999999999997%">           <p><a href="/consumer/cn/doc/harmonyos-references/nearlink-data-transfer-api#section85111632162516">ConnectionParams</a></p></td>          <td class="cellrowborder" width="7.12%">           <p>是</p></td>          <td class="cellrowborder" width="54.24%">           <p>指明端口的连接参数。</p></td>         </tr>               </tbody></table></div>      </div>     </div>     <div class="p">      <strong>返回值：</strong>      <div class="tablenoborder">       <div class="tbBox"><table class="tableClass2_t">                         <tbody><tr class="firstRow">          <th align="left" class="cellrowborder" id="mcps1.3.8.8.2.1.3.1.1" width="28.050000000000004%">           <p>类型</p></th>          <th align="left" class="cellrowborder" id="mcps1.3.8.8.2.1.3.1.2" width="71.95%">           <p>说明</p></th>         </tr><tr>          <td class="cellrowborder" width="28.050000000000004%">           <p>Promise&lt;void&gt;</p></td>          <td class="cellrowborder" width="71.95%">           <p>Promise对象，无返回值。</p></td>         </tr>               </tbody></table></div>      </div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/nearlink-error-code">ArkTS API错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.8.11.1.3.1.1" style="border: none;" width="49.419999999999995%">          <p>错误码ID</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.8.11.1.3.1.2" style="border: none;" width="50.580000000000005%">          <p>错误信息</p></th>        </tr><tr>         <td class="cellrowborder" style="border: none;" width="49.419999999999995%">          <p>201</p></td>         <td class="cellrowborder" style="border: none;" width="50.580000000000005%">          <p>Permission denied</p></td>        </tr>        <tr>         <td class="cellrowborder" style="border: none;" width="49.419999999999995%">          <p>401</p></td>         <td class="cellrowborder" style="border: none;" width="50.580000000000005%">          <p>Invalid parameter</p></td>        </tr>        <tr>         <td class="cellrowborder" style="border: none;" width="49.419999999999995%">          <p>801</p></td>         <td class="cellrowborder" style="border: none;" width="50.580000000000005%">          <p>Capability not supported</p></td>        </tr>        <tr>         <td class="cellrowborder" style="border: none;" width="49.419999999999995%">          <p>1009700003</p></td>         <td class="cellrowborder" style="border: none;" width="50.580000000000005%">          <p>Nearlink is off</p></td>        </tr>        <tr>         <td class="cellrowborder" style="border: none;" width="49.419999999999995%">          <p>1009700099</p></td>         <td class="cellrowborder" style="border: none;" width="50.580000000000005%">          <p>Operation failed</p></td>        </tr>             </tbody></table></div>     </div>     <div class="p">      <strong>示例：</strong>      <div _ngcontent-dvd-c106="" class="highlight-div"><div _ngcontent-dvd-c106="" class="highlight-div-header"><div _ngcontent-dvd-c106="" class="highlight-div-header-left"><div _ngcontent-dvd-c106="" class="handle-button expand-button"><div _ngcontent-dvd-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-dvd-c106="" class="highlight-div-header-right"><div _ngcontent-dvd-c106="" class="handle-button ai-button"></div><div _ngcontent-dvd-c106="" class="handle-button line-button"><div _ngcontent-dvd-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-dvd-c106="" class="handle-button theme-button"><div _ngcontent-dvd-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-dvd-c106="" class="handle-button copy-button"><div _ngcontent-dvd-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-dvd-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { dataTransfer} <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NearLinkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">try</span> {</li><li>  <span class="hljs-comment">// 构造端口通道建立的参数</span></li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">connectionParams</span>:dataTransfer.<span class="hljs-property">ConnectionParams</span> = {</li><li>    <span class="hljs-attr">address</span>: <span class="hljs-string">'01:02:03:04:05:06'</span>, <span class="hljs-comment">// 星闪远端设备地址</span></li><li>    <span class="hljs-attr">uuid</span>: <span class="hljs-string">'37BEA880-FC70-11EA-B720-00000000060D'</span>, <span class="hljs-comment">// 星闪服务UUID</span></li><li>    <span class="hljs-attr">mtu</span>: <span class="hljs-number">1024</span>, <span class="hljs-comment">// 期望发送数据包的字节大小，可选参数</span></li><li>  };</li><li>  dataTransfer.<span class="hljs-title function_">disconnect</span>(connectionParams).<span class="hljs-title function_">then</span>(<span class="hljs-function">()=&gt;</span>{</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'disconnect success'</span>);</li><li>  });</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>     </div>    </div>    <div class="tiledSection">     <h2 id="section1259823863112" device-type="phone,2in1,tv,tablet,wearable">on('connectionStateChanged')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section1259823863112" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>on(type: 'connectionStateChanged', callback: Callback&lt;ConnectionResult&gt;): void</p>     <p>订阅端口通道连接状态变更事件。</p>     <p><strong>需要权限：</strong>ohos.permission.ACCESS_NEARLINK</p>     <p><strong>系统能力：</strong>SystemCapability.Communication.NearLink.Core</p>     <p><strong>起始版本：</strong>5.1.0(18)</p>     <div class="p">      <strong>参数：</strong>      <div class="tablenoborder">       <div class="tbBox"><table>        <thead>         <tr>          <th align="left" class="cellrowborder" id="mcps1.3.9.7.2.1.5.1.1" width="13.320000000000002%">           <p>参数名</p></th>          <th align="left" class="cellrowborder" id="mcps1.3.9.7.2.1.5.1.2" width="25.319999999999997%">           <p>类型</p></th>          <th align="left" class="cellrowborder" id="mcps1.3.9.7.2.1.5.1.3" width="7.12%">           <p>必填</p></th>          <th align="left" class="cellrowborder" id="mcps1.3.9.7.2.1.5.1.4" width="54.24%">           <p>说明</p></th>         </tr>        </thead>                 <tbody><tr>          <td class="cellrowborder" width="13.320000000000002%">           <p>type</p></td>          <td class="cellrowborder" width="25.319999999999997%">           <p>string</p></td>          <td class="cellrowborder" width="7.12%">           <p>是</p></td>          <td class="cellrowborder" width="54.24%">           <p>固定填写"connectionStateChanged"字符串，表示端口通道连接状态变更事件。</p></td>         </tr>         <tr>          <td class="cellrowborder" width="13.320000000000002%">           <p>callback</p></td>          <td class="cellrowborder" width="25.319999999999997%">           <p>Callback&lt;<a href="/consumer/cn/doc/harmonyos-references/nearlink-data-transfer-api#section149561050194010">ConnectionResult</a>&gt;</p></td>          <td class="cellrowborder" width="7.12%">           <p>是</p></td>          <td class="cellrowborder" width="54.24%">           <p>表示端口通道连接状态变化回调函数的入参，回调函数由用户创建通过该接口注册。</p></td>         </tr>               </tbody></table></div>      </div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/nearlink-error-code">ArkTS API错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.9.10.1.3.1.1" style="border: none;" width="49.419999999999995%">          <p>错误码ID</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.9.10.1.3.1.2" style="border: none;" width="50.580000000000005%">          <p>错误信息</p></th>        </tr><tr>         <td class="cellrowborder" style="border: none;" width="49.419999999999995%">          <p>201</p></td>         <td class="cellrowborder" style="border: none;" width="50.580000000000005%">          <p>Permission denied</p></td>        </tr>        <tr>         <td class="cellrowborder" style="border: none;" width="49.419999999999995%">          <p>401</p></td>         <td class="cellrowborder" style="border: none;" width="50.580000000000005%">          <p>Invalid parameter</p></td>        </tr>        <tr>         <td class="cellrowborder" style="border: none;" width="49.419999999999995%">          <p>801</p></td>         <td class="cellrowborder" style="border: none;" width="50.580000000000005%">          <p>Capability not supported</p></td>        </tr>        <tr>         <td class="cellrowborder" style="border: none;" width="49.419999999999995%">          <p>1009700099</p></td>         <td class="cellrowborder" style="border: none;" width="50.580000000000005%">          <p>Operation failed</p></td>        </tr>             </tbody></table></div>     </div>     <div class="p">      <strong>示例：</strong>      <div _ngcontent-dvd-c106="" class="highlight-div"><div _ngcontent-dvd-c106="" class="highlight-div-header"><div _ngcontent-dvd-c106="" class="highlight-div-header-left"><div _ngcontent-dvd-c106="" class="handle-button expand-button"><div _ngcontent-dvd-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-dvd-c106="" class="highlight-div-header-right"><div _ngcontent-dvd-c106="" class="handle-button ai-button"></div><div _ngcontent-dvd-c106="" class="handle-button line-button"><div _ngcontent-dvd-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-dvd-c106="" class="handle-button theme-button"><div _ngcontent-dvd-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-dvd-c106="" class="handle-button copy-button"><div _ngcontent-dvd-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-dvd-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { dataTransfer} <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NearLinkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Callback</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">callback</span>: <span class="hljs-title class_">Callback</span>&lt;dataTransfer.<span class="hljs-property">ConnectionResult</span>&gt; = <span class="hljs-function">(<span class="hljs-params">data: dataTransfer.ConnectionResult</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'data: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data));</li><li>};</li><li><span class="hljs-keyword">try</span> {</li><li>  dataTransfer.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connectionStateChanged'</span>, callback);</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>     </div>    </div>    <div class="tiledSection">     <h2 id="section1095216210383" device-type="phone,2in1,tv,tablet,wearable">off('connectionStateChanged')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section1095216210383" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>off(type: 'connectionStateChanged', callback?: Callback&lt;ConnectionResult&gt;): void</p>     <p>取消订阅端口通道连接状态变更事件。</p>     <p><strong>需要权限：</strong>ohos.permission.ACCESS_NEARLINK</p>     <p><strong>系统能力：</strong>SystemCapability.Communication.NearLink.Core</p>     <p><strong>起始版本：</strong>5.1.0(18)</p>     <div class="p">      <strong>参数：</strong>      <div class="tablenoborder">       <div class="tbBox"><table>        <thead>         <tr>          <th align="left" class="cellrowborder" id="mcps1.3.10.7.2.1.5.1.1" width="13.320000000000002%">           <p>参数名</p></th>          <th align="left" class="cellrowborder" id="mcps1.3.10.7.2.1.5.1.2" width="25.319999999999997%">           <p>类型</p></th>          <th align="left" class="cellrowborder" id="mcps1.3.10.7.2.1.5.1.3" width="7.12%">           <p>必填</p></th>          <th align="left" class="cellrowborder" id="mcps1.3.10.7.2.1.5.1.4" width="54.24%">           <p>说明</p></th>         </tr>        </thead>                 <tbody><tr>          <td class="cellrowborder" width="13.320000000000002%">           <p>type</p></td>          <td class="cellrowborder" width="25.319999999999997%">           <p>string</p></td>          <td class="cellrowborder" width="7.12%">           <p>是</p></td>          <td class="cellrowborder" width="54.24%">           <p>固定填写"connectionStateChanged"字符串，表示端口通道连接状态变更事件。</p></td>         </tr>         <tr>          <td class="cellrowborder" width="13.320000000000002%">           <p>callback</p></td>          <td class="cellrowborder" width="25.319999999999997%">           <p>Callback&lt;<a href="/consumer/cn/doc/harmonyos-references/nearlink-data-transfer-api#section149561050194010">ConnectionResult</a>&gt;</p></td>          <td class="cellrowborder" width="7.12%">           <p>否</p></td>          <td class="cellrowborder" width="54.24%">           <p>可选参数，需要取消注册的回调函数，需与订阅时传入的回调函数是同一个。若无此参数，则取消注册所有的回调函数。</p></td>         </tr>               </tbody></table></div>      </div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/nearlink-error-code">ArkTS API错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.10.10.1.3.1.1" style="border: none;" width="49.419999999999995%">          <p>错误码ID</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.10.10.1.3.1.2" style="border: none;" width="50.580000000000005%">          <p>错误信息</p></th>        </tr><tr>         <td class="cellrowborder" style="border: none;" width="49.419999999999995%">          <p>201</p></td>         <td class="cellrowborder" style="border: none;" width="50.580000000000005%">          <p>Permission denied</p></td>        </tr>        <tr>         <td class="cellrowborder" style="border: none;" width="49.419999999999995%">          <p>401</p></td>         <td class="cellrowborder" style="border: none;" width="50.580000000000005%">          <p>Invalid parameter</p></td>        </tr>        <tr>         <td class="cellrowborder" style="border: none;" width="49.419999999999995%">          <p>801</p></td>         <td class="cellrowborder" style="border: none;" width="50.580000000000005%">          <p>Capability not supported</p></td>        </tr>        <tr>         <td class="cellrowborder" style="border: none;" width="49.419999999999995%">          <p>1009700099</p></td>         <td class="cellrowborder" style="border: none;" width="50.580000000000005%">          <p>Operation failed</p></td>        </tr>             </tbody></table></div>     </div>     <div class="p">      <strong>示例：</strong>      <div _ngcontent-dvd-c106="" class="highlight-div"><div _ngcontent-dvd-c106="" class="highlight-div-header"><div _ngcontent-dvd-c106="" class="highlight-div-header-left"><div _ngcontent-dvd-c106="" class="handle-button expand-button"><div _ngcontent-dvd-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-dvd-c106="" class="highlight-div-header-right"><div _ngcontent-dvd-c106="" class="handle-button ai-button"></div><div _ngcontent-dvd-c106="" class="handle-button line-button"><div _ngcontent-dvd-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-dvd-c106="" class="handle-button theme-button"><div _ngcontent-dvd-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-dvd-c106="" class="handle-button copy-button"><div _ngcontent-dvd-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-dvd-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { dataTransfer} <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NearLinkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">try</span> {</li><li>  dataTransfer.<span class="hljs-title function_">off</span>(<span class="hljs-string">'connectionStateChanged'</span>);</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>     </div>    </div>    <div class="tiledSection">     <h2 id="section9446731153818" device-type="phone,2in1,tv,tablet,wearable">getConnectionState<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section9446731153818" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>getConnectionState(params: ConnectionStateParams): ConnectionState</p>     <p>获取与远端设备之间的端口通道连接状态。</p>     <p><strong>需要权限：</strong>ohos.permission.ACCESS_NEARLINK</p>     <p><strong>系统能力：</strong>SystemCapability.Communication.NearLink.Core</p>     <p><strong>起始版本：</strong>5.1.0(18)</p>     <div class="p">      <strong>参数：</strong>      <div class="tablenoborder">       <div class="tbBox"><table>        <thead>         <tr>          <th align="left" class="cellrowborder" id="mcps1.3.11.7.2.1.5.1.1" width="13.320000000000002%">           <p>参数名</p></th>          <th align="left" class="cellrowborder" id="mcps1.3.11.7.2.1.5.1.2" width="25.319999999999997%">           <p>类型</p></th>          <th align="left" class="cellrowborder" id="mcps1.3.11.7.2.1.5.1.3" width="7.12%">           <p>必填</p></th>          <th align="left" class="cellrowborder" id="mcps1.3.11.7.2.1.5.1.4" width="54.24%">           <p>说明</p></th>         </tr>        </thead>                 <tbody><tr>          <td class="cellrowborder" width="13.320000000000002%">           <p>params</p></td>          <td class="cellrowborder" width="25.319999999999997%">           <p><a href="/consumer/cn/doc/harmonyos-references/nearlink-data-transfer-api#section1230716832813">ConnectionStateParams</a></p></td>          <td class="cellrowborder" width="7.12%">           <p>是</p></td>          <td class="cellrowborder" width="54.24%">           <p>指明端口的连接参数。</p></td>         </tr>               </tbody></table></div>      </div>     </div>     <div class="p">      <strong>返回值：</strong>      <div class="tablenoborder">       <div class="tbBox"><table class="tableClass2_t">                         <tbody><tr class="firstRow">          <th align="left" class="cellrowborder" id="mcps1.3.11.8.2.1.3.1.1" width="28.050000000000004%">           <p>类型</p></th>          <th align="left" class="cellrowborder" id="mcps1.3.11.8.2.1.3.1.2" width="71.95%">           <p>说明</p></th>         </tr><tr>          <td class="cellrowborder" width="28.050000000000004%">           <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/nearlink-constant#section14942121015417">ConnectionState</a></p></td>          <td class="cellrowborder" width="71.95%">           <p>和远端设备的星闪端口通道连接状态。</p></td>         </tr>               </tbody></table></div>      </div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/nearlink-error-code">ArkTS API错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.11.11.1.3.1.1" style="border: none;" width="49.419999999999995%">          <p>错误码ID</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.11.11.1.3.1.2" style="border: none;" width="50.580000000000005%">          <p>错误信息</p></th>        </tr><tr>         <td class="cellrowborder" style="border: none;" width="49.419999999999995%">          <p>201</p></td>         <td class="cellrowborder" style="border: none;" width="50.580000000000005%">          <p>Permission denied</p></td>        </tr>        <tr>         <td class="cellrowborder" style="border: none;" width="49.419999999999995%">          <p>401</p></td>         <td class="cellrowborder" style="border: none;" width="50.580000000000005%">          <p>Parameter error. Possible causes: 1. Mandatory parameters are left unspecified; 2. Incorrect parameter types; 3. Parameter verification failed.</p></td>        </tr>        <tr>         <td class="cellrowborder" style="border: none;" width="49.419999999999995%">          <p>801</p></td>         <td class="cellrowborder" style="border: none;" width="50.580000000000005%">          <p>Capability not supported</p></td>        </tr>        <tr>         <td class="cellrowborder" style="border: none;" width="49.419999999999995%">          <p>1009700003</p></td>         <td class="cellrowborder" style="border: none;" width="50.580000000000005%">          <p>NearLink is off</p></td>        </tr>        <tr>         <td class="cellrowborder" style="border: none;" width="49.419999999999995%">          <p>1009700099</p></td>         <td class="cellrowborder" style="border: none;" width="50.580000000000005%">          <p>Operation failed</p></td>        </tr>             </tbody></table></div>     </div>     <div class="p">      <strong>示例：</strong>      <div _ngcontent-dvd-c106="" class="highlight-div"><div _ngcontent-dvd-c106="" class="highlight-div-header"><div _ngcontent-dvd-c106="" class="highlight-div-header-left"><div _ngcontent-dvd-c106="" class="handle-button expand-button"><div _ngcontent-dvd-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-dvd-c106="" class="highlight-div-header-right"><div _ngcontent-dvd-c106="" class="handle-button ai-button"></div><div _ngcontent-dvd-c106="" class="handle-button line-button"><div _ngcontent-dvd-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-dvd-c106="" class="handle-button theme-button"><div _ngcontent-dvd-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-dvd-c106="" class="handle-button copy-button"><div _ngcontent-dvd-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-dvd-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { dataTransfer } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NearLinkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">try</span> {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">connectionStateParams</span>:dataTransfer.<span class="hljs-property">ConnectionStateParams</span> = {</li><li>    <span class="hljs-attr">address</span>: <span class="hljs-string">'01:02:03:04:05:06'</span>, <span class="hljs-comment">// 扫描获取到的远端设备地址</span></li><li>    <span class="hljs-attr">uuid</span>: <span class="hljs-string">'FFFFFFFF-FC70-11EA-B720-000078951234'</span> <span class="hljs-comment">// 星闪服务UUID示例</span></li><li>  };</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">state</span>:dataTransfer.<span class="hljs-property">ConnectionState</span> = dataTransfer.<span class="hljs-property">getConnectionState</span> (connectionStateParams);</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'state:'</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(state));</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>     </div>    </div>    <div class="tiledSection">     <h2 id="section5484100194119" device-type="phone,2in1,tv,tablet,wearable">writeData<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section5484100194119" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>writeData(params: DataParams): Promise&lt;void&gt;</p>     <p>通过设备地址和uuid向远端设备发数据。使用Promise异步回调。</p>     <p><strong>需要权限：</strong>ohos.permission.ACCESS_NEARLINK</p>     <p><strong>系统能力：</strong>SystemCapability.Communication.NearLink.Core</p>     <p><strong>起始版本：</strong>5.1.0(18)</p>     <div class="p">      <strong>参数：</strong>      <div class="tablenoborder">       <div class="tbBox"><table>        <thead>         <tr>          <th align="left" class="cellrowborder" id="mcps1.3.12.7.2.1.5.1.1" width="13.320000000000002%">           <p>参数名</p></th>          <th align="left" class="cellrowborder" id="mcps1.3.12.7.2.1.5.1.2" width="25.319999999999997%">           <p>类型</p></th>          <th align="left" class="cellrowborder" id="mcps1.3.12.7.2.1.5.1.3" width="7.12%">           <p>必填</p></th>          <th align="left" class="cellrowborder" id="mcps1.3.12.7.2.1.5.1.4" width="54.24%">           <p>说明</p></th>         </tr>        </thead>                 <tbody><tr>          <td class="cellrowborder" width="13.320000000000002%">           <p>params</p></td>          <td class="cellrowborder" width="25.319999999999997%">           <p><a href="/consumer/cn/doc/harmonyos-references/nearlink-data-transfer-api#section181874974014">DataParams</a></p></td>          <td class="cellrowborder" width="7.12%">           <p>是</p></td>          <td class="cellrowborder" width="54.24%">           <p>指明发送数据的参数，包含远端设备地址、服务UUID以及发送的数据包。</p></td>         </tr>               </tbody></table></div>      </div>     </div>     <div class="p">      <strong>返回值：</strong>      <div class="tablenoborder">       <div class="tbBox"><table class="tableClass2_t">                         <tbody><tr class="firstRow">          <th align="left" class="cellrowborder" id="mcps1.3.12.8.2.1.3.1.1" width="28.050000000000004%">           <p>类型</p></th>          <th align="left" class="cellrowborder" id="mcps1.3.12.8.2.1.3.1.2" width="71.95%">           <p>说明</p></th>         </tr><tr>          <td class="cellrowborder" width="28.050000000000004%">           <p>Promise&lt;void&gt;</p></td>          <td class="cellrowborder" width="71.95%">           <p>Promise对象，无返回值。</p></td>         </tr>               </tbody></table></div>      </div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/nearlink-error-code">ArkTS API错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.12.11.1.3.1.1" style="border: none;" width="49.419999999999995%">          <p>错误码ID</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.12.11.1.3.1.2" style="border: none;" width="50.580000000000005%">          <p>错误信息</p></th>        </tr><tr>         <td class="cellrowborder" style="border: none;" width="49.419999999999995%">          <p>201</p></td>         <td class="cellrowborder" style="border: none;" width="50.580000000000005%">          <p>Permission denied</p></td>        </tr>        <tr>         <td class="cellrowborder" style="border: none;" width="49.419999999999995%">          <p>401</p></td>         <td class="cellrowborder" style="border: none;" width="50.580000000000005%">          <p>Invalid parameter</p></td>        </tr>        <tr>         <td class="cellrowborder" style="border: none;" width="49.419999999999995%">          <p>801</p></td>         <td class="cellrowborder" style="border: none;" width="50.580000000000005%">          <p>Capability not supported</p></td>        </tr>        <tr>         <td class="cellrowborder" style="border: none;" width="49.419999999999995%">          <p>1009700003</p></td>         <td class="cellrowborder" style="border: none;" width="50.580000000000005%">          <p>Nearlink is off</p></td>        </tr>        <tr>         <td class="cellrowborder" style="border: none;" width="49.419999999999995%">          <p>1009700023</p></td>         <td class="cellrowborder" style="border: none;" width="50.580000000000005%">          <p>Write data congest</p></td>        </tr>        <tr>         <td class="cellrowborder" style="border: none;" width="49.419999999999995%">          <p>1009700099</p></td>         <td class="cellrowborder" style="border: none;" width="50.580000000000005%">          <p>Operation failed</p></td>        </tr>             </tbody></table></div>     </div>     <div class="p">      <strong>示例：</strong>      <div _ngcontent-dvd-c106="" class="highlight-div"><div _ngcontent-dvd-c106="" class="highlight-div-header"><div _ngcontent-dvd-c106="" class="highlight-div-header-left"><div _ngcontent-dvd-c106="" class="handle-button expand-button"><div _ngcontent-dvd-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-dvd-c106="" class="highlight-div-header-right"><div _ngcontent-dvd-c106="" class="handle-button ai-button"></div><div _ngcontent-dvd-c106="" class="handle-button line-button"><div _ngcontent-dvd-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-dvd-c106="" class="handle-button theme-button"><div _ngcontent-dvd-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-dvd-c106="" class="handle-button copy-button"><div _ngcontent-dvd-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-dvd-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { dataTransfer} <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NearLinkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">try</span> {</li><li>  <span class="hljs-comment">// 构造发送数据参数</span></li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">transferValueBuffer</span>: <span class="hljs-title class_">Uint8Array</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(<span class="hljs-number">4</span>);</li><li>  transferValueBuffer[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>;</li><li>  transferValueBuffer[<span class="hljs-number">1</span>] = <span class="hljs-number">2</span>;</li><li>  transferValueBuffer[<span class="hljs-number">2</span>] = <span class="hljs-number">3</span>;</li><li>  transferValueBuffer[<span class="hljs-number">3</span>] = <span class="hljs-number">4</span>;</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">dataParams</span>: dataTransfer.<span class="hljs-property">DataParams</span> = {</li><li>    <span class="hljs-attr">address</span>: <span class="hljs-string">'01:02:03:04:05:06'</span>, <span class="hljs-comment">// 星闪远端设备地址</span></li><li>    <span class="hljs-attr">uuid</span>: <span class="hljs-string">'37BEA880-FC70-11EA-B720-00000000060D'</span>, <span class="hljs-comment">// 星闪服务UUID</span></li><li>    <span class="hljs-attr">data</span>: transferValueBuffer.<span class="hljs-property">buffer</span>, <span class="hljs-comment">// 星闪设备间传输的数据</span></li><li>  };</li><li>  dataTransfer.<span class="hljs-title function_">writeData</span>(dataParams).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'writeData success'</span>);</li><li>  });</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>     </div>    </div>    <div class="tiledSection">     <h2 id="section5547151720408" device-type="phone,2in1,tv,tablet,wearable">on('readData')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section5547151720408" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>on(type: 'readData', callback: Callback&lt;DataParams&gt;): void</p>     <p>订阅端口通道数据接收事件。</p>     <p><strong>需要权限：</strong>ohos.permission.ACCESS_NEARLINK</p>     <p><strong>系统能力：</strong>SystemCapability.Communication.NearLink.Core</p>     <p><strong>起始版本：</strong>5.1.0(18)</p>     <div class="p">      <strong>参数：</strong>      <div class="tablenoborder">       <div class="tbBox"><table>        <thead>         <tr>          <th align="left" class="cellrowborder" id="mcps1.3.13.7.2.1.5.1.1" width="13.320000000000002%">           <p>参数名</p></th>          <th align="left" class="cellrowborder" id="mcps1.3.13.7.2.1.5.1.2" width="25.319999999999997%">           <p>类型</p></th>          <th align="left" class="cellrowborder" id="mcps1.3.13.7.2.1.5.1.3" width="7.12%">           <p>必填</p></th>          <th align="left" class="cellrowborder" id="mcps1.3.13.7.2.1.5.1.4" width="54.24%">           <p>说明</p></th>         </tr>        </thead>                 <tbody><tr>          <td class="cellrowborder" width="13.320000000000002%">           <p>type</p></td>          <td class="cellrowborder" width="25.319999999999997%">           <p>string</p></td>          <td class="cellrowborder" width="7.12%">           <p>是</p></td>          <td class="cellrowborder" width="54.24%">           <p>固定填写"readData"字符串，表示端口通道数据接收事件。</p></td>         </tr>         <tr>          <td class="cellrowborder" width="13.320000000000002%">           <p>callback</p></td>          <td class="cellrowborder" width="25.319999999999997%">           <p>Callback&lt;<a href="/consumer/cn/doc/harmonyos-references/nearlink-data-transfer-api#section181874974014">DataParams</a>&gt;</p></td>          <td class="cellrowborder" width="7.12%">           <p>是</p></td>          <td class="cellrowborder" width="54.24%">           <p>表示端口通道数据接收回调函数的入参。回调函数由用户创建通过该接口注册。</p></td>         </tr>               </tbody></table></div>      </div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/nearlink-error-code">ArkTS API错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.13.10.1.3.1.1" style="border: none;" width="49.419999999999995%">          <p>错误码ID</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.13.10.1.3.1.2" style="border: none;" width="50.580000000000005%">          <p>错误信息</p></th>        </tr><tr>         <td class="cellrowborder" style="border: none;" width="49.419999999999995%">          <p>201</p></td>         <td class="cellrowborder" style="border: none;" width="50.580000000000005%">          <p>Permission denied</p></td>        </tr>        <tr>         <td class="cellrowborder" style="border: none;" width="49.419999999999995%">          <p>401</p></td>         <td class="cellrowborder" style="border: none;" width="50.580000000000005%">          <p>Invalid parameter</p></td>        </tr>        <tr>         <td class="cellrowborder" style="border: none;" width="49.419999999999995%">          <p>801</p></td>         <td class="cellrowborder" style="border: none;" width="50.580000000000005%">          <p>Capability not supported</p></td>        </tr>        <tr>         <td class="cellrowborder" style="border: none;" width="49.419999999999995%">          <p>1009700099</p></td>         <td class="cellrowborder" style="border: none;" width="50.580000000000005%">          <p>Operation failed</p></td>        </tr>             </tbody></table></div>     </div>     <div class="p">      <strong>示例：</strong>      <div _ngcontent-dvd-c106="" class="highlight-div"><div _ngcontent-dvd-c106="" class="highlight-div-header"><div _ngcontent-dvd-c106="" class="highlight-div-header-left"><div _ngcontent-dvd-c106="" class="handle-button expand-button"><div _ngcontent-dvd-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-dvd-c106="" class="highlight-div-header-right"><div _ngcontent-dvd-c106="" class="handle-button ai-button"></div><div _ngcontent-dvd-c106="" class="handle-button line-button"><div _ngcontent-dvd-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-dvd-c106="" class="handle-button theme-button"><div _ngcontent-dvd-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-dvd-c106="" class="handle-button copy-button"><div _ngcontent-dvd-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-dvd-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { dataTransfer} <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NearLinkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Callback</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">callback</span>: <span class="hljs-title class_">Callback</span>&lt;dataTransfer.<span class="hljs-property">DataParams</span>&gt; = <span class="hljs-function">(<span class="hljs-params">data: dataTransfer.DataParams</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'data: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data));</li><li>};</li><li><span class="hljs-keyword">try</span> {</li><li>  dataTransfer.<span class="hljs-title function_">on</span>(<span class="hljs-string">'readData'</span>, callback);</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>     </div>    </div>    <div class="tiledSection">     <h2 id="section1357982454013" device-type="phone,2in1,tv,tablet,wearable">off('readData')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section1357982454013" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>off(type: 'readData', callback?: Callback&lt;DataParams&gt;): void</p>     <p>取消订阅端口通道数据接收事件。</p>     <p><strong>需要权限：</strong>ohos.permission.ACCESS_NEARLINK</p>     <p><strong>系统能力：</strong>SystemCapability.Communication.NearLink.Core</p>     <p><strong>起始版本：</strong>5.1.0(18)</p>     <div class="p">      <strong>参数：</strong>      <div class="tablenoborder">       <div class="tbBox"><table>        <thead>         <tr>          <th align="left" class="cellrowborder" id="mcps1.3.14.7.2.1.5.1.1" width="13.320000000000002%">           <p>参数名</p></th>          <th align="left" class="cellrowborder" id="mcps1.3.14.7.2.1.5.1.2" width="25.319999999999997%">           <p>类型</p></th>          <th align="left" class="cellrowborder" id="mcps1.3.14.7.2.1.5.1.3" width="7.12%">           <p>必填</p></th>          <th align="left" class="cellrowborder" id="mcps1.3.14.7.2.1.5.1.4" width="54.24%">           <p>说明</p></th>         </tr>        </thead>                 <tbody><tr>          <td class="cellrowborder" width="13.320000000000002%">           <p>type</p></td>          <td class="cellrowborder" width="25.319999999999997%">           <p>string</p></td>          <td class="cellrowborder" width="7.12%">           <p>是</p></td>          <td class="cellrowborder" width="54.24%">           <p>固定填写"readData"字符串，表示端口接收数据事件。</p></td>         </tr>         <tr>          <td class="cellrowborder" width="13.320000000000002%">           <p>callback</p></td>          <td class="cellrowborder" width="25.319999999999997%">           <p>Callback&lt;<a href="/consumer/cn/doc/harmonyos-references/nearlink-data-transfer-api#section181874974014">DataParams</a>&gt;</p></td>          <td class="cellrowborder" width="7.12%">           <p>否</p></td>          <td class="cellrowborder" width="54.24%">           <p>可选参数，需要取消注册的回调函数，需与订阅时传入的回调函数是同一个。若无此参数，则取消注册所有的回调函数。</p></td>         </tr>               </tbody></table></div>      </div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/nearlink-error-code">ArkTS API错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.14.10.1.3.1.1" style="border: none;" width="49.419999999999995%">          <p>错误码ID</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.14.10.1.3.1.2" style="border: none;" width="50.580000000000005%">          <p>错误信息</p></th>        </tr><tr>         <td class="cellrowborder" style="border: none;" width="49.419999999999995%">          <p>201</p></td>         <td class="cellrowborder" style="border: none;" width="50.580000000000005%">          <p>Permission denied</p></td>        </tr>        <tr>         <td class="cellrowborder" style="border: none;" width="49.419999999999995%">          <p>401</p></td>         <td class="cellrowborder" style="border: none;" width="50.580000000000005%">          <p>Invalid parameter</p></td>        </tr>        <tr>         <td class="cellrowborder" style="border: none;" width="49.419999999999995%">          <p>801</p></td>         <td class="cellrowborder" style="border: none;" width="50.580000000000005%">          <p>Capability not supported</p></td>        </tr>        <tr>         <td class="cellrowborder" style="border: none;" width="49.419999999999995%">          <p>1009700099</p></td>         <td class="cellrowborder" style="border: none;" width="50.580000000000005%">          <p>Operation failed</p></td>        </tr>             </tbody></table></div>     </div>     <div class="p">      <strong>示例：</strong>      <div _ngcontent-dvd-c106="" class="highlight-div"><div _ngcontent-dvd-c106="" class="highlight-div-header"><div _ngcontent-dvd-c106="" class="highlight-div-header-left"><div _ngcontent-dvd-c106="" class="handle-button expand-button"><div _ngcontent-dvd-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-dvd-c106="" class="highlight-div-header-right"><div _ngcontent-dvd-c106="" class="handle-button ai-button"></div><div _ngcontent-dvd-c106="" class="handle-button line-button"><div _ngcontent-dvd-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-dvd-c106="" class="handle-button theme-button"><div _ngcontent-dvd-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-dvd-c106="" class="handle-button copy-button"><div _ngcontent-dvd-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-dvd-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { dataTransfer} <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NearLinkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">try</span> {</li><li>  dataTransfer.<span class="hljs-title function_">off</span>(<span class="hljs-string">'readData'</span>);</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>     </div>    </div>    <div class="tiledSection">     <h2 id="section85111632162516" device-type="phone,2in1,tv,tablet,wearable">ConnectionParams<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section85111632162516" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>发起端口连接的参数。</p>     <p><strong>系统能力：</strong>SystemCapability.Communication.NearLink.Core</p>     <p><strong>起始版本：</strong>5.1.0(18)</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.15.5.1.6.1.1" width="14.299999999999999%">          <p>名称</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.15.5.1.6.1.2" width="22.16%">          <p>类型</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.15.5.1.6.1.3" width="7.5200000000000005%">          <p>只读</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.15.5.1.6.1.4" width="21.77%">          <p>可选</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.15.5.1.6.1.5" width="34.25%">          <p>说明</p></th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="14.299999999999999%">          <p>address</p></td>         <td class="cellrowborder" width="22.16%">          <p>string</p></td>         <td class="cellrowborder" width="7.5200000000000005%">          <p>否</p></td>         <td class="cellrowborder" width="21.77%">          <p>否</p></td>         <td class="cellrowborder" width="34.25%">          <p>远端设备的星闪地址。地址格式参考："11:22:33:AA:BB:FF"。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="14.299999999999999%">          <p>uuid</p></td>         <td class="cellrowborder" width="22.16%">          <p>string</p></td>         <td class="cellrowborder" width="7.5200000000000005%">          <p>否</p></td>         <td class="cellrowborder" width="21.77%">          <p>否</p></td>         <td class="cellrowborder" width="34.25%">          <p>星闪服务UUID，例如：37bea880-fc70-11ea-b720-000000004386。UUID格式参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/nearlink-faq#section1263634155618" target="_blank">星闪标准服务UUID</a>。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="14.299999999999999%">          <p>mtu</p></td>         <td class="cellrowborder" width="22.16%">          <p>number</p></td>         <td class="cellrowborder" width="7.5200000000000005%">          <p>否</p></td>         <td class="cellrowborder" width="21.77%">          <p>是</p></td>         <td class="cellrowborder" width="34.25%">          <p>期望发送数据的包长，单位为byte。范围[0, 65535]，默认值为512。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="14.299999999999999%">          <p>transferMode</p></td>         <td class="cellrowborder" width="22.16%">          <p><a href="/consumer/cn/doc/harmonyos-references/nearlink-data-transfer-api#section757023015351">TransferMode</a></p></td>         <td class="cellrowborder" width="7.5200000000000005%">          <p>否</p></td>         <td class="cellrowborder" width="21.77%">          <p>是</p></td>         <td class="cellrowborder" width="34.25%">          <p>表示和远端设备的数据传输模式。默认值是BASIC。</p></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="section181874974014" device-type="phone,2in1,tv,tablet,wearable">DataParams<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section181874974014" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>端口数据发送和接收的参数。</p>     <p><strong>系统能力：</strong>SystemCapability.Communication.NearLink.Core</p>     <p><strong>起始版本：</strong>5.1.0(18)</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.16.5.1.6.1.1" width="14.299999999999999%">          <p>名称</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.16.5.1.6.1.2" width="22.16%">          <p>类型</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.16.5.1.6.1.3" width="7.5200000000000005%">          <p>只读</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.16.5.1.6.1.4" width="21.77%">          <p>可选</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.16.5.1.6.1.5" width="34.25%">          <p>说明</p></th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="14.299999999999999%">          <p>address</p></td>         <td class="cellrowborder" width="22.16%">          <p>string</p></td>         <td class="cellrowborder" width="7.5200000000000005%">          <p>否</p></td>         <td class="cellrowborder" width="21.77%">          <p>否</p></td>         <td class="cellrowborder" width="34.25%">          <p>远端设备的星闪地址。地址格式参考："11:22:33:AA:BB:FF"。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="14.299999999999999%">          <p>uuid</p></td>         <td class="cellrowborder" width="22.16%">          <p>string</p></td>         <td class="cellrowborder" width="7.5200000000000005%">          <p>否</p></td>         <td class="cellrowborder" width="21.77%">          <p>否</p></td>         <td class="cellrowborder" width="34.25%">          <p>星闪服务UUID，例如：37bea880-fc70-11ea-b720-000000004386。UUID格式参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/nearlink-faq#section1263634155618" target="_blank">星闪标准服务UUID</a>。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="14.299999999999999%">          <p>data</p></td>         <td class="cellrowborder" width="22.16%">          <p>ArrayBuffer</p></td>         <td class="cellrowborder" width="7.5200000000000005%">          <p>否</p></td>         <td class="cellrowborder" width="21.77%">          <p>否</p></td>         <td class="cellrowborder" width="34.25%">          <p>发送的数据包。</p></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="section149561050194010" device-type="phone,2in1,tv,tablet,wearable">ConnectionResult<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section149561050194010" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>与远端设备端口连接参数的协商结果</p>     <p><strong>系统能力：</strong>SystemCapability.Communication.NearLink.Core</p>     <p><strong>起始版本：</strong>5.1.0(18)</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.17.5.1.6.1.1" width="14.299999999999999%">          <p>名称</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.17.5.1.6.1.2" width="22.16%">          <p>类型</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.17.5.1.6.1.3" width="7.5200000000000005%">          <p>只读</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.17.5.1.6.1.4" width="21.77%">          <p>可选</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.17.5.1.6.1.5" width="34.25%">          <p>说明</p></th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="14.299999999999999%">          <p>address</p></td>         <td class="cellrowborder" width="22.16%">          <p>string</p></td>         <td class="cellrowborder" width="7.5200000000000005%">          <p>否</p></td>         <td class="cellrowborder" width="21.77%">          <p>否</p></td>         <td class="cellrowborder" width="34.25%">          <p>远端设备的星闪地址。地址格式参考："11:22:33:AA:BB:FF"。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="14.299999999999999%">          <p>uuid</p></td>         <td class="cellrowborder" width="22.16%">          <p>string</p></td>         <td class="cellrowborder" width="7.5200000000000005%">          <p>否</p></td>         <td class="cellrowborder" width="21.77%">          <p>否</p></td>         <td class="cellrowborder" width="34.25%">          <p>星闪服务UUID，例如：37bea880-fc70-11ea-b720-000000004386。UUID格式参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/nearlink-faq#section1263634155618" target="_blank">星闪标准服务UUID</a>。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="14.299999999999999%">          <p>mtu</p></td>         <td class="cellrowborder" width="22.16%">          <p>number</p></td>         <td class="cellrowborder" width="7.5200000000000005%">          <p>否</p></td>         <td class="cellrowborder" width="21.77%">          <p>否</p></td>         <td class="cellrowborder" width="34.25%">          <p>协商后的发送和接收数据的包长，单位为byte，范围[0, 65535]。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="14.299999999999999%">          <p>state</p></td>         <td class="cellrowborder" width="22.16%">          <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/nearlink-constant#section14942121015417">ConnectionState</a></p></td>         <td class="cellrowborder" width="7.5200000000000005%">          <p>否</p></td>         <td class="cellrowborder" width="21.77%">          <p>否</p></td>         <td class="cellrowborder" width="34.25%">          <p>与远端设备的连接状态。</p></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="section1230716832813" device-type="phone,2in1,tv,tablet,wearable">ConnectionStateParams<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section1230716832813" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>获取端口通道连接状态所需参数。</p>     <p><strong>系统能力：</strong>SystemCapability.Communication.NearLink.Core</p>     <p><strong>起始版本：</strong>5.1.0(18)</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.18.5.1.6.1.1" width="14.299999999999999%">          <p>名称</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.18.5.1.6.1.2" width="22.16%">          <p>类型</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.18.5.1.6.1.3" width="7.5200000000000005%">          <p>只读</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.18.5.1.6.1.4" width="21.77%">          <p>可选</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.18.5.1.6.1.5" width="34.25%">          <p>说明</p></th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="14.299999999999999%">          <p>address</p></td>         <td class="cellrowborder" width="22.16%">          <p>string</p></td>         <td class="cellrowborder" width="7.5200000000000005%">          <p>否</p></td>         <td class="cellrowborder" width="21.77%">          <p>否</p></td>         <td class="cellrowborder" width="34.25%">          <p>远端设备的星闪地址。地址格式参考："11:22:33:AA:BB:FF"。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="14.299999999999999%">          <p>uuid</p></td>         <td class="cellrowborder" width="22.16%">          <p>string</p></td>         <td class="cellrowborder" width="7.5200000000000005%">          <p>否</p></td>         <td class="cellrowborder" width="21.77%">          <p>否</p></td>         <td class="cellrowborder" width="34.25%">          <p>星闪服务UUID，例如：37bea880-fc70-11ea-b720-000000004386。UUID格式参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/nearlink-faq#section1263634155618" target="_blank">星闪标准服务UUID</a>。</p></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="section757023015351" device-type="phone,2in1,tv,tablet,wearable">TransferMode<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section757023015351" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>表示和远端设备的数据传输模式，为枚举值。</p>     <p><strong>系统能力：</strong>SystemCapability.Communication.NearLink.Core</p>     <p><strong>起始版本：</strong>5.1.0(18)</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.19.5.1.4.1.1" width="21.912191219121908%">          <p>名称</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.19.5.1.4.1.2" width="16.31163116311631%">          <p>值</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.19.5.1.4.1.3" width="61.776177617761775%">          <p>说明</p></th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="21.912191219121908%">          <p>BASIC</p></td>         <td class="cellrowborder" width="16.31163116311631%">          <p>0</p></td>         <td class="cellrowborder" width="61.776177617761775%">          <p>表示基础模式，无数据重传机制。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="21.912191219121908%">          <p>RELIABLE</p></td>         <td class="cellrowborder" width="16.31163116311631%">          <p>1</p></td>         <td class="cellrowborder" width="61.776177617761775%">          <p>表示可靠模式，有数据重传机制。</p></td>        </tr>             </tbody></table></div>     </div>    </div>   </div>   <div></div></div>