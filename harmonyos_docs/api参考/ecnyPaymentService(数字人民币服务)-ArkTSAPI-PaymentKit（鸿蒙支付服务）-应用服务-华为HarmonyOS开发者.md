<h1 _ngcontent-ghu-c119="" class="doc-title ng-star-inserted" title="ecnyPaymentService (数字人民币服务)"> ecnyPaymentService (数字人民币服务) </h1>

<div _ngcontent-ghu-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p>本模块提供数字人民币支付服务。</p>    <p><strong>模型约束：</strong>本模块接口仅可在Stage模型下使用。</p>    <p><strong>元服务API</strong>： 从版本5.0.1(13)开始，该接口支持在元服务中使用。</p>    <p><strong>起始版本：</strong>5.0.1(13)</p>    <div class="tiledSection">     <h2 id="section164051883419" device-type="phone,tablet,2in1">导入模块<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section164051883419" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><div _ngcontent-ghu-c106="" class="highlight-div"><div _ngcontent-ghu-c106="" class="highlight-div-header"><div _ngcontent-ghu-c106="" class="highlight-div-header-left"><div _ngcontent-ghu-c106="" class="handle-button expand-button"><div _ngcontent-ghu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ghu-c106="" class="highlight-div-header-right"><div _ngcontent-ghu-c106="" class="handle-button ai-button"></div><div _ngcontent-ghu-c106="" class="handle-button line-button"><div _ngcontent-ghu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ghu-c106="" class="handle-button theme-button"><div _ngcontent-ghu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ghu-c106="" class="handle-button copy-button"><div _ngcontent-ghu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ghu-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { ecnyPaymentService } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PaymentKit'</span>;</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="section363mcpsimp" device-type="phone,tablet,2in1">EcnyOrderInfo<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section363mcpsimp" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><p>拉起数字人民币收银台时传入的订单信息。</p>     <p><strong>模型约束：</strong>本模块接口仅可在Stage模型下使用。</p>     <p><strong>元服务API</strong>： 从版本5.0.1(13)开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力：</strong>SystemCapability.Payment.ECNYPaymentService</p>     <p><strong>起始版本：</strong>5.0.1(13)</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.6.7.1.6.1.1" width="20.349999999999998%">          <p><strong>名称</strong></p></th>         <th align="left" class="cellrowborder" id="mcps1.3.6.7.1.6.1.2" width="12.950000000000001%">          <p><strong>类型</strong></p></th>         <th align="left" class="cellrowborder" id="mcps1.3.6.7.1.6.1.3" width="7.5200000000000005%">          <p>只读</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.6.7.1.6.1.4" width="6.47%">          <p>可选</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.6.7.1.6.1.5" width="52.71%">          <p><strong>说明</strong></p></th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20.349999999999998%">          <p>merchantAppId</p></td>         <td class="cellrowborder" width="12.950000000000001%">          <p>string</p></td>         <td class="cellrowborder" width="7.5200000000000005%">          <p>否</p></td>         <td class="cellrowborder" width="6.47%">          <p>否</p></td>         <td class="cellrowborder" width="52.71%">          <p>由运营机构分配的APPID。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20.349999999999998%">          <p>merchantNo</p></td>         <td class="cellrowborder" width="12.950000000000001%">          <p>string</p></td>         <td class="cellrowborder" width="7.5200000000000005%">          <p>否</p></td>         <td class="cellrowborder" width="6.47%">          <p>否</p></td>         <td class="cellrowborder" width="52.71%">          <p>由运营机构分配的商户号。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20.349999999999998%">          <p>acqAgtInstnId</p></td>         <td class="cellrowborder" width="12.950000000000001%">          <p>string</p></td>         <td class="cellrowborder" width="7.5200000000000005%">          <p>否</p></td>         <td class="cellrowborder" width="6.47%">          <p>是</p></td>         <td class="cellrowborder" width="52.71%">          <p>受理服务机构的金融机构编码（<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/payment-digital-cny-pay-preparations" target="_blank">通过受理服务机构入网</a>的商户，此项必填）。若未填写，默认为空。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20.349999999999998%">          <p>creditorInstitutionId</p></td>         <td class="cellrowborder" width="12.950000000000001%">          <p>string</p></td>         <td class="cellrowborder" width="7.5200000000000005%">          <p>否</p></td>         <td class="cellrowborder" width="6.47%">          <p>否</p></td>         <td class="cellrowborder" width="52.71%">          <p>收款运营机构的金融机构编码。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20.349999999999998%">          <p>encryptedKey</p></td>         <td class="cellrowborder" width="12.950000000000001%">          <p>string</p></td>         <td class="cellrowborder" width="7.5200000000000005%">          <p>否</p></td>         <td class="cellrowborder" width="6.47%">          <p>否</p></td>         <td class="cellrowborder" width="52.71%">          <p>用于加密订单信息的密钥密文。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20.349999999999998%">          <p>encryptedInfo</p></td>         <td class="cellrowborder" width="12.950000000000001%">          <p>string</p></td>         <td class="cellrowborder" width="7.5200000000000005%">          <p>否</p></td>         <td class="cellrowborder" width="6.47%">          <p>否</p></td>         <td class="cellrowborder" width="52.71%">          <p>订单加密信息。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20.349999999999998%">          <p>encryptionSN</p></td>         <td class="cellrowborder" width="12.950000000000001%">          <p>string</p></td>         <td class="cellrowborder" width="7.5200000000000005%">          <p>否</p></td>         <td class="cellrowborder" width="6.47%">          <p>是</p></td>         <td class="cellrowborder" width="52.71%">          <p>收款运营机构加密证书序列号。若未填写，默认为空。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20.349999999999998%">          <p>lastWalletId</p></td>         <td class="cellrowborder" width="12.950000000000001%">          <p>string</p></td>         <td class="cellrowborder" width="7.5200000000000005%">          <p>否</p></td>         <td class="cellrowborder" width="6.47%">          <p>是</p></td>         <td class="cellrowborder" width="52.71%">          <p>付款钱包编号后四位，如果传可以在数字人民币收银台默认选择该钱包。若未填写，默认为空。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20.349999999999998%">          <p>extraInfo</p></td>         <td class="cellrowborder" width="12.950000000000001%">          <p>string</p></td>         <td class="cellrowborder" width="7.5200000000000005%">          <p>否</p></td>         <td class="cellrowborder" width="6.47%">          <p>是</p></td>         <td class="cellrowborder" width="52.71%">          <p>保留字段。json string格式。若未填写，默认为空。</p></td>        </tr>             </tbody></table></div>     </div>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>相关参数获取及详细说明参见运营机构或受理服务机构（客服热线956196）提供的开发指引。</p>      </div></div></div>    </div>    <div class="tiledSection">     <h2 id="section472mcpsimp" device-type="phone,tablet,2in1">EcnyPayResult<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section472mcpsimp" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><p>数字人民币支付结果。</p>     <p><strong>模型约束：</strong>本模块接口仅可在Stage模型下使用。</p>     <p><strong>元服务API</strong>： 从版本5.0.1(13)开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力：</strong>SystemCapability.Payment.ECNYPaymentService</p>     <p><strong>起始版本：</strong>5.0.1(13)</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.7.7.1.6.1.1" width="20.349999999999998%">          <p><strong>名称</strong></p></th>         <th align="left" class="cellrowborder" id="mcps1.3.7.7.1.6.1.2" width="12.950000000000001%">          <p><strong>类型</strong></p></th>         <th align="left" class="cellrowborder" id="mcps1.3.7.7.1.6.1.3" width="7.5200000000000005%">          <p>只读</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.7.7.1.6.1.4" width="6.47%">          <p>可选</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.7.7.1.6.1.5" width="52.71%">          <p><strong>说明</strong></p></th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20.349999999999998%">          <p>orderNo</p></td>         <td class="cellrowborder" width="12.950000000000001%">          <p>string</p></td>         <td class="cellrowborder" width="7.5200000000000005%">          <p>否</p></td>         <td class="cellrowborder" width="6.47%">          <p>否</p></td>         <td class="cellrowborder" width="52.71%">          <p>订单号。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20.349999999999998%">          <p>extraInfo</p></td>         <td class="cellrowborder" width="12.950000000000001%">          <p>string</p></td>         <td class="cellrowborder" width="7.5200000000000005%">          <p>否</p></td>         <td class="cellrowborder" width="6.47%">          <p>是</p></td>         <td class="cellrowborder" width="52.71%">          <p>保留字段。json string格式。</p></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="section11356145173918" device-type="phone,tablet,2in1">ecnyPaymentService.requestEcnyPayment<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section11356145173918" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><p>requestEcnyPayment(context: common.Context, orderInfo: EcnyOrderInfo): Promise&lt;EcnyPayResult&gt;</p>     <p>该方法提供基础支付功能，调用该方法前请确保网络已连接，调用该方法后会拉起数字人民币收银台，支付完成后使用Promise异步返回。</p>     <p><strong>模型约束</strong>：此接口仅可在Stage模型下使用。</p>     <p><strong>元服务API：</strong>从版本5.0.1(13)开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力：</strong>SystemCapability.Payment.ECNYPaymentService</p>     <p><strong>起始版本：</strong>5.0.1(13)</p>     <div class="p">      <strong>参数</strong>：       <div class="tablenoborder">       <div class="tbBox"><table>        <thead>         <tr>          <th align="left" class="cellrowborder" id="mcps1.3.8.8.2.1.5.1.1" width="17.8%">           <p><strong>参数名</strong></p></th>          <th align="left" class="cellrowborder" id="mcps1.3.8.8.2.1.5.1.2" width="17.8%">           <p><strong>类型</strong></p></th>          <th align="left" class="cellrowborder" id="mcps1.3.8.8.2.1.5.1.3" width="7.17%">           <p>必填</p></th>          <th align="left" class="cellrowborder" id="mcps1.3.8.8.2.1.5.1.4" width="57.230000000000004%">           <p><strong>说明</strong></p></th>         </tr>        </thead>                 <tbody><tr>          <td class="cellrowborder" width="17.8%">           <p>context</p></td>          <td class="cellrowborder" width="17.8%">           <p>common.<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-context" target="_blank">Context</a></p></td>          <td class="cellrowborder" width="7.17%">           <p>是</p></td>          <td class="cellrowborder" width="57.230000000000004%">           <p>上下文，不传会报401参数错误。</p></td>         </tr>         <tr>          <td class="cellrowborder" width="17.8%">           <p>orderInfo</p></td>          <td class="cellrowborder" width="17.8%">           <p><a href="/consumer/cn/doc/harmonyos-references/payment-digitalcnyservice#section363mcpsimp">EcnyOrderInfo</a></p></td>          <td class="cellrowborder" width="7.17%">           <p>是</p></td>          <td class="cellrowborder" width="57.230000000000004%">           <p>拉起收银台传入的订单信息.。不传会报401参数错误。</p></td>         </tr>               </tbody></table></div>      </div>     </div>    </div>    <div class="p">     <strong>返回值</strong>:      <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.9.2.1.3.1.1" width="28.050000000000004%">          <p>类型</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.9.2.1.3.1.2" width="71.95%">          <p>说明</p></th>        </tr><tr>         <td class="cellrowborder" width="28.050000000000004%">          <p>Promise&lt;<a href="/consumer/cn/doc/harmonyos-references/payment-digitalcnyservice#section472mcpsimp">EcnyPayResult</a>&gt;</p></td>         <td class="cellrowborder" width="71.95%">          <p>Promise对象。返回支付结果信息。</p></td>        </tr>             </tbody></table></div>     </div>    </div>    <p><strong>错误码</strong>：</p>    <div class="p">     以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-error-code">ArkTS API错误码</a>。      <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.11.2.1.3.1.1" width="30%">          <p>错误码ID</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.11.2.1.3.1.2" width="70%">          <p>错误信息（此处仅提供错误抛出的关键信息）</p></th>        </tr><tr>         <td class="cellrowborder" width="30%">          <p>401</p></td>         <td class="cellrowborder" width="70%">          <p>Parameter error. Possible causes: 1. Mandatory parameters are left unspecified; 2. Incorrect parameter types.</p></td>        </tr>        <tr>         <td class="cellrowborder" width="30%">          <p>1014900000</p></td>         <td class="cellrowborder" width="70%">          <p>The operation was canceled by the user.</p></td>        </tr>        <tr>         <td class="cellrowborder" width="30%">          <p>1014900001</p></td>         <td class="cellrowborder" width="70%">          <p>Payment failed.</p></td>        </tr>        <tr>         <td class="cellrowborder" width="30%">          <p>1014900002</p></td>         <td class="cellrowborder" width="70%">          <p>The transaction has been processed.</p></td>        </tr>        <tr>         <td class="cellrowborder" width="30%">          <p>1014900003</p></td>         <td class="cellrowborder" width="70%">          <p>Duplicate request.</p></td>        </tr>        <tr>         <td class="cellrowborder" width="30%">          <p>1014900004</p></td>         <td class="cellrowborder" width="70%">          <p>Network connection error.</p></td>        </tr>        <tr>         <td class="cellrowborder" width="30%">          <p>1014900005</p></td>         <td class="cellrowborder" width="70%">          <p>The payment environment is not ready.</p></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="p">     <strong>示例</strong>：     <div _ngcontent-ghu-c106="" class="highlight-div"><div _ngcontent-ghu-c106="" class="highlight-div-header"><div _ngcontent-ghu-c106="" class="highlight-div-header-left"><div _ngcontent-ghu-c106="" class="handle-button expand-button"><div _ngcontent-ghu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ghu-c106="" class="highlight-div-header-right"><div _ngcontent-ghu-c106="" class="handle-button ai-button"></div><div _ngcontent-ghu-c106="" class="handle-button line-button"><div _ngcontent-ghu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ghu-c106="" class="handle-button theme-button"><div _ngcontent-ghu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ghu-c106="" class="handle-button copy-button"><div _ngcontent-ghu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ghu-c106="" class="highlight-scroll-div"><pre class="java prettyprint linenums hljs language-java" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { BusinessError } from <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { ecnyPaymentService } from <span class="hljs-string">'@kit.PaymentKit'</span>;</li><li><span class="hljs-keyword">import</span> { common } from <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li> </li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct Index {</li><li>  context: common.UIAbilityContext = <span class="hljs-built_in">this</span>.getUIContext().getHostContext() as common.UIAbilityContext;</li><li>  requestEcnyPaymentPromise() {</li><li>    <span class="hljs-comment">// use your own orderInfo</span></li><li>    const orderInfo: ecnyPaymentService.EcnyOrderInfo = {</li><li>      merchantAppId: <span class="hljs-string">"***"</span>,</li><li>      merchantNo: <span class="hljs-string">"***"</span>,</li><li>      acqAgtInstnId: <span class="hljs-string">"***"</span>,</li><li>      creditorInstitutionId: <span class="hljs-string">"***"</span>,</li><li>      encryptedKey: <span class="hljs-string">"***"</span>,</li><li>      encryptedInfo: <span class="hljs-string">"***"</span>,</li><li>      encryptionSN: <span class="hljs-string">"***"</span>,</li><li>      extraInfo: <span class="hljs-string">"***"</span>,</li><li>      lastWalletId: <span class="hljs-string">"***"</span></li><li>    };</li><li>    ecnyPaymentService.requestEcnyPayment(<span class="hljs-built_in">this</span>.context, orderInfo)</li><li>      .then((result: ecnyPaymentService.EcnyPayResult) =&gt; {</li><li>        <span class="hljs-comment">// pay success</span></li><li>        console.info(`succeeded in paying, result.orderNo: ${result.orderNo}, result.extraInfo: ${result.extraInfo}`);</li><li>      })</li><li>      .<span class="hljs-keyword">catch</span>((error: BusinessError) =&gt; {</li><li>        <span class="hljs-comment">// failed to pay</span></li><li>        console.error(`failed to pay, error.code: ${error.code}, error.message: ${error.message}`);</li><li>      });</li><li>  }</li><li> </li><li>  build() {</li><li>    Column() {</li><li>      Button(<span class="hljs-string">'requestEcnyPaymentPromise'</span>)</li><li>        .type(ButtonType.Capsule)</li><li>        .width(<span class="hljs-string">'50%'</span>)</li><li>        .margin(<span class="hljs-number">20</span>)</li><li>        .onClick(() =&gt; {</li><li>          <span class="hljs-built_in">this</span>.requestEcnyPaymentPromise();</li><li>        })</li><li>      }</li><li>    .width(<span class="hljs-string">'100%'</span>)</li><li>    .height(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <p></p>   </div>   <div></div></div>