<h1 _ngcontent-aea-c119="" class="doc-title ng-star-inserted" title="faceDetector（人脸检测）"> faceDetector（人脸检测） </h1>

<div _ngcontent-aea-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p>人脸检测支持2D人脸检测框的检测能力。检测给定图片中的人脸数量、人脸位置、特征点（左右眼中心、鼻子、左右嘴角）和姿态（pitch、roll、yaw）信息。人脸检测框按照大小排序。</p>    <p>与Vision Kit的活体检测的区别是：活体检测用于视频，人脸检测用于图片。</p>    <p><strong>起始版本：</strong>5.0.0(12)</p>    <div class="tiledSection">     <h2 id="section858242013419" device-type="phone,2in1,tablet">导入模块<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section858242013419" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><div _ngcontent-aea-c106="" class="highlight-div"><div _ngcontent-aea-c106="" class="highlight-div-header"><div _ngcontent-aea-c106="" class="highlight-div-header-left"><div _ngcontent-aea-c106="" class="handle-button expand-button"><div _ngcontent-aea-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-aea-c106="" class="highlight-div-header-right"><div _ngcontent-aea-c106="" class="handle-button ai-button"></div><div _ngcontent-aea-c106="" class="handle-button line-button"><div _ngcontent-aea-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-aea-c106="" class="handle-button theme-button"><div _ngcontent-aea-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-aea-c106="" class="handle-button copy-button"><div _ngcontent-aea-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-aea-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { faceDetector } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.CoreVisionKit'</span>;</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="section14488135133518" device-type="phone,2in1,tablet">VisionInfo<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section14488135133518" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><p>待识别的视觉信息，目前仅支持颜色数据格式为RGBA_8888的PixelMap类型的视觉信息。</p>     <p><strong>元服务API：</strong> 从版本5.0.2(14)开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力：</strong>SystemCapability.AI.Face.Detector</p>     <p><strong>起始版本：</strong>5.0.0(12)</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.5.6.1.6.1.1" width="17.07%">          <p>名称</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.5.6.1.6.1.2" width="17.43%">          <p>类型</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.5.6.1.6.1.3" width="11.450000000000001%">          <p>只读</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.5.6.1.6.1.4" width="15.920000000000002%">          <p>可选</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.5.6.1.6.1.5" width="38.129999999999995%">          <p>说明</p></th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="17.07%">          <p>pixelMap</p></td>         <td class="cellrowborder" width="17.43%">          <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-image-pixelmap" target="_blank">image.PixelMap</a></p></td>         <td class="cellrowborder" width="11.450000000000001%">          <p>是</p></td>         <td class="cellrowborder" width="15.920000000000002%">          <p>否</p></td>         <td class="cellrowborder" width="38.129999999999995%">          <p>待识别的图片。</p>          <p>具体规格请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/core-vision-introduction#section625292610522" target="_blank">约束与限制</a>。</p></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="section1821372213619" device-type="phone,2in1,tablet">FaceRecognitionConfiguration<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section1821372213619" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><p>人脸遮挡检测的配置项。</p>     <p><strong>系统能力：</strong>SystemCapability.AI.Face.Detector</p>     <p><strong>起始版本：</strong>5.0.2(14)</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.6.5.1.6.1.1" width="17.07%">          <p>名称</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.6.5.1.6.1.2" width="17.43%">          <p>类型</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.6.5.1.6.1.3" width="11.450000000000001%">          <p>只读</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.6.5.1.6.1.4" width="15.920000000000002%">          <p>可选</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.6.5.1.6.1.5" width="38.129999999999995%">          <p>说明</p></th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="17.07%">          <p>faceBlock</p></td>         <td class="cellrowborder" width="17.43%">          <p>boolean</p></td>         <td class="cellrowborder" width="11.450000000000001%">          <p>是</p></td>         <td class="cellrowborder" width="15.920000000000002%">          <p>否</p></td>         <td class="cellrowborder" width="38.129999999999995%">          <p>是否开启人脸遮挡检测。</p>          <p>true：开启人脸遮挡检测；false：不开启人脸遮挡检测。默认为false。</p></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="section13470323960" device-type="phone,2in1,tablet">FaceBlock<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section13470323960" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><p>人脸遮挡检测结果的枚举类。</p>     <p><strong>系统能力：</strong>SystemCapability.AI.Face.Detector</p>     <p><strong>起始版本：</strong>5.0.2(14)</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.7.5.1.4.1.1" width="29.959999999999997%">          <p>名称</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.7.5.1.4.1.2" width="26.1%">          <p>值</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.7.5.1.4.1.3" width="43.94%">          <p>说明</p></th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="29.959999999999997%">          <p>UNINITIALIZED</p></td>         <td class="cellrowborder" width="26.1%">          <p>-1</p></td>         <td class="cellrowborder" width="43.94%">          <p>人脸遮挡检测未开启。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="29.959999999999997%">          <p>UNBLOCKED</p></td>         <td class="cellrowborder" width="26.1%">          <p>0</p></td>         <td class="cellrowborder" width="43.94%">          <p>人脸无遮挡。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="29.959999999999997%">          <p>BLOCKED</p></td>         <td class="cellrowborder" width="26.1%">          <p>1</p></td>         <td class="cellrowborder" width="43.94%">          <p>人脸有遮挡。</p></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="section789716171126" device-type="phone,2in1,tablet">FacePoint<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section789716171126" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><p>指示像素点的位置。</p>     <p><strong>元服务API：</strong> 从版本5.0.2(14)开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力：</strong>SystemCapability.AI.Face.Detector</p>     <p><strong>起始版本：</strong>5.0.0(12)</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.8.6.1.6.1.1" width="17.07%">          <p>名称</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.8.6.1.6.1.2" width="17.43%">          <p>类型</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.8.6.1.6.1.3" width="11.450000000000001%">          <p>只读</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.8.6.1.6.1.4" width="15.920000000000002%">          <p>可选</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.8.6.1.6.1.5" width="38.129999999999995%">          <p>说明</p></th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="17.07%">          <p>x</p></td>         <td class="cellrowborder" width="17.43%">          <p>number</p></td>         <td class="cellrowborder" width="11.450000000000001%">          <p>是</p></td>         <td class="cellrowborder" width="15.920000000000002%">          <p>否</p></td>         <td class="cellrowborder" width="38.129999999999995%">          <p>像素点横向x坐标。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="17.07%">          <p>y</p></td>         <td class="cellrowborder" width="17.43%">          <p>number</p></td>         <td class="cellrowborder" width="11.450000000000001%">          <p>是</p></td>         <td class="cellrowborder" width="15.920000000000002%">          <p>否</p></td>         <td class="cellrowborder" width="38.129999999999995%">          <p>像素点纵向y坐标。</p></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="section1268211401742" device-type="phone,2in1,tablet">FacePose<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section1268211401742" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><p>描述人脸在三维空间中的方向。坐标系可参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/core-vision-face-detector#section17390143819516" target="_blank">世界坐标系</a>。</p>     <p><strong>元服务API：</strong> 从版本5.0.2(14)开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力：</strong>SystemCapability.AI.Face.Detector</p>     <p><strong>起始版本：</strong>5.0.0(12)</p>    </div>    <div class="tablenoborder">     <div class="tbBox"><table>      <thead>       <tr>        <th align="left" class="cellrowborder" id="mcps1.3.10.1.6.1.1" width="17.07%">         <p>名称</p></th>        <th align="left" class="cellrowborder" id="mcps1.3.10.1.6.1.2" width="17.43%">         <p>类型</p></th>        <th align="left" class="cellrowborder" id="mcps1.3.10.1.6.1.3" width="11.450000000000001%">         <p>只读</p></th>        <th align="left" class="cellrowborder" id="mcps1.3.10.1.6.1.4" width="9.62%">         <p>可选</p></th>        <th align="left" class="cellrowborder" id="mcps1.3.10.1.6.1.5" width="44.43%">         <p>说明</p></th>       </tr>      </thead>             <tbody><tr>        <td class="cellrowborder" width="17.07%">         <p>yaw</p></td>        <td class="cellrowborder" width="17.43%">         <p>number</p></td>        <td class="cellrowborder" width="11.450000000000001%">         <p>是</p></td>        <td class="cellrowborder" width="9.62%">         <p>否</p></td>        <td class="cellrowborder" width="44.43%">         <p>头型航向，将物体绕Y轴旋转（localRotationY）。取值范围[-180,180]。</p></td>       </tr>       <tr>        <td class="cellrowborder" width="17.07%">         <p>pitch</p></td>        <td class="cellrowborder" width="17.43%">         <p>number</p></td>        <td class="cellrowborder" width="11.450000000000001%">         <p>是</p></td>        <td class="cellrowborder" width="9.62%">         <p>否</p></td>        <td class="cellrowborder" width="44.43%">         <p>头型俯仰，将物体绕X轴旋转（localRotationX）。取值范围[-180,180]。</p></td>       </tr>       <tr>        <td class="cellrowborder" width="17.07%">         <p>roll</p></td>        <td class="cellrowborder" width="17.43%">         <p>number</p></td>        <td class="cellrowborder" width="11.450000000000001%">         <p>是</p></td>        <td class="cellrowborder" width="9.62%">         <p>否</p></td>        <td class="cellrowborder" width="44.43%">         <p>头型横滚，将物体绕Z轴旋转（localRotationZ）。取值范围[-180,180]。</p></td>       </tr>           </tbody></table></div>    </div>    <div class="tiledSection">     <h2 id="section19644831362" device-type="phone,2in1,tablet">FaceRectangle<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section19644831362" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><p>表示人脸的矩形框。</p>     <p><strong>元服务API：</strong> 从版本5.0.2(14)开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力：</strong>SystemCapability.AI.Face.Detector</p>     <p><strong>起始版本：</strong>5.0.0(12)</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.11.6.1.6.1.1" width="17.07%">          <p>名称</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.11.6.1.6.1.2" width="17.43%">          <p>类型</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.11.6.1.6.1.3" width="11.450000000000001%">          <p>只读</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.11.6.1.6.1.4" width="9.62%">          <p>可选</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.11.6.1.6.1.5" width="44.43%">          <p>说明</p></th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="17.07%">          <p>left</p></td>         <td class="cellrowborder" width="17.43%">          <p>number</p></td>         <td class="cellrowborder" width="11.450000000000001%">          <p>是</p></td>         <td class="cellrowborder" width="9.62%">          <p>否</p></td>         <td class="cellrowborder" width="44.43%">          <p>人脸矩形框左上角x坐标。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="17.07%">          <p>top</p></td>         <td class="cellrowborder" width="17.43%">          <p>number</p></td>         <td class="cellrowborder" width="11.450000000000001%">          <p>是</p></td>         <td class="cellrowborder" width="9.62%">          <p>否</p></td>         <td class="cellrowborder" width="44.43%">          <p>人脸矩形框左上角y坐标。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="17.07%">          <p>width</p></td>         <td class="cellrowborder" width="17.43%">          <p>number</p></td>         <td class="cellrowborder" width="11.450000000000001%">          <p>是</p></td>         <td class="cellrowborder" width="9.62%">          <p>否</p></td>         <td class="cellrowborder" width="44.43%">          <p>人脸框宽，单位：pixel。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="17.07%">          <p>height</p></td>         <td class="cellrowborder" width="17.43%">          <p>number</p></td>         <td class="cellrowborder" width="11.450000000000001%">          <p>是</p></td>         <td class="cellrowborder" width="9.62%">          <p>否</p></td>         <td class="cellrowborder" width="44.43%">          <p>人脸框高，单位：pixel。</p></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="section747541297" device-type="phone,2in1,tablet">Face<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section747541297" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><p>表示人脸的信息列表。</p>     <p><strong>系统能力：</strong>SystemCapability.AI.Face.Detector</p>     <p><strong>起始版本：</strong>5.0.0(12)</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.12.5.1.6.1.1" width="12.5%">          <p>名称</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.12.5.1.6.1.2" width="22%">          <p>类型</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.12.5.1.6.1.3" width="11.450000000000001%">          <p>只读</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.12.5.1.6.1.4" width="9.62%">          <p>可选</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.12.5.1.6.1.5" width="44.43%">          <p>说明</p></th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="12.5%">          <p>probability</p></td>         <td class="cellrowborder" width="22%">          <p>number</p></td>         <td class="cellrowborder" width="11.450000000000001%">          <p>是</p></td>         <td class="cellrowborder" width="9.62%">          <p>否</p></td>         <td class="cellrowborder" width="44.43%">          <p>表示人脸检测结果的置信度，取值范围为(0,1)的浮点数，数值越大代表置信度越高。</p>          <p><strong>元服务API</strong>：从版本5.0.2(14)开始，该接口支持在元服务中使用。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="12.5%">          <p>block</p></td>         <td class="cellrowborder" width="22%">          <p><a href="/consumer/cn/doc/harmonyos-references/core-vision-face-detector-api#section13470323960">FaceBlock</a></p></td>         <td class="cellrowborder" width="11.450000000000001%">          <p>是</p></td>         <td class="cellrowborder" width="9.62%">          <p>是</p></td>         <td class="cellrowborder" width="44.43%">          <p>人脸遮挡结果。</p>          <p><strong>起始版本</strong>：5.0.2(14)。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="12.5%">          <p>pose</p></td>         <td class="cellrowborder" width="22%">          <p><a href="/consumer/cn/doc/harmonyos-references/core-vision-face-detector-api#section1268211401742">FacePose</a></p></td>         <td class="cellrowborder" width="11.450000000000001%">          <p>是</p></td>         <td class="cellrowborder" width="9.62%">          <p>否</p></td>         <td class="cellrowborder" width="44.43%">          <p>人脸头型航向。</p>          <p><strong>元服务API</strong>：从版本5.0.2(14)开始，该接口支持在元服务中使用。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="12.5%">          <p>rect</p></td>         <td class="cellrowborder" width="22%">          <p><a href="/consumer/cn/doc/harmonyos-references/core-vision-face-detector-api#section19644831362">FaceRectangle</a></p></td>         <td class="cellrowborder" width="11.450000000000001%">          <p>是</p></td>         <td class="cellrowborder" width="9.62%">          <p>否</p></td>         <td class="cellrowborder" width="44.43%">          <p>人脸框列表。</p>          <p><strong>元服务API</strong>：从版本5.0.2(14)开始，该接口支持在元服务中使用。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="12.5%">          <p>points</p></td>         <td class="cellrowborder" width="22%">          <p>Array&lt;<a href="/consumer/cn/doc/harmonyos-references/core-vision-face-detector-api#section789716171126">FacePoint</a>&gt;</p></td>         <td class="cellrowborder" width="11.450000000000001%">          <p>是</p></td>         <td class="cellrowborder" width="9.62%">          <p>否</p></td>         <td class="cellrowborder" width="44.43%">          <p>人脸五官位置数组，包括：左右眼中心、鼻子、左右嘴角。参数顺序为：左眼中心，右眼中心，鼻子，左嘴角，右嘴角。</p>          <p><strong>元服务API</strong>：从版本5.0.2(14)开始，该接口支持在元服务中使用。</p></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="section129681142578" device-type="phone,2in1,tablet">faceDetector.init<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section129681142578" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><p>init(): Promise&lt;boolean&gt;</p>     <p>初始化人脸检测分析器服务。使用Promise异步回调。</p>     <p><strong>元服务API：</strong> 从版本5.0.2(14)开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力：</strong>SystemCapability.AI.Face.Detector</p>     <p><strong>起始版本：</strong>5.0.0(12)</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.13.8.1.3.1.1" width="38.440000000000005%">          <p>类型</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.13.8.1.3.1.2" width="61.56%">          <p>说明</p></th>        </tr><tr>         <td class="cellrowborder" width="38.440000000000005%">          <p>Promise&lt;boolean&gt;</p></td>         <td class="cellrowborder" width="61.56%">          <p>Promise对象，返回初始化是否成功。</p>          <p>true：初始化成功；false：初始化失败。</p></td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-aea-c106="" class="highlight-div"><div _ngcontent-aea-c106="" class="highlight-div-header"><div _ngcontent-aea-c106="" class="highlight-div-header-left"><div _ngcontent-aea-c106="" class="handle-button expand-button"><div _ngcontent-aea-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-aea-c106="" class="highlight-div-header-right"><div _ngcontent-aea-c106="" class="handle-button ai-button"></div><div _ngcontent-aea-c106="" class="handle-button line-button"><div _ngcontent-aea-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-aea-c106="" class="handle-button theme-button"><div _ngcontent-aea-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-aea-c106="" class="handle-button copy-button"><div _ngcontent-aea-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-aea-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { faceDetector } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.CoreVisionKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li>
</li><li><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">initAndReleaseFaceDetector</span>(<span class="hljs-params"></span>) {</li><li>  <span class="hljs-comment">// 初始化人脸检测服务</span></li><li>  <span class="hljs-keyword">const</span> initResult = <span class="hljs-keyword">await</span> faceDetector.<span class="hljs-title function_">init</span>();</li><li>  hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'faceDetectorSample'</span>, <span class="hljs-string">`Face detector initialization result:<span class="hljs-subst">${initResult}</span>`</span>);</li><li>
</li><li>  <span class="hljs-keyword">if</span> (initResult) {</li><li>    hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'faceDetectorSample'</span>, <span class="hljs-string">'Face detector initialized successfully'</span>);</li><li>
</li><li>    <span class="hljs-comment">// 这里可以添加使用人脸检测服务的代码</span></li><li>
</li><li>    <span class="hljs-comment">// 使用完毕后，释放人脸检测服务</span></li><li>    <span class="hljs-keyword">await</span> faceDetector.<span class="hljs-title function_">release</span>();</li><li>    hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'faceDetectorSample'</span>, <span class="hljs-string">'Face detector released successfully'</span>);</li><li>  } <span class="hljs-keyword">else</span> {</li><li>    hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'faceDetectorSample'</span>, <span class="hljs-string">'Failed to initialize face detector'</span>);</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Page</span> {</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>(){</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'initAndReleaseFaceDetector'</span>).<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>        <span class="hljs-comment">// 调用函数</span></li><li>        <span class="hljs-title function_">initAndReleaseFaceDetector</span>();</li><li>      })</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="section982291913112" device-type="phone,2in1,tablet">faceDetector.init<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section982291913112" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><p>init(faceRecognitionConfiguration: FaceRecognitionConfiguration): Promise&lt;boolean&gt;</p>     <p>初始化人脸遮挡检测分析器服务。同一个进程内只要有人脸检测服务开启了遮挡检测，在该人脸检测服务未release这段时间内，这个进程内的其他所有人脸检测服务都等同于开启了遮挡检测。使用Promise异步回调。</p>     <p><strong>系统能力：</strong>SystemCapability.AI.Face.Detector</p>     <p><strong>起始版本：</strong>5.0.2(14)</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.14.7.1.5.1.1" width="19.388061193880613%">          <p>参数名</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.14.7.1.5.1.2" width="22.447755224477554%">          <p>类型</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.14.7.1.5.1.3" width="17.348265173482652%">          <p>必填</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.14.7.1.5.1.4" width="40.815918408159185%">          <p>说明</p></th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="19.388061193880613%">          <p>faceRecognitionConfiguration</p></td>         <td class="cellrowborder" width="22.447755224477554%">          <p><a href="/consumer/cn/doc/harmonyos-references/core-vision-face-detector-api#section1821372213619">FaceRecognitionConfiguration</a></p></td>         <td class="cellrowborder" width="17.348265173482652%">          <p>是</p></td>         <td class="cellrowborder" width="40.815918408159185%">          <p>人脸遮挡检测配置参数。</p></td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.14.9.1.3.1.1" width="38.379999999999995%">          <p>类型</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.14.9.1.3.1.2" width="61.62%">          <p>说明</p></th>        </tr><tr>         <td class="cellrowborder" width="38.379999999999995%">          <p>Promise&lt;boolean&gt;</p></td>         <td class="cellrowborder" width="61.62%">          <p>Promise对象，返回初始化是否成功。</p>          <p>true：初始化成功；false：初始化失败。</p></td>        </tr>             </tbody></table></div>     </div>     <p><strong>错误码：</strong></p>     <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/core-vision-error-code">Core Vision Kit错误码</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.14.12.1.3.1.1" width="50%">          <p>错误码ID</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.14.12.1.3.1.2" width="50%">          <p>错误信息</p></th>        </tr><tr>         <td class="cellrowborder" width="50%">          <p>401</p></td>         <td class="cellrowborder" width="50%">          <p>The parameter check failed.</p></td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-aea-c106="" class="highlight-div"><div _ngcontent-aea-c106="" class="highlight-div-header"><div _ngcontent-aea-c106="" class="highlight-div-header-left"><div _ngcontent-aea-c106="" class="handle-button expand-button"><div _ngcontent-aea-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-aea-c106="" class="highlight-div-header-right"><div _ngcontent-aea-c106="" class="handle-button ai-button"></div><div _ngcontent-aea-c106="" class="handle-button line-button"><div _ngcontent-aea-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-aea-c106="" class="handle-button theme-button"><div _ngcontent-aea-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-aea-c106="" class="handle-button copy-button"><div _ngcontent-aea-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-aea-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { faceDetector } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.CoreVisionKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li>
</li><li><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">initAndReleaseFaceDetector</span>(<span class="hljs-params"></span>) {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">config</span>: faceDetector.<span class="hljs-property">FaceRecognitionConfiguration</span> = {</li><li>    <span class="hljs-attr">faceBlock</span>: <span class="hljs-literal">true</span></li><li>  }</li><li>  <span class="hljs-comment">// 初始化人脸遮挡检测服务</span></li><li>  <span class="hljs-keyword">const</span> initResult = <span class="hljs-keyword">await</span> faceDetector.<span class="hljs-title function_">init</span>(config);</li><li>  hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'faceDetectorSample'</span>, <span class="hljs-string">`Face detector initialization result:<span class="hljs-subst">${initResult}</span>`</span>);</li><li>
</li><li>  <span class="hljs-keyword">if</span> (initResult) {</li><li>    hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'faceDetectorSample'</span>, <span class="hljs-string">'Face detector initialized successfully'</span>);</li><li>
</li><li>    <span class="hljs-comment">// 这里可以添加使用人脸检测服务的代码</span></li><li>
</li><li>    <span class="hljs-comment">// 使用完毕后，释放人脸检测服务</span></li><li>    <span class="hljs-keyword">await</span> faceDetector.<span class="hljs-title function_">release</span>();</li><li>    hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'faceDetectorSample'</span>, <span class="hljs-string">'Face detector released successfully'</span>);</li><li>  } <span class="hljs-keyword">else</span> {</li><li>    hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'faceDetectorSample'</span>, <span class="hljs-string">'Failed to initialize face detector'</span>);</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Page</span> {</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>(){</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'initAndReleaseFaceDetector'</span>).<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>        <span class="hljs-comment">// 调用函数</span></li><li>        <span class="hljs-title function_">initAndReleaseFaceDetector</span>();</li><li>      })</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="section1079524313716" device-type="phone,2in1,tablet">faceDetector.release<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section1079524313716" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><p>release(): Promise&lt;void&gt;</p>     <p>释放人脸检测分析器服务。使用Promise异步回调。</p>     <p><strong>元服务API：</strong> 从版本5.0.2(14)开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力：</strong>SystemCapability.AI.Face.Detector</p>     <p><strong>起始版本：</strong>5.0.0(12)</p>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.15.8.1.3.1.1" width="38.440000000000005%">          <p>类型</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.15.8.1.3.1.2" width="61.56%">          <p>说明</p></th>        </tr><tr>         <td class="cellrowborder" width="38.440000000000005%">          <p>Promise&lt;void&gt;</p></td>         <td class="cellrowborder" width="61.56%">          <p>Promise对象，释放接口无返回值。</p></td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-aea-c106="" class="highlight-div"><div _ngcontent-aea-c106="" class="highlight-div-header"><div _ngcontent-aea-c106="" class="highlight-div-header-left"><div _ngcontent-aea-c106="" class="handle-button expand-button"><div _ngcontent-aea-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-aea-c106="" class="highlight-div-header-right"><div _ngcontent-aea-c106="" class="handle-button ai-button"></div><div _ngcontent-aea-c106="" class="handle-button line-button"><div _ngcontent-aea-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-aea-c106="" class="handle-button theme-button"><div _ngcontent-aea-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-aea-c106="" class="handle-button copy-button"><div _ngcontent-aea-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-aea-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { faceDetector } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.CoreVisionKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li>
</li><li><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">initAndReleaseFaceDetector</span>(<span class="hljs-params"></span>) {</li><li>  <span class="hljs-comment">// 初始化人脸检测服务</span></li><li>  <span class="hljs-keyword">const</span> initResult = <span class="hljs-keyword">await</span> faceDetector.<span class="hljs-title function_">init</span>();</li><li>  hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'faceDetectorSample'</span>, <span class="hljs-string">`Face detector initialization result:<span class="hljs-subst">${initResult}</span>`</span>);</li><li>
</li><li>  <span class="hljs-keyword">if</span> (initResult) {</li><li>    hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'faceDetectorSample'</span>, <span class="hljs-string">'Face detector initialized successfully'</span>);</li><li>
</li><li>    <span class="hljs-comment">// 这里可以添加使用人脸检测服务的代码</span></li><li>
</li><li>    <span class="hljs-comment">// 使用完毕后，释放人脸检测服务</span></li><li>    <span class="hljs-keyword">await</span> faceDetector.<span class="hljs-title function_">release</span>();</li><li>    hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'faceDetectorSample'</span>, <span class="hljs-string">'Face detector released successfully'</span>);</li><li>  } <span class="hljs-keyword">else</span> {</li><li>    hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'faceDetectorSample'</span>, <span class="hljs-string">'Failed to initialize face detector'</span>);</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Page</span> {</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>(){</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'initAndReleaseFaceDetector'</span>).<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>        <span class="hljs-comment">// 调用函数</span></li><li>        <span class="hljs-title function_">initAndReleaseFaceDetector</span>();</li><li>      })</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="section3410243584" device-type="phone,2in1,tablet">faceDetector.detect<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section3410243584" tips="复制节点链接"></i></h2>         <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div></div>    <p>detect(visionInfo: VisionInfo): Promise&lt;Array&lt;Face&gt;&gt;</p>    <p>检测一张图片中的人脸信息，使用Promise异步回调。</p>    <p><strong>元服务API：</strong> 从版本5.0.2(14)开始，该接口支持在元服务中使用。</p>    <p><strong>系统能力：</strong>SystemCapability.AI.Face.Detector</p>    <p><strong>起始版本：</strong>5.0.0(12)</p>    <p><strong>参数：</strong></p>    <div class="tablenoborder">     <div class="tbBox"><table>      <thead>       <tr>        <th align="left" class="cellrowborder" id="mcps1.3.23.1.5.1.1" width="19.2%">         <p>参数名</p></th>        <th align="left" class="cellrowborder" id="mcps1.3.23.1.5.1.2" width="22.07%">         <p>类型</p></th>        <th align="left" class="cellrowborder" id="mcps1.3.23.1.5.1.3" width="17.97%">         <p>必填</p></th>        <th align="left" class="cellrowborder" id="mcps1.3.23.1.5.1.4" width="40.760000000000005%">         <p>说明</p></th>       </tr>      </thead>             <tbody><tr>        <td class="cellrowborder" width="19.2%">         <p>visionInfo</p></td>        <td class="cellrowborder" width="22.07%">         <p><a href="/consumer/cn/doc/harmonyos-references/core-vision-face-detector-api#section14488135133518">VisionInfo</a></p></td>        <td class="cellrowborder" width="17.97%">         <p>是</p></td>        <td class="cellrowborder" width="40.760000000000005%">         <p>图片实例（包含人脸）。</p></td>       </tr>           </tbody></table></div>    </div>    <p><strong>返回值：</strong></p>    <div class="tablenoborder">     <div class="tbBox"><table class="tableClass2_t">                   <tbody><tr class="firstRow">        <th align="left" class="cellrowborder" id="mcps1.3.25.1.3.1.1" width="38.440000000000005%">         <p>类型</p></th>        <th align="left" class="cellrowborder" id="mcps1.3.25.1.3.1.2" width="61.56%">         <p>说明</p></th>       </tr><tr>        <td class="cellrowborder" width="38.440000000000005%">         <p>Promise&lt;Array&lt;<a href="/consumer/cn/doc/harmonyos-references/core-vision-face-detector-api#section747541297">Face</a>&gt;&gt;</p></td>        <td class="cellrowborder" width="61.56%">         <p>Promise对象，返回人脸检测的结果。</p></td>       </tr>           </tbody></table></div>    </div>    <p><strong>错误码：</strong></p>    <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/core-vision-error-code">Core Vision Kit错误码</a>。</p>    <div class="tablenoborder">     <div class="tbBox"><table class="tableClass2_t">                   <tbody><tr class="firstRow">        <th align="left" class="cellrowborder" id="mcps1.3.28.1.3.1.1" width="50%">         <p>错误码ID</p></th>        <th align="left" class="cellrowborder" id="mcps1.3.28.1.3.1.2" width="50%">         <p>错误信息</p></th>       </tr><tr>        <td class="cellrowborder" width="50%">         <p>200</p></td>        <td class="cellrowborder" width="50%">         <p>Run timed out, please try again later.</p></td>       </tr>       <tr>        <td class="cellrowborder" width="50%">         <p>401</p></td>        <td class="cellrowborder" width="50%">         <p>The parameter check failed.</p></td>       </tr>       <tr>        <td class="cellrowborder" width="50%">         <p>1008800001</p></td>        <td class="cellrowborder" width="50%">         <p>Failed to run, please try again.</p></td>       </tr>       <tr>        <td class="cellrowborder" width="50%">         <p>1008800002</p></td>        <td class="cellrowborder" width="50%">         <p>The service is abnormal.</p></td>       </tr>           </tbody></table></div>    </div>    <p><strong>示例：</strong></p>    <div _ngcontent-aea-c106="" class="highlight-div"><div _ngcontent-aea-c106="" class="highlight-div-header"><div _ngcontent-aea-c106="" class="highlight-div-header-left"><div _ngcontent-aea-c106="" class="handle-button expand-button"><div _ngcontent-aea-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-aea-c106="" class="highlight-div-header-right"><div _ngcontent-aea-c106="" class="handle-button ai-button"></div><div _ngcontent-aea-c106="" class="handle-button line-button"><div _ngcontent-aea-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-aea-c106="" class="handle-button theme-button"><div _ngcontent-aea-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-aea-c106="" class="handle-button copy-button"><div _ngcontent-aea-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-aea-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { faceDetector } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.CoreVisionKit'</span>;</li><li><span class="hljs-keyword">import</span> { image } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ImageKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { fileIo } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.CoreFileKit'</span>;</li><li><span class="hljs-keyword">import</span> { photoAccessHelper } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.MediaLibraryKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">imageSource</span>: image.<span class="hljs-property">ImageSource</span> | <span class="hljs-literal">undefined</span> = <span class="hljs-literal">undefined</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">chooseImage</span>: <span class="hljs-title class_">PixelMap</span> | <span class="hljs-literal">undefined</span> = <span class="hljs-literal">undefined</span>;</li><li>
</li><li><span class="hljs-comment">// 将图片转换为PixelMap，可以通过图库获取</span></li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">photoPicker</span>: photoAccessHelper.<span class="hljs-property">PhotoViewPicker</span> = <span class="hljs-keyword">new</span> photoAccessHelper.<span class="hljs-title class_">PhotoViewPicker</span>();</li><li>photoPicker.<span class="hljs-title function_">select</span>({</li><li>  <span class="hljs-title class_">MIMEType</span>: photoAccessHelper.<span class="hljs-property">PhotoViewMIMETypes</span>.<span class="hljs-property">IMAGE_TYPE</span>,</li><li>  <span class="hljs-attr">maxSelectNumber</span>: <span class="hljs-number">1</span></li><li>}).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">res: photoAccessHelper.PhotoSelectResult</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">let</span> uri = res.<span class="hljs-property">photoUris</span>[<span class="hljs-number">0</span>];</li><li>  <span class="hljs-keyword">if</span> (uri === <span class="hljs-literal">undefined</span>) {</li><li>    hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'faceDetectorSample'</span>, <span class="hljs-string">'uri is undefined'</span>);</li><li>    <span class="hljs-keyword">return</span></li><li>  }</li><li>  <span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">async</span> () =&gt; {</li><li>    <span class="hljs-keyword">let</span> file = <span class="hljs-keyword">await</span> fileIo.<span class="hljs-title function_">open</span>(uri, fileIo.<span class="hljs-property">OpenMode</span>.<span class="hljs-property">READ_ONLY</span>);</li><li>    imageSource = image.<span class="hljs-title function_">createImageSource</span>(file.<span class="hljs-property">fd</span>);</li><li>    chooseImage = <span class="hljs-keyword">await</span> imageSource.<span class="hljs-title function_">createPixelMap</span>();</li><li>    hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'faceDetectorSample'</span>, <span class="hljs-string">'chooseImage:'</span>, chooseImage);</li><li>    <span class="hljs-keyword">if</span> (!chooseImage) {</li><li>      <span class="hljs-keyword">return</span></li><li>    }</li><li>    <span class="hljs-comment">// 调用人脸检测接口</span></li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">visionInfo</span>: faceDetector.<span class="hljs-property">VisionInfo</span> = {</li><li>      <span class="hljs-attr">pixelMap</span>: chooseImage</li><li>    };</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">data</span>: faceDetector.<span class="hljs-property">Face</span>[] = <span class="hljs-keyword">await</span> faceDetector.<span class="hljs-title function_">detect</span>(visionInfo);</li><li>    <span class="hljs-keyword">if</span> (data.<span class="hljs-property">length</span> === <span class="hljs-number">0</span>) {</li><li>      hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'faceDetectorSample'</span>, <span class="hljs-string">'No face is detected in the image.'</span>);</li><li>    } <span class="hljs-keyword">else</span> {</li><li>      <span class="hljs-keyword">let</span> faceString = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data);</li><li>      hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'faceDetectorSample'</span>, <span class="hljs-string">'faceString data is '</span> + faceString);</li><li>    }</li><li>
</li><li>    <span class="hljs-keyword">if</span> (chooseImage &amp;&amp; imageSource) {</li><li>      chooseImage.<span class="hljs-title function_">release</span>();</li><li>      imageSource.<span class="hljs-title function_">release</span>();</li><li>    }</li><li>    <span class="hljs-keyword">if</span> (file) {</li><li>      <span class="hljs-keyword">try</span> {</li><li>        <span class="hljs-keyword">await</span> fileIo.<span class="hljs-title function_">close</span>(file);</li><li>      } <span class="hljs-keyword">catch</span> (err) {</li><li>        hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'faceDetectorSample'</span>, <span class="hljs-string">`Failed to close fileSource. Code: <span class="hljs-subst">${err.code}</span>，message: <span class="hljs-subst">${err.message}</span>`</span>);</li><li>      }</li><li>    }</li><li>  }, <span class="hljs-number">100</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'faceDetectorSample'</span>, <span class="hljs-string">`Failed to get photo image uri. code: <span class="hljs-subst">${err.code}</span>，message: <span class="hljs-subst">${err.message}</span>`</span>);</li><li>});</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Page</span> {</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>(){</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>   </div>   <div></div></div>