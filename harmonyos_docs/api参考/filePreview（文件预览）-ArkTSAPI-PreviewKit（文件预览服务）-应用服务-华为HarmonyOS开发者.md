<h1 _ngcontent-mgp-c119="" class="doc-title ng-star-inserted" title="filePreview（文件预览）"> filePreview（文件预览） </h1>

<div _ngcontent-mgp-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div><p>本模块为应用提供便捷的文件快速预览能力。应用可以通过文件预览提供的系统级预览API，可快速启动预览界面，实现对各类文件的预览。通过预览服务，用户可以对文件（包括图片，视频，音频，文本、html等）进行操作。</p> <p>本模块提供接入文件快速预览的能力，可通过传递文件信息快速打开预览窗口。</p> <p>支持的预览文件类型如下：</p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.4.1.4.1.1" width="14.361436143614362%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.4.1.4.1.2" width="37.38373837383738%"><p>文件后缀</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.4.1.4.1.3" width="48.254825482548256%"><p>mimeType类型</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="14.361436143614362%"><p>文本</p> </td> <td class="cellrowborder" width="37.38373837383738%"><p>txt、cpp、c、h、java、xhtml、xml</p> </td> <td class="cellrowborder" width="48.254825482548256%"><p>text/plain、text/x-c++src、text/x-csrc、text/x-chdr、text/x-java、application/xhtml+xml、text/xml</p> </td> </tr> <tr><td class="cellrowborder" width="14.361436143614362%"><p>网页</p> </td> <td class="cellrowborder" width="37.38373837383738%"><p>html、htm</p> </td> <td class="cellrowborder" width="48.254825482548256%"><p>text/html</p> </td> </tr> <tr><td class="cellrowborder" width="14.361436143614362%"><p>图片</p> </td> <td class="cellrowborder" width="37.38373837383738%"><p>jpg、png、gif、webp、bmp、svg</p> </td> <td class="cellrowborder" width="48.254825482548256%"><p>image/jpeg、image/png、image/gif、image/webp，image/bmp、image/svg+xml</p> </td> </tr> <tr><td class="cellrowborder" width="14.361436143614362%"><p>音频</p> </td> <td class="cellrowborder" width="37.38373837383738%"><p>m4a、aac、mp3、ogg、wav</p> </td> <td class="cellrowborder" width="48.254825482548256%"><p>audio/mp4a-latm、audio/aac、audio/mpeg、audio/ogg、audio/x-wav</p> </td> </tr> <tr><td class="cellrowborder" width="14.361436143614362%"><p>视频</p> </td> <td class="cellrowborder" width="37.38373837383738%"><p>mp4、mkv、ts</p> </td> <td class="cellrowborder" width="48.254825482548256%"><p>video/mp4、video/x-matroska、video/mp2ts</p> </td> </tr> <tr><td class="cellrowborder" width="14.361436143614362%"><p>文件夹</p> </td> <td class="cellrowborder" width="37.38373837383738%"><p>无</p> </td> <td class="cellrowborder" width="48.254825482548256%"><p>无</p> </td> </tr> <tr><td class="cellrowborder" width="14.361436143614362%"><p>文档</p> </td> <td class="cellrowborder" width="37.38373837383738%"><p>pdf</p> </td> <td class="cellrowborder" width="48.254825482548256%"><p>application/pdf</p> <p><strong>起始版本：</strong>5.0.0(12)</p> </td> </tr> <tr><td class="cellrowborder" width="14.361436143614362%"><p>Office文档</p> </td> <td class="cellrowborder" width="37.38373837383738%"><p>doc、docx、xls、xlsx、ppt、pptx、csv、ofd</p> </td> <td class="cellrowborder" width="48.254825482548256%"><p>application/msword、application/vnd.openxmlformats-officedocument.wordprocessingml.document、application/vnd.ms-excel、application/vnd.openxmlformats-officedocument.spreadsheetml.sheet、application/vnd.ms-powerpoint、application/vnd.openxmlformats-officedocument.presentationml.presentation、text/csv、general.ofd</p> <p><strong>起始版本：</strong>5.0.0(12)</p> </td> </tr>  </tbody></table></div> </div> <p><strong>起始版本：</strong>4.1.0(11)</p> <div class="tiledSection"><h2 id="section16609101116259" device-type="phone,2in1,tablet">导入模块<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section16609101116259" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><div _ngcontent-mgp-c106="" class="highlight-div"><div _ngcontent-mgp-c106="" class="highlight-div-header"><div _ngcontent-mgp-c106="" class="highlight-div-header-left"><div _ngcontent-mgp-c106="" class="handle-button expand-button"><div _ngcontent-mgp-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mgp-c106="" class="highlight-div-header-right"><div _ngcontent-mgp-c106="" class="handle-button ai-button"></div><div _ngcontent-mgp-c106="" class="handle-button line-button"><div _ngcontent-mgp-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mgp-c106="" class="handle-button theme-button"><div _ngcontent-mgp-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mgp-c106="" class="handle-button copy-button"><div _ngcontent-mgp-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mgp-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { filePreview } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PreviewKit'</span>;</li></ol></pre></div></div> </div> <div class="tiledSection"><h2 id="section1081123302517" device-type="phone,2in1,tablet">PreviewInfo<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section1081123302517" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><p>文件预览信息，包含了文件标题名、uri以及文件类型（mimeType）。</p> <p><strong>元服务API：</strong>从版本4.1.0(11)开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong> SystemCapability.FileManagement.FilePreview.Core</p> <p><strong>起始版本：</strong>4.1.0(11)</p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.7.6.1.6.1.1" width="20%"><p>名称</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.7.6.1.6.1.2" width="20%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.7.6.1.6.1.3" width="17.43%"><p>只读</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.7.6.1.6.1.4" width="14.71%"><p>可选</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.7.6.1.6.1.5" width="27.860000000000003%"><p>说明</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="20%"><p>title</p> </td> <td class="cellrowborder" width="20%"><p>string</p> </td> <td class="cellrowborder" width="17.43%"><p>否</p> </td> <td class="cellrowborder" width="14.71%"><p>是</p> </td> <td class="cellrowborder" width="27.860000000000003%"><p>文件的标题名称</p> </td> </tr> <tr><td class="cellrowborder" width="20%"><p>uri</p> </td> <td class="cellrowborder" width="20%"><p>string</p> </td> <td class="cellrowborder" width="17.43%"><p>否</p> </td> <td class="cellrowborder" width="14.71%"><p>否</p> </td> <td class="cellrowborder" width="27.860000000000003%"><p>文件的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/user-file-uri-intro" target="_blank">uri</a></p> </td> </tr> <tr><td class="cellrowborder" width="20%"><p>mimeType</p> </td> <td class="cellrowborder" width="20%"><p>string</p> </td> <td class="cellrowborder" width="17.43%"><p>否</p> </td> <td class="cellrowborder" width="14.71%"><p>否</p> </td> <td class="cellrowborder" width="27.860000000000003%"><p>文件的媒体资源类型，如text/plain。</p> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p>若无法确定文件格式，该项可直接赋值空字符串（""），系统会通过uri后缀进行文件格式判断。</p> </div></div></div> </td> </tr>  </tbody></table></div> </div> </div> <div class="tiledSection"><h2 id="section177311614561" device-type="phone,2in1,tablet">DisplayInfo<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section177311614561" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><p>悬浮窗口的属性值，包含了悬浮窗大小以及位置信息。</p> <p><strong>元服务API：</strong>从版本4.1.0(11)开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong> SystemCapability.FileManagement.FilePreview.Core</p> <p><strong>起始版本：</strong>4.1.0(11)</p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.8.6.1.6.1.1" width="15.6%"><p>名称</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.8.6.1.6.1.2" width="15.950000000000001%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.8.6.1.6.1.3" width="17.47%"><p>只读</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.8.6.1.6.1.4" width="16.869999999999997%"><p>可选</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.8.6.1.6.1.5" width="34.11%"><p>说明</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="15.6%"><p>x</p> </td> <td class="cellrowborder" width="15.950000000000001%"><p>number</p> </td> <td class="cellrowborder" width="17.47%"><p>否</p> </td> <td class="cellrowborder" width="16.869999999999997%"><p>否</p> </td> <td class="cellrowborder" width="34.11%"><p>预览窗口的起始X轴，单位px</p> </td> </tr> <tr><td class="cellrowborder" width="15.6%"><p>y</p> </td> <td class="cellrowborder" width="15.950000000000001%"><p>number</p> </td> <td class="cellrowborder" width="17.47%"><p>否</p> </td> <td class="cellrowborder" width="16.869999999999997%"><p>否</p> </td> <td class="cellrowborder" width="34.11%"><p>预览窗口的起始Y轴，单位px</p> </td> </tr> <tr><td class="cellrowborder" width="15.6%"><p>width</p> </td> <td class="cellrowborder" width="15.950000000000001%"><p>number</p> </td> <td class="cellrowborder" width="17.47%"><p>否</p> </td> <td class="cellrowborder" width="16.869999999999997%"><p>是</p> </td> <td class="cellrowborder" width="34.11%"><p>预览窗口的宽度，单位px</p> </td> </tr> <tr><td class="cellrowborder" width="15.6%"><p>height</p> </td> <td class="cellrowborder" width="15.950000000000001%"><p>number</p> </td> <td class="cellrowborder" width="17.47%"><p>否</p> </td> <td class="cellrowborder" width="16.869999999999997%"><p>是</p> </td> <td class="cellrowborder" width="34.11%"><p>预览窗口的高度，单位px</p> </td> </tr>  </tbody></table></div> </div> </div> <div class="tiledSection"><h2 id="section144826162913" device-type="phone,2in1,tablet">openPreview<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section144826162913" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><p>openPreview(context: Context, file: PreviewInfo, info?: DisplayInfo): Promise&lt;void&gt;</p> <p>通过传入文件预览信息以及悬浮窗口属性信息，打开预览窗口。1秒内重复调用无效。使用Promise方式异步返回结果。</p> <p>该接口需要调用方确认传入的uri可进行转授权。</p> <p><strong>元服务API：</strong>从版本4.1.0(11)开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong> SystemCapability.FileManagement.FilePreview.Core</p> <p><strong>起始版本：</strong>4.1.0(11)</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.9.9.1.5.1.1" width="19.2%"><p>参数名</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.9.9.1.5.1.2" width="30.8%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.9.9.1.5.1.3" width="8.32%"><p>必填</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.9.9.1.5.1.4" width="41.68%"><p>说明</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="19.2%"><p>context</p> </td> <td class="cellrowborder" width="30.8%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-context" target="_blank">Context</a></p> </td> <td class="cellrowborder" width="8.32%"><p>是</p> </td> <td class="cellrowborder" width="41.68%"><p>上下文<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext" target="_blank">common.UIAbilityContext</a>。</p> <div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content"><p>当前context仅支持传入UIAbilityContext。</p> </div></div></div> </td> </tr> <tr><td class="cellrowborder" width="19.2%"><p>file</p> </td> <td class="cellrowborder" width="30.8%"><p><a href="/consumer/cn/doc/harmonyos-references/preview-arkts#section1081123302517">PreviewInfo</a></p> </td> <td class="cellrowborder" width="8.32%"><p>是</p> </td> <td class="cellrowborder" width="41.68%"><p>文件的预览信息，title为可选，不填会通过uri解析，无法解析则显示未知文件。</p> </td> </tr> <tr><td class="cellrowborder" width="19.2%"><p>info</p> </td> <td class="cellrowborder" width="30.8%"><p><a href="/consumer/cn/doc/harmonyos-references/preview-arkts#section177311614561">DisplayInfo</a></p> </td> <td class="cellrowborder" width="8.32%"><p>否</p> </td> <td class="cellrowborder" width="41.68%"><p>模态窗口的窗口展示信息，2in1端不填写则展示默认大小窗口，手机和平板设备填写无效。</p> </td> </tr>  </tbody></table></div> </div> <p><strong>返回值：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.9.11.1.3.1.1" width="50%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.9.11.1.3.1.2" width="50%"><p>说明</p> </th> </tr><tr><td class="cellrowborder" width="50%"><p>Promise&lt;void&gt;</p> </td> <td class="cellrowborder" width="50%"><p>无返回结果的Promise对象。</p> </td> </tr>  </tbody></table></div> </div> <p><strong>错误码：</strong>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal" target="_blank">通用错误码</a></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.9.13.1.3.1.1" width="49.96%"><p>错误码ID</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.9.13.1.3.1.2" width="50.03999999999999%"><p>错误信息</p> </th> </tr><tr><td class="cellrowborder" width="49.96%"><p>401</p> </td> <td class="cellrowborder" width="50.03999999999999%"><p>invalid input parameter.</p> </td> </tr>  </tbody></table></div> </div> <p><strong>示例：</strong></p> <div _ngcontent-mgp-c106="" class="highlight-div"><div _ngcontent-mgp-c106="" class="highlight-div-header"><div _ngcontent-mgp-c106="" class="highlight-div-header-left"><div _ngcontent-mgp-c106="" class="handle-button expand-button"><div _ngcontent-mgp-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mgp-c106="" class="highlight-div-header-right"><div _ngcontent-mgp-c106="" class="handle-button ai-button"></div><div _ngcontent-mgp-c106="" class="handle-button line-button"><div _ngcontent-mgp-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mgp-c106="" class="handle-button theme-button"><div _ngcontent-mgp-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mgp-c106="" class="handle-button copy-button"><div _ngcontent-mgp-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mgp-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { filePreview } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PreviewKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> uiContext = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> <span class="hljs-title class_">Context</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">displayInfo</span>: filePreview.<span class="hljs-property">DisplayInfo</span> = {</li><li>  <span class="hljs-attr">x</span>: <span class="hljs-number">100</span>,</li><li>  <span class="hljs-attr">y</span>: <span class="hljs-number">100</span>,</li><li>  <span class="hljs-attr">width</span>: <span class="hljs-number">800</span>,</li><li>  <span class="hljs-attr">height</span>: <span class="hljs-number">800</span></li><li>};</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">fileInfo</span>: filePreview.<span class="hljs-property">PreviewInfo</span> = {</li><li>  <span class="hljs-attr">title</span>: <span class="hljs-string">'1.txt'</span>,</li><li>  <span class="hljs-attr">uri</span>: <span class="hljs-string">'file://docs/storage/Users/currentUser/Documents/1.txt'</span>,</li><li>  <span class="hljs-attr">mimeType</span>: <span class="hljs-string">'text/plain'</span></li><li>};</li><li>filePreview.<span class="hljs-title function_">openPreview</span>(uiContext, fileInfo, displayInfo).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Succeeded in opening preview'</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Failed to open preview, err.code = <span class="hljs-subst">${err.code}</span>, err.message = <span class="hljs-subst">${err.message}</span>`</span>);</li><li>});</li></ol></pre></div></div> </div> <p></p> <div class="tiledSection"><h2 id="section194471112185315" device-type="phone,2in1,tablet">openPreview<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section194471112185315" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><p>openPreview(context: Context, file: PreviewInfo, info: DisplayInfo, callback: AsyncCallback&lt;void&gt;): void</p> <p>通过传入文件预览信息以及悬浮窗口属性信息，打开预览窗口。1秒内重复调用无效。使用Callback回调异步返回结果。</p> <p>该接口需要调用方确认传入的uri可进行转授权。</p> <p><strong>元服务API：</strong>从版本4.1.0(11)开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong> SystemCapability.FileManagement.FilePreview.Core</p> <p><strong>起始版本：</strong>4.1.0(11)</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.11.9.1.5.1.1" width="19.2%"><p>参数名</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.11.9.1.5.1.2" width="30.8%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.11.9.1.5.1.3" width="9.24%"><p>必填</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.11.9.1.5.1.4" width="40.760000000000005%"><p>说明</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="19.2%"><p>context</p> </td> <td class="cellrowborder" width="30.8%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-context" target="_blank">Context</a></p> </td> <td class="cellrowborder" width="9.24%"><p>是</p> </td> <td class="cellrowborder" width="40.760000000000005%"><p>上下文<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext" target="_blank">common.UIAbilityContext</a>。</p> <div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content"><p>当前context仅支持传入UIAbilityContext。</p> </div></div></div> </td> </tr> <tr><td class="cellrowborder" width="19.2%"><p>file</p> </td> <td class="cellrowborder" width="30.8%"><p><a href="/consumer/cn/doc/harmonyos-references/preview-arkts#section1081123302517">PreviewInfo</a></p> </td> <td class="cellrowborder" width="9.24%"><p>是</p> </td> <td class="cellrowborder" width="40.760000000000005%"><p>文件的预览信息，title为可选，不填写时会通过uri解析，无法解析则显示未知文件。</p> </td> </tr> <tr><td class="cellrowborder" width="19.2%"><p>info</p> </td> <td class="cellrowborder" width="30.8%"><p><a href="/consumer/cn/doc/harmonyos-references/preview-arkts#section177311614561">DisplayInfo</a></p> </td> <td class="cellrowborder" width="9.24%"><p>是</p> </td> <td class="cellrowborder" width="40.760000000000005%"><p>模态窗口的窗口展示信息，手机和平板设备填写无效。</p> </td> </tr> <tr><td class="cellrowborder" width="19.2%"><p>callback</p> </td> <td class="cellrowborder" width="30.8%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-base#asynccallback" target="_blank">AsyncCallback</a>&lt;void&gt;</p> </td> <td class="cellrowborder" width="9.24%"><p>是</p> </td> <td class="cellrowborder" width="40.760000000000005%"><p>回调函数。当预览窗口成功打开时，err为undefined或err.code为0，否则为错误对象。</p> </td> </tr>  </tbody></table></div> </div> <p><strong>错误码：</strong>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal" target="_blank">通用错误码</a></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.11.11.1.3.1.1" width="49.9%"><p>错误码ID</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.11.11.1.3.1.2" width="50.1%"><p>错误信息</p> </th> </tr><tr><td class="cellrowborder" width="49.9%"><p>401</p> </td> <td class="cellrowborder" width="50.1%"><p>invalid input parameter.</p> </td> </tr>  </tbody></table></div> </div> <p><strong>示例：</strong></p> <div _ngcontent-mgp-c106="" class="highlight-div"><div _ngcontent-mgp-c106="" class="highlight-div-header"><div _ngcontent-mgp-c106="" class="highlight-div-header-left"><div _ngcontent-mgp-c106="" class="handle-button expand-button"><div _ngcontent-mgp-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mgp-c106="" class="highlight-div-header-right"><div _ngcontent-mgp-c106="" class="handle-button ai-button"></div><div _ngcontent-mgp-c106="" class="handle-button line-button"><div _ngcontent-mgp-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mgp-c106="" class="handle-button theme-button"><div _ngcontent-mgp-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mgp-c106="" class="handle-button copy-button"><div _ngcontent-mgp-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mgp-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { filePreview } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PreviewKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> uiContext = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> <span class="hljs-title class_">Context</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">displayInfo</span>: filePreview.<span class="hljs-property">DisplayInfo</span> = {</li><li>  <span class="hljs-attr">x</span>: <span class="hljs-number">100</span>,</li><li>  <span class="hljs-attr">y</span>: <span class="hljs-number">100</span>,</li><li>  <span class="hljs-attr">width</span>: <span class="hljs-number">800</span>,</li><li>  <span class="hljs-attr">height</span>: <span class="hljs-number">800</span></li><li>};</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">fileInfo</span>: filePreview.<span class="hljs-property">PreviewInfo</span> = {</li><li>  <span class="hljs-attr">title</span>: <span class="hljs-string">'1.txt'</span>,</li><li>  <span class="hljs-attr">uri</span>: <span class="hljs-string">'file://docs/storage/Users/currentUser/Documents/1.txt'</span>,</li><li>  <span class="hljs-attr">mimeType</span>: <span class="hljs-string">'text/plain'</span></li><li>};</li><li>filePreview.<span class="hljs-title function_">openPreview</span>(uiContext, fileInfo, displayInfo, <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (err &amp;&amp; err.<span class="hljs-property">code</span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Failed to open preview, err.code = <span class="hljs-subst">${err.code}</span>, err.message = <span class="hljs-subst">${err.message}</span>`</span>);</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Succeeded in opening preview'</span>);</li><li>});</li></ol></pre></div></div> </div> <p></p> <div class="tiledSection"><h2 id="section18472142115592" device-type="phone,2in1,tablet">openPreview<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section18472142115592" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><p>openPreview(context: Context, files: Array&lt;PreviewInfo&gt;, index?: number): Promise&lt;void&gt;</p> <p>通过传入多个文件预览信息以及选择展示的文件信息下标，打开预览窗口。1秒内重复调用无效。使用Promise方式异步返回结果。</p> <p>该接口需要调用方确认传入的uri可进行转授权。</p> <p>该接口不支持2in1设备。</p> <p><strong>元服务API：</strong>从版本5.0.0(12)开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong> SystemCapability.FileManagement.FilePreview.Core</p> <p><strong>起始版本：</strong>5.0.0(12)</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.13.10.1.5.1.1" width="19.2%"><p>参数名</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.13.10.1.5.1.2" width="30.8%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.13.10.1.5.1.3" width="9.24%"><p>必填</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.13.10.1.5.1.4" width="40.760000000000005%"><p>说明</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="19.2%"><p>context</p> </td> <td class="cellrowborder" width="30.8%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-context" target="_blank">Context</a></p> </td> <td class="cellrowborder" width="9.24%"><p>是</p> </td> <td class="cellrowborder" width="40.760000000000005%"><p>上下文<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext" target="_blank">common.UIAbilityContext</a>。</p> <div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content"><p>当前context仅支持传入UIAbilityContext。</p> </div></div></div> </td> </tr> <tr><td class="cellrowborder" width="19.2%"><p>files</p> </td> <td class="cellrowborder" width="30.8%"><p>Array&lt;<a href="/consumer/cn/doc/harmonyos-references/preview-arkts#section1081123302517">PreviewInfo</a>&gt;</p> </td> <td class="cellrowborder" width="9.24%"><p>是</p> </td> <td class="cellrowborder" width="40.760000000000005%"><p>文件预览信息列表。</p> </td> </tr> <tr><td class="cellrowborder" width="19.2%"><p>index</p> </td> <td class="cellrowborder" width="30.8%"><p>number</p> </td> <td class="cellrowborder" width="9.24%"><p>否</p> </td> <td class="cellrowborder" width="40.760000000000005%"><p>预览窗口打开时展示的文件预览信息下标，不填默认为0。取值范围大于等于0，小于files长度。</p> </td> </tr>  </tbody></table></div> </div> <p><strong>返回值：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.13.12.1.3.1.1" width="50%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.13.12.1.3.1.2" width="50%"><p>说明</p> </th> </tr><tr><td class="cellrowborder" width="50%"><p>Promise&lt;void&gt;</p> </td> <td class="cellrowborder" width="50%"><p>无返回结果的Promise对象。</p> </td> </tr>  </tbody></table></div> </div> <p><strong>错误码：</strong>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal" target="_blank">通用错误码</a></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.13.14.1.3.1.1" width="49.96%"><p>错误码ID</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.13.14.1.3.1.2" width="50.03999999999999%"><p>错误信息</p> </th> </tr><tr><td class="cellrowborder" width="49.96%"><p>401</p> </td> <td class="cellrowborder" width="50.03999999999999%"><p>invalid input parameter.</p> </td> </tr> <tr><td class="cellrowborder" width="49.96%"><p>801</p> </td> <td class="cellrowborder" width="50.03999999999999%"><p>Capability not supported.</p> </td> </tr>  </tbody></table></div> </div> <p><strong>示例：</strong></p> <div _ngcontent-mgp-c106="" class="highlight-div"><div _ngcontent-mgp-c106="" class="highlight-div-header"><div _ngcontent-mgp-c106="" class="highlight-div-header-left"><div _ngcontent-mgp-c106="" class="handle-button expand-button"><div _ngcontent-mgp-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mgp-c106="" class="highlight-div-header-right"><div _ngcontent-mgp-c106="" class="handle-button ai-button"></div><div _ngcontent-mgp-c106="" class="handle-button line-button"><div _ngcontent-mgp-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mgp-c106="" class="handle-button theme-button"><div _ngcontent-mgp-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mgp-c106="" class="handle-button copy-button"><div _ngcontent-mgp-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mgp-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { filePreview } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PreviewKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> uiContext = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> <span class="hljs-title class_">Context</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">fileInfo</span>: filePreview.<span class="hljs-property">PreviewInfo</span> = {</li><li>  <span class="hljs-attr">title</span>: <span class="hljs-string">'1.txt'</span>,</li><li>  <span class="hljs-attr">uri</span>: <span class="hljs-string">'file://docs/storage/Users/currentUser/Documents/1.txt'</span>,</li><li>  <span class="hljs-attr">mimeType</span>: <span class="hljs-string">'text/plain'</span></li><li>};</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">files</span>: <span class="hljs-title class_">Array</span>&lt;filePreview.<span class="hljs-property">PreviewInfo</span>&gt; = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>();</li><li>files.<span class="hljs-title function_">push</span>(fileInfo);</li><li>filePreview.<span class="hljs-title function_">openPreview</span>(uiContext, files, <span class="hljs-number">0</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Succeeded in opening preview'</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Failed to open preview, err.code = <span class="hljs-subst">${err.code}</span>, err.message = <span class="hljs-subst">${err.message}</span>`</span>);</li><li>});</li></ol></pre></div></div> </div> <p></p> <div class="tiledSection"><h2 id="section3643113161616" device-type="phone,2in1,tablet">canPreview<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section3643113161616" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><p>canPreview(context: Context, uri: string): Promise&lt;boolean&gt;</p> <p>根据文件的uri判断文件是否可预览，当传入支持的文件uri时，会返回true；传入不可预览的文件uri时，返回false。使用Promise方式异步返回结果。</p> <p>当前接口仅针对文件是否存在以及文件格式是否为支持的文件类型进行检验，后续openPreview进行文件查看时需要调用方保证文件可以被转授权。</p> <p><strong>元服务API：</strong>从版本4.1.0(11)开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong> SystemCapability.FileManagement.FilePreview.Core</p> <p><strong>起始版本：</strong>4.1.0(11)</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.15.9.1.5.1.1" width="19.2%"><p>参数名</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.15.9.1.5.1.2" width="30.8%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.15.9.1.5.1.3" width="9.24%"><p>必填</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.15.9.1.5.1.4" width="40.760000000000005%"><p>说明</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="19.2%"><p>context</p> </td> <td class="cellrowborder" width="30.8%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-context" target="_blank">Context</a></p> </td> <td class="cellrowborder" width="9.24%"><p>是</p> </td> <td class="cellrowborder" width="40.760000000000005%"><p>上下文<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext" target="_blank">common.UIAbilityContext</a>。</p> <div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content"><p>当前context仅支持传入UIAbilityContext。</p> </div></div></div> </td> </tr> <tr><td class="cellrowborder" width="19.2%"><p>uri</p> </td> <td class="cellrowborder" width="30.8%"><p>string</p> </td> <td class="cellrowborder" width="9.24%"><p>是</p> </td> <td class="cellrowborder" width="40.760000000000005%"><p>文件<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/user-file-uri-intro" target="_blank">uri</a></p> </td> </tr>  </tbody></table></div> </div> <p><strong>返回值：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.15.11.1.3.1.1" width="50%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.15.11.1.3.1.2" width="50%"><p>说明</p> </th> </tr><tr><td class="cellrowborder" width="50%"><p>Promise&lt;boolean&gt;</p> </td> <td class="cellrowborder" width="50%"><p>Promise对象，当传入支持的文件uri时，会返回true；传入不可预览的文件uri时，返回false。</p> </td> </tr>  </tbody></table></div> </div> <p><strong>错误码：</strong>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal" target="_blank">通用错误码</a></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.15.13.1.3.1.1" width="49.96%"><p>错误码ID</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.15.13.1.3.1.2" width="50.03999999999999%"><p>错误信息</p> </th> </tr><tr><td class="cellrowborder" width="49.96%"><p>401</p> </td> <td class="cellrowborder" width="50.03999999999999%"><p>invalid input parameter.</p> </td> </tr>  </tbody></table></div> </div> <p><strong>示例：</strong></p> <div _ngcontent-mgp-c106="" class="highlight-div"><div _ngcontent-mgp-c106="" class="highlight-div-header"><div _ngcontent-mgp-c106="" class="highlight-div-header-left"><div _ngcontent-mgp-c106="" class="handle-button expand-button"><div _ngcontent-mgp-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mgp-c106="" class="highlight-div-header-right"><div _ngcontent-mgp-c106="" class="handle-button ai-button"></div><div _ngcontent-mgp-c106="" class="handle-button line-button"><div _ngcontent-mgp-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mgp-c106="" class="handle-button theme-button"><div _ngcontent-mgp-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mgp-c106="" class="handle-button copy-button"><div _ngcontent-mgp-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mgp-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { filePreview } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PreviewKit'</span>;</li><li>
</li><li> <span class="hljs-comment">// e.g 文件存在且类型符合时 </span></li><li><span class="hljs-keyword">let</span> uri = <span class="hljs-string">'file://docs/storage/Users/currentUser/Documents/1.txt'</span>;</li><li><span class="hljs-keyword">let</span> uiContext = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> <span class="hljs-title class_">Context</span>;</li><li>filePreview.<span class="hljs-title function_">canPreview</span>(uiContext, uri).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">result</span>) =&gt;</span> {    <span class="hljs-comment">// 此处返回true</span></li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`Succeeded in obtaining the result of whether it can be previewed. result = <span class="hljs-subst">${result}</span>`</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Failed to obtain the result of whether it can be previewed, err.code = <span class="hljs-subst">${err.code}</span>, err.message = <span class="hljs-subst">${err.message}</span>`</span>);</li><li>})</li></ol></pre></div></div> <div _ngcontent-mgp-c106="" class="highlight-div"><div _ngcontent-mgp-c106="" class="highlight-div-header"><div _ngcontent-mgp-c106="" class="highlight-div-header-left"><div _ngcontent-mgp-c106="" class="handle-button expand-button"><div _ngcontent-mgp-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mgp-c106="" class="highlight-div-header-right"><div _ngcontent-mgp-c106="" class="handle-button ai-button"></div><div _ngcontent-mgp-c106="" class="handle-button line-button"><div _ngcontent-mgp-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mgp-c106="" class="handle-button theme-button"><div _ngcontent-mgp-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mgp-c106="" class="handle-button copy-button"><div _ngcontent-mgp-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mgp-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { filePreview } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PreviewKit'</span>;</li><li>
</li><li><span class="hljs-comment">// e.g 文件不存在或文件类型不符合时 </span></li><li><span class="hljs-keyword">let</span> uri = <span class="hljs-string">'file://docs/storage/Users/currentUser/Documents/1.txt'</span>;</li><li><span class="hljs-keyword">let</span> uiContext = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> <span class="hljs-title class_">Context</span>;</li><li>filePreview.<span class="hljs-title function_">canPreview</span>(uiContext, uri).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">result</span>) =&gt;</span> {    <span class="hljs-comment">// 此处返回false</span></li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`Succeeded in obtaining the result of whether it can be previewed. result = <span class="hljs-subst">${result}</span>`</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Failed to obtain the result of whether it can be previewed, err.code = <span class="hljs-subst">${err.code}</span>, err.message = <span class="hljs-subst">${err.message}</span>`</span>);</li><li>});</li></ol></pre></div></div> </div> <div class="tiledSection"><h2 id="section156699320551" device-type="phone,2in1,tablet">canPreview<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section156699320551" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><p>canPreview(context: Context, uri: string, callback: AsyncCallback&lt;boolean&gt;): void</p> <p>根据文件的uri判断文件是否可预览，当传入支持的文件uri时，会返回true；传入不可预览的文件uri时，返回false。使用Callback回调异步返回结果。</p> <p>当前接口仅针对文件是否存在以及文件格式是否为支持的文件类型进行检验，后续openPreview进行文件查看时需要调用方保证文件可以被转授权。</p> <p><strong>元服务API：</strong>从版本4.1.0(11)开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong> SystemCapability.FileManagement.FilePreview.Core</p> <p><strong>起始版本：</strong>4.1.0(11)</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.16.9.1.5.1.1" width="19.2%"><p>参数名</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.16.9.1.5.1.2" width="30.8%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.16.9.1.5.1.3" width="8.59%"><p>必填</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.16.9.1.5.1.4" width="41.410000000000004%"><p>说明</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="19.2%"><p>context</p> </td> <td class="cellrowborder" width="30.8%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-context" target="_blank">Context</a></p> </td> <td class="cellrowborder" width="8.59%"><p>是</p> </td> <td class="cellrowborder" width="41.410000000000004%"><p>上下文<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext" target="_blank">common.UIAbilityContext</a>。</p> <div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content"><p>当前context仅支持传入UIAbilityContext。</p> </div></div></div> </td> </tr> <tr><td class="cellrowborder" width="19.2%"><p>uri</p> </td> <td class="cellrowborder" width="30.8%"><p>string</p> </td> <td class="cellrowborder" width="8.59%"><p>是</p> </td> <td class="cellrowborder" width="41.410000000000004%"><p>文件<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/user-file-uri-intro" target="_blank">uri</a></p> </td> </tr> <tr><td class="cellrowborder" width="19.2%"><p>callback</p> </td> <td class="cellrowborder" width="30.8%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-base#asynccallback" target="_blank">AsyncCallback</a>&lt;boolean&gt;</p> </td> <td class="cellrowborder" width="8.59%"><p>是</p> </td> <td class="cellrowborder" width="41.410000000000004%"><p>回调函数。当传入支持的文件uri时，会返回true；传入不可预览的文件uri时，返回false。</p> </td> </tr>  </tbody></table></div> </div> <p><strong>错误码：</strong>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal" target="_blank">通用错误码</a></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.16.11.1.3.1.1" width="49.96%"><p>错误码ID</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.16.11.1.3.1.2" width="50.03999999999999%"><p>错误信息</p> </th> </tr><tr><td class="cellrowborder" width="49.96%"><p>401</p> </td> <td class="cellrowborder" width="50.03999999999999%"><p>invalid input parameter.</p> </td> </tr>  </tbody></table></div> </div> <div class="p"><strong>示例：</strong><div _ngcontent-mgp-c106="" class="highlight-div"><div _ngcontent-mgp-c106="" class="highlight-div-header"><div _ngcontent-mgp-c106="" class="highlight-div-header-left"><div _ngcontent-mgp-c106="" class="handle-button expand-button"><div _ngcontent-mgp-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mgp-c106="" class="highlight-div-header-right"><div _ngcontent-mgp-c106="" class="handle-button ai-button"></div><div _ngcontent-mgp-c106="" class="handle-button line-button"><div _ngcontent-mgp-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mgp-c106="" class="handle-button theme-button"><div _ngcontent-mgp-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mgp-c106="" class="handle-button copy-button"><div _ngcontent-mgp-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mgp-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { filePreview } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PreviewKit'</span>;</li><li>
</li><li><span class="hljs-comment">// e.g 文件存在且类型符合时 </span></li><li><span class="hljs-keyword">let</span> uri = <span class="hljs-string">'file://docs/storage/Users/currentUser/Documents/1.txt'</span>;</li><li><span class="hljs-keyword">let</span> uiContext = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> <span class="hljs-title class_">Context</span>;</li><li>filePreview.<span class="hljs-title function_">canPreview</span>(uiContext, uri, <span class="hljs-function">(<span class="hljs-params">err, result</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (err &amp;&amp; err.<span class="hljs-property">code</span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Failed to obtain the result of whether it can be previewed, err.code = <span class="hljs-subst">${err.code}</span>, err.message = <span class="hljs-subst">${err.message}</span>`</span>);</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`Succeeded in obtaining the result of whether it can be previewed. result = <span class="hljs-subst">${result}</span>`</span>);     <span class="hljs-comment">// 此处返回true</span></li><li>});</li></ol></pre></div></div> </div> <div _ngcontent-mgp-c106="" class="highlight-div"><div _ngcontent-mgp-c106="" class="highlight-div-header"><div _ngcontent-mgp-c106="" class="highlight-div-header-left"><div _ngcontent-mgp-c106="" class="handle-button expand-button"><div _ngcontent-mgp-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mgp-c106="" class="highlight-div-header-right"><div _ngcontent-mgp-c106="" class="handle-button ai-button"></div><div _ngcontent-mgp-c106="" class="handle-button line-button"><div _ngcontent-mgp-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mgp-c106="" class="handle-button theme-button"><div _ngcontent-mgp-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mgp-c106="" class="handle-button copy-button"><div _ngcontent-mgp-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mgp-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { filePreview } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PreviewKit'</span>;</li><li>
</li><li><span class="hljs-comment">// e.g 文件不存在或文件类型不符合时 </span></li><li><span class="hljs-keyword">let</span> uri = <span class="hljs-string">'file://docs/storage/Users/currentUser/Documents/9.txt'</span>;</li><li><span class="hljs-keyword">let</span> uiContext = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> <span class="hljs-title class_">Context</span>;</li><li>filePreview.<span class="hljs-title function_">canPreview</span>(uiContext, uri, <span class="hljs-function">(<span class="hljs-params">err, result</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (err &amp;&amp; err.<span class="hljs-property">code</span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Failed to obtain the result of whether it can be previewed, err.code = <span class="hljs-subst">${err.code}</span>, err.message = <span class="hljs-subst">${err.message}</span>`</span>);</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`Succeeded in obtaining the result of whether it can be previewed. result = <span class="hljs-subst">${result}</span>`</span>);     <span class="hljs-comment">// 此处返回false</span></li><li>});</li></ol></pre></div></div> </div> <div class="tiledSection"><h2 id="section125501659101916" device-type="phone,2in1,tablet">hasDisplayed<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section125501659101916" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><p>hasDisplayed(context: Context): Promise&lt;boolean&gt;</p> <p>判断预览窗口是否已经存在。预览窗口是单例的形式，如果预览窗口已经打开过并且没关闭，那会返回true。如果没打开或者打开后已关闭，那将返回false。使用Promise方式异步返回结果。判断是否已打开预览需要等待窗口创建完成才能产生效果，窗口还没创建完成就调用hasDisplayed接口会导致结果返回false。</p> <p><strong>元服务API：</strong>从版本4.1.0(11)开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong> SystemCapability.FileManagement.FilePreview.Core</p> <p><strong>起始版本：</strong>4.1.0(11)</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.17.8.1.5.1.1" width="19.2%"><p>参数名</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.17.8.1.5.1.2" width="30.8%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.17.8.1.5.1.3" width="9.24%"><p>必填</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.17.8.1.5.1.4" width="40.760000000000005%"><p>说明</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="19.2%"><p>context</p> </td> <td class="cellrowborder" width="30.8%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-context" target="_blank">Context</a></p> </td> <td class="cellrowborder" width="9.24%"><p>是</p> </td> <td class="cellrowborder" width="40.760000000000005%"><p>上下文<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext" target="_blank">common.UIAbilityContext</a>。</p> <div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content"><p>当前context仅支持传入UIAbilityContext。</p> </div></div></div> </td> </tr>  </tbody></table></div> </div> <p><strong>返回值：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.17.10.1.3.1.1" width="50%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.17.10.1.3.1.2" width="50%"><p>说明</p> </th> </tr><tr><td class="cellrowborder" width="50%"><p>Promise&lt;boolean&gt;</p> </td> <td class="cellrowborder" width="50%"><p>Promise对象，预览窗口是单例的形式，当预览窗口已经打开过并且没关闭，那会返回true。如果没打开或者打开后已关闭，那将返回false。</p> </td> </tr>  </tbody></table></div> </div> <p><strong>错误码：</strong>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal" target="_blank">通用错误码</a></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.17.12.1.3.1.1" width="49.96%"><p>错误码ID</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.17.12.1.3.1.2" width="50.03999999999999%"><p>错误信息</p> </th> </tr><tr><td class="cellrowborder" width="49.96%"><p>401</p> </td> <td class="cellrowborder" width="50.03999999999999%"><p>invalid input parameter.</p> </td> </tr>  </tbody></table></div> </div> <p><strong>示例：</strong></p> <div _ngcontent-mgp-c106="" class="highlight-div"><div _ngcontent-mgp-c106="" class="highlight-div-header"><div _ngcontent-mgp-c106="" class="highlight-div-header-left"><div _ngcontent-mgp-c106="" class="handle-button expand-button"><div _ngcontent-mgp-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mgp-c106="" class="highlight-div-header-right"><div _ngcontent-mgp-c106="" class="handle-button ai-button"></div><div _ngcontent-mgp-c106="" class="handle-button line-button"><div _ngcontent-mgp-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mgp-c106="" class="handle-button theme-button"><div _ngcontent-mgp-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mgp-c106="" class="handle-button copy-button"><div _ngcontent-mgp-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mgp-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { filePreview } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PreviewKit'</span>;</li><li>
</li><li><span class="hljs-comment">// e.g 预览窗口已存在 </span></li><li><span class="hljs-keyword">let</span> uiContext = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> <span class="hljs-title class_">Context</span>;</li><li>filePreview.<span class="hljs-title function_">hasDisplayed</span>(uiContext).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">result</span>) =&gt;</span> {    <span class="hljs-comment">// 此处返回true</span></li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`Succeeded in obtaining the result of whether the preview has displayed. result = <span class="hljs-subst">${result}</span>`</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Failed to obtain the result of whether the preview has displayed, err.code = <span class="hljs-subst">${err.code}</span>, err.message = <span class="hljs-subst">${err.message}</span>`</span>);</li><li>});</li></ol></pre></div></div> <div _ngcontent-mgp-c106="" class="highlight-div"><div _ngcontent-mgp-c106="" class="highlight-div-header"><div _ngcontent-mgp-c106="" class="highlight-div-header-left"><div _ngcontent-mgp-c106="" class="handle-button expand-button"><div _ngcontent-mgp-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mgp-c106="" class="highlight-div-header-right"><div _ngcontent-mgp-c106="" class="handle-button ai-button"></div><div _ngcontent-mgp-c106="" class="handle-button line-button"><div _ngcontent-mgp-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mgp-c106="" class="handle-button theme-button"><div _ngcontent-mgp-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mgp-c106="" class="handle-button copy-button"><div _ngcontent-mgp-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mgp-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { filePreview } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PreviewKit'</span>;</li><li>
</li><li> <span class="hljs-comment">// e.g 预览窗口不存在</span></li><li><span class="hljs-keyword">let</span> uiContext = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> <span class="hljs-title class_">Context</span>;</li><li>filePreview.<span class="hljs-title function_">hasDisplayed</span>(uiContext).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">result</span>) =&gt;</span> {    <span class="hljs-comment">// 此处返回false</span></li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`Succeeded in obtaining the result of whether the preview has displayed. result = <span class="hljs-subst">${result}</span>`</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Failed to obtain the result of whether the preview has displayed, err.code = <span class="hljs-subst">${err.code}</span>, err.message = <span class="hljs-subst">${err.message}</span>`</span>);</li><li>});</li></ol></pre></div></div> </div> <div class="tiledSection"><h2 id="section18328125413515" device-type="phone,2in1,tablet">hasDisplayed<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section18328125413515" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><p>hasDisplayed(context: Context, callback: AsyncCallback&lt;boolean&gt;): void</p> <p>判断预览窗口是否已经存在。预览窗口是单例的形式，如果预览窗口已经打开过并且没关闭，那会返回true。如果没打开或者打开后已关闭，那将返回false。使用Callback回调异步返回结果。判断是否已打开预览需要等待窗口创建完成才能产生效果，窗口还没创建完成就调用hasDisplayed接口会导致结果返回false。</p> <p><strong>元服务API：</strong>从版本4.1.0(11)开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong> SystemCapability.FileManagement.FilePreview.Core</p> <p><strong>起始版本：</strong>4.1.0(11)</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.18.8.1.5.1.1" width="19.2%"><p>参数名</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.18.8.1.5.1.2" width="30.8%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.18.8.1.5.1.3" width="8.23%"><p>必填</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.18.8.1.5.1.4" width="41.77%"><p>说明</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="19.2%"><p>context</p> </td> <td class="cellrowborder" width="30.8%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-context" target="_blank">Context</a></p> </td> <td class="cellrowborder" width="8.23%"><p>是</p> </td> <td class="cellrowborder" width="41.77%"><p>上下文<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext" target="_blank">common.UIAbilityContext</a>。</p> <div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content"><p>当前context仅支持传入UIAbilityContext。</p> </div></div></div> </td> </tr> <tr><td class="cellrowborder" width="19.2%"><p>callback</p> </td> <td class="cellrowborder" width="30.8%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-base#asynccallback" target="_blank">AsyncCallback</a>&lt;boolean&gt;</p> </td> <td class="cellrowborder" width="8.23%"><p>是</p> </td> <td class="cellrowborder" width="41.77%"><p>回调函数。预览窗口是单例的形式，当预览窗口已经打开过并且没关闭，那会返回true。如果没打开或者打开后已关闭，那将返回false。</p> </td> </tr>  </tbody></table></div> </div> <p><strong>错误码：</strong>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal" target="_blank">通用错误码</a></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.18.10.1.3.1.1" width="49.96%"><p>错误码ID</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.18.10.1.3.1.2" width="50.03999999999999%"><p>错误信息</p> </th> </tr><tr><td class="cellrowborder" width="49.96%"><p>401</p> </td> <td class="cellrowborder" width="50.03999999999999%"><p>invalid input parameter.</p> </td> </tr>  </tbody></table></div> </div> <p><strong>示例：</strong></p> <div _ngcontent-mgp-c106="" class="highlight-div"><div _ngcontent-mgp-c106="" class="highlight-div-header"><div _ngcontent-mgp-c106="" class="highlight-div-header-left"><div _ngcontent-mgp-c106="" class="handle-button expand-button"><div _ngcontent-mgp-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mgp-c106="" class="highlight-div-header-right"><div _ngcontent-mgp-c106="" class="handle-button ai-button"></div><div _ngcontent-mgp-c106="" class="handle-button line-button"><div _ngcontent-mgp-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mgp-c106="" class="handle-button theme-button"><div _ngcontent-mgp-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mgp-c106="" class="handle-button copy-button"><div _ngcontent-mgp-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mgp-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { filePreview } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PreviewKit'</span>;</li><li>
</li><li><span class="hljs-comment">// e.g 预览窗口已存在 </span></li><li><span class="hljs-keyword">let</span> uiContext = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> <span class="hljs-title class_">Context</span>;</li><li>filePreview.<span class="hljs-title function_">hasDisplayed</span>(uiContext, <span class="hljs-function">(<span class="hljs-params">err, result</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (err &amp;&amp; err.<span class="hljs-property">code</span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Failed to obtain the result of whether the preview has displayed, err.code = <span class="hljs-subst">${err.code}</span>, err.message = <span class="hljs-subst">${err.message}</span>`</span>);</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`Succeeded in obtaining the result of whether the preview has displayed. result = <span class="hljs-subst">${result}</span>`</span>);     <span class="hljs-comment">// 此处返回true</span></li><li>});</li></ol></pre></div></div> <div _ngcontent-mgp-c106="" class="highlight-div"><div _ngcontent-mgp-c106="" class="highlight-div-header"><div _ngcontent-mgp-c106="" class="highlight-div-header-left"><div _ngcontent-mgp-c106="" class="handle-button expand-button"><div _ngcontent-mgp-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mgp-c106="" class="highlight-div-header-right"><div _ngcontent-mgp-c106="" class="handle-button ai-button"></div><div _ngcontent-mgp-c106="" class="handle-button line-button"><div _ngcontent-mgp-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mgp-c106="" class="handle-button theme-button"><div _ngcontent-mgp-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mgp-c106="" class="handle-button copy-button"><div _ngcontent-mgp-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mgp-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { filePreview } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PreviewKit'</span>;</li><li>
</li><li><span class="hljs-comment">// e.g 预览窗口不存在 </span></li><li><span class="hljs-keyword">let</span> uiContext = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> <span class="hljs-title class_">Context</span>;</li><li>filePreview.<span class="hljs-title function_">hasDisplayed</span>(uiContext, <span class="hljs-function">(<span class="hljs-params">err, result</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (err &amp;&amp; err.<span class="hljs-property">code</span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Failed to obtain the result of whether the preview has displayed, err.code = <span class="hljs-subst">${err.code}</span>, err.message = <span class="hljs-subst">${err.message}</span>`</span>);</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`Succeeded in obtaining the result of whether the preview has displayed. result = <span class="hljs-subst">${result}</span>`</span>);     <span class="hljs-comment">// 此处返回false</span></li><li>});</li></ol></pre></div></div> </div> <div class="tiledSection"><h2 id="section1555691716202" device-type="phone,2in1,tablet">closePreview<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section1555691716202" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><p>closePreview(context: Context): Promise&lt;void&gt;</p> <p>关闭预览窗口，仅当预览窗口存在时起效。使用Promise方式异步返回结果。关闭预览窗口需要等待窗口创建完成才能产生效果，窗口还没创建完成就调用closePreview接口会无效。</p> <p><strong>元服务API：</strong>从版本4.1.0(11)开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong> SystemCapability.FileManagement.FilePreview.Core</p> <p><strong>起始版本：</strong>4.1.0(11)</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.19.8.1.5.1.1" width="19.2%"><p>参数名</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.19.8.1.5.1.2" width="30.8%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.19.8.1.5.1.3" width="9.24%"><p>必填</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.19.8.1.5.1.4" width="40.760000000000005%"><p>说明</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="19.2%"><p>context</p> </td> <td class="cellrowborder" width="30.8%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-context" target="_blank">Context</a></p> </td> <td class="cellrowborder" width="9.24%"><p>是</p> </td> <td class="cellrowborder" width="40.760000000000005%"><p>上下文<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext" target="_blank">common.UIAbilityContext</a>。</p> <div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content"><p>当前context仅支持传入UIAbilityContext。</p> </div></div></div> </td> </tr>  </tbody></table></div> </div> <p><strong>返回值：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.19.10.1.3.1.1" width="50%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.19.10.1.3.1.2" width="50%"><p>说明</p> </th> </tr><tr><td class="cellrowborder" width="50%"><p>Promise&lt;void&gt;</p> </td> <td class="cellrowborder" width="50%"><p>无返回结果的Promise对象。</p> </td> </tr>  </tbody></table></div> </div> <p><strong>错误码：</strong>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal" target="_blank">通用错误码</a></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.19.12.1.3.1.1" width="49.96%"><p>错误码ID</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.19.12.1.3.1.2" width="50.03999999999999%"><p>错误信息</p> </th> </tr><tr><td class="cellrowborder" width="49.96%"><p>401</p> </td> <td class="cellrowborder" width="50.03999999999999%"><p>invalid input parameter.</p> </td> </tr>  </tbody></table></div> </div> <div class="p"><strong>示例：</strong><div _ngcontent-mgp-c106="" class="highlight-div"><div _ngcontent-mgp-c106="" class="highlight-div-header"><div _ngcontent-mgp-c106="" class="highlight-div-header-left"><div _ngcontent-mgp-c106="" class="handle-button expand-button"><div _ngcontent-mgp-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mgp-c106="" class="highlight-div-header-right"><div _ngcontent-mgp-c106="" class="handle-button ai-button"></div><div _ngcontent-mgp-c106="" class="handle-button line-button"><div _ngcontent-mgp-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mgp-c106="" class="handle-button theme-button"><div _ngcontent-mgp-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mgp-c106="" class="handle-button copy-button"><div _ngcontent-mgp-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mgp-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { filePreview } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PreviewKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> uiContext = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> <span class="hljs-title class_">Context</span>;</li><li>filePreview.<span class="hljs-title function_">closePreview</span>(uiContext).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {   <span class="hljs-comment">// 仅当预览窗口存在时起效</span></li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Succeeded in closing preview'</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Failed to close preview, err.code = <span class="hljs-subst">${err.code}</span>, err.message = <span class="hljs-subst">${err.message}</span>`</span>);</li><li>});</li></ol></pre></div></div> </div> </div> <div class="tiledSection"><h2 id="section1218513547316" device-type="phone,2in1,tablet">closePreview<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section1218513547316" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><p>closePreview(context: Context, callback: AsyncCallback&lt;void&gt;): void</p> <p>关闭预览窗口，仅当预览窗口存在时起效。使用Callback回调异步返回结果。关闭预览窗口需要等待窗口创建完成才能产生效果，窗口还没创建完成就调用closePreview接口会无效。</p> <p><strong>元服务API：</strong>从版本4.1.0(11)开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong> SystemCapability.FileManagement.FilePreview.Core</p> <p><strong>起始版本：</strong>4.1.0(11)</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.20.8.1.5.1.1" width="19.2%"><p>参数名</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.20.8.1.5.1.2" width="30.8%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.20.8.1.5.1.3" width="9.24%"><p>必填</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.20.8.1.5.1.4" width="40.760000000000005%"><p>说明</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="19.2%"><p>context</p> </td> <td class="cellrowborder" width="30.8%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-context" target="_blank">Context</a></p> </td> <td class="cellrowborder" width="9.24%"><p>是</p> </td> <td class="cellrowborder" width="40.760000000000005%"><p>上下文<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext" target="_blank">common.UIAbilityContext</a>。</p> <div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content"><p>当前context仅支持传入UIAbilityContext。</p> </div></div></div> </td> </tr> <tr><td class="cellrowborder" width="19.2%"><p>callback</p> </td> <td class="cellrowborder" width="30.8%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-base#asynccallback" target="_blank">AsyncCallback</a>&lt;void&gt;</p> </td> <td class="cellrowborder" width="9.24%"><p>是</p> </td> <td class="cellrowborder" width="40.760000000000005%"><p>回调函数。当预览窗口成功关闭时，err为undefined或err.code为0，否则为错误对象。</p> </td> </tr>  </tbody></table></div> </div> <p><strong>错误码：</strong>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal" target="_blank">通用错误码</a></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.20.10.1.3.1.1" width="49.96%"><p>错误码ID</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.20.10.1.3.1.2" width="50.03999999999999%"><p>错误信息</p> </th> </tr><tr><td class="cellrowborder" width="49.96%"><p>401</p> </td> <td class="cellrowborder" width="50.03999999999999%"><p>invalid input parameter.</p> </td> </tr>  </tbody></table></div> </div> <div class="p"><strong>示例：</strong><div _ngcontent-mgp-c106="" class="highlight-div"><div _ngcontent-mgp-c106="" class="highlight-div-header"><div _ngcontent-mgp-c106="" class="highlight-div-header-left"><div _ngcontent-mgp-c106="" class="handle-button expand-button"><div _ngcontent-mgp-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mgp-c106="" class="highlight-div-header-right"><div _ngcontent-mgp-c106="" class="handle-button ai-button"></div><div _ngcontent-mgp-c106="" class="handle-button line-button"><div _ngcontent-mgp-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mgp-c106="" class="handle-button theme-button"><div _ngcontent-mgp-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mgp-c106="" class="handle-button copy-button"><div _ngcontent-mgp-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mgp-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { filePreview } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PreviewKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> uiContext = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> <span class="hljs-title class_">Context</span>;</li><li>filePreview.<span class="hljs-title function_">closePreview</span>(uiContext, <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> {  <span class="hljs-comment">// 仅当预览窗口存在时起效</span></li><li>  <span class="hljs-keyword">if</span> (err &amp;&amp; err.<span class="hljs-property">code</span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Failed to close preview, err.code = <span class="hljs-subst">${err.code}</span>, err.message = <span class="hljs-subst">${err.message}</span>`</span>);</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Succeeded in closing preview'</span>);</li><li>});</li></ol></pre></div></div> </div> </div> <div class="tiledSection"><h2 id="section1045913401474" device-type="phone,2in1,tablet">loadData<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section1045913401474" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><p>loadData(context: Context, file: PreviewInfo): Promise&lt;void&gt;</p> <p>加载预览文件信息。仅当预览窗口存在时起效。传入可预览文件时展示对应预览界面，传入不可预览文件显示不支持预览界面。100毫秒内重复调用无效。使用Promise方式异步返回结果。加载预览文件需要等待窗口创建完成才能产生效果，窗口还没创建完成就调用loadData接口会无效。</p> <p><strong>元服务API：</strong>从版本4.1.0(11)开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong> SystemCapability.FileManagement.FilePreview.Core</p> <p><strong>起始版本：</strong>4.1.0(11)</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.21.8.1.5.1.1" width="19.2%"><p>参数名</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.21.8.1.5.1.2" width="30.8%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.21.8.1.5.1.3" width="9.24%"><p>必填</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.21.8.1.5.1.4" width="40.760000000000005%"><p>说明</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="19.2%"><p>context</p> </td> <td class="cellrowborder" width="30.8%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-context" target="_blank">Context</a></p> </td> <td class="cellrowborder" width="9.24%"><p>是</p> </td> <td class="cellrowborder" width="40.760000000000005%"><p>上下文<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext" target="_blank">common.UIAbilityContext</a>。</p> <div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content"><p>当前context仅支持传入UIAbilityContext。</p> </div></div></div> </td> </tr> <tr><td class="cellrowborder" width="19.2%"><p>file</p> </td> <td class="cellrowborder" width="30.8%"><p><a href="/consumer/cn/doc/harmonyos-references/preview-arkts#section1081123302517">PreviewInfo</a></p> </td> <td class="cellrowborder" width="9.24%"><p>是</p> </td> <td class="cellrowborder" width="40.760000000000005%"><p>文件的预览信息，title为可选，不填会通过uri解析，无法解析则显示未知文件。</p> </td> </tr>  </tbody></table></div> </div> <p><strong>返回值：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.21.10.1.3.1.1" width="50%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.21.10.1.3.1.2" width="50%"><p>说明</p> </th> </tr><tr><td class="cellrowborder" width="50%"><p>Promise&lt;void&gt;</p> </td> <td class="cellrowborder" width="50%"><p>无返回结果的Promise对象。</p> </td> </tr>  </tbody></table></div> </div> <p><strong>错误码：</strong>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal" target="_blank">通用错误码</a></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.21.12.1.3.1.1" width="49.96%"><p>错误码ID</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.21.12.1.3.1.2" width="50.03999999999999%"><p>错误信息</p> </th> </tr><tr><td class="cellrowborder" width="49.96%"><p>401</p> </td> <td class="cellrowborder" width="50.03999999999999%"><p>invalid input parameter.</p> </td> </tr>  </tbody></table></div> </div> <p></p> <p><strong>示例：</strong></p> <div _ngcontent-mgp-c106="" class="highlight-div"><div _ngcontent-mgp-c106="" class="highlight-div-header"><div _ngcontent-mgp-c106="" class="highlight-div-header-left"><div _ngcontent-mgp-c106="" class="handle-button expand-button"><div _ngcontent-mgp-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mgp-c106="" class="highlight-div-header-right"><div _ngcontent-mgp-c106="" class="handle-button ai-button"></div><div _ngcontent-mgp-c106="" class="handle-button line-button"><div _ngcontent-mgp-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mgp-c106="" class="handle-button theme-button"><div _ngcontent-mgp-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mgp-c106="" class="handle-button copy-button"><div _ngcontent-mgp-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mgp-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { filePreview } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PreviewKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> uiContext = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> <span class="hljs-title class_">Context</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">fileInfo</span>: filePreview.<span class="hljs-property">PreviewInfo</span> = {</li><li>  <span class="hljs-attr">title</span>: <span class="hljs-string">'1.txt'</span>,</li><li>  <span class="hljs-attr">uri</span>: <span class="hljs-string">'file://docs/storage/Users/currentUser/Documents/1.txt'</span>,</li><li>  <span class="hljs-attr">mimeType</span>: <span class="hljs-string">'text/plain'</span></li><li>};</li><li>filePreview.<span class="hljs-title function_">loadData</span>(uiContext, fileInfo).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {   <span class="hljs-comment">// 仅当预览窗口存在时起效</span></li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Succeeded in loading data.'</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Failed to load data, err.code = <span class="hljs-subst">${err.code}</span>, err.message = <span class="hljs-subst">${err.message}</span>`</span>);</li><li>});</li></ol></pre></div></div> </div> <div class="tiledSection"><h2 id="section199642286203" device-type="phone,2in1,tablet">loadData<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section199642286203" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><p>loadData(context: Context, file: PreviewInfo, callback: AsyncCallback&lt;void&gt;): void</p> <p>加载预览文件信息。仅当预览窗口存在时起效。传入可预览文件时展示对应预览界面，传入不可预览文件显示不支持预览界面。100毫秒内重复调用无效。使用Callback回调异步返回结果。加载预览文件需要等待窗口创建完成才能产生效果，窗口还没创建完成就调用loadData接口会无效。</p> <p><strong>元服务API：</strong>从版本4.1.0(11)开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong> SystemCapability.FileManagement.FilePreview.Core</p> <p><strong>起始版本：</strong>4.1.0(11)</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.22.8.1.5.1.1" width="19.2%"><p>参数名</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.22.8.1.5.1.2" width="30.8%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.22.8.1.5.1.3" width="9.24%"><p>必填</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.22.8.1.5.1.4" width="40.760000000000005%"><p>说明</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="19.2%"><p>context</p> </td> <td class="cellrowborder" width="30.8%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-context" target="_blank">Context</a></p> </td> <td class="cellrowborder" width="9.24%"><p>是</p> </td> <td class="cellrowborder" width="40.760000000000005%"><p>上下文<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext" target="_blank">common.UIAbilityContext</a>。</p> <div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content"><p>当前context仅支持传入UIAbilityContext。</p> </div></div></div> </td> </tr> <tr><td class="cellrowborder" width="19.2%"><p>file</p> </td> <td class="cellrowborder" width="30.8%"><p><a href="/consumer/cn/doc/harmonyos-references/preview-arkts#section1081123302517">PreviewInfo</a></p> </td> <td class="cellrowborder" width="9.24%"><p>是</p> </td> <td class="cellrowborder" width="40.760000000000005%"><p>文件的预览信息，title为可选，不填会通过uri解析，无法解析则显示未知文件。</p> </td> </tr> <tr><td class="cellrowborder" width="19.2%"><p>callback</p> </td> <td class="cellrowborder" width="30.8%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-base#asynccallback" target="_blank">AsyncCallback</a>&lt;void&gt;</p> </td> <td class="cellrowborder" width="9.24%"><p>是</p> </td> <td class="cellrowborder" width="40.760000000000005%"><p>回调函数。当预览文件加载成功时，err为undefined或err.code为0，否则为错误对象。</p> </td> </tr>  </tbody></table></div> </div> <p><strong>错误码：</strong>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal" target="_blank">通用错误码</a></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.22.10.1.3.1.1" width="49.96%"><p>错误码ID</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.22.10.1.3.1.2" width="50.03999999999999%"><p>错误信息</p> </th> </tr><tr><td class="cellrowborder" width="49.96%"><p>401</p> </td> <td class="cellrowborder" width="50.03999999999999%"><p>invalid input parameter.</p> </td> </tr>  </tbody></table></div> </div> <div class="p"><strong>示例：</strong><div _ngcontent-mgp-c106="" class="highlight-div"><div _ngcontent-mgp-c106="" class="highlight-div-header"><div _ngcontent-mgp-c106="" class="highlight-div-header-left"><div _ngcontent-mgp-c106="" class="handle-button expand-button"><div _ngcontent-mgp-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mgp-c106="" class="highlight-div-header-right"><div _ngcontent-mgp-c106="" class="handle-button ai-button"></div><div _ngcontent-mgp-c106="" class="handle-button line-button"><div _ngcontent-mgp-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mgp-c106="" class="handle-button theme-button"><div _ngcontent-mgp-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mgp-c106="" class="handle-button copy-button"><div _ngcontent-mgp-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mgp-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { filePreview } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PreviewKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> uiContext = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> <span class="hljs-title class_">Context</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">fileInfo</span>: filePreview.<span class="hljs-property">PreviewInfo</span> = {</li><li>  <span class="hljs-attr">title</span>: <span class="hljs-string">'1.txt'</span>,</li><li>  <span class="hljs-attr">uri</span>: <span class="hljs-string">'file://docs/storage/Users/currentUser/Documents/1.txt'</span>,</li><li>  <span class="hljs-attr">mimeType</span>: <span class="hljs-string">'text/plain'</span></li><li>};</li><li>filePreview.<span class="hljs-title function_">loadData</span>(uiContext, fileInfo, <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> {   <span class="hljs-comment">// 仅当预览窗口存在时起效</span></li><li>  <span class="hljs-keyword">if</span> (err &amp;&amp; err.<span class="hljs-property">code</span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Failed to load data, err.code = <span class="hljs-subst">${err.code}</span>, err.message = <span class="hljs-subst">${err.message}</span>`</span>);</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Succeeded in loading data.'</span>);</li><li>});</li></ol></pre></div></div> </div> <p></p> </div> <div class="tiledSection"><h2 id="section8257182225" device-type="phone,2in1,tablet">loadData<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section8257182225" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><p>loadData(context: Context, files: Array&lt;PreviewInfo&gt;, index?: number): Promise&lt;void&gt;</p> <p>加载预览文件信息。仅当预览窗口存在时起效。可传入多个文件预览信息以及对应展示的列表下标进行选择预览。使用Promise方式异步返回结果。</p> <p>加载预览文件需要等待窗口创建完成才能产生效果，窗口还没创建完成就调用loadData接口会无效。该接口在2in1端无效。100毫秒内重复调用无效。</p> <p><strong>元服务API：</strong>从版本5.0.0(12)开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong> SystemCapability.FileManagement.FilePreview.Core</p> <p><strong>起始版本：</strong>5.0.0(12)</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.23.9.1.5.1.1" width="19.2%"><p>参数名</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.23.9.1.5.1.2" width="30.8%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.23.9.1.5.1.3" width="9.24%"><p>必填</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.23.9.1.5.1.4" width="40.760000000000005%"><p>说明</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="19.2%"><p>context</p> </td> <td class="cellrowborder" width="30.8%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-context" target="_blank">Context</a></p> </td> <td class="cellrowborder" width="9.24%"><p>是</p> </td> <td class="cellrowborder" width="40.760000000000005%"><p>上下文<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext" target="_blank">common.UIAbilityContext</a>。</p> <div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content"><p>当前context仅支持传入UIAbilityContext。</p> </div></div></div> </td> </tr> <tr><td class="cellrowborder" width="19.2%"><p>files</p> </td> <td class="cellrowborder" width="30.8%"><p>Array&lt;<a href="/consumer/cn/doc/harmonyos-references/preview-arkts#section1081123302517">PreviewInfo</a>&gt;</p> </td> <td class="cellrowborder" width="9.24%"><p>是</p> </td> <td class="cellrowborder" width="40.760000000000005%"><p>文件预览信息列表。</p> </td> </tr> <tr><td class="cellrowborder" width="19.2%"><p>index</p> </td> <td class="cellrowborder" width="30.8%"><p>number</p> </td> <td class="cellrowborder" width="9.24%"><p>否</p> </td> <td class="cellrowborder" width="40.760000000000005%"><p>预览窗口打开时展示的文件预览信息下标，不填默认为0。取值范围大于等于0，小于files长度。</p> </td> </tr>  </tbody></table></div> </div> <p><strong>返回值：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.23.11.1.3.1.1" width="50%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.23.11.1.3.1.2" width="50%"><p>说明</p> </th> </tr><tr><td class="cellrowborder" width="50%"><p>Promise&lt;void&gt;</p> </td> <td class="cellrowborder" width="50%"><p>无返回结果的Promise对象。</p> </td> </tr>  </tbody></table></div> </div> <p><strong>错误码：</strong>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal" target="_blank">通用错误码</a></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.23.13.1.3.1.1" width="49.96%"><p>错误码ID</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.23.13.1.3.1.2" width="50.03999999999999%"><p>错误信息</p> </th> </tr><tr><td class="cellrowborder" width="49.96%"><p>401</p> </td> <td class="cellrowborder" width="50.03999999999999%"><p>invalid input parameter.</p> </td> </tr> <tr><td class="cellrowborder" width="49.96%"><p>801</p> </td> <td class="cellrowborder" width="50.03999999999999%"><p>Capability not supported.</p> </td> </tr>  </tbody></table></div> </div> <p><strong>示例：</strong></p> <div _ngcontent-mgp-c106="" class="highlight-div"><div _ngcontent-mgp-c106="" class="highlight-div-header"><div _ngcontent-mgp-c106="" class="highlight-div-header-left"><div _ngcontent-mgp-c106="" class="handle-button expand-button"><div _ngcontent-mgp-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mgp-c106="" class="highlight-div-header-right"><div _ngcontent-mgp-c106="" class="handle-button ai-button"></div><div _ngcontent-mgp-c106="" class="handle-button line-button"><div _ngcontent-mgp-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mgp-c106="" class="handle-button theme-button"><div _ngcontent-mgp-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mgp-c106="" class="handle-button copy-button"><div _ngcontent-mgp-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mgp-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { filePreview } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PreviewKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> uiContext = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> <span class="hljs-title class_">Context</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">fileInfo</span>: filePreview.<span class="hljs-property">PreviewInfo</span> = {</li><li>  <span class="hljs-attr">title</span>: <span class="hljs-string">'1.txt'</span>,</li><li>  <span class="hljs-attr">uri</span>: <span class="hljs-string">'file://docs/storage/Users/currentUser/Documents/1.txt'</span>,</li><li>  <span class="hljs-attr">mimeType</span>: <span class="hljs-string">'text/plain'</span></li><li>};</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">files</span>: <span class="hljs-title class_">Array</span>&lt;filePreview.<span class="hljs-property">PreviewInfo</span>&gt; = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>();</li><li>files.<span class="hljs-title function_">push</span>(fileInfo);</li><li>filePreview.<span class="hljs-title function_">loadData</span>(uiContext, files, <span class="hljs-number">0</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {   <span class="hljs-comment">// 仅当预览窗口存在时起效</span></li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Succeeded in loading data.'</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Failed to load data, err.code = <span class="hljs-subst">${err.code}</span>, err.message = <span class="hljs-subst">${err.message}</span>`</span>);</li><li>});</li></ol></pre></div></div> <p></p> </div> </div> <div></div></div>