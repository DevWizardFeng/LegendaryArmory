<h1 _ngcontent-had-c119="" class="doc-title ng-star-inserted" title="native_image.h"> native_image.h </h1>

<div _ngcontent-had-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div> <div class="tiledSection"><h2 id="概述" device-type="phone,2in1,tablet,wearable,tv">概述<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="概述" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>定义获取和使用NativeImage的相关函数。</p> <p><strong>引用文件：</strong> &lt;native_image/native_image.h&gt;</p> <p><strong>库：</strong> libnative_image.so</p> <p><strong>起始版本：</strong> 9</p> <p><strong>相关模块：</strong> <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-oh-nativeimage">OH_NativeImage</a></p> </div>  <div class="tiledSection"><h2 id="汇总" device-type="phone,2in1,tablet,wearable,tv">汇总<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="汇总" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div></div>  <div class="tiledSection"><h3 id="结构体" device-type="phone,2in1,tablet,wearable,tv" class="firsth2">结构体<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="结构体" tips="复制节点链接"></i></h3> <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.3.2.1.4.1.1" width="33.33333333333333%">名称</th> <th align="left" class="cellrowborder" id="mcps1.3.3.2.1.4.1.2" width="33.33333333333333%">typedef关键字</th> <th align="left" class="cellrowborder" id="mcps1.3.3.2.1.4.1.3" width="33.33333333333333%">描述</th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="33.33333333333333%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-oh-nativeimage-oh-onframeavailablelistener">OH_OnFrameAvailableListener</a></td> <td class="cellrowborder" width="33.33333333333333%">OH_OnFrameAvailableListener</td> <td class="cellrowborder" width="33.33333333333333%">一个OH_NativeImage的监听者，通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-native-image-h#oh_nativeimage_setonframeavailablelistener">OH_NativeImage_SetOnFrameAvailableListener</a>接口注册该监听结构体，当有buffer可获取时，将触发回调给用户。</td> </tr> <tr><td class="cellrowborder" width="33.33333333333333%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-oh-nativeimage-oh-nativeimage">OH_NativeImage</a></td> <td class="cellrowborder" width="33.33333333333333%">OH_NativeImage</td> <td class="cellrowborder" width="33.33333333333333%">提供OH_NativeImage结构体声明。</td> </tr> <tr><td class="cellrowborder" width="33.33333333333333%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-nativewindow-nativewindow">NativeWindow</a></td> <td class="cellrowborder" width="33.33333333333333%">OHNativeWindow</td> <td class="cellrowborder" width="33.33333333333333%">提供对NativeWindow的访问功能。</td> </tr> <tr><td class="cellrowborder" width="33.33333333333333%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-nativewindow-nativewindowbuffer">NativeWindowBuffer</a></td> <td class="cellrowborder" width="33.33333333333333%">OHNativeWindowBuffer</td> <td class="cellrowborder" width="33.33333333333333%">提供NativeWindowBuffer结构体声明。</td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h3 id="函数" device-type="phone,2in1,tablet,wearable,tv">函数<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="函数" tips="复制节点链接"></i></h3> <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.4.2.1.4.1.1" width="33.33333333333333%">名称</th> <th align="left" class="cellrowborder" id="mcps1.3.4.2.1.4.1.2" width="33.33333333333333%">typedef关键字</th> <th align="left" class="cellrowborder" id="mcps1.3.4.2.1.4.1.3" width="33.33333333333333%">描述</th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="33.33333333333333%"><a href="/consumer/cn/doc/harmonyos-references/capi-native-image-h#oh_onframeavailable">typedef void (*OH_OnFrameAvailable)(void *context)</a></td> <td class="cellrowborder" width="33.33333333333333%">OH_OnFrameAvailable</td> <td class="cellrowborder" width="33.33333333333333%">有buffer可获取时触发的回调函数。</td> </tr> <tr><td class="cellrowborder" width="33.33333333333333%"><a href="/consumer/cn/doc/harmonyos-references/capi-native-image-h#oh_nativeimage_create">OH_NativeImage* OH_NativeImage_Create(uint32_t textureId, uint32_t textureTarget)</a></td> <td class="cellrowborder" width="33.33333333333333%">-</td> <td class="cellrowborder" width="33.33333333333333%"><p>创建一个OH_NativeImage实例，该实例与OpenGL ES的纹理ID和纹理目标相关联。</p> <p>本接口需要与<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-native-image-h#oh_nativeimage_destroy">OH_NativeImage_Destroy</a>接口配合使用，否则会存在内存泄露。</p> <p>本接口为非线程安全类型接口。</p> </td> </tr> <tr><td class="cellrowborder" width="33.33333333333333%"><a href="/consumer/cn/doc/harmonyos-references/capi-native-image-h#oh_nativeimage_acquirenativewindow">OHNativeWindow* OH_NativeImage_AcquireNativeWindow(OH_NativeImage* image)</a></td> <td class="cellrowborder" width="33.33333333333333%">-</td> <td class="cellrowborder" width="33.33333333333333%"><p>获取与OH_NativeImage相关联的OHNativeWindow指针。</p> <p>本接口为非线程安全类型接口。</p> <p>OH_NativeImage析构时会将对应的OHNativeWindow实例释放。若从本接口获取OHNativeWindow指针，当OH_NativeImage实例释放时，请将获取到的OHNativeWindow指针置空，防止后续产生野指针。</p> </td> </tr> <tr><td class="cellrowborder" width="33.33333333333333%"><a href="/consumer/cn/doc/harmonyos-references/capi-native-image-h#oh_nativeimage_attachcontext">int32_t OH_NativeImage_AttachContext(OH_NativeImage* image, uint32_t textureId)</a></td> <td class="cellrowborder" width="33.33333333333333%">-</td> <td class="cellrowborder" width="33.33333333333333%"><p>将OH_NativeImage实例附加到当前OpenGL ES上下文，且该OpenGL ES纹理会绑定到GL_TEXTURE_EXTERNAL_OES, 并通过OH_NativeImage进行更新。</p> <p>本接口为非线程安全类型接口。</p> </td> </tr> <tr><td class="cellrowborder" width="33.33333333333333%"><a href="/consumer/cn/doc/harmonyos-references/capi-native-image-h#oh_nativeimage_detachcontext">int32_t OH_NativeImage_DetachContext(OH_NativeImage* image)</a></td> <td class="cellrowborder" width="33.33333333333333%">-</td> <td class="cellrowborder" width="33.33333333333333%"><p>将OH_NativeImage实例从当前OpenGL ES上下文分离。</p> <p>本接口为非线程安全类型接口。</p> </td> </tr> <tr><td class="cellrowborder" width="33.33333333333333%"><a href="/consumer/cn/doc/harmonyos-references/capi-native-image-h#oh_nativeimage_updatesurfaceimage">int32_t OH_NativeImage_UpdateSurfaceImage(OH_NativeImage* image)</a></td> <td class="cellrowborder" width="33.33333333333333%">-</td> <td class="cellrowborder" width="33.33333333333333%"><p>通过OH_NativeImage获取最新帧更新相关联的OpenGL ES纹理。</p> <p>本接口需要在Opengl ES环境上下文的线程中调用。</p> <p>本接口需要在接收到<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-oh-nativeimage-oh-onframeavailablelistener">OH_OnFrameAvailableListener</a>回调后调用。</p> <p>本接口为非线程安全类型接口。</p> </td> </tr> <tr><td class="cellrowborder" width="33.33333333333333%"><a href="/consumer/cn/doc/harmonyos-references/capi-native-image-h#oh_nativeimage_gettimestamp">int64_t OH_NativeImage_GetTimestamp(OH_NativeImage* image)</a></td> <td class="cellrowborder" width="33.33333333333333%">-</td> <td class="cellrowborder" width="33.33333333333333%"><p>获取最近调用OH_NativeImage_UpdateSurfaceImage的纹理图像的相关时间戳。</p> <p>本接口为非线程安全类型接口。</p> </td> </tr> <tr><td class="cellrowborder" width="33.33333333333333%"><a href="/consumer/cn/doc/harmonyos-references/capi-native-image-h#oh_nativeimage_gettransformmatrix">int32_t OH_NativeImage_GetTransformMatrix(OH_NativeImage* image, float matrix[16])</a></td> <td class="cellrowborder" width="33.33333333333333%">-</td> <td class="cellrowborder" width="33.33333333333333%">获取最近调用OH_NativeImage_UpdateSurfaceImage的纹理图像的变化矩阵。</td> </tr> <tr><td class="cellrowborder" width="33.33333333333333%"><a href="/consumer/cn/doc/harmonyos-references/capi-native-image-h#oh_nativeimage_getsurfaceid">int32_t OH_NativeImage_GetSurfaceId(OH_NativeImage* image, uint64_t* surfaceId)</a></td> <td class="cellrowborder" width="33.33333333333333%">-</td> <td class="cellrowborder" width="33.33333333333333%"><p>获取OH_NativeImage的surface编号。</p> <p>本接口为非线程安全类型接口。</p> </td> </tr> <tr><td class="cellrowborder" width="33.33333333333333%"><a href="/consumer/cn/doc/harmonyos-references/capi-native-image-h#oh_nativeimage_setonframeavailablelistener">int32_t OH_NativeImage_SetOnFrameAvailableListener(OH_NativeImage* image, OH_OnFrameAvailableListener listener)</a></td> <td class="cellrowborder" width="33.33333333333333%">-</td> <td class="cellrowborder" width="33.33333333333333%"><p>设置帧可用回调。</p> <p>不允许在回调函数中调用本模块的其他接口。</p> <p>本接口为非线程安全类型接口。</p> </td> </tr> <tr><td class="cellrowborder" width="33.33333333333333%"><a href="/consumer/cn/doc/harmonyos-references/capi-native-image-h#oh_nativeimage_unsetonframeavailablelistener">int32_t OH_NativeImage_UnsetOnFrameAvailableListener(OH_NativeImage* image)</a></td> <td class="cellrowborder" width="33.33333333333333%">-</td> <td class="cellrowborder" width="33.33333333333333%"><p>取消设置帧可用回调。</p> <p>本接口为非线程安全类型接口。</p> </td> </tr> <tr><td class="cellrowborder" width="33.33333333333333%"><a href="/consumer/cn/doc/harmonyos-references/capi-native-image-h#oh_nativeimage_destroy">void OH_NativeImage_Destroy(OH_NativeImage** image)</a></td> <td class="cellrowborder" width="33.33333333333333%">-</td> <td class="cellrowborder" width="33.33333333333333%"><p>销毁通过OH_NativeImage_Create创建的OH_NativeImage实例, 销毁后该</p> <p>OH_NativeImage指针会被赋值为空。</p> <p>本接口为非线程安全类型接口。</p> </td> </tr> <tr><td class="cellrowborder" width="33.33333333333333%"><a href="/consumer/cn/doc/harmonyos-references/capi-native-image-h#oh_nativeimage_gettransformmatrixv2">int32_t OH_NativeImage_GetTransformMatrixV2(OH_NativeImage* image, float matrix[16])</a></td> <td class="cellrowborder" width="33.33333333333333%">-</td> <td class="cellrowborder" width="33.33333333333333%"><p>根据生产端设置的旋转角度，获取最近调用OH_NativeImage_UpdateSurfaceImage的纹理图像的变化矩阵。</p> <p>matrix在<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-native-image-h#oh_nativeimage_updatesurfaceimage">OH_NativeImage_UpdateSurfaceImage</a>接口调用后，才会更新。</p> <p>本接口为非线程安全类型接口。</p> </td> </tr> <tr><td class="cellrowborder" width="33.33333333333333%"><a href="/consumer/cn/doc/harmonyos-references/capi-native-image-h#oh_nativeimage_getbuffermatrix">int32_t OH_NativeImage_GetBufferMatrix(OH_NativeImage* image, float matrix[16])</a></td> <td class="cellrowborder" width="33.33333333333333%">-</td> <td class="cellrowborder" width="33.33333333333333%"><p>获取根据生产端设置的旋转角度和buffer实际有效内容区域计算出的变换矩阵。</p> <p>本接口返回一个变换矩阵，该矩阵是<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-oh-nativeimage-oh-nativeimage">OH_NativeImage</a>在消费buffer，即调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-native-image-h#oh_nativeimage_updatesurfaceimage">OH_NativeImage_UpdateSurfaceImage</a>或者<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-native-image-h#oh_nativeimage_acquirenativewindowbuffer">OH_NativeImage_AcquireNativeWindowBuffer</a>时，根据buffer的旋转角度和实际有效内容区域计算所得。</p> <p>本接口为非线程安全类型接口。</p> </td> </tr> <tr><td class="cellrowborder" width="33.33333333333333%"><a href="/consumer/cn/doc/harmonyos-references/capi-native-image-h#oh_nativeimage_acquirenativewindowbuffer">int32_t OH_NativeImage_AcquireNativeWindowBuffer(OH_NativeImage* image,OHNativeWindowBuffer** nativeWindowBuffer, int* fenceFd)</a></td> <td class="cellrowborder" width="33.33333333333333%">-</td> <td class="cellrowborder" width="33.33333333333333%"><p>通过消费端的OH_NativeImage获取一个OHNativeWindowBuffer。</p> <p>本接口不能与<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-native-image-h#oh_nativeimage_updatesurfaceimage">OH_NativeImage_UpdateSurfaceImage</a>接口同时使用。</p> <p>本接口将会创建一个OHNativeWindowBuffer。</p> <p>当使用OHNativeWindowBuffer时，用户需要通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-external-window-h#oh_nativewindow_nativeobjectreference">OH_NativeWindow_NativeObjectReference</a>接口将其引用计数加一。</p> <p>当OHNativeWindowBuffer使用完，用户需要通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-external-window-h#oh_nativewindow_nativeobjectunreference">OH_NativeWindow_NativeObjectUnreference</a>接口将其引用计数减一。</p> <p>本接口需要和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-native-image-h#oh_nativeimage_releasenativewindowbuffer">OH_NativeImage_ReleaseNativeWindowBuffer</a>接口配合使用，否则会存在内存泄露。</p> <p>当fenceFd使用完，用户需要将其close。</p> <p>本接口为非线程安全类型接口。</p> </td> </tr> <tr><td class="cellrowborder" width="33.33333333333333%"><a href="/consumer/cn/doc/harmonyos-references/capi-native-image-h#oh_nativeimage_releasenativewindowbuffer">int32_t OH_NativeImage_ReleaseNativeWindowBuffer(OH_NativeImage* image,OHNativeWindowBuffer* nativeWindowBuffer, int fenceFd)</a></td> <td class="cellrowborder" width="33.33333333333333%">-</td> <td class="cellrowborder" width="33.33333333333333%"><p>通过OH_NativeImage实例将OHNativeWindowBuffer归还到buffer队列中。</p> <p>系统会将fenceFd关闭，无需用户close。</p> <p>本接口为非线程安全类型接口。</p> </td> </tr> <tr><td class="cellrowborder" width="33.33333333333333%"><a href="/consumer/cn/doc/harmonyos-references/capi-native-image-h#oh_consumersurface_create">OH_NativeImage* OH_ConsumerSurface_Create(void)</a></td> <td class="cellrowborder" width="33.33333333333333%">-</td> <td class="cellrowborder" width="33.33333333333333%"><p>创建一个OH_NativeImage实例，作为surface的消费端。</p> <p>本接口仅用于surface消费端的内存轮转，创建的OH_NativeImage内部不会主动进行内存渲染处理。</p> <p>本接口不能与<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-native-image-h#oh_nativeimage_updatesurfaceimage">OH_NativeImage_UpdateSurfaceImage</a>接口同时使用。</p> <p>本接口与<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-native-image-h#oh_nativeimage_acquirenativewindowbuffer">OH_NativeImage_AcquireNativeWindowBuffer</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-native-image-h#oh_nativeimage_releasenativewindowbuffer">OH_NativeImage_ReleaseNativeWindowBuffer</a>配合使用。</p> <p>本接口需要和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-native-image-h#oh_nativeimage_destroy">OH_NativeImage_Destroy</a>接口配合使用，否则会存在内存泄露。</p> <p>本接口为非线程安全类型接口。</p> </td> </tr> <tr><td class="cellrowborder" width="33.33333333333333%"><a href="/consumer/cn/doc/harmonyos-references/capi-native-image-h#oh_consumersurface_setdefaultusage">int32_t OH_ConsumerSurface_SetDefaultUsage(OH_NativeImage* image, uint64_t usage)</a></td> <td class="cellrowborder" width="33.33333333333333%">-</td> <td class="cellrowborder" width="33.33333333333333%"><p>设置默认读写方式。</p> <p>本接口为非线程安全类型接口。</p> </td> </tr> <tr><td class="cellrowborder" width="33.33333333333333%"><a href="/consumer/cn/doc/harmonyos-references/capi-native-image-h#oh_consumersurface_setdefaultsize">int32_t OH_ConsumerSurface_SetDefaultSize(OH_NativeImage* image, int32_t width, int32_t height)</a></td> <td class="cellrowborder" width="33.33333333333333%">-</td> <td class="cellrowborder" width="33.33333333333333%"><p>设置几何图形默认尺寸。</p> <p>本接口为非线程安全类型接口。</p> </td> </tr> <tr><td class="cellrowborder" width="33.33333333333333%"><a href="/consumer/cn/doc/harmonyos-references/capi-native-image-h#oh_nativeimage_setdropbuffermode">int32_t OH_NativeImage_SetDropBufferMode(OH_NativeImage* image, bool isOpen)</a></td> <td class="cellrowborder" width="33.33333333333333%">-</td> <td class="cellrowborder" width="33.33333333333333%"><p>设置OH_NativeImage是否为渲染丢帧模式。</p> <p>处于此模式时，大部分生产端生产的buffer将会被丢弃，最新的buffer会及时上屏渲染。</p> <p>此模式不能同时保证帧率高的要求。</p> <p>此接口建议在<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-native-image-h#oh_nativeimage_create">OH_NativeImage_Create</a>接口调用后立即调用。</p> <p>此接口在与<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-native-image-h#oh_nativeimage_updatesurfaceimage">OH_NativeImage_UpdateSurfaceImage</a>接口一起使用的场景下才会生效。</p> <p>本接口为非线程安全类型接口。</p> </td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h2 id="函数说明" device-type="phone,2in1,tablet,wearable,tv">函数说明<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="函数说明" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div></div>  <div class="tiledSection"><h3 id="oh_onframeavailable" device-type="phone,2in1,tablet,wearable,tv" class="firsth2">OH_OnFrameAvailable()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="oh_onframeavailable" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><div _ngcontent-had-c106="" class="highlight-div"><div _ngcontent-had-c106="" class="highlight-div-header"><div _ngcontent-had-c106="" class="highlight-div-header-left"><div _ngcontent-had-c106="" class="handle-button expand-button"><div _ngcontent-had-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-had-c106="" class="highlight-div-header-right"><div _ngcontent-had-c106="" class="handle-button ai-button"></div><div _ngcontent-had-c106="" class="handle-button line-button"><div _ngcontent-had-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-had-c106="" class="handle-button theme-button"><div _ngcontent-had-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-had-c106="" class="handle-button copy-button"><div _ngcontent-had-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-had-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-objectivec" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">typedef</span> <span class="hljs-type">void</span> (*OH_OnFrameAvailable)(<span class="hljs-type">void</span> *context)</li></ol></pre></div></div> <p><strong>描述</strong></p> <p>有buffer可获取时触发的回调函数。</p> <p><strong>系统能力：</strong> SystemCapability.Graphic.Graphic2D.NativeImage</p> <p><strong>起始版本：</strong> 11</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.6.8.1.3.1.1" width="50%">参数项</th> <th align="left" class="cellrowborder" id="mcps1.3.6.8.1.3.1.2" width="50%">描述</th> </tr><tr><td class="cellrowborder" width="50%">void *context</td> <td class="cellrowborder" width="50%">用户自定义的上下文信息，会在回调触发时返回给用户。</td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h3 id="oh_nativeimage_create" device-type="phone,2in1,tablet,wearable,tv">OH_NativeImage_Create()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="oh_nativeimage_create" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><div _ngcontent-had-c106="" class="highlight-div"><div _ngcontent-had-c106="" class="highlight-div-header"><div _ngcontent-had-c106="" class="highlight-div-header-left"><div _ngcontent-had-c106="" class="handle-button expand-button"><div _ngcontent-had-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-had-c106="" class="highlight-div-header-right"><div _ngcontent-had-c106="" class="handle-button ai-button"></div><div _ngcontent-had-c106="" class="handle-button line-button"><div _ngcontent-had-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-had-c106="" class="handle-button theme-button"><div _ngcontent-had-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-had-c106="" class="handle-button copy-button"><div _ngcontent-had-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-had-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-function">OH_NativeImage* <span class="hljs-title">OH_NativeImage_Create</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> textureId, <span class="hljs-type">uint32_t</span> textureTarget)</span></span></li></ol></pre></div></div> <p><strong>描述</strong></p> <p>创建一个OH_NativeImage实例，该实例与OpenGL ES的纹理ID和纹理目标相关联。</p> <p>本接口需要与<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-native-image-h#oh_nativeimage_destroy">OH_NativeImage_Destroy</a>接口配合使用，否则会存在内存泄露。</p> <p>本接口为非线程安全类型接口。</p> <p><strong>系统能力：</strong> SystemCapability.Graphic.Graphic2D.NativeImage</p> <p><strong>起始版本：</strong> 9</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.7.10.1.3.1.1" width="50%">参数项</th> <th align="left" class="cellrowborder" id="mcps1.3.7.10.1.3.1.2" width="50%">描述</th> </tr><tr><td class="cellrowborder" width="50%">uint32_t textureId</td> <td class="cellrowborder" width="50%">OpenGL ES的纹理ID，OH_NativeImage实例会与之相关联。</td> </tr> <tr><td class="cellrowborder" width="50%">uint32_t textureTarget</td> <td class="cellrowborder" width="50%">OpenGL ES的纹理目标，取值范围为GL_TEXTURE_2D和GL_TEXTURE_EXTERNAL_OES，具体可见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-faqs/faqs-arkgraphics-2d-12" target="_blank">选择纹理类型</a>。</td> </tr>  </tbody></table></div> </div> <p><strong>返回：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.7.12.1.3.1.1" width="50%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.7.12.1.3.1.2" width="50%">说明</th> </tr><tr><td class="cellrowborder" width="50%">OH_NativeImage*</td> <td class="cellrowborder" width="50%">创建成功则返回一个指向OH_NativeImage实例的指针，否则返回NULL。</td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h3 id="oh_nativeimage_acquirenativewindow" device-type="phone,2in1,tablet,wearable,tv">OH_NativeImage_AcquireNativeWindow()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="oh_nativeimage_acquirenativewindow" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><div _ngcontent-had-c106="" class="highlight-div"><div _ngcontent-had-c106="" class="highlight-div-header"><div _ngcontent-had-c106="" class="highlight-div-header-left"><div _ngcontent-had-c106="" class="handle-button expand-button"><div _ngcontent-had-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-had-c106="" class="highlight-div-header-right"><div _ngcontent-had-c106="" class="handle-button ai-button"></div><div _ngcontent-had-c106="" class="handle-button line-button"><div _ngcontent-had-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-had-c106="" class="handle-button theme-button"><div _ngcontent-had-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-had-c106="" class="handle-button copy-button"><div _ngcontent-had-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-had-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-scss" data-highlighted="yes"><ol class="linenums"><li>OHNativeWindow* <span class="hljs-built_in">OH_NativeImage_AcquireNativeWindow</span>(OH_NativeImage* image)</li></ol></pre></div></div> <p><strong>描述</strong></p> <p>获取与OH_NativeImage相关联的OHNativeWindow指针。</p> <p>本接口为非线程安全类型接口。</p> <p>OH_NativeImage析构时会将对应的OHNativeWindow实例释放。若从本接口获取OHNativeWindow指针，当OH_NativeImage实例释放时，请将获取到的OHNativeWindow指针置空，防止后续产生野指针。</p> <p><strong>系统能力：</strong> SystemCapability.Graphic.Graphic2D.NativeImage</p> <p><strong>起始版本：</strong> 9</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.8.10.1.3.1.1" width="50%">参数项</th> <th align="left" class="cellrowborder" id="mcps1.3.8.10.1.3.1.2" width="50%">描述</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-oh-nativeimage-oh-nativeimage">OH_NativeImage</a>* image</td> <td class="cellrowborder" width="50%">指向OH_NativeImage实例的指针。</td> </tr>  </tbody></table></div> </div> <p><strong>返回：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.8.12.1.3.1.1" width="50%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.8.12.1.3.1.2" width="50%">说明</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-nativewindow-nativewindow">OHNativeWindow</a>*</td> <td class="cellrowborder" width="50%">成功则返回一个指向OHNativeWindow实例的指针，否则返回NULL。</td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h3 id="oh_nativeimage_attachcontext" device-type="phone,2in1,tablet,wearable,tv">OH_NativeImage_AttachContext()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="oh_nativeimage_attachcontext" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><div _ngcontent-had-c106="" class="highlight-div"><div _ngcontent-had-c106="" class="highlight-div-header"><div _ngcontent-had-c106="" class="highlight-div-header-left"><div _ngcontent-had-c106="" class="handle-button expand-button"><div _ngcontent-had-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-had-c106="" class="highlight-div-header-right"><div _ngcontent-had-c106="" class="handle-button ai-button"></div><div _ngcontent-had-c106="" class="handle-button line-button"><div _ngcontent-had-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-had-c106="" class="handle-button theme-button"><div _ngcontent-had-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-had-c106="" class="handle-button copy-button"><div _ngcontent-had-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-had-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-function"><span class="hljs-type">int32_t</span> <span class="hljs-title">OH_NativeImage_AttachContext</span><span class="hljs-params">(OH_NativeImage* image, <span class="hljs-type">uint32_t</span> textureId)</span></span></li></ol></pre></div></div> <p><strong>描述</strong></p> <p>将OH_NativeImage实例附加到当前OpenGL ES上下文，且该OpenGL ES纹理会绑定到GL_TEXTURE_EXTERNAL_OES, 并通过OH_NativeImage进行更新。</p> <p>本接口为非线程安全类型接口。</p> <p><strong>系统能力：</strong> SystemCapability.Graphic.Graphic2D.NativeImage</p> <p><strong>起始版本：</strong> 9</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.9.9.1.3.1.1" width="50%">参数项</th> <th align="left" class="cellrowborder" id="mcps1.3.9.9.1.3.1.2" width="50%">描述</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-oh-nativeimage-oh-nativeimage">OH_NativeImage</a>* image</td> <td class="cellrowborder" width="50%">指向OH_NativeImage实例的指针。</td> </tr> <tr><td class="cellrowborder" width="50%">uint32_t textureId</td> <td class="cellrowborder" width="50%">是OH_NativeImage要附加到的OpenGL ES纹理的id。</td> </tr>  </tbody></table></div> </div> <p><strong>返回：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.9.11.1.3.1.1" width="50%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.9.11.1.3.1.2" width="50%">说明</th> </tr><tr><td class="cellrowborder" width="50%">int32_t</td> <td class="cellrowborder" width="50%">返回值为0表示执行成功，其他返回值可参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-graphic-error-code-h#ohnativeerrorcode">OHNativeErrorCode</a>。</td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h3 id="oh_nativeimage_detachcontext" device-type="phone,2in1,tablet,wearable,tv">OH_NativeImage_DetachContext()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="oh_nativeimage_detachcontext" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><div _ngcontent-had-c106="" class="highlight-div"><div _ngcontent-had-c106="" class="highlight-div-header"><div _ngcontent-had-c106="" class="highlight-div-header-left"><div _ngcontent-had-c106="" class="handle-button expand-button"><div _ngcontent-had-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-had-c106="" class="highlight-div-header-right"><div _ngcontent-had-c106="" class="handle-button ai-button"></div><div _ngcontent-had-c106="" class="handle-button line-button"><div _ngcontent-had-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-had-c106="" class="handle-button theme-button"><div _ngcontent-had-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-had-c106="" class="handle-button copy-button"><div _ngcontent-had-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-had-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-scss" data-highlighted="yes"><ol class="linenums"><li>int32_t <span class="hljs-built_in">OH_NativeImage_DetachContext</span>(OH_NativeImage* image)</li></ol></pre></div></div> <p><strong>描述</strong></p> <p>将OH_NativeImage实例从当前OpenGL ES上下文分离。</p> <p>本接口为非线程安全类型接口。</p> <p><strong>系统能力：</strong> SystemCapability.Graphic.Graphic2D.NativeImage</p> <p><strong>起始版本：</strong> 9</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.10.9.1.3.1.1" width="50%">参数项</th> <th align="left" class="cellrowborder" id="mcps1.3.10.9.1.3.1.2" width="50%">描述</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-oh-nativeimage-oh-nativeimage">OH_NativeImage</a>* image</td> <td class="cellrowborder" width="50%">指向OH_NativeImage实例的指针。</td> </tr>  </tbody></table></div> </div> <p><strong>返回：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.10.11.1.3.1.1" width="50%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.10.11.1.3.1.2" width="50%">说明</th> </tr><tr><td class="cellrowborder" width="50%">int32_t</td> <td class="cellrowborder" width="50%">返回值为0表示执行成功，其他返回值可参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-graphic-error-code-h#ohnativeerrorcode">OHNativeErrorCode</a>。</td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h3 id="oh_nativeimage_updatesurfaceimage" device-type="phone,2in1,tablet,wearable,tv">OH_NativeImage_UpdateSurfaceImage()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="oh_nativeimage_updatesurfaceimage" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><div _ngcontent-had-c106="" class="highlight-div"><div _ngcontent-had-c106="" class="highlight-div-header"><div _ngcontent-had-c106="" class="highlight-div-header-left"><div _ngcontent-had-c106="" class="handle-button expand-button"><div _ngcontent-had-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-had-c106="" class="highlight-div-header-right"><div _ngcontent-had-c106="" class="handle-button ai-button"></div><div _ngcontent-had-c106="" class="handle-button line-button"><div _ngcontent-had-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-had-c106="" class="handle-button theme-button"><div _ngcontent-had-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-had-c106="" class="handle-button copy-button"><div _ngcontent-had-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-had-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-scss" data-highlighted="yes"><ol class="linenums"><li>int32_t <span class="hljs-built_in">OH_NativeImage_UpdateSurfaceImage</span>(OH_NativeImage* image)</li></ol></pre></div></div> <p><strong>描述</strong></p> <p>通过OH_NativeImage获取最新帧更新相关联的OpenGL ES纹理。</p> <p>本接口需要在Opengl ES环境上下文的线程中调用。</p> <p>本接口需要在接收到<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-oh-nativeimage-oh-onframeavailablelistener">OH_OnFrameAvailableListener</a>回调后调用。</p> <p>本接口为非线程安全类型接口。</p> <p><strong>系统能力：</strong> SystemCapability.Graphic.Graphic2D.NativeImage</p> <p><strong>起始版本：</strong> 9</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.11.11.1.3.1.1" width="50%">参数项</th> <th align="left" class="cellrowborder" id="mcps1.3.11.11.1.3.1.2" width="50%">描述</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-oh-nativeimage-oh-nativeimage">OH_NativeImage</a>* image</td> <td class="cellrowborder" width="50%">指向OH_NativeImage实例的指针。</td> </tr>  </tbody></table></div> </div> <p><strong>返回：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.11.13.1.3.1.1" width="50%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.11.13.1.3.1.2" width="50%">说明</th> </tr><tr><td class="cellrowborder" width="50%">int32_t</td> <td class="cellrowborder" width="50%">返回值为0表示执行成功，其他返回值可参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-graphic-error-code-h#ohnativeerrorcode">OHNativeErrorCode</a>。</td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h3 id="oh_nativeimage_gettimestamp" device-type="phone,2in1,tablet,wearable,tv">OH_NativeImage_GetTimestamp()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="oh_nativeimage_gettimestamp" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><div _ngcontent-had-c106="" class="highlight-div"><div _ngcontent-had-c106="" class="highlight-div-header"><div _ngcontent-had-c106="" class="highlight-div-header-left"><div _ngcontent-had-c106="" class="handle-button expand-button"><div _ngcontent-had-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-had-c106="" class="highlight-div-header-right"><div _ngcontent-had-c106="" class="handle-button ai-button"></div><div _ngcontent-had-c106="" class="handle-button line-button"><div _ngcontent-had-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-had-c106="" class="handle-button theme-button"><div _ngcontent-had-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-had-c106="" class="handle-button copy-button"><div _ngcontent-had-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-had-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-scss" data-highlighted="yes"><ol class="linenums"><li>int64_t <span class="hljs-built_in">OH_NativeImage_GetTimestamp</span>(OH_NativeImage* image)</li></ol></pre></div></div> <p><strong>描述</strong></p> <p>获取最近调用OH_NativeImage_UpdateSurfaceImage的纹理图像的相关时间戳。</p> <p>本接口为非线程安全类型接口。</p> <p><strong>系统能力：</strong> SystemCapability.Graphic.Graphic2D.NativeImage</p> <p><strong>起始版本：</strong> 9</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.12.9.1.3.1.1" width="50%">参数项</th> <th align="left" class="cellrowborder" id="mcps1.3.12.9.1.3.1.2" width="50%">描述</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-oh-nativeimage-oh-nativeimage">OH_NativeImage</a>* image</td> <td class="cellrowborder" width="50%">指向OH_NativeImage实例的指针。</td> </tr>  </tbody></table></div> </div> <p><strong>返回：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.12.11.1.3.1.1" width="50%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.12.11.1.3.1.2" width="50%">说明</th> </tr><tr><td class="cellrowborder" width="50%">int64_t</td> <td class="cellrowborder" width="50%">返回纹理图像的相关时间戳。</td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h3 id="oh_nativeimage_gettransformmatrix" device-type="phone,2in1,tablet,wearable,tv">OH_NativeImage_GetTransformMatrix()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="oh_nativeimage_gettransformmatrix" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><div _ngcontent-had-c106="" class="highlight-div"><div _ngcontent-had-c106="" class="highlight-div-header"><div _ngcontent-had-c106="" class="highlight-div-header-left"><div _ngcontent-had-c106="" class="handle-button expand-button"><div _ngcontent-had-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-had-c106="" class="highlight-div-header-right"><div _ngcontent-had-c106="" class="handle-button ai-button"></div><div _ngcontent-had-c106="" class="handle-button line-button"><div _ngcontent-had-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-had-c106="" class="handle-button theme-button"><div _ngcontent-had-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-had-c106="" class="handle-button copy-button"><div _ngcontent-had-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-had-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-function"><span class="hljs-type">int32_t</span> <span class="hljs-title">OH_NativeImage_GetTransformMatrix</span><span class="hljs-params">(OH_NativeImage* image, <span class="hljs-type">float</span> matrix[<span class="hljs-number">16</span>])</span></span></li></ol></pre></div></div> <p><strong>描述</strong></p> <p>获取最近调用OH_NativeImage_UpdateSurfaceImage的纹理图像的变化矩阵。</p> <p><strong>系统能力：</strong> SystemCapability.Graphic.Graphic2D.NativeImage</p> <p><strong>起始版本：</strong> 9</p> <p><strong>废弃版本：</strong> 从API version 12开始废弃。</p> <p><strong>替代接口：</strong> <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-native-image-h#oh_nativeimage_gettransformmatrixv2">OH_NativeImage_GetTransformMatrixV2</a></p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.13.10.1.3.1.1" width="50%">参数项</th> <th align="left" class="cellrowborder" id="mcps1.3.13.10.1.3.1.2" width="50%">描述</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-oh-nativeimage-oh-nativeimage">OH_NativeImage</a>* image</td> <td class="cellrowborder" width="50%">指向OH_NativeImage实例的指针。</td> </tr> <tr><td class="cellrowborder" width="50%">matrix</td> <td class="cellrowborder" width="50%">用来存储要获取的4*4的变化矩阵。</td> </tr>  </tbody></table></div> </div> <p><strong>返回：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.13.12.1.3.1.1" width="50%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.13.12.1.3.1.2" width="50%">说明</th> </tr><tr><td class="cellrowborder" width="50%">int32_t</td> <td class="cellrowborder" width="50%">返回值为0表示执行成功，其他返回值可参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-graphic-error-code-h#ohnativeerrorcode">OHNativeErrorCode</a>。</td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h3 id="oh_nativeimage_getsurfaceid" device-type="phone,2in1,tablet,wearable,tv">OH_NativeImage_GetSurfaceId()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="oh_nativeimage_getsurfaceid" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><div _ngcontent-had-c106="" class="highlight-div"><div _ngcontent-had-c106="" class="highlight-div-header"><div _ngcontent-had-c106="" class="highlight-div-header-left"><div _ngcontent-had-c106="" class="handle-button expand-button"><div _ngcontent-had-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-had-c106="" class="highlight-div-header-right"><div _ngcontent-had-c106="" class="handle-button ai-button"></div><div _ngcontent-had-c106="" class="handle-button line-button"><div _ngcontent-had-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-had-c106="" class="handle-button theme-button"><div _ngcontent-had-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-had-c106="" class="handle-button copy-button"><div _ngcontent-had-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-had-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-function"><span class="hljs-type">int32_t</span> <span class="hljs-title">OH_NativeImage_GetSurfaceId</span><span class="hljs-params">(OH_NativeImage* image, <span class="hljs-type">uint64_t</span>* surfaceId)</span></span></li></ol></pre></div></div> <p><strong>描述</strong></p> <p>获取OH_NativeImage的surface编号。</p> <p>本接口为非线程安全类型接口。</p> <p><strong>系统能力：</strong> SystemCapability.Graphic.Graphic2D.NativeImage</p> <p><strong>起始版本：</strong> 11</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.14.9.1.3.1.1" width="50%">参数项</th> <th align="left" class="cellrowborder" id="mcps1.3.14.9.1.3.1.2" width="50%">描述</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-oh-nativeimage-oh-nativeimage">OH_NativeImage</a>* image</td> <td class="cellrowborder" width="50%">指向OH_NativeImage实例的指针。</td> </tr> <tr><td class="cellrowborder" width="50%">uint64_t* surfaceId</td> <td class="cellrowborder" width="50%">是指向surface编号的指针。</td> </tr>  </tbody></table></div> </div> <p><strong>返回：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.14.11.1.3.1.1" width="50%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.14.11.1.3.1.2" width="50%">说明</th> </tr><tr><td class="cellrowborder" width="50%">int32_t</td> <td class="cellrowborder" width="50%">返回值为0表示执行成功，其他返回值可参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-graphic-error-code-h#ohnativeerrorcode">OHNativeErrorCode</a>。</td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h3 id="oh_nativeimage_setonframeavailablelistener" device-type="phone,2in1,tablet,wearable,tv">OH_NativeImage_SetOnFrameAvailableListener()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="oh_nativeimage_setonframeavailablelistener" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><div _ngcontent-had-c106="" class="highlight-div"><div _ngcontent-had-c106="" class="highlight-div-header"><div _ngcontent-had-c106="" class="highlight-div-header-left"><div _ngcontent-had-c106="" class="handle-button expand-button"><div _ngcontent-had-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-had-c106="" class="highlight-div-header-right"><div _ngcontent-had-c106="" class="handle-button ai-button"></div><div _ngcontent-had-c106="" class="handle-button line-button"><div _ngcontent-had-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-had-c106="" class="handle-button theme-button"><div _ngcontent-had-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-had-c106="" class="handle-button copy-button"><div _ngcontent-had-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-had-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-scss" data-highlighted="yes"><ol class="linenums"><li>int32_t <span class="hljs-built_in">OH_NativeImage_SetOnFrameAvailableListener</span>(OH_NativeImage* image, OH_OnFrameAvailableListener listener)</li></ol></pre></div></div> <p><strong>描述</strong></p> <p>设置帧可用回调。</p> <p>不允许在回调函数中调用本模块的其他接口。</p> <p>本接口为非线程安全类型接口。</p> <p><strong>系统能力：</strong> SystemCapability.Graphic.Graphic2D.NativeImage</p> <p><strong>起始版本：</strong> 11</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.15.10.1.3.1.1" width="50%">参数项</th> <th align="left" class="cellrowborder" id="mcps1.3.15.10.1.3.1.2" width="50%">描述</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-oh-nativeimage-oh-nativeimage">OH_NativeImage</a>* image</td> <td class="cellrowborder" width="50%">指向OH_NativeImage实例的指针。</td> </tr> <tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-oh-nativeimage-oh-onframeavailablelistener">OH_OnFrameAvailableListener</a> listener</td> <td class="cellrowborder" width="50%">表示回调监听者。</td> </tr>  </tbody></table></div> </div> <p><strong>返回：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.15.12.1.3.1.1" width="50%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.15.12.1.3.1.2" width="50%">说明</th> </tr><tr><td class="cellrowborder" width="50%">int32_t</td> <td class="cellrowborder" width="50%">返回值为0表示执行成功，其他返回值可参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-graphic-error-code-h#ohnativeerrorcode">OHNativeErrorCode</a>。</td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h3 id="oh_nativeimage_unsetonframeavailablelistener" device-type="phone,2in1,tablet,wearable,tv">OH_NativeImage_UnsetOnFrameAvailableListener()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="oh_nativeimage_unsetonframeavailablelistener" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><div _ngcontent-had-c106="" class="highlight-div"><div _ngcontent-had-c106="" class="highlight-div-header"><div _ngcontent-had-c106="" class="highlight-div-header-left"><div _ngcontent-had-c106="" class="handle-button expand-button"><div _ngcontent-had-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-had-c106="" class="highlight-div-header-right"><div _ngcontent-had-c106="" class="handle-button ai-button"></div><div _ngcontent-had-c106="" class="handle-button line-button"><div _ngcontent-had-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-had-c106="" class="handle-button theme-button"><div _ngcontent-had-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-had-c106="" class="handle-button copy-button"><div _ngcontent-had-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-had-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-scss" data-highlighted="yes"><ol class="linenums"><li>int32_t <span class="hljs-built_in">OH_NativeImage_UnsetOnFrameAvailableListener</span>(OH_NativeImage* image)</li></ol></pre></div></div> <p><strong>描述</strong></p> <p>取消设置帧可用回调。</p> <p>本接口为非线程安全类型接口。</p> <p><strong>系统能力：</strong> SystemCapability.Graphic.Graphic2D.NativeImage</p> <p><strong>起始版本：</strong> 11</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.16.9.1.3.1.1" width="50%">参数项</th> <th align="left" class="cellrowborder" id="mcps1.3.16.9.1.3.1.2" width="50%">描述</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-oh-nativeimage-oh-nativeimage">OH_NativeImage</a>* image</td> <td class="cellrowborder" width="50%">指向OH_NativeImage实例的指针。</td> </tr>  </tbody></table></div> </div> <p><strong>返回：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.16.11.1.3.1.1" width="50%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.16.11.1.3.1.2" width="50%">说明</th> </tr><tr><td class="cellrowborder" width="50%">int32_t</td> <td class="cellrowborder" width="50%">返回值为0表示执行成功，其他返回值可参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-graphic-error-code-h#ohnativeerrorcode">OHNativeErrorCode</a>。</td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h3 id="oh_nativeimage_destroy" device-type="phone,2in1,tablet,wearable,tv">OH_NativeImage_Destroy()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="oh_nativeimage_destroy" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><div _ngcontent-had-c106="" class="highlight-div"><div _ngcontent-had-c106="" class="highlight-div-header"><div _ngcontent-had-c106="" class="highlight-div-header-left"><div _ngcontent-had-c106="" class="handle-button expand-button"><div _ngcontent-had-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-had-c106="" class="highlight-div-header-right"><div _ngcontent-had-c106="" class="handle-button ai-button"></div><div _ngcontent-had-c106="" class="handle-button line-button"><div _ngcontent-had-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-had-c106="" class="handle-button theme-button"><div _ngcontent-had-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-had-c106="" class="handle-button copy-button"><div _ngcontent-had-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-had-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-java" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">void</span> <span class="hljs-title function_">OH_NativeImage_Destroy</span><span class="hljs-params">(OH_NativeImage** image)</span></li></ol></pre></div></div> <p><strong>描述</strong></p> <p>销毁通过OH_NativeImage_Create创建的OH_NativeImage实例, 销毁后该</p> <p>OH_NativeImage指针会被赋值为空。</p> <p>本接口为非线程安全类型接口。</p> <p><strong>系统能力：</strong> SystemCapability.Graphic.Graphic2D.NativeImage</p> <p><strong>起始版本：</strong> 9</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.17.10.1.3.1.1" width="50%">参数项</th> <th align="left" class="cellrowborder" id="mcps1.3.17.10.1.3.1.2" width="50%">描述</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-oh-nativeimage-oh-nativeimage">OH_NativeImage</a>** image</td> <td class="cellrowborder" width="50%">指向OH_NativeImage实例的指针。</td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h3 id="oh_nativeimage_gettransformmatrixv2" device-type="phone,2in1,tablet,wearable,tv">OH_NativeImage_GetTransformMatrixV2()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="oh_nativeimage_gettransformmatrixv2" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><div _ngcontent-had-c106="" class="highlight-div"><div _ngcontent-had-c106="" class="highlight-div-header"><div _ngcontent-had-c106="" class="highlight-div-header-left"><div _ngcontent-had-c106="" class="handle-button expand-button"><div _ngcontent-had-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-had-c106="" class="highlight-div-header-right"><div _ngcontent-had-c106="" class="handle-button ai-button"></div><div _ngcontent-had-c106="" class="handle-button line-button"><div _ngcontent-had-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-had-c106="" class="handle-button theme-button"><div _ngcontent-had-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-had-c106="" class="handle-button copy-button"><div _ngcontent-had-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-had-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-function"><span class="hljs-type">int32_t</span> <span class="hljs-title">OH_NativeImage_GetTransformMatrixV2</span><span class="hljs-params">(OH_NativeImage* image, <span class="hljs-type">float</span> matrix[<span class="hljs-number">16</span>])</span></span></li></ol></pre></div></div> <p><strong>描述</strong></p> <p>根据生产端设置的旋转角度，获取最近调用OH_NativeImage_UpdateSurfaceImage的纹理图像的变化矩阵。</p> <p>matrix在<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-native-image-h#oh_nativeimage_updatesurfaceimage">OH_NativeImage_UpdateSurfaceImage</a>接口调用后，才会更新。</p> <p>本接口为非线程安全类型接口。</p> <p><strong>系统能力：</strong> SystemCapability.Graphic.Graphic2D.NativeImage</p> <p><strong>起始版本：</strong> 12</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.18.10.1.3.1.1" width="50%">参数项</th> <th align="left" class="cellrowborder" id="mcps1.3.18.10.1.3.1.2" width="50%">描述</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-oh-nativeimage-oh-nativeimage">OH_NativeImage</a>* image</td> <td class="cellrowborder" width="50%">指向OH_NativeImage实例的指针。</td> </tr> <tr><td class="cellrowborder" width="50%">matrix</td> <td class="cellrowborder" width="50%">用来存储要获取的4*4的变化矩阵。</td> </tr>  </tbody></table></div> </div> <p><strong>返回：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.18.12.1.3.1.1" width="50%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.18.12.1.3.1.2" width="50%">说明</th> </tr><tr><td class="cellrowborder" width="50%">int32_t</td> <td class="cellrowborder" width="50%"><p>返回接口执行结果。NATIVE_ERROR_OK，表示接口执行成功。</p> <p> 返回NATIVE_ERROR_INVALID_ARGUMENTS，对应错误码为40001000，表示image参数为空。</p> <p> 返回NATIVE_ERROR_UNKNOWN，对应错误码为50002000，表示未知错误，请查看日志。</p> </td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h3 id="oh_nativeimage_getbuffermatrix" device-type="phone,2in1,tablet,wearable,tv">OH_NativeImage_GetBufferMatrix()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="oh_nativeimage_getbuffermatrix" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><div _ngcontent-had-c106="" class="highlight-div"><div _ngcontent-had-c106="" class="highlight-div-header"><div _ngcontent-had-c106="" class="highlight-div-header-left"><div _ngcontent-had-c106="" class="handle-button expand-button"><div _ngcontent-had-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-had-c106="" class="highlight-div-header-right"><div _ngcontent-had-c106="" class="handle-button ai-button"></div><div _ngcontent-had-c106="" class="handle-button line-button"><div _ngcontent-had-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-had-c106="" class="handle-button theme-button"><div _ngcontent-had-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-had-c106="" class="handle-button copy-button"><div _ngcontent-had-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-had-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-function"><span class="hljs-type">int32_t</span> <span class="hljs-title">OH_NativeImage_GetBufferMatrix</span><span class="hljs-params">(OH_NativeImage* image, <span class="hljs-type">float</span> matrix[<span class="hljs-number">16</span>])</span></span></li></ol></pre></div></div> <p><strong>描述</strong></p> <p>获取根据生产端设置的旋转角度和buffer实际有效内容区域计算出的变换矩阵。</p> <p>本接口返回一个变换矩阵，该矩阵是<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-oh-nativeimage-oh-nativeimage">OH_NativeImage</a>在消费buffer，即调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-native-image-h#oh_nativeimage_updatesurfaceimage">OH_NativeImage_UpdateSurfaceImage</a>或者<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-native-image-h#oh_nativeimage_acquirenativewindowbuffer">OH_NativeImage_AcquireNativeWindowBuffer</a>时，根据buffer的旋转角度和实际有效内容区域计算所得。</p> <p>本接口为非线程安全类型接口。</p> <p><strong>系统能力：</strong> SystemCapability.Graphic.Graphic2D.NativeImage</p> <p><strong>起始版本：</strong> 15</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.19.10.1.3.1.1" width="50%">参数项</th> <th align="left" class="cellrowborder" id="mcps1.3.19.10.1.3.1.2" width="50%">描述</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-oh-nativeimage-oh-nativeimage">OH_NativeImage</a>* image</td> <td class="cellrowborder" width="50%">指向<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-oh-nativeimage-oh-nativeimage">OH_NativeImage</a>实例的指针。</td> </tr> <tr><td class="cellrowborder" width="50%">matrix</td> <td class="cellrowborder" width="50%">用于存储获取的4*4变换矩阵。</td> </tr>  </tbody></table></div> </div> <p><strong>返回：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.19.12.1.3.1.1" width="50%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.19.12.1.3.1.2" width="50%">说明</th> </tr><tr><td class="cellrowborder" width="50%">int32_t</td> <td class="cellrowborder" width="50%"><p>返回接口执行结果。NATIVE_ERROR_OK，表示接口执行成功。</p> <p> 返回NATIVE_ERROR_INVALID_ARGUMENTS，对应错误码为40001000，表示image参数为空。</p> <p> 返回NATIVE_ERROR_MEM_OPERATION_ERROR，对应错误码为30001000，表示内存操作错误，获取变换矩阵失败。</p> </td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h3 id="oh_nativeimage_acquirenativewindowbuffer" device-type="phone,2in1,tablet,wearable,tv">OH_NativeImage_AcquireNativeWindowBuffer()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="oh_nativeimage_acquirenativewindowbuffer" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><div _ngcontent-had-c106="" class="highlight-div"><div _ngcontent-had-c106="" class="highlight-div-header"><div _ngcontent-had-c106="" class="highlight-div-header-left"><div _ngcontent-had-c106="" class="handle-button expand-button"><div _ngcontent-had-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-had-c106="" class="highlight-div-header-right"><div _ngcontent-had-c106="" class="handle-button ai-button"></div><div _ngcontent-had-c106="" class="handle-button line-button"><div _ngcontent-had-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-had-c106="" class="handle-button theme-button"><div _ngcontent-had-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-had-c106="" class="handle-button copy-button"><div _ngcontent-had-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-had-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-function"><span class="hljs-type">int32_t</span> <span class="hljs-title">OH_NativeImage_AcquireNativeWindowBuffer</span><span class="hljs-params">(OH_NativeImage* image,OHNativeWindowBuffer** nativeWindowBuffer, <span class="hljs-type">int</span>* fenceFd)</span></span></li></ol></pre></div></div> <p><strong>描述</strong></p> <p>通过消费端的OH_NativeImage获取一个OHNativeWindowBuffer。本接口不能与<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-native-image-h#oh_nativeimage_updatesurfaceimage">OH_NativeImage_UpdateSurfaceImage</a>接口同时使用。</p> <p>本接口将会创建一个OHNativeWindowBuffer。当使用OHNativeWindowBuffer时，用户需要通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-external-window-h#oh_nativewindow_nativeobjectreference">OH_NativeWindow_NativeObjectReference</a>接口将其引用计数加一。当OHNativeWindowBuffer使用完，用户需要通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-external-window-h#oh_nativewindow_nativeobjectunreference">OH_NativeWindow_NativeObjectUnreference</a>接口将其引用计数减一。</p> <p>本接口需要和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-native-image-h#oh_nativeimage_releasenativewindowbuffer">OH_NativeImage_ReleaseNativeWindowBuffer</a>接口配合使用，否则会存在内存泄露。</p> <p>当fenceFd使用完，用户需要将其close。</p> <p>本接口为非线程安全类型接口。</p> <p><strong>系统能力：</strong> SystemCapability.Graphic.Graphic2D.NativeImage</p> <p><strong>起始版本：</strong> 12</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.20.12.1.3.1.1" width="50%">参数项</th> <th align="left" class="cellrowborder" id="mcps1.3.20.12.1.3.1.2" width="50%">描述</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-oh-nativeimage-oh-nativeimage">OH_NativeImage</a>* image</td> <td class="cellrowborder" width="50%">指向OH_NativeImage实例的指针。</td> </tr> <tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-nativewindow-nativewindowbuffer">OHNativeWindowBuffer</a>** nativeWindowBuffer</td> <td class="cellrowborder" width="50%">指向OHNativeWindowBuffer指针的指针。</td> </tr> <tr><td class="cellrowborder" width="50%">int* fenceFd</td> <td class="cellrowborder" width="50%">指向文件描述符句柄的指针。</td> </tr>  </tbody></table></div> </div> <p><strong>返回：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.20.14.1.3.1.1" width="50%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.20.14.1.3.1.2" width="50%">说明</th> </tr><tr><td class="cellrowborder" width="50%">int32_t</td> <td class="cellrowborder" width="50%"><p>执行成功时返回NATIVE_ERROR_OK。</p> <p> image, nativeWindowBuffer, fenceFd是空指针时返回NATIVE_ERROR_INVALID_ARGUMENTS。</p> <p> 没有buffer可以消费时返回NATIVE_ERROR_NO_BUFFER。</p> </td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h3 id="oh_nativeimage_releasenativewindowbuffer" device-type="phone,2in1,tablet,wearable,tv">OH_NativeImage_ReleaseNativeWindowBuffer()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="oh_nativeimage_releasenativewindowbuffer" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><div _ngcontent-had-c106="" class="highlight-div"><div _ngcontent-had-c106="" class="highlight-div-header"><div _ngcontent-had-c106="" class="highlight-div-header-left"><div _ngcontent-had-c106="" class="handle-button expand-button"><div _ngcontent-had-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-had-c106="" class="highlight-div-header-right"><div _ngcontent-had-c106="" class="handle-button ai-button"></div><div _ngcontent-had-c106="" class="handle-button line-button"><div _ngcontent-had-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-had-c106="" class="handle-button theme-button"><div _ngcontent-had-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-had-c106="" class="handle-button copy-button"><div _ngcontent-had-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-had-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-function"><span class="hljs-type">int32_t</span> <span class="hljs-title">OH_NativeImage_ReleaseNativeWindowBuffer</span><span class="hljs-params">(OH_NativeImage* image,OHNativeWindowBuffer* nativeWindowBuffer, <span class="hljs-type">int</span> fenceFd)</span></span></li></ol></pre></div></div> <p><strong>描述</strong></p> <p>通过OH_NativeImage实例将OHNativeWindowBuffer归还到buffer队列中。</p> <p>系统会将fenceFd关闭，无需用户close。</p> <p>本接口为非线程安全类型接口。</p> <p><strong>系统能力：</strong> SystemCapability.Graphic.Graphic2D.NativeImage</p> <p><strong>起始版本：</strong> 12</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.21.10.1.3.1.1" width="50%">参数项</th> <th align="left" class="cellrowborder" id="mcps1.3.21.10.1.3.1.2" width="50%">描述</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-oh-nativeimage-oh-nativeimage">OH_NativeImage</a>* image</td> <td class="cellrowborder" width="50%">指向OH_NativeImage实例的指针。</td> </tr> <tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-nativewindow-nativewindowbuffer">OHNativeWindowBuffer</a>* nativeWindowBuffer</td> <td class="cellrowborder" width="50%">指向OHNativeWindowBuffer实例的指针。</td> </tr> <tr><td class="cellrowborder" width="50%">int fenceFd</td> <td class="cellrowborder" width="50%">指向文件描述符句柄, 用于并发同步控制。</td> </tr>  </tbody></table></div> </div> <p><strong>返回：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.21.12.1.3.1.1" width="50%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.21.12.1.3.1.2" width="50%">说明</th> </tr><tr><td class="cellrowborder" width="50%">int32_t</td> <td class="cellrowborder" width="50%"><p>执行成功时返回NATIVE_ERROR_OK。</p> <p> image, nativeWindowBuffer是空指针时返回NATIVE_ERROR_INVALID_ARGUMENTS。</p> <p> nativeWindowBuffer为状态非法时返回NATIVE_ERROR_BUFFER_STATE_INVALID。</p> <p> nativeWindowBuffer不在缓存中返回NATIVE_ERROR_BUFFER_NOT_IN_CACHE。</p> </td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h3 id="oh_consumersurface_create" device-type="phone,2in1,tablet,wearable,tv">OH_ConsumerSurface_Create()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="oh_consumersurface_create" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><div _ngcontent-had-c106="" class="highlight-div"><div _ngcontent-had-c106="" class="highlight-div-header"><div _ngcontent-had-c106="" class="highlight-div-header-left"><div _ngcontent-had-c106="" class="handle-button expand-button"><div _ngcontent-had-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-had-c106="" class="highlight-div-header-right"><div _ngcontent-had-c106="" class="handle-button ai-button"></div><div _ngcontent-had-c106="" class="handle-button line-button"><div _ngcontent-had-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-had-c106="" class="handle-button theme-button"><div _ngcontent-had-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-had-c106="" class="handle-button copy-button"><div _ngcontent-had-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-had-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-scss" data-highlighted="yes"><ol class="linenums"><li>OH_NativeImage* <span class="hljs-built_in">OH_ConsumerSurface_Create</span>(void)</li></ol></pre></div></div> <p><strong>描述</strong></p> <p>创建一个OH_NativeImage实例，作为surface的消费端。</p> <p>本接口仅用于surface消费端的内存轮转，创建的OH_NativeImage内部不会主动进行内存渲染处理。</p> <p>本接口不能与<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-native-image-h#oh_nativeimage_updatesurfaceimage">OH_NativeImage_UpdateSurfaceImage</a>接口同时使用。</p> <p>本接口与<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-native-image-h#oh_nativeimage_acquirenativewindowbuffer">OH_NativeImage_AcquireNativeWindowBuffer</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-native-image-h#oh_nativeimage_releasenativewindowbuffer">OH_NativeImage_ReleaseNativeWindowBuffer</a>配合使用。</p> <p>本接口需要和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-native-image-h#oh_nativeimage_destroy">OH_NativeImage_Destroy</a>接口配合使用，否则会存在内存泄露。</p> <p>本接口为非线程安全类型接口。</p> <p><strong>系统能力：</strong> SystemCapability.Graphic.Graphic2D.NativeImage</p> <p><strong>起始版本：</strong> 12</p> <p><strong>返回：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.22.13.1.3.1.1" width="50%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.22.13.1.3.1.2" width="50%">说明</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-oh-nativeimage-oh-nativeimage">OH_NativeImage</a>*</td> <td class="cellrowborder" width="50%">成功则返回一个指向OH_NativeImage实例的指针，否则返回NULL。</td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h3 id="oh_consumersurface_setdefaultusage" device-type="phone,2in1,tablet,wearable,tv">OH_ConsumerSurface_SetDefaultUsage()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="oh_consumersurface_setdefaultusage" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><div _ngcontent-had-c106="" class="highlight-div"><div _ngcontent-had-c106="" class="highlight-div-header"><div _ngcontent-had-c106="" class="highlight-div-header-left"><div _ngcontent-had-c106="" class="handle-button expand-button"><div _ngcontent-had-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-had-c106="" class="highlight-div-header-right"><div _ngcontent-had-c106="" class="handle-button ai-button"></div><div _ngcontent-had-c106="" class="handle-button line-button"><div _ngcontent-had-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-had-c106="" class="handle-button theme-button"><div _ngcontent-had-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-had-c106="" class="handle-button copy-button"><div _ngcontent-had-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-had-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-function"><span class="hljs-type">int32_t</span> <span class="hljs-title">OH_ConsumerSurface_SetDefaultUsage</span><span class="hljs-params">(OH_NativeImage* image, <span class="hljs-type">uint64_t</span> usage)</span></span></li></ol></pre></div></div> <p><strong>描述</strong></p> <p>设置默认读写方式。</p> <p>本接口为非线程安全类型接口。</p> <p><strong>系统能力：</strong> SystemCapability.Graphic.Graphic2D.NativeImage</p> <p><strong>起始版本：</strong> 13</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.23.9.1.3.1.1" width="50%">参数项</th> <th align="left" class="cellrowborder" id="mcps1.3.23.9.1.3.1.2" width="50%">描述</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-oh-nativeimage-oh-nativeimage">OH_NativeImage</a>* image</td> <td class="cellrowborder" width="50%">指向OH_NativeImage实例的指针。</td> </tr> <tr><td class="cellrowborder" width="50%">uint64_t usage</td> <td class="cellrowborder" width="50%">表示读写方式。枚举值参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-native-buffer-h#oh_nativebuffer_usage">OH_NativeBuffer_Usage</a>。</td> </tr>  </tbody></table></div> </div> <p><strong>返回：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.23.11.1.3.1.1" width="50%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.23.11.1.3.1.2" width="50%">说明</th> </tr><tr><td class="cellrowborder" width="50%">int32_t</td> <td class="cellrowborder" width="50%"><p>执行成功时返回NATIVE_ERROR_OK。</p> <p> image是空指针时返回NATIVE_ERROR_INVALID_ARGUMENTS。</p> </td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h3 id="oh_consumersurface_setdefaultsize" device-type="phone,2in1,tablet,wearable,tv">OH_ConsumerSurface_SetDefaultSize()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="oh_consumersurface_setdefaultsize" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><div _ngcontent-had-c106="" class="highlight-div"><div _ngcontent-had-c106="" class="highlight-div-header"><div _ngcontent-had-c106="" class="highlight-div-header-left"><div _ngcontent-had-c106="" class="handle-button expand-button"><div _ngcontent-had-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-had-c106="" class="highlight-div-header-right"><div _ngcontent-had-c106="" class="handle-button ai-button"></div><div _ngcontent-had-c106="" class="handle-button line-button"><div _ngcontent-had-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-had-c106="" class="handle-button theme-button"><div _ngcontent-had-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-had-c106="" class="handle-button copy-button"><div _ngcontent-had-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-had-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-function"><span class="hljs-type">int32_t</span> <span class="hljs-title">OH_ConsumerSurface_SetDefaultSize</span><span class="hljs-params">(OH_NativeImage* image, <span class="hljs-type">int32_t</span> width, <span class="hljs-type">int32_t</span> height)</span></span></li></ol></pre></div></div> <p><strong>描述</strong></p> <p>设置几何图形默认尺寸。</p> <p>本接口为非线程安全类型接口。</p> <p><strong>系统能力：</strong> SystemCapability.Graphic.Graphic2D.NativeImage</p> <p><strong>起始版本：</strong> 13</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.24.9.1.3.1.1" width="50%">参数项</th> <th align="left" class="cellrowborder" id="mcps1.3.24.9.1.3.1.2" width="50%">描述</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-oh-nativeimage-oh-nativeimage">OH_NativeImage</a>* image</td> <td class="cellrowborder" width="50%">指向OH_NativeImage实例的指针。</td> </tr> <tr><td class="cellrowborder" width="50%">int32_t width</td> <td class="cellrowborder" width="50%">表示几何图形宽度，取值范围大于0，单位为像素。</td> </tr> <tr><td class="cellrowborder" width="50%">int32_t height</td> <td class="cellrowborder" width="50%">表示几何图形高度，取值范围大于0，单位为像素。</td> </tr>  </tbody></table></div> </div> <p><strong>返回：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.24.11.1.3.1.1" width="50%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.24.11.1.3.1.2" width="50%">说明</th> </tr><tr><td class="cellrowborder" width="50%">int32_t</td> <td class="cellrowborder" width="50%"><p>执行成功时返回NATIVE_ERROR_OK。</p> <p> image是空指针时，或width、height小于等于0时返回NATIVE_ERROR_INVALID_ARGUMENTS。</p> </td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h3 id="oh_nativeimage_setdropbuffermode" device-type="phone,2in1,tablet,wearable,tv">OH_NativeImage_SetDropBufferMode()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="oh_nativeimage_setdropbuffermode" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><div _ngcontent-had-c106="" class="highlight-div"><div _ngcontent-had-c106="" class="highlight-div-header"><div _ngcontent-had-c106="" class="highlight-div-header-left"><div _ngcontent-had-c106="" class="handle-button expand-button"><div _ngcontent-had-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-had-c106="" class="highlight-div-header-right"><div _ngcontent-had-c106="" class="handle-button ai-button"></div><div _ngcontent-had-c106="" class="handle-button line-button"><div _ngcontent-had-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-had-c106="" class="handle-button theme-button"><div _ngcontent-had-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-had-c106="" class="handle-button copy-button"><div _ngcontent-had-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-had-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-function"><span class="hljs-type">int32_t</span> <span class="hljs-title">OH_NativeImage_SetDropBufferMode</span><span class="hljs-params">(OH_NativeImage* image, <span class="hljs-type">bool</span> isOpen)</span></span></li></ol></pre></div></div> <p><strong>描述</strong></p> <p>设置OH_NativeImage是否为渲染丢帧模式。</p> <p>处于此模式时，大部分生产端生产的buffer将会被丢弃，最新的buffer会及时上屏渲染。</p> <p>此模式不能同时保证帧率高的要求。</p> <p>此接口建议在<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-native-image-h#oh_nativeimage_create">OH_NativeImage_Create</a>接口调用后立即调用。</p> <p>此接口在与<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-native-image-h#oh_nativeimage_updatesurfaceimage">OH_NativeImage_UpdateSurfaceImage</a>接口一起使用的场景下才会生效。</p> <p>本接口为非线程安全类型接口。</p> <p>通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-native-image-h#oh_nativeimage_setonframeavailablelistener">OH_NativeImage_SetOnFrameAvailableListener</a>设置的listener回调不会因为设置了丢帧模式而减少。</p> <p><strong>系统能力：</strong> SystemCapability.Graphic.Graphic2D.NativeImage</p> <p><strong>起始版本：</strong> 17</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.25.14.1.3.1.1" width="50%">参数项</th> <th align="left" class="cellrowborder" id="mcps1.3.25.14.1.3.1.2" width="50%">描述</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-oh-nativeimage-oh-nativeimage">OH_NativeImage</a>* image</td> <td class="cellrowborder" width="50%">指向OH_NativeImage实例的指针。</td> </tr> <tr><td class="cellrowborder" width="50%">bool isOpen</td> <td class="cellrowborder" width="50%">是否设置渲染丢帧。true表示设置为渲染丢帧模式，false表示不设置。</td> </tr>  </tbody></table></div> </div> <p><strong>返回：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.25.16.1.3.1.1" width="50%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.25.16.1.3.1.2" width="50%">说明</th> </tr><tr><td class="cellrowborder" width="50%">int32_t</td> <td class="cellrowborder" width="50%"><p>执行成功时返回NATIVE_ERROR_OK。</p> <p> image是空指针时返回NATIVE_ERROR_INVALID_ARGUMENTS。</p> </td> </tr>  </tbody></table></div> </div> </div> </div> <div></div></div>