<h1 _ngcontent-edy-c119="" class="doc-title ng-star-inserted" title="neural_network_runtime.h"> neural_network_runtime.h </h1>

<div _ngcontent-edy-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div> <div class="tiledSection"><h2 id="概述" device-type="phone,2in1,tablet">概述<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="概述" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><p>Neural Network Runtime模块接口定义，AI推理框架使用Neural Network Runtime提供的Native接口，完成模型构建。</p> <p>Neural Network Runtime的接口目前均不支持多线程并发调用。</p> <p><strong>引用文件：</strong> &lt;neural_network_runtime/neural_network_runtime.h&gt;</p> <p><strong>库：</strong> libneural_network_runtime.so</p> <p><strong>系统能力：</strong> SystemCapability.AI.NeuralNetworkRuntime</p> <p><strong>起始版本：</strong> 9</p> <p><strong>相关模块：</strong> <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime">NeuralNetworkRuntime</a></p> </div>  <div class="tiledSection"><h2 id="汇总" device-type="phone,2in1,tablet">汇总<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="汇总" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div></div>  <div class="tiledSection"><h3 id="函数" device-type="phone,2in1,tablet" class="firsth2">函数<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="函数" tips="复制节点链接"></i></h3> <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.3.2.1.3.1.1" width="50%">名称</th> <th align="left" class="cellrowborder" id="mcps1.3.3.2.1.3.1.2" width="50%">描述</th> </tr><tr><td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnquantparam_create">NN_QuantParam *OH_NNQuantParam_Create()</a></td> <td class="cellrowborder" width="50%">创建一个<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-nn-quantparam">NN_QuantParam</a>量化参数实例。</td> </tr> <tr><td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnquantparam_setscales">OH_NN_ReturnCode OH_NNQuantParam_SetScales(NN_QuantParam *quantParams, const double *scales, size_t quantCount)</a></td> <td class="cellrowborder" width="50%"><p>设置<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-nn-quantparam">NN_QuantParam</a>的缩放系数。</p> <p>参数<strong>quantCount</strong>是张量中量化参数的数量，例如对于per-channel量化，<strong>quantCount</strong>就是通道数量。</p> </td> </tr> <tr><td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnquantparam_setzeropoints">OH_NN_ReturnCode OH_NNQuantParam_SetZeroPoints(NN_QuantParam *quantParams, const int32_t *zeroPoints, size_t quantCount)</a></td> <td class="cellrowborder" width="50%"><p>设置<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-nn-quantparam">NN_QuantParam</a>的零点。</p> <p>参数<strong>quantCount</strong>是张量中量化参数的数量，例如对于per-channel量化，<strong>quantCount</strong>就是通道数量。</p> </td> </tr> <tr><td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnquantparam_setnumbits">OH_NN_ReturnCode OH_NNQuantParam_SetNumBits(NN_QuantParam *quantParams, const uint32_t *numBits, size_t quantCount)</a></td> <td class="cellrowborder" width="50%"><p>设置<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-nn-quantparam">NN_QuantParam</a>的量化位数。</p> <p>参数<strong>quantCount</strong>是张量中量化参数的数量，例如对于per-channel量化，<strong>quantCount</strong>就是通道数量。</p> </td> </tr> <tr><td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnquantparam_destroy">OH_NN_ReturnCode OH_NNQuantParam_Destroy(NN_QuantParam **quantParams)</a></td> <td class="cellrowborder" width="50%"><p>销毁<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-nn-quantparam">NN_QuantParam</a>实例。 </p> <p>当设置<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-nn-quantparam">NN_QuantParam</a>实例到一个<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-nn-tensor">NN_Tensor</a>中后，如果不再使用该实例，需要销毁它以避免内存泄漏。 </p> <p>如果<strong>quantParams</strong>或<strong>*quantParams</strong>是空指针，那么该接口仅打印警告日志，不会执行销毁操作。</p> </td> </tr> <tr><td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnmodel_construct">OH_NNModel *OH_NNModel_Construct(void)</a></td> <td class="cellrowborder" width="50%">创建<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nnmodel">OH_NNModel</a>类型的模型实例，搭配OH_NNModel模块提供的其他接口，完成模型实例的构造。</td> </tr> <tr><td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnmodel_addtensortomodel">OH_NN_ReturnCode OH_NNModel_AddTensorToModel(OH_NNModel *model, const NN_TensorDesc *tensorDesc)</a></td> <td class="cellrowborder" width="50%"><p>向模型实例中添加张量。</p> <p>Neural Network Runtime模型中的数据节点和算子参数均由模型的张量构成。</p> </td> </tr> <tr><td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnmodel_settensordata">OH_NN_ReturnCode OH_NNModel_SetTensorData(OH_NNModel *model, uint32_t index, const void *dataBuffer, size_t length)</a></td> <td class="cellrowborder" width="50%">设置张量的数值。 对于具有常量值的张量（如模型的权重），需要在构图阶段使用该接口设置数值。张量的索引值根据张量添加进模型的顺序决定，张量的添加参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnmodel_addtensortomodel">OH_NNModel_AddTensorToModel</a>。</td> </tr> <tr><td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnmodel_settensorquantparams">OH_NN_ReturnCode OH_NNModel_SetTensorQuantParams(OH_NNModel *model, uint32_t index, NN_QuantParam *quantParam)</a></td> <td class="cellrowborder" width="50%">设置张量的量化参数，参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-nn-quantparam">NN_QuantParam</a>。</td> </tr> <tr><td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnmodel_settensortype">OH_NN_ReturnCode OH_NNModel_SetTensorType(OH_NNModel *model, uint32_t index, OH_NN_TensorType tensorType)</a></td> <td class="cellrowborder" width="50%">设置张量的类型，参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-type-h#oh_nn_tensortype">OH_NN_TensorType</a>。</td> </tr> <tr><td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnmodel_addoperation">OH_NN_ReturnCode OH_NNModel_AddOperation(OH_NNModel *model,OH_NN_OperationType op,const OH_NN_UInt32Array *paramIndices,const OH_NN_UInt32Array *inputIndices,const OH_NN_UInt32Array *outputIndices)</a></td> <td class="cellrowborder" width="50%">向模型实例中添加算子。</td> </tr> <tr><td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnmodel_specifyinputsandoutputs">OH_NN_ReturnCode OH_NNModel_SpecifyInputsAndOutputs(OH_NNModel *model,const OH_NN_UInt32Array *inputIndices,const OH_NN_UInt32Array *outputIndices)</a></td> <td class="cellrowborder" width="50%">指定模型的输入和输出张量的索引值。模型实例需要指定张量作为端到端的输入和输出张量。</td> </tr> <tr><td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnmodel_finish">OH_NN_ReturnCode OH_NNModel_Finish(OH_NNModel *model)</a></td> <td class="cellrowborder" width="50%">完成模型构图。完成模型拓扑结构的搭建后，调用该接口指示构图已完成。</td> </tr> <tr><td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnmodel_destroy">void OH_NNModel_Destroy(OH_NNModel **model)</a></td> <td class="cellrowborder" width="50%">销毁模型实例。调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnmodel_construct">OH_NNModel_Construct</a>创建的模型实例需要调用该接口主动销毁，否则将造成内存泄漏。 如果model为空指针或者*model为空指针，该接口仅打印警告日志，不执行销毁操作。</td> </tr> <tr><td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnmodel_getavailableoperations">OH_NN_ReturnCode OH_NNModel_GetAvailableOperations(OH_NNModel *model,size_t deviceID,const bool **isSupported,uint32_t *opCount)</a></td> <td class="cellrowborder" width="50%">查询硬件对模型内所有算子的支持情况，通过布尔值序列指示支持情况。</td> </tr> <tr><td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnmodel_addtensor">OH_NN_ReturnCode OH_NNModel_AddTensor(OH_NNModel *model, const OH_NN_Tensor *tensor)</a></td> <td class="cellrowborder" width="50%"><p>向模型实例中添加张量。</p> <p>Neural Network Runtime模型中的数据节点和算子参数均由模型的张量构成，该接口根据tensor，向model实例中添加张量。</p> </td> </tr> <tr><td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnexecutor_setinput">OH_NN_ReturnCode OH_NNExecutor_SetInput(OH_NNExecutor *executor,uint32_t inputIndex,const OH_NN_Tensor *tensor,const void *dataBuffer,size_t length)</a></td> <td class="cellrowborder" width="50%">设置模型单个输入的数据。该接口将dataBuffer中，长度为length个字节的数据，拷贝到底层硬件的共享内存。</td> </tr> <tr><td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnexecutor_setoutput">OH_NN_ReturnCode OH_NNExecutor_SetOutput(OH_NNExecutor *executor,uint32_t outputIndex,void *dataBuffer,size_t length)</a></td> <td class="cellrowborder" width="50%"><p>设置模型单个输出的内存。</p> <p>该接口将dataBuffer指向的内存与outputIndex指定的输出绑定，内存的长度由length指定。</p> </td> </tr> <tr><td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnexecutor_run">OH_NN_ReturnCode OH_NNExecutor_Run(OH_NNExecutor *executor)</a></td> <td class="cellrowborder" width="50%">执行推理。 在执行器关联的硬件上，执行模型的端到端推理计算。</td> </tr> <tr><td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnexecutor_allocateinputmemory">OH_NN_Memory *OH_NNExecutor_AllocateInputMemory(OH_NNExecutor *executor, uint32_t inputIndex, size_t length)</a></td> <td class="cellrowborder" width="50%">在硬件上为单个输入申请共享内存。</td> </tr> <tr><td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnexecutor_allocateoutputmemory">OH_NN_Memory *OH_NNExecutor_AllocateOutputMemory(OH_NNExecutor *executor, uint32_t outputIndex, size_t length)</a></td> <td class="cellrowborder" width="50%">在硬件上为单个输出申请共享内存。</td> </tr> <tr><td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnexecutor_destroyinputmemory">void OH_NNExecutor_DestroyInputMemory(OH_NNExecutor *executor, uint32_t inputIndex, OH_NN_Memory **memory)</a></td> <td class="cellrowborder" width="50%">释放<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nn-memory">OH_NN_Memory</a>实例指向的输入内存。 调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnexecutor_allocateinputmemory">OH_NNExecutor_AllocateInputMemory</a>创建的内存实例，需要主动调用该接口进行释放，否则将造成内存泄漏。</td> </tr> <tr><td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnexecutor_destroyoutputmemory">void OH_NNExecutor_DestroyOutputMemory(OH_NNExecutor *executor, uint32_t outputIndex, OH_NN_Memory **memory)</a></td> <td class="cellrowborder" width="50%">释放<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nn-memory">OH_NN_Memory</a>实例指向的输出内存。 调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnexecutor_allocateoutputmemory">OH_NNExecutor_AllocateOutputMemory</a>创建的内存实例，需要主动调用该接口进行释放，否则将造成内存泄漏。outputIndex和memory的对应关系需要和创建内存实例时保持一致。 如果memory或*memory为空指针，该接口仅打印警告日志，不执行释放操作。</td> </tr> <tr><td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnexecutor_setinputwithmemory">OH_NN_ReturnCode OH_NNExecutor_SetInputWithMemory(OH_NNExecutor *executor,uint32_t inputIndex,const OH_NN_Tensor *tensor,const OH_NN_Memory *memory)</a></td> <td class="cellrowborder" width="50%">将<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nn-memory">OH_NN_Memory</a>实例指向的硬件共享内存，并指定为单个输入使用的内存。</td> </tr> <tr><td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnexecutor_setoutputwithmemory">OH_NN_ReturnCode OH_NNExecutor_SetOutputWithMemory(OH_NNExecutor *executor,uint32_t outputIndex,const OH_NN_Memory *memory)</a></td> <td class="cellrowborder" width="50%">将<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nn-memory">OH_NN_Memory</a>实例指向的硬件共享内存，并指定为单个输出使用的内存。</td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h2 id="函数说明" device-type="phone,2in1,tablet">函数说明<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="函数说明" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div></div>  <div class="tiledSection"><h3 id="oh_nnquantparam_create" device-type="phone,2in1,tablet" class="firsth2">OH_NNQuantParam_Create()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="oh_nnquantparam_create" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><div _ngcontent-edy-c106="" class="highlight-div"><div _ngcontent-edy-c106="" class="highlight-div-header"><div _ngcontent-edy-c106="" class="highlight-div-header-left"><div _ngcontent-edy-c106="" class="handle-button expand-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-edy-c106="" class="highlight-div-header-right"><div _ngcontent-edy-c106="" class="handle-button ai-button"></div><div _ngcontent-edy-c106="" class="handle-button line-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-edy-c106="" class="handle-button theme-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-edy-c106="" class="handle-button copy-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-edy-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-scss" data-highlighted="yes"><ol class="linenums"><li>NN_QuantParam *<span class="hljs-built_in">OH_NNQuantParam_Create</span>()</li></ol></pre></div></div> <p><strong>描述</strong></p> <p>创建一个<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-nn-quantparam">NN_QuantParam</a>量化参数实例。</p> <p>创建<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-nn-quantparam">NN_QuantParam</a>量化参数实例后，调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnquantparam_setscales">OH_NNQuantParam_SetScales</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnquantparam_setzeropoints">OH_NNQuantParam_SetZeroPoints</a>或<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnquantparam_setnumbits">OH_NNQuantParam_SetNumBits</a>设置它的属性值，并调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnmodel_settensorquantparams">OH_NNModel_SetTensorQuantParams</a>将它设置到<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-nn-tensor">NN_Tensor</a>中。最后再调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnquantparam_destroy">OH_NNQuantParam_Destroy</a>销毁它，以避免内存泄露。</p> <p><strong>起始版本：</strong> 11</p> <p><strong>返回：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.5.8.1.3.1.1" width="50%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.5.8.1.3.1.2" width="50%">说明</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-nn-quantparam">NN_QuantParam</a> *</td> <td class="cellrowborder" width="50%">指向<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-nn-quantparam">NN_QuantParam</a>实例的指针，如果创建失败就返回NULL。</td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h3 id="oh_nnquantparam_setscales" device-type="phone,2in1,tablet">OH_NNQuantParam_SetScales()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="oh_nnquantparam_setscales" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><div _ngcontent-edy-c106="" class="highlight-div"><div _ngcontent-edy-c106="" class="highlight-div-header"><div _ngcontent-edy-c106="" class="highlight-div-header-left"><div _ngcontent-edy-c106="" class="handle-button expand-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-edy-c106="" class="highlight-div-header-right"><div _ngcontent-edy-c106="" class="handle-button ai-button"></div><div _ngcontent-edy-c106="" class="handle-button line-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-edy-c106="" class="handle-button theme-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-edy-c106="" class="handle-button copy-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-edy-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-function">OH_NN_ReturnCode <span class="hljs-title">OH_NNQuantParam_SetScales</span><span class="hljs-params">(NN_QuantParam *quantParams, <span class="hljs-type">const</span> <span class="hljs-type">double</span> *scales, <span class="hljs-type">size_t</span> quantCount)</span></span></li></ol></pre></div></div> <p><strong>描述</strong></p> <p>设置<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-nn-quantparam">NN_QuantParam</a>的缩放系数。</p> <p>参数<strong>quantCount</strong>是张量中量化参数的数量，例如对于per-channel量化，<strong>quantCount</strong>就是通道数量。</p> <p><strong>起始版本：</strong> 11</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.6.8.1.3.1.1" width="50%">参数项</th> <th align="left" class="cellrowborder" id="mcps1.3.6.8.1.3.1.2" width="50%">描述</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-nn-quantparam">NN_QuantParam</a> *quantParams</td> <td class="cellrowborder" width="50%">指向<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-nn-quantparam">NN_QuantParam</a>实例的指针。</td> </tr> <tr><td class="cellrowborder" width="50%">const double *scales</td> <td class="cellrowborder" width="50%">张量中所有量化参数的缩放系数构成的数组。</td> </tr> <tr><td class="cellrowborder" width="50%">size_t quantCount</td> <td class="cellrowborder" width="50%">张量中量化参数的数量。</td> </tr>  </tbody></table></div> </div> <p><strong>返回：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.6.10.1.3.1.1" width="50%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.6.10.1.3.1.2" width="50%">说明</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-type-h#oh_nn_returncode">OH_NN_ReturnCode</a></td> <td class="cellrowborder" width="50%">函数执行的结果状态。执行成功返回OH_NN_SUCCESS；失败返回具体错误码，具体失败错误码可参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-type-h#oh_nn_returncode">OH_NN_ReturnCode</a>。</td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h3 id="oh_nnquantparam_setzeropoints" device-type="phone,2in1,tablet">OH_NNQuantParam_SetZeroPoints()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="oh_nnquantparam_setzeropoints" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><div _ngcontent-edy-c106="" class="highlight-div"><div _ngcontent-edy-c106="" class="highlight-div-header"><div _ngcontent-edy-c106="" class="highlight-div-header-left"><div _ngcontent-edy-c106="" class="handle-button expand-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-edy-c106="" class="highlight-div-header-right"><div _ngcontent-edy-c106="" class="handle-button ai-button"></div><div _ngcontent-edy-c106="" class="handle-button line-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-edy-c106="" class="handle-button theme-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-edy-c106="" class="handle-button copy-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-edy-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-function">OH_NN_ReturnCode <span class="hljs-title">OH_NNQuantParam_SetZeroPoints</span><span class="hljs-params">(NN_QuantParam *quantParams, <span class="hljs-type">const</span> <span class="hljs-type">int32_t</span> *zeroPoints, <span class="hljs-type">size_t</span> quantCount)</span></span></li></ol></pre></div></div> <p><strong>描述</strong></p> <p>设置<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-nn-quantparam">NN_QuantParam</a>的零点。</p> <p>参数<strong>quantCount</strong>是张量中量化参数的数量，例如对于per-channel量化，<strong>quantCount</strong>就是通道数量。</p> <p><strong>起始版本：</strong> 11</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.7.8.1.3.1.1" width="50%">参数项</th> <th align="left" class="cellrowborder" id="mcps1.3.7.8.1.3.1.2" width="50%">描述</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-nn-quantparam">NN_QuantParam</a> *quantParams</td> <td class="cellrowborder" width="50%">指向<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-nn-quantparam">NN_QuantParam</a>实例的指针。</td> </tr> <tr><td class="cellrowborder" width="50%">const int32_t *zeroPoints</td> <td class="cellrowborder" width="50%">张量中所有量化参数的零点构成的数组。</td> </tr> <tr><td class="cellrowborder" width="50%">size_t quantCount</td> <td class="cellrowborder" width="50%">张量中量化参数的数量。</td> </tr>  </tbody></table></div> </div> <p><strong>返回：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.7.10.1.3.1.1" width="50%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.7.10.1.3.1.2" width="50%">说明</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-type-h#oh_nn_returncode">OH_NN_ReturnCode</a></td> <td class="cellrowborder" width="50%">函数执行的结果状态。执行成功返回OH_NN_SUCCESS；失败返回具体错误码，具体失败错误码可参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-type-h#oh_nn_returncode">OH_NN_ReturnCode</a>。</td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h3 id="oh_nnquantparam_setnumbits" device-type="phone,2in1,tablet">OH_NNQuantParam_SetNumBits()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="oh_nnquantparam_setnumbits" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><div _ngcontent-edy-c106="" class="highlight-div"><div _ngcontent-edy-c106="" class="highlight-div-header"><div _ngcontent-edy-c106="" class="highlight-div-header-left"><div _ngcontent-edy-c106="" class="handle-button expand-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-edy-c106="" class="highlight-div-header-right"><div _ngcontent-edy-c106="" class="handle-button ai-button"></div><div _ngcontent-edy-c106="" class="handle-button line-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-edy-c106="" class="handle-button theme-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-edy-c106="" class="handle-button copy-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-edy-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-function">OH_NN_ReturnCode <span class="hljs-title">OH_NNQuantParam_SetNumBits</span><span class="hljs-params">(NN_QuantParam *quantParams, <span class="hljs-type">const</span> <span class="hljs-type">uint32_t</span> *numBits, <span class="hljs-type">size_t</span> quantCount)</span></span></li></ol></pre></div></div> <p><strong>描述</strong></p> <p>设置<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-nn-quantparam">NN_QuantParam</a>的量化位数。</p> <p>参数<strong>quantCount</strong>是张量中量化参数的数量，例如对于per-channel量化，<strong>quantCount</strong>就是通道数量。</p> <p><strong>起始版本：</strong> 11</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.8.8.1.3.1.1" width="50%">参数项</th> <th align="left" class="cellrowborder" id="mcps1.3.8.8.1.3.1.2" width="50%">描述</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-nn-quantparam">NN_QuantParam</a> *quantParams</td> <td class="cellrowborder" width="50%">指向<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-nn-quantparam">NN_QuantParam</a>实例的指针。</td> </tr> <tr><td class="cellrowborder" width="50%">const uint32_t *numBits</td> <td class="cellrowborder" width="50%">张量中所有量化参数的量化位数构成的数组。</td> </tr> <tr><td class="cellrowborder" width="50%">size_t quantCount</td> <td class="cellrowborder" width="50%">张量中量化参数的数量。</td> </tr>  </tbody></table></div> </div> <p><strong>返回：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.8.10.1.3.1.1" width="50%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.8.10.1.3.1.2" width="50%">说明</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-type-h#oh_nn_returncode">OH_NN_ReturnCode</a></td> <td class="cellrowborder" width="50%">函数执行的结果状态。执行成功返回OH_NN_SUCCESS；失败返回具体错误码，具体失败错误码可参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-type-h#oh_nn_returncode">OH_NN_ReturnCode</a>。</td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h3 id="oh_nnquantparam_destroy" device-type="phone,2in1,tablet">OH_NNQuantParam_Destroy()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="oh_nnquantparam_destroy" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><div _ngcontent-edy-c106="" class="highlight-div"><div _ngcontent-edy-c106="" class="highlight-div-header"><div _ngcontent-edy-c106="" class="highlight-div-header-left"><div _ngcontent-edy-c106="" class="handle-button expand-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-edy-c106="" class="highlight-div-header-right"><div _ngcontent-edy-c106="" class="handle-button ai-button"></div><div _ngcontent-edy-c106="" class="handle-button line-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-edy-c106="" class="handle-button theme-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-edy-c106="" class="handle-button copy-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-edy-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-scss" data-highlighted="yes"><ol class="linenums"><li>OH_NN_ReturnCode <span class="hljs-built_in">OH_NNQuantParam_Destroy</span>(NN_QuantParam **quantParams)</li></ol></pre></div></div> <p><strong>描述</strong></p> <p>销毁<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-nn-quantparam">NN_QuantParam</a>实例。</p> <p>当设置<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-nn-quantparam">NN_QuantParam</a>实例到一个<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-nn-tensor">NN_Tensor</a>中后，如果不再使用该实例，需要销毁它以避免内存泄漏。 </p> <p>如果<strong>quantParams</strong>或<strong>*quantParams</strong>是空指针，那么该接口仅打印警告日志，不会执行销毁操作。</p> <p><strong>起始版本：</strong> 11</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.9.9.1.3.1.1" width="50%">参数项</th> <th align="left" class="cellrowborder" id="mcps1.3.9.9.1.3.1.2" width="50%">描述</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-nn-quantparam">NN_QuantParam</a> **quantParams</td> <td class="cellrowborder" width="50%">指向<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-nn-quantparam">NN_QuantParam</a>实例的二级指针。</td> </tr>  </tbody></table></div> </div> <p><strong>返回：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.9.11.1.3.1.1" width="50%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.9.11.1.3.1.2" width="50%">说明</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-type-h#oh_nn_returncode">OH_NN_ReturnCode</a></td> <td class="cellrowborder" width="50%">函数执行的结果状态。执行成功返回OH_NN_SUCCESS；失败返回具体错误码，具体失败错误码可参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-type-h#oh_nn_returncode">OH_NN_ReturnCode</a>。</td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h3 id="oh_nnmodel_construct" device-type="phone,2in1,tablet">OH_NNModel_Construct()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="oh_nnmodel_construct" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><div _ngcontent-edy-c106="" class="highlight-div"><div _ngcontent-edy-c106="" class="highlight-div-header"><div _ngcontent-edy-c106="" class="highlight-div-header-left"><div _ngcontent-edy-c106="" class="handle-button expand-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-edy-c106="" class="highlight-div-header-right"><div _ngcontent-edy-c106="" class="handle-button ai-button"></div><div _ngcontent-edy-c106="" class="handle-button line-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-edy-c106="" class="handle-button theme-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-edy-c106="" class="handle-button copy-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-edy-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-scss" data-highlighted="yes"><ol class="linenums"><li>OH_NNModel *<span class="hljs-built_in">OH_NNModel_Construct</span>(void)</li></ol></pre></div></div> <p><strong>描述</strong></p> <p>创建<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nnmodel">OH_NNModel</a>类型的模型实例，搭配OH_NNModel模块提供的其他接口，完成模型实例的构造。</p> <p>在开始构图前，先调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnmodel_construct">OH_NNModel_Construct</a>创建模型实例，根据模型的拓扑结构，调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnmodel_addtensortomodel">OH_NNModel_AddTensorToModel</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnmodel_addoperation">OH_NNModel_AddOperation</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnmodel_settensordata">OH_NNModel_SetTensorData</a>方法，填充模型的数据节点和算子节点；然后调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnmodel_specifyinputsandoutputs">OH_NNModel_SpecifyInputsAndOutputs</a>指定模型的输入和输出；当构造完模型的拓扑结构，调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnmodel_finish">OH_NNModel_Finish</a>完成模型的构建。</p> <p>模型实例使用完毕后，需要调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnmodel_destroy">OH_NNModel_Destroy</a>销毁模型实例，避免内存泄漏。</p> <p><strong>起始版本：</strong> 9</p> <p><strong>返回：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.10.9.1.3.1.1" width="50%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.10.9.1.3.1.2" width="50%">说明</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nnmodel">OH_NNModel</a> *</td> <td class="cellrowborder" width="50%">返回一个指向<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nnmodel">OH_NNModel</a>实例的指针，如果创建失败就返回NULL。</td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h3 id="oh_nnmodel_addtensortomodel" device-type="phone,2in1,tablet">OH_NNModel_AddTensorToModel()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="oh_nnmodel_addtensortomodel" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><div _ngcontent-edy-c106="" class="highlight-div"><div _ngcontent-edy-c106="" class="highlight-div-header"><div _ngcontent-edy-c106="" class="highlight-div-header-left"><div _ngcontent-edy-c106="" class="handle-button expand-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-edy-c106="" class="highlight-div-header-right"><div _ngcontent-edy-c106="" class="handle-button ai-button"></div><div _ngcontent-edy-c106="" class="handle-button line-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-edy-c106="" class="handle-button theme-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-edy-c106="" class="handle-button copy-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-edy-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-scss" data-highlighted="yes"><ol class="linenums"><li>OH_NN_ReturnCode <span class="hljs-built_in">OH_NNModel_AddTensorToModel</span>(OH_NNModel *model, const NN_TensorDesc *tensorDesc)</li></ol></pre></div></div> <p><strong>描述</strong></p> <p>向模型实例中添加张量。</p> <p>Neural Network Runtime模型中的数据节点和算子参数均由模型的张量构成。</p> <p>该接口根据<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-nn-tensordesc">NN_TensorDesc</a>向model实例中添加张量，张量添加的顺序是模型中记录张量的索引值。<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnmodel_settensordata">OH_NNModel_SetTensorData</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnmodel_addoperation">OH_NNModel_AddOperation</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnmodel_specifyinputsandoutputs">OH_NNModel_SpecifyInputsAndOutputs</a>接口根据该索引值，指定不同的张量。</p> <p>Neural Network Runtime支持动态形状的输入和输出张量。在添加动态形状的数据节点时，需要将tensor.dimensions中支持动态变化的维度设置为-1。例如可将一个四维tensor的dimensions设置为[1, -1, 2, 2]，表示其第二个维度支持动态变化。</p> <p><strong>起始版本：</strong> 11</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.11.10.1.3.1.1" width="50%">参数项</th> <th align="left" class="cellrowborder" id="mcps1.3.11.10.1.3.1.2" width="50%">描述</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nnmodel">OH_NNModel</a> *model</td> <td class="cellrowborder" width="50%">指向<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nnmodel">OH_NNModel</a>实例的指针。</td> </tr> <tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-nn-tensordesc">const NN_TensorDesc</a> *tensorDesc</td> <td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-nn-tensordesc">NN_TensorDesc</a>张量的指针，<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-nn-tensordesc">NN_TensorDesc</a>指定了添加到模型实例中张量的属性。</td> </tr>  </tbody></table></div> </div> <p><strong>返回：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.11.12.1.3.1.1" width="50%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.11.12.1.3.1.2" width="50%">说明</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-type-h#oh_nn_returncode">OH_NN_ReturnCode</a></td> <td class="cellrowborder" width="50%">函数执行的结果状态。执行成功返回OH_NN_SUCCESS；失败返回具体错误码，具体失败错误码可参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-type-h#oh_nn_returncode">OH_NN_ReturnCode</a>。</td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h3 id="oh_nnmodel_settensordata" device-type="phone,2in1,tablet">OH_NNModel_SetTensorData()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="oh_nnmodel_settensordata" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><div _ngcontent-edy-c106="" class="highlight-div"><div _ngcontent-edy-c106="" class="highlight-div-header"><div _ngcontent-edy-c106="" class="highlight-div-header-left"><div _ngcontent-edy-c106="" class="handle-button expand-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-edy-c106="" class="highlight-div-header-right"><div _ngcontent-edy-c106="" class="handle-button ai-button"></div><div _ngcontent-edy-c106="" class="handle-button line-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-edy-c106="" class="handle-button theme-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-edy-c106="" class="handle-button copy-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-edy-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-function">OH_NN_ReturnCode <span class="hljs-title">OH_NNModel_SetTensorData</span><span class="hljs-params">(OH_NNModel *model, <span class="hljs-type">uint32_t</span> index, <span class="hljs-type">const</span> <span class="hljs-type">void</span> *dataBuffer, <span class="hljs-type">size_t</span> length)</span></span></li></ol></pre></div></div> <p><strong>描述</strong></p> <p>设置张量的数值。 对于具有常量值的张量（如模型的权重），需要在构图阶段使用该接口设置数值。</p> <p>张量的索引值根据张量添加进模型的顺序决定，张量的添加参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnmodel_addtensortomodel">OH_NNModel_AddTensorToModel</a>。</p> <p><strong>起始版本：</strong> 9</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.12.8.1.3.1.1" width="50%">参数项</th> <th align="left" class="cellrowborder" id="mcps1.3.12.8.1.3.1.2" width="50%">描述</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nnmodel">OH_NNModel</a> *model</td> <td class="cellrowborder" width="50%">指向<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nnmodel">OH_NNModel</a>实例的指针。</td> </tr> <tr><td class="cellrowborder" width="50%">uint32_t index</td> <td class="cellrowborder" width="50%">张量的索引值。</td> </tr> <tr><td class="cellrowborder" width="50%">const void *dataBuffer</td> <td class="cellrowborder" width="50%">指向真实数据内存的指针。</td> </tr> <tr><td class="cellrowborder" width="50%">size_t length</td> <td class="cellrowborder" width="50%">数据内存的长度。</td> </tr>  </tbody></table></div> </div> <p><strong>返回：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.12.10.1.3.1.1" width="50%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.12.10.1.3.1.2" width="50%">说明</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-type-h#oh_nn_returncode">OH_NN_ReturnCode</a></td> <td class="cellrowborder" width="50%">函数执行的结果状态。执行成功返回OH_NN_SUCCESS；失败返回具体错误码，具体失败错误码可参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-type-h#oh_nn_returncode">OH_NN_ReturnCode</a>。</td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h3 id="oh_nnmodel_settensorquantparams" device-type="phone,2in1,tablet">OH_NNModel_SetTensorQuantParams()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="oh_nnmodel_settensorquantparams" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><div _ngcontent-edy-c106="" class="highlight-div"><div _ngcontent-edy-c106="" class="highlight-div-header"><div _ngcontent-edy-c106="" class="highlight-div-header-left"><div _ngcontent-edy-c106="" class="handle-button expand-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-edy-c106="" class="highlight-div-header-right"><div _ngcontent-edy-c106="" class="handle-button ai-button"></div><div _ngcontent-edy-c106="" class="handle-button line-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-edy-c106="" class="handle-button theme-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-edy-c106="" class="handle-button copy-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-edy-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-scss" data-highlighted="yes"><ol class="linenums"><li>OH_NN_ReturnCode <span class="hljs-built_in">OH_NNModel_SetTensorQuantParams</span>(OH_NNModel *model, uint32_t index, NN_QuantParam *quantParam)</li></ol></pre></div></div> <p><strong>描述</strong></p> <p>设置张量的量化参数，参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-nn-quantparam">NN_QuantParam</a>。</p> <p><strong>起始版本：</strong> 11</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.13.7.1.3.1.1" width="50%">参数项</th> <th align="left" class="cellrowborder" id="mcps1.3.13.7.1.3.1.2" width="50%">描述</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nnmodel">OH_NNModel</a> *model</td> <td class="cellrowborder" width="50%">指向<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nnmodel">OH_NNModel</a>实例的指针。</td> </tr> <tr><td class="cellrowborder" width="50%">uint32_t index</td> <td class="cellrowborder" width="50%">张量的索引值。</td> </tr> <tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-nn-quantparam">NN_QuantParam</a> *quantParam</td> <td class="cellrowborder" width="50%">指向<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-nn-quantparam">NN_QuantParam</a>的指针。</td> </tr>  </tbody></table></div> </div> <p><strong>返回：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.13.9.1.3.1.1" width="50%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.13.9.1.3.1.2" width="50%">说明</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-type-h#oh_nn_returncode">OH_NN_ReturnCode</a></td> <td class="cellrowborder" width="50%">函数执行的结果状态。执行成功返回OH_NN_SUCCESS；失败返回具体错误码，具体失败错误码可参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-type-h#oh_nn_returncode">OH_NN_ReturnCode</a>。</td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h3 id="oh_nnmodel_settensortype" device-type="phone,2in1,tablet">OH_NNModel_SetTensorType()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="oh_nnmodel_settensortype" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><div _ngcontent-edy-c106="" class="highlight-div"><div _ngcontent-edy-c106="" class="highlight-div-header"><div _ngcontent-edy-c106="" class="highlight-div-header-left"><div _ngcontent-edy-c106="" class="handle-button expand-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-edy-c106="" class="highlight-div-header-right"><div _ngcontent-edy-c106="" class="handle-button ai-button"></div><div _ngcontent-edy-c106="" class="handle-button line-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-edy-c106="" class="handle-button theme-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-edy-c106="" class="handle-button copy-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-edy-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-scss" data-highlighted="yes"><ol class="linenums"><li>OH_NN_ReturnCode <span class="hljs-built_in">OH_NNModel_SetTensorType</span>(OH_NNModel *model, uint32_t index, OH_NN_TensorType tensorType)</li></ol></pre></div></div> <p><strong>描述</strong></p> <p>设置张量的类型，参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-type-h#oh_nn_tensortype">OH_NN_TensorType</a>。</p> <p><strong>起始版本：</strong> 11</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.14.7.1.3.1.1" width="50%">参数项</th> <th align="left" class="cellrowborder" id="mcps1.3.14.7.1.3.1.2" width="50%">描述</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nnmodel">OH_NNModel</a> *model</td> <td class="cellrowborder" width="50%">指向<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nnmodel">OH_NNModel</a>实例的指针。</td> </tr> <tr><td class="cellrowborder" width="50%">uint32_t index</td> <td class="cellrowborder" width="50%">张量的索引值。</td> </tr> <tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-type-h#oh_nn_tensortype">OH_NN_TensorType</a> tensorType</td> <td class="cellrowborder" width="50%">张量类型。</td> </tr>  </tbody></table></div> </div> <p><strong>返回：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.14.9.1.3.1.1" width="50%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.14.9.1.3.1.2" width="50%">说明</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-type-h#oh_nn_returncode">OH_NN_ReturnCode</a></td> <td class="cellrowborder" width="50%">函数执行的结果状态。执行成功返回OH_NN_SUCCESS；失败返回具体错误码，具体失败错误码可参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-type-h#oh_nn_returncode">OH_NN_ReturnCode</a></td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h3 id="oh_nnmodel_addoperation" device-type="phone,2in1,tablet">OH_NNModel_AddOperation()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="oh_nnmodel_addoperation" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><div _ngcontent-edy-c106="" class="highlight-div"><div _ngcontent-edy-c106="" class="highlight-div-header"><div _ngcontent-edy-c106="" class="highlight-div-header-left"><div _ngcontent-edy-c106="" class="handle-button expand-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-edy-c106="" class="highlight-div-header-right"><div _ngcontent-edy-c106="" class="handle-button ai-button"></div><div _ngcontent-edy-c106="" class="handle-button line-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-edy-c106="" class="handle-button theme-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-edy-c106="" class="handle-button copy-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-edy-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-function">OH_NN_ReturnCode <span class="hljs-title">OH_NNModel_AddOperation</span><span class="hljs-params">(OH_NNModel *model,OH_NN_OperationType op,<span class="hljs-type">const</span> OH_NN_UInt32Array *paramIndices,<span class="hljs-type">const</span> OH_NN_UInt32Array *inputIndices,<span class="hljs-type">const</span> OH_NN_UInt32Array *outputIndices)</span></span></li></ol></pre></div></div> <p><strong>描述</strong></p> <p>向模型实例中添加算子。</p> <p>该接口向模型实例中添加算子，算子类型由op指定，算子的参数、输入和输出由paramIndices、inputIndices和outputIndices指定。</p> <p>该接口将对算子参数的属性和输入、输出张量的数量进行校验，这些属性需要在调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnmodel_addtensortomodel">OH_NNModel_AddTensorToModel</a>添加张量时正确设置。</p> <p>每个算子期望的参数、输入和输出属性请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-type-h#oh_nn_operationtype">OH_NN_OperationType</a>。</p> <p>paramIndices、inputIndices和outputIndices中存储的是张量的索引值，每个索引值根据张量添加进模型的顺序决定，正确设置并添加算子要求准确设置每个张量的索引值。</p> <p>张量的添加参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnmodel_addtensortomodel">OH_NNModel_AddTensorToModel</a>。</p> <p>如果添加算子时，添加了额外的参数（非算子需要的参数），该接口返回<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-type-h#oh_nn_returncode">OH_NN_INVALID_PARAMETER</a>；如果没有设置算子参数，则算子按默认值设置缺省的参数，默认值请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-type-h#oh_nn_operationtype">OH_NN_OperationType</a>。</p> <p><strong>起始版本：</strong> 9</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.15.13.1.3.1.1" width="50%">参数项</th> <th align="left" class="cellrowborder" id="mcps1.3.15.13.1.3.1.2" width="50%">描述</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nnmodel">OH_NNModel</a> *model</td> <td class="cellrowborder" width="50%">指向<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nnmodel">OH_NNModel</a>实例的指针。</td> </tr> <tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-type-h#oh_nn_operationtype">OH_NN_OperationType</a> op</td> <td class="cellrowborder" width="50%">指定添加的算子类型，取值请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-type-h#oh_nn_operationtype">OH_NN_OperationType</a>的枚举值。</td> </tr> <tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nn-uint32array">const OH_NN_UInt32Array</a> *paramIndices</td> <td class="cellrowborder" width="50%">OH_NN_UInt32Array实例的指针，设置算子的参数张量索引。</td> </tr> <tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nn-uint32array">const OH_NN_UInt32Array</a> *inputIndices</td> <td class="cellrowborder" width="50%">OH_NN_UInt32Array实例的指针，指定算子的输入张量索引。</td> </tr> <tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nn-uint32array">const OH_NN_UInt32Array</a> *outputIndices</td> <td class="cellrowborder" width="50%">OH_NN_UInt32Array实例的指针，设置算子的输出张量索引。</td> </tr>  </tbody></table></div> </div> <p><strong>返回：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.15.15.1.3.1.1" width="50%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.15.15.1.3.1.2" width="50%">说明</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-type-h#oh_nn_returncode">OH_NN_ReturnCode</a></td> <td class="cellrowborder" width="50%">函数执行的结果状态。执行成功返回OH_NN_SUCCESS；失败返回具体错误码，具体失败错误码可参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-type-h#oh_nn_returncode">OH_NN_ReturnCode</a>。</td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h3 id="oh_nnmodel_specifyinputsandoutputs" device-type="phone,2in1,tablet">OH_NNModel_SpecifyInputsAndOutputs()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="oh_nnmodel_specifyinputsandoutputs" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><div _ngcontent-edy-c106="" class="highlight-div"><div _ngcontent-edy-c106="" class="highlight-div-header"><div _ngcontent-edy-c106="" class="highlight-div-header-left"><div _ngcontent-edy-c106="" class="handle-button expand-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-edy-c106="" class="highlight-div-header-right"><div _ngcontent-edy-c106="" class="handle-button ai-button"></div><div _ngcontent-edy-c106="" class="handle-button line-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-edy-c106="" class="handle-button theme-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-edy-c106="" class="handle-button copy-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-edy-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-function">OH_NN_ReturnCode <span class="hljs-title">OH_NNModel_SpecifyInputsAndOutputs</span><span class="hljs-params">(OH_NNModel *model,<span class="hljs-type">const</span> OH_NN_UInt32Array *inputIndices,<span class="hljs-type">const</span> OH_NN_UInt32Array *outputIndices)</span></span></li></ol></pre></div></div> <p><strong>描述</strong></p> <p>指定模型的输入和输出张量的索引值。</p> <p>模型实例需要指定张量作为端到端的输入和输出张量。设置一个张量为输入或输出张量后，就不能再通过调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnmodel_settensordata">OH_NNModel_SetTensorData</a>设置张量数据，而需要在执行阶段调用OH_NNExecutor的方法设置输入或输出张量数据。</p> <p>张量的索引值根据张量添加进模型的顺序决定，张量的添加参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnmodel_addtensortomodel">OH_NNModel_AddTensorToModel</a>。 暂时不支持异步设置模型输入和输出张量。</p> <p><strong>起始版本：</strong> 9</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.16.9.1.3.1.1" width="50%">参数项</th> <th align="left" class="cellrowborder" id="mcps1.3.16.9.1.3.1.2" width="50%">描述</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nnmodel">OH_NNModel</a> *model</td> <td class="cellrowborder" width="50%">指向<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nnmodel">OH_NNModel</a>实例的指针。</td> </tr> <tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nn-uint32array">const OH_NN_UInt32Array</a> *inputIndices</td> <td class="cellrowborder" width="50%">OH_NN_UInt32Array实例的指针，指定算子的输入张量。</td> </tr> <tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nn-uint32array">const OH_NN_UInt32Array</a> *outputIndices</td> <td class="cellrowborder" width="50%">OH_NN_UInt32Array实例的指针，指定算子的输出张量。</td> </tr>  </tbody></table></div> </div> <p><strong>返回：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.16.11.1.3.1.1" width="50%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.16.11.1.3.1.2" width="50%">说明</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-type-h#oh_nn_returncode">OH_NN_ReturnCode</a></td> <td class="cellrowborder" width="50%">函数执行的结果状态。执行成功返回OH_NN_SUCCESS；失败返回具体错误码，具体失败错误码可参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-type-h#oh_nn_returncode">OH_NN_ReturnCode</a>。</td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h3 id="oh_nnmodel_finish" device-type="phone,2in1,tablet">OH_NNModel_Finish()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="oh_nnmodel_finish" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><div _ngcontent-edy-c106="" class="highlight-div"><div _ngcontent-edy-c106="" class="highlight-div-header"><div _ngcontent-edy-c106="" class="highlight-div-header-left"><div _ngcontent-edy-c106="" class="handle-button expand-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-edy-c106="" class="highlight-div-header-right"><div _ngcontent-edy-c106="" class="handle-button ai-button"></div><div _ngcontent-edy-c106="" class="handle-button line-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-edy-c106="" class="handle-button theme-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-edy-c106="" class="handle-button copy-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-edy-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-scss" data-highlighted="yes"><ol class="linenums"><li>OH_NN_ReturnCode <span class="hljs-built_in">OH_NNModel_Finish</span>(OH_NNModel *model)</li></ol></pre></div></div> <p><strong>描述</strong></p> <p>完成模型构图。</p> <p>完成模型拓扑结构的搭建后，调用该接口指示构图已完成。</p> <p>在调用该接口后，无法进行额外的构图操作，调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnmodel_addtensortomodel">OH_NNModel_AddTensorToModel</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnmodel_addoperation">OH_NNModel_AddOperation</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnmodel_settensordata">OH_NNModel_SetTensorData</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnmodel_specifyinputsandoutputs">OH_NNModel_SpecifyInputsAndOutputs</a>将返回<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-type-h#oh_nn_returncode">OH_NN_OPERATION_FORBIDDEN</a>。</p> <p>在调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnmodel_getavailableoperations">OH_NNModel_GetAvailableOperations</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-core-h#oh_nncompilation_construct">OH_NNCompilation_Construct</a>之前，必须先调用该接口完成构图。</p> <p><strong>起始版本：</strong> 9</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.17.10.1.3.1.1" width="50%">参数项</th> <th align="left" class="cellrowborder" id="mcps1.3.17.10.1.3.1.2" width="50%">描述</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nnmodel">OH_NNModel</a> *model</td> <td class="cellrowborder" width="50%">指向<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nnmodel">OH_NNModel</a>实例的指针。</td> </tr>  </tbody></table></div> </div> <p><strong>返回：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.17.12.1.3.1.1" width="50%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.17.12.1.3.1.2" width="50%">说明</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-type-h#oh_nn_returncode">OH_NN_ReturnCode</a></td> <td class="cellrowborder" width="50%">函数执行的结果状态。执行成功返回OH_NN_SUCCESS；失败返回具体错误码，具体失败错误码可参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-type-h#oh_nn_returncode">OH_NN_ReturnCode</a>。</td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h3 id="oh_nnmodel_destroy" device-type="phone,2in1,tablet">OH_NNModel_Destroy()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="oh_nnmodel_destroy" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><div _ngcontent-edy-c106="" class="highlight-div"><div _ngcontent-edy-c106="" class="highlight-div-header"><div _ngcontent-edy-c106="" class="highlight-div-header-left"><div _ngcontent-edy-c106="" class="handle-button expand-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-edy-c106="" class="highlight-div-header-right"><div _ngcontent-edy-c106="" class="handle-button ai-button"></div><div _ngcontent-edy-c106="" class="handle-button line-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-edy-c106="" class="handle-button theme-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-edy-c106="" class="handle-button copy-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-edy-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-java" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">void</span> <span class="hljs-title function_">OH_NNModel_Destroy</span><span class="hljs-params">(OH_NNModel **model)</span></li></ol></pre></div></div> <p><strong>描述</strong></p> <p>销毁模型实例。</p> <p>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnmodel_construct">OH_NNModel_Construct</a>创建的模型实例需要调用该接口主动销毁，否则将造成内存泄漏。</p> <p>如果model为空指针或者*model为空指针，该接口仅打印警告日志，不执行销毁操作。</p> <p><strong>起始版本：</strong> 9</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.18.9.1.3.1.1" width="50%">参数项</th> <th align="left" class="cellrowborder" id="mcps1.3.18.9.1.3.1.2" width="50%">描述</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nnmodel">OH_NNModel</a> **model</td> <td class="cellrowborder" width="50%">指向<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nnmodel">OH_NNModel</a>实例的二级指针。模型实例销毁后，该接口会将*model主动设置为空指针。</td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h3 id="oh_nnmodel_getavailableoperations" device-type="phone,2in1,tablet">OH_NNModel_GetAvailableOperations()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="oh_nnmodel_getavailableoperations" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><div _ngcontent-edy-c106="" class="highlight-div"><div _ngcontent-edy-c106="" class="highlight-div-header"><div _ngcontent-edy-c106="" class="highlight-div-header-left"><div _ngcontent-edy-c106="" class="handle-button expand-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-edy-c106="" class="highlight-div-header-right"><div _ngcontent-edy-c106="" class="handle-button ai-button"></div><div _ngcontent-edy-c106="" class="handle-button line-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-edy-c106="" class="handle-button theme-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-edy-c106="" class="handle-button copy-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-edy-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-function">OH_NN_ReturnCode <span class="hljs-title">OH_NNModel_GetAvailableOperations</span><span class="hljs-params">(OH_NNModel *model,<span class="hljs-type">size_t</span> deviceID,<span class="hljs-type">const</span> <span class="hljs-type">bool</span> **isSupported,<span class="hljs-type">uint32_t</span> *opCount)</span></span></li></ol></pre></div></div> <p><strong>描述</strong></p> <p>查询硬件对模型内所有算子的支持情况，通过布尔值序列指示支持情况。</p> <p>查询底层硬件对模型实例内每个算子的支持情况，硬件由deviceID指定，结果将通过isSupported指向的数组表示。</p> <p>如果支持第i个算子，则(*isSupported)[i] == true，否则为false。 该接口成功执行后，(*isSupported)将指向记录算子支持情况的bool数组，数组长度和模型实例的算子数量相等。</p> <p>该数组对应的内存由Neural Network Runtime管理，在模型实例销毁或再次调用该接口后自动销毁。</p> <p><strong>起始版本：</strong> 9</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.19.10.1.3.1.1" width="50%">参数项</th> <th align="left" class="cellrowborder" id="mcps1.3.19.10.1.3.1.2" width="50%">描述</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nnmodel">OH_NNModel</a> *model</td> <td class="cellrowborder" width="50%">指向<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nnmodel">OH_NNModel</a>实例的指针。</td> </tr> <tr><td class="cellrowborder" width="50%">size_t deviceID</td> <td class="cellrowborder" width="50%">指定查询的硬件ID，通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-core-h#oh_nndevice_getalldevicesid">OH_NNDevice_GetAllDevicesID</a>获取。</td> </tr> <tr><td class="cellrowborder" width="50%">const bool **isSupported</td> <td class="cellrowborder" width="50%">指向bool数组的指针。调用该接口时，要求(*isSupported)为空指针，否则返回<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-type-h#oh_nn_returncode">OH_NN_INVALID_PARAMETER</a>。</td> </tr> <tr><td class="cellrowborder" width="50%">uint32_t *opCount</td> <td class="cellrowborder" width="50%">模型实例中算子的数量，对应(*isSupported)数组的长度。</td> </tr>  </tbody></table></div> </div> <p><strong>返回：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.19.12.1.3.1.1" width="50%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.19.12.1.3.1.2" width="50%">说明</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-type-h#oh_nn_returncode">OH_NN_ReturnCode</a></td> <td class="cellrowborder" width="50%">函数执行的结果状态。执行成功返回OH_NN_SUCCESS；失败返回具体错误码，具体失败错误码可参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-type-h#oh_nn_returncode">OH_NN_ReturnCode</a>。</td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h3 id="oh_nnmodel_addtensor" device-type="phone,2in1,tablet">OH_NNModel_AddTensor()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="oh_nnmodel_addtensor" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><div _ngcontent-edy-c106="" class="highlight-div"><div _ngcontent-edy-c106="" class="highlight-div-header"><div _ngcontent-edy-c106="" class="highlight-div-header-left"><div _ngcontent-edy-c106="" class="handle-button expand-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-edy-c106="" class="highlight-div-header-right"><div _ngcontent-edy-c106="" class="handle-button ai-button"></div><div _ngcontent-edy-c106="" class="handle-button line-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-edy-c106="" class="handle-button theme-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-edy-c106="" class="handle-button copy-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-edy-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-scss" data-highlighted="yes"><ol class="linenums"><li>OH_NN_ReturnCode <span class="hljs-built_in">OH_NNModel_AddTensor</span>(OH_NNModel *model, const OH_NN_Tensor *tensor)</li></ol></pre></div></div> <p><strong>描述</strong></p> <p>向模型实例中添加张量。</p> <p>Neural Network Runtime模型中的数据节点和算子参数均由模型的张量构成，该接口根据tensor，向model实例中添加张量。</p> <p>张量添加的顺序由模型中记录张量的索引值来确定，<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnmodel_settensordata">OH_NNModel_SetTensorData</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnmodel_addoperation">OH_NNModel_AddOperation</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnmodel_specifyinputsandoutputs">OH_NNModel_SpecifyInputsAndOutputs</a>接口根据该索引值，指定不同的张量。</p> <p>Neural Network Runtime支持动态形状输入和输出。</p> <p>在添加动态形状的数据节点时，需要将tensor.dimensions中支持动态变化的维度设置为-1。例如可将一个四维tensor的dimensions设置为[1, -1, 2, 2]，表示其第二个维度支持动态变化。</p> <p><strong>起始版本：</strong> 9</p> <p><strong>废弃版本：</strong> 11</p> <p><strong>替代接口：</strong> <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnmodel_addtensortomodel">OH_NNModel_AddTensorToModel</a></p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.20.13.1.3.1.1" width="50%">参数项</th> <th align="left" class="cellrowborder" id="mcps1.3.20.13.1.3.1.2" width="50%">描述</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nnmodel">OH_NNModel</a> *model</td> <td class="cellrowborder" width="50%">指向<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nnmodel">OH_NNModel</a>实例的指针。</td> </tr> <tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nn-tensor">const OH_NN_Tensor</a> *tensor</td> <td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nn-tensor">OH_NN_Tensor</a>张量的指针，tensor指定了添加到模型实例中张量的属性。</td> </tr>  </tbody></table></div> </div> <p><strong>返回：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.20.15.1.3.1.1" width="50%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.20.15.1.3.1.2" width="50%">说明</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-type-h#oh_nn_returncode">OH_NN_ReturnCode</a></td> <td class="cellrowborder" width="50%">函数执行的结果状态。执行成功返回OH_NN_SUCCESS；失败返回具体错误码，具体失败错误码可参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-type-h#oh_nn_returncode">OH_NN_ReturnCode</a>。</td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h3 id="oh_nnexecutor_setinput" device-type="phone,2in1,tablet">OH_NNExecutor_SetInput()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="oh_nnexecutor_setinput" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><div _ngcontent-edy-c106="" class="highlight-div"><div _ngcontent-edy-c106="" class="highlight-div-header"><div _ngcontent-edy-c106="" class="highlight-div-header-left"><div _ngcontent-edy-c106="" class="handle-button expand-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-edy-c106="" class="highlight-div-header-right"><div _ngcontent-edy-c106="" class="handle-button ai-button"></div><div _ngcontent-edy-c106="" class="handle-button line-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-edy-c106="" class="handle-button theme-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-edy-c106="" class="handle-button copy-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-edy-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-function">OH_NN_ReturnCode <span class="hljs-title">OH_NNExecutor_SetInput</span><span class="hljs-params">(OH_NNExecutor *executor,<span class="hljs-type">uint32_t</span> inputIndex,<span class="hljs-type">const</span> OH_NN_Tensor *tensor,<span class="hljs-type">const</span> <span class="hljs-type">void</span> *dataBuffer,<span class="hljs-type">size_t</span> length)</span></span></li></ol></pre></div></div> <p><strong>描述</strong></p> <p>设置模型单个输入的数据。</p> <p>该接口将dataBuffer中，长度为length个字节的数据，拷贝到底层硬件的共享内存。</p> <p>inputIndex指定设置的输入，tensor用于设置输入张量的形状、数据类型、量化参数等信息。</p> <p>由于Neural Network Runtime支持动态输入形状的模型，在固定形状输入和动态形状输入的场景下，该接口采取不同的处理策略：</p> <ul><li>固定形状输入的场景：tensor各属性必须和构图阶段调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnmodel_addtensor">OH_NNModel_AddTensor</a>添加的张量保持一致；</li><li><p>动态形状输入的场景：在构图阶段，由于动态输入的形状不确定，调用该接口时，要求tensor.dimensions中的每个值必须大于0，以确定执行计算阶段输入的形状。设置形状时，只允许调整数值为-1的维度。</p> <p>假设在构图阶段，输入A的维度为[-1, 224, 224, 3]，调用该接口时，只能调整第一个维度的尺寸，如：[3, 224, 224, 3]。调整其他维度将返回<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-type-h#oh_nn_returncode">OH_NN_INVALID_PARAMETER</a>。</p> </li></ul> <p><strong>起始版本：</strong> 9</p> <p><strong>废弃版本：</strong> 11</p> <p><strong>替代接口：</strong> <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-core-h#oh_nnexecutor_runsync">OH_NNExecutor_RunSync</a></p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.21.13.1.3.1.1" width="50%">参数项</th> <th align="left" class="cellrowborder" id="mcps1.3.21.13.1.3.1.2" width="50%">描述</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nnexecutor">OH_NNExecutor</a> *executor</td> <td class="cellrowborder" width="50%">指向<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nnexecutor">OH_NNExecutor</a>实例的指针。</td> </tr> <tr><td class="cellrowborder" width="50%">uint32_t inputIndex</td> <td class="cellrowborder" width="50%"><p>输入的索引值，与调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnmodel_specifyinputsandoutputs">OH_NNModel_SpecifyInputsAndOutputs</a>时输入数据的顺序一致。</p> <p>假设调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnmodel_specifyinputsandoutputs">OH_NNModel_SpecifyInputsAndOutputs</a>时，inputIndices为{1, 5, 9}，则在设置输入的阶段，三个输入的索引值分别为{0, 1, 2}。</p> </td> </tr> <tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nn-tensor">const OH_NN_Tensor</a> *tensor</td> <td class="cellrowborder" width="50%">设置输入数据对应的张量。</td> </tr> <tr><td class="cellrowborder" width="50%">const void *dataBuffer</td> <td class="cellrowborder" width="50%">指向输入数据的指针。</td> </tr> <tr><td class="cellrowborder" width="50%">size_t length</td> <td class="cellrowborder" width="50%">数据内存的字节长度。</td> </tr>  </tbody></table></div> </div> <p><strong>返回：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.21.15.1.3.1.1" width="50%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.21.15.1.3.1.2" width="50%">说明</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-type-h#oh_nn_returncode">OH_NN_ReturnCode</a></td> <td class="cellrowborder" width="50%">函数执行的结果状态。执行成功返回OH_NN_SUCCESS；失败返回具体错误码，具体失败错误码可参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-type-h#oh_nn_returncode">OH_NN_ReturnCode</a>。</td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h3 id="oh_nnexecutor_setoutput" device-type="phone,2in1,tablet">OH_NNExecutor_SetOutput()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="oh_nnexecutor_setoutput" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><div _ngcontent-edy-c106="" class="highlight-div"><div _ngcontent-edy-c106="" class="highlight-div-header"><div _ngcontent-edy-c106="" class="highlight-div-header-left"><div _ngcontent-edy-c106="" class="handle-button expand-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-edy-c106="" class="highlight-div-header-right"><div _ngcontent-edy-c106="" class="handle-button ai-button"></div><div _ngcontent-edy-c106="" class="handle-button line-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-edy-c106="" class="handle-button theme-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-edy-c106="" class="handle-button copy-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-edy-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-function">OH_NN_ReturnCode <span class="hljs-title">OH_NNExecutor_SetOutput</span><span class="hljs-params">(OH_NNExecutor *executor,<span class="hljs-type">uint32_t</span> outputIndex,<span class="hljs-type">void</span> *dataBuffer,<span class="hljs-type">size_t</span> length)</span></span></li></ol></pre></div></div> <p><strong>描述</strong></p> <p>设置模型单个输出的内存。</p> <p>该接口将dataBuffer指向的内存与outputIndex指定的输出绑定，内存的长度由length指定。</p> <p>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnexecutor_run">OH_NNExecutor_Run</a>完成单次模型推理后，Neural Network Runtime将比对dataBuffer指向的内存与输出数据的长度，根据不同情况，返回不同结果：</p> <ul><li>如果内存大小大于或等于数据长度：则推理后的结果将拷贝至内存，并返回<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-type-h#oh_nn_returncode">OH_NN_SUCCESS</a>，可以通过访问dataBuffer读取推理结果。</li><li>如果内存大小小于数据长度：则<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnexecutor_run">OH_NNExecutor_Run</a>将返回<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-type-h#oh_nn_returncode">OH_NN_INVALID_PARAMETER</a>，并输出日志告知内存太小的信息。</li></ul> <p><strong>起始版本：</strong> 9</p> <p><strong>废弃版本：</strong> 11</p> <p><strong>替代接口：</strong> <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-core-h#oh_nnexecutor_runsync">OH_NNExecutor_RunSync</a></p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.22.12.1.3.1.1" width="50%">参数项</th> <th align="left" class="cellrowborder" id="mcps1.3.22.12.1.3.1.2" width="50%">描述</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nnexecutor">OH_NNExecutor</a> *executor</td> <td class="cellrowborder" width="50%">指向<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nnexecutor">OH_NNExecutor</a>实例的指针。</td> </tr> <tr><td class="cellrowborder" width="50%">uint32_t outputIndex</td> <td class="cellrowborder" width="50%"><p>输出的索引值，与调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnmodel_specifyinputsandoutputs">OH_NNModel_SpecifyInputsAndOutputs</a>时输出数据的顺序一致。</p> <p>假设调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnmodel_specifyinputsandoutputs">OH_NNModel_SpecifyInputsAndOutputs</a>时，outputIndices为{4, 6, 8}，则在设置输出内存时，三个输出的索引值分别为{0, 1, 2}。</p> </td> </tr> <tr><td class="cellrowborder" width="50%">void *dataBuffer</td> <td class="cellrowborder" width="50%">指向输出数据的指针。</td> </tr> <tr><td class="cellrowborder" width="50%">size_t length</td> <td class="cellrowborder" width="50%">数据内存的字节长度。</td> </tr>  </tbody></table></div> </div> <p><strong>返回：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.22.14.1.3.1.1" width="50%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.22.14.1.3.1.2" width="50%">说明</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-type-h#oh_nn_returncode">OH_NN_ReturnCode</a></td> <td class="cellrowborder" width="50%">函数执行的结果状态。执行成功返回OH_NN_SUCCESS；失败返回具体错误码，具体失败错误码可参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-type-h#oh_nn_returncode">OH_NN_ReturnCode</a>。</td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h3 id="oh_nnexecutor_run" device-type="phone,2in1,tablet">OH_NNExecutor_Run()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="oh_nnexecutor_run" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><div _ngcontent-edy-c106="" class="highlight-div"><div _ngcontent-edy-c106="" class="highlight-div-header"><div _ngcontent-edy-c106="" class="highlight-div-header-left"><div _ngcontent-edy-c106="" class="handle-button expand-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-edy-c106="" class="highlight-div-header-right"><div _ngcontent-edy-c106="" class="handle-button ai-button"></div><div _ngcontent-edy-c106="" class="handle-button line-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-edy-c106="" class="handle-button theme-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-edy-c106="" class="handle-button copy-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-edy-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-scss" data-highlighted="yes"><ol class="linenums"><li>OH_NN_ReturnCode <span class="hljs-built_in">OH_NNExecutor_Run</span>(OH_NNExecutor *executor)</li></ol></pre></div></div> <p><strong>描述</strong></p> <p>执行推理。 在执行器关联的硬件上，执行模型的端到端推理计算。</p> <p><strong>起始版本：</strong> 9</p> <p><strong>废弃版本：</strong> 11</p> <p><strong>替代接口：</strong> <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-core-h#oh_nnexecutor_runsync">OH_NNExecutor_RunSync</a></p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.23.9.1.3.1.1" width="50%">参数项</th> <th align="left" class="cellrowborder" id="mcps1.3.23.9.1.3.1.2" width="50%">描述</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nnexecutor">OH_NNExecutor</a> *executor</td> <td class="cellrowborder" width="50%">指向<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nnexecutor">OH_NNExecutor</a>实例的指针。</td> </tr>  </tbody></table></div> </div> <p><strong>返回：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.23.11.1.3.1.1" width="50%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.23.11.1.3.1.2" width="50%">说明</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-type-h#oh_nn_returncode">OH_NN_ReturnCode</a></td> <td class="cellrowborder" width="50%">函数执行的结果状态。执行成功返回OH_NN_SUCCESS；失败返回具体错误码，具体失败错误码可参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-type-h#oh_nn_returncode">OH_NN_ReturnCode</a>。</td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h3 id="oh_nnexecutor_allocateinputmemory" device-type="phone,2in1,tablet">OH_NNExecutor_AllocateInputMemory()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="oh_nnexecutor_allocateinputmemory" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><div _ngcontent-edy-c106="" class="highlight-div"><div _ngcontent-edy-c106="" class="highlight-div-header"><div _ngcontent-edy-c106="" class="highlight-div-header-left"><div _ngcontent-edy-c106="" class="handle-button expand-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-edy-c106="" class="highlight-div-header-right"><div _ngcontent-edy-c106="" class="handle-button ai-button"></div><div _ngcontent-edy-c106="" class="handle-button line-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-edy-c106="" class="handle-button theme-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-edy-c106="" class="handle-button copy-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-edy-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-function">OH_NN_Memory *<span class="hljs-title">OH_NNExecutor_AllocateInputMemory</span><span class="hljs-params">(OH_NNExecutor *executor, <span class="hljs-type">uint32_t</span> inputIndex, <span class="hljs-type">size_t</span> length)</span></span></li></ol></pre></div></div> <p><strong>描述</strong></p> <p>在硬件上为单个输入申请共享内存。</p> <p>Neural Network Runtime 提供主动申请硬件共享内存的方法。</p> <p>通过指定执行器和输入索引值，该接口在单个输入关联的硬件上，申请大小为length的共享内存，通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nn-memory">OH_NN_Memory</a>实例返回。</p> <p><strong>起始版本：</strong> 9</p> <p><strong>废弃版本：</strong> 11</p> <p><strong>替代接口：</strong> <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-core-h#oh_nntensor_createwithsize">OH_NNTensor_CreateWithSize</a></p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.24.11.1.3.1.1" width="50%">参数项</th> <th align="left" class="cellrowborder" id="mcps1.3.24.11.1.3.1.2" width="50%">描述</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nnexecutor">OH_NNExecutor</a> *executor</td> <td class="cellrowborder" width="50%">指向<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nnexecutor">OH_NNExecutor</a>实例的指针。</td> </tr> <tr><td class="cellrowborder" width="50%">uint32_t inputIndex</td> <td class="cellrowborder" width="50%"><p>输入的索引值，与调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnmodel_specifyinputsandoutputs">OH_NNModel_SpecifyInputsAndOutputs</a>时输入数据的顺序一致。</p> <p>假设调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnmodel_specifyinputsandoutputs">OH_NNModel_SpecifyInputsAndOutputs</a>时，inputIndices为{1, 5, 9}，则在申请输入内存时，三个输入的索引值分别为{0, 1, 2}。</p> </td> </tr> <tr><td class="cellrowborder" width="50%">size_t length</td> <td class="cellrowborder" width="50%">申请的内存字节。</td> </tr>  </tbody></table></div> </div> <p><strong>返回：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.24.13.1.3.1.1" width="50%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.24.13.1.3.1.2" width="50%">说明</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nn-memory">OH_NN_Memory</a> *</td> <td class="cellrowborder" width="50%">指向<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nn-memory">OH_NN_Memory</a>实例的指针，如果创建失败就返回NULL。</td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h3 id="oh_nnexecutor_allocateoutputmemory" device-type="phone,2in1,tablet">OH_NNExecutor_AllocateOutputMemory()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="oh_nnexecutor_allocateoutputmemory" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><div _ngcontent-edy-c106="" class="highlight-div"><div _ngcontent-edy-c106="" class="highlight-div-header"><div _ngcontent-edy-c106="" class="highlight-div-header-left"><div _ngcontent-edy-c106="" class="handle-button expand-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-edy-c106="" class="highlight-div-header-right"><div _ngcontent-edy-c106="" class="handle-button ai-button"></div><div _ngcontent-edy-c106="" class="handle-button line-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-edy-c106="" class="handle-button theme-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-edy-c106="" class="handle-button copy-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-edy-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-function">OH_NN_Memory *<span class="hljs-title">OH_NNExecutor_AllocateOutputMemory</span><span class="hljs-params">(OH_NNExecutor *executor, <span class="hljs-type">uint32_t</span> outputIndex, <span class="hljs-type">size_t</span> length)</span></span></li></ol></pre></div></div> <p><strong>描述</strong></p> <p>在硬件上为单个输出申请共享内存。</p> <p>Neural Network Runtime 提供主动申请硬件共享内存的方法。</p> <p>通过指定执行器和输出索引值，该接口在单个输出关联的硬件上，申请大小为length的共享内存，通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nn-memory">OH_NN_Memory</a>实例返回。</p> <p><strong>起始版本：</strong> 9</p> <p><strong>废弃版本：</strong> 11</p> <p><strong>替代接口：</strong> <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-core-h#oh_nntensor_createwithsize">OH_NNTensor_CreateWithSize</a></p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.25.11.1.3.1.1" width="50%">参数项</th> <th align="left" class="cellrowborder" id="mcps1.3.25.11.1.3.1.2" width="50%">描述</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nnexecutor">OH_NNExecutor</a> *executor</td> <td class="cellrowborder" width="50%">指向<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nnexecutor">OH_NNExecutor</a>实例的指针。</td> </tr> <tr><td class="cellrowborder" width="50%">uint32_t outputIndex</td> <td class="cellrowborder" width="50%"><p>输出的索引值，与调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnmodel_specifyinputsandoutputs">OH_NNModel_SpecifyInputsAndOutputs</a>时输出数据的顺序一致。</p> <p>假设调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnmodel_specifyinputsandoutputs">OH_NNModel_SpecifyInputsAndOutputs</a>时，outputIndices为{4, 6, 8}，则在申请输出内存时，三个输出的索引值分别为{0, 1, 2}。</p> </td> </tr> <tr><td class="cellrowborder" width="50%">size_t length</td> <td class="cellrowborder" width="50%">申请的内存字节。</td> </tr>  </tbody></table></div> </div> <p><strong>返回：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.25.13.1.3.1.1" width="50%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.25.13.1.3.1.2" width="50%">说明</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nn-memory">OH_NN_Memory</a> *</td> <td class="cellrowborder" width="50%">指向<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nn-memory">OH_NN_Memory</a>实例的指针，如果创建失败就返回NULL。</td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h3 id="oh_nnexecutor_destroyinputmemory" device-type="phone,2in1,tablet">OH_NNExecutor_DestroyInputMemory()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="oh_nnexecutor_destroyinputmemory" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><div _ngcontent-edy-c106="" class="highlight-div"><div _ngcontent-edy-c106="" class="highlight-div-header"><div _ngcontent-edy-c106="" class="highlight-div-header-left"><div _ngcontent-edy-c106="" class="handle-button expand-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-edy-c106="" class="highlight-div-header-right"><div _ngcontent-edy-c106="" class="handle-button ai-button"></div><div _ngcontent-edy-c106="" class="handle-button line-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-edy-c106="" class="handle-button theme-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-edy-c106="" class="handle-button copy-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-edy-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">OH_NNExecutor_DestroyInputMemory</span><span class="hljs-params">(OH_NNExecutor *executor, <span class="hljs-type">uint32_t</span> inputIndex, OH_NN_Memory **memory)</span></span></li></ol></pre></div></div> <p><strong>描述</strong></p> <p>释放<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nn-memory">OH_NN_Memory</a>实例指向的输入内存。</p> <p>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnexecutor_allocateinputmemory">OH_NNExecutor_AllocateInputMemory</a>创建的内存实例，需要主动调用该接口进行释放，否则将造成内存泄漏。</p> <p>inputIndex和memory的对应关系需要和创建内存实例时保持一致。 如果memory或*memory为空指针，该接口仅打印警告日志，不执行释放操作。</p> <p><strong>起始版本：</strong> 9</p> <p><strong>废弃版本：</strong> 11</p> <p><strong>替代接口：</strong> <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-core-h#oh_nntensor_destroy">OH_NNTensor_Destroy</a></p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.26.11.1.3.1.1" width="50%">参数项</th> <th align="left" class="cellrowborder" id="mcps1.3.26.11.1.3.1.2" width="50%">描述</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nnexecutor">OH_NNExecutor</a> *executor</td> <td class="cellrowborder" width="50%">指向<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nnexecutor">OH_NNExecutor</a>实例的指针。</td> </tr> <tr><td class="cellrowborder" width="50%">uint32_t inputIndex</td> <td class="cellrowborder" width="50%"><p>输入的索引值，与调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnmodel_specifyinputsandoutputs">OH_NNModel_SpecifyInputsAndOutputs</a>时输入数据的顺序一致。</p> <p>假设调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnmodel_specifyinputsandoutputs">OH_NNModel_SpecifyInputsAndOutputs</a>时，inputIndices为{1, 5, 9}，则在释放输入内存时，三个输入的索引值分别为{0, 1, 2}。</p> </td> </tr> <tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nn-memory">OH_NN_Memory</a> **memory</td> <td class="cellrowborder" width="50%">指向<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nn-memory">OH_NN_Memory</a>实例的二级指针。共享内存释放后，该接口将*memory主动设置为空指针。</td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h3 id="oh_nnexecutor_destroyoutputmemory" device-type="phone,2in1,tablet">OH_NNExecutor_DestroyOutputMemory()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="oh_nnexecutor_destroyoutputmemory" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><div _ngcontent-edy-c106="" class="highlight-div"><div _ngcontent-edy-c106="" class="highlight-div-header"><div _ngcontent-edy-c106="" class="highlight-div-header-left"><div _ngcontent-edy-c106="" class="handle-button expand-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-edy-c106="" class="highlight-div-header-right"><div _ngcontent-edy-c106="" class="handle-button ai-button"></div><div _ngcontent-edy-c106="" class="handle-button line-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-edy-c106="" class="handle-button theme-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-edy-c106="" class="handle-button copy-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-edy-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">OH_NNExecutor_DestroyOutputMemory</span><span class="hljs-params">(OH_NNExecutor *executor, <span class="hljs-type">uint32_t</span> outputIndex, OH_NN_Memory **memory)</span></span></li></ol></pre></div></div> <p><strong>描述</strong></p> <p>释放<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nn-memory">OH_NN_Memory</a>实例指向的输出内存。</p> <p>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnexecutor_allocateoutputmemory">OH_NNExecutor_AllocateOutputMemory</a>创建的内存实例，需要主动调用该接口进行释放，否则将造成内存泄漏。</p> <p>outputIndex和memory的对应关系需要和创建内存实例时保持一致。</p> <p>如果memory或*memory为空指针，该接口仅打印警告日志，不执行释放操作。</p> <p><strong>起始版本：</strong> 9</p> <p><strong>废弃版本：</strong> 11</p> <p><strong>替代接口：</strong> <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-core-h#oh_nntensor_destroy">OH_NNTensor_Destroy</a></p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.27.12.1.3.1.1" width="50%">参数项</th> <th align="left" class="cellrowborder" id="mcps1.3.27.12.1.3.1.2" width="50%">描述</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nnexecutor">OH_NNExecutor</a> *executor</td> <td class="cellrowborder" width="50%">指向<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nnexecutor">OH_NNExecutor</a>实例的指针。</td> </tr> <tr><td class="cellrowborder" width="50%">uint32_t outputIndex</td> <td class="cellrowborder" width="50%"><p>输出的索引值，与调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnmodel_specifyinputsandoutputs">OH_NNModel_SpecifyInputsAndOutputs</a>时输出数据的顺序一致。</p> <p>假设调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnmodel_specifyinputsandoutputs">OH_NNModel_SpecifyInputsAndOutputs</a>时，outputIndices为{4, 6, 8}，则在释放输出内存时，三个输出的索引值分别为{0, 1, 2}。</p> </td> </tr> <tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nn-memory">OH_NN_Memory</a> **memory</td> <td class="cellrowborder" width="50%">指向<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nn-memory">OH_NN_Memory</a>实例的二级指针。共享内存释放后，该接口将*memory主动设置为空指针。</td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h3 id="oh_nnexecutor_setinputwithmemory" device-type="phone,2in1,tablet">OH_NNExecutor_SetInputWithMemory()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="oh_nnexecutor_setinputwithmemory" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><div _ngcontent-edy-c106="" class="highlight-div"><div _ngcontent-edy-c106="" class="highlight-div-header"><div _ngcontent-edy-c106="" class="highlight-div-header-left"><div _ngcontent-edy-c106="" class="handle-button expand-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-edy-c106="" class="highlight-div-header-right"><div _ngcontent-edy-c106="" class="handle-button ai-button"></div><div _ngcontent-edy-c106="" class="handle-button line-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-edy-c106="" class="handle-button theme-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-edy-c106="" class="handle-button copy-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-edy-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-function">OH_NN_ReturnCode <span class="hljs-title">OH_NNExecutor_SetInputWithMemory</span><span class="hljs-params">(OH_NNExecutor *executor,<span class="hljs-type">uint32_t</span> inputIndex,<span class="hljs-type">const</span> OH_NN_Tensor *tensor,<span class="hljs-type">const</span> OH_NN_Memory *memory)</span></span></li></ol></pre></div></div> <p><strong>描述</strong></p> <p>将<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nn-memory">OH_NN_Memory</a>实例指向的硬件共享内存，并指定为单个输入使用的内存。</p> <p>在需要自行管理内存的场景下，该接口将执行输入和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nn-memory">OH_NN_Memory</a>内存实例绑定。</p> <p>执行计算时，底层硬件从内存实例指向的共享内存中读取输入数据。</p> <p>通过该接口，可以实现设置输入、执行计算、读取输出的并发执行，提升数据流的推理效率。</p> <p><strong>起始版本：</strong> 9</p> <p><strong>废弃版本：</strong> 11</p> <p><strong>替代接口：</strong> <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-core-h#oh_nnexecutor_runsync">OH_NNExecutor_RunSync</a></p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.28.12.1.3.1.1" width="50%">参数项</th> <th align="left" class="cellrowborder" id="mcps1.3.28.12.1.3.1.2" width="50%">描述</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nnexecutor">OH_NNExecutor</a> *executor</td> <td class="cellrowborder" width="50%">指向<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nnexecutor">OH_NNExecutor</a>实例的指针。</td> </tr> <tr><td class="cellrowborder" width="50%">uint32_t inputIndex</td> <td class="cellrowborder" width="50%"><p>输入的索引值，与调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnmodel_specifyinputsandoutputs">OH_NNModel_SpecifyInputsAndOutputs</a>时输入数据的顺序一致。</p> <p>假设调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnmodel_specifyinputsandoutputs">OH_NNModel_SpecifyInputsAndOutputs</a>时，inputIndices为{1, 5, 9}，则在指定输入的共享内存时，三个输入的索引值分别为{0, 1, 2}。</p> </td> </tr> <tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nn-tensor">const OH_NN_Tensor</a> *tensor</td> <td class="cellrowborder" width="50%">指向<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nn-tensor">OH_NN_Tensor</a>的指针，设置单个输入所对应的张量。</td> </tr> <tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nn-memory">const OH_NN_Memory</a> *memory</td> <td class="cellrowborder" width="50%">指向<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nn-memory">OH_NN_Memory</a>的指针。</td> </tr>  </tbody></table></div> </div> <p><strong>返回：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.28.14.1.3.1.1" width="50%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.28.14.1.3.1.2" width="50%">说明</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-type-h#oh_nn_returncode">OH_NN_ReturnCode</a></td> <td class="cellrowborder" width="50%">函数执行的结果状态。执行成功返回OH_NN_SUCCESS；失败返回具体错误码，具体失败错误码可参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-type-h#oh_nn_returncode">OH_NN_ReturnCode</a>。</td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h3 id="oh_nnexecutor_setoutputwithmemory" device-type="phone,2in1,tablet">OH_NNExecutor_SetOutputWithMemory()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="oh_nnexecutor_setoutputwithmemory" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><div _ngcontent-edy-c106="" class="highlight-div"><div _ngcontent-edy-c106="" class="highlight-div-header"><div _ngcontent-edy-c106="" class="highlight-div-header-left"><div _ngcontent-edy-c106="" class="handle-button expand-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-edy-c106="" class="highlight-div-header-right"><div _ngcontent-edy-c106="" class="handle-button ai-button"></div><div _ngcontent-edy-c106="" class="handle-button line-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-edy-c106="" class="handle-button theme-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-edy-c106="" class="handle-button copy-button"><div _ngcontent-edy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-edy-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-function">OH_NN_ReturnCode <span class="hljs-title">OH_NNExecutor_SetOutputWithMemory</span><span class="hljs-params">(OH_NNExecutor *executor,<span class="hljs-type">uint32_t</span> outputIndex,<span class="hljs-type">const</span> OH_NN_Memory *memory)</span></span></li></ol></pre></div></div> <p><strong>描述</strong></p> <p>将<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nn-memory">OH_NN_Memory</a>实例指向的硬件共享内存，并指定为单个输出使用的内存。</p> <p>在需要自行管理内存的场景下，该接口将执行输出和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nn-memory">OH_NN_Memory</a>内存实例绑定。</p> <p>执行计算时，底层硬件将计算结果直接写入内存实例指向的共享内存。</p> <p>通过该接口，可以实现设置输入、执行计算、读取输出的并发执行，提升数据流的推理效率。</p> <p><strong>起始版本：</strong> 9</p> <p><strong>废弃版本：</strong> 11</p> <p><strong>替代接口：</strong> <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-core-h#oh_nnexecutor_runsync">OH_NNExecutor_RunSync</a></p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.29.12.1.3.1.1" width="50%">参数项</th> <th align="left" class="cellrowborder" id="mcps1.3.29.12.1.3.1.2" width="50%">描述</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nnexecutor">OH_NNExecutor</a> *executor</td> <td class="cellrowborder" width="50%">执行器。</td> </tr> <tr><td class="cellrowborder" width="50%">uint32_t outputIndex</td> <td class="cellrowborder" width="50%"><p>输出的索引值，与调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnmodel_specifyinputsandoutputs">OH_NNModel_SpecifyInputsAndOutputs</a>时输出数据的顺序一致。</p> <p>假设调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-h#oh_nnmodel_specifyinputsandoutputs">OH_NNModel_SpecifyInputsAndOutputs</a>时，outputIndices为{4, 6, 8}，则在指定输出的共享内存时，三个输出的索引值分别为{0, 1, 2}。</p> </td> </tr> <tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nn-memory">const OH_NN_Memory</a> *memory</td> <td class="cellrowborder" width="50%">指向<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-oh-nn-memory">OH_NN_Memory</a>的指针。</td> </tr>  </tbody></table></div> </div> <p><strong>返回：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.29.14.1.3.1.1" width="50%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.29.14.1.3.1.2" width="50%">说明</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-type-h#oh_nn_returncode">OH_NN_ReturnCode</a></td> <td class="cellrowborder" width="50%">函数执行的结果状态。执行成功返回OH_NN_SUCCESS；失败返回具体错误码，具体失败错误码可参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neural-network-runtime-type-h#oh_nn_returncode">OH_NN_ReturnCode</a>。</td> </tr>  </tbody></table></div> </div> </div> </div> <div></div></div>