<h1 _ngcontent-thq-c119="" class="doc-title ng-star-inserted" title="oh_file_share.h"> oh_file_share.h </h1>

<div _ngcontent-thq-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div> <div class="tiledSection"><h2 id="概述" device-type="phone,2in1,tablet,tv">概述<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="概述" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span></div><p>提供基于URI的文件及目录授予持久化权限、权限激活、权限查询等方法。</p> <p><strong>引用文件：</strong> &lt;filemanagement/fileshare/oh_file_share.h&gt;</p> <p><strong>库：</strong> libohfileshare.so</p> <p><strong>系统能力：</strong> SystemCapability.FileManagement.AppFileService.FolderAuthorization</p> <p><strong>起始版本：</strong> 12</p> <p><strong>相关模块：</strong> <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-fileshare">fileShare</a></p> </div>  <div class="tiledSection"><h2 id="汇总" device-type="phone,2in1,tablet,tv">汇总<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="汇总" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span></div></div>  <div class="tiledSection"><h3 id="结构体" device-type="phone,2in1,tablet,tv" class="firsth2">结构体<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="结构体" tips="复制节点链接"></i></h3> <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span></div><div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.3.2.1.4.1.1" width="33.33333333333333%">名称</th> <th align="left" class="cellrowborder" id="mcps1.3.3.2.1.4.1.2" width="33.33333333333333%">typedef关键字</th> <th align="left" class="cellrowborder" id="mcps1.3.3.2.1.4.1.3" width="33.33333333333333%">描述</th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="33.33333333333333%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-fileshare-fileshare-policyerrorresult">FileShare_PolicyErrorResult</a></td> <td class="cellrowborder" width="33.33333333333333%">FileShare_PolicyErrorResult</td> <td class="cellrowborder" width="33.33333333333333%">授予或使能权限失败的URI策略结果。</td> </tr> <tr><td class="cellrowborder" width="33.33333333333333%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-fileshare-fileshare-policyinfo">FileShare_PolicyInfo</a></td> <td class="cellrowborder" width="33.33333333333333%">FileShare_PolicyInfo</td> <td class="cellrowborder" width="33.33333333333333%">需要授予或使能权限URI的策略信息。</td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h3 id="枚举" device-type="phone,2in1,tablet,tv">枚举<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="枚举" tips="复制节点链接"></i></h3> <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span></div><div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.4.2.1.4.1.1" width="33.33333333333333%">名称</th> <th align="left" class="cellrowborder" id="mcps1.3.4.2.1.4.1.2" width="33.33333333333333%">typedef关键字</th> <th align="left" class="cellrowborder" id="mcps1.3.4.2.1.4.1.3" width="33.33333333333333%">描述</th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="33.33333333333333%"><a href="/consumer/cn/doc/harmonyos-references/capi-oh-file-share-h#fileshare_operationmode">FileShare_OperationMode</a></td> <td class="cellrowborder" width="33.33333333333333%">FileShare_OperationMode</td> <td class="cellrowborder" width="33.33333333333333%">URI操作模式枚举值。</td> </tr> <tr><td class="cellrowborder" width="33.33333333333333%"><a href="/consumer/cn/doc/harmonyos-references/capi-oh-file-share-h#fileshare_policyerrorcode">FileShare_PolicyErrorCode</a></td> <td class="cellrowborder" width="33.33333333333333%">FileShare_PolicyErrorCode</td> <td class="cellrowborder" width="33.33333333333333%">授予或使能权限策略失败的URI对应的错误码。</td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h3 id="函数" device-type="phone,2in1,tablet,tv">函数<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="函数" tips="复制节点链接"></i></h3> <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span></div><div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.5.2.1.3.1.1" width="50%">名称</th> <th align="left" class="cellrowborder" id="mcps1.3.5.2.1.3.1.2" width="50%">描述</th> </tr><tr><td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/capi-oh-file-share-h#oh_fileshare_persistpermission">FileManagement_ErrCode OH_FileShare_PersistPermission(const FileShare_PolicyInfo *policies, unsigned int policyNum, FileShare_PolicyErrorResult **result, unsigned int *resultNum)</a></td> <td class="cellrowborder" width="50%">对所选择的多个文件或目录URI持久化授权。</td> </tr> <tr><td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/capi-oh-file-share-h#oh_fileshare_revokepermission">FileManagement_ErrCode OH_FileShare_RevokePermission(const FileShare_PolicyInfo *policies, unsigned int policyNum, FileShare_PolicyErrorResult **result, unsigned int *resultNum)</a></td> <td class="cellrowborder" width="50%">对所选择的多个文件或目录URI取消持久化授权。</td> </tr> <tr><td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/capi-oh-file-share-h#oh_fileshare_activatepermission">FileManagement_ErrCode OH_FileShare_ActivatePermission(const FileShare_PolicyInfo *policies, unsigned int policyNum, FileShare_PolicyErrorResult **result, unsigned int *resultNum)</a></td> <td class="cellrowborder" width="50%">使能多个已经持久化授权的文件或目录。</td> </tr> <tr><td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/capi-oh-file-share-h#oh_fileshare_deactivatepermission">FileManagement_ErrCode OH_FileShare_DeactivatePermission(const FileShare_PolicyInfo *policies, unsigned int policyNum, FileShare_PolicyErrorResult **result, unsigned int *resultNum)</a></td> <td class="cellrowborder" width="50%">取消使能持久化授权过的多个文件或目录。</td> </tr> <tr><td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/capi-oh-file-share-h#oh_fileshare_checkpersistentpermission">FileManagement_ErrCode OH_FileShare_CheckPersistentPermission(const FileShare_PolicyInfo *policies, unsigned int policyNum, bool **result, unsigned int *resultNum)</a></td> <td class="cellrowborder" width="50%">校验所选择的多个文件或目录URI的持久化授权。</td> </tr> <tr><td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/capi-oh-file-share-h#oh_fileshare_releasepolicyerrorresult">void OH_FileShare_ReleasePolicyErrorResult(FileShare_PolicyErrorResult *errorResult, unsigned int resultNum)</a></td> <td class="cellrowborder" width="50%">释放FileShare_PolicyErrorResult指针指向的内存资源。</td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h2 id="枚举类型说明" device-type="phone,2in1,tablet,tv">枚举类型说明<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="枚举类型说明" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span></div></div>  <div class="tiledSection"><h3 id="fileshare_operationmode" device-type="phone,2in1,tablet,tv" class="firsth2">FileShare_OperationMode<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="fileshare_operationmode" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span></div><div _ngcontent-thq-c106="" class="highlight-div"><div _ngcontent-thq-c106="" class="highlight-div-header"><div _ngcontent-thq-c106="" class="highlight-div-header-left"><div _ngcontent-thq-c106="" class="handle-button expand-button"><div _ngcontent-thq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-thq-c106="" class="highlight-div-header-right"><div _ngcontent-thq-c106="" class="handle-button ai-button"></div><div _ngcontent-thq-c106="" class="handle-button line-button"><div _ngcontent-thq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-thq-c106="" class="handle-button theme-button"><div _ngcontent-thq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-thq-c106="" class="handle-button copy-button"><div _ngcontent-thq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-thq-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">enum</span> <span class="hljs-title class_">FileShare_OperationMode</span></li></ol></pre></div></div> <p><strong>描述</strong></p> <p>URI操作模式枚举值。</p> <p><strong>起始版本：</strong> 12</p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.7.6.1.3.1.1" width="50%">枚举项</th> <th align="left" class="cellrowborder" id="mcps1.3.7.6.1.3.1.2" width="50%">描述</th> </tr><tr><td class="cellrowborder" width="50%">READ_MODE = 1 &lt;&lt; 0</td> <td class="cellrowborder" width="50%">读取权限。</td> </tr> <tr><td class="cellrowborder" width="50%">WRITE_MODE = 1 &lt;&lt; 1</td> <td class="cellrowborder" width="50%">写入权限。</td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h3 id="fileshare_policyerrorcode" device-type="phone,2in1,tablet,tv">FileShare_PolicyErrorCode<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="fileshare_policyerrorcode" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span></div><div _ngcontent-thq-c106="" class="highlight-div"><div _ngcontent-thq-c106="" class="highlight-div-header"><div _ngcontent-thq-c106="" class="highlight-div-header-left"><div _ngcontent-thq-c106="" class="handle-button expand-button"><div _ngcontent-thq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-thq-c106="" class="highlight-div-header-right"><div _ngcontent-thq-c106="" class="handle-button ai-button"></div><div _ngcontent-thq-c106="" class="handle-button line-button"><div _ngcontent-thq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-thq-c106="" class="handle-button theme-button"><div _ngcontent-thq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-thq-c106="" class="handle-button copy-button"><div _ngcontent-thq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-thq-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">enum</span> <span class="hljs-title class_">FileShare_PolicyErrorCode</span></li></ol></pre></div></div> <p><strong>描述</strong></p> <p>授予或使能权限策略失败的URI对应的错误码。</p> <p><strong>起始版本：</strong> 12</p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.8.6.1.3.1.1" width="50%">枚举项</th> <th align="left" class="cellrowborder" id="mcps1.3.8.6.1.3.1.2" width="50%">描述</th> </tr><tr><td class="cellrowborder" width="50%">PERSISTENCE_FORBIDDEN = 1</td> <td class="cellrowborder" width="50%">URI禁止被持久化。</td> </tr> <tr><td class="cellrowborder" width="50%">INVALID_MODE = 2</td> <td class="cellrowborder" width="50%">无效的模式。</td> </tr> <tr><td class="cellrowborder" width="50%">INVALID_PATH = 3</td> <td class="cellrowborder" width="50%">无效路径。</td> </tr> <tr><td class="cellrowborder" width="50%">PERMISSION_NOT_PERSISTED = 4</td> <td class="cellrowborder" width="50%">权限没有被持久化。</td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h2 id="函数说明" device-type="phone,2in1,tablet,tv">函数说明<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="函数说明" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span></div></div>  <div class="tiledSection"><h3 id="oh_fileshare_persistpermission" device-type="phone,2in1,tablet,tv" class="firsth2">OH_FileShare_PersistPermission()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="oh_fileshare_persistpermission" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span></div><div _ngcontent-thq-c106="" class="highlight-div"><div _ngcontent-thq-c106="" class="highlight-div-header"><div _ngcontent-thq-c106="" class="highlight-div-header-left"><div _ngcontent-thq-c106="" class="handle-button expand-button"><div _ngcontent-thq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-thq-c106="" class="highlight-div-header-right"><div _ngcontent-thq-c106="" class="handle-button ai-button"></div><div _ngcontent-thq-c106="" class="handle-button line-button"><div _ngcontent-thq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-thq-c106="" class="handle-button theme-button"><div _ngcontent-thq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-thq-c106="" class="handle-button copy-button"><div _ngcontent-thq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-thq-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-function">FileManagement_ErrCode <span class="hljs-title">OH_FileShare_PersistPermission</span><span class="hljs-params">(<span class="hljs-type">const</span> FileShare_PolicyInfo *policies, <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> policyNum, FileShare_PolicyErrorResult **result, <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> *resultNum)</span></span></li></ol></pre></div></div> <p><strong>描述</strong></p> <p>对所选择的多个文件或目录URI持久化授权。</p> <p><strong>需要权限：</strong> ohos.permission.FILE_ACCESS_PERSIST</p> <p><strong>起始版本：</strong> 12</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.10.8.1.3.1.1" width="50%">参数项</th> <th align="left" class="cellrowborder" id="mcps1.3.10.8.1.3.1.2" width="50%">描述</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-fileshare-fileshare-policyinfo">const FileShare_PolicyInfo</a> *policies</td> <td class="cellrowborder" width="50%">一个指向FileShare_PolicyInfo实例的指针。</td> </tr> <tr><td class="cellrowborder" width="50%">unsigned int policyNum</td> <td class="cellrowborder" width="50%">FileShare_PolicyInfo实例数组的大小。</td> </tr> <tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-fileshare-fileshare-policyerrorresult">FileShare_PolicyErrorResult</a> **result</td> <td class="cellrowborder" width="50%">FileShare_PolicyErrorResult数组指针。请使用OH_FileShare_ReleasePolicyErrorResult()进行资源释放。</td> </tr> <tr><td class="cellrowborder" width="50%">unsigned int *resultNum</td> <td class="cellrowborder" width="50%">FileShare_PolicyErrorResult数组大小。</td> </tr>  </tbody></table></div> </div> <p><strong>返回：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.10.10.1.3.1.1" width="50%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.10.10.1.3.1.2" width="50%">说明</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-error-code-h#filemanagement_errcode">FileManagement_ErrCode</a></td> <td class="cellrowborder" width="50%"><p>返回FileManagement模块错误码<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-error-code-h#filemanagement_errcode">FileManagement_ErrCode</a>。</p> <p> ERR_INVALID_PARAMETER 401 - 输入参数无效。可能的原因有：</p> <p> 1. 参数policies或参数result或参数resultNum为空指针；</p> <p> 2. 参数policyNum值为0或者超过最大长度(500)；</p> <p> 3. 参数policies中携带的uri为空或者length为0或者uri的长度与length不一致。</p> <p> ERR_DEVICE_NOT_SUPPORTED 801 - 当前设备类型不支持此接口。</p> <p> ERR_PERMISSION_ERROR 201 - 接口权限校验失败。</p> <p> ERR_ENOMEM 13900011 - 分配或者拷贝内存失败。</p> <p> ERR_EPERM 13900001 - 操作不被允许。</p> <p> ERR_OK 0 - 接口调用成功。</p> </td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h3 id="oh_fileshare_revokepermission" device-type="phone,2in1,tablet,tv">OH_FileShare_RevokePermission()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="oh_fileshare_revokepermission" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span></div><div _ngcontent-thq-c106="" class="highlight-div"><div _ngcontent-thq-c106="" class="highlight-div-header"><div _ngcontent-thq-c106="" class="highlight-div-header-left"><div _ngcontent-thq-c106="" class="handle-button expand-button"><div _ngcontent-thq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-thq-c106="" class="highlight-div-header-right"><div _ngcontent-thq-c106="" class="handle-button ai-button"></div><div _ngcontent-thq-c106="" class="handle-button line-button"><div _ngcontent-thq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-thq-c106="" class="handle-button theme-button"><div _ngcontent-thq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-thq-c106="" class="handle-button copy-button"><div _ngcontent-thq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-thq-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-function">FileManagement_ErrCode <span class="hljs-title">OH_FileShare_RevokePermission</span><span class="hljs-params">(<span class="hljs-type">const</span> FileShare_PolicyInfo *policies, <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> policyNum, FileShare_PolicyErrorResult **result, <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> *resultNum)</span></span></li></ol></pre></div></div> <p><strong>描述</strong></p> <p>对所选择的多个文件或目录URI取消持久化授权。</p> <p><strong>需要权限：</strong> ohos.permission.FILE_ACCESS_PERSIST</p> <p><strong>起始版本：</strong> 12</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.11.8.1.3.1.1" width="50%">参数项</th> <th align="left" class="cellrowborder" id="mcps1.3.11.8.1.3.1.2" width="50%">描述</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-fileshare-fileshare-policyinfo">const FileShare_PolicyInfo</a> *policies</td> <td class="cellrowborder" width="50%">一个指向FileShare_PolicyInfo实例的指针。</td> </tr> <tr><td class="cellrowborder" width="50%">unsigned int policyNum</td> <td class="cellrowborder" width="50%">FileShare_PolicyInfo实例数组的大小。</td> </tr> <tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-fileshare-fileshare-policyerrorresult">FileShare_PolicyErrorResult</a> **result</td> <td class="cellrowborder" width="50%">FileShare_PolicyErrorResult数组指针。请使用OH_FileShare_ReleasePolicyErrorResult()进行资源释放。</td> </tr> <tr><td class="cellrowborder" width="50%">unsigned int *resultNum</td> <td class="cellrowborder" width="50%">FileShare_PolicyErrorResult数组大小。</td> </tr>  </tbody></table></div> </div> <p><strong>返回：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.11.10.1.3.1.1" width="50%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.11.10.1.3.1.2" width="50%">说明</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-error-code-h#filemanagement_errcode">FileManagement_ErrCode</a></td> <td class="cellrowborder" width="50%"><p>返回FileManagement模块错误码<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-error-code-h#filemanagement_errcode">FileManagement_ErrCode</a>。</p> <p> ERR_INVALID_PARAMETER 401 - 输入参数无效。可能的原因有：1. 参数policies或参数result或参数resultNum为空指针；</p> <p> 2. 参数policyNum值为0或者超过最大长度(500)；3. 参数policies中携带的uri为空或者length为0或者uri的长度与length不一致。</p> <p> ERR_DEVICE_NOT_SUPPORTED 801 - 当前设备类型不支持此接口。</p> <p> E_PERMISSION 201 - 接口权限校验失败。</p> <p> ERR_ENOMEM 13900011 - 分配或者拷贝内存失败。</p> <p> ERR_EPERM 13900001 - 操作不被允许。</p> <p> ERR_OK - 接口调用成功。</p> </td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h3 id="oh_fileshare_activatepermission" device-type="phone,2in1,tablet,tv">OH_FileShare_ActivatePermission()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="oh_fileshare_activatepermission" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span></div><div _ngcontent-thq-c106="" class="highlight-div"><div _ngcontent-thq-c106="" class="highlight-div-header"><div _ngcontent-thq-c106="" class="highlight-div-header-left"><div _ngcontent-thq-c106="" class="handle-button expand-button"><div _ngcontent-thq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-thq-c106="" class="highlight-div-header-right"><div _ngcontent-thq-c106="" class="handle-button ai-button"></div><div _ngcontent-thq-c106="" class="handle-button line-button"><div _ngcontent-thq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-thq-c106="" class="handle-button theme-button"><div _ngcontent-thq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-thq-c106="" class="handle-button copy-button"><div _ngcontent-thq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-thq-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-function">FileManagement_ErrCode <span class="hljs-title">OH_FileShare_ActivatePermission</span><span class="hljs-params">(<span class="hljs-type">const</span> FileShare_PolicyInfo *policies, <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> policyNum, FileShare_PolicyErrorResult **result, <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> *resultNum)</span></span></li></ol></pre></div></div> <p><strong>描述</strong></p> <p>使能多个已经持久化授权的文件或目录。</p> <p><strong>需要权限：</strong> ohos.permission.FILE_ACCESS_PERSIST</p> <p><strong>起始版本：</strong> 12</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.12.8.1.3.1.1" width="50%">参数项</th> <th align="left" class="cellrowborder" id="mcps1.3.12.8.1.3.1.2" width="50%">描述</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-fileshare-fileshare-policyinfo">const FileShare_PolicyInfo</a> *policies</td> <td class="cellrowborder" width="50%">一个指向FileShare_PolicyInfo实例的指针。</td> </tr> <tr><td class="cellrowborder" width="50%">unsigned int policyNum</td> <td class="cellrowborder" width="50%">FileShare_PolicyInfo实例数组的大小。</td> </tr> <tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-fileshare-fileshare-policyerrorresult">FileShare_PolicyErrorResult</a> **result</td> <td class="cellrowborder" width="50%">FileShare_PolicyErrorResult数组指针。请使用OH_FileShare_ReleasePolicyErrorResult()进行资源释放。</td> </tr> <tr><td class="cellrowborder" width="50%">unsigned int *resultNum</td> <td class="cellrowborder" width="50%">FileShare_PolicyErrorResult数组大小。</td> </tr>  </tbody></table></div> </div> <p><strong>返回：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.12.10.1.3.1.1" width="50%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.12.10.1.3.1.2" width="50%">说明</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-error-code-h#filemanagement_errcode">FileManagement_ErrCode</a></td> <td class="cellrowborder" width="50%"><p>返回FileManagement模块错误码<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-error-code-h#filemanagement_errcode">FileManagement_ErrCode</a>。</p> <p> ERR_INVALID_PARAMETER 401 - 输入参数无效。可能的原因有：</p> <p> 1. 参数policies或参数result或参数resultNum为空指针；</p> <p> 2. 参数policyNum值为0或者超过最大长度(500)；</p> <p> 3. 参数policies中携带的uri为空或者length为0或者uri的长度与length不一致。</p> <p> ERR_DEVICE_NOT_SUPPORTED 801 - 当前设备类型不支持此接口。</p> <p> ERR_PERMISSION_ERROR 201 - 接口权限校验失败。</p> <p> ERR_ENOMEM 13900011 - 分配或者拷贝内存失败。</p> <p> ERR_EPERM 13900001 - 操作不被允许。</p> <p> ERR_OK 0 - 接口调用成功。</p> </td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h3 id="oh_fileshare_deactivatepermission" device-type="phone,2in1,tablet,tv">OH_FileShare_DeactivatePermission()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="oh_fileshare_deactivatepermission" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span></div><div _ngcontent-thq-c106="" class="highlight-div"><div _ngcontent-thq-c106="" class="highlight-div-header"><div _ngcontent-thq-c106="" class="highlight-div-header-left"><div _ngcontent-thq-c106="" class="handle-button expand-button"><div _ngcontent-thq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-thq-c106="" class="highlight-div-header-right"><div _ngcontent-thq-c106="" class="handle-button ai-button"></div><div _ngcontent-thq-c106="" class="handle-button line-button"><div _ngcontent-thq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-thq-c106="" class="handle-button theme-button"><div _ngcontent-thq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-thq-c106="" class="handle-button copy-button"><div _ngcontent-thq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-thq-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-function">FileManagement_ErrCode <span class="hljs-title">OH_FileShare_DeactivatePermission</span><span class="hljs-params">(<span class="hljs-type">const</span> FileShare_PolicyInfo *policies, <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> policyNum, FileShare_PolicyErrorResult **result, <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> *resultNum)</span></span></li></ol></pre></div></div> <p><strong>描述</strong></p> <p>取消使能持久化授权过的多个文件或目录。</p> <p><strong>需要权限：</strong> ohos.permission.FILE_ACCESS_PERSIST</p> <p><strong>起始版本：</strong> 12</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.13.8.1.3.1.1" width="50%">参数项</th> <th align="left" class="cellrowborder" id="mcps1.3.13.8.1.3.1.2" width="50%">描述</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-fileshare-fileshare-policyinfo">const FileShare_PolicyInfo</a> *policies</td> <td class="cellrowborder" width="50%">一个指向FileShare_PolicyInfo实例的指针。</td> </tr> <tr><td class="cellrowborder" width="50%">unsigned int policyNum</td> <td class="cellrowborder" width="50%">FileShare_PolicyInfo实例数组的大小。</td> </tr> <tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-fileshare-fileshare-policyerrorresult">FileShare_PolicyErrorResult</a> **result</td> <td class="cellrowborder" width="50%">FileShare_PolicyErrorResult数组指针。请使用OH_FileShare_ReleasePolicyErrorResult()进行资源释放。</td> </tr> <tr><td class="cellrowborder" width="50%">unsigned int *resultNum</td> <td class="cellrowborder" width="50%">FileShare_PolicyErrorResult数组大小。</td> </tr>  </tbody></table></div> </div> <p><strong>返回：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.13.10.1.3.1.1" width="50%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.13.10.1.3.1.2" width="50%">说明</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-error-code-h#filemanagement_errcode">FileManagement_ErrCode</a></td> <td class="cellrowborder" width="50%"><p>返回FileManagement模块错误码<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-error-code-h#filemanagement_errcode">FileManagement_ErrCode</a>。</p> <p> ERR_INVALID_PARAMETER 401 - 输入参数无效。可能的原因有：</p> <p> 1. 参数policies或参数result或参数resultNum为空指针；</p> <p> 2. 参数policyNum值为0或者超过最大长度(500)；</p> <p> 3. 参数policies中携带的uri为空或者length为0或者uri的长度与length不一致。</p> <p> ERR_DEVICE_NOT_SUPPORTED 801 - 当前设备类型不支持此接口。</p> <p> ERR_PERMISSION_ERROR 201 - 接口权限校验失败。</p> <p> ERR_ENOMEM 13900011 - 分配或者拷贝内存失败。</p> <p> ERR_EPERM 13900001 - 操作不被允许。</p> <p> ERR_OK - 接口调用成功。</p> </td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h3 id="oh_fileshare_checkpersistentpermission" device-type="phone,2in1,tablet,tv">OH_FileShare_CheckPersistentPermission()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="oh_fileshare_checkpersistentpermission" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span></div><div _ngcontent-thq-c106="" class="highlight-div"><div _ngcontent-thq-c106="" class="highlight-div-header"><div _ngcontent-thq-c106="" class="highlight-div-header-left"><div _ngcontent-thq-c106="" class="handle-button expand-button"><div _ngcontent-thq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-thq-c106="" class="highlight-div-header-right"><div _ngcontent-thq-c106="" class="handle-button ai-button"></div><div _ngcontent-thq-c106="" class="handle-button line-button"><div _ngcontent-thq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-thq-c106="" class="handle-button theme-button"><div _ngcontent-thq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-thq-c106="" class="handle-button copy-button"><div _ngcontent-thq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-thq-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-function">FileManagement_ErrCode <span class="hljs-title">OH_FileShare_CheckPersistentPermission</span><span class="hljs-params">(<span class="hljs-type">const</span> FileShare_PolicyInfo *policies, <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> policyNum, <span class="hljs-type">bool</span> **result, <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> *resultNum)</span></span></li></ol></pre></div></div> <p><strong>描述</strong></p> <p>校验所选择的多个文件或目录URI的持久化授权。</p> <p><strong>需要权限：</strong> ohos.permission.FILE_ACCESS_PERSIST</p> <p><strong>起始版本：</strong> 12</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.14.8.1.3.1.1" width="50%">参数项</th> <th align="left" class="cellrowborder" id="mcps1.3.14.8.1.3.1.2" width="50%">描述</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-fileshare-fileshare-policyinfo">const FileShare_PolicyInfo</a> *policies</td> <td class="cellrowborder" width="50%">一个指向FileShare_PolicyInfo实例的指针。</td> </tr> <tr><td class="cellrowborder" width="50%">unsigned int policyNum</td> <td class="cellrowborder" width="50%">FileShare_PolicyInfo实例数组的大小。</td> </tr> <tr><td class="cellrowborder" width="50%">bool **result</td> <td class="cellrowborder" width="50%">授权校验结果指针。true表示有持久化授权；false表示不具有持久化授权。请引用头文件malloc.h并使用free()进行资源释放。</td> </tr> <tr><td class="cellrowborder" width="50%">unsigned int *resultNum</td> <td class="cellrowborder" width="50%">校验结果数组的大小。</td> </tr>  </tbody></table></div> </div> <p><strong>返回：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.14.10.1.3.1.1" width="50%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.14.10.1.3.1.2" width="50%">说明</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-error-code-h#filemanagement_errcode">FileManagement_ErrCode</a></td> <td class="cellrowborder" width="50%"><p>返回FileManagement模块错误码<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-error-code-h#filemanagement_errcode">FileManagement_ErrCode</a>。</p> <p> ERR_INVALID_PARAMETER 401 - 输入参数无效。可能的原因有：</p> <p> 1. 参数policies或参数result或参数resultNum为空指针；</p> <p> 2. 参数policyNum值为0或者超过最大长度(500)；</p> <p> 3. 参数policies中携带的uri为空或者length为0或者uri的长度与length不一致。</p> <p> ERR_DEVICE_NOT_SUPPORTED 801 - 当前设备类型不支持此接口。</p> <p> ERR_PERMISSION_ERROR 201 - 接口权限校验失败。</p> <p> ERR_ENOMEM 13900011 - 分配或者拷贝内存失败。</p> <p> ERR_EPERM 13900001 - 操作不被允许。可能的原因为policies中携带的所有uri都不符合规范或者uri转换出来的路径不存在。</p> <p> ERR_OK 0 - 接口调用成功。</p> </td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h3 id="oh_fileshare_releasepolicyerrorresult" device-type="phone,2in1,tablet,tv">OH_FileShare_ReleasePolicyErrorResult()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="oh_fileshare_releasepolicyerrorresult" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span></div><div _ngcontent-thq-c106="" class="highlight-div"><div _ngcontent-thq-c106="" class="highlight-div-header"><div _ngcontent-thq-c106="" class="highlight-div-header-left"><div _ngcontent-thq-c106="" class="handle-button expand-button"><div _ngcontent-thq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-thq-c106="" class="highlight-div-header-right"><div _ngcontent-thq-c106="" class="handle-button ai-button"></div><div _ngcontent-thq-c106="" class="handle-button line-button"><div _ngcontent-thq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-thq-c106="" class="handle-button theme-button"><div _ngcontent-thq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-thq-c106="" class="handle-button copy-button"><div _ngcontent-thq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-thq-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">OH_FileShare_ReleasePolicyErrorResult</span><span class="hljs-params">(FileShare_PolicyErrorResult *errorResult, <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> resultNum)</span></span></li></ol></pre></div></div> <p><strong>描述</strong></p> <p>释放FileShare_PolicyErrorResult指针指向的内存资源。</p> <p><strong>起始版本：</strong> 12</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.15.7.1.3.1.1" width="50%">参数项</th> <th align="left" class="cellrowborder" id="mcps1.3.15.7.1.3.1.2" width="50%">描述</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-fileshare-fileshare-policyerrorresult">FileShare_PolicyErrorResult</a> *errorResult</td> <td class="cellrowborder" width="50%">一个指向FileShare_PolicyErrorResult实例的指针。</td> </tr> <tr><td class="cellrowborder" width="50%">unsigned int resultNum</td> <td class="cellrowborder" width="50%">FileShare_PolicyErrorResult实例数组的大小。</td> </tr>  </tbody></table></div> </div> </div> </div> <div></div></div>