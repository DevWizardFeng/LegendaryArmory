<h1 _ngcontent-hyu-c119="" class="doc-title ng-star-inserted" title="paymentService (鸿蒙支付服务)"> paymentService (鸿蒙支付服务) </h1>

<div _ngcontent-hyu-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div><p>本模块提供支付、签约服务能力，包括基础支付、支付并签约、合单支付、签约代扣等。</p> <p><strong>起始版本：</strong>4.1.0(11)</p> <div class="tiledSection"><h2 id="section164051883419" device-type="phone,tablet,2in1">导入模块<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section164051883419" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><div _ngcontent-hyu-c106="" class="highlight-div"><div _ngcontent-hyu-c106="" class="highlight-div-header"><div _ngcontent-hyu-c106="" class="highlight-div-header-left"><div _ngcontent-hyu-c106="" class="handle-button expand-button"><div _ngcontent-hyu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-hyu-c106="" class="highlight-div-header-right"><div _ngcontent-hyu-c106="" class="handle-button ai-button"></div><div _ngcontent-hyu-c106="" class="handle-button line-button"><div _ngcontent-hyu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-hyu-c106="" class="handle-button theme-button"><div _ngcontent-hyu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-hyu-c106="" class="handle-button copy-button"><div _ngcontent-hyu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-hyu-c106="" class="highlight-scroll-div"><pre class="javascript prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { paymentService } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PaymentKit'</span>;</li></ol></pre></div></div> </div> <div class="tiledSection"><h2 id="section363mcpsimp" device-type="phone,tablet,2in1">PayResult<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section363mcpsimp" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><p>用户在通用收银台选择支付方式并确认支付后的支付信息。</p> <p><strong>模型约束：</strong>此接口仅可在Stage模型下使用。</p> <p><strong>元服务API</strong>： 从版本5.0.2(14)开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong>SystemCapability.Payment.PaymentService</p> <p><strong>起始版本：</strong>5.0.2(14)</p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.4.7.1.6.1.1" width="20.349999999999998%"><p><strong>名称</strong></p> </th> <th align="left" class="cellrowborder" id="mcps1.3.4.7.1.6.1.2" width="12.93%"><p><strong>类型</strong></p> </th> <th align="left" class="cellrowborder" id="mcps1.3.4.7.1.6.1.3" width="7.5200000000000005%"><p>只读</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.4.7.1.6.1.4" width="6.4799999999999995%"><p>可选</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.4.7.1.6.1.5" width="52.72%"><p><strong>说明</strong></p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="20.349999999999998%"><p>selectedPaymentType</p> </td> <td class="cellrowborder" width="12.93%"><p>string</p> </td> <td class="cellrowborder" width="7.5200000000000005%"><p>否</p> </td> <td class="cellrowborder" width="6.4799999999999995%"><p>是</p> </td> <td class="cellrowborder" width="52.72%"><p>用户选择的支付方式。</p> <ul><li>wechat_pay：微信支付</li><li>ali_pay：支付宝支付</li></ul> <ul><li>其他（其他为商户申请配置三方支付方式时所申请的三方支付相关配置）</li></ul> </td> </tr> <tr><td class="cellrowborder" width="20.349999999999998%"><p>clientToken</p> </td> <td class="cellrowborder" width="12.93%"><p>string</p> </td> <td class="cellrowborder" width="7.5200000000000005%"><p>否</p> </td> <td class="cellrowborder" width="6.4799999999999995%"><p>是</p> </td> <td class="cellrowborder" width="52.72%"><p>客户端凭证。</p> </td> </tr> <tr><td class="cellrowborder" width="20.349999999999998%"><p>nextStep</p> </td> <td class="cellrowborder" width="12.93%"><p>string</p> </td> <td class="cellrowborder" width="7.5200000000000005%"><p>否</p> </td> <td class="cellrowborder" width="6.4799999999999995%"><p>是</p> </td> <td class="cellrowborder" width="52.72%"><p>下一步支付流程。</p> </td> </tr> <tr><td class="cellrowborder" width="20.349999999999998%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-model#section151931211104318">extraInfo</a></p> </td> <td class="cellrowborder" width="12.93%"><p>string</p> </td> <td class="cellrowborder" width="7.5200000000000005%"><p>否</p> </td> <td class="cellrowborder" width="6.4799999999999995%"><p>是</p> </td> <td class="cellrowborder" width="52.72%"><p>保留字段。json string格式。</p> </td> </tr> <tr><td class="cellrowborder" width="20.349999999999998%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-model#section17853161714224">payload</a></p> </td> <td class="cellrowborder" width="12.93%"><p>string</p> </td> <td class="cellrowborder" width="7.5200000000000005%"><p>否</p> </td> <td class="cellrowborder" width="6.4799999999999995%"><p>是</p> </td> <td class="cellrowborder" width="52.72%"><p>预留信息，在请求接口时，入参如果传递，接口响应中则会原样返回。</p> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p>拉起H5支付场景下需要固定传递“AP”。</p> </div></div></div> </td> </tr>  </tbody></table></div> </div> </div> <div class="tiledSection"><h2 id="section1158325715256" device-type="phone,tablet,2in1">PaymentInfo<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section1158325715256" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><p>三方支付拉起通用收银台时传入的支付订单信息。</p> <p><strong>模型约束：</strong>此接口仅可在Stage模型下使用。</p> <p><strong>元服务API</strong>： 从版本5.0.2(14)开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong>SystemCapability.Payment.PaymentService</p> <p><strong>起始版本：</strong>5.0.2(14)</p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.5.7.1.6.1.1" width="20.349999999999998%"><p><strong>名称</strong></p> </th> <th align="left" class="cellrowborder" id="mcps1.3.5.7.1.6.1.2" width="12.950000000000001%"><p><strong>类型</strong></p> </th> <th align="left" class="cellrowborder" id="mcps1.3.5.7.1.6.1.3" width="7.5200000000000005%"><p>只读</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.5.7.1.6.1.4" width="6.47%"><p>可选</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.5.7.1.6.1.5" width="52.71%"><p><strong>说明</strong></p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="20.349999999999998%"><p>tradeSummary</p> </td> <td class="cellrowborder" width="12.950000000000001%"><p>string</p> </td> <td class="cellrowborder" width="7.5200000000000005%"><p>否</p> </td> <td class="cellrowborder" width="6.47%"><p>是</p> </td> <td class="cellrowborder" width="52.71%"><p>订单的摘要信息。若未填写，默认为空。</p> </td> </tr> <tr><td class="cellrowborder" width="20.349999999999998%"><p>amount</p> </td> <td class="cellrowborder" width="12.950000000000001%"><p>number</p> </td> <td class="cellrowborder" width="7.5200000000000005%"><p>否</p> </td> <td class="cellrowborder" width="6.47%"><p>是</p> </td> <td class="cellrowborder" width="52.71%"><p>订单总金额（单位：分）。</p> </td> </tr> <tr><td class="cellrowborder" width="20.349999999999998%"><p>currency</p> </td> <td class="cellrowborder" width="12.950000000000001%"><p>string</p> </td> <td class="cellrowborder" width="7.5200000000000005%"><p>否</p> </td> <td class="cellrowborder" width="6.47%"><p>是</p> </td> <td class="cellrowborder" width="52.71%"><p>货币单位。若未填写，默认为空。</p> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><ul><li>不传递则收银台不显示货币单位。</li><li>传递后收银台可以转换成货币符号则显示货币符号（比如￥），转换不了则显示所传递的值。</li></ul> </div></div></div> </td> </tr> <tr><td class="cellrowborder" width="20.349999999999998%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-model#section151931211104318">extraInfo</a></p> </td> <td class="cellrowborder" width="12.950000000000001%"><p>string</p> </td> <td class="cellrowborder" width="7.5200000000000005%"><p>否</p> <p></p> </td> <td class="cellrowborder" width="6.47%"><p>是</p> </td> <td class="cellrowborder" width="52.71%"><p>保留字段。json string格式。若未填写，默认为空。</p> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><div class="p">商户可以通过保留字段指定支付方式。指定收银台支付方式列表传递内容示例如下：<div _ngcontent-hyu-c106="" class="highlight-div"><div _ngcontent-hyu-c106="" class="highlight-div-header"><div _ngcontent-hyu-c106="" class="highlight-div-header-left"><div _ngcontent-hyu-c106="" class="handle-button expand-button"><div _ngcontent-hyu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-hyu-c106="" class="highlight-div-header-right"><div _ngcontent-hyu-c106="" class="handle-button ai-button"></div><div _ngcontent-hyu-c106="" class="handle-button line-button"><div _ngcontent-hyu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-hyu-c106="" class="handle-button theme-button"><div _ngcontent-hyu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-hyu-c106="" class="handle-button copy-button"><div _ngcontent-hyu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-hyu-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-json" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-punctuation">{</span><span class="hljs-attr">"selectPayType"</span><span class="hljs-punctuation">:</span><span class="hljs-string">"wechat_pay|xxx"</span><span class="hljs-punctuation">}</span></li></ol></pre></div></div> </div> </div></div></div> </td> </tr>  </tbody></table></div> </div> </div> <div class="tiledSection"><h2 id="section1129353710263" device-type="phone,tablet,2in1">PickerResult<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section1129353710263" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><p>三方支付拉起通用收银台时响应给开发者的订单支付信息。</p> <p><strong>模型约束：</strong>此接口仅可在Stage模型下使用。</p> <p><strong>元服务API</strong>： 从版本5.0.2(14)开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong>SystemCapability.Payment.PaymentService</p> <p><strong>起始版本：</strong>5.0.2(14)</p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.6.7.1.6.1.1" width="20.349999999999998%"><p><strong>名称</strong></p> </th> <th align="left" class="cellrowborder" id="mcps1.3.6.7.1.6.1.2" width="12.950000000000001%"><p><strong>类型</strong></p> </th> <th align="left" class="cellrowborder" id="mcps1.3.6.7.1.6.1.3" width="7.5200000000000005%"><p>只读</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.6.7.1.6.1.4" width="6.47%"><p>可选</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.6.7.1.6.1.5" width="52.71%"><p><strong>说明</strong></p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="20.349999999999998%"><p>selectedPaymentType</p> </td> <td class="cellrowborder" width="12.950000000000001%"><p>string</p> </td> <td class="cellrowborder" width="7.5200000000000005%"><p>否</p> </td> <td class="cellrowborder" width="6.47%"><p>是</p> </td> <td class="cellrowborder" width="52.71%"><p>用户选择的支付方式。</p> <ul><li>wechat_pay：微信支付</li><li>ali_pay：支付宝支付</li><li>其他（其他为商户申请配置三方支付方式时所申请的相关配置）</li></ul> </td> </tr> <tr><td class="cellrowborder" width="20.349999999999998%"><p>clientToken</p> </td> <td class="cellrowborder" width="12.950000000000001%"><p>string</p> </td> <td class="cellrowborder" width="7.5200000000000005%"><p>否</p> </td> <td class="cellrowborder" width="6.47%"><p>是</p> </td> <td class="cellrowborder" width="52.71%"><p>客户端凭证。</p> </td> </tr>  </tbody></table></div> </div> </div> <div class="tiledSection"><h2 id="section1492519912514" device-type="phone,tablet,2in1">BindCardResult<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section1492519912514" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><p>绑卡结果信息。</p> <p><strong>模型约束：</strong>此接口仅可在Stage模型下使用。</p> <p><strong>元服务API</strong>： 从版本5.0.5(17)开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong>SystemCapability.Payment.PaymentService</p> <p><strong>起始版本：</strong>5.0.5(17)</p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.7.7.1.6.1.1" width="20.349999999999998%"><p><strong>名称</strong></p> </th> <th align="left" class="cellrowborder" id="mcps1.3.7.7.1.6.1.2" width="12.950000000000001%"><p><strong>类型</strong></p> </th> <th align="left" class="cellrowborder" id="mcps1.3.7.7.1.6.1.3" width="7.5200000000000005%"><p>只读</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.7.7.1.6.1.4" width="6.47%"><p>可选</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.7.7.1.6.1.5" width="52.71%"><p><strong>说明</strong></p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="20.349999999999998%"><p>hasBankCard</p> </td> <td class="cellrowborder" width="12.950000000000001%"><p>boolean</p> </td> <td class="cellrowborder" width="7.5200000000000005%"><p>否</p> </td> <td class="cellrowborder" width="6.47%"><p>否</p> </td> <td class="cellrowborder" width="52.71%"><p>用户当前是否有已绑定的银行卡。</p> <ul><li>true：是</li><li>false：否</li></ul> </td> </tr> <tr><td class="cellrowborder" width="20.349999999999998%"><p>hasJustBoundCard</p> </td> <td class="cellrowborder" width="12.950000000000001%"><p>boolean</p> </td> <td class="cellrowborder" width="7.5200000000000005%"><p>否</p> </td> <td class="cellrowborder" width="6.47%"><p>是</p> </td> <td class="cellrowborder" width="52.71%"><p>用户在拉起绑卡管理页面后是否完成了绑卡。</p> <ul><li>true：是</li><li>false：否</li></ul> </td> </tr>  </tbody></table></div> </div> </div> <div class="tiledSection"><h2 id="section192192415554" device-type="phone,tablet,2in1">paymentService.requestPayment<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section192192415554" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><p>requestPayment(context: common.UIAbilityContext, orderStr: string): Promise&lt;void&gt;</p> <p>该方法提供基础支付、支付并签约等功能，调用方法前请确保网络已连接，调用该方法后会拉起Payment Kit收银台，支付完成后使用Promise异步返回。</p> <p><strong>元服务API：</strong>从版本4.1.0(11)开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong>SystemCapability.Payment.PaymentService</p> <p><strong>起始版本：</strong>4.1.0(11)</p> <div class="p"><strong>参数</strong>： <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.8.7.2.1.5.1.1" width="17.8%"><p><strong>参数名</strong></p> </th> <th align="left" class="cellrowborder" id="mcps1.3.8.7.2.1.5.1.2" width="17.8%"><p><strong>类型</strong></p> </th> <th align="left" class="cellrowborder" id="mcps1.3.8.7.2.1.5.1.3" width="7.17%"><p>必填</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.8.7.2.1.5.1.4" width="57.230000000000004%"><p><strong>说明</strong></p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="17.8%"><p>context</p> </td> <td class="cellrowborder" width="17.8%"><p>common.<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext" target="_blank">UIAbilityContext</a></p> </td> <td class="cellrowborder" width="7.17%"><p>是</p> </td> <td class="cellrowborder" width="57.230000000000004%"><p>UIAbility上下文，不传会报401参数错误。</p> </td> </tr> <tr><td class="cellrowborder" width="17.8%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-model#section159202591414">orderStr</a></p> </td> <td class="cellrowborder" width="17.8%"><p>string</p> </td> <td class="cellrowborder" width="7.17%"><p>是</p> </td> <td class="cellrowborder" width="57.230000000000004%"><p>拉起收银台传入的订单信息，<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-model#section159202591414">orderStr</a>是json字符串的格式。不传会报401参数错误。</p> </td> </tr>  </tbody></table></div> </div> </div> <div class="p"><strong>返回值</strong>: <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.8.8.2.1.3.1.1" width="28.050000000000004%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.8.8.2.1.3.1.2" width="71.95%"><p>说明</p> </th> </tr><tr><td class="cellrowborder" width="28.050000000000004%"><p>Promise&lt;void&gt;</p> </td> <td class="cellrowborder" width="71.95%"><p>Promise对象。无返回结果的Promise对象。</p> </td> </tr>  </tbody></table></div> </div> </div> <p><strong>错误码</strong>：</p> <div class="p">以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-error-code">ArkTS API错误码</a>。 <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.8.10.2.1.3.1.1" width="30%"><p>错误码ID</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.8.10.2.1.3.1.2" width="70%"><p>错误信息（此处仅提供错误抛出的关键信息）</p> </th> </tr><tr><td class="cellrowborder" width="30%"><p>401</p> </td> <td class="cellrowborder" width="70%"><p>Parameter error.</p> </td> </tr> <tr><td class="cellrowborder" width="30%"><p>1001930000</p> </td> <td class="cellrowborder" width="70%"><p>The operation was canceled by the user.</p> </td> </tr> <tr><td class="cellrowborder" width="30%"><p>1001930001</p> </td> <td class="cellrowborder" width="70%"><p>Pay failed.</p> </td> </tr> <tr><td class="cellrowborder" width="30%"><p>1001930002</p> </td> <td class="cellrowborder" width="70%"><p>The transaction has been processed.</p> </td> </tr> <tr><td class="cellrowborder" width="30%"><p>1001930010</p> </td> <td class="cellrowborder" width="70%"><p>Duplicate request.</p> </td> </tr> <tr><td class="cellrowborder" width="30%"><p>1001930011</p> </td> <td class="cellrowborder" width="70%"><p>Network connection error.</p> </td> </tr>  </tbody></table></div> </div> </div> <div class="p"><strong>示例</strong>：<div _ngcontent-hyu-c106="" class="highlight-div"><div _ngcontent-hyu-c106="" class="highlight-div-header"><div _ngcontent-hyu-c106="" class="highlight-div-header-left"><div _ngcontent-hyu-c106="" class="handle-button expand-button"><div _ngcontent-hyu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-hyu-c106="" class="highlight-div-header-right"><div _ngcontent-hyu-c106="" class="handle-button ai-button"></div><div _ngcontent-hyu-c106="" class="handle-button line-button"><div _ngcontent-hyu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-hyu-c106="" class="handle-button theme-button"><div _ngcontent-hyu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-hyu-c106="" class="handle-button copy-button"><div _ngcontent-hyu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-hyu-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { paymentService } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PaymentKit'</span>;</li><li><span class="hljs-keyword">import</span> { common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-attr">context</span>: common.<span class="hljs-property">UIAbilityContext</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li>  <span class="hljs-title function_">requestPaymentPromise</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-comment">// use your own orderStr</span></li><li>    <span class="hljs-keyword">const</span> orderStr = <span class="hljs-string">'{"app_id":"***","merc_no":"***","prepay_id":"xxx","timestamp":"1680259863114","noncestr":"1487b8a60ed9f9ecc0ba759fbec23f4f","sign":"****","auth_id":"***"}'</span>;</li><li>    paymentService.<span class="hljs-title function_">requestPayment</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>, orderStr)</li><li>      .<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>        <span class="hljs-comment">// succeeded in paying</span></li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'succeeded in paying'</span>);</li><li>      })</li><li>      .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error: BusinessError</span>) =&gt;</span> {</li><li>        <span class="hljs-comment">// failed to pay</span></li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`failed to pay, error.code: <span class="hljs-subst">${error.code}</span>, error.message: <span class="hljs-subst">${error.message}</span>`</span>);</li><li>      });</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'requestPaymentPromise'</span>)</li><li>        .<span class="hljs-title function_">type</span>(<span class="hljs-title class_">ButtonType</span>.<span class="hljs-property">Capsule</span>)</li><li>        .<span class="hljs-title function_">width</span>(<span class="hljs-string">'50%'</span>)</li><li>        .<span class="hljs-title function_">margin</span>(<span class="hljs-number">20</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">requestPaymentPromise</span>();</li><li>        })</li><li>      }</li><li>    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div> </div> </div> <div class="tiledSection"><h2 id="section9482124221520" device-type="phone,tablet,2in1">paymentService.requestPayment<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section9482124221520" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><p>requestPayment(context: common.UIAbilityContext, orderStr: string, callback: AsyncCallback&lt;void&gt;): void</p> <p>该方法提供基础支付、支付并签约等功能，调用该方法前请确保网络已连接，调用该方法后会拉起Payment Kit收银台，支付完成后通过AsyncCallback回调结果。</p> <p><strong>元服务API：</strong>从版本4.1.0(11)开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong>SystemCapability.Payment.PaymentService</p> <p><strong>起始版本：</strong>4.1.0(11)</p> <div class="p"><strong>参数</strong>： <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.9.7.2.1.5.1.1" width="17.931793179317932%"><p><strong>参数名</strong></p> </th> <th align="left" class="cellrowborder" id="mcps1.3.9.7.2.1.5.1.2" width="17.931793179317932%"><p><strong>类型</strong></p> </th> <th align="left" class="cellrowborder" id="mcps1.3.9.7.2.1.5.1.3" width="7.46074607460746%"><p>必填</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.9.7.2.1.5.1.4" width="56.67566756675667%"><p><strong>说明</strong></p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="17.931793179317932%"><p>context</p> </td> <td class="cellrowborder" width="17.931793179317932%"><p>common.<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext" target="_blank">UIAbilityContext</a></p> </td> <td class="cellrowborder" width="7.46074607460746%"><p>是</p> </td> <td class="cellrowborder" width="56.67566756675667%"><p>UIAbility上下文，不传会报401参数错误。</p> </td> </tr> <tr><td class="cellrowborder" width="17.931793179317932%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-model#section159202591414">orderStr</a></p> </td> <td class="cellrowborder" width="17.931793179317932%"><p>string</p> </td> <td class="cellrowborder" width="7.46074607460746%"><p>是</p> </td> <td class="cellrowborder" width="56.67566756675667%"><p>拉起收银台传入的订单信息，<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-model#section159202591414">orderStr</a>是json字符串的格式。不传会报401参数错误。</p> </td> </tr> <tr><td class="cellrowborder" width="17.931793179317932%"><p>callback</p> </td> <td class="cellrowborder" width="17.931793179317932%"><p>AsyncCallback&lt;void&gt;</p> </td> <td class="cellrowborder" width="7.46074607460746%"><p>是</p> </td> <td class="cellrowborder" width="56.67566756675667%"><p>回调函数。当支付成功，error为undefined，否则为错误对象。</p> </td> </tr>  </tbody></table></div> </div> </div> <p><strong>错误码</strong>：</p> <div class="p">以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-error-code">ArkTS API错误码</a>。 <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.9.9.2.1.3.1.1" width="30%"><p>错误码ID</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.9.9.2.1.3.1.2" width="70%"><p>错误信息（此处仅提供错误抛出的关键信息）</p> </th> </tr><tr><td class="cellrowborder" width="30%"><p>401</p> </td> <td class="cellrowborder" width="70%"><p>Parameter error.</p> </td> </tr> <tr><td class="cellrowborder" width="30%"><p>1001930000</p> </td> <td class="cellrowborder" width="70%"><p>The operation was canceled by the user.</p> </td> </tr> <tr><td class="cellrowborder" width="30%"><p>1001930001</p> </td> <td class="cellrowborder" width="70%"><p>Pay failed.</p> </td> </tr> <tr><td class="cellrowborder" width="30%"><p>1001930002</p> </td> <td class="cellrowborder" width="70%"><p>The transaction has been processed.</p> </td> </tr> <tr><td class="cellrowborder" width="30%"><p>1001930010</p> </td> <td class="cellrowborder" width="70%"><p>Duplicate request.</p> </td> </tr> <tr><td class="cellrowborder" width="30%"><p>1001930011</p> </td> <td class="cellrowborder" width="70%"><p>Network connection error.</p> </td> </tr>  </tbody></table></div> </div> </div> <div class="p"><strong>示例</strong>：<div _ngcontent-hyu-c106="" class="highlight-div"><div _ngcontent-hyu-c106="" class="highlight-div-header"><div _ngcontent-hyu-c106="" class="highlight-div-header-left"><div _ngcontent-hyu-c106="" class="handle-button expand-button"><div _ngcontent-hyu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-hyu-c106="" class="highlight-div-header-right"><div _ngcontent-hyu-c106="" class="handle-button ai-button"></div><div _ngcontent-hyu-c106="" class="handle-button line-button"><div _ngcontent-hyu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-hyu-c106="" class="handle-button theme-button"><div _ngcontent-hyu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-hyu-c106="" class="handle-button copy-button"><div _ngcontent-hyu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-hyu-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { paymentService } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PaymentKit'</span>;</li><li><span class="hljs-keyword">import</span> { common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-attr">context</span>: common.<span class="hljs-property">UIAbilityContext</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li>  <span class="hljs-title function_">requestPaymentCallBack</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-comment">// use your own orderStr</span></li><li>    <span class="hljs-keyword">const</span> orderStr = <span class="hljs-string">'{"app_id":"***","merc_no":"***","prepay_id":"xxx","timestamp":"1680259863114","noncestr":"1487b8a60ed9f9ecc0ba759fbec23f4f","sign":"****","auth_id":"***"}'</span>;</li><li>    paymentService.<span class="hljs-title function_">requestPayment</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>, orderStr, <span class="hljs-function">(<span class="hljs-params">error: BusinessError</span>) =&gt;</span> {</li><li>      <span class="hljs-keyword">if</span> (error) {</li><li>        <span class="hljs-comment">// failed to pay</span></li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`failed to pay, error.code: <span class="hljs-subst">${error.code}</span>, error.message: <span class="hljs-subst">${error.message}</span>`</span>);</li><li>        <span class="hljs-keyword">return</span>;</li><li>      }</li><li>      <span class="hljs-comment">// succeeded in paying</span></li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'succeeded in paying'</span>);</li><li>    })</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'requestPaymentCallBack'</span>)</li><li>        .<span class="hljs-title function_">type</span>(<span class="hljs-title class_">ButtonType</span>.<span class="hljs-property">Capsule</span>)</li><li>        .<span class="hljs-title function_">width</span>(<span class="hljs-string">'50%'</span>)</li><li>        .<span class="hljs-title function_">margin</span>(<span class="hljs-number">20</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">requestPaymentCallBack</span>();</li><li>        })</li><li>      }</li><li>    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div> </div> </div> <div class="tiledSection"><h2 id="section176908331459" device-type="phone,tablet,2in1">paymentService.requestContract<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section176908331459" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><p>requestContract(context: common.UIAbilityContext, contractStr: string): Promise&lt;void&gt;</p> <p>该方法提供签约功能，调用方法前请确保网络已连接，调用该方法后会拉起Payment Kit签约收银台，签约完成后使用Promise异步返回。</p> <p><strong>元服务API：</strong>从版本5.0.0(12)开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong>SystemCapability.Payment.PaymentService</p> <p><strong>起始版本：</strong>5.0.0(12)</p> <div class="p"><strong>参数</strong>： <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.10.7.2.1.5.1.1" width="18.14181418141814%"><p><strong>参数名</strong></p> </th> <th align="left" class="cellrowborder" id="mcps1.3.10.7.2.1.5.1.2" width="18.14181418141814%"><p><strong>类型</strong></p> </th> <th align="left" class="cellrowborder" id="mcps1.3.10.7.2.1.5.1.3" width="8.790879087908792%"><p>必填</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.10.7.2.1.5.1.4" width="54.925492549254926%"><p><strong>说明</strong></p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="18.14181418141814%"><p>context</p> </td> <td class="cellrowborder" width="18.14181418141814%"><p>common.<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext" target="_blank">UIAbilityContext</a></p> </td> <td class="cellrowborder" width="8.790879087908792%"><p>是</p> </td> <td class="cellrowborder" width="54.925492549254926%"><p>UIAbility上下文，不传会报401参数错误。</p> </td> </tr> <tr><td class="cellrowborder" width="18.14181418141814%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-model#section01944104716">contractStr</a></p> </td> <td class="cellrowborder" width="18.14181418141814%"><p>string</p> </td> <td class="cellrowborder" width="8.790879087908792%"><p>是</p> </td> <td class="cellrowborder" width="54.925492549254926%"><p>拉起签约收银台入参，<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-model#section01944104716">contractStr</a>是json字符串的格式。不传会报401参数错误。</p> </td> </tr>  </tbody></table></div> </div> </div> <div class="p"><strong>返回值</strong>: <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.10.8.2.1.3.1.1" width="28.050000000000004%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.10.8.2.1.3.1.2" width="71.95%"><p>说明</p> </th> </tr><tr><td class="cellrowborder" width="28.050000000000004%"><p>Promise&lt;void&gt;</p> </td> <td class="cellrowborder" width="71.95%"><p>Promise对象。无返回结果的Promise对象。</p> </td> </tr>  </tbody></table></div> </div> </div> <p><strong>错误码</strong>：</p> <div class="p">以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-error-code">ArkTS API错误码</a>。 <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.10.10.2.1.3.1.1" width="30%"><p>错误码ID</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.10.10.2.1.3.1.2" width="70%"><p>错误信息（此处仅提供错误抛出的关键信息）</p> </th> </tr><tr><td class="cellrowborder" width="30%"><p>401</p> </td> <td class="cellrowborder" width="70%"><p>Parameter error.</p> </td> </tr> <tr><td class="cellrowborder" width="30%"><p>1001930000</p> </td> <td class="cellrowborder" width="70%"><p>The operation was canceled by the user.</p> </td> </tr> <tr><td class="cellrowborder" width="30%"><p>1001930002</p> </td> <td class="cellrowborder" width="70%"><p>The transaction has been processed.</p> </td> </tr> <tr><td class="cellrowborder" width="30%"><p>1001930003</p> </td> <td class="cellrowborder" width="70%"><p>Withhold failed.</p> </td> </tr> <tr><td class="cellrowborder" width="30%"><p>1001930010</p> </td> <td class="cellrowborder" width="70%"><p>Duplicate request.</p> </td> </tr> <tr><td class="cellrowborder" width="30%"><p>1001930011</p> </td> <td class="cellrowborder" width="70%"><p>Network connection error.</p> </td> </tr>  </tbody></table></div> </div> </div> <div class="p"><strong>示例</strong>：<div _ngcontent-hyu-c106="" class="highlight-div"><div _ngcontent-hyu-c106="" class="highlight-div-header"><div _ngcontent-hyu-c106="" class="highlight-div-header-left"><div _ngcontent-hyu-c106="" class="handle-button expand-button"><div _ngcontent-hyu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-hyu-c106="" class="highlight-div-header-right"><div _ngcontent-hyu-c106="" class="handle-button ai-button"></div><div _ngcontent-hyu-c106="" class="handle-button line-button"><div _ngcontent-hyu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-hyu-c106="" class="handle-button theme-button"><div _ngcontent-hyu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-hyu-c106="" class="handle-button copy-button"><div _ngcontent-hyu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-hyu-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { paymentService } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PaymentKit'</span>;</li><li><span class="hljs-keyword">import</span> { common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-attr">context</span>: common.<span class="hljs-property">UIAbilityContext</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li>  <span class="hljs-title function_">requestContractPromise</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-comment">// use your own contractStr </span></li><li>    <span class="hljs-keyword">const</span> contractStr = <span class="hljs-string">'{"appId":"***","preSignNo":"***"}'</span>;</li><li>    paymentService.<span class="hljs-title function_">requestContract</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>, contractStr)</li><li>      .<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>        <span class="hljs-comment">// succeeded in signing</span></li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'succeeded in signing'</span>);</li><li>      })</li><li>      .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error: BusinessError</span>) =&gt;</span> {</li><li>        <span class="hljs-comment">// failed to sign</span></li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`failed to sign, error.code: <span class="hljs-subst">${error.code}</span>, error.message: <span class="hljs-subst">${error.message}</span>`</span>);</li><li>      });</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'requestContractPromise'</span>)</li><li>        .<span class="hljs-title function_">type</span>(<span class="hljs-title class_">ButtonType</span>.<span class="hljs-property">Capsule</span>)</li><li>        .<span class="hljs-title function_">width</span>(<span class="hljs-string">'50%'</span>)</li><li>        .<span class="hljs-title function_">margin</span>(<span class="hljs-number">20</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">requestContractPromise</span>();</li><li>        })</li><li>      }</li><li>    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div> </div> </div> <div class="tiledSection"><h2 id="section554912382160" device-type="phone,tablet,2in1">paymentService.requestContract<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section554912382160" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><p>requestContract(context: common.UIAbilityContext, contractStr: string, callback: AsyncCallback&lt;void&gt;): void</p> <p>该方法提供签约功能，调用该方法前请确保网络已连接，调用该方法后会拉起Payment Kit签约收银台，签约完成后通过AsyncCallback回调结果。</p> <p><strong>元服务API：</strong>从版本5.0.0(12)开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong>SystemCapability.Payment.PaymentService</p> <p><strong>起始版本：</strong>5.0.0(12)</p> <div class="p"><strong>参数</strong>： <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.11.7.2.1.5.1.1" width="18.25182518251825%"><p><strong>参数名</strong></p> </th> <th align="left" class="cellrowborder" id="mcps1.3.11.7.2.1.5.1.2" width="18.25182518251825%"><p><strong>类型</strong></p> </th> <th align="left" class="cellrowborder" id="mcps1.3.11.7.2.1.5.1.3" width="8.160816081608163%"><p>必填</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.11.7.2.1.5.1.4" width="55.33553355335533%"><p><strong>说明</strong></p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="18.25182518251825%"><p>context</p> </td> <td class="cellrowborder" width="18.25182518251825%"><p>common.<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext" target="_blank">UIAbilityContext</a></p> </td> <td class="cellrowborder" width="8.160816081608163%"><p>是</p> </td> <td class="cellrowborder" width="55.33553355335533%"><p>UIAbility上下文，不传会报401参数错误。</p> </td> </tr> <tr><td class="cellrowborder" width="18.25182518251825%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-model#section01944104716">contractStr</a></p> </td> <td class="cellrowborder" width="18.25182518251825%"><p>string</p> </td> <td class="cellrowborder" width="8.160816081608163%"><p>是</p> </td> <td class="cellrowborder" width="55.33553355335533%"><p>拉起签约收银台入参，<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-model#section01944104716">contractStr</a>是json字符串的格式。不传会报401参数错误。</p> </td> </tr> <tr><td class="cellrowborder" width="18.25182518251825%"><p>callback</p> </td> <td class="cellrowborder" width="18.25182518251825%"><p>AsyncCallback&lt;void&gt;</p> </td> <td class="cellrowborder" width="8.160816081608163%"><p>是</p> </td> <td class="cellrowborder" width="55.33553355335533%"><p>回调函数。当签约成功，error为undefined，否则为错误对象。</p> </td> </tr>  </tbody></table></div> </div> </div> <p><strong>错误码</strong>：</p> <div class="p">以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-error-code">ArkTS API错误码</a>。 <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.11.9.2.1.3.1.1" width="30%"><p>错误码ID</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.11.9.2.1.3.1.2" width="70%"><p>错误信息（此处仅提供错误抛出的关键信息）</p> </th> </tr><tr><td class="cellrowborder" width="30%"><p>401</p> </td> <td class="cellrowborder" width="70%"><p>Parameter error.</p> </td> </tr> <tr><td class="cellrowborder" width="30%"><p>1001930000</p> </td> <td class="cellrowborder" width="70%"><p>The operation was canceled by the user.</p> </td> </tr> <tr><td class="cellrowborder" width="30%"><p>1001930002</p> </td> <td class="cellrowborder" width="70%"><p>The transaction has been processed.</p> </td> </tr> <tr><td class="cellrowborder" width="30%"><p>1001930003</p> </td> <td class="cellrowborder" width="70%"><p>Withhold failed.</p> </td> </tr> <tr><td class="cellrowborder" width="30%"><p>1001930010</p> </td> <td class="cellrowborder" width="70%"><p>Duplicate request.</p> </td> </tr> <tr><td class="cellrowborder" width="30%"><p>1001930011</p> </td> <td class="cellrowborder" width="70%"><p>Network connection error.</p> </td> </tr>  </tbody></table></div> </div> </div> <div class="p"><strong>示例</strong>：<div _ngcontent-hyu-c106="" class="highlight-div"><div _ngcontent-hyu-c106="" class="highlight-div-header"><div _ngcontent-hyu-c106="" class="highlight-div-header-left"><div _ngcontent-hyu-c106="" class="handle-button expand-button"><div _ngcontent-hyu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-hyu-c106="" class="highlight-div-header-right"><div _ngcontent-hyu-c106="" class="handle-button ai-button"></div><div _ngcontent-hyu-c106="" class="handle-button line-button"><div _ngcontent-hyu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-hyu-c106="" class="handle-button theme-button"><div _ngcontent-hyu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-hyu-c106="" class="handle-button copy-button"><div _ngcontent-hyu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-hyu-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { paymentService } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PaymentKit'</span>;</li><li><span class="hljs-keyword">import</span> { common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-attr">context</span>: common.<span class="hljs-property">UIAbilityContext</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li>  <span class="hljs-title function_">requestContractCallBack</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-comment">// use your own contractStr </span></li><li>    <span class="hljs-keyword">const</span> contractStr = <span class="hljs-string">'{"appId":"***","preSignNo":"***"}'</span>;</li><li>    paymentService.<span class="hljs-title function_">requestContract</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>, contractStr, <span class="hljs-function">(<span class="hljs-params">error: BusinessError</span>) =&gt;</span> {</li><li>      <span class="hljs-keyword">if</span> (error) {</li><li>        <span class="hljs-comment">// failed to sign</span></li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`failed to sign, error.code: <span class="hljs-subst">${error.code}</span>, error.message: <span class="hljs-subst">${error.message}</span>`</span>);</li><li>        <span class="hljs-keyword">return</span>;</li><li>      }</li><li>      <span class="hljs-comment">// succeeded in signing</span></li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'succeeded in signing'</span>);</li><li>    })</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'requestContractCallBack'</span>)</li><li>        .<span class="hljs-title function_">type</span>(<span class="hljs-title class_">ButtonType</span>.<span class="hljs-property">Capsule</span>)</li><li>        .<span class="hljs-title function_">width</span>(<span class="hljs-string">'50%'</span>)</li><li>        .<span class="hljs-title function_">margin</span>(<span class="hljs-number">20</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">requestContractCallBack</span>();</li><li>        })</li><li>      }</li><li>    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div> </div> </div> <div class="tiledSection"><h2 id="section295285522616" device-type="phone,tablet,2in1">paymentService.requestPayment<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section295285522616" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><p>requestPayment(context: common.UIAbilityContext, orderStr: string, payload: string): Promise&lt;PayResult&gt;</p> <p>该方法提供拉起通用收银台、跳转三方支付功能，调用方法前请确保网络已连接，用户在通用收银台选择支付方式并确认支付后，使用Promise异步返回。</p> <p><strong>元服务API：</strong>从版本5.0.2(14)开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong>SystemCapability.Payment.PaymentService</p> <p><strong>起始版本：</strong>5.0.2(14)</p> <div class="p"><strong>参数</strong>： <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.12.7.2.1.5.1.1" width="17.8%"><p><strong>参数名</strong></p> </th> <th align="left" class="cellrowborder" id="mcps1.3.12.7.2.1.5.1.2" width="17.8%"><p><strong>类型</strong></p> </th> <th align="left" class="cellrowborder" id="mcps1.3.12.7.2.1.5.1.3" width="7.17%"><p>必填</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.12.7.2.1.5.1.4" width="57.230000000000004%"><p><strong>说明</strong></p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="17.8%"><p>context</p> </td> <td class="cellrowborder" width="17.8%"><p>common.<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext" target="_blank">UIAbilityContext</a></p> </td> <td class="cellrowborder" width="7.17%"><p>是</p> </td> <td class="cellrowborder" width="57.230000000000004%"><p>UIAbility上下文，不传会报401参数错误。</p> </td> </tr> <tr><td class="cellrowborder" width="17.8%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-model#section159202591414">orderStr</a></p> </td> <td class="cellrowborder" width="17.8%"><p>string</p> </td> <td class="cellrowborder" width="7.17%"><p>是</p> </td> <td class="cellrowborder" width="57.230000000000004%"><p>拉起收银台或跳转三方支付传入的订单信息。</p> <p>orderStr是json字符串的格式，不传会报401参数错误。</p> </td> </tr> <tr><td class="cellrowborder" width="17.8%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-model#section17853161714224">payload</a></p> </td> <td class="cellrowborder" width="17.8%"><p>string</p> </td> <td class="cellrowborder" width="7.17%"><p>是</p> </td> <td class="cellrowborder" width="57.230000000000004%"><p>预留信息，在请求接口时，入参如果传递，接口响应中则会原样返回。</p> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><ul><li>拉起华为支付收银台，需传空或空字符。H5支付场景下跳转三方支付收银台需要固定传递“AP”。</li></ul> </div></div></div> </td> </tr>  </tbody></table></div> </div> </div> <div class="p"><strong>返回值</strong>: <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.12.8.2.1.3.1.1" width="28.050000000000004%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.12.8.2.1.3.1.2" width="71.95%"><p>说明</p> </th> </tr><tr><td class="cellrowborder" width="28.050000000000004%"><p>Promise&lt;<a href="/consumer/cn/doc/harmonyos-references/payment-paymentservice#section363mcpsimp">PayResult</a>&gt;</p> </td> <td class="cellrowborder" width="71.95%"><p>Promise对象。带<a href="/consumer/cn/doc/harmonyos-references/payment-paymentservice#section363mcpsimp">PayResult</a>返回结果的Promise对象。</p> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p>华为支付场景下，<a href="/consumer/cn/doc/harmonyos-references/payment-paymentservice#section363mcpsimp">PayResult</a>可能返回为空，支付结果以回调通知或查询结果为准。</p> </div></div></div> </td> </tr>  </tbody></table></div> </div> </div> <p><strong>错误码</strong>：</p> <div class="p">以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-error-code">ArkTS API错误码</a>。 <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.12.10.2.1.3.1.1" width="30%"><p>错误码ID</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.12.10.2.1.3.1.2" width="70%"><p>错误信息（此处仅提供错误抛出的关键信息）</p> </th> </tr><tr><td class="cellrowborder" width="30%"><p>401</p> </td> <td class="cellrowborder" width="70%"><p>Parameter error.</p> </td> </tr> <tr><td class="cellrowborder" width="30%"><p>1001930000</p> </td> <td class="cellrowborder" width="70%"><p>The operation was canceled by the user.</p> </td> </tr> <tr><td class="cellrowborder" width="30%"><p>1001930001</p> </td> <td class="cellrowborder" width="70%"><p>Pay failed.</p> </td> </tr> <tr><td class="cellrowborder" width="30%"><p>1001930002</p> </td> <td class="cellrowborder" width="70%"><p>The transaction has been processed.</p> </td> </tr> <tr><td class="cellrowborder" width="30%"><p>1001930010</p> </td> <td class="cellrowborder" width="70%"><p>Duplicate request.</p> </td> </tr> <tr><td class="cellrowborder" width="30%"><p>1001930011</p> </td> <td class="cellrowborder" width="70%"><p>Network connection error.</p> </td> </tr>  </tbody></table></div> </div> </div> <div class="p"><strong>示例</strong>：<div _ngcontent-hyu-c106="" class="highlight-div"><div _ngcontent-hyu-c106="" class="highlight-div-header"><div _ngcontent-hyu-c106="" class="highlight-div-header-left"><div _ngcontent-hyu-c106="" class="handle-button expand-button"><div _ngcontent-hyu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-hyu-c106="" class="highlight-div-header-right"><div _ngcontent-hyu-c106="" class="handle-button ai-button"></div><div _ngcontent-hyu-c106="" class="handle-button line-button"><div _ngcontent-hyu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-hyu-c106="" class="handle-button theme-button"><div _ngcontent-hyu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-hyu-c106="" class="handle-button copy-button"><div _ngcontent-hyu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-hyu-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { paymentService } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PaymentKit'</span>;</li><li><span class="hljs-keyword">import</span> { common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-attr">context</span>: common.<span class="hljs-property">UIAbilityContext</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li>  <span class="hljs-title function_">requestPaymentPromise</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-comment">// use orderStr to pay for an order, use your own orderStr.</span></li><li>    <span class="hljs-comment">// const orderStr = '{"app_id":"***","merc_no":"***","prepay_id":"xxx","timestamp":"1680259863114","noncestr":"1487b8a60ed9f9ecc0ba759fbec23f4f","sign":"****","auth_id":"***"}';</span></li><li>    <span class="hljs-comment">// use orderStr to jump third-party payment, use your own orderStr.</span></li><li>    <span class="hljs-keyword">const</span> orderStr = <span class="hljs-string">'{"nextAction":"L","linkUrl":"https://www.***.pay.com/h5pay?prepay_id=***&amp;sign=***","scheme":"","clientToken":"***"}'</span>;</li><li>    paymentService.<span class="hljs-title function_">requestPayment</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>, orderStr, <span class="hljs-string">"AP"</span>)</li><li>      .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">payResult: paymentService.PayResult</span>) =&gt;</span> {</li><li>        <span class="hljs-comment">// succeeded in paying</span></li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'succeeded in paying, pay result: '</span>, payResult);</li><li>      })</li><li>      .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error: BusinessError</span>) =&gt;</span> {</li><li>        <span class="hljs-comment">// failed to pay</span></li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`failed to pay, error.code: <span class="hljs-subst">${error.code}</span>, error.message: <span class="hljs-subst">${error.message}</span>`</span>);</li><li>      });</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'requestPaymentPromise'</span>)</li><li>        .<span class="hljs-title function_">type</span>(<span class="hljs-title class_">ButtonType</span>.<span class="hljs-property">Capsule</span>)</li><li>        .<span class="hljs-title function_">width</span>(<span class="hljs-string">'50%'</span>)</li><li>        .<span class="hljs-title function_">margin</span>(<span class="hljs-number">20</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">requestPaymentPromise</span>();</li><li>        })</li><li>      }</li><li>    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div> </div> </div> <div class="tiledSection"><h2 id="section107051621123013" device-type="phone,tablet,2in1">paymentService.cashierPicker<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section107051621123013" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><p>cashierPicker(context: common.UIAbilityContext, paymentInfo: PaymentInfo): Promise&lt;PickerResult&gt;</p> <p>该方法提供拉起通用收银台功能，调用方法前请确保网络已连接，用户在通用收银台选择支付方式并确认支付后，使用Promise异步返回。</p> <p><strong>元服务API：</strong>从版本5.0.2(14)开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong>SystemCapability.Payment.PaymentService</p> <p><strong>起始版本：</strong>5.0.2(14)</p> <div class="p"><strong>参数</strong>： <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.13.7.2.1.5.1.1" width="18.14181418141814%"><p><strong>参数名</strong></p> </th> <th align="left" class="cellrowborder" id="mcps1.3.13.7.2.1.5.1.2" width="18.14181418141814%"><p><strong>类型</strong></p> </th> <th align="left" class="cellrowborder" id="mcps1.3.13.7.2.1.5.1.3" width="8.790879087908792%"><p>必填</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.13.7.2.1.5.1.4" width="54.925492549254926%"><p><strong>说明</strong></p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="18.14181418141814%"><p>context</p> </td> <td class="cellrowborder" width="18.14181418141814%"><p>common.<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext" target="_blank">UIAbilityContext</a></p> </td> <td class="cellrowborder" width="8.790879087908792%"><p>是</p> </td> <td class="cellrowborder" width="54.925492549254926%"><p>UIAbility上下文，不传会报401参数错误。</p> </td> </tr> <tr><td class="cellrowborder" width="18.14181418141814%"><p>paymentInfo</p> </td> <td class="cellrowborder" width="18.14181418141814%"><p><a href="/consumer/cn/doc/harmonyos-references/payment-paymentservice#section1158325715256">PaymentInfo</a></p> </td> <td class="cellrowborder" width="8.790879087908792%"><p>是</p> </td> <td class="cellrowborder" width="54.925492549254926%"><p>拉起通用收银台传入的支付信息。</p> </td> </tr>  </tbody></table></div> </div> </div> <div class="p"><strong>返回值</strong>: <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.13.8.2.1.3.1.1" width="28.050000000000004%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.13.8.2.1.3.1.2" width="71.95%"><p>说明</p> </th> </tr><tr><td class="cellrowborder" width="28.050000000000004%"><p>Promise&lt;<a href="/consumer/cn/doc/harmonyos-references/payment-paymentservice#section1129353710263">PickerResult</a>&gt;</p> </td> <td class="cellrowborder" width="71.95%"><p>Promise对象。带<a href="/consumer/cn/doc/harmonyos-references/payment-paymentservice#section1129353710263">PickerResult</a>返回结果的Promise对象。</p> </td> </tr>  </tbody></table></div> </div> </div> <p><strong>错误码</strong>：</p> <div class="p">以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-error-code">ArkTS API错误码</a>。 <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.13.10.2.1.3.1.1" width="30%"><p>错误码ID</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.13.10.2.1.3.1.2" width="70%"><p>错误信息（此处仅提供错误抛出的关键信息）</p> </th> </tr><tr><td class="cellrowborder" width="30%"><p>401</p> </td> <td class="cellrowborder" width="70%"><p>Parameter error.</p> </td> </tr> <tr><td class="cellrowborder" width="30%"><p>1001930000</p> </td> <td class="cellrowborder" width="70%"><p>The operation was canceled by the user.</p> </td> </tr> <tr><td class="cellrowborder" width="30%"><p>1001930001</p> </td> <td class="cellrowborder" width="70%"><p>Pay failed.</p> </td> </tr> <tr><td class="cellrowborder" width="30%"><p>1001930002</p> </td> <td class="cellrowborder" width="70%"><p>The transaction has been processed.</p> </td> </tr> <tr><td class="cellrowborder" width="30%"><p>1001930010</p> </td> <td class="cellrowborder" width="70%"><p>Duplicate request.</p> </td> </tr> <tr><td class="cellrowborder" width="30%"><p>1001930011</p> </td> <td class="cellrowborder" width="70%"><p>Network connection error.</p> </td> </tr>  </tbody></table></div> </div> </div> <div class="p"><strong>示例</strong>：<div _ngcontent-hyu-c106="" class="highlight-div"><div _ngcontent-hyu-c106="" class="highlight-div-header"><div _ngcontent-hyu-c106="" class="highlight-div-header-left"><div _ngcontent-hyu-c106="" class="handle-button expand-button"><div _ngcontent-hyu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-hyu-c106="" class="highlight-div-header-right"><div _ngcontent-hyu-c106="" class="handle-button ai-button"></div><div _ngcontent-hyu-c106="" class="handle-button line-button"><div _ngcontent-hyu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-hyu-c106="" class="handle-button theme-button"><div _ngcontent-hyu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-hyu-c106="" class="handle-button copy-button"><div _ngcontent-hyu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-hyu-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { paymentService } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PaymentKit'</span>;</li><li><span class="hljs-keyword">import</span> { common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-attr">context</span>: common.<span class="hljs-property">UIAbilityContext</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li>  <span class="hljs-title function_">requestCashierPicker</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-comment">// use your own paymentInfo</span></li><li>    <span class="hljs-keyword">const</span> <span class="hljs-attr">paymentInfo</span>: paymentService.<span class="hljs-property">PaymentInfo</span>= {</li><li>      <span class="hljs-attr">tradeSummary</span>: <span class="hljs-string">"***交易"</span>,</li><li>      <span class="hljs-attr">amount</span>: <span class="hljs-number">100</span>,</li><li>      <span class="hljs-attr">currency</span>: <span class="hljs-string">"CNY"</span>,</li><li>      <span class="hljs-attr">extraInfo</span>: <span class="hljs-string">'{"***":"***"}'</span></li><li>    }</li><li>    paymentService.<span class="hljs-title function_">cashierPicker</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>, paymentInfo)</li><li>      .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">pickerResult: paymentService.PickerResult</span>) =&gt;</span> {</li><li>        <span class="hljs-comment">// succeeded in paying</span></li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'succeeded in paying, picker result: '</span>, pickerResult);</li><li>      })</li><li>      .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error: BusinessError</span>) =&gt;</span> {</li><li>        <span class="hljs-comment">// failed to pay</span></li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`failed to pay, error.code: <span class="hljs-subst">${error.code}</span>, error.message: <span class="hljs-subst">${error.message}</span>`</span>);</li><li>      });</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'requestCashierPicker'</span>)</li><li>        .<span class="hljs-title function_">type</span>(<span class="hljs-title class_">ButtonType</span>.<span class="hljs-property">Capsule</span>)</li><li>        .<span class="hljs-title function_">width</span>(<span class="hljs-string">'50%'</span>)</li><li>        .<span class="hljs-title function_">margin</span>(<span class="hljs-number">20</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">requestCashierPicker</span>();</li><li>        })</li><li>      }</li><li>    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div> </div> </div> <div class="tiledSection"><h2 id="section645562616313" device-type="phone,tablet,2in1">paymentService.requestBindCard<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section645562616313" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><p>requestBindCard(context: common.UIAbilityContext | common.UIExtensionContext): Promise&lt;BindCardResult&gt;</p> <p>该方法提供用户绑卡功能，调用该方法后会拉起Payment Kit用户绑卡页面，绑卡完成后使用Promise异步返回。调用方法前请确保网络已连接。</p> <p><strong>元服务API：</strong>从版本5.0.5(17)开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong>SystemCapability.Payment.PaymentService</p> <p><strong>起始版本：</strong>5.0.5(17)</p> <div class="p"><strong>参数</strong>： <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.14.7.2.1.5.1.1" width="17.8%"><p><strong>参数名</strong></p> </th> <th align="left" class="cellrowborder" id="mcps1.3.14.7.2.1.5.1.2" width="17.8%"><p><strong>类型</strong></p> </th> <th align="left" class="cellrowborder" id="mcps1.3.14.7.2.1.5.1.3" width="7.17%"><p>必填</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.14.7.2.1.5.1.4" width="57.230000000000004%"><p><strong>说明</strong></p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="17.8%"><p>context</p> </td> <td class="cellrowborder" width="17.8%"><p>common.<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext" target="_blank">UIAbilityContext</a> | common.<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiextensioncontext" target="_blank">UIExtensionContext</a></p> </td> <td class="cellrowborder" width="7.17%"><p>是</p> </td> <td class="cellrowborder" width="57.230000000000004%"><p>UIAbility上下文，不传会报401参数错误。</p> </td> </tr>  </tbody></table></div> </div> </div> <div class="p"><strong>返回值</strong>: <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.14.8.2.1.3.1.1" width="28.050000000000004%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.14.8.2.1.3.1.2" width="71.95%"><p>说明</p> </th> </tr><tr><td class="cellrowborder" width="28.050000000000004%"><p>Promise&lt;<a href="/consumer/cn/doc/harmonyos-references/payment-paymentservice#section1492519912514">BindCardResult</a>&gt;</p> </td> <td class="cellrowborder" width="71.95%"><p>Promise对象。带<a href="/consumer/cn/doc/harmonyos-references/payment-paymentservice#section1492519912514">BindCardResult</a>返回结果的Promise对象。</p> </td> </tr>  </tbody></table></div> </div> </div> <p><strong>错误码</strong>：</p> <div class="p">以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-error-code">ArkTS API错误码</a>。 <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.14.10.2.1.3.1.1" width="30%"><p>错误码ID</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.14.10.2.1.3.1.2" width="70%"><p>错误信息（此处仅提供错误抛出的关键信息）</p> </th> </tr><tr><td class="cellrowborder" width="30%"><p>401</p> </td> <td class="cellrowborder" width="70%"><p>Parameter error.</p> </td> </tr> <tr><td class="cellrowborder" width="30%"><p>1001930000</p> </td> <td class="cellrowborder" width="70%"><p>The operation was canceled by the user.</p> </td> </tr> <tr><td class="cellrowborder" width="30%"><p>1001930011</p> </td> <td class="cellrowborder" width="70%"><p>Network connection error.</p> </td> </tr>  </tbody></table></div> </div> </div> <div class="p"><strong>示例</strong>：<div _ngcontent-hyu-c106="" class="highlight-div"><div _ngcontent-hyu-c106="" class="highlight-div-header"><div _ngcontent-hyu-c106="" class="highlight-div-header-left"><div _ngcontent-hyu-c106="" class="handle-button expand-button"><div _ngcontent-hyu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-hyu-c106="" class="highlight-div-header-right"><div _ngcontent-hyu-c106="" class="handle-button ai-button"></div><div _ngcontent-hyu-c106="" class="handle-button line-button"><div _ngcontent-hyu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-hyu-c106="" class="handle-button theme-button"><div _ngcontent-hyu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-hyu-c106="" class="handle-button copy-button"><div _ngcontent-hyu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-hyu-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { paymentService } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PaymentKit'</span>;</li><li><span class="hljs-keyword">import</span> { common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-attr">context</span>: common.<span class="hljs-property">UIAbilityContext</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li>  <span class="hljs-title function_">requestBindCardPromise</span>(<span class="hljs-params"></span>) {</li><li>    paymentService.<span class="hljs-title function_">requestBindCard</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>)</li><li>      .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">bindCardResult: paymentService.BindCardResult</span>) =&gt;</span> {</li><li>        <span class="hljs-comment">// succeeded in bind card</span></li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'succeeded in bind card'</span>);</li><li>      })</li><li>      .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error: BusinessError</span>) =&gt;</span> {</li><li>        <span class="hljs-comment">// failed to bind card</span></li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`failed to bind card, error.code: <span class="hljs-subst">${error.code}</span>, error.message: <span class="hljs-subst">${error.message}</span>`</span>);</li><li>      });</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'requestBindCardPromise'</span>)</li><li>        .<span class="hljs-title function_">type</span>(<span class="hljs-title class_">ButtonType</span>.<span class="hljs-property">Capsule</span>)</li><li>        .<span class="hljs-title function_">width</span>(<span class="hljs-string">'50%'</span>)</li><li>        .<span class="hljs-title function_">margin</span>(<span class="hljs-number">20</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">requestBindCardPromise</span>();</li><li>        })</li><li>      }</li><li>    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div> </div> </div> </div> <div></div></div>