<h1 _ngcontent-xkh-c119="" class="doc-title ng-star-inserted" title="readerCore（阅读核心能力）"> readerCore（阅读核心能力） </h1>

<div _ngcontent-xkh-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div><p>本模块为Reader Kit核心能力。提供阅读页面数据基础类、页面状态、内容分页信息、页面排版属性、组件控制器等能力。</p> <p><strong>起始版本：</strong>5.0.4(16)</p> <div class="tiledSection"><h2 id="section41484152321" device-type="phone,2in1,tablet">导入模块<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section41484152321" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><div _ngcontent-xkh-c106="" class="highlight-div"><div _ngcontent-xkh-c106="" class="highlight-div-header"><div _ngcontent-xkh-c106="" class="highlight-div-header-left"><div _ngcontent-xkh-c106="" class="handle-button expand-button"><div _ngcontent-xkh-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xkh-c106="" class="highlight-div-header-right"><div _ngcontent-xkh-c106="" class="handle-button ai-button"></div><div _ngcontent-xkh-c106="" class="handle-button line-button"><div _ngcontent-xkh-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xkh-c106="" class="handle-button theme-button"><div _ngcontent-xkh-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xkh-c106="" class="handle-button copy-button"><div _ngcontent-xkh-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xkh-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { readerCore } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ReaderKit'</span>;</li></ol></pre></div></div> </div> <div class="tiledSection"><h2 id="section393123711811" device-type="phone,2in1,tablet">PageDatabaseBean<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section393123711811" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><p>页面数据基础类。</p> <p><strong>元服务API：</strong>从版本5.0.4(16)开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong>SystemCapability.Reader.ReaderService.ReaderCore</p> <p><strong>起始版本：</strong>5.0.4(16)</p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.4.6.1.6.1.1" width="23.39%"><p><strong>名称</strong></p> </th> <th align="left" class="cellrowborder" id="mcps1.3.4.6.1.6.1.2" width="9.89%"><p><strong>类型</strong></p> </th> <th align="left" class="cellrowborder" id="mcps1.3.4.6.1.6.1.3" width="8.870000000000001%"><p>只读</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.4.6.1.6.1.4" width="7.9799999999999995%"><p>可选</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.4.6.1.6.1.5" width="49.87%"><p><strong>说明</strong></p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="23.39%"><p>nodeType</p> </td> <td class="cellrowborder" width="9.89%"><p>string</p> </td> <td class="cellrowborder" width="8.870000000000001%"><p>否</p> </td> <td class="cellrowborder" width="7.9799999999999995%"><p>否</p> </td> <td class="cellrowborder" width="49.87%"><p>节点类型，固定值为“ReaderCoreIdentity”，表示阅读器节点。</p> </td> </tr> <tr><td class="cellrowborder" width="23.39%"><p>dataId</p> </td> <td class="cellrowborder" width="9.89%"><p>string</p> </td> <td class="cellrowborder" width="8.870000000000001%"><p>否</p> </td> <td class="cellrowborder" width="7.9799999999999995%"><p>否</p> </td> <td class="cellrowborder" width="49.87%"><p>节点标识，根据资源索引、页面偏移量自动生成。</p> </td> </tr>  </tbody></table></div> </div> </div> <div class="tiledSection"><h3 id="section11497516132017" device-type="phone,2in1,tablet" class="firsth2">constructor<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section11497516132017" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><p>constructor(nodeType: string, nodeDataId: string)</p> <p>页面数据构造函数。</p> <p><strong>元服务API：</strong>从版本5.0.4(16)开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong>SystemCapability.Reader.ReaderService.ReaderCore</p> <p><strong>起始版本：</strong>5.0.4(16)</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.5.8.1.5.1.1" width="25%"><p>参数名</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.5.8.1.5.1.2" width="13.62%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.5.8.1.5.1.3" width="10.040000000000001%"><p>必填</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.5.8.1.5.1.4" width="51.339999999999996%"><p>说明</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="25%"><p>nodeType</p> </td> <td class="cellrowborder" width="13.62%"><p>string</p> </td> <td class="cellrowborder" width="10.040000000000001%"><p>是</p> </td> <td class="cellrowborder" width="51.339999999999996%"><p>节点类型，固定值为“ReaderCoreIdentity”，表示阅读器节点。</p> </td> </tr> <tr><td class="cellrowborder" width="25%"><p>nodeDataId</p> </td> <td class="cellrowborder" width="13.62%"><p>string</p> </td> <td class="cellrowborder" width="10.040000000000001%"><p>是</p> </td> <td class="cellrowborder" width="51.339999999999996%"><p>节点标识，根据子类<a href="/consumer/cn/doc/harmonyos-references/reader-read-core#section1064382518239">PageDataInfo</a>.resourceIndex、<a href="/consumer/cn/doc/harmonyos-references/reader-read-core#section1064382518239">PageDataInfo</a>.pageOffset字段自动生成。</p> </td> </tr>  </tbody></table></div> </div> </div> <div class="tiledSection"><h2 id="section143420551333" device-type="phone,2in1,tablet">PageState<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section143420551333" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><p>页面状态。</p> <p><strong>元服务API：</strong>从版本5.0.4(16)开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong>SystemCapability.Reader.ReaderService.ReaderCore</p> <p><strong>起始版本：</strong>5.0.4(16)</p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.6.6.1.4.1.1" width="27.900000000000002%"><p>名称</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.6.6.1.4.1.2" width="12.43%"><p>值</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.6.6.1.4.1.3" width="59.67%"><p>说明</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="27.900000000000002%"><p>PAGE_WAITING</p> </td> <td class="cellrowborder" width="12.43%"><p>1</p> </td> <td class="cellrowborder" width="59.67%"><p>等待加载。</p> </td> </tr> <tr><td class="cellrowborder" width="27.900000000000002%"><p>PAGE_LOADING</p> </td> <td class="cellrowborder" width="12.43%"><p>2</p> </td> <td class="cellrowborder" width="59.67%"><p>加载中。</p> </td> </tr> <tr><td class="cellrowborder" width="27.900000000000002%"><p>PAGE_ON_SHOW</p> </td> <td class="cellrowborder" width="12.43%"><p>3</p> </td> <td class="cellrowborder" width="59.67%"><p>加载成功。</p> </td> </tr> <tr><td class="cellrowborder" width="27.900000000000002%"><p>OPEN_BOOK_FAIL</p> </td> <td class="cellrowborder" width="12.43%"><p>4</p> </td> <td class="cellrowborder" width="59.67%"><p>加载失败。</p> </td> </tr>  </tbody></table></div> </div> </div> <div class="tiledSection"><h2 id="section1064382518239" device-type="phone,2in1,tablet">PageDataInfo<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section1064382518239" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><p>内容分页信息，继承<a href="/consumer/cn/doc/harmonyos-references/reader-read-core#section393123711811">PageDatabaseBean</a>。</p> <p><strong>元服务API：</strong>从版本5.0.4(16)开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong>SystemCapability.Reader.ReaderService.ReaderCore</p> <p><strong>起始版本：</strong>5.0.4(16)</p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.7.6.1.6.1.1" width="23.39%"><p><strong>名称</strong></p> </th> <th align="left" class="cellrowborder" id="mcps1.3.7.6.1.6.1.2" width="9.89%"><p><strong>类型</strong></p> </th> <th align="left" class="cellrowborder" id="mcps1.3.7.6.1.6.1.3" width="7.5200000000000005%"><p>只读</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.7.6.1.6.1.4" width="6.35%"><p>可选</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.7.6.1.6.1.5" width="52.849999999999994%"><p><strong>说明</strong></p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="23.39%"><p>nodeType</p> </td> <td class="cellrowborder" width="9.89%"><p>string</p> </td> <td class="cellrowborder" width="7.5200000000000005%"><p>否</p> </td> <td class="cellrowborder" width="6.35%"><p>否</p> </td> <td class="cellrowborder" width="52.849999999999994%"><p>节点类型，固定值为"ReaderCoreIdentity"，表示阅读器节点。</p> </td> </tr> <tr><td class="cellrowborder" width="23.39%"><p>dataId</p> </td> <td class="cellrowborder" width="9.89%"><p>string</p> </td> <td class="cellrowborder" width="7.5200000000000005%"><p>否</p> </td> <td class="cellrowborder" width="6.35%"><p>否</p> </td> <td class="cellrowborder" width="52.849999999999994%"><p>节点标识，根据“resourceIndex”、“pageOffset”字段自动生成。</p> </td> </tr> <tr><td class="cellrowborder" width="23.39%"><p>pageHeaderContent</p> </td> <td class="cellrowborder" width="9.89%"><p>string</p> </td> <td class="cellrowborder" width="7.5200000000000005%"><p>否</p> </td> <td class="cellrowborder" width="6.35%"><p>否</p> </td> <td class="cellrowborder" width="52.849999999999994%"><p>页眉文本。（预留字段，暂不支持。）</p> </td> </tr> <tr><td class="cellrowborder" width="23.39%"><p>pageFooterContent</p> </td> <td class="cellrowborder" width="9.89%"><p>string</p> </td> <td class="cellrowborder" width="7.5200000000000005%"><p>否</p> </td> <td class="cellrowborder" width="6.35%"><p>否</p> </td> <td class="cellrowborder" width="52.849999999999994%"><p>页脚文本。（预留字段，暂不支持。）</p> </td> </tr> <tr><td class="cellrowborder" width="23.39%"><p>startDomPos</p> </td> <td class="cellrowborder" width="9.89%"><p>string</p> </td> <td class="cellrowborder" width="7.5200000000000005%"><p>否</p> </td> <td class="cellrowborder" width="6.35%"><p>否</p> </td> <td class="cellrowborder" width="52.849999999999994%"><p>当前页的起始位置信息。</p> </td> </tr> <tr><td class="cellrowborder" width="23.39%"><p>endDomPos</p> </td> <td class="cellrowborder" width="9.89%"><p>string</p> </td> <td class="cellrowborder" width="7.5200000000000005%"><p>否</p> </td> <td class="cellrowborder" width="6.35%"><p>否</p> </td> <td class="cellrowborder" width="52.849999999999994%"><p>当前页的结束位置信息。</p> </td> </tr> <tr><td class="cellrowborder" width="23.39%"><p>state</p> </td> <td class="cellrowborder" width="9.89%"><p><a href="/consumer/cn/doc/harmonyos-references/reader-read-core#section143420551333">PageState</a></p> </td> <td class="cellrowborder" width="7.5200000000000005%"><p>否</p> </td> <td class="cellrowborder" width="6.35%"><p>否</p> </td> <td class="cellrowborder" width="52.849999999999994%"><p>页面状态。</p> </td> </tr> <tr><td class="cellrowborder" width="23.39%"><p>resourceIndex</p> </td> <td class="cellrowborder" width="9.89%"><p>number</p> </td> <td class="cellrowborder" width="7.5200000000000005%"><p>否</p> </td> <td class="cellrowborder" width="6.35%"><p>否</p> </td> <td class="cellrowborder" width="52.849999999999994%"><p>书脊内容节点索引<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/reader-book-parser#section1029864651619">SpineItem</a>.index。</p> </td> </tr> <tr><td class="cellrowborder" width="23.39%"><p>pageOffset</p> </td> <td class="cellrowborder" width="9.89%"><p>number</p> </td> <td class="cellrowborder" width="7.5200000000000005%"><p>否</p> </td> <td class="cellrowborder" width="6.35%"><p>否</p> </td> <td class="cellrowborder" width="52.849999999999994%"><p>页数偏移值，从0开始取值。</p> <p>例如：一个内容资源文件有50页，这个值的取值范围则为0-49。</p> </td> </tr>  </tbody></table></div> </div> </div> <div class="tiledSection"><h3 id="section8843805333" device-type="phone,2in1,tablet" class="firsth2">constructor<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section8843805333" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><p>constructor(nodeType: string, nodeId: string)</p> <p>内容分页信息构造函数。</p> <p><strong>元服务API：</strong>从版本5.0.4(16)开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong>SystemCapability.Reader.ReaderService.ReaderCore</p> <p><strong>起始版本：</strong>5.0.4(16)</p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.8.7.1.5.1.1" width="25%"><p>参数名</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.8.7.1.5.1.2" width="13.62%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.8.7.1.5.1.3" width="10.040000000000001%"><p>必填</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.8.7.1.5.1.4" width="51.339999999999996%"><p>说明</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="25%"><p>nodeType</p> </td> <td class="cellrowborder" width="13.62%"><p>string</p> </td> <td class="cellrowborder" width="10.040000000000001%"><p>是</p> </td> <td class="cellrowborder" width="51.339999999999996%"><p>节点类型，固定值为“ReaderCoreIdentity”。</p> </td> </tr> <tr><td class="cellrowborder" width="25%"><p>nodeId</p> </td> <td class="cellrowborder" width="13.62%"><p>string</p> </td> <td class="cellrowborder" width="10.040000000000001%"><p>是</p> </td> <td class="cellrowborder" width="51.339999999999996%"><p>节点标识，根据子类<a href="/consumer/cn/doc/harmonyos-references/reader-read-core#section1064382518239">PageDataInfo</a>.resourceIndex、<a href="/consumer/cn/doc/harmonyos-references/reader-read-core#section1064382518239">PageDataInfo</a>.pageOffset字段自动生成。</p> </td> </tr>  </tbody></table></div> </div> </div> <div class="tiledSection"><h2 id="section13615732174218" device-type="phone,2in1,tablet">ReaderSetting<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section13615732174218" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><p>页面排版属性。</p> <p><strong>元服务API：</strong>从版本5.0.4(16)开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong>SystemCapability.Reader.ReaderService.ReaderCore</p> <p><strong>起始版本：</strong>5.0.4(16)</p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.9.6.1.6.1.1" width="23.39%"><p><strong>名称</strong></p> </th> <th align="left" class="cellrowborder" id="mcps1.3.9.6.1.6.1.2" width="9.89%"><p><strong>类型</strong></p> </th> <th align="left" class="cellrowborder" id="mcps1.3.9.6.1.6.1.3" width="7.5200000000000005%"><p>只读</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.9.6.1.6.1.4" width="6.4799999999999995%"><p>可选</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.9.6.1.6.1.5" width="52.72%"><p><strong>说明</strong></p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="23.39%"><p>fontName</p> </td> <td class="cellrowborder" width="9.89%"><p>string</p> </td> <td class="cellrowborder" width="7.5200000000000005%"><p>否</p> </td> <td class="cellrowborder" width="6.4799999999999995%"><p>否</p> </td> <td class="cellrowborder" width="52.72%"><p>字体名称。</p> </td> </tr> <tr><td class="cellrowborder" width="23.39%"><p>fontSize</p> </td> <td class="cellrowborder" width="9.89%"><p>number</p> </td> <td class="cellrowborder" width="7.5200000000000005%"><p>否</p> </td> <td class="cellrowborder" width="6.4799999999999995%"><p>否</p> </td> <td class="cellrowborder" width="52.72%"><p>字号大小，单位：px。</p> </td> </tr> <tr><td class="cellrowborder" width="23.39%"><p>fontWeight</p> </td> <td class="cellrowborder" width="9.89%"><p>number</p> </td> <td class="cellrowborder" width="7.5200000000000005%"><p>否</p> </td> <td class="cellrowborder" width="6.4799999999999995%"><p>否</p> </td> <td class="cellrowborder" width="52.72%"><p>文本的字体粗细，依赖所引用的字体文件是否支持设置文本的粗细。（预留字段，暂不支持。）</p> </td> </tr> <tr><td class="cellrowborder" width="23.39%"><p>fontColor</p> </td> <td class="cellrowborder" width="9.89%"><p>string</p> </td> <td class="cellrowborder" width="7.5200000000000005%"><p>否</p> </td> <td class="cellrowborder" width="6.4799999999999995%"><p>否</p> </td> <td class="cellrowborder" width="52.72%"><p>字体颜色。例如'#ffffff'、'rgba(248, 249, 250, 1)'。</p> <div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content"><p>字体颜色的值限制如下：</p> <ul><li>对于16进制颜色值，只支持6位颜色值，不支持透明度。</li><li>对于rgba颜色值，透明度的值只支持1。</li></ul> </div></div></div> </td> </tr> <tr><td class="cellrowborder" width="23.39%"><p>fontPath</p> </td> <td class="cellrowborder" width="9.89%"><p>string</p> </td> <td class="cellrowborder" width="7.5200000000000005%"><p>否</p> </td> <td class="cellrowborder" width="6.4799999999999995%"><p>否</p> </td> <td class="cellrowborder" width="52.72%"><p>字体文件本地路径。</p> <p>支持两种存放路径：</p> <ul><li>工程目录resources/rawfile文件夹。</li><li><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/app-sandbox-directory" target="_blank">应用沙箱目录</a>。</li></ul> </td> </tr> <tr><td class="cellrowborder" width="23.39%"><p>lineHeight</p> </td> <td class="cellrowborder" width="9.89%"><p>number</p> </td> <td class="cellrowborder" width="7.5200000000000005%"><p>否</p> </td> <td class="cellrowborder" width="6.4799999999999995%"><p>否</p> </td> <td class="cellrowborder" width="52.72%"><p>行高系数。一行文本实际显示高度为fontSize * lineHeight。</p> </td> </tr> <tr><td class="cellrowborder" width="23.39%"><p>nightMode</p> </td> <td class="cellrowborder" width="9.89%"><p>boolean</p> </td> <td class="cellrowborder" width="7.5200000000000005%"><p>否</p> </td> <td class="cellrowborder" width="6.4799999999999995%"><p>否</p> </td> <td class="cellrowborder" width="52.72%"><p>是否深色模式，需要开发者在监听到深、浅模式变化时手动设置。</p> <p>用于仿真翻页时背面主题色的绘制。</p> <ul><li>true：深色模式。</li><li>false：浅色模式，默认是false。</li></ul> </td> </tr> <tr><td class="cellrowborder" width="23.39%"><p>themeColor</p> </td> <td class="cellrowborder" width="9.89%"><p>string</p> </td> <td class="cellrowborder" width="7.5200000000000005%"><p>否</p> </td> <td class="cellrowborder" width="6.4799999999999995%"><p>否</p> </td> <td class="cellrowborder" width="52.72%"><p>主题背景色。示例：'#ffffff'、'rgba(248, 249, 250, 1)'。</p> <p>如果有设置背景图的情况下，通常用于仿真翻页时背面主题色的绘制。</p> <p>如果没有设置背景图片，还会用于渲染阅读页的背景色。</p> <div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content"><p>背景色的值限制如下：</p> <ul><li>对于16进制颜色值，只支持6位颜色值，不支持透明度。</li><li>对于rgba颜色值，透明度的值只支持1。</li></ul> </div></div></div> </td> </tr> <tr><td class="cellrowborder" width="23.39%"><p>themeBgImg</p> </td> <td class="cellrowborder" width="9.89%"><p>string</p> </td> <td class="cellrowborder" width="7.5200000000000005%"><p>否</p> </td> <td class="cellrowborder" width="6.4799999999999995%"><p>否</p> </td> <td class="cellrowborder" width="52.72%"><p>主题背景图路径，用于阅读页背景的绘制。</p> <p>支持两种存放路径：</p> <ul><li>工程目录resources/rawfile文件夹。</li><li><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/app-sandbox-directory" target="_blank">应用沙箱目录</a>。</li></ul> </td> </tr> <tr><td class="cellrowborder" width="23.39%"><p>flipMode</p> </td> <td class="cellrowborder" width="9.89%"><p>string</p> </td> <td class="cellrowborder" width="7.5200000000000005%"><p>否</p> </td> <td class="cellrowborder" width="6.4799999999999995%"><p>否</p> </td> <td class="cellrowborder" width="52.72%"><p>翻页方式。</p> <ul><li>'0'：仿真。</li><li>'1'：横滑。</li></ul> <p>默认值为0。</p> </td> </tr> <tr><td class="cellrowborder" width="23.39%"><p>scaledDensity</p> </td> <td class="cellrowborder" width="9.89%"><p>number</p> </td> <td class="cellrowborder" width="7.5200000000000005%"><p>否</p> </td> <td class="cellrowborder" width="6.4799999999999995%"><p>否</p> </td> <td class="cellrowborder" width="52.72%"><p>系统显示文本的缩放因子，该值通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-display#displaygetdefaultdisplaysync9" target="_blank">display.getDefaultDisplaySync().scaledDensity</a>字段获取。</p> <p>在智慧多窗等场景，文本缩放因子发生变化时，开发者需要调用ReaderComponentController组件控制器的<a href="/consumer/cn/doc/harmonyos-references/reader-read-core#section6297758718">setPageConfig</a>接口更新该属性。</p> </td> </tr> <tr><td class="cellrowborder" width="23.39%"><p>viewPortWidth</p> </td> <td class="cellrowborder" width="9.89%"><p>number</p> </td> <td class="cellrowborder" width="7.5200000000000005%"><p>否</p> </td> <td class="cellrowborder" width="6.4799999999999995%"><p>否</p> </td> <td class="cellrowborder" width="52.72%"><p>排版视口宽度，单位：px。</p> </td> </tr> <tr><td class="cellrowborder" width="23.39%"><p>viewPortHeight</p> </td> <td class="cellrowborder" width="9.89%"><p>number</p> </td> <td class="cellrowborder" width="7.5200000000000005%"><p>否</p> </td> <td class="cellrowborder" width="6.4799999999999995%"><p>否</p> </td> <td class="cellrowborder" width="52.72%"><p>排版视口高度，单位：px。</p> </td> </tr>  </tbody></table></div> </div> </div> <div class="tiledSection"><h2 id="section1917812014110" device-type="phone,2in1,tablet">ReaderComponentController<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section1917812014110" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/reader-api-readpagecomponent#section3730195311450">ReadPageComponent</a>组件控制器，需要配合ReadPageComponent组件一起使用。</p> <p><strong>元服务API：</strong>从版本5.0.4(16)开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong>SystemCapability.Reader.ReaderService.ReaderCore</p> <p><strong>起始版本：</strong>5.0.4(16)</p> </div> <div class="tiledSection"><h3 id="section8938164817438" device-type="phone,2in1,tablet" class="firsth2">init<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section8938164817438" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><p>init(context: common.UIAbilityContext): Promise&lt;void&gt;</p> <p>初始化ReaderComponentController，使用Promise异步回调。</p> <div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content"><p>在集成ReaderComponentController时，初始化接口一定要优先于controller的其他接口之前执行。</p> </div></div></div> <p><strong>元服务API：</strong>从版本5.0.4(16)开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong>SystemCapability.Reader.ReaderService.ReaderCore</p> <p><strong>起始版本：</strong>5.0.4(16)</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.11.9.1.5.1.1" width="25%"><p>参数名</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.11.9.1.5.1.2" width="25%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.11.9.1.5.1.3" width="25%"><p>必填</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.11.9.1.5.1.4" width="25%"><p>说明</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="25%"><p>context</p> </td> <td class="cellrowborder" width="25%"><p>common.<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext" target="_blank">UIAbilityContext</a></p> </td> <td class="cellrowborder" width="25%"><p>是</p> </td> <td class="cellrowborder" width="25%"><p>当前应用上下文。</p> </td> </tr>  </tbody></table></div> </div> <p><strong>返回值：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.11.11.1.3.1.1" width="32.16%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.11.11.1.3.1.2" width="67.84%"><p>说明</p> </th> </tr><tr><td class="cellrowborder" width="32.16%"><p>Promise&lt;void&gt;</p> </td> <td class="cellrowborder" width="67.84%"><p>Promise对象。无返回结果的Promise对象。</p> </td> </tr>  </tbody></table></div> </div> <p><strong>错误码：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.11.13.1.3.1.1" width="33.72%"><p>错误码ID</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.11.13.1.3.1.2" width="66.28%"><p>错误信息</p> </th> </tr><tr><td class="cellrowborder" width="33.72%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal#section401-参数检查失败" target="_blank">401</a></p> </td> <td class="cellrowborder" width="66.28%"><p>Parameter error.</p> </td> </tr> <tr><td class="cellrowborder" width="33.72%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/reader-error-code#section11556619102">1016910004</a></p> </td> <td class="cellrowborder" width="66.28%"><p>Invalid caller.</p> </td> </tr>  </tbody></table></div> </div> <p><strong>示例：</strong></p> <div _ngcontent-xkh-c106="" class="highlight-div"><div _ngcontent-xkh-c106="" class="highlight-div-header"><div _ngcontent-xkh-c106="" class="highlight-div-header-left"><div _ngcontent-xkh-c106="" class="handle-button expand-button"><div _ngcontent-xkh-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xkh-c106="" class="highlight-div-header-right"><div _ngcontent-xkh-c106="" class="handle-button ai-button"></div><div _ngcontent-xkh-c106="" class="handle-button line-button"><div _ngcontent-xkh-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xkh-c106="" class="handle-button theme-button"><div _ngcontent-xkh-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xkh-c106="" class="handle-button copy-button"><div _ngcontent-xkh-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xkh-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { readerCore, <span class="hljs-title class_">ReadPageComponent</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ReaderKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li><span class="hljs-keyword">import</span> { common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Reader</span> {</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">readerComponentController</span>: readerCore.<span class="hljs-property">ReaderComponentController</span> = <span class="hljs-keyword">new</span> readerCore.<span class="hljs-title class_">ReaderComponentController</span>();</li><li>
</li><li>  <span class="hljs-title function_">aboutToAppear</span>(): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">init</span>();</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">init</span>(<span class="hljs-params"></span>){</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-keyword">let</span> context = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li>      <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">readerComponentController</span>.<span class="hljs-title function_">init</span>(context);</li><li>      hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">`init succeeded`</span>);</li><li>    } <span class="hljs-keyword">catch</span> (err) {</li><li>      hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">`failed to init, Code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Stack</span>() {</li><li>      <span class="hljs-title class_">ReadPageComponent</span>({</li><li>        <span class="hljs-attr">controller</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">readerComponentController</span>,</li><li>        <span class="hljs-attr">readerCallback</span>: <span class="hljs-function">(<span class="hljs-params">err: BusinessError, data: readerCore.ReaderComponentController</span>) =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">readerComponentController</span> = data;</li><li>        }</li><li>      })</li><li>    }.<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>).<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div> </div> <div class="tiledSection"><h3 id="section181215815104" device-type="phone,2in1,tablet">registerBookParser<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section181215815104" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><p>registerBookParser(bookParserHandler: bookParser.BookParserHandler): void</p> <p>注册书籍解析器。</p> <div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content"><p>registerBookParser接口需要在<a href="/consumer/cn/doc/harmonyos-references/reader-read-core#section3667128165411">startPlay</a>接口之前调用，否则将会抛出异常。</p> </div></div></div> <p><strong>元服务API：</strong>从版本5.0.4(16)开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong>SystemCapability.Reader.ReaderService.ReaderCore</p> <p><strong>起始版本：</strong>5.0.4(16)</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.12.9.1.5.1.1" width="25%"><p>参数名</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.12.9.1.5.1.2" width="25%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.12.9.1.5.1.3" width="25%"><p>必填</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.12.9.1.5.1.4" width="25%"><p>说明</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="25%"><p>bookParserHandler</p> </td> <td class="cellrowborder" width="25%"><p>bookParser.<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/reader-book-parser#section59035422210">BookParserHandler</a></p> </td> <td class="cellrowborder" width="25%"><p>是</p> </td> <td class="cellrowborder" width="25%"><p>书籍解析器。</p> </td> </tr>  </tbody></table></div> </div> <p><strong>错误码：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.12.11.1.3.1.1" width="33.72%"><p>错误码ID</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.12.11.1.3.1.2" width="66.28%"><p>错误信息</p> </th> </tr><tr><td class="cellrowborder" width="33.72%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal#section401-参数检查失败" target="_blank">401</a></p> </td> <td class="cellrowborder" width="66.28%"><p>Parameter error.</p> </td> </tr> <tr><td class="cellrowborder" width="33.72%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/reader-error-code#section174762013118">1016900002</a></p> </td> <td class="cellrowborder" width="66.28%"><p>Read Page Component is not initialized.</p> </td> </tr> <tr><td class="cellrowborder" width="33.72%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/reader-error-code#section16343120935">1016900003</a></p> </td> <td class="cellrowborder" width="66.28%"><p>Invalid request.</p> </td> </tr> <tr><td class="cellrowborder" width="33.72%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/reader-error-code#section14689171516514">1016900999</a></p> </td> <td class="cellrowborder" width="66.28%"><p>Other error.</p> </td> </tr>  </tbody></table></div> </div> <div class="p"><strong>示例：</strong><div _ngcontent-xkh-c106="" class="highlight-div"><div _ngcontent-xkh-c106="" class="highlight-div-header"><div _ngcontent-xkh-c106="" class="highlight-div-header-left"><div _ngcontent-xkh-c106="" class="handle-button expand-button"><div _ngcontent-xkh-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xkh-c106="" class="highlight-div-header-right"><div _ngcontent-xkh-c106="" class="handle-button ai-button"></div><div _ngcontent-xkh-c106="" class="handle-button line-button"><div _ngcontent-xkh-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xkh-c106="" class="handle-button theme-button"><div _ngcontent-xkh-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xkh-c106="" class="handle-button copy-button"><div _ngcontent-xkh-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xkh-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { bookParser, readerCore, <span class="hljs-title class_">ReadPageComponent</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ReaderKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li><span class="hljs-keyword">import</span> { common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Reader</span> {</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">readerComponentController</span>: readerCore.<span class="hljs-property">ReaderComponentController</span> = <span class="hljs-keyword">new</span> readerCore.<span class="hljs-title class_">ReaderComponentController</span>();</li><li>
</li><li>  <span class="hljs-title function_">aboutToAppear</span>(): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">registerBookParser</span>();</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">registerBookParser</span>(<span class="hljs-params"></span>){</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-comment">// 通过提前导入到</span><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/app-sandbox-directory" target="_blank"><span class="hljs-comment">应用沙箱目录</span></a><span class="hljs-comment">中的书籍文件，初始化书籍解析器</span></li><li>      <span class="hljs-keyword">let</span> context = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">filePath</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">`<span class="hljs-subst">${context.filesDir}</span>/abc.epub`</span>;</li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">bookParserHandler</span>: bookParser.<span class="hljs-property">BookParserHandler</span> = <span class="hljs-keyword">await</span> bookParser.<span class="hljs-title function_">getDefaultHandler</span>(filePath);</li><li>      <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">readerComponentController</span>.<span class="hljs-title function_">init</span>(context);</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">readerComponentController</span>.<span class="hljs-title function_">registerBookParser</span>(bookParserHandler);</li><li>      hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">`registerBookParser succeeded`</span>);</li><li>    } <span class="hljs-keyword">catch</span> (err) {</li><li>      hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">`failed to registerBookParser, Code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Stack</span>() {</li><li>      <span class="hljs-title class_">ReadPageComponent</span>({</li><li>        <span class="hljs-attr">controller</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">readerComponentController</span>,</li><li>        <span class="hljs-attr">readerCallback</span>: <span class="hljs-function">(<span class="hljs-params">err: BusinessError, data: readerCore.ReaderComponentController</span>) =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">readerComponentController</span> = data;</li><li>        }</li><li>      })</li><li>    }.<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>).<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div> </div> </div> <div class="tiledSection"><h3 id="section6297758718" device-type="phone,2in1,tablet">setPageConfig<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section6297758718" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><p>setPageConfig(pageConfig: ReaderSetting): void</p> <p>设置或者修改页面排版属性。</p> <p><strong>元服务API：</strong>从版本5.0.4(16)开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong>SystemCapability.Reader.ReaderService.ReaderCore</p> <p><strong>起始版本：</strong>5.0.4(16)</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.13.8.1.5.1.1" width="25%"><p>参数名</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.13.8.1.5.1.2" width="25%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.13.8.1.5.1.3" width="25%"><p>必填</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.13.8.1.5.1.4" width="25%"><p>说明</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="25%"><p>pageConfig</p> </td> <td class="cellrowborder" width="25%"><p><a href="/consumer/cn/doc/harmonyos-references/reader-read-core#section13615732174218">ReaderSetting</a></p> </td> <td class="cellrowborder" width="25%"><p>是</p> </td> <td class="cellrowborder" width="25%"><p>页面排版属性。</p> </td> </tr>  </tbody></table></div> </div> <p><strong>错误码：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.13.10.1.3.1.1" width="33.72%"><p>错误码ID</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.13.10.1.3.1.2" width="66.28%"><p>错误信息</p> </th> </tr><tr><td class="cellrowborder" width="33.72%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal#section401-参数检查失败" target="_blank">401</a></p> </td> <td class="cellrowborder" width="66.28%"><p>Parameter error.</p> </td> </tr> <tr><td class="cellrowborder" width="33.72%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/reader-error-code#section174762013118">1016900002</a></p> </td> <td class="cellrowborder" width="66.28%"><p>Read Page Component is not initialized.</p> </td> </tr> <tr><td class="cellrowborder" width="33.72%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/reader-error-code#section16343120935">1016900003</a></p> </td> <td class="cellrowborder" width="66.28%"><p>Invalid request.</p> </td> </tr> <tr><td class="cellrowborder" width="33.72%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/reader-error-code#section14689171516514">1016900999</a></p> </td> <td class="cellrowborder" width="66.28%"><p>Other error.</p> </td> </tr>  </tbody></table></div> </div> <p><strong>示例：</strong></p> <div _ngcontent-xkh-c106="" class="highlight-div"><div _ngcontent-xkh-c106="" class="highlight-div-header"><div _ngcontent-xkh-c106="" class="highlight-div-header-left"><div _ngcontent-xkh-c106="" class="handle-button expand-button"><div _ngcontent-xkh-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xkh-c106="" class="highlight-div-header-right"><div _ngcontent-xkh-c106="" class="handle-button ai-button"></div><div _ngcontent-xkh-c106="" class="handle-button line-button"><div _ngcontent-xkh-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xkh-c106="" class="handle-button theme-button"><div _ngcontent-xkh-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xkh-c106="" class="handle-button copy-button"><div _ngcontent-xkh-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xkh-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { readerCore, <span class="hljs-title class_">ReadPageComponent</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ReaderKit'</span>;</li><li><span class="hljs-keyword">import</span> { common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li><span class="hljs-keyword">import</span> { display } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Reader</span> {</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">readerComponentController</span>: readerCore.<span class="hljs-property">ReaderComponentController</span> = <span class="hljs-keyword">new</span> readerCore.<span class="hljs-title class_">ReaderComponentController</span>();</li><li>
</li><li>  <span class="hljs-title function_">aboutToAppear</span>(): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setPageConfig</span>();</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">setPageConfig</span>(<span class="hljs-params"></span>){</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">readerSetting</span>: readerCore.<span class="hljs-property">ReaderSetting</span> = {</li><li>        <span class="hljs-attr">fontName</span>: <span class="hljs-string">'系统字体'</span>,</li><li>        <span class="hljs-attr">fontPath</span>: <span class="hljs-string">''</span>,</li><li>        <span class="hljs-attr">fontSize</span>: <span class="hljs-number">18</span>,</li><li>        <span class="hljs-attr">fontColor</span>: <span class="hljs-string">'#000000'</span>,</li><li>        <span class="hljs-attr">fontWeight</span>: <span class="hljs-number">400</span>,</li><li>        <span class="hljs-attr">lineHeight</span>: <span class="hljs-number">1.9</span>,</li><li>        <span class="hljs-attr">nightMode</span>: <span class="hljs-literal">false</span>,</li><li>        <span class="hljs-attr">themeColor</span>: <span class="hljs-string">'rgba(248, 249, 250, 1)'</span>,</li><li>        <span class="hljs-attr">themeBgImg</span>: <span class="hljs-string">''</span>,</li><li>        <span class="hljs-attr">flipMode</span>: <span class="hljs-string">'0'</span>,</li><li>        <span class="hljs-attr">scaledDensity</span>: display.<span class="hljs-title function_">getDefaultDisplaySync</span>().<span class="hljs-property">scaledDensity</span> &gt; <span class="hljs-number">0</span> ? display.<span class="hljs-title function_">getDefaultDisplaySync</span>().<span class="hljs-property">scaledDensity</span> :</li><li>          <span class="hljs-number">1</span>,</li><li>        <span class="hljs-attr">viewPortWidth</span>: <span class="hljs-number">1260</span>, <span class="hljs-comment">// 视口宽度，需要根据设备实际情况获取，否则会导致阅读界面异常</span></li><li>        <span class="hljs-attr">viewPortHeight</span>: <span class="hljs-number">2720</span>, <span class="hljs-comment">// 视口高度，需要根据设备实际情况获取，否则会导致阅读界面异常</span></li><li>      };</li><li>
</li><li>      <span class="hljs-keyword">let</span> context = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li>      <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">readerComponentController</span>.<span class="hljs-title function_">init</span>(context);</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">readerComponentController</span>.<span class="hljs-title function_">setPageConfig</span>(readerSetting);</li><li>      hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">`setPageConfig succeeded`</span>);</li><li>    } <span class="hljs-keyword">catch</span> (err) {</li><li>      hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">`failed to setPageConfig, Code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Stack</span>() {</li><li>      <span class="hljs-title class_">ReadPageComponent</span>({</li><li>        <span class="hljs-attr">controller</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">readerComponentController</span>,</li><li>        <span class="hljs-attr">readerCallback</span>: <span class="hljs-function">(<span class="hljs-params">err: BusinessError, data: readerCore.ReaderComponentController</span>) =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">readerComponentController</span> = data;</li><li>        }</li><li>      })</li><li>    }.<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>).<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div> </div> <div class="tiledSection"><h3 id="section3667128165411" device-type="phone,2in1,tablet">startPlay<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section3667128165411" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><p>startPlay(spineIndex: number, domPos: string): Promise&lt;void&gt;</p> <p>以指定阅读进度打开书籍，使用Promise异步回调。</p> <div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content"><p>startPlay接口需在<a href="/consumer/cn/doc/harmonyos-references/reader-read-core#section181215815104">registerBookParser</a>事件成功触发后，才能调用。</p> </div></div></div> <p><strong>元服务API：</strong>从版本5.0.4(16)开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong>SystemCapability.Reader.ReaderService.ReaderCore</p> <p><strong>起始版本：</strong>5.0.4(16)</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.14.9.1.5.1.1" width="25%"><p>参数名</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.14.9.1.5.1.2" width="25%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.14.9.1.5.1.3" width="25%"><p>必填</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.14.9.1.5.1.4" width="25%"><p>说明</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="25%"><p>spineIndex</p> </td> <td class="cellrowborder" width="25%"><p>number</p> </td> <td class="cellrowborder" width="25%"><p>是</p> </td> <td class="cellrowborder" width="25%"><p>内容资源索引<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/reader-book-parser#section1029864651619">SpineItem</a>.index。</p> </td> </tr> <tr><td class="cellrowborder" width="25%"><p>domPos</p> </td> <td class="cellrowborder" width="25%"><p>string</p> </td> <td class="cellrowborder" width="25%"><p>是</p> </td> <td class="cellrowborder" width="25%"><p>用户上次阅读进度。</p> </td> </tr>  </tbody></table></div> </div> <p><strong>返回值：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.14.11.1.3.1.1" width="32.16%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.14.11.1.3.1.2" width="67.84%"><p>说明</p> </th> </tr><tr><td class="cellrowborder" width="32.16%"><p>Promise&lt;void&gt;</p> </td> <td class="cellrowborder" width="67.84%"><p>Promise对象。无返回结果的Promise对象。</p> </td> </tr>  </tbody></table></div> </div> <p><strong>错误码：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.14.13.1.3.1.1" width="33.72%"><p>错误码ID</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.14.13.1.3.1.2" width="66.28%"><p>错误信息</p> </th> </tr><tr><td class="cellrowborder" width="33.72%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal#section401-参数检查失败" target="_blank">401</a></p> </td> <td class="cellrowborder" width="66.28%"><p>Parameter error.</p> </td> </tr> <tr><td class="cellrowborder" width="33.72%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/reader-error-code#section174762013118">1016900002</a></p> </td> <td class="cellrowborder" width="66.28%"><p>Read Page Component is not initialized.</p> </td> </tr> <tr><td class="cellrowborder" width="33.72%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/reader-error-code#section16343120935">1016900003</a></p> </td> <td class="cellrowborder" width="66.28%"><p>Invalid request.</p> </td> </tr> <tr><td class="cellrowborder" width="33.72%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/reader-error-code#section14689171516514">1016900999</a></p> </td> <td class="cellrowborder" width="66.28%"><p>Other error.</p> </td> </tr> <tr><td class="cellrowborder" width="33.72%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/reader-error-code#section13763141364">1016910001</a></p> </td> <td class="cellrowborder" width="66.28%"><p>Invalid spine item.</p> </td> </tr> <tr><td class="cellrowborder" width="33.72%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/reader-error-code#section15116730175">1016910002</a></p> </td> <td class="cellrowborder" width="66.28%"><p>Unexpected spine item resource data.</p> </td> </tr> <tr><td class="cellrowborder" width="33.72%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/reader-error-code#section216871194">1016910003</a></p> </td> <td class="cellrowborder" width="66.28%"><p>Spine item resource data out of range.</p> </td> </tr>  </tbody></table></div> </div> <div class="p"><strong>示例：</strong><div _ngcontent-xkh-c106="" class="highlight-div"><div _ngcontent-xkh-c106="" class="highlight-div-header"><div _ngcontent-xkh-c106="" class="highlight-div-header-left"><div _ngcontent-xkh-c106="" class="handle-button expand-button"><div _ngcontent-xkh-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xkh-c106="" class="highlight-div-header-right"><div _ngcontent-xkh-c106="" class="handle-button ai-button"></div><div _ngcontent-xkh-c106="" class="handle-button line-button"><div _ngcontent-xkh-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xkh-c106="" class="handle-button theme-button"><div _ngcontent-xkh-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xkh-c106="" class="handle-button copy-button"><div _ngcontent-xkh-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xkh-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { bookParser, readerCore, <span class="hljs-title class_">ReadPageComponent</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ReaderKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li><span class="hljs-keyword">import</span> { common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Reader</span> {</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">readerComponentController</span>: readerCore.<span class="hljs-property">ReaderComponentController</span> = <span class="hljs-keyword">new</span> readerCore.<span class="hljs-title class_">ReaderComponentController</span>();</li><li>
</li><li>  <span class="hljs-title function_">aboutToAppear</span>(): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">startPlay</span>();</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">startPlay</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-comment">// 通过提前导入到</span><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/app-sandbox-directory" target="_blank"><span class="hljs-comment">应用沙箱目录</span></a><span class="hljs-comment">中的书籍文件，初始化书籍解析器</span></li><li>      <span class="hljs-keyword">let</span> context = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">filePath</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">`<span class="hljs-subst">${context.filesDir}</span>/abc.epub`</span>;</li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">bookParserHandler</span>: bookParser.<span class="hljs-property">BookParserHandler</span> = <span class="hljs-keyword">await</span> bookParser.<span class="hljs-title function_">getDefaultHandler</span>(filePath);</li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">spineList</span>: bookParser.<span class="hljs-property">SpineItem</span>[] = bookParserHandler.<span class="hljs-title function_">getSpineList</span>();</li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">spineIndex</span>: <span class="hljs-built_in">number</span> = spineList[<span class="hljs-number">0</span>].<span class="hljs-property">index</span>;</li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">domPos</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">''</span>;</li><li>
</li><li>      <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">readerComponentController</span>.<span class="hljs-title function_">init</span>(context);</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">readerComponentController</span>.<span class="hljs-title function_">registerBookParser</span>(bookParserHandler);</li><li>      <span class="hljs-comment">// 调用startPlay接口初始化书籍内容显示</span></li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">readerComponentController</span>.<span class="hljs-title function_">startPlay</span>(spineIndex || <span class="hljs-number">0</span>, domPos);</li><li>      hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">`startPlay succeeded`</span>);</li><li>    } <span class="hljs-keyword">catch</span> (err) {</li><li>      hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">`failed to startPlay, Code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Stack</span>() {</li><li>      <span class="hljs-title class_">ReadPageComponent</span>({</li><li>        <span class="hljs-attr">controller</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">readerComponentController</span>,</li><li>        <span class="hljs-attr">readerCallback</span>: <span class="hljs-function">(<span class="hljs-params">err: BusinessError, data: readerCore.ReaderComponentController</span>) =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">readerComponentController</span> = data;</li><li>        }</li><li>      })</li><li>    }.<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>).<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div> </div> </div> <div class="tiledSection"><h3 id="section444911141952" device-type="phone,2in1,tablet">flipPage<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section444911141952" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><p>flipPage(isNext: boolean): void</p> <p>触发<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/reader-api-readpagecomponent#section3730195311450">ReadPageComponent</a>组件进行翻页。</p> <p><strong>元服务API：</strong>从版本5.0.4(16)开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong>SystemCapability.Reader.ReaderService.ReaderCore</p> <p><strong>起始版本：</strong>5.0.4(16)</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.15.8.1.5.1.1" width="25%"><p>参数名</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.15.8.1.5.1.2" width="25%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.15.8.1.5.1.3" width="25%"><p>必填</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.15.8.1.5.1.4" width="25%"><p>说明</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="25%"><p>isNext</p> </td> <td class="cellrowborder" width="25%"><p>boolean</p> </td> <td class="cellrowborder" width="25%"><p>是</p> </td> <td class="cellrowborder" width="25%"><p>是否翻到下一页。</p> <p>true：往下一页翻页。</p> <p>false：往上一页翻页。</p> </td> </tr>  </tbody></table></div> </div> <p><strong>错误码：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.15.10.1.3.1.1" width="33.72%"><p>错误码ID</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.15.10.1.3.1.2" width="66.28%"><p>错误信息</p> </th> </tr><tr><td class="cellrowborder" width="33.72%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-universal#section401-参数检查失败" target="_blank">401</a></p> </td> <td class="cellrowborder" width="66.28%"><p>Parameter error.</p> </td> </tr> <tr><td class="cellrowborder" width="33.72%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/reader-error-code#section174762013118">1016900002</a></p> </td> <td class="cellrowborder" width="66.28%"><p>Read Page Component is not initialized.</p> </td> </tr> <tr><td class="cellrowborder" width="33.72%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/reader-error-code#section16343120935">1016900003</a></p> </td> <td class="cellrowborder" width="66.28%"><p>Invalid request.</p> </td> </tr> <tr><td class="cellrowborder" width="33.72%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/reader-error-code#section14689171516514">1016900999</a></p> </td> <td class="cellrowborder" width="66.28%"><p>Other error.</p> </td> </tr>  </tbody></table></div> </div> <p><strong>示例：</strong></p> <div _ngcontent-xkh-c106="" class="highlight-div"><div _ngcontent-xkh-c106="" class="highlight-div-header"><div _ngcontent-xkh-c106="" class="highlight-div-header-left"><div _ngcontent-xkh-c106="" class="handle-button expand-button"><div _ngcontent-xkh-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xkh-c106="" class="highlight-div-header-right"><div _ngcontent-xkh-c106="" class="handle-button ai-button"></div><div _ngcontent-xkh-c106="" class="handle-button line-button"><div _ngcontent-xkh-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xkh-c106="" class="handle-button theme-button"><div _ngcontent-xkh-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xkh-c106="" class="handle-button copy-button"><div _ngcontent-xkh-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xkh-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { readerCore, <span class="hljs-title class_">ReadPageComponent</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ReaderKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li><span class="hljs-keyword">import</span> { common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Reader</span> {</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">readerComponentController</span>: readerCore.<span class="hljs-property">ReaderComponentController</span> = <span class="hljs-keyword">new</span> readerCore.<span class="hljs-title class_">ReaderComponentController</span>();</li><li>
</li><li>  <span class="hljs-title function_">aboutToAppear</span>(): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">flipPage</span>();</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">flipPage</span>(<span class="hljs-params"></span>){</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-keyword">let</span> context = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li>      <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">readerComponentController</span>.<span class="hljs-title function_">init</span>(context);</li><li>      <span class="hljs-comment">// 翻下一页</span></li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">readerComponentController</span>.<span class="hljs-title function_">flipPage</span>(<span class="hljs-literal">true</span>);</li><li>      hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">`flipPage succeeded`</span>);</li><li>    } <span class="hljs-keyword">catch</span> (err) {</li><li>      hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">`failed to flipPage, Code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Stack</span>() {</li><li>      <span class="hljs-title class_">ReadPageComponent</span>({</li><li>        <span class="hljs-attr">controller</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">readerComponentController</span>,</li><li>        <span class="hljs-attr">readerCallback</span>: <span class="hljs-function">(<span class="hljs-params">err: BusinessError, data: readerCore.ReaderComponentController</span>) =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">readerComponentController</span> = data;</li><li>        }</li><li>      })</li><li>    }.<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>).<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div> </div> <div class="tiledSection"><h3 id="section379443617818" device-type="phone,2in1,tablet">releaseBook<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section379443617818" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><p>releaseBook(): void</p> <p>释放书籍资源，在退出阅读器等释放资源场景时使用。</p> <p><strong>元服务API：</strong>从版本5.0.4(16)开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong>SystemCapability.Reader.ReaderService.ReaderCore</p> <p><strong>起始版本：</strong>5.0.4(16)</p> <p><strong>示例：</strong></p> <div _ngcontent-xkh-c106="" class="highlight-div"><div _ngcontent-xkh-c106="" class="highlight-div-header"><div _ngcontent-xkh-c106="" class="highlight-div-header-left"><div _ngcontent-xkh-c106="" class="handle-button expand-button"><div _ngcontent-xkh-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xkh-c106="" class="highlight-div-header-right"><div _ngcontent-xkh-c106="" class="handle-button ai-button"></div><div _ngcontent-xkh-c106="" class="handle-button line-button"><div _ngcontent-xkh-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xkh-c106="" class="handle-button theme-button"><div _ngcontent-xkh-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xkh-c106="" class="handle-button copy-button"><div _ngcontent-xkh-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xkh-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { readerCore, <span class="hljs-title class_">ReadPageComponent</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ReaderKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li><span class="hljs-keyword">import</span> { common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Reader</span> {</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">readerComponentController</span>: readerCore.<span class="hljs-property">ReaderComponentController</span> = <span class="hljs-keyword">new</span> readerCore.<span class="hljs-title class_">ReaderComponentController</span>();</li><li>
</li><li>  <span class="hljs-title function_">aboutToAppear</span>(): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">releaseBook</span>();</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">releaseBook</span>(<span class="hljs-params"></span>){</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-keyword">let</span> context = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li>      <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">readerComponentController</span>.<span class="hljs-title function_">init</span>(context);</li><li>      <span class="hljs-comment">// 释放加载书籍时的资源</span></li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">readerComponentController</span>.<span class="hljs-title function_">releaseBook</span>();</li><li>      hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">`releaseBook succeeded`</span>);</li><li>    } <span class="hljs-keyword">catch</span> (err) {</li><li>      hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">`failed to releaseBook, Code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Stack</span>() {</li><li>      <span class="hljs-title class_">ReadPageComponent</span>({</li><li>        <span class="hljs-attr">controller</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">readerComponentController</span>,</li><li>        <span class="hljs-attr">readerCallback</span>: <span class="hljs-function">(<span class="hljs-params">err: BusinessError, data: readerCore.ReaderComponentController</span>) =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">readerComponentController</span> = data;</li><li>        }</li><li>      })</li><li>    }.<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>).<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div> </div> <div class="tiledSection"><h3 id="section1657755491213" device-type="phone,2in1,tablet">on('pageShow')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section1657755491213" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><p>on(type: 'pageShow', callback: Callback&lt;PageDataInfo&gt;): void</p> <p>注册章节内容分页展示结果回调。</p> <p><strong>元服务API：</strong>从版本5.0.4(16)开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong>SystemCapability.Reader.ReaderService.ReaderCore</p> <p><strong>起始版本：</strong>5.0.4(16)</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.17.8.1.5.1.1" width="25%"><p>参数名</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.17.8.1.5.1.2" width="25%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.17.8.1.5.1.3" width="25%"><p>必填</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.17.8.1.5.1.4" width="25%"><p>说明</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="25%"><p>type</p> </td> <td class="cellrowborder" width="25%"><p>string</p> </td> <td class="cellrowborder" width="25%"><p>是</p> </td> <td class="cellrowborder" width="25%"><p>事件回调类型，支持的事件为“pageShow”。</p> </td> </tr> <tr><td class="cellrowborder" width="25%"><p>callback</p> </td> <td class="cellrowborder" width="25%"><p>Callback&lt;<a href="/consumer/cn/doc/harmonyos-references/reader-read-core#section1064382518239">PageDataInfo</a>&gt;</p> </td> <td class="cellrowborder" width="25%"><p>是</p> </td> <td class="cellrowborder" width="25%"><p>回调函数，返回内容分页排版信息。</p> </td> </tr>  </tbody></table></div> </div> <p><strong>示例：</strong></p> <div _ngcontent-xkh-c106="" class="highlight-div"><div _ngcontent-xkh-c106="" class="highlight-div-header"><div _ngcontent-xkh-c106="" class="highlight-div-header-left"><div _ngcontent-xkh-c106="" class="handle-button expand-button"><div _ngcontent-xkh-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xkh-c106="" class="highlight-div-header-right"><div _ngcontent-xkh-c106="" class="handle-button ai-button"></div><div _ngcontent-xkh-c106="" class="handle-button line-button"><div _ngcontent-xkh-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xkh-c106="" class="handle-button theme-button"><div _ngcontent-xkh-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xkh-c106="" class="handle-button copy-button"><div _ngcontent-xkh-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xkh-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { readerCore, <span class="hljs-title class_">ReadPageComponent</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ReaderKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li><span class="hljs-keyword">import</span> { common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Reader</span> {</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">readerComponentController</span>: readerCore.<span class="hljs-property">ReaderComponentController</span> = <span class="hljs-keyword">new</span> readerCore.<span class="hljs-title class_">ReaderComponentController</span>();</li><li>
</li><li>  <span class="hljs-title function_">aboutToAppear</span>(): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">registerListener</span>();</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">registerListener</span>(<span class="hljs-params"></span>){</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-keyword">let</span> context = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li>      <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">readerComponentController</span>.<span class="hljs-title function_">init</span>(context)</li><li>      <span class="hljs-comment">// 此处只演示方法调用，实际触发回调，需要配合startPlay接口使用</span></li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">readerComponentController</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">'pageShow'</span>, (<span class="hljs-attr">data</span>: readerCore.<span class="hljs-property">PageDataInfo</span>): <span class="hljs-function"><span class="hljs-params">void</span> =&gt;</span> {</li><li>        <span class="hljs-comment">// 开发者可在此保存内容分布排版数据，利用data.resourceIndex及data.startDomPos数据调用startPlay接口继续阅读</span></li><li>        hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">'pageshow: data is: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data));</li><li>      });</li><li>    } <span class="hljs-keyword">catch</span> (err) {</li><li>      hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">`failed to registerListener, Code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Stack</span>() {</li><li>      <span class="hljs-title class_">ReadPageComponent</span>({</li><li>        <span class="hljs-attr">controller</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">readerComponentController</span>,</li><li>        <span class="hljs-attr">readerCallback</span>: <span class="hljs-function">(<span class="hljs-params">err: BusinessError, data: readerCore.ReaderComponentController</span>) =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">readerComponentController</span> = data;</li><li>        }</li><li>      })</li><li>    }.<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>).<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div> </div> <div class="tiledSection"><h3 id="section18368173691416" device-type="phone,2in1,tablet">off('pageShow')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section18368173691416" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><p>off(type: 'pageShow', callback?: Callback&lt;PageDataInfo&gt;): void</p> <p>注销章节内容分页展示结果回调，可在页面销毁时调用。</p> <p><strong>元服务API：</strong>从版本5.0.4(16)开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong>SystemCapability.Reader.ReaderService.ReaderCore</p> <p><strong>起始版本：</strong>5.0.4(16)</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.18.8.1.5.1.1" width="25%"><p>参数名</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.18.8.1.5.1.2" width="25%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.18.8.1.5.1.3" width="24.97%"><p>必填</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.18.8.1.5.1.4" width="25.03%"><p>说明</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="25%"><p>type</p> </td> <td class="cellrowborder" width="25%"><p>string</p> </td> <td class="cellrowborder" width="24.97%"><p>是</p> </td> <td class="cellrowborder" width="25.03%"><p>事件回调类型，支持的事件为“pageShow”。</p> </td> </tr> <tr><td class="cellrowborder" width="25%"><p>callback</p> </td> <td class="cellrowborder" width="25%"><p>Callback&lt;<a href="/consumer/cn/doc/harmonyos-references/reader-read-core#section1064382518239">PageDataInfo</a>&gt;</p> </td> <td class="cellrowborder" width="24.97%"><p>否</p> </td> <td class="cellrowborder" width="25.03%"><p>回调函数，需要传“on('pageShow')”同样的回调函数，若不传则注销所有的回调函数。</p> </td> </tr>  </tbody></table></div> </div> <p><strong>示例：</strong></p> <div _ngcontent-xkh-c106="" class="highlight-div"><div _ngcontent-xkh-c106="" class="highlight-div-header"><div _ngcontent-xkh-c106="" class="highlight-div-header-left"><div _ngcontent-xkh-c106="" class="handle-button expand-button"><div _ngcontent-xkh-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xkh-c106="" class="highlight-div-header-right"><div _ngcontent-xkh-c106="" class="handle-button ai-button"></div><div _ngcontent-xkh-c106="" class="handle-button line-button"><div _ngcontent-xkh-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xkh-c106="" class="handle-button theme-button"><div _ngcontent-xkh-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xkh-c106="" class="handle-button copy-button"><div _ngcontent-xkh-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xkh-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { readerCore, <span class="hljs-title class_">ReadPageComponent</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ReaderKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li><span class="hljs-keyword">import</span> { common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Reader</span> {</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">readerComponentController</span>: readerCore.<span class="hljs-property">ReaderComponentController</span> = <span class="hljs-keyword">new</span> readerCore.<span class="hljs-title class_">ReaderComponentController</span>();</li><li>
</li><li>  <span class="hljs-title function_">aboutToAppear</span>(): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">unregisterListener</span>();</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">unregisterListener</span>(<span class="hljs-params"></span>){</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-keyword">let</span> context = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">readerComponentController</span>: readerCore.<span class="hljs-property">ReaderComponentController</span> = <span class="hljs-keyword">new</span> readerCore.<span class="hljs-title class_">ReaderComponentController</span>();</li><li>      <span class="hljs-keyword">await</span> readerComponentController.<span class="hljs-title function_">init</span>(context);</li><li>      readerComponentController.<span class="hljs-title function_">off</span>(<span class="hljs-string">'pageShow'</span>);</li><li>      hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">`offPageShow succeeded`</span>);</li><li>    } <span class="hljs-keyword">catch</span> (err) {</li><li>      hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">`failed to unregisterListener, Code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Stack</span>() {</li><li>      <span class="hljs-title class_">ReadPageComponent</span>({</li><li>        <span class="hljs-attr">controller</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">readerComponentController</span>,</li><li>        <span class="hljs-attr">readerCallback</span>: <span class="hljs-function">(<span class="hljs-params">err: BusinessError, data: readerCore.ReaderComponentController</span>) =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">readerComponentController</span> = data;</li><li>        }</li><li>      })</li><li>    }.<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>).<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div> </div> <div class="tiledSection"><h3 id="section169541417131914" device-type="phone,2in1,tablet">on('resourceRequest')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section169541417131914" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><p>on(type: 'resourceRequest', callback: bookParser.CallbackRes&lt;string, ArrayBuffer&gt;): void</p> <p>注册资源请求回调，如果设置了自定义背景，字体时，排版引擎会通过此接口获取对应的资源ArrayBuffer。</p> <div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content"><p>注册多个资源请求回调时，只会生效最后一个。</p> </div></div></div> <p><strong>元服务API：</strong>从版本5.0.4(16)开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong>SystemCapability.Reader.ReaderService.ReaderCore</p> <p><strong>起始版本：</strong>5.0.4(16)</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.19.9.1.5.1.1" width="25%"><p>参数名</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.19.9.1.5.1.2" width="25%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.19.9.1.5.1.3" width="23.51%"><p>必填</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.19.9.1.5.1.4" width="26.490000000000002%"><p>说明</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="25%"><p>type</p> </td> <td class="cellrowborder" width="25%"><p>string</p> </td> <td class="cellrowborder" width="23.51%"><p>是</p> </td> <td class="cellrowborder" width="26.490000000000002%"><p>事件回调类型，支持的事件为“resourceRequest”。</p> </td> </tr> <tr><td class="cellrowborder" width="25%"><p>callback</p> </td> <td class="cellrowborder" width="25%"><p>bookParser.<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/reader-book-parser#section174676520576">CallbackRes</a>&lt;string, ArrayBuffer&gt;</p> </td> <td class="cellrowborder" width="23.51%"><p>是</p> </td> <td class="cellrowborder" width="26.490000000000002%"><p>回调函数，string：请求资源路径。ArrayBuffer：请求资源对应的二进制数据。</p> </td> </tr>  </tbody></table></div> </div> <p><strong>示例：</strong></p> <div _ngcontent-xkh-c106="" class="highlight-div"><div _ngcontent-xkh-c106="" class="highlight-div-header"><div _ngcontent-xkh-c106="" class="highlight-div-header-left"><div _ngcontent-xkh-c106="" class="handle-button expand-button"><div _ngcontent-xkh-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xkh-c106="" class="highlight-div-header-right"><div _ngcontent-xkh-c106="" class="handle-button ai-button"></div><div _ngcontent-xkh-c106="" class="handle-button line-button"><div _ngcontent-xkh-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xkh-c106="" class="handle-button theme-button"><div _ngcontent-xkh-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xkh-c106="" class="handle-button copy-button"><div _ngcontent-xkh-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xkh-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { bookParser, readerCore, <span class="hljs-title class_">ReadPageComponent</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ReaderKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li><span class="hljs-keyword">import</span> { common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Reader</span> {</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">readerComponentController</span>: readerCore.<span class="hljs-property">ReaderComponentController</span> = <span class="hljs-keyword">new</span> readerCore.<span class="hljs-title class_">ReaderComponentController</span>();</li><li>  <span class="hljs-comment">// 字体文件以实际文件名及路径为准</span></li><li>  <span class="hljs-keyword">private</span> selectFontPath = <span class="hljs-string">'fonts/SourceHanSerifCN-VF.ttf'</span>;</li><li>
</li><li>  <span class="hljs-title function_">aboutToAppear</span>(): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">registerListener</span>();</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">registerListener</span>(<span class="hljs-params"></span>){</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-keyword">let</span> context = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li>      <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">readerComponentController</span>.<span class="hljs-title function_">init</span>(context);</li><li>      <span class="hljs-comment">// 此处只演示方法调用，实际触发回调，需要配合startPlay接口使用</span></li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">readerComponentController</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">'resourceRequest'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">resourceRequest</span>);</li><li>    } <span class="hljs-keyword">catch</span> (err) {</li><li>      hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">`failed to registerListener, Code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">resourceRequest</span>: bookParser.<span class="hljs-property">CallbackRes</span>&lt;<span class="hljs-built_in">string</span>,<span class="hljs-title class_">ArrayBuffer</span>&gt; = (<span class="hljs-attr">fileName</span>: <span class="hljs-built_in">string</span>): <span class="hljs-function"><span class="hljs-params">ArrayBuffer</span> =&gt;</span> {</li><li>    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">isFont</span>(fileName)) {</li><li>      <span class="hljs-keyword">let</span> res = $rawfile(<span class="hljs-variable language_">this</span>.<span class="hljs-property">selectFontPath</span>);</li><li>      <span class="hljs-keyword">let</span> context = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>();</li><li>      <span class="hljs-keyword">if</span> (res &amp;&amp; context) {</li><li>        <span class="hljs-keyword">try</span> {</li><li>          <span class="hljs-comment">// 获取资源路径下的字体数据</span></li><li>          <span class="hljs-keyword">let</span> <span class="hljs-attr">value</span>: <span class="hljs-title class_">Uint8Array</span> = context.<span class="hljs-property">resourceManager</span>.<span class="hljs-title function_">getRawFileContentSync</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">selectFontPath</span>);</li><li>          hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">'resourceRequest : get success'</span>);</li><li>          <span class="hljs-keyword">return</span> value.<span class="hljs-property">buffer</span> <span class="hljs-keyword">as</span> <span class="hljs-title class_">ArrayBuffer</span>;</li><li>        } <span class="hljs-keyword">catch</span> (error) {</li><li>          <span class="hljs-keyword">let</span> code = (error <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span>;</li><li>          <span class="hljs-keyword">let</span> message = (error <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>;</li><li>          hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">`callback getRawFileContent failed, error code: <span class="hljs-subst">${code}</span>, message: <span class="hljs-subst">${message}</span>.`</span>);</li><li>        }</li><li>      }</li><li>    }</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayBuffer</span>(<span class="hljs-number">0</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-title function_">isFont</span>(<span class="hljs-attr">filePath</span>: <span class="hljs-built_in">string</span>): <span class="hljs-built_in">boolean</span> {</li><li>    <span class="hljs-keyword">let</span> options = [<span class="hljs-string">".ttf"</span>, <span class="hljs-string">".woff2"</span>, <span class="hljs-string">".otf"</span>];</li><li>    <span class="hljs-keyword">let</span> path = filePath.<span class="hljs-title function_">toLowerCase</span>();</li><li>    <span class="hljs-keyword">let</span> result = path.<span class="hljs-title function_">indexOf</span>(options[<span class="hljs-number">0</span>]) != -<span class="hljs-number">1</span> || path.<span class="hljs-title function_">indexOf</span>(options[<span class="hljs-number">1</span>]) != -<span class="hljs-number">1</span> || path.<span class="hljs-title function_">indexOf</span>(options[<span class="hljs-number">2</span>]) != -<span class="hljs-number">1</span>;</li><li>    hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">'isFont = '</span> + result);</li><li>    <span class="hljs-keyword">return</span> result;</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Stack</span>() {</li><li>      <span class="hljs-title class_">ReadPageComponent</span>({</li><li>        <span class="hljs-attr">controller</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">readerComponentController</span>,</li><li>        <span class="hljs-attr">readerCallback</span>: <span class="hljs-function">(<span class="hljs-params">err: BusinessError, data: readerCore.ReaderComponentController</span>) =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">readerComponentController</span> = data;</li><li>        }</li><li>      })</li><li>    }.<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>).<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div> </div> <div class="tiledSection"><h3 id="section3912114022216" device-type="phone,2in1,tablet">off('resourceRequest')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section3912114022216" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span></div><p>off(type: 'resourceRequest', callback?: bookParser.CallbackRes&lt;string, ArrayBuffer&gt;): void</p> <p>注销资源请求回调接口，可在页面销毁时调用。</p> <p><strong>元服务API：</strong>从版本5.0.4(16)开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong>SystemCapability.Reader.ReaderService.ReaderCore</p> <p><strong>起始版本：</strong>5.0.4(16)</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.20.8.1.5.1.1" width="25%"><p>参数名</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.20.8.1.5.1.2" width="25%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.20.8.1.5.1.3" width="24.22%"><p>必填</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.20.8.1.5.1.4" width="25.779999999999998%"><p>说明</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="25%"><p>type</p> </td> <td class="cellrowborder" width="25%"><p>string</p> </td> <td class="cellrowborder" width="24.22%"><p>是</p> </td> <td class="cellrowborder" width="25.779999999999998%"><p>事件回调类型，支持的事件为“resourceRequest”。</p> </td> </tr> <tr><td class="cellrowborder" width="25%"><p>callback</p> </td> <td class="cellrowborder" width="25%"><p>bookParser.<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/reader-book-parser#section174676520576">CallbackRes</a>&lt;string, ArrayBuffer&gt;</p> </td> <td class="cellrowborder" width="24.22%"><p>否</p> </td> <td class="cellrowborder" width="25.779999999999998%"><p>回调函数，需要传与“on('resourceRequest')”同样的回调函数，若不传则注销所有的回调函数。</p> </td> </tr>  </tbody></table></div> </div> <p><strong>示例：</strong></p> <div _ngcontent-xkh-c106="" class="highlight-div"><div _ngcontent-xkh-c106="" class="highlight-div-header"><div _ngcontent-xkh-c106="" class="highlight-div-header-left"><div _ngcontent-xkh-c106="" class="handle-button expand-button"><div _ngcontent-xkh-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xkh-c106="" class="highlight-div-header-right"><div _ngcontent-xkh-c106="" class="handle-button ai-button"></div><div _ngcontent-xkh-c106="" class="handle-button line-button"><div _ngcontent-xkh-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xkh-c106="" class="handle-button theme-button"><div _ngcontent-xkh-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xkh-c106="" class="handle-button copy-button"><div _ngcontent-xkh-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xkh-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { readerCore, <span class="hljs-title class_">ReadPageComponent</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ReaderKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li><span class="hljs-keyword">import</span> { common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Reader</span> {</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">readerComponentController</span>: readerCore.<span class="hljs-property">ReaderComponentController</span> = <span class="hljs-keyword">new</span> readerCore.<span class="hljs-title class_">ReaderComponentController</span>();</li><li>
</li><li>  <span class="hljs-title function_">aboutToAppear</span>(): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">unregisterListener</span>();</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">unregisterListener</span>(<span class="hljs-params"></span>){</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-keyword">let</span> context = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li>      <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">readerComponentController</span>.<span class="hljs-title function_">init</span>(context);</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">readerComponentController</span>.<span class="hljs-title function_">off</span>(<span class="hljs-string">'resourceRequest'</span>);</li><li>      hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">`offResourceRequest succeeded`</span>);</li><li>    } <span class="hljs-keyword">catch</span> (err) {</li><li>      hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">`failed to unregisterListener, Code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Stack</span>() {</li><li>      <span class="hljs-title class_">ReadPageComponent</span>({</li><li>        <span class="hljs-attr">controller</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">readerComponentController</span>,</li><li>        <span class="hljs-attr">readerCallback</span>: <span class="hljs-function">(<span class="hljs-params">err: BusinessError, data: readerCore.ReaderComponentController</span>) =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">readerComponentController</span> = data;</li><li>        }</li><li>      })</li><li>    }.<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>).<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div> <p></p> </div> </div> <div></div></div>