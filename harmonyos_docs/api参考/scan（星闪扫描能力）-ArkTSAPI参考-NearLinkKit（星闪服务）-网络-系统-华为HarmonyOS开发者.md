<h1 _ngcontent-hdy-c119="" class="doc-title ng-star-inserted" title="scan（星闪扫描能力）"> scan（星闪扫描能力） </h1>

<div _ngcontent-hdy-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div><p>本模块提供了星闪扫描相关功能。</p> <p><strong>起始版本：</strong>5.0.1(13)</p> <div class="tiledSection"><h2 id="section148115414307" device-type="phone,2in1,tv,tablet,wearable">导入模块<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section148115414307" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><div _ngcontent-hdy-c106="" class="highlight-div"><div _ngcontent-hdy-c106="" class="highlight-div-header"><div _ngcontent-hdy-c106="" class="highlight-div-header-left"><div _ngcontent-hdy-c106="" class="handle-button expand-button"><div _ngcontent-hdy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-hdy-c106="" class="highlight-div-header-right"><div _ngcontent-hdy-c106="" class="handle-button ai-button"></div><div _ngcontent-hdy-c106="" class="handle-button line-button"><div _ngcontent-hdy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-hdy-c106="" class="handle-button theme-button"><div _ngcontent-hdy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-hdy-c106="" class="handle-button copy-button"><div _ngcontent-hdy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-hdy-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { scan } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NearLinkKit'</span>;</li></ol></pre></div></div> </div> <div class="tiledSection"><h2 id="section87401754163116" device-type="phone,2in1,tv,tablet,wearable">startScan<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section87401754163116" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>startScan(filters: Array&lt;ScanFilters&gt;, options?: ScanOptions): Promise&lt;void&gt;</p> <p>发起星闪扫描。使用Promise异步回调。</p> <p><strong>需要权限：</strong>ohos.permission.ACCESS_NEARLINK</p> <p><strong>系统能力：</strong>SystemCapability.Communication.NearLink.Core</p> <p><strong>起始版本：</strong>5.0.1(13)</p> <div class="p"><strong>参数：</strong> <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.4.7.2.1.5.1.1" width="13.320000000000002%"><p>参数名</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.4.7.2.1.5.1.2" width="25.319999999999997%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.4.7.2.1.5.1.3" width="7.12%"><p>必填</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.4.7.2.1.5.1.4" width="54.24%"><p>说明</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="13.320000000000002%"><p>filters</p> </td> <td class="cellrowborder" width="25.319999999999997%"><p>Array&lt;<a href="/consumer/cn/doc/harmonyos-references/nearlink-scan#section14720175812465">ScanFilters</a>&gt;</p> </td> <td class="cellrowborder" width="7.12%"><p>是</p> </td> <td class="cellrowborder" width="54.24%"><p>表示扫描过滤器，配置期望扫描的设备名称、地址等信息。其中表示过滤条件的ScanFilters中全部字段均为可选字段，所有字段都未配置的ScanFilters代表一组空过滤器，视为无效过滤器而忽略。不允许filters中的所有ScanFilters都配置为空过滤器，否则返回错误码401。</p> </td> </tr> <tr><td class="cellrowborder" width="13.320000000000002%"><p>options</p> </td> <td class="cellrowborder" width="25.319999999999997%"><p><a href="/consumer/cn/doc/harmonyos-references/nearlink-scan#section74475912491">ScanOptions</a></p> </td> <td class="cellrowborder" width="7.12%"><p>否</p> </td> <td class="cellrowborder" width="54.24%"><p>表示扫描选项。默认为低功耗模式。</p> </td> </tr>  </tbody></table></div> </div> </div> <div class="p"><strong>返回值：</strong> <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.4.8.2.1.3.1.1" width="28.050000000000004%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.4.8.2.1.3.1.2" width="71.95%"><p>说明</p> </th> </tr><tr><td class="cellrowborder" width="28.050000000000004%"><p>Promise&lt;void&gt;</p> </td> <td class="cellrowborder" width="71.95%"><p>Promise对象，无返回值。</p> </td> </tr>  </tbody></table></div> </div> </div> <p><strong>错误码：</strong></p> <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/nearlink-error-code">ArkTS API错误码</a>。</p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.4.11.1.3.1.1" style="border: none;" width="49.419999999999995%"><p>错误码ID</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.4.11.1.3.1.2" style="border: none;" width="50.580000000000005%"><p>错误信息</p> </th> </tr><tr><td class="cellrowborder" style="border: none;" width="49.419999999999995%"><p>201</p> </td> <td class="cellrowborder" style="border: none;" width="50.580000000000005%"><p>Permission denied</p> </td> </tr> <tr><td class="cellrowborder" style="border: none;" width="49.419999999999995%"><p>401</p> </td> <td class="cellrowborder" style="border: none;" width="50.580000000000005%"><p>Invalid parameter</p> </td> </tr> <tr><td class="cellrowborder" style="border: none;" width="49.419999999999995%"><p>801</p> </td> <td class="cellrowborder" style="border: none;" width="50.580000000000005%"><p>Capability not supported</p> </td> </tr> <tr><td class="cellrowborder" style="border: none;" width="49.419999999999995%"><p>1009700003</p> </td> <td class="cellrowborder" style="border: none;" width="50.580000000000005%"><p>Nearlink is off</p> </td> </tr> <tr><td class="cellrowborder" style="border: none;" width="49.419999999999995%"><p>1009700099</p> </td> <td class="cellrowborder" style="border: none;" width="50.580000000000005%"><p>Operation failed</p> </td> </tr>  </tbody></table></div> </div> <div class="p"><strong>示例：</strong><div _ngcontent-hdy-c106="" class="highlight-div"><div _ngcontent-hdy-c106="" class="highlight-div-header"><div _ngcontent-hdy-c106="" class="highlight-div-header-left"><div _ngcontent-hdy-c106="" class="handle-button expand-button"><div _ngcontent-hdy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-hdy-c106="" class="highlight-div-header-right"><div _ngcontent-hdy-c106="" class="handle-button ai-button"></div><div _ngcontent-hdy-c106="" class="handle-button line-button"><div _ngcontent-hdy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-hdy-c106="" class="handle-button theme-button"><div _ngcontent-hdy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-hdy-c106="" class="handle-button copy-button"><div _ngcontent-hdy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-hdy-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-variable">scan</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NearLinkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-variable">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-variable">scanFilter</span>: <span class="hljs-title class_">scan</span>.<span class="hljs-title class_">ScanFilters</span> = {</li><li>  <span class="hljs-variable">address</span>: <span class="hljs-string">"11:22:33:44:AA:FF"</span>, <span class="hljs-comment">// 期望扫描到的外围设备地址</span></li><li>  <span class="hljs-variable">deviceName</span>: <span class="hljs-string">"device name"</span> <span class="hljs-comment">// 期望扫描到的外围设备名称</span></li><li>};</li><li><span class="hljs-keyword">let</span> <span class="hljs-variable">scanOptions</span>: <span class="hljs-title class_">scan</span>.<span class="hljs-title class_">ScanOptions</span> = {</li><li>  <span class="hljs-variable">scanMode</span>: <span class="hljs-title class_">scan</span>.<span class="hljs-title class_">ScanMode</span>.<span class="hljs-title class_">SCAN_MODE_LOW_POWER</span></li><li>}</li><li><span class="hljs-keyword">try</span> {</li><li>  <span class="hljs-variable">scan</span>.<span class="hljs-title function_">startScan</span>([<span class="hljs-variable">scanFilter</span>], <span class="hljs-variable">scanOptions</span>).<span class="hljs-title function_">then</span>(() =&gt; {</li><li>    <span class="hljs-variable">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"start scan success"</span>);</li><li>  });</li><li>} <span class="hljs-keyword">catch</span> (<span class="hljs-variable">err</span>) {</li><li>  <span class="hljs-variable">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (<span class="hljs-variable">err</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">BusinessError</span>).<span class="hljs-variable">code</span> + <span class="hljs-string">', errMessage: '</span> + (<span class="hljs-variable">err</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">BusinessError</span>).<span class="hljs-variable">message</span>);</li><li>}</li></ol></pre></div></div> </div> </div> <div class="tiledSection"><h2 id="section11322144811298" device-type="phone,2in1,tv,tablet,wearable">stopScan<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section11322144811298" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>stopScan(): Promise&lt;void&gt;</p> <p>停止星闪扫描。使用Promise异步回调。</p> <p><strong>需要权限：</strong>ohos.permission.ACCESS_NEARLINK</p> <p><strong>系统能力：</strong>SystemCapability.Communication.NearLink.Core</p> <p><strong>起始版本：</strong>5.0.1(13)</p> <div class="p"><strong>返回值：</strong> <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.5.7.2.1.3.1.1" width="28.050000000000004%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.5.7.2.1.3.1.2" width="71.95%"><p>说明</p> </th> </tr><tr><td class="cellrowborder" width="28.050000000000004%"><p>Promise&lt;void&gt;</p> </td> <td class="cellrowborder" width="71.95%"><p>Promise对象，无返回值。</p> </td> </tr>  </tbody></table></div> </div> </div> <p><strong>错误码：</strong></p> <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/nearlink-error-code">ArkTS API错误码</a>。</p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.5.10.1.3.1.1" style="border: none;" width="49.419999999999995%"><p>错误码ID</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.5.10.1.3.1.2" style="border: none;" width="50.580000000000005%"><p>错误信息</p> </th> </tr><tr><td class="cellrowborder" style="border: none;" width="49.419999999999995%"><p>201</p> </td> <td class="cellrowborder" style="border: none;" width="50.580000000000005%"><p>Permission denied</p> </td> </tr> <tr><td class="cellrowborder" style="border: none;" width="49.419999999999995%"><p>801</p> </td> <td class="cellrowborder" style="border: none;" width="50.580000000000005%"><p>Capability not supported</p> </td> </tr> <tr><td class="cellrowborder" style="border: none;" width="49.419999999999995%"><p>1009700003</p> </td> <td class="cellrowborder" style="border: none;" width="50.580000000000005%"><p>Nearlink is off</p> </td> </tr> <tr><td class="cellrowborder" style="border: none;" width="49.419999999999995%"><p>1009700099</p> </td> <td class="cellrowborder" style="border: none;" width="50.580000000000005%"><p>Operation failed</p> </td> </tr>  </tbody></table></div> </div> <div class="p"><strong>示例：</strong><div _ngcontent-hdy-c106="" class="highlight-div"><div _ngcontent-hdy-c106="" class="highlight-div-header"><div _ngcontent-hdy-c106="" class="highlight-div-header-left"><div _ngcontent-hdy-c106="" class="handle-button expand-button"><div _ngcontent-hdy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-hdy-c106="" class="highlight-div-header-right"><div _ngcontent-hdy-c106="" class="handle-button ai-button"></div><div _ngcontent-hdy-c106="" class="handle-button line-button"><div _ngcontent-hdy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-hdy-c106="" class="handle-button theme-button"><div _ngcontent-hdy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-hdy-c106="" class="handle-button copy-button"><div _ngcontent-hdy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-hdy-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { scan } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NearLinkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">try</span> {</li><li>  scan.<span class="hljs-title function_">stopScan</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"stop scan success"</span>);</li><li>  });</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div> </div> </div> <div class="tiledSection"><h2 id="section13106021163" device-type="phone,2in1,tv,tablet,wearable">on( 'deviceFound')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section13106021163" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>on(type: 'deviceFound', callback: Callback&lt;Array&lt;ScanResults&gt;&gt;): void</p> <p>订阅星闪扫描结果。回调函数携带远端设备的随机地址。</p> <p><strong>需要权限：</strong>ohos.permission.ACCESS_NEARLINK</p> <p><strong>系统能力：</strong>SystemCapability.Communication.NearLink.Core</p> <p><strong>起始版本：</strong>5.0.1(13)</p> <div class="p"><strong>参数：</strong> <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.6.7.2.1.5.1.1" width="13.320000000000002%"><p>参数名</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.6.7.2.1.5.1.2" width="25.319999999999997%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.6.7.2.1.5.1.3" width="7.12%"><p>必填</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.6.7.2.1.5.1.4" width="54.24%"><p>说明</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="13.320000000000002%"><p>type</p> </td> <td class="cellrowborder" width="25.319999999999997%"><p>string</p> </td> <td class="cellrowborder" width="7.12%"><p>是</p> </td> <td class="cellrowborder" width="54.24%"><p>固定填写"deviceFound"字符串，表示星闪扫描的设备发现事件。</p> </td> </tr> <tr><td class="cellrowborder" width="13.320000000000002%"><p>callback</p> </td> <td class="cellrowborder" width="25.319999999999997%"><p>Callback&lt;Array&lt;<a href="/consumer/cn/doc/harmonyos-references/nearlink-scan#section1622511479139">ScanResults</a>&gt;&gt;</p> </td> <td class="cellrowborder" width="7.12%"><p>是</p> </td> <td class="cellrowborder" width="54.24%"><p>表示星闪扫描结果回调函数的入参。回调函数由用户创建通过该接口注册。</p> </td> </tr>  </tbody></table></div> </div> </div> <p><strong>错误码：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.6.9.1.3.1.1" style="border: none;" width="49.419999999999995%"><p>错误码ID</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.6.9.1.3.1.2" style="border: none;" width="50.580000000000005%"><p>错误信息</p> </th> </tr><tr><td class="cellrowborder" style="border: none;" width="49.419999999999995%"><p>201</p> </td> <td class="cellrowborder" style="border: none;" width="50.580000000000005%"><p>Permission denied</p> </td> </tr> <tr><td class="cellrowborder" style="border: none;" width="49.419999999999995%"><p>401</p> </td> <td class="cellrowborder" style="border: none;" width="50.580000000000005%"><p>Invalid parameter</p> </td> </tr> <tr><td class="cellrowborder" style="border: none;" width="49.419999999999995%"><p>801</p> </td> <td class="cellrowborder" style="border: none;" width="50.580000000000005%"><p>Capability not supported</p> </td> </tr>  </tbody></table></div> </div> <div class="p"><strong>示例：</strong><div _ngcontent-hdy-c106="" class="highlight-div"><div _ngcontent-hdy-c106="" class="highlight-div-header"><div _ngcontent-hdy-c106="" class="highlight-div-header-left"><div _ngcontent-hdy-c106="" class="handle-button expand-button"><div _ngcontent-hdy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-hdy-c106="" class="highlight-div-header-right"><div _ngcontent-hdy-c106="" class="handle-button ai-button"></div><div _ngcontent-hdy-c106="" class="handle-button line-button"><div _ngcontent-hdy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-hdy-c106="" class="handle-button theme-button"><div _ngcontent-hdy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-hdy-c106="" class="handle-button copy-button"><div _ngcontent-hdy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-hdy-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { scan } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NearLinkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">onReceiveEvent</span>:<span class="hljs-function">(<span class="hljs-params">data: <span class="hljs-built_in">Array</span>&lt;scan.ScanResults&gt;</span>) =&gt;</span> <span class="hljs-keyword">void</span> = <span class="hljs-function">(<span class="hljs-params">data: <span class="hljs-built_in">Array</span>&lt;scan.ScanResults&gt;</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'scan result addr:'</span>+ data[<span class="hljs-number">0</span>].<span class="hljs-property">address</span> + <span class="hljs-string">'name:'</span> + data[<span class="hljs-number">0</span>].<span class="hljs-property">deviceName</span>);</li><li>}</li><li><span class="hljs-keyword">try</span> {</li><li>  scan.<span class="hljs-title function_">on</span>(<span class="hljs-string">"deviceFound"</span>, onReceiveEvent);</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div> </div> </div> <div class="tiledSection"><h2 id="section1552411314504" device-type="phone,2in1,tv,tablet,wearable">off( 'deviceFound')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section1552411314504" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>off(type: 'deviceFound', callback?: Callback&lt;Array&lt;ScanResults&gt;&gt;): void</p> <p>取消订阅星闪扫描结果。</p> <p><strong>需要权限：</strong>ohos.permission.ACCESS_NEARLINK</p> <p><strong>系统能力：</strong>SystemCapability.Communication.NearLink.Core</p> <p><strong>起始版本：</strong>5.0.1(13)</p> <div class="p"><strong>参数：</strong> <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.7.7.2.1.5.1.1" width="13.320000000000002%"><p>参数名</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.7.7.2.1.5.1.2" width="25.319999999999997%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.7.7.2.1.5.1.3" width="7.12%"><p>必填</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.7.7.2.1.5.1.4" width="54.24%"><p>说明</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="13.320000000000002%"><p>type</p> </td> <td class="cellrowborder" width="25.319999999999997%"><p>string</p> </td> <td class="cellrowborder" width="7.12%"><p>是</p> </td> <td class="cellrowborder" width="54.24%"><p>固定填写"deviceFound"字符串，表示星闪扫描的设备发现事件。</p> </td> </tr> <tr><td class="cellrowborder" width="13.320000000000002%"><p>callback</p> </td> <td class="cellrowborder" width="25.319999999999997%"><p>Callback&lt;Array&lt;<a href="/consumer/cn/doc/harmonyos-references/nearlink-scan#section1622511479139">ScanResults</a>&gt;&gt;</p> </td> <td class="cellrowborder" width="7.12%"><p>否</p> </td> <td class="cellrowborder" width="54.24%"><p>可选参数，需要取消注册的回调函数，需与订阅时传入的回调函数是同一个。若无此参数，则取消注册所有的回调函数。</p> </td> </tr>  </tbody></table></div> </div> </div> <p><strong>错误码：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.7.9.1.3.1.1" style="border: none;" width="49.419999999999995%"><p>错误码ID</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.7.9.1.3.1.2" style="border: none;" width="50.580000000000005%"><p>错误信息</p> </th> </tr><tr><td class="cellrowborder" style="border: none;" width="49.419999999999995%"><p>201</p> </td> <td class="cellrowborder" style="border: none;" width="50.580000000000005%"><p>Permission denied</p> </td> </tr> <tr><td class="cellrowborder" style="border: none;" width="49.419999999999995%"><p>401</p> </td> <td class="cellrowborder" style="border: none;" width="50.580000000000005%"><p>Invalid parameter</p> </td> </tr> <tr><td class="cellrowborder" style="border: none;" width="49.419999999999995%"><p>801</p> </td> <td class="cellrowborder" style="border: none;" width="50.580000000000005%"><p>Capability not supported</p> </td> </tr>  </tbody></table></div> </div> <div class="p"><strong>示例：</strong><div _ngcontent-hdy-c106="" class="highlight-div"><div _ngcontent-hdy-c106="" class="highlight-div-header"><div _ngcontent-hdy-c106="" class="highlight-div-header-left"><div _ngcontent-hdy-c106="" class="handle-button expand-button"><div _ngcontent-hdy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-hdy-c106="" class="highlight-div-header-right"><div _ngcontent-hdy-c106="" class="handle-button ai-button"></div><div _ngcontent-hdy-c106="" class="handle-button line-button"><div _ngcontent-hdy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-hdy-c106="" class="handle-button theme-button"><div _ngcontent-hdy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-hdy-c106="" class="handle-button copy-button"><div _ngcontent-hdy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-hdy-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { scan } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NearLinkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">try</span> {</li><li>  scan.<span class="hljs-title function_">off</span>(<span class="hljs-string">'deviceFound'</span>);</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div> </div> </div> <div class="tiledSection"><h2 id="section1622511479139" device-type="phone,2in1,tv,tablet,wearable">ScanResults<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section1622511479139" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>表示扫描结果。</p> <p><strong>系统能力：</strong>SystemCapability.Communication.NearLink.Core</p> <p><strong>起始版本：</strong>5.0.1(13)</p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.8.5.1.6.1.1" width="14.299999999999999%"><p>名称</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.8.5.1.6.1.2" width="22.16%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.8.5.1.6.1.3" width="7.5200000000000005%"><p>只读</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.8.5.1.6.1.4" width="21.77%"><p>可选</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.8.5.1.6.1.5" width="34.25%"><p>说明</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="14.299999999999999%"><p>address</p> </td> <td class="cellrowborder" width="22.16%"><p>string</p> </td> <td class="cellrowborder" width="7.5200000000000005%"><p>否</p> </td> <td class="cellrowborder" width="21.77%"><p>否</p> </td> <td class="cellrowborder" width="34.25%"><p>表示扫描到设备地址。地址格式参考："11:22:33:AA:BB:FF"。</p> </td> </tr> <tr><td class="cellrowborder" width="14.299999999999999%"><p>rssi</p> </td> <td class="cellrowborder" width="22.16%"><p>number</p> </td> <td class="cellrowborder" width="7.5200000000000005%"><p>否</p> </td> <td class="cellrowborder" width="21.77%"><p>否</p> </td> <td class="cellrowborder" width="34.25%"><p>表示扫描到的设备rssi值。</p> </td> </tr> <tr><td class="cellrowborder" width="14.299999999999999%"><p>data</p> </td> <td class="cellrowborder" width="22.16%"><p>ArrayBuffer</p> </td> <td class="cellrowborder" width="7.5200000000000005%"><p>否</p> </td> <td class="cellrowborder" width="21.77%"><p>否</p> </td> <td class="cellrowborder" width="34.25%"><p>表示广播包数据。</p> </td> </tr> <tr><td class="cellrowborder" width="14.299999999999999%"><p>deviceName</p> </td> <td class="cellrowborder" width="22.16%"><p>string</p> </td> <td class="cellrowborder" width="7.5200000000000005%"><p>否</p> </td> <td class="cellrowborder" width="21.77%"><p>否</p> </td> <td class="cellrowborder" width="34.25%"><p>表示扫描到的设备名称。字符串长度范围[0, 30]。</p> </td> </tr> <tr><td class="cellrowborder" width="14.299999999999999%"><p>isConnectable</p> </td> <td class="cellrowborder" width="22.16%"><p>boolean</p> </td> <td class="cellrowborder" width="7.5200000000000005%"><p>否</p> </td> <td class="cellrowborder" width="21.77%"><p>否</p> </td> <td class="cellrowborder" width="34.25%"><p>表示扫描到的广播是否可连接。true：可连接，false：不可连接</p> </td> </tr> <tr><td class="cellrowborder" width="14.299999999999999%"><p>deviceClass</p> </td> <td class="cellrowborder" width="22.16%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/nearlink-constant#section1589220571714">constant.DeviceClass</a></p> </td> <td class="cellrowborder" width="7.5200000000000005%"><p>否</p> </td> <td class="cellrowborder" width="21.77%"><p>是</p> </td> <td class="cellrowborder" width="34.25%"><p>表示扫描到的设备类型</p> <p><strong>起始版本：</strong>5.1.0(18)</p> </td> </tr>  </tbody></table></div> </div> </div> <div class="tiledSection"><h2 id="section14720175812465" device-type="phone,2in1,tv,tablet,wearable">ScanFilters<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section14720175812465" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>表示扫描过滤条件。</p> <p><strong>系统能力：</strong>SystemCapability.Communication.NearLink.Core</p> <p><strong>起始版本：</strong>5.0.1(13)</p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.9.5.1.6.1.1" width="14.299999999999999%"><p>名称</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.9.5.1.6.1.2" width="22.16%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.9.5.1.6.1.3" width="7.5200000000000005%"><p>只读</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.9.5.1.6.1.4" width="21.77%"><p>可选</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.9.5.1.6.1.5" width="34.25%"><p>说明</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="14.299999999999999%"><p>address</p> </td> <td class="cellrowborder" width="22.16%"><p>string</p> </td> <td class="cellrowborder" width="7.5200000000000005%"><p>否</p> </td> <td class="cellrowborder" width="21.77%"><p>是</p> </td> <td class="cellrowborder" width="34.25%"><p>表示设备地址，若未配置则默认不过滤该字段。地址格式参考："11:22:33:AA:BB:FF"。</p> </td> </tr> <tr><td class="cellrowborder" width="14.299999999999999%"><p>deviceName</p> </td> <td class="cellrowborder" width="22.16%"><p>string</p> </td> <td class="cellrowborder" width="7.5200000000000005%"><p>否</p> </td> <td class="cellrowborder" width="21.77%"><p>是</p> </td> <td class="cellrowborder" width="34.25%"><p>表示设备名称，字符串长度范围[0, 30]。若未配置则默认不过滤该字段。</p> </td> </tr> <tr><td class="cellrowborder" width="14.299999999999999%"><p>manufacturerId</p> </td> <td class="cellrowborder" width="22.16%"><p>number</p> </td> <td class="cellrowborder" width="7.5200000000000005%"><p>否</p> </td> <td class="cellrowborder" width="21.77%"><p>是</p> </td> <td class="cellrowborder" width="34.25%"><p>表示厂商ID，取值范围(0, 65535]，若未配置则默认不过滤该字段。</p> </td> </tr> <tr><td class="cellrowborder" width="14.299999999999999%"><p>manufacturerData</p> </td> <td class="cellrowborder" width="22.16%"><p>ArrayBuffer</p> </td> <td class="cellrowborder" width="7.5200000000000005%"><p>否</p> </td> <td class="cellrowborder" width="21.77%"><p>是</p> </td> <td class="cellrowborder" width="34.25%"><p>表示厂商数据，若未配置则默认不过滤该字段。配置该字段需同时配置manufacturerId。</p> </td> </tr> <tr><td class="cellrowborder" width="14.299999999999999%"><p>manufacturerDataMask</p> </td> <td class="cellrowborder" width="22.16%"><p>ArrayBuffer</p> </td> <td class="cellrowborder" width="7.5200000000000005%"><p>否</p> </td> <td class="cellrowborder" width="21.77%"><p>是</p> </td> <td class="cellrowborder" width="34.25%"><p>表示厂商数据掩码，若未配置则默认不过滤该字段。配置该字段需同时配置manufacturerData，且二者长度必须一致。</p> </td> </tr>  </tbody></table></div> </div> </div> <div class="tiledSection"><h2 id="section74475912491" device-type="phone,2in1,tv,tablet,wearable">ScanOptions<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section74475912491" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>表示扫描选项。</p> <p><strong>系统能力：</strong>SystemCapability.Communication.NearLink.Core</p> <p><strong>起始版本：</strong>5.0.1(13)</p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.10.5.1.6.1.1" width="14.299999999999999%"><p>名称</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.10.5.1.6.1.2" width="22.16%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.10.5.1.6.1.3" width="7.5200000000000005%"><p>只读</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.10.5.1.6.1.4" width="21.77%"><p>可选</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.10.5.1.6.1.5" width="34.25%"><p>说明</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="14.299999999999999%"><p>scanMode</p> </td> <td class="cellrowborder" width="22.16%"><p><a href="/consumer/cn/doc/harmonyos-references/nearlink-scan#section757023015351">ScanMode</a></p> </td> <td class="cellrowborder" width="7.5200000000000005%"><p>否</p> </td> <td class="cellrowborder" width="21.77%"><p>是</p> </td> <td class="cellrowborder" width="34.25%"><p>表示扫描模式。默认值为"SCAN_MODE_LOW_POWER"</p> </td> </tr> <tr><td class="cellrowborder" width="14.299999999999999%"><p>duration</p> </td> <td class="cellrowborder" width="22.16%"><p>number</p> </td> <td class="cellrowborder" width="7.5200000000000005%"><p>否</p> </td> <td class="cellrowborder" width="21.77%"><p>是</p> </td> <td class="cellrowborder" width="34.25%"><p>表示扫描持续时间。单位second，取值范围[10, 60]，默认值为全时段扫描</p> </td> </tr>  </tbody></table></div> </div> </div> <div class="tiledSection"><h2 id="section757023015351" device-type="phone,2in1,tv,tablet,wearable">ScanMode<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section757023015351" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>表示扫描模式，为枚举值。</p> <p><strong>系统能力：</strong>SystemCapability.Communication.NearLink.Core</p> <p><strong>起始版本：</strong>5.0.1(13)</p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.11.5.1.4.1.1" width="21.912191219121908%"><p>名称</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.11.5.1.4.1.2" width="16.31163116311631%"><p>值</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.11.5.1.4.1.3" width="61.776177617761775%"><p>说明</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="21.912191219121908%"><p>SCAN_MODE_LOW_POWER</p> </td> <td class="cellrowborder" width="16.31163116311631%"><p>0</p> </td> <td class="cellrowborder" width="61.776177617761775%"><p>表示低功耗扫描模式，扫描频率低，功耗低。默认值。</p> </td> </tr> <tr><td class="cellrowborder" width="21.912191219121908%"><p>SCAN_MODE_BALANCED</p> </td> <td class="cellrowborder" width="16.31163116311631%"><p>1</p> </td> <td class="cellrowborder" width="61.776177617761775%"><p>表示均衡扫描模式，扫描频率中等，功耗中等。</p> </td> </tr>  </tbody></table></div> </div> </div> </div> <div></div></div>