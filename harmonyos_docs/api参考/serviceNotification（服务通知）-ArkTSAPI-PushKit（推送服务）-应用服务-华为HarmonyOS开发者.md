<h1 _ngcontent-ewy-c119="" class="doc-title ng-star-inserted" title="serviceNotification（服务通知）"> serviceNotification（服务通知） </h1>

<div _ngcontent-ewy-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div><p>本模块提供服务通知的基础能力，包括请求订阅通知授权。</p> <p><strong>模型约束：</strong>此接口仅可在Stage模型下使用。</p> <p><strong>元服务API：</strong>从版本5.0.0(12)开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong>SystemCapability.Push.PushService</p> <p><strong>起始版本：</strong>4.1.0(11)</p> <div class="tiledSection"><h2 id="section1955538121910" device-type="phone,2in1,tablet,wearable,tv">导入模块<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section1955538121910" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><div _ngcontent-ewy-c106="" class="highlight-div"><div _ngcontent-ewy-c106="" class="highlight-div-header"><div _ngcontent-ewy-c106="" class="highlight-div-header-left"><div _ngcontent-ewy-c106="" class="handle-button expand-button"><div _ngcontent-ewy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ewy-c106="" class="highlight-div-header-right"><div _ngcontent-ewy-c106="" class="handle-button ai-button"></div><div _ngcontent-ewy-c106="" class="handle-button line-button"><div _ngcontent-ewy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ewy-c106="" class="handle-button theme-button"><div _ngcontent-ewy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ewy-c106="" class="handle-button copy-button"><div _ngcontent-ewy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ewy-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { serviceNotification } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PushKit'</span>;</li></ol></pre></div></div> </div> <div class="tiledSection"><h2 id="section55213247371" device-type="phone,2in1,tablet,wearable,tv">serviceNotification.requestSubscribeNotification<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section55213247371" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>requestSubscribeNotification(context: Context, entityIds: Array&lt;string&gt;, callback: AsyncCallback&lt;RequestResult&gt;): void</p> <p>请求订阅通知授权，使用callback异步回调。</p> <p><strong>模型约束：</strong>此接口仅可在Stage模型下使用。</p> <p><strong>系统能力：</strong>SystemCapability.Push.PushService</p> <p><strong>设备行为差异</strong>：该接口在Phone、Tablet、PC/2in1中可正常调用，在其他设备类型中返回错误码1000900017。</p> <p><strong>起始版本：</strong>4.1.0(11)</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.7.9.1.5.1.1" width="10.68%"><p>参数名</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.7.9.1.5.1.2" width="30.520000000000003%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.7.9.1.5.1.3" width="8.459999999999999%"><p>必填</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.7.9.1.5.1.4" width="50.339999999999996%"><p>说明</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="10.68%"><p>context</p> </td> <td class="cellrowborder" width="30.520000000000003%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-context" target="_blank">Context</a></p> </td> <td class="cellrowborder" width="8.459999999999999%"><p>是</p> </td> <td class="cellrowborder" width="50.339999999999996%"><p>请求订阅通知授权界面<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext" target="_blank">UIAbilityContext</a>。</p> <div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content"><p>context仅支持传入UIAbilityContext。</p> </div></div></div> </td> </tr> <tr><td class="cellrowborder" width="10.68%"><p>entityIds</p> </td> <td class="cellrowborder" width="30.520000000000003%"><p>Array&lt;string&gt;</p> </td> <td class="cellrowborder" width="8.459999999999999%"><p>是</p> </td> <td class="cellrowborder" width="50.339999999999996%"><p>模板ID列表。</p> </td> </tr> <tr><td class="cellrowborder" width="10.68%"><p>callback</p> </td> <td class="cellrowborder" width="30.520000000000003%"><p>AsyncCallback&lt;<a href="/consumer/cn/doc/harmonyos-references/push-servicenotification#section185441313151716">RequestResult</a>&gt;</p> </td> <td class="cellrowborder" width="8.459999999999999%"><p>是</p> </td> <td class="cellrowborder" width="50.339999999999996%"><p>回调函数。当请求订阅成功，err为undefined，data为订阅授权结果；否则为错误对象。</p> </td> </tr>  </tbody></table></div> </div> <p><strong>错误码：</strong></p> <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/push-error-code">ArkTS API错误码</a>。</p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.7.12.1.3.1.1" width="26.26%"><p>错误码ID</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.7.12.1.3.1.2" width="73.74000000000001%"><p>错误信息</p> </th> </tr><tr><td class="cellrowborder" width="26.26%"><p>401</p> </td> <td class="cellrowborder" width="73.74000000000001%"><p>Parameter error. Possible causes:</p> <p>1. Mandatory parameters are left unspecified;</p> <p>2. Incorrect parameter types;</p> <p>3. Parameter verification failed.</p> </td> </tr> <tr><td class="cellrowborder" width="26.26%"><p>1000900001</p> </td> <td class="cellrowborder" width="73.74000000000001%"><p>System internal error.</p> </td> </tr> <tr><td class="cellrowborder" width="26.26%"><p>1000900008</p> </td> <td class="cellrowborder" width="73.74000000000001%"><p>Failed to connect to the push service.</p> </td> </tr> <tr><td class="cellrowborder" width="26.26%"><p>1000900009</p> </td> <td class="cellrowborder" width="73.74000000000001%"><p>Internal error of the push service.</p> </td> </tr> <tr><td class="cellrowborder" width="26.26%"><p>1000900010</p> </td> <td class="cellrowborder" width="73.74000000000001%"><p>Illegal application identity.</p> </td> </tr> <tr><td class="cellrowborder" width="26.26%"><p>1000900011</p> </td> <td class="cellrowborder" width="73.74000000000001%"><p>The network is unavailable.</p> </td> </tr> <tr><td class="cellrowborder" width="26.26%"><p>1000900017</p> </td> <td class="cellrowborder" width="73.74000000000001%"><p>The device does not support current operation.</p> </td> </tr> <tr><td class="cellrowborder" width="26.26%"><p>1000900018</p> </td> <td class="cellrowborder" width="73.74000000000001%"><p>Number of calls exceeded.</p> </td> </tr> <tr><td class="cellrowborder" width="26.26%"><p>1000900019</p> </td> <td class="cellrowborder" width="73.74000000000001%"><p>Illegal entity id.</p> </td> </tr> <tr><td class="cellrowborder" width="26.26%"><p>1000900020</p> </td> <td class="cellrowborder" width="73.74000000000001%"><p>App token is empty.</p> </td> </tr> <tr><td class="cellrowborder" width="26.26%"><p>1000900021</p> </td> <td class="cellrowborder" width="73.74000000000001%"><p>App is not available or not registered.</p> </td> </tr> <tr><td class="cellrowborder" width="26.26%"><p>1000900022</p> </td> <td class="cellrowborder" width="73.74000000000001%"><p>Notification switch off.</p> </td> </tr> <tr><td class="cellrowborder" width="26.26%"><p>1000900023</p> </td> <td class="cellrowborder" width="73.74000000000001%"><p>Number of entity ids exceed the upper limit.</p> </td> </tr> <tr><td class="cellrowborder" width="26.26%"><p>1000900024</p> </td> <td class="cellrowborder" width="73.74000000000001%"><p>Failed to display subscription UI.</p> </td> </tr> <tr><td class="cellrowborder" width="26.26%"><p>1000900025</p> </td> <td class="cellrowborder" width="73.74000000000001%"><p>No rights to access entity id.</p> </td> </tr> <tr><td class="cellrowborder" width="26.26%"><p>1000900026</p> </td> <td class="cellrowborder" width="73.74000000000001%"><p>Illegal entity type.</p> </td> </tr>  </tbody></table></div> </div> <p><strong>示例：</strong></p> <div _ngcontent-ewy-c106="" class="highlight-div"><div _ngcontent-ewy-c106="" class="highlight-div-header"><div _ngcontent-ewy-c106="" class="highlight-div-header-left"><div _ngcontent-ewy-c106="" class="handle-button expand-button"><div _ngcontent-ewy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ewy-c106="" class="highlight-div-header-right"><div _ngcontent-ewy-c106="" class="handle-button ai-button"></div><div _ngcontent-ewy-c106="" class="handle-button line-button"><div _ngcontent-ewy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ewy-c106="" class="handle-button theme-button"><div _ngcontent-ewy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ewy-c106="" class="handle-button copy-button"><div _ngcontent-ewy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ewy-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AbilityConstant</span>, <span class="hljs-title class_">UIAbility</span>, <span class="hljs-title class_">Want</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li><span class="hljs-keyword">import</span> { serviceNotification } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PushKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">DOMAIN</span> = <span class="hljs-number">0x0000</span>;</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onCreate</span>(<span class="hljs-attr">want</span>: <span class="hljs-title class_">Want</span>, <span class="hljs-attr">launchParam</span>: <span class="hljs-title class_">AbilityConstant</span>.<span class="hljs-property">LaunchParam</span>): <span class="hljs-built_in">void</span> {</li><li>    hilog.<span class="hljs-title function_">info</span>(<span class="hljs-variable constant_">DOMAIN</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">'%{public}s'</span>, <span class="hljs-string">'Ability onCreate'</span>);</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-comment">// entityIds请替换为待订阅的模板ID</span></li><li>      <span class="hljs-keyword">const</span> entityIds = [<span class="hljs-string">'entityId1'</span>, <span class="hljs-string">'entityId2'</span>, <span class="hljs-string">'entityId3'</span>];</li><li>      serviceNotification.<span class="hljs-title function_">requestSubscribeNotification</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>, entityIds, <span class="hljs-function">(<span class="hljs-params">err, data</span>) =&gt;</span> {</li><li>        <span class="hljs-keyword">if</span> (err) {</li><li>          hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">'Failed to request subscribe notification: %{public}d %{public}s'</span>, err.<span class="hljs-property">code</span>,</li><li>            err.<span class="hljs-property">message</span>);</li><li>        } <span class="hljs-keyword">else</span> {</li><li>          hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">'Succeeded in requesting subscribe notification: %{public}s'</span>,</li><li>            <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data.<span class="hljs-property">entityResult</span>));</li><li>        }</li><li>      });</li><li>    } <span class="hljs-keyword">catch</span> (err) {</li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">e</span>: <span class="hljs-title class_">BusinessError</span> = err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>;</li><li>      hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">'Failed to request subscribe notification: %{public}d %{public}s'</span>, e.<span class="hljs-property">code</span>,</li><li>        e.<span class="hljs-property">message</span>);</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div> </div> <div class="tiledSection"><h2 id="section11384539111610" device-type="phone,2in1,tablet,wearable,tv">serviceNotification.requestSubscribeNotification<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section11384539111610" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>requestSubscribeNotification(context: Context, entityIds: Array&lt;string&gt;, type?: SubscribeNotificationType): Promise&lt;RequestResult&gt;</p> <p>请求订阅通知授权，使用Promise异步回调。</p> <p><strong>模型约束：</strong>此接口仅可在Stage模型下使用。</p> <p><strong>元服务API：</strong>从版本5.0.0(12)开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong>SystemCapability.Push.PushService</p> <p><strong>设备行为差异</strong>：该接口在Phone、Tablet、PC/2in1中可正常调用，在其他设备类型中返回错误码1000900017。</p> <p><strong>起始版本：</strong>4.1.0(11)</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.8.10.1.5.1.1" width="11.790000000000001%"><p>参数名</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.8.10.1.5.1.2" width="28.03%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.8.10.1.5.1.3" width="11.78%"><p>必填</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.8.10.1.5.1.4" width="48.4%"><p>说明</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="11.790000000000001%"><p>context</p> </td> <td class="cellrowborder" width="28.03%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-context" target="_blank">Context</a></p> </td> <td class="cellrowborder" width="11.78%"><p>是</p> </td> <td class="cellrowborder" width="48.4%"><p>请求订阅通知授权界面<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext" target="_blank">UIAbilityContext</a>。</p> <div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content"><p>context仅支持传入UIAbilityContext。</p> </div></div></div> </td> </tr> <tr><td class="cellrowborder" width="11.790000000000001%"><p>entityIds</p> </td> <td class="cellrowborder" width="28.03%"><p>Array&lt;string&gt;</p> </td> <td class="cellrowborder" width="11.78%"><p>是</p> </td> <td class="cellrowborder" width="48.4%"><p>表示待订阅的模板ID列表。</p> <ul><li>当订阅type为SUBSCRIBE_WITH_HUAWEI_ID时，详情请参见<a href="https://developer.huawei.com/consumer/cn/doc/atomic-guides/push-as-service-noti#section880418143379" target="_blank">选用订阅模板</a>。</li></ul> </td> </tr> <tr><td class="cellrowborder" width="11.790000000000001%"><p>type</p> </td> <td class="cellrowborder" width="28.03%"><p><a href="/consumer/cn/doc/harmonyos-references/push-servicenotification#section3556183619491">SubscribeNotificationType</a></p> </td> <td class="cellrowborder" width="11.78%"><p>否</p> </td> <td class="cellrowborder" width="48.4%"><p>订阅类型。默认为SUBSCRIBE_WITH_TOKEN。</p> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p>起始版本：5.0.0(12)。</p> </div></div></div> </td> </tr>  </tbody></table></div> </div> <p><strong>返回值：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.8.12.1.3.1.1" width="34.339999999999996%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.8.12.1.3.1.2" width="65.66%"><p>说明</p> </th> </tr><tr><td class="cellrowborder" width="34.339999999999996%"><p>Promise&lt;<a href="/consumer/cn/doc/harmonyos-references/push-servicenotification#section185441313151716">RequestResult</a>&gt;</p> </td> <td class="cellrowborder" width="65.66%"><p>Promise对象，返回订阅授权结果。</p> </td> </tr>  </tbody></table></div> </div> <p><strong>错误码：</strong></p> <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/push-error-code">ArkTS API错误码</a>。</p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.8.15.1.3.1.1" width="26.26%"><p>错误码ID</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.8.15.1.3.1.2" width="73.74000000000001%"><p>错误信息</p> </th> </tr><tr><td class="cellrowborder" width="26.26%"><p>401</p> </td> <td class="cellrowborder" width="73.74000000000001%"><p>Parameter error. Possible causes: 1. Mandatory parameters are left unspecified; 2. Incorrect parameter types; 3. Parameter verification failed.</p> </td> </tr> <tr><td class="cellrowborder" width="26.26%"><p>1000900001</p> </td> <td class="cellrowborder" width="73.74000000000001%"><p>System internal error.</p> </td> </tr> <tr><td class="cellrowborder" width="26.26%"><p>1000900008</p> </td> <td class="cellrowborder" width="73.74000000000001%"><p>Failed to connect to the push service.</p> </td> </tr> <tr><td class="cellrowborder" width="26.26%"><p>1000900009</p> </td> <td class="cellrowborder" width="73.74000000000001%"><p>Internal error of the push service.</p> </td> </tr> <tr><td class="cellrowborder" width="26.26%"><p>1000900010</p> </td> <td class="cellrowborder" width="73.74000000000001%"><p>Illegal application identity.</p> </td> </tr> <tr><td class="cellrowborder" width="26.26%"><p>1000900011</p> </td> <td class="cellrowborder" width="73.74000000000001%"><p>The network is unavailable.</p> </td> </tr> <tr><td class="cellrowborder" width="26.26%"><p>1000900017</p> </td> <td class="cellrowborder" width="73.74000000000001%"><p>The device does not support current operation.</p> </td> </tr> <tr><td class="cellrowborder" width="26.26%"><p>1000900018</p> </td> <td class="cellrowborder" width="73.74000000000001%"><p>Number of calls exceeded.</p> </td> </tr> <tr><td class="cellrowborder" width="26.26%"><p>1000900019</p> </td> <td class="cellrowborder" width="73.74000000000001%"><p>Illegal entity id.</p> </td> </tr> <tr><td class="cellrowborder" width="26.26%"><p>1000900020</p> </td> <td class="cellrowborder" width="73.74000000000001%"><p>App token is empty.</p> </td> </tr> <tr><td class="cellrowborder" width="26.26%"><p>1000900021</p> </td> <td class="cellrowborder" width="73.74000000000001%"><p>App is not available or not  registered.</p> </td> </tr> <tr><td class="cellrowborder" width="26.26%"><p>1000900022</p> </td> <td class="cellrowborder" width="73.74000000000001%"><p>Notification switch off.</p> </td> </tr> <tr><td class="cellrowborder" width="26.26%"><p>1000900023</p> </td> <td class="cellrowborder" width="73.74000000000001%"><p>Number of entity ids exceed  the upper  limit.</p> </td> </tr> <tr><td class="cellrowborder" width="26.26%"><p>1000900024</p> </td> <td class="cellrowborder" width="73.74000000000001%"><p>Failed to display subscription UI.</p> </td> </tr> <tr><td class="cellrowborder" width="26.26%"><p>1000900025</p> </td> <td class="cellrowborder" width="73.74000000000001%"><p>No rights to access entity id.</p> </td> </tr> <tr><td class="cellrowborder" width="26.26%"><p>1000900026</p> </td> <td class="cellrowborder" width="73.74000000000001%"><p>Illegal entity type.</p> </td> </tr> <tr><td class="cellrowborder" width="26.26%"><p>1000900030</p> </td> <td class="cellrowborder" width="73.74000000000001%"><p>The user has not logged in with HUAWEI ID.</p> </td> </tr>  </tbody></table></div> </div> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p>错误码1000900030仅当接口在元服务中使用时才涉及。</p> <p>错误码1000900011可能是推送服务无网被禁网，请到设置 移动网络-&gt;流量管理-&gt;应用联网，检查推送服务是否被禁网。</p> </div></div></div> <p><strong>示例：</strong></p> <div _ngcontent-ewy-c106="" class="highlight-div"><div _ngcontent-ewy-c106="" class="highlight-div-header"><div _ngcontent-ewy-c106="" class="highlight-div-header-left"><div _ngcontent-ewy-c106="" class="handle-button expand-button"><div _ngcontent-ewy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ewy-c106="" class="highlight-div-header-right"><div _ngcontent-ewy-c106="" class="handle-button ai-button"></div><div _ngcontent-ewy-c106="" class="handle-button line-button"><div _ngcontent-ewy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ewy-c106="" class="handle-button theme-button"><div _ngcontent-ewy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ewy-c106="" class="handle-button copy-button"><div _ngcontent-ewy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ewy-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li><span class="hljs-keyword">import</span> { serviceNotification } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PushKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">DOMAIN</span> = <span class="hljs-number">0x0000</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onCreate</span>(): <span class="hljs-built_in">void</span> {</li><li>    hilog.<span class="hljs-title function_">info</span>(<span class="hljs-variable constant_">DOMAIN</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">'%{public}s'</span>, <span class="hljs-string">'Ability onCreate'</span>);</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-comment">// entityIds请替换为待订阅的模板ID</span></li><li>      <span class="hljs-keyword">const</span> entityIds = [<span class="hljs-string">'entityId1'</span>, <span class="hljs-string">'entityId2'</span>, <span class="hljs-string">'entityId3'</span>];</li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">type</span>: serviceNotification.<span class="hljs-property">SubscribeNotificationType</span> =</li><li>        serviceNotification.<span class="hljs-property">SubscribeNotificationType</span>.<span class="hljs-property">SUBSCRIBE_WITH_HUAWEI_ID</span>;</li><li>      serviceNotification.<span class="hljs-title function_">requestSubscribeNotification</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>, entityIds, <span class="hljs-keyword">type</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {</li><li>        hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">'Succeeded in requesting subscribe notification: %{public}s'</span>,</li><li>          <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data.<span class="hljs-property">entityResult</span>));</li><li>      }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>        hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">'Failed to request subscribe notification: %{public}d %{public}s'</span>, err.<span class="hljs-property">code</span>,</li><li>          err.<span class="hljs-property">message</span>);</li><li>      });</li><li>    } <span class="hljs-keyword">catch</span> (err) {</li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">e</span>: <span class="hljs-title class_">BusinessError</span> = err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>;</li><li>      hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">'Failed to request subscribe notification: %{public}d %{public}s'</span>, e.<span class="hljs-property">code</span>,</li><li>        e.<span class="hljs-property">message</span>);</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div> </div> <div class="tiledSection"><h2 id="section185441313151716" device-type="phone,2in1,tablet,wearable,tv">RequestResult<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section185441313151716" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>表示单次订阅的授权结果。</p> <p><strong>模型约束：</strong>此接口仅可在Stage模型下使用。</p> <p><strong>元服务API：</strong>从版本5.0.0(12)开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong>SystemCapability.Push.PushService</p> <p><strong>设备行为差异</strong>：该接口在Phone、Tablet、PC/2in1中可正常调用，在其他设备类型中无效果。</p> <p><strong>起始版本：</strong>4.1.0(11)</p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.9.8.1.6.1.1" width="14.298570142985698%"><p>名称</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.9.8.1.6.1.2" width="25.087491250874912%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.9.8.1.6.1.3" width="14.498550144985497%"><p>只读</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.9.8.1.6.1.4" width="11.868813118688129%"><p>可选</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.9.8.1.6.1.5" width="34.24657534246575%"><p>说明</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="14.298570142985698%"><p>entityResult</p> </td> <td class="cellrowborder" width="25.087491250874912%"><p>Array&lt;<a href="/consumer/cn/doc/harmonyos-references/push-servicenotification#section63339171710">EntityResult</a>&gt;</p> </td> <td class="cellrowborder" width="14.498550144985497%"><p>是</p> </td> <td class="cellrowborder" width="11.868813118688129%"><p>否</p> </td> <td class="cellrowborder" width="34.24657534246575%"><p>授权订阅结果。</p> </td> </tr>  </tbody></table></div> </div> </div> <div class="tiledSection"><h2 id="section63339171710" device-type="phone,2in1,tablet,wearable,tv">EntityResult<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section63339171710" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>表示单次订阅中每一个模板订阅的授权结果。</p> <p><strong>模型约束：</strong>此接口仅可在Stage模型下使用。</p> <p><strong>元服务API：</strong>从版本5.0.0(12)开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong>SystemCapability.Push.PushService</p> <p><strong>设备行为差异</strong>：该接口在Phone、Tablet、PC/2in1中可正常调用，在其他设备类型中无效果。</p> <p><strong>起始版本：</strong>4.1.0(11)</p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.10.8.1.6.1.1" width="16%"><p>名称</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.10.8.1.6.1.2" width="22.8%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.10.8.1.6.1.3" width="15.540000000000001%"><p>只读</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.10.8.1.6.1.4" width="11.29%"><p>可选</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.10.8.1.6.1.5" width="34.37%"><p>说明</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="16%"><p>entityId</p> </td> <td class="cellrowborder" width="22.8%"><p>string</p> </td> <td class="cellrowborder" width="15.540000000000001%"><p>是</p> </td> <td class="cellrowborder" width="11.29%"><p>否</p> </td> <td class="cellrowborder" width="34.37%"><p>模板ID。</p> </td> </tr> <tr><td class="cellrowborder" width="16%"><p>resultCode</p> </td> <td class="cellrowborder" width="22.8%"><p><a href="/consumer/cn/doc/harmonyos-references/push-servicenotification#section5698135841715">ResultCode</a></p> </td> <td class="cellrowborder" width="15.540000000000001%"><p>是</p> </td> <td class="cellrowborder" width="11.29%"><p>否</p> </td> <td class="cellrowborder" width="34.37%"><p>授权订阅结果码。</p> </td> </tr>  </tbody></table></div> </div> </div> <div class="tiledSection"><h2 id="section5698135841715" device-type="phone,2in1,tablet,wearable,tv">ResultCode<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section5698135841715" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>标识授权订阅结果，为枚举值。</p> <p><strong>模型约束：</strong>此接口仅可在Stage模型下使用。</p> <p><strong>元服务API：</strong>从版本5.0.0(12)开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong>SystemCapability.Push.PushService</p> <p><strong>设备行为差异</strong>：该枚举值在Phone、Tablet、PC/2in1中可正常使用，在其他设备类型中无效果。</p> <p><strong>起始版本：</strong>4.1.0(11)</p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.11.8.1.4.1.1" width="21.912191219121908%"><p>名称</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.11.8.1.4.1.2" width="16.31163116311631%"><p>值</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.11.8.1.4.1.3" width="61.776177617761775%"><p>说明</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="21.912191219121908%"><p>ACCEPTED</p> </td> <td class="cellrowborder" width="16.31163116311631%"><p>0</p> </td> <td class="cellrowborder" width="61.776177617761775%"><p>表示模板被接受。</p> </td> </tr> <tr><td class="cellrowborder" width="21.912191219121908%"><p>REJECTED</p> </td> <td class="cellrowborder" width="16.31163116311631%"><p>1</p> </td> <td class="cellrowborder" width="61.776177617761775%"><p>表示模板被拒绝。</p> </td> </tr> <tr><td class="cellrowborder" width="21.912191219121908%"><p>FILTERED</p> </td> <td class="cellrowborder" width="16.31163116311631%"><p>2</p> </td> <td class="cellrowborder" width="61.776177617761775%"><p>表示模板被过滤。</p> </td> </tr> <tr><td class="cellrowborder" width="21.912191219121908%"><p>BANNED</p> </td> <td class="cellrowborder" width="16.31163116311631%"><p>3</p> </td> <td class="cellrowborder" width="61.776177617761775%"><p>表示模板被禁止。</p> </td> </tr> <tr><td class="cellrowborder" width="21.912191219121908%"><p>UNKNOWN</p> </td> <td class="cellrowborder" width="16.31163116311631%"><p>-1</p> </td> <td class="cellrowborder" width="61.776177617761775%"><p>表示未知错误。</p> </td> </tr>  </tbody></table></div> </div> </div> <div class="tiledSection"><h2 id="section3556183619491" device-type="phone,2in1,tablet,wearable,tv">SubscribeNotificationType<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section3556183619491" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>标识订阅类型，为枚举值。</p> <p><strong>模型约束：</strong>此接口仅可在Stage模型下使用。</p> <p><strong>元服务API：</strong>从版本5.0.0(12)开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong>SystemCapability.Push.PushService</p> <p><strong>设备行为差异</strong>：该枚举值在Phone、Tablet、PC/2in1中可正常使用，在其他设备类型中无效果。</p> <p><strong>起始版本：</strong>5.0.0(12)</p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.12.8.1.4.1.1" width="28.802880288028803%"><p>名称</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.12.8.1.4.1.2" width="12.171217121712173%"><p>值</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.12.8.1.4.1.3" width="59.02590259025903%"><p>说明</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="28.802880288028803%"><p>SUBSCRIBE_WITH_TOKEN</p> </td> <td class="cellrowborder" width="12.171217121712173%"><p>0</p> </td> <td class="cellrowborder" width="59.02590259025903%"><p>表示通过Push Token订阅，<strong>仅</strong><strong>应用支持通过Push Token订阅</strong>。</p> </td> </tr> <tr><td class="cellrowborder" width="28.802880288028803%"><p>SUBSCRIBE_WITH_HUAWEI_ID</p> </td> <td class="cellrowborder" width="12.171217121712173%"><p>1</p> </td> <td class="cellrowborder" width="59.02590259025903%"><p>表示通过华为账号订阅，<strong>仅</strong><strong>元服务支持通过账号订阅</strong>。详情请参见<a href="https://developer.huawei.com/consumer/cn/doc/atomic-guides/push-as-send-sub-noti" target="_blank">推送基于账号的订阅消息</a>。</p> </td> </tr>  </tbody></table></div> </div> </div> </div> <div></div></div>