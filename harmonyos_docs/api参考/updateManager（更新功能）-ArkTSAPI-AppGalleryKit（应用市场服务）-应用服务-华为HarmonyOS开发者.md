<h1 _ngcontent-aft-c119="" class="doc-title ng-star-inserted" title="updateManager（更新功能）"> updateManager（更新功能） </h1>

<div _ngcontent-aft-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div><p>提供检测新版本及升级功能。</p> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p>调用接口需捕获异常。</p> </div></div></div> <p><strong>起始版本：</strong>5.0.0(12)</p> <div class="tiledSection"><h2 id="section16609101116259" device-type="phone,2in1,tablet,tv,wearable">导入模块<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section16609101116259" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><div _ngcontent-aft-c106="" class="highlight-div"><div _ngcontent-aft-c106="" class="highlight-div-header"><div _ngcontent-aft-c106="" class="highlight-div-header-left"><div _ngcontent-aft-c106="" class="handle-button expand-button"><div _ngcontent-aft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-aft-c106="" class="highlight-div-header-right"><div _ngcontent-aft-c106="" class="handle-button ai-button"></div><div _ngcontent-aft-c106="" class="handle-button line-button"><div _ngcontent-aft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-aft-c106="" class="handle-button theme-button"><div _ngcontent-aft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-aft-c106="" class="handle-button copy-button"><div _ngcontent-aft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-aft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { updateManager } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AppGalleryKit'</span>;</li></ol></pre></div></div> </div> <div class="tiledSection"><h2 id="section4465197164210" device-type="phone,2in1,tablet,tv,wearable">UpdateAvailableCode<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section4465197164210" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>检测更新结果码类型的枚举。</p> <p><strong>模型约束：</strong>此接口仅可在Stage模型下使用。</p> <p><strong>元服务API：</strong>从版本6.0.0(20)开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong>SystemCapability.AppGalleryService.Distribution.Update</p> <p><strong>起始版本：</strong>5.0.0(12)</p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.5.7.1.4.1.1" width="33.33333333333333%"><p>名称</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.5.7.1.4.1.2" width="33.33333333333333%"><p>值</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.5.7.1.4.1.3" width="33.33333333333333%"><p>说明</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="33.33333333333333%"><p>LATER_VERSION_NOT_EXIST</p> </td> <td class="cellrowborder" width="33.33333333333333%"><p>0</p> </td> <td class="cellrowborder" width="33.33333333333333%"><p>不存在新版本。</p> </td> </tr> <tr><td class="cellrowborder" width="33.33333333333333%"><p>LATER_VERSION_EXIST</p> </td> <td class="cellrowborder" width="33.33333333333333%"><p>1</p> </td> <td class="cellrowborder" width="33.33333333333333%"><p>存在新版本。</p> </td> </tr>  </tbody></table></div> </div> </div> <div class="tiledSection"><h2 id="section194882568246" device-type="phone,2in1,tablet,tv,wearable">ShowUpdateResultCode<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section194882568246" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>显示升级弹框结果码类型的枚举。</p> <p><strong>模型约束：</strong>此接口仅可在Stage模型下使用。</p> <p><strong>系统能力：</strong>SystemCapability.AppGalleryService.Distribution.Update</p> <p><strong>起始版本：</strong>5.0.0(12)</p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.6.6.1.4.1.1" width="33.33333333333333%"><p>名称</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.6.6.1.4.1.2" width="33.33333333333333%"><p>值</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.6.6.1.4.1.3" width="33.33333333333333%"><p>说明</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="33.33333333333333%"><p>SHOW_DIALOG_SUCCESS</p> </td> <td class="cellrowborder" width="33.33333333333333%"><p>0</p> </td> <td class="cellrowborder" width="33.33333333333333%"><p>显示升级弹框成功。</p> </td> </tr> <tr><td class="cellrowborder" width="33.33333333333333%"><p>SHOW_DIALOG_FAILURE</p> </td> <td class="cellrowborder" width="33.33333333333333%"><p>1</p> </td> <td class="cellrowborder" width="33.33333333333333%"><p>显示升级弹框失败。</p> </td> </tr>  </tbody></table></div> </div> </div> <div class="tiledSection"><h2 id="section1535385414136" device-type="phone,2in1,tablet,tv,wearable">CheckUpdateResult<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section1535385414136" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>检查是否有“更新”的接口调用结果。</p> <p><strong>模型约束：</strong>此接口仅可在Stage模型下使用。</p> <p><strong>元服务API：</strong>从版本6.0.0(20)开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong>SystemCapability.AppGalleryService.Distribution.Update</p> <p><strong>起始版本：</strong>5.0.0(12)</p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.7.7.1.6.1.1" width="26.99269926992699%"><p>名称</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.7.7.1.6.1.2" width="23.08230823082308%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.7.7.1.6.1.3" width="7.520752075207521%"><p>只读</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.7.7.1.6.1.4" width="15.41154115411541%"><p>可选</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.7.7.1.6.1.5" width="26.99269926992699%"><p>说明</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="26.99269926992699%"><p>updateAvailable</p> </td> <td class="cellrowborder" width="23.08230823082308%"><p><a href="/consumer/cn/doc/harmonyos-references/store-updatemanager#section4465197164210">UpdateAvailableCode</a></p> </td> <td class="cellrowborder" width="7.520752075207521%"><p>是</p> </td> <td class="cellrowborder" width="15.41154115411541%"><p>否</p> </td> <td class="cellrowborder" width="26.99269926992699%"><p>检查结果。</p> </td> </tr> <tr><td class="cellrowborder" width="26.99269926992699%"><p>versionName</p> </td> <td class="cellrowborder" width="23.08230823082308%"><p>string</p> </td> <td class="cellrowborder" width="7.520752075207521%"><p>是</p> </td> <td class="cellrowborder" width="15.41154115411541%"><p>是</p> </td> <td class="cellrowborder" width="26.99269926992699%"><p>版本名称，例如1.0.0.1。</p> <p><strong>起始版本：</strong>6.0.0(20)</p> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p>用于元服务场景调用。</p> </div></div></div> </td> </tr> <tr><td class="cellrowborder" width="26.99269926992699%"><p>versionCode</p> </td> <td class="cellrowborder" width="23.08230823082308%"><p>number</p> </td> <td class="cellrowborder" width="7.520752075207521%"><p>是</p> </td> <td class="cellrowborder" width="15.41154115411541%"><p>是</p> </td> <td class="cellrowborder" width="26.99269926992699%"><p>版本号，例如1001。</p> <p><strong>起始版本：</strong>6.0.0(20)</p> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p>用于元服务场景调用。</p> </div></div></div> </td> </tr>  </tbody></table></div> </div> </div> <div class="tiledSection"><h2 id="section1713825674019" device-type="phone,2in1,tablet,tv,wearable">RequestErrorCode<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section1713825674019" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>监听元服务更新检查接口结果码类型的枚举。</p> <p><strong>模型约束：</strong>此接口仅可在Stage模型下使用。</p> <p><strong>元服务API：</strong>从版本6.0.0(20)开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong>SystemCapability.AppGalleryService.Distribution.Update</p> <p><strong>起始版本：</strong>6.0.0(20)</p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.8.7.1.4.1.1" width="33.33333333333333%"><p>名称</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.8.7.1.4.1.2" width="33.33333333333333%"><p>值</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.8.7.1.4.1.3" width="33.33333333333333%"><p>说明</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="33.33333333333333%"><p>NO_UPGRADE</p> </td> <td class="cellrowborder" width="33.33333333333333%"><p>0</p> </td> <td class="cellrowborder" width="33.33333333333333%"><p>无最新版本。</p> </td> </tr> <tr><td class="cellrowborder" width="33.33333333333333%"><p>NEED_UPGRADE</p> </td> <td class="cellrowborder" width="33.33333333333333%"><p>1</p> </td> <td class="cellrowborder" width="33.33333333333333%"><p>有最新版本。</p> </td> </tr> <tr><td class="cellrowborder" width="33.33333333333333%"><p>DOWNLOADED</p> </td> <td class="cellrowborder" width="33.33333333333333%"><p>2</p> </td> <td class="cellrowborder" width="33.33333333333333%"><p>下载完成。</p> </td> </tr>  </tbody></table></div> </div> </div> <div class="tiledSection"><h2 id="section18222589421" device-type="phone,2in1,tablet,tv,wearable">UpdateSessionState<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section18222589421" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>监听元服务更新检查接口的回调结果。</p> <p><strong>模型约束：</strong>此接口仅可在Stage模型下使用。</p> <p><strong>元服务API：</strong>从版本6.0.0(20)开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong>SystemCapability.AppGalleryService.Distribution.Update</p> <p><strong>起始版本：</strong>6.0.0(20)</p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.9.7.1.6.1.1" width="26.99269926992699%"><p>名称</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.9.7.1.6.1.2" width="23.08230823082308%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.9.7.1.6.1.3" width="7.520752075207521%"><p>只读</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.9.7.1.6.1.4" width="15.41154115411541%"><p>可选</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.9.7.1.6.1.5" width="26.99269926992699%"><p>说明</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="26.99269926992699%"><p>code</p> </td> <td class="cellrowborder" width="23.08230823082308%"><p><a href="/consumer/cn/doc/harmonyos-references/store-updatemanager#section1713825674019">RequestErrorCode</a></p> </td> <td class="cellrowborder" width="7.520752075207521%"><p>是</p> </td> <td class="cellrowborder" width="15.41154115411541%"><p>否</p> </td> <td class="cellrowborder" width="26.99269926992699%"><p>检查结果码。</p> </td> </tr> <tr><td class="cellrowborder" width="26.99269926992699%"><p>checkUpdateResult</p> </td> <td class="cellrowborder" width="23.08230823082308%"><p><a href="/consumer/cn/doc/harmonyos-references/store-updatemanager#section1535385414136">CheckUpdateResult</a></p> </td> <td class="cellrowborder" width="7.520752075207521%"><p>是</p> </td> <td class="cellrowborder" width="15.41154115411541%"><p>是</p> </td> <td class="cellrowborder" width="26.99269926992699%"><p>检查结果。</p> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p>仅在RequestErrorCode为NEED_UPGRADE或NO_UPGRADE时不为空。</p> </div></div></div> </td> </tr>  </tbody></table></div> </div> </div> <div class="tiledSection"><h2 id="section10984155711373" device-type="phone,2in1,tablet,tv,wearable">updateManager.checkAppUpdate<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section10984155711373" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>checkAppUpdate(context: common.UIAbilityContext): Promise&lt;CheckUpdateResult&gt;</p> <p>检查是否有更新，使用Promise方式异步返回结果。</p> <p><strong>模型约束：</strong>此接口仅可在Stage模型下使用。</p> <p><strong>系统能力：</strong>SystemCapability.AppGalleryService.Distribution.Update</p> <p><strong>设备行为差异：</strong>对于API 19之前版本，该接口在Phone、Tablet、PC/2in1中可正常调用，在其他设备类型上该接口返回的CheckUpdateResult中updateAvailable值固定为LATER_VERSION_NOT_EXIST，无法检查出应用是否有更新。对于API 19版本，该接口在Phone、Tablet、PC/2in1、TV中可正常调用，在其他设备类型上该接口返回的CheckUpdateResult中updateAvailable值固定为LATER_VERSION_NOT_EXIST，无法检查出应用是否有更新。对于API 20及之后版本，该接口在Phone、Tablet、PC/2in1、TV、Wearable中可正常调用。</p> <p><strong>起始版本：</strong>5.0.0(12)</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.10.9.1.5.1.1" width="24.47%"><p>参数名</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.10.9.1.5.1.2" width="25.53%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.10.9.1.5.1.3" width="25%"><p>必填</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.10.9.1.5.1.4" width="25%"><p>说明</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="24.47%"><p>context</p> </td> <td class="cellrowborder" width="25.53%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext" target="_blank">common.UIAbilityContext</a></p> </td> <td class="cellrowborder" width="25%"><p>是</p> </td> <td class="cellrowborder" width="25%"><p>调用方应用的上下文。</p> </td> </tr>  </tbody></table></div> </div> <p><strong>返回值：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.10.11.1.3.1.1" width="50%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.10.11.1.3.1.2" width="50%"><p>说明</p> </th> </tr><tr><td class="cellrowborder" width="50%"><p>Promise&lt;<a href="/consumer/cn/doc/harmonyos-references/store-updatemanager#section1535385414136">CheckUpdateResult</a>&gt;</p> </td> <td class="cellrowborder" width="50%"><p>Promise对象，返回是否有更新检查结果。</p> </td> </tr>  </tbody></table></div> </div> <p><strong>错误码：</strong></p> <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/store-error-code">ArkTS API错误码</a>。</p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.10.14.1.3.1.1" width="50%"><p>错误码ID</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.10.14.1.3.1.2" width="50%"><p>错误信息</p> </th> </tr><tr><td class="cellrowborder" width="50%"><p>401</p> </td> <td class="cellrowborder" width="50%"><p>Parameter error.</p> </td> </tr> <tr><td class="cellrowborder" width="50%"><p>1009400001</p> </td> <td class="cellrowborder" width="50%"><p>SA connect error.</p> </td> </tr> <tr><td class="cellrowborder" width="50%"><p>1009400002</p> </td> <td class="cellrowborder" width="50%"><p>Request to service error.</p> </td> </tr> <tr><td class="cellrowborder" width="50%"><p>1009400003</p> </td> <td class="cellrowborder" width="50%"><p>Network error.</p> </td> </tr> <tr><td class="cellrowborder" width="50%"><p>1009400004</p> </td> <td class="cellrowborder" width="50%"><p>The application is not in the foreground.</p> </td> </tr> <tr><td class="cellrowborder" width="50%"><p>1009400005</p> </td> <td class="cellrowborder" width="50%"><p>Not agreeing to the privacy agreement.</p> </td> </tr> <tr><td class="cellrowborder" width="50%"><p>1009400006</p> </td> <td class="cellrowborder" width="50%"><p>Time limited.</p> </td> </tr> <tr><td class="cellrowborder" width="50%"><p>1009400007</p> </td> <td class="cellrowborder" width="50%"><p>Other error.</p> </td> </tr>  </tbody></table></div> </div> <p><strong>示例：</strong></p> <div _ngcontent-aft-c106="" class="highlight-div"><div _ngcontent-aft-c106="" class="highlight-div-header"><div _ngcontent-aft-c106="" class="highlight-div-header-left"><div _ngcontent-aft-c106="" class="handle-button expand-button"><div _ngcontent-aft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-aft-c106="" class="highlight-div-header-right"><div _ngcontent-aft-c106="" class="handle-button ai-button"></div><div _ngcontent-aft-c106="" class="handle-button line-button"><div _ngcontent-aft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-aft-c106="" class="handle-button theme-button"><div _ngcontent-aft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-aft-c106="" class="handle-button copy-button"><div _ngcontent-aft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-aft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { updateManager } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AppGalleryKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li><span class="hljs-keyword">import</span> { common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'checkAppUpdate test'</span></li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Row</span>() {</li><li>      <span class="hljs-title class_">Column</span>() {</li><li>        <span class="hljs-title class_">Text</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span>)</li><li>          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">50</span>)</li><li>          .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-keyword">try</span> {</li><li>              updateManager.<span class="hljs-title function_">checkAppUpdate</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>)</li><li>                .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">checkResult: updateManager.CheckUpdateResult</span>) =&gt;</span> {</li><li>                  hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0</span>, <span class="hljs-string">'TAG'</span>, <span class="hljs-string">"Succeeded in checking Result updateAvailable:"</span> + checkResult.<span class="hljs-property">updateAvailable</span>);</li><li>                }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error: BusinessError</span>) =&gt;</span> {</li><li>                hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0</span>, <span class="hljs-string">'TAG'</span>, <span class="hljs-string">`checkAppUpdate onError.code is <span class="hljs-subst">${error.code}</span>, message is <span class="hljs-subst">${error.message}</span>`</span>);</li><li>              });</li><li>            } <span class="hljs-keyword">catch</span> (error) {</li><li>              hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0</span>, <span class="hljs-string">'TAG'</span>, <span class="hljs-string">`checkAppUpdate onError.code is <span class="hljs-subst">${error.code}</span>, message is <span class="hljs-subst">${error.message}</span>`</span>);</li><li>            }</li><li>          })</li><li>      }</li><li>      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    }</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div> </div> <div class="tiledSection"><h2 id="section16502191111574" device-type="phone,2in1,tablet,tv,wearable">updateManager.showUpdateDialog<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section16502191111574" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>showUpdateDialog(context: common.UIAbilityContext): Promise&lt;ShowUpdateResultCode&gt;</p> <p>显示升级弹框，使用Promise方式异步返回结果。</p> <p><strong>模型约束：</strong>此接口仅可在Stage模型下使用。</p> <p><strong>系统能力：</strong>SystemCapability.AppGalleryService.Distribution.Update</p> <p><strong>设备行为差异：</strong>对于API 19之前版本，该接口在Phone、Tablet、PC/2in1中可正常调用，在其他设备类型上该接口返回的ShowUpdateResultCode值固定为SHOW_DIALOG_FAILURE，无法弹出应用更新弹框。对于API 19版本，该接口在Phone、Tablet、PC/2in1、TV中可正常调用，在其他设备类型上该接口返回的ShowUpdateResultCode值固定为SHOW_DIALOG_FAILURE，无法弹出应用更新弹框。对于API 20及之后版本，该接口在Phone、Tablet、PC/2in1、TV、Wearable中可正常调用。</p> <p><strong>起始版本：</strong>5.0.0(12)</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.11.9.1.5.1.1" width="25%"><p>参数名</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.11.9.1.5.1.2" width="25%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.11.9.1.5.1.3" width="25%"><p>必填</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.11.9.1.5.1.4" width="25%"><p>说明</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="25%"><p>context</p> </td> <td class="cellrowborder" width="25%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext" target="_blank">common.UIAbilityContext</a></p> </td> <td class="cellrowborder" width="25%"><p>是</p> </td> <td class="cellrowborder" width="25%"><p>调用方应用的上下文。</p> </td> </tr>  </tbody></table></div> </div> <p><strong>返回值：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.11.11.1.3.1.1" width="50%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.11.11.1.3.1.2" width="50%"><p>说明</p> </th> </tr><tr><td class="cellrowborder" width="50%"><p>Promise&lt;<a href="/consumer/cn/doc/harmonyos-references/store-updatemanager#section194882568246">ShowUpdateResultCode</a>&gt;</p> </td> <td class="cellrowborder" width="50%"><p>Promise对象，返回显示升级弹框获取结果。</p> </td> </tr>  </tbody></table></div> </div> <p><strong>错误码：</strong></p> <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/store-error-code">ArkTS API错误码</a>。</p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.11.14.1.3.1.1" width="50%"><p>错误码ID</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.11.14.1.3.1.2" width="50%"><p>错误信息</p> </th> </tr><tr><td class="cellrowborder" width="50%"><p>401</p> </td> <td class="cellrowborder" width="50%"><p>Parameter error.</p> </td> </tr> <tr><td class="cellrowborder" width="50%"><p>1009400001</p> </td> <td class="cellrowborder" width="50%"><p>SA connection error.</p> </td> </tr> <tr><td class="cellrowborder" width="50%"><p>1009400002</p> </td> <td class="cellrowborder" width="50%"><p>Request to service error.</p> </td> </tr> <tr><td class="cellrowborder" width="50%"><p>1009400004</p> </td> <td class="cellrowborder" width="50%"><p>The application is not in the foreground.</p> </td> </tr> <tr><td class="cellrowborder" width="50%"><p>1009400005</p> </td> <td class="cellrowborder" width="50%"><p>Not agreeing to the privacy agreement.</p> </td> </tr> <tr><td class="cellrowborder" width="50%"><p>1009400007</p> </td> <td class="cellrowborder" width="50%"><p>Other error.</p> </td> </tr>  </tbody></table></div> </div> <p><strong>示例：</strong></p> <div _ngcontent-aft-c106="" class="highlight-div"><div _ngcontent-aft-c106="" class="highlight-div-header"><div _ngcontent-aft-c106="" class="highlight-div-header-left"><div _ngcontent-aft-c106="" class="handle-button expand-button"><div _ngcontent-aft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-aft-c106="" class="highlight-div-header-right"><div _ngcontent-aft-c106="" class="handle-button ai-button"></div><div _ngcontent-aft-c106="" class="handle-button line-button"><div _ngcontent-aft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-aft-c106="" class="handle-button theme-button"><div _ngcontent-aft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-aft-c106="" class="handle-button copy-button"><div _ngcontent-aft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-aft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { updateManager } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AppGalleryKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li><span class="hljs-keyword">import</span> { common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'showUpdateDialog test'</span></li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Row</span>() {</li><li>      <span class="hljs-title class_">Column</span>() {</li><li>        <span class="hljs-title class_">Text</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span>)</li><li>          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">50</span>)</li><li>          .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-keyword">try</span> {</li><li>              updateManager.<span class="hljs-title function_">showUpdateDialog</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>)</li><li>                .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">resultCode: updateManager.ShowUpdateResultCode</span>) =&gt;</span> {</li><li>                  hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0</span>, <span class="hljs-string">'TAG'</span>, <span class="hljs-string">"Succeeded in showing UpdateDialog resultCode:"</span> + resultCode);</li><li>                })</li><li>                .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error: BusinessError</span>) =&gt;</span> {</li><li>                  hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0</span>, <span class="hljs-string">'TAG'</span>, <span class="hljs-string">`showUpdateDialog onError.code is <span class="hljs-subst">${error.code}</span>, message is <span class="hljs-subst">${error.message}</span>`</span>);</li><li>                });</li><li>            } <span class="hljs-keyword">catch</span> (error) {</li><li>              hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0</span>, <span class="hljs-string">'TAG'</span>, <span class="hljs-string">`showUpdateDialog onError.code is <span class="hljs-subst">${error.code}</span>, message is <span class="hljs-subst">${error.message}</span>`</span>);</li><li>            }</li><li>          })</li><li>      }</li><li>      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    }</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div> </div> <div class="tiledSection"><h2 id="section10594172619239" device-type="phone,2in1,tablet,tv,wearable">updateManager.on('updateChange')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section10594172619239" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>on(type: 'updateChange', callback: Callback&lt;UpdateSessionState&gt;, timeout?: number): void</p> <p>监听元服务更新检查接口，检查到有/无更新后，使用callback方式返回结果。</p> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p>同一元服务的调用次数不超过6次/天、每30分钟调用次数不超过1次。</p> </div></div></div> <p><strong>模型约束：</strong>此接口仅可在Stage模型下使用。</p> <p><strong>元服务API：</strong>从版本6.0.0(20)开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong>SystemCapability.AppGalleryService.Distribution.Update</p> <p><strong>起始版本：</strong>6.0.0(20)</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.12.10.1.5.1.1" width="24.47%"><p>参数名</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.12.10.1.5.1.2" width="25.53%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.12.10.1.5.1.3" width="25%"><p>必填</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.12.10.1.5.1.4" width="25%"><p>说明</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="24.47%"><p>type</p> </td> <td class="cellrowborder" width="25.53%"><p>string</p> </td> <td class="cellrowborder" width="25%"><p>是</p> </td> <td class="cellrowborder" width="25%"><p>固定值"updateChange"。</p> </td> </tr> <tr><td class="cellrowborder" width="24.47%"><p>callback</p> </td> <td class="cellrowborder" width="25.53%"><p>Callback&lt;<a href="/consumer/cn/doc/harmonyos-references/store-updatemanager#section18222589421">UpdateSessionState</a>&gt;</p> </td> <td class="cellrowborder" width="25%"><p>是</p> </td> <td class="cellrowborder" width="25%"><p>回调函数，使用Callback方式获取结果。</p> </td> </tr> <tr><td class="cellrowborder" width="24.47%"><p>timeout</p> </td> <td class="cellrowborder" width="25.53%"><p>number</p> </td> <td class="cellrowborder" width="25%"><p>否</p> </td> <td class="cellrowborder" width="25%"><p>注册监听允许的最大监听时间（单位：s），取值范围：不大于20的正整数，如果不传，取默认值20。</p> </td> </tr>  </tbody></table></div> </div> <p><strong>错误码：</strong></p> <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/store-error-code">ArkTS API错误码</a>。</p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.12.13.1.3.1.1" width="50%"><p>错误码ID</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.12.13.1.3.1.2" width="50%"><p>错误信息</p> </th> </tr><tr><td class="cellrowborder" width="50%"><p>1009400001</p> </td> <td class="cellrowborder" width="50%"><p>SA connection error.</p> </td> </tr> <tr><td class="cellrowborder" width="50%"><p>1009400002</p> </td> <td class="cellrowborder" width="50%"><p>Request to service error.</p> </td> </tr> <tr><td class="cellrowborder" width="50%"><p>1009400007</p> </td> <td class="cellrowborder" width="50%"><p>Other error.</p> </td> </tr> <tr><td class="cellrowborder" width="50%"><p>1009400008</p> </td> <td class="cellrowborder" width="50%"><p>The number of parameters for the on API is incorrect.</p> </td> </tr> <tr><td class="cellrowborder" width="50%"><p>1009400009</p> </td> <td class="cellrowborder" width="50%"><p>The type parameter for the on API is invalid.</p> </td> </tr> <tr><td class="cellrowborder" width="50%"><p>1009400010</p> </td> <td class="cellrowborder" width="50%"><p>The callback parameter for the on API is invalid.</p> </td> </tr> <tr><td class="cellrowborder" width="50%"><p>1009400011</p> </td> <td class="cellrowborder" width="50%"><p>The timeout parameter for the on API is invalid.</p> </td> </tr>  </tbody></table></div> </div> </div> <p><strong>示例：</strong></p> <div _ngcontent-aft-c106="" class="highlight-div"><div _ngcontent-aft-c106="" class="highlight-div-header"><div _ngcontent-aft-c106="" class="highlight-div-header-left"><div _ngcontent-aft-c106="" class="handle-button expand-button"><div _ngcontent-aft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-aft-c106="" class="highlight-div-header-right"><div _ngcontent-aft-c106="" class="handle-button ai-button"></div><div _ngcontent-aft-c106="" class="handle-button line-button"><div _ngcontent-aft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-aft-c106="" class="handle-button theme-button"><div _ngcontent-aft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-aft-c106="" class="handle-button copy-button"><div _ngcontent-aft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-aft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { updateManager } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AppGalleryKit'</span>;</li><li><span class="hljs-keyword">import</span> { abilityManager, common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'on'</span></li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Row</span>() {</li><li>      <span class="hljs-title class_">Column</span>() {</li><li>        <span class="hljs-title class_">Text</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span>)</li><li>          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">50</span>)</li><li>          .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">callOn</span>)</li><li>      }</li><li>      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    }</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-title function_">callOn</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-title function_">callback</span> = (<span class="hljs-params">state: updateManager.UpdateSessionState</span>) =&gt; {</li><li>      <span class="hljs-keyword">if</span> (state.<span class="hljs-property">code</span> === updateManager.<span class="hljs-property">RequestErrorCode</span>.<span class="hljs-property">NO_UPGRADE</span>) {</li><li>        hilog.<span class="hljs-property">info</span> (<span class="hljs-number">0</span>, <span class="hljs-string">'TAG'</span>, <span class="hljs-string">`on success, no need update`</span>);</li><li>        updateManager.<span class="hljs-title function_">off</span>(<span class="hljs-string">'updateChange'</span>);</li><li>      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (state.<span class="hljs-property">code</span> === updateManager.<span class="hljs-property">RequestErrorCode</span>.<span class="hljs-property">NEED_UPGRADE</span>) {</li><li>        hilog.<span class="hljs-property">info</span> (<span class="hljs-number">0</span>, <span class="hljs-string">'TAG'</span>, <span class="hljs-string">`on success, need update`</span>);</li><li>      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (state.<span class="hljs-property">code</span> === updateManager.<span class="hljs-property">RequestErrorCode</span>.<span class="hljs-property">DOWNLOADED</span>) {</li><li>        hilog.<span class="hljs-property">info</span> (<span class="hljs-number">0</span>, <span class="hljs-string">'TAG'</span>, <span class="hljs-string">`on success, need update and download success`</span>);</li><li>        updateManager.<span class="hljs-title function_">off</span>(<span class="hljs-string">'updateChange'</span>);</li><li>        abilityManager.<span class="hljs-title function_">restartSelfAtomicService</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">Context</span>);</li><li>      }</li><li>    };</li><li>    <span class="hljs-keyword">try</span> {</li><li>      updateManager.<span class="hljs-title function_">on</span>(<span class="hljs-string">'updateChange'</span>, callback, <span class="hljs-number">20</span>);</li><li>    } <span class="hljs-keyword">catch</span> (error) {</li><li>      hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0</span>, <span class="hljs-string">'TAG'</span>, <span class="hljs-string">`on Error.code is <span class="hljs-subst">${error.code}</span>, message is <span class="hljs-subst">${error.message}</span>`</span>);</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div> <div class="tiledSection"><h2 id="section9889107152415" device-type="phone,2in1,tablet,tv,wearable">updateManager.off('updateChange')<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="section9889107152415" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>off(type: 'updateChange', callback?: Callback&lt;UpdateSessionState&gt;): void</p> <p>取消监听元服务更新检查接口。</p> <p><strong>模型约束：</strong>此接口仅可在Stage模型下使用。</p> <p><strong>元服务API：</strong>从版本6.0.0(20)开始，该接口支持在元服务中使用。</p> <p><strong>系统能力：</strong>SystemCapability.AppGalleryService.Distribution.Update</p> <p><strong>起始版本：</strong>6.0.0(20)</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.15.9.1.5.1.1" width="25%"><p>参数名</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.15.9.1.5.1.2" width="25%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.15.9.1.5.1.3" width="25%"><p>必填</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.15.9.1.5.1.4" width="25%"><p>说明</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="25%"><p>type</p> </td> <td class="cellrowborder" width="25%"><p>string</p> </td> <td class="cellrowborder" width="25%"><p>是</p> </td> <td class="cellrowborder" width="25%"><p>固定值"updateChange"。</p> </td> </tr> <tr><td class="cellrowborder" width="25%"><p>callback</p> </td> <td class="cellrowborder" width="25%"><p>Callback&lt;<a href="/consumer/cn/doc/harmonyos-references/store-updatemanager#section18222589421">UpdateSessionState</a>&gt;</p> </td> <td class="cellrowborder" width="25%"><p>否</p> </td> <td class="cellrowborder" width="25%"><p>回调函数，使用Callback的方式获取结果。不传该参数则会取消当前应用的所有监听。</p> </td> </tr>  </tbody></table></div> </div> <p><strong>错误码：</strong></p> <p>以下错误码的详细介绍请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/store-error-code">ArkTS API错误码</a>。</p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.15.12.1.3.1.1" width="50%"><p>错误码ID</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.15.12.1.3.1.2" width="50%"><p>错误信息</p> </th> </tr><tr><td class="cellrowborder" width="50%"><p>1009400001</p> </td> <td class="cellrowborder" width="50%"><p>SA connection error.</p> </td> </tr> <tr><td class="cellrowborder" width="50%"><p>1009400002</p> </td> <td class="cellrowborder" width="50%"><p>Request to service error.</p> </td> </tr> <tr><td class="cellrowborder" width="50%"><p>1009400007</p> </td> <td class="cellrowborder" width="50%"><p>Other error.</p> </td> </tr> <tr><td class="cellrowborder" width="50%"><p>1009400012</p> </td> <td class="cellrowborder" width="50%"><p>The number of parameters for the off API is incorrect.</p> </td> </tr> <tr><td class="cellrowborder" width="50%"><p>1009400013</p> </td> <td class="cellrowborder" width="50%"><p>The type parameter for the off API is invalid.</p> </td> </tr> <tr><td class="cellrowborder" width="50%"><p>1009400014</p> </td> <td class="cellrowborder" width="50%"><p>The callback parameter for the off API is invalid.</p> </td> </tr>  </tbody></table></div> </div> <p><strong>示例：</strong></p> <div _ngcontent-aft-c106="" class="highlight-div"><div _ngcontent-aft-c106="" class="highlight-div-header"><div _ngcontent-aft-c106="" class="highlight-div-header-left"><div _ngcontent-aft-c106="" class="handle-button expand-button"><div _ngcontent-aft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-aft-c106="" class="highlight-div-header-right"><div _ngcontent-aft-c106="" class="handle-button ai-button"></div><div _ngcontent-aft-c106="" class="handle-button line-button"><div _ngcontent-aft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-aft-c106="" class="handle-button theme-button"><div _ngcontent-aft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-aft-c106="" class="handle-button copy-button"><div _ngcontent-aft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-aft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { updateManager } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AppGalleryKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li><span class="hljs-keyword">try</span> {</li><li>  <span class="hljs-comment">// 取消监听</span></li><li>  updateManager.<span class="hljs-title function_">off</span>(<span class="hljs-string">'updateChange'</span>);</li><li>} <span class="hljs-keyword">catch</span> (error) {</li><li>  hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0</span>, <span class="hljs-string">'TAG'</span>, <span class="hljs-string">`moduleInstallManager.off onError.code is <span class="hljs-subst">${error.code}</span>, message is <span class="hljs-subst">${error.message}</span>`</span>);</li><li>}</li></ol></pre></div></div> </div> </div> <div></div></div>