<h1 _ngcontent-mdq-c119="" class="doc-title ng-star-inserted" title="usb_ddk_api.h"> usb_ddk_api.h </h1>

<div _ngcontent-mdq-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div> <div class="tiledSection"><h2 id="概述" device-type="2in1">概述<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="概述" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">PC/2in1</span></div><p>声明用于主机侧访问设备的USB DDK接口。</p> <p><strong>引用文件：</strong> &lt;usb/usb_ddk_api.h&gt;</p> <p><strong>库：</strong> libusb_ndk.z.so</p> <p><strong>系统能力：</strong> SystemCapability.Driver.USB.Extension</p> <p><strong>起始版本：</strong> 10</p> <p><strong>相关模块：</strong> <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usbddk">UsbDDK</a></p> </div>  <div class="tiledSection"><h2 id="汇总" device-type="2in1">汇总<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="汇总" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">PC/2in1</span></div></div>  <div class="tiledSection"><h3 id="函数" device-type="2in1" class="firsth2">函数<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="函数" tips="复制节点链接"></i></h3> <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">PC/2in1</span></div><div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.3.2.1.3.1.1" width="50%">名称</th> <th align="left" class="cellrowborder" id="mcps1.3.3.2.1.3.1.2" width="50%">描述</th> </tr><tr><td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/capi-usb-ddk-api-h#oh_usb_init">int32_t OH_Usb_Init(void)</a></td> <td class="cellrowborder" width="50%">初始化DDK。</td> </tr> <tr><td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/capi-usb-ddk-api-h#oh_usb_release">void OH_Usb_Release(void)</a></td> <td class="cellrowborder" width="50%">释放DDK。</td> </tr> <tr><td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/capi-usb-ddk-api-h#oh_usb_releaseresource">int32_t OH_Usb_ReleaseResource(void)</a></td> <td class="cellrowborder" width="50%">释放DDK。</td> </tr> <tr><td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/capi-usb-ddk-api-h#oh_usb_getdevicedescriptor">int32_t OH_Usb_GetDeviceDescriptor(uint64_t deviceId, struct UsbDeviceDescriptor *desc)</a></td> <td class="cellrowborder" width="50%">获取设备描述符。</td> </tr> <tr><td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/capi-usb-ddk-api-h#oh_usb_getconfigdescriptor">int32_t OH_Usb_GetConfigDescriptor(uint64_t deviceId, uint8_t configIndex, struct UsbDdkConfigDescriptor ** const config)</a></td> <td class="cellrowborder" width="50%">获取配置描述符。请在描述符使用完后使用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-api-h#oh_usb_freeconfigdescriptor">OH_Usb_FreeConfigDescriptor</a>释放描述符，否则会造成内存泄露。</td> </tr> <tr><td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/capi-usb-ddk-api-h#oh_usb_freeconfigdescriptor">void OH_Usb_FreeConfigDescriptor(const struct UsbDdkConfigDescriptor * const config)</a></td> <td class="cellrowborder" width="50%">释放配置描述符，请在描述符使用完后释放描述符，否则会造成内存泄露。</td> </tr> <tr><td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/capi-usb-ddk-api-h#oh_usb_claiminterface">int32_t OH_Usb_ClaimInterface(uint64_t deviceId, uint8_t interfaceIndex, uint64_t *interfaceHandle)</a></td> <td class="cellrowborder" width="50%">声明接口。</td> </tr> <tr><td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/capi-usb-ddk-api-h#oh_usb_releaseinterface">int32_t OH_Usb_ReleaseInterface(uint64_t interfaceHandle)</a></td> <td class="cellrowborder" width="50%">释放接口。</td> </tr> <tr><td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/capi-usb-ddk-api-h#oh_usb_selectinterfacesetting">int32_t OH_Usb_SelectInterfaceSetting(uint64_t interfaceHandle, uint8_t settingIndex)</a></td> <td class="cellrowborder" width="50%">激活接口的备用设置。</td> </tr> <tr><td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/capi-usb-ddk-api-h#oh_usb_getcurrentinterfacesetting">int32_t OH_Usb_GetCurrentInterfaceSetting(uint64_t interfaceHandle, uint8_t *settingIndex)</a></td> <td class="cellrowborder" width="50%">获取接口当前激活的备用设置。</td> </tr> <tr><td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/capi-usb-ddk-api-h#oh_usb_sendcontrolreadrequest">int32_t OH_Usb_SendControlReadRequest(uint64_t interfaceHandle, const struct UsbControlRequestSetup *setup,uint32_t timeout, uint8_t *data, uint32_t *dataLen)</a></td> <td class="cellrowborder" width="50%">发送控制读请求，该接口为同步接口。</td> </tr> <tr><td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/capi-usb-ddk-api-h#oh_usb_sendcontrolwriterequest">int32_t OH_Usb_SendControlWriteRequest(uint64_t interfaceHandle, const struct UsbControlRequestSetup *setup,uint32_t timeout, const uint8_t *data, uint32_t dataLen)</a></td> <td class="cellrowborder" width="50%">发送控制写请求，该接口为同步接口。</td> </tr> <tr><td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/capi-usb-ddk-api-h#oh_usb_sendpiperequest">int32_t OH_Usb_SendPipeRequest(const struct UsbRequestPipe *pipe, UsbDeviceMemMap *devMmap)</a></td> <td class="cellrowborder" width="50%">发送管道请求，该接口为同步接口。中断传输和批量传输都使用该接口发送请求。</td> </tr> <tr><td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/capi-usb-ddk-api-h#oh_usb_sendpiperequestwithashmem">int32_t OH_Usb_SendPipeRequestWithAshmem(const struct UsbRequestPipe *pipe, DDK_Ashmem *ashmem)</a></td> <td class="cellrowborder" width="50%">发送管道请求，该接口为同步接口。中断传输和批量传输都使用该接口发送请求。</td> </tr> <tr><td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/capi-usb-ddk-api-h#oh_usb_createdevicememmap">int32_t OH_Usb_CreateDeviceMemMap(uint64_t deviceId, size_t size, UsbDeviceMemMap **devMmap)</a></td> <td class="cellrowborder" width="50%">创建缓冲区。请在缓冲区使用完后，调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-api-h#oh_usb_destroydevicememmap">OH_Usb_DestroyDeviceMemMap</a>销毁缓冲区，否则会造成资源泄露。</td> </tr> <tr><td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/capi-usb-ddk-api-h#oh_usb_destroydevicememmap">void OH_Usb_DestroyDeviceMemMap(UsbDeviceMemMap *devMmap)</a></td> <td class="cellrowborder" width="50%">销毁缓冲区。请在缓冲区使用完后及时销毁缓冲区，否则会造成资源泄露。</td> </tr> <tr><td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/capi-usb-ddk-api-h#oh_usb_getdevices">int32_t OH_Usb_GetDevices(struct Usb_DeviceArray *devices)</a></td> <td class="cellrowborder" width="50%">获取USB设备ID列表。请保证传入的指针参数是有效的，申请设备的数量不要超过128个，在使用完结构之后，释放成员内存，否则造成资源泄露。获取到的USB设备ID，已通过驱动配置信息中的vid进行筛选过滤。</td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h2 id="函数说明" device-type="2in1">函数说明<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="函数说明" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">PC/2in1</span></div></div>  <div class="tiledSection"><h3 id="oh_usb_init" device-type="2in1" class="firsth2">OH_Usb_Init()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="oh_usb_init" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">PC/2in1</span></div><div _ngcontent-mdq-c106="" class="highlight-div"><div _ngcontent-mdq-c106="" class="highlight-div-header"><div _ngcontent-mdq-c106="" class="highlight-div-header-left"><div _ngcontent-mdq-c106="" class="handle-button expand-button"><div _ngcontent-mdq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mdq-c106="" class="highlight-div-header-right"><div _ngcontent-mdq-c106="" class="handle-button ai-button"></div><div _ngcontent-mdq-c106="" class="handle-button line-button"><div _ngcontent-mdq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mdq-c106="" class="handle-button theme-button"><div _ngcontent-mdq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mdq-c106="" class="handle-button copy-button"><div _ngcontent-mdq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mdq-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-function"><span class="hljs-type">int32_t</span> <span class="hljs-title">OH_Usb_Init</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span></span></li></ol></pre></div></div> <p><strong>描述</strong></p> <p>初始化DDK。</p> <p><strong>需要权限：</strong> ohos.permission.ACCESS_DDK_USB</p> <p><strong>起始版本：</strong> 10</p> <p><strong>返回：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.5.8.1.3.1.1" width="50%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.5.8.1.3.1.2" width="50%">说明</th> </tr><tr><td class="cellrowborder" width="50%">int32_t</td> <td class="cellrowborder" width="50%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-types-h#usbddkerrcode">USB_DDK_SUCCESS</a> 调用接口成功。</p> <p> <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-types-h#usbddkerrcode">USB_DDK_INVALID_OPERATION</a> 连接 USB DDK 服务失败或内部错误。</p> <p> <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-types-h#usbddkerrcode">USB_DDK_NO_PERM</a> 权限检查失败。</p> <p> <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-types-h#usbddkerrcode">USB_DDK_MEMORY_ERROR</a> 内存分配失败。</p> </td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h3 id="oh_usb_release" device-type="2in1">OH_Usb_Release()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="oh_usb_release" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">PC/2in1</span></div><div _ngcontent-mdq-c106="" class="highlight-div"><div _ngcontent-mdq-c106="" class="highlight-div-header"><div _ngcontent-mdq-c106="" class="highlight-div-header-left"><div _ngcontent-mdq-c106="" class="handle-button expand-button"><div _ngcontent-mdq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mdq-c106="" class="highlight-div-header-right"><div _ngcontent-mdq-c106="" class="handle-button ai-button"></div><div _ngcontent-mdq-c106="" class="handle-button line-button"><div _ngcontent-mdq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mdq-c106="" class="handle-button theme-button"><div _ngcontent-mdq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mdq-c106="" class="handle-button copy-button"><div _ngcontent-mdq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mdq-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-java" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">void</span> <span class="hljs-title function_">OH_Usb_Release</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span></li></ol></pre></div></div> <p><strong>描述</strong></p> <p>释放DDK。</p> <p><strong>需要权限：</strong> ohos.permission.ACCESS_DDK_USB</p> <p><strong>起始版本：</strong> 10</p> </div>  <div class="tiledSection"><h3 id="oh_usb_releaseresource" device-type="2in1">OH_Usb_ReleaseResource()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="oh_usb_releaseresource" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">PC/2in1</span></div><div _ngcontent-mdq-c106="" class="highlight-div"><div _ngcontent-mdq-c106="" class="highlight-div-header"><div _ngcontent-mdq-c106="" class="highlight-div-header-left"><div _ngcontent-mdq-c106="" class="handle-button expand-button"><div _ngcontent-mdq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mdq-c106="" class="highlight-div-header-right"><div _ngcontent-mdq-c106="" class="handle-button ai-button"></div><div _ngcontent-mdq-c106="" class="handle-button line-button"><div _ngcontent-mdq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mdq-c106="" class="handle-button theme-button"><div _ngcontent-mdq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mdq-c106="" class="handle-button copy-button"><div _ngcontent-mdq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mdq-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-function"><span class="hljs-type">int32_t</span> <span class="hljs-title">OH_Usb_ReleaseResource</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span></span></li></ol></pre></div></div> <p><strong>描述</strong></p> <p>释放DDK。</p> <p><strong>需要权限：</strong> ohos.permission.ACCESS_DDK_USB</p> <p><strong>起始版本：</strong> 18</p> <p><strong>返回：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.7.8.1.3.1.1" width="50%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.7.8.1.3.1.2" width="50%">说明</th> </tr><tr><td class="cellrowborder" width="50%">int32_t</td> <td class="cellrowborder" width="50%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-types-h#usbddkerrcode">USB_DDK_SUCCESS</a> 调用接口成功。</p> <p> <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-types-h#usbddkerrcode">USB_DDK_NO_PERM</a> 权限检查失败。</p> <p> <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-types-h#usbddkerrcode">USB_DDK_INVALID_OPERATION</a> 连接 USB DDK 服务失败。</p> </td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h3 id="oh_usb_getdevicedescriptor" device-type="2in1">OH_Usb_GetDeviceDescriptor()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="oh_usb_getdevicedescriptor" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">PC/2in1</span></div><div _ngcontent-mdq-c106="" class="highlight-div"><div _ngcontent-mdq-c106="" class="highlight-div-header"><div _ngcontent-mdq-c106="" class="highlight-div-header-left"><div _ngcontent-mdq-c106="" class="handle-button expand-button"><div _ngcontent-mdq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mdq-c106="" class="highlight-div-header-right"><div _ngcontent-mdq-c106="" class="handle-button ai-button"></div><div _ngcontent-mdq-c106="" class="handle-button line-button"><div _ngcontent-mdq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mdq-c106="" class="handle-button theme-button"><div _ngcontent-mdq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mdq-c106="" class="handle-button copy-button"><div _ngcontent-mdq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mdq-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-function"><span class="hljs-type">int32_t</span> <span class="hljs-title">OH_Usb_GetDeviceDescriptor</span><span class="hljs-params">(<span class="hljs-type">uint64_t</span> deviceId, <span class="hljs-keyword">struct</span> UsbDeviceDescriptor *desc)</span></span></li></ol></pre></div></div> <p><strong>描述</strong></p> <p>获取设备描述符。</p> <p><strong>需要权限：</strong> ohos.permission.ACCESS_DDK_USB</p> <p><strong>起始版本：</strong> 10</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.8.8.1.3.1.1" width="50%">参数项</th> <th align="left" class="cellrowborder" id="mcps1.3.8.8.1.3.1.2" width="50%">描述</th> </tr><tr><td class="cellrowborder" width="50%">uint64_t deviceId</td> <td class="cellrowborder" width="50%">设备ID，代表要获取描述符的设备。</td> </tr> <tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usbddk-usbdevicedescriptor">struct UsbDeviceDescriptor</a> *desc</td> <td class="cellrowborder" width="50%">设备描述符，详细定义请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usbddk-usbdevicedescriptor">UsbDeviceDescriptor</a>。</td> </tr>  </tbody></table></div> </div> <p><strong>返回：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.8.10.1.3.1.1" width="50%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.8.10.1.3.1.2" width="50%">说明</th> </tr><tr><td class="cellrowborder" width="50%">int32_t</td> <td class="cellrowborder" width="50%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-types-h#usbddkerrcode">USB_DDK_SUCCESS</a> 调用接口成功。</p> <p> <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-types-h#usbddkerrcode">USB_DDK_NO_PERM</a> 权限检查失败。</p> <p> <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-types-h#usbddkerrcode">USB_DDK_INVALID_OPERATION</a> 连接usb_ddk服务失败。</p> <p> <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-types-h#usbddkerrcode">USB_DDK_INVALID_PARAMETER</a> 入参desc为空指针。</p> </td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h3 id="oh_usb_getconfigdescriptor" device-type="2in1">OH_Usb_GetConfigDescriptor()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="oh_usb_getconfigdescriptor" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">PC/2in1</span></div><div _ngcontent-mdq-c106="" class="highlight-div"><div _ngcontent-mdq-c106="" class="highlight-div-header"><div _ngcontent-mdq-c106="" class="highlight-div-header-left"><div _ngcontent-mdq-c106="" class="handle-button expand-button"><div _ngcontent-mdq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mdq-c106="" class="highlight-div-header-right"><div _ngcontent-mdq-c106="" class="handle-button ai-button"></div><div _ngcontent-mdq-c106="" class="handle-button line-button"><div _ngcontent-mdq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mdq-c106="" class="handle-button theme-button"><div _ngcontent-mdq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mdq-c106="" class="handle-button copy-button"><div _ngcontent-mdq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mdq-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-function"><span class="hljs-type">int32_t</span> <span class="hljs-title">OH_Usb_GetConfigDescriptor</span><span class="hljs-params">(<span class="hljs-type">uint64_t</span> deviceId, <span class="hljs-type">uint8_t</span> configIndex, <span class="hljs-keyword">struct</span> UsbDdkConfigDescriptor ** <span class="hljs-type">const</span> config)</span></span></li></ol></pre></div></div> <p><strong>描述</strong></p> <p>获取配置描述符。请在描述符使用完后使用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-api-h#oh_usb_freeconfigdescriptor">OH_Usb_FreeConfigDescriptor</a>释放描述符，否则会造成内存泄露。</p> <p><strong>需要权限：</strong> ohos.permission.ACCESS_DDK_USB</p> <p><strong>起始版本：</strong> 10</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.9.8.1.3.1.1" width="50%">参数项</th> <th align="left" class="cellrowborder" id="mcps1.3.9.8.1.3.1.2" width="50%">描述</th> </tr><tr><td class="cellrowborder" width="50%">uint64_t deviceId</td> <td class="cellrowborder" width="50%">设备ID，代表要获取配置描述符的设备。</td> </tr> <tr><td class="cellrowborder" width="50%">uint8_t configIndex</td> <td class="cellrowborder" width="50%">配置id，对应USB协议中的{@link bConfigurationValue}。</td> </tr> <tr><td class="cellrowborder" width="50%">struct <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usbddk-usbddkconfigdescriptor">UsbDdkConfigDescriptor</a> ** const config</td> <td class="cellrowborder" width="50%">配置描述符，包含USB协议中定义的标准配置描述符，以及与其关联的接口描述符和端点描述符。</td> </tr>  </tbody></table></div> </div> <p><strong>返回：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.9.10.1.3.1.1" width="50%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.9.10.1.3.1.2" width="50%">说明</th> </tr><tr><td class="cellrowborder" width="50%">int32_t</td> <td class="cellrowborder" width="50%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-types-h#usbddkerrcode">USB_DDK_SUCCESS</a> 调用接口成功。</p> <p> <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-types-h#usbddkerrcode">USB_DDK_NO_PERM</a> 权限检查失败。</p> <p> <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-types-h#usbddkerrcode">USB_DDK_INVALID_OPERATION</a> 连接USB DDK服务失败。</p> <p> <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-types-h#usbddkerrcode">USB_DDK_INVALID_PARAMETER</a> 入参config为空指针。</p> <p> <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-types-h#usbddkerrcode">USB_DDK_IO_FAILED</a> 数据IO异常。</p> <p> <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-types-h#usbddkerrcode">USB_DDK_MEMORY_ERROR</a> 内存分配失败。</p> </td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h3 id="oh_usb_freeconfigdescriptor" device-type="2in1">OH_Usb_FreeConfigDescriptor()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="oh_usb_freeconfigdescriptor" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">PC/2in1</span></div><div _ngcontent-mdq-c106="" class="highlight-div"><div _ngcontent-mdq-c106="" class="highlight-div-header"><div _ngcontent-mdq-c106="" class="highlight-div-header-left"><div _ngcontent-mdq-c106="" class="handle-button expand-button"><div _ngcontent-mdq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mdq-c106="" class="highlight-div-header-right"><div _ngcontent-mdq-c106="" class="handle-button ai-button"></div><div _ngcontent-mdq-c106="" class="handle-button line-button"><div _ngcontent-mdq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mdq-c106="" class="handle-button theme-button"><div _ngcontent-mdq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mdq-c106="" class="handle-button copy-button"><div _ngcontent-mdq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mdq-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">OH_Usb_FreeConfigDescriptor</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-keyword">struct</span> UsbDdkConfigDescriptor * <span class="hljs-type">const</span> config)</span></span></li></ol></pre></div></div> <p><strong>描述</strong></p> <p>释放配置描述符，请在描述符使用完后释放描述符，否则会造成内存泄露。</p> <p><strong>需要权限：</strong> ohos.permission.ACCESS_DDK_USB</p> <p><strong>起始版本：</strong> 10</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.10.8.1.3.1.1" width="50%">参数项</th> <th align="left" class="cellrowborder" id="mcps1.3.10.8.1.3.1.2" width="50%">描述</th> </tr><tr><td class="cellrowborder" width="50%">const struct <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usbddk-usbddkconfigdescriptor">UsbDdkConfigDescriptor</a> * const config</td> <td class="cellrowborder" width="50%">配置描述符，通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-api-h#oh_usb_getconfigdescriptor">OH_Usb_GetConfigDescriptor</a>获得的配置描述符。</td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h3 id="oh_usb_claiminterface" device-type="2in1">OH_Usb_ClaimInterface()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="oh_usb_claiminterface" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">PC/2in1</span></div><div _ngcontent-mdq-c106="" class="highlight-div"><div _ngcontent-mdq-c106="" class="highlight-div-header"><div _ngcontent-mdq-c106="" class="highlight-div-header-left"><div _ngcontent-mdq-c106="" class="handle-button expand-button"><div _ngcontent-mdq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mdq-c106="" class="highlight-div-header-right"><div _ngcontent-mdq-c106="" class="handle-button ai-button"></div><div _ngcontent-mdq-c106="" class="handle-button line-button"><div _ngcontent-mdq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mdq-c106="" class="handle-button theme-button"><div _ngcontent-mdq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mdq-c106="" class="handle-button copy-button"><div _ngcontent-mdq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mdq-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-function"><span class="hljs-type">int32_t</span> <span class="hljs-title">OH_Usb_ClaimInterface</span><span class="hljs-params">(<span class="hljs-type">uint64_t</span> deviceId, <span class="hljs-type">uint8_t</span> interfaceIndex, <span class="hljs-type">uint64_t</span> *interfaceHandle)</span></span></li></ol></pre></div></div> <p><strong>描述</strong></p> <p>声明接口。</p> <p><strong>需要权限：</strong> ohos.permission.ACCESS_DDK_USB</p> <p><strong>起始版本：</strong> 10</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.11.8.1.3.1.1" width="50%">参数项</th> <th align="left" class="cellrowborder" id="mcps1.3.11.8.1.3.1.2" width="50%">描述</th> </tr><tr><td class="cellrowborder" width="50%">uint64_t deviceId</td> <td class="cellrowborder" width="50%">设备ID，代表要操作的设备。</td> </tr> <tr><td class="cellrowborder" width="50%">uint8_t interfaceIndex</td> <td class="cellrowborder" width="50%">接口索引，对应USB协议中的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usbddk-usbinterfacedescriptor">bInterfaceNumber</a>。</td> </tr> <tr><td class="cellrowborder" width="50%">uint64_t *interfaceHandle</td> <td class="cellrowborder" width="50%">接口操作句柄，接口声明成功后，该参数将会被赋值。</td> </tr>  </tbody></table></div> </div> <p><strong>返回：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.11.10.1.3.1.1" width="50%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.11.10.1.3.1.2" width="50%">说明</th> </tr><tr><td class="cellrowborder" width="50%">int32_t</td> <td class="cellrowborder" width="50%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-types-h#usbddkerrcode">USB_DDK_SUCCESS</a> 调用接口成功。</p> <p> <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-types-h#usbddkerrcode">USB_DDK_NO_PERM</a> 权限检查失败。</p> <p> <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-types-h#usbddkerrcode">USB_DDK_INVALID_OPERATION</a> 连接USB DDK服务失败。</p> <p> <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-types-h#usbddkerrcode">USB_DDK_INVALID_PARAMETER</a> 入参interfaceHandle为空指针。</p> <p> <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-types-h#usbddkerrcode">USB_DDK_MEMORY_ERROR</a> 内存超出限制。</p> </td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h3 id="oh_usb_releaseinterface" device-type="2in1">OH_Usb_ReleaseInterface()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="oh_usb_releaseinterface" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">PC/2in1</span></div><div _ngcontent-mdq-c106="" class="highlight-div"><div _ngcontent-mdq-c106="" class="highlight-div-header"><div _ngcontent-mdq-c106="" class="highlight-div-header-left"><div _ngcontent-mdq-c106="" class="handle-button expand-button"><div _ngcontent-mdq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mdq-c106="" class="highlight-div-header-right"><div _ngcontent-mdq-c106="" class="handle-button ai-button"></div><div _ngcontent-mdq-c106="" class="handle-button line-button"><div _ngcontent-mdq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mdq-c106="" class="handle-button theme-button"><div _ngcontent-mdq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mdq-c106="" class="handle-button copy-button"><div _ngcontent-mdq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mdq-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-function"><span class="hljs-type">int32_t</span> <span class="hljs-title">OH_Usb_ReleaseInterface</span><span class="hljs-params">(<span class="hljs-type">uint64_t</span> interfaceHandle)</span></span></li></ol></pre></div></div> <p><strong>描述</strong></p> <p>释放接口。</p> <p><strong>需要权限：</strong> ohos.permission.ACCESS_DDK_USB</p> <p><strong>起始版本：</strong> 10</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.12.8.1.3.1.1" width="50%">参数项</th> <th align="left" class="cellrowborder" id="mcps1.3.12.8.1.3.1.2" width="50%">描述</th> </tr><tr><td class="cellrowborder" width="50%">uint64_t interfaceHandle</td> <td class="cellrowborder" width="50%">接口操作句柄，代表要释放的接口。</td> </tr>  </tbody></table></div> </div> <p><strong>返回：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.12.10.1.3.1.1" width="50%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.12.10.1.3.1.2" width="50%">说明</th> </tr><tr><td class="cellrowborder" width="50%">int32_t</td> <td class="cellrowborder" width="50%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-types-h#usbddkerrcode">USB_DDK_SUCCESS</a> 调用接口成功。</p> <p> <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-types-h#usbddkerrcode">USB_DDK_NO_PERM</a> 权限检查失败。</p> <p> <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-types-h#usbddkerrcode">USB_DDK_INVALID_OPERATION</a> 连接USB DDK服务失败。</p> <p> <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-types-h#usbddkerrcode">USB_DDK_INVALID_PARAMETER</a> 参数错误。</p> </td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h3 id="oh_usb_selectinterfacesetting" device-type="2in1">OH_Usb_SelectInterfaceSetting()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="oh_usb_selectinterfacesetting" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">PC/2in1</span></div><div _ngcontent-mdq-c106="" class="highlight-div"><div _ngcontent-mdq-c106="" class="highlight-div-header"><div _ngcontent-mdq-c106="" class="highlight-div-header-left"><div _ngcontent-mdq-c106="" class="handle-button expand-button"><div _ngcontent-mdq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mdq-c106="" class="highlight-div-header-right"><div _ngcontent-mdq-c106="" class="handle-button ai-button"></div><div _ngcontent-mdq-c106="" class="handle-button line-button"><div _ngcontent-mdq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mdq-c106="" class="handle-button theme-button"><div _ngcontent-mdq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mdq-c106="" class="handle-button copy-button"><div _ngcontent-mdq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mdq-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-function"><span class="hljs-type">int32_t</span> <span class="hljs-title">OH_Usb_SelectInterfaceSetting</span><span class="hljs-params">(<span class="hljs-type">uint64_t</span> interfaceHandle, <span class="hljs-type">uint8_t</span> settingIndex)</span></span></li></ol></pre></div></div> <p><strong>描述</strong></p> <p>激活接口的备用设置。</p> <p><strong>需要权限：</strong> ohos.permission.ACCESS_DDK_USB</p> <p><strong>起始版本：</strong> 10</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.13.8.1.3.1.1" width="50%">参数项</th> <th align="left" class="cellrowborder" id="mcps1.3.13.8.1.3.1.2" width="50%">描述</th> </tr><tr><td class="cellrowborder" width="50%">uint64_t interfaceHandle</td> <td class="cellrowborder" width="50%">接口操作句柄，代表要操作的接口。</td> </tr> <tr><td class="cellrowborder" width="50%">uint8_t settingIndex</td> <td class="cellrowborder" width="50%">备用设置索引，对应USB协议中的{@link bAlternateSetting}。</td> </tr>  </tbody></table></div> </div> <p><strong>返回：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.13.10.1.3.1.1" width="50%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.13.10.1.3.1.2" width="50%">说明</th> </tr><tr><td class="cellrowborder" width="50%">int32_t</td> <td class="cellrowborder" width="50%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-types-h#usbddkerrcode">USB_DDK_SUCCESS</a> 调用接口成功。</p> <p> <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-types-h#usbddkerrcode">USB_DDK_NO_PERM</a> 权限检查失败。</p> <p> <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-types-h#usbddkerrcode">USB_DDK_INVALID_OPERATION</a> 连接USB DDK服务失败。</p> <p> <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-types-h#usbddkerrcode">USB_DDK_INVALID_PARAMETER</a> 参数错误。</p> </td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h3 id="oh_usb_getcurrentinterfacesetting" device-type="2in1">OH_Usb_GetCurrentInterfaceSetting()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="oh_usb_getcurrentinterfacesetting" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">PC/2in1</span></div><div _ngcontent-mdq-c106="" class="highlight-div"><div _ngcontent-mdq-c106="" class="highlight-div-header"><div _ngcontent-mdq-c106="" class="highlight-div-header-left"><div _ngcontent-mdq-c106="" class="handle-button expand-button"><div _ngcontent-mdq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mdq-c106="" class="highlight-div-header-right"><div _ngcontent-mdq-c106="" class="handle-button ai-button"></div><div _ngcontent-mdq-c106="" class="handle-button line-button"><div _ngcontent-mdq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mdq-c106="" class="handle-button theme-button"><div _ngcontent-mdq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mdq-c106="" class="handle-button copy-button"><div _ngcontent-mdq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mdq-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-function"><span class="hljs-type">int32_t</span> <span class="hljs-title">OH_Usb_GetCurrentInterfaceSetting</span><span class="hljs-params">(<span class="hljs-type">uint64_t</span> interfaceHandle, <span class="hljs-type">uint8_t</span> *settingIndex)</span></span></li></ol></pre></div></div> <p><strong>描述</strong></p> <p>获取接口当前激活的备用设置。</p> <p><strong>需要权限：</strong> ohos.permission.ACCESS_DDK_USB</p> <p><strong>起始版本：</strong> 10</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.14.8.1.3.1.1" width="50%">参数项</th> <th align="left" class="cellrowborder" id="mcps1.3.14.8.1.3.1.2" width="50%">描述</th> </tr><tr><td class="cellrowborder" width="50%">uint64_t interfaceHandle</td> <td class="cellrowborder" width="50%">接口操作句柄，代表要操作的接口。</td> </tr> <tr><td class="cellrowborder" width="50%">uint8_t *settingIndex</td> <td class="cellrowborder" width="50%">备用设置索引，对应USB协议中的{@link bAlternateSetting}。</td> </tr>  </tbody></table></div> </div> <p><strong>返回：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.14.10.1.3.1.1" width="50%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.14.10.1.3.1.2" width="50%">说明</th> </tr><tr><td class="cellrowborder" width="50%">int32_t</td> <td class="cellrowborder" width="50%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-types-h#usbddkerrcode">USB_DDK_SUCCESS</a> 调用接口成功。</p> <p> <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-types-h#usbddkerrcode">USB_DDK_NO_PERM</a> 权限检查失败。</p> <p> <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-types-h#usbddkerrcode">USB_DDK_INVALID_OPERATION</a> 连接USB DDK服务失败。</p> <p> <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-types-h#usbddkerrcode">USB_DDK_INVALID_PARAMETER</a> 入参settingIndex为空指针。</p> </td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h3 id="oh_usb_sendcontrolreadrequest" device-type="2in1">OH_Usb_SendControlReadRequest()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="oh_usb_sendcontrolreadrequest" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">PC/2in1</span></div><div _ngcontent-mdq-c106="" class="highlight-div"><div _ngcontent-mdq-c106="" class="highlight-div-header"><div _ngcontent-mdq-c106="" class="highlight-div-header-left"><div _ngcontent-mdq-c106="" class="handle-button expand-button"><div _ngcontent-mdq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mdq-c106="" class="highlight-div-header-right"><div _ngcontent-mdq-c106="" class="handle-button ai-button"></div><div _ngcontent-mdq-c106="" class="handle-button line-button"><div _ngcontent-mdq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mdq-c106="" class="handle-button theme-button"><div _ngcontent-mdq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mdq-c106="" class="handle-button copy-button"><div _ngcontent-mdq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mdq-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-function"><span class="hljs-type">int32_t</span> <span class="hljs-title">OH_Usb_SendControlReadRequest</span><span class="hljs-params">(<span class="hljs-type">uint64_t</span> interfaceHandle, <span class="hljs-type">const</span> <span class="hljs-keyword">struct</span> UsbControlRequestSetup *setup,<span class="hljs-type">uint32_t</span> timeout, <span class="hljs-type">uint8_t</span> *data, <span class="hljs-type">uint32_t</span> *dataLen)</span></span></li></ol></pre></div></div> <p><strong>描述</strong></p> <p>发送控制读请求，该接口为同步接口。</p> <p><strong>需要权限：</strong> ohos.permission.ACCESS_DDK_USB</p> <p><strong>起始版本：</strong> 10</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.15.8.1.3.1.1" width="50%">参数项</th> <th align="left" class="cellrowborder" id="mcps1.3.15.8.1.3.1.2" width="50%">描述</th> </tr><tr><td class="cellrowborder" width="50%">uint64_t interfaceHandle</td> <td class="cellrowborder" width="50%">接口操作句柄，代表要操作的接口。</td> </tr> <tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usbddk-usbcontrolrequestsetup">const struct UsbControlRequestSetup</a> *setup</td> <td class="cellrowborder" width="50%">请求相关的参数，详细定义请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usbddk-usbcontrolrequestsetup">UsbControlRequestSetup</a>。</td> </tr> <tr><td class="cellrowborder" width="50%">uint32_t timeout</td> <td class="cellrowborder" width="50%">超时时间，单位为毫秒。</td> </tr> <tr><td class="cellrowborder" width="50%">uint8_t *data</td> <td class="cellrowborder" width="50%">要传输的数据。</td> </tr> <tr><td class="cellrowborder" width="50%">uint32_t *dataLen</td> <td class="cellrowborder" width="50%">表示data的数据长度，在函数返回后，表示实际读取到的数据的长度。</td> </tr>  </tbody></table></div> </div> <p><strong>返回：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.15.10.1.3.1.1" width="50%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.15.10.1.3.1.2" width="50%">说明</th> </tr><tr><td class="cellrowborder" width="50%">int32_t</td> <td class="cellrowborder" width="50%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-types-h#usbddkerrcode">USB_DDK_SUCCESS</a> 调用接口成功。</p> <p> <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-types-h#usbddkerrcode">USB_DDK_FAILED</a> 权限校验失败。</p> <p> <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-types-h#usbddkerrcode">USB_DDK_INVALID_OPERATION</a> 连接USB DDK服务失败。</p> <p> <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-types-h#usbddkerrcode">USB_DDK_INVALID_PARAMETER</a> 入参setup或者data或者dataLen为空指针，或者datalen小于读取到的数据长度。</p> <p> <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-types-h#usbddkerrcode">USB_DDK_MEMORY_ERROR</a> 拷贝读取数据的内存失败。</p> <p> <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-types-h#usbddkerrcode">USB_DDK_IO_FAILED</a> 数据IO异常。</p> <p> <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-types-h#usbddkerrcode">USB_DDK_TIMEOUT</a> 接口调用超时。</p> </td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h3 id="oh_usb_sendcontrolwriterequest" device-type="2in1">OH_Usb_SendControlWriteRequest()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="oh_usb_sendcontrolwriterequest" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">PC/2in1</span></div><div _ngcontent-mdq-c106="" class="highlight-div"><div _ngcontent-mdq-c106="" class="highlight-div-header"><div _ngcontent-mdq-c106="" class="highlight-div-header-left"><div _ngcontent-mdq-c106="" class="handle-button expand-button"><div _ngcontent-mdq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mdq-c106="" class="highlight-div-header-right"><div _ngcontent-mdq-c106="" class="handle-button ai-button"></div><div _ngcontent-mdq-c106="" class="handle-button line-button"><div _ngcontent-mdq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mdq-c106="" class="handle-button theme-button"><div _ngcontent-mdq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mdq-c106="" class="handle-button copy-button"><div _ngcontent-mdq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mdq-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-function"><span class="hljs-type">int32_t</span> <span class="hljs-title">OH_Usb_SendControlWriteRequest</span><span class="hljs-params">(<span class="hljs-type">uint64_t</span> interfaceHandle, <span class="hljs-type">const</span> <span class="hljs-keyword">struct</span> UsbControlRequestSetup *setup,<span class="hljs-type">uint32_t</span> timeout, <span class="hljs-type">const</span> <span class="hljs-type">uint8_t</span> *data, <span class="hljs-type">uint32_t</span> dataLen)</span></span></li></ol></pre></div></div> <p><strong>描述</strong></p> <p>发送控制写请求，该接口为同步接口。</p> <p><strong>需要权限：</strong> ohos.permission.ACCESS_DDK_USB</p> <p><strong>起始版本：</strong> 10</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.16.8.1.3.1.1" width="50%">参数项</th> <th align="left" class="cellrowborder" id="mcps1.3.16.8.1.3.1.2" width="50%">描述</th> </tr><tr><td class="cellrowborder" width="50%">uint64_t interfaceHandle</td> <td class="cellrowborder" width="50%">接口操作句柄，代表要操作的接口。</td> </tr> <tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usbddk-usbcontrolrequestsetup">const struct UsbControlRequestSetup</a> *setup</td> <td class="cellrowborder" width="50%">请求相关的参数，详细定义请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usbddk-usbcontrolrequestsetup">UsbControlRequestSetup</a>。</td> </tr> <tr><td class="cellrowborder" width="50%">uint32_t timeout</td> <td class="cellrowborder" width="50%">超时时间，单位为毫秒。</td> </tr> <tr><td class="cellrowborder" width="50%">const uint8_t *data</td> <td class="cellrowborder" width="50%">要传输的数据。</td> </tr> <tr><td class="cellrowborder" width="50%">uint32_t dataLen</td> <td class="cellrowborder" width="50%">表示data数据长度。</td> </tr>  </tbody></table></div> </div> <p><strong>返回：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.16.10.1.3.1.1" width="50%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.16.10.1.3.1.2" width="50%">说明</th> </tr><tr><td class="cellrowborder" width="50%">int32_t</td> <td class="cellrowborder" width="50%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-types-h#usbddkerrcode">USB_DDK_SUCCESS</a> 调用接口成功。</p> <p> <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-types-h#usbddkerrcode">USB_DDK_FAILED</a> 权限校验失败。</p> <p> <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-types-h#usbddkerrcode">USB_DDK_INVALID_OPERATION</a> 连接USB DDK服务失败。</p> <p> <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-types-h#usbddkerrcode">USB_DDK_INVALID_PARAMETER</a> 入参setup或者data为空指针。</p> <p> <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-types-h#usbddkerrcode">USB_DDK_MEMORY_ERROR</a> 内存拷贝失败。</p> <p> <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-types-h#usbddkerrcode">USB_DDK_IO_FAILED</a> 数据IO异常。</p> <p> <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-types-h#usbddkerrcode">USB_DDK_TIMEOUT</a> 接口调用超时。</p> </td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h3 id="oh_usb_sendpiperequest" device-type="2in1">OH_Usb_SendPipeRequest()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="oh_usb_sendpiperequest" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">PC/2in1</span></div><div _ngcontent-mdq-c106="" class="highlight-div"><div _ngcontent-mdq-c106="" class="highlight-div-header"><div _ngcontent-mdq-c106="" class="highlight-div-header-left"><div _ngcontent-mdq-c106="" class="handle-button expand-button"><div _ngcontent-mdq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mdq-c106="" class="highlight-div-header-right"><div _ngcontent-mdq-c106="" class="handle-button ai-button"></div><div _ngcontent-mdq-c106="" class="handle-button line-button"><div _ngcontent-mdq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mdq-c106="" class="handle-button theme-button"><div _ngcontent-mdq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mdq-c106="" class="handle-button copy-button"><div _ngcontent-mdq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mdq-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-function"><span class="hljs-type">int32_t</span> <span class="hljs-title">OH_Usb_SendPipeRequest</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-keyword">struct</span> UsbRequestPipe *pipe, UsbDeviceMemMap *devMmap)</span></span></li></ol></pre></div></div> <p><strong>描述</strong></p> <p>发送管道请求，该接口为同步接口。中断传输和批量传输都使用该接口发送请求。</p> <p><strong>需要权限：</strong> ohos.permission.ACCESS_DDK_USB</p> <p><strong>起始版本：</strong> 10</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.17.8.1.3.1.1" width="50%">参数项</th> <th align="left" class="cellrowborder" id="mcps1.3.17.8.1.3.1.2" width="50%">描述</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usbddk-usbrequestpipe">const struct UsbRequestPipe</a> *pipe</td> <td class="cellrowborder" width="50%">要传输数据的管道信息。</td> </tr> <tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usbddk-usbdevicememmap">UsbDeviceMemMap</a> *devMmap</td> <td class="cellrowborder" width="50%">数据缓冲区，可以通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-api-h#oh_usb_createdevicememmap">OH_Usb_CreateDeviceMemMap</a>获得。</td> </tr>  </tbody></table></div> </div> <p><strong>返回：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.17.10.1.3.1.1" width="50%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.17.10.1.3.1.2" width="50%">说明</th> </tr><tr><td class="cellrowborder" width="50%">int32_t</td> <td class="cellrowborder" width="50%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-types-h#usbddkerrcode">USB_DDK_SUCCESS</a> 调用接口成功。</p> <p> <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-types-h#usbddkerrcode">USB_DDK_NO_PERM</a> 权限检查失败。</p> <p> <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-types-h#usbddkerrcode">USB_DDK_INVALID_OPERATION</a> 连接USB DDK服务失败。</p> <p> <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-types-h#usbddkerrcode">USB_DDK_INVALID_PARAMETER</a> 入参pipe为空指针或devMmap为空指针或devMmap的地址为空。</p> <p> <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-types-h#usbddkerrcode">USB_DDK_MEMORY_ERROR</a> 读取数据的内存拷贝失败。</p> <p> <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-types-h#usbddkerrcode">USB_DDK_IO_FAILED</a> 数据 IO 异常。</p> <p> <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-types-h#usbddkerrcode">USB_DDK_TIMEOUT</a> 接口超时。</p> </td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h3 id="oh_usb_sendpiperequestwithashmem" device-type="2in1">OH_Usb_SendPipeRequestWithAshmem()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="oh_usb_sendpiperequestwithashmem" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">PC/2in1</span></div><div _ngcontent-mdq-c106="" class="highlight-div"><div _ngcontent-mdq-c106="" class="highlight-div-header"><div _ngcontent-mdq-c106="" class="highlight-div-header-left"><div _ngcontent-mdq-c106="" class="handle-button expand-button"><div _ngcontent-mdq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mdq-c106="" class="highlight-div-header-right"><div _ngcontent-mdq-c106="" class="handle-button ai-button"></div><div _ngcontent-mdq-c106="" class="handle-button line-button"><div _ngcontent-mdq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mdq-c106="" class="handle-button theme-button"><div _ngcontent-mdq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mdq-c106="" class="handle-button copy-button"><div _ngcontent-mdq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mdq-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-function"><span class="hljs-type">int32_t</span> <span class="hljs-title">OH_Usb_SendPipeRequestWithAshmem</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-keyword">struct</span> UsbRequestPipe *pipe, DDK_Ashmem *ashmem)</span></span></li></ol></pre></div></div> <p><strong>描述</strong></p> <p>发送管道请求，该接口为同步接口。中断传输和批量传输都使用该接口发送请求。</p> <p><strong>需要权限：</strong> ohos.permission.ACCESS_DDK_USB</p> <p><strong>起始版本：</strong> 12</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.18.8.1.3.1.1" width="50%">参数项</th> <th align="left" class="cellrowborder" id="mcps1.3.18.8.1.3.1.2" width="50%">描述</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usbddk-usbrequestpipe">const struct UsbRequestPipe</a> *pipe</td> <td class="cellrowborder" width="50%">要传输数据的管道信息。</td> </tr> <tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-baseddk-ddk-ashmem">DDK_Ashmem</a> *ashmem</td> <td class="cellrowborder" width="50%">共享内存，可以通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-ddk-api-h#oh_ddk_createashmem">OH_DDK_CreateAshmem</a>获得。</td> </tr>  </tbody></table></div> </div> <p><strong>返回：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.18.10.1.3.1.1" width="50%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.18.10.1.3.1.2" width="50%">说明</th> </tr><tr><td class="cellrowborder" width="50%">int32_t</td> <td class="cellrowborder" width="50%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-types-h#usbddkerrcode">USB_DDK_SUCCESS</a> 调用接口成功。</p> <p> <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-types-h#usbddkerrcode">USB_DDK_NO_PERM</a> 权限检查失败。</p> <p> <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-types-h#usbddkerrcode">USB_DDK_INVALID_OPERATION</a> 连接USB DDK服务失败。</p> <p> <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-types-h#usbddkerrcode">USB_DDK_INVALID_PARAMETER</a>入参pipe为空指针或ashmem为空指针或ashmem的地址为空。</p> <p> <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-types-h#usbddkerrcode">USB_DDK_MEMORY_ERROR</a> 读取数据的内存拷贝失败。</p> <p> <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-types-h#usbddkerrcode">USB_DDK_IO_FAILED</a> 数据 IO 异常。</p> <p> <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-types-h#usbddkerrcode">USB_DDK_TIMEOUT</a> 接口超时。</p> </td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h3 id="oh_usb_createdevicememmap" device-type="2in1">OH_Usb_CreateDeviceMemMap()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="oh_usb_createdevicememmap" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">PC/2in1</span></div><div _ngcontent-mdq-c106="" class="highlight-div"><div _ngcontent-mdq-c106="" class="highlight-div-header"><div _ngcontent-mdq-c106="" class="highlight-div-header-left"><div _ngcontent-mdq-c106="" class="handle-button expand-button"><div _ngcontent-mdq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mdq-c106="" class="highlight-div-header-right"><div _ngcontent-mdq-c106="" class="handle-button ai-button"></div><div _ngcontent-mdq-c106="" class="handle-button line-button"><div _ngcontent-mdq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mdq-c106="" class="handle-button theme-button"><div _ngcontent-mdq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mdq-c106="" class="handle-button copy-button"><div _ngcontent-mdq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mdq-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-function"><span class="hljs-type">int32_t</span> <span class="hljs-title">OH_Usb_CreateDeviceMemMap</span><span class="hljs-params">(<span class="hljs-type">uint64_t</span> deviceId, <span class="hljs-type">size_t</span> size, UsbDeviceMemMap **devMmap)</span></span></li></ol></pre></div></div> <p><strong>描述</strong></p> <p>创建缓冲区。请在缓冲区使用完后，调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-api-h#oh_usb_destroydevicememmap">OH_Usb_DestroyDeviceMemMap</a>销毁缓冲区，否则会造成资源泄露。</p> <p><strong>需要权限：</strong> ohos.permission.ACCESS_DDK_USB</p> <p><strong>起始版本：</strong> 10</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.19.8.1.3.1.1" width="50%">参数项</th> <th align="left" class="cellrowborder" id="mcps1.3.19.8.1.3.1.2" width="50%">描述</th> </tr><tr><td class="cellrowborder" width="50%">uint64_t deviceId</td> <td class="cellrowborder" width="50%">设备ID，代表要创建缓冲区的设备。</td> </tr> <tr><td class="cellrowborder" width="50%">size_t size</td> <td class="cellrowborder" width="50%">缓冲区的大小。</td> </tr> <tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usbddk-usbdevicememmap">UsbDeviceMemMap</a> **devMmap</td> <td class="cellrowborder" width="50%">创建的缓冲区通过该参数返回给调用者。</td> </tr>  </tbody></table></div> </div> <p><strong>返回：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.19.10.1.3.1.1" width="50%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.19.10.1.3.1.2" width="50%">说明</th> </tr><tr><td class="cellrowborder" width="50%">int32_t</td> <td class="cellrowborder" width="50%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-types-h#usbddkerrcode">USB_DDK_SUCCESS</a>调用接口成功。</p> <p> <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-types-h#usbddkerrcode">USB_DDK_NO_PERM</a> 权限检查失败。</p> <p> <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-types-h#usbddkerrcode">USB_DDK_INVALID_PARAMETER</a> 入参devMmap为空指针。</p> <p> <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-types-h#usbddkerrcode">USB_DDK_MEMORY_ERROR</a> 内存映射失败或devMmap的内存分配失败。</p> </td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h3 id="oh_usb_destroydevicememmap" device-type="2in1">OH_Usb_DestroyDeviceMemMap()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="oh_usb_destroydevicememmap" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">PC/2in1</span></div><div _ngcontent-mdq-c106="" class="highlight-div"><div _ngcontent-mdq-c106="" class="highlight-div-header"><div _ngcontent-mdq-c106="" class="highlight-div-header-left"><div _ngcontent-mdq-c106="" class="handle-button expand-button"><div _ngcontent-mdq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mdq-c106="" class="highlight-div-header-right"><div _ngcontent-mdq-c106="" class="handle-button ai-button"></div><div _ngcontent-mdq-c106="" class="handle-button line-button"><div _ngcontent-mdq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mdq-c106="" class="handle-button theme-button"><div _ngcontent-mdq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mdq-c106="" class="handle-button copy-button"><div _ngcontent-mdq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mdq-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-java" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">void</span> <span class="hljs-title function_">OH_Usb_DestroyDeviceMemMap</span><span class="hljs-params">(UsbDeviceMemMap *devMmap)</span></li></ol></pre></div></div> <p><strong>描述</strong></p> <p>销毁缓冲区。请在缓冲区使用完后及时销毁缓冲区，否则会造成资源泄露。</p> <p><strong>需要权限：</strong> ohos.permission.ACCESS_DDK_USB</p> <p><strong>起始版本：</strong> 10</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.20.8.1.3.1.1" width="50%">参数项</th> <th align="left" class="cellrowborder" id="mcps1.3.20.8.1.3.1.2" width="50%">描述</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usbddk-usbdevicememmap">UsbDeviceMemMap</a> *devMmap</td> <td class="cellrowborder" width="50%">销毁由<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-api-h#oh_usb_createdevicememmap">OH_Usb_CreateDeviceMemMap</a>创建的缓冲区。</td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h3 id="oh_usb_getdevices" device-type="2in1">OH_Usb_GetDevices()<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="oh_usb_getdevices" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">PC/2in1</span></div><div _ngcontent-mdq-c106="" class="highlight-div"><div _ngcontent-mdq-c106="" class="highlight-div-header"><div _ngcontent-mdq-c106="" class="highlight-div-header-left"><div _ngcontent-mdq-c106="" class="handle-button expand-button"><div _ngcontent-mdq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mdq-c106="" class="highlight-div-header-right"><div _ngcontent-mdq-c106="" class="handle-button ai-button"></div><div _ngcontent-mdq-c106="" class="handle-button line-button"><div _ngcontent-mdq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mdq-c106="" class="handle-button theme-button"><div _ngcontent-mdq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mdq-c106="" class="handle-button copy-button"><div _ngcontent-mdq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mdq-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-function"><span class="hljs-type">int32_t</span> <span class="hljs-title">OH_Usb_GetDevices</span><span class="hljs-params">(<span class="hljs-keyword">struct</span> Usb_DeviceArray *devices)</span></span></li></ol></pre></div></div> <p><strong>描述</strong></p> <p>获取USB设备ID列表。请保证传入的指针参数是有效的，申请设备的数量不要超过128个，在使用完结构之后，释放成员内存，否则造成资源泄露。获取到的USB设备ID，已通过驱动配置信息中的vid进行筛选过滤。</p> <p><strong>需要权限：</strong> ohos.permission.ACCESS_DDK_USB</p> <p><strong>起始版本：</strong> 18</p> <p><strong>参数：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.21.8.1.3.1.1" width="50%">参数项</th> <th align="left" class="cellrowborder" id="mcps1.3.21.8.1.3.1.2" width="50%">描述</th> </tr><tr><td class="cellrowborder" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usbddk-usb-devicearray">struct Usb_DeviceArray</a> *devices</td> <td class="cellrowborder" width="50%">已申请好的设备内存地址，用于存放获取到的设备ID列表及数量。</td> </tr>  </tbody></table></div> </div> <p><strong>返回：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="tableClass2_t"> <tbody><tr class="firstRow"><th align="left" class="cellrowborder" id="mcps1.3.21.10.1.3.1.1" width="50%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.21.10.1.3.1.2" width="50%">说明</th> </tr><tr><td class="cellrowborder" width="50%">int32_t</td> <td class="cellrowborder" width="50%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-types-h#usbddkerrcode">USB_DDK_SUCCESS</a> 调用接口成功。</p> <p> <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-types-h#usbddkerrcode">USB_DDK_NO_PERM</a> 权限检查失败。</p> <p> <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-types-h#usbddkerrcode">USB_DDK_INVALID_OPERATION</a> 连接USB DDK服务失败。</p> <p> <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-usb-ddk-types-h#usbddkerrcode">USB_DDK_INVALID_PARAMETER</a> 入参devices为空指针。</p> </td> </tr>  </tbody></table></div> </div> </div> </div> <div></div></div>