<h1 _ngcontent-qeq-c119="" class="doc-title ng-star-inserted" title="一键登录获取华为账号绑定号码和UnionID/OpenID"> 一键登录获取华为账号绑定号码和UnionID/OpenID </h1>

<div _ngcontent-qeq-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content">      <p>为了更安全的网络访问，请务必升级到TLS1.2版本。若使用协议是TLS1.0、TLS1.1或规定外的加密套件，可能无法正常访问华为账号服务。</p>      <p>关于TLS1.2协议及加密套件的信息，可以点击这里进行详细了解：<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/account-api-common#section1329115361128">TLS协议及加密套件</a>。</p>     </div></div></div>    <div class="tiledSection">     <h2 id="section1211262695115">功能介绍<i class="anchor-icon anchor-icon-link" anchorid="section1211262695115" tips="复制节点链接"></i></h2>          <p>通过一键登录场景的Authorization Code获取UnionID，OpenID，华为账号绑定的手机号码及其相关信息。</p>    </div>    <div class="tiledSection">     <h2 id="section460894595119">场景描述<i class="anchor-icon anchor-icon-link" anchorid="section460894595119" tips="复制节点链接"></i></h2>          <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/account-phone-unionid-login" target="_blank">华为账号一键登录（获取手机号和UnionID/OpenID）</a>场景，应用服务端向华为账号服务器调用该接口获取UnionID，OpenID，华为账号绑定的手机号码及其相关信息。该服务仅对中国境内（不包含中国香港、中国澳门、中国台湾）用户提供。</p>    </div>    <div class="tiledSection">     <h2 id="section74906714178">使用约束<i class="anchor-icon anchor-icon-link" anchorid="section74906714178" tips="复制节点链接"></i></h2>          <ul>      <li>需确保调用端网络正常。</li>      <li>华为账号一键登录服务仅对中国境内（不包含中国香港、中国澳门、中国台湾）用户提供；且应用服务端获取华为账号绑定的手机号码时，该服务器必须部署在中国境内（不包含中国香港、中国澳门、中国台湾）。</li>      <li>应用使用华为账号一键登录功能之前，需要完成华为账号一键登录权限申请，详见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/account-config-permissions" target="_blank">申请账号权限</a>。</li>     </ul>    </div>    <div class="tiledSection">     <h2 id="section2520125725115">接口原型<i class="anchor-icon anchor-icon-link" anchorid="section2520125725115" tips="复制节点链接"></i></h2>          <div class="tablenoborder">      <div class="tbBox"><table>               <tbody><tr>         <th class="firstcol" id="mcps1.3.5.2.1.3.1.1" width="18.740000000000002%">          <p><strong>承载协议</strong></p></th>         <td class="cellrowborder" width="81.26%">          <p>HTTPS POST</p></td>        </tr>        <tr>         <th class="firstcol" id="mcps1.3.5.2.1.3.2.1" width="18.740000000000002%">          <p><strong>接口方向</strong></p></th>         <td class="cellrowborder" width="81.26%">          <p><span style="color: rgb(36,39,40);">开发者服务器-</span><span style="color: rgb(36,39,40);">&gt;</span><span style="color: rgb(36,39,40);">华为账号服务器</span></p></td>        </tr>        <tr>         <th class="firstcol" id="mcps1.3.5.2.1.3.3.1" width="18.740000000000002%">          <p><strong>接口URL</strong></p></th>         <td class="cellrowborder" width="81.26%">          <p>https://account-api.cloud.huawei.com/oauth2/v6/quickLogin/getPhoneNumber</p></td>        </tr>        <tr>         <th class="firstcol" id="mcps1.3.5.2.1.3.4.1" width="18.740000000000002%">          <p><strong>数据格式</strong></p></th>         <td class="cellrowborder" width="81.26%">          <p>请求消息：<span style="color: rgb(36,39,40);">Content-Type: application/json</span></p>          <p>响应消息：Content-Type: application/json</p></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="section18490162375211">请求参数<i class="anchor-icon anchor-icon-link" anchorid="section18490162375211" tips="复制节点链接"></i></h2>         </div>    <div class="tiledSection">     <h3 id="section8899419862" class="firsth2">Request Header<i class="anchor-icon anchor-icon-link" anchorid="section8899419862" tips="复制节点链接"></i></h3>          <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.7.2.1.5.1.1" width="20.562056205620564%">          <p>参数</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.7.2.1.5.1.2" width="19.781978197819782%">          <p>是否必选</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.7.2.1.5.1.3" width="22.492249224922492%">          <p>参数类型</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.7.2.1.5.1.4" width="37.163716371637165%">          <p>描述</p></th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20.562056205620564%">          <p>Content-Type</p></td>         <td class="cellrowborder" width="19.781978197819782%">          <p>是</p></td>         <td class="cellrowborder" width="22.492249224922492%">          <p>String</p></td>         <td class="cellrowborder" width="37.163716371637165%">          <p>取值为：<span style="color: rgb(36,39,40);">application/json</span>。</p>          <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">            <p>Request Body传参，请务必遵循此请求头格式，否则可能导致请求失败，具体传参方式可参考<a href="/consumer/cn/doc/harmonyos-references/account-api-get-user-info-quicklogin-by-code#section1888515151299">示例代码</a>。</p>           </div></div></div></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h3 id="section118656231362">Request Body<i class="anchor-icon anchor-icon-link" anchorid="section118656231362" tips="复制节点链接"></i></h3>          <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.8.2.1.5.1.1" width="20.562056205620564%">          <p>参数</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.8.2.1.5.1.2" width="19.781978197819782%">          <p>是否必选</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.8.2.1.5.1.3" width="22.492249224922492%">          <p>参数类型</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.8.2.1.5.1.4" width="37.163716371637165%">          <p>描述</p></th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20.562056205620564%">          <p>code</p></td>         <td class="cellrowborder" width="19.781978197819782%">          <p>是</p></td>         <td class="cellrowborder" width="22.492249224922492%">          <p>String</p></td>         <td class="cellrowborder" width="37.163716371637165%">          <p>通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/account-phone-unionid-login" target="_blank">华为账号一键登录（获取手机号和UnionID/OpenID）</a>场景获取的Authorization Code，详情可参考一键登录<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/account-phone-unionid-login#section834212543125" target="_blank">客户端开发</a>。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20.562056205620564%">          <p>clientId</p></td>         <td class="cellrowborder" width="19.781978197819782%">          <p>是</p></td>         <td class="cellrowborder" width="22.492249224922492%">          <p>String</p></td>         <td class="cellrowborder" width="37.163716371637165%">          <p>在创建应用后，由AppGallery Connect（简称AGC）为应用分配的唯一标识。参数取值详见<a href="https://developer.huawei.com/consumer/cn/doc/app/agc-help-appinfo-0000001100014694" target="_blank">查看应用基本信息</a>中的<strong>OAuth 2.0客户端ID(凭据)-Client ID</strong>参数。</p>          <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">            <p>该参数与获取code参数时的Client ID必须一致，否则会报错（响应消息中resultCode=60180003），如出现此报错，请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/account-client-id" target="_blank">配置Client ID</a>排查处理。</p>           </div></div></div></td>        </tr>        <tr>         <td class="cellrowborder" width="20.562056205620564%">          <p>clientSecret</p></td>         <td class="cellrowborder" width="19.781978197819782%">          <p>是</p></td>         <td class="cellrowborder" width="22.492249224922492%">          <p>String</p></td>         <td class="cellrowborder" width="37.163716371637165%">          <p>在创建应用后，由AppGallery Connect（简称AGC）为应用分配的密钥（Client Secret）。参数取值详见<a href="https://developer.huawei.com/consumer/cn/doc/app/agc-help-appinfo-0000001100014694" target="_blank">查看应用基本信息</a>中的<strong>OAuth 2.0客户端ID(凭据)-Client Secret</strong>参数。</p></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="section191878131473">请求示例<i class="anchor-icon anchor-icon-link" anchorid="section191878131473" tips="复制节点链接"></i></h2>          <p>请通过POST方式调用，示例如下：</p>     <div _ngcontent-qeq-c106="" class="highlight-div"><div _ngcontent-qeq-c106="" class="highlight-div-header"><div _ngcontent-qeq-c106="" class="highlight-div-header-left"><div _ngcontent-qeq-c106="" class="handle-button expand-button"><div _ngcontent-qeq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-qeq-c106="" class="highlight-div-header-right"><div _ngcontent-qeq-c106="" class="handle-button ai-button"></div><div _ngcontent-qeq-c106="" class="handle-button line-button"><div _ngcontent-qeq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-qeq-c106="" class="handle-button theme-button"><div _ngcontent-qeq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-qeq-c106="" class="handle-button copy-button"><div _ngcontent-qeq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-qeq-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-variable">POST</span> /<span class="hljs-variable">oauth2</span>/<span class="hljs-variable">v6</span>/<span class="hljs-variable">quickLogin</span>/<span class="hljs-variable">getPhoneNumber</span> <span class="hljs-variable">HTTP</span>/<span class="hljs-number">1.1</span></li><li><span class="hljs-variable">Host</span>: <span class="hljs-title class_">account</span>-<span class="hljs-title class_">api</span>.<span class="hljs-title class_">cloud</span>.<span class="hljs-title class_">huawei</span>.<span class="hljs-title class_">com</span></li><li><span class="hljs-variable">Content</span>-<span class="hljs-variable">Type</span>: <span class="hljs-title class_">application</span>/<span class="hljs-variable">json</span></li><li>
</li><li>{<span class="hljs-string">"code"</span>:<span class="hljs-string">"</span><i><div class="varname_wrapper"><span class="varname"><span class="hljs-string">&lt;code&gt;</span></span></div></i><span class="hljs-string">"</span>,<span class="hljs-string">"clientId"</span>: <span class="hljs-string">"</span><i><div class="varname_wrapper"><span class="varname"><span class="hljs-string">&lt;clientId&gt;</span></span></div></i><span class="hljs-string">"</span>,<span class="hljs-string">"clientSecret"</span>: <span class="hljs-string">"</span><i><div class="varname_wrapper"><span class="varname"><span class="hljs-string">&lt;clientSecret&gt;</span></span></div></i><span class="hljs-string">"</span>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="section31838013539">响应参数<i class="anchor-icon anchor-icon-link" anchorid="section31838013539" tips="复制节点链接"></i></h2>         </div>    <div class="tiledSection">     <h3 id="section154661090713" class="firsth2">Response Header<i class="anchor-icon anchor-icon-link" anchorid="section154661090713" tips="复制节点链接"></i></h3>          <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.11.2.1.5.1.1" width="20.562056205620564%">          <p>参数</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.11.2.1.5.1.2" width="19.781978197819782%">          <p>是否必选</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.11.2.1.5.1.3" width="22.492249224922492%">          <p>参数类型</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.11.2.1.5.1.4" width="37.163716371637165%">          <p>描述</p></th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20.562056205620564%">          <p>Content-Type</p></td>         <td class="cellrowborder" width="19.781978197819782%">          <p>是</p></td>         <td class="cellrowborder" width="22.492249224922492%">          <p>String</p></td>         <td class="cellrowborder" width="37.163716371637165%">          <p>取值为：application/json。</p></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h3 id="section161781814472">Response Body<i class="anchor-icon anchor-icon-link" anchorid="section161781814472" tips="复制节点链接"></i></h3>          <p>调用成功时，响应消息返回如下：</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.12.3.1.5.1.1" width="20.562056205620564%">          <p><strong>参数</strong></p></th>         <th align="left" class="cellrowborder" id="mcps1.3.12.3.1.5.1.2" width="19.781978197819782%">          <p>是否必选</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.12.3.1.5.1.3" width="22.472247224722473%">          <p>参数类型</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.12.3.1.5.1.4" width="37.18371837183719%">          <p>描述</p></th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20.562056205620564%">          <p>openId</p></td>         <td class="cellrowborder" width="19.781978197819782%">          <p>是</p></td>         <td class="cellrowborder" width="22.472247224722473%">          <p>String</p></td>         <td class="cellrowborder" width="37.18371837183719%">          <p>用户OpenID。具体格式要求请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/account-faq-9" target="_blank">OpenID和UnionID的格式说明</a>。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20.562056205620564%">          <p>unionId</p></td>         <td class="cellrowborder" width="19.781978197819782%">          <p>是</p></td>         <td class="cellrowborder" width="22.472247224722473%">          <p>String</p></td>         <td class="cellrowborder" width="37.18371837183719%">          <p>用户UnionID。具体格式要求请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/account-faq-9" target="_blank">OpenID和UnionID的格式说明</a>。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20.562056205620564%">          <p>phoneNumber</p></td>         <td class="cellrowborder" width="19.781978197819782%">          <p>是</p></td>         <td class="cellrowborder" width="22.472247224722473%">          <p>String</p></td>         <td class="cellrowborder" width="37.18371837183719%">          <p>华为账号绑定号码（含国家码），使用该手机号完成一键登录的功能，详见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/account-phone-unionid-login" target="_blank">华为账号一键登录（获取手机号和UnionID/OpenID）</a>。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20.562056205620564%">          <p>phoneNumberValid</p></td>         <td class="cellrowborder" width="19.781978197819782%">          <p>是</p></td>         <td class="cellrowborder" width="22.472247224722473%">          <p>Integer</p></td>         <td class="cellrowborder" width="37.18371837183719%">          <p>通过一键登录功能获取的华为账号绑定号码的实时有效性。</p>          <p>若发起一键登录时<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/account-api-component-manager#section29582063177">LoginPanelParams</a>的verifyPhoneNumber参数值传递为true，表示华为代为验证手机号有效性，开发者无需关注此返回值；</p>          <p>若verifyPhoneNumber参数值传递为false, 需要根据返回的状态值进行处理。</p>          <ul>           <li>0：在过去90天内，无法证明当前手机号码可以触达用户， 需要进行验证。</li>           <li>1：在过去90天内，当前手机号码被证明可以触达用户，可以直接使用。</li>          </ul></td>        </tr>        <tr>         <td class="cellrowborder" width="20.562056205620564%">          <p>purePhoneNumber</p></td>         <td class="cellrowborder" width="19.781978197819782%">          <p>是</p></td>         <td class="cellrowborder" width="22.472247224722473%">          <p>String</p></td>         <td class="cellrowborder" width="37.18371837183719%">          <p>不带国家码的手机号，此处为phoneNumber去除国际冠码与国际电话区号的形式。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20.562056205620564%">          <p>phoneCountryCode</p></td>         <td class="cellrowborder" width="19.781978197819782%">          <p>是</p></td>         <td class="cellrowborder" width="22.472247224722473%">          <p>String</p></td>         <td class="cellrowborder" width="37.18371837183719%">          <p>purePhoneNumber的国际冠码(00)+国际电话区号。</p></td>        </tr>             </tbody></table></div>     </div>     <p>调用失败时，响应消息返回如下：</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.12.5.1.4.1.1" width="21.27%">          <p>参数</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.12.5.1.4.1.2" width="26.5%">          <p>参数类型</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.12.5.1.4.1.3" width="52.23%">          <p>描述</p></th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="21.27%">          <p>resultCode</p></td>         <td class="cellrowborder" width="26.5%">          <p>int</p></td>         <td class="cellrowborder" width="52.23%">          <p>错误码，详见本章节<a href="/consumer/cn/doc/harmonyos-references/account-api-get-user-info-quicklogin-by-code#section15782984912">错误码</a>。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="21.27%">          <p>resultDesc</p></td>         <td class="cellrowborder" width="26.5%">          <p>String</p></td>         <td class="cellrowborder" width="52.23%">          <p>错误描述信息。</p></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="section2409115094716">响应示例<i class="anchor-icon anchor-icon-link" anchorid="section2409115094716" tips="复制节点链接"></i></h2>         </div>    <div class="tiledSection">     <h3 id="section5981636810" class="firsth2">请求成功时<i class="anchor-icon anchor-icon-link" anchorid="section5981636810" tips="复制节点链接"></i></h3>          <div _ngcontent-qeq-c106="" class="highlight-div"><div _ngcontent-qeq-c106="" class="highlight-div-header"><div _ngcontent-qeq-c106="" class="highlight-div-header-left"><div _ngcontent-qeq-c106="" class="handle-button expand-button"><div _ngcontent-qeq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-qeq-c106="" class="highlight-div-header-right"><div _ngcontent-qeq-c106="" class="handle-button ai-button"></div><div _ngcontent-qeq-c106="" class="handle-button line-button"><div _ngcontent-qeq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-qeq-c106="" class="handle-button theme-button"><div _ngcontent-qeq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-qeq-c106="" class="handle-button copy-button"><div _ngcontent-qeq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-qeq-c106="" class="highlight-scroll-div"><pre class="json prettyprint linenums hljs language-json" data-highlighted="yes"><ol class="linenums"><li>HTTP/<span class="hljs-number">1.1</span> <span class="hljs-number">200</span> OK</li><li>Content-Type<span class="hljs-punctuation">:</span> application/json</li><li>
</li><li><span class="hljs-punctuation">{</span></li><li>    <span class="hljs-attr">"openId"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"MDFAMTAxMDA1MTg1QGFlMzM0OWIyOGY0*****MDRiaNTI5ODAxYTA3MDh*****A4ZTZmNTA2ZTE4ZT*****lmNGVmN2E1ZjY1OTg4NWRiaN2QxMzQy*****TU0YWQ3"</span><span class="hljs-punctuation">,</span></li><li>    <span class="hljs-attr">"unionId"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"MDF9pBd6xxxxA8iaG4ZNPTw*****3fyXzG9WgUcmY8XibBvQ"</span><span class="hljs-punctuation">,</span></li><li>    <span class="hljs-comment">// 华为账号绑定号码，使用该手机号完成一键登录的功能(返回数据实际为明文)</span></li><li>    <span class="hljs-attr">"phoneNumber"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"0086191******08"</span><span class="hljs-punctuation">,</span></li><li>    <span class="hljs-comment">// 通过一键登录功能获取的华为账号绑定号码的实时有效性, 0表示需要进一步验证有效性， 1表示可以直接使用</span></li><li>    <span class="hljs-attr">"phoneNumberValid"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span></li><li>    <span class="hljs-comment">// phoneNumber不带国际冠码与国际电话区号的形式(返回数据实际为明文)</span></li><li>    <span class="hljs-attr">"purePhoneNumber"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"191******08"</span><span class="hljs-punctuation">,</span></li><li>    <span class="hljs-attr">"phoneCountryCode"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"0086"</span></li><li><span class="hljs-punctuation">}</span></li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="section271418571171">请求失败时<i class="anchor-icon anchor-icon-link" anchorid="section271418571171" tips="复制节点链接"></i></h3>          <div _ngcontent-qeq-c106="" class="highlight-div"><div _ngcontent-qeq-c106="" class="highlight-div-header"><div _ngcontent-qeq-c106="" class="highlight-div-header-left"><div _ngcontent-qeq-c106="" class="handle-button expand-button"><div _ngcontent-qeq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-qeq-c106="" class="highlight-div-header-right"><div _ngcontent-qeq-c106="" class="handle-button ai-button"></div><div _ngcontent-qeq-c106="" class="handle-button line-button"><div _ngcontent-qeq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-qeq-c106="" class="handle-button theme-button"><div _ngcontent-qeq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-qeq-c106="" class="handle-button copy-button"><div _ngcontent-qeq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-qeq-c106="" class="highlight-scroll-div"><pre class="json prettyprint linenums hljs language-json" data-highlighted="yes"><ol class="linenums"><li>HTTP/<span class="hljs-number">1.1</span> <span class="hljs-number">200</span> OK</li><li>Content-Type<span class="hljs-punctuation">:</span> application/json</li><li>
</li><li><span class="hljs-punctuation">{</span></li><li>    <span class="hljs-attr">"resultCode"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">60180008</span><span class="hljs-punctuation">,</span></li><li>    <span class="hljs-attr">"resultDesc"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"user or phone number not exist"</span></li><li><span class="hljs-punctuation">}</span></li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="section1888515151299">示例代码<i class="anchor-icon anchor-icon-link" anchorid="section1888515151299" tips="复制节点链接"></i></h2>          <p>Java示例代码如下，运行前需要进行<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/account-api-common#section444143185314">示例代码环境配置</a>：</p>     <div _ngcontent-qeq-c106="" class="highlight-div"><div _ngcontent-qeq-c106="" class="highlight-div-header"><div _ngcontent-qeq-c106="" class="highlight-div-header-left"><div _ngcontent-qeq-c106="" class="handle-button expand-button"><div _ngcontent-qeq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-qeq-c106="" class="highlight-div-header-right"><div _ngcontent-qeq-c106="" class="handle-button ai-button"></div><div _ngcontent-qeq-c106="" class="handle-button line-button"><div _ngcontent-qeq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-qeq-c106="" class="handle-button theme-button"><div _ngcontent-qeq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-qeq-c106="" class="handle-button copy-button"><div _ngcontent-qeq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-qeq-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-java" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> com.alibaba.fastjson2.JSONObject;</li><li><span class="hljs-keyword">import</span> lombok.extern.slf4j.Slf4j;</li><li><span class="hljs-keyword">import</span> org.apache.http.client.methods.HttpPost;</li><li><span class="hljs-keyword">import</span> org.huawei.uniaccount.util.CallUtils;</li><li><span class="hljs-keyword">import</span> java.io.IOException;</li><li><span class="hljs-keyword">import</span> java.util.HashMap;</li><li><span class="hljs-keyword">import</span> java.util.Map;</li><li>
</li><li><span class="hljs-comment">/**</span></li><li><span class="hljs-comment"> * 一键登录获取华为账号绑定号码和OpenID/UnionID</span></li><li><span class="hljs-comment"> */</span></li><li><span class="hljs-meta">@Slf4j</span></li><li><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">GetQuickLoginMobilePhoneByCodeDemo</span> {</li><li>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> IOException {</li><li>        <span class="hljs-comment">// 一键登录获取华为账号绑定号码和OpenID/UnionID的接口URL</span></li><li>        <span class="hljs-type">String</span> <span class="hljs-variable">url</span> <span class="hljs-operator">=</span> <span class="hljs-string">"https://account-api.cloud.huawei.com/oauth2/v6/quickLogin/getPhoneNumber"</span>;</li><li>        <span class="hljs-comment">// 替换为一键登录场景获取到的Authorization Code</span></li><li>        <span class="hljs-type">String</span> <span class="hljs-variable">authorizationCode</span> <span class="hljs-operator">=</span> <span class="hljs-string">"</span><i><div class="varname_wrapper"><span class="varname"><span class="hljs-string">&lt;Authorization Code&gt;</span></span></div></i><span class="hljs-string">"</span>;</li><li>        <span class="hljs-comment">// 替换为一键登录场景获取Authorization Code时使用的Client ID</span></li><li>        <span class="hljs-type">String</span> <span class="hljs-variable">clientId</span> <span class="hljs-operator">=</span> <span class="hljs-string">"</span><i><div class="varname_wrapper"><span class="varname"><span class="hljs-string">&lt;Client ID&gt;</span></span></div></i><span class="hljs-string">"</span>;</li><li>        <span class="hljs-comment">// 替换为Client ID对应Client Secret</span></li><li>        <span class="hljs-type">String</span> <span class="hljs-variable">clientSecret</span> <span class="hljs-operator">=</span> <span class="hljs-string">"</span><i><div class="varname_wrapper"><span class="varname"><span class="hljs-string">&lt;Client Secret&gt;</span></span></div></i><span class="hljs-string">"</span>;</li><li>        <span class="hljs-type">JSONObject</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> getQuickLoginMobile(url, authorizationCode, clientId, clientSecret);</li><li>        <span class="hljs-comment">// 解析获取openId</span></li><li>        <span class="hljs-type">String</span> <span class="hljs-variable">openId</span> <span class="hljs-operator">=</span> result.getString(<span class="hljs-string">"openId"</span>);</li><li>        <span class="hljs-comment">// 解析获取unionId</span></li><li>        <span class="hljs-type">String</span> <span class="hljs-variable">unionId</span> <span class="hljs-operator">=</span> result.getString(<span class="hljs-string">"unionId"</span>);</li><li>        <span class="hljs-comment">// 解析获取phoneNumber</span></li><li>        <span class="hljs-type">String</span> <span class="hljs-variable">phoneNumber</span> <span class="hljs-operator">=</span> result.getString(<span class="hljs-string">"phoneNumber"</span>);</li><li>        <span class="hljs-comment">// 解析获取phoneNumberValid</span></li><li>        <span class="hljs-type">Integer</span> <span class="hljs-variable">phoneNumberValid</span> <span class="hljs-operator">=</span> result.getInteger(<span class="hljs-string">"phoneNumberValid"</span>);</li><li>        <span class="hljs-comment">// 解析获取purePhoneNumber</span></li><li>        <span class="hljs-type">String</span> <span class="hljs-variable">purePhoneNumber</span> <span class="hljs-operator">=</span> result.getString(<span class="hljs-string">"purePhoneNumber"</span>);</li><li>        <span class="hljs-comment">// 解析获取phoneCountryCode</span></li><li>        <span class="hljs-type">String</span> <span class="hljs-variable">phoneCountryCode</span> <span class="hljs-operator">=</span> result.getString(<span class="hljs-string">"phoneCountryCode"</span>);</li><li>    }</li><li>
</li><li>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> JSONObject <span class="hljs-title function_">getQuickLoginMobile</span><span class="hljs-params">(</span></li><li><span class="hljs-params">            String url, String authorizationCode, String clientId, String clientSecret)</span> <span class="hljs-keyword">throws</span> IOException {</li><li>        <span class="hljs-type">HttpPost</span> <span class="hljs-variable">httpPost</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">HttpPost</span>(url);</li><li>        Map&lt;String, Object&gt; reqBody = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();</li><li>        reqBody.put(<span class="hljs-string">"code"</span>, authorizationCode);</li><li>        reqBody.put(<span class="hljs-string">"clientId"</span>, clientId);</li><li>        reqBody.put(<span class="hljs-string">"clientSecret"</span>, clientSecret);</li><li>        httpPost.setEntity(CallUtils.wrapJsonEntity(reqBody));</li><li>        <span class="hljs-comment">// 如需要自定义异常处理请使用api CallUtils#remoteCall(HttpUriRequest, BiFunction&lt;CloseableHttpResponse,String,E&gt;)</span></li><li>        <span class="hljs-keyword">return</span> CallUtils.toJsonObject(CallUtils.remoteCallAccountApi(httpPost));</li><li>    }</li><li>
</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="section15782984912">错误码<i class="anchor-icon anchor-icon-link" anchorid="section15782984912" tips="复制节点链接"></i></h2>          <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.17.2.1.4.1.1" width="19.81%">          <p>HTTP响应码</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.17.2.1.4.1.2" width="35.32%">          <p>描述</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.17.2.1.4.1.3" width="44.87%">          <p>解决方法</p></th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="19.81%">          <p>200</p></td>         <td class="cellrowborder" width="35.32%">          <p>仅表示本次接口调用成功，实际业务处理结果需要通过<strong>Response Body</strong>中的<strong>resultCode（错误码）</strong>进行判断。</p></td>         <td class="cellrowborder" width="44.87%">          <p>-</p></td>        </tr>        <tr>         <td class="cellrowborder" width="19.81%">          <p>403</p></td>         <td class="cellrowborder" width="35.32%">          <p>无权限访问。</p></td>         <td class="cellrowborder" width="44.87%">          <p>请检查调用环境、配置及http请求方式。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="19.81%">          <p>404</p></td>         <td class="cellrowborder" width="35.32%">          <p>找不到服务。</p></td>         <td class="cellrowborder" width="44.87%">          <p>请检查请求URI是否正确。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="19.81%">          <p>405</p></td>         <td class="cellrowborder" width="35.32%">          <p>不支持的http请求method。</p></td>         <td class="cellrowborder" width="44.87%">          <p>请检查http请求method是否与接口说明一致。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="19.81%">          <p>500</p></td>         <td class="cellrowborder" width="35.32%">          <p>服务内部错误。</p></td>         <td class="cellrowborder" width="44.87%">          <p>请通过<a href="https://developer.huawei.com/consumer/cn/support/feedback/#/" target="_blank">在线提单</a>提交问题。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="19.81%">          <p>502</p></td>         <td class="cellrowborder" width="35.32%">          <p>请求连接异常，常见于网络状况不稳定。</p></td>         <td class="cellrowborder" width="44.87%">          <p>建议稍后重试，若仍无法解决，请通过<a href="https://developer.huawei.com/consumer/cn/support/feedback/#/" target="_blank">在线提单</a>提交问题。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="19.81%">          <p>503</p></td>         <td class="cellrowborder" width="35.32%">          <p>系统流控。</p></td>         <td class="cellrowborder" width="44.87%">          <p>触发系统流控，请稍后重试。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="19.81%">          <p>504</p></td>         <td class="cellrowborder" width="35.32%">          <p>请求连接超时，常见于网络状况不稳定。</p></td>         <td class="cellrowborder" width="44.87%">          <p>建议稍后重试，若仍无法解决，请通过<a href="https://developer.huawei.com/consumer/cn/support/feedback/#/" target="_blank">在线提单</a>提交问题。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="19.81%">          <p>590</p></td>         <td class="cellrowborder" width="35.32%">          <p>服务内部错误。</p></td>         <td class="cellrowborder" width="44.87%">          <p>请通过<a href="https://developer.huawei.com/consumer/cn/support/feedback/#/" target="_blank">在线提单</a>提交问题。</p></td>        </tr>             </tbody></table></div>     </div>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.17.3.1.4.1.1" width="21.32%">          <p>错误码</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.17.3.1.4.1.2" width="39.26%">          <p>描述</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.17.3.1.4.1.3" width="39.42%">          <p>解决方法</p></th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="21.32%">          <p>60010002</p></td>         <td class="cellrowborder" width="39.26%">          <p>参数不合法。</p></td>         <td class="cellrowborder" width="39.42%">          <p>请按照错误描述及接口<a href="/consumer/cn/doc/harmonyos-references/account-api-get-user-info-quicklogin-by-code#section118656231362">Request Body</a>参数说明检查入参。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="21.32%">          <p>60010012</p></td>         <td class="cellrowborder" width="39.26%">          <p>code参数不正确。</p></td>         <td class="cellrowborder" width="39.42%">          <p>code参数传值不正确，可能原因：伪造的无效code或code被篡改。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="21.32%">          <p>60010013</p></td>         <td class="cellrowborder" width="39.26%">          <p>clientSecret参数不正确。</p></td>         <td class="cellrowborder" width="39.42%">          <p>clientSecret参数传值不正确，参数取值详见<a href="https://developer.huawei.com/consumer/cn/doc/app/agc-help-appinfo-0000001100014694" target="_blank">查看应用基本信息</a>中的<strong>OAuth 2.0客户端ID(凭据)-Client Secret</strong>参数。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="21.32%">          <p>60180003</p></td>         <td class="cellrowborder" width="39.26%">          <p>code中的client_id和入参不一致。</p></td>         <td class="cellrowborder" width="39.42%">          <p>code参数获取时的clientId与当前接口参数clientId不一致导致，请检查入参client_id是否与<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/account-client-id" target="_blank">配置Client ID</a>中的值一致。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="21.32%">          <p>60180004</p></td>         <td class="cellrowborder" width="39.26%">          <p>code过期，code只有5分钟有效期。</p></td>         <td class="cellrowborder" width="39.42%">          <p>需要重新获取code。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="21.32%">          <p>60180005</p></td>         <td class="cellrowborder" width="39.26%">          <p>code已经被使用过。</p></td>         <td class="cellrowborder" width="39.42%">          <p>code只能用一次，请重新获取code再重试。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="21.32%">          <p>60180006</p></td>         <td class="cellrowborder" width="39.26%">          <p>code授权被取消。</p></td>         <td class="cellrowborder" width="39.42%">          <p>用户取消授权，导致code失效，请重新获取code再重试。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="21.32%">          <p>60180007</p></td>         <td class="cellrowborder" width="39.26%">          <p>code未授权华为账号一键登录权限。</p></td>         <td class="cellrowborder" width="39.42%">          <p>code未授权华为账号一键登录权限，可能原因如下：</p>          <ul>           <li>应用使用华为账号一键登录功能之前，需要完成华为账号一键登录权限申请，详见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/account-config-permissions" target="_blank">申请账号权限</a>。</li>           <li>code参数需通过QuickLoginButtonComponent组件获取，详见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/account-phone-unionid-login#li8130114016451" target="_blank">展示一键登录页面并获取Authorization Code</a>。</li>          </ul></td>        </tr>        <tr>         <td class="cellrowborder" width="21.32%">          <p>60180008</p></td>         <td class="cellrowborder" width="39.26%">          <p>用户无手机号。</p></td>         <td class="cellrowborder" width="39.42%">          <p>用户华为账号未绑定手机号，该异常场景应用需要展示其他登录方式。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="21.32%">          <p>60180009</p></td>         <td class="cellrowborder" width="39.26%">          <p>手机号信息获取受限。</p></td>         <td class="cellrowborder" width="39.42%">          <ul>           <li>华为账号一键登录服务仅对中国境内（不包含中国香港、中国澳门、中国台湾）用户提供。</li>           <li>应用服务端获取华为账号绑定号码时，该服务器必须部署在中国境内（不包含中国香港、中国澳门、中国台湾）。</li>          </ul></td>        </tr>        <tr>         <td class="cellrowborder" width="21.32%">          <p>60010001</p></td>         <td class="cellrowborder" width="39.26%">          <p>系统内部错误。</p></td>         <td class="cellrowborder" width="39.42%">          <p>请稍后重试，若仍无法解决，请通过<a href="https://developer.huawei.com/consumer/cn/support/feedback/#/" target="_blank">在线提单</a>提交问题。</p></td>        </tr>             </tbody></table></div>     </div>    </div>   </div>   <div></div></div>