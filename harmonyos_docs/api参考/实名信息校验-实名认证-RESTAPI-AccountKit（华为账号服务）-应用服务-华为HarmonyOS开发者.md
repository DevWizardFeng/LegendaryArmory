<h1 _ngcontent-thf-c119="" class="doc-title ng-star-inserted" title="实名信息校验"> 实名信息校验 </h1>

<div _ngcontent-thf-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div><div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content"><p>为了更安全的网络访问，请务必升级到TLS1.2版本。若使用协议是TLS1.0、TLS1.1或规定外的加密套件，可能无法正常访问华为账号服务。</p> <p>关于TLS1.2协议及加密套件的信息，可以点击这里进行详细了解：<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/account-api-common#section1329115361128">TLS协议及加密套件</a>。</p> </div></div></div> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p>该接口目前暂停开放。</p> </div></div></div> <div class="tiledSection"><h2 id="section1211262695115">功能介绍<i class="anchor-icon anchor-icon-link" anchorid="section1211262695115" tips="复制节点链接"></i></h2><p>应用服务端向华为账号服务器调用该接口用于校验实名信息和华为账号实名信息是否一致。</p> </div> <div class="tiledSection"><h2 id="section460894595119">场景描述<i class="anchor-icon anchor-icon-link" anchorid="section460894595119" tips="复制节点链接"></i></h2><p>应用已经通过授权码（Authorization Code）获取到Access Token，并且已申请账号开放信息对应权限后，将用户填写的实名信息与华为账号实名信息进行校验，并获取用户实名信息校验结果。</p> </div> <div class="tiledSection"><h2 id="section74906714178">使用约束<i class="anchor-icon anchor-icon-link" anchorid="section74906714178" tips="复制节点链接"></i></h2><p>该接口目前暂停开放。</p> </div> <div class="tiledSection"><h2 id="section2520125725115">接口原型<i class="anchor-icon anchor-icon-link" anchorid="section2520125725115" tips="复制节点链接"></i></h2> <div class="tablenoborder"><div class="tbBox"><table><tbody><tr><th class="firstcol" id="mcps1.3.6.2.1.3.1.1" width="18.740000000000002%"><p><strong>承载协议</strong></p> </th> <td class="cellrowborder" width="81.26%"><p>HTTPS POST</p> </td> </tr> <tr><th class="firstcol" id="mcps1.3.6.2.1.3.2.1" width="18.740000000000002%"><p><strong>接口方向</strong></p> </th> <td class="cellrowborder" width="81.26%"><p><span style="color: rgb(36,39,40);">开发者服务器-</span><span style="color: rgb(36,39,40);">&gt;</span><span style="color: rgb(36,39,40);">华为账号服务器</span></p> </td> </tr> <tr><th class="firstcol" id="mcps1.3.6.2.1.3.3.1" width="18.740000000000002%"><p><strong>接口URL</strong></p> </th> <td class="cellrowborder" width="81.26%"><p>https://openrealname.cloud.huawei.com/rest.php?nsp_svc=OpenRealName.User.verifyRealName</p> </td> </tr> <tr><th class="firstcol" id="mcps1.3.6.2.1.3.4.1" width="18.740000000000002%"><p><strong>数据格式</strong></p> </th> <td class="cellrowborder" width="81.26%"><p>请求消息：<span style="color: rgb(36,39,40);">Content-Type: application/x-www-form-urlencoded</span></p> <p>响应消息：Content-Type: application/json;charset=utf-8</p> </td> </tr>  </tbody></table></div> </div> </div> <div class="tiledSection"><h2 id="section18490162375211">请求参数<i class="anchor-icon anchor-icon-link" anchorid="section18490162375211" tips="复制节点链接"></i></h2></div> <div class="tiledSection"><h3 id="section476016355486" class="firsth2">Request Header<i class="anchor-icon anchor-icon-link" anchorid="section476016355486" tips="复制节点链接"></i></h3> <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.8.2.1.5.1.1" width="20.562056205620564%"><p>参数</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.8.2.1.5.1.2" width="19.781978197819782%"><p>是否必选</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.8.2.1.5.1.3" width="22.492249224922492%"><p>参数类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.8.2.1.5.1.4" width="37.163716371637165%"><p>描述</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="20.562056205620564%"><p>Content-Type</p> </td> <td class="cellrowborder" width="19.781978197819782%"><p>是</p> </td> <td class="cellrowborder" width="22.492249224922492%"><p>String</p> </td> <td class="cellrowborder" width="37.163716371637165%"><p>取值为：application/x-www-form-urlencoded。</p> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p>Request Body传参，请务必遵循此请求头格式，否则可能导致请求失败，具体传参方式可参考<a href="/consumer/cn/doc/harmonyos-references/account-api-verify-realname#section1888515151299">示例代码</a>。</p> </div></div></div> </td> </tr>  </tbody></table></div> </div> </div> <div class="tiledSection"><h3 id="section513652310485">Request Body<i class="anchor-icon anchor-icon-link" anchorid="section513652310485" tips="复制节点链接"></i></h3> <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.9.2.1.5.1.1" width="20.562056205620564%"><p>参数</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.9.2.1.5.1.2" width="19.781978197819782%"><p>是否必选</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.9.2.1.5.1.3" width="22.492249224922492%"><p>参数类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.9.2.1.5.1.4" width="37.163716371637165%"><p>描述</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="20.562056205620564%"><p>access_token</p> </td> <td class="cellrowborder" width="19.781978197819782%"><p>是</p> </td> <td class="cellrowborder" width="22.492249224922492%"><p>String</p> </td> <td class="cellrowborder" width="37.163716371637165%"><p>通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/account-api-obtain-user-token">获取用户级凭证</a>获取的Access Token。</p> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p>本场景下Access Token只能使用一次，再次使用会报“access forbidden”错误。</p> </div></div></div> </td> </tr> <tr><td class="cellrowborder" width="20.562056205620564%"><p>sceneID</p> </td> <td class="cellrowborder" width="19.781978197819782%"><p>是</p> </td> <td class="cellrowborder" width="22.492249224922492%"><p>Integer</p> </td> <td class="cellrowborder" width="37.163716371637165%"><p>调用场景</p> <ul><li>0：使用华为账号实名信息验证姓名、证件类型、证件号场景</li><li>1：使用华为账号实名信息验证姓名、证件类型、证件号、人脸场景</li><li>2：使用华为账号实名信息验证人脸场景</li></ul> </td> </tr> <tr><td class="cellrowborder" width="20.562056205620564%"><p>idType</p> </td> <td class="cellrowborder" width="19.781978197819782%"><p>是</p> </td> <td class="cellrowborder" width="22.492249224922492%"><p>Integer</p> </td> <td class="cellrowborder" width="37.163716371637165%"><p>ID类型枚举对象</p> <ul><li>1：UserID类型</li><li>2：OpenID类型</li><li>3：UnionID类型</li></ul> </td> </tr> <tr><td class="cellrowborder" width="20.562056205620564%"><p>idValue</p> </td> <td class="cellrowborder" width="19.781978197819782%"><p>是</p> </td> <td class="cellrowborder" width="22.492249224922492%"><p>String</p> </td> <td class="cellrowborder" width="37.163716371637165%"><p>ID实际值，值类型通过idType属性定义，如传用户的UnionID、OpenID值。</p> </td> </tr> <tr><td class="cellrowborder" width="20.562056205620564%"><p>ctfType</p> </td> <td class="cellrowborder" width="19.781978197819782%"><p>否</p> </td> <td class="cellrowborder" width="22.492249224922492%"><p>Integer</p> </td> <td class="cellrowborder" width="37.163716371637165%"><p>证件类型</p> <ul><li>1：身份证（sceneID调用场景为0或1时需传）</li></ul> </td> </tr> <tr><td class="cellrowborder" width="20.562056205620564%"><p>realName</p> </td> <td class="cellrowborder" width="19.781978197819782%"><p>否</p> </td> <td class="cellrowborder" width="22.492249224922492%"><p>String</p> </td> <td class="cellrowborder" width="37.163716371637165%"><p>待校验实名信息中的姓名，需使用SHA-512算法进行HASH后传入（sceneID调用场景为0或1时需传）</p> </td> </tr> <tr><td class="cellrowborder" width="20.562056205620564%"><p>ctfCode</p> </td> <td class="cellrowborder" width="19.781978197819782%"><p>否</p> </td> <td class="cellrowborder" width="22.492249224922492%"><p>String</p> </td> <td class="cellrowborder" width="37.163716371637165%"><p>待校验实名信息中的身份证号（若尾号为x，需统一转成大写X后校验），需使用SHA-512算法进行HASH后传入（sceneID调用场景为0或1时需传）</p> </td> </tr> <tr><td class="cellrowborder" width="20.562056205620564%"><p>supportAlg</p> </td> <td class="cellrowborder" width="19.781978197819782%"><p>是</p> </td> <td class="cellrowborder" width="22.492249224922492%"><p>String</p> </td> <td class="cellrowborder" width="37.163716371637165%"><p>指定返回的verifyToken的签名算法类型。</p> <ul><li>RS256</li><li>PS256</li><li>ES256</li></ul> </td> </tr>  </tbody></table></div> </div> </div> <div class="tiledSection"><h2 id="section191878131473">请求示例<i class="anchor-icon anchor-icon-link" anchorid="section191878131473" tips="复制节点链接"></i></h2><p>请通过POST方式调用，示例如下：</p> <div _ngcontent-thf-c106="" class="highlight-div"><div _ngcontent-thf-c106="" class="highlight-div-header"><div _ngcontent-thf-c106="" class="highlight-div-header-left"><div _ngcontent-thf-c106="" class="handle-button expand-button"><div _ngcontent-thf-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-thf-c106="" class="highlight-div-header-right"><div _ngcontent-thf-c106="" class="handle-button ai-button"></div><div _ngcontent-thf-c106="" class="handle-button line-button"><div _ngcontent-thf-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-thf-c106="" class="handle-button theme-button"><div _ngcontent-thf-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-thf-c106="" class="handle-button copy-button"><div _ngcontent-thf-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-thf-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-variable">POST</span> /<span class="hljs-variable">rest</span>.<span class="hljs-variable">php</span>?<span class="hljs-variable">nsp_svc</span>=<span class="hljs-variable">OpenRealName</span>.<span class="hljs-variable">User</span>.<span class="hljs-variable">verifyRealName</span> <span class="hljs-variable">HTTP</span>/<span class="hljs-number">1.1</span></li><li><span class="hljs-variable">Host</span>: <span class="hljs-title class_">openrealname</span>.<span class="hljs-title class_">cloud</span>.<span class="hljs-title class_">huawei</span>.<span class="hljs-title class_">com</span></li><li><span class="hljs-variable">Content</span>-<span class="hljs-variable">Type</span>: <span class="hljs-title class_">application</span>/<span class="hljs-variable">x</span>-<span class="hljs-variable">www</span>-<span class="hljs-variable">form</span>-<span class="hljs-variable">urlencoded</span></li><li>
</li><li><span class="hljs-variable">access_token</span>=<i><div class="varname_wrapper"><span class="varname">&lt;<span class="hljs-title class_">access_token</span>&gt;</span></div></i>&amp;<span class="hljs-variable">sceneID</span>=<span class="hljs-number">1</span>&amp;<span class="hljs-variable">ctfType</span>=<span class="hljs-number">1</span>&amp;<span class="hljs-variable">realName</span>=<i><div class="varname_wrapper"><span class="varname">&lt;<span class="hljs-title class_">realName</span>&gt;</span></div></i>&amp;<span class="hljs-variable">ctfCode</span>=<i><div class="varname_wrapper"><span class="varname">&lt;<span class="hljs-title class_">ctfCode</span>&gt;</span></div></i>&amp;<span class="hljs-variable">idType</span>=<span class="hljs-number">2</span>&amp;<span class="hljs-variable">idValue</span>=<i><div class="varname_wrapper"><span class="varname">&lt;<span class="hljs-title class_">idValue</span>&gt;</span></div></i>&amp;<span class="hljs-variable">supportAlg</span>=<span class="hljs-variable">RS256</span></li></ol></pre></div></div> </div> <div class="tiledSection"><h2 id="section31838013539">响应参数<i class="anchor-icon anchor-icon-link" anchorid="section31838013539" tips="复制节点链接"></i></h2></div> <div class="tiledSection"><h3 id="section159041010154814" class="firsth2">Response Header<i class="anchor-icon anchor-icon-link" anchorid="section159041010154814" tips="复制节点链接"></i></h3> <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.12.2.1.5.1.1" width="20.562056205620564%"><p>参数</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.12.2.1.5.1.2" width="19.781978197819782%"><p>是否必选</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.12.2.1.5.1.3" width="22.492249224922492%"><p>参数类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.12.2.1.5.1.4" width="37.163716371637165%"><p>描述</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="20.562056205620564%"><p>Content-Type</p> </td> <td class="cellrowborder" width="19.781978197819782%"><p>是</p> </td> <td class="cellrowborder" width="22.492249224922492%"><p>String</p> </td> <td class="cellrowborder" width="37.163716371637165%"><p>取值为：application/json;charset=utf-8。</p> </td> </tr>  </tbody></table></div> </div> </div> <div class="tiledSection"><h3 id="section1975215344810">Response Body<i class="anchor-icon anchor-icon-link" anchorid="section1975215344810" tips="复制节点链接"></i></h3><p>调用成功时，响应消息体返回如下：</p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.13.3.1.5.1.1" width="20.562056205620564%"><p><strong>参数</strong></p> </th> <th align="left" class="cellrowborder" id="mcps1.3.13.3.1.5.1.2" width="19.781978197819782%"><p>是否必选</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.13.3.1.5.1.3" width="22.492249224922492%"><p>参数类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.13.3.1.5.1.4" width="37.163716371637165%"><p>描述</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="20.562056205620564%"><p>state</p> </td> <td class="cellrowborder" width="19.781978197819782%"><p>是</p> </td> <td class="cellrowborder" width="22.492249224922492%"><p>Integer</p> </td> <td class="cellrowborder" width="37.163716371637165%"><p>实名状态</p> <ul><li>0：未认证</li><li>1：已认证</li><li>2： 认证中</li></ul> </td> </tr> <tr><td class="cellrowborder" width="20.562056205620564%"><p>realNameLevel</p> </td> <td class="cellrowborder" width="19.781978197819782%"><p>否</p> </td> <td class="cellrowborder" width="22.492249224922492%"><p>Integer</p> </td> <td class="cellrowborder" width="37.163716371637165%"><p>实名认证等级</p> <ul><li>20：验证填写的姓名证件号实名</li><li>30：验证证件照片实名</li><li>35：验证过银行卡实名</li><li>40：验证人脸实名</li></ul> </td> </tr> <tr><td class="cellrowborder" width="20.562056205620564%"><p>verifyResult</p> </td> <td class="cellrowborder" width="19.781978197819782%"><p>否</p> </td> <td class="cellrowborder" width="22.492249224922492%"><p>Integer</p> </td> <td class="cellrowborder" width="37.163716371637165%"><p>实名一致性校验结果</p> <ul><li>0：校验一致</li><li>1：姓名不匹配</li><li>2：姓名与证件号码不匹配</li></ul> </td> </tr> <tr><td class="cellrowborder" width="20.562056205620564%"><p>verifyToken</p> </td> <td class="cellrowborder" width="19.781978197819782%"><p>否</p> </td> <td class="cellrowborder" width="22.492249224922492%"><p>String</p> </td> <td class="cellrowborder" width="37.163716371637165%"><p>验证通过后返回的Token，JWT格式的数据</p> </td> </tr>  </tbody></table></div> </div> <p>调用失败时，响应消息体返回如下：</p>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.13.5.1.5.1.1" width="19.67%"><p>参数</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.13.5.1.5.1.2" width="16.39%"><p>参数位置</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.13.5.1.5.1.3" width="15.64%"><p>参数类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.13.5.1.5.1.4" width="48.3%"><p>描述</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="19.67%"><p>NSP_STATUS</p> </td> <td class="cellrowborder" width="16.39%"><p>header</p> </td> <td class="cellrowborder" width="15.64%"><p>String</p> </td> <td class="cellrowborder" width="48.3%"><p>错误码，详见本章节<a href="/consumer/cn/doc/harmonyos-references/account-api-verify-realname#section15782984912">错误码</a>。</p> </td> </tr> <tr><td class="cellrowborder" width="19.67%"><p>error</p> </td> <td class="cellrowborder" width="16.39%"><p>body</p> </td> <td class="cellrowborder" width="15.64%"><p>String</p> </td> <td class="cellrowborder" width="48.3%"><p>错误描述信息。</p> </td> </tr>  </tbody></table></div> </div> </div> <div class="tiledSection"><h2 id="section2409115094716">响应示例<i class="anchor-icon anchor-icon-link" anchorid="section2409115094716" tips="复制节点链接"></i></h2></div> <div class="tiledSection"><h3 id="section19160115214716" class="firsth2">请求成功时<i class="anchor-icon anchor-icon-link" anchorid="section19160115214716" tips="复制节点链接"></i></h3><div _ngcontent-thf-c106="" class="highlight-div"><div _ngcontent-thf-c106="" class="highlight-div-header"><div _ngcontent-thf-c106="" class="highlight-div-header-left"><div _ngcontent-thf-c106="" class="handle-button expand-button"><div _ngcontent-thf-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-thf-c106="" class="highlight-div-header-right"><div _ngcontent-thf-c106="" class="handle-button ai-button"></div><div _ngcontent-thf-c106="" class="handle-button line-button"><div _ngcontent-thf-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-thf-c106="" class="handle-button theme-button"><div _ngcontent-thf-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-thf-c106="" class="handle-button copy-button"><div _ngcontent-thf-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-thf-c106="" class="highlight-scroll-div"><pre class="json prettyprint linenums hljs language-json" data-highlighted="yes"><ol class="linenums"><li>HTTP/<span class="hljs-number">1.1</span> <span class="hljs-number">200</span> OK</li><li>Content-Type<span class="hljs-punctuation">:</span> application/json;charset=utf<span class="hljs-number">-8</span></li><li>
</li><li><span class="hljs-punctuation">{</span></li><li>    <span class="hljs-attr">"state"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span></li><li>    <span class="hljs-attr">"verifyResult"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span></li><li>    <span class="hljs-attr">"realNameLevel"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">20</span><span class="hljs-punctuation">,</span></li><li>    <span class="hljs-attr">"verifyToken"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"eyJraWQ****Aad-dw"</span></li><li><span class="hljs-punctuation">}</span></li></ol></pre></div></div> </div> <div class="tiledSection"><h3 id="section79925331473">请求失败时<i class="anchor-icon anchor-icon-link" anchorid="section79925331473" tips="复制节点链接"></i></h3></div> <div _ngcontent-thf-c106="" class="highlight-div"><div _ngcontent-thf-c106="" class="highlight-div-header"><div _ngcontent-thf-c106="" class="highlight-div-header-left"><div _ngcontent-thf-c106="" class="handle-button expand-button"><div _ngcontent-thf-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-thf-c106="" class="highlight-div-header-right"><div _ngcontent-thf-c106="" class="handle-button ai-button"></div><div _ngcontent-thf-c106="" class="handle-button line-button"><div _ngcontent-thf-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-thf-c106="" class="handle-button theme-button"><div _ngcontent-thf-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-thf-c106="" class="handle-button copy-button"><div _ngcontent-thf-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-thf-c106="" class="highlight-scroll-div"><pre class="json prettyprint linenums hljs language-json" data-highlighted="yes"><ol class="linenums"><li>HTTP/<span class="hljs-number">1.1</span> <span class="hljs-number">200</span> OK</li><li>Content-Type<span class="hljs-punctuation">:</span> application/json;charset=utf<span class="hljs-number">-8</span></li><li><strong>NSP_STATUS<span class="hljs-punctuation">:</span> <span class="hljs-number">6</span></strong></li><li>
</li><li><span class="hljs-punctuation">{</span></li><li>    <span class="hljs-attr">"error"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"session timeout"</span></li><li><span class="hljs-punctuation">}</span></li></ol></pre></div></div> <div class="tiledSection"><h2 id="section1888515151299">示例代码<i class="anchor-icon anchor-icon-link" anchorid="section1888515151299" tips="复制节点链接"></i></h2><p>Java示例代码如下，运行前需要进行<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/account-api-common#section444143185314">示例代码环境配置</a>：</p> <div _ngcontent-thf-c106="" class="highlight-div"><div _ngcontent-thf-c106="" class="highlight-div-header"><div _ngcontent-thf-c106="" class="highlight-div-header-left"><div _ngcontent-thf-c106="" class="handle-button expand-button"><div _ngcontent-thf-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-thf-c106="" class="highlight-div-header-right"><div _ngcontent-thf-c106="" class="handle-button ai-button"></div><div _ngcontent-thf-c106="" class="handle-button line-button"><div _ngcontent-thf-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-thf-c106="" class="handle-button theme-button"><div _ngcontent-thf-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-thf-c106="" class="handle-button copy-button"><div _ngcontent-thf-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-thf-c106="" class="highlight-scroll-div"><pre class="java prettyprint linenums hljs language-java" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> com.alibaba.fastjson2.JSONObject;</li><li><span class="hljs-keyword">import</span> lombok.extern.slf4j.Slf4j;</li><li><span class="hljs-keyword">import</span> org.apache.http.NameValuePair;</li><li><span class="hljs-keyword">import</span> org.apache.http.client.entity.UrlEncodedFormEntity;</li><li><span class="hljs-keyword">import</span> org.apache.http.client.methods.HttpPost;</li><li><span class="hljs-keyword">import</span> org.apache.http.message.BasicNameValuePair;</li><li><span class="hljs-keyword">import</span> org.huawei.uniaccount.util.CallUtils;</li><li><span class="hljs-keyword">import</span> javax.xml.bind.annotation.adapters.HexBinaryAdapter;</li><li><span class="hljs-keyword">import</span> java.io.IOException;</li><li><span class="hljs-keyword">import</span> java.nio.charset.StandardCharsets;</li><li><span class="hljs-keyword">import</span> java.security.MessageDigest;</li><li><span class="hljs-keyword">import</span> java.security.NoSuchAlgorithmException;</li><li><span class="hljs-keyword">import</span> java.util.ArrayList;</li><li><span class="hljs-keyword">import</span> java.util.List;</li><li><span class="hljs-keyword">import</span> java.util.Locale;</li><li>
</li><li><span class="hljs-comment">/**</span></li><li><span class="hljs-comment"> * 实名信息校验</span></li><li><span class="hljs-comment"> */</span></li><li><span class="hljs-meta">@Slf4j</span></li><li><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">VerifyRealNameDemo</span> {</li><li>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> IOException {</li><li>        <span class="hljs-comment">// 实名信息校验的接口URL</span></li><li>        <span class="hljs-type">String</span> <span class="hljs-variable">url</span> <span class="hljs-operator">=</span> <span class="hljs-string">"https://openrealname.cloud.huawei.com/rest.php?nsp_svc=OpenRealName.User.verifyRealName"</span>;</li><li>        <span class="hljs-comment">// 替换为您获取的Access Token</span></li><li>        <span class="hljs-type">String</span> <span class="hljs-variable">accessToken</span> <span class="hljs-operator">=</span> <span class="hljs-string">"</span><i><div class="varname_wrapper"><span class="varname"><span><span class="hljs-string">&lt;</span></span><span><span class="hljs-string">Access Token</span></span><span><span class="hljs-string">&gt;</span></span></span></div></i><span class="hljs-string">"</span>;</li><li>        <span class="hljs-comment">// 替换为您需要校验的实名信息中的姓名</span></li><li>        <span class="hljs-type">String</span> <span class="hljs-variable">realName</span> <span class="hljs-operator">=</span> <span class="hljs-string">"</span><i><div class="varname_wrapper"><span class="varname"><span><span class="hljs-string">&lt;</span></span><span><span class="hljs-string">realName</span></span><span><span class="hljs-string">&gt;</span></span></span></div></i><span class="hljs-string">"</span>;</li><li>        <span class="hljs-comment">// 替换为您需要校验的实名信息中的身份证号</span></li><li>        <span class="hljs-type">String</span> <span class="hljs-variable">ctfCode</span> <span class="hljs-operator">=</span> <span class="hljs-string">"</span><i><div class="varname_wrapper"><span class="varname"><span class="hljs-string">&lt;ctfCode&gt;</span></span></div></i><span class="hljs-string">"</span>;</li><li>        <span class="hljs-type">JSONObject</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> verifyRealName(url, accessToken, realName, ctfCode);</li><li>        <span class="hljs-comment">// 解析获取state</span></li><li>        <span class="hljs-type">Integer</span> <span class="hljs-variable">state</span> <span class="hljs-operator">=</span> result.getInteger(<span class="hljs-string">"state"</span>);</li><li>        <span class="hljs-comment">// 解析获取realNameLevel</span></li><li>        <span class="hljs-type">Integer</span> <span class="hljs-variable">realNameLevel</span> <span class="hljs-operator">=</span> result.getInteger(<span class="hljs-string">"realNameLevel"</span>);</li><li>        <span class="hljs-comment">// 解析获取verifyResult</span></li><li>        <span class="hljs-type">Integer</span> <span class="hljs-variable">verifyResult</span> <span class="hljs-operator">=</span> result.getInteger(<span class="hljs-string">"verifyResult"</span>);</li><li>        <span class="hljs-comment">// 解析获取verifyToken</span></li><li>        <span class="hljs-type">String</span> <span class="hljs-variable">verifyToken</span> <span class="hljs-operator">=</span> result.getString(<span class="hljs-string">"verifyToken"</span>);</li><li>    }</li><li>
</li><li>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> JSONObject <span class="hljs-title function_">verifyRealName</span> <span class="hljs-params">(String url, String accessToken, String realName, String ctfCode)</span> <span class="hljs-keyword">throws</span> IOException {</li><li>        <span class="hljs-type">HttpPost</span> <span class="hljs-variable">httpPost</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">HttpPost</span>(url);</li><li>        List&lt;NameValuePair&gt; request = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();</li><li>        request.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">BasicNameValuePair</span>(<span class="hljs-string">"access_token"</span>, accessToken));</li><li>        <span class="hljs-comment">// 请根据实际情况调整sceneID的值</span></li><li>        request.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">BasicNameValuePair</span>(<span class="hljs-string">"sceneID"</span>, <span class="hljs-string">"</span><i><div class="varname_wrapper"><span class="varname"><span class="hljs-string">&lt;sceneID&gt;</span></span></div></i><span class="hljs-string">"</span>));</li><li>        <span class="hljs-comment">// 请根据实际情况调整idType的值</span></li><li>        request.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">BasicNameValuePair</span>(<span class="hljs-string">"idType"</span>, <span class="hljs-string">"</span><i><div class="varname_wrapper"><span class="varname"><span class="hljs-string">&lt;idType&gt;</span></span></div></i><span class="hljs-string">"</span>));</li><li>        <span class="hljs-comment">// 请根据实际情况调整idValue的值</span></li><li>        request.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">BasicNameValuePair</span>(<span class="hljs-string">"idValue"</span>, <span class="hljs-string">"</span><i><div class="varname_wrapper"><span class="varname"><span class="hljs-string">&lt;idValue&gt;</span></span></div></i><span class="hljs-string">"</span>));</li><li>        <span class="hljs-comment">// 请根据实际情况调整ctfType的值</span></li><li>        request.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">BasicNameValuePair</span>(<span class="hljs-string">"ctfType"</span>, <span class="hljs-string">"</span><i><div class="varname_wrapper"><span class="varname"><span class="hljs-string">&lt;ctfType&gt;</span></span></div></i><span class="hljs-string">"</span>));</li><li>        request.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">BasicNameValuePair</span>(<span class="hljs-string">"realName"</span>, encryptBySHA512(&lt;realName&gt;)));</li><li>        request.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">BasicNameValuePair</span>(<span class="hljs-string">"ctfCode"</span>, encryptBySHA512(ctfCode.toLowerCase(Locale.US))));</li><li>        <span class="hljs-comment">// 请根据实际情况调整supportAlg的值</span></li><li>        request.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">BasicNameValuePair</span>(<span class="hljs-string">"supportAlg"</span>, <span class="hljs-string">"</span><i><div class="varname_wrapper"><span class="varname"><span><span class="hljs-string">PS256</span></span></span></div></i><span class="hljs-string">"</span>));</li><li>        httpPost.setEntity(<span class="hljs-keyword">new</span> <span class="hljs-title class_">UrlEncodedFormEntity</span>(request));</li><li>        <span class="hljs-comment">// 使用默认异常处理逻辑，自定义异常处理请使用api CallUtils#remoteCall(HttpUriRequest, BiFunction&lt;CloseableHttpResponse,String,E&gt;)</span></li><li>        <span class="hljs-keyword">return</span> CallUtils.toJsonObject(CallUtils.remoteCall(httpPost));</li><li>    }</li><li>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">encryptBySHA512</span><span class="hljs-params">(String str)</span> {</li><li>        <span class="hljs-keyword">try</span> {</li><li>            <span class="hljs-type">MessageDigest</span> <span class="hljs-variable">md</span> <span class="hljs-operator">=</span> MessageDigest.getInstance(<span class="hljs-string">"SHA-512"</span>);</li><li>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">HexBinaryAdapter</span>().marshal(md.digest(str.getBytes(StandardCharsets.UTF_8)))</li><li>                .toLowerCase(Locale.US);</li><li>        } <span class="hljs-keyword">catch</span> (NoSuchAlgorithmException e) {</li><li>            log.error(<span class="hljs-string">"no such alg"</span>, e);</li><li>        }</li><li>        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;</li><li>    }</li><li>}</li></ol></pre></div></div> </div> <div class="tiledSection"><h2 id="section15782984912">错误码<i class="anchor-icon anchor-icon-link" anchorid="section15782984912" tips="复制节点链接"></i></h2> <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.19.2.1.4.1.1" width="19.81%"><p>HTTP响应码</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.19.2.1.4.1.2" width="28.17%"><p>描述</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.19.2.1.4.1.3" width="52.019999999999996%"><p>解决方法</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="19.81%"><p>200</p> </td> <td class="cellrowborder" width="28.17%"><p>仅表示本次接口调用成功，实际业务处理结果需要通过<strong>Response Header</strong>中的<strong>NSP_STATUS</strong>进行判断。</p> </td> <td class="cellrowborder" width="52.019999999999996%"><p>-</p> </td> </tr> <tr><td class="cellrowborder" width="19.81%"><p>400</p> </td> <td class="cellrowborder" width="28.17%"><p>参数错误。</p> </td> <td class="cellrowborder" width="52.019999999999996%"><p>请根据文档排查请求参数是否符合规范。</p> </td> </tr> <tr><td class="cellrowborder" width="19.81%"><p>403</p> </td> <td class="cellrowborder" width="28.17%"><p>无权限访问。</p> </td> <td class="cellrowborder" width="52.019999999999996%"><p>请检查调用环境及权限配置。</p> </td> </tr> <tr><td class="cellrowborder" width="19.81%"><p>404</p> </td> <td class="cellrowborder" width="28.17%"><p>找不到服务。</p> </td> <td class="cellrowborder" width="52.019999999999996%"><p>请检查请求URI是否正确。</p> </td> </tr> <tr><td class="cellrowborder" width="19.81%"><p>405</p> </td> <td class="cellrowborder" width="28.17%"><p>不支持的http请求method。</p> </td> <td class="cellrowborder" width="52.019999999999996%"><p>请检查http请求method是否与接口说明一致。</p> </td> </tr> <tr><td class="cellrowborder" width="19.81%"><p>500</p> </td> <td class="cellrowborder" width="28.17%"><p>服务内部错误。</p> </td> <td class="cellrowborder" width="52.019999999999996%"><p>请通过<a href="https://developer.huawei.com/consumer/cn/support/feedback/#/" target="_blank">在线提单</a>提交问题。</p> </td> </tr> <tr><td class="cellrowborder" width="19.81%"><p>502</p> </td> <td class="cellrowborder" width="28.17%"><p>请求连接异常，常见于网络状况不稳定。</p> </td> <td class="cellrowborder" width="52.019999999999996%"><p>建议稍后重试，若仍无法解决，请通过<a href="https://developer.huawei.com/consumer/cn/support/feedback/#/" target="_blank">在线提单</a>提交问题。</p> </td> </tr> <tr><td class="cellrowborder" width="19.81%"><p>503</p> </td> <td class="cellrowborder" width="28.17%"><p>系统流控。</p> </td> <td class="cellrowborder" width="52.019999999999996%"><p>触发系统流控，请稍后重试。</p> </td> </tr> <tr><td class="cellrowborder" width="19.81%"><p>504</p> </td> <td class="cellrowborder" width="28.17%"><p>请求连接超时，常见于网络状况不稳定。</p> </td> <td class="cellrowborder" width="52.019999999999996%"><p>建议稍后重试，若仍无法解决，请通过<a href="https://developer.huawei.com/consumer/cn/support/feedback/#/" target="_blank">在线提单</a>提交问题。</p> </td> </tr> <tr><td class="cellrowborder" width="19.81%"><p>590</p> </td> <td class="cellrowborder" width="28.17%"><p>服务内部错误。</p> </td> <td class="cellrowborder" width="52.019999999999996%"><p>请通过<a href="https://developer.huawei.com/consumer/cn/support/feedback/#/" target="_blank">在线提单</a>提交问题。</p> </td> </tr>  </tbody></table></div> </div> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p>Response Header中的NSP_STATUS字段，在处理成功时不会返回。</p> </div></div></div> </div>  <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.20.1.4.1.1" width="21.27%"><p>NSP_STATUS</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.20.1.4.1.2" width="26.5%"><p>描述</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.20.1.4.1.3" width="52.23%"><p>解决方法</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="21.27%"><p>6</p> </td> <td class="cellrowborder" width="26.5%"><p>会话失效，session timeout。</p> <p>可能原因:</p> <ul><li>access_token无效或已过期</li><li>access_token格式不正确</li></ul> </td> <td class="cellrowborder" width="52.23%"><ul><li>access_token无效或已过期，请检查传参是否正确，如无问题请尝试重新获取。</li></ul> <ul><li>未对access_token进行URLEncode处理，可参考<a href="/consumer/cn/doc/harmonyos-references/account-api-verify-realname#section1888515151299">示例代码</a>组装参数。</li></ul> </td> </tr> <tr><td class="cellrowborder" width="21.27%"><p>105</p> </td> <td class="cellrowborder" width="26.5%"><p>请求url中nsp_svc参数错误。</p> </td> <td class="cellrowborder" width="52.23%"><p>请检查请求地址参数是否正确。</p> </td> </tr> <tr><td class="cellrowborder" width="21.27%"><p>403</p> </td> <td class="cellrowborder" width="26.5%"><p>访问无权限。</p> </td> <td class="cellrowborder" width="52.23%"><p>请根据<a href="/consumer/cn/doc/harmonyos-references/account-api-verify-realname#section74906714178">使用约束</a>章节进行检查。</p> </td> </tr> <tr><td class="cellrowborder" width="21.27%"><p>500</p> </td> <td class="cellrowborder" width="26.5%"><p>接口内部错误。</p> </td> <td class="cellrowborder" width="52.23%"><p>根据返回的错误描述进行处理，若仍无法解决，请通过<a href="https://developer.huawei.com/consumer/cn/support/feedback/#/" target="_blank">在线提单</a>提交问题。</p> </td> </tr> <tr><td class="cellrowborder" width="21.27%"><p>503</p> </td> <td class="cellrowborder" width="26.5%"><p>接口流控。</p> </td> <td class="cellrowborder" width="52.23%"><p>业务调用频率过高，请稍后重试。</p> </td> </tr> <tr><td class="cellrowborder" width="21.27%"><p>70001201</p> </td> <td class="cellrowborder" width="26.5%"><p>请求参数错误。</p> </td> <td class="cellrowborder" width="52.23%"><p>请根据错误描述信息确定错误参数并修正后重试。</p> </td> </tr> <tr><td class="cellrowborder" width="21.27%"><p>70001401</p> </td> <td class="cellrowborder" width="26.5%"><p>服务内部错误。</p> </td> <td class="cellrowborder" width="52.23%"><p>请通过<a href="https://developer.huawei.com/consumer/cn/support/feedback/#/" target="_blank">在线提单</a>提交问题。</p> </td> </tr> <tr><td class="cellrowborder" width="21.27%"><p>70009019</p> </td> <td class="cellrowborder" width="26.5%"><p>实名信息不存在</p> </td> <td class="cellrowborder" width="52.23%"><p>账号未实名，请先进行实名，或更换已实名账号，若仍无法解决，请通过<a href="https://developer.huawei.com/consumer/cn/support/feedback/#/" target="_blank">在线提单</a>提交问题。</p> </td> </tr>  </tbody></table></div> </div> </div> <div></div></div>