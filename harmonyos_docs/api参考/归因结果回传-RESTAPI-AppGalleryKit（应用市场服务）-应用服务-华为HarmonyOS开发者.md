<h1 _ngcontent-bqg-c119="" class="doc-title ng-star-inserted" title="归因结果回传"> 归因结果回传 </h1>

<div _ngcontent-bqg-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <div class="tiledSection">     <h2 id="section151101231122811">功能介绍<i class="anchor-icon anchor-icon-link" anchorid="section151101231122811" tips="复制节点链接"></i></h2>          <p>应用归因服务将满足隐私要求的归因结果回传给开发者、获胜的分发平台以及分发平台配置的归因监测平台。</p>    </div>    <div class="tiledSection">     <h2 id="section15397641162818">接口原型<i class="anchor-icon anchor-icon-link" anchorid="section15397641162818" tips="复制节点链接"></i></h2>          <div class="tablenoborder">      <div class="tbBox"><table>               <tbody><tr>         <th class="firstcol" id="mcps1.3.2.2.1.3.1.1" width="18.98%">          <p>承载协议</p></th>         <td class="cellrowborder" width="81.02000000000001%">          <p>HTTPS POST</p></td>        </tr>        <tr>         <th class="firstcol" id="mcps1.3.2.2.1.3.2.1" width="18.98%">          <p>接口方向</p></th>         <td class="cellrowborder" width="81.02000000000001%">          <p>华为应用归因端侧 -&gt; （分发平台/开发者/归因监测平台）</p></td>        </tr>        <tr>         <th class="firstcol" id="mcps1.3.2.2.1.3.3.1" width="18.98%">          <p>接口URL</p></th>         <td class="cellrowborder" width="81.02000000000001%">          <p>应用生态伙伴在归因云端管理台注册归因角色时填写的URL地址</p></td>        </tr>        <tr>         <th class="firstcol" id="mcps1.3.2.2.1.3.4.1" width="18.98%">          <p>数据格式</p></th>         <td class="cellrowborder" width="81.02000000000001%">          <p>请求消息：Content-Type: application/json</p>          <p>响应消息：Content-Type: application/json</p></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="section81271745122818">请求参数<i class="anchor-icon anchor-icon-link" anchorid="section81271745122818" tips="复制节点链接"></i></h2>          <div class="p">      <strong>Request Body</strong>      <div class="tablenoborder">       <div class="tbBox"><table>        <thead>         <tr>          <th align="left" class="cellrowborder" id="mcps1.3.3.2.2.1.6.1.1" width="14.649999999999999%">           <p>参数</p></th>          <th align="left" class="cellrowborder" id="mcps1.3.3.2.2.1.6.1.2" width="10.07%">           <p>参数类型</p></th>          <th align="left" class="cellrowborder" id="mcps1.3.3.2.2.1.6.1.3" width="18.29%">           <p>是否必选</p></th>          <th align="left" class="cellrowborder" id="mcps1.3.3.2.2.1.6.1.4" width="7.5200000000000005%">           <p>是否参与签名</p></th>          <th align="left" class="cellrowborder" id="mcps1.3.3.2.2.1.6.1.5" width="49.47%">           <p>描述</p></th>         </tr>        </thead>                 <tbody><tr>          <td class="cellrowborder" width="14.649999999999999%">           <p>ad_tech_id</p></td>          <td class="cellrowborder" width="10.07%">           <p>String</p></td>          <td class="cellrowborder" width="18.29%">           <p>否</p></td>          <td class="cellrowborder" width="7.5200000000000005%">           <p>是</p></td>          <td class="cellrowborder" width="49.47%">           <p>归因成功的分发平台id，分发平台向应用归因云侧注册角色时，由应用归因服务分配，长度固定为8字符如果接收方为分发平台，该id即分发平台自身的id。</p>           <p>如果接收方为归因监测平台/开发者，该id为归因监测平台/开发者注册转化时指定分发平台列表中归因成功的分发平台id。</p></td>         </tr>         <tr>          <td class="cellrowborder" width="14.649999999999999%">           <p>campaign_id</p></td>          <td class="cellrowborder" width="10.07%">           <p>String</p></td>          <td class="cellrowborder" width="18.29%">           <p>否</p></td>          <td class="cellrowborder" width="7.5200000000000005%">           <p>是</p></td>          <td class="cellrowborder" width="49.47%">           <p>本次转化归因到的营销任务id，仅当满足回传条件时携带。</p></td>         </tr>         <tr>          <td class="cellrowborder" width="14.649999999999999%">           <p>source_id</p></td>          <td class="cellrowborder" width="10.07%">           <p>String</p></td>          <td class="cellrowborder" width="18.29%">           <p>否</p></td>          <td class="cellrowborder" width="7.5200000000000005%">           <p>是</p></td>          <td class="cellrowborder" width="49.47%">           <p>媒体应用id，长度不超过64，仅当满足回传条件时携带。</p></td>         </tr>         <tr>          <td class="cellrowborder" width="14.649999999999999%">           <p>destination_id</p></td>          <td class="cellrowborder" width="10.07%">           <p>String</p></td>          <td class="cellrowborder" width="18.29%">           <p>否</p></td>          <td class="cellrowborder" width="7.5200000000000005%">           <p>是</p></td>          <td class="cellrowborder" width="49.47%">           <p>开发者应用id，长度不超过64 。</p>           <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">             <p>您的应用ID参考<a href="https://developer.huawei.com/consumer/cn/doc/app/agc-help-appinfo-0000001100014694" target="_blank">查看应用基本信息</a>获取。</p>            </div></div></div></td>         </tr>         <tr>          <td class="cellrowborder" width="14.649999999999999%">           <p>service_tag</p></td>          <td class="cellrowborder" width="10.07%">           <p>String</p></td>          <td class="cellrowborder" width="18.29%">           <p>否</p></td>          <td class="cellrowborder" width="7.5200000000000005%">           <p>否</p></td>          <td class="cellrowborder" width="49.47%">           <p>业务标识，分发平台关注的业务信息，如创意、素材等，长度不超过32。</p>           <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">             <p>通过白名单方式向分发平台开放（白名单开放方式请联系华为运营）。</p>            </div></div></div></td>         </tr>         <tr>          <td class="cellrowborder" width="14.649999999999999%">           <p>business_scene</p></td>          <td class="cellrowborder" width="10.07%">           <p>number</p></td>          <td class="cellrowborder" width="18.29%">           <p>否</p></td>          <td class="cellrowborder" width="7.5200000000000005%">           <p>否</p></td>          <td class="cellrowborder" width="49.47%">           <p>业务场景值，仅开发者满足回传条件时携带。</p>           <p>取值范围：[0,99]。</p>           <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">             <p>通过白名单方式向开发者开放（白名单开放方式请联系华为运营）。</p>            </div></div></div></td>         </tr>         <tr>          <td class="cellrowborder" width="14.649999999999999%">           <p>trigger_data</p></td>          <td class="cellrowborder" width="10.07%">           <p>number</p></td>          <td class="cellrowborder" width="18.29%">           <p>否</p></td>          <td class="cellrowborder" width="7.5200000000000005%">           <p>是</p></td>          <td class="cellrowborder" width="49.47%">           <p>转化事件编码。</p>           <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/store-attribution-trigger-standard" target="_blank">标准转化事件</a>取值范围：[1, 200]。</p>           <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/store-attribution-trigger-custom" target="_blank">自定义转化事件</a>取值范围：[501, 600]。</p></td>         </tr>         <tr>          <td class="cellrowborder" width="14.649999999999999%">           <p>installation_status</p></td>          <td class="cellrowborder" width="10.07%">           <p>number</p></td>          <td class="cellrowborder" width="18.29%">           <p>否</p></td>          <td class="cellrowborder" width="7.5200000000000005%">           <p>否</p></td>          <td class="cellrowborder" width="49.47%">           <p>应用安装状态。</p>           <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">             <p>通过白名单方式向应用生态伙伴（分发平台、开发者、归因监测平台）开放（白名单开放方式请联系华为运营）。</p>            </div></div></div></td>         </tr>         <tr>          <td class="cellrowborder" width="14.649999999999999%">           <p>nonce</p></td>          <td class="cellrowborder" width="10.07%">           <p>String</p></td>          <td class="cellrowborder" width="18.29%">           <p>是</p></td>          <td class="cellrowborder" width="7.5200000000000005%">           <p>是</p></td>          <td class="cellrowborder" width="49.47%">           <p>用于计算签名的随机数，不带"-"，由应用归因服务生成，每次归因结果回传，nonce唯一。</p></td>         </tr>         <tr>          <td class="cellrowborder" width="14.649999999999999%">           <p>timestamp</p></td>          <td class="cellrowborder" width="10.07%">           <p>number</p></td>          <td class="cellrowborder" width="18.29%">           <p>是</p></td>          <td class="cellrowborder" width="7.5200000000000005%">           <p>是</p></td>          <td class="cellrowborder" width="49.47%">           <p>unix时间戳，毫秒，回传发生的时间戳，建议校验时判断与当前时间相差不超过 5min。</p></td>         </tr>         <tr>          <td class="cellrowborder" width="14.649999999999999%">           <p>signature</p></td>          <td class="cellrowborder" width="10.07%">           <p>String</p></td>          <td class="cellrowborder" width="18.29%">           <p>是</p></td>          <td class="cellrowborder" width="7.5200000000000005%">           <p>否</p></td>          <td class="cellrowborder" width="49.47%">           <p>签名值。接收方应使用应用归因服务提供的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/store-attribution-receive#section15571357102111" target="_blank">公钥</a>，对该签名值进行验签，具体参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/store-attribution-receive#section15571357102111" target="_blank">验签计算规则</a>、<a href="/consumer/cn/doc/harmonyos-references/store-rest-receive#section114341820105218">回传结果验签方法</a>。</p></td>         </tr>         <tr>          <td class="cellrowborder" width="14.649999999999999%">           <p>transaction_id</p></td>          <td class="cellrowborder" width="10.07%">           <p>String</p></td>          <td class="cellrowborder" width="18.29%">           <p>是</p></td>          <td class="cellrowborder" width="7.5200000000000005%">           <p>否</p></td>          <td class="cellrowborder" width="49.47%">           <p>本次回传的事务id，唯一，接收方可用于请求的幂等处理。</p></td>         </tr>               </tbody></table></div>      </div>     </div>    </div>    <div class="tiledSection">     <h2 id="section17184811284">请求示例<i class="anchor-icon anchor-icon-link" anchorid="section17184811284" tips="复制节点链接"></i></h2>          <div _ngcontent-bqg-c106="" class="highlight-div"><div _ngcontent-bqg-c106="" class="highlight-div-header"><div _ngcontent-bqg-c106="" class="highlight-div-header-left"><div _ngcontent-bqg-c106="" class="handle-button expand-button"><div _ngcontent-bqg-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bqg-c106="" class="highlight-div-header-right"><div _ngcontent-bqg-c106="" class="handle-button ai-button"></div><div _ngcontent-bqg-c106="" class="handle-button line-button"><div _ngcontent-bqg-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bqg-c106="" class="handle-button theme-button"><div _ngcontent-bqg-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bqg-c106="" class="handle-button copy-button"><div _ngcontent-bqg-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bqg-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-variable constant_">POST</span> <span class="hljs-attr">https</span>:<span class="hljs-comment">//xxxxxxxx/attribution/report-attribution</span></li><li><span class="hljs-title class_">Content</span>-<span class="hljs-title class_">Type</span>: application/json</li><li>{</li><li>    <span class="hljs-string">"ad_tech_id"</span>:<span class="hljs-string">"12345678"</span>,</li><li>    <span class="hljs-string">"campaign_id"</span>:<span class="hljs-string">"50"</span>,</li><li>    <span class="hljs-string">"source_id"</span>:<span class="hljs-string">"108****321"</span>,</li><li>    <span class="hljs-string">"destination_id"</span>:<span class="hljs-string">"101****678"</span>,</li><li>    <span class="hljs-string">"trigger_data"</span>:<span class="hljs-number">12</span>,</li><li>    <span class="hljs-string">"nonce"</span>:<span class="hljs-string">"17aa292c****4516****25150****195"</span>,</li><li>    <span class="hljs-string">"timestamp"</span>:<span class="hljs-number">167</span>****<span class="hljs-number">380</span>,</li><li>    <span class="hljs-string">"signature"</span>:<span class="hljs-string">"MEQCIEQlmZ****zKBSE8QnhLTIHZZZ****ZpRqRxHss65Ko****JgJKjdrWdkL****juEx2RmFS7da****ZRVZ8RyMyUXg=="</span>,</li><li>    <span class="hljs-string">"transaction_id"</span>:<span class="hljs-string">"aa****aaaa"</span></li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="section85809515287">响应参数<i class="anchor-icon anchor-icon-link" anchorid="section85809515287" tips="复制节点链接"></i></h2>          <div class="p">      <strong>Response Header</strong>      <div class="tablenoborder">       <div class="tbBox"><table>        <thead>         <tr>          <th align="left" class="cellrowborder" id="mcps1.3.5.2.2.1.5.1.1" width="16.068393160683932%">           <p>参数</p></th>          <th align="left" class="cellrowborder" id="mcps1.3.5.2.2.1.5.1.2" width="10.32896710328967%">           <p>参数类型</p></th>          <th align="left" class="cellrowborder" id="mcps1.3.5.2.2.1.5.1.3" width="8.249175082491751%">           <p>是否必选</p></th>          <th align="left" class="cellrowborder" id="mcps1.3.5.2.2.1.5.1.4" width="65.35346465353464%">           <p>描述</p></th>         </tr>        </thead>                 <tbody><tr>          <td class="cellrowborder" width="16.068393160683932%">           <p>Content-Type</p></td>          <td class="cellrowborder" width="10.32896710328967%">           <p>String</p></td>          <td class="cellrowborder" width="8.249175082491751%">           <p>是</p></td>          <td class="cellrowborder" width="65.35346465353464%">           <p>取值为：application/json; charset=UTF-8</p></td>         </tr>               </tbody></table></div>      </div>     </div>     <div class="p">      <strong>Response Body</strong>      <div class="tablenoborder">       <div class="tbBox"><table>        <thead>         <tr>          <th align="left" class="cellrowborder" id="mcps1.3.5.3.2.1.5.1.1" width="12%">           <p>参数</p></th>          <th align="left" class="cellrowborder" id="mcps1.3.5.3.2.1.5.1.2" width="12%">           <p>参数类型</p></th>          <th align="left" class="cellrowborder" id="mcps1.3.5.3.2.1.5.1.3" width="9.85%">           <p>是否必选</p></th>          <th align="left" class="cellrowborder" id="mcps1.3.5.3.2.1.5.1.4" width="66.14999999999999%">           <p>描述</p></th>         </tr>        </thead>                 <tbody><tr>          <td class="cellrowborder" width="12%">           <p>resultCode</p></td>          <td class="cellrowborder" width="12%">           <p>String</p></td>          <td class="cellrowborder" width="9.85%">           <p>是</p></td>          <td class="cellrowborder" width="66.14999999999999%">           <p>应用归因侧解析application/json类型响应，“0”表示成功，其他值失败。</p></td>         </tr>         <tr>          <td class="cellrowborder" width="12%">           <p>resultDesc</p></td>          <td class="cellrowborder" width="12%">           <p>String</p></td>          <td class="cellrowborder" width="9.85%">           <p>是</p></td>          <td class="cellrowborder" width="66.14999999999999%">           <p>结果描述。</p></td>         </tr>               </tbody></table></div>      </div>     </div>    </div>    <div class="tiledSection">     <h2 id="section19545562815">响应示例<i class="anchor-icon anchor-icon-link" anchorid="section19545562815" tips="复制节点链接"></i></h2>          <div _ngcontent-bqg-c106="" class="highlight-div"><div _ngcontent-bqg-c106="" class="highlight-div-header"><div _ngcontent-bqg-c106="" class="highlight-div-header-left"><div _ngcontent-bqg-c106="" class="handle-button expand-button"><div _ngcontent-bqg-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bqg-c106="" class="highlight-div-header-right"><div _ngcontent-bqg-c106="" class="handle-button ai-button"></div><div _ngcontent-bqg-c106="" class="handle-button line-button"><div _ngcontent-bqg-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bqg-c106="" class="handle-button theme-button"><div _ngcontent-bqg-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bqg-c106="" class="handle-button copy-button"><div _ngcontent-bqg-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bqg-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-variable constant_">HTTP</span>/<span class="hljs-number">1.1</span> <span class="hljs-number">200</span> <span class="hljs-variable constant_">OK</span></li><li><span class="hljs-title class_">Content</span>-<span class="hljs-title class_">Type</span>: application/json; charset=<span class="hljs-variable constant_">UTF</span>-<span class="hljs-number">8</span></li><li>{</li><li>  <span class="hljs-string">"resultCode"</span>: <span class="hljs-string">"0"</span>,</li><li>  <span class="hljs-string">"resultDesc"</span>: <span class="hljs-string">"Success."</span></li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="section114341820105218">回传结果验签方法<i class="anchor-icon anchor-icon-link" anchorid="section114341820105218" tips="复制节点链接"></i></h2>          <ol>      <li>您需要在pom.xml文件中引入最新版本的开源密码算法包<a href="https://www.bouncycastle.org/latest_releases.html" target="_blank">Bouncy Castle</a>。       <div _ngcontent-bqg-c106="" class="highlight-div"><div _ngcontent-bqg-c106="" class="highlight-div-header"><div _ngcontent-bqg-c106="" class="highlight-div-header-left"><div _ngcontent-bqg-c106="" class="handle-button expand-button"><div _ngcontent-bqg-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bqg-c106="" class="highlight-div-header-right"><div _ngcontent-bqg-c106="" class="handle-button ai-button"></div><div _ngcontent-bqg-c106="" class="handle-button line-button"><div _ngcontent-bqg-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bqg-c106="" class="handle-button theme-button"><div _ngcontent-bqg-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bqg-c106="" class="handle-button copy-button"><div _ngcontent-bqg-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bqg-c106="" class="highlight-scroll-div"><pre class="java prettyprint linenums hljs language-java" data-highlighted="yes"><ol class="linenums"><li>&lt;dependency&gt;</li><li>  &lt;groupId&gt;org.bouncycastle&lt;/groupId&gt;</li><li>  &lt;artifactId&gt;bcprov-jdk18on&lt;/artifactId&gt;</li><li>  &lt;version&gt;${last_version}&lt;/version&gt;</li><li>&lt;/dependency&gt;</li><li>&lt;dependency&gt;</li><li>  &lt;groupId&gt;commons-codec&lt;/groupId&gt;</li><li>  &lt;artifactId&gt;commons-codec&lt;/artifactId&gt;</li><li>  &lt;version&gt;${last_version}&lt;/version&gt;</li><li>&lt;/dependency&gt;</li></ol></pre></div></div></li>      <li>您可以使用以下代码对回传请求中签名值进行验签。       <div _ngcontent-bqg-c106="" class="highlight-div"><div _ngcontent-bqg-c106="" class="highlight-div-header"><div _ngcontent-bqg-c106="" class="highlight-div-header-left"><div _ngcontent-bqg-c106="" class="handle-button expand-button"><div _ngcontent-bqg-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bqg-c106="" class="highlight-div-header-right"><div _ngcontent-bqg-c106="" class="handle-button ai-button"></div><div _ngcontent-bqg-c106="" class="handle-button line-button"><div _ngcontent-bqg-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bqg-c106="" class="handle-button theme-button"><div _ngcontent-bqg-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bqg-c106="" class="handle-button copy-button"><div _ngcontent-bqg-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bqg-c106="" class="highlight-scroll-div"><pre class="java prettyprint linenums hljs language-java" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> org.apache.commons.codec.binary.Base64;</li><li><span class="hljs-keyword">import</span> org.bouncycastle.jce.provider.BouncyCastleProvider;</li><li><span class="hljs-keyword">import</span> java.nio.charset.StandardCharsets;</li><li><span class="hljs-keyword">import</span> java.security.InvalidKeyException;</li><li><span class="hljs-keyword">import</span> java.security.KeyFactory;</li><li><span class="hljs-keyword">import</span> java.security.NoSuchAlgorithmException;</li><li><span class="hljs-keyword">import</span> java.security.PublicKey;</li><li><span class="hljs-keyword">import</span> java.security.Security;</li><li><span class="hljs-keyword">import</span> java.security.Signature;</li><li><span class="hljs-keyword">import</span> java.security.SignatureException;</li><li><span class="hljs-keyword">import</span> java.security.spec.InvalidKeySpecException;</li><li><span class="hljs-keyword">import</span> java.security.spec.X509EncodedKeySpec;</li><li>
</li><li><span class="hljs-comment">/**</span></li><li><span class="hljs-comment"> * 回传结果验签工具类</span></li><li><span class="hljs-comment"> * </span></li><li><span class="hljs-comment"> * <span class="hljs-doctag">@author</span> ******</span></li><li><span class="hljs-comment"> * <span class="hljs-doctag">@since</span> ****-**-**</span></li><li><span class="hljs-comment"> */</span></li><li><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PostbackResultVerifyUtil</span> {</li><li>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">String</span> <span class="hljs-variable">publicKey</span> <span class="hljs-operator">=</span> <span class="hljs-string">"MIIBoj*****AAE="</span>;</li><li>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">RSA_ALGORITHM</span> <span class="hljs-operator">=</span> <span class="hljs-string">"RSA"</span>;</li><li>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">SHA256WithRSA_PSS_ALGORITHM</span> <span class="hljs-operator">=</span> <span class="hljs-string">"SHA256WithRSA/PSS"</span>;</li><li>
</li><li>    <span class="hljs-comment">/**</span></li><li><span class="hljs-comment">     * 回传结果验签调用方法</span></li><li><span class="hljs-comment">     *</span></li><li><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> content 签名内容拼接字段</span></li><li><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> signature 回传请求中的签名值</span></li><li><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> 验签结果</span></li><li><span class="hljs-comment">     * <span class="hljs-doctag">@throws</span> NoSuchAlgorithmException NoSuchAlgorithmException</span></li><li><span class="hljs-comment">     * <span class="hljs-doctag">@throws</span> InvalidKeySpecException InvalidKeySpecException</span></li><li><span class="hljs-comment">     * <span class="hljs-doctag">@throws</span> InvalidKeyException InvalidKeyException</span></li><li><span class="hljs-comment">     * <span class="hljs-doctag">@throws</span> SignatureException SignatureException</span></li><li><span class="hljs-comment">     */</span></li><li>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">verify</span><span class="hljs-params">(String content,String signature)</span></li><li>        <span class="hljs-keyword">throws</span> NoSuchAlgorithmException, InvalidKeySpecException, InvalidKeyException, SignatureException {</li><li>        <span class="hljs-type">byte</span>[] plainContent = content.getBytes(StandardCharsets.UTF_8);</li><li>        <span class="hljs-type">byte</span>[] signContent = decodeBase64(signature);</li><li>        Security.addProvider(<span class="hljs-keyword">new</span> <span class="hljs-title class_">BouncyCastleProvider</span>());</li><li>        <span class="hljs-type">PublicKey</span> <span class="hljs-variable">pubKey</span> <span class="hljs-operator">=</span> getPublicKey(publicKey);</li><li>        <span class="hljs-type">Signature</span> <span class="hljs-variable">rsaSignature</span> <span class="hljs-operator">=</span> Signature.getInstance(SHA256WithRSA_PSS_ALGORITHM);</li><li>        rsaSignature.initVerify(pubKey);</li><li>        rsaSignature.update(plainContent);</li><li>        <span class="hljs-keyword">return</span> rsaSignature.verify(signContent);</li><li>    }</li><li>
</li><li>    <span class="hljs-keyword">private</span> PublicKey <span class="hljs-title function_">getPublicKey</span><span class="hljs-params">(String key)</span> <span class="hljs-keyword">throws</span> NoSuchAlgorithmException, InvalidKeySpecException {</li><li>        <span class="hljs-type">X509EncodedKeySpec</span> <span class="hljs-variable">keySpec</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">X509EncodedKeySpec</span>(decodeBase64(key));</li><li>        <span class="hljs-type">KeyFactory</span> <span class="hljs-variable">keyFactory</span> <span class="hljs-operator">=</span> KeyFactory.getInstance(RSA_ALGORITHM);</li><li>        <span class="hljs-keyword">return</span> keyFactory.generatePublic(keySpec);</li><li>    }</li><li>
</li><li>    <span class="hljs-keyword">private</span> <span class="hljs-type">byte</span>[] decodeBase64(String base64Str) {</li><li>        <span class="hljs-keyword">return</span> Base64.decodeBase64(base64Str.getBytes(StandardCharsets.UTF_8));</li><li>    }</li><li>}</li></ol></pre></div></div>       <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">         <p>回传结果验签调用方法verify(String content,String signature)中：</p>         <p>content：签名内容拼接字段，拼接方式可参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/store-attribution-receive#section15571357102111" target="_blank">验签计算规则</a>。</p>         <p>signature：回传请求中的签名值。</p>        </div></div></div></li>     </ol>    </div>   </div>   <div></div></div>