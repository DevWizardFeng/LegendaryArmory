<h1 _ngcontent-xgq-c119="" class="doc-title ng-star-inserted" title="数据传递与处理"> 数据传递与处理 </h1>

<div _ngcontent-xgq-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div> <div class="tiledSection"><h2 id="props" device-type="phone,2in1,tablet,wearable,tv">Props<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="props" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>自定义组件可以通过props声明属性，父组件通过设置属性向子组件传递参数，props支持类型包括：String，Number，Boolean，Array，Object，Function。camelCase (驼峰命名法) 的 prop 名，在外部父组件传递参数时需要使用 kebab-case (短横线分隔命名) 形式，即当属性compProp在父组件引用时需要转换为comp-prop。给自定义组件添加props，通过父组件向下传递参数的示例如下：</p> <div _ngcontent-xgq-c106="" class="highlight-div"><div _ngcontent-xgq-c106="" class="highlight-div-header"><div _ngcontent-xgq-c106="" class="highlight-div-header-left"><div _ngcontent-xgq-c106="" class="handle-button expand-button"><div _ngcontent-xgq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xgq-c106="" class="highlight-div-header-right"><div _ngcontent-xgq-c106="" class="handle-button ai-button"></div><div _ngcontent-xgq-c106="" class="handle-button line-button"><div _ngcontent-xgq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xgq-c106="" class="handle-button theme-button"><div _ngcontent-xgq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xgq-c106="" class="handle-button copy-button"><div _ngcontent-xgq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xgq-c106="" class="highlight-scroll-div"><pre class="html prettyprint linenums hljs language-xml" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">&lt;!-- comp.hml --&gt;</span></li><li><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"item"</span>&gt;</span> </li><li>   <span class="hljs-tag">&lt;<span class="hljs-name">text</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"title-style"</span>&gt;</span>{{compProp}}<span class="hljs-tag">&lt;/<span class="hljs-name">text</span>&gt;</span> </li><li><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></li></ol></pre></div></div> <div _ngcontent-xgq-c106="" class="highlight-div"><div _ngcontent-xgq-c106="" class="highlight-div-header"><div _ngcontent-xgq-c106="" class="highlight-div-header-left"><div _ngcontent-xgq-c106="" class="handle-button expand-button"><div _ngcontent-xgq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xgq-c106="" class="highlight-div-header-right"><div _ngcontent-xgq-c106="" class="handle-button ai-button"></div><div _ngcontent-xgq-c106="" class="handle-button line-button"><div _ngcontent-xgq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xgq-c106="" class="handle-button theme-button"><div _ngcontent-xgq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xgq-c106="" class="handle-button copy-button"><div _ngcontent-xgq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xgq-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// comp.js</span></li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {</li><li>  <span class="hljs-attr">props</span>: [<span class="hljs-string">'compProp'</span>],</li><li>}</li></ol></pre></div></div> <div _ngcontent-xgq-c106="" class="highlight-div"><div _ngcontent-xgq-c106="" class="highlight-div-header"><div _ngcontent-xgq-c106="" class="highlight-div-header-left"><div _ngcontent-xgq-c106="" class="handle-button expand-button"><div _ngcontent-xgq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xgq-c106="" class="highlight-div-header-right"><div _ngcontent-xgq-c106="" class="handle-button ai-button"></div><div _ngcontent-xgq-c106="" class="handle-button line-button"><div _ngcontent-xgq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xgq-c106="" class="handle-button theme-button"><div _ngcontent-xgq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xgq-c106="" class="handle-button copy-button"><div _ngcontent-xgq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xgq-c106="" class="highlight-scroll-div"><pre class="html prettyprint linenums hljs language-xml" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">&lt;!-- xxx.hml --&gt;</span></li><li><span class="hljs-tag">&lt;<span class="hljs-name">element</span> <span class="hljs-attr">name</span>=<span class="hljs-string">'comp'</span> <span class="hljs-attr">src</span>=<span class="hljs-string">'../common/component/comp/comp.hml'</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">element</span>&gt;</span></li><li><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"container"</span>&gt;</span> </li><li>   <span class="hljs-tag">&lt;<span class="hljs-name">comp</span> <span class="hljs-attr">comp-prop</span>=<span class="hljs-string">"{{title}}"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">comp</span>&gt;</span> </li><li><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></li></ol></pre></div></div> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"> <p> 自定义属性命名时禁止以on、@、on:、grab: 等保留关键字为开头。</p>  </div></div></div> </div>  <div class="tiledSection"><h3 id="添加默认值" device-type="phone,2in1,tablet,wearable,tv" class="firsth2">添加默认值<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="添加默认值" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>子组件可以通过固定值default设置默认值，当父组件没有设置该属性时，将使用其默认值。此情况下props属性必须为对象形式，不能用数组形式，示例如下：</p> <div _ngcontent-xgq-c106="" class="highlight-div"><div _ngcontent-xgq-c106="" class="highlight-div-header"><div _ngcontent-xgq-c106="" class="highlight-div-header-left"><div _ngcontent-xgq-c106="" class="handle-button expand-button"><div _ngcontent-xgq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xgq-c106="" class="highlight-div-header-right"><div _ngcontent-xgq-c106="" class="handle-button ai-button"></div><div _ngcontent-xgq-c106="" class="handle-button line-button"><div _ngcontent-xgq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xgq-c106="" class="handle-button theme-button"><div _ngcontent-xgq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xgq-c106="" class="handle-button copy-button"><div _ngcontent-xgq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xgq-c106="" class="highlight-scroll-div"><pre class="html prettyprint linenums hljs language-xml" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">&lt;!-- comp.hml --&gt;</span></li><li><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"item"</span>&gt;</span> </li><li>   <span class="hljs-tag">&lt;<span class="hljs-name">text</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"title-style"</span>&gt;</span>{{title}}<span class="hljs-tag">&lt;/<span class="hljs-name">text</span>&gt;</span> </li><li><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></li></ol></pre></div></div> <div _ngcontent-xgq-c106="" class="highlight-div"><div _ngcontent-xgq-c106="" class="highlight-div-header"><div _ngcontent-xgq-c106="" class="highlight-div-header-left"><div _ngcontent-xgq-c106="" class="handle-button expand-button"><div _ngcontent-xgq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xgq-c106="" class="highlight-div-header-right"><div _ngcontent-xgq-c106="" class="handle-button ai-button"></div><div _ngcontent-xgq-c106="" class="handle-button line-button"><div _ngcontent-xgq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xgq-c106="" class="handle-button theme-button"><div _ngcontent-xgq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xgq-c106="" class="handle-button copy-button"><div _ngcontent-xgq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xgq-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// comp.js</span></li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {</li><li>  <span class="hljs-attr">props</span>: {</li><li>    <span class="hljs-attr">title</span>: {</li><li>      <span class="hljs-attr">default</span>: <span class="hljs-string">'title'</span>,</li><li>    },</li><li>  },</li><li>}</li></ol></pre></div></div> <p>本示例中加入了一个text组件显示标题，标题的内容是一个自定义属性，显示用户设置的标题内容，当用户没有设置时显示默认值title。在引用该组件时添加该属性的设置：</p> <div _ngcontent-xgq-c106="" class="highlight-div"><div _ngcontent-xgq-c106="" class="highlight-div-header"><div _ngcontent-xgq-c106="" class="highlight-div-header-left"><div _ngcontent-xgq-c106="" class="handle-button expand-button"><div _ngcontent-xgq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xgq-c106="" class="highlight-div-header-right"><div _ngcontent-xgq-c106="" class="handle-button ai-button"></div><div _ngcontent-xgq-c106="" class="handle-button line-button"><div _ngcontent-xgq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xgq-c106="" class="handle-button theme-button"><div _ngcontent-xgq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xgq-c106="" class="handle-button copy-button"><div _ngcontent-xgq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xgq-c106="" class="highlight-scroll-div"><pre class="html prettyprint linenums hljs language-xml" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">&lt;!-- xxx.hml --&gt;</span></li><li><span class="hljs-tag">&lt;<span class="hljs-name">element</span> <span class="hljs-attr">name</span>=<span class="hljs-string">'comp'</span> <span class="hljs-attr">src</span>=<span class="hljs-string">'../common/component/comp/comp.hml'</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">element</span>&gt;</span></li><li><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"container"</span>&gt;</span> </li><li>   <span class="hljs-tag">&lt;<span class="hljs-name">comp</span> <span class="hljs-attr">title</span>=<span class="hljs-string">"自定义组件"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">comp</span>&gt;</span> </li><li><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></li></ol></pre></div></div> </div>  <div class="tiledSection"><h3 id="数据单向性" device-type="phone,2in1,tablet,wearable,tv">数据单向性<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="数据单向性" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>父子组件之间数据的传递是单向的，只能从父组件传递给子组件，子组件不能直接修改父组件传递下来的值，可以将props传入的值用data接收后作为默认值，再对data的值进行修改。</p> <div _ngcontent-xgq-c106="" class="highlight-div"><div _ngcontent-xgq-c106="" class="highlight-div-header"><div _ngcontent-xgq-c106="" class="highlight-div-header-left"><div _ngcontent-xgq-c106="" class="handle-button expand-button"><div _ngcontent-xgq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xgq-c106="" class="highlight-div-header-right"><div _ngcontent-xgq-c106="" class="handle-button ai-button"></div><div _ngcontent-xgq-c106="" class="handle-button line-button"><div _ngcontent-xgq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xgq-c106="" class="handle-button theme-button"><div _ngcontent-xgq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xgq-c106="" class="handle-button copy-button"><div _ngcontent-xgq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xgq-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// comp.js</span></li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {</li><li>  <span class="hljs-attr">props</span>: [<span class="hljs-string">'defaultCount'</span>],</li><li>  <span class="hljs-title function_">data</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">return</span> {</li><li>      <span class="hljs-attr">count</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">defaultCount</span>,</li><li>    };</li><li>  },</li><li>  <span class="hljs-title function_">onClick</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span> + <span class="hljs-number">1</span>;</li><li>  },</li><li>}</li></ol></pre></div></div> </div>  <div class="tiledSection"><h3 id="watch感知数据改变" device-type="phone,2in1,tablet,wearable,tv">$watch感知数据改变<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="watch感知数据改变" tips="复制节点链接"></i></h3><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>如果需要观察组件中属性变化，可以通过$watch方法增加属性变化回调。使用方法如下：</p> <div _ngcontent-xgq-c106="" class="highlight-div"><div _ngcontent-xgq-c106="" class="highlight-div-header"><div _ngcontent-xgq-c106="" class="highlight-div-header-left"><div _ngcontent-xgq-c106="" class="handle-button expand-button"><div _ngcontent-xgq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xgq-c106="" class="highlight-div-header-right"><div _ngcontent-xgq-c106="" class="handle-button ai-button"></div><div _ngcontent-xgq-c106="" class="handle-button line-button"><div _ngcontent-xgq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xgq-c106="" class="handle-button theme-button"><div _ngcontent-xgq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xgq-c106="" class="handle-button copy-button"><div _ngcontent-xgq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xgq-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// comp.js</span></li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {</li><li>  <span class="hljs-attr">props</span>: [<span class="hljs-string">'title'</span>],</li><li>  <span class="hljs-title function_">onInit</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">this</span>.$watch(<span class="hljs-string">'title'</span>, <span class="hljs-string">'onPropertyChange'</span>);</li><li>  },</li><li>  <span class="hljs-title function_">onPropertyChange</span>(<span class="hljs-params">newV, oldV</span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'title 属性变化 '</span> + newV + <span class="hljs-string">' '</span> + oldV);</li><li>  },</li><li>}</li></ol></pre></div></div> </div>  <div class="tiledSection"><h2 id="computed" device-type="phone,2in1,tablet,wearable,tv">computed<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="computed" tips="复制节点链接"></i></h2><div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>自定义组件中经常需要在读取或设置某个属性时进行预先处理，提高开发效率，此种情况就需要使用computed计算属性。computed字段中可通过设置属性的getter和setter方法在属性读写的时候进行触发，使用方式如下：</p> <div _ngcontent-xgq-c106="" class="highlight-div"><div _ngcontent-xgq-c106="" class="highlight-div-header"><div _ngcontent-xgq-c106="" class="highlight-div-header-left"><div _ngcontent-xgq-c106="" class="handle-button expand-button"><div _ngcontent-xgq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xgq-c106="" class="highlight-div-header-right"><div _ngcontent-xgq-c106="" class="handle-button ai-button"></div><div _ngcontent-xgq-c106="" class="handle-button line-button"><div _ngcontent-xgq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xgq-c106="" class="handle-button theme-button"><div _ngcontent-xgq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xgq-c106="" class="handle-button copy-button"><div _ngcontent-xgq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xgq-c106="" class="highlight-scroll-div"><pre class="js prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// comp.js</span></li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {</li><li>  <span class="hljs-attr">props</span>: [<span class="hljs-string">'title'</span>],</li><li>  <span class="hljs-title function_">data</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">return</span> {</li><li>      <span class="hljs-attr">objTitle</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">title</span>,</li><li>      <span class="hljs-attr">time</span>: <span class="hljs-string">'Today'</span>,</li><li>    };</li><li>  },</li><li>  <span class="hljs-attr">computed</span>: {</li><li>    <span class="hljs-title function_">message</span>(<span class="hljs-params"></span>) {</li><li>      <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">time</span> + <span class="hljs-string">' '</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">objTitle</span>;</li><li>    },</li><li>    <span class="hljs-attr">notice</span>: {</li><li>      <span class="hljs-title function_">get</span>(<span class="hljs-params"></span>) {</li><li>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">time</span>;</li><li>      },</li><li>      <span class="hljs-title function_">set</span>(<span class="hljs-params">newValue</span>) {</li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">time</span> = newValue;</li><li>      },</li><li>    },</li><li>  },</li><li>  <span class="hljs-title function_">onClick</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'get click event '</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span>);</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">notice</span> = <span class="hljs-string">'Tomorrow'</span>;</li><li>  },</li><li>}</li></ol></pre></div></div> <p>这里声明的第一个计算属性message默认只有getter函数，message的值会取决于objTitle的值的变化。getter函数只能读取不能改变参数值，例如data中初始化定义的time，当需要赋值给计算属性的时候可以提供一个setter函数，如示例中的notice。</p> </div> </div> <div></div></div>