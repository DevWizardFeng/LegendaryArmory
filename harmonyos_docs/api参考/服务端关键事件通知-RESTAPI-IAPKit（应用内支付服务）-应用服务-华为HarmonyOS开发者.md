<h1 _ngcontent-ukm-c119="" class="doc-title ng-star-inserted" title="服务端关键事件通知"> 服务端关键事件通知 </h1>

<div _ngcontent-ukm-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p>如果接入了IAP Kit订单/订阅功能，建议在<a href="https://developer.huawei.com/consumer/cn/service/josp/agc/index.html" target="_blank">AppGallery Connect</a>网站<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/iap-set-necessary-parameters#section22711950153313" target="_blank">配置通知接收地址</a>，用于接收IAP服务器发送的关键事件通知。IAP关键事件通知版本只支持v3。</p>    <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">      <p>建议所有提供消耗型/非消耗型/自动续期订阅/非续期订阅商品的App均配置该通知接收地址，以便接收关键事件通知，为用户提供更好、更及时的服务。另外，通知接收地址必须基于HTTPS并且配置有商业域名机构颁发的证书。</p>     </div></div></div>    <div class="tiledSection">     <h2 id="section6569154515312">功能介绍<i class="anchor-icon anchor-icon-link" anchorid="section6569154515312" tips="复制节点链接"></i></h2>          <p>用户购买消耗型/非消耗型/自动续期订阅/非续期订阅商品后，IAP服务器调用此接口向开发者服务器发送关键事件通知。</p>    </div>    <div class="tiledSection">     <h2 id="section3341022479">场景描述<i class="anchor-icon anchor-icon-link" anchorid="section3341022479" tips="复制节点链接"></i></h2>          <p>如果在<a href="https://developer.huawei.com/consumer/cn/service/josp/agc/index.html" target="_blank">AppGallery Connect</a>申请支付服务时提前<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/iap-set-necessary-parameters#section22711950153313" target="_blank">配置通知接收地址</a>，并且通知版本设置为v3，用户购买消耗型/非消耗型/自动续期订阅/非续期订阅商品后，IAP服务器会在某些关键事件发生时调用此接口通知已配置的服务器。</p>     <p>消耗型/非消耗型/非续期订阅商品主要涉及的场景如下：</p>     <ul>      <li>支付成功。</li>      <li>退款成功。</li>     </ul>     <p>自动续期订阅商品主要涉及的场景如下：</p>     <ul>      <li>用户第一次订阅成功。</li>      <li>已过期的订阅自动续期成功。</li>      <li>用户主动恢复一个已过期的自动续期订阅商品。</li>      <li>用户调整为相同等级的自动续期订阅商品，如果订阅商品的周期相同，则新订阅立即生效。</li>      <li>用户调整为相同等级的自动续期订阅商品，如果订阅商品的周期不相同，则新订阅在下个续期日生效。</li>      <li>用户调整为更高等级的自动续期订阅商品，则新订阅立即生效，原订阅的剩余金额将折算成新订阅的天数，延长新订阅的有效期。</li>      <li>用户调整为更低等级的自动续期订阅商品，则新订阅在下个续期日生效</li>      <li>用户主动或者App取消一个自动续期订阅商品，已经收费的服务仍然有效，但是后续续期会停止。</li>      <li>一个自动续期订阅商品成功续期。</li>      <li>一个到期的自动续期订阅商品进入账号保留期。</li>      <li>订阅的续期时间已延期。</li>     </ul>     <p>若开发者服务器返回结果为非成功响应（请求返回的HTTP状态码不为200），IAP服务器将对本次关键事件的通知进行周期性重发。建议在收到通知后立即返回成功响应，避免通知消息堆积。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>为保证可靠性，系统具备补偿机制，所以可能出现重发的通知比预期的多。</p>       <p>沙盒测试场景下通知失败不会进行重发。</p>      </div></div></div>    </div>    <div class="tiledSection">     <h2 id="section1716151320494">关键事件通知处理建议<i class="anchor-icon anchor-icon-link" anchorid="section1716151320494" tips="复制节点链接"></i></h2>          <ol>      <li>开发者服务器收到IAP服务器的关键事件通知（下文简称事件通知）时，建议根据通知内容中的购买Token，请求IAP服务器校验购买Token获取当前购买Token关联订单/订阅的最新状态，并根据订单/订阅最新状态决定是否需要提供商品服务。</li>      <li>事件通知仅作为订单/订阅状态发生变化的一个事件通知，由于网络延迟等导致服务器收到通知事件有延迟，通知中携带的信息可能与IAP服务器的最新的状态不一致，建议不要根据事件通知来决定是否提供商品服务。</li>      <li>收到DID_NEW_TRANSACTION通知类型后，建议根据如下通知处理流程进行业务逻辑处理，提供商品服务。</li>     </ol>     <p>关键事件通知处理流程建议如下：</p>     <p><span><img originheight="483" originwidth="459" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211115253.41795261613491873444881697357598:50001231000000:2800:ED0AF7FD9A2C52D89D54853D81E3F700AC1A9CC6C6D79990CB21D42F971BE2A2.png" width="459" height="483"></span></p>     <ol>      <li>IAP服务器发送订单/订阅关键事件通知。</li>      <li>应用服务器收到通知请求后，从通知中获取购买Token。</li>      <li>调用IAP服务器提供的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/iap-query-order-status">订单状态查询</a>/<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/iap-query-subscription-status">订阅状态查询</a>接口，查询购买数据及其签名数据。</li>      <li>IAP服务器返回购买数据及其签名数据。</li>      <li>校验订单/订阅状态提供商品服务。消耗型/非消耗型/非续期订阅商品请根据<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/iap-query-order-status">订单状态查询</a>接口获取消耗型/非消耗型/非续期订阅的订单最新状态，再根据订单状态调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/iap-confirm-purchase-for-order">订单确认发货</a>接口执行发货操作。自动续期订阅商品请根据<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/iap-query-subscription-status">订阅状态查询</a>接口响应经JWS解码之后SubGroupStatusPayload中的status字段决定是否发货。若status为1，则调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/iap-confirm-purchase-for-sub">订阅确认发货</a>接口执行发货操作。</li>      <li>应用服务器返回通知响应给IAP服务器。</li>     </ol>    </div>    <div class="tiledSection">     <h2 id="section1943932814710">接口约束<i class="anchor-icon anchor-icon-link" anchorid="section1943932814710" tips="复制节点链接"></i></h2>          <p>不允许开发者服务器设置IP允许清单用于限制华为侧的出口IP地址。IP允许清单本身并不能提高安全性且会给业务发展带来约束，在消息层面已有更安全的JWS签名机制条件下，没有存在价值。不遵守该约定而导致的后果将由开发者自行承担。</p>     <p>必须在开发前在<a href="https://developer.huawei.com/consumer/cn/service/josp/agc/index.html" target="_blank">AppGallery Connect</a>中配置开发者服务器的回调地址，地址必须支持HTTPS协议且具有合法商用证书，出于安全考虑，cipher需要支持ECDHE-RSA-AES128-GCM-SHA256、ECDHE-ECDSA-AES128-GCM-SHA256、ECDHE-RSA-AES256-GCM-SHA384或ECDHE-ECDSA-AES256-GCM-SHA384中至少一种，否则无法正常接收通知消息。</p>    </div>    <div class="tiledSection">     <h2 id="section20963122661013">接口原型<i class="anchor-icon anchor-icon-link" anchorid="section20963122661013" tips="复制节点链接"></i></h2>          <div class="tablenoborder">      <div class="tbBox"><table>               <tbody><tr>         <th class="firstcol" id="mcps1.3.7.2.1.3.1.1" width="20%">          <p>承载协议</p></th>         <td class="cellrowborder" width="80%">          <p>HTTPS POST</p></td>        </tr>        <tr>         <th class="firstcol" id="mcps1.3.7.2.1.3.2.1" width="20%">          <p>接口方向</p></th>         <td class="cellrowborder" width="80%">          <p>IAP服务器 -&gt; 开发者服务器</p></td>        </tr>        <tr>         <th class="firstcol" id="mcps1.3.7.2.1.3.3.1" width="20%">          <p>接口URL</p></th>         <td class="cellrowborder" width="80%">          <p>URL由开发者在申请支付服务时配置。</p></td>        </tr>        <tr>         <th class="firstcol" id="mcps1.3.7.2.1.3.4.1" width="20%">          <p>数据格式</p></th>         <td class="cellrowborder" width="80%">          <p>请求消息：Content-Type: application/json;charset=UTF-8</p>          <p>响应消息：Content-Type: application/json;charset=UTF-8</p></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="section18290165220716">请求参数<i class="anchor-icon anchor-icon-link" anchorid="section18290165220716" tips="复制节点链接"></i></h2>         </div>    <div class="tiledSection">     <h3 id="section4398518278" class="firsth2">Request Body<i class="anchor-icon anchor-icon-link" anchorid="section4398518278" tips="复制节点链接"></i></h3>          <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.9.2.1.5.1.1" width="20%">          <p>参数</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.9.2.1.5.1.2" width="15%">          <p>是否必选</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.9.2.1.5.1.3" width="15%">          <p>参数类型</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.9.2.1.5.1.4" width="50%">          <p>描述</p></th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">          <p>jwsNotification</p></td>         <td class="cellrowborder" width="15%">          <p>是</p></td>         <td class="cellrowborder" width="15%">          <p>String</p></td>         <td class="cellrowborder" width="50%">          <p>通知内容信息，对通知内容NotificationPayload签名后的字符串。具体请参见表<a href="/consumer/cn/doc/harmonyos-references/iap-key-event-notifications#section6960203212276">NotificationPayload</a>。</p>          <p>需要参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/iap-verifying-signature">对返回结果验签</a>使用JWS签名方式对NotificationPayload消息体进行验签。</p></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h3 id="section6960203212276">NotificationPayload<i class="anchor-icon anchor-icon-link" anchorid="section6960203212276" tips="复制节点链接"></i></h3>          <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.10.2.1.5.1.1" width="20%">          <p>参数</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.10.2.1.5.1.2" width="15%">          <p>是否必选</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.10.2.1.5.1.3" width="15%">          <p>参数类型</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.10.2.1.5.1.4" width="50%">          <p>描述</p></th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">          <p>notificationType</p></td>         <td class="cellrowborder" width="15%">          <p>是</p></td>         <td class="cellrowborder" width="15%">          <p>String</p></td>         <td class="cellrowborder" width="50%">          <p>通知主类型，具体请参见表<a href="/consumer/cn/doc/harmonyos-references/iap-key-event-notifications#section161113819282">NotificationType</a>说明。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">          <p>notificationSubtype</p></td>         <td class="cellrowborder" width="15%">          <p>否</p></td>         <td class="cellrowborder" width="15%">          <p>String</p></td>         <td class="cellrowborder" width="50%">          <p>通知子类型，具体请参见表<a href="/consumer/cn/doc/harmonyos-references/iap-key-event-notifications#section16254133782813">NotificationSubtype</a>说明。后续子类型会增加，开发者需要设计相应的处理机制。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">          <p>notificationRequestId</p></td>         <td class="cellrowborder" width="15%">          <p>是</p></td>         <td class="cellrowborder" width="15%">          <p>String</p></td>         <td class="cellrowborder" width="50%">          <p>通知唯一请求ID。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">          <p>notificationMetaData</p></td>         <td class="cellrowborder" width="15%">          <p>是</p></td>         <td class="cellrowborder" width="15%">          <p>Object</p></td>         <td class="cellrowborder" width="50%">          <p>通知元数据，具体请参见表<a href="/consumer/cn/doc/harmonyos-references/iap-key-event-notifications#section526717832913">NotificationMetaData</a>说明。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">          <p>notificationVersion</p></td>         <td class="cellrowborder" width="15%">          <p>是</p></td>         <td class="cellrowborder" width="15%">          <p>String</p></td>         <td class="cellrowborder" width="50%">          <p>通知版本：v3。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">          <p>signedTime</p></td>         <td class="cellrowborder" width="15%">          <p>是</p></td>         <td class="cellrowborder" width="15%">          <p>Long</p></td>         <td class="cellrowborder" width="50%">          <p>通知签名时间，UTC时间戳，以毫秒为单位。</p></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h3 id="section161113819282">NotificationType<i class="anchor-icon anchor-icon-link" anchorid="section161113819282" tips="复制节点链接"></i></h3>          <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.11.2.1.3.1.1" width="31.34%">          <p>取值</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.11.2.1.3.1.2" width="68.66%">          <p>取值说明</p></th>        </tr><tr>         <td class="cellrowborder" width="31.34%">          <p>DID_NEW_TRANSACTION</p></td>         <td class="cellrowborder" width="68.66%">          <p>订单已购买/订阅已购买/订阅续订成功。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="31.34%">          <p>DID_CHANGE_RENEWAL_STATUS</p></td>         <td class="cellrowborder" width="68.66%">          <p>订阅状态发生改变。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="31.34%">          <p>REVOKE</p></td>         <td class="cellrowborder" width="68.66%">          <p>订单退款/撤销订阅。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="31.34%">          <p>RENEWAL_TIME_MODIFIED</p></td>         <td class="cellrowborder" width="68.66%">          <p>订阅过期时间调整。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="31.34%">          <p>EXPIRE</p></td>         <td class="cellrowborder" width="68.66%">          <p>订阅已过期。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="31.34%">          <p>TEST</p></td>         <td class="cellrowborder" width="68.66%">          <p>测试服务端通知，仅开发者调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/iap-server-notifications-test">测试服务端通知</a>接口才会发送此类型通知。</p>          <p>此场景下无notificationSubtype。</p></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h3 id="section16254133782813">NotificationSubtype<i class="anchor-icon anchor-icon-link" anchorid="section16254133782813" tips="复制节点链接"></i></h3>          <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.12.2.1.3.1.1" width="31.34%">          <p>取值</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.12.2.1.3.1.2" width="68.66%">          <p>取值说明</p></th>        </tr><tr>         <td class="cellrowborder" width="31.34%">          <p>INITIAL_BUY</p></td>         <td class="cellrowborder" width="68.66%">          <p>消耗型/非消耗型/非续期订阅商品购买成功。</p>          <p>自动续期订阅商品的第一次购买成功。</p>          <p>使用主类型：DID_NEW_TRANSACTION</p></td>        </tr>        <tr>         <td class="cellrowborder" width="31.34%">          <p>DID_RENEW</p></td>         <td class="cellrowborder" width="68.66%">          <p>续期成功。</p>          <p>使用主类型：DID_NEW_TRANSACTION</p></td>        </tr>        <tr>         <td class="cellrowborder" width="31.34%">          <p>RESTORE</p></td>         <td class="cellrowborder" width="68.66%">          <p>用户主动恢复了一个订阅型商品，续期恢复正常。</p>          <p>使用主类型：DID_NEW_TRANSACTION</p></td>        </tr>        <tr>         <td class="cellrowborder" width="31.34%">          <p>AUTO_RENEW_ENABLED</p></td>         <td class="cellrowborder" width="68.66%">          <p>自动续期功能开启。</p>          <p>使用主类型：DID_CHANGE_RENEWAL_STATUS</p></td>        </tr>        <tr>         <td class="cellrowborder" width="31.34%">          <p>AUTO_RENEW_DISABLED</p></td>         <td class="cellrowborder" width="68.66%">          <p>自动续期功能关闭。</p>          <p>使用主类型：DID_CHANGE_RENEWAL_STATUS</p></td>        </tr>        <tr>         <td class="cellrowborder" width="31.34%">          <p>DOWNGRADE</p></td>         <td class="cellrowborder" width="68.66%">          <p>用户调整自动续期订阅商品降级或跨级且在下个续订生效。</p>          <p>使用主类型：DID_CHANGE_RENEWAL_STATUS或DID_NEW_TRANSACTION</p></td>        </tr>        <tr>         <td class="cellrowborder" width="31.34%">          <p>UPGRADE</p></td>         <td class="cellrowborder" width="68.66%">          <p>用户调整自动续期订阅商品升级或跨级且立即生效。</p>          <p>使用主类型：DID_NEW_TRANSACTION</p></td>        </tr>        <tr>         <td class="cellrowborder" width="31.34%">          <p>REFUND_TRANSACTION</p></td>         <td class="cellrowborder" width="68.66%">          <p>消耗型/非消耗型/非续期订阅商品订单退款成功。</p>          <p>自动续期订阅商品订单退款成功。</p>          <p>使用主类型：REVOKE</p></td>        </tr>        <tr>         <td class="cellrowborder" width="31.34%">          <p>BILLING_RETRY</p></td>         <td class="cellrowborder" width="68.66%">          <p>一个到期的自动续期订阅商品进入账号保留期。</p>          <p>使用主类型：EXPIRE</p></td>        </tr>        <tr>         <td class="cellrowborder" width="31.34%">          <p>PRICE_INCREASE</p></td>         <td class="cellrowborder" width="68.66%">          <p>用户同意了涨价。</p>          <p>使用主类型：DID_CHANGE_RENEWAL_STATUS</p></td>        </tr>        <tr>         <td class="cellrowborder" width="31.34%">          <p>BILLING_RECOVERY</p></td>         <td class="cellrowborder" width="68.66%">          <p>订阅重试扣费成功。</p>          <p>使用主类型：DID_NEW_TRANSACTION</p></td>        </tr>        <tr>         <td class="cellrowborder" width="31.34%">          <p>VOLUNTARY</p></td>         <td class="cellrowborder" width="68.66%">          <p>主动退订后订阅过期。</p>          <p>使用主类型：EXPIRE</p></td>        </tr>        <tr>         <td class="cellrowborder" width="31.34%">          <p>PRODUCT_NOT_FOR_SALE</p></td>         <td class="cellrowborder" width="68.66%">          <p>商品不存在。</p>          <p>使用主类型：EXPIRE</p></td>        </tr>        <tr>         <td class="cellrowborder" width="31.34%">          <p>APPLICATION_DELETE_SUBSCRIPTION_HOSTING</p></td>         <td class="cellrowborder" width="68.66%">          <p>撤销订阅成功，订阅权益会立即取消。</p>          <p>使用主类型：REVOKE</p></td>        </tr>        <tr>         <td class="cellrowborder" width="31.34%">          <p>RENEWAL_EXTENDED</p></td>         <td class="cellrowborder" width="68.66%">          <p>延迟订阅续订日期成功，订阅的下一个续订日期将推迟。</p>          <p>使用主类型：RENEWAL_TIME_MODIFIED</p></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h3 id="section526717832913">NotificationMetaData<i class="anchor-icon anchor-icon-link" anchorid="section526717832913" tips="复制节点链接"></i></h3>          <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.13.2.1.5.1.1" width="20%">          <p>参数</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.13.2.1.5.1.2" width="15%">          <p>是否必选</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.13.2.1.5.1.3" width="15%">          <p>参数类型</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.13.2.1.5.1.4" width="50%">          <p>描述</p></th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">          <p>environment</p></td>         <td class="cellrowborder" width="15%">          <p>是</p></td>         <td class="cellrowborder" width="15%">          <p>String</p></td>         <td class="cellrowborder" width="50%">          <p>环境类型。</p>          <ul>           <li>NORMAL：正式环境</li>           <li>SANDBOX：沙盒环境</li>          </ul></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">          <p>applicationId</p></td>         <td class="cellrowborder" width="15%">          <p>是</p></td>         <td class="cellrowborder" width="15%">          <p>String</p></td>         <td class="cellrowborder" width="50%">          <p>应用Id。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">          <p>packageName</p></td>         <td class="cellrowborder" width="15%">          <p>是</p></td>         <td class="cellrowborder" width="15%">          <p>String</p></td>         <td class="cellrowborder" width="50%">          <p>应用包名。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">          <p>type</p></td>         <td class="cellrowborder" width="15%">          <p>是</p></td>         <td class="cellrowborder" width="15%">          <p>Integer</p></td>         <td class="cellrowborder" width="50%">          <p>商品类型。</p>          <ul>           <li>0：消耗型商品</li>           <li>1：非消耗型商品</li>           <li>2：自动续期订阅商品</li>           <li>3：非续期订阅商品</li>          </ul></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">          <p>currentProductId</p></td>         <td class="cellrowborder" width="15%">          <p>否</p></td>         <td class="cellrowborder" width="15%">          <p>String</p></td>         <td class="cellrowborder" width="50%">          <p>最近一个有效订阅的商品ID。仅自动续期订阅商品场景下存在值。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">          <p>subGroupId</p></td>         <td class="cellrowborder" width="15%">          <p>否</p></td>         <td class="cellrowborder" width="15%">          <p>String</p></td>         <td class="cellrowborder" width="50%">          <p>订阅组ID。仅自动续期订阅商品场景下存在值。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">          <p>subGroupGenerationId</p></td>         <td class="cellrowborder" width="15%">          <p>否</p></td>         <td class="cellrowborder" width="15%">          <p>String</p></td>         <td class="cellrowborder" width="50%">          <p id="ZH-CN_TOPIC_0000002446613073__zh-cn_topic_0000002446613081_p10186123284210">订阅组的代ID。</p>          <ul id="ZH-CN_TOPIC_0000002446613073__zh-cn_topic_0000002446613081_ul1718611324420">           <li id="zh-cn_topic_0000002446613081_li818673214213">用户切换订阅商品时，此ID不会改变。</li>           <li id="zh-cn_topic_0000002446613081_li141861032164214">订阅失效且超出<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/iap-subscription-functions#section1656191811315" target="_blank">保留期</a>后，用户重新购买商品时，此ID会改变。</li>          </ul></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">          <p>subscriptionId</p></td>         <td class="cellrowborder" width="15%">          <p>否</p></td>         <td class="cellrowborder" width="15%">          <p>String</p></td>         <td class="cellrowborder" width="50%">          <p id="ZH-CN_TOPIC_0000002446613073__zh-cn_topic_0000002446613081_p1263810572423">商品的订阅ID。以下场景，此ID会发生改变：</p>          <ul id="ZH-CN_TOPIC_0000002446613073__zh-cn_topic_0000002446613081_ul1639115714211">           <li id="zh-cn_topic_0000002446613081_li463995712426">用户切换订阅商品时。</li>           <li id="zh-cn_topic_0000002446613081_li663917572424">订阅失效且超出<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/iap-subscription-functions#section1656191811315" target="_blank">保留期</a>后，用户重新购买商品时。</li>          </ul></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">          <p>purchaseToken</p></td>         <td class="cellrowborder" width="15%">          <p>是</p></td>         <td class="cellrowborder" width="15%">          <p>String</p></td>         <td class="cellrowborder" width="50%">          <p>商品的购买Token，发起购买和查询订阅信息均会返回。最大长度256。</p></td>        </tr>        <tr>         <td class="cellrowborder" width="20%">          <p>purchaseOrderId</p></td>         <td class="cellrowborder" width="15%">          <p>否</p></td>         <td class="cellrowborder" width="15%">          <p>String</p></td>         <td class="cellrowborder" width="50%">          <p>具体一笔订单中对应的购买订单号。当NotificationType为DID_CHANGE_RENEWAL_STATUS且NotificationSubtype为DOWNGRADE时不返回purchaseOrderId。</p>          <p>最大长度256。</p></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="section165473512435">请求示例<i class="anchor-icon anchor-icon-link" anchorid="section165473512435" tips="复制节点链接"></i></h2>          <div _ngcontent-ukm-c106="" class="highlight-div"><div _ngcontent-ukm-c106="" class="highlight-div-header"><div _ngcontent-ukm-c106="" class="highlight-div-header-left"><div _ngcontent-ukm-c106="" class="handle-button expand-button"><div _ngcontent-ukm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ukm-c106="" class="highlight-div-header-right"><div _ngcontent-ukm-c106="" class="handle-button ai-button"></div><div _ngcontent-ukm-c106="" class="handle-button line-button"><div _ngcontent-ukm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ukm-c106="" class="handle-button theme-button"><div _ngcontent-ukm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ukm-c106="" class="handle-button copy-button"><div _ngcontent-ukm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ukm-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-variable">POST</span> /<span class="hljs-variable">notify</span>/<span class="hljs-variable">address</span></li><li><span class="hljs-variable">Content</span>-<span class="hljs-variable">Type</span>: <span class="hljs-title class_">application</span>/<span class="hljs-variable">json</span>;<span class="hljs-variable">charset</span>=<span class="hljs-variable">UTF</span>-<span class="hljs-number">8</span></li><li><span class="hljs-variable">Accept</span>: <span class="hljs-title class_">application</span>/<span class="hljs-variable">json</span></li><li>{</li><li>  <span class="hljs-string">"jwsNotification"</span>: <span class="hljs-string">"***"</span></li><li>}</li></ol></pre></div></div>     <p>NotificationPayload样例（消耗型/非消耗型）</p>     <div _ngcontent-ukm-c106="" class="highlight-div"><div _ngcontent-ukm-c106="" class="highlight-div-header"><div _ngcontent-ukm-c106="" class="highlight-div-header-left"><div _ngcontent-ukm-c106="" class="handle-button expand-button"><div _ngcontent-ukm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ukm-c106="" class="highlight-div-header-right"><div _ngcontent-ukm-c106="" class="handle-button ai-button"></div><div _ngcontent-ukm-c106="" class="handle-button line-button"><div _ngcontent-ukm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ukm-c106="" class="handle-button theme-button"><div _ngcontent-ukm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ukm-c106="" class="handle-button copy-button"><div _ngcontent-ukm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ukm-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" data-highlighted="yes"><ol class="linenums"><li>{</li><li>  <span class="hljs-string">"notificationType"</span>: <span class="hljs-string">"DID_NEW_TRANSACTION"</span>,</li><li>  <span class="hljs-string">"notificationSubtype"</span>: <span class="hljs-string">"INITIAL_BUY"</span>,</li><li>  <span class="hljs-string">"notificationRequestId"</span>: <span class="hljs-string">"7f67e39aa72d1a55f36293047f9769c0aa47a467ffb110eaeeeb888def9f9713"</span>,</li><li>  <span class="hljs-string">"notificationMetaData"</span>: {</li><li>    <span class="hljs-string">"environment"</span>: <span class="hljs-string">"NORMAL"</span>,</li><li>    <span class="hljs-string">"applicationId"</span>: <span class="hljs-string">"***"</span>,</li><li>    <span class="hljs-string">"packageName"</span>: <span class="hljs-string">"***"</span>,</li><li>    <span class="hljs-string">"type"</span>: <span class="hljs-number">0</span>,</li><li>    <span class="hljs-string">"purchaseToken"</span>: <span class="hljs-string">"***.*.***"</span>,</li><li>    <span class="hljs-string">"purchaseOrderId"</span>: <span class="hljs-string">"***.***"</span></li><li>  },</li><li>  <span class="hljs-string">"notificationVersion"</span>: <span class="hljs-string">"v3"</span>,</li><li>  <span class="hljs-string">"signedTime"</span>: <span class="hljs-number">1702607152698</span></li><li>}</li></ol></pre></div></div>     <p>NotificationPayload样例（非续期订阅商品）</p>     <div _ngcontent-ukm-c106="" class="highlight-div"><div _ngcontent-ukm-c106="" class="highlight-div-header"><div _ngcontent-ukm-c106="" class="highlight-div-header-left"><div _ngcontent-ukm-c106="" class="handle-button expand-button"><div _ngcontent-ukm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ukm-c106="" class="highlight-div-header-right"><div _ngcontent-ukm-c106="" class="handle-button ai-button"></div><div _ngcontent-ukm-c106="" class="handle-button line-button"><div _ngcontent-ukm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ukm-c106="" class="handle-button theme-button"><div _ngcontent-ukm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ukm-c106="" class="handle-button copy-button"><div _ngcontent-ukm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ukm-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" data-highlighted="yes"><ol class="linenums"><li>{</li><li>  <span class="hljs-string">"notificationType"</span>: <span class="hljs-string">"DID_NEW_TRANSACTION"</span>,</li><li>  <span class="hljs-string">"notificationSubtype"</span>: <span class="hljs-string">"INITIAL_BUY"</span>,</li><li>  <span class="hljs-string">"notificationRequestId"</span>: <span class="hljs-string">"7f67e39aa72d1a55f36293047f9769c0aa47a467ffb110eaeeeb888def9f9713"</span>,</li><li>  <span class="hljs-string">"notificationMetaData"</span>: {</li><li>    <span class="hljs-string">"environment"</span>: <span class="hljs-string">"NORMAL"</span>,</li><li>    <span class="hljs-string">"applicationId"</span>: <span class="hljs-string">"***"</span>,</li><li>    <span class="hljs-string">"packageName"</span>: <span class="hljs-string">"***"</span>,</li><li>    <span class="hljs-string">"type"</span>: <span class="hljs-number">3</span>,</li><li>    <span class="hljs-string">"purchaseToken"</span>: <span class="hljs-string">"***.*.***"</span>,</li><li>    <span class="hljs-string">"purchaseOrderId"</span>: <span class="hljs-string">"***.***"</span></li><li>  },</li><li>  <span class="hljs-string">"notificationVersion"</span>: <span class="hljs-string">"v3"</span>,</li><li>  <span class="hljs-string">"signedTime"</span>: <span class="hljs-number">1702607152698</span></li><li>}</li></ol></pre></div></div>     <p>NotificationPayload样例（自动续期订阅商品）</p>     <div _ngcontent-ukm-c106="" class="highlight-div"><div _ngcontent-ukm-c106="" class="highlight-div-header"><div _ngcontent-ukm-c106="" class="highlight-div-header-left"><div _ngcontent-ukm-c106="" class="handle-button expand-button"><div _ngcontent-ukm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ukm-c106="" class="highlight-div-header-right"><div _ngcontent-ukm-c106="" class="handle-button ai-button"></div><div _ngcontent-ukm-c106="" class="handle-button line-button"><div _ngcontent-ukm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ukm-c106="" class="handle-button theme-button"><div _ngcontent-ukm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ukm-c106="" class="handle-button copy-button"><div _ngcontent-ukm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ukm-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" data-highlighted="yes"><ol class="linenums"><li>{</li><li>  <span class="hljs-string">"notificationType"</span>: <span class="hljs-string">"DID_NEW_TRANSACTION"</span>,</li><li>  <span class="hljs-string">"notificationSubtype"</span>: <span class="hljs-string">"INITIAL_BUY"</span>,</li><li>  <span class="hljs-string">"notificationRequestId"</span>: <span class="hljs-string">"6d5882d55c8e5136f2348b8e13b4aaad6d0938898b7e5efdc13f7c7130286f8c"</span>,</li><li>  <span class="hljs-string">"notificationMetaData"</span>: {</li><li>    <span class="hljs-string">"environment"</span>: <span class="hljs-string">"NORMAL"</span>,</li><li>    <span class="hljs-string">"applicationId"</span>: <span class="hljs-string">"***"</span>,</li><li>    <span class="hljs-string">"packageName"</span>: <span class="hljs-string">"***"</span>,</li><li>    <span class="hljs-string">"type"</span>: <span class="hljs-number">2</span>,</li><li>    <span class="hljs-string">"currentProductId"</span>: <span class="hljs-string">"1701072721154732"</span>,</li><li>    <span class="hljs-string">"subGroupId"</span>: <span class="hljs-string">"1701072721154732"</span>,</li><li>    <span class="hljs-string">"subGroupGenerationId"</span>: <span class="hljs-string">"f7967e2439769fbb3c155a50d2cdd6a8cc8f7750cac7bf78b6f5d65c97c34deb"</span>,</li><li>    <span class="hljs-string">"subscriptionId"</span>: <span class="hljs-string">"1701072722814.ADE66B39.4732"</span>,</li><li>    <span class="hljs-string">"purchaseToken"</span>: <span class="hljs-string">"***.*.***"</span>,</li><li>    <span class="hljs-string">"purchaseOrderId"</span>: <span class="hljs-string">"***.***"</span></li><li>  },</li><li>  <span class="hljs-string">"notificationVersion"</span>: <span class="hljs-string">"v3"</span>,</li><li>  <span class="hljs-string">"signedTime"</span>: <span class="hljs-number">1701072726860</span></li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="section239612436136">响应参数<i class="anchor-icon anchor-icon-link" anchorid="section239612436136" tips="复制节点链接"></i></h2>          <p>通过HTTP状态码来标识IAP服务器通知开发者服务器是否发送成功：</p>     <ul>      <li>如果通知发送成功，则发送HTTP 200，不需要返回响应体。</li>      <li>如果通知发送失败，则通过发送HTTP 40X或者HTTP 50X，告知IAP服务器进行重试，IAP服务器会在一段时间内重试多次。</li>     </ul>    </div>    <div class="tiledSection">     <h2 id="section693011533393">响应示例<i class="anchor-icon anchor-icon-link" anchorid="section693011533393" tips="复制节点链接"></i></h2>          <div _ngcontent-ukm-c106="" class="highlight-div"><div _ngcontent-ukm-c106="" class="highlight-div-header"><div _ngcontent-ukm-c106="" class="highlight-div-header-left"><div _ngcontent-ukm-c106="" class="handle-button expand-button"><div _ngcontent-ukm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ukm-c106="" class="highlight-div-header-right"><div _ngcontent-ukm-c106="" class="handle-button ai-button"></div><div _ngcontent-ukm-c106="" class="handle-button line-button"><div _ngcontent-ukm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ukm-c106="" class="handle-button theme-button"><div _ngcontent-ukm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ukm-c106="" class="handle-button copy-button"><div _ngcontent-ukm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ukm-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-undefined" data-highlighted="yes"><ol class="linenums"><li>HTTP/1.2 200 OK</li></ol></pre></div></div>    </div>   </div>   <div></div></div>