<h1 _ngcontent-wkr-c119="" class="doc-title ng-star-inserted" title="状态变量变化监听"> 状态变量变化监听 </h1>

<div _ngcontent-wkr-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p>状态变量监听模块提供了对状态变量变化的感知能力。</p>    <p>本文档仅为API参考说明。实际功能使用与限制见各接口对应的开发指南。</p>    <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">      <p>本模块首批接口从API version 7开始支持。后续版本的新增接口，采用上角标单独标记接口的起始版本。</p>     </div></div></div>    <div class="tiledSection">     <h2 id="watch" device-type="phone,2in1,tablet,wearable,tv">Watch<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="watch" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>Watch: (value: string) =&gt; PropertyDecorator</p>     <p>@Watch装饰器用于状态管理V1中对状态变量变化的监听。@Watch的详细使用方式见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-watch" target="_blank">@Watch装饰器：状态变量更改通知</a>。</p>     <p><strong>卡片能力：</strong> 从API version 9开始，该接口支持在ArkTS卡片中使用。</p>     <p><strong>元服务API：</strong> 从API version 11开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力：</strong> SystemCapability.ArkUI.ArkUI.Full</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.4.8.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.4.8.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.4.8.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.4.8.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">value</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">用于监听的回调函数名，内容由开发者指定。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.4.10.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.4.10.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">PropertyDecorator</td>         <td class="cellrowborder" width="50%">属性装饰器，开发者无需关注该返回值。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wkr-c106="" class="highlight-div"><div _ngcontent-wkr-c106="" class="highlight-div-header"><div _ngcontent-wkr-c106="" class="highlight-div-header-left"><div _ngcontent-wkr-c106="" class="handle-button expand-button"><div _ngcontent-wkr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wkr-c106="" class="highlight-div-header-right"><div _ngcontent-wkr-c106="" class="handle-button ai-button"></div><div _ngcontent-wkr-c106="" class="handle-button line-button"><div _ngcontent-wkr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wkr-c106="" class="handle-button theme-button"><div _ngcontent-wkr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wkr-c106="" class="handle-button copy-button"><div _ngcontent-wkr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wkr-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-meta">@Watch</span>(<span class="hljs-string">'onChange'</span>) <span class="hljs-attr">num</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>; <span class="hljs-comment">// @Watch入参为函数名</span></li><li>  <span class="hljs-title function_">onChange</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`num change to <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.num}</span>`</span>);</li><li>  }</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`num is: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.num}</span>`</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">num</span>++; <span class="hljs-comment">// 会触发onChange函数回调</span></li><li>        })</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="monitor12" device-type="phone,2in1,tablet,wearable,tv">Monitor<sup>12+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="monitor12" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>Monitor: MonitorDecorator</p>     <p>@Monitor装饰器用于状态管理V2中对状态变量变化的监听。@Monitor相关内容的详细使用方式见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-new-monitor" target="_blank">@Monitor装饰器：状态变量修改监听</a>。</p>     <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力：</strong> SystemCapability.ArkUI.ArkUI.Full</p>    </div>    <div class="tiledSection">     <h2 id="monitordecorator12" device-type="phone,2in1,tablet,wearable,tv">MonitorDecorator<sup>12+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="monitordecorator12" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>type MonitorDecorator = (value: string, ...args: string[]) =&gt; MethodDecorator</p>     <p>@Monitor装饰器的实际类型。</p>     <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力：</strong> SystemCapability.ArkUI.ArkUI.Full</p>     <p><strong>参数</strong>：</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.6.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.6.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.6.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.6.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">value</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">是</td>         <td class="cellrowborder" width="25%">用于监听的变量名路径，内容由开发者指定。当开发者仅传入一个字符串时，入参为该类型。</td>        </tr>        <tr>         <td class="cellrowborder" width="25%">...args</td>         <td class="cellrowborder" width="25%">string[]</td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">用于监听的变量名路径数组，内容由开发者指定。当开发者传入多个字符串时，入参为该类型。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.6.9.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.6.9.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%">MethodDecorator</td>         <td class="cellrowborder" width="50%">方法装饰器，开发者无需关注该返回值。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wkr-c106="" class="highlight-div"><div _ngcontent-wkr-c106="" class="highlight-div-header"><div _ngcontent-wkr-c106="" class="highlight-div-header-left"><div _ngcontent-wkr-c106="" class="handle-button expand-button"><div _ngcontent-wkr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wkr-c106="" class="highlight-div-header-right"><div _ngcontent-wkr-c106="" class="handle-button ai-button"></div><div _ngcontent-wkr-c106="" class="handle-button line-button"><div _ngcontent-wkr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wkr-c106="" class="handle-button theme-button"><div _ngcontent-wkr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wkr-c106="" class="handle-button copy-button"><div _ngcontent-wkr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wkr-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@ObservedV2</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Info</span> {</li><li>  <span class="hljs-meta">@Trace</span> <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'Tom'</span>;</li><li>  <span class="hljs-meta">@Trace</span> <span class="hljs-attr">age</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">25</span>;</li><li>  <span class="hljs-meta">@Trace</span> <span class="hljs-attr">height</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">175</span>;</li><li>  <span class="hljs-meta">@Monitor</span>(<span class="hljs-string">'name'</span>) <span class="hljs-comment">// 监听一个变量</span></li><li>  <span class="hljs-title function_">onNameChange</span>(<span class="hljs-params">monitor: IMonitor</span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`name change to <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.name}</span>`</span>);</li><li>  }</li><li>  <span class="hljs-meta">@Monitor</span>(<span class="hljs-string">'age'</span>, <span class="hljs-string">'height'</span>) <span class="hljs-comment">// 监听多个变量</span></li><li>  <span class="hljs-title function_">onRecordChange</span>(<span class="hljs-params">monitor: IMonitor</span>) {</li><li>    monitor.<span class="hljs-property">dirty</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">path: <span class="hljs-built_in">string</span></span>) =&gt;</span> {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`<span class="hljs-subst">${path}</span> change from <span class="hljs-subst">${monitor.value(path)?.before}</span> to <span class="hljs-subst">${monitor.value(path)?.now}</span>`</span>);</li><li>    })</li><li>  }</li><li>}</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@ComponentV2</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-meta">@Local</span> <span class="hljs-attr">info</span>: <span class="hljs-title class_">Info</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Info</span>();</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`info.name: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.info.name}</span>`</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">info</span>.<span class="hljs-property">name</span> = <span class="hljs-string">'Bob'</span>; <span class="hljs-comment">// 输出日志：name change to Bob</span></li><li>        })</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`info.age: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.info.age}</span>, info.height: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.info.height}</span>`</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">info</span>.<span class="hljs-property">age</span>++; <span class="hljs-comment">// 输出日志：age change from 25 to 26</span></li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">info</span>.<span class="hljs-property">height</span>++; <span class="hljs-comment">// 输出日志：height change from 175 to 176</span></li><li>        })</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="imonitor12" device-type="phone,2in1,tablet,wearable,tv">IMonitor<sup>12+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="imonitor12" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>当监听的变量变化时，状态管理框架侧将回调开发者注册的函数，并传入变化信息。变化信息的类型即为IMonitor类型。</p>    </div>    <div class="tiledSection">     <h3 id="属性" device-type="phone,2in1,tablet,wearable,tv" class="firsth2">属性<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="属性" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力：</strong> SystemCapability.ArkUI.ArkUI.Full</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.8.4.1.6.1.1" width="20%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.8.4.1.6.1.2" width="20%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.8.4.1.6.1.3" width="20%">只读</th>         <th align="left" class="cellrowborder" id="mcps1.3.8.4.1.6.1.4" width="20%">可选</th>         <th align="left" class="cellrowborder" id="mcps1.3.8.4.1.6.1.5" width="20%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">dirty<sup>12+</sup></td>         <td class="cellrowborder" width="20%">Array&lt;string&gt;</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">变化路径的数组。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h3 id="value12" device-type="phone,2in1,tablet,wearable,tv">value<sup>12+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="value12" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>value&lt;T&gt;(path?: string): IMonitorValue&lt;T&gt; | undefined</p>     <p>获取指定path的变化信息。</p>     <p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力：</strong> SystemCapability.ArkUI.ArkUI.Full</p>     <p><strong>参数：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.9.7.1.5.1.1" width="25%">参数名</th>         <th align="left" class="cellrowborder" id="mcps1.3.9.7.1.5.1.2" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.9.7.1.5.1.3" width="25%">必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.9.7.1.5.1.4" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="25%">path</td>         <td class="cellrowborder" width="25%">string</td>         <td class="cellrowborder" width="25%">否</td>         <td class="cellrowborder" width="25%">可选，被监听的变量路径名。未指定时默认使用变化路径数组dirty中的第一个路径。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>返回值：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="tableClass2_t">                      <tbody><tr class="firstRow">         <th align="left" class="cellrowborder" id="mcps1.3.9.9.1.3.1.1" width="50%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.9.9.1.3.1.2" width="50%">说明</th>        </tr><tr>         <td class="cellrowborder" width="50%"><a href="/consumer/cn/doc/harmonyos-references/ts-state-management-watch-monitor#imonitorvaluet12">IMonitorValue&lt;T&gt;</a> | undefined</td>         <td class="cellrowborder" width="50%">          <p>@Monitor监听变量的路径以及变化前后值信息。</p>          <p>T为监听变量的类型。</p>          <p>当监听的路径不存在时，返回undefined。</p>          <p>当未指定路径时，默认返回变化路径数组dirty中第一个路径对应的信息。</p></td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wkr-c106="" class="highlight-div"><div _ngcontent-wkr-c106="" class="highlight-div-header"><div _ngcontent-wkr-c106="" class="highlight-div-header-left"><div _ngcontent-wkr-c106="" class="handle-button expand-button"><div _ngcontent-wkr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wkr-c106="" class="highlight-div-header-right"><div _ngcontent-wkr-c106="" class="handle-button ai-button"></div><div _ngcontent-wkr-c106="" class="handle-button line-button"><div _ngcontent-wkr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wkr-c106="" class="handle-button theme-button"><div _ngcontent-wkr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wkr-c106="" class="handle-button copy-button"><div _ngcontent-wkr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wkr-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@ObservedV2</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Info</span> {</li><li>  <span class="hljs-meta">@Trace</span> <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'Tom'</span>;</li><li>  <span class="hljs-meta">@Trace</span> <span class="hljs-attr">age</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">25</span>;</li><li>  <span class="hljs-meta">@Trace</span> <span class="hljs-attr">height</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">175</span>;</li><li>  <span class="hljs-meta">@Monitor</span>(<span class="hljs-string">'name'</span>) <span class="hljs-comment">// 监听一个变量</span></li><li>  <span class="hljs-title function_">onNameChange</span>(<span class="hljs-params">monitor: IMonitor</span>) {</li><li>    <span class="hljs-comment">// 未指定value的入参时，默认使用dirty中的第一个路径作为入参</span></li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`path: <span class="hljs-subst">${monitor.value()?.path}</span> change from <span class="hljs-subst">${monitor.value()?.before}</span> to <span class="hljs-subst">${monitor.value()?.now}</span>`</span>);</li><li>  }</li><li>  <span class="hljs-meta">@Monitor</span>(<span class="hljs-string">'age'</span>, <span class="hljs-string">'height'</span>) <span class="hljs-comment">// 监听多个变量</span></li><li>  <span class="hljs-title function_">onRecordChange</span>(<span class="hljs-params">monitor: IMonitor</span>) {</li><li>    <span class="hljs-comment">// 指定value的入参时，将返回入参路径path对应的变量变化值信息</span></li><li>    monitor.<span class="hljs-property">dirty</span>.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">path: <span class="hljs-built_in">string</span></span>) =&gt;</span> {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`path: <span class="hljs-subst">${path}</span> change from <span class="hljs-subst">${monitor.value(path)?.before}</span> to <span class="hljs-subst">${monitor.value(path)?.now}</span>`</span>);</li><li>    })</li><li>  }</li><li>}</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@ComponentV2</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-meta">@Local</span> <span class="hljs-attr">info</span>: <span class="hljs-title class_">Info</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Info</span>();</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`info.name: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.info.name}</span>`</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">info</span>.<span class="hljs-property">name</span> = <span class="hljs-string">'Bob'</span>; <span class="hljs-comment">// 输出日志：path: name change from Tom to Bob</span></li><li>        })</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`info.age: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.info.age}</span>, info.height: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.info.height}</span>`</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">info</span>.<span class="hljs-property">age</span>++; <span class="hljs-comment">// 输出日志：path: age change from 25 to 26</span></li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">info</span>.<span class="hljs-property">height</span>++; <span class="hljs-comment">// 输出日志：path: height change from 175 to 176</span></li><li>        })</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="imonitorvaluet12" device-type="phone,2in1,tablet,wearable,tv">IMonitorValue&lt;T&gt;<sup>12+</sup><i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="imonitorvaluet12" tips="复制节点链接"></i></h2>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p>@Monitor监听变量变化的具体信息，通过IMonitor的value接口获取。T为变量类型。</p>    </div>    <div class="tiledSection">     <h3 id="属性-1" device-type="phone,2in1,tablet,wearable,tv" class="firsth2">属性<i class="anchor-icon anchor-icon-device active" active-tips="隐藏支持设备" tips="显示支持设备"></i><i class="anchor-icon anchor-icon-link" anchorid="属性-1" tips="复制节点链接"></i></h3>          <div class="device-list active"><span class="support-device-pre">支持设备</span><span class="support-device-item">Phone</span><span class="support-device-item">PC/2in1</span><span class="support-device-item">Tablet</span><span class="support-device-item">TV</span><span class="support-device-item">Wearable</span></div><p><strong>元服务API：</strong> 从API version 12开始，该接口支持在元服务中使用。</p>     <p><strong>系统能力：</strong> SystemCapability.ArkUI.ArkUI.Full</p>     <div class="tablenoborder">      <div class="tbBox"><table>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.11.4.1.6.1.1" width="20%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.11.4.1.6.1.2" width="20%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.11.4.1.6.1.3" width="20%">只读</th>         <th align="left" class="cellrowborder" id="mcps1.3.11.4.1.6.1.4" width="20%">可选</th>         <th align="left" class="cellrowborder" id="mcps1.3.11.4.1.6.1.5" width="20%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" width="20%">before<sup>12+</sup></td>         <td class="cellrowborder" width="20%">T</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">变量变化前的值。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">now<sup>12+</sup></td>         <td class="cellrowborder" width="20%">T</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">变量当前的值。</td>        </tr>        <tr>         <td class="cellrowborder" width="20%">path<sup>12+</sup></td>         <td class="cellrowborder" width="20%">string</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">否</td>         <td class="cellrowborder" width="20%">变量的路径。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>示例：</strong></p>     <div _ngcontent-wkr-c106="" class="highlight-div"><div _ngcontent-wkr-c106="" class="highlight-div-header"><div _ngcontent-wkr-c106="" class="highlight-div-header-left"><div _ngcontent-wkr-c106="" class="handle-button expand-button"><div _ngcontent-wkr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wkr-c106="" class="highlight-div-header-right"><div _ngcontent-wkr-c106="" class="handle-button ai-button"></div><div _ngcontent-wkr-c106="" class="handle-button line-button"><div _ngcontent-wkr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wkr-c106="" class="handle-button theme-button"><div _ngcontent-wkr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wkr-c106="" class="handle-button copy-button"><div _ngcontent-wkr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wkr-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@ObservedV2</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Info</span> {</li><li>  <span class="hljs-meta">@Trace</span> <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'Tom'</span>;</li><li>  <span class="hljs-meta">@Monitor</span>(<span class="hljs-string">'name'</span>)</li><li>  <span class="hljs-title function_">onNameChange</span>(<span class="hljs-params">monitor: IMonitor</span>) {</li><li>    <span class="hljs-comment">// value的返回值为IMonitorValue类型，可以通过该返回值获取变量变化的信息</span></li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`path: <span class="hljs-subst">${monitor.value()?.path}</span> change from <span class="hljs-subst">${monitor.value()?.before}</span> to <span class="hljs-subst">${monitor.value()?.now}</span>`</span>);</li><li>  }</li><li>}</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@ComponentV2</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-meta">@Local</span> <span class="hljs-attr">info</span>: <span class="hljs-title class_">Info</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Info</span>();</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`info.name: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.info.name}</span>`</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">info</span>.<span class="hljs-property">name</span> = <span class="hljs-string">'Bob'</span>; <span class="hljs-comment">// 输出日志：path: name change from Tom to Bob</span></li><li>        })</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>   </div>   <div></div></div>