<h1 _ngcontent-qkf-c119="" class="doc-title ng-star-inserted" title="转换ID"> 转换ID </h1>

<div _ngcontent-qkf-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div><div class="tiledSection"><h2 id="section2985105118353">功能介绍<i class="anchor-icon anchor-icon-link" anchorid="section2985105118353" tips="复制节点链接"></i></h2><p>调用该接口，传入Access Token、appId、gamePlayerId到华为服务器上获取HarmonyOS系统下玩家的playerId、openId、unionId明细信息。</p> </div> <div class="tiledSection"><h2 id="section59851051113519">场景描述<i class="anchor-icon anchor-icon-link" anchorid="section59851051113519" tips="复制节点链接"></i></h2><p>通过Access Token、appId、gamePlayerId信息到华为服务器上查询HarmonyOS系统下玩家的playerId、openId、unionId明细信息。</p> </div> <div class="tiledSection"><h2 id="section1798515114357">接口原型<i class="anchor-icon anchor-icon-link" anchorid="section1798515114357" tips="复制节点链接"></i></h2> <div class="tablenoborder"><div class="tbBox"><table><tbody><tr><th class="firstcol" id="mcps1.3.3.2.1.3.1.1" width="16.74%"><p>承载协议</p> </th> <td class="cellrowborder" width="83.26%"><p>HTTPS POST</p> </td> </tr> <tr><th class="firstcol" id="mcps1.3.3.2.1.3.2.1" width="16.74%"><p>接口方向</p> </th> <td class="cellrowborder" width="83.26%"><p>开发者服务器-&gt;华为游戏服务器</p> </td> </tr> <tr><th class="firstcol" id="mcps1.3.3.2.1.3.3.1" width="16.74%"><p>接口URL</p> </th> <td class="cellrowborder" width="83.26%"><p>https://jos-open-api.cloud.huawei.com/gameservice/api/gbClientApi</p> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p>请使用TLS 1.2协议或以上版本。</p> </div></div></div> </td> </tr> <tr><th class="firstcol" id="mcps1.3.3.2.1.3.4.1" width="16.74%"><p>数据格式</p> </th> <td class="cellrowborder" width="83.26%"><p>请求：Content-Type: application/x-www-form-urlencoded（表单方式）</p> <p>响应：Content-Type: application/json</p> </td> </tr>  </tbody></table></div> </div> </div> <div class="tiledSection"><h2 id="section13986115113350">请求参数<i class="anchor-icon anchor-icon-link" anchorid="section13986115113350" tips="复制节点链接"></i></h2> <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.4.2.1.5.1.1" width="14.91%"><p>参数</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.4.2.1.5.1.2" width="17.29%"><p>是否必选</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.4.2.1.5.1.3" width="18.26%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.4.2.1.5.1.4" width="49.54%"><p>描述</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="14.91%"><p>method</p> </td> <td class="cellrowborder" width="17.29%"><p>是</p> </td> <td class="cellrowborder" width="18.26%"><p>String</p> </td> <td class="cellrowborder" width="49.54%"><p>固定传入“external.hms.gs.player.transfer.convertId”。</p> </td> </tr> <tr><td class="cellrowborder" width="14.91%"><p>accessToken</p> </td> <td class="cellrowborder" width="17.29%"><p>是</p> </td> <td class="cellrowborder" width="18.26%"><p>String</p> </td> <td class="cellrowborder" width="49.54%"><p>游戏调用华为账号的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/account-api-obtain-user-token" target="_blank">获取用户级凭证</a>接口获取到的Access Token。</p> </td> </tr> <tr><td class="cellrowborder" width="14.91%"><p>appId</p> </td> <td class="cellrowborder" width="17.29%"><p>是</p> </td> <td class="cellrowborder" width="18.26%"><p>String</p> </td> <td class="cellrowborder" width="49.54%"><p>HarmonyOS NEXT游戏的APP ID，获取方法请参见<a href="https://developer.huawei.com/consumer/cn/doc/app/agc-help-view-app-info-0000002282674569" target="_blank">查看应用信息</a>。</p> </td> </tr> <tr><td class="cellrowborder" width="14.91%"><p>gamePlayerId</p> </td> <td class="cellrowborder" width="17.29%"><p>是</p> </td> <td class="cellrowborder" width="18.26%"><p>String</p> </td> <td class="cellrowborder" width="49.54%"><p>HarmonyOS NEXT游戏的玩家标识，通过调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/gameservice-gameplayer#section157848375136">unionLogin</a>接口返回。</p> </td> </tr>  </tbody></table></div> </div> </div> <div class="tiledSection"><h2 id="section19989155153512">请求示例<i class="anchor-icon anchor-icon-link" anchorid="section19989155153512" tips="复制节点链接"></i></h2><div _ngcontent-qkf-c106="" class="highlight-div"><div _ngcontent-qkf-c106="" class="highlight-div-header"><div _ngcontent-qkf-c106="" class="highlight-div-header-left"><div _ngcontent-qkf-c106="" class="handle-button expand-button"><div _ngcontent-qkf-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-qkf-c106="" class="highlight-div-header-right"><div _ngcontent-qkf-c106="" class="handle-button ai-button"></div><div _ngcontent-qkf-c106="" class="handle-button line-button"><div _ngcontent-qkf-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-qkf-c106="" class="handle-button theme-button"><div _ngcontent-qkf-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-qkf-c106="" class="handle-button copy-button"><div _ngcontent-qkf-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-qkf-c106="" class="highlight-scroll-div"><pre class="java prettyprint linenums hljs language-java" data-highlighted="yes"><ol class="linenums"><li>POST /gameservice/api/gbClientApi HTTP/<span class="hljs-number">1.1</span></li><li>Content-Type: application/x-www-form-urlencoded</li><li>User-Agent: PostmanRuntime/<span class="hljs-number">7.24</span><span class="hljs-number">.0</span></li><li>Accept: *<span class="hljs-comment">/*</span></li><li><span class="hljs-comment">Host: jos-open-api.cloud.huawei.com</span></li><li><span class="hljs-comment">Accept-Encoding: gzip, deflate, br</span></li><li><span class="hljs-comment">Connection: keep-alive</span></li><li><span class="hljs-comment">Content-Length: 717</span></li><li><span class="hljs-comment">// </span><strong><span class="hljs-comment">所有请求参数</span></strong><strong><span class="hljs-comment">值</span></strong><span class="hljs-comment">均需要urlencode编码后再进行拼接</span></li><li><span class="hljs-comment">method=external.hms.gs.player.transfer.convertId&amp;accessToken=******&amp;appId=xxxxxxx&amp;gamePlayerId=xxxxxxx</span></li></ol></pre></div></div> </div> <div class="tiledSection"><h2 id="section12989451113515">响应参数<i class="anchor-icon anchor-icon-link" anchorid="section12989451113515" tips="复制节点链接"></i></h2> <div class="tablenoborder"><div class="tbBox"><table><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.6.2.1.5.1.1" width="14.48%"><p>参数</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.6.2.1.5.1.2" width="18%"><p>是否必选</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.6.2.1.5.1.3" width="17.06%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.6.2.1.5.1.4" width="50.46000000000001%"><p>描述</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" width="14.48%"><p>rtnCode</p> </td> <td class="cellrowborder" width="18%"><p>是</p> </td> <td class="cellrowborder" width="17.06%"><p>int</p> </td> <td class="cellrowborder" width="50.46000000000001%"><p>服务端结果说明。</p> <ul><li>0：获取成功</li><li>-1：获取失败</li><li>2：accessToken无效</li><li>3001：参数错误</li><li>3101：应用ID与鉴权应用不一致</li></ul> </td> </tr> <tr><td class="cellrowborder" width="14.48%"><p>playerId</p> </td> <td class="cellrowborder" width="18%"><p>是</p> </td> <td class="cellrowborder" width="17.06%"><p>String</p> </td> <td class="cellrowborder" width="50.46000000000001%"><p>HarmonyOS系统下，华为游戏服务器给华为账号封装处理后的对外开放的游戏玩家标识。</p> </td> </tr> <tr><td class="cellrowborder" width="14.48%"><p>openId</p> </td> <td class="cellrowborder" width="18%"><p>是</p> </td> <td class="cellrowborder" width="17.06%"><p>String</p> </td> <td class="cellrowborder" width="50.46000000000001%"><p>HarmonyOS系统下，由华为账号和应用唯一标识组合加密起来的玩家标识。</p> </td> </tr> <tr><td class="cellrowborder" width="14.48%"><p>unionId</p> </td> <td class="cellrowborder" width="18%"><p>否</p> </td> <td class="cellrowborder" width="17.06%"><p>String</p> </td> <td class="cellrowborder" width="50.46000000000001%"><p>HarmonyOS系统下，由华为账号和开发者账号组合加密起来的玩家标识。</p> </td> </tr> <tr><td class="cellrowborder" width="14.48%"><p>errMsg</p> </td> <td class="cellrowborder" width="18%"><p>否</p> </td> <td class="cellrowborder" width="17.06%"><p>String</p> </td> <td class="cellrowborder" width="50.46000000000001%"><p>异常场景下返回错误码的描述。</p> </td> </tr>  </tbody></table></div> </div> </div> <div class="tiledSection"><h2 id="section1799113512351">响应示例<i class="anchor-icon anchor-icon-link" anchorid="section1799113512351" tips="复制节点链接"></i></h2><div _ngcontent-qkf-c106="" class="highlight-div"><div _ngcontent-qkf-c106="" class="highlight-div-header"><div _ngcontent-qkf-c106="" class="highlight-div-header-left"><div _ngcontent-qkf-c106="" class="handle-button expand-button"><div _ngcontent-qkf-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-qkf-c106="" class="highlight-div-header-right"><div _ngcontent-qkf-c106="" class="handle-button ai-button"></div><div _ngcontent-qkf-c106="" class="handle-button line-button"><div _ngcontent-qkf-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-qkf-c106="" class="handle-button theme-button"><div _ngcontent-qkf-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-qkf-c106="" class="handle-button copy-button"><div _ngcontent-qkf-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-qkf-c106="" class="highlight-scroll-div"><pre class="java prettyprint linenums hljs language-java" data-highlighted="yes"><ol class="linenums"><li>HTTP/<span class="hljs-number">1.1</span> <span class="hljs-number">200</span> OK</li><li>Date: Tue, <span class="hljs-number">19</span> May <span class="hljs-number">2023</span> <span class="hljs-number">06</span>:<span class="hljs-number">28</span>:<span class="hljs-number">02</span> GMT</li><li>Content-Type: application/json; charset=utf-<span class="hljs-number">8</span></li><li>Transfer-Encoding: chunked</li><li>Connection: keep-alive</li><li>Content-Encoding: gzip</li><li>Server: elb</li><li>{</li><li>    <span class="hljs-string">"playerId"</span>: <span class="hljs-string">"13423***9864303"</span>,</li><li>    <span class="hljs-string">"openId"</span>: <span class="hljs-string">"43JIOdok743***980sd9453"</span>,</li><li>    <span class="hljs-string">"unionId"</span>: <span class="hljs-string">"MDFiaNicx***JHIicHAlnRD"</span>,</li><li>    <span class="hljs-string">"rtnCode"</span>: <span class="hljs-number">0</span></li><li>}</li></ol></pre></div></div> </div> <div class="tiledSection"><h2 id="section182029402541">调用示例<i class="anchor-icon anchor-icon-link" anchorid="section182029402541" tips="复制节点链接"></i></h2><div class="p">    <div class="switchPre"><div class="preTab preTab-cn"><div class="activePre" switchpre-data="0" switchpre-lang="Java">Java</div><div switchpre-data="1" switchpre-lang="C#">C#</div><div switchpre-data="2" switchpre-lang="PHP">PHP</div><div switchpre-data="3" switchpre-lang="Python">Python</div></div><div class="switchPreBox"><div class="prebox"><div _ngcontent-qkf-c106="" class="highlight-div"><div _ngcontent-qkf-c106="" class="highlight-div-header"><div _ngcontent-qkf-c106="" class="highlight-div-header-left"><div _ngcontent-qkf-c106="" class="handle-button expand-button"><div _ngcontent-qkf-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-qkf-c106="" class="highlight-div-header-right"><div _ngcontent-qkf-c106="" class="handle-button ai-button"></div><div _ngcontent-qkf-c106="" class="handle-button line-button"><div _ngcontent-qkf-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-qkf-c106="" class="handle-button theme-button"><div _ngcontent-qkf-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-qkf-c106="" class="handle-button copy-button"><div _ngcontent-qkf-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-qkf-c106="" class="highlight-scroll-div"><pre class="java prettyprint linenums hljs language-java" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">package</span> okhttp.com.post;</li><li><span class="hljs-keyword">import</span> com.alibaba.fastjson.JSONObject;</li><li><span class="hljs-keyword">import</span> okhttp3.*;</li><li><span class="hljs-keyword">import</span> java.io.IOException;</li><li>
</li><li><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ConvertIdTest</span> {</li><li>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">Integer</span> <span class="hljs-variable">RETURN_CODE_SUCCEED</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;</li><li>
</li><li>    <span class="hljs-comment">/**</span></li><li><span class="hljs-comment">     * 接口本地调测时使用</span></li><li><span class="hljs-comment">     */</span></li><li>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> {</li><li>        <span class="hljs-type">String</span> <span class="hljs-variable">method</span> <span class="hljs-operator">=</span> <span class="hljs-string">"external.hms.gs.player.transfer.convertId"</span>; <span class="hljs-comment">// 固定传入</span></li><li>        <span class="hljs-type">String</span> <span class="hljs-variable">accessToken</span> <span class="hljs-operator">=</span> <span class="hljs-string">"xxxxx"</span>; <span class="hljs-comment">// 请使用游戏客户端调用账号获取到的Access Token</span></li><li>        <span class="hljs-type">String</span> <span class="hljs-variable">appId</span> <span class="hljs-operator">=</span> <span class="hljs-string">"xxxx"</span>; <span class="hljs-comment">// HarmonyOS NEXT系统下游戏ID</span></li><li>        <span class="hljs-type">String</span> <span class="hljs-variable">gamePlayerId</span> <span class="hljs-operator">=</span> <span class="hljs-string">"xxxxx"</span>; <span class="hljs-comment">// 通过Access Token到华为服务器上获取到的玩家的gamePlayerId。</span></li><li>        convertIdService(method, accessToken,appId, gamePlayerId);</li><li>    }</li><li>
</li><li>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">convertIdService</span><span class="hljs-params">(String method, String accessToken, String appId, String gamePlayerId)</span> {</li><li>        <span class="hljs-type">OkHttpClient</span> <span class="hljs-variable">client</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">OkHttpClient</span>().newBuilder().build();</li><li>        <span class="hljs-type">RequestBody</span> <span class="hljs-variable">mFormBody</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">FormBody</span>.Builder().add(<span class="hljs-string">"method"</span>, method)</li><li>            .add(<span class="hljs-string">"accessToken"</span>, accessToken)</li><li>            .add(<span class="hljs-string">"appId"</span>, appId)</li><li>            .add(<span class="hljs-string">"gamePlayerId"</span>, gamePlayerId)</li><li>            .build();</li><li>        <span class="hljs-type">Request</span> <span class="hljs-variable">request</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Request</span>.Builder().url(<span class="hljs-string">"https://jos-open-api.cloud.huawei.com/gameservice/api/gbClientApi"</span>)</li><li>            .post(mFormBody)</li><li>            .build();</li><li>        <span class="hljs-keyword">try</span> {</li><li>            <span class="hljs-type">Response</span> <span class="hljs-variable">response</span> <span class="hljs-operator">=</span> client.newCall(request).execute();</li><li>            <span class="hljs-keyword">if</span> (response.isSuccessful()) {</li><li>                <span class="hljs-type">JSONObject</span> <span class="hljs-variable">object</span> <span class="hljs-operator">=</span> JSONObject.parseObject(response.body().string());</li><li>                <span class="hljs-keyword">if</span> (RETURN_CODE_SUCCEED.equals(object.get(<span class="hljs-string">"rtnCode"</span>))) {</li><li>                    System.out.println(<span class="hljs-string">"playerId: "</span> + object.get(<span class="hljs-string">"playerId"</span>));</li><li>                    System.out.println(<span class="hljs-string">"openId: "</span> + object.get(<span class="hljs-string">"openId"</span>));</li><li>                    System.out.println(<span class="hljs-string">"unionId: "</span> + object.get(<span class="hljs-string">"unionId"</span>));</li><li>                } <span class="hljs-keyword">else</span> {</li><li>                    System.out.println(<span class="hljs-string">"rtnCode: "</span> + object.get(<span class="hljs-string">"rtnCode"</span>));</li><li>                    System.out.println(<span class="hljs-string">"rtnMsg: "</span> + object.get(<span class="hljs-string">"errMsg"</span>));</li><li>                }</li><li>            }</li><li>        } <span class="hljs-keyword">catch</span> (IOException e) {</li><li>            e.printStackTrace();</li><li>        }</li><li>    }</li><li>}</li></ol></pre></div></div></div><div class="prebox"><div _ngcontent-qkf-c106="" class="highlight-div"><div _ngcontent-qkf-c106="" class="highlight-div-header"><div _ngcontent-qkf-c106="" class="highlight-div-header-left"><div _ngcontent-qkf-c106="" class="handle-button expand-button"><div _ngcontent-qkf-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-qkf-c106="" class="highlight-div-header-right"><div _ngcontent-qkf-c106="" class="handle-button ai-button"></div><div _ngcontent-qkf-c106="" class="handle-button line-button"><div _ngcontent-qkf-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-qkf-c106="" class="handle-button theme-button"><div _ngcontent-qkf-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-qkf-c106="" class="handle-button copy-button"><div _ngcontent-qkf-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-qkf-c106="" class="highlight-scroll-div"><pre class="csharp prettyprint linenums hljs language-csharp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">using</span> System;</li><li><span class="hljs-keyword">using</span> System.IO;</li><li><span class="hljs-keyword">using</span> System.Net;</li><li><span class="hljs-keyword">using</span> System.Text;</li><li><span class="hljs-keyword">using</span> System.Web;</li><li><span class="hljs-keyword">namespace</span> <span class="hljs-title">cXdemo</span></li><li>{</li><li>    <span class="hljs-keyword">class</span> <span class="hljs-title">Program</span></li><li>    {</li><li>        <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span>(<span class="hljs-params"><span class="hljs-built_in">string</span>[] args</span>)</span></li><li>        {</li><li>            <span class="hljs-comment">// 固定传入“external.hms.gs.player.transfer.convertId”</span></li><li>            <span class="hljs-built_in">string</span> method = <span class="hljs-string">"external.hms.gs.player.transfer.convertId"</span>;</li><li>            <span class="hljs-comment">// 取自当前玩家的Player对象中获取到的Access Token。</span></li><li>            <span class="hljs-built_in">string</span> accessToken = <span class="hljs-string">"xxxxx"</span>;</li><li>        <span class="hljs-comment">// HarmonyOS NEXT系统下游戏ID</span></li><li>        <span class="hljs-built_in">string</span> appId = <span class="hljs-string">"xxxx"</span>;</li><li>        <span class="hljs-comment">// 通过Access Token到华为服务器上获取到的玩家的gamePlayerId。</span></li><li>        <span class="hljs-built_in">string</span> gamePlayerId = <span class="hljs-string">"xxxxx"</span>;</li><li>            <span class="hljs-comment">// 请求接口</span></li><li>            requestgameInfo(method, accessToken, appId, gamePlayerId);</li><li>        }</li><li>        <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">requestgameInfo</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> method, <span class="hljs-built_in">string</span> accessToken, <span class="hljs-built_in">string</span> appId, <span class="hljs-built_in">string</span> gamePlayerId</span>)</span> </li><li>        {</li><li>            <span class="hljs-keyword">var</span> requestUrl = <span class="hljs-string">"https://jos-open-api.cloud.huawei.com/gameservice/api/gbClientApi"</span>;</li><li>            HttpWebRequest request = WebRequest.Create(requestUrl) <span class="hljs-keyword">as</span> HttpWebRequest;</li><li>            request.Method = <span class="hljs-string">"post"</span>;</li><li>            request.ContentType = <span class="hljs-string">"application/x-www-form-urlencoded"</span>;</li><li>            StringBuilder data = <span class="hljs-keyword">new</span> StringBuilder();</li><li>            data.Append(<span class="hljs-string">"method="</span> + HttpUtility.UrlEncode(method));</li><li>            data.Append(<span class="hljs-string">"&amp;accessToken="</span> + HttpUtility.UrlEncode(accessToken));</li><li>            data.Append(<span class="hljs-string">"&amp;appId="</span> + HttpUtility.UrlEncode(appId));</li><li>            data.Append(<span class="hljs-string">"&amp;gamePlayerId="</span> + HttpUtility.UrlEncode(gamePlayerId));</li><li>            <span class="hljs-built_in">byte</span>[] byteData = Encoding.UTF8.GetBytes(data.ToString());</li><li>            request.ContentLength = byteData.Length;</li><li>            Stream postStream = request.GetRequestStream();</li><li>            postStream.Write(byteData, <span class="hljs-number">0</span>, byteData.Length);</li><li>            postStream.Close();</li><li>            WebResponse response = request.GetResponse();</li><li>            StreamReader reader = <span class="hljs-keyword">new</span> StreamReader(response.GetResponseStream(), Encoding.UTF8);</li><li>            <span class="hljs-built_in">string</span> strJson = reader.ReadToEnd();</li><li>            Console.WriteLine(strJson);</li><li>            reader.Close();</li><li>            response.Close();</li><li>        }</li><li>    }</li><li>}</li></ol></pre></div></div></div><div class="prebox"><div _ngcontent-qkf-c106="" class="highlight-div"><div _ngcontent-qkf-c106="" class="highlight-div-header"><div _ngcontent-qkf-c106="" class="highlight-div-header-left"><div _ngcontent-qkf-c106="" class="handle-button expand-button"><div _ngcontent-qkf-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-qkf-c106="" class="highlight-div-header-right"><div _ngcontent-qkf-c106="" class="handle-button ai-button"></div><div _ngcontent-qkf-c106="" class="handle-button line-button"><div _ngcontent-qkf-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-qkf-c106="" class="handle-button theme-button"><div _ngcontent-qkf-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-qkf-c106="" class="handle-button copy-button"><div _ngcontent-qkf-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-qkf-c106="" class="highlight-scroll-div"><pre class="php prettyprint linenums hljs language-php" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">convert_id</span></span></li><li><span class="hljs-class"></span>{</li><li>    <span class="hljs-comment">/**</span></li><li><span class="hljs-comment">     * 根据AccessToken获取玩家信息</span></li><li><span class="hljs-comment">     *</span></li><li><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> string $method 固定传入“external.hms.gs.player.transfer.convertId”</span></li><li><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> string $accessToken 请使用客户端Player对象中的AccessToken</span></li><li><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> string $appId HarmonyOS NEXT系统下游戏ID</span></li><li><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> string $gamePlayerId 通过Access Token到华为服务器上获取到的玩家的gamePlayerId</span></li><li><span class="hljs-comment">     */</span></li><li>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">call_https</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> <span class="hljs-variable">$method</span>, <span class="hljs-keyword">string</span> <span class="hljs-variable">$accessToken</span>, <span class="hljs-keyword">string</span> <span class="hljs-variable">$appId</span>, <span class="hljs-keyword">string</span> <span class="hljs-variable">$gamePlayerId</span></span>): <span class="hljs-title">void</span></span></li><li><span class="hljs-function">    </span>{</li><li>        <span class="hljs-variable">$data</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">"method"</span> =&gt; <span class="hljs-variable">$method</span>, <span class="hljs-string">"accessToken"</span> =&gt; <span class="hljs-variable">$accessToken</span>, <span class="hljs-string">"appId"</span> =&gt; <span class="hljs-variable">$appId</span>, <span class="hljs-string">"gamePlayerId"</span> =&gt; <span class="hljs-variable">$gamePlayerId</span>);</li><li>        <span class="hljs-variable">$curl</span> = <span class="hljs-title function_ invoke__">curl_init</span>();</li><li>        <span class="hljs-title function_ invoke__">curl_setopt_array</span>(<span class="hljs-variable">$curl</span>, <span class="hljs-keyword">array</span>(</li><li>            CURLOPT_URL =&gt; <span class="hljs-string">'https://jos-open-api.cloud.huawei.com/gameservice/api/gbClientApi'</span>,</li><li>            CURLOPT_RETURNTRANSFER =&gt; <span class="hljs-literal">true</span>,</li><li>            CURLOPT_ENCODING =&gt; <span class="hljs-string">''</span>,</li><li>            CURLOPT_MAXREDIRS =&gt; <span class="hljs-number">10</span>,</li><li>            CURLOPT_TIMEOUT =&gt; <span class="hljs-number">0</span>,</li><li>            CURLOPT_FOLLOWLOCATION =&gt; <span class="hljs-literal">true</span>,</li><li>            CURLOPT_CUSTOMREQUEST =&gt; <span class="hljs-string">'POST'</span>,</li><li>            CURLOPT_SSL_VERIFYHOST =&gt; <span class="hljs-literal">false</span>,</li><li>            CURLOPT_SSL_VERIFYPEER =&gt; <span class="hljs-literal">false</span>,</li><li>            CURLOPT_HTTP_VERSION =&gt; CURL_HTTP_VERSION_1_1,</li><li>            CURLOPT_POSTFIELDS =&gt; <span class="hljs-title function_ invoke__">http_build_query</span>(<span class="hljs-variable">$data</span>),</li><li>            CURLOPT_HTTPHEADER =&gt; <span class="hljs-keyword">array</span>(</li><li>                <span class="hljs-string">'Content-Type: application/x-www-form-urlencoded'</span></li><li>            ),</li><li>        ));</li><li>        <span class="hljs-variable">$response</span> = <span class="hljs-title function_ invoke__">curl_exec</span>(<span class="hljs-variable">$curl</span>);</li><li>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">curl_error</span>(<span class="hljs-variable">$curl</span>)) {</li><li>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Exception</span>(<span class="hljs-title function_ invoke__">curl_error</span>(<span class="hljs-variable">$curl</span>));</li><li>        }</li><li>        <span class="hljs-title function_ invoke__">curl_close</span>(<span class="hljs-variable">$curl</span>);</li><li>        <span class="hljs-variable">$result</span> = <span class="hljs-title function_ invoke__">json_decode</span>(<span class="hljs-variable">$response</span>, <span class="hljs-literal">true</span>);</li><li>        <span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-variable">$result</span>);</li><li>    }</li><li>}</li><li><span class="hljs-variable">$convert_id</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">convert_id</span>();</li><li><span class="hljs-variable">$method</span> = <span class="hljs-string">"external.hms.gs.player.transfer.convertId"</span>; <span class="hljs-comment">// 固定传入</span></li><li><span class="hljs-variable">$accessToken</span> = <span class="hljs-string">"xxxxx"</span>; <span class="hljs-comment">// 请使用客户端Player对象中的AccessToken</span></li><li><span class="hljs-variable">$appId</span> = <span class="hljs-string">"xxxxx"</span>; <span class="hljs-comment">// 游戏appId</span></li><li><span class="hljs-variable">$gamePlayerId</span> = <span class="hljs-string">"xxxxx"</span>; <span class="hljs-comment">// 通过Access Token到华为服务器上获取到的玩家的gamePlayerId</span></li><li><span class="hljs-variable">$convert_id</span>-&gt;<span class="hljs-title function_ invoke__">call_https</span>(<span class="hljs-variable">$method</span>, <span class="hljs-variable">$accessToken</span>, <span class="hljs-variable">$appId</span>, <span class="hljs-variable">$gamePlayerId</span>);</li></ol></pre></div></div></div><div class="prebox"><div _ngcontent-qkf-c106="" class="highlight-div"><div _ngcontent-qkf-c106="" class="highlight-div-header"><div _ngcontent-qkf-c106="" class="highlight-div-header-left"><div _ngcontent-qkf-c106="" class="handle-button expand-button"><div _ngcontent-qkf-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-qkf-c106="" class="highlight-div-header-right"><div _ngcontent-qkf-c106="" class="handle-button ai-button"></div><div _ngcontent-qkf-c106="" class="handle-button line-button"><div _ngcontent-qkf-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-qkf-c106="" class="handle-button theme-button"><div _ngcontent-qkf-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-qkf-c106="" class="handle-button copy-button"><div _ngcontent-qkf-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-qkf-c106="" class="highlight-scroll-div"><pre class="python prettyprint linenums hljs language-python" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">from</span> typing <span class="hljs-keyword">import</span> <span class="hljs-type">Any</span></li><li><span class="hljs-keyword">import</span> requests</li><li><span class="hljs-keyword">import</span> urllib.parse</li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">ConvertIdSolution</span>:</li><li>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">convert_id</span>(<span class="hljs-params">self, method, accessToken, appId, gamePlayerId</span>):</li><li>        url = <span class="hljs-string">"https://jos-open-api.cloud.huawei.com/gameservice/api/gbClientApi"</span></li><li>        params: <span class="hljs-built_in">dict</span>[<span class="hljs-built_in">str</span>, <span class="hljs-type">Any</span>] = {</li><li>            <span class="hljs-string">'method'</span>: method,</li><li>            <span class="hljs-string">'accessToken'</span>: accessToken,</li><li>            <span class="hljs-string">'appId'</span>: appId,</li><li>            <span class="hljs-string">'gamePlayerId'</span>: gamePlayerId</li><li>        }</li><li>        encodedParams = urllib.parse.urlencode(params)</li><li>        headers = {</li><li>            <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/x-www-form-urlencoded'</span></li><li>        }</li><li>        response = requests.post(url, headers=headers, data=encodedParams)</li><li>        <span class="hljs-built_in">print</span>(response.text)</li><li><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:</li><li>    <span class="hljs-comment"># 固定传入“external.hms.gs.player.transfer.convertId”</span></li><li>    input_method = <span class="hljs-string">'external.hms.gs.player.transfer.convertId'</span></li><li>    <span class="hljs-comment"># 请使用客户端Player对象中的AccessToken</span></li><li>    input_accessToken = <span class="hljs-string">'xxx'</span></li><li>    <span class="hljs-comment"># HarmonyOS NEXT系统下游戏ID</span></li><li>    input_appId = <span class="hljs-string">'xxx'</span></li><li>    <span class="hljs-comment"># 通过Access Token到华为服务器上获取到的玩家的gamePlayerId</span></li><li>    input_gamePlayerId = <span class="hljs-string">'xxx'</span></li><li>    function = ConvertIdSolution()</li><li>    function.convert_id(input_method, input_accessToken, input_appId, input_gamePlayerId)</li></ol></pre></div></div></div></div></div></div> </div> </div> <div></div></div>