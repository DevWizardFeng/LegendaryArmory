<h1 _ngcontent-kpr-c119="" class="doc-title ng-star-inserted" title="@Link装饰器：父子双向同步"> @Link装饰器：父子双向同步 </h1>

<div _ngcontent-kpr-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p>子组件中被@Link装饰的变量与其父组件中对应的数据源建立双向数据绑定。</p>    <p>在阅读@Link文档前，建议先熟悉<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-state">@State</a>的基本用法。最佳实践请参考<a href="https://developer.huawei.com/consumer/cn/doc/best-practices/bpta-status-management" target="_blank">状态管理最佳实践</a>。</p>    <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">      <p>从API version 9开始，该装饰器支持在ArkTS卡片中使用。</p>      <p>从API version 11开始，该装饰器支持在元服务中使用。</p>     </div></div></div>    <div class="tiledSection">     <h2 id="概述">概述<i class="anchor-icon anchor-icon-link" anchorid="概述" tips="复制节点链接"></i></h2>          <p>@Link装饰的变量与其父组件中的数据源共享相同的值。</p>    </div>    <div class="tiledSection">     <h2 id="装饰器使用规则说明">装饰器使用规则说明<i class="anchor-icon anchor-icon-link" anchorid="装饰器使用规则说明" tips="复制节点链接"></i></h2>          <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.5.2.1.3.1.1" valign="top" width="50%">@Link变量装饰器</th>         <th align="left" class="cellrowborder" id="mcps1.3.5.2.1.3.1.2" valign="top" width="50%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="50%">装饰器参数</td>         <td class="cellrowborder" valign="top" width="50%">无。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">同步类型</td>         <td class="cellrowborder" valign="top" width="50%">          <p>双向同步。</p>          <p>父组件状态变量与子组件@Link建立双向同步，当其中一方改变时，另一方也会同步更新。</p></td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">允许装饰的变量类型</td>         <td class="cellrowborder" valign="top" width="50%">          <p>Object、class、string、number、boolean、enum类型，以及这些类型的数组。</p>          <p>API version 10开始支持<a href="/consumer/cn/doc/harmonyos-guides/arkts-link#装饰date类型变量">Date类型</a>。</p>          <p>API version 11及以上支持<a href="/consumer/cn/doc/harmonyos-guides/arkts-link#装饰map类型变量">Map</a>、<a href="/consumer/cn/doc/harmonyos-guides/arkts-link#装饰set类型变量">Set</a>类型、undefined和null类型、ArkUI框架定义的联合类型<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-types#length" target="_blank">Length</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-types#resourcestr" target="_blank">ResourceStr</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-types#resourcecolor" target="_blank">ResourceColor</a>类型以及这些类型的联合类型，示例见<a href="/consumer/cn/doc/harmonyos-guides/arkts-link#link支持联合类型实例">Link支持联合类型实例</a>。</p>          <p>支持类型的场景请参考<a href="/consumer/cn/doc/harmonyos-guides/arkts-link#观察变化">观察变化</a>。</p></td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">不允许装饰的变量类型</td>         <td class="cellrowborder" valign="top" width="50%">不支持装饰Function类型。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">被装饰变量的初始值</td>         <td class="cellrowborder" valign="top" width="50%">禁止本地初始化。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="变量的传递访问规则说明">变量的传递/访问规则说明<i class="anchor-icon anchor-icon-link" anchorid="变量的传递访问规则说明" tips="复制节点链接"></i></h2>          <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.6.2.1.3.1.1" valign="top" width="50%">传递/访问</th>         <th align="left" class="cellrowborder" id="mcps1.3.6.2.1.3.1.2" valign="top" width="50%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="50%">从父组件初始化和更新</td>         <td class="cellrowborder" valign="top" width="50%">          <p>必选。</p>          <p>允许父组件中<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-state">@State</a>、@Link、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-prop">@Prop</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-provide-and-consume">@Provide</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-provide-and-consume">@Consume</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-observed-and-objectlink">@ObjectLink</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-appstorage#storagelink">@StorageLink</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-appstorage#storageprop">@StorageProp</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-localstorage#localstoragelink">@LocalStorageLink</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-localstorage#localstorageprop">@LocalStorageProp</a>装饰变量初始化子组件@Link，并建立双向绑定。</p>          <p>- 从API version 9开始，@Link子组件从父组件初始化@State的语法为Comp({ aLink: this.aState })，同样支持Comp({aLink: $aState})。</p></td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">用于初始化子组件</td>         <td class="cellrowborder" valign="top" width="50%">允许，可用于初始化常规变量、@State、@Link、@Prop、@Provide。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">是否支持组件外访问</td>         <td class="cellrowborder" valign="top" width="50%">私有，只能在所属组件内访问。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>图1</strong> 初始化规则示意图</p>     <p><span><img originheight="273" originwidth="1741" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114957.34993276915658276622718079883495:50001231000000:2800:0CF338BED7003F1CFE779FEB36CF59B9AA107A25C350A80723C1F88EFE9FCC3A.png" width="920" height="144.2619184376795"></span></p>    </div>    <div class="tiledSection">     <h2 id="观察变化和行为表现">观察变化和行为表现<i class="anchor-icon anchor-icon-link" anchorid="观察变化和行为表现" tips="复制节点链接"></i></h2>         </div>    <div class="tiledSection">     <h3 id="观察变化" class="firsth2">观察变化<i class="anchor-icon anchor-icon-link" anchorid="观察变化" tips="复制节点链接"></i></h3>          <ul>      <li>       <p>当装饰的数据类型为boolean、string、number类型时，可以同步观察到数值的变化，示例请参考<a href="/consumer/cn/doc/harmonyos-guides/arkts-link#简单类型和类对象类型的link">简单类型和类对象类型的@Link</a>。</p></li>      <li>       <p>当装饰的数据类型为class或者Object时，可以观察到赋值和属性赋值的变化，即Object.keys(observedObject)返回的所有属性，示例请参考<a href="/consumer/cn/doc/harmonyos-guides/arkts-link#简单类型和类对象类型的link">简单类型和类对象类型的@Link</a>。</p></li>      <li>       <p>当装饰的对象是Array时，可以观察到数组添加、删除、更新数组单元的变化，示例请参考<a href="/consumer/cn/doc/harmonyos-guides/arkts-link#数组类型的link">数组类型的@Link</a>。</p></li>      <li>       <p>当装饰的对象是Date时，可以观察到Date的整体赋值，以及通过调用setFullYear, setMonth, setDate, setHours, setMinutes, setSeconds, setMilliseconds, setTime, setUTCFullYear, setUTCMonth, setUTCDate, setUTCHours, setUTCMinutes, setUTCSeconds, setUTCMilliseconds方法更新其属性，示例请参考<a href="/consumer/cn/doc/harmonyos-guides/arkts-link#装饰date类型变量">装饰Date类型变量</a>。</p></li>      <li>       <p>当装饰的变量是Map时，可以观察到Map整体的赋值，以及可通过调用Map的set、clear、delete接口更新Map的值，示例请参考<a href="/consumer/cn/doc/harmonyos-guides/arkts-link#装饰map类型变量">装饰Map类型变量</a>。</p></li>      <li>       <p>当装饰的变量是Set时，可以观察Set整体的赋值，以及通过调用Set的add、clear、delete接口更新其值，示例请参考<a href="/consumer/cn/doc/harmonyos-guides/arkts-link#装饰set类型变量">装饰Set类型变量</a>。</p></li>     </ul>    </div>    <div class="tiledSection">     <h3 id="框架行为">框架行为<i class="anchor-icon anchor-icon-link" anchorid="框架行为" tips="复制节点链接"></i></h3>          <p>@Link装饰的变量和所属的自定义组件共享生命周期。</p>     <p>为了了解@Link变量的初始化和更新机制，有必要先了解父组件和拥有@Link变量的子组件的关系，以及初始渲染和双向更新的流程（以父组件为@State为例）。</p>     <ol>      <li>       <p>初始渲染：执行父组件的 build() 函数，创建子组件的新实例。初始化过程如下：</p>       <ol>        <li>指定父组件中的@State变量用于初始化子组件的@Link变量。子组件的@Link变量值与其父组件的数据源变量保持双向数据同步。</li>        <li>父组件的@State状态变量包装类通过构造函数传给子组件，子组件的@Link包装类拿到父组件的@State的状态变量后，将当前@Link包装类实例注册给父组件的@State变量。</li>       </ol></li>      <li>       <p>@Link的数据源的更新：即父组件中状态变量更新，引起相关子组件的@Link的更新。处理步骤：</p>       <ol>        <li>通过初始渲染的步骤可知，子组件@Link包装类把当前this指针注册给父组件。父组件@State变量变更后，会遍历更新所有依赖它的系统组件和状态变量（例如：@Link包装类）。</li>        <li>通知@Link包装类更新后，子组件中所有依赖@Link状态变量的系统组件都会被通知更新。以此实现父组件对子组件的状态数据同步。</li>       </ol></li>      <li>       <p>@Link的更新：当子组件中@Link更新后，处理步骤如下（以父组件为@State为例）：</p>       <ol>        <li>@Link更新后，调用父组件的@State包装类的set方法，将数值同步回父组件。</li>        <li>子组件@Link和父组件@State分别遍历依赖的系统组件，更新对应的UI。从而实现子组件@Link与父组件@State的同步。</li>       </ol></li>     </ol>    </div>    <div class="tiledSection">     <h2 id="限制条件">限制条件<i class="anchor-icon anchor-icon-link" anchorid="限制条件" tips="复制节点链接"></i></h2>          <ol>      <li>       <p>@Link装饰器不建议在<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-create-custom-components#entry">@Entry</a>装饰的自定义组件中使用，否则编译时会抛出警告；若该自定义组件作为页面根节点使用，则会抛出运行时错误。</p></li>      <li>       <p>@Link装饰的变量禁止本地初始化，否则编译期会报错。</p>       <div _ngcontent-kpr-c106="" class="highlight-div"><div _ngcontent-kpr-c106="" class="highlight-div-header"><div _ngcontent-kpr-c106="" class="highlight-div-header-left"><div _ngcontent-kpr-c106="" class="handle-button expand-button"><div _ngcontent-kpr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kpr-c106="" class="highlight-div-header-right"><div _ngcontent-kpr-c106="" class="handle-button ai-button"></div><div _ngcontent-kpr-c106="" class="handle-button line-button"><div _ngcontent-kpr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kpr-c106="" class="handle-button theme-button"><div _ngcontent-kpr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kpr-c106="" class="handle-button copy-button"><div _ngcontent-kpr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kpr-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 错误写法，编译报错</span></li><li><span class="hljs-meta">@Link</span> <span class="hljs-attr">count</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">10</span>;</li><li>
</li><li><span class="hljs-comment">// 正确写法</span></li><li><span class="hljs-meta">@Link</span> <span class="hljs-attr">count</span>: <span class="hljs-built_in">number</span>;</li></ol></pre></div></div></li>      <li>       <p>@Link装饰的变量的类型要和数据源类型保持一致，否则编译期会报错。同时，数据源必须是状态变量，否则框架会抛出运行时错误。</p>       <p>【反例】</p>       <div _ngcontent-kpr-c106="" class="highlight-div"><div _ngcontent-kpr-c106="" class="highlight-div-header"><div _ngcontent-kpr-c106="" class="highlight-div-header-left"><div _ngcontent-kpr-c106="" class="handle-button expand-button"><div _ngcontent-kpr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kpr-c106="" class="highlight-div-header-right"><div _ngcontent-kpr-c106="" class="handle-button ai-button"></div><div _ngcontent-kpr-c106="" class="handle-button line-button"><div _ngcontent-kpr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kpr-c106="" class="handle-button theme-button"><div _ngcontent-kpr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kpr-c106="" class="handle-button copy-button"><div _ngcontent-kpr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kpr-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Info</span> {</li><li>  <span class="hljs-attr">value</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'Hello'</span>;</li><li>}</li><li>
</li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Cousin</span> {</li><li>  <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'Hello'</span>;</li><li>}</li><li>
</li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Child</span> {</li><li>  <span class="hljs-comment">// 错误写法1：@Link装饰的变量与@State装饰的变量类型不一致</span></li><li>  <span class="hljs-meta">@Link</span> <span class="hljs-attr">test</span>: <span class="hljs-title class_">Cousin</span>;</li><li>  <span class="hljs-comment">// 错误写法2：数据源非状态变量</span></li><li>  <span class="hljs-meta">@Link</span> <span class="hljs-attr">testStr</span>: <span class="hljs-built_in">string</span>;</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">test</span>.<span class="hljs-property">name</span>)</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">testStr</span>)</li><li>    }</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">LinkExample</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">info</span>: <span class="hljs-title class_">Info</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Info</span>();</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Child</span>({</li><li>        <span class="hljs-comment">// 错误写法1：@Link装饰的变量与@State装饰的变量类型不一致</span></li><li>        <span class="hljs-attr">test</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">info</span>,</li><li>        <span class="hljs-comment">// 错误写法2：数据源非状态变量</span></li><li>        <span class="hljs-attr">testStr</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">info</span>.<span class="hljs-property">value</span></li><li>      })</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>       <p>【正例】</p>       <div _ngcontent-kpr-c106="" class="highlight-div"><div _ngcontent-kpr-c106="" class="highlight-div-header"><div _ngcontent-kpr-c106="" class="highlight-div-header-left"><div _ngcontent-kpr-c106="" class="handle-button expand-button"><div _ngcontent-kpr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kpr-c106="" class="highlight-div-header-right"><div _ngcontent-kpr-c106="" class="handle-button ai-button"></div><div _ngcontent-kpr-c106="" class="handle-button line-button"><div _ngcontent-kpr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kpr-c106="" class="handle-button theme-button"><div _ngcontent-kpr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kpr-c106="" class="handle-button copy-button"><div _ngcontent-kpr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kpr-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Info</span> {</li><li>  <span class="hljs-attr">value</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'Hello'</span>;</li><li>}</li><li>
</li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Child</span> {</li><li>  <span class="hljs-comment">// 在子组件中，使用@Link装饰Info类型的test变量</span></li><li>  <span class="hljs-meta">@Link</span> <span class="hljs-attr">test</span>: <span class="hljs-title class_">Info</span>;</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Text</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">test</span>.<span class="hljs-property">value</span>)</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">LinkExample</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">info</span>: <span class="hljs-title class_">Info</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Info</span>();</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-comment">// 在父组件中，使用@State装饰的info变量初始化Child组件的test变量</span></li><li>      <span class="hljs-title class_">Child</span>({<span class="hljs-attr">test</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">info</span>})</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div></li>      <li>       <p>@Link装饰的变量仅能被状态变量初始化，不能使用常规变量初始化，否则编译期会给出告警，并在运行时崩溃。</p>       <p>【反例】</p>       <div _ngcontent-kpr-c106="" class="highlight-div"><div _ngcontent-kpr-c106="" class="highlight-div-header"><div _ngcontent-kpr-c106="" class="highlight-div-header-left"><div _ngcontent-kpr-c106="" class="handle-button expand-button"><div _ngcontent-kpr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kpr-c106="" class="highlight-div-header-right"><div _ngcontent-kpr-c106="" class="handle-button ai-button"></div><div _ngcontent-kpr-c106="" class="handle-button line-button"><div _ngcontent-kpr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kpr-c106="" class="handle-button theme-button"><div _ngcontent-kpr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kpr-c106="" class="handle-button copy-button"><div _ngcontent-kpr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kpr-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Info</span> {</li><li>  <span class="hljs-attr">info</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'Hello'</span>;</li><li>}</li><li>
</li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Child</span> {</li><li>  <span class="hljs-meta">@Link</span> <span class="hljs-attr">msg</span>: <span class="hljs-built_in">string</span>;</li><li>  <span class="hljs-meta">@Link</span> <span class="hljs-attr">info</span>: <span class="hljs-built_in">string</span>;</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Text</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">msg</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">info</span>)</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">LinkExample</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'Hello'</span>;</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">info</span>: <span class="hljs-title class_">Info</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Info</span>();</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-comment">// 错误写法，常规变量不能初始化@Link</span></li><li>      <span class="hljs-title class_">Child</span>({<span class="hljs-attr">msg</span>: <span class="hljs-string">'World'</span>, <span class="hljs-attr">info</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">info</span>.<span class="hljs-property">info</span>})</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>       <p>【正例】</p>       <div _ngcontent-kpr-c106="" class="highlight-div"><div _ngcontent-kpr-c106="" class="highlight-div-header"><div _ngcontent-kpr-c106="" class="highlight-div-header-left"><div _ngcontent-kpr-c106="" class="handle-button expand-button"><div _ngcontent-kpr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kpr-c106="" class="highlight-div-header-right"><div _ngcontent-kpr-c106="" class="handle-button ai-button"></div><div _ngcontent-kpr-c106="" class="handle-button line-button"><div _ngcontent-kpr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kpr-c106="" class="handle-button theme-button"><div _ngcontent-kpr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kpr-c106="" class="handle-button copy-button"><div _ngcontent-kpr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kpr-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Info</span> {</li><li>  <span class="hljs-attr">info</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'Hello'</span>;</li><li>}</li><li>
</li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Child</span> {</li><li>  <span class="hljs-meta">@Link</span> <span class="hljs-attr">msg</span>: <span class="hljs-built_in">string</span>;</li><li>  <span class="hljs-meta">@Link</span> <span class="hljs-attr">info</span>: <span class="hljs-title class_">Info</span>;</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Text</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">msg</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">info</span>.<span class="hljs-property">info</span>)</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">LinkExample</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'Hello'</span>;</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">info</span>: <span class="hljs-title class_">Info</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Info</span>();</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-comment">// 正确写法</span></li><li>      <span class="hljs-title class_">Child</span>({<span class="hljs-attr">msg</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span>, <span class="hljs-attr">info</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">info</span>})</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div></li>      <li>       <p>@Link不支持装饰Function类型的变量，框架会抛出运行时错误。</p></li>     </ol>    </div>    <div class="tiledSection">     <h2 id="使用场景">使用场景<i class="anchor-icon anchor-icon-link" anchorid="使用场景" tips="复制节点链接"></i></h2>         </div>    <div class="tiledSection">     <h3 id="简单类型和类对象类型的link" class="firsth2">简单类型和类对象类型的@Link<i class="anchor-icon anchor-icon-link" anchorid="简单类型和类对象类型的link" tips="复制节点链接"></i></h3>          <p>以下示例中，点击父组件ShufflingContainer中的“Parent View: Set yellowButton”和“Parent View: Set GreenButton”，可以从父组件将变化同步给子组件。</p>     <p>1.点击子组件GreenButton和YellowButton中的Button，子组件会发生相应变化，将变化同步给父组件。因为@Link是双向同步，会将变化同步给@State。</p>     <p>2.当点击父组件ShufflingContainer中的Button时，@State会发生变化，并同步给@Link，子组件也会进行对应的刷新。</p>     <div _ngcontent-kpr-c106="" class="highlight-div"><div _ngcontent-kpr-c106="" class="highlight-div-header"><div _ngcontent-kpr-c106="" class="highlight-div-header-left"><div _ngcontent-kpr-c106="" class="handle-button expand-button"><div _ngcontent-kpr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kpr-c106="" class="highlight-div-header-right"><div _ngcontent-kpr-c106="" class="handle-button ai-button"></div><div _ngcontent-kpr-c106="" class="handle-button line-button"><div _ngcontent-kpr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kpr-c106="" class="handle-button theme-button"><div _ngcontent-kpr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kpr-c106="" class="handle-button copy-button"><div _ngcontent-kpr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kpr-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">GreenButtonState</span> {</li><li>  <span class="hljs-attr">width</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;</li><li>
</li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">width: <span class="hljs-built_in">number</span></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">width</span> = width;</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">GreenButton</span> {</li><li>  <span class="hljs-meta">@Link</span> <span class="hljs-attr">greenButtonState</span>: <span class="hljs-title class_">GreenButtonState</span>;</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Button</span>(<span class="hljs-string">'Green Button'</span>)</li><li>      .<span class="hljs-title function_">width</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">greenButtonState</span>.<span class="hljs-property">width</span>)</li><li>      .<span class="hljs-title function_">height</span>(<span class="hljs-number">40</span>)</li><li>      .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">'#64bb5c'</span>)</li><li>      .<span class="hljs-title function_">fontColor</span>(<span class="hljs-string">'#FFFFFF'</span>)</li><li>      .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">greenButtonState</span>.<span class="hljs-property">width</span> &lt; <span class="hljs-number">700</span>) {</li><li>          <span class="hljs-comment">// 更新class的属性，变化可以被观察到同步回父组件</span></li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">greenButtonState</span>.<span class="hljs-property">width</span> += <span class="hljs-number">60</span>;</li><li>        } <span class="hljs-keyword">else</span> {</li><li>          <span class="hljs-comment">// 更新class，变化可以被观察到同步回父组件</span></li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">greenButtonState</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">GreenButtonState</span>(<span class="hljs-number">180</span>);</li><li>        }</li><li>      })</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">YellowButton</span> {</li><li>  <span class="hljs-meta">@Link</span> <span class="hljs-attr">yellowButtonState</span>: <span class="hljs-built_in">number</span>;</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Button</span>(<span class="hljs-string">'Yellow Button'</span>)</li><li>      .<span class="hljs-title function_">width</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">yellowButtonState</span>)</li><li>      .<span class="hljs-title function_">height</span>(<span class="hljs-number">40</span>)</li><li>      .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">'#f7ce00'</span>)</li><li>      .<span class="hljs-title function_">fontColor</span>(<span class="hljs-string">'#FFFFFF'</span>)</li><li>      .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>        <span class="hljs-comment">// 子组件的简单类型可以同步回父组件</span></li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">yellowButtonState</span> += <span class="hljs-number">40.0</span>;</li><li>      })</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">ShufflingContainer</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">greenButtonState</span>: <span class="hljs-title class_">GreenButtonState</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">GreenButtonState</span>(<span class="hljs-number">180</span>);</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">yellowButtonProp</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">180</span>;</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Flex</span>({ <span class="hljs-attr">direction</span>: <span class="hljs-title class_">FlexDirection</span>.<span class="hljs-property">Column</span>, <span class="hljs-attr">alignItems</span>: <span class="hljs-title class_">ItemAlign</span>.<span class="hljs-property">Center</span> }) {</li><li>        <span class="hljs-comment">// 简单类型从父组件@State向子组件@Link数据同步</span></li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">'Parent View: Set yellowButton'</span>)</li><li>          .<span class="hljs-title function_">width</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">yellowButtonProp</span>)</li><li>          .<span class="hljs-title function_">height</span>(<span class="hljs-number">40</span>)</li><li>          .<span class="hljs-title function_">margin</span>(<span class="hljs-number">12</span>)</li><li>          .<span class="hljs-title function_">fontColor</span>(<span class="hljs-string">'#FFFFFF'</span>)</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">yellowButtonProp</span> = (<span class="hljs-variable language_">this</span>.<span class="hljs-property">yellowButtonProp</span> &lt; <span class="hljs-number">700</span>) ? <span class="hljs-variable language_">this</span>.<span class="hljs-property">yellowButtonProp</span> + <span class="hljs-number">40</span> : <span class="hljs-number">100</span>;</li><li>          })</li><li>        <span class="hljs-comment">// class类型从父组件@State向子组件@Link数据同步</span></li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">'Parent View: Set GreenButton'</span>)</li><li>          .<span class="hljs-title function_">width</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">greenButtonState</span>.<span class="hljs-property">width</span>)</li><li>          .<span class="hljs-title function_">height</span>(<span class="hljs-number">40</span>)</li><li>          .<span class="hljs-title function_">margin</span>(<span class="hljs-number">12</span>)</li><li>          .<span class="hljs-title function_">fontColor</span>(<span class="hljs-string">'#FFFFFF'</span>)</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">greenButtonState</span>.<span class="hljs-property">width</span> = (<span class="hljs-variable language_">this</span>.<span class="hljs-property">greenButtonState</span>.<span class="hljs-property">width</span> &lt; <span class="hljs-number">700</span>) ? <span class="hljs-variable language_">this</span>.<span class="hljs-property">greenButtonState</span>.<span class="hljs-property">width</span> + <span class="hljs-number">100</span> : <span class="hljs-number">100</span>;</li><li>          })</li><li>        <span class="hljs-comment">// class类型初始化@Link</span></li><li>        <span class="hljs-title class_">GreenButton</span>({ <span class="hljs-attr">greenButtonState</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">greenButtonState</span> }).<span class="hljs-title function_">margin</span>(<span class="hljs-number">12</span>)</li><li>        <span class="hljs-comment">// 简单类型初始化@Link</span></li><li>        <span class="hljs-title class_">YellowButton</span>({ <span class="hljs-attr">yellowButtonState</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">yellowButtonProp</span> }).<span class="hljs-title function_">margin</span>(<span class="hljs-number">12</span>)</li><li>      }</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>     <p><span><img originheight="376" originwidth="348" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114957.84949350586770084271607890701208:50001231000000:2800:85391D8360FCA382101E65CEFC40F76361F6915129CEE3A1C7B2C47FA52A2344.gif" width="348" height="376"></span></p>    </div>    <div class="tiledSection">     <h3 id="数组类型的link">数组类型的@Link<i class="anchor-icon anchor-icon-link" anchorid="数组类型的link" tips="复制节点链接"></i></h3>          <div _ngcontent-kpr-c106="" class="highlight-div"><div _ngcontent-kpr-c106="" class="highlight-div-header"><div _ngcontent-kpr-c106="" class="highlight-div-header-left"><div _ngcontent-kpr-c106="" class="handle-button expand-button"><div _ngcontent-kpr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kpr-c106="" class="highlight-div-header-right"><div _ngcontent-kpr-c106="" class="handle-button ai-button"></div><div _ngcontent-kpr-c106="" class="handle-button line-button"><div _ngcontent-kpr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kpr-c106="" class="handle-button theme-button"><div _ngcontent-kpr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kpr-c106="" class="handle-button copy-button"><div _ngcontent-kpr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kpr-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Child</span> {</li><li>  <span class="hljs-meta">@Link</span> <span class="hljs-attr">items</span>: <span class="hljs-built_in">number</span>[];</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">`Button1: push`</span>)</li><li>        .<span class="hljs-title function_">margin</span>(<span class="hljs-number">12</span>)</li><li>        .<span class="hljs-title function_">width</span>(<span class="hljs-number">312</span>)</li><li>        .<span class="hljs-title function_">height</span>(<span class="hljs-number">40</span>)</li><li>        .<span class="hljs-title function_">fontColor</span>(<span class="hljs-string">'#FFFFFF'</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span>.<span class="hljs-title function_">push</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span>.<span class="hljs-property">length</span> + <span class="hljs-number">1</span>);</li><li>        })</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">`Button2: replace whole item`</span>)</li><li>        .<span class="hljs-title function_">margin</span>(<span class="hljs-number">12</span>)</li><li>        .<span class="hljs-title function_">width</span>(<span class="hljs-number">312</span>)</li><li>        .<span class="hljs-title function_">height</span>(<span class="hljs-number">40</span>)</li><li>        .<span class="hljs-title function_">fontColor</span>(<span class="hljs-string">'#FFFFFF'</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">items</span> = [<span class="hljs-number">100</span>, <span class="hljs-number">200</span>, <span class="hljs-number">300</span>];</li><li>        })</li><li>    }</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Parent</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">arr</span>: <span class="hljs-built_in">number</span>[] = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>];</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Child</span>({ <span class="hljs-attr">items</span>: $arr })</li><li>        .<span class="hljs-title function_">margin</span>(<span class="hljs-number">12</span>)</li><li>      <span class="hljs-title class_">ForEach</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">arr</span>,</li><li>        <span class="hljs-function">(<span class="hljs-params">item: <span class="hljs-built_in">number</span></span>) =&gt;</span> {</li><li>          <span class="hljs-title class_">Button</span>(<span class="hljs-string">`<span class="hljs-subst">${item}</span>`</span>)</li><li>            .<span class="hljs-title function_">margin</span>(<span class="hljs-number">12</span>)</li><li>            .<span class="hljs-title function_">width</span>(<span class="hljs-number">312</span>)</li><li>            .<span class="hljs-title function_">height</span>(<span class="hljs-number">40</span>)</li><li>            .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">'#11a2a2a2'</span>)</li><li>            .<span class="hljs-title function_">fontColor</span>(<span class="hljs-string">'#e6000000'</span>)</li><li>        },</li><li>        <span class="hljs-function">(<span class="hljs-params">item: ForEachInterface</span>) =&gt;</span> item.<span class="hljs-title function_">toString</span>()</li><li>      )</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>     <p><span><img originheight="356" originwidth="304" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114957.38592483451027345015026667599381:50001231000000:2800:4B8802500C259B53986B3F51B89181C1D89027C48395379BA9B9F3CA12CA0371.gif" width="304" height="356"></span></p>     <p>ArkUI框架可以观察到数组元素的添加、删除和替换。在该示例中，@State和@Link的类型均为number[]，不支持将@Link定义成number类型（@Link item : number），并用@State数组中的每个数据项在父组件中创建子组件。如需使用这种场景，可以参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-prop">@Prop</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-observed-and-objectlink">@Observed</a>。</p>    </div>    <div class="tiledSection">     <h3 id="装饰map类型变量">装饰Map类型变量<i class="anchor-icon anchor-icon-link" anchorid="装饰map类型变量" tips="复制节点链接"></i></h3>          <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>从API version 11开始，@Link支持Map类型。</p>      </div></div></div>     <p>在下面的示例中，value类型为Map&lt;number, string&gt;，点击Button改变message的值，视图会随之刷新。</p>     <div _ngcontent-kpr-c106="" class="highlight-div"><div _ngcontent-kpr-c106="" class="highlight-div-header"><div _ngcontent-kpr-c106="" class="highlight-div-header-left"><div _ngcontent-kpr-c106="" class="handle-button expand-button"><div _ngcontent-kpr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kpr-c106="" class="highlight-div-header-right"><div _ngcontent-kpr-c106="" class="handle-button ai-button"></div><div _ngcontent-kpr-c106="" class="handle-button line-button"><div _ngcontent-kpr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kpr-c106="" class="handle-button theme-button"><div _ngcontent-kpr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kpr-c106="" class="handle-button copy-button"><div _ngcontent-kpr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kpr-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Child</span> {</li><li>  <span class="hljs-meta">@Link</span> <span class="hljs-attr">value</span>: <span class="hljs-title class_">Map</span>&lt;<span class="hljs-built_in">number</span>, <span class="hljs-built_in">string</span>&gt;;</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">ForEach</span>(<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>.<span class="hljs-title function_">entries</span>()), <span class="hljs-function">(<span class="hljs-params">item: [<span class="hljs-built_in">number</span>, <span class="hljs-built_in">string</span>]</span>) =&gt;</span> {</li><li>        <span class="hljs-title class_">Text</span>(<span class="hljs-string">`<span class="hljs-subst">${item[<span class="hljs-number">0</span>]}</span>`</span>).<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">30</span>)</li><li>        <span class="hljs-title class_">Text</span>(<span class="hljs-string">`<span class="hljs-subst">${item[<span class="hljs-number">1</span>]}</span>`</span>).<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">30</span>)</li><li>        <span class="hljs-title class_">Divider</span>()</li><li>      })</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'child init map'</span>).<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>([[<span class="hljs-number">0</span>, <span class="hljs-string">'a'</span>], [<span class="hljs-number">1</span>, <span class="hljs-string">'b'</span>], [<span class="hljs-number">3</span>, <span class="hljs-string">'c'</span>]]);</li><li>      })</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'child set new one'</span>).<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>.<span class="hljs-title function_">set</span>(<span class="hljs-number">4</span>, <span class="hljs-string">'d'</span>);</li><li>      })</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'child clear'</span>).<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>.<span class="hljs-title function_">clear</span>();</li><li>      })</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'child replace the first one'</span>).<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>.<span class="hljs-title function_">set</span>(<span class="hljs-number">0</span>, <span class="hljs-string">'aa'</span>);</li><li>      })</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'child delete the first one'</span>).<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>.<span class="hljs-title function_">delete</span>(<span class="hljs-number">0</span>);</li><li>      })</li><li>    }</li><li>  }</li><li>}</li><li>
</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">MapSample</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">message</span>: <span class="hljs-title class_">Map</span>&lt;<span class="hljs-built_in">number</span>, <span class="hljs-built_in">string</span>&gt; = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>([[<span class="hljs-number">0</span>, <span class="hljs-string">'a'</span>], [<span class="hljs-number">1</span>, <span class="hljs-string">'b'</span>], [<span class="hljs-number">3</span>, <span class="hljs-string">'c'</span>]]);</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Row</span>() {</li><li>      <span class="hljs-title class_">Column</span>() {</li><li>        <span class="hljs-title class_">Child</span>({ <span class="hljs-attr">value</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span> })</li><li>      }</li><li>      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    }</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="装饰set类型变量">装饰Set类型变量<i class="anchor-icon anchor-icon-link" anchorid="装饰set类型变量" tips="复制节点链接"></i></h3>          <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>从API version 11开始，@Link支持Set类型。</p>      </div></div></div>     <p>在下面的示例中，message类型为Set&lt;number&gt;，点击Button改变message的值，视图会随之刷新。</p>     <div _ngcontent-kpr-c106="" class="highlight-div"><div _ngcontent-kpr-c106="" class="highlight-div-header"><div _ngcontent-kpr-c106="" class="highlight-div-header-left"><div _ngcontent-kpr-c106="" class="handle-button expand-button"><div _ngcontent-kpr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kpr-c106="" class="highlight-div-header-right"><div _ngcontent-kpr-c106="" class="handle-button ai-button"></div><div _ngcontent-kpr-c106="" class="handle-button line-button"><div _ngcontent-kpr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kpr-c106="" class="handle-button theme-button"><div _ngcontent-kpr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kpr-c106="" class="handle-button copy-button"><div _ngcontent-kpr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kpr-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Child</span> {</li><li>  <span class="hljs-meta">@Link</span> <span class="hljs-attr">message</span>: <span class="hljs-title class_">Set</span>&lt;<span class="hljs-built_in">number</span>&gt;;</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">ForEach</span>(<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span>.<span class="hljs-title function_">entries</span>()), <span class="hljs-function">(<span class="hljs-params">item: [<span class="hljs-built_in">number</span>, <span class="hljs-built_in">number</span>]</span>) =&gt;</span> {</li><li>        <span class="hljs-title class_">Text</span>(<span class="hljs-string">`<span class="hljs-subst">${item[<span class="hljs-number">0</span>]}</span>`</span>).<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">30</span>)</li><li>        <span class="hljs-title class_">Divider</span>()</li><li>      })</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'init set'</span>).<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>([<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>]);</li><li>      })</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'set new one'</span>).<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span>.<span class="hljs-title function_">add</span>(<span class="hljs-number">5</span>);</li><li>      })</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'clear'</span>).<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span>.<span class="hljs-title function_">clear</span>();</li><li>      })</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'delete the first one'</span>).<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span>.<span class="hljs-title function_">delete</span>(<span class="hljs-number">0</span>);</li><li>      })</li><li>    }</li><li>    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li><li>
</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">SetSample</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">message</span>: <span class="hljs-title class_">Set</span>&lt;<span class="hljs-built_in">number</span>&gt; = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>([<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>]);</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Row</span>() {</li><li>      <span class="hljs-title class_">Column</span>() {</li><li>        <span class="hljs-title class_">Child</span>({ <span class="hljs-attr">message</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span> })</li><li>      }</li><li>      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    }</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="装饰date类型变量">装饰Date类型变量<i class="anchor-icon anchor-icon-link" anchorid="装饰date类型变量" tips="复制节点链接"></i></h3>          <p>在下面的示例中，selectedDate类型为Date，点击Button改变selectedDate的值，视图会随之刷新。</p>     <div _ngcontent-kpr-c106="" class="highlight-div"><div _ngcontent-kpr-c106="" class="highlight-div-header"><div _ngcontent-kpr-c106="" class="highlight-div-header-left"><div _ngcontent-kpr-c106="" class="handle-button expand-button"><div _ngcontent-kpr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kpr-c106="" class="highlight-div-header-right"><div _ngcontent-kpr-c106="" class="handle-button ai-button"></div><div _ngcontent-kpr-c106="" class="handle-button line-button"><div _ngcontent-kpr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kpr-c106="" class="handle-button theme-button"><div _ngcontent-kpr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kpr-c106="" class="handle-button copy-button"><div _ngcontent-kpr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kpr-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">DateComponent</span> {</li><li>  <span class="hljs-meta">@Link</span> <span class="hljs-attr">selectedDate</span>: <span class="hljs-title class_">Date</span>;</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">`child increase the year by 1`</span>)</li><li>      .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">selectedDate</span>.<span class="hljs-title function_">setFullYear</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">selectedDate</span>.<span class="hljs-title function_">getFullYear</span>() + <span class="hljs-number">1</span>);</li><li>      })</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'child update the new date'</span>)</li><li>        .<span class="hljs-title function_">margin</span>(<span class="hljs-number">10</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">selectedDate</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-string">'2023-09-09'</span>);</li><li>        })</li><li>      <span class="hljs-title class_">DatePicker</span>({</li><li>        <span class="hljs-attr">start</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-string">'1970-1-1'</span>),</li><li>        <span class="hljs-attr">end</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-string">'2100-1-1'</span>),</li><li>        <span class="hljs-attr">selected</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">selectedDate</span></li><li>      })</li><li>    }</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">ParentComponent</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">parentSelectedDate</span>: <span class="hljs-title class_">Date</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-string">'2021-08-08'</span>);</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'parent increase the month by 1'</span>)</li><li>        .<span class="hljs-title function_">margin</span>(<span class="hljs-number">10</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">parentSelectedDate</span>.<span class="hljs-title function_">setMonth</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">parentSelectedDate</span>.<span class="hljs-title function_">getMonth</span>() + <span class="hljs-number">1</span>);</li><li>        })</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'parent update the new date'</span>)</li><li>        .<span class="hljs-title function_">margin</span>(<span class="hljs-number">10</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">parentSelectedDate</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-string">'2023-07-07'</span>);</li><li>        })</li><li>      <span class="hljs-title class_">DatePicker</span>({</li><li>        <span class="hljs-attr">start</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-string">'1970-1-1'</span>),</li><li>        <span class="hljs-attr">end</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-string">'2100-1-1'</span>),</li><li>        <span class="hljs-attr">selected</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">parentSelectedDate</span></li><li>      })</li><li>
</li><li>      <span class="hljs-title class_">DateComponent</span>({ <span class="hljs-attr">selectedDate</span>:<span class="hljs-variable language_">this</span>.<span class="hljs-property">parentSelectedDate</span> })</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="使用双向同步机制更改本地其他变量">使用双向同步机制更改本地其他变量<i class="anchor-icon anchor-icon-link" anchorid="使用双向同步机制更改本地其他变量" tips="复制节点链接"></i></h3>          <p>通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-watch">@Watch</a>可以在双向同步时更改本地变量。</p>     <p>以下示例中，在@Link的@Watch里面修改了一个@State装饰的变量memberMessage，实现父子组件间的变量同步。但是@State装饰的变量memberMessage在本地修改不会影响到父组件中的变量改变。</p>     <div _ngcontent-kpr-c106="" class="highlight-div"><div _ngcontent-kpr-c106="" class="highlight-div-header"><div _ngcontent-kpr-c106="" class="highlight-div-header-left"><div _ngcontent-kpr-c106="" class="handle-button expand-button"><div _ngcontent-kpr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kpr-c106="" class="highlight-div-header-right"><div _ngcontent-kpr-c106="" class="handle-button ai-button"></div><div _ngcontent-kpr-c106="" class="handle-button line-button"><div _ngcontent-kpr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kpr-c106="" class="handle-button theme-button"><div _ngcontent-kpr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kpr-c106="" class="handle-button copy-button"><div _ngcontent-kpr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kpr-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Parent</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">sourceNumber</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`父组件的sourceNumber：`</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">sourceNumber</span>)</li><li>      <span class="hljs-title class_">Child</span>({ <span class="hljs-attr">sourceNumber</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">sourceNumber</span> })</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'父组件更改sourceNumber'</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">sourceNumber</span>++;</li><li>        })</li><li>    }</li><li>    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Child</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">memberMessage</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'Hello World'</span>;</li><li>  <span class="hljs-meta">@Link</span> <span class="hljs-meta">@Watch</span>(<span class="hljs-string">'onSourceChange'</span>) <span class="hljs-attr">sourceNumber</span>: <span class="hljs-built_in">number</span>;</li><li>
</li><li>  <span class="hljs-title function_">onSourceChange</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">memberMessage</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">sourceNumber</span>.<span class="hljs-title function_">toString</span>();</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">memberMessage</span>)</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`子组件的sourceNumber：`</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">sourceNumber</span>.<span class="hljs-title function_">toString</span>())</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'子组件更改memberMessage'</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">memberMessage</span> = <span class="hljs-string">'Hello memberMessage'</span>;</li><li>        })</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="link支持联合类型实例">Link支持联合类型实例<i class="anchor-icon anchor-icon-link" anchorid="link支持联合类型实例" tips="复制节点链接"></i></h3>          <p>@Link支持联合类型、undefined和null。在以下示例中，name类型为string | undefined。点击父组件Index中的按钮可以改变name的属性或类型，Child组件也会相应刷新。</p>     <div _ngcontent-kpr-c106="" class="highlight-div"><div _ngcontent-kpr-c106="" class="highlight-div-header"><div _ngcontent-kpr-c106="" class="highlight-div-header-left"><div _ngcontent-kpr-c106="" class="handle-button expand-button"><div _ngcontent-kpr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kpr-c106="" class="highlight-div-header-right"><div _ngcontent-kpr-c106="" class="handle-button ai-button"></div><div _ngcontent-kpr-c106="" class="handle-button line-button"><div _ngcontent-kpr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kpr-c106="" class="handle-button theme-button"><div _ngcontent-kpr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kpr-c106="" class="handle-button copy-button"><div _ngcontent-kpr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kpr-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Child</span> {</li><li>  <span class="hljs-meta">@Link</span> <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span> | <span class="hljs-literal">undefined</span>;</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>
</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'Child change name to Bob'</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = <span class="hljs-string">'Bob'</span>;</li><li>        })</li><li>
</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'Child change name to undefined'</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = <span class="hljs-literal">undefined</span>;</li><li>        })</li><li>
</li><li>    }.<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span> | <span class="hljs-literal">undefined</span> = <span class="hljs-string">'mary'</span>;</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`The name is  <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.name}</span>`</span>).<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">30</span>)</li><li>
</li><li>      <span class="hljs-title class_">Child</span>({ <span class="hljs-attr">name</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> })</li><li>
</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'Parents change name to Peter'</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = <span class="hljs-string">'Peter'</span>;</li><li>        })</li><li>
</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'Parents change name to undefined'</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = <span class="hljs-literal">undefined</span>;</li><li>        })</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="常见问题">常见问题<i class="anchor-icon anchor-icon-link" anchorid="常见问题" tips="复制节点链接"></i></h2>         </div>    <div class="tiledSection">     <h3 id="使用abthisobject形式调用不会触发ui刷新" class="firsth2">使用a.b(this.object)形式调用，不会触发UI刷新<i class="anchor-icon anchor-icon-link" anchorid="使用abthisobject形式调用不会触发ui刷新" tips="复制节点链接"></i></h3>          <p>在build方法内，当@Link装饰的变量是Object类型且通过a.b(this.object)形式调用时，b方法内传入的是this.object的原始对象，修改其属性无法触发UI刷新。以下示例中，通过静态方法Score.changeScore1或this.changeScore2修改Child组件中的this.score.value时，UI不会刷新。</p>     <p>【反例】</p>     <div _ngcontent-kpr-c106="" class="highlight-div"><div _ngcontent-kpr-c106="" class="highlight-div-header"><div _ngcontent-kpr-c106="" class="highlight-div-header-left"><div _ngcontent-kpr-c106="" class="handle-button expand-button"><div _ngcontent-kpr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kpr-c106="" class="highlight-div-header-right"><div _ngcontent-kpr-c106="" class="handle-button ai-button"></div><div _ngcontent-kpr-c106="" class="handle-button line-button"><div _ngcontent-kpr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kpr-c106="" class="handle-button theme-button"><div _ngcontent-kpr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kpr-c106="" class="handle-button copy-button"><div _ngcontent-kpr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kpr-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Score</span> {</li><li>  <span class="hljs-attr">value</span>: <span class="hljs-built_in">number</span>;</li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">value: <span class="hljs-built_in">number</span></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = value;</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">static</span> <span class="hljs-title function_">changeScore1</span>(<span class="hljs-params">score:Score</span>) {</li><li>    score.<span class="hljs-property">value</span> += <span class="hljs-number">1</span>;</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Parent</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">score</span>: <span class="hljs-title class_">Score</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Score</span>(<span class="hljs-number">1</span>);</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>({<span class="hljs-attr">space</span>:<span class="hljs-number">8</span>}) {</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`The value in Parent is <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.score.value}</span>.`</span>)</li><li>        .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">30</span>)</li><li>        .<span class="hljs-title function_">fontColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Red</span>)</li><li>      <span class="hljs-title class_">Child</span>({ <span class="hljs-attr">score</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">score</span> })</li><li>    }</li><li>    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Child</span> {</li><li>  <span class="hljs-meta">@Link</span> <span class="hljs-attr">score</span>: <span class="hljs-title class_">Score</span>;</li><li>
</li><li>  <span class="hljs-title function_">changeScore2</span>(<span class="hljs-params">score:Score</span>) {</li><li>    score.<span class="hljs-property">value</span> += <span class="hljs-number">2</span>;</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>({<span class="hljs-attr">space</span>:<span class="hljs-number">8</span>}) {</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`The value in Child is <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.score.value}</span>.`</span>)</li><li>        .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">30</span>)</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">`changeScore1`</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">()=&gt;</span>{</li><li>          <span class="hljs-comment">// 通过静态方法调用，无法触发UI刷新</span></li><li>          <span class="hljs-title class_">Score</span>.<span class="hljs-title function_">changeScore1</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">score</span>);</li><li>        })</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">`changeScore2`</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">()=&gt;</span>{</li><li>          <span class="hljs-comment">// 使用this通过自定义组件内部方法调用，无法触发UI刷新</span></li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">changeScore2</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">score</span>);</li><li>        })</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>     <p>可以通过如下先赋值、再调用新赋值的变量的方式为this.score加上Proxy代理，实现UI刷新。</p>     <p>【正例】</p>     <div _ngcontent-kpr-c106="" class="highlight-div"><div _ngcontent-kpr-c106="" class="highlight-div-header"><div _ngcontent-kpr-c106="" class="highlight-div-header-left"><div _ngcontent-kpr-c106="" class="handle-button expand-button"><div _ngcontent-kpr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kpr-c106="" class="highlight-div-header-right"><div _ngcontent-kpr-c106="" class="handle-button ai-button"></div><div _ngcontent-kpr-c106="" class="handle-button line-button"><div _ngcontent-kpr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kpr-c106="" class="handle-button theme-button"><div _ngcontent-kpr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kpr-c106="" class="handle-button copy-button"><div _ngcontent-kpr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kpr-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Score</span> {</li><li>  <span class="hljs-attr">value</span>: <span class="hljs-built_in">number</span>;</li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">value: <span class="hljs-built_in">number</span></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = value;</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">static</span> <span class="hljs-title function_">changeScore1</span>(<span class="hljs-params">score:Score</span>) {</li><li>    score.<span class="hljs-property">value</span> += <span class="hljs-number">1</span>;</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Parent</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">score</span>: <span class="hljs-title class_">Score</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Score</span>(<span class="hljs-number">1</span>);</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>({<span class="hljs-attr">space</span>:<span class="hljs-number">8</span>}) {</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`The value in Parent is <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.score.value}</span>.`</span>)</li><li>        .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">30</span>)</li><li>        .<span class="hljs-title function_">fontColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Red</span>)</li><li>      <span class="hljs-title class_">Child</span>({ <span class="hljs-attr">score</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">score</span> })</li><li>    }</li><li>    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Child</span> {</li><li>  <span class="hljs-meta">@Link</span> <span class="hljs-attr">score</span>: <span class="hljs-title class_">Score</span>;</li><li>
</li><li>  <span class="hljs-title function_">changeScore2</span>(<span class="hljs-params">score:Score</span>) {</li><li>    score.<span class="hljs-property">value</span> += <span class="hljs-number">2</span>;</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>({<span class="hljs-attr">space</span>:<span class="hljs-number">8</span>}) {</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`The value in Child is <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.score.value}</span>.`</span>)</li><li>        .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">30</span>)</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">`changeScore1`</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">()=&gt;</span>{</li><li>          <span class="hljs-comment">// 通过赋值添加 Proxy 代理</span></li><li>          <span class="hljs-keyword">let</span> score1 = <span class="hljs-variable language_">this</span>.<span class="hljs-property">score</span>;</li><li>          <span class="hljs-title class_">Score</span>.<span class="hljs-title function_">changeScore1</span>(score1);</li><li>        })</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">`changeScore2`</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">()=&gt;</span>{</li><li>          <span class="hljs-comment">// 通过赋值添加 Proxy 代理</span></li><li>          <span class="hljs-keyword">let</span> score2 = <span class="hljs-variable language_">this</span>.<span class="hljs-property">score</span>;</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">changeScore2</span>(score2);</li><li>        })</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>   </div>   <div></div></div>