<h1 _ngcontent-nbx-c119="" class="doc-title ng-star-inserted" title="@ObservedV2装饰器和@Trace装饰器：类属性变化观测"> @ObservedV2装饰器和@Trace装饰器：类属性变化观测 </h1>

<div _ngcontent-nbx-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div><p>为了增强状态管理框架对类对象中属性的观测能力，开发者可以使用@ObservedV2装饰器和@Trace装饰器装饰类以及类中的属性。</p> <p>@ObservedV2和@Trace提供了对嵌套类对象属性变化直接观测的能力，是状态管理V2中相对核心的能力之一。在阅读本文档前，建议提前阅读：<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-state-management-overview">状态管理概述</a>来了解状态管理V2整体的能力架构。</p> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"> <p>@ObservedV2与@Trace装饰器从API version 12开始支持。</p>  <p>从API version 12开始，@ObservedV2与@Trace装饰器支持在ArkTS卡片中使用。</p>  <p>从API version 12开始，@ObservedV2与@Trace装饰器支持在元服务中使用。</p>  </div></div></div>  <div class="tiledSection"><h2 id="概述">概述<i class="anchor-icon anchor-icon-link" anchorid="概述" tips="复制节点链接"></i></h2><p>@ObservedV2装饰器与@Trace装饰器用于装饰类以及类中的属性，使得被装饰的类和属性具有深度观测的能力：</p> <ul><li>@ObservedV2装饰器与@Trace装饰器需要配合使用，单独使用@ObservedV2装饰器或@Trace装饰器没有任何作用。</li><li>被@Trace装饰器装饰的属性property变化时，仅会通知property关联的组件进行刷新。</li><li>在嵌套类中，嵌套类中的属性property被@Trace装饰且嵌套类被@ObservedV2装饰时，才具有触发UI刷新的能力。</li><li>在继承类中，父类或子类中的属性property被@Trace装饰且该property所在类被@ObservedV2装饰时，才具有触发UI刷新的能力。</li><li>未被@Trace装饰的属性用在UI中无法感知到变化，也无法触发UI刷新。</li><li>@ObservedV2的类实例目前不支持使用JSON.stringify进行序列化。</li><li>使用@ObservedV2与@Trace装饰器的类，需通过new操作符实例化后，才具备被观测变化的能力。</li></ul> </div>  <div class="tiledSection"><h2 id="状态管理v1版本对嵌套类对象属性变化直接观测的局限性">状态管理V1版本对嵌套类对象属性变化直接观测的局限性<i class="anchor-icon anchor-icon-link" anchorid="状态管理v1版本对嵌套类对象属性变化直接观测的局限性" tips="复制节点链接"></i></h2><p>现有状态管理V1版本无法实现对嵌套类对象属性变化的直接观测。</p> <div _ngcontent-nbx-c106="" class="highlight-div"><div _ngcontent-nbx-c106="" class="highlight-div-header"><div _ngcontent-nbx-c106="" class="highlight-div-header-left"><div _ngcontent-nbx-c106="" class="handle-button expand-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-nbx-c106="" class="highlight-div-header-right"><div _ngcontent-nbx-c106="" class="handle-button ai-button"></div><div _ngcontent-nbx-c106="" class="handle-button line-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-nbx-c106="" class="handle-button theme-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-nbx-c106="" class="handle-button copy-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-nbx-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@Observed</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Father</span> {</li><li>  <span class="hljs-attr">son</span>: <span class="hljs-title class_">Son</span>;</li><li>
</li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name: <span class="hljs-built_in">string</span>, age: <span class="hljs-built_in">number</span></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">son</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Son</span>(name, age);</li><li>  }</li><li>}</li><li><span class="hljs-meta">@Observed</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Son</span> {</li><li>  <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;</li><li>  <span class="hljs-attr">age</span>: <span class="hljs-built_in">number</span>;</li><li>
</li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name: <span class="hljs-built_in">string</span>, age: <span class="hljs-built_in">number</span></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;</li><li>  }</li><li>}</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">father</span>: <span class="hljs-title class_">Father</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Father</span>(<span class="hljs-string">'John'</span>, <span class="hljs-number">8</span>);</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Row</span>() {</li><li>      <span class="hljs-title class_">Column</span>() {</li><li>        <span class="hljs-title class_">Text</span>(<span class="hljs-string">`name: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.father.son.name}</span> age: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.father.son.age}</span>`</span>)</li><li>          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">50</span>)</li><li>          .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">father</span>.<span class="hljs-property">son</span>.<span class="hljs-property">age</span>++;</li><li>          })</li><li>      }</li><li>      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    }</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div> <p>在上述代码中，点击Text组件增加age的值时，不会触发UI刷新。原因在于现有的状态管理框架无法观测到嵌套类中属性age的值变化。V1版本的解决方案是使用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-observed-and-objectlink">@ObjectLink装饰器</a>与自定义组件来实现观测。</p> <div _ngcontent-nbx-c106="" class="highlight-div"><div _ngcontent-nbx-c106="" class="highlight-div-header"><div _ngcontent-nbx-c106="" class="highlight-div-header-left"><div _ngcontent-nbx-c106="" class="handle-button expand-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-nbx-c106="" class="highlight-div-header-right"><div _ngcontent-nbx-c106="" class="handle-button ai-button"></div><div _ngcontent-nbx-c106="" class="handle-button line-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-nbx-c106="" class="handle-button theme-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-nbx-c106="" class="handle-button copy-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-nbx-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@Observed</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Father</span> {</li><li>  <span class="hljs-attr">son</span>: <span class="hljs-title class_">Son</span>;</li><li>
</li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name: <span class="hljs-built_in">string</span>, age: <span class="hljs-built_in">number</span></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">son</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Son</span>(name, age);</li><li>  }</li><li>}</li><li><span class="hljs-meta">@Observed</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Son</span> {</li><li>  <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;</li><li>  <span class="hljs-attr">age</span>: <span class="hljs-built_in">number</span>;</li><li>
</li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name: <span class="hljs-built_in">string</span>, age: <span class="hljs-built_in">number</span></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;</li><li>  }</li><li>}</li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Child</span> {</li><li>  <span class="hljs-meta">@ObjectLink</span> <span class="hljs-attr">son</span>: <span class="hljs-title class_">Son</span>;</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Row</span>() {</li><li>      <span class="hljs-title class_">Column</span>() {</li><li>        <span class="hljs-title class_">Text</span>(<span class="hljs-string">`name: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.son.name}</span> age: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.son.age}</span>`</span>)</li><li>          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">50</span>)</li><li>          .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">son</span>.<span class="hljs-property">age</span>++;</li><li>          })</li><li>      }</li><li>      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    }</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">father</span>: <span class="hljs-title class_">Father</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Father</span>(<span class="hljs-string">'John'</span>, <span class="hljs-number">8</span>);</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Child</span>({<span class="hljs-attr">son</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">father</span>.<span class="hljs-property">son</span>})</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div> <p>通过这种方式虽然能够实现对嵌套类中属性变化的观测，但是当嵌套层级较深时，代码将会变得十分复杂，易用性差。因此推出类装饰器@ObservedV2与成员变量装饰器@Trace，增强对嵌套类中属性变化的观测能力。</p> </div>  <div class="tiledSection"><h2 id="装饰器说明">装饰器说明<i class="anchor-icon anchor-icon-link" anchorid="装饰器说明" tips="复制节点链接"></i></h2> <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.6.2.1.3.1.1" valign="top" width="50%">@ObservedV2类装饰器</th> <th align="left" class="cellrowborder" id="mcps1.3.6.2.1.3.1.2" valign="top" width="50%">说明</th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="50%">装饰器参数</td> <td class="cellrowborder" valign="top" width="50%">无。</td> </tr> <tr><td class="cellrowborder" valign="top" width="50%">类装饰器</td> <td class="cellrowborder" valign="top" width="50%">装饰class。需要放在class的定义前，使用new创建类对象。</td> </tr>  </tbody></table></div> </div>  <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.6.3.1.3.1.1" valign="top" width="50%">@Trace成员变量装饰器</th> <th align="left" class="cellrowborder" id="mcps1.3.6.3.1.3.1.2" valign="top" width="50%">说明</th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="50%">装饰器参数</td> <td class="cellrowborder" valign="top" width="50%">无。</td> </tr> <tr><td class="cellrowborder" valign="top" width="50%">可装饰的变量</td> <td class="cellrowborder" valign="top" width="50%">class中成员属性。属性的类型可以为number、string、boolean、class、Array、Date、Map、Set等类型。</td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h2 id="观察变化">观察变化<i class="anchor-icon anchor-icon-link" anchorid="观察变化" tips="复制节点链接"></i></h2><p>使用@ObservedV2装饰的类中被@Trace装饰的属性具有被观测变化的能力，当该属性值变化时，会触发该属性绑定的UI组件刷新。</p> <ul><li>在嵌套类中使用@Trace装饰的属性具有被观测变化的能力。</li></ul> <div _ngcontent-nbx-c106="" class="highlight-div"><div _ngcontent-nbx-c106="" class="highlight-div-header"><div _ngcontent-nbx-c106="" class="highlight-div-header-left"><div _ngcontent-nbx-c106="" class="handle-button expand-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-nbx-c106="" class="highlight-div-header-right"><div _ngcontent-nbx-c106="" class="handle-button ai-button"></div><div _ngcontent-nbx-c106="" class="handle-button line-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-nbx-c106="" class="handle-button theme-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-nbx-c106="" class="handle-button copy-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-nbx-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@ObservedV2</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Son</span> {</li><li>  <span class="hljs-meta">@Trace</span> <span class="hljs-attr">age</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">100</span>;</li><li>}</li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Father</span> {</li><li>  <span class="hljs-attr">son</span>: <span class="hljs-title class_">Son</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Son</span>();</li><li>}</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@ComponentV2</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-attr">father</span>: <span class="hljs-title class_">Father</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Father</span>();</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-comment">// 当点击改变age时，Text组件会刷新</span></li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.father.son.age}</span>`</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">father</span>.<span class="hljs-property">son</span>.<span class="hljs-property">age</span>++;</li><li>        })</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div> <ul><li>在继承类中使用@Trace装饰的属性具有被观测变化的能力。</li></ul> <div _ngcontent-nbx-c106="" class="highlight-div"><div _ngcontent-nbx-c106="" class="highlight-div-header"><div _ngcontent-nbx-c106="" class="highlight-div-header-left"><div _ngcontent-nbx-c106="" class="handle-button expand-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-nbx-c106="" class="highlight-div-header-right"><div _ngcontent-nbx-c106="" class="handle-button ai-button"></div><div _ngcontent-nbx-c106="" class="handle-button line-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-nbx-c106="" class="handle-button theme-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-nbx-c106="" class="handle-button copy-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-nbx-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@ObservedV2</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Father</span> {</li><li>  <span class="hljs-meta">@Trace</span> <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'Tom'</span>;</li><li>}</li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Son</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Father</span> {</li><li>}</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@ComponentV2</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-attr">son</span>: <span class="hljs-title class_">Son</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Son</span>();</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-comment">// 当点击改变name时，Text组件会刷新</span></li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.son.name}</span>`</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">son</span>.<span class="hljs-property">name</span> = <span class="hljs-string">'Jack'</span>;</li><li>        })</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div> <ul><li>类中使用@Trace装饰的静态属性具有被观测变化的能力。</li></ul> <div _ngcontent-nbx-c106="" class="highlight-div"><div _ngcontent-nbx-c106="" class="highlight-div-header"><div _ngcontent-nbx-c106="" class="highlight-div-header-left"><div _ngcontent-nbx-c106="" class="handle-button expand-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-nbx-c106="" class="highlight-div-header-right"><div _ngcontent-nbx-c106="" class="handle-button ai-button"></div><div _ngcontent-nbx-c106="" class="handle-button line-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-nbx-c106="" class="handle-button theme-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-nbx-c106="" class="handle-button copy-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-nbx-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@ObservedV2</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Manager</span> {</li><li>  <span class="hljs-meta">@Trace</span> <span class="hljs-keyword">static</span> <span class="hljs-attr">count</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">1</span>;</li><li>}</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@ComponentV2</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-comment">// 当点击改变count时，Text组件会刷新</span></li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`<span class="hljs-subst">${Manager.count}</span>`</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-title class_">Manager</span>.<span class="hljs-property">count</span>++;</li><li>        })</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div> <ul><li><p>@Trace装饰内置类型时，可以观测各自API导致的变化：</p>   <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.7.9.1.2.1.3.1.1" valign="top" width="50%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.7.9.1.2.1.3.1.2" valign="top" width="50%">可观测变化的API</th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="50%">Array</td> <td class="cellrowborder" valign="top" width="50%">push、pop、shift、unshift、splice、copyWithin、fill、reverse、sort</td> </tr> <tr><td class="cellrowborder" valign="top" width="50%">Date</td> <td class="cellrowborder" valign="top" width="50%">setFullYear, setMonth, setDate, setHours, setMinutes, setSeconds, setMilliseconds, setTime, setUTCFullYear, setUTCMonth, setUTCDate, setUTCHours, setUTCMinutes, setUTCSeconds, setUTCMilliseconds</td> </tr> <tr><td class="cellrowborder" valign="top" width="50%">Map</td> <td class="cellrowborder" valign="top" width="50%">set, clear, delete</td> </tr> <tr><td class="cellrowborder" valign="top" width="50%">Set</td> <td class="cellrowborder" valign="top" width="50%">add, clear, delete</td> </tr>  </tbody></table></div> </div>  </li></ul> </div>  <div class="tiledSection"><h2 id="使用限制">使用限制<i class="anchor-icon anchor-icon-link" anchorid="使用限制" tips="复制节点链接"></i></h2><p>@ObservedV2与@Trace装饰器存在以下使用限制：</p> <ul><li>非@Trace装饰的成员属性用在UI上无法触发UI刷新。</li></ul> <div _ngcontent-nbx-c106="" class="highlight-div"><div _ngcontent-nbx-c106="" class="highlight-div-header"><div _ngcontent-nbx-c106="" class="highlight-div-header-left"><div _ngcontent-nbx-c106="" class="handle-button expand-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-nbx-c106="" class="highlight-div-header-right"><div _ngcontent-nbx-c106="" class="handle-button ai-button"></div><div _ngcontent-nbx-c106="" class="handle-button line-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-nbx-c106="" class="handle-button theme-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-nbx-c106="" class="handle-button copy-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-nbx-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@ObservedV2</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span> {</li><li>  <span class="hljs-attr">id</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;</li><li>  <span class="hljs-meta">@Trace</span> <span class="hljs-attr">age</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">8</span>;</li><li>}</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@ComponentV2</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-attr">person</span>: <span class="hljs-title class_">Person</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>();</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-comment">// age被@Trace装饰，用在UI中可以触发UI刷新</span></li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.person.age}</span>`</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">person</span>.<span class="hljs-property">age</span>++; <span class="hljs-comment">// 点击会触发UI刷新</span></li><li>        })</li><li>      <span class="hljs-comment">// id未被@Trace装饰，用在UI中不会触发UI刷新</span></li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.person.id}</span>`</span>) <span class="hljs-comment">// 当id变化时不会刷新</span></li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">person</span>.<span class="hljs-property">id</span>++; <span class="hljs-comment">// 点击不会触发UI刷新</span></li><li>        })</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div> <ul><li>@ObservedV2仅能装饰class，无法装饰自定义组件。</li></ul> <div _ngcontent-nbx-c106="" class="highlight-div"><div _ngcontent-nbx-c106="" class="highlight-div-header"><div _ngcontent-nbx-c106="" class="highlight-div-header-left"><div _ngcontent-nbx-c106="" class="handle-button expand-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-nbx-c106="" class="highlight-div-header-right"><div _ngcontent-nbx-c106="" class="handle-button ai-button"></div><div _ngcontent-nbx-c106="" class="handle-button line-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-nbx-c106="" class="handle-button theme-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-nbx-c106="" class="handle-button copy-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-nbx-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@ObservedV2</span> <span class="hljs-comment">// 错误用法，编译时报错</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>  }</li><li>}</li></ol></pre></div></div> <ul><li>@Trace不能用在没有被@ObservedV2装饰的class上。</li></ul> <div _ngcontent-nbx-c106="" class="highlight-div"><div _ngcontent-nbx-c106="" class="highlight-div-header"><div _ngcontent-nbx-c106="" class="highlight-div-header-left"><div _ngcontent-nbx-c106="" class="handle-button expand-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-nbx-c106="" class="highlight-div-header-right"><div _ngcontent-nbx-c106="" class="handle-button ai-button"></div><div _ngcontent-nbx-c106="" class="handle-button line-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-nbx-c106="" class="handle-button theme-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-nbx-c106="" class="handle-button copy-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-nbx-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span> {</li><li>  <span class="hljs-attr">id</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;</li><li>  <span class="hljs-meta">@Trace</span> <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'Tom'</span>; <span class="hljs-comment">// 错误用法，编译时报错</span></li><li>}</li></ol></pre></div></div> <ul><li>@Trace是class中属性的装饰器，不能用在struct中。</li></ul> <div _ngcontent-nbx-c106="" class="highlight-div"><div _ngcontent-nbx-c106="" class="highlight-div-header"><div _ngcontent-nbx-c106="" class="highlight-div-header-left"><div _ngcontent-nbx-c106="" class="handle-button expand-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-nbx-c106="" class="highlight-div-header-right"><div _ngcontent-nbx-c106="" class="handle-button ai-button"></div><div _ngcontent-nbx-c106="" class="handle-button line-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-nbx-c106="" class="handle-button theme-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-nbx-c106="" class="handle-button copy-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-nbx-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@ComponentV2</span></li><li>struct <span class="hljs-title class_">Comp</span> {</li><li>  <span class="hljs-meta">@Trace</span> <span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'Hello World'</span>; <span class="hljs-comment">// 错误用法，编译时报错</span></li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>  }</li><li>}</li></ol></pre></div></div> <ul><li>@ObservedV2、@Trace不能与<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-observed-and-objectlink">@Observed</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-track">@Track</a>混合使用。</li></ul> <div _ngcontent-nbx-c106="" class="highlight-div"><div _ngcontent-nbx-c106="" class="highlight-div-header"><div _ngcontent-nbx-c106="" class="highlight-div-header-left"><div _ngcontent-nbx-c106="" class="handle-button expand-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-nbx-c106="" class="highlight-div-header-right"><div _ngcontent-nbx-c106="" class="handle-button ai-button"></div><div _ngcontent-nbx-c106="" class="handle-button line-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-nbx-c106="" class="handle-button theme-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-nbx-c106="" class="handle-button copy-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-nbx-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@Observed</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span> {</li><li>  <span class="hljs-meta">@Trace</span> <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'Tom'</span>; <span class="hljs-comment">// 错误用法，编译时报错</span></li><li>}</li><li>
</li><li><span class="hljs-meta">@ObservedV2</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span> {</li><li>  <span class="hljs-meta">@Track</span> <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'Jack'</span>; <span class="hljs-comment">// 错误用法，编译时报错</span></li><li>}</li></ol></pre></div></div> <ul><li>使用@ObservedV2与@Trace装饰的类不能和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-state">@State</a>等V1的装饰器混合使用，编译时报错。</li></ul> <div _ngcontent-nbx-c106="" class="highlight-div"><div _ngcontent-nbx-c106="" class="highlight-div-header"><div _ngcontent-nbx-c106="" class="highlight-div-header-left"><div _ngcontent-nbx-c106="" class="handle-button expand-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-nbx-c106="" class="highlight-div-header-right"><div _ngcontent-nbx-c106="" class="handle-button ai-button"></div><div _ngcontent-nbx-c106="" class="handle-button line-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-nbx-c106="" class="handle-button theme-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-nbx-c106="" class="handle-button copy-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-nbx-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 以@State装饰器为例</span></li><li><span class="hljs-meta">@ObservedV2</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Job</span> {</li><li>  <span class="hljs-meta">@Trace</span> <span class="hljs-attr">jobName</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'Teacher'</span>;</li><li>}</li><li><span class="hljs-meta">@ObservedV2</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Info</span> {</li><li>  <span class="hljs-meta">@Trace</span> <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'Tom'</span>;</li><li>  <span class="hljs-meta">@Trace</span> <span class="hljs-attr">age</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">25</span>;</li><li>  <span class="hljs-attr">job</span>: <span class="hljs-title class_">Job</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Job</span>();</li><li>}</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">info</span>: <span class="hljs-title class_">Info</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Info</span>(); <span class="hljs-comment">// 无法混用，编译时报错</span></li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`name: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.info.name}</span>`</span>)</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`age: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.info.age}</span>`</span>)</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`jobName: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.info.job.jobName}</span>`</span>)</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'change age'</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">info</span>.<span class="hljs-property">age</span>++;</li><li>        })</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'Change job'</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">info</span>.<span class="hljs-property">job</span>.<span class="hljs-property">jobName</span> = <span class="hljs-string">'Doctor'</span>;</li><li>        })</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div> <ul><li>继承自@ObservedV2的类无法和@State等V1的装饰器混用，运行时报错。</li></ul> <div _ngcontent-nbx-c106="" class="highlight-div"><div _ngcontent-nbx-c106="" class="highlight-div-header"><div _ngcontent-nbx-c106="" class="highlight-div-header-left"><div _ngcontent-nbx-c106="" class="handle-button expand-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-nbx-c106="" class="highlight-div-header-right"><div _ngcontent-nbx-c106="" class="handle-button ai-button"></div><div _ngcontent-nbx-c106="" class="handle-button line-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-nbx-c106="" class="handle-button theme-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-nbx-c106="" class="handle-button copy-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-nbx-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 以@State装饰器为例</span></li><li><span class="hljs-meta">@ObservedV2</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Job</span> {</li><li>  <span class="hljs-meta">@Trace</span> <span class="hljs-attr">jobName</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'Teacher'</span>;</li><li>}</li><li><span class="hljs-meta">@ObservedV2</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Info</span> {</li><li>  <span class="hljs-meta">@Trace</span> <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'Tom'</span>;</li><li>  <span class="hljs-meta">@Trace</span> <span class="hljs-attr">age</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">25</span>;</li><li>  <span class="hljs-attr">job</span>: <span class="hljs-title class_">Job</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Job</span>();</li><li>}</li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Message</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Info</span> {</li><li>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) {</li><li>        <span class="hljs-variable language_">super</span>();</li><li>    }</li><li>}</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">message</span>: <span class="hljs-title class_">Message</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Message</span>(); <span class="hljs-comment">// 无法混用，运行时报错</span></li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`name: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.message.name}</span>`</span>)</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`age: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.message.age}</span>`</span>)</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`jobName: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.message.job.jobName}</span>`</span>)</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'change age'</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span>.<span class="hljs-property">age</span>++;</li><li>        })</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'Change job'</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span>.<span class="hljs-property">job</span>.<span class="hljs-property">jobName</span> = <span class="hljs-string">'Doctor'</span>;</li><li>        })</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div> <ul><li>@ObservedV2的类实例目前不支持使用JSON.stringify进行序列化。</li><li>使用@ObservedV2与@Trace装饰器的类，需通过new操作符实例化后，才具备被观测变化的能力。</li></ul> </div>  <div class="tiledSection"><h2 id="使用场景">使用场景<i class="anchor-icon anchor-icon-link" anchorid="使用场景" tips="复制节点链接"></i></h2></div>  <div class="tiledSection"><h3 id="嵌套类场景" class="firsth2">嵌套类场景<i class="anchor-icon anchor-icon-link" anchorid="嵌套类场景" tips="复制节点链接"></i></h3><p>在下面的嵌套类场景中，Pencil类是Son类中最里层的类，Pencil类被@ObservedV2装饰且属性length被@Trace装饰，此时length的变化能够被观测到。</p> <p>@Trace装饰器与现有状态管理框架的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-track">@Track</a>与<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-state">@State</a>装饰器的能力不同，@Track使class具有属性级更新的能力，但并不具备深度观测的能力；而@State只能观测到对象本身以及第一层的变化，对于多层嵌套场景只能通过封装自定义组件，搭配<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-observed-and-objectlink">@Observed</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-observed-and-objectlink">@ObjectLink</a>来实现观测。</p> <ul><li>点击Button('change length')，length是被@Trace装饰的属性，它的变化可以触发关联的UI组件，即UINode (1)的刷新，并输出"id: 1 renderTimes: x"的日志，其中x根据点击次数依次增长。</li><li>自定义组件Page中的son是常规变量，因此点击Button('assign Son')并不会观测到变化。</li><li>当点击Button('assign Son')后，再点击Button('change length')并不会引起UI刷新。因为此时son的地址改变，其关联的UI组件并没有关联到最新的son。</li></ul> <div _ngcontent-nbx-c106="" class="highlight-div"><div _ngcontent-nbx-c106="" class="highlight-div-header"><div _ngcontent-nbx-c106="" class="highlight-div-header-left"><div _ngcontent-nbx-c106="" class="handle-button expand-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-nbx-c106="" class="highlight-div-header-right"><div _ngcontent-nbx-c106="" class="handle-button ai-button"></div><div _ngcontent-nbx-c106="" class="handle-button line-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-nbx-c106="" class="handle-button theme-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-nbx-c106="" class="handle-button copy-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-nbx-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@ObservedV2</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Pencil</span> {</li><li>  <span class="hljs-meta">@Trace</span> <span class="hljs-attr">length</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">21</span>; <span class="hljs-comment">// 当length变化时，会刷新关联的组件</span></li><li>}</li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Bag</span> {</li><li>  <span class="hljs-attr">width</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">50</span>;</li><li>  <span class="hljs-attr">height</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">60</span>;</li><li>  <span class="hljs-attr">pencil</span>: <span class="hljs-title class_">Pencil</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Pencil</span>();</li><li>}</li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Son</span> {</li><li>  <span class="hljs-attr">age</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">5</span>;</li><li>  <span class="hljs-attr">school</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'some'</span>;</li><li>  <span class="hljs-attr">bag</span>: <span class="hljs-title class_">Bag</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Bag</span>();</li><li>}</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@ComponentV2</span></li><li>struct <span class="hljs-title class_">Page</span> {</li><li>  <span class="hljs-attr">son</span>: <span class="hljs-title class_">Son</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Son</span>();</li><li>  <span class="hljs-attr">renderTimes</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;</li><li>  <span class="hljs-title function_">isRender</span>(<span class="hljs-attr">id</span>: <span class="hljs-built_in">number</span>): <span class="hljs-built_in">number</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`id: <span class="hljs-subst">${id}</span> renderTimes: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.renderTimes}</span>`</span>);</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">renderTimes</span>++;</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-number">40</span>;</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">'pencil length'</span>+ <span class="hljs-variable language_">this</span>.<span class="hljs-property">son</span>.<span class="hljs-property">bag</span>.<span class="hljs-property">pencil</span>.<span class="hljs-property">length</span>)</li><li>        .<span class="hljs-title function_">fontSize</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">isRender</span>(<span class="hljs-number">1</span>))   <span class="hljs-comment">// UINode (1)</span></li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'change length'</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-comment">// 点击更改length值，UINode（1）会刷新</span></li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">son</span>.<span class="hljs-property">bag</span>.<span class="hljs-property">pencil</span>.<span class="hljs-property">length</span> += <span class="hljs-number">100</span>;</li><li>        })</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'assign Son'</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-comment">// 由于变量son非状态变量，因此无法刷新UINode（1）</span></li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">son</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Son</span>();</li><li>        })</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div> </div>  <div class="tiledSection"><h3 id="继承类场景">继承类场景<i class="anchor-icon anchor-icon-link" anchorid="继承类场景" tips="复制节点链接"></i></h3><p>@Trace支持在类的继承场景中使用，无论是在基类还是继承类中，只有被@Trace装饰的属性才具有被观测变化的能力。</p> <p>以下例子中，声明class GrandFather、Father、Uncle、Son、Cousin，继承关系如下图。</p> <p><span><img originheight="626" originwidth="677" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114952.17611231108115998669797411412993:50001231000000:2800:8E4B9899CD2B796B68E8F4D130ABFA43FC507318EB1E7CF8F65258283E29557D.png" width="677" height="626"></span></p> <p>创建类Son和类Cousin的实例，点击Button('change Son age')和Button('change Cousin age')可以触发UI的刷新。</p> <div _ngcontent-nbx-c106="" class="highlight-div"><div _ngcontent-nbx-c106="" class="highlight-div-header"><div _ngcontent-nbx-c106="" class="highlight-div-header-left"><div _ngcontent-nbx-c106="" class="handle-button expand-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-nbx-c106="" class="highlight-div-header-right"><div _ngcontent-nbx-c106="" class="handle-button ai-button"></div><div _ngcontent-nbx-c106="" class="handle-button line-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-nbx-c106="" class="handle-button theme-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-nbx-c106="" class="handle-button copy-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-nbx-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@ObservedV2</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">GrandFather</span> {</li><li>  <span class="hljs-meta">@Trace</span> <span class="hljs-attr">age</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;</li><li>
</li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">age: <span class="hljs-built_in">number</span></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;</li><li>  }</li><li>}</li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Father</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">GrandFather</span>{</li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">father: <span class="hljs-built_in">number</span></span>) {</li><li>    <span class="hljs-variable language_">super</span>(father);</li><li>  }</li><li>}</li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Uncle</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">GrandFather</span> {</li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">uncle: <span class="hljs-built_in">number</span></span>) {</li><li>    <span class="hljs-variable language_">super</span>(uncle);</li><li>  }</li><li>}</li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Son</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Father</span> {</li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">son: <span class="hljs-built_in">number</span></span>) {</li><li>    <span class="hljs-variable language_">super</span>(son);</li><li>  }</li><li>}</li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Cousin</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">Uncle</span> {</li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">cousin: <span class="hljs-built_in">number</span></span>) {</li><li>    <span class="hljs-variable language_">super</span>(cousin);</li><li>  }</li><li>}</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@ComponentV2</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-attr">son</span>: <span class="hljs-title class_">Son</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Son</span>(<span class="hljs-number">0</span>);</li><li>  <span class="hljs-attr">cousin</span>: <span class="hljs-title class_">Cousin</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cousin</span>(<span class="hljs-number">0</span>);</li><li>  <span class="hljs-attr">renderTimes</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;</li><li>
</li><li>  <span class="hljs-title function_">isRender</span>(<span class="hljs-attr">id</span>: <span class="hljs-built_in">number</span>): <span class="hljs-built_in">number</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`id: <span class="hljs-subst">${id}</span> renderTimes: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.renderTimes}</span>`</span>);</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">renderTimes</span>++;</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-number">40</span>;</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Row</span>() {</li><li>      <span class="hljs-title class_">Column</span>() {</li><li>        <span class="hljs-title class_">Text</span>(<span class="hljs-string">`Son <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.son.age}</span>`</span>)</li><li>          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">isRender</span>(<span class="hljs-number">1</span>))</li><li>          .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)</li><li>        <span class="hljs-title class_">Text</span>(<span class="hljs-string">`Cousin <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.cousin.age}</span>`</span>)</li><li>          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">isRender</span>(<span class="hljs-number">2</span>))</li><li>          .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">'change Son age'</span>)</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">son</span>.<span class="hljs-property">age</span>++;</li><li>          })</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">'change Cousin age'</span>)</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">cousin</span>.<span class="hljs-property">age</span>++;</li><li>          })</li><li>      }</li><li>      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    }</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div> </div>  <div class="tiledSection"><h3 id="trace装饰基础类型的数组">@Trace装饰基础类型的数组<i class="anchor-icon anchor-icon-link" anchorid="trace装饰基础类型的数组" tips="复制节点链接"></i></h3><p>@Trace装饰数组时，使用支持的API能够观测到变化。支持的API见<a href="/consumer/cn/doc/harmonyos-guides/arkts-new-observedv2-and-trace#观察变化">观察变化</a>。</p> <p>在下面的示例中@ObservedV2装饰的Arr类中的属性numberArr是@Trace装饰的数组，当使用数组API操作numberArr时，可以观测到对应的变化。注意使用数组长度进行判断以防越界访问。</p> <div _ngcontent-nbx-c106="" class="highlight-div"><div _ngcontent-nbx-c106="" class="highlight-div-header"><div _ngcontent-nbx-c106="" class="highlight-div-header-left"><div _ngcontent-nbx-c106="" class="handle-button expand-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-nbx-c106="" class="highlight-div-header-right"><div _ngcontent-nbx-c106="" class="handle-button ai-button"></div><div _ngcontent-nbx-c106="" class="handle-button line-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-nbx-c106="" class="handle-button theme-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-nbx-c106="" class="handle-button copy-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-nbx-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">let</span> <span class="hljs-attr">nextId</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;</li><li>
</li><li><span class="hljs-meta">@ObservedV2</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Arr</span> {</li><li>  <span class="hljs-attr">id</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;</li><li>  <span class="hljs-meta">@Trace</span> <span class="hljs-attr">numberArr</span>: <span class="hljs-built_in">number</span>[] = [];</li><li>
</li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">id</span> = nextId++;</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">numberArr</span> = [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>];</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@ComponentV2</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-attr">arr</span>: <span class="hljs-title class_">Arr</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Arr</span>();</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`length: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.arr.numberArr.length}</span>`</span>)</li><li>        .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">40</span>)</li><li>      <span class="hljs-title class_">Divider</span>()</li><li>      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">arr</span>.<span class="hljs-property">numberArr</span>.<span class="hljs-property">length</span> &gt;= <span class="hljs-number">3</span>) {</li><li>        <span class="hljs-title class_">Text</span>(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.arr.numberArr[<span class="hljs-number">0</span>]}</span>`</span>)</li><li>          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">40</span>)</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">arr</span>.<span class="hljs-property">numberArr</span>[<span class="hljs-number">0</span>]++;</li><li>          })</li><li>        <span class="hljs-title class_">Text</span>(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.arr.numberArr[<span class="hljs-number">1</span>]}</span>`</span>)</li><li>          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">40</span>)</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">arr</span>.<span class="hljs-property">numberArr</span>[<span class="hljs-number">1</span>]++;</li><li>          })</li><li>        <span class="hljs-title class_">Text</span>(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.arr.numberArr[<span class="hljs-number">2</span>]}</span>`</span>)</li><li>          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">40</span>)</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">arr</span>.<span class="hljs-property">numberArr</span>[<span class="hljs-number">2</span>]++;</li><li>          })</li><li>      }</li><li>
</li><li>      <span class="hljs-title class_">Divider</span>()</li><li>
</li><li>      <span class="hljs-title class_">ForEach</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">arr</span>.<span class="hljs-property">numberArr</span>, <span class="hljs-function">(<span class="hljs-params">item: <span class="hljs-built_in">number</span>, index: <span class="hljs-built_in">number</span></span>) =&gt;</span> {</li><li>        <span class="hljs-title class_">Text</span>(<span class="hljs-string">`<span class="hljs-subst">${index}</span> <span class="hljs-subst">${item}</span>`</span>)</li><li>          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">40</span>)</li><li>      })</li><li>
</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'push'</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">arr</span>.<span class="hljs-property">numberArr</span>.<span class="hljs-title function_">push</span>(<span class="hljs-number">50</span>);</li><li>        })</li><li>
</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'pop'</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">arr</span>.<span class="hljs-property">numberArr</span>.<span class="hljs-title function_">pop</span>();</li><li>        })</li><li>
</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'shift'</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">arr</span>.<span class="hljs-property">numberArr</span>.<span class="hljs-title function_">shift</span>();</li><li>        })</li><li>
</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'splice'</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">arr</span>.<span class="hljs-property">numberArr</span>.<span class="hljs-title function_">splice</span>(<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">60</span>);</li><li>        })</li><li>
</li><li>
</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'unshift'</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">arr</span>.<span class="hljs-property">numberArr</span>.<span class="hljs-title function_">unshift</span>(<span class="hljs-number">100</span>);</li><li>        })</li><li>
</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'copywithin'</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">arr</span>.<span class="hljs-property">numberArr</span>.<span class="hljs-title function_">copyWithin</span>(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>);</li><li>        })</li><li>
</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'fill'</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">arr</span>.<span class="hljs-property">numberArr</span>.<span class="hljs-title function_">fill</span>(<span class="hljs-number">0</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>);</li><li>        })</li><li>
</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'reverse'</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">arr</span>.<span class="hljs-property">numberArr</span>.<span class="hljs-title function_">reverse</span>();</li><li>        })</li><li>
</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'sort'</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">arr</span>.<span class="hljs-property">numberArr</span>.<span class="hljs-title function_">sort</span>();</li><li>        })</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div> </div>  <div class="tiledSection"><h3 id="trace装饰对象数组">@Trace装饰对象数组<i class="anchor-icon anchor-icon-link" anchorid="trace装饰对象数组" tips="复制节点链接"></i></h3><ul><li>@Trace装饰对象数组personList以及Person类中的age属性，因此当personList、age改变时均可以观测到变化。</li><li>点击Text组件更改age时，Text组件会刷新。</li></ul> <div _ngcontent-nbx-c106="" class="highlight-div"><div _ngcontent-nbx-c106="" class="highlight-div-header"><div _ngcontent-nbx-c106="" class="highlight-div-header-left"><div _ngcontent-nbx-c106="" class="handle-button expand-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-nbx-c106="" class="highlight-div-header-right"><div _ngcontent-nbx-c106="" class="handle-button ai-button"></div><div _ngcontent-nbx-c106="" class="handle-button line-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-nbx-c106="" class="handle-button theme-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-nbx-c106="" class="handle-button copy-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-nbx-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">let</span> <span class="hljs-attr">nextId</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;</li><li>
</li><li><span class="hljs-meta">@ObservedV2</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span> {</li><li>  <span class="hljs-meta">@Trace</span> <span class="hljs-attr">age</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;</li><li>
</li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">age: <span class="hljs-built_in">number</span></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-meta">@ObservedV2</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Info</span> {</li><li>  <span class="hljs-attr">id</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;</li><li>  <span class="hljs-meta">@Trace</span> <span class="hljs-attr">personList</span>: <span class="hljs-title class_">Person</span>[] = [];</li><li>
</li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">id</span> = nextId++;</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">personList</span> = [<span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-number">0</span>), <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-number">1</span>), <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-number">2</span>)];</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@ComponentV2</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-attr">info</span>: <span class="hljs-title class_">Info</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Info</span>();</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`length: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.info.personList.length}</span>`</span>)</li><li>        .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">40</span>)</li><li>      <span class="hljs-title class_">Divider</span>()</li><li>      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">info</span>.<span class="hljs-property">personList</span>.<span class="hljs-property">length</span> &gt;= <span class="hljs-number">3</span>) {</li><li>        <span class="hljs-title class_">Text</span>(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.info.personList[<span class="hljs-number">0</span>].age}</span>`</span>)</li><li>          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">40</span>)</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">info</span>.<span class="hljs-property">personList</span>[<span class="hljs-number">0</span>].<span class="hljs-property">age</span>++;</li><li>          })</li><li>
</li><li>        <span class="hljs-title class_">Text</span>(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.info.personList[<span class="hljs-number">1</span>].age}</span>`</span>)</li><li>          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">40</span>)</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">info</span>.<span class="hljs-property">personList</span>[<span class="hljs-number">1</span>].<span class="hljs-property">age</span>++;</li><li>          })</li><li>
</li><li>        <span class="hljs-title class_">Text</span>(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.info.personList[<span class="hljs-number">2</span>].age}</span>`</span>)</li><li>          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">40</span>)</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">info</span>.<span class="hljs-property">personList</span>[<span class="hljs-number">2</span>].<span class="hljs-property">age</span>++;</li><li>          })</li><li>      }</li><li>
</li><li>      <span class="hljs-title class_">Divider</span>()</li><li>
</li><li>      <span class="hljs-title class_">ForEach</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">info</span>.<span class="hljs-property">personList</span>, <span class="hljs-function">(<span class="hljs-params">item: Person, index: <span class="hljs-built_in">number</span></span>) =&gt;</span> {</li><li>        <span class="hljs-title class_">Text</span>(<span class="hljs-string">`<span class="hljs-subst">${index}</span> <span class="hljs-subst">${item.age}</span>`</span>)</li><li>          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">40</span>)</li><li>      })</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div> </div>  <div class="tiledSection"><h3 id="trace装饰map类型">@Trace装饰Map类型<i class="anchor-icon anchor-icon-link" anchorid="trace装饰map类型" tips="复制节点链接"></i></h3><ul><li>被@Trace装饰的Map类型属性可以观测到调用API带来的变化，包括 set、clear、delete。</li><li>因为Info类被@ObservedV2装饰且属性memberMap被@Trace装饰，点击Button('init map')对memberMap赋值也可以观测到变化。</li></ul> <div _ngcontent-nbx-c106="" class="highlight-div"><div _ngcontent-nbx-c106="" class="highlight-div-header"><div _ngcontent-nbx-c106="" class="highlight-div-header-left"><div _ngcontent-nbx-c106="" class="handle-button expand-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-nbx-c106="" class="highlight-div-header-right"><div _ngcontent-nbx-c106="" class="handle-button ai-button"></div><div _ngcontent-nbx-c106="" class="handle-button line-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-nbx-c106="" class="handle-button theme-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-nbx-c106="" class="handle-button copy-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-nbx-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@ObservedV2</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Info</span> {</li><li>  <span class="hljs-meta">@Trace</span> <span class="hljs-attr">memberMap</span>: <span class="hljs-title class_">Map</span>&lt;<span class="hljs-built_in">number</span>, <span class="hljs-built_in">string</span>&gt; = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>([[<span class="hljs-number">0</span>, <span class="hljs-string">'a'</span>], [<span class="hljs-number">1</span>, <span class="hljs-string">'b'</span>], [<span class="hljs-number">3</span>, <span class="hljs-string">'c'</span>]]);</li><li>}</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@ComponentV2</span></li><li>struct <span class="hljs-title class_">MapSample</span> {</li><li>  <span class="hljs-attr">info</span>: <span class="hljs-title class_">Info</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Info</span>();</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Row</span>() {</li><li>      <span class="hljs-title class_">Column</span>() {</li><li>        <span class="hljs-title class_">ForEach</span>(<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">info</span>.<span class="hljs-property">memberMap</span>.<span class="hljs-title function_">entries</span>()), <span class="hljs-function">(<span class="hljs-params">item: [<span class="hljs-built_in">number</span>, <span class="hljs-built_in">string</span>]</span>) =&gt;</span> {</li><li>          <span class="hljs-title class_">Text</span>(<span class="hljs-string">`<span class="hljs-subst">${item[<span class="hljs-number">0</span>]}</span>`</span>)</li><li>            .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">30</span>)</li><li>          <span class="hljs-title class_">Text</span>(<span class="hljs-string">`<span class="hljs-subst">${item[<span class="hljs-number">1</span>]}</span>`</span>)</li><li>            .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">30</span>)</li><li>          <span class="hljs-title class_">Divider</span>()</li><li>        })</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">'init map'</span>)</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">info</span>.<span class="hljs-property">memberMap</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>([[<span class="hljs-number">0</span>, <span class="hljs-string">'a'</span>], [<span class="hljs-number">1</span>, <span class="hljs-string">'b'</span>], [<span class="hljs-number">3</span>, <span class="hljs-string">'c'</span>]]);</li><li>          })</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">'set new one'</span>)</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">info</span>.<span class="hljs-property">memberMap</span>.<span class="hljs-title function_">set</span>(<span class="hljs-number">4</span>, <span class="hljs-string">'d'</span>);</li><li>          })</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">'clear'</span>)</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">info</span>.<span class="hljs-property">memberMap</span>.<span class="hljs-title function_">clear</span>();</li><li>          })</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">'set the key: 0'</span>)</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">info</span>.<span class="hljs-property">memberMap</span>.<span class="hljs-title function_">set</span>(<span class="hljs-number">0</span>, <span class="hljs-string">'aa'</span>);</li><li>          })</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">'delete the first one'</span>)</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">info</span>.<span class="hljs-property">memberMap</span>.<span class="hljs-title function_">delete</span>(<span class="hljs-number">0</span>);</li><li>          })</li><li>      }</li><li>      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    }</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div> </div>  <div class="tiledSection"><h3 id="trace装饰set类型">@Trace装饰Set类型<i class="anchor-icon anchor-icon-link" anchorid="trace装饰set类型" tips="复制节点链接"></i></h3><ul><li>被@Trace装饰的Set类型属性可以观测到调用API带来的变化，包括 add、clear和delete。</li><li>因为Info类被@ObservedV2装饰且属性memberSet被@Trace装饰，点击Button('init set')对memberSet赋值也可以观测到变化。</li></ul> <div _ngcontent-nbx-c106="" class="highlight-div"><div _ngcontent-nbx-c106="" class="highlight-div-header"><div _ngcontent-nbx-c106="" class="highlight-div-header-left"><div _ngcontent-nbx-c106="" class="handle-button expand-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-nbx-c106="" class="highlight-div-header-right"><div _ngcontent-nbx-c106="" class="handle-button ai-button"></div><div _ngcontent-nbx-c106="" class="handle-button line-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-nbx-c106="" class="handle-button theme-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-nbx-c106="" class="handle-button copy-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-nbx-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@ObservedV2</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Info</span> {</li><li>  <span class="hljs-meta">@Trace</span> <span class="hljs-attr">memberSet</span>: <span class="hljs-title class_">Set</span>&lt;<span class="hljs-built_in">number</span>&gt; = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>([<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>]);</li><li>}</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@ComponentV2</span></li><li>struct <span class="hljs-title class_">SetSample</span> {</li><li>  <span class="hljs-attr">info</span>: <span class="hljs-title class_">Info</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Info</span>();</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Row</span>() {</li><li>      <span class="hljs-title class_">Column</span>() {</li><li>        <span class="hljs-title class_">ForEach</span>(<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">info</span>.<span class="hljs-property">memberSet</span>.<span class="hljs-title function_">entries</span>()), <span class="hljs-function">(<span class="hljs-params">item: [<span class="hljs-built_in">number</span>, <span class="hljs-built_in">number</span>]</span>) =&gt;</span> {</li><li>          <span class="hljs-title class_">Text</span>(<span class="hljs-string">`<span class="hljs-subst">${item[<span class="hljs-number">0</span>]}</span>`</span>)</li><li>            .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">30</span>)</li><li>          <span class="hljs-title class_">Divider</span>()</li><li>        })</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">'init set'</span>)</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">info</span>.<span class="hljs-property">memberSet</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>([<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>]);</li><li>          })</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">'set new one'</span>)</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">info</span>.<span class="hljs-property">memberSet</span>.<span class="hljs-title function_">add</span>(<span class="hljs-number">5</span>);</li><li>          })</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">'clear'</span>)</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">info</span>.<span class="hljs-property">memberSet</span>.<span class="hljs-title function_">clear</span>();</li><li>          })</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">'delete the first one'</span>)</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">info</span>.<span class="hljs-property">memberSet</span>.<span class="hljs-title function_">delete</span>(<span class="hljs-number">0</span>);</li><li>          })</li><li>      }</li><li>      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    }</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div> </div>  <div class="tiledSection"><h3 id="trace装饰date类型">@Trace装饰Date类型<i class="anchor-icon anchor-icon-link" anchorid="trace装饰date类型" tips="复制节点链接"></i></h3><ul><li>@Trace装饰的Date类型属性可以观测调用API带来的变化，包括 setFullYear、setMonth、setDate、setHours、setMinutes、setSeconds、setMilliseconds、setTime、setUTCFullYear、setUTCMonth、setUTCDate、setUTCHours、setUTCMinutes、setUTCSeconds、setUTCMilliseconds。</li><li>因为Info类被@ObservedV2装饰且属性selectedDate被@Trace装饰，点击Button('set selectedDate to 2023-07-08')对selectedDate赋值也可以观测到变化。</li></ul> <div _ngcontent-nbx-c106="" class="highlight-div"><div _ngcontent-nbx-c106="" class="highlight-div-header"><div _ngcontent-nbx-c106="" class="highlight-div-header-left"><div _ngcontent-nbx-c106="" class="handle-button expand-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-nbx-c106="" class="highlight-div-header-right"><div _ngcontent-nbx-c106="" class="handle-button ai-button"></div><div _ngcontent-nbx-c106="" class="handle-button line-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-nbx-c106="" class="handle-button theme-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-nbx-c106="" class="handle-button copy-button"><div _ngcontent-nbx-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-nbx-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@ObservedV2</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Info</span> {</li><li>  <span class="hljs-meta">@Trace</span> <span class="hljs-attr">selectedDate</span>: <span class="hljs-title class_">Date</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-string">'2021-08-08'</span>);</li><li>}</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@ComponentV2</span></li><li>struct <span class="hljs-title class_">DateSample</span> {</li><li>  <span class="hljs-attr">info</span>: <span class="hljs-title class_">Info</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Info</span>();</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'set selectedDate to 2023-07-08'</span>)</li><li>        .<span class="hljs-title function_">margin</span>(<span class="hljs-number">10</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">info</span>.<span class="hljs-property">selectedDate</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-string">'2023-07-08'</span>);</li><li>        })</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'increase the year by 1'</span>)</li><li>        .<span class="hljs-title function_">margin</span>(<span class="hljs-number">10</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">info</span>.<span class="hljs-property">selectedDate</span>.<span class="hljs-title function_">setFullYear</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">info</span>.<span class="hljs-property">selectedDate</span>.<span class="hljs-title function_">getFullYear</span>() + <span class="hljs-number">1</span>);</li><li>        })</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'increase the month by 1'</span>)</li><li>        .<span class="hljs-title function_">margin</span>(<span class="hljs-number">10</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">info</span>.<span class="hljs-property">selectedDate</span>.<span class="hljs-title function_">setMonth</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">info</span>.<span class="hljs-property">selectedDate</span>.<span class="hljs-title function_">getMonth</span>() + <span class="hljs-number">1</span>);</li><li>        })</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'increase the day by 1'</span>)</li><li>        .<span class="hljs-title function_">margin</span>(<span class="hljs-number">10</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">info</span>.<span class="hljs-property">selectedDate</span>.<span class="hljs-title function_">setDate</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">info</span>.<span class="hljs-property">selectedDate</span>.<span class="hljs-title function_">getDate</span>() + <span class="hljs-number">1</span>);</li><li>        })</li><li>      <span class="hljs-title class_">DatePicker</span>({</li><li>        <span class="hljs-attr">start</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-string">'1970-1-1'</span>),</li><li>        <span class="hljs-attr">end</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-string">'2100-1-1'</span>),</li><li>        <span class="hljs-attr">selected</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">info</span>.<span class="hljs-property">selectedDate</span></li><li>      })</li><li>    }.<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div> </div> </div> <div></div></div>