<h1 _ngcontent-ssu-c119="" class="doc-title ng-star-inserted" title="@Param：组件外部输入"> @Param：组件外部输入 </h1>

<div _ngcontent-ssu-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div><p>为了增强子组件接受外部参数输入的能力，开发者可以使用@Param装饰器。</p> <p>@Param不仅可以接受组件外部输入，还可以接受@Local的同步变化。在阅读本文档前，建议提前阅读：<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-new-local">@Local</a>。</p> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"> <p>从API version 12开始，在@ComponentV2装饰的自定义组件中支持使用@Param装饰器。</p>  <p>从API version 12开始，该装饰器支持在元服务中使用。</p>  </div></div></div>  <div class="tiledSection"><h2 id="概述">概述<i class="anchor-icon anchor-icon-link" anchorid="概述" tips="复制节点链接"></i></h2><p>@Param表示组件从外部传入的状态，使得父子组件之间的数据能够进行同步：</p> <ul><li><p>@Param装饰的变量支持本地初始化，但不允许在组件内部直接修改。</p>  </li><li><p>被@Param装饰的变量能够在初始化自定义组件时从外部传入，当数据源也是状态变量时，数据源的修改会同步给@Param。</p>  </li><li><p>@Param可以接受任意类型的数据源，包括普通变量、状态变量、常量、函数返回值等。</p>  </li><li><p>@Param装饰的变量变化时，会刷新该变量关联的组件。</p>  </li><li><p>@Param支持对基本类型（如number、boolean、string、Object、class）、内嵌类型（如<a href="/consumer/cn/doc/harmonyos-guides/arkts-new-param#装饰array类型变量">Array</a>、<a href="/consumer/cn/doc/harmonyos-guides/arkts-new-param#装饰set类型变量">Set</a>、<a href="/consumer/cn/doc/harmonyos-guides/arkts-new-param#装饰map类型变量">Map</a>、<a href="/consumer/cn/doc/harmonyos-guides/arkts-new-param#装饰date类型变量">Date</a>），以及null、undefined和<a href="/consumer/cn/doc/harmonyos-guides/arkts-new-param#联合类型">联合类型</a>进行观测。</p>  </li><li><p>对于复杂类型如类对象，@Param会接受数据源的引用。在组件内可以修改类对象中的属性，该修改会同步到数据源。</p>  </li><li><p>@Param的观测能力仅限于被装饰的变量本身。详见<a href="/consumer/cn/doc/harmonyos-guides/arkts-new-param#观察变化">观察变化</a>。</p>  </li></ul> </div>  <div class="tiledSection"><h2 id="状态管理v1版本接受外部传入的装饰器的局限性">状态管理V1版本接受外部传入的装饰器的局限性<i class="anchor-icon anchor-icon-link" anchorid="状态管理v1版本接受外部传入的装饰器的局限性" tips="复制节点链接"></i></h2><p>状态管理V1存在多种可接受外部传入的装饰器，常用的有<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-state">@State</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-prop">@Prop</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-link">@Link</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-observed-and-objectlink">@ObjectLink</a>。这些装饰器使用有限制且不易区分，不当使用会导致性能问题。</p> <div _ngcontent-ssu-c106="" class="highlight-div"><div _ngcontent-ssu-c106="" class="highlight-div-header"><div _ngcontent-ssu-c106="" class="highlight-div-header-left"><div _ngcontent-ssu-c106="" class="handle-button expand-button"><div _ngcontent-ssu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ssu-c106="" class="highlight-div-header-right"><div _ngcontent-ssu-c106="" class="handle-button ai-button"></div><div _ngcontent-ssu-c106="" class="handle-button line-button"><div _ngcontent-ssu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ssu-c106="" class="handle-button theme-button"><div _ngcontent-ssu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ssu-c106="" class="handle-button copy-button"><div _ngcontent-ssu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ssu-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@Observed</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Region</span> {</li><li>  <span class="hljs-attr">x</span>: <span class="hljs-built_in">number</span>;</li><li>  <span class="hljs-attr">y</span>: <span class="hljs-built_in">number</span>;</li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">x: <span class="hljs-built_in">number</span>, y: <span class="hljs-built_in">number</span></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">x</span> = x;</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">y</span> = y;</li><li>  }</li><li>}</li><li><span class="hljs-meta">@Observed</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Info</span> {</li><li>  <span class="hljs-attr">region</span>: <span class="hljs-title class_">Region</span>;</li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">x: <span class="hljs-built_in">number</span>, y: <span class="hljs-built_in">number</span></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">region</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Region</span>(x, y);</li><li>  }</li><li>}</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">info</span>: <span class="hljs-title class_">Info</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Info</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>);</li><li>  </li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'change Info'</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">info</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Info</span>(<span class="hljs-number">100</span>, <span class="hljs-number">100</span>);</li><li>      })</li><li>      <span class="hljs-title class_">Child</span>({</li><li>        <span class="hljs-attr">region</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">info</span>.<span class="hljs-property">region</span>,</li><li>        <span class="hljs-attr">regionProp</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">info</span>.<span class="hljs-property">region</span>,</li><li>        <span class="hljs-attr">infoProp</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">info</span>,</li><li>        <span class="hljs-attr">infoLink</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">info</span>,</li><li>        <span class="hljs-attr">infoState</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">info</span></li><li>      })</li><li>    }</li><li>  }</li><li>}</li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Child</span> {</li><li>  <span class="hljs-meta">@ObjectLink</span> <span class="hljs-attr">region</span>: <span class="hljs-title class_">Region</span>;</li><li>  <span class="hljs-meta">@Prop</span> <span class="hljs-attr">regionProp</span>: <span class="hljs-title class_">Region</span>;</li><li>  <span class="hljs-meta">@Prop</span> <span class="hljs-attr">infoProp</span>: <span class="hljs-title class_">Info</span>;</li><li>  <span class="hljs-meta">@Link</span> <span class="hljs-attr">infoLink</span>: <span class="hljs-title class_">Info</span>;</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">infoState</span>: <span class="hljs-title class_">Info</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Info</span>(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>);</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`ObjectLink region: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.region.x}</span>-<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.region.y}</span>`</span>)</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`Prop regionProp: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.regionProp.x}</span>-<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.regionProp.y}</span>`</span>)</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div> <p>在上面的示例中，@State仅能在初始化时接收info的引用，改变info之后无法同步。@Prop虽然能够进行单向同步，但是对于较复杂的类型来说，深拷贝性能较差。@Link能够接受传入的引用进行双向同步，但它必须要求数据源也是状态变量，因此无法接受info中的成员属性region。@ObjectLink能够接受类成员属性，但是要求该属性类型必须为@Observed装饰的类。装饰器的不同限制使得父子组件之间的传值规则复杂、不易使用。因此推出@Param装饰器，表示组件从外部传入的状态。</p> </div>  <div class="tiledSection"><h2 id="装饰器说明">装饰器说明<i class="anchor-icon anchor-icon-link" anchorid="装饰器说明" tips="复制节点链接"></i></h2> <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.6.2.1.3.1.1" valign="top" width="50%">@Param变量装饰器</th> <th align="left" class="cellrowborder" id="mcps1.3.6.2.1.3.1.2" valign="top" width="50%">说明</th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="50%">装饰器参数</td> <td class="cellrowborder" valign="top" width="50%">无。</td> </tr> <tr><td class="cellrowborder" valign="top" width="50%">能否本地修改</td> <td class="cellrowborder" valign="top" width="50%">否。若需要修改值，可使用@Param搭配<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-new-once">@Once</a>修改子组件的本地值。或通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-new-event">@Event</a>装饰器，修改@Param数据源的值。</td> </tr> <tr><td class="cellrowborder" valign="top" width="50%">同步类型</td> <td class="cellrowborder" valign="top" width="50%">由父到子单向同步。</td> </tr> <tr><td class="cellrowborder" valign="top" width="50%">允许装饰的变量类型</td> <td class="cellrowborder" valign="top" width="50%">Object、class、string、number、boolean、enum等基本类型以及Array、Date、Map、Set等内嵌类型。支持null、undefined以及联合类型。</td> </tr> <tr><td class="cellrowborder" valign="top" width="50%">被装饰变量的初始值</td> <td class="cellrowborder" valign="top" width="50%">允许本地初始化，若不在本地初始化，则需要和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-require">@Require</a>装饰器一起使用，要求必须从外部传入初始化。</td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h2 id="变量传递">变量传递<i class="anchor-icon anchor-icon-link" anchorid="变量传递" tips="复制节点链接"></i></h2> <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.7.2.1.3.1.1" valign="top" width="50%">传递规则</th> <th align="left" class="cellrowborder" id="mcps1.3.7.2.1.3.1.2" valign="top" width="50%">说明</th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="50%">从父组件初始化</td> <td class="cellrowborder" valign="top" width="50%">@Param装饰的变量允许本地初始化，若无本地初始化则必须从外部传入初始化。当同时存在本地初始值与外部传入值时，优先使用外部传入值进行初始化。</td> </tr> <tr><td class="cellrowborder" valign="top" width="50%">初始化子组件</td> <td class="cellrowborder" valign="top" width="50%">@Param装饰的变量可以初始化子组件中@Param装饰的变量。</td> </tr> <tr><td class="cellrowborder" valign="top" width="50%">同步</td> <td class="cellrowborder" valign="top" width="50%">@Param可以和父组件传入的状态变量数据源（即@Local或@Param装饰的变量）进行同步，当数据源发生变化时，会将修改同步给子组件的@Param。</td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h2 id="观察变化">观察变化<i class="anchor-icon anchor-icon-link" anchorid="观察变化" tips="复制节点链接"></i></h2><p>使用@Param装饰的变量具有被观测变化的能力。当装饰的变量发生变化时，会触发该变量绑定的UI组件刷新。</p> <ul><li><p>当装饰的变量类型为boolean、string、number类型时，可观察数据源同步变化。</p>  <div _ngcontent-ssu-c106="" class="highlight-div"><div _ngcontent-ssu-c106="" class="highlight-div-header"><div _ngcontent-ssu-c106="" class="highlight-div-header-left"><div _ngcontent-ssu-c106="" class="handle-button expand-button"><div _ngcontent-ssu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ssu-c106="" class="highlight-div-header-right"><div _ngcontent-ssu-c106="" class="handle-button ai-button"></div><div _ngcontent-ssu-c106="" class="handle-button line-button"><div _ngcontent-ssu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ssu-c106="" class="handle-button theme-button"><div _ngcontent-ssu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ssu-c106="" class="handle-button copy-button"><div _ngcontent-ssu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ssu-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@ComponentV2</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-meta">@Local</span> <span class="hljs-attr">count</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;</li><li>  <span class="hljs-meta">@Local</span> <span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'Hello'</span>;</li><li>  <span class="hljs-meta">@Local</span> <span class="hljs-attr">flag</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">false</span>;</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`Local <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.count}</span>`</span>)</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`Local <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.message}</span>`</span>)</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`Local <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.flag}</span>`</span>)</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'change Local'</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">()=&gt;</span>{</li><li>          <span class="hljs-comment">// 对数据源的更改会同步给子组件</span></li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>++;</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span> += <span class="hljs-string">' World'</span>;</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">flag</span> = !<span class="hljs-variable language_">this</span>.<span class="hljs-property">flag</span>;</li><li>      })</li><li>      <span class="hljs-title class_">Child</span>({</li><li>        <span class="hljs-attr">count</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>,</li><li>        <span class="hljs-attr">message</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span>,</li><li>        <span class="hljs-attr">flag</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">flag</span></li><li>      })</li><li>    }</li><li>  }</li><li>}</li><li><span class="hljs-meta">@ComponentV2</span></li><li>struct <span class="hljs-title class_">Child</span> {</li><li>  <span class="hljs-meta">@Require</span> <span class="hljs-meta">@Param</span> <span class="hljs-attr">count</span>: <span class="hljs-built_in">number</span>;</li><li>  <span class="hljs-meta">@Require</span> <span class="hljs-meta">@Param</span> <span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span>;</li><li>  <span class="hljs-meta">@Require</span> <span class="hljs-meta">@Param</span> <span class="hljs-attr">flag</span>: <span class="hljs-built_in">boolean</span>;</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`Param <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.count}</span>`</span>)</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`Param <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.message}</span>`</span>)</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`Param <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.flag}</span>`</span>)</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>  </li><li><p>当装饰的变量类型为类对象时，仅可以观察到对类对象整体赋值的变化，无法直接观察到对类成员属性赋值的变化，对类成员属性的观察依赖<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-new-observedv2-and-trace">@ObservedV2</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-new-observedv2-and-trace">@Trace</a>装饰器。</p>  <div _ngcontent-ssu-c106="" class="highlight-div"><div _ngcontent-ssu-c106="" class="highlight-div-header"><div _ngcontent-ssu-c106="" class="highlight-div-header-left"><div _ngcontent-ssu-c106="" class="handle-button expand-button"><div _ngcontent-ssu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ssu-c106="" class="highlight-div-header-right"><div _ngcontent-ssu-c106="" class="handle-button ai-button"></div><div _ngcontent-ssu-c106="" class="handle-button line-button"><div _ngcontent-ssu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ssu-c106="" class="handle-button theme-button"><div _ngcontent-ssu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ssu-c106="" class="handle-button copy-button"><div _ngcontent-ssu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ssu-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">RawObject</span> {</li><li>  <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;</li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name: <span class="hljs-built_in">string</span></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;</li><li>  }</li><li>}</li><li><span class="hljs-meta">@ObservedV2</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">ObservedObject</span> {</li><li>  <span class="hljs-meta">@Trace</span> <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;</li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name: <span class="hljs-built_in">string</span></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;</li><li>  }</li><li>}</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@ComponentV2</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-meta">@Local</span> <span class="hljs-attr">rawObject</span>: <span class="hljs-title class_">RawObject</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">RawObject</span>(<span class="hljs-string">'rawObject'</span>);</li><li>  <span class="hljs-meta">@Local</span> <span class="hljs-attr">observedObject</span>: <span class="hljs-title class_">ObservedObject</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObservedObject</span>(<span class="hljs-string">'observedObject'</span>);</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.rawObject.name}</span>`</span>)</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.observedObject.name}</span>`</span>)</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'change object'</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-comment">// 对类对象整体的修改均能观察到</span></li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">rawObject</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">RawObject</span>(<span class="hljs-string">'new rawObject'</span>);</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">observedObject</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObservedObject</span>(<span class="hljs-string">'new observedObject'</span>);</li><li>      })</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'change name'</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-comment">// @Local与@Param均不具备观察类对象属性的能力，因此对rawObject.name的修改无法观察到</span></li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">rawObject</span>.<span class="hljs-property">name</span> = <span class="hljs-string">'new rawObject name'</span>;</li><li>          <span class="hljs-comment">// 由于ObservedObject的name属性被@Trace装饰，因此对observedObject.name的修改能被观察到</span></li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">observedObject</span>.<span class="hljs-property">name</span> = <span class="hljs-string">'new observedObject name'</span>;</li><li>      })</li><li>      <span class="hljs-title class_">Child</span>({</li><li>        <span class="hljs-attr">rawObject</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">rawObject</span>,</li><li>        <span class="hljs-attr">observedObject</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">observedObject</span></li><li>      })</li><li>    }</li><li>  }</li><li>}</li><li><span class="hljs-meta">@ComponentV2</span></li><li>struct <span class="hljs-title class_">Child</span> {</li><li>  <span class="hljs-meta">@Require</span> <span class="hljs-meta">@Param</span> <span class="hljs-attr">rawObject</span>: <span class="hljs-title class_">RawObject</span>;</li><li>  <span class="hljs-meta">@Require</span> <span class="hljs-meta">@Param</span> <span class="hljs-attr">observedObject</span>: <span class="hljs-title class_">ObservedObject</span>;</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.rawObject.name}</span>`</span>)</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.observedObject.name}</span>`</span>)</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>  </li><li><p>装饰的变量为简单类型数组时，可观察数组整体或数组项变化。</p>  <div _ngcontent-ssu-c106="" class="highlight-div"><div _ngcontent-ssu-c106="" class="highlight-div-header"><div _ngcontent-ssu-c106="" class="highlight-div-header-left"><div _ngcontent-ssu-c106="" class="handle-button expand-button"><div _ngcontent-ssu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ssu-c106="" class="highlight-div-header-right"><div _ngcontent-ssu-c106="" class="handle-button ai-button"></div><div _ngcontent-ssu-c106="" class="handle-button line-button"><div _ngcontent-ssu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ssu-c106="" class="handle-button theme-button"><div _ngcontent-ssu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ssu-c106="" class="handle-button copy-button"><div _ngcontent-ssu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ssu-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@ComponentV2</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-meta">@Local</span> <span class="hljs-attr">numArr</span>: <span class="hljs-built_in">number</span>[] = [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>];</li><li>  <span class="hljs-meta">@Local</span> <span class="hljs-attr">dimensionTwo</span>: <span class="hljs-built_in">number</span>[][] = [[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>],[<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>]];</li><li>  </li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.numArr[<span class="hljs-number">0</span>]}</span>`</span>)</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.numArr[<span class="hljs-number">1</span>]}</span>`</span>)</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.numArr[<span class="hljs-number">2</span>]}</span>`</span>)</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.dimensionTwo[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]}</span>`</span>)</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.dimensionTwo[<span class="hljs-number">1</span>][<span class="hljs-number">1</span>]}</span>`</span>)</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'change array item'</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">numArr</span>[<span class="hljs-number">0</span>]++;</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">numArr</span>[<span class="hljs-number">1</span>] += <span class="hljs-number">2</span>;</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">dimensionTwo</span>[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>;</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">dimensionTwo</span>[<span class="hljs-number">1</span>][<span class="hljs-number">1</span>] = <span class="hljs-number">0</span>;</li><li>        })</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'change whole array'</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">numArr</span> = [<span class="hljs-number">5</span>,<span class="hljs-number">4</span>,<span class="hljs-number">3</span>,<span class="hljs-number">2</span>,<span class="hljs-number">1</span>];</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">dimensionTwo</span> = [[<span class="hljs-number">7</span>,<span class="hljs-number">8</span>,<span class="hljs-number">9</span>],[<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>]];</li><li>        })</li><li>      <span class="hljs-title class_">Child</span>({</li><li>        <span class="hljs-attr">numArr</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">numArr</span>,</li><li>        <span class="hljs-attr">dimensionTwo</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">dimensionTwo</span></li><li>      })</li><li>    }</li><li>  }</li><li>}</li><li><span class="hljs-meta">@ComponentV2</span></li><li>struct <span class="hljs-title class_">Child</span> {</li><li>  <span class="hljs-meta">@Require</span> <span class="hljs-meta">@Param</span> <span class="hljs-attr">numArr</span>: <span class="hljs-built_in">number</span>[];</li><li>  <span class="hljs-meta">@Require</span> <span class="hljs-meta">@Param</span> <span class="hljs-attr">dimensionTwo</span>: <span class="hljs-built_in">number</span>[][];</li><li>  </li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.numArr[<span class="hljs-number">0</span>]}</span>`</span>)</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.numArr[<span class="hljs-number">1</span>]}</span>`</span>)</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.numArr[<span class="hljs-number">2</span>]}</span>`</span>)</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.dimensionTwo[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]}</span>`</span>)</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.dimensionTwo[<span class="hljs-number">1</span>][<span class="hljs-number">1</span>]}</span>`</span>)</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>  </li><li><p>当装饰的变量是嵌套类或对象数组时，@Param无法观察深层对象属性的变化。对深层对象属性的观测依赖@ObservedV2与@Trace装饰器。</p>  <div _ngcontent-ssu-c106="" class="highlight-div"><div _ngcontent-ssu-c106="" class="highlight-div-header"><div _ngcontent-ssu-c106="" class="highlight-div-header-left"><div _ngcontent-ssu-c106="" class="handle-button expand-button"><div _ngcontent-ssu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ssu-c106="" class="highlight-div-header-right"><div _ngcontent-ssu-c106="" class="handle-button ai-button"></div><div _ngcontent-ssu-c106="" class="handle-button line-button"><div _ngcontent-ssu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ssu-c106="" class="handle-button theme-button"><div _ngcontent-ssu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ssu-c106="" class="handle-button copy-button"><div _ngcontent-ssu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ssu-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@ObservedV2</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Region</span> {</li><li>  <span class="hljs-meta">@Trace</span> <span class="hljs-attr">x</span>: <span class="hljs-built_in">number</span>;</li><li>  <span class="hljs-meta">@Trace</span> <span class="hljs-attr">y</span>: <span class="hljs-built_in">number</span>;</li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">x: <span class="hljs-built_in">number</span>, y: <span class="hljs-built_in">number</span></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">x</span> = x;</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">y</span> = y;</li><li>  }</li><li>}</li><li><span class="hljs-meta">@ObservedV2</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Info</span> {</li><li>  <span class="hljs-meta">@Trace</span> <span class="hljs-attr">region</span>: <span class="hljs-title class_">Region</span>;</li><li>  <span class="hljs-meta">@Trace</span> <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;</li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name: <span class="hljs-built_in">string</span>, x: <span class="hljs-built_in">number</span>, y: <span class="hljs-built_in">number</span></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">region</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Region</span>(x, y);</li><li>  }</li><li>}</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@ComponentV2</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-meta">@Local</span> <span class="hljs-attr">infoArr</span>: <span class="hljs-title class_">Info</span>[] = [<span class="hljs-keyword">new</span> <span class="hljs-title class_">Info</span>(<span class="hljs-string">'Ocean'</span>, <span class="hljs-number">28</span>, <span class="hljs-number">120</span>), <span class="hljs-keyword">new</span> <span class="hljs-title class_">Info</span>(<span class="hljs-string">'Mountain'</span>, <span class="hljs-number">26</span>, <span class="hljs-number">20</span>)];</li><li>  <span class="hljs-meta">@Local</span> <span class="hljs-attr">originInfo</span>: <span class="hljs-title class_">Info</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Info</span>(<span class="hljs-string">'Origin'</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">ForEach</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">infoArr</span>, <span class="hljs-function">(<span class="hljs-params">info: Info</span>) =&gt;</span> {</li><li>        <span class="hljs-title class_">Row</span>() {</li><li>          <span class="hljs-title class_">Text</span>(<span class="hljs-string">`name: <span class="hljs-subst">${info.name}</span>`</span>)</li><li>          <span class="hljs-title class_">Text</span>(<span class="hljs-string">`region: <span class="hljs-subst">${info.region.x}</span>-<span class="hljs-subst">${info.region.y}</span>`</span>)</li><li>        }</li><li>      })</li><li>      <span class="hljs-title class_">Row</span>() {</li><li>        <span class="hljs-title class_">Text</span>(<span class="hljs-string">`Origin name: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.originInfo.name}</span>`</span>)</li><li>        <span class="hljs-title class_">Text</span>(<span class="hljs-string">`Origin region: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.originInfo.region.x}</span>-<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.originInfo.region.y}</span>`</span>)</li><li>      }</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'change infoArr item'</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-comment">// 由于属性name被@Trace装饰，所以能够观察到</span></li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">infoArr</span>[<span class="hljs-number">0</span>].<span class="hljs-property">name</span> = <span class="hljs-string">'Win'</span>;</li><li>        })</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'change originInfo'</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-comment">// 由于变量originInfo被@Local装饰，所以能够观察到</span></li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">originInfo</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Info</span>(<span class="hljs-string">'Origin'</span>, <span class="hljs-number">100</span>, <span class="hljs-number">100</span>);</li><li>        })</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'change originInfo region'</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-comment">// 由于属性x、y被@Trace装饰，所以能够观察到</span></li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">originInfo</span>.<span class="hljs-property">region</span>.<span class="hljs-property">x</span> = <span class="hljs-number">25</span>;</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">originInfo</span>.<span class="hljs-property">region</span>.<span class="hljs-property">y</span> = <span class="hljs-number">25</span>;</li><li>        })</li><li>      <span class="hljs-title class_">Child</span>({</li><li>        <span class="hljs-attr">infoArr</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">infoArr</span>,</li><li>        <span class="hljs-attr">originInfo</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">originInfo</span></li><li>      })</li><li>    }</li><li>  }</li><li>}</li><li><span class="hljs-meta">@ComponentV2</span></li><li>struct <span class="hljs-title class_">Child</span> {</li><li>  <span class="hljs-meta">@Param</span> <span class="hljs-attr">infoArr</span>: <span class="hljs-title class_">Info</span>[] = [];</li><li>  <span class="hljs-meta">@Param</span> <span class="hljs-attr">originInfo</span>: <span class="hljs-title class_">Info</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Info</span>(<span class="hljs-string">'O'</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">ForEach</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">infoArr</span>, <span class="hljs-function">(<span class="hljs-params">info: Info</span>) =&gt;</span> {</li><li>        <span class="hljs-title class_">Row</span>() {</li><li>          <span class="hljs-title class_">Text</span>(<span class="hljs-string">`name: <span class="hljs-subst">${info.name}</span>`</span>)</li><li>          <span class="hljs-title class_">Text</span>(<span class="hljs-string">`region: <span class="hljs-subst">${info.region.x}</span>-<span class="hljs-subst">${info.region.y}</span>`</span>)</li><li>        }</li><li>      })</li><li>      <span class="hljs-title class_">Row</span>() {</li><li>        <span class="hljs-title class_">Text</span>(<span class="hljs-string">`Origin name: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.originInfo.name}</span>`</span>)</li><li>        <span class="hljs-title class_">Text</span>(<span class="hljs-string">`Origin region: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.originInfo.region.x}</span>-<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.originInfo.region.y}</span>`</span>)</li><li>      }</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>  </li><li><p>装饰的变量为内置类型时，可观察变量整体赋值和API调用的变化。</p>   <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.8.3.5.2.1.3.1.1" valign="top" width="50%">类型</th> <th align="left" class="cellrowborder" id="mcps1.3.8.3.5.2.1.3.1.2" valign="top" width="50%">可观测变化的API</th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="50%">Array</td> <td class="cellrowborder" valign="top" width="50%">push, pop, shift, unshift, splice, copyWithin, fill, reverse, sort</td> </tr> <tr><td class="cellrowborder" valign="top" width="50%">Date</td> <td class="cellrowborder" valign="top" width="50%">setFullYear, setMonth, setDate, setHours, setMinutes, setSeconds, setMilliseconds, setTime, setUTCFullYear, setUTCMonth, setUTCDate, setUTCHours, setUTCMinutes, setUTCSeconds, setUTCMilliseconds</td> </tr> <tr><td class="cellrowborder" valign="top" width="50%">Map</td> <td class="cellrowborder" valign="top" width="50%">set, clear, delete</td> </tr> <tr><td class="cellrowborder" valign="top" width="50%">Set</td> <td class="cellrowborder" valign="top" width="50%">add, clear, delete</td> </tr>  </tbody></table></div> </div>  </li></ul> </div>  <div class="tiledSection"><h2 id="限制条件">限制条件<i class="anchor-icon anchor-icon-link" anchorid="限制条件" tips="复制节点链接"></i></h2><p>@Param装饰器存在以下使用限制：</p> <ul><li><p>@Param装饰器只能在<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-new-componentv2">@ComponentV2</a>装饰器的自定义组件中使用。</p>  <div _ngcontent-ssu-c106="" class="highlight-div"><div _ngcontent-ssu-c106="" class="highlight-div-header"><div _ngcontent-ssu-c106="" class="highlight-div-header-left"><div _ngcontent-ssu-c106="" class="handle-button expand-button"><div _ngcontent-ssu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ssu-c106="" class="highlight-div-header-right"><div _ngcontent-ssu-c106="" class="handle-button ai-button"></div><div _ngcontent-ssu-c106="" class="handle-button line-button"><div _ngcontent-ssu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ssu-c106="" class="handle-button theme-button"><div _ngcontent-ssu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ssu-c106="" class="handle-button copy-button"><div _ngcontent-ssu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ssu-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@ComponentV2</span></li><li>struct <span class="hljs-title class_">MyComponent</span> {</li><li>  <span class="hljs-meta">@Param</span> <span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'Hello World'</span>; <span class="hljs-comment">// 正确用法</span></li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>  }</li><li>}</li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">TestComponent</span> {</li><li>  <span class="hljs-meta">@Param</span> <span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'Hello World'</span>; <span class="hljs-comment">// 错误用法，编译时报错</span></li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>  }</li><li>}</li></ol></pre></div></div>  </li><li><p>@Param装饰的变量表示组件外部输入，需要初始化。支持使用本地初始值或外部传入值进行初始化。当存在外部传入值时，优先使用外部传入值。不允许既不使用本地初始值，也不使用外部传入值。</p>  <div _ngcontent-ssu-c106="" class="highlight-div"><div _ngcontent-ssu-c106="" class="highlight-div-header"><div _ngcontent-ssu-c106="" class="highlight-div-header-left"><div _ngcontent-ssu-c106="" class="handle-button expand-button"><div _ngcontent-ssu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ssu-c106="" class="highlight-div-header-right"><div _ngcontent-ssu-c106="" class="handle-button ai-button"></div><div _ngcontent-ssu-c106="" class="handle-button line-button"><div _ngcontent-ssu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ssu-c106="" class="handle-button theme-button"><div _ngcontent-ssu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ssu-c106="" class="handle-button copy-button"><div _ngcontent-ssu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ssu-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@ComponentV2</span></li><li>struct <span class="hljs-title class_">ChildComponent</span> {</li><li>  <span class="hljs-meta">@Param</span> <span class="hljs-attr">param1</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'Initialize local'</span>;</li><li>  <span class="hljs-meta">@Param</span> <span class="hljs-attr">param2</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'Initialize local and put in'</span>;</li><li>  <span class="hljs-meta">@Require</span> <span class="hljs-meta">@Param</span> <span class="hljs-attr">param3</span>: <span class="hljs-built_in">string</span>;</li><li>  <span class="hljs-meta">@Param</span> <span class="hljs-attr">param4</span>: <span class="hljs-built_in">string</span>; <span class="hljs-comment">// 错误用法，外部未传入初始化且本地也无初始值，编译报错</span></li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.param1}</span>`</span>) <span class="hljs-comment">// 本地初始化，显示Initialize local</span></li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.param2}</span>`</span>) <span class="hljs-comment">// 外部传入初始化，显示Put in</span></li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.param3}</span>`</span>) <span class="hljs-comment">// 外部传入初始化，显示Put in</span></li><li>    }</li><li>  }</li><li>}</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@ComponentV2</span></li><li>struct <span class="hljs-title class_">MyComponent</span> {</li><li>  <span class="hljs-meta">@Local</span> <span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'Put in'</span>;</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">ChildComponent</span>({</li><li>        <span class="hljs-attr">param2</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span>,</li><li>        <span class="hljs-attr">param3</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span></li><li>      })</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>  </li><li><p>使用@Param装饰的变量在子组件中无法被直接修改。但是，如果装饰的变量是对象类型，在子组件中可以修改对象的属性。</p>  <div _ngcontent-ssu-c106="" class="highlight-div"><div _ngcontent-ssu-c106="" class="highlight-div-header"><div _ngcontent-ssu-c106="" class="highlight-div-header-left"><div _ngcontent-ssu-c106="" class="handle-button expand-button"><div _ngcontent-ssu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ssu-c106="" class="highlight-div-header-right"><div _ngcontent-ssu-c106="" class="handle-button ai-button"></div><div _ngcontent-ssu-c106="" class="handle-button line-button"><div _ngcontent-ssu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ssu-c106="" class="handle-button theme-button"><div _ngcontent-ssu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ssu-c106="" class="handle-button copy-button"><div _ngcontent-ssu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ssu-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@ObservedV2</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Info</span> {</li><li>  <span class="hljs-meta">@Trace</span> <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;</li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name: <span class="hljs-built_in">string</span></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;</li><li>  }</li><li>}</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@ComponentV2</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-meta">@Local</span> <span class="hljs-attr">info</span>: <span class="hljs-title class_">Info</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Info</span>(<span class="hljs-string">'Tom'</span>);</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`Parent info.name <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.info.name}</span>`</span>)</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'Parent change info'</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-comment">// 父组件更改@Local变量，会同步子组件对应@Param变量</span></li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">info</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Info</span>(<span class="hljs-string">'Lucy'</span>);</li><li>      })</li><li>      <span class="hljs-title class_">Child</span>({ <span class="hljs-attr">info</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">info</span> })</li><li>    }</li><li>  }</li><li>}</li><li><span class="hljs-meta">@ComponentV2</span></li><li>struct <span class="hljs-title class_">Child</span> {</li><li>  <span class="hljs-meta">@Require</span> <span class="hljs-meta">@Param</span> <span class="hljs-attr">info</span>: <span class="hljs-title class_">Info</span>;</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`info.name: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.info.name}</span>`</span>)</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'change info'</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-comment">// 错误用法，不允许在子组件中更改@Param变量，编译时会报错</span></li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">info</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Info</span>(<span class="hljs-string">'Jack'</span>);</li><li>        })</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'Child change info.name'</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-comment">// 允许在子组件中更改对象中属性，该修改会同步到父组件数据源上，当属性被@Trace装饰时，可观测到对应UI刷新</span></li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">info</span>.<span class="hljs-property">name</span> = <span class="hljs-string">'Jack'</span>;</li><li>        })</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>  </li></ul> </div>  <div class="tiledSection"><h2 id="使用场景">使用场景<i class="anchor-icon anchor-icon-link" anchorid="使用场景" tips="复制节点链接"></i></h2></div>  <div class="tiledSection"><h3 id="从父组件到子组件变量传递与同步" class="firsth2">从父组件到子组件变量传递与同步<i class="anchor-icon anchor-icon-link" anchorid="从父组件到子组件变量传递与同步" tips="复制节点链接"></i></h3><p>@Param能够接受父组件@Local或@Param传递的数据并与之变化同步。</p> <div _ngcontent-ssu-c106="" class="highlight-div"><div _ngcontent-ssu-c106="" class="highlight-div-header"><div _ngcontent-ssu-c106="" class="highlight-div-header-left"><div _ngcontent-ssu-c106="" class="handle-button expand-button"><div _ngcontent-ssu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ssu-c106="" class="highlight-div-header-right"><div _ngcontent-ssu-c106="" class="handle-button ai-button"></div><div _ngcontent-ssu-c106="" class="handle-button line-button"><div _ngcontent-ssu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ssu-c106="" class="handle-button theme-button"><div _ngcontent-ssu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ssu-c106="" class="handle-button copy-button"><div _ngcontent-ssu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ssu-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@ObservedV2</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Region</span> {</li><li>  <span class="hljs-meta">@Trace</span> <span class="hljs-attr">x</span>: <span class="hljs-built_in">number</span>;</li><li>  <span class="hljs-meta">@Trace</span> <span class="hljs-attr">y</span>: <span class="hljs-built_in">number</span>;</li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">x: <span class="hljs-built_in">number</span>, y: <span class="hljs-built_in">number</span></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">x</span> = x;</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">y</span> = y;</li><li>  }</li><li>}</li><li><span class="hljs-meta">@ObservedV2</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Info</span> {</li><li>  <span class="hljs-meta">@Trace</span> <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;</li><li>  <span class="hljs-meta">@Trace</span> <span class="hljs-attr">age</span>: <span class="hljs-built_in">number</span>;</li><li>  <span class="hljs-meta">@Trace</span> <span class="hljs-attr">region</span>: <span class="hljs-title class_">Region</span>;</li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name: <span class="hljs-built_in">string</span>, age: <span class="hljs-built_in">number</span>, x: <span class="hljs-built_in">number</span>, y: <span class="hljs-built_in">number</span></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span> = age;</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">region</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Region</span>(x, y);</li><li>  }</li><li>}</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@ComponentV2</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-meta">@Local</span> <span class="hljs-attr">infoList</span>: <span class="hljs-title class_">Info</span>[] = [<span class="hljs-keyword">new</span> <span class="hljs-title class_">Info</span>(<span class="hljs-string">'Alice'</span>, <span class="hljs-number">8</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>), <span class="hljs-keyword">new</span> <span class="hljs-title class_">Info</span>(<span class="hljs-string">'Barry'</span>, <span class="hljs-number">10</span>, <span class="hljs-number">1</span>, <span class="hljs-number">20</span>), <span class="hljs-keyword">new</span> <span class="hljs-title class_">Info</span>(<span class="hljs-string">'Cindy'</span>, <span class="hljs-number">18</span>, <span class="hljs-number">24</span>, <span class="hljs-number">40</span>)];</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">ForEach</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">infoList</span>, <span class="hljs-function">(<span class="hljs-params">info: Info</span>) =&gt;</span> {</li><li>        <span class="hljs-title class_">MiddleComponent</span>({ <span class="hljs-attr">info</span>: info })</li><li>      })</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'change'</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">infoList</span>[<span class="hljs-number">0</span>] = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Info</span>(<span class="hljs-string">'Atom'</span>, <span class="hljs-number">40</span>, <span class="hljs-number">27</span>, <span class="hljs-number">90</span>);</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">infoList</span>[<span class="hljs-number">1</span>].<span class="hljs-property">name</span> = <span class="hljs-string">'Bob'</span>;</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">infoList</span>[<span class="hljs-number">2</span>].<span class="hljs-property">region</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Region</span>(<span class="hljs-number">7</span>, <span class="hljs-number">9</span>);</li><li>        })</li><li>    }</li><li>  }</li><li>}</li><li><span class="hljs-meta">@ComponentV2</span></li><li>struct <span class="hljs-title class_">MiddleComponent</span> {</li><li>  <span class="hljs-meta">@Require</span> <span class="hljs-meta">@Param</span> <span class="hljs-attr">info</span>: <span class="hljs-title class_">Info</span>;</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`name: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.info.name}</span>`</span>)</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`age: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.info.age}</span>`</span>)</li><li>      <span class="hljs-title class_">SubComponent</span>({ <span class="hljs-attr">region</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">info</span>.<span class="hljs-property">region</span> })</li><li>    }</li><li>  }</li><li>}</li><li><span class="hljs-meta">@ComponentV2</span></li><li>struct <span class="hljs-title class_">SubComponent</span> {</li><li>  <span class="hljs-meta">@Require</span> <span class="hljs-meta">@Param</span> <span class="hljs-attr">region</span>: <span class="hljs-title class_">Region</span>;</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`region: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.region.x}</span>-<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.region.y}</span>`</span>)</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div> </div>  <div class="tiledSection"><h3 id="装饰array类型变量">装饰Array类型变量<i class="anchor-icon anchor-icon-link" anchorid="装饰array类型变量" tips="复制节点链接"></i></h3><p>@Param装饰Array类型变量，可以观察到数据源对Array整体的赋值，以及调用Array的接口push, pop, shift, unshift, splice, copyWithin, fill, reverse, sort带来的变化。</p> <div _ngcontent-ssu-c106="" class="highlight-div"><div _ngcontent-ssu-c106="" class="highlight-div-header"><div _ngcontent-ssu-c106="" class="highlight-div-header-left"><div _ngcontent-ssu-c106="" class="handle-button expand-button"><div _ngcontent-ssu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ssu-c106="" class="highlight-div-header-right"><div _ngcontent-ssu-c106="" class="handle-button ai-button"></div><div _ngcontent-ssu-c106="" class="handle-button line-button"><div _ngcontent-ssu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ssu-c106="" class="handle-button theme-button"><div _ngcontent-ssu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ssu-c106="" class="handle-button copy-button"><div _ngcontent-ssu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ssu-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@ComponentV2</span></li><li>struct <span class="hljs-title class_">Child</span> {</li><li>  <span class="hljs-meta">@Require</span> <span class="hljs-meta">@Param</span> <span class="hljs-attr">count</span>: <span class="hljs-built_in">number</span>[];</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">ForEach</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>, <span class="hljs-function">(<span class="hljs-params">item: <span class="hljs-built_in">number</span></span>) =&gt;</span> {</li><li>        <span class="hljs-title class_">Text</span>(<span class="hljs-string">`<span class="hljs-subst">${item}</span>`</span>).<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">30</span>)</li><li>        <span class="hljs-title class_">Divider</span>()</li><li>      })</li><li>    }</li><li>    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@ComponentV2</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-meta">@Local</span> <span class="hljs-attr">count</span>: <span class="hljs-built_in">number</span>[] = [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>];</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Row</span>() {</li><li>      <span class="hljs-title class_">Column</span>() {</li><li>        <span class="hljs-title class_">Child</span>({ <span class="hljs-attr">count</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span> })</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">'init array'</span>).<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span> = [<span class="hljs-number">9</span>,<span class="hljs-number">8</span>,<span class="hljs-number">7</span>];</li><li>        })</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">'push'</span>).<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>.<span class="hljs-title function_">push</span>(<span class="hljs-number">0</span>);</li><li>        })</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">'reverse'</span>).<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>.<span class="hljs-title function_">reverse</span>();</li><li>        })</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">'fill'</span>).<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span>.<span class="hljs-title function_">fill</span>(<span class="hljs-number">6</span>);</li><li>        })</li><li>      }</li><li>      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    }</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div> </div>  <div class="tiledSection"><h3 id="装饰date类型变量">装饰Date类型变量<i class="anchor-icon anchor-icon-link" anchorid="装饰date类型变量" tips="复制节点链接"></i></h3><p>@Param装饰Date类型变量，可以观察到数据源对Date整体的赋值，以及调用Date的接口setFullYear, setMonth, setDate, setHours, setMinutes, setSeconds, setMilliseconds, setTime, setUTCFullYear, setUTCMonth, setUTCDate, setUTCHours, setUTCMinutes, setUTCSeconds, setUTCMilliseconds带来的变化。</p> <div _ngcontent-ssu-c106="" class="highlight-div"><div _ngcontent-ssu-c106="" class="highlight-div-header"><div _ngcontent-ssu-c106="" class="highlight-div-header-left"><div _ngcontent-ssu-c106="" class="handle-button expand-button"><div _ngcontent-ssu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ssu-c106="" class="highlight-div-header-right"><div _ngcontent-ssu-c106="" class="handle-button ai-button"></div><div _ngcontent-ssu-c106="" class="handle-button line-button"><div _ngcontent-ssu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ssu-c106="" class="handle-button theme-button"><div _ngcontent-ssu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ssu-c106="" class="handle-button copy-button"><div _ngcontent-ssu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ssu-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@ComponentV2</span></li><li>struct <span class="hljs-title class_">DateComponent</span> {</li><li>  <span class="hljs-meta">@Param</span> <span class="hljs-attr">selectedDate</span>: <span class="hljs-title class_">Date</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-string">'2024-01-01'</span>);</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">DatePicker</span>({</li><li>        <span class="hljs-attr">start</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-string">'1970-1-1'</span>),</li><li>        <span class="hljs-attr">end</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-string">'2100-1-1'</span>),</li><li>        <span class="hljs-attr">selected</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">selectedDate</span></li><li>      })</li><li>    }</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@ComponentV2</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-meta">@Local</span> <span class="hljs-attr">parentSelectedDate</span>: <span class="hljs-title class_">Date</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-string">'2021-08-08'</span>);</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'parent update the new date'</span>)</li><li>        .<span class="hljs-title function_">margin</span>(<span class="hljs-number">10</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">parentSelectedDate</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-string">'2023-07-07'</span>);</li><li>        })</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'increase the year by 1'</span>)</li><li>        .<span class="hljs-title function_">margin</span>(<span class="hljs-number">10</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">parentSelectedDate</span>.<span class="hljs-title function_">setFullYear</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">parentSelectedDate</span>.<span class="hljs-title function_">getFullYear</span>() + <span class="hljs-number">1</span>);</li><li>        })</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'increase the month by 1'</span>)</li><li>        .<span class="hljs-title function_">margin</span>(<span class="hljs-number">10</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">parentSelectedDate</span>.<span class="hljs-title function_">setMonth</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">parentSelectedDate</span>.<span class="hljs-title function_">getMonth</span>() + <span class="hljs-number">1</span>);</li><li>        })</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'parent increase the day by 1'</span>)</li><li>        .<span class="hljs-title function_">margin</span>(<span class="hljs-number">10</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">parentSelectedDate</span>.<span class="hljs-title function_">setDate</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">parentSelectedDate</span>.<span class="hljs-title function_">getDate</span>() + <span class="hljs-number">1</span>);</li><li>        })</li><li>      <span class="hljs-title class_">DateComponent</span>({ <span class="hljs-attr">selectedDate</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">parentSelectedDate</span> })</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div> </div>  <div class="tiledSection"><h3 id="装饰map类型变量">装饰Map类型变量<i class="anchor-icon anchor-icon-link" anchorid="装饰map类型变量" tips="复制节点链接"></i></h3><p>@Param装饰Map类型变量，可以观察到数据源对Map整体的赋值，以及调用Map的接口set, clear, delete带来的变化。</p> <div _ngcontent-ssu-c106="" class="highlight-div"><div _ngcontent-ssu-c106="" class="highlight-div-header"><div _ngcontent-ssu-c106="" class="highlight-div-header-left"><div _ngcontent-ssu-c106="" class="handle-button expand-button"><div _ngcontent-ssu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ssu-c106="" class="highlight-div-header-right"><div _ngcontent-ssu-c106="" class="handle-button ai-button"></div><div _ngcontent-ssu-c106="" class="handle-button line-button"><div _ngcontent-ssu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ssu-c106="" class="handle-button theme-button"><div _ngcontent-ssu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ssu-c106="" class="handle-button copy-button"><div _ngcontent-ssu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ssu-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@ComponentV2</span></li><li>struct <span class="hljs-title class_">Child</span> {</li><li>  <span class="hljs-meta">@Param</span> <span class="hljs-attr">value</span>: <span class="hljs-title class_">Map</span>&lt;<span class="hljs-built_in">number</span>, <span class="hljs-built_in">string</span>&gt; = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">ForEach</span>(<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>.<span class="hljs-title function_">entries</span>()), <span class="hljs-function">(<span class="hljs-params">item: [<span class="hljs-built_in">number</span>, <span class="hljs-built_in">string</span>]</span>) =&gt;</span> {</li><li>        <span class="hljs-title class_">Text</span>(<span class="hljs-string">`<span class="hljs-subst">${item[<span class="hljs-number">0</span>]}</span>`</span>).<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">30</span>)</li><li>        <span class="hljs-title class_">Text</span>(<span class="hljs-string">`<span class="hljs-subst">${item[<span class="hljs-number">1</span>]}</span>`</span>).<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">30</span>)</li><li>        <span class="hljs-title class_">Divider</span>()</li><li>      })</li><li>    }</li><li>  }</li><li>}</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@ComponentV2</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-meta">@Local</span> <span class="hljs-attr">message</span>: <span class="hljs-title class_">Map</span>&lt;<span class="hljs-built_in">number</span>, <span class="hljs-built_in">string</span>&gt; = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>([[<span class="hljs-number">0</span>, <span class="hljs-string">'a'</span>], [<span class="hljs-number">1</span>, <span class="hljs-string">'b'</span>], [<span class="hljs-number">3</span>, <span class="hljs-string">'c'</span>]]);</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Row</span>() {</li><li>      <span class="hljs-title class_">Column</span>() {</li><li>        <span class="hljs-title class_">Child</span>({ <span class="hljs-attr">value</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span> })</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">'init map'</span>).<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>([[<span class="hljs-number">0</span>, <span class="hljs-string">'a'</span>], [<span class="hljs-number">1</span>, <span class="hljs-string">'b'</span>], [<span class="hljs-number">3</span>, <span class="hljs-string">'c'</span>]]);</li><li>        })</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">'set new one'</span>).<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span>.<span class="hljs-title function_">set</span>(<span class="hljs-number">4</span>, <span class="hljs-string">'d'</span>);</li><li>        })</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">'clear'</span>).<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span>.<span class="hljs-title function_">clear</span>();</li><li>        })</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">'replace the first one'</span>).<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span>.<span class="hljs-title function_">set</span>(<span class="hljs-number">0</span>, <span class="hljs-string">'aa'</span>);</li><li>        })</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">'delete the first one'</span>).<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span>.<span class="hljs-title function_">delete</span>(<span class="hljs-number">0</span>);</li><li>        })</li><li>      }</li><li>      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    }</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div> </div>  <div class="tiledSection"><h3 id="装饰set类型变量">装饰Set类型变量<i class="anchor-icon anchor-icon-link" anchorid="装饰set类型变量" tips="复制节点链接"></i></h3><p>@Param装饰Set类型变量，可以观察到数据源对Set整体的赋值，以及调用Set的接口add, clear, delete带来的变化。</p> <div _ngcontent-ssu-c106="" class="highlight-div"><div _ngcontent-ssu-c106="" class="highlight-div-header"><div _ngcontent-ssu-c106="" class="highlight-div-header-left"><div _ngcontent-ssu-c106="" class="handle-button expand-button"><div _ngcontent-ssu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ssu-c106="" class="highlight-div-header-right"><div _ngcontent-ssu-c106="" class="handle-button ai-button"></div><div _ngcontent-ssu-c106="" class="handle-button line-button"><div _ngcontent-ssu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ssu-c106="" class="handle-button theme-button"><div _ngcontent-ssu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ssu-c106="" class="handle-button copy-button"><div _ngcontent-ssu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ssu-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@ComponentV2</span></li><li>struct <span class="hljs-title class_">Child</span> {</li><li>  <span class="hljs-meta">@Param</span> <span class="hljs-attr">message</span>: <span class="hljs-title class_">Set</span>&lt;<span class="hljs-built_in">number</span>&gt; = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>();</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">ForEach</span>(<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span>.<span class="hljs-title function_">entries</span>()), <span class="hljs-function">(<span class="hljs-params">item: [<span class="hljs-built_in">number</span>, <span class="hljs-built_in">number</span>]</span>) =&gt;</span> {</li><li>        <span class="hljs-title class_">Text</span>(<span class="hljs-string">`<span class="hljs-subst">${item[<span class="hljs-number">0</span>]}</span>`</span>).<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">30</span>)</li><li>        <span class="hljs-title class_">Divider</span>()</li><li>      })</li><li>    }</li><li>    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@ComponentV2</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-meta">@Local</span> <span class="hljs-attr">message</span>: <span class="hljs-title class_">Set</span>&lt;<span class="hljs-built_in">number</span>&gt; = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>([<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>]);</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Row</span>() {</li><li>      <span class="hljs-title class_">Column</span>() {</li><li>        <span class="hljs-title class_">Child</span>({ <span class="hljs-attr">message</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span> })</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">'init set'</span>).<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Set</span>([<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>]);</li><li>        })</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">'set new one'</span>).<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span>.<span class="hljs-title function_">add</span>(<span class="hljs-number">5</span>);</li><li>        })</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">'clear'</span>).<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span>.<span class="hljs-title function_">clear</span>();</li><li>        })</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">'delete the first one'</span>).<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span>.<span class="hljs-title function_">delete</span>(<span class="hljs-number">0</span>);</li><li>        })</li><li>      }</li><li>      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    }</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div> </div>  <div class="tiledSection"><h3 id="联合类型">联合类型<i class="anchor-icon anchor-icon-link" anchorid="联合类型" tips="复制节点链接"></i></h3><p>@Param支持null、undefined以及联合类型。以下示例中，count类型为number | undefined，点击改变count的类型时，UI会自动刷新。</p> <div _ngcontent-ssu-c106="" class="highlight-div"><div _ngcontent-ssu-c106="" class="highlight-div-header"><div _ngcontent-ssu-c106="" class="highlight-div-header-left"><div _ngcontent-ssu-c106="" class="handle-button expand-button"><div _ngcontent-ssu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ssu-c106="" class="highlight-div-header-right"><div _ngcontent-ssu-c106="" class="handle-button ai-button"></div><div _ngcontent-ssu-c106="" class="handle-button line-button"><div _ngcontent-ssu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ssu-c106="" class="handle-button theme-button"><div _ngcontent-ssu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ssu-c106="" class="handle-button copy-button"><div _ngcontent-ssu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ssu-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@ComponentV2</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-meta">@Local</span> <span class="hljs-attr">count</span>: <span class="hljs-built_in">number</span> | <span class="hljs-literal">undefined</span> = <span class="hljs-number">0</span>;</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">MyComponent</span>({ <span class="hljs-attr">count</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span> })</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'change'</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">count</span> = <span class="hljs-literal">undefined</span>;</li><li>        })</li><li>    }</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-meta">@ComponentV2</span></li><li>struct <span class="hljs-title class_">MyComponent</span> {</li><li>  <span class="hljs-meta">@Param</span> <span class="hljs-attr">count</span>: <span class="hljs-built_in">number</span> | <span class="hljs-literal">undefined</span> = <span class="hljs-number">0</span>;</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`count(<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.count}</span>)`</span>)</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div> </div> </div> <div></div></div>