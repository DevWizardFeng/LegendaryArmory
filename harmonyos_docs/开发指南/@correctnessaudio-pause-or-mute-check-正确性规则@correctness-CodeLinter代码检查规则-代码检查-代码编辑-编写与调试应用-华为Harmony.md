<h1 _ngcontent-omf-c119="" class="doc-title ng-star-inserted" title="@correctness/audio-pause-or-mute-check"> @correctness/audio-pause-or-mute-check </h1>

<div _ngcontent-omf-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div id="body0000002168504129"><p id="ZH-CN_TOPIC_0000002478174436__p655181018414">建议应用在播放声音的场景下，监听音频发声设备变化。</p> <p id="ZH-CN_TOPIC_0000002478174436__p626716244514">改善<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/audio-output-device-change#音频流输出设备变更原因" target="_blank">音视频播放</a>体验场景下，建议优先修改。</p> <div class="tiledSection"><h2 id="section360119186717">规则配置<i class="anchor-icon anchor-icon-link" anchorid="section360119186717" tips="复制节点链接"></i></h2><div _ngcontent-omf-c106="" class="highlight-div"><div _ngcontent-omf-c106="" class="highlight-div-header"><div _ngcontent-omf-c106="" class="highlight-div-header-left"><div _ngcontent-omf-c106="" class="handle-button expand-button"><div _ngcontent-omf-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-omf-c106="" class="highlight-div-header-right"><div _ngcontent-omf-c106="" class="handle-button ai-button"></div><div _ngcontent-omf-c106="" class="handle-button line-button"><div _ngcontent-omf-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-omf-c106="" class="handle-button theme-button"><div _ngcontent-omf-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-omf-c106="" class="handle-button copy-button"><div _ngcontent-omf-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-omf-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" id="ZH-CN_TOPIC_0000002478174436__screen13464104716810" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// code-linter.json5</span></li><li>{</li><li>  <span class=""><span class="hljs-string">"rules"</span></span>: {</li><li>    <span class="hljs-string">"@correctness/audio-pause-or-mute-check"</span>: <span class="hljs-string">"warn"</span></li><li>  }</li><li>}</li></ol></pre></div></div> </div> <div class="tiledSection"><h2 id="section182418564158">选项<i class="anchor-icon anchor-icon-link" anchorid="section182418564158" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002478174436__p157697119168">该规则无需配置额外选项。</p> </div> <div class="tiledSection"><h2 id="section8953121019164">正例<i class="anchor-icon anchor-icon-link" anchorid="section8953121019164" tips="复制节点链接"></i></h2><div _ngcontent-omf-c106="" class="highlight-div"><div _ngcontent-omf-c106="" class="highlight-div-header"><div _ngcontent-omf-c106="" class="highlight-div-header-left"><div _ngcontent-omf-c106="" class="handle-button expand-button"><div _ngcontent-omf-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-omf-c106="" class="highlight-div-header-right"><div _ngcontent-omf-c106="" class="handle-button ai-button"></div><div _ngcontent-omf-c106="" class="handle-button line-button"><div _ngcontent-omf-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-omf-c106="" class="handle-button theme-button"><div _ngcontent-omf-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-omf-c106="" class="handle-button copy-button"><div _ngcontent-omf-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-omf-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" id="ZH-CN_TOPIC_0000002478174436__screen270311361760" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-variable">media</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.MediaKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-variable">audio</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AudioKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-variable">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-variable">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AudioPauseNoReport</span> {</li><li>  <span class="hljs-title function_">demoCallBack</span>() {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-variable">audioStreamInfo1</span>: <span class="hljs-title class_">audio</span>.<span class="hljs-title class_">AudioStreamInfo</span> = {</li><li>      <span class="hljs-variable">samplingRate</span>: <span class="hljs-title class_">audio</span>.<span class="hljs-title class_">AudioSamplingRate</span>.<span class="hljs-title class_">SAMPLE_RATE_44100</span>,</li><li>      <span class="hljs-variable">channels</span>: <span class="hljs-title class_">audio</span>.<span class="hljs-title class_">AudioChannel</span>.<span class="hljs-title class_">CHANNEL_1</span>,</li><li>      <span class="hljs-variable">sampleFormat</span>: <span class="hljs-title class_">audio</span>.<span class="hljs-title class_">AudioSampleFormat</span>.<span class="hljs-title class_">SAMPLE_FORMAT_S16LE</span>,</li><li>      <span class="hljs-variable">encodingType</span>: <span class="hljs-title class_">audio</span>.<span class="hljs-title class_">AudioEncodingType</span>.<span class="hljs-title class_">ENCODING_TYPE_RAW</span></li><li>    };</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-variable">audioRendererInfo</span>: <span class="hljs-title class_">audio</span>.<span class="hljs-title class_">AudioRendererInfo</span> = {</li><li>      <span class="hljs-variable">usage</span>: <span class="hljs-title class_">audio</span>.<span class="hljs-title class_">StreamUsage</span>.<span class="hljs-title class_">STREAM_USAGE_VOICE_COMMUNICATION</span>,</li><li>      <span class="hljs-variable">rendererFlags</span>: <span class="hljs-number">0</span></li><li>    };</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-variable">audioRendererOptions</span>: <span class="hljs-title class_">audio</span>.<span class="hljs-title class_">AudioRendererOptions</span> = {</li><li>      <span class="hljs-variable">streamInfo</span>: <span class="hljs-title class_">audioStreamInfo1</span>,</li><li>      <span class="hljs-variable">rendererInfo</span>: <span class="hljs-title class_">audioRendererInfo</span></li><li>    };</li><li>    <span class="hljs-variable">media</span>.<span class="hljs-title function_">createAVPlayer</span>((<span class="hljs-variable">error</span>: <span class="hljs-title class_">BusinessError</span>, <span class="hljs-variable">player</span>) =&gt; {</li><li>      <span class="hljs-keyword">if</span> (<span class="hljs-variable">player</span>) {</li><li>        <span class="hljs-variable">player</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">'audioInterrupt'</span>, (<span class="hljs-variable">interruptEvent</span>: <span class="hljs-title class_">audio</span>.<span class="hljs-title class_">InterruptEvent</span>)=&gt;{</li><li>          <span class="hljs-variable">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Succeeded'</span>);</li><li>        });</li><li>        <span class="hljs-variable">player</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">'audioOutputDeviceChangeWithInfo'</span>, ()=&gt;{</li><li>          <span class="hljs-variable">console</span>.<span class="hljs-title function_">error</span>(`<span class="hljs-variable">createAVPlayer</span> <span class="hljs-variable">audioOutputDeviceChangeWithInfo</span>`);</li><li>        });</li><li>        <span class="hljs-variable">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Succeeded in creating AVPlayer.'</span>);</li><li>      } <span class="hljs-keyword">else</span> {</li><li>        <span class="hljs-variable">console</span>.<span class="hljs-title function_">error</span>(`<span class="hljs-variable">Failed</span> <span class="hljs-variable">to</span> <span class="hljs-variable">create</span> <span class="hljs-variable">AVPlayer</span>, <span class="hljs-variable">error</span> <span class="hljs-variable">message</span>:${<span class="hljs-variable">error</span>.<span class="hljs-variable">message</span>}`);</li><li>      }</li><li>    });</li><li>    <span class="hljs-variable">audio</span>.<span class="hljs-title function_">createAudioRenderer</span>(<span class="hljs-variable">audioRendererOptions</span>,(<span class="hljs-variable">err</span>, <span class="hljs-variable">audioRenderer</span>: <span class="hljs-title class_">audio</span>.<span class="hljs-title class_">AudioRenderer</span>) =&gt; {</li><li>      <span class="hljs-keyword">if</span> (<span class="hljs-variable">err</span>) {</li><li>        <span class="hljs-variable">console</span>.<span class="hljs-title function_">error</span>(`<span class="hljs-variable">AudioRenderer</span> <span class="hljs-variable">Created</span>: <span class="hljs-title class_">Error</span>: ${<span class="hljs-variable">err</span>}`);</li><li>      } <span class="hljs-keyword">else</span> {</li><li>        <span class="hljs-variable">audioRenderer</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">'audioInterrupt'</span>, (<span class="hljs-variable">interruptEvent</span>: <span class="hljs-title class_">audio</span>.<span class="hljs-title class_">InterruptEvent</span>)=&gt;{</li><li>          <span class="hljs-variable">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Succeeded'</span>);</li><li>        });</li><li>        <span class="hljs-variable">audioRenderer</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">'outputDeviceChangeWithInfo'</span>, ()=&gt;{</li><li>          <span class="hljs-variable">console</span>.<span class="hljs-title function_">error</span>(`<span class="hljs-variable">createAudioRenderer</span> <span class="hljs-variable">outputDeviceChangeWithInfo</span>`);</li><li>        })</li><li>        <span class="hljs-variable">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'AudioRenderer Created: Success: SUCCESS'</span>);</li><li>      }</li><li>    });</li><li>  }</li><li>}</li></ol></pre></div></div> </div> <div class="tiledSection"><h2 id="section1228618482198">反例<i class="anchor-icon anchor-icon-link" anchorid="section1228618482198" tips="复制节点链接"></i></h2><div _ngcontent-omf-c106="" class="highlight-div"><div _ngcontent-omf-c106="" class="highlight-div-header"><div _ngcontent-omf-c106="" class="highlight-div-header-left"><div _ngcontent-omf-c106="" class="handle-button expand-button"><div _ngcontent-omf-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-omf-c106="" class="highlight-div-header-right"><div _ngcontent-omf-c106="" class="handle-button ai-button"></div><div _ngcontent-omf-c106="" class="handle-button line-button"><div _ngcontent-omf-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-omf-c106="" class="handle-button theme-button"><div _ngcontent-omf-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-omf-c106="" class="handle-button copy-button"><div _ngcontent-omf-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-omf-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" id="ZH-CN_TOPIC_0000002478174436__screen1014733115517" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-variable">media</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.MediaKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-variable">audio</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AudioKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-variable">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-variable">audioStreamInfo1</span>: <span class="hljs-title class_">audio</span>.<span class="hljs-title class_">AudioStreamInfo</span> = {</li><li>  <span class="hljs-variable">samplingRate</span>: <span class="hljs-title class_">audio</span>.<span class="hljs-title class_">AudioSamplingRate</span>.<span class="hljs-title class_">SAMPLE_RATE_44100</span>,</li><li>  <span class="hljs-variable">channels</span>: <span class="hljs-title class_">audio</span>.<span class="hljs-title class_">AudioChannel</span>.<span class="hljs-title class_">CHANNEL_1</span>,</li><li>  <span class="hljs-variable">sampleFormat</span>: <span class="hljs-title class_">audio</span>.<span class="hljs-title class_">AudioSampleFormat</span>.<span class="hljs-title class_">SAMPLE_FORMAT_S16LE</span>,</li><li>  <span class="hljs-variable">encodingType</span>: <span class="hljs-title class_">audio</span>.<span class="hljs-title class_">AudioEncodingType</span>.<span class="hljs-title class_">ENCODING_TYPE_RAW</span></li><li>};</li><li><span class="hljs-keyword">let</span> <span class="hljs-variable">audioRendererInfo</span>: <span class="hljs-title class_">audio</span>.<span class="hljs-title class_">AudioRendererInfo</span> = {</li><li>  <span class="hljs-variable">usage</span>: <span class="hljs-title class_">audio</span>.<span class="hljs-title class_">StreamUsage</span>.<span class="hljs-title class_">STREAM_USAGE_VOICE_COMMUNICATION</span>,</li><li>  <span class="hljs-variable">rendererFlags</span>: <span class="hljs-number">0</span></li><li>};</li><li><span class="hljs-keyword">let</span> <span class="hljs-variable">audioRendererOptions</span>: <span class="hljs-title class_">audio</span>.<span class="hljs-title class_">AudioRendererOptions</span> = {</li><li>  <span class="hljs-variable">streamInfo</span>: <span class="hljs-title class_">audioStreamInfo1</span>,</li><li>  <span class="hljs-variable">rendererInfo</span>: <span class="hljs-title class_">audioRendererInfo</span></li><li>};</li><li><span class="hljs-variable">function</span> <span class="hljs-title function_">demoCallBack</span>() {</li><li>  <span class="hljs-comment">// warning line</span></li><li>  <span class="hljs-variable">media</span>.<span class="hljs-title function_">createAVPlayer</span>((<span class="hljs-variable">error</span>: <span class="hljs-title class_">BusinessError</span>, <span class="hljs-variable">player</span>: <span class="hljs-title class_">media</span>.<span class="hljs-title class_">AVPlayer</span>) =&gt; {</li><li>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">player</span> != <span class="hljs-variable">null</span>) {</li><li>      <span class="hljs-variable">player</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">'audioInterrupt'</span>, (<span class="hljs-variable">interruptEvent</span>: <span class="hljs-title class_">audio</span>.<span class="hljs-title class_">InterruptEvent</span>)=&gt;{</li><li>        <span class="hljs-variable">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Succeeded'</span>);</li><li>      });</li><li>      <span class="hljs-variable">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Succeeded in creating AVPlayer.'</span>);</li><li>    } <span class="hljs-keyword">else</span> {</li><li>      <span class="hljs-variable">console</span>.<span class="hljs-title function_">error</span>(`<span class="hljs-variable">Failed</span> <span class="hljs-variable">to</span> <span class="hljs-variable">create</span> <span class="hljs-variable">AVPlayer</span>, <span class="hljs-variable">error</span> <span class="hljs-variable">message</span>:${<span class="hljs-variable">error</span>.<span class="hljs-variable">message</span>}`);</li><li>    }</li><li>  });</li><li>  <span class="hljs-comment">// warning line</span></li><li>  <span class="hljs-variable">audio</span>.<span class="hljs-title function_">createAudioRenderer</span>(<span class="hljs-variable">audioRendererOptions</span>,(<span class="hljs-variable">err</span>, <span class="hljs-variable">audioRenderer</span>: <span class="hljs-title class_">audio</span>.<span class="hljs-title class_">AudioRenderer</span>) =&gt; {</li><li>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">err</span>) {</li><li>      <span class="hljs-variable">console</span>.<span class="hljs-title function_">error</span>(`<span class="hljs-variable">AudioRenderer</span> <span class="hljs-variable">Created</span>: <span class="hljs-title class_">Error</span>: ${<span class="hljs-variable">err</span>}`);</li><li>    } <span class="hljs-keyword">else</span> {</li><li>      <span class="hljs-variable">audioRenderer</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">'audioInterrupt'</span>, (<span class="hljs-variable">interruptEvent</span>: <span class="hljs-title class_">audio</span>.<span class="hljs-title class_">InterruptEvent</span>)=&gt;{</li><li>        <span class="hljs-variable">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Succeeded'</span>);</li><li>      });</li><li>      <span class="hljs-variable">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'AudioRenderer Created.'</span>);</li><li>    }</li><li>  });</li><li>}</li></ol></pre></div></div> </div> <div class="tiledSection"><h2 id="section124723517167">规则集<i class="anchor-icon anchor-icon-link" anchorid="section124723517167" tips="复制节点链接"></i></h2><div _ngcontent-omf-c106="" class="highlight-div"><div _ngcontent-omf-c106="" class="highlight-div-header"><div _ngcontent-omf-c106="" class="highlight-div-header-left"><div _ngcontent-omf-c106="" class="handle-button expand-button"><div _ngcontent-omf-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-omf-c106="" class="highlight-div-header-right"><div _ngcontent-omf-c106="" class="handle-button ai-button"></div><div _ngcontent-omf-c106="" class="handle-button line-button"><div _ngcontent-omf-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-omf-c106="" class="handle-button theme-button"><div _ngcontent-omf-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-omf-c106="" class="handle-button copy-button"><div _ngcontent-omf-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-omf-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-sql" id="ZH-CN_TOPIC_0000002478174436__screen109871857191218" data-highlighted="yes"><ol class="linenums"><li><span class="">plugin:<span class="hljs-variable">@correctness</span><span class="hljs-operator">/</span><span class="hljs-keyword">all</span></span></li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002478174436__p105701158182115">Code Linter代码检查规则的配置指导请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-code-linter">Code Linter代码检查</a>。</p> </div> </div> <div></div></div>