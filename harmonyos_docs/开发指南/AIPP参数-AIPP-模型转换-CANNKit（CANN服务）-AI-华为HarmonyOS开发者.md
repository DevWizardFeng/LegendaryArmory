<h1 _ngcontent-ftp-c119="" class="doc-title ng-star-inserted" title="AIPP参数"> AIPP参数 </h1>

<div _ngcontent-ftp-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div><p class="msonormalindent">AIPP分为静态AIPP和动态AIPP，两者使用严格区分，静态AIPP模型不能接收模型推理时传入的AIPP参数，不兼容动态AIPP场景，静态与动态AIPP区别详见下表。</p>  <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.2.1.4.1.1" valign="top" width="10.47895210478952%"><p>AIPP</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.2.1.4.1.2" valign="top" width="51.68483151684832%"><p>设置AIPP参数方式</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.2.1.4.1.3" valign="top" width="37.83621637836217%"><p>优点</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="10.47895210478952%"><p>静态AIPP</p> </td> <td class="cellrowborder" valign="top" width="51.68483151684832%"><p>在模型生成时通过配置文件或者IR构图预置。</p> </td> <td class="cellrowborder" valign="top" width="37.83621637836217%"><p>更高效率，模型加载阶段即可完成AIPP初始化。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="10.47895210478952%"><p>动态AIPP</p> </td> <td class="cellrowborder" valign="top" width="51.68483151684832%"><p>仅标记该模型具备AIPP处理功能。</p> </td> <td class="cellrowborder" valign="top" width="37.83621637836217%"><p>更灵活，每次推理可传入不同AIPP参数。</p> </td> </tr>  </tbody></table></div> </div> <div class="tiledSection"><h2 id="section11405464173">AIPP支持的输入格式<i class="anchor-icon anchor-icon-link" anchorid="section11405464173" tips="复制节点链接"></i></h2><p class="msonormalindent">AIPP可配置的图片格式如下：</p> <ul><li>YUV420SP_U8</li><li>XRGB8888_U8</li><li>ARGB8888_U8</li><li>YUYV_U8</li><li>YUV422SP_U8</li><li>AYUV444_U8</li><li>YUV400_U8</li><li>RGB888_U8</li></ul> <p class="msonormalindent">格式后缀U8表示图片像素点为Uint8类型，范围为0到255。当图片的输入为YUV类型时，无论是YUV420还是YUV422或者YUYV，AIPP自动将图片数据补齐为YUV444格式。</p> <p class="msonormalindent">除以上列举的图片类型，AIPP还可以通过开启Channel Swap通道交换功能，支持更加丰富的图片输入格式。</p> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><ul><li>YUYV_U8和AYUV444_U8当前版本不支持。</li></ul> </div></div></div> </div> <div class="tiledSection"><h2 id="section697312919187">AIPP支持的功能<i class="anchor-icon anchor-icon-link" anchorid="section697312919187" tips="复制节点链接"></i></h2><p class="msonormal">AIPP按照芯片的处理顺序，支持的功能如下：</p> <ul><li><a href="/consumer/cn/doc/harmonyos-guides/cannkit-aipp-parameters#section197711329191913">Crop</a>：图片裁剪。</li><li><a href="/consumer/cn/doc/harmonyos-guides/cannkit-aipp-parameters#section8293174872013">Channel Swap</a>：通道交换。</li><li><a href="/consumer/cn/doc/harmonyos-guides/cannkit-aipp-parameters#section89862027112118">Color Space Conversion</a>：色域转换。</li><li><a href="/consumer/cn/doc/harmonyos-guides/cannkit-aipp-parameters#section4757633132210">Resize</a>：图片缩放。</li><li><a href="/consumer/cn/doc/harmonyos-guides/cannkit-aipp-parameters#section12331181152317">Data Type Conversion</a>：数据类型转换。</li><li><a href="/consumer/cn/doc/harmonyos-guides/cannkit-aipp-parameters#section127618563124">Rotation</a>：图片旋转。</li><li><a href="/consumer/cn/doc/harmonyos-guides/cannkit-aipp-parameters#section03997455233">Padding</a>：图片补边。</li></ul> </div> <div class="tiledSection"><h3 id="section197711329191913" class="firsth2">Crop<i class="anchor-icon anchor-icon-link" anchorid="section197711329191913" tips="复制节点链接"></i></h3><p class="msonormalindent">AIPP的Crop功能用于对输入图片进行裁剪，涉及参数如下：</p>  <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.5.3.1.4.1.1" valign="top" width="21.95%"><p><strong>名称</strong></p> </th> <th align="left" class="cellrowborder" id="mcps1.3.5.3.1.4.1.2" valign="top" width="35.29%"><p><strong>描述</strong></p> </th> <th align="left" class="cellrowborder" id="mcps1.3.5.3.1.4.1.3" valign="top" width="42.76%"><p><strong>取值范围</strong></p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="21.95%"><p>switch</p> </td> <td class="cellrowborder" valign="top" width="35.29%"><p>裁剪使能开关。</p> </td> <td class="cellrowborder" valign="top" width="42.76%"><p>false/true</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="21.95%"><p>load_start_pos_w</p> </td> <td class="cellrowborder" valign="top" width="35.29%"><p>裁剪起始位置水平方向坐标。</p> </td> <td class="cellrowborder" valign="top" width="42.76%"><p>load_start_pos_w &lt; src_image_size_w</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="21.95%"><p>load_start_pos_h</p> </td> <td class="cellrowborder" valign="top" width="35.29%"><p>裁剪起始位置垂直方向坐标。</p> </td> <td class="cellrowborder" valign="top" width="42.76%"><p>load_start_pos_h &lt; src_image_size_h</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="21.95%"><p>crop_size_w</p> </td> <td class="cellrowborder" valign="top" width="35.29%"><p>裁剪出的图像宽度。</p> </td> <td class="cellrowborder" valign="top" width="42.76%"><p>load_start_pos_w + crop_size_w &lt;= src_image_size_w</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="21.95%"><p>crop_size_h</p> </td> <td class="cellrowborder" valign="top" width="35.29%"><p>裁剪出的图像高度。</p> </td> <td class="cellrowborder" valign="top" width="42.76%"><p>load_start_pos_h + crop_size_h &lt;= src_image_size_h</p> </td> </tr>  </tbody></table></div> </div> <p>YUV类型的图片受图片自身类型的限制，当输入图片类型为YUV420SP、YUYV、YUV422SP和AYUV444时，裁剪的起始坐标和裁剪的宽高都应该是偶数，系统会进行校验。</p> </div> <div class="tiledSection"><h3 id="section8293174872013">Channel Swap<i class="anchor-icon anchor-icon-link" anchorid="section8293174872013" tips="复制节点链接"></i></h3><p class="msonormalindent">AIPP支持两种类型的通道交换：RB/UV通道交换和AX通道交换。</p> <p class="msonormal">RB/UV通道交换丰富了输入图片的格式，开启RB/UV通道交换后，AIPP支持的图片输入格式比可配置的输入类型丰富了一倍。</p>  <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.6.4.1.3.1.1" valign="top" width="26.14%"><p>配置类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.6.4.1.3.1.2" valign="top" width="73.86%"><p>可接受图片类型</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="26.14%"><p>YUV420SP_U8</p> </td> <td class="cellrowborder" valign="top" width="73.86%"><p>YUV420，YVU420 + rbuv_swap_switch</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="26.14%"><p>XRGB8888_U8</p> </td> <td class="cellrowborder" valign="top" width="73.86%"><p>XRGB，XBGR + rbuv_swap_switch</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="26.14%"><p>ARGB8888_U8</p> </td> <td class="cellrowborder" valign="top" width="73.86%"><p>ARGB，ABGR + rbuv_swap_switch</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="26.14%"><p>RGB888_U8</p> </td> <td class="cellrowborder" valign="top" width="73.86%"><p>BGR + rbuv_swap_switch</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="26.14%"><p>YUYV_U8</p> </td> <td class="cellrowborder" valign="top" width="73.86%"><p>YUYV，YVYU + rbuv_swap_switch</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="26.14%"><p>YUV422SP_U8</p> </td> <td class="cellrowborder" valign="top" width="73.86%"><p>YUV422，YVU422 + rbuv_swap_switch</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="26.14%"><p>AYUV444_U8</p> </td> <td class="cellrowborder" valign="top" width="73.86%"><p>AYUV + rbuv_swap_switch</p> </td> </tr>  </tbody></table></div> </div> <p>当配置的图片输入格式为XRGB、ARGB或AYUV时，支持开启AX通道交换。开启通道交换后，图片第一个通道的输入被搬移到第四个通道上，即当XRGB、ARGB和AYUV开启AX通道交换后，转变为RGBX、RGBA和YUVA。</p> <p>当模型训练集为RGB格式的图片，而推理时的图片输入为XRGB或者ARGB时，可以通过使能AX通道交换，将RGB通道前移，实现兼容。</p> </div> <div class="tiledSection"><h3 id="section89862027112118">Color Space Conversion<i class="anchor-icon anchor-icon-link" anchorid="section89862027112118" tips="复制节点链接"></i></h3><p class="msonormal">色域转换（Color Space Conversion，以下简称CSC），特指在YUV444和RGB888两种图片格式之间进行转换。涉及如下配置参数。</p>  <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.7.3.1.5.1.1" valign="top" width="22.02%"><p><strong>名称</strong></p> </th> <th align="left" class="cellrowborder" id="mcps1.3.7.3.1.5.1.2" valign="top" width="39.64%"><p><strong>描述</strong></p> </th> <th align="left" class="cellrowborder" id="mcps1.3.7.3.1.5.1.3" valign="top" width="14.030000000000001%"><p><strong>类型</strong></p> </th> <th align="left" class="cellrowborder" id="mcps1.3.7.3.1.5.1.4" valign="top" width="24.310000000000002%"><p><strong>取值范围</strong></p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="22.02%"><p>csc_switch</p> </td> <td class="cellrowborder" valign="top" width="39.64%"><p>CSC开关。</p> </td> <td class="cellrowborder" valign="top" width="14.030000000000001%"><p>bool</p> </td> <td class="cellrowborder" valign="top" width="24.310000000000002%"><p>true/false</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="22.02%"><p>matrix_r0c0</p> <p>matrix_r0c1</p> <p>matrix_r0c2</p> <p>matrix_r1c0</p> <p>matrix_r1c1</p> <p>matrix_r1c2</p> <p>matrix_r2c0</p> <p>matrix_r2c1</p> <p>matrix_r2c2</p> </td> <td class="cellrowborder" valign="top" width="39.64%"><p>CSC矩阵元素。</p> </td> <td class="cellrowborder" valign="top" width="14.030000000000001%"><p>int16</p> </td> <td class="cellrowborder" valign="top" width="24.310000000000002%"><p>[-32677, 32676]</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="22.02%"><p>output_bias_0</p> <p>output_bias_1</p> <p>output_bias_2</p> </td> <td class="cellrowborder" valign="top" width="39.64%"><p>RGB转YUV时的输出偏移。</p> </td> <td class="cellrowborder" valign="top" width="14.030000000000001%"><p>uint8</p> </td> <td class="cellrowborder" valign="top" width="24.310000000000002%"><p>[0, 255]</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="22.02%"><p>input_bias_0</p> <p>input_bias_1</p> <p>input_bias_2</p> </td> <td class="cellrowborder" valign="top" width="39.64%"><p>YUV转RGB时的输入偏移。</p> </td> <td class="cellrowborder" valign="top" width="14.030000000000001%"><p>uint8</p> </td> <td class="cellrowborder" valign="top" width="24.310000000000002%"><p>[0, 255]</p> </td> </tr>  </tbody></table></div> </div> <p>参考1：YUV和BGR的转换公式。</p> <ul><li>YUV转BGR<p><span><img height="92.34190000000001" originheight="114" originwidth="821" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114251.89663241870574348161139595688801:50001231000000:2800:A5CAF139E8B9C0B24292DB32C12CA35F55047A58651332076395E3D63F8F4F4D.png" title="点击放大" width="532"></span></p> </li></ul> <ul><li>BGR转YUV<p><span><img height="113.715" originheight="114" originwidth="884" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114251.68551165567659655206730953812852:50001231000000:2800:837D254FDB7FF7E077EC3061444BAD06AD2D942E5A137E3909CF8F80AB96A147.png" title="点击放大" width="532"></span></p> </li></ul> <p>参考2：BT-601 narrow、JPEG和BT-709 narrow三种类型图片的转换公式。</p> <ul><li>BT-601 narrow<p><span><img height="157.6316" originheight="241" originwidth="610" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114251.99614745758550206780570520769820:50001231000000:2800:B1257585CA69738427C2A6DBEB4D46DE07F977095630DE03F8F6576D2DF64849.png" title="点击放大" width="399"></span></p> </li><li>JPEG<p><span><img height="172.1286" originheight="239" originwidth="554" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114251.15802454882283814894729700074719:50001231000000:2800:5A0E57F15799A9084013037BF52A7E7701CF35B9213B4B3844BCF363177C7428.png" title="点击放大" width="399"></span></p> </li><li>BT-709 narrow<p><span><img height="163.5368" originheight="241" originwidth="588" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114251.63937663349999119610045788650351:50001231000000:2800:115D45C82A81806512736A50EEDD338FEED4937429CA588D456988F1F173A1B9.png" title="点击放大" width="399"></span></p> </li></ul> <p>使用配置文件生成静态AIPP模型时，需要根据以上的公式配置CSC矩阵以及<span class="parmvalue">“input_bias”</span>或者<span class="parmvalue">“output_bias”</span>的值。使用IR定义AIPP CSC功能算子，以及使用CANN Kit接口配置CSC参数时，支持传入目标类型，由系统来填充CSC配置参数。</p> <p>以下为JPEG和BT-601NARROW两种图片类型下的CSC配置参考。</p> <ul><li>输入为YUV格式图片(YUV420/YUYV/YUV422SP/AYUV444)，模型训练集为RGB，不支持从YUV400到RGB的转换。 <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.7.11.1.1.1.5.1.1" valign="top" width="25%"><p>JPEG</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.7.11.1.1.1.5.1.2" valign="top" width="25%"><p>BT-601NARROW</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.7.11.1.1.1.5.1.3" valign="top" width="25%"><p>BT-601FULL</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.7.11.1.1.1.5.1.4" valign="top" width="25%"><p>BT-709NARROW</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="25%"><p>matrix_r0c0 : 256</p> <p>matrix_r0c1 : 0</p> <p>matrix_r0c2 : 359</p> <p>matrix_r1c0 : 256</p> <p>matrix_r1c1 : -88</p> <p>matrix_r1c2 : -183</p> <p>matrix_r2c0 : 256</p> <p>matrix_r2c1 : 454</p> <p>matrix_r2c2 : 0</p> <p>input_bias_0 : 0</p> <p>input_bias_1 : 128</p> <p>input_bias_2 : 128</p> </td> <td class="cellrowborder" valign="top" width="25%"><p>matrix_r0c0 : 298</p> <p>matrix_r0c1 : 0</p> <p>matrix_r0c2 : 409</p> <p>matrix_r1c0 : 298</p> <p>matrix_r1c1 : -100</p> <p>matrix_r1c2 : -208</p> <p>matrix_r2c0 : 298</p> <p>matrix_r2c1 : 516</p> <p>matrix_r2c2 : 0</p> <p>input_bias_0 : 16</p> <p>input_bias_1 : 128</p> <p>input_bias_2 : 128</p> </td> <td class="cellrowborder" valign="top" width="25%"><p>matrix_r0c0 : 256</p> <p>matrix_r0c1 : 0</p> <p>matrix_r0c2 : 359</p> <p>matrix_r1c0 : 256</p> <p>matrix_r1c1 : -88</p> <p>matrix_r1c2 : -183</p> <p>matrix_r2c0 : 256</p> <p>matrix_r2c1 : 454</p> <p>matrix_r2c2 : 0</p> <p>input_bias_0 : 0</p> <p>input_bias_1 : 128</p> <p>input_bias_2 : 128</p> </td> <td class="cellrowborder" valign="top" width="25%"><p>matrix_r0c0 : 298</p> <p>matrix_r0c1 : 0</p> <p>matrix_r0c2 : 460</p> <p>matrix_r1c0 : 298</p> <p>matrix_r1c1 : -55</p> <p>matrix_r1c2 : -137</p> <p>matrix_r2c0 : 298</p> <p>matrix_r2c1 : 541</p> <p>matrix_r2c2 : 0</p> <p>input_bias_0 : 16</p> <p>input_bias_1 : 128</p> <p>input_bias_2 : 128</p> </td> </tr>  </tbody></table></div> </div> </li><li>输入为YUV格式图片(YUV420/YUYV/YUV422SP/AYUV444)，模型训练集为BGR，不支持从YUV400到BGR的转换。 <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.7.11.2.1.1.5.1.1" valign="top" width="25%"><p>JPEG</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.7.11.2.1.1.5.1.2" valign="top" width="25%"><p>BT-601NARROW</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.7.11.2.1.1.5.1.3" valign="top" width="25%"><p>BT-601FULL</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.7.11.2.1.1.5.1.4" valign="top" width="25%"><p>BT-709NARROW</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="25%"><p>matrix_r0c0 : 256</p> <p>matrix_r0c1 : 454</p> <p>matrix_r0c2 : 0</p> <p>matrix_r1c0 : 256</p> <p>matrix_r1c1 : -88</p> <p>matrix_r1c2 : -183</p> <p>matrix_r2c0 : 256</p> <p>matrix_r2c1 : 0</p> <p>matrix_r2c2 : 359</p> <p>input_bias_0 : 0</p> <p>input_bias_1 : 128</p> <p>input_bias_2 : 128</p> </td> <td class="cellrowborder" valign="top" width="25%"><p>matrix_r0c0 : 298</p> <p>matrix_r0c1 : 516</p> <p>matrix_r0c2 : 0</p> <p>matrix_r1c0 : 298</p> <p>matrix_r1c1 : -100</p> <p>matrix_r1c2 : -208</p> <p>matrix_r2c0 : 298</p> <p>matrix_r2c1 : 0</p> <p>matrix_r2c2 : 409</p> <p>input_bias_0 : 16</p> <p>input_bias_1 : 128</p> <p>input_bias_2 : 128</p> </td> <td class="cellrowborder" valign="top" width="25%"><p>matrix_r0c0 : 256</p> <p>matrix_r0c1 : 454</p> <p>matrix_r0c2 : 0</p> <p>matrix_r1c0 : 256</p> <p>matrix_r1c1 : -88</p> <p>matrix_r1c2 : -183</p> <p>matrix_r2c0 : 256</p> <p>matrix_r2c1 : 0</p> <p>matrix_r2c2 : 359</p> <p>input_bias_0 : 0</p> <p>input_bias_1 : 128</p> <p>input_bias_2 : 128</p> </td> <td class="cellrowborder" valign="top" width="25%"><p>matrix_r0c0 : 298</p> <p>matrix_r0c1 : 541</p> <p>matrix_r0c2 : 0</p> <p>matrix_r1c0 : 298</p> <p>matrix_r1c1 : -55</p> <p>matrix_r1c2 : -137</p> <p>matrix_r2c0 : 298</p> <p>matrix_r2c1 : 0</p> <p>matrix_r2c2 : 460</p> <p>input_bias_0 : 16</p> <p>input_bias_1 : 128</p> <p>input_bias_2 : 128</p> </td> </tr>  </tbody></table></div> </div> </li><li>输入为YUV格式图片(YUV420/YUYV/YUV422SP/AYUV444)，模型训练集为灰度图（YUV400_U8）。 <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><tbody><tr><td class="cellrowborder" valign="top" width="100%"><p>matrix_r0c0 : 256</p> <p>matrix_r0c1 : 0</p> <p>matrix_r0c2 : 0</p> <p>matrix_r1c0 : 0</p> <p>matrix_r1c1 : 0</p> <p>matrix_r1c2 : 0</p> <p>matrix_r2c0 : 0</p> <p>matrix_r2c1 : 0</p> <p>matrix_r2c2 : 0</p> </td> </tr>  </tbody></table></div> </div> </li><li>输入为RGB格式图片(XRGB8888/ARGB8888)，模型训练集为灰度图（YUV400_U8）。 <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><tbody><tr><td class="cellrowborder" valign="top" width="100%"><p>matrix_r0c0 : 76</p> <p>matrix_r0c1 : 150</p> <p>matrix_r0c2 : 30</p> <p>matrix_r1c0 : 0</p> <p>matrix_r1c1 : 0</p> <p>matrix_r1c2 : 0</p> <p>matrix_r2c0 : 0</p> <p>matrix_r2c1 : 0</p> <p>matrix_r2c2 : 0</p> </td> </tr>  </tbody></table></div> </div> </li><li>输入为RGB格式图片(XRGB8888/ARGB8888)，模型训练集为YUV444SP。 <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.7.11.5.1.1.5.1.1" valign="top" width="25%"><p>JPEG</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.7.11.5.1.1.5.1.2" valign="top" width="25%"><p>BT-601NARROW</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.7.11.5.1.1.5.1.3" valign="top" width="25%"><p>BT-601FULL</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.7.11.5.1.1.5.1.4" valign="top" width="25%"><p>BT-709NARROW</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="25%"><p>matrix_r0c0 : 77</p> <p>matrix_r0c1 : 150</p> <p>matrix_r0c2 : 29</p> <p>matrix_r1c0 : -43</p> <p>matrix_r1c1 : -85</p> <p>matrix_r1c2 : 128</p> <p>matrix_r2c0 : 128</p> <p>matrix_r2c1 : -107</p> <p>matrix_r2c2 : -21</p> <p>output_bias_0 : 0</p> <p>output_bias_1 : 128</p> <p>output_bias_2 : 128</p> </td> <td class="cellrowborder" valign="top" width="25%"><p>matrix_r0c0 : 66</p> <p>matrix_r0c1 : 129</p> <p>matrix_r0c2 : 25</p> <p>matrix_r1c0 : -38</p> <p>matrix_r1c1 : -74</p> <p>matrix_r1c2 : 112</p> <p>matrix_r2c0 : 112</p> <p>matrix_r2c1 : -94</p> <p>matrix_r2c2 : -18</p> <p>output_bias_0 : 16</p> <p>output_bias_1 : 128</p> <p>output_bias_2 : 128</p> </td> <td class="cellrowborder" valign="top" width="25%"><p>matrix_r0c0 : 77</p> <p>matrix_r0c1 : 150</p> <p>matrix_r0c2 : 29</p> <p>matrix_r1c0 : -43</p> <p>matrix_r1c1 : -85</p> <p>matrix_r1c2 : 128</p> <p>matrix_r2c0 : 128</p> <p>matrix_r2c1 : -107</p> <p>matrix_r2c2 : -21</p> <p>output_bias_0 : 0</p> <p>output_bias_1 : 128</p> <p>output_bias_2 : 128</p> </td> <td class="cellrowborder" valign="top" width="25%"><p>matrix_r0c0 : 47</p> <p>matrix_r0c1 : 157</p> <p>matrix_r0c2 : 16</p> <p>matrix_r1c0 : -26</p> <p>matrix_r1c1 : -87</p> <p>matrix_r1c2 : 112</p> <p>matrix_r2c0 : 112</p> <p>matrix_r2c1 : -102</p> <p>matrix_r2c2 : -10</p> <p>output_bias_0 : 16</p> <p>output_bias_1 : 128</p> <p>output_bias_2 : 128</p> </td> </tr>  </tbody></table></div> </div> </li><li>输入为RGB格式图片(XRGB8888/ARGB8888)，模型训练集为YVU444SP。 <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.7.11.6.1.1.5.1.1" valign="top" width="25%"><p>JPEG</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.7.11.6.1.1.5.1.2" valign="top" width="25%"><p>BT-601NARROW</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.7.11.6.1.1.5.1.3" valign="top" width="25%"><p>BT-601FULL</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.7.11.6.1.1.5.1.4" valign="top" width="25%"><p>BT-709NARROW</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="25%"><p>matrix_r0c0 : 77</p> <p>matrix_r0c1 : 150</p> <p>matrix_r0c2 : 29</p> <p>matrix_r1c0 : 128</p> <p>matrix_r1c1 : -107</p> <p>matrix_r1c2 : -21</p> <p>matrix_r2c0 : -43</p> <p>matrix_r2c1 : -85</p> <p>matrix_r2c2 : 128</p> <p>output_bias_0 : 0</p> <p>output_bias_1 : 128</p> <p>output_bias_2 : 128</p> </td> <td class="cellrowborder" valign="top" width="25%"><p>matrix_r0c0 : 66</p> <p>matrix_r0c1 : 129</p> <p>matrix_r0c2 : 25</p> <p>matrix_r1c0 : 112</p> <p>matrix_r1c1 : -94</p> <p>matrix_r1c2 : -18</p> <p>matrix_r2c0 : -38</p> <p>matrix_r2c1 : -74</p> <p>matrix_r2c2 : 112</p> <p>output_bias_0 : 16</p> <p>output_bias_1 : 128</p> <p>output_bias_2 : 128</p> </td> <td class="cellrowborder" valign="top" width="25%"><p>matrix_r0c0 : 77</p> <p>matrix_r0c1 : 150</p> <p>matrix_r0c2 : 29</p> <p>matrix_r1c0 : 128</p> <p>matrix_r1c1 : -107</p> <p>matrix_r1c2 : -21</p> <p>matrix_r2c0 : -43</p> <p>matrix_r2c1 : -85</p> <p>matrix_r2c2 : 128</p> <p>output_bias_0 : 0</p> <p>output_bias_1 : 128</p> <p>output_bias_2 : 128</p> </td> <td class="cellrowborder" valign="top" width="25%"><p>matrix_r0c0 : 47</p> <p>matrix_r0c1 : 157</p> <p>matrix_r0c2 : 16</p> <p>matrix_r1c0 : 112</p> <p>matrix_r1c1 : -102</p> <p>matrix_r1c2 : -10</p> <p>matrix_r2c0 : -26</p> <p>matrix_r2c1 : -87</p> <p>matrix_r2c2 : 112</p> <p>output_bias_0 : 16</p> <p>output_bias_1 : 128</p> <p>output_bias_2 : 128</p> </td> </tr>  </tbody></table></div> </div> </li></ul> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p>从使用的角度，将灰度图转成RGB没有意义，系统约束当输入格式配置为YUV400_U8时，不支持CSC。</p> </div></div></div> </div> <div class="tiledSection"><h3 id="section4757633132210">Resize<i class="anchor-icon anchor-icon-link" anchorid="section4757633132210" tips="复制节点链接"></i></h3><p class="msonormal">图片缩放参数及约束如下：</p>  <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.8.3.1.5.1.1" valign="top" width="16.76%"><p><strong>名称</strong></p> </th> <th align="left" class="cellrowborder" id="mcps1.3.8.3.1.5.1.2" valign="top" width="23.52%"><p><strong>描述</strong></p> </th> <th align="left" class="cellrowborder" id="mcps1.3.8.3.1.5.1.3" valign="top" width="27.01%"><p><strong>取值范围（静态）</strong></p> </th> <th align="left" class="cellrowborder" id="mcps1.3.8.3.1.5.1.4" valign="top" width="32.71%"><p><strong>取值范围（动态）</strong></p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="16.76%"><p>switch</p> </td> <td class="cellrowborder" valign="top" width="23.52%"><p>缩放使能开关</p> </td> <td class="cellrowborder" valign="top" width="27.01%"><p>false/true</p> </td> <td class="cellrowborder" valign="top" width="32.71%"><p>false/true</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="16.76%"><p>resize_input_w</p> </td> <td class="cellrowborder" valign="top" width="23.52%"><p>缩放前图像宽度</p> </td> <td class="cellrowborder" valign="top" width="27.01%"><p>[16, 4096]</p> </td> <td class="cellrowborder" valign="top" width="32.71%"><p>[16, 1280]</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="16.76%"><p>resize_input_h</p> </td> <td class="cellrowborder" valign="top" width="23.52%"><p>缩放前图像高度</p> </td> <td class="cellrowborder" valign="top" width="27.01%"><p>[16, 4096]</p> </td> <td class="cellrowborder" valign="top" width="32.71%"><p>[16, 4096]</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="16.76%"><p>resize_output_w</p> </td> <td class="cellrowborder" valign="top" width="23.52%"><p>缩放后图像宽度</p> </td> <td class="cellrowborder" valign="top" width="27.01%"><p>[16, 1280]</p> </td> <td class="cellrowborder" valign="top" width="32.71%"><p>[16, 448]</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="16.76%"><p>resize_output_h</p> </td> <td class="cellrowborder" valign="top" width="23.52%"><p>缩放后图像高度</p> </td> <td class="cellrowborder" valign="top" width="27.01%"><p>[16, 4096]</p> </td> <td class="cellrowborder" valign="top" width="32.71%"><p>[16, 4096]</p> </td> </tr>  </tbody></table></div> </div> <p>图片缩放倍数约束如下：</p>  <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.8.5.1.4.1.1" valign="top" width="33.33333333333333%"><p>名称</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.8.5.1.4.1.2" valign="top" width="33.33333333333333%"><p>描述</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.8.5.1.4.1.3" valign="top" width="33.33333333333333%"><p>范围（动态&amp;静态）</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="33.33333333333333%"><p>resize_output_w / resize_input_w</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p>图像宽度缩放倍数</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p>[1/16, 16]</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="33.33333333333333%"><p>resize_output_h / resize_input_h</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p>图像高度缩放倍数</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p>[1/16, 16]</p> </td> </tr>  </tbody></table></div> </div> <p>Resize类型为双线性插值。Resize子功能的<span class="parmvalue">“resize_input_w”</span>和<span class="parmvalue">“resize_input_h”</span>两个参数对开发者不可见。</p> <ul><li>当Crop功能关闭时，图片缩放前的大小取输入图片的大小。</li><li>当Crop功能打开时，因为AIPP的Resize处理总是在Crop之后，图片缩放前的大小取图片裁剪后的大小。配置时，只需要关心缩放后的大小即可。</li></ul> <p>通过配置文件转换静态AIPP模型时，Crop之后的大小<span class="parmvalue">“crop_size_w”</span>和<span class="parmvalue">“crop_size_h”</span>，以及Resize之后的大小<span class="parmvalue">“resize_output_w”</span>和<span class="parmvalue">“resize_output_h”</span>可以省去不配置，前提是这两个参数可以通过计算获取。省略<span class="parmvalue">“resize_output_w”</span>和<span class="parmvalue">“resize_output_h”</span>时，Resize功能这两个值取模型训练集的图片尺寸减去AIPP Padding之后的结果；当Resize不使用时，同理可省略Crop功能<span class="parmvalue">“crop_size_w”</span>和<span class="parmvalue">“crop_size_h”</span>。</p> </div> <div class="tiledSection"><h3 id="section12331181152317">Data Type Conversion<i class="anchor-icon anchor-icon-link" anchorid="section12331181152317" tips="复制节点链接"></i></h3><p class="msonormalindent">数据类型转换（Data Type Conversion，以下简称DTC），DTC用于将输入图片中像素值转换为模型训练时的数据类型。AIPP允许开发者设置DTC参数，使得转换之后的数据在一个预期的范围，避免强制转换。</p> <p class="msonormalindent">将Uint8类型的数据转换为Int8类型的数据，计算规则如下：</p> <p class="msonormalindent">pixel_out_chx(i) = pixel_in_chx(i)-mean_chn_i</p> <p class="msonormalindent">将Uint8类型的数据转换为Float16类型的数据，计算规则如下：</p> <p class="msonormalindent">pixel_out_chx(i) = [pixel_in_chx(i)-mean_chn_i-min_chn_i] * var_reci_chn</p> <p class="msonormal">DTC涉及的配置参数如下表。</p>  <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.9.8.1.4.1.1" valign="top" width="21.92%"><p><strong>名称</strong></p> </th> <th align="left" class="cellrowborder" id="mcps1.3.9.8.1.4.1.2" valign="top" width="30.520000000000003%"><p><strong>描述</strong></p> </th> <th align="left" class="cellrowborder" id="mcps1.3.9.8.1.4.1.3" valign="top" width="47.56%"><p><strong>取值范围</strong></p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="21.92%"><p>switch</p> </td> <td class="cellrowborder" valign="top" width="30.520000000000003%"><p>DTC使能开关。</p> </td> <td class="cellrowborder" valign="top" width="47.56%"><p>false/true</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="21.92%"><p>mean_chn_0</p> </td> <td class="cellrowborder" valign="top" width="30.520000000000003%"><p>通道0均值。</p> </td> <td class="cellrowborder" valign="top" width="47.56%"><p>[0, 255]</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="21.92%"><p>mean_chn_1</p> </td> <td class="cellrowborder" valign="top" width="30.520000000000003%"><p>通道1均值。</p> </td> <td class="cellrowborder" valign="top" width="47.56%"><p>[0, 255]</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="21.92%"><p>mean_chn_2</p> </td> <td class="cellrowborder" valign="top" width="30.520000000000003%"><p>通道2均值。</p> </td> <td class="cellrowborder" valign="top" width="47.56%"><p>[0, 255]</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="21.92%"><p>mean_chn_3</p> </td> <td class="cellrowborder" valign="top" width="30.520000000000003%"><p>通道3均值。</p> </td> <td class="cellrowborder" valign="top" width="47.56%"><p>[0, 255]</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="21.92%"><p>min_chn_0</p> </td> <td class="cellrowborder" valign="top" width="30.520000000000003%"><p>通道0最小值。</p> </td> <td class="cellrowborder" valign="top" width="47.56%"><p>[-65504, 65504]</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="21.92%"><p>min_chn_1</p> </td> <td class="cellrowborder" valign="top" width="30.520000000000003%"><p>通道1最小值。</p> </td> <td class="cellrowborder" valign="top" width="47.56%"><p>[-65504, 65504]</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="21.92%"><p>min_chn_2</p> </td> <td class="cellrowborder" valign="top" width="30.520000000000003%"><p>通道2最小值。</p> </td> <td class="cellrowborder" valign="top" width="47.56%"><p>[-65504, 65504]</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="21.92%"><p>min_chn_3</p> </td> <td class="cellrowborder" valign="top" width="30.520000000000003%"><p>通道3最小值。</p> </td> <td class="cellrowborder" valign="top" width="47.56%"><p>[-65504, 65504]</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="21.92%"><p>var_reci_chn_0</p> </td> <td class="cellrowborder" valign="top" width="30.520000000000003%"><p>通道0方差。</p> </td> <td class="cellrowborder" valign="top" width="47.56%"><p>[-65504, 65504]</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="21.92%"><p>var_reci_chn_1</p> </td> <td class="cellrowborder" valign="top" width="30.520000000000003%"><p>通道1方差。</p> </td> <td class="cellrowborder" valign="top" width="47.56%"><p>[-65504, 65504]</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="21.92%"><p>var_reci_chn_2</p> </td> <td class="cellrowborder" valign="top" width="30.520000000000003%"><p>通道2方差。</p> </td> <td class="cellrowborder" valign="top" width="47.56%"><p>[-65504, 65504]</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="21.92%"><p>var_reci_chn_3</p> </td> <td class="cellrowborder" valign="top" width="30.520000000000003%"><p>通道3方差。</p> </td> <td class="cellrowborder" valign="top" width="47.56%"><p>[-65504, 65504]</p> </td> </tr>  </tbody></table></div> </div> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p>当DTC开关为false时，或者开发者调用CANN Kit接口未传入DTC参数时，系统默认对图片输入数据进行类型强转，效果同通道均值和最小值均为0，通道方差为1。</p> </div></div></div> </div> <div class="tiledSection"><h3 id="section127618563124">Rotation<i class="anchor-icon anchor-icon-link" anchorid="section127618563124" tips="复制节点链接"></i></h3><p class="msonormal">AIPP的Rotation功能用于对输入图片进行旋转，涉及的参数如下：</p>  <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.10.3.1.4.1.1" valign="top" width="21.917808219178085%"><p><strong>名称</strong></p> </th> <th align="left" class="cellrowborder" id="mcps1.3.10.3.1.4.1.2" valign="top" width="27.43725627437256%"><p><strong>描述</strong></p> </th> <th align="left" class="cellrowborder" id="mcps1.3.10.3.1.4.1.3" valign="top" width="50.64493550644935%"><p><strong>取值范围</strong></p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="21.917808219178085%"><p>switch</p> </td> <td class="cellrowborder" valign="top" width="27.43725627437256%"><p>Rotation使能开关</p> </td> <td class="cellrowborder" valign="top" width="50.64493550644935%"><p>false/true</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="21.917808219178085%"><p>rotation_angle</p> </td> <td class="cellrowborder" valign="top" width="27.43725627437256%"><p>图像旋转角度</p> </td> <td class="cellrowborder" valign="top" width="50.64493550644935%"><p>[0, 90, 180, 270]</p> </td> </tr>  </tbody></table></div> </div> </div> <div class="tiledSection"><h3 id="section03997455233">Padding<i class="anchor-icon anchor-icon-link" anchorid="section03997455233" tips="复制节点链接"></i></h3><p class="msonormal">AIPP的Padding功能用于对输入图片进行补边，涉及的参数如下。</p>  <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.11.3.1.4.1.1" valign="top" width="21.917808219178085%"><p><strong>名称</strong></p> </th> <th align="left" class="cellrowborder" id="mcps1.3.11.3.1.4.1.2" valign="top" width="27.43725627437256%"><p><strong>描述</strong></p> </th> <th align="left" class="cellrowborder" id="mcps1.3.11.3.1.4.1.3" valign="top" width="50.64493550644935%"><p><strong>取值范围</strong></p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="21.917808219178085%"><p>switch</p> </td> <td class="cellrowborder" valign="top" width="27.43725627437256%"><p>Padding使能开关。</p> </td> <td class="cellrowborder" valign="top" width="50.64493550644935%"><p>false/true</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="21.917808219178085%"><p>left_padding_size</p> </td> <td class="cellrowborder" valign="top" width="27.43725627437256%"><p>图像左侧Padding像素数。</p> </td> <td class="cellrowborder" valign="top" width="50.64493550644935%"><p>-</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="21.917808219178085%"><p>right_padding_size</p> </td> <td class="cellrowborder" valign="top" width="27.43725627437256%"><p>图像右侧Padding像素数。</p> </td> <td class="cellrowborder" valign="top" width="50.64493550644935%"><p>-</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="21.917808219178085%"><p>top_padding_size</p> </td> <td class="cellrowborder" valign="top" width="27.43725627437256%"><p>图像上侧Padding像素数。</p> </td> <td class="cellrowborder" valign="top" width="50.64493550644935%"><p>-</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="21.917808219178085%"><p>bottom_padding_size</p> </td> <td class="cellrowborder" valign="top" width="27.43725627437256%"><p>图像下侧Padding像素数。</p> </td> <td class="cellrowborder" valign="top" width="50.64493550644935%"><p>-</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="21.917808219178085%"><p>padding_value_chn_0</p> </td> <td class="cellrowborder" valign="top" width="27.43725627437256%"><p>通道0 Padding的值。</p> </td> <td class="cellrowborder" valign="top" width="50.64493550644935%"><p>[-65504, 65504]</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="21.917808219178085%"><p>padding_value_chn_1</p> </td> <td class="cellrowborder" valign="top" width="27.43725627437256%"><p>通道1 Padding的值。</p> </td> <td class="cellrowborder" valign="top" width="50.64493550644935%"><p>[-65504, 65504]</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="21.917808219178085%"><p>padding_value_chn_2</p> </td> <td class="cellrowborder" valign="top" width="27.43725627437256%"><p>通道2 Padding的值。</p> </td> <td class="cellrowborder" valign="top" width="50.64493550644935%"><p>[-65504, 65504]</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="21.917808219178085%"><p>padding_value_chn_3</p> </td> <td class="cellrowborder" valign="top" width="27.43725627437256%"><p>通道3 Padding的值。</p> </td> <td class="cellrowborder" valign="top" width="50.64493550644935%"><p>[-65504, 65504]</p> </td> </tr>  </tbody></table></div> </div> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><ul><li>上下左右的Padding值不要超过32，如果Padding值过大，AIPP将使用软件代码进行处理，效率低于硬件实现。</li><li>padding_value_chn_0~padding_value_chn_3暂不支持。</li></ul> </div></div></div> </div> </div> <div></div></div>