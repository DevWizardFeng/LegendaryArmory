<h1 _ngcontent-rxh-c119="" class="doc-title ng-star-inserted" title="AIPP部署"> AIPP部署 </h1>

<div _ngcontent-rxh-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div><div class="tiledSection"><h2 id="section12697121616460">基本概念<i class="anchor-icon anchor-icon-link" anchorid="section12697121616460" tips="复制节点链接"></i></h2><p>AIPP部署是指动态AIPP推理时开发者按需配置动态AIPP参数，从而达到使能AIPP功能。</p> </div> <div class="tiledSection"><h2 id="section1490815544715">业务流程<i class="anchor-icon anchor-icon-link" anchorid="section1490815544715" tips="复制节点链接"></i></h2><p><span><img height="40.8975" originheight="411" originwidth="5207" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114239.00500986795047257117509356358774:50001231000000:2800:CDB6002CEA8C8854F24F8566014449C9A718CA9F865EB10C3BF7F5228166DFB1.png" title="点击放大" width="523.6875"></span></p> </div> <div class="tiledSection"><h2 id="section23511351184819">接口说明<i class="anchor-icon anchor-icon-link" anchorid="section23511351184819" tips="复制节点链接"></i></h2><p>以下接口为AIPP参数设置接口，如要使用更丰富的设置和查询接口，请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/cannkit" target="_blank">API参考</a>。</p>  <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><caption><b>表1 </b>CANN Kit模型推理AIPP设置相关接口功能介绍</caption><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.3.3.2.3.1.1" valign="top" width="49.95%"><p>接口名</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.3.3.2.3.1.2" valign="top" width="50.05%"><p>描述</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="49.95%"><p>HiAI_AippParam* HMS_HiAIAippParam_Create(uint32_t batchNum);</p> </td> <td class="cellrowborder" valign="top" width="50.05%"><p>动态AIPP配置实例创建。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="49.95%"><p>void HMS_HiAIAippParam_Destroy(HiAI_AippParam** aippParam);</p> </td> <td class="cellrowborder" valign="top" width="50.05%"><p>动态AIPP配置实例销毁。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="49.95%"><p>OH_NN_ReturnCode HMS_HiAIAippParam_SetInputIndex(HiAI_AippParam* aippParam, uint32_t inputIndex);</p> </td> <td class="cellrowborder" valign="top" width="50.05%"><p>设置动态AIPP配置作用于输入上的索引。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="49.95%"><p>OH_NN_ReturnCode HMS_HiAIAippParam_SetInputAippIndex(HiAI_AippParam* aippParam, uint32_t inputAippIndex);</p> </td> <td class="cellrowborder" valign="top" width="50.05%"><p>设置动态AIPP配置作用于该输入的多个输出分支上的索引。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="49.95%"><p>OH_NN_ReturnCode HMS_HiAIAippParam_SetInputFormat(HiAI_AippParam* aippParam, HiAI_ImageFormat inputFormat);</p> </td> <td class="cellrowborder" valign="top" width="50.05%"><p>设置输入图片的格式。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="49.95%"><p>OH_NN_ReturnCode HMS_HiAIAippParam_SetInputShape(HiAI_AippParam* aippParam, uint32_t srcImageW, uint32_t srcImageH);</p> </td> <td class="cellrowborder" valign="top" width="50.05%"><p>设置输入图片的原始宽高。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="49.95%"><p>OH_NN_ReturnCode HMS_HiAIAippParam_SetCscConfig(HiAI_AippParam* aippParam, HiAI_ImageFormat inputFormat, HiAI_ImageFormat outputFormat, HiAI_ImageColorSpace space);</p> </td> <td class="cellrowborder" valign="top" width="50.05%"><p>设置图片色域转换参数。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="49.95%"><p>OH_NN_ReturnCode HMS_HiAIAippParam_SetChannelSwapConfig(HiAI_AippParam* aippParam, bool rbuvSwapSwitch, bool axSwapSwitch);</p> </td> <td class="cellrowborder" valign="top" width="50.05%"><p>设置图片通道交换参数。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="49.95%"><p>OH_NN_ReturnCode HMS_HiAIAippParam_SetCropConfig(HiAI_AippParam* aippParam, uint32_t batchIndex, uint32_t startPosW, uint32_t startPosH, uint32_t croppedW, uint32_t croppedH);</p> </td> <td class="cellrowborder" valign="top" width="50.05%"><p>设置图片裁剪参数。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="49.95%"><p>OH_NN_ReturnCode HMS_HiAIAippParam_SetResizeConfig(HiAI_AippParam* aippParam, uint32_t batchIndex, uint32_t resizedW, uint32_t resizedH);</p> </td> <td class="cellrowborder" valign="top" width="50.05%"><p>设置图片缩放大小参数。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="49.95%"><p>OH_NN_ReturnCode HMS_HiAIAippParam_SetPadConfig(HiAI_AippParam* aippParam, uint32_t batchIndex, uint32_t leftPadSize, uint32_t rightPadSize, uint32_t topPadSize, uint32_t bottomPadSize);</p> </td> <td class="cellrowborder" valign="top" width="50.05%"><p>设置图片左右上下填充的像素数。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="49.95%"><p>OH_NN_ReturnCode HMS_HiAIAippParam_SetChannelPadding(HiAI_AippParam* aippParam, uint32_t batchIndex, uint32_t paddingValues[], uint32_t channelCount);</p> </td> <td class="cellrowborder" valign="top" width="50.05%"><p>设置通道填充值。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="49.95%"><p>OH_NN_ReturnCode HMS_HiAIAippParam_SetRotationAngle(HiAI_AippParam* aippParam, uint32_t batchIndex, float rotationAngle);</p> </td> <td class="cellrowborder" valign="top" width="50.05%"><p>设置图片旋转参数。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="49.95%"><p>OH_NN_ReturnCode HMS_HiAIAippParam_SetDtcMeanPixel(HiAI_AippParam* aippParam, uint32_t batchIndex, uint32_t meanPixel[], uint32_t channelCount);</p> </td> <td class="cellrowborder" valign="top" width="50.05%"><p>设置图片数据类型转换的通道像素平均值。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="49.95%"><p>OH_NN_ReturnCode HMS_HiAIAippParam_SetDtcMinPixel(HiAI_AippParam* aippParam, uint32_t batchIndex, float minPixel[], uint32_t channelCount);</p> </td> <td class="cellrowborder" valign="top" width="50.05%"><p>设置图片数据类型转换的通道像素最小值。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="49.95%"><p>OH_NN_ReturnCode HMS_HiAIAippParam_SetDtcVarReciPixel(HiAI_AippParam* aippParam, uint32_t batchIndex, float varReciPixel[], uint32_t channelCount);</p> </td> <td class="cellrowborder" valign="top" width="50.05%"><p>设置图片数据类型转换的通道像素方差。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="49.95%"><p>OH_NN_ReturnCode HMS_HiAITensor_SetAippParams(NN_Tensor* tensor, HiAI_AippParam* aippParams[], size_t aippNum);</p> </td> <td class="cellrowborder" valign="top" width="50.05%"><p>给输入Tensor设置AIPP参数。</p> </td> </tr>  </tbody></table></div> </div> </div> <div class="tiledSection"><h2 id="section11809144217273">开发步骤<i class="anchor-icon anchor-icon-link" anchorid="section11809144217273" tips="复制节点链接"></i></h2><ol><li><span>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/cannkit#hms_hiaiaippparam_create" target="_blank">HMS_HiAIAippParam_Create</a>创建动态AIPP配置实例。</span></li></ol><ol start="2"><li><span>设置与计算图关联的配置。</span><p></p><ul><li>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/cannkit#hms_hiaiaippparam_setinputindex" target="_blank">HMS_HiAIAippParam_SetInputIndex</a>设置此动态AIPP配置所在输入的索引。</li><li>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/cannkit#hms_hiaiaippparam_setinputaippindex" target="_blank">HMS_HiAIAippParam_SetInputAippIndex</a>设置此动态AIPP配置所在某个输入的输出分支索引。</li></ul> <p></p></li><li><span>设置动态AIPP输入图片相关配置。</span><p></p><ul><li>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/cannkit#hms_hiaiaippparam_setinputformat" target="_blank">HMS_HiAIAippParam_SetInputFormat</a>设置输入图片的格式。</li><li>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/cannkit#hms_hiaiaippparam_setinputshape" target="_blank">HMS_HiAIAippParam_SetInputShape</a>设置输入图片原始宽高。</li></ul> <p></p></li><li><span>开发者按需设置以下动态AIPP功能参数。</span><p></p><ul><li>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/cannkit#hms_hiaiaippparam_setchannelswapconfig" target="_blank">HMS_HiAIAippParam_SetChannelSwapConfig</a>设置通道交换参数。</li><li>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/cannkit#hms_hiaiaippparam_setcscconfig" target="_blank">HMS_HiAIAippParam_SetCscConfig</a>设置图片色域转换参数。</li><li>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/cannkit#hms_hiaiaippparam_setcropconfig" target="_blank">HMS_HiAIAippParam_SetCropConfig</a>设置图片裁剪参数。</li><li>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/cannkit#hms_hiaiaippparam_setresizeconfig" target="_blank">HMS_HiAIAippParam_SetResizeConfig</a>设置图片缩放大小参数。</li><li>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/cannkit#hms_hiaiaippparam_setpadconfig" target="_blank">HMS_HiAIAippParam_SetPadConfig</a>设置图片填充大小参数。</li><li>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/cannkit#hms_hiaiaippparam_setchannelpadding" target="_blank">HMS_HiAIAippParam_SetChannelPadding</a>设置各通道上的填充值参数。</li><li>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/cannkit#hms_hiaiaippparam_setrotationangle" target="_blank">HMS_HiAIAippParam_SetRotationAngle</a>设置旋转角度。</li><li>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/cannkit#hms_hiaiaippparam_setdtcmeanpixel" target="_blank">HMS_HiAIAippParam_SetDtcMeanPixel</a>设置数据类型转换通道像素平均值。</li><li>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/cannkit#hms_hiaiaippparam_setdtcminpixel" target="_blank">HMS_HiAIAippParam_SetDtcMinPixel</a>设置数据类型转换通道像素最小值。</li><li>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/cannkit#hms_hiaiaippparam_setdtcvarrecipixel" target="_blank">HMS_HiAIAippParam_SetDtcVarReciPixel</a>设置数据类型转换通道像素方差。</li></ul> <p></p></li><li><span>将AIPP配置设置到<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-neuralnetworkruntime-nn-tensor" target="_blank">NN_Tensor</a>。</span><p></p><p>通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/cannkit-model-inference#li10555614927">构造输入输出Tensor</a>后，调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/cannkit#hms_hiaitensor_setaippparams" target="_blank">HMS_HiAITensor_SetAippParams</a>给输入Tensor设置AIPP参数。</p> <p></p></li><li><span><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/cannkit-model-inference#li510118171220">执行模型推理</a>。</span></li><li><span>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/cannkit#hms_hiaiaippparam_destroy" target="_blank">HMS_HiAIAippParam_Destroy</a>销毁动态AIPP配置实例。</span></li></ol> </div> <div class="tiledSection"><h2 id="section1986510369322">示例说明<i class="anchor-icon anchor-icon-link" anchorid="section1986510369322" tips="复制节点链接"></i></h2><p>假定当前有一个模型，训练时采用的训练集为RGB888的图片，使能了动态AIPP之后，可以接收YUYV类型的图片作为模型推理的输入。当用于模型推理的图片尺寸与训练集不一致时，还可以使用AIPP的裁剪、缩放和填充功能，改变输入图片尺寸。以下示例代码基于NDK接口，实现AIPP的裁剪、缩放和填充等功能，将一张YUYV尺寸为480x480的图片预处理为224x224的输入。</p> <div _ngcontent-rxh-c106="" class="highlight-div"><div _ngcontent-rxh-c106="" class="highlight-div-header"><div _ngcontent-rxh-c106="" class="highlight-div-header-left"><div _ngcontent-rxh-c106="" class="handle-button expand-button"><div _ngcontent-rxh-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rxh-c106="" class="highlight-div-header-right"><div _ngcontent-rxh-c106="" class="handle-button ai-button"></div><div _ngcontent-rxh-c106="" class="handle-button line-button"><div _ngcontent-rxh-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rxh-c106="" class="handle-button theme-button"><div _ngcontent-rxh-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rxh-c106="" class="handle-button copy-button"><div _ngcontent-rxh-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rxh-c106="" class="highlight-scroll-div"><pre class="cpp prettyprint linenums hljs language-cpp" hw-language="cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"neural_network_runtime/neural_network_core.h"</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"CANNKit/hiai_aipp_param.h"</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"CANNKit/hiai_tensor.h"</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span></li><li>
</li><li><span class="hljs-keyword">constexpr</span> <span class="hljs-type">uint32_t</span> BATCH_NUM = <span class="hljs-number">1</span>;</li><li><span class="hljs-comment">// 创建一个batch数为1的动态aipp配置实例</span></li><li>HiAI_AippParam* aippPara = <span class="hljs-built_in">HMS_HiAIAippParam_Create</span>(BATCH_NUM);</li><li><span class="hljs-comment">// 在多个输入情况下，设置索引以确定该AippParam对象作用于第几个输入</span></li><li><span class="hljs-type">uint32_t</span> inputIndex = <span class="hljs-number">0</span>;</li><li>OH_NN_ReturnCode ret = <span class="hljs-built_in">HMS_HiAIAippParam_SetInputIndex</span>(aippPara, inputIndex);</li><li><span class="hljs-comment">// 在data有多个输出分支时，设置AippParam对象作用域该输入的第几个输出分支</span></li><li><span class="hljs-type">uint32_t</span> validInputAippIndex = <span class="hljs-number">0</span>;</li><li><span class="hljs-built_in">HMS_HiAIAippParam_SetInputAippIndex</span>(aippPara, validInputAippIndex);</li><li><span class="hljs-comment">// 设置AippParam对象的输入图像格式</span></li><li><span class="hljs-built_in">HMS_HiAIAippParam_SetInputFormat</span>(aippPara, HIAI_YUV420SP_U8);</li><li><span class="hljs-comment">// 设置AippParam对象的输入图像宽高</span></li><li><span class="hljs-built_in">HMS_HiAIAippParam_SetInputShape</span>(aippPara, <span class="hljs-number">224</span>, <span class="hljs-number">224</span>);</li><li><span class="hljs-comment">// 设置AippParam对象的CSC色域转换参数</span></li><li><span class="hljs-built_in">HMS_HiAIAippParam_SetCscConfig</span>(aippPara, HIAI_YUV420SP_U8, HIAI_RGB888_U8, HIAI_JPEG);</li><li><span class="hljs-comment">// 设置AippParam对象RB/UV通道交换</span></li><li><span class="hljs-built_in">HMS_HiAIAippParam_SetChannelSwapConfig</span>(aippPara, <span class="hljs-literal">true</span>, <span class="hljs-literal">false</span>);</li><li><span class="hljs-comment">// 设置AippParam对象第0个索引batch的crop参数</span></li><li><span class="hljs-built_in">HMS_HiAIAippParam_SetCropConfig</span>(aippPara, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">100</span>, <span class="hljs-number">100</span>);</li><li><span class="hljs-comment">// 设置AippParam对象第0个索引batch的resize参数</span></li><li><span class="hljs-built_in">HMS_HiAIAippParam_SetResizeConfig</span>(aippPara, <span class="hljs-number">0</span>, <span class="hljs-number">110</span>, <span class="hljs-number">110</span>);</li><li><span class="hljs-comment">// 设置AippParam对象第0个索引batch的通道padding填充值</span></li><li><span class="hljs-built_in">HMS_HiAIAippParam_SetPadConfig</span>(aippPara, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>);</li><li><span class="hljs-comment">// 设置AippParam对象第0个索引batch的旋转角度</span></li><li><span class="hljs-built_in">HMS_HiAIAippParam_SetRotationAngle</span>(aippPara, <span class="hljs-number">0</span>, <span class="hljs-number">90.0</span>);</li><li><span class="hljs-comment">// 设置AippParam对象第0个batch的数据类型转换通道像素平均值</span></li><li><span class="hljs-keyword">constexpr</span> <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> chnNum = <span class="hljs-number">4</span>;</li><li><span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> pixelMeanPara[chnNum] = {<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>};</li><li><span class="hljs-built_in">HMS_HiAIAippParam_SetDtcMeanPixel</span>(aippPara, <span class="hljs-number">0</span>, pixelMeanPara, chnNum);</li><li>
</li><li><span class="hljs-comment">// 准备输入Tensor</span></li><li><span class="hljs-type">size_t</span> inputCount = <span class="hljs-number">0</span>;</li><li>ret = <span class="hljs-built_in">OH_NNExecutor_GetInputCount</span>(executor, &amp;inputCount); <span class="hljs-comment">// 创建executor可参考</span><a href="https://developer.huawei.com/consumer/cn/codelabsPortal/carddetails/tutorials_CANNKit-Image-classification" target="_blank"><span class="hljs-comment">CANN Kit Codelab</span></a></li><li>std::vector&lt;NN_Tensor *&gt; inputTensors;</li><li><span class="hljs-keyword">for</span> (<span class="hljs-type">size_t</span> i = <span class="hljs-number">0</span>; i &lt; inputCount; ++i) {</li><li>    <span class="hljs-comment">// 创建executor可参考</span><a href="https://developer.huawei.com/consumer/cn/codelabsPortal/carddetails/tutorials_CANNKit-Image-classification" target="_blank"><span class="hljs-comment">CANN Kit Codelab</span></a></li><li>    NN_TensorDesc* desc = <span class="hljs-built_in">OH_NNExecutor_CreateInputTensorDesc</span>(executor, i);</li><li>    NN_Tensor* tensor = <span class="hljs-built_in">OH_NNTensor_Create</span>(deviceID, desc); <span class="hljs-comment">// 获取deviceID可参考</span><a href="https://developer.huawei.com/consumer/cn/codelabsPortal/carddetails/tutorials_CANNKit-Image-classification" target="_blank"><span class="hljs-comment">CANN Kit Codelab</span></a></li><li>    inputTensors.<span class="hljs-built_in">push_back</span>(tensor);</li><li>}</li><li><span class="hljs-comment">// 准备aipp输入Tensor</span></li><li>HiAI_AippParam* aippParas[<span class="hljs-number">1</span>] = {aippPara};</li><li>NN_Tensor* tensor = <span class="hljs-literal">nullptr</span>;</li><li>ret = <span class="hljs-built_in">HMS_HiAITensor_SetAippParams</span>(tensor, aippParas, <span class="hljs-number">1</span>);</li><li><span class="hljs-keyword">if</span> (ret != OH_NN_SUCCESS ) {</li><li>    <span class="hljs-keyword">return</span>;</li><li>}</li><li>inputTensors.<span class="hljs-built_in">push_back</span>(tensor);</li><li>
</li><li><span class="hljs-comment">// 准备输出Tensor</span></li><li><span class="hljs-type">size_t</span> outputCount = <span class="hljs-number">0</span>;</li><li>ret = <span class="hljs-built_in">OH_NNExecutor_GetOutputCount</span>(executor, &amp;outputCount); <span class="hljs-comment">// 创建executor可参考</span><a href="https://developer.huawei.com/consumer/cn/codelabsPortal/carddetails/tutorials_CANNKit-Image-classification" target="_blank"><span class="hljs-comment">CANN Kit Codelab</span></a></li><li>std::vector&lt;NN_Tensor *&gt; outputTensors;</li><li><span class="hljs-keyword">for</span> (<span class="hljs-type">size_t</span> i = <span class="hljs-number">0</span>; i &lt; outputCount; i++) {</li><li>    NN_TensorDesc* desc = <span class="hljs-built_in">OH_NNExecutor_CreateOutputTensorDesc</span>(executor, i); <span class="hljs-comment">// 创建executor可参考</span><a href="https://developer.huawei.com/consumer/cn/codelabsPortal/carddetails/tutorials_CANNKit-Image-classification" target="_blank"><span class="hljs-comment">CANN Kit Codelab</span></a></li><li>    NN_Tensor* tensor = <span class="hljs-built_in">OH_NNTensor_Create</span>(deviceID, desc); <span class="hljs-comment">// 获取deviceID可参考</span><a href="https://developer.huawei.com/consumer/cn/codelabsPortal/carddetails/tutorials_CANNKit-Image-classification" target="_blank"><span class="hljs-comment">CANN Kit Codelab</span></a></li><li>    outputTensors.<span class="hljs-built_in">push_back</span>(tensor);</li><li>}</li><li><span class="hljs-comment">// 执行推理</span></li><li>ret = <span class="hljs-built_in">OH_NNExecutor_RunSync</span>(executor_, inputTensors.<span class="hljs-built_in">data</span>(), <span class="hljs-number">1</span>, outputTensors.<span class="hljs-built_in">data</span>(), <span class="hljs-number">1</span>);</li><li><span class="hljs-keyword">if</span> (ret != OH_NN_SUCCESS ) {</li><li>    <span class="hljs-keyword">return</span>;</li><li>}</li><li><span class="hljs-keyword">if</span> (aippPara != <span class="hljs-literal">nullptr</span>) {</li><li>    <span class="hljs-built_in">HMS_HiAIAippParam_Destroy</span>(&amp;aippPara);</li><li>}</li></ol></pre></div></div> </div> </div> <div></div></div>