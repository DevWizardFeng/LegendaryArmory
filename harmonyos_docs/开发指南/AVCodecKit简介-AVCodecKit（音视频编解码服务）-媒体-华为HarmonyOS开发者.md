<h1 _ngcontent-ank-c119="" class="doc-title ng-star-inserted" title="AVCodec Kit简介"> AVCodec Kit简介 </h1>

<div _ngcontent-ank-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p>AVCodec Kit（Audio &amp; Video Codec Kit，音视频编解码，封装解析）是媒体系统中的音视频的编解码、媒体文件的解析、封装、媒体数据输入等原子能力。</p>    <p>基于性能考虑，AVCodec Kit仅提供C接口。</p>    <div class="tiledSection">     <h2 id="能力范围">能力范围<i class="anchor-icon anchor-icon-link" anchorid="能力范围" tips="复制节点链接"></i></h2>          <ul>      <li>媒体数据输入：媒体应用可以传入文件fd、或者流媒体url，进行后续的媒体信息解析等处理。</li>      <li>媒体基础能力（Media Foundation）：提供媒体数据处理的公共基础类型，包括<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-native-avbuffer-h" target="_blank">AVBuffer</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-native-avformat-h" target="_blank">AVFormat</a>等。</li>      <li>音频编码：音频类应用（比如音频通话、音频录制等）可以将未压缩的音频数据送到音频编码器进行编码，应用可以设置编码要用到的编码格式、码率、采样率等参数，控制编码的输出，达到压缩音频文件的目的。</li>      <li>视频编码：视频类应用（比如视频通话、视频录制等）可以将未压缩的视频数据送到视频编码器进行编码，应用可以设置编码要用到的编码格式、码率、帧率等参数，控制编码的输出，达到压缩视频文件的目的。</li>      <li>音频解码：音频类应用（比如音频通话、音频播放器等）将音频码流通过音频解码器解码，解码后的数据可以送到音频设备播放。</li>      <li>视频解码：视频类应用（比如视频通话、视频播放器等）将视频码流通过视频解码器解码，解码后的图像数据可以送到视频显示设备显示。</li>      <li>媒体文件解析：在媒体应用（音视频播放器等），将本地或者网络接收到的媒体文件解析，获得音视频的码流、音视频的呈现时间、编码格式、文件的一些基本属性信息等。</li>      <li>媒体文件封装：在媒体应用（音视频录制等），将音视频编码器编码后的码流数据封装成媒体文件（mp4、m4a），将音视频的码流、音视频的呈现时间、编码格式、文件的一些基本属性信息等按照文件格式写入应用指定的文件中。</li>     </ul>    </div>    <div class="tiledSection">     <h2 id="亮点特征">亮点/特征<i class="anchor-icon anchor-icon-link" anchorid="亮点特征" tips="复制节点链接"></i></h2>          <ul>      <li>系统内部数据零拷贝：在视频解码过程，AVCodec通过回调函数提供AVBuffer给应用，由应用将要解码的sample数据写入AVBuffer，在AVCodec中数据不再需要从内存拷入硬件解码器，而是直接送入解码器解码，实现系统内数据零拷贝。</li>      <li>视频编码、解码支持硬件加速：支持H.264、H.265、H.265 10bit的硬件编解码。</li>     </ul>    </div>    <div class="tiledSection">     <h2 id="基础概念">基础概念<i class="anchor-icon anchor-icon-link" anchorid="基础概念" tips="复制节点链接"></i></h2>          <ul>      <li>       <p>媒体文件：携带有音视频、字幕等媒体数据的文件，如.mp4、.m4a。</p></li>      <li>       <p>流媒体：可以边下载，边播放的媒体传输形式，下载协议如HTTP/HTTPS、HLS协议。</p></li>      <li>       <p>音视频编码：将未压缩原序列音视频数据转换为另一种格式数据，如H.264、AAC。</p></li>      <li>       <p>音视频解码：将一种数据格式转换为未压缩状态的原序列音视频数据，如YUV、PCM。</p></li>      <li>       <p>媒体文件封装：将音频、视频、字幕等数据以及描述信息，按照某种格式要求，写入到同一个文件中，如.mp4。</p></li>      <li>       <p>媒体文件解封装：将文件中的音频、视频、字幕等媒体数据读出，解析出媒体的描述信息。</p></li>      <li>       <p>sample：有相同时间属性的一组数据。</p>       <p>对于音视频，通常是有相同解码时间戳的压缩数据。</p>       <p>对于字幕，通常包含对应时间点的字幕内容。</p>       <p>所有的轨道结尾数据都为空。</p></li>     </ul>    </div>    <div class="tiledSection">     <h2 id="使用方式">使用方式<i class="anchor-icon anchor-icon-link" anchorid="使用方式" tips="复制节点链接"></i></h2>          <ul>      <li>       <p>视频编解码</p>       <p>视频编码的输入和视频解码的输出支持Surface模式。</p>       <p>在编码和解码过程中，通过回调函数通知应用数据处理的情况；如编码过程通过回调通知应用，完成一帧编码，输出编码结果AVBuffer；在解码过程通过回调通知应用输入一帧码流到解码器解码，当解码完成也会通过回调通知应用解码完成，应用可以对数据做后续处理。</p>       <p>视频编解码的逻辑如图所示。</p>       <p><span><img originheight="345" originwidth="1199" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114416.64142509798829657348239414830068:50001231000000:2800:94874984F3B5F1869ED84A0E06BCEA5260A6E532CECC9BC9EE225C7A9E41934A.png" width="920" height="264.72060050041705"></span></p>       <p>具体开发指导请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/video-decoding#surface模式">视频解码Surface模式</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/video-encoding#surface模式">视频编码Surface模式</a>。</p></li>      <li>       <p>音频编解码</p>       <p>音频编码的输入和音频解码的输出为PCM格式。</p>       <p>在编码和解码过程中，通过回调函数通知应用数据处理的情况；如编码过程通过回调通知应用，完成一帧编码，输出编码结果AVBuffer；在解码过程通过回调通知应用输入一帧码流到解码器解码，当解码完成也会通过回调通知应用解码完成，应用可以对数据做后续处理。</p>       <p>音频编解码逻辑如图所示。</p>       <p><span><img originheight="345" originwidth="1199" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114416.33164298763654528568441480311638:50001231000000:2800:3DA7E0D1D395BE58E323793B154AB8EE07130A5582B1CFEF68C8472B8B84B780.png" width="920" height="264.72060050041705"></span></p>       <p>具体开发指导请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/audio-decoding">音频解码</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/audio-encoding">音频编码</a>。</p></li>      <li>       <p>文件解析封装</p>       <p>在文件封装环节，应用将AVBuffer送入Codec对应的接口，执行数据封装，AVBuffer可以是由上述编码输出的AVBuffer，也可以是应用创建的AVBuffer，AVBuffer中要携带有效的码流数据和相关的时间描述等信息；</p>       <p>在文件解析环节，应用从Codec对应的接口获得携带有码流数据的AVBuffer，该AVBuffer可以送入上述视频和音频编解码对应接口。</p>       <p>文件封装解封装逻辑如图所示。</p>       <p><span><img originheight="345" originwidth="796" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114416.61563653748756944747926142331804:50001231000000:2800:262BC8BDEA272EBC3D829C6C4C5356F3C4CD059A48396FBBF8CD5A75A005F9ED.png" width="796" height="345"></span></p>       <p>具体开发指导请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/audio-video-demuxer">媒体数据解析</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/audio-video-muxer">媒体数据封装</a>。</p></li>     </ul>    </div>   </div>   <div></div></div>