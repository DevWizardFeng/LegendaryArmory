<h1 _ngcontent-qku-c119="" class="doc-title ng-star-inserted" title="AVScreenCapture录屏自定义场景"> AVScreenCapture录屏自定义场景 </h1>

<div _ngcontent-qku-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p>AVScreenCapture支持应用完成场景化的自定义配置，具体配置可参考下述指导。</p>    <div class="tiledSection">     <h2 id="设置录屏策略">设置录屏策略<i class="anchor-icon anchor-icon-link" anchorid="设置录屏策略" tips="复制节点链接"></i></h2>         </div>    <div class="tiledSection">     <h3 id="蜂窝通话设置" class="firsth2">蜂窝通话设置<i class="anchor-icon anchor-icon-link" anchorid="蜂窝通话设置" tips="复制节点链接"></i></h3>          <p>从API version 20开始支持蜂窝通话设置。</p>     <p>使用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-native-avscreen-capture-h#oh_avscreencapture_strategyforkeepcaptureduringcall" target="_blank">OH_AVScreenCapture_StrategyForKeepCaptureDuringCall</a>设置蜂窝通话时是否保持录屏。</p>     <div _ngcontent-qku-c106="" class="highlight-div"><div _ngcontent-qku-c106="" class="highlight-div-header"><div _ngcontent-qku-c106="" class="highlight-div-header-left"><div _ngcontent-qku-c106="" class="handle-button expand-button"><div _ngcontent-qku-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-qku-c106="" class="highlight-div-header-right"><div _ngcontent-qku-c106="" class="handle-button ai-button"></div><div _ngcontent-qku-c106="" class="handle-button line-button"><div _ngcontent-qku-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-qku-c106="" class="handle-button theme-button"><div _ngcontent-qku-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-qku-c106="" class="handle-button copy-button"><div _ngcontent-qku-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-qku-c106="" class="highlight-scroll-div"><pre class="prettyprint linenums hljs language-bash" data-highlighted="yes"><ol class="linenums"><li>OH_AVScreenCapture_CaptureStrategy* strategy = OH_AVScreenCapture_CreateCaptureStrategy();</li><li>OH_AVScreenCapture_StrategyForKeepCaptureDuringCall(strategy, <span class="hljs-literal">true</span>);</li><li>OH_AVScreenCapture_SetCaptureStrategy(capture, strategy);</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="设置b帧编码">设置B帧编码<i class="anchor-icon anchor-icon-link" anchorid="设置b帧编码" tips="复制节点链接"></i></h3>          <p>从API version 20开始支持设置B帧编码。</p>     <p>使用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-native-avscreen-capture-h#oh_avscreencapture_strategyforbframesencoding" target="_blank">OH_AVScreenCapture_StrategyForBFramesEncoding</a>设置是否使用B帧编码，用于减小录制文件的大小。</p>     <div _ngcontent-qku-c106="" class="highlight-div"><div _ngcontent-qku-c106="" class="highlight-div-header"><div _ngcontent-qku-c106="" class="highlight-div-header-left"><div _ngcontent-qku-c106="" class="handle-button expand-button"><div _ngcontent-qku-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-qku-c106="" class="highlight-div-header-right"><div _ngcontent-qku-c106="" class="handle-button ai-button"></div><div _ngcontent-qku-c106="" class="handle-button line-button"><div _ngcontent-qku-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-qku-c106="" class="handle-button theme-button"><div _ngcontent-qku-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-qku-c106="" class="handle-button copy-button"><div _ngcontent-qku-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-qku-c106="" class="highlight-scroll-div"><pre class="prettyprint linenums hljs language-bash" data-highlighted="yes"><ol class="linenums"><li>OH_AVScreenCapture_CaptureStrategy* strategy = OH_AVScreenCapture_CreateCaptureStrategy();</li><li>OH_AVScreenCapture_StrategyForBFramesEncoding(strategy, <span class="hljs-literal">true</span>);</li><li>OH_AVScreenCapture_SetCaptureStrategy(capture, strategy);</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="设置屏幕捕获picker">设置屏幕捕获Picker<i class="anchor-icon anchor-icon-link" anchorid="设置屏幕捕获picker" tips="复制节点链接"></i></h3>          <p>从API version 20开始支持设置屏幕捕获Picker。</p>     <p>使用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-native-avscreen-capture-h#oh_avscreencapture_strategyforpickerpopup" target="_blank">OH_AVScreenCapture_StrategyForPickerPopUp</a>设置是否弹出屏幕捕获Picker。</p>     <div _ngcontent-qku-c106="" class="highlight-div"><div _ngcontent-qku-c106="" class="highlight-div-header"><div _ngcontent-qku-c106="" class="highlight-div-header-left"><div _ngcontent-qku-c106="" class="handle-button expand-button"><div _ngcontent-qku-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-qku-c106="" class="highlight-div-header-right"><div _ngcontent-qku-c106="" class="handle-button ai-button"></div><div _ngcontent-qku-c106="" class="handle-button line-button"><div _ngcontent-qku-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-qku-c106="" class="handle-button theme-button"><div _ngcontent-qku-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-qku-c106="" class="handle-button copy-button"><div _ngcontent-qku-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-qku-c106="" class="highlight-scroll-div"><pre class="prettyprint linenums hljs language-bash" data-highlighted="yes"><ol class="linenums"><li>OH_AVScreenCapture_CaptureStrategy* strategy = OH_AVScreenCapture_CreateCaptureStrategy();</li><li>OH_AVScreenCapture_StrategyForPickerPopUp(strategy, <span class="hljs-literal">true</span>);</li><li>OH_AVScreenCapture_SetCaptureStrategy(capture, strategy);</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="设置旋转适配">设置旋转适配<i class="anchor-icon anchor-icon-link" anchorid="设置旋转适配" tips="复制节点链接"></i></h2>          <p>从API version 20开始支持设置旋转适配。</p>     <p>使用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-native-avscreen-capture-h#oh_avscreencapture_strategyforcanvasfollowrotation" target="_blank">OH_AVScreenCapture_StrategyForCanvasFollowRotation</a>，可设置录屏时是否自动跟随屏幕旋转。</p>     <p>调用此接口完成设置后，无需再调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-native-avscreen-capture-h#oh_avscreencapture_resizecanvas" target="_blank">OH_AVScreenCapture_ResizeCanvas</a>手动修改分辨率。</p>     <div _ngcontent-qku-c106="" class="highlight-div"><div _ngcontent-qku-c106="" class="highlight-div-header"><div _ngcontent-qku-c106="" class="highlight-div-header-left"><div _ngcontent-qku-c106="" class="handle-button expand-button"><div _ngcontent-qku-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-qku-c106="" class="highlight-div-header-right"><div _ngcontent-qku-c106="" class="handle-button ai-button"></div><div _ngcontent-qku-c106="" class="handle-button line-button"><div _ngcontent-qku-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-qku-c106="" class="handle-button theme-button"><div _ngcontent-qku-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-qku-c106="" class="handle-button copy-button"><div _ngcontent-qku-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-qku-c106="" class="highlight-scroll-div"><pre class="prettyprint linenums hljs language-ruby" data-highlighted="yes"><ol class="linenums"><li>OH_AVScreenCapture_CaptureStrategy* strategy = OH_AVScreenCapture_CreateCaptureStrategy();</li><li><span class="hljs-regexp">//</span> 设为<span class="hljs-literal">true</span>，表示跟随屏幕旋转，并在横竖屏旋转后，自动调换虚拟屏尺寸，确保输出画面及时跟随旋转。</li><li>OH_AVScreenCapture_StrategyForCanvasFollowRotation(strategy, <span class="hljs-literal">true</span>);</li><li>OH_AVScreenCapture_SetCaptureStrategy(capture, strategy);</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="设置麦克风开关">设置麦克风开关<i class="anchor-icon anchor-icon-link" anchorid="设置麦克风开关" tips="复制节点链接"></i></h2>          <p>使用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-native-avscreen-capture-h#oh_avscreencapture_setmicrophoneenabled" target="_blank">OH_AVScreenCapture_SetMicrophoneEnabled</a>，可设置在录屏过程中是否开启麦克风，默认麦克风开关为开启状态。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>使用麦克风录制，需要：</p>       <ul>        <li>配置麦克风权限ohos.permission.MICROPHONE，配置方式请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/request-user-authorization">向用户申请权限</a>。</li>        <li>申请长时任务，申请方式请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/continuous-task">申请长时任务</a>。</li>       </ul>      </div></div></div>     <div _ngcontent-qku-c106="" class="highlight-div"><div _ngcontent-qku-c106="" class="highlight-div-header"><div _ngcontent-qku-c106="" class="highlight-div-header-left"><div _ngcontent-qku-c106="" class="handle-button expand-button"><div _ngcontent-qku-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-qku-c106="" class="highlight-div-header-right"><div _ngcontent-qku-c106="" class="handle-button ai-button"></div><div _ngcontent-qku-c106="" class="handle-button line-button"><div _ngcontent-qku-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-qku-c106="" class="handle-button theme-button"><div _ngcontent-qku-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-qku-c106="" class="handle-button copy-button"><div _ngcontent-qku-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-qku-c106="" class="highlight-scroll-div"><pre class="prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-type">bool</span> isMic = <span class="hljs-literal">true</span>;</li><li><span class="hljs-built_in">OH_AVScreenCapture_SetMicrophoneEnabled</span>(capture, isMic);</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="隐私设置">隐私设置<i class="anchor-icon anchor-icon-link" anchorid="隐私设置" tips="复制节点链接"></i></h2>          <p>从API version 20开始，支持使用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-native-avscreen-capture-h#oh_avscreencapture_strategyforprivacymaskmode" target="_blank">OH_AVScreenCapture_StrategyForPrivacyMaskMode</a>设置屏幕录制隐私窗口屏蔽模式。</p>     <div _ngcontent-qku-c106="" class="highlight-div"><div _ngcontent-qku-c106="" class="highlight-div-header"><div _ngcontent-qku-c106="" class="highlight-div-header-left"><div _ngcontent-qku-c106="" class="handle-button expand-button"><div _ngcontent-qku-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-qku-c106="" class="highlight-div-header-right"><div _ngcontent-qku-c106="" class="handle-button ai-button"></div><div _ngcontent-qku-c106="" class="handle-button line-button"><div _ngcontent-qku-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-qku-c106="" class="handle-button theme-button"><div _ngcontent-qku-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-qku-c106="" class="handle-button copy-button"><div _ngcontent-qku-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-qku-c106="" class="highlight-scroll-div"><pre class="prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">//  value值设为0，表示全屏屏蔽模式。value值设为1，表示窗口屏蔽模式。默认为全屏屏蔽模式。</span></li><li><span class="hljs-type">int</span> value = <span class="hljs-number">0</span>;</li><li>OH_AVScreenCapture_CaptureStrategy* strategy = <span class="hljs-built_in">OH_AVScreenCapture_CreateCaptureStrategy</span>();</li><li><span class="hljs-built_in">OH_AVScreenCapture_StrategyForPrivacyMaskMode</span>(strategy, value);</li><li><span class="hljs-built_in">OH_AVScreenCapture_SetCaptureStrategy</span>(capture, strategy);</li></ol></pre></div></div>     <p>在API version 12时，支持使用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-native-avscreen-capture-h#oh_avscreencapture_skipprivacymode" target="_blank">OH_AVScreenCapture_SkipPrivacyMode</a>设置录屏时的豁免隐私窗口。目前设置豁免隐私窗口需要传入所有隐私子窗口和主窗口ID，传空数组取消豁免隐私窗口。</p>     <div _ngcontent-qku-c106="" class="highlight-div"><div _ngcontent-qku-c106="" class="highlight-div-header"><div _ngcontent-qku-c106="" class="highlight-div-header-left"><div _ngcontent-qku-c106="" class="handle-button expand-button"><div _ngcontent-qku-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-qku-c106="" class="highlight-div-header-right"><div _ngcontent-qku-c106="" class="handle-button ai-button"></div><div _ngcontent-qku-c106="" class="handle-button line-button"><div _ngcontent-qku-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-qku-c106="" class="handle-button theme-button"><div _ngcontent-qku-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-qku-c106="" class="handle-button copy-button"><div _ngcontent-qku-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-qku-c106="" class="highlight-scroll-div"><pre class="prettyprint linenums hljs language-cangjie" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-variable">std</span>::<span class="hljs-title class_">vector</span>&lt;<span class="hljs-title class_">int</span>&gt; <span class="hljs-title class_">windowIdsSkipPrivacy</span> = {};</li><li><span class="hljs-title function_">OH_AVScreenCapture_SkipPrivacyMode</span>(<span class="hljs-variable">capture</span>, &amp;<span class="hljs-title class_">windowIdsSkipPrivacy</span>[<span class="hljs-number">0</span>],</li><li>    <span class="hljs-title class_">static_cast</span>&lt;<span class="hljs-title class_">int32_t</span>&gt;(<span class="hljs-variable">windowIdsSkipPrivacy</span>.<span class="hljs-title function_">size</span>()));</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="设置捕获区域">设置捕获区域<i class="anchor-icon anchor-icon-link" anchorid="设置捕获区域" tips="复制节点链接"></i></h2>          <p>从API version 20开始支持设置捕获区域。</p>     <p>可以根据需要设置区域坐标和大小，使用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-native-avscreen-capture-h#oh_avscreencapture_setcapturearea" target="_blank">OH_AVScreenCapture_SetCaptureArea</a>设置想要捕获的区域，如下方创建了一个从（0，0）为起点的长100px，宽100px的矩形区域。此接口在录屏开始前后都可以设置。</p>     <div _ngcontent-qku-c106="" class="highlight-div"><div _ngcontent-qku-c106="" class="highlight-div-header"><div _ngcontent-qku-c106="" class="highlight-div-header-left"><div _ngcontent-qku-c106="" class="handle-button expand-button"><div _ngcontent-qku-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-qku-c106="" class="highlight-div-header-right"><div _ngcontent-qku-c106="" class="handle-button ai-button"></div><div _ngcontent-qku-c106="" class="handle-button line-button"><div _ngcontent-qku-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-qku-c106="" class="handle-button theme-button"><div _ngcontent-qku-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-qku-c106="" class="handle-button copy-button"><div _ngcontent-qku-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-qku-c106="" class="highlight-scroll-div"><pre class="prettyprint linenums hljs language-cangjie" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-variable">OH_Rect</span>* <span class="hljs-variable">region</span> = <span class="hljs-variable">new</span> <span class="hljs-variable">OH_Rect</span>;</li><li>    <span class="hljs-variable">region</span>-&gt;<span class="hljs-title class_">x</span> = <span class="hljs-number">0</span>;</li><li>    <span class="hljs-variable">region</span>-&gt;<span class="hljs-title class_">y</span> = <span class="hljs-number">0</span>;</li><li>    <span class="hljs-variable">region</span>-&gt;<span class="hljs-title class_">width</span> = <span class="hljs-number">100</span>;</li><li>    <span class="hljs-variable">region</span>-&gt;<span class="hljs-title class_">height</span> = <span class="hljs-number">100</span>;</li><li><span class="hljs-variable">uint64_t</span> <span class="hljs-variable">regionDisplayId</span> = <span class="hljs-number">0</span>; <span class="hljs-comment">// 传入矩形区域所在的屏幕Id。</span></li><li><span class="hljs-title function_">OH_AVScreenCapture_SetCaptureArea</span>(<span class="hljs-variable">capture</span>, <span class="hljs-variable">regionDisplayId</span>, <span class="hljs-variable">region</span>);</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="设置捕获光标">设置捕获光标<i class="anchor-icon anchor-icon-link" anchorid="设置捕获光标" tips="复制节点链接"></i></h2>          <p>从API version 15开始支持设置捕获光标。</p>     <p>使用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-native-avscreen-capture-h#oh_avscreencapture_showcursor" target="_blank">OH_AVScreenCapture_ShowCursor</a>设置光标显示开关，开始录屏前后均可调用。</p>     <div _ngcontent-qku-c106="" class="highlight-div"><div _ngcontent-qku-c106="" class="highlight-div-header"><div _ngcontent-qku-c106="" class="highlight-div-header-left"><div _ngcontent-qku-c106="" class="handle-button expand-button"><div _ngcontent-qku-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-qku-c106="" class="highlight-div-header-right"><div _ngcontent-qku-c106="" class="handle-button ai-button"></div><div _ngcontent-qku-c106="" class="handle-button line-button"><div _ngcontent-qku-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-qku-c106="" class="handle-button theme-button"><div _ngcontent-qku-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-qku-c106="" class="handle-button copy-button"><div _ngcontent-qku-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-qku-c106="" class="highlight-scroll-div"><pre class="prettyprint linenums hljs language-scss" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-built_in">OH_AVScreenCapture_ShowCursor</span>(capture, false);</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="设置最大帧率">设置最大帧率<i class="anchor-icon anchor-icon-link" anchorid="设置最大帧率" tips="复制节点链接"></i></h2>          <p>从API version 14开始支持设置最大帧率。</p>     <p>使用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-native-avscreen-capture-h#oh_avscreencapture_setmaxvideoframerate" target="_blank">OH_AVScreenCapture_SetMaxVideoFrameRate</a>设置录屏时的最大帧率，需在录屏启动后被调用。</p>     <div _ngcontent-qku-c106="" class="highlight-div"><div _ngcontent-qku-c106="" class="highlight-div-header"><div _ngcontent-qku-c106="" class="highlight-div-header-left"><div _ngcontent-qku-c106="" class="handle-button expand-button"><div _ngcontent-qku-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-qku-c106="" class="highlight-div-header-right"><div _ngcontent-qku-c106="" class="handle-button ai-button"></div><div _ngcontent-qku-c106="" class="handle-button line-button"><div _ngcontent-qku-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-qku-c106="" class="handle-button theme-button"><div _ngcontent-qku-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-qku-c106="" class="handle-button copy-button"><div _ngcontent-qku-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-qku-c106="" class="highlight-scroll-div"><pre class="prettyprint linenums hljs language-scss" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-built_in">OH_AVScreenCapture_SetMaxVideoFrameRate</span>(capture, <span class="hljs-number">20</span>);</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="设置屏幕分辨率">设置屏幕分辨率<i class="anchor-icon anchor-icon-link" anchorid="设置屏幕分辨率" tips="复制节点链接"></i></h2>          <p>使用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-native-avscreen-capture-h#oh_avscreencapture_resizecanvas" target="_blank">OH_AVScreenCapture_ResizeCanvas</a>调整录屏分辨率，需在启动后调用，分辨率有范围限制。</p>     <div _ngcontent-qku-c106="" class="highlight-div"><div _ngcontent-qku-c106="" class="highlight-div-header"><div _ngcontent-qku-c106="" class="highlight-div-header-left"><div _ngcontent-qku-c106="" class="handle-button expand-button"><div _ngcontent-qku-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-qku-c106="" class="highlight-div-header-right"><div _ngcontent-qku-c106="" class="handle-button ai-button"></div><div _ngcontent-qku-c106="" class="handle-button line-button"><div _ngcontent-qku-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-qku-c106="" class="handle-button theme-button"><div _ngcontent-qku-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-qku-c106="" class="handle-button copy-button"><div _ngcontent-qku-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-qku-c106="" class="highlight-scroll-div"><pre class="prettyprint linenums hljs language-scss" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-built_in">OH_AVScreenCapture_ResizeCanvas</span>(capture, <span class="hljs-number">768</span>, <span class="hljs-number">1280</span>);</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="设置内容过滤">设置内容过滤<i class="anchor-icon anchor-icon-link" anchorid="设置内容过滤" tips="复制节点链接"></i></h2>          <p>选择录屏时要过滤的声音和窗口。</p>     <p>使用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-native-avscreen-capture-h#oh_avscreencapture_contentfilter_addaudiocontent" target="_blank">OH_AVScreenCapture_ContentFilter_AddAudioContent</a>设置可过滤的声音，包含系统音和应用自身声音。</p>     <p>使用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-native-avscreen-capture-h#oh_avscreencapture_contentfilter_addwindowcontent" target="_blank">OH_AVScreenCapture_ContentFilter_AddWindowContent</a>设置可过滤的窗口，通过窗口ID来指定。</p>     <div _ngcontent-qku-c106="" class="highlight-div"><div _ngcontent-qku-c106="" class="highlight-div-header"><div _ngcontent-qku-c106="" class="highlight-div-header-left"><div _ngcontent-qku-c106="" class="handle-button expand-button"><div _ngcontent-qku-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-qku-c106="" class="highlight-div-header-right"><div _ngcontent-qku-c106="" class="handle-button ai-button"></div><div _ngcontent-qku-c106="" class="handle-button line-button"><div _ngcontent-qku-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-qku-c106="" class="handle-button theme-button"><div _ngcontent-qku-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-qku-c106="" class="handle-button copy-button"><div _ngcontent-qku-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-qku-c106="" class="highlight-scroll-div"><pre class="prettyprint linenums hljs language-cangjie" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-variable">OH_AVScreenCapture_ContentFilter</span> *<span class="hljs-variable">contentFilter</span>= <span class="hljs-title function_">OH_AVScreenCapture_CreateContentFilter</span>();</li><li><span class="hljs-comment">// 添加过滤通知音。</span></li><li><span class="hljs-title function_">OH_AVScreenCapture_ContentFilter_AddAudioContent</span>(<span class="hljs-variable">contentFilter</span>, <span class="hljs-variable">OH_SCREEN_CAPTURE_NOTIFICATION_AUDIO</span>);</li><li><span class="hljs-comment">// 排除指定窗口id。</span></li><li><span class="hljs-variable">std</span>::<span class="hljs-title class_">vector</span>&lt;<span class="hljs-title class_">int</span>&gt; <span class="hljs-title class_">windowIdsExclude</span> = {};</li><li><span class="hljs-title function_">OH_AVScreenCapture_ContentFilter_AddWindowContent</span>(<span class="hljs-variable">contentFilter</span>, &amp;<span class="hljs-title class_">windowIdsExclude</span>[<span class="hljs-number">0</span>],</li><li>    <span class="hljs-title class_">static_cast</span>&lt;<span class="hljs-title class_">int32_t</span>&gt;(<span class="hljs-variable">windowIdsExclude</span>.<span class="hljs-title function_">size</span>()));</li><li>
</li><li><span class="hljs-title function_">OH_AVScreenCapture_ExcludeContent</span>(<span class="hljs-variable">capture</span>, <span class="hljs-variable">contentFilter</span>);</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="更多资源">更多资源<i class="anchor-icon anchor-icon-link" anchorid="更多资源" tips="复制节点链接"></i></h2>          <ul>      <li>       <p>API参考：详细的API描述请见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-native-avscreen-capture-h" target="_blank">native_avscreen_capture.h</a>。</p></li>      <li>       <p>示例工程：该示例调用了媒体AVScreenCapture组件提供的接口能力，提供屏幕捕获的功能，详情见<a href="https://gitcode.com/openharmony/applications_app_samples/tree/master/code/DocsSample/Media/ScreenCapture/ScreenCaptureSample" target="_blank">录屏示例工程</a>。</p></li>     </ul>    </div>   </div>   <div></div></div>