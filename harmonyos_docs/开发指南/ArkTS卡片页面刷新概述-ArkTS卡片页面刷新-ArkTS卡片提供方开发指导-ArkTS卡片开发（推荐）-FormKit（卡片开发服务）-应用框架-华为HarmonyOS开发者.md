<h1 _ngcontent-ods-c119="" class="doc-title ng-star-inserted" title="ArkTS卡片页面刷新概述"> ArkTS卡片页面刷新概述 </h1>

<div _ngcontent-ods-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p>卡片使用方（例如：桌面）和卡片提供方均可主动触发卡片页面刷新。此外，卡片管理服务会根据开发者声明的定时信息，按需通知卡片提供方进行卡片刷新。因此，卡片刷新方式包括：卡片提供方主动触发刷新、卡片使用方主动触发刷新以及卡片定时定点刷新。这些刷新方式均需由卡片提供方推送需要刷新的卡片数据。</p>    <div class="tiledSection">     <h2 id="卡片数据交互">卡片数据交互<i class="anchor-icon anchor-icon-link" anchorid="卡片数据交互" tips="复制节点链接"></i></h2>          <p>ArkTS卡片管理服务支持卡片提供方（例如：应用）和卡片之间的数据交互。卡片通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-postcardaction#postcardaction-1" target="_blank">postCardAction</a>传递数据给卡片提供方，卡片提供方则通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-form-formprovider#formproviderupdateform" target="_blank">updateForm</a>接口传递数据给卡片。卡片提供方将数据提供给卡片后，可以用于卡片页面刷新等。</p>     <p>由于卡片提供方和卡片为相互独立的进程，两者间的数据共享只能通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-localstorage#localstorageprop">LocalStorageProp</a>传递，不能使用getContext方法。因此卡片提供方推送数据后，卡片UI需要通过LocalStorageProp接收数据，且接收数据时，卡片数据会被转换成string类型。</p>    </div>    <div class="tiledSection">     <h2 id="页面刷新分类">页面刷新分类<i class="anchor-icon anchor-icon-link" anchorid="页面刷新分类" tips="复制节点链接"></i></h2>          <p>根据触发方式的差异，卡片刷新分为主动刷新和被动刷新。</p>    </div>    <div class="tiledSection">     <h3 id="主动刷新" class="firsth2">主动刷新<i class="anchor-icon anchor-icon-link" anchorid="主动刷新" tips="复制节点链接"></i></h3>          <p>主动刷新包括卡片提供方主动刷新卡片和卡片使用方主动刷新卡片。开发指导请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-ui-widget-active-refresh">ArkTS卡片主动刷新</a>。</p>     <p><strong>图1 卡片提供方主动刷新卡片流程图</strong></p>     <p><span><img originheight="278" originwidth="865" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114906.81964258143379707076394817775380:50001231000000:2800:94A5940E5B295B5D5EE3CF482072F5DE72BB2A7AFC71D7A64E17A3E0B5F80AED.png" width="865" height="278"></span></p>     <p>卡片提供方应用运行过程中，如果识别到有要更新卡片数据的诉求，可以主动通过formProvider提供的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-form-formprovider#formproviderupdateform" target="_blank">updateForm</a>接口更新卡片。</p>     <p><strong>图2 卡片使用方主动刷新卡片流程图</strong></p>     <p><span><img originheight="284" originwidth="943" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114906.81750772165054868617567192617638:50001231000000:2800:7C1AB84E9970FDFF762EA0CA4C9BAE59BDE4DCD2B8083496FDBDB38E1481CB0C.png" width="920" height="277.0731707317073"></span></p>     <p>卡片使用方在运行过程中，如果检测到系统语言、深浅色有变化时，可以主动通过formHost提供的requestForm（仅支持系统应用使用）接口请求更新卡片，卡片管理服务会进而通知卡片提供方完成卡片更新。</p>    </div>    <div class="tiledSection">     <h3 id="被动刷新">被动刷新<i class="anchor-icon anchor-icon-link" anchorid="被动刷新" tips="复制节点链接"></i></h3>          <p>被动刷新包括定时刷新、定点刷新。开发指导请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-ui-widget-passive-refresh">ArkTS卡片被动刷新</a>。</p>     <p>卡片定时刷新：表示在一定时间间隔内调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-form-formextensionability#formextensionabilityonupdateform" target="_blank">onUpdateForm</a>的生命周期回调函数自动刷新卡片内容。</p>     <p>卡片定点刷新：表示在每天的某个特定时间点自动刷新卡片内容。</p>     <p><strong>图3 卡片管理服务通知卡片提供方定时定点刷新卡片流程图</strong></p>     <p><span><img originheight="285" originwidth="949" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114907.23677984542733123415066015221041:50001231000000:2800:2890D6A53C413FA176509672FA5E046150B439CF5575B1C061AB1FB02A5B4F10.png" width="920" height="276.29083245521605"></span></p>     <p>根据卡片提供方开发者提前配置声明的定时刷新信息，卡片管理服务会根据定时信息、卡片可见状态、刷新次数等因素综合判断是否需要通知卡片提供方更新卡片。</p>    </div>    <div class="tiledSection">     <h2 id="约束与限制">约束与限制<i class="anchor-icon anchor-icon-link" anchorid="约束与限制" tips="复制节点链接"></i></h2>          <ol>      <li>卡片提供方仅允许刷新自己的卡片，其他提供方的卡片无法刷新。</li>      <li>卡片使用方仅允许刷新添加到自己的卡片，添加到其他使用方的卡片无法刷新。</li>      <li>从API version 20开始，如果卡片刷新的数据通过共享内存更新，刷新数据总大小不超过10MB，刷新图片数量不超过20张，API version 19及之前的版本，图片文件数量上限为5张，每张限制内存2MB，超出限制的图片会显示异常。</li>     </ol>    </div>   </div>   <div></div></div>