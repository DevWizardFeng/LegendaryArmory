<h1 _ngcontent-lgf-c119="" class="doc-title ng-star-inserted" title="CPU活动分析：CPU分析"> CPU活动分析：CPU分析 </h1>

<div _ngcontent-lgf-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div id="body0000001532306157"><p id="ZH-CN_TOPIC_0000002510294379__p1851214117">开发者可使用DevEco Profiler的CPU场景调优分析，在应用或元服务运行时，实时显示CPU使用率和线程的运行状态，了解指定时间段内的CPU资源消耗情况，查看系统的关键打点（例如图形系统打点、应用服务框架打点等），进行更具针对性的优化。</p> <div class="tiledSection"><h2 id="section353485410331">查看各CPU使用情况<i class="anchor-icon anchor-icon-link" anchorid="section353485410331" tips="复制节点链接"></i></h2><ol id="ZH-CN_TOPIC_0000002510294379__ol2042415618351"><li id="li583393362510"><span>创建CPU分析任务并录制相关数据，操作方法可参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/deep-recording">性能问题定位：深度录制</a>，或在会话区选择<strong>Open File</strong>，导入历史数据。</span><p></p><p id="ZH-CN_TOPIC_0000002510294379__p103115328285">CPU分析任务支持在录制前单击<span><img height="25.4163" originheight="16" originwidth="13" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104922.97453180760390630723608943799414:50001231000000:2800:1371E62A29DB361813C6808BABC4729D8DF003D1340D6FD513A271986C2BA784.png" width="21.945" class="IconPic notEnlarge"></span>指定要录制的泳道。</p> <p></p></li><li id="li197692955811"><span>“CPU Core”泳道显示当前选择调优应用或元服务的CPU的使用率。</span><p></p><p id="ZH-CN_TOPIC_0000002510294379__p114403583316">可在“CPU Core”右侧的下拉列表中选择显示内容：</p> <ul id="ZH-CN_TOPIC_0000002510294379__ul1275672518467"><li id="li1175610253461">Slice and Frequency：每个子泳道包含时间片和频率两部分，时间片显示占用该CPU核心的进程、线程。</li><li id="li13756525114619">Usage and Frequency：每个子泳道包含CPU核心使用率和频率两部分。</li></ul> <p id="ZH-CN_TOPIC_0000002510294379__p1735711222593">框选主泳道，可对所选时间段内的CPU使用情况进行汇总统计，可查询多时间片的进程维度统计信息、线程维度状态统计信息、线程状态统计信息，以及所有时间片的数据统计信息。</p> <p id="ZH-CN_TOPIC_0000002510294379__p34551834175311"><span><img height="402.7267605633803" originheight="669" originwidth="1536" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104922.45618850865719550851553978898376:50001231000000:2800:AAF65AAD97389E7E59D0D9E0D8A0AC4F9B497776F5ACA02A148DAA7800CCB025.png" title="点击放大" width="920"></span></p> <p></p></li><li id="li114241756143517"><span>将其展开，子泳道显示各CPU核心调度信息、各CPU核心频率信息以及各CPU核心使用率信息。</span><p></p><div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p id="ZH-CN_TOPIC_0000002510294379__p1049418488509">将鼠标悬浮在某时间片上时，能够置灰非同进程时间片，通过此方法可以确定时间片的关联性。</p> </div></div></div> <p id="ZH-CN_TOPIC_0000002510294379__p645710342534"><span><img height="202.5457" originheight="340" originwidth="1539" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104922.23901104103223325869646994681617:50001231000000:2800:B327F1E1F287209F95F99278D6551B5B645DE395B63D657F8D5D8A1EBC26B21A.png" title="点击放大" width="904.4000000000001"></span></p> <p id="ZH-CN_TOPIC_0000002510294379__p6348123313415"></p> <p></p></li><li id="li167126218382"><span>指定时间片，查看统计信息。</span><p></p><ul id="ZH-CN_TOPIC_0000002510294379__ul1755963663910"><li id="li931014143918">单击某个运行状态的时间片，可查询这个时间片的基本运行信息及调度时延信息。<p id="ZH-CN_TOPIC_0000002510294379__p15458143417538"><span><img height="381.8164" originheight="679" originwidth="1545" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104922.67505873593019007937328711313594:50001231000000:2800:89BACF102FCC8A4509A847EB3CF10A5F8B2DE7D9474CB8A699D1A7E94CF1D4D1.png" title="点击放大" width="864.5"></span></p> </li><li id="li2055943614391">框选多个时间片，则可查询多时间片的进程维度统计信息以及所有时间片的数据统计信息。<p id="ZH-CN_TOPIC_0000002510294379__p1945913348536"><span><img height="398.2552" originheight="673" originwidth="1536" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104922.57055852332398122663114616884852:50001231000000:2800:C24CBD9696C417359FE44B4F3FC3B7D93F4823C17BA360C59A8C88EFA09EEE87.png" title="点击放大" width="904.4000000000001"></span></p> </li><li id="li124921233174">开启"View Integrated Scheduling Chain"后，点击CPU时间片泳道的节点可以查看某一个CPU运行线程的完整唤醒调度链。<p id="ZH-CN_TOPIC_0000002510294379__p4460183435315"><span><img height="398.96010000000007" originheight="676" originwidth="1540" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104922.56836151933261519894250741063801:50001231000000:2800:60BA8532BCF12F4EA2A5B55E95A464DCDEF351515A30DF448D09B27D746E1866.png" title="点击放大" width="904.4000000000001"></span></p> <p id="ZH-CN_TOPIC_0000002510294379__p1079194316271"></p> </li></ul> <p></p></li></ol> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><ul id="ZH-CN_TOPIC_0000002510294379__ul11646419013"><li id="li4243164312012">在任务分析窗口，可以通过“Ctrl+鼠标滚轮”缩放时间轴，通过“Shift+鼠标滚轮”左右移动时间轴。或使用快捷键W/S放大或缩小时间轴，使用A键/D键可以左右移动时间轴。</li><li id="li182232025112917">将鼠标悬停在泳道任意位置，可以通过M键添加单点时间标签。</li><li id="li1099292513324">鼠标框选要关注的时间段，可以通过“Shift+M”添加时间段时间标签。</li><li id="li540422233317">在任务分析窗口，可以通过“Ctrl+, ”向前选中单点时间标签，通过“Ctrl+. ”向后选中单点时间标签。</li><li id="li1360912834114">在任务分析窗口，可以通过“Ctrl+[ ”向前选中时间段时间标签，通过“Ctrl+]”向后选中时间段时间标签。</li><li id="li12164114113013">CPU分析支持能耗分析，请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-profiler-energy">能耗诊断：Energy分析</a>。</li></ul> </div></div></div> </div> <div class="tiledSection"><h2 id="section5691164615341">查询进程详情<i class="anchor-icon anchor-icon-link" anchorid="section5691164615341" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510294379__p37356435218">单击工具控制栏中的<span><img height="20.721400000000003" originheight="21" originwidth="20" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104922.93291373864900799257135550647428:50001231000000:2800:AAA00B0C2260D87C0E55D9887C6A83E51F29DE352E5970B705854BA72430D73D.png" width="19.950000000000003" class="IconPic notEnlarge"></span>按钮，可以设置是否为精简模式。精简模式下，trace数据量将大幅减少，主要采集当前进程、大桌面进程和render_service进程的trace数据。</p> <p id="ZH-CN_TOPIC_0000002510294379__p540611812539"><span><img height="448.26320000000004" originheight="631" originwidth="1128" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104922.97335389774152728474530625167472:50001231000000:2800:FF15726134C026B48959DC1E42E1C0E768CB51181075F4E87EDDC853A63EC78F.png" title="点击放大" width="798"></span></p> <div class="p" id="ZH-CN_TOPIC_0000002510294379__p38881855122919">进程泳道显示进程对各CPU核心的占用情况。展开进程泳道，显示进程下的线程列表以及线程的运行状态。<ul id="ZH-CN_TOPIC_0000002510294379__ul16771143611416"><li id="li07711136645">单击运行状态的时间片，显示线程在该片段的运行详情，包括起始时间、持续时长、运行状态、频率、线程优先级、所属进程、所属线程、上一运行状态、下一运行状态、唤醒线程，支持跳转到上个或者下个线程运行状态，支持跳转到唤醒线程状态等。<p id="ZH-CN_TOPIC_0000002510294379__p66210543376"><span><img height="351.29290000000003" originheight="609" originwidth="1554" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104922.84374019951875144027794877868861:50001231000000:2800:815E74D0FC0DE3FC220CF6C2C4E35EE19AF9D8ED62909840A918C8173F891A56.png" title="点击放大" width="891.1"></span></p> </li><li id="li14771183613417">框选Thread泳道中多个运行状态的时间片，可查看此时间段内的不同运行状态的线程的统计信息，包括总耗时时长、最大耗时、最小耗时、平均耗时、处于当前状态的线程数量以及线程中的中载重载数据统计。<div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p id="ZH-CN_TOPIC_0000002510294379__p202471857161815">中载重载数据每100ms做一次统计，24ms &lt; Running时长 ≤ 48ms 记为中载，Running时长大于48ms记为重载。</p> </div></div></div> <p id="ZH-CN_TOPIC_0000002510294379__p12934610417"><span><img height="327.3396" originheight="572" originwidth="1544" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104922.83992443488989007738269843588529:50001231000000:2800:0AB499E6D2C4E0B0DA9620F08D1DA0A4C58BB0D2A0451C36E9E98034370F40AF.png" title="点击放大" width="877.8000000000001"></span></p> </li><li id="li139891145104215">框选应用进程Process主泳道，可查看此时间段内该进程下的线程并行度统计信息。并行度数据每100ms做一次统计，可以查看100ms内运行的总线程数量、各线程并行的总时间和并行度。点选某一行，可以查看对应线程编号和运行时间段。<div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p id="ZH-CN_TOPIC_0000002510294379__p20601552187">并行度（Parallelism）取值范围是[1, cpu核数]，数值越小代表并行度越低。</p> </div></div></div> <p id="ZH-CN_TOPIC_0000002510294379__p69891145154219"><span><img height="359.8714" originheight="627" originwidth="1538" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104922.47624319509422187549171642795759:50001231000000:2800:CD501D810A4D66A0A533BD08C4837232B72EA8189C2C0F9038749F9993CA3270.png" title="点击放大" width="877.8000000000001"></span></p> </li></ul> </div> </div> <div class="tiledSection"><h2 id="section156261526105610">查看Trace详情<i class="anchor-icon anchor-icon-link" anchorid="section156261526105610" tips="复制节点链接"></i></h2><div class="p" id="ZH-CN_TOPIC_0000002510294379__p1046274483018">当存在Trace任务时，可在对应的线程泳道查看到当前线程已触发的Trace任务层叠图。选择待查询的Trace。<ul id="ZH-CN_TOPIC_0000002510294379__ul117741036945"><li id="li27741361145">点选泳道中的Trace片段，可查看单个Trace详情，包括名称、所属进程、所属线程、起始时间、持续时长、深度等。<div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><ul id="ZH-CN_TOPIC_0000002510294379__ul9775163618412"><li id="li11775436949">如果用户对线程进行了自定义打点，在此处亦可查看到对应的User Trace打点信息。</li><li id="li177751236942">从所在线程名称可分辨当前Trace的类型，系统Trace对应的线程名称为“线程名+线程号”，User Trace对应的线程名称为“打点任务名”。</li></ul> </div></div></div> <p id="ZH-CN_TOPIC_0000002510294379__p1377513360417"><span><img height="349.8033" originheight="618" originwidth="1548" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104924.23976511795306362736943153787544:50001231000000:2800:E82AF998B0E05A1F4E1680924979A34B15147754FA77B72EDBC124E840C86B9E.png" title="点击放大" width="871.1500000000001"></span></p> </li><li id="li1177517361240">框选多个Trace片段，可查看到Trace统计信息列表，包括Trace名称、此类Trace的总耗时、单个Trace的平均耗时、以及该时间段内该类Trace的触发次数等。<p id="ZH-CN_TOPIC_0000002510294379__p4470113435313"><span><img height="371.0750684931507" originheight="622" originwidth="1551" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104924.34605813649376492787668378527467:50001231000000:2800:2EBB9B93C342EB32A809A743C92A0D7912823DA1A5C5443855C43E44AC651E03.png" title="点击放大" width="920"></span></p> </li></ul> </div> </div> <div class="section" id="section16594132216520"><p id="ZH-CN_TOPIC_0000002510294379__p168913189331"></p> </div> </div></div>