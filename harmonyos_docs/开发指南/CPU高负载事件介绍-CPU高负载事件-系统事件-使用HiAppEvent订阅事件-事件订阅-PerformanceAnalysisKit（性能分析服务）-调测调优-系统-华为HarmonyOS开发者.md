<h1 _ngcontent-txc-c119="" class="doc-title ng-star-inserted" title="CPU高负载事件介绍"> CPU高负载事件介绍 </h1>

<div _ngcontent-txc-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div><div class="tiledSection"><h2 id="section4364396211">简介<i class="anchor-icon anchor-icon-link" anchorid="section4364396211" tips="复制节点链接"></i></h2></div> <p>CPU高负载事件用于检测应用在前台或后台时，应用相关的进程使用CPU资源超过系统的门限，导致手机发热等问题。</p> <p>如需了解如何使用HiAppEvent提供订阅CPU高负载事件，请参考以下文档。目前仅提供ArkTS接口。</p> <ul><li><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/hiappevent-watcher-cpu-usage-high-arkts" target="_blank">订阅CPU高负载事件（ArkTS）</a></li></ul> <div class="tiledSection"><h2 id="section19370106129">检测原理<i class="anchor-icon anchor-icon-link" anchorid="section19370106129" tips="复制节点链接"></i></h2><p>CPU高负载事件检测原理详见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/power-detection" target="_blank">功耗检测</a>章节。</p> </div> <div class="tiledSection"><h2 id="section74241024203713">事件字段说明<i class="anchor-icon anchor-icon-link" anchorid="section74241024203713" tips="复制节点链接"></i></h2><p>params字段说明</p> </div>  <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.7.1.4.1.1" valign="top" width="33.33333333333333%"><p>名称</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.7.1.4.1.2" valign="top" width="33.33333333333333%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.7.1.4.1.3" valign="top" width="33.33333333333333%"><p>说明</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="33.33333333333333%"><p>time</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p>number</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p>事件生成时间，单位为ms。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="33.33333333333333%"><p>bundle_version</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p>string</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p>应用版本。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="33.33333333333333%"><p>bundle_name</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p>string</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p>应用名称。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="33.33333333333333%"><p>foreground</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p>boolean</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p>应用是否处于前台状态，true：应用在前台，false：应用在后台。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="33.33333333333333%"><p>usage</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p>number</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p>单核CPU平均使用率，取值范围[0，100]，单位百分比。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="33.33333333333333%"><p>begin_time</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p>number</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p>采集开始时间，单位为ms。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="33.33333333333333%"><p>end_time</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p>number</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p>采集结束时间，单位为ms。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="33.33333333333333%"><p>fault_type</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p>number</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p>故障类型(从API version 20开始，支持该参数)：</p> <ul><li>1：前台；</li><li>2：后台；</li><li>3：线程高负载。</li></ul> </td> </tr> <tr><td class="cellrowborder" valign="top" width="33.33333333333333%"><p>external_log</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p>string[]</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p>记录故障日志文件路径，日志的文件名是：CPU_USAGE_HIGH_时间数字_数字.log，详细见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/power-detection#section1471964462613" target="_blank">日志规格</a>。<strong>为避免目录空间超限，导致新生成的日志文件写入失败，日志文件处理完后请及时删除。</strong></p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="33.33333333333333%"><p>log_over_limit</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p>boolean</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p>生成的故障日志文件与已存在的日志文件总大小是否超过5M上限。true表示超过上限，日志写入失败；false表示未超过上限</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="33.33333333333333%"><p>threads</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p>object[]</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p>Top5线程调用栈，详见thread属性。</p> </td> </tr>  </tbody></table></div> </div> <div class="tiledSection"><h3 id="section667111164161" class="firsth2">threads字段说明<i class="anchor-icon anchor-icon-link" anchorid="section667111164161" tips="复制节点链接"></i></h3></div>  <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.9.1.4.1.1" valign="top" width="33.33333333333333%"><p>名称</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.9.1.4.1.2" valign="top" width="33.33333333333333%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.9.1.4.1.3" valign="top" width="33.33333333333333%"><p>说明</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="33.33333333333333%"><p>name</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p>string</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p>线程名。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="33.33333333333333%"><p>tid</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p>number</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p>线程id。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="33.33333333333333%"><p>usage</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p>number</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p>前、后台CPU高负载事件：多核平均负载，如需换算单核负载需乘以核数。</p> <p>线程CPU高负载事件：单核平均负载。</p> </td> </tr>  </tbody></table></div> </div> <p>threads为上报预警事件的前10秒内的TOP5线程，如果在上报事件的时间点，进程负载下降了，那么此处的TOP线程以及提供的日志可能不准确。</p> </div> <div></div></div>