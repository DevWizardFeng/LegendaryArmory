<h1 _ngcontent-jhr-c119="" class="doc-title ng-star-inserted" title="HAP"> HAP </h1>

<div _ngcontent-jhr-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p>HAP（Harmony Ability Package）是应用安装和运行的基本单元。HAP包是由代码、资源、第三方库、配置文件等打包生成的模块包，其主要分为两种类型：entry和feature。</p>    <ul>     <li>entry：应用的主模块，作为应用的入口，提供了应用的基础功能。</li>     <li>feature：应用的动态特性模块，作为应用能力的扩展，可以根据用户的需求和设备类型进行选择性安装。</li>    </ul>    <p>应用程序包可以只包含一个基础的entry包，也可以包含一个基础的entry包和多个功能性的feature包。</p>    <div class="tiledSection">     <h2 id="使用场景">使用场景<i class="anchor-icon anchor-icon-link" anchorid="使用场景" tips="复制节点链接"></i></h2>          <ul>      <li>       <p>单HAP场景：如果只包含UIAbility组件，无需使用ExtensionAbility组件，优先采用单HAP（即一个entry包）来实现应用开发。虽然一个HAP中可以包含一个或多个UIAbility组件，为了避免不必要的资源加载，推荐采用“一个UIAbility+多个页面”的方式。</p></li>      <li>       <p>多HAP场景：如果应用的功能比较复杂，需要使用ExtensionAbility组件，可以采用多HAP（即一个entry包+多个feature包）来实现应用开发，每个HAP中包含一个UIAbility组件或者一个ExtensionAbility组件。在这种场景下，多个HAP引用相同的库文件，可能导致重复打包的问题。</p></li>     </ul>    </div>    <div class="tiledSection">     <h2 id="约束限制">约束限制<i class="anchor-icon anchor-icon-link" anchorid="约束限制" tips="复制节点链接"></i></h2>          <ul>      <li>       <p>不支持导出接口和ArkUI组件，给其他模块使用。</p></li>      <li>       <p>多HAP场景下，App Pack包中同一设备类型的所有HAP中最多只能包含一个Entry类型的HAP，也可以不包含；可以包含一个或者多个Feature类型的HAP，也可以不包含。</p></li>      <li>       <p>多HAP场景下，在安装或更新时，存在一致性校验，详情参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/odule_installation_update_consistency_verification">应用安装与更新一致性校验</a>。使用打包工具进行打包成APP时，也会进行合法性校验，详情请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/packing-tool#app打包指令">打包工具</a>。</p></li>      <li>       <p>多HAP场景下，同一应用的所有HAP、HSP的签名证书要保持一致。上架应用市场是以App Pack形式上架，应用市场分发时会将所有HAP从App Pack中拆分出来，同时对所有HAP进行重签名，以保证签名证书的一致性。在调试阶段，开发者通过命令行或DevEco Studio将HAP安装到设备上时，要保证所有HAP签名证书一致，否则会出现安装失败的问题，签名操作请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-signing" target="_blank">应用/元服务签名</a>。</p></li>     </ul>    </div>    <div class="tiledSection">     <h2 id="创建">创建<i class="anchor-icon anchor-icon-link" anchorid="创建" tips="复制节点链接"></i></h2>          <p>下面简要介绍如何通过DevEco Studio新建一个HAP模块。</p>     <ol>      <li>       <p>创建工程，构建第一个ArkTS应用。</p></li>      <li>       <p>在工程目录上单击右键，选择<strong>New &gt; Module</strong>。</p></li>      <li>       <p>在弹出的对话框中选择<strong>Empty Ability</strong>模板，单击<strong>Next</strong>。</p></li>      <li>       <p>在Module配置界面，配置<strong>Module name</strong>，选择<strong>Module Type</strong>和<strong>Device Type</strong>，然后单击<strong>Next</strong>。</p></li>      <li>       <p>在Ability配置界面，配置<strong>Ability name</strong>，然后单击<strong>Finish</strong>完成创建。</p></li>     </ol>    </div>    <div class="tiledSection">     <h2 id="开发">开发<i class="anchor-icon anchor-icon-link" anchorid="开发" tips="复制节点链接"></i></h2>          <ul>      <li>       <p>HAP中支持添加UIAbility组件或ExtensionAbility组件，以及pages页面。具体操作可参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-add-new-ability" target="_blank">在模块中添加Ability</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-add-page" target="_blank">添加Page</a>。</p></li>      <li>       <p>HAP中支持引用HAR或HSP共享包，详见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/har-package#使用">HAR的使用</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/in-app-hsp#使用">HSP的使用</a>。</p></li>     </ul>    </div>    <div class="tiledSection">     <h2 id="调试">调试<i class="anchor-icon anchor-icon-link" anchorid="调试" tips="复制节点链接"></i></h2>          <p>通过DevEco Studio编译打包，生成单个或者多个HAP，即可基于HAP进行调试。如需根据不同的部署环境、目标人群、运行环境等，将同一个HAP定制编译为不同版本，请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-customized-multi-targets-and-products-guides#section1011341611469" target="_blank">定制编译指导</a>。</p>     <p>开发者可以使用DevEco Studio或者hdc工具进行调试：</p>     <ul>      <li>       <p><strong>方法一：</strong> 使用DevEco Studio进行调试，详见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-run-debug-configurations" target="_blank">应用程序包调试方法</a>。</p></li>      <li>       <p><strong>方法二：</strong> 使用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/hdc">hdc工具</a>进行调试。</p>       <p>在调试前，需要先安装或更新HAP，此处有两种方式：</p>       <ul>        <li>         <p>直接使用hdc安装、更新HAP。</p>         <p>HAP的路径为开发平台上的文件路径，以Windows开发平台为例，命令参考如下：</p>         <div _ngcontent-jhr-c106="" class="highlight-div"><div _ngcontent-jhr-c106="" class="highlight-div-header"><div _ngcontent-jhr-c106="" class="highlight-div-header-left"><div _ngcontent-jhr-c106="" class="handle-button expand-button"><div _ngcontent-jhr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jhr-c106="" class="highlight-div-header-right"><div _ngcontent-jhr-c106="" class="handle-button ai-button"></div><div _ngcontent-jhr-c106="" class="handle-button line-button"><div _ngcontent-jhr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jhr-c106="" class="handle-button theme-button"><div _ngcontent-jhr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jhr-c106="" class="handle-button copy-button"><div _ngcontent-jhr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jhr-c106="" class="highlight-scroll-div"><pre class="shell prettyprint linenums hljs language-shell" hw-language="shell" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta prompt_"># </span><span class="language-bash">安装、更新，多HAP可以指定多个文件路径</span></li><li>hdc install entry.hap feature.hap</li><li><span class="hljs-meta prompt_"># </span><span class="language-bash">执行结果</span></li><li>install bundle successfully.</li><li><span class="hljs-meta prompt_"># </span><span class="language-bash">卸载</span></li><li>hdc uninstall com.example.myapplication</li><li><span class="hljs-meta prompt_"># </span><span class="language-bash">执行结果</span></li><li>uninstall bundle successfully.</li></ol></pre></div></div></li>        <li>         <p>先执行hdc shell，再使用bm工具安装、更新HAP。</p>         <p>HAP的文件路径为真机上的文件路径，命令参考如下：</p>         <div _ngcontent-jhr-c106="" class="highlight-div"><div _ngcontent-jhr-c106="" class="highlight-div-header"><div _ngcontent-jhr-c106="" class="highlight-div-header-left"><div _ngcontent-jhr-c106="" class="handle-button expand-button"><div _ngcontent-jhr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jhr-c106="" class="highlight-div-header-right"><div _ngcontent-jhr-c106="" class="handle-button ai-button"></div><div _ngcontent-jhr-c106="" class="handle-button line-button"><div _ngcontent-jhr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jhr-c106="" class="handle-button theme-button"><div _ngcontent-jhr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jhr-c106="" class="handle-button copy-button"><div _ngcontent-jhr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jhr-c106="" class="highlight-scroll-div"><pre class="shell prettyprint linenums hljs language-shell" hw-language="shell" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta prompt_"># </span><span class="language-bash">先执行hdc shell才能使用bm工具</span></li><li>hdc shell</li><li><span class="hljs-meta prompt_"># </span><span class="language-bash">安装、更新，多HAP可以指定多个文件路径</span></li><li>bm install -p /data/app/entry.hap /data/app/feature.hap</li><li><span class="hljs-meta prompt_"># </span><span class="language-bash">执行结果</span></li><li>install bundle successfully.</li><li><span class="hljs-meta prompt_"># </span><span class="language-bash">卸载</span></li><li>bm uninstall -n com.example.myapplication</li><li><span class="hljs-meta prompt_"># </span><span class="language-bash">执行结果</span></li><li>uninstall bundle successfully.</li></ol></pre></div></div></li>       </ul>       <p>完成HAP安装或更新后，即可参考相关调试命令进行<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/aa-tool#进入调试模式命令attach">调试</a>。</p></li>     </ul>    </div>    <div class="tiledSection">     <h2 id="示例代码">示例代码<i class="anchor-icon anchor-icon-link" anchorid="示例代码" tips="复制节点链接"></i></h2>          <ul>      <li><a href="https://gitcode.com/HarmonyOS_Samples/multi-hap" target="_blank">多HAP</a></li>     </ul>    </div>   </div>   <div></div></div>