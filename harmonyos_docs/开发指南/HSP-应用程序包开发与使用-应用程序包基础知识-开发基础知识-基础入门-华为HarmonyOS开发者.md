<h1 _ngcontent-irm-c119="" class="doc-title ng-star-inserted" title="HSP"> HSP </h1>

<div _ngcontent-irm-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p>HSP（Harmony Shared Package）是动态共享包，包含代码、C++库、资源和配置文件，通过HSP可以实现代码和资源的共享。HSP不支持独立发布上架，而是跟随宿主应用的APP包一起发布，与宿主应用同进程，具有相同的包名和生命周期。</p>    <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">      <ul>       <li>        <p>应用内HSP：在编译过程中与应用包名（bundleName）强耦合，只能给某个特定的应用使用。</p></li>       <li>        <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/integrated-hsp">集成态HSP</a>：构建、发布过程中，不与特定的应用包名耦合；使用时，工具链支持自动将集成态HSP的包名替换成宿主应用包名，并且会重新签名生成一个新的HSP包，作为宿主应用的安装包，这个新的HSP也属于宿主应用HAP的应用内HSP。</p></li>       <li>        <p>指南和API参考文档中如无特殊说明，默认HSP都为应用内HSP。</p></li>      </ul>     </div></div></div>    <div class="tiledSection">     <h2 id="使用场景">使用场景<i class="anchor-icon anchor-icon-link" anchorid="使用场景" tips="复制节点链接"></i></h2>          <ul>      <li>       <p>多个HAP/HSP共用的代码和资源放在同一个HSP中，可以提高代码、资源的可重用性和可维护性，同时编译打包时也只保留一份HSP代码和资源，能够控制应用包的大小。</p></li>      <li>       <p>HSP在运行时<a href="https://developer.huawei.com/consumer/cn/doc/best-practices/bpta-modular-design#section28312051291" target="_blank">按需加载</a>，有助于提升应用性能。</p></li>      <li>       <p>同一个组织内部的多个应用之间，可以使用集成态HSP实现代码和资源的共享。</p></li>     </ul>    </div>    <div class="tiledSection">     <h2 id="约束限制">约束限制<i class="anchor-icon anchor-icon-link" anchorid="约束限制" tips="复制节点链接"></i></h2>          <ul>      <li>HSP不支持在设备上单独安装/运行，需要与依赖该HSP的HAP一起安装/运行。在安装或更新时，多模块之间存在校验，详情参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/odule_installation_update_consistency_verification">一致性校验</a>。使用打包工具进行打包时，会进行合法性校验，详情请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/packing-tool">打包工具</a>。</li>      <li>从API version 14开始HSP支持在配置文件中<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/uiability-overview#声明配置">声明UIAbility</a>组件，但不支持具有入口能力的UIAbility（即skill标签配置了entity.system.home和ohos.want.action.home）。配置UIAbility的方法参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-add-new-ability#section18658758104318" target="_blank">模块中添加UIAbility</a>，HSP中UIAbility的启动方式与<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/uiability-intra-device-interaction">应用内启动UIAbility</a>方法相同。API version 13及之前版本，不支持在配置文件中声明<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/uiability-overview#声明配置">UIAbility</a>组件。</li>      <li>从API version 18开始HSP支持在配置文件中声明<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/extensionability-overview">ExtensionAbility</a>组件，但不支持具有入口能力的ExtensionAbility（即skill标签配置了entity.system.home和ohos.want.action.home）。HSP中配置ExtensionAbility的方法参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-add-new-ability#section18891639459" target="_blank">模块中添加ExtensionAbility</a>。 API version 17及之前版本，不支持在配置文件中声明<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/extensionability-overview">ExtensionAbility</a>组件。</li>      <li>HSP可以依赖其他HAR或HSP，也可以被HAP或者HSP依赖集成，但不支持循环依赖，也不支持依赖传递。</li>     </ul>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>循环依赖：例如有三个HSP，HSP-A、HSP-B和HSP-C，循环依赖指HSP-A依赖HSP-B，HSP-B依赖HSP-C，HSP-C又依赖HSP-A。</p>       <p>依赖传递：例如有三个HSP，HSP-A、HSP-B和HSP-C，依赖关系是HSP-A依赖HSP-B，HSP-B依赖HSP-C。不支持传递依赖指HSP-A可以使用HSP-B的方法和组件，但是HSP-A不能直接使用HSP-C的方法和组件。</p>      </div></div></div>    </div>    <div class="tiledSection">     <h2 id="创建">创建<i class="anchor-icon anchor-icon-link" anchorid="创建" tips="复制节点链接"></i></h2>          <p>使用DevEco Studio创建一个用于调用C++代码的HSP模块。并在“Configure New Module”页面中启用“Enable native”选项。详见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-hsp#section7717162312546" target="_blank">创建HSP模块</a>，以创建一个名为library的HSP模块为例。基本的工程目录结构如下：</p>     <div _ngcontent-irm-c106="" class="highlight-div"><div _ngcontent-irm-c106="" class="highlight-div-header"><div _ngcontent-irm-c106="" class="highlight-div-header-left"><div _ngcontent-irm-c106="" class="handle-button expand-button"><div _ngcontent-irm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-irm-c106="" class="highlight-div-header-right"><div _ngcontent-irm-c106="" class="handle-button ai-button"></div><div _ngcontent-irm-c106="" class="handle-button line-button"><div _ngcontent-irm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-irm-c106="" class="handle-button theme-button"><div _ngcontent-irm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-irm-c106="" class="handle-button copy-button"><div _ngcontent-irm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-irm-c106="" class="highlight-scroll-div"><pre class="txt prettyprint linenums hljs language-plaintext" hw-language="txt" data-highlighted="yes"><ol class="linenums"><li>MyApplication</li><li>├── library</li><li>│   ├── src</li><li>│   │   └── main</li><li>|   |       ├── cpp</li><li>|   |       |   ├── CMakeLists.txt    //C++代码编译的配置文件</li><li>|   |       |   └── napi_init.cpp     //NAPI模块初始化的C++文件</li><li>│   │       ├── ets</li><li>│   │       │   └── pages</li><li>│   │       │       └── index.ets     //模块library的页面文件</li><li>│   │       ├── resources             //模块library的资源目录</li><li>│   │       └── module.json5          //模块library的配置文件</li><li>│   ├── oh-package.json5              //模块级</li><li>│   ├── index.ets                     //入口文件index.ets</li><li>│   └── build-profile.json5           //模块级</li><li>└── build-profile.json5               //工程级</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="开发">开发<i class="anchor-icon anchor-icon-link" anchorid="开发" tips="复制节点链接"></i></h2>          <p>介绍如何导出HSP的ArkUI组件、接口、资源，供应用内的其他HAP/HSP引用。</p>    </div>    <div class="tiledSection">     <h3 id="导出arkui组件" class="firsth2">导出ArkUI组件<i class="anchor-icon anchor-icon-link" anchorid="导出arkui组件" tips="复制节点链接"></i></h3>          <p>ArkUI组件可以通过export导出，例如：</p>     <div _ngcontent-irm-c106="" class="highlight-div"><div _ngcontent-irm-c106="" class="highlight-div-header"><div _ngcontent-irm-c106="" class="highlight-div-header-left"><div _ngcontent-irm-c106="" class="handle-button expand-button"><div _ngcontent-irm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-irm-c106="" class="highlight-div-header-right"><div _ngcontent-irm-c106="" class="handle-button ai-button"></div><div _ngcontent-irm-c106="" class="handle-button line-button"><div _ngcontent-irm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-irm-c106="" class="handle-button theme-button"><div _ngcontent-irm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-irm-c106="" class="handle-button copy-button"><div _ngcontent-irm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-irm-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// library/src/main/ets/components/MyTitleBar.ets</span></li><li><span class="hljs-meta">@Component</span></li><li><span class="hljs-keyword">export</span> struct <span class="hljs-title class_">MyTitleBar</span> {</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Row</span>() {</li><li>      <span class="hljs-title class_">Text</span>($r(<span class="hljs-string">'app.string.library_title'</span>))</li><li>        .<span class="hljs-title function_">id</span>(<span class="hljs-string">'library'</span>)</li><li>        .<span class="hljs-title function_">fontFamily</span>(<span class="hljs-string">'HarmonyHeiTi'</span>)</li><li>        .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)</li><li>        .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">32</span>)</li><li>        .<span class="hljs-title function_">fontColor</span>($r(<span class="hljs-string">'app.color.text_color'</span>))</li><li>    }</li><li>    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div>     <p>在入口文件 index.ets 中声明对外暴露的接口。</p>     <div _ngcontent-irm-c106="" class="highlight-div"><div _ngcontent-irm-c106="" class="highlight-div-header"><div _ngcontent-irm-c106="" class="highlight-div-header-left"><div _ngcontent-irm-c106="" class="handle-button expand-button"><div _ngcontent-irm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-irm-c106="" class="highlight-div-header-right"><div _ngcontent-irm-c106="" class="handle-button ai-button"></div><div _ngcontent-irm-c106="" class="handle-button line-button"><div _ngcontent-irm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-irm-c106="" class="handle-button theme-button"><div _ngcontent-irm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-irm-c106="" class="handle-button copy-button"><div _ngcontent-irm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-irm-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// library/index.ets</span></li><li><span class="hljs-keyword">export</span> { <span class="hljs-title class_">MyTitleBar</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./src/main/ets/components/MyTitleBar'</span>;</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="导出类和方法">导出类和方法<i class="anchor-icon anchor-icon-link" anchorid="导出类和方法" tips="复制节点链接"></i></h3>          <p>通过export导出类和方法，例如：</p>     <div _ngcontent-irm-c106="" class="highlight-div"><div _ngcontent-irm-c106="" class="highlight-div-header"><div _ngcontent-irm-c106="" class="highlight-div-header-left"><div _ngcontent-irm-c106="" class="handle-button expand-button"><div _ngcontent-irm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-irm-c106="" class="highlight-div-header-right"><div _ngcontent-irm-c106="" class="handle-button ai-button"></div><div _ngcontent-irm-c106="" class="handle-button line-button"><div _ngcontent-irm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-irm-c106="" class="handle-button theme-button"><div _ngcontent-irm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-irm-c106="" class="handle-button copy-button"><div _ngcontent-irm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-irm-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// library/src/main/ets/utils/test.ets</span></li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Log</span> {</li><li>  <span class="hljs-keyword">static</span> <span class="hljs-title function_">info</span>(<span class="hljs-attr">msg</span>: <span class="hljs-built_in">string</span>): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(msg);</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">a: <span class="hljs-built_in">number</span>, b: <span class="hljs-built_in">number</span></span>): <span class="hljs-built_in">number</span> {</li><li>  <span class="hljs-keyword">return</span> a + b;</li><li>}</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">minus</span>(<span class="hljs-params">a: <span class="hljs-built_in">number</span>, b: <span class="hljs-built_in">number</span></span>): <span class="hljs-built_in">number</span> {</li><li>  <span class="hljs-keyword">return</span> a - b;</li><li>}</li></ol></pre></div></div>     <p>在入口文件 index.ets 中声明对外暴露的接口。</p>     <div _ngcontent-irm-c106="" class="highlight-div"><div _ngcontent-irm-c106="" class="highlight-div-header"><div _ngcontent-irm-c106="" class="highlight-div-header-left"><div _ngcontent-irm-c106="" class="handle-button expand-button"><div _ngcontent-irm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-irm-c106="" class="highlight-div-header-right"><div _ngcontent-irm-c106="" class="handle-button ai-button"></div><div _ngcontent-irm-c106="" class="handle-button line-button"><div _ngcontent-irm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-irm-c106="" class="handle-button theme-button"><div _ngcontent-irm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-irm-c106="" class="handle-button copy-button"><div _ngcontent-irm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-irm-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// library/index.ets</span></li><li><span class="hljs-keyword">export</span> { <span class="hljs-title class_">Log</span>, add, minus } <span class="hljs-keyword">from</span> <span class="hljs-string">'./src/main/ets/utils/test'</span>;</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="导出native方法">导出native方法<i class="anchor-icon anchor-icon-link" anchorid="导出native方法" tips="复制节点链接"></i></h3>          <p>在HSP中也可以包含C++编写的so。对于so中的native方法，HSP通过间接的方式导出，以导出liblibrary.so的乘法接口multi为例：</p>     <div _ngcontent-irm-c106="" class="highlight-div"><div _ngcontent-irm-c106="" class="highlight-div-header"><div _ngcontent-irm-c106="" class="highlight-div-header-left"><div _ngcontent-irm-c106="" class="handle-button expand-button"><div _ngcontent-irm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-irm-c106="" class="highlight-div-header-right"><div _ngcontent-irm-c106="" class="handle-button ai-button"></div><div _ngcontent-irm-c106="" class="handle-button line-button"><div _ngcontent-irm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-irm-c106="" class="handle-button theme-button"><div _ngcontent-irm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-irm-c106="" class="handle-button copy-button"><div _ngcontent-irm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-irm-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// library/src/main/ets/utils/nativeTest.ets</span></li><li><span class="hljs-keyword">import</span> native <span class="hljs-keyword">from</span> <span class="hljs-string">'liblibrary.so'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">nativeMulti</span>(<span class="hljs-params">a: <span class="hljs-built_in">number</span>, b: <span class="hljs-built_in">number</span></span>): <span class="hljs-built_in">number</span> {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">result</span>: <span class="hljs-built_in">number</span> = native.<span class="hljs-title function_">multi</span>(a, b);</li><li>  <span class="hljs-keyword">return</span> result;</li><li>}</li></ol></pre></div></div>     <p>在入口文件 index.ets 中声明对外暴露的接口。</p>     <div _ngcontent-irm-c106="" class="highlight-div"><div _ngcontent-irm-c106="" class="highlight-div-header"><div _ngcontent-irm-c106="" class="highlight-div-header-left"><div _ngcontent-irm-c106="" class="handle-button expand-button"><div _ngcontent-irm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-irm-c106="" class="highlight-div-header-right"><div _ngcontent-irm-c106="" class="handle-button ai-button"></div><div _ngcontent-irm-c106="" class="handle-button line-button"><div _ngcontent-irm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-irm-c106="" class="handle-button theme-button"><div _ngcontent-irm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-irm-c106="" class="handle-button copy-button"><div _ngcontent-irm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-irm-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// library/index.ets</span></li><li><span class="hljs-keyword">export</span> { nativeMulti } <span class="hljs-keyword">from</span> <span class="hljs-string">'./src/main/ets/utils/nativeTest'</span>;</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="通过r访问hsp中的资源">通过$r访问HSP中的资源<i class="anchor-icon anchor-icon-link" anchorid="通过r访问hsp中的资源" tips="复制节点链接"></i></h3>          <p>在组件中，经常需要使用字符串、图片等资源。HSP中的组件需要使用资源时，一般将其所用资源放在HSP包内，而非放在HSP的使用方处，以符合高内聚低耦合的原则。</p>     <p>在工程中，常通过$r/$rawfile的形式引用应用资源。可以用$r/$rawfile访问本模块resources目录下的资源，如访问resources目录下定义的图片src/main/resources/base/media/example.png时，可以用$r("app.media.example")。有关$r/$rawfile的使用方式，请参阅文档<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/resource-categories-and-access">资源分类与访问</a>中“资源访问-应用资源”小节。</p>     <p>不推荐使用相对路径的方式，容易引用错误路径。例如：</p>     <p>当要引用上述同一图片资源时，在HSP模块中使用Image("../../resources/base/media/example.png")，实际上该Image组件访问的是HSP调用方（如entry）下的资源entry/src/main/resources/base/media/example.png。</p>     <div _ngcontent-irm-c106="" class="highlight-div"><div _ngcontent-irm-c106="" class="highlight-div-header"><div _ngcontent-irm-c106="" class="highlight-div-header-left"><div _ngcontent-irm-c106="" class="handle-button expand-button"><div _ngcontent-irm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-irm-c106="" class="highlight-div-header-right"><div _ngcontent-irm-c106="" class="handle-button ai-button"></div><div _ngcontent-irm-c106="" class="handle-button line-button"><div _ngcontent-irm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-irm-c106="" class="handle-button theme-button"><div _ngcontent-irm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-irm-c106="" class="handle-button copy-button"><div _ngcontent-irm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-irm-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// library/src/main/ets/pages/Index.ets</span></li><li><span class="hljs-comment">// 正确用例</span></li><li><span class="hljs-title class_">Image</span>($r(<span class="hljs-string">'app.media.example'</span>))</li><li>  .<span class="hljs-title function_">id</span>(<span class="hljs-string">'example'</span>)</li><li>  .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-string">'48px'</span>)</li><li><span class="hljs-comment">// 错误用例</span></li><li><span class="hljs-title class_">Image</span>(<span class="hljs-string">"../../resources/base/media/example.png"</span>)</li><li>  .<span class="hljs-title function_">id</span>(<span class="hljs-string">'example'</span>)</li><li>  .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-string">'48px'</span>)</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="导出hsp中的资源">导出HSP中的资源<i class="anchor-icon anchor-icon-link" anchorid="导出hsp中的资源" tips="复制节点链接"></i></h3>          <p>跨包访问HSP内资源时，推荐实现一个资源管理类，以封装对外导出的资源。采用这种方式，具有如下优点：</p>     <ul>      <li>HSP开发者可以控制自己需要导出的资源，不需要对外暴露的资源可以不用导出。</li>      <li>使用方无须感知HSP内部的资源名称。当HSP内部的资源名称发生变化时，也不需要使用方跟着修改。</li>     </ul>     <p>其具体实现如下：</p>     <p>将需要对外提供的资源封装为一个资源管理类：</p>     <div _ngcontent-irm-c106="" class="highlight-div"><div _ngcontent-irm-c106="" class="highlight-div-header"><div _ngcontent-irm-c106="" class="highlight-div-header-left"><div _ngcontent-irm-c106="" class="handle-button expand-button"><div _ngcontent-irm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-irm-c106="" class="highlight-div-header-right"><div _ngcontent-irm-c106="" class="handle-button ai-button"></div><div _ngcontent-irm-c106="" class="handle-button line-button"><div _ngcontent-irm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-irm-c106="" class="handle-button theme-button"><div _ngcontent-irm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-irm-c106="" class="handle-button copy-button"><div _ngcontent-irm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-irm-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// library/src/main/ets/ResManager.ets</span></li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ResManager</span>{</li><li>  <span class="hljs-keyword">static</span> <span class="hljs-title function_">getPic</span>(): <span class="hljs-title class_">Resource</span>{</li><li>    <span class="hljs-keyword">return</span> $r(<span class="hljs-string">'app.media.pic'</span>);</li><li>  }</li><li>  <span class="hljs-keyword">static</span> <span class="hljs-title function_">getDesc</span>(): <span class="hljs-title class_">Resource</span>{</li><li>    <span class="hljs-keyword">return</span> $r(<span class="hljs-string">'app.string.shared_desc'</span>);</li><li>  }</li><li>}</li></ol></pre></div></div>     <p>在入口文件 index.ets 中声明对外暴露的接口。</p>     <div _ngcontent-irm-c106="" class="highlight-div"><div _ngcontent-irm-c106="" class="highlight-div-header"><div _ngcontent-irm-c106="" class="highlight-div-header-left"><div _ngcontent-irm-c106="" class="handle-button expand-button"><div _ngcontent-irm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-irm-c106="" class="highlight-div-header-right"><div _ngcontent-irm-c106="" class="handle-button ai-button"></div><div _ngcontent-irm-c106="" class="handle-button line-button"><div _ngcontent-irm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-irm-c106="" class="handle-button theme-button"><div _ngcontent-irm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-irm-c106="" class="handle-button copy-button"><div _ngcontent-irm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-irm-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// library/index.ets</span></li><li><span class="hljs-keyword">export</span> { <span class="hljs-title class_">ResManager</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./src/main/ets/ResManager'</span>;</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="使用">使用<i class="anchor-icon anchor-icon-link" anchorid="使用" tips="复制节点链接"></i></h2>          <p>介绍如何引用HSP中的接口，以及如何通过页面路由实现HSP的pages页面跳转与返回。</p>    </div>    <div class="tiledSection">     <h3 id="引用hsp中的接口" class="firsth2">引用HSP中的接口<i class="anchor-icon anchor-icon-link" anchorid="引用hsp中的接口" tips="复制节点链接"></i></h3>          <p>要使用HSP中的接口，首先需要在使用方的 oh-package.json5 文件中配置对它的依赖。具体配置方法请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-har-import" target="_blank">引用动态共享包</a>。</p>     <p>依赖配置成功后，就可以像使用HAR一样调用HSP的对外接口了。例如，上面的library已经导出了下面这些接口：</p>     <div _ngcontent-irm-c106="" class="highlight-div"><div _ngcontent-irm-c106="" class="highlight-div-header"><div _ngcontent-irm-c106="" class="highlight-div-header-left"><div _ngcontent-irm-c106="" class="handle-button expand-button"><div _ngcontent-irm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-irm-c106="" class="highlight-div-header-right"><div _ngcontent-irm-c106="" class="handle-button ai-button"></div><div _ngcontent-irm-c106="" class="handle-button line-button"><div _ngcontent-irm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-irm-c106="" class="handle-button theme-button"><div _ngcontent-irm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-irm-c106="" class="handle-button copy-button"><div _ngcontent-irm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-irm-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// library/index.ets</span></li><li><span class="hljs-keyword">export</span> { <span class="hljs-title class_">Log</span>, add, minus } <span class="hljs-keyword">from</span> <span class="hljs-string">'./src/main/ets/utils/test'</span>;</li><li><span class="hljs-keyword">export</span> { <span class="hljs-title class_">MyTitleBar</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./src/main/ets/components/MyTitleBar'</span>;</li><li><span class="hljs-keyword">export</span> { <span class="hljs-title class_">ResManager</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'./src/main/ets/ResManager'</span>;</li><li><span class="hljs-keyword">export</span> { nativeMulti } <span class="hljs-keyword">from</span> <span class="hljs-string">'./src/main/ets/utils/nativeTest'</span>;</li></ol></pre></div></div>     <p>在使用方的代码中，可以这样使用：</p>     <div _ngcontent-irm-c106="" class="highlight-div"><div _ngcontent-irm-c106="" class="highlight-div-header"><div _ngcontent-irm-c106="" class="highlight-div-header-left"><div _ngcontent-irm-c106="" class="handle-button expand-button"><div _ngcontent-irm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-irm-c106="" class="highlight-div-header-right"><div _ngcontent-irm-c106="" class="handle-button ai-button"></div><div _ngcontent-irm-c106="" class="handle-button line-button"><div _ngcontent-irm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-irm-c106="" class="handle-button theme-button"><div _ngcontent-irm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-irm-c106="" class="handle-button copy-button"><div _ngcontent-irm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-irm-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// entry/src/main/ets/pages/index.ets</span></li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Log</span>, add, <span class="hljs-title class_">MyTitleBar</span>, <span class="hljs-title class_">ResManager</span>, nativeMulti } <span class="hljs-keyword">from</span> <span class="hljs-string">'library'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@kit.BasicServicesKit"</span>;</li><li><span class="hljs-keyword">import</span> { application} <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">TAG</span> = <span class="hljs-string">'Index'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">''</span>;</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">List</span>() {</li><li>        <span class="hljs-title class_">ListItem</span>() {</li><li>          <span class="hljs-title class_">MyTitleBar</span>()</li><li>        }</li><li>        .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">left</span>: <span class="hljs-string">'35px'</span>, <span class="hljs-attr">top</span>: <span class="hljs-string">'32px'</span> })</li><li>
</li><li>        <span class="hljs-title class_">ListItem</span>() {</li><li>          <span class="hljs-title class_">Text</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span>)</li><li>            .<span class="hljs-title function_">fontFamily</span>(<span class="hljs-string">'HarmonyHeiTi'</span>)</li><li>            .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">18</span>)</li><li>            .<span class="hljs-title function_">textAlign</span>(<span class="hljs-title class_">TextAlign</span>.<span class="hljs-property">Start</span>)</li><li>            .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>            .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)</li><li>        }</li><li>        .<span class="hljs-title function_">width</span>(<span class="hljs-string">'685px'</span>)</li><li>        .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">30</span>, <span class="hljs-attr">bottom</span>: <span class="hljs-number">10</span> })</li><li>
</li><li>        <span class="hljs-title class_">ListItem</span>() {</li><li>          <span class="hljs-comment">// ResManager返回的Resource对象，可以传给组件直接使用，也可以从中取出资源来使用</span></li><li>          <span class="hljs-title class_">Image</span>(<span class="hljs-title class_">ResManager</span>.<span class="hljs-title function_">getPic</span>())</li><li>            .<span class="hljs-title function_">id</span>(<span class="hljs-string">'image'</span>)</li><li>            .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-string">'48px'</span>)</li><li>        }</li><li>        .<span class="hljs-title function_">width</span>(<span class="hljs-string">'685px'</span>)</li><li>        .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">10</span>, <span class="hljs-attr">bottom</span>: <span class="hljs-number">10</span> })</li><li>        .<span class="hljs-title function_">padding</span>({ <span class="hljs-attr">left</span>: <span class="hljs-number">12</span>, <span class="hljs-attr">right</span>: <span class="hljs-number">12</span>, <span class="hljs-attr">top</span>: <span class="hljs-number">4</span>, <span class="hljs-attr">bottom</span>: <span class="hljs-number">4</span> })</li><li>
</li><li>        <span class="hljs-title class_">ListItem</span>() {</li><li>          <span class="hljs-title class_">Text</span>($r(<span class="hljs-string">'app.string.add'</span>))</li><li>            .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">18</span>)</li><li>            .<span class="hljs-title function_">textAlign</span>(<span class="hljs-title class_">TextAlign</span>.<span class="hljs-property">Start</span>)</li><li>            .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>            .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-number">500</span>)</li><li>            .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>        }</li><li>        .<span class="hljs-title function_">id</span>(<span class="hljs-string">'add'</span>)</li><li>        .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">24</span>)</li><li>        .<span class="hljs-title function_">width</span>(<span class="hljs-string">'685px'</span>)</li><li>        .<span class="hljs-title function_">height</span>(<span class="hljs-string">'84px'</span>)</li><li>        .<span class="hljs-title function_">backgroundColor</span>($r(<span class="hljs-string">'sys.color.ohos_id_color_foreground_contrary'</span>))</li><li>        .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">10</span>, <span class="hljs-attr">bottom</span>: <span class="hljs-number">10</span> })</li><li>        .<span class="hljs-title function_">padding</span>({ <span class="hljs-attr">left</span>: <span class="hljs-number">12</span>, <span class="hljs-attr">right</span>: <span class="hljs-number">12</span>, <span class="hljs-attr">top</span>: <span class="hljs-number">4</span>, <span class="hljs-attr">bottom</span>: <span class="hljs-number">4</span> })</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-title class_">Log</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'add button click!'</span>);</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span> = <span class="hljs-string">'result: '</span> + <span class="hljs-title function_">add</span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>);</li><li>        })</li><li>
</li><li>        <span class="hljs-title class_">ListItem</span>() {</li><li>          <span class="hljs-title class_">Text</span>(<span class="hljs-title class_">ResManager</span>.<span class="hljs-title function_">getDesc</span>())</li><li>            .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">18</span>)</li><li>            .<span class="hljs-title function_">textAlign</span>(<span class="hljs-title class_">TextAlign</span>.<span class="hljs-property">Start</span>)</li><li>            .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>            .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-number">500</span>)</li><li>            .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>        }</li><li>        .<span class="hljs-title function_">id</span>(<span class="hljs-string">'getStringValue'</span>)</li><li>        .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">24</span>)</li><li>        .<span class="hljs-title function_">width</span>(<span class="hljs-string">'685px'</span>)</li><li>        .<span class="hljs-title function_">height</span>(<span class="hljs-string">'84px'</span>)</li><li>        .<span class="hljs-title function_">backgroundColor</span>($r(<span class="hljs-string">'sys.color.ohos_id_color_foreground_contrary'</span>))</li><li>        .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">10</span>, <span class="hljs-attr">bottom</span>: <span class="hljs-number">10</span> })</li><li>        .<span class="hljs-title function_">padding</span>({ <span class="hljs-attr">left</span>: <span class="hljs-number">12</span>, <span class="hljs-attr">right</span>: <span class="hljs-number">12</span>, <span class="hljs-attr">top</span>: <span class="hljs-number">4</span>, <span class="hljs-attr">bottom</span>: <span class="hljs-number">4</span> })</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-comment">// 先通过当前application.createModuleContext获取hsp模块的上下文，再获取hsp模块的resourceManager，然后再调用resourceManager的接口获取资源</span></li><li>          application.<span class="hljs-title function_">createModuleContext</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>()?.<span class="hljs-title function_">getHostContext</span>(), <span class="hljs-string">"library"</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">context:Context</span>)=&gt;</span>{</li><li>              context.<span class="hljs-property">resourceManager</span>.<span class="hljs-title function_">getStringValue</span>(<span class="hljs-title class_">ResManager</span>.<span class="hljs-title function_">getDesc</span>().<span class="hljs-property">id</span>)</li><li>              .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">value</span> =&gt;</span> {</li><li>                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'getStringValue is '</span> + value);</li><li>                <span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span> = <span class="hljs-string">'getStringValue is '</span> + value;</li><li>              })</li><li>              .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'getStringValue promise error is '</span> + err);</li><li>              });</li><li>          }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'createModuleContext promise error is '</span> + err);</li><li>          });</li><li>        })</li><li>
</li><li>        <span class="hljs-title class_">ListItem</span>() {</li><li>          <span class="hljs-title class_">Text</span>($r(<span class="hljs-string">'app.string.native_multi'</span>))</li><li>            .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">18</span>)</li><li>            .<span class="hljs-title function_">textAlign</span>(<span class="hljs-title class_">TextAlign</span>.<span class="hljs-property">Start</span>)</li><li>            .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>            .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-number">500</span>)</li><li>            .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>        }</li><li>        .<span class="hljs-title function_">id</span>(<span class="hljs-string">'nativeMulti'</span>)</li><li>        .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">24</span>)</li><li>        .<span class="hljs-title function_">width</span>(<span class="hljs-string">'685px'</span>)</li><li>        .<span class="hljs-title function_">height</span>(<span class="hljs-string">'84px'</span>)</li><li>        .<span class="hljs-title function_">backgroundColor</span>($r(<span class="hljs-string">'sys.color.ohos_id_color_foreground_contrary'</span>))</li><li>        .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">10</span>, <span class="hljs-attr">bottom</span>: <span class="hljs-number">10</span> })</li><li>        .<span class="hljs-title function_">padding</span>({ <span class="hljs-attr">left</span>: <span class="hljs-number">12</span>, <span class="hljs-attr">right</span>: <span class="hljs-number">12</span>, <span class="hljs-attr">top</span>: <span class="hljs-number">4</span>, <span class="hljs-attr">bottom</span>: <span class="hljs-number">4</span> })</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-title class_">Log</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'nativeMulti button click!'</span>);</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span> = <span class="hljs-string">'result: '</span> + <span class="hljs-title function_">nativeMulti</span>(<span class="hljs-number">3</span>, <span class="hljs-number">4</span>);</li><li>        })</li><li>      }</li><li>      .<span class="hljs-title function_">alignListItem</span>(<span class="hljs-title class_">ListItemAlign</span>.<span class="hljs-property">Center</span>)</li><li>    }</li><li>    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    .<span class="hljs-title function_">backgroundColor</span>($r(<span class="hljs-string">'app.color.page_background'</span>))</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="页面跳转和返回">页面跳转和返回<i class="anchor-icon anchor-icon-link" anchorid="页面跳转和返回" tips="复制节点链接"></i></h3>          <p>开发者想在entry模块中，添加一个按钮跳转至library模块中的menu页面（路径为：library/src/main/ets/pages/library_menu.ets），那么可以在使用方的代码（entry模块下的Index.ets，路径为：entry/src/main/ets/pages/Index.ets）里这样使用：</p>     <div _ngcontent-irm-c106="" class="highlight-div"><div _ngcontent-irm-c106="" class="highlight-div-header"><div _ngcontent-irm-c106="" class="highlight-div-header-left"><div _ngcontent-irm-c106="" class="handle-button expand-button"><div _ngcontent-irm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-irm-c106="" class="highlight-div-header-right"><div _ngcontent-irm-c106="" class="handle-button ai-button"></div><div _ngcontent-irm-c106="" class="handle-button line-button"><div _ngcontent-irm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-irm-c106="" class="handle-button theme-button"><div _ngcontent-irm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-irm-c106="" class="handle-button copy-button"><div _ngcontent-irm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-irm-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// entry/src/main/ets/pages/Index.ets</span></li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">''</span>;</li><li>  <span class="hljs-attr">pathStack</span>: <span class="hljs-title class_">NavPathStack</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">NavPathStack</span>();</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Navigation</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">pathStack</span>) {</li><li>      <span class="hljs-title class_">Column</span>() {</li><li>        <span class="hljs-title class_">List</span>() {</li><li>          <span class="hljs-title class_">ListItem</span>() {</li><li>            <span class="hljs-title class_">Text</span>($r(<span class="hljs-string">'app.string.click_to_menu'</span>))</li><li>              .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">18</span>)</li><li>              .<span class="hljs-title function_">textAlign</span>(<span class="hljs-title class_">TextAlign</span>.<span class="hljs-property">Start</span>)</li><li>              .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>              .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-number">500</span>)</li><li>              .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>          }</li><li>          .<span class="hljs-title function_">id</span>(<span class="hljs-string">'clickToMenu'</span>)</li><li>          .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">24</span>)</li><li>          .<span class="hljs-title function_">width</span>(<span class="hljs-string">'685px'</span>)</li><li>          .<span class="hljs-title function_">height</span>(<span class="hljs-string">'84px'</span>)</li><li>          .<span class="hljs-title function_">backgroundColor</span>($r(<span class="hljs-string">'sys.color.ohos_id_color_foreground_contrary'</span>))</li><li>          .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">10</span>, <span class="hljs-attr">bottom</span>: <span class="hljs-number">10</span> })</li><li>          .<span class="hljs-title function_">padding</span>({</li><li>            <span class="hljs-attr">left</span>: <span class="hljs-number">12</span>,</li><li>            <span class="hljs-attr">right</span>: <span class="hljs-number">12</span>,</li><li>            <span class="hljs-attr">top</span>: <span class="hljs-number">4</span>,</li><li>            <span class="hljs-attr">bottom</span>: <span class="hljs-number">4</span></li><li>          })</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">pathStack</span>.<span class="hljs-title function_">pushPathByName</span>(<span class="hljs-string">'library_menu'</span>, <span class="hljs-literal">null</span>)</li><li>          })</li><li>        }</li><li>        .<span class="hljs-title function_">alignListItem</span>(<span class="hljs-title class_">ListItemAlign</span>.<span class="hljs-property">Center</span>)</li><li>      }</li><li>      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>      .<span class="hljs-title function_">backgroundColor</span>($r(<span class="hljs-string">'app.color.page_background'</span>))</li><li>      .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>    }.<span class="hljs-title function_">title</span>(<span class="hljs-string">"Navigation_index"</span>)</li><li>    .<span class="hljs-title function_">mode</span>(<span class="hljs-title class_">NavigationMode</span>.<span class="hljs-property">Stack</span>)</li><li>  }</li><li>}</li></ol></pre></div></div>     <p>在library下新增page文件（library/src/main/ets/pages/library_menu.ets），其中'back_to_index'的按钮返回上一页。</p>     <div _ngcontent-irm-c106="" class="highlight-div"><div _ngcontent-irm-c106="" class="highlight-div-header"><div _ngcontent-irm-c106="" class="highlight-div-header-left"><div _ngcontent-irm-c106="" class="handle-button expand-button"><div _ngcontent-irm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-irm-c106="" class="highlight-div-header-right"><div _ngcontent-irm-c106="" class="handle-button ai-button"></div><div _ngcontent-irm-c106="" class="handle-button line-button"><div _ngcontent-irm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-irm-c106="" class="handle-button theme-button"><div _ngcontent-irm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-irm-c106="" class="handle-button copy-button"><div _ngcontent-irm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-irm-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// library/src/main/ets/pages/library_menu.ets</span></li><li><span class="hljs-meta">@Builder</span></li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">PageOneBuilder</span>(<span class="hljs-params"></span>) {</li><li>  <span class="hljs-title class_">Library</span>_Menu()</li><li>}</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li><span class="hljs-keyword">export</span> struct <span class="hljs-title class_">Library</span>_Menu {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'Hello World'</span>;</li><li>  <span class="hljs-attr">pathStack</span>: <span class="hljs-title class_">NavPathStack</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">NavPathStack</span>();</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">NavDestination</span>() {</li><li>      <span class="hljs-title class_">Row</span>() {</li><li>        <span class="hljs-title class_">Column</span>() {</li><li>          <span class="hljs-title class_">Text</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span>)</li><li>            .<span class="hljs-title function_">fontSize</span>($r(<span class="hljs-string">'app.float.page_text_font_size'</span>))</li><li>            .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)</li><li>            .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>              <span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span> = <span class="hljs-string">'Welcome'</span>;</li><li>            })</li><li>          <span class="hljs-title class_">Button</span>(<span class="hljs-string">"back_to_index"</span>).<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">50</span>).<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">pathStack</span>.<span class="hljs-title function_">pop</span>();</li><li>          })</li><li>        }</li><li>        .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>      }</li><li>      .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>    }.<span class="hljs-title function_">title</span>(<span class="hljs-string">'Library_Menu'</span>)</li><li>    .<span class="hljs-title function_">onReady</span>(<span class="hljs-function">(<span class="hljs-params">context: NavDestinationContext</span>) =&gt;</span> {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">pathStack</span> = context.<span class="hljs-property">pathStack</span></li><li>    })</li><li>  }</li><li>}</li></ol></pre></div></div>     <p>需要在library模块下新增route_map.json文件（library/src/main/resources/base/profile/route_map.json）。</p>     <div _ngcontent-irm-c106="" class="highlight-div"><div _ngcontent-irm-c106="" class="highlight-div-header"><div _ngcontent-irm-c106="" class="highlight-div-header-left"><div _ngcontent-irm-c106="" class="handle-button expand-button"><div _ngcontent-irm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-irm-c106="" class="highlight-div-header-right"><div _ngcontent-irm-c106="" class="handle-button ai-button"></div><div _ngcontent-irm-c106="" class="handle-button line-button"><div _ngcontent-irm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-irm-c106="" class="handle-button theme-button"><div _ngcontent-irm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-irm-c106="" class="handle-button copy-button"><div _ngcontent-irm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-irm-c106="" class="highlight-scroll-div"><pre class="json prettyprint linenums hljs language-json" hw-language="json" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-punctuation">{</span></li><li>  <span class="hljs-attr">"routerMap"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span></li><li>    <span class="hljs-punctuation">{</span></li><li>      <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"library_menu"</span><span class="hljs-punctuation">,</span></li><li>      <span class="hljs-attr">"pageSourceFile"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"src/main/ets/pages/library_menu.ets"</span><span class="hljs-punctuation">,</span></li><li>      <span class="hljs-attr">"buildFunction"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"PageOneBuilder"</span><span class="hljs-punctuation">,</span></li><li>      <span class="hljs-attr">"data"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>        <span class="hljs-attr">"description"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"this is library_menu"</span></li><li>      <span class="hljs-punctuation">}</span></li><li>    <span class="hljs-punctuation">}</span></li><li>  <span class="hljs-punctuation">]</span></li><li><span class="hljs-punctuation">}</span></li></ol></pre></div></div>     <p>在library模块下的配置文件（library/src/main/module.json5）中配置json文件。</p>     <div _ngcontent-irm-c106="" class="highlight-div"><div _ngcontent-irm-c106="" class="highlight-div-header"><div _ngcontent-irm-c106="" class="highlight-div-header-left"><div _ngcontent-irm-c106="" class="handle-button expand-button"><div _ngcontent-irm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-irm-c106="" class="highlight-div-header-right"><div _ngcontent-irm-c106="" class="handle-button ai-button"></div><div _ngcontent-irm-c106="" class="handle-button line-button"><div _ngcontent-irm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-irm-c106="" class="handle-button theme-button"><div _ngcontent-irm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-irm-c106="" class="handle-button copy-button"><div _ngcontent-irm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-irm-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" data-highlighted="yes"><ol class="linenums"><li>{</li><li>  <span class="hljs-string">"module"</span>: {</li><li>    <span class="hljs-string">"name"</span>: <span class="hljs-string">"library"</span>,</li><li>    <span class="hljs-string">"type"</span>: <span class="hljs-string">"shared"</span>,</li><li>    <span class="hljs-string">"description"</span>: <span class="hljs-string">"$string:shared_desc"</span>,</li><li>    <span class="hljs-string">"deviceTypes"</span>: [</li><li>      <span class="hljs-string">"phone"</span>,</li><li>      <span class="hljs-string">"tablet"</span>,</li><li>      <span class="hljs-string">"2in1"</span></li><li>    ],</li><li>    <span class="hljs-string">"deliveryWithInstall"</span>: <span class="hljs-keyword">true</span>,</li><li>    <span class="hljs-string">"pages"</span>: <span class="hljs-string">"$profile:main_pages"</span>,</li><li>    <span class="hljs-string">"routerMap"</span>: <span class="hljs-string">"$profile:route_map"</span> <span class="hljs-comment">//新增配置，指向route_map.json文件</span></li><li>  }</li><li>}</li></ol></pre></div></div>     <p>页面跳转和页面返回都使用了Navigation的特性，详情参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-navigation-navigation#路由操作">Navigation跳转</a>。</p>    </div>   </div>   <div></div></div>