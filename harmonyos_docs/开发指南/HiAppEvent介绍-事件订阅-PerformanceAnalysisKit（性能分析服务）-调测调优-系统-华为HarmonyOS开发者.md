<h1 _ngcontent-vjm-c119="" class="doc-title ng-star-inserted" title="HiAppEvent介绍"> HiAppEvent介绍 </h1>

<div _ngcontent-vjm-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <div class="tiledSection">     <h2 id="简介">简介<i class="anchor-icon anchor-icon-link" anchorid="简介" tips="复制节点链接"></i></h2>          <p>HiAppEvent是系统为应用开发者提供的事件打点机制，支持记录应用运行过程中的故障、统计、安全和行为事件，帮助开发者定位问题、分析应用运行情况，统计访问量、用户活跃度、操作习惯以及其他影响用户使用产品的关键因素。</p>    </div>    <div class="tiledSection">     <h2 id="基本概念">基本概念<i class="anchor-icon anchor-icon-link" anchorid="基本概念" tips="复制节点链接"></i></h2>          <p><strong>打点</strong>：记录用户操作引起的变化，提供业务数据信息，供开发、产品、运维分析。</p>     <ul>      <li>       <p>事件领域：标识事件的领域，建议设置为业务领域名称，以便于区分不同的业务领域。</p></li>      <li>       <p>事件名称：指定事件的名称，建议设置为具体的业务名称，以便于描述实际的业务意义。</p></li>      <li>       <p>事件类型：指定事件的类型，支持以下四种类型事件：</p>       <ul>        <li>行为事件：记录用户日常操作行为的事件，例如按钮点击、界面跳转等行为。</li>        <li>故障事件：定位和分析应用故障的事件，例如界面卡顿、网络中断等故障。</li>        <li>统计事件：统计和度量应用关键行为的事件，例如对使用时长、访问数等的统计。</li>        <li>安全事件：记录涉及应用安全行为的事件，例如用户授权等行为。</li>       </ul></li>      <li>       <p>事件参数：指定事件的参数，每个事件可以包含一组参数，建议设置为事件属性或事件发生的上下文信息，以便于描述事件的详细信息。</p></li>     </ul>     <p><strong>事件订阅</strong>：通过HiAppEvent的接口<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-hiviewdfx-hiappevent#hiappeventaddwatcher" target="_blank">addWatcher</a>，开发者可以注册监听自己关注的系统事件或应用事件。目的是当订阅的事件发生后，接收事件的回调信息并进行处理。</p>    </div>    <div class="tiledSection">     <h2 id="实现原理">实现原理<i class="anchor-icon anchor-icon-link" anchorid="实现原理" tips="复制节点链接"></i></h2>         </div>    <div class="tiledSection">     <h3 id="系统事件订阅机制" class="firsth2">系统事件订阅机制<i class="anchor-icon anchor-icon-link" anchorid="系统事件订阅机制" tips="复制节点链接"></i></h3>          <p>在当前系统应用沙箱机制下，应用进程仅可以直接访问自己的应用沙箱目录，参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/app-sandbox-directory">应用沙箱目录</a>。而系统事件信息的存放路径不在应用沙箱目录中，因此无法直接获取。</p>     <p>应用调用HiAppEvent的addWatcher接口订阅系统事件并创建共享目录。当应用进程发生故障时，DFX系统捕获相关信息，生成事件和日志，并写入到共享目录。HiAppEvent监听到事件后，将事件回调给应用。</p>     <p><span><img originheight="444" originwidth="797" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211115035.88821415885311690194688396774890:50001231000000:2800:3210C46A5ED0A7EEDD300582B843E21477A408F27B3EF28C07E7F561C682561C.png" width="797" height="444"></span></p>    </div>    <div class="tiledSection">     <h3 id="应用事件订阅机制">应用事件订阅机制<i class="anchor-icon anchor-icon-link" anchorid="应用事件订阅机制" tips="复制节点链接"></i></h3>          <p>应用调用addWatcher接口订阅关注的应用事件后，还需在应用事件发生时，调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-hiviewdfx-hiappevent#hiappeventwrite-1" target="_blank">write</a>接口进行打点，用来记录应用事件。</p>     <p>HiAppEvent通过事件领域和事件名称关联应用事件，并通过addWatcher接口设置的回调方式将事件回调给应用。</p>     <p><span><img originheight="462" originwidth="472" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211115035.38681324860800706274859031249982:50001231000000:2800:A26D027630F61545DF42861F5EB4119EE1C5DEC285C393305E499229230A4316.png" width="472" height="462"></span></p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>若应用已订阅到相关事件，但在触发回调前应用退出，则未回调的事件会在应用下次启动调用addWatcher后进行回调。例如订阅崩溃事件场景，在应用崩溃退出后，下次启动调用addWatcher后执行事件回调。</p>      </div></div></div>    </div>    <div class="tiledSection">     <h2 id="约束与限制">约束与限制<i class="anchor-icon anchor-icon-link" anchorid="约束与限制" tips="复制节点链接"></i></h2>          <ul>      <li>       <p>订阅接口addWatcher是同步接口，涉及IO操作。对于性能有要求的模块，建议将接口的调用放到非主线程。</p></li>      <li>       <p>订阅接口addWatcher传入的名称name是唯一的，相同的name，后一次调用会覆盖前一次的订阅。</p></li>     </ul>    </div>   </div>   <div></div></div>