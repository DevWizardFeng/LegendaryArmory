<h1 _ngcontent-dem-c119="" class="doc-title ng-star-inserted" title="JSON扩展库"> JSON扩展库 </h1>

<div _ngcontent-dem-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <div class="tiledSection">     <h2 id="场景介绍">场景介绍<i class="anchor-icon anchor-icon-link" anchorid="场景介绍" tips="复制节点链接"></i></h2>          <p>该库扩展了原生JSON功能，提供了额外的错误处理、循环引用检测、BigInt处理以及对不同输入类型的严格检查。代码中底层依赖于原生JSON.parse和JSON.stringify，但在此基础上加入了多种自定义逻辑并提供额外的has和remove接口，具体可见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-json" target="_blank">@arkts.json</a>。</p>     <p>JSON扩展库主要适用于以下场景：</p>     <ul>      <li>       <p>需要处理BigInt的JSON解析或序列化。</p></li>      <li>       <p>需要更严格的参数校验和错误处理。</p></li>      <li>       <p>需要在序列化对象时检测循环引用。</p></li>      <li>       <p>需要安全的对象操作（has/remove）。</p></li>     </ul>     <p>该库适用于需要增强JSON功能的场景，特别是在处理BigInt和严格的参数校验时。</p>    </div>    <div class="tiledSection">     <h2 id="json扩展说明">JSON扩展说明<i class="anchor-icon anchor-icon-link" anchorid="json扩展说明" tips="复制节点链接"></i></h2>         </div>    <div class="tiledSection">     <h3 id="parse" class="firsth2">parse<i class="anchor-icon anchor-icon-link" anchorid="parse" tips="复制节点链接"></i></h3>          <p>parse(text: string, reviver?: Transformer, options?: ParseOptions): Object | null</p>     <p>解析JSON字符串，支持BigInt模式。</p>     <p><strong>与原生的区别：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.3.5.1.4.1.1" valign="top" width="33.33333333333333%">特性</th>         <th align="left" class="cellrowborder" id="mcps1.3.3.5.1.4.1.2" valign="top" width="33.33333333333333%">原生parse</th>         <th align="left" class="cellrowborder" id="mcps1.3.3.5.1.4.1.3" valign="top" width="33.33333333333333%">本库parse</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">BigInt支持</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">不支持（抛出TypeError）</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">支持（通过parseBigInt扩展）</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">参数校验</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">弱校验</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">强校验（抛出BusinessError）</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">错误信息</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">原生错误（如SyntaxError）</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">自定义BusinessError</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">reviver参数</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">支持</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">支持，但强制类型检查</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h3 id="stringify">stringify<i class="anchor-icon anchor-icon-link" anchorid="stringify" tips="复制节点链接"></i></h3>          <p>stringify(value: Object, replacer?: (number | string)[] | null, space?: string | number): string</p>     <p>将对象转换为JSON字符串，支持BigInt模式。</p>     <p><strong>与原生的区别：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.4.5.1.4.1.1" valign="top" width="33.33333333333333%">特性</th>         <th align="left" class="cellrowborder" id="mcps1.3.4.5.1.4.1.2" valign="top" width="33.33333333333333%">原生stringify</th>         <th align="left" class="cellrowborder" id="mcps1.3.4.5.1.4.1.3" valign="top" width="33.33333333333333%">本库stringify</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">BigInt支持</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">不支持（抛出TypeError）</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">支持（通过stringifyBigInt扩展）</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">循环引用检测</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">抛出TypeError</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">检测并抛出BusinessError</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">参数校验</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">弱校验</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">强校验（replacer必须是函数或数组）</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">错误信息</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">原生错误</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">自定义BusinessError</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h3 id="has">has<i class="anchor-icon anchor-icon-link" anchorid="has" tips="复制节点链接"></i></h3>          <p>has(obj: object, property: string): boolean</p>     <p>检查对象是否包含指定的属性，确保传入的值是一个对象，并且属性键是有效的字符串。</p>     <p><strong>与原生的区别：</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.5.5.1.4.1.1" valign="top" width="33.33333333333333%">特性</th>         <th align="left" class="cellrowborder" id="mcps1.3.5.5.1.4.1.2" valign="top" width="33.33333333333333%">原生方式（obj.hasOwnProperty）</th>         <th align="left" class="cellrowborder" id="mcps1.3.5.5.1.4.1.3" valign="top" width="33.33333333333333%">本库has</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">参数校验</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">无校验（可能误用）</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">强制检查obj是普通对象，property是非空字符串</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">错误处理</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">可能静默失败</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">抛出BusinessError</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h3 id="remove">remove<i class="anchor-icon anchor-icon-link" anchorid="remove" tips="复制节点链接"></i></h3>          <p>remove(obj: object, property: string): void</p>     <p>从对象中删除指定的属性。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.6.4.1.4.1.1" valign="top" width="33.33333333333333%">特性</th>         <th align="left" class="cellrowborder" id="mcps1.3.6.4.1.4.1.2" valign="top" width="33.33333333333333%">原生方式（delete obj.key）</th>         <th align="left" class="cellrowborder" id="mcps1.3.6.4.1.4.1.3" valign="top" width="33.33333333333333%">本库remove</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">参数校验</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">无校验（可能误删）</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">强制检查obj是普通对象，property是非空字符串</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">错误处理</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">可能静默失败</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">抛出BusinessError</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h3 id="总结">总结<i class="anchor-icon anchor-icon-link" anchorid="总结" tips="复制节点链接"></i></h3>          <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.7.2.1.4.1.1" valign="top" width="33.33333333333333%">功能</th>         <th align="left" class="cellrowborder" id="mcps1.3.7.2.1.4.1.2" valign="top" width="33.33333333333333%">原生JSON</th>         <th align="left" class="cellrowborder" id="mcps1.3.7.2.1.4.1.3" valign="top" width="33.33333333333333%">本库</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">严格参数校验</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">不支持</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">支持</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">循环引用检测</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">不支持</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">支持</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">BigInt处理</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">不支持</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">支持</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">增强的错误处理（BusinessError）</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">不支持</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">支持</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">额外方法（has/remove）</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">不支持</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">支持</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="开发场景">开发场景<i class="anchor-icon anchor-icon-link" anchorid="开发场景" tips="复制节点链接"></i></h2>         </div>    <div class="tiledSection">     <h3 id="解析包含嵌套引号的json字符串场景" class="firsth2">解析包含嵌套引号的JSON字符串场景<i class="anchor-icon anchor-icon-link" anchorid="解析包含嵌套引号的json字符串场景" tips="复制节点链接"></i></h3>          <p>JSON字符串中的嵌套引号会破坏其结构，将导致解析失败。</p>     <div _ngcontent-dem-c106="" class="highlight-div"><div _ngcontent-dem-c106="" class="highlight-div-header"><div _ngcontent-dem-c106="" class="highlight-div-header-left"><div _ngcontent-dem-c106="" class="handle-button expand-button"><div _ngcontent-dem-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-dem-c106="" class="highlight-div-header-right"><div _ngcontent-dem-c106="" class="handle-button ai-button"></div><div _ngcontent-dem-c106="" class="handle-button line-button"><div _ngcontent-dem-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-dem-c106="" class="handle-button theme-button"><div _ngcontent-dem-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-dem-c106="" class="handle-button copy-button"><div _ngcontent-dem-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-dem-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 比如以下JSON字符串，由于嵌套引号导致结构破坏，执行JSON.parse将会抛异常。</span></li><li><span class="hljs-comment">// let jsonStr = `{"info": "{"name": "zhangsan", "age": 18}"}`;</span></li></ol></pre></div></div>     <p>以下提供两种方式解决该场景问题：</p>     <p>方式1：避免出现嵌套引号的操作。</p>     <div _ngcontent-dem-c106="" class="highlight-div"><div _ngcontent-dem-c106="" class="highlight-div-header"><div _ngcontent-dem-c106="" class="highlight-div-header-left"><div _ngcontent-dem-c106="" class="handle-button expand-button"><div _ngcontent-dem-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-dem-c106="" class="highlight-div-header-right"><div _ngcontent-dem-c106="" class="handle-button ai-button"></div><div _ngcontent-dem-c106="" class="handle-button line-button"><div _ngcontent-dem-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-dem-c106="" class="handle-button theme-button"><div _ngcontent-dem-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-dem-c106="" class="handle-button copy-button"><div _ngcontent-dem-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-dem-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">JSON</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkTS'</span>;</li><li>
</li><li><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Info</span> {</li><li>  <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;</li><li>  <span class="hljs-attr">age</span>: <span class="hljs-built_in">number</span>;</li><li>}</li><li>
</li><li><span class="hljs-keyword">interface</span> <span class="hljs-title class_">TestObj</span> {</li><li>  <span class="hljs-attr">info</span>: <span class="hljs-title class_">Info</span>;</li><li>}</li><li>
</li><li><span class="hljs-keyword">interface</span> <span class="hljs-title class_">TestStr</span> {</li><li>  <span class="hljs-attr">info</span>: <span class="hljs-built_in">string</span>;</li><li>}</li><li>
</li><li><span class="hljs-comment">/*</span></li><li><span class="hljs-comment"> * 将原始JSON字符串`{"info": "{"name": "zhangsan", "age": 18}"}`</span></li><li><span class="hljs-comment"> * 修改为`{"info": {"name": "zhangsan", "age": 18}}`。</span></li><li><span class="hljs-comment"> * */</span></li><li><span class="hljs-keyword">let</span> jsonStr = <span class="hljs-string">`{"info": {"name": "zhangsan", "age": 18}}`</span>;</li><li><span class="hljs-keyword">let</span> obj1  = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(jsonStr) <span class="hljs-keyword">as</span> <span class="hljs-title class_">TestObj</span>;</li><li><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(obj1));    <span class="hljs-comment">//{"info":{"name":"zhangsan","age":18}}</span></li><li><span class="hljs-comment">// 获取JSON字符串中的name信息</span></li><li><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(obj1.<span class="hljs-property">info</span>.<span class="hljs-property">name</span>); <span class="hljs-comment">// zhangsan</span></li></ol></pre></div></div>     <p>方式2：将JSON字符串中嵌套的引号进行双重转义，恢复JSON的正常结构。</p>     <div _ngcontent-dem-c106="" class="highlight-div"><div _ngcontent-dem-c106="" class="highlight-div-header"><div _ngcontent-dem-c106="" class="highlight-div-header-left"><div _ngcontent-dem-c106="" class="handle-button expand-button"><div _ngcontent-dem-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-dem-c106="" class="highlight-div-header-right"><div _ngcontent-dem-c106="" class="handle-button ai-button"></div><div _ngcontent-dem-c106="" class="handle-button line-button"><div _ngcontent-dem-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-dem-c106="" class="handle-button theme-button"><div _ngcontent-dem-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-dem-c106="" class="handle-button copy-button"><div _ngcontent-dem-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-dem-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">JSON</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkTS'</span>;</li><li>
</li><li><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Info</span> {</li><li>  <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;</li><li>  <span class="hljs-attr">age</span>: <span class="hljs-built_in">number</span>;</li><li>}</li><li>
</li><li><span class="hljs-keyword">interface</span> <span class="hljs-title class_">TestObj</span> {</li><li>  <span class="hljs-attr">info</span>: <span class="hljs-title class_">Info</span>;</li><li>}</li><li>
</li><li><span class="hljs-keyword">interface</span> <span class="hljs-title class_">TestStr</span> {</li><li>  <span class="hljs-attr">info</span>: <span class="hljs-built_in">string</span>;</li><li>}</li><li>
</li><li><span class="hljs-comment">/*</span></li><li><span class="hljs-comment"> * 将原始JSON字符串`{"info": "{"name": "zhangsan", "age": 18}"}`进行双重转义，</span></li><li><span class="hljs-comment"> * 修改为`{"info": "{\\"name\\": \\"zhangsan\\", \\"age\\": 18}"}`。</span></li><li><span class="hljs-comment"> * */</span></li><li><span class="hljs-keyword">let</span> jsonStr = <span class="hljs-string">`{"info": "{\\"name\\": \\"zhangsan\\", \\"age\\": 18}"}`</span>;</li><li><span class="hljs-keyword">let</span> obj2 = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(jsonStr) <span class="hljs-keyword">as</span> <span class="hljs-title class_">TestStr</span>;</li><li><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(obj2));    <span class="hljs-comment">// {"info":"{\"name\": \"zhangsan\", \"age\": 18}"}</span></li><li><span class="hljs-comment">// 获取JSON字符串中的name信息</span></li><li><span class="hljs-keyword">let</span> obj3 = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(obj2.<span class="hljs-property">info</span>) <span class="hljs-keyword">as</span> <span class="hljs-title class_">Info</span>;</li><li><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(obj3.<span class="hljs-property">name</span>); <span class="hljs-comment">// zhangsan</span></li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="解析包含大整数的json字符串场景">解析包含大整数的JSON字符串场景<i class="anchor-icon anchor-icon-link" anchorid="解析包含大整数的json字符串场景" tips="复制节点链接"></i></h3>          <p>当JSON字符串中存在小于-(2^53-1)或大于(2^53-1)的整数时，解析后数据会出现精度丢失或不正确的情况。该解析场景需要指定BigIntMode，将大整数解析为BigInt。</p>     <div _ngcontent-dem-c106="" class="highlight-div"><div _ngcontent-dem-c106="" class="highlight-div-header"><div _ngcontent-dem-c106="" class="highlight-div-header-left"><div _ngcontent-dem-c106="" class="handle-button expand-button"><div _ngcontent-dem-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-dem-c106="" class="highlight-div-header-right"><div _ngcontent-dem-c106="" class="handle-button ai-button"></div><div _ngcontent-dem-c106="" class="handle-button line-button"><div _ngcontent-dem-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-dem-c106="" class="handle-button theme-button"><div _ngcontent-dem-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-dem-c106="" class="handle-button copy-button"><div _ngcontent-dem-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-dem-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">JSON</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkTS'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> numberText = <span class="hljs-string">'{"number": 10, "largeNumber": 112233445566778899}'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> numberObj1 = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(numberText) <span class="hljs-keyword">as</span> <span class="hljs-title class_">Object</span>;</li><li><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>((numberObj1 <span class="hljs-keyword">as</span> <span class="hljs-built_in">object</span>)?.[<span class="hljs-string">"largeNumber"</span>]);    <span class="hljs-comment">// 112233445566778900</span></li><li>
</li><li><span class="hljs-comment">// 使用PARSE_AS_BIGINT的BigInt模式进行解析，避免出现大整数解析错误。</span></li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">options</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-property">ParseOptions</span> = {</li><li>  <span class="hljs-attr">bigIntMode</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-property">BigIntMode</span>.<span class="hljs-property">PARSE_AS_BIGINT</span>,</li><li>}</li><li>
</li><li><span class="hljs-keyword">let</span> numberObj2 = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(numberText, <span class="hljs-literal">null</span>, options) <span class="hljs-keyword">as</span> <span class="hljs-title class_">Object</span>;</li><li>
</li><li><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-keyword">typeof</span> (numberObj2 <span class="hljs-keyword">as</span> <span class="hljs-built_in">object</span>)?.[<span class="hljs-string">"number"</span>]);   <span class="hljs-comment">// number</span></li><li><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>((numberObj2 <span class="hljs-keyword">as</span> <span class="hljs-built_in">object</span>)?.[<span class="hljs-string">"number"</span>]);    <span class="hljs-comment">// 10</span></li><li>
</li><li><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-keyword">typeof</span> (numberObj2 <span class="hljs-keyword">as</span> <span class="hljs-built_in">object</span>)?.[<span class="hljs-string">"largeNumber"</span>]);    <span class="hljs-comment">// bigint</span></li><li><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>((numberObj2 <span class="hljs-keyword">as</span> <span class="hljs-built_in">object</span>)?.[<span class="hljs-string">"largeNumber"</span>]);    <span class="hljs-comment">// 112233445566778899</span></li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="序列化bigint对象场景">序列化BigInt对象场景<i class="anchor-icon anchor-icon-link" anchorid="序列化bigint对象场景" tips="复制节点链接"></i></h3>          <p>为弥补原生JSON无法序列化BigInt对象的缺陷，本库提供以下两种JSON序列化方式：</p>     <p>方式1：不使用自定义转换函数，直接序列化BigInt对象。</p>     <div _ngcontent-dem-c106="" class="highlight-div"><div _ngcontent-dem-c106="" class="highlight-div-header"><div _ngcontent-dem-c106="" class="highlight-div-header-left"><div _ngcontent-dem-c106="" class="handle-button expand-button"><div _ngcontent-dem-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-dem-c106="" class="highlight-div-header-right"><div _ngcontent-dem-c106="" class="handle-button ai-button"></div><div _ngcontent-dem-c106="" class="handle-button line-button"><div _ngcontent-dem-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-dem-c106="" class="handle-button theme-button"><div _ngcontent-dem-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-dem-c106="" class="handle-button copy-button"><div _ngcontent-dem-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-dem-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">JSON</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkTS'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> bigIntObject = <span class="hljs-title class_">BigInt</span>(<span class="hljs-number">112233445566778899n</span>)</li><li>
</li><li><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(bigIntObject)); <span class="hljs-comment">// 112233445566778899</span></li></ol></pre></div></div>     <p>方式2：使用自定义转换函数，需预处理BigInt对象进行序列化操作。</p>     <div _ngcontent-dem-c106="" class="highlight-div"><div _ngcontent-dem-c106="" class="highlight-div-header"><div _ngcontent-dem-c106="" class="highlight-div-header-left"><div _ngcontent-dem-c106="" class="handle-button expand-button"><div _ngcontent-dem-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-dem-c106="" class="highlight-div-header-right"><div _ngcontent-dem-c106="" class="handle-button ai-button"></div><div _ngcontent-dem-c106="" class="handle-button line-button"><div _ngcontent-dem-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-dem-c106="" class="handle-button theme-button"><div _ngcontent-dem-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-dem-c106="" class="handle-button copy-button"><div _ngcontent-dem-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-dem-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">JSON</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkTS'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> bigIntObject = <span class="hljs-title class_">BigInt</span>(<span class="hljs-number">112233445566778899n</span>)</li><li>
</li><li><span class="hljs-comment">// 错误序列化用法：自定义函数中直接返回BigInt对象</span></li><li><span class="hljs-comment">// JSON.stringify(bigIntObject, (key: string, value: Object): Object =&gt;{ return value; });</span></li><li>
</li><li><span class="hljs-comment">// 正确序列化用法：自定义函数中将BigInt对象预处理为string对象</span></li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">result</span>: <span class="hljs-built_in">string</span> = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(bigIntObject, (<span class="hljs-attr">key</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">value</span>: <span class="hljs-title class_">Object</span>): <span class="hljs-function"><span class="hljs-params">Object</span> =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> value === <span class="hljs-string">'bigint'</span>) {</li><li>    <span class="hljs-keyword">return</span> value.<span class="hljs-title function_">toString</span>();</li><li>  }</li><li>  <span class="hljs-keyword">return</span> value;</li><li>});</li><li><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"result:"</span>, result); <span class="hljs-comment">// result: "112233445566778899"</span></li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="序列化浮点数number场景">序列化浮点数number场景<i class="anchor-icon anchor-icon-link" anchorid="序列化浮点数number场景" tips="复制节点链接"></i></h3>          <p>在JSON序列化中，浮点数处理存在一个特殊行为：当小数部分为零时，为保持数值的简洁表示，序列化结果会自动省略小数部分。这可能导致精度信息丢失，影响需要精确表示浮点数的场景（如金融金额、科学计量）。以下示例提供解决该场景的方法：</p>     <div _ngcontent-dem-c106="" class="highlight-div"><div _ngcontent-dem-c106="" class="highlight-div-header"><div _ngcontent-dem-c106="" class="highlight-div-header-left"><div _ngcontent-dem-c106="" class="handle-button expand-button"><div _ngcontent-dem-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-dem-c106="" class="highlight-div-header-right"><div _ngcontent-dem-c106="" class="handle-button ai-button"></div><div _ngcontent-dem-c106="" class="handle-button line-button"><div _ngcontent-dem-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-dem-c106="" class="handle-button theme-button"><div _ngcontent-dem-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-dem-c106="" class="handle-button copy-button"><div _ngcontent-dem-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-dem-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">JSON</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkTS'</span>;</li><li>
</li><li><span class="hljs-comment">// 序列化小数部分不为零的浮点数，可以正常序列化。</span></li><li><span class="hljs-keyword">let</span> floatNumber1 = <span class="hljs-number">10.12345</span>;</li><li><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(floatNumber1)); <span class="hljs-comment">// 10.12345</span></li><li>
</li><li><span class="hljs-comment">// 序列化小数部分为零的浮点数，为保持数值的简洁表示，会丢失小数部分的精度。</span></li><li><span class="hljs-keyword">let</span> floatNumber2 = <span class="hljs-number">10.00</span>;</li><li><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(floatNumber2)); <span class="hljs-comment">// 10</span></li><li>
</li><li><span class="hljs-comment">// 以下是防止浮点数精度丢失的方法：</span></li><li><span class="hljs-keyword">let</span> result = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(floatNumber2, (<span class="hljs-attr">key</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">value</span>: <span class="hljs-title class_">Object</span>): <span class="hljs-function"><span class="hljs-params">Object</span> =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> value === <span class="hljs-string">'number'</span>) {</li><li>    <span class="hljs-comment">// 按照业务场景需要，定制所需的固定精度。</span></li><li>    <span class="hljs-keyword">return</span> value.<span class="hljs-title function_">toFixed</span>(<span class="hljs-number">2</span>);</li><li>  }</li><li>  <span class="hljs-keyword">return</span> value;</li><li>});</li><li><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(result); <span class="hljs-comment">// "10.00"</span></li></ol></pre></div></div>    </div>   </div>   <div></div></div>