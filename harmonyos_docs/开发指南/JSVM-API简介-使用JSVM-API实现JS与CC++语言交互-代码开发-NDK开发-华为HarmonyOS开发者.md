<h1 _ngcontent-rie-c119="" class="doc-title ng-star-inserted" title="JSVM-API简介"> JSVM-API简介 </h1>

<div _ngcontent-rie-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div> <div class="tiledSection"><h2 id="场景介绍">场景介绍<i class="anchor-icon anchor-icon-link" anchorid="场景介绍" tips="复制节点链接"></i></h2><p>HarmonyOS JSVM-API基于标准JS引擎提供了一套稳定的API，支持创建和销毁引擎、执行JS代码、JS与C++的交互等关键功能。</p> <p>HarmonyOS JSVM-API是C语言接口，遵循C99标准。</p> <p>通过JSVM-API，可以在应用运行期间直接执行动态加载的JS代码。此外，可以将对性能和底层系统调用有较高要求的核心功能用C/C++实现，并将C++方法注册到JS侧，从而在JS代码中直接调用，提高应用执行效率。</p> <p>本文中如无特别说明，后续均使用JSVM-API指代HarmonyOS JSVM-API能力。</p> </div>  <div class="tiledSection"><h2 id="jsvm-api的组成架构">JSVM-API的组成架构<i class="anchor-icon anchor-icon-link" anchorid="jsvm-api的组成架构" tips="复制节点链接"></i></h2><p><strong>图1</strong> JSVM-API的组成架构</p> <p>  </p> <p><span><img originheight="702" originwidth="1222" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114335.82688475030841097394440494761873:50001231000000:2800:EB953795FD60536BA7C27C8ADAC92B00065514B7EFD4B85D863526514B63F909.png" width="920" height="528.5106382978723"></span></p> <ul><li><p>Native Module：开发者使用JSVM-API开发的模块，用于在Native侧使用。</p>  </li><li><p>VM Life Cycle Manager：管理JSVM_VM的生命周期。</p>  </li><li><p>JS Context Manager：管理JSVM_Env的生命周期。</p>  </li><li><p>Context Snapshot：上下文快照，可用以缩短JS Context的创建时间。</p>  </li><li><p>JS Code Execute：执行JS代码。</p>  </li><li><p>JS/C++ Interaction：连接JS层与C++层，用于支撑JS与C++之间的交互。</p>  </li><li><p>Code Cache：编译后的JS代码的缓存，能提升JS代码执行的启动速度。</p>  </li><li><p>Debugger：调试器，用于调试JS代码。</p>  </li><li><p>CPU Profiler：该工具可以记录JS代码的执行时间，帮助开发者分析性能瓶颈，为代码优化提供数据支撑。</p>  </li><li><p>Heap Snapshot：JS堆内存分析/调优工具，可以进行内存优化和发现内存泄漏问题。</p>  </li><li><p>Heap Statistics：JS堆统计信息，包括内存大小及上下文数量。</p>  </li><li><p>Memory Adjustment：调整外部内存大小、虚拟机内存压力，以加快触发GC。</p>  </li><li><p>VM Information：JSVM_VM的信息。</p>  </li><li><p>Standard JS Engine：标准JS引擎。</p>  </li></ul> </div>  <div class="tiledSection"><h2 id="jsvm-api的关键交互流程">JSVM-API的关键交互流程<i class="anchor-icon anchor-icon-link" anchorid="jsvm-api的关键交互流程" tips="复制节点链接"></i></h2><p><strong>图2</strong> JSVM-API的关键交互流程</p> <p><span><img originheight="946" originwidth="1484" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114335.42131106285879914338930256938173:50001231000000:2800:C11C0952FF5114BF1DB775DFCF6711B2670167FA7E1C579AF16BE74286A4BA48.png" width="920" height="586.4690026954178"></span></p> <p>JSVM-API与Native模块之间的交互流程主要分为以下两步：</p> <ol><li><p><strong>初始化阶段</strong>：在Native模块上初始化JSVM和JS上下文，并完成Native函数的注册。Native方法将被挂载到JS执行环境的全局上下文即GlobalThis。</p>  </li><li><p><strong>调用阶段</strong>：当JS侧调用通过JSVM-API注册到JS全局上下文的方法时，JS引擎会找到并调用对应的C/C++方法。</p>  </li></ol> </div> </div> <div></div></div>