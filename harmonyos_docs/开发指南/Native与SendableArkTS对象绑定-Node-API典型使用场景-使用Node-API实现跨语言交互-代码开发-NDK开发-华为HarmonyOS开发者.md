<h1 _ngcontent-gxw-c119="" class="doc-title ng-star-inserted" title="Native与Sendable ArkTS对象绑定"> Native与Sendable ArkTS对象绑定 </h1>

<div _ngcontent-gxw-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <div class="tiledSection">     <h2 id="场景介绍">场景介绍<i class="anchor-icon anchor-icon-link" anchorid="场景介绍" tips="复制节点链接"></i></h2>          <p>通过napi_wrap_sendable将<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-sendable">Sendable</a> ArkTS对象与Native的C++对象绑定，后续操作时再通过napi_unwrap_sendable将ArkTS对象绑定的C++对象取出，并对其进行操作。</p>    </div>    <div class="tiledSection">     <h2 id="使用示例">使用示例<i class="anchor-icon anchor-icon-link" anchorid="使用示例" tips="复制节点链接"></i></h2>          <ol>      <li>       <p>接口声明、编译配置以及模块注册</p>       <p><strong>接口声明</strong></p>       <div _ngcontent-gxw-c106="" class="highlight-div"><div _ngcontent-gxw-c106="" class="highlight-div-header"><div _ngcontent-gxw-c106="" class="highlight-div-header-left"><div _ngcontent-gxw-c106="" class="handle-button expand-button"><div _ngcontent-gxw-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gxw-c106="" class="highlight-div-header-right"><div _ngcontent-gxw-c106="" class="handle-button ai-button"></div><div _ngcontent-gxw-c106="" class="handle-button line-button"><div _ngcontent-gxw-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gxw-c106="" class="handle-button theme-button"><div _ngcontent-gxw-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gxw-c106="" class="handle-button copy-button"><div _ngcontent-gxw-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gxw-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// index.d.ets</span></li><li><span class="hljs-meta">@Sendable</span></li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyObject</span> {</li><li><span class="hljs-title function_">constructor</span>(<span class="hljs-params">arg: <span class="hljs-built_in">number</span></span>);</li><li><span class="hljs-title function_">plusOne</span>(): <span class="hljs-built_in">number</span>;</li><li>
</li><li><span class="hljs-keyword">public</span> <span class="hljs-keyword">get</span> <span class="hljs-title function_">value</span>();</li><li><span class="hljs-keyword">public</span> <span class="hljs-keyword">set</span> <span class="hljs-title function_">value</span>(<span class="hljs-params">newVal: <span class="hljs-built_in">number</span></span>);</li><li>}</li></ol></pre></div></div>       <p><strong>编译配置</strong></p>       <div _ngcontent-gxw-c106="" class="highlight-div"><div _ngcontent-gxw-c106="" class="highlight-div-header"><div _ngcontent-gxw-c106="" class="highlight-div-header-left"><div _ngcontent-gxw-c106="" class="handle-button expand-button"><div _ngcontent-gxw-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gxw-c106="" class="highlight-div-header-right"><div _ngcontent-gxw-c106="" class="handle-button ai-button"></div><div _ngcontent-gxw-c106="" class="handle-button line-button"><div _ngcontent-gxw-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gxw-c106="" class="handle-button theme-button"><div _ngcontent-gxw-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gxw-c106="" class="handle-button copy-button"><div _ngcontent-gxw-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gxw-c106="" class="highlight-scroll-div"><pre class="cmake prettyprint linenums hljs language-scss" hw-language="cmake" data-highlighted="yes"><ol class="linenums"><li># the minimum version of CMake.</li><li><span class="hljs-built_in">cmake_minimum_required</span>(VERSION <span class="hljs-number">3.5</span>.<span class="hljs-number">0</span>)</li><li><span class="hljs-built_in">project</span>(napi_wrap_sendable_demo)</li><li>
</li><li><span class="hljs-built_in">set</span>(NATIVERENDER_ROOT_PATH ${CMAKE_CURRENT_SOURCE_DIR})</li><li>
</li><li><span class="hljs-built_in">if</span>(DEFINED PACKAGE_FIND_FILE)</li><li>    <span class="hljs-built_in">include</span>(${PACKAGE_FIND_FILE})</li><li><span class="hljs-built_in">endif</span>()</li><li>
</li><li><span class="hljs-built_in">include_directories</span>(${NATIVERENDER_ROOT_PATH}</li><li>                    ${NATIVERENDER_ROOT_PATH}/include)</li><li>
</li><li><span class="hljs-built_in">add_definitions</span>("-DLOG_DOMAIN=<span class="hljs-number">0</span>x0000")</li><li><span class="hljs-built_in">add_definitions</span>("-DLOG_TAG=\"testTag\"")</li><li>
</li><li><span class="hljs-built_in">add_library</span>(entry SHARED napi_init.cpp)</li><li><span class="hljs-built_in">target_link_libraries</span>(entry PUBLIC libace_napi.z.so libhilog_ndk.z.so)</li></ol></pre></div></div>       <p><strong>模块注册</strong></p>       <div _ngcontent-gxw-c106="" class="highlight-div"><div _ngcontent-gxw-c106="" class="highlight-div-header"><div _ngcontent-gxw-c106="" class="highlight-div-header-left"><div _ngcontent-gxw-c106="" class="handle-button expand-button"><div _ngcontent-gxw-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gxw-c106="" class="highlight-div-header-right"><div _ngcontent-gxw-c106="" class="handle-button ai-button"></div><div _ngcontent-gxw-c106="" class="handle-button line-button"><div _ngcontent-gxw-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gxw-c106="" class="handle-button theme-button"><div _ngcontent-gxw-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gxw-c106="" class="handle-button copy-button"><div _ngcontent-gxw-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gxw-c106="" class="highlight-scroll-div"><pre class="cpp prettyprint linenums hljs language-cpp" hw-language="cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// napi_init.cpp</span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"napi/native_api.h"</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"hilog/log.h"</span></span></li><li>
</li><li><span class="hljs-comment">// 一个native类，它的实例在下面会包装在Sendable ArkTS对象中</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyObject</span> {</li><li><span class="hljs-keyword">public</span>:</li><li>    <span class="hljs-function"><span class="hljs-type">static</span> napi_value <span class="hljs-title">Init</span><span class="hljs-params">(napi_env env, napi_value exports)</span></span>;</li><li>    <span class="hljs-function"><span class="hljs-type">static</span> <span class="hljs-type">void</span> <span class="hljs-title">Destructor</span><span class="hljs-params">(napi_env env, <span class="hljs-type">void</span> *nativeObject, <span class="hljs-type">void</span> *finalize_hint)</span></span>;</li><li>
</li><li><span class="hljs-keyword">private</span>:</li><li>    <span class="hljs-function"><span class="hljs-keyword">explicit</span> <span class="hljs-title">MyObject</span><span class="hljs-params">(<span class="hljs-type">double</span> value_ = <span class="hljs-number">0</span>)</span></span>;</li><li>    ~<span class="hljs-built_in">MyObject</span>();</li><li>
</li><li>    <span class="hljs-function"><span class="hljs-type">static</span> napi_value <span class="hljs-title">New</span><span class="hljs-params">(napi_env env, napi_callback_info info)</span></span>;</li><li>    <span class="hljs-function"><span class="hljs-type">static</span> napi_value <span class="hljs-title">GetValue</span><span class="hljs-params">(napi_env env, napi_callback_info info)</span></span>;</li><li>    <span class="hljs-function"><span class="hljs-type">static</span> napi_value <span class="hljs-title">SetValue</span><span class="hljs-params">(napi_env env, napi_callback_info info)</span></span>;</li><li>    <span class="hljs-function"><span class="hljs-type">static</span> napi_value <span class="hljs-title">PlusOne</span><span class="hljs-params">(napi_env env, napi_callback_info info)</span></span>;</li><li>
</li><li>    <span class="hljs-type">double</span> value_;</li><li>    napi_env env_;</li><li>};</li><li>
</li><li><span class="hljs-type">static</span> <span class="hljs-keyword">thread_local</span> napi_ref g_ref = <span class="hljs-literal">nullptr</span>;</li><li>
</li><li>MyObject::<span class="hljs-built_in">MyObject</span>(<span class="hljs-type">double</span> value) : <span class="hljs-built_in">value_</span>(value), <span class="hljs-built_in">env_</span>(<span class="hljs-literal">nullptr</span>) {}</li><li>
</li><li>MyObject::~<span class="hljs-built_in">MyObject</span>() {}</li><li>
</li><li><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">MyObject::Destructor</span><span class="hljs-params">(napi_env env, <span class="hljs-type">void</span> *nativeObject, [[maybe_unused]] <span class="hljs-type">void</span> *finalize_hint)</span> </span>{</li><li>    <span class="hljs-built_in">OH_LOG_INFO</span>(LOG_APP, <span class="hljs-string">"MyObject::Destructor called"</span>);</li><li>    <span class="hljs-built_in">reinterpret_cast</span>&lt;MyObject *&gt;(nativeObject)-&gt;~<span class="hljs-built_in">MyObject</span>();</li><li>}</li><li>
</li><li><span class="hljs-function">napi_value <span class="hljs-title">MyObject::Init</span><span class="hljs-params">(napi_env env, napi_value exports)</span> </span>{</li><li>    napi_value num;</li><li>    <span class="hljs-built_in">napi_create_double</span>(env, <span class="hljs-number">0</span>, &amp;num);</li><li>    napi_property_descriptor properties[] = {</li><li>        {<span class="hljs-string">"value"</span>, <span class="hljs-literal">nullptr</span>, <span class="hljs-literal">nullptr</span>, GetValue, SetValue, <span class="hljs-literal">nullptr</span>, napi_default, <span class="hljs-literal">nullptr</span>},</li><li>        {<span class="hljs-string">"plusOne"</span>, <span class="hljs-literal">nullptr</span>, PlusOne, <span class="hljs-literal">nullptr</span>, <span class="hljs-literal">nullptr</span>, <span class="hljs-literal">nullptr</span>, napi_default, <span class="hljs-literal">nullptr</span>},</li><li>    };</li><li>
</li><li>    napi_value cons;</li><li>    <span class="hljs-comment">// 定义一个Sendable class MyObject</span></li><li>    <span class="hljs-built_in">napi_define_sendable_class</span>(env, <span class="hljs-string">"MyObject"</span>, NAPI_AUTO_LENGTH, New, <span class="hljs-literal">nullptr</span>,</li><li>                            <span class="hljs-built_in">sizeof</span>(properties) / <span class="hljs-built_in">sizeof</span>(properties[<span class="hljs-number">0</span>]), properties, <span class="hljs-literal">nullptr</span>, &amp;cons);</li><li>
</li><li>    <span class="hljs-built_in">napi_create_reference</span>(env, cons, <span class="hljs-number">1</span>, &amp;g_ref);</li><li>    <span class="hljs-comment">// 在exports对象上挂载MyObject类</span></li><li>    <span class="hljs-built_in">napi_set_named_property</span>(env, exports, <span class="hljs-string">"MyObject"</span>, cons);</li><li>    <span class="hljs-keyword">return</span> exports;</li><li>}</li><li>
</li><li>EXTERN_C_START</li><li><span class="hljs-comment">// 模块初始化</span></li><li><span class="hljs-function"><span class="hljs-type">static</span> napi_value <span class="hljs-title">Init</span><span class="hljs-params">(napi_env env, napi_value exports)</span> </span>{</li><li>    MyObject::<span class="hljs-built_in">Init</span>(env, exports);</li><li>    <span class="hljs-keyword">return</span> exports;</li><li>}</li><li>EXTERN_C_END</li><li>
</li><li><span class="hljs-comment">// 准备模块加载相关信息，将上述Init函数与本模块名等信息记录下来。</span></li><li><span class="hljs-type">static</span> napi_module nativeModule = {</li><li>    .nm_version = <span class="hljs-number">1</span>,</li><li>    .nm_flags = <span class="hljs-number">0</span>,</li><li>    .nm_filename = <span class="hljs-literal">nullptr</span>,</li><li>    .nm_register_func = Init,</li><li>    .nm_modname = <span class="hljs-string">"entry"</span>,</li><li>    .nm_priv = <span class="hljs-literal">nullptr</span>,</li><li>    .reserved = {<span class="hljs-number">0</span>},</li><li>};</li><li>
</li><li><span class="hljs-comment">// 加载so时，该函数会自动被调用，将上述nativeModule模块注册到系统中。</span></li><li><span class="hljs-keyword">extern</span> <span class="hljs-string">"C"</span> __attribute__((constructor)) <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">RegisterObjectWrapModule</span><span class="hljs-params">()</span> </span>{ <span class="hljs-built_in">napi_module_register</span>(&amp;nativeModule); }</li></ol></pre></div></div></li>      <li>       <p>在构造函数中绑定Sendable ArkTS与C++对象</p>       <div _ngcontent-gxw-c106="" class="highlight-div"><div _ngcontent-gxw-c106="" class="highlight-div-header"><div _ngcontent-gxw-c106="" class="highlight-div-header-left"><div _ngcontent-gxw-c106="" class="handle-button expand-button"><div _ngcontent-gxw-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gxw-c106="" class="highlight-div-header-right"><div _ngcontent-gxw-c106="" class="handle-button ai-button"></div><div _ngcontent-gxw-c106="" class="handle-button line-button"><div _ngcontent-gxw-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gxw-c106="" class="handle-button theme-button"><div _ngcontent-gxw-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gxw-c106="" class="handle-button copy-button"><div _ngcontent-gxw-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gxw-c106="" class="highlight-scroll-div"><pre class="cpp prettyprint linenums hljs language-cpp" hw-language="cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-function">napi_value <span class="hljs-title">MyObject::New</span><span class="hljs-params">(napi_env env, napi_callback_info info)</span> </span>{</li><li>    <span class="hljs-built_in">OH_LOG_INFO</span>(LOG_APP, <span class="hljs-string">"MyObject::New called"</span>);</li><li>
</li><li>    napi_value newTarget;</li><li>    <span class="hljs-built_in">napi_get_new_target</span>(env, info, &amp;newTarget);</li><li>    <span class="hljs-keyword">if</span> (newTarget != <span class="hljs-literal">nullptr</span>) {</li><li>        <span class="hljs-comment">// 使用`new MyObject(...)`调用方式</span></li><li>        <span class="hljs-type">size_t</span> argc = <span class="hljs-number">1</span>;</li><li>        napi_value args[<span class="hljs-number">1</span>];</li><li>        napi_value jsThis;</li><li>        <span class="hljs-built_in">napi_get_cb_info</span>(env, info, &amp;argc, args, &amp;jsThis, <span class="hljs-literal">nullptr</span>);</li><li>
</li><li>        <span class="hljs-type">double</span> value = <span class="hljs-number">0.0</span>;</li><li>        napi_valuetype valuetype;</li><li>        <span class="hljs-built_in">napi_typeof</span>(env, args[<span class="hljs-number">0</span>], &amp;valuetype);</li><li>        <span class="hljs-keyword">if</span> (valuetype != napi_undefined) {</li><li>            <span class="hljs-built_in">napi_get_value_double</span>(env, args[<span class="hljs-number">0</span>], &amp;value);</li><li>        }</li><li>
</li><li>        MyObject *obj = <span class="hljs-keyword">new</span> <span class="hljs-built_in">MyObject</span>(value);</li><li>
</li><li>        obj-&gt;env_ = env;</li><li>        <span class="hljs-comment">// 通过napi_wrap_sendable将Sendable ArkTS对象jsThis与C++对象obj绑定</span></li><li>        <span class="hljs-built_in">napi_wrap_sendable</span>(env, jsThis, <span class="hljs-built_in">reinterpret_cast</span>&lt;<span class="hljs-type">void</span> *&gt;(obj), MyObject::Destructor, <span class="hljs-literal">nullptr</span>);</li><li>
</li><li>        <span class="hljs-keyword">return</span> jsThis;</li><li>    } <span class="hljs-keyword">else</span> {</li><li>        <span class="hljs-comment">// 使用`MyObject(...)`调用方式</span></li><li>        <span class="hljs-type">size_t</span> argc = <span class="hljs-number">1</span>;</li><li>        napi_value args[<span class="hljs-number">1</span>];</li><li>        <span class="hljs-built_in">napi_get_cb_info</span>(env, info, &amp;argc, args, <span class="hljs-literal">nullptr</span>, <span class="hljs-literal">nullptr</span>);</li><li>
</li><li>        napi_value cons;</li><li>        <span class="hljs-built_in">napi_get_reference_value</span>(env, g_ref, &amp;cons);</li><li>        napi_value instance;</li><li>        <span class="hljs-built_in">napi_new_instance</span>(env, cons, argc, args, &amp;instance);</li><li>
</li><li>        <span class="hljs-keyword">return</span> instance;</li><li>    }</li><li>}</li></ol></pre></div></div></li>      <li>       <p>将Sendable ArkTS对象之前绑定的C++对象取出，并对其进行操作</p>       <div _ngcontent-gxw-c106="" class="highlight-div"><div _ngcontent-gxw-c106="" class="highlight-div-header"><div _ngcontent-gxw-c106="" class="highlight-div-header-left"><div _ngcontent-gxw-c106="" class="handle-button expand-button"><div _ngcontent-gxw-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gxw-c106="" class="highlight-div-header-right"><div _ngcontent-gxw-c106="" class="handle-button ai-button"></div><div _ngcontent-gxw-c106="" class="handle-button line-button"><div _ngcontent-gxw-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gxw-c106="" class="handle-button theme-button"><div _ngcontent-gxw-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gxw-c106="" class="handle-button copy-button"><div _ngcontent-gxw-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gxw-c106="" class="highlight-scroll-div"><pre class="cpp prettyprint linenums hljs language-cpp" hw-language="cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-function">napi_value <span class="hljs-title">MyObject::GetValue</span><span class="hljs-params">(napi_env env, napi_callback_info info)</span> </span>{</li><li>    <span class="hljs-built_in">OH_LOG_INFO</span>(LOG_APP, <span class="hljs-string">"MyObject::GetValue called"</span>);</li><li>
</li><li>    napi_value jsThis;</li><li>    <span class="hljs-built_in">napi_get_cb_info</span>(env, info, <span class="hljs-literal">nullptr</span>, <span class="hljs-literal">nullptr</span>, &amp;jsThis, <span class="hljs-literal">nullptr</span>);</li><li>
</li><li>    MyObject *obj;</li><li>    <span class="hljs-comment">// 通过napi_unwrap_sendable将jsThis之前绑定的C++对象取出，并对其进行操作</span></li><li>    <span class="hljs-built_in">napi_unwrap_sendable</span>(env, jsThis, <span class="hljs-built_in">reinterpret_cast</span>&lt;<span class="hljs-type">void</span> **&gt;(&amp;obj));</li><li>    napi_value num;</li><li>    <span class="hljs-built_in">napi_create_double</span>(env, obj-&gt;value_, &amp;num);</li><li>
</li><li>    <span class="hljs-keyword">return</span> num;</li><li>}</li><li>
</li><li><span class="hljs-function">napi_value <span class="hljs-title">MyObject::SetValue</span><span class="hljs-params">(napi_env env, napi_callback_info info)</span> </span>{</li><li>    <span class="hljs-built_in">OH_LOG_INFO</span>(LOG_APP, <span class="hljs-string">"MyObject::SetValue called"</span>);</li><li>
</li><li>    <span class="hljs-type">size_t</span> argc = <span class="hljs-number">1</span>;</li><li>    napi_value value;</li><li>    napi_value jsThis;</li><li>
</li><li>    <span class="hljs-built_in">napi_get_cb_info</span>(env, info, &amp;argc, &amp;value, &amp;jsThis, <span class="hljs-literal">nullptr</span>);</li><li>
</li><li>    MyObject *obj;</li><li>    <span class="hljs-comment">// 通过napi_unwrap_sendable将jsThis之前绑定的C++对象取出，并对其进行操作</span></li><li>    <span class="hljs-built_in">napi_unwrap_sendable</span>(env, jsThis, <span class="hljs-built_in">reinterpret_cast</span>&lt;<span class="hljs-type">void</span> **&gt;(&amp;obj));</li><li>    <span class="hljs-built_in">napi_get_value_double</span>(env, value, &amp;obj-&gt;value_);</li><li>
</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-literal">nullptr</span>;</li><li>}</li><li>
</li><li><span class="hljs-function">napi_value <span class="hljs-title">MyObject::PlusOne</span><span class="hljs-params">(napi_env env, napi_callback_info info)</span> </span>{</li><li>    <span class="hljs-built_in">OH_LOG_INFO</span>(LOG_APP, <span class="hljs-string">"MyObject::PlusOne called"</span>);</li><li>
</li><li>    napi_value jsThis;</li><li>    <span class="hljs-built_in">napi_get_cb_info</span>(env, info, <span class="hljs-literal">nullptr</span>, <span class="hljs-literal">nullptr</span>, &amp;jsThis, <span class="hljs-literal">nullptr</span>);</li><li>
</li><li>    MyObject *obj;</li><li>    <span class="hljs-comment">// 通过napi_unwrap_sendable将jsThis之前绑定的C++对象取出，并对其进行操作</span></li><li>    <span class="hljs-built_in">napi_unwrap_sendable</span>(env, jsThis, <span class="hljs-built_in">reinterpret_cast</span>&lt;<span class="hljs-type">void</span> **&gt;(&amp;obj));</li><li>    obj-&gt;value_ += <span class="hljs-number">1</span>;</li><li>    napi_value num;</li><li>    <span class="hljs-built_in">napi_create_double</span>(env, obj-&gt;value_, &amp;num);</li><li>
</li><li>    <span class="hljs-keyword">return</span> num;</li><li>}</li></ol></pre></div></div></li>      <li>       <p>ArkTS侧示例代码</p>       <div _ngcontent-gxw-c106="" class="highlight-div"><div _ngcontent-gxw-c106="" class="highlight-div-header"><div _ngcontent-gxw-c106="" class="highlight-div-header-left"><div _ngcontent-gxw-c106="" class="handle-button expand-button"><div _ngcontent-gxw-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gxw-c106="" class="highlight-div-header-right"><div _ngcontent-gxw-c106="" class="handle-button ai-button"></div><div _ngcontent-gxw-c106="" class="handle-button line-button"><div _ngcontent-gxw-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gxw-c106="" class="handle-button theme-button"><div _ngcontent-gxw-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gxw-c106="" class="handle-button copy-button"><div _ngcontent-gxw-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gxw-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">MyObject</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'libentry.so'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-built_in">object</span> : <span class="hljs-title class_">MyObject</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyObject</span>(<span class="hljs-number">0</span>);</li><li><span class="hljs-built_in">object</span>.<span class="hljs-property">value</span> = <span class="hljs-number">1023</span>;</li><li>hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">'MyObject value after set: %{public}d'</span>, <span class="hljs-built_in">object</span>.<span class="hljs-property">value</span>);</li><li>hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">'MyObject plusOne: %{public}d'</span>, <span class="hljs-built_in">object</span>.<span class="hljs-title function_">plusOne</span>());</li></ol></pre></div></div></li>     </ol>    </div>   </div>   <div></div></div>