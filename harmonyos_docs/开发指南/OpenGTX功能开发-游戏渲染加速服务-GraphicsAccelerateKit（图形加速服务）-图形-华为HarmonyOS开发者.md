<h1 _ngcontent-jdg-c119="" class="doc-title ng-star-inserted" title="OpenGTX功能开发"> OpenGTX功能开发 </h1>

<div _ngcontent-jdg-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <div class="tiledSection">     <h2 id="section1260114611332">概述<i class="anchor-icon anchor-icon-link" anchorid="section1260114611332" tips="复制节点链接"></i></h2>          <p>OpenGTX是GPU Turbo X的开放式入口，根据游戏开发者主动提供的游戏过程中的关键信息，使能LTPO（动态帧率/刷新率）等游戏加速方案，助力游戏开发者打造高画质、高流畅、低功耗极致体验。LTPO通过动态感知游戏渲染状态、游戏场景、设备状态等关键信息，动态调整游戏的帧率/刷新率以及设备的SOC/DDR频率。</p>     <p><span><img height="499.96695000000005" originheight="606" originwidth="775" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114355.20864557516229199099141673269090:50001231000000:2800:561CCAFC007B4B099DEECC102E4A3E29B62FA071DFD17CCAE48D8CD5566D91DD.png" title="点击放大" width="639.3975"></span></p>    </div>    <div class="tiledSection">     <h2 id="section19678153515291">业务流程<i class="anchor-icon anchor-icon-link" anchorid="section19678153515291" tips="复制节点链接"></i></h2>          <p>LTPO的主要业务流程如下：</p>     <p><span><img originheight="955" originwidth="965" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114356.98630491913227982055955666411451:50001231000000:2800:2A28A88E06959750B2BC04C457F7872E31415D359172B42B364D48D2AC8BD132.png" width="920" height="910.4663212435232"></span></p>     <ol>      <li>用户进入游戏。</li>      <li>游戏应用调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/_graphics_accelerate#ga94aadbb64ffb5382a4661790c040f1c3" target="_blank">HMS_OpenGTX_CreateContext</a>接口创建OpenGTX上下文实例。</li>      <li>游戏应用调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/_graphics_accelerate#gaaa09a16f113a0a9e0014b495ff961b6e" target="_blank">HMS_OpenGTX_SetConfiguration</a>接口初始化配置实例属性，包含LTPO模式、目标帧率、包名、游戏类型、分辨率、游戏关键线程等属性。</li>      <li>游戏应用调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/_graphics_accelerate#ga67e6cc5b491539c5e219f9e9ef15abca" target="_blank">HMS_OpenGTX_Activate</a>接口激活OpenGTX上下文实例。</li>      <li>游戏切换不同游戏场景后调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/_graphics_accelerate#gafd01b1b2726f10b10968cdcd73da632f" target="_blank">HMS_OpenGTX_DispatchGameSceneInfo</a>接口发送游戏场景信息，包含场景类型、指定帧率、调度帧率范围、当前分辨率等信息。</li>      <li>游戏应用在每帧渲染前调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/_graphics_accelerate#ga0c0b0034e4a6337e509888b2a9611489" target="_blank">HMS_OpenGTX_DispatchFrameRenderInfo</a>接口发送游戏帧渲染信息，包含游戏主相机的位置和欧拉角。</li>      <li>游戏应用在每帧渲染前如遇到网络时延档位变化，调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/_graphics_accelerate#gad7a6544a832f28ef068df580ac8a1b78" target="_blank">HMS_OpenGTX_DispatchNetworkInfo</a>接口发送游戏网络信息，包含服务器IP地址、网络时延等信息。</li>      <li>游戏应用正常绘制。</li>      <li>一帧送显。</li>      <li>每帧结束，将帧尾决策帧率、决策设备频率通知到设备。</li>      <li>用户退出游戏。</li>      <li>游戏应用调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/_graphics_accelerate#ga0b757b487acf42e92b06178e159b03ac" target="_blank">HMS_OpenGTX_DestroyContext</a>接口销毁OpenGTX上下文实例并释放内存资源。</li>     </ol>    </div>    <div class="tiledSection">     <h2 id="section6979123962911">开发步骤<i class="anchor-icon anchor-icon-link" anchorid="section6979123962911" tips="复制节点链接"></i></h2>          <p>本节介绍OpenGTX的开发接入，从流程上分别阐述每个步骤的实现和调用。详细代码请参考<a href="https://gitcode.com/harmonyos_samples/open-gtx-samplecode-clientdemo-cpp" target="_blank">OpenGTX Sample</a>。</p>    </div>    <div class="tiledSection">     <h3 id="section1452251416266" class="firsth2">设置项目配置项<i class="anchor-icon anchor-icon-link" anchorid="section1452251416266" tips="复制节点链接"></i></h3>          <p>在<span class="filepath">“src/main/module.json5”</span>module层级中添加以下配置。</p>     <div _ngcontent-jdg-c106="" class="highlight-div"><div _ngcontent-jdg-c106="" class="highlight-div-header"><div _ngcontent-jdg-c106="" class="highlight-div-header-left"><div _ngcontent-jdg-c106="" class="handle-button expand-button"><div _ngcontent-jdg-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jdg-c106="" class="highlight-div-header-right"><div _ngcontent-jdg-c106="" class="handle-button ai-button"></div><div _ngcontent-jdg-c106="" class="handle-button line-button"><div _ngcontent-jdg-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jdg-c106="" class="handle-button theme-button"><div _ngcontent-jdg-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jdg-c106="" class="handle-button copy-button"><div _ngcontent-jdg-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jdg-c106="" class="highlight-scroll-div"><pre class="json prettyprint linenums hljs language-json" hw-language="json" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-attr">"metadata"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span></li><li>  <span class="hljs-punctuation">{</span></li><li>    <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"GraphicsAccelerateKit_LTPO"</span><span class="hljs-punctuation">,</span></li><li>    <span class="hljs-attr">"value"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"true"</span></li><li>  <span class="hljs-punctuation">}</span></li><li><span class="hljs-punctuation">]</span></li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="section384164010196">头文件引用<i class="anchor-icon anchor-icon-link" anchorid="section384164010196" tips="复制节点链接"></i></h3>          <div class="p">      引用Graphics Accelerate Kit OpenGTX头文件：opengtx_base.h。      <div _ngcontent-jdg-c106="" class="highlight-div"><div _ngcontent-jdg-c106="" class="highlight-div-header"><div _ngcontent-jdg-c106="" class="highlight-div-header-left"><div _ngcontent-jdg-c106="" class="handle-button expand-button"><div _ngcontent-jdg-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jdg-c106="" class="highlight-div-header-right"><div _ngcontent-jdg-c106="" class="handle-button ai-button"></div><div _ngcontent-jdg-c106="" class="handle-button line-button"><div _ngcontent-jdg-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jdg-c106="" class="handle-button theme-button"><div _ngcontent-jdg-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jdg-c106="" class="handle-button copy-button"><div _ngcontent-jdg-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jdg-c106="" class="highlight-scroll-div"><pre class="cpp prettyprint linenums hljs language-cpp" hw-language="cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 引用OpenGTX头文件 opengtx_base.h</span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;graphics_game_sdk/opengtx_base.h&gt;</span></span></li></ol></pre></div></div>     </div>    </div>    <div class="tiledSection">     <h3 id="section156111314818">编写CMakeLists.txt<i class="anchor-icon anchor-icon-link" anchorid="section156111314818" tips="复制节点链接"></i></h3>          <div _ngcontent-jdg-c106="" class="highlight-div"><div _ngcontent-jdg-c106="" class="highlight-div-header"><div _ngcontent-jdg-c106="" class="highlight-div-header-left"><div _ngcontent-jdg-c106="" class="handle-button expand-button"><div _ngcontent-jdg-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jdg-c106="" class="highlight-div-header-right"><div _ngcontent-jdg-c106="" class="handle-button ai-button"></div><div _ngcontent-jdg-c106="" class="handle-button line-button"><div _ngcontent-jdg-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jdg-c106="" class="handle-button theme-button"><div _ngcontent-jdg-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jdg-c106="" class="handle-button copy-button"><div _ngcontent-jdg-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jdg-c106="" class="highlight-scroll-div"><pre class="cpp prettyprint linenums hljs language-cpp" hw-language="cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-built_in">find_library</span>(</li><li>    # Sets the name of the path variable.</li><li>    opengtx-lib</li><li>    # Specifies the name of the NDK library that you want CMake to locate.</li><li>    libopengtx.so</li><li>)</li><li><span class="hljs-built_in">find_library</span>(</li><li>    # Sets the name of the path variable.</li><li>    GLES-lib</li><li>    # Specifies the name of the NDK library that you want CMake to locate.</li><li>    GLESv3</li><li>)</li><li><span class="hljs-built_in">find_library</span>(</li><li>    # Sets the name of the path variable.</li><li>    hilog-lib</li><li>    # Specifies the name of the NDK library that you want CMake to locate.</li><li>    hilog_ndk.z</li><li>)</li><li>
</li><li><span class="hljs-built_in">target_link_libraries</span>(entry PUBLIC</li><li>    ${opengtx-lib} ${GLES-lib} ${hilog-lib}</li><li>)</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="section14305526111610">OpenGTX初始化<i class="anchor-icon anchor-icon-link" anchorid="section14305526111610" tips="复制节点链接"></i></h3>          <p>在surface创建后，会触发其事件回调函数<span class="parmname">Core::OnSurfaceCreated()</span>，在该函数中完成OpenGTX上下文实例创建、OpenGTX属性配置和功能激活。其中OpenGTX上下文实例负责管理OpenGTX整个生命周期。</p>     <ol>      <li>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/_graphics_accelerate#ga94aadbb64ffb5382a4661790c040f1c3" target="_blank">HMS_OpenGTX_CreateContext</a>接口创建OpenGTX上下文实例。如果返回nullptr，则说明OpenGTX上下文实例创建失败，或当前硬件设备不支持开启OpenGTX。       <div _ngcontent-jdg-c106="" class="highlight-div"><div _ngcontent-jdg-c106="" class="highlight-div-header"><div _ngcontent-jdg-c106="" class="highlight-div-header-left"><div _ngcontent-jdg-c106="" class="handle-button expand-button"><div _ngcontent-jdg-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jdg-c106="" class="highlight-div-header-right"><div _ngcontent-jdg-c106="" class="handle-button ai-button"></div><div _ngcontent-jdg-c106="" class="handle-button line-button"><div _ngcontent-jdg-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jdg-c106="" class="handle-button theme-button"><div _ngcontent-jdg-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jdg-c106="" class="handle-button copy-button"><div _ngcontent-jdg-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jdg-c106="" class="highlight-scroll-div"><pre class="cpp prettyprint linenums hljs language-cpp" hw-language="cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 创建OpenGTX上下文实例</span></li><li>OpenGTX_Context *context_ = <span class="hljs-built_in">HMS_OpenGTX_CreateContext</span>(<span class="hljs-literal">nullptr</span>);</li><li><span class="hljs-keyword">if</span> (context_ == <span class="hljs-literal">nullptr</span>) {</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;</li><li>}</li></ol></pre></div></div></li>      <li>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/_graphics_accelerate#gaaa09a16f113a0a9e0014b495ff961b6e" target="_blank">HMS_OpenGTX_SetConfiguration</a>接口属性配置，包含LTPO模式、目标帧率、包名、游戏类型、分辨率、游戏关键线程等属性。       <div _ngcontent-jdg-c106="" class="highlight-div"><div _ngcontent-jdg-c106="" class="highlight-div-header"><div _ngcontent-jdg-c106="" class="highlight-div-header-left"><div _ngcontent-jdg-c106="" class="handle-button expand-button"><div _ngcontent-jdg-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jdg-c106="" class="highlight-div-header-right"><div _ngcontent-jdg-c106="" class="handle-button ai-button"></div><div _ngcontent-jdg-c106="" class="handle-button line-button"><div _ngcontent-jdg-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jdg-c106="" class="handle-button theme-button"><div _ngcontent-jdg-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jdg-c106="" class="handle-button copy-button"><div _ngcontent-jdg-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jdg-c106="" class="highlight-scroll-div"><pre class="cpp prettyprint linenums hljs language-cpp" hw-language="cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 初始化OpenGTX接口调用错误码</span></li><li>OpenGTX_ErrorCode errorCode = OPENGTX_SUCCESS;</li><li><span class="hljs-comment">// OpenGTX属性配置结构体</span></li><li>OpenGTX_ConfigDescription config;</li><li><span class="hljs-comment">// LTPO调度模式</span></li><li>config.mode = ADAPTIVE_MODE;</li><li><span class="hljs-comment">// 游戏设置目标帧率</span></li><li>config.targetFPS = <span class="hljs-number">120</span>;</li><li><span class="hljs-comment">// 游戏包名</span></li><li>config.packageName = (<span class="hljs-type">char</span>*)<span class="hljs-string">"OpenGTX"</span>;</li><li><span class="hljs-comment">// 游戏版本</span></li><li>config.appVersion = (<span class="hljs-type">char</span>*)<span class="hljs-string">"1.1.0"</span>;</li><li><span class="hljs-comment">// 引擎类型</span></li><li>config.engineType = UNREAL;</li><li><span class="hljs-comment">// 引擎版本</span></li><li>config.engineVersion = (<span class="hljs-type">char</span>*)<span class="hljs-string">"4.26.2"</span>;</li><li><span class="hljs-comment">// 游戏类别</span></li><li>config.gameType = RPG;</li><li><span class="hljs-comment">// 游戏最高画质等级</span></li><li>config.pictureQualityMaxLevel = HD;</li><li><span class="hljs-comment">// 游戏设置最大分辨率</span></li><li>config.resolutionMaxValue = OpenGTX_ResolutionValue { <span class="hljs-number">1280</span>, <span class="hljs-number">720</span>};</li><li><span class="hljs-comment">// 游戏逻辑线程</span></li><li>config.gameMainThreadId = <span class="hljs-number">11</span>;</li><li><span class="hljs-comment">// 游戏渲染线程</span></li><li>config.gameRenderThreadId = <span class="hljs-number">11</span>;</li><li><span class="hljs-comment">// 游戏运行其他关键线程</span></li><li>config.gameKeyThreadIds[<span class="hljs-number">0</span>] = <span class="hljs-number">0</span>;</li><li>config.gameKeyThreadIds[<span class="hljs-number">1</span>] = <span class="hljs-number">0</span>;</li><li>config.gameKeyThreadIds[<span class="hljs-number">2</span>] = <span class="hljs-number">0</span>;</li><li>config.gameKeyThreadIds[<span class="hljs-number">3</span>] = <span class="hljs-number">0</span>;</li><li>config.gameKeyThreadIds[<span class="hljs-number">4</span>] = <span class="hljs-number">0</span>;</li><li><span class="hljs-comment">// 游戏图形API是否为Vulkan</span></li><li>config.vulkanSupport = <span class="hljs-literal">false</span>;</li><li><span class="hljs-comment">// 初始化OpenGTX实例，配置OpenGTX属性</span></li><li>errorCode = <span class="hljs-built_in">HMS_OpenGTX_SetConfiguration</span>(context_, &amp;config);</li><li><span class="hljs-keyword">if</span> (errorCode != OPENGTX_SUCCESS) {</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;</li><li>}</li></ol></pre></div></div></li>      <li>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/_graphics_accelerate#ga67e6cc5b491539c5e219f9e9ef15abca" target="_blank">HMS_OpenGTX_Activate</a>接口激活OpenGTX上下文实例。       <div _ngcontent-jdg-c106="" class="highlight-div"><div _ngcontent-jdg-c106="" class="highlight-div-header"><div _ngcontent-jdg-c106="" class="highlight-div-header-left"><div _ngcontent-jdg-c106="" class="handle-button expand-button"><div _ngcontent-jdg-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jdg-c106="" class="highlight-div-header-right"><div _ngcontent-jdg-c106="" class="handle-button ai-button"></div><div _ngcontent-jdg-c106="" class="handle-button line-button"><div _ngcontent-jdg-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jdg-c106="" class="handle-button theme-button"><div _ngcontent-jdg-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jdg-c106="" class="handle-button copy-button"><div _ngcontent-jdg-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jdg-c106="" class="highlight-scroll-div"><pre class="cpp prettyprint linenums hljs language-cpp" hw-language="cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 激活OpenGTX上下文实例</span></li><li>errorCode = <span class="hljs-built_in">HMS_OpenGTX_Activate</span>(context_);</li><li><span class="hljs-keyword">if</span> (errorCode != OPENGTX_SUCCESS) {</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;</li><li>}</li></ol></pre></div></div></li>      <li>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/_graphics_accelerate#gaa741745687d067180d27d3be30db7422" target="_blank">HMS_OpenGTX_Deactivate</a>接口去激活OpenGTX上下文实例。（在需要关闭OpenGTX功能时调用此接口。去激活后，调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/_graphics_accelerate#gafd01b1b2726f10b10968cdcd73da632f" target="_blank">HMS_OpenGTX_DispatchGameSceneInfo</a>等接口将不会生效）。       <div _ngcontent-jdg-c106="" class="highlight-div"><div _ngcontent-jdg-c106="" class="highlight-div-header"><div _ngcontent-jdg-c106="" class="highlight-div-header-left"><div _ngcontent-jdg-c106="" class="handle-button expand-button"><div _ngcontent-jdg-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jdg-c106="" class="highlight-div-header-right"><div _ngcontent-jdg-c106="" class="handle-button ai-button"></div><div _ngcontent-jdg-c106="" class="handle-button line-button"><div _ngcontent-jdg-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jdg-c106="" class="handle-button theme-button"><div _ngcontent-jdg-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jdg-c106="" class="handle-button copy-button"><div _ngcontent-jdg-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jdg-c106="" class="highlight-scroll-div"><pre class="cpp prettyprint linenums hljs language-cpp" hw-language="cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 去激活OpenGTX上下文实例</span></li><li>errorCode = <span class="hljs-built_in">HMS_OpenGTX_Deactivate</span>(context_);</li><li><span class="hljs-keyword">if</span> (errorCode != OPENGTX_SUCCESS) {</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;</li><li>}</li></ol></pre></div></div></li>     </ol>    </div>    <div class="tiledSection">     <h3 id="section161205281201">OpenGTX关键信息更新<i class="anchor-icon anchor-icon-link" anchorid="section161205281201" tips="复制节点链接"></i></h3>          <ol>      <li>游戏切换不同游戏场景后调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/_graphics_accelerate#gafd01b1b2726f10b10968cdcd73da632f" target="_blank">HMS_OpenGTX_DispatchGameSceneInfo</a>接口发送游戏场景信息，包含场景类型、指定帧率、调度帧率范围、当前分辨率等信息。       <div _ngcontent-jdg-c106="" class="highlight-div"><div _ngcontent-jdg-c106="" class="highlight-div-header"><div _ngcontent-jdg-c106="" class="highlight-div-header-left"><div _ngcontent-jdg-c106="" class="handle-button expand-button"><div _ngcontent-jdg-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jdg-c106="" class="highlight-div-header-right"><div _ngcontent-jdg-c106="" class="handle-button ai-button"></div><div _ngcontent-jdg-c106="" class="handle-button line-button"><div _ngcontent-jdg-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jdg-c106="" class="handle-button theme-button"><div _ngcontent-jdg-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jdg-c106="" class="handle-button copy-button"><div _ngcontent-jdg-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jdg-c106="" class="highlight-scroll-div"><pre class="cpp prettyprint linenums hljs language-cpp" hw-language="cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// OpenGTX游戏场景信息结构体</span></li><li>OpenGTX_GameSceneInfo gameSceneInfo;</li><li><span class="hljs-comment">// 游戏场景类型ID</span></li><li>gameSceneInfo.sceneID = OTHERS_SCENE;</li><li><span class="hljs-comment">// 游戏场景描述</span></li><li>gameSceneInfo.description = (<span class="hljs-type">char</span>*)<span class="hljs-string">"其他场景"</span>;</li><li><span class="hljs-comment">// 游戏场景推荐帧率</span></li><li>gameSceneInfo.recommendFPS = <span class="hljs-number">60</span>;</li><li><span class="hljs-comment">// 游戏场景最小帧率</span></li><li>gameSceneInfo.minFPS = <span class="hljs-number">30</span>;</li><li><span class="hljs-comment">// 游戏场景最大帧率</span></li><li>gameSceneInfo.maxFPS = <span class="hljs-number">90</span>;</li><li><span class="hljs-comment">// 屏幕分辨率 高度</span></li><li>gameSceneInfo.resolutionCurValue.height = <span class="hljs-number">360</span>;</li><li><span class="hljs-comment">// 屏幕分辨率 宽度</span></li><li>gameSceneInfo.resolutionCurValue.width = <span class="hljs-number">7680</span>;</li><li><span class="hljs-comment">// OpenGTX接收游戏场景信息</span></li><li>errorCode = <span class="hljs-built_in">HMS_OpenGTX_DispatchGameSceneInfo</span>(context_, &amp;gameSceneInfo); </li><li><span class="hljs-keyword">if</span> (errorCode != OPENGTX_SUCCESS) {</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;</li><li>}</li></ol></pre></div></div></li>      <li>每帧渲染前调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/_graphics_accelerate#ga0c0b0034e4a6337e509888b2a9611489" target="_blank">HMS_OpenGTX_DispatchFrameRenderInfo</a>接口发送游戏帧渲染信息，包含游戏主相机的位置和欧拉角。       <div _ngcontent-jdg-c106="" class="highlight-div"><div _ngcontent-jdg-c106="" class="highlight-div-header"><div _ngcontent-jdg-c106="" class="highlight-div-header-left"><div _ngcontent-jdg-c106="" class="handle-button expand-button"><div _ngcontent-jdg-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jdg-c106="" class="highlight-div-header-right"><div _ngcontent-jdg-c106="" class="handle-button ai-button"></div><div _ngcontent-jdg-c106="" class="handle-button line-button"><div _ngcontent-jdg-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jdg-c106="" class="handle-button theme-button"><div _ngcontent-jdg-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jdg-c106="" class="handle-button copy-button"><div _ngcontent-jdg-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jdg-c106="" class="highlight-scroll-div"><pre class="cpp prettyprint linenums hljs language-cpp" hw-language="cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// OpenGTX游戏渲染信息结构体</span></li><li>OpenGTX_FrameRenderInfo frameRenderInfo;</li><li><span class="hljs-comment">// 主相机位置</span></li><li>frameRenderInfo.mainCameraPosition = { <span class="hljs-number">0.0f</span>, <span class="hljs-number">0.0f</span>, <span class="hljs-number">0.0f</span> };</li><li><span class="hljs-comment">// 主相机欧拉角</span></li><li>frameRenderInfo.mainCameraRotate = { <span class="hljs-number">0.0f</span>, <span class="hljs-number">0.0f</span>, <span class="hljs-number">0.0f</span> };</li><li><span class="hljs-comment">// OpenGTX接收游戏渲染信息</span></li><li>errorCode = <span class="hljs-built_in">HMS_OpenGTX_DispatchFrameRenderInfo</span>(context_, &amp;frameRenderInfo);</li><li><span class="hljs-keyword">if</span> (errorCode != OPENGTX_SUCCESS) {</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;</li><li>}</li></ol></pre></div></div></li>      <li>每帧渲染前如遇到网络时延档位变化，调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/_graphics_accelerate#gad7a6544a832f28ef068df580ac8a1b78" target="_blank">HMS_OpenGTX_DispatchNetworkInfo</a>接口发送游戏网络信息。包含服务器IP地址、网络时延等信息。       <div _ngcontent-jdg-c106="" class="highlight-div"><div _ngcontent-jdg-c106="" class="highlight-div-header"><div _ngcontent-jdg-c106="" class="highlight-div-header-left"><div _ngcontent-jdg-c106="" class="handle-button expand-button"><div _ngcontent-jdg-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jdg-c106="" class="highlight-div-header-right"><div _ngcontent-jdg-c106="" class="handle-button ai-button"></div><div _ngcontent-jdg-c106="" class="handle-button line-button"><div _ngcontent-jdg-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jdg-c106="" class="handle-button theme-button"><div _ngcontent-jdg-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jdg-c106="" class="handle-button copy-button"><div _ngcontent-jdg-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jdg-c106="" class="highlight-scroll-div"><pre class="cpp prettyprint linenums hljs language-cpp" hw-language="cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// OpenGTX游戏网络信息结构体</span></li><li>OpenGTX_NetworkInfo networkInfo;</li><li><span class="hljs-comment">// OpenGTX游戏网络时延结构体</span></li><li>OpenGTX_NetworkLatency networkLatency;</li><li><span class="hljs-comment">// 网络总时延</span></li><li>networkLatency.total = <span class="hljs-number">50</span>;</li><li><span class="hljs-comment">// 网络上行时延</span></li><li>networkLatency.up = <span class="hljs-number">10</span>;</li><li><span class="hljs-comment">// 网络下行时延</span></li><li>networkLatency.down = <span class="hljs-number">40</span>;</li><li><span class="hljs-comment">// 游戏网络时延</span></li><li>networkInfo.networkLatency = networkLatency;</li><li><span class="hljs-comment">// 游戏服务器IP地址</span></li><li>networkInfo.networkServerIP = (<span class="hljs-type">char</span>*)<span class="hljs-string">"10.10.10.10"</span>;</li><li><span class="hljs-comment">// OpenGTX接收游戏网络信息</span></li><li>errorCode = <span class="hljs-built_in">HMS_OpenGTX_DispatchNetworkInfo</span>(context_, &amp;networkInfo); </li><li><span class="hljs-keyword">if</span> (errorCode != OPENGTX_SUCCESS) {</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;</li><li>}</li></ol></pre></div></div></li>     </ol>    </div>    <div class="tiledSection">     <h3 id="section16329954246">销毁OpenGTX实例<i class="anchor-icon anchor-icon-link" anchorid="section16329954246" tips="复制节点链接"></i></h3>          <p>在surface销毁时，会触发其事件回调函数<span class="parmname">Core::OnSurfaceDestroyed()</span>，在该函数中完成OpenGTX实例的销毁。</p>     <ol>      <li>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/_graphics_accelerate#ga0b757b487acf42e92b06178e159b03ac" target="_blank">HMS_OpenGTX_DestroyContext</a>接口销毁OpenGTX实例，释放内存资源。       <div _ngcontent-jdg-c106="" class="highlight-div"><div _ngcontent-jdg-c106="" class="highlight-div-header"><div _ngcontent-jdg-c106="" class="highlight-div-header-left"><div _ngcontent-jdg-c106="" class="handle-button expand-button"><div _ngcontent-jdg-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jdg-c106="" class="highlight-div-header-right"><div _ngcontent-jdg-c106="" class="handle-button ai-button"></div><div _ngcontent-jdg-c106="" class="handle-button line-button"><div _ngcontent-jdg-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jdg-c106="" class="handle-button theme-button"><div _ngcontent-jdg-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jdg-c106="" class="handle-button copy-button"><div _ngcontent-jdg-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jdg-c106="" class="highlight-scroll-div"><pre class="cpp prettyprint linenums hljs language-cpp" hw-language="cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 销毁OpenGTX上下文实例并释放内存资源</span></li><li>errorCode = <span class="hljs-built_in">HMS_OpenGTX_DestroyContext</span>(&amp;context_);</li><li><span class="hljs-keyword">if</span> (errorCode != OPENGTX_SUCCESS) {</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;</li><li>}</li></ol></pre></div></div></li>     </ol>    </div>   </div>   <div></div></div>