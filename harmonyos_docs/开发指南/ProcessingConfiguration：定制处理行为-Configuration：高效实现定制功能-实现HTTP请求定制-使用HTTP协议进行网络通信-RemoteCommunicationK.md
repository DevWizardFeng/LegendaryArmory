<h1 _ngcontent-iyy-c119="" class="doc-title ng-star-inserted" title="ProcessingConfiguration：定制处理行为"> ProcessingConfiguration：定制处理行为 </h1>

<div _ngcontent-iyy-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div><div class="tiledSection"><h2 id="section85384272914">场景介绍<i class="anchor-icon anchor-icon-link" anchorid="section85384272914" tips="复制节点链接"></i></h2><p>ProcessingConfiguration 是 Remote Communication Kit 中用于定制响应处理行为的一个重要组件。它允许你在消息被分发到不同的处理器之前或之后执行一些自定义的逻辑。场景如检验响应状态是否为成功即响应码是否为200。</p> </div> <div class="tiledSection"><h2 id="section15385135185019">约束与限制<i class="anchor-icon anchor-icon-link" anchorid="section15385135185019" tips="复制节点链接"></i></h2><p>定制处理行为能力支持Phone、2in1、Tablet、Wearable设备。并且从5.1.1(19)开始，新增支持TV设备。</p> </div> <div class="tiledSection"><h2 id="section43169332313">使用示例<i class="anchor-icon anchor-icon-link" anchorid="section43169332313" tips="复制节点链接"></i></h2><ol><li><span>导入需要的模块。</span><p></p><div _ngcontent-iyy-c106="" class="highlight-div"><div _ngcontent-iyy-c106="" class="highlight-div-header"><div _ngcontent-iyy-c106="" class="highlight-div-header-left"><div _ngcontent-iyy-c106="" class="handle-button expand-button"><div _ngcontent-iyy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-iyy-c106="" class="highlight-div-header-right"><div _ngcontent-iyy-c106="" class="handle-button ai-button"></div><div _ngcontent-iyy-c106="" class="handle-button line-button"><div _ngcontent-iyy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-iyy-c106="" class="handle-button theme-button"><div _ngcontent-iyy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-iyy-c106="" class="handle-button copy-button"><div _ngcontent-iyy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-iyy-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { rcp } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.RemoteCommunicationKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li></ol></pre></div></div> <p></p></li><li><span>创建会话、请求以及定义相关处理配置。</span><p></p><div _ngcontent-iyy-c106="" class="highlight-div"><div _ngcontent-iyy-c106="" class="highlight-div-header"><div _ngcontent-iyy-c106="" class="highlight-div-header-left"><div _ngcontent-iyy-c106="" class="handle-button expand-button"><div _ngcontent-iyy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-iyy-c106="" class="highlight-div-header-right"><div _ngcontent-iyy-c106="" class="handle-button ai-button"></div><div _ngcontent-iyy-c106="" class="handle-button line-button"><div _ngcontent-iyy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-iyy-c106="" class="handle-button theme-button"><div _ngcontent-iyy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-iyy-c106="" class="handle-button copy-button"><div _ngcontent-iyy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-iyy-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">const</span> session = rcp.<span class="hljs-title function_">createSession</span>();</li><li><span class="hljs-keyword">const</span> request = <span class="hljs-keyword">new</span> rcp.<span class="hljs-title class_">Request</span>(<span class="hljs-string">"https://www.example.com"</span>);</li><li>
</li><li><span class="hljs-comment">// 定义处理配置，用于验证响应状态码是否为200</span></li><li><span class="hljs-keyword">const</span> <span class="hljs-attr">processing</span>: rcp.<span class="hljs-property">ProcessingConfiguration</span> = {</li><li>  <span class="hljs-attr">validateResponse</span>: (<span class="hljs-attr">response</span>: rcp.<span class="hljs-property">Response</span>): <span class="hljs-function"><span class="hljs-params">boolean</span> =&gt;</span> {</li><li>    <span class="hljs-keyword">return</span> response.<span class="hljs-property">statusCode</span> === <span class="hljs-number">200</span>;</li><li>  },</li><li>};</li><li>
</li><li><span class="hljs-comment">// 将处理配置应用到请求中</span></li><li>request.<span class="hljs-property">configuration</span> = {</li><li>  <span class="hljs-attr">processing</span>: processing,</li><li>};</li></ol></pre></div></div> <p></p></li><li><span>发送请求并等待响应。如果 processing.validateResponse 的返回值是 true，则会执行 then 方法处理成功的响应；如果 processing.validateResponse 的返回值是 false，则会执行 catch 方法处理可能出现的错误。</span><p></p><div _ngcontent-iyy-c106="" class="highlight-div"><div _ngcontent-iyy-c106="" class="highlight-div-header"><div _ngcontent-iyy-c106="" class="highlight-div-header-left"><div _ngcontent-iyy-c106="" class="handle-button expand-button"><div _ngcontent-iyy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-iyy-c106="" class="highlight-div-header-right"><div _ngcontent-iyy-c106="" class="handle-button ai-button"></div><div _ngcontent-iyy-c106="" class="handle-button line-button"><div _ngcontent-iyy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-iyy-c106="" class="handle-button theme-button"><div _ngcontent-iyy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-iyy-c106="" class="handle-button copy-button"><div _ngcontent-iyy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-iyy-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li>session.<span class="hljs-title function_">fetch</span>(request).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">response: rcp.Response</span>) =&gt;</span> {</li><li>  <span class="hljs-comment">// 如果 processing.validateResponse 返回值是true，则会执行以下流程。</span></li><li>  <span class="hljs-keyword">if</span> (response) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`Response received with status code: <span class="hljs-subst">${response.statusCode}</span>`</span>);</li><li>  } <span class="hljs-keyword">else</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'No response received'</span>);</li><li>  }</li><li>  session.<span class="hljs-title function_">close</span>();</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-comment">// 如果 processing.validateResponse 返回值是false，则会执行以下流程。</span></li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`The error is: <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(err)}</span>`</span>);</li><li>  session.<span class="hljs-title function_">close</span>();</li><li>});</li></ol></pre></div></div> <p></p></li></ol> </div> </div> <div></div></div>