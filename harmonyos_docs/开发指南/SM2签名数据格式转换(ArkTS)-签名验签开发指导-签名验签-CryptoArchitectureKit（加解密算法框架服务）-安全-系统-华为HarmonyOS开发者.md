<h1 _ngcontent-bvl-c119="" class="doc-title ng-star-inserted" title="SM2签名数据格式转换(ArkTS)"> SM2签名数据格式转换(ArkTS) </h1>

<div _ngcontent-bvl-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p>当前支持DER格式与（r、s）格式互转的能力。</p>    <p>开发者可指定SM2签名数据，将其转换成DER格式密文。反之，也可以从DER格式密文中取出具体的SM2签名数据。</p>    <p><strong>指定密文参数，转换为DER格式</strong></p>    <ol>     <li>      <p>构造<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-cryptoframework#eccsignaturespec20" target="_blank">EccSignatureSpec</a>对象，用于指定SM2密文参数。</p></li>     <li>      <p>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-cryptoframework#geneccsignature20" target="_blank">genEccSignature</a>，将EccSignatureSpec对象传入，转换为DER格式的SM2密文。</p></li>    </ol>    <div _ngcontent-bvl-c106="" class="highlight-div"><div _ngcontent-bvl-c106="" class="highlight-div-header"><div _ngcontent-bvl-c106="" class="highlight-div-header-left"><div _ngcontent-bvl-c106="" class="handle-button expand-button"><div _ngcontent-bvl-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bvl-c106="" class="highlight-div-header-right"><div _ngcontent-bvl-c106="" class="handle-button ai-button"></div><div _ngcontent-bvl-c106="" class="handle-button line-button"><div _ngcontent-bvl-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bvl-c106="" class="handle-button theme-button"><div _ngcontent-bvl-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bvl-c106="" class="handle-button copy-button"><div _ngcontent-bvl-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bvl-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { cryptoFramework } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.CryptoArchitectureKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">testGenEccSignature</span>(<span class="hljs-params"></span>) {</li><li>  <span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">spec</span>: cryptoFramework.<span class="hljs-property">EccSignatureSpec</span> = {</li><li>      <span class="hljs-attr">r</span>: <span class="hljs-title class_">BigInt</span>(<span class="hljs-string">'97726608965854271693043443511967021777934035174185659091642456228829830775155'</span>),</li><li>      <span class="hljs-attr">s</span>: <span class="hljs-title class_">BigInt</span>(<span class="hljs-string">'23084224202834231287427338597254751764391338275617140205467537273296855150376'</span>),</li><li>    };</li><li>
</li><li>    <span class="hljs-keyword">let</span> data = cryptoFramework.<span class="hljs-property">SignatureUtils</span>.<span class="hljs-title function_">genEccSignature</span>(spec);</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'genEccSignature success'</span>);</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'data is '</span> + data);</li><li>  } <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">e</span>: <span class="hljs-title class_">BusinessError</span> = err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>;</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`ecc error, <span class="hljs-subst">${e.code}</span>, <span class="hljs-subst">${e.message}</span>`</span>);</li><li>  }</li><li>}</li></ol></pre></div></div>    <p><strong>指定DER格式，转换为（r、s）格式</strong></p>    <ol>     <li>      <p>指定DER格式的SM2密文参数。</p></li>     <li>      <p>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-cryptoframework#geneccsignaturespec20" target="_blank">genEccSignatureSpec</a>，将DER格式数据传入，转换为(r、s)格式的SM2密文。</p></li>    </ol>    <div _ngcontent-bvl-c106="" class="highlight-div"><div _ngcontent-bvl-c106="" class="highlight-div-header"><div _ngcontent-bvl-c106="" class="highlight-div-header-left"><div _ngcontent-bvl-c106="" class="handle-button expand-button"><div _ngcontent-bvl-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bvl-c106="" class="highlight-div-header-right"><div _ngcontent-bvl-c106="" class="handle-button ai-button"></div><div _ngcontent-bvl-c106="" class="handle-button line-button"><div _ngcontent-bvl-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bvl-c106="" class="handle-button theme-button"><div _ngcontent-bvl-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bvl-c106="" class="handle-button copy-button"><div _ngcontent-bvl-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bvl-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { cryptoFramework } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.CryptoArchitectureKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">testGenEccSignatureSpec</span>(<span class="hljs-params"></span>) {</li><li>  <span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">let</span> data =</li><li>      <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>([<span class="hljs-number">48</span>, <span class="hljs-number">69</span>, <span class="hljs-number">2</span>, <span class="hljs-number">33</span>, <span class="hljs-number">0</span>, <span class="hljs-number">216</span>, <span class="hljs-number">15</span>, <span class="hljs-number">76</span>, <span class="hljs-number">238</span>, <span class="hljs-number">158</span>, <span class="hljs-number">165</span>, <span class="hljs-number">108</span>, <span class="hljs-number">76</span>, <span class="hljs-number">72</span>, <span class="hljs-number">63</span>, <span class="hljs-number">115</span>, <span class="hljs-number">52</span>, <span class="hljs-number">255</span>, <span class="hljs-number">51</span>, <span class="hljs-number">149</span>, <span class="hljs-number">54</span>, <span class="hljs-number">224</span>,</li><li>        <span class="hljs-number">179</span>, <span class="hljs-number">49</span>, <span class="hljs-number">225</span>, <span class="hljs-number">70</span>, <span class="hljs-number">36</span>, <span class="hljs-number">117</span>, <span class="hljs-number">88</span>, <span class="hljs-number">154</span>, <span class="hljs-number">154</span>, <span class="hljs-number">27</span>, <span class="hljs-number">194</span>, <span class="hljs-number">161</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">115</span>, <span class="hljs-number">2</span>, <span class="hljs-number">32</span>, <span class="hljs-number">51</span>, <span class="hljs-number">9</span>, <span class="hljs-number">53</span>, <span class="hljs-number">55</span>, <span class="hljs-number">248</span>, <span class="hljs-number">82</span>, <span class="hljs-number">7</span>, <span class="hljs-number">159</span>, <span class="hljs-number">179</span>,</li><li>        <span class="hljs-number">144</span>, <span class="hljs-number">57</span>, <span class="hljs-number">151</span>, <span class="hljs-number">195</span>, <span class="hljs-number">17</span>, <span class="hljs-number">31</span>, <span class="hljs-number">106</span>, <span class="hljs-number">123</span>, <span class="hljs-number">32</span>, <span class="hljs-number">139</span>, <span class="hljs-number">219</span>, <span class="hljs-number">6</span>, <span class="hljs-number">253</span>, <span class="hljs-number">62</span>, <span class="hljs-number">240</span>, <span class="hljs-number">181</span>, <span class="hljs-number">134</span>, <span class="hljs-number">214</span>, <span class="hljs-number">107</span>, <span class="hljs-number">27</span>, <span class="hljs-number">230</span>, <span class="hljs-number">175</span>, <span class="hljs-number">40</span>]);</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">spec</span>: cryptoFramework.<span class="hljs-property">EccSignatureSpec</span> = cryptoFramework.<span class="hljs-property">SignatureUtils</span>.<span class="hljs-title function_">genEccSignatureSpec</span>(data);</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'genEccSignatureSpec success'</span>);</li><li>  } <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">e</span>: <span class="hljs-title class_">BusinessError</span> = err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>;</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`ecc error, <span class="hljs-subst">${e.code}</span>, <span class="hljs-subst">${e.message}</span>`</span>);</li><li>  }</li><li>}</li></ol></pre></div></div>   </div>   <div></div></div>