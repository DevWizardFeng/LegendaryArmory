<h1 _ngcontent-yox-c119="" class="doc-title ng-star-inserted" title="SSAP服务端"> SSAP服务端 </h1>

<div _ngcontent-yox-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p>提供SSAP（SparkLink Service Access Protocol）服务端相关的连接、数据传输和服务管理功能。</p>    <div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content">      <p>建立SSAP连接后，SSAP服务端广播会自动停止。后续如果服务端期望被客户端发现，可参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/nearlink-send-advertising">发送星闪广播</a>，重新发起广播。</p>     </div></div></div>    <div class="tiledSection">     <h2 id="section874625817512">场景介绍<i class="anchor-icon anchor-icon-link" anchorid="section874625817512" tips="复制节点链接"></i></h2>          <p>支持应用基于Nearlink技术进行数据传输，设备作为服务端，客户端可连接该服务端进行数据传输。</p>    </div>    <div class="tiledSection">     <h2 id="section11948101511812">接口说明<i class="anchor-icon anchor-icon-link" anchorid="section11948101511812" tips="复制节点链接"></i></h2>          <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.4.2.1.3.1.1" valign="top" width="63.71%">          <p>接口名</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.4.2.1.3.1.2" valign="top" width="36.29%">          <p>描述</p></th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="63.71%">          <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/nearlink-ssap#section383817192117" target="_blank">createServer</a>(): Server</p></td>         <td class="cellrowborder" valign="top" width="36.29%">          <p>创建ssap服务端实例。</p></td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="63.71%">          <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/nearlink-ssap#section169891248173012" target="_blank">addService</a>(service: Service): void</p></td>         <td class="cellrowborder" valign="top" width="36.29%">          <p>服务端添加服务。</p></td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="63.71%">          <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/nearlink-ssap#section168082298487" target="_blank">on</a>(type: 'connectionStateChange', callback: Callback&lt;ConnectionChangeState&gt;): void</p></td>         <td class="cellrowborder" valign="top" width="36.29%">          <p>订阅连接状态变化事件。</p></td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="63.71%">          <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/nearlink-ssap#section16823110115120" target="_blank">on</a>(type: 'propertyRead', callback: Callback&lt;PropertyReadRequest&gt;): void</p></td>         <td class="cellrowborder" valign="top" width="36.29%">          <p>订阅客户端的读请求事件。</p></td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="63.71%">          <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/nearlink-ssap#section299716275465" target="_blank">sendResponse</a>(response: ServerResponse): void</p></td>         <td class="cellrowborder" valign="top" width="36.29%">          <p>回复客户端读/写请求。</p></td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="63.71%">          <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/nearlink-ssap#section19961193482813" target="_blank">notifyPropertyChanged</a>(address: string, property: Property): Promise&lt;void&gt;</p></td>         <td class="cellrowborder" valign="top" width="36.29%">          <p>通知客户端property值更新。</p></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="section19531434125318">开发步骤<i class="anchor-icon anchor-icon-link" anchorid="section19531434125318" tips="复制节点链接"></i></h2>          <ol>      <li><span>导入相关模块。</span>       <p></p>       <div _ngcontent-yox-c106="" class="highlight-div"><div _ngcontent-yox-c106="" class="highlight-div-header"><div _ngcontent-yox-c106="" class="highlight-div-header-left"><div _ngcontent-yox-c106="" class="handle-button expand-button"><div _ngcontent-yox-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-yox-c106="" class="highlight-div-header-right"><div _ngcontent-yox-c106="" class="handle-button ai-button"></div><div _ngcontent-yox-c106="" class="handle-button line-button"><div _ngcontent-yox-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-yox-c106="" class="handle-button theme-button"><div _ngcontent-yox-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-yox-c106="" class="handle-button copy-button"><div _ngcontent-yox-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-yox-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { ssap } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NearLinkKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li></ol></pre></div></div>       <p></p></li>      <li id="li155814147593"><span>创建ssap服务端实例。</span>       <p></p>       <div _ngcontent-yox-c106="" class="highlight-div"><div _ngcontent-yox-c106="" class="highlight-div-header"><div _ngcontent-yox-c106="" class="highlight-div-header-left"><div _ngcontent-yox-c106="" class="handle-button expand-button"><div _ngcontent-yox-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-yox-c106="" class="highlight-div-header-right"><div _ngcontent-yox-c106="" class="handle-button ai-button"></div><div _ngcontent-yox-c106="" class="handle-button line-button"><div _ngcontent-yox-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-yox-c106="" class="handle-button theme-button"><div _ngcontent-yox-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-yox-c106="" class="handle-button copy-button"><div _ngcontent-yox-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-yox-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">let</span> <span class="hljs-attr">server</span>: ssap.<span class="hljs-property">Server</span>;</li><li><span class="hljs-keyword">try</span> {</li><li>  server = ssap.<span class="hljs-title function_">createServer</span>();</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'server: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(server));</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>       <p></p></li>      <li><span>添加服务端支持的服务，其中server对象在<a href="/consumer/cn/doc/harmonyos-guides/nearlink-ssap-server-connect#li155814147593">步骤2</a>创建，后续步骤中使用的server对象也是一样，不再赘述。</span>       <p></p>       <div _ngcontent-yox-c106="" class="highlight-div"><div _ngcontent-yox-c106="" class="highlight-div-header"><div _ngcontent-yox-c106="" class="highlight-div-header-left"><div _ngcontent-yox-c106="" class="handle-button expand-button"><div _ngcontent-yox-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-yox-c106="" class="highlight-div-header-right"><div _ngcontent-yox-c106="" class="handle-button ai-button"></div><div _ngcontent-yox-c106="" class="handle-button line-button"><div _ngcontent-yox-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-yox-c106="" class="handle-button theme-button"><div _ngcontent-yox-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-yox-c106="" class="handle-button copy-button"><div _ngcontent-yox-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-yox-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 构造descriptor</span></li><li><span class="hljs-keyword">let</span> <span class="hljs-variable">descriptorsArray</span>: <span class="hljs-title class_">Array</span>&lt;<span class="hljs-title class_">ssap</span>.<span class="hljs-title class_">PropertyDescriptor</span>&gt; = [];</li><li><span class="hljs-keyword">let</span> <span class="hljs-variable">arrayBuffer</span> = <span class="hljs-variable">new</span> <span class="hljs-title function_">ArrayBuffer</span>(<span class="hljs-number">2</span>);</li><li><span class="hljs-keyword">let</span> <span class="hljs-variable">descValue</span> = <span class="hljs-variable">new</span> <span class="hljs-title function_">Uint8Array</span>(<span class="hljs-variable">arrayBuffer</span>);</li><li><span class="hljs-variable">descValue</span>[<span class="hljs-number">0</span>] = <span class="hljs-number">11</span>;</li><li><span class="hljs-variable">descValue</span>[<span class="hljs-number">1</span>] = <span class="hljs-number">22</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-variable">descriptor</span>: <span class="hljs-title class_">ssap</span>.<span class="hljs-title class_">PropertyDescriptor</span> = {</li><li>  <span class="hljs-variable">serviceUuid</span>:<span class="hljs-string">'37bea880-fc70-11ea-b720-000000004386'</span>,</li><li>  <span class="hljs-variable">propertyUuid</span>: <span class="hljs-string">'37bea880-fc70-11ea-b720-000000001234'</span>,</li><li>  <span class="hljs-variable">value</span>: <span class="hljs-title class_">arrayBuffer</span>,</li><li>  <span class="hljs-variable">descriptorType</span>:<span class="hljs-title class_">ssap</span>.<span class="hljs-title class_">PropertyDescriptorType</span>.<span class="hljs-title class_">PROPERTY</span>,</li><li>  <span class="hljs-variable">isWriteable</span>:<span class="hljs-keyword">true</span></li><li>};</li><li><span class="hljs-variable">descriptorsArray</span>[<span class="hljs-number">0</span>] = <span class="hljs-variable">descriptor</span>;</li><li><span class="hljs-comment">// 构造properties</span></li><li><span class="hljs-keyword">let</span> <span class="hljs-variable">propertiesArray</span>: <span class="hljs-title class_">Array</span>&lt;<span class="hljs-title class_">ssap</span>.<span class="hljs-title class_">Property</span>&gt; = [];</li><li><span class="hljs-keyword">let</span> <span class="hljs-variable">arrayBufferProperty</span> = <span class="hljs-variable">new</span> <span class="hljs-title function_">ArrayBuffer</span>(<span class="hljs-number">1</span>);</li><li><span class="hljs-keyword">let</span> <span class="hljs-variable">properValue</span> = <span class="hljs-variable">new</span> <span class="hljs-title function_">Uint8Array</span>(<span class="hljs-variable">arrayBufferProperty</span>);</li><li><span class="hljs-variable">properValue</span>[<span class="hljs-number">0</span>] = <span class="hljs-number">1</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-variable">property1</span>: <span class="hljs-title class_">ssap</span>.<span class="hljs-title class_">Property</span> = {</li><li>  <span class="hljs-variable">serviceUuid</span>:<span class="hljs-string">'37bea880-fc70-11ea-b720-000000004386'</span>,</li><li>  <span class="hljs-variable">propertyUuid</span>: <span class="hljs-string">'37bea880-fc70-11ea-b720-000000001234'</span>,</li><li>  <span class="hljs-variable">value</span>: <span class="hljs-title class_">arrayBufferProperty</span>,</li><li>  <span class="hljs-variable">descriptors</span>:<span class="hljs-title class_">descriptorsArray</span>,</li><li>  <span class="hljs-variable">operation</span>:<span class="hljs-number">3</span> <span class="hljs-comment">// 属性可读且可写</span></li><li>};</li><li><span class="hljs-keyword">let</span> <span class="hljs-variable">property2</span>: <span class="hljs-title class_">ssap</span>.<span class="hljs-title class_">Property</span> = {</li><li>  <span class="hljs-variable">serviceUuid</span>:<span class="hljs-string">'37bea880-fc70-11ea-b720-000000004386'</span>,</li><li>  <span class="hljs-variable">propertyUuid</span>: <span class="hljs-string">'37bea880-fc70-11ea-b720-000000003421'</span>,</li><li>  <span class="hljs-variable">value</span>: <span class="hljs-title class_">arrayBufferProperty</span>,</li><li>  <span class="hljs-variable">descriptors</span>:<span class="hljs-title class_">descriptorsArray</span>,</li><li>  <span class="hljs-variable">operation</span>:<span class="hljs-number">3</span> <span class="hljs-comment">// 属性可读且可写</span></li><li>};</li><li><span class="hljs-variable">propertiesArray</span>[<span class="hljs-number">0</span>] = <span class="hljs-variable">property1</span>;</li><li><span class="hljs-variable">propertiesArray</span>[<span class="hljs-number">1</span>] = <span class="hljs-variable">property2</span>;</li><li><span class="hljs-comment">// 构造服务</span></li><li><span class="hljs-keyword">let</span> <span class="hljs-variable">Service</span>: <span class="hljs-title class_">ssap</span>.<span class="hljs-title class_">Service</span> = {</li><li>  <span class="hljs-variable">serviceUuid</span>:<span class="hljs-string">'37bea880-fc70-11ea-b720-000000004386'</span>,</li><li>  <span class="hljs-variable">properties</span>:<span class="hljs-title class_">propertiesArray</span></li><li>};</li><li><span class="hljs-keyword">try</span> {</li><li>  <span class="hljs-variable">server</span>.<span class="hljs-title function_">addService</span>(<span class="hljs-variable">Service</span>);</li><li>} <span class="hljs-keyword">catch</span> (<span class="hljs-variable">err</span>) {</li><li>  <span class="hljs-variable">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (<span class="hljs-variable">err</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">BusinessError</span>).<span class="hljs-variable">code</span> + <span class="hljs-string">', errMessage: '</span> + (<span class="hljs-variable">err</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">BusinessError</span>).<span class="hljs-variable">message</span>);</li><li>}</li></ol></pre></div></div>       <p></p></li>      <li id="li629472212549"><span>订阅连接状态变化事件。</span>       <p></p>       <div _ngcontent-yox-c106="" class="highlight-div"><div _ngcontent-yox-c106="" class="highlight-div-header"><div _ngcontent-yox-c106="" class="highlight-div-header-left"><div _ngcontent-yox-c106="" class="handle-button expand-button"><div _ngcontent-yox-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-yox-c106="" class="highlight-div-header-right"><div _ngcontent-yox-c106="" class="handle-button ai-button"></div><div _ngcontent-yox-c106="" class="handle-button line-button"><div _ngcontent-yox-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-yox-c106="" class="handle-button theme-button"><div _ngcontent-yox-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-yox-c106="" class="handle-button copy-button"><div _ngcontent-yox-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-yox-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">let</span> <span class="hljs-attr">onReceiveConnectionChangeEvent</span>:<span class="hljs-function">(<span class="hljs-params">data: ssap.ConnectionChangeState</span>) =&gt;</span> <span class="hljs-keyword">void</span> = <span class="hljs-function">(<span class="hljs-params">data: ssap.ConnectionChangeState</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'data:'</span>+ <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data));</li><li>}</li><li><span class="hljs-keyword">try</span> {</li><li>  server.<span class="hljs-title function_">on</span>(<span class="hljs-string">'connectionStateChange'</span>, onReceiveConnectionChangeEvent);</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>       <p></p></li>      <li id="li1776019142546"><span>订阅客户端读请求事件。</span>       <p></p>       <div _ngcontent-yox-c106="" class="highlight-div"><div _ngcontent-yox-c106="" class="highlight-div-header"><div _ngcontent-yox-c106="" class="highlight-div-header-left"><div _ngcontent-yox-c106="" class="handle-button expand-button"><div _ngcontent-yox-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-yox-c106="" class="highlight-div-header-right"><div _ngcontent-yox-c106="" class="handle-button ai-button"></div><div _ngcontent-yox-c106="" class="handle-button line-button"><div _ngcontent-yox-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-yox-c106="" class="handle-button theme-button"><div _ngcontent-yox-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-yox-c106="" class="handle-button copy-button"><div _ngcontent-yox-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-yox-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">let</span> <span class="hljs-attr">onReceivePropertyReadEvent</span>:<span class="hljs-function">(<span class="hljs-params">data: ssap.PropertyReadRequest</span>) =&gt;</span> <span class="hljs-keyword">void</span> = <span class="hljs-function">(<span class="hljs-params">data: ssap.PropertyReadRequest</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'data:'</span>+ <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data));</li><li>}</li><li><span class="hljs-keyword">try</span> {</li><li>  server.<span class="hljs-title function_">on</span>(<span class="hljs-string">'propertyRead'</span>, onReceivePropertyReadEvent);</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>       <p></p></li>      <li><span>收到客户端读请求事件后，回复响应。读请求通过<a href="/consumer/cn/doc/harmonyos-guides/nearlink-ssap-server-connect#li1776019142546">步骤5</a>订阅。</span>       <p></p>       <div _ngcontent-yox-c106="" class="highlight-div"><div _ngcontent-yox-c106="" class="highlight-div-header"><div _ngcontent-yox-c106="" class="highlight-div-header-left"><div _ngcontent-yox-c106="" class="handle-button expand-button"><div _ngcontent-yox-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-yox-c106="" class="highlight-div-header-right"><div _ngcontent-yox-c106="" class="handle-button ai-button"></div><div _ngcontent-yox-c106="" class="handle-button line-button"><div _ngcontent-yox-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-yox-c106="" class="handle-button theme-button"><div _ngcontent-yox-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-yox-c106="" class="handle-button copy-button"><div _ngcontent-yox-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-yox-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 订阅客户端的读写请求，收到请求后通过该接口回复</span></li><li><span class="hljs-keyword">let</span> arrayBuffer = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayBuffer</span>(<span class="hljs-number">2</span>);</li><li><span class="hljs-keyword">let</span> descValue = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(arrayBuffer);</li><li>descValue[<span class="hljs-number">0</span>] = <span class="hljs-number">11</span>;</li><li>descValue[<span class="hljs-number">1</span>] = <span class="hljs-number">22</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">resp</span>: ssap.<span class="hljs-property">ServerResponse</span> = {</li><li>  <span class="hljs-attr">address</span>: <span class="hljs-string">'00:11:22:33:AA:FF'</span>, <span class="hljs-comment">// 请求方的客户端地址</span></li><li>  <span class="hljs-attr">requestId</span>: <span class="hljs-number">1</span>, <span class="hljs-comment">// 请求方传入</span></li><li>  <span class="hljs-attr">value</span>: arrayBuffer <span class="hljs-comment">// 回复的数据</span></li><li>};</li><li><span class="hljs-keyword">try</span> {</li><li>  <span class="hljs-comment">// 地址是服务端缓存的已连接的客户端设备</span></li><li>  server.<span class="hljs-title function_">sendResponse</span>(resp);</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>       <p></p></li>      <li><span>通知客户端property值更新。其中参数address是<a href="/consumer/cn/doc/harmonyos-guides/nearlink-ssap-server-connect#li629472212549">步骤4</a>中获取的已连接客户端设备地址。</span>       <p></p>       <div _ngcontent-yox-c106="" class="highlight-div"><div _ngcontent-yox-c106="" class="highlight-div-header"><div _ngcontent-yox-c106="" class="highlight-div-header-left"><div _ngcontent-yox-c106="" class="handle-button expand-button"><div _ngcontent-yox-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-yox-c106="" class="highlight-div-header-right"><div _ngcontent-yox-c106="" class="handle-button ai-button"></div><div _ngcontent-yox-c106="" class="handle-button line-button"><div _ngcontent-yox-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-yox-c106="" class="handle-button theme-button"><div _ngcontent-yox-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-yox-c106="" class="handle-button copy-button"><div _ngcontent-yox-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-yox-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 构造properties</span></li><li><span class="hljs-keyword">let</span> arrayBufferProperty = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayBuffer</span>(<span class="hljs-number">8</span>);</li><li><span class="hljs-keyword">let</span> properValue = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(arrayBufferProperty);</li><li>properValue[<span class="hljs-number">0</span>] = <span class="hljs-number">123</span>; <span class="hljs-comment">// 本次更新后的值</span></li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">property</span>: ssap.<span class="hljs-property">Property</span> = {</li><li>  <span class="hljs-attr">serviceUuid</span>:<span class="hljs-string">'37bea880-fc70-11ea-b720-000000004386'</span>,</li><li>  <span class="hljs-attr">propertyUuid</span>: <span class="hljs-string">'37bea880-fc70-11ea-b720-000000001234'</span>,</li><li>  <span class="hljs-attr">value</span>: arrayBufferProperty,</li><li>};</li><li><span class="hljs-keyword">try</span> {</li><li>  <span class="hljs-keyword">let</span> address = <span class="hljs-string">'00:11:22:33:AA:FF'</span>; <span class="hljs-comment">// 已连接的设备地址</span></li><li>  server.<span class="hljs-title function_">notifyPropertyChanged</span>(address, property).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'notifyPropertyChanged success'</span>);</li><li>  }).<span class="hljs-property">catch</span> (<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + err.<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + err.<span class="hljs-property">message</span>);</li><li>  });</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'errCode: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span> + <span class="hljs-string">', errMessage: '</span> + (err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>       <p></p></li>     </ol>    </div>    <div class="tiledSection">     <h2 id="section8672185218498">示例代码<i class="anchor-icon anchor-icon-link" anchorid="section8672185218498" tips="复制节点链接"></i></h2>          <p>SSAP服务端功能可参考<a href="https://gitcode.com/harmonyos_samples/nearlink-kit_-sample-code" target="_blank">星闪示例代码</a>，entry/src/main/ets/pages/SsapServerPage.ets中的实现方法。</p>    </div>   </div>   <div></div></div>