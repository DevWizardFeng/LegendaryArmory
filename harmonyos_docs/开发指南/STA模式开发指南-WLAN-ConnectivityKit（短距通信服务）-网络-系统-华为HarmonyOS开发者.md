<h1 _ngcontent-daw-c119="" class="doc-title ng-star-inserted" title="STA模式开发指南"> STA模式开发指南 </h1>

<div _ngcontent-daw-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <div class="tiledSection">     <h2 id="简介">简介<i class="anchor-icon anchor-icon-link" anchorid="简介" tips="复制节点链接"></i></h2>          <p>Wi-Fi STA模式（Station Mode，站点模式）是无线设备作为客户端接入无线局域网（WLAN）的工作模式。在该模式下，设备（如手机、电脑、平板等）通过连接到接入点（AP，Access Point）或无线路由器，实现对网络的访问。</p>    </div>    <div class="tiledSection">     <h2 id="场景介绍">场景介绍<i class="anchor-icon anchor-icon-link" anchorid="场景介绍" tips="复制节点链接"></i></h2>          <ul>      <li><a href="/consumer/cn/doc/harmonyos-guides/sta-development-guide#判断wi-fi状态">判断Wi-Fi状态</a></li>      <li><a href="/consumer/cn/doc/harmonyos-guides/sta-development-guide#建立wi-fi连接">建立Wi-Fi连接</a></li>     </ul>    </div>    <div class="tiledSection">     <h2 id="接口说明">接口说明<i class="anchor-icon anchor-icon-link" anchorid="接口说明" tips="复制节点链接"></i></h2>          <p>完整的JS API说明以及示例代码请参考：<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-wifimanager" target="_blank">STA接口</a>。</p>     <p>接口具体说明如下表所示。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.3.4.1.3.1.1" valign="top" width="50%">接口名</th>         <th align="left" class="cellrowborder" id="mcps1.3.3.4.1.3.1.2" valign="top" width="50%">功能描述</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="50%">isWifiActive()</td>         <td class="cellrowborder" valign="top" width="50%">查询WLAN开关是否已使能。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">addCandidateConfig()</td>         <td class="cellrowborder" valign="top" width="50%">添加候选网络配置，使用前先使能WLAN。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">connectToCandidateConfig()</td>         <td class="cellrowborder" valign="top" width="50%">应用使用该接口连接到自己添加的候选网络。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">isConnected()</td>         <td class="cellrowborder" valign="top" width="50%">查询WLAN是否已连接。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">removeCandidateConfig()</td>         <td class="cellrowborder" valign="top" width="50%">移除候选网络配置。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">getCandidateConfigs()</td>         <td class="cellrowborder" valign="top" width="50%">获取候选网络配置。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">on(type: 'wifiStateChange')</td>         <td class="cellrowborder" valign="top" width="50%">注册WLAN状态改变事件。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">off(type: 'wifiStateChange')</td>         <td class="cellrowborder" valign="top" width="50%">取消注册WLAN状态改变事件。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">on(type: 'wifiConnectionChange')</td>         <td class="cellrowborder" valign="top" width="50%">注册WLAN连接状态改变事件。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">off(type: 'wifiConnectionChange')</td>         <td class="cellrowborder" valign="top" width="50%">取消注册WLAN连接状态改变事件。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="主要场景开发步骤">主要场景开发步骤<i class="anchor-icon anchor-icon-link" anchorid="主要场景开发步骤" tips="复制节点链接"></i></h2>         </div>    <div class="tiledSection">     <h3 id="判断wi-fi状态" class="firsth2">判断Wi-Fi状态<i class="anchor-icon anchor-icon-link" anchorid="判断wi-fi状态" tips="复制节点链接"></i></h3>          <ol>      <li>导入需要的Wi-Fi模块。</li>      <li>需要SystemCapability.Communication.WiFi.STA系统能力。</li>      <li>需要申请权限ohos.permission.GET_WIFI_INFO。</li>      <li>开启设备Wi-Fi。</li>      <li>示例代码：</li>     </ol>     <div _ngcontent-daw-c106="" class="highlight-div"><div _ngcontent-daw-c106="" class="highlight-div-header"><div _ngcontent-daw-c106="" class="highlight-div-header-left"><div _ngcontent-daw-c106="" class="handle-button expand-button"><div _ngcontent-daw-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-daw-c106="" class="highlight-div-header-right"><div _ngcontent-daw-c106="" class="handle-button ai-button"></div><div _ngcontent-daw-c106="" class="handle-button line-button"><div _ngcontent-daw-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-daw-c106="" class="handle-button theme-button"><div _ngcontent-daw-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-daw-c106="" class="handle-button copy-button"><div _ngcontent-daw-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-daw-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { wifiManager } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ConnectivityKit'</span>;</li><li>
</li><li><span class="hljs-keyword">try</span> {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-title function_">recvPowerNotifyFunc</span> = (<span class="hljs-params">result: <span class="hljs-built_in">number</span></span>) =&gt; {</li><li>    <span class="hljs-keyword">let</span> wifiState = <span class="hljs-string">""</span>;</li><li>    <span class="hljs-keyword">switch</span> (result) {</li><li>      <span class="hljs-keyword">case</span> <span class="hljs-number">0</span>:</li><li>        wifiState += <span class="hljs-string">'DISABLING'</span>;</li><li>        <span class="hljs-keyword">break</span>;</li><li>      <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:</li><li>        wifiState += <span class="hljs-string">'DISABLED'</span>;</li><li>        <span class="hljs-keyword">break</span>;</li><li>      <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:</li><li>        wifiState += <span class="hljs-string">'ENABLING'</span>;</li><li>        <span class="hljs-keyword">break</span>;</li><li>      <span class="hljs-keyword">case</span> <span class="hljs-number">3</span>:</li><li>        wifiState += <span class="hljs-string">'ENABLED'</span>;</li><li>        <span class="hljs-keyword">break</span>;</li><li>      <span class="hljs-attr">default</span>:</li><li>        wifiState += <span class="hljs-string">'UNKNOWN STATUS'</span>;</li><li>        <span class="hljs-keyword">break</span>;</li><li>    }</li><li>  }</li><li>  <span class="hljs-comment">// 监听Wi-Fi当前状态</span></li><li>  wifiManager.<span class="hljs-title function_">on</span>(<span class="hljs-string">"wifiStateChange"</span>, recvPowerNotifyFunc);</li><li>  <span class="hljs-comment">// 判断Wi-Fi是否打开</span></li><li>  <span class="hljs-keyword">let</span> isWifiActive = wifiManager.<span class="hljs-title function_">isWifiActive</span>();</li><li>  <span class="hljs-keyword">if</span> (!isWifiActive) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"Wi-Fi not enabled"</span>); <span class="hljs-comment">// 请先手动打开Wi-Fi</span></li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>
</li><li>  wifiManager.<span class="hljs-title function_">off</span>(<span class="hljs-string">"wifiStateChange"</span>, recvPowerNotifyFunc);</li><li>} <span class="hljs-keyword">catch</span> (error) {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`WiFi state monitor failed. <span class="hljs-subst">${error.message}</span>`</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="建立wi-fi连接">建立Wi-Fi连接<i class="anchor-icon anchor-icon-link" anchorid="建立wi-fi连接" tips="复制节点链接"></i></h3>          <ol>      <li>       <p>导入需要的Wi-Fi模块。</p></li>      <li>       <p>开启设备的Wi-Fi。</p></li>      <li>       <p>需要SystemCapability.Communication.WiFi.STA系统能力。</p></li>      <li>       <p>需要申请权限ohos.permission.GET_WIFI_INFO，ohos.permission.SET_WIFI_INFO。</p></li>      <li>       <p>示例代码：</p>       <div _ngcontent-daw-c106="" class="highlight-div"><div _ngcontent-daw-c106="" class="highlight-div-header"><div _ngcontent-daw-c106="" class="highlight-div-header-left"><div _ngcontent-daw-c106="" class="handle-button expand-button"><div _ngcontent-daw-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-daw-c106="" class="highlight-div-header-right"><div _ngcontent-daw-c106="" class="handle-button ai-button"></div><div _ngcontent-daw-c106="" class="handle-button line-button"><div _ngcontent-daw-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-daw-c106="" class="handle-button theme-button"><div _ngcontent-daw-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-daw-c106="" class="handle-button copy-button"><div _ngcontent-daw-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-daw-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { wifiManager } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ConnectivityKit'</span>;</li><li>
</li><li><span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-title function_">recvWifiConnectionChangeFunc</span> = (<span class="hljs-params">result:<span class="hljs-built_in">number</span></span>) =&gt; {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"Receive wifi connection change event: "</span> + result);</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">config</span>:wifiManager.<span class="hljs-property">WifiDeviceConfig</span> = {</li><li>    ssid : <span class="hljs-string">"****"</span>,</li><li>    bssid : <span class="hljs-string">"****"</span>,</li><li>    preSharedKey : <span class="hljs-string">"****"</span>,</li><li>    securityType : <span class="hljs-number">0</span></li><li>    }</li><li>
</li><li>    <span class="hljs-comment">// 更新当前Wi-Fi连接状态</span></li><li>  wifiManager.<span class="hljs-title function_">on</span>(<span class="hljs-string">"wifiConnectionChange"</span>, recvWifiConnectionChangeFunc);</li><li>    <span class="hljs-comment">// 添加候选网络配置</span></li><li>    wifiManager.<span class="hljs-title function_">addCandidateConfig</span>(config).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">result</span> =&gt;</span> {</li><li>    <span class="hljs-comment">// 连接指定网络</span></li><li>    wifiManager.<span class="hljs-title function_">connectToCandidateConfig</span>(result);</li><li>  });</li><li>
</li><li>  <span class="hljs-keyword">if</span> (!wifiManager.<span class="hljs-title function_">isConnected</span>()) {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"Wi-Fi not connected"</span>);</li><li>  }</li><li>   <span class="hljs-comment">// 获取连接信息</span></li><li>  wifiManager.<span class="hljs-title function_">getLinkedInfo</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">data</span> =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"get Wi-Fi linked info: "</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data));</li><li>  })</li><li>  <span class="hljs-comment">// 查询信号强度</span></li><li>  <span class="hljs-keyword">let</span> rssi = -<span class="hljs-number">88</span>;</li><li>  <span class="hljs-keyword">let</span> band = <span class="hljs-number">1</span>;</li><li>  <span class="hljs-keyword">let</span> level = wifiManager.<span class="hljs-title function_">getSignalLevel</span>(rssi,band);</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"level:"</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(level));</li><li>
</li><li>  <span class="hljs-comment">// 取消注册，停止更新当前Wi-Fi连接状态</span></li><li>  wifiManager.<span class="hljs-title function_">off</span>(<span class="hljs-string">"wifiConnectionChange"</span>, recvWifiConnectionChangeFunc);</li><li>} <span class="hljs-keyword">catch</span> (error) {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`WiFi Connection failed. <span class="hljs-subst">${error.message}</span>`</span>);</li><li>}</li></ol></pre></div></div></li>      <li>       <p>Wi-Fi连接状态值，详情请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-wifimanager#connstate9" target="_blank">ConnState</a>。</p></li>      <li>       <p>错误码详情请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-wifi" target="_blank">WIFI错误码</a>。</p></li>     </ol>    </div>   </div>   <div></div></div>