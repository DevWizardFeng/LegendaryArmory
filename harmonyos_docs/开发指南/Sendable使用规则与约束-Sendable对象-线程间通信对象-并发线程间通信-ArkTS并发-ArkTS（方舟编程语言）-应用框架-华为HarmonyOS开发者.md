<h1 _ngcontent-kok-c119="" class="doc-title ng-star-inserted" title="Sendable使用规则与约束"> Sendable使用规则与约束 </h1>

<div _ngcontent-kok-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <div class="tiledSection">     <h2 id="继承规则">继承规则<i class="anchor-icon anchor-icon-link" anchorid="继承规则" tips="复制节点链接"></i></h2>         </div>    <div class="tiledSection">     <h3 id="sendable类必须继承自sendable类" class="firsth2">Sendable类必须继承自Sendable类<i class="anchor-icon anchor-icon-link" anchorid="sendable类必须继承自sendable类" tips="复制节点链接"></i></h3>          <p>Sendable对象的布局和原型链不可变，而非Sendable对象可以通过特殊方式修改布局。因此，不允许互相继承。这里的类不包含变量，Sendable类不能继承自变量。</p>     <p><strong>正例：</strong></p>     <div _ngcontent-kok-c106="" class="highlight-div"><div _ngcontent-kok-c106="" class="highlight-div-header"><div _ngcontent-kok-c106="" class="highlight-div-header-left"><div _ngcontent-kok-c106="" class="handle-button expand-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kok-c106="" class="highlight-div-header-right"><div _ngcontent-kok-c106="" class="handle-button ai-button"></div><div _ngcontent-kok-c106="" class="handle-button line-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kok-c106="" class="handle-button theme-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kok-c106="" class="handle-button copy-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kok-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@Sendable</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span> {</li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) {</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-meta">@Sendable</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">B</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">A</span> {</li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">super</span>()</li><li>  }</li><li>}</li></ol></pre></div></div>     <p><strong>反例：</strong></p>     <div _ngcontent-kok-c106="" class="highlight-div"><div _ngcontent-kok-c106="" class="highlight-div-header"><div _ngcontent-kok-c106="" class="highlight-div-header-left"><div _ngcontent-kok-c106="" class="handle-button expand-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kok-c106="" class="highlight-div-header-right"><div _ngcontent-kok-c106="" class="handle-button ai-button"></div><div _ngcontent-kok-c106="" class="handle-button line-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kok-c106="" class="handle-button theme-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kok-c106="" class="handle-button copy-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kok-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span> {</li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) {</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-meta">@Sendable</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">B</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">A</span> { <span class="hljs-comment">// A不是sendable class，B不能继承它，编译报错</span></li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">super</span>()</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="非sendable类必须继承自非sendable类">非Sendable类必须继承自非Sendable类<i class="anchor-icon anchor-icon-link" anchorid="非sendable类必须继承自非sendable类" tips="复制节点链接"></i></h3>          <p>Sendable对象的布局和原型链不可变，而非Sendable对象可以通过特殊方式修改布局，因此不允许互相继承。</p>     <p><strong>正例：</strong></p>     <div _ngcontent-kok-c106="" class="highlight-div"><div _ngcontent-kok-c106="" class="highlight-div-header"><div _ngcontent-kok-c106="" class="highlight-div-header-left"><div _ngcontent-kok-c106="" class="handle-button expand-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kok-c106="" class="highlight-div-header-right"><div _ngcontent-kok-c106="" class="handle-button ai-button"></div><div _ngcontent-kok-c106="" class="handle-button line-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kok-c106="" class="handle-button theme-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kok-c106="" class="handle-button copy-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kok-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span> {</li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) {</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">B</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">A</span> {</li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">super</span>()</li><li>  }</li><li>}</li></ol></pre></div></div>     <p><strong>反例：</strong></p>     <div _ngcontent-kok-c106="" class="highlight-div"><div _ngcontent-kok-c106="" class="highlight-div-header"><div _ngcontent-kok-c106="" class="highlight-div-header-left"><div _ngcontent-kok-c106="" class="handle-button expand-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kok-c106="" class="highlight-div-header-right"><div _ngcontent-kok-c106="" class="handle-button ai-button"></div><div _ngcontent-kok-c106="" class="handle-button line-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kok-c106="" class="handle-button theme-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kok-c106="" class="handle-button copy-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kok-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@Sendable</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span> {</li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) {</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">B</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">A</span> { <span class="hljs-comment">// A是sendable class，B不能继承它，编译报错</span></li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">super</span>()</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="接口实现规则">接口实现规则<i class="anchor-icon anchor-icon-link" anchorid="接口实现规则" tips="复制节点链接"></i></h2>         </div>    <div class="tiledSection">     <h3 id="非sendable类禁止实现sendable接口" class="firsth2">非Sendable类禁止实现Sendable接口<i class="anchor-icon anchor-icon-link" anchorid="非sendable类禁止实现sendable接口" tips="复制节点链接"></i></h3>          <p>非Sendable类实现Sendable接口时，可能被误认为是Sendable类，导致错误使用。</p>     <p><strong>正例：</strong></p>     <div _ngcontent-kok-c106="" class="highlight-div"><div _ngcontent-kok-c106="" class="highlight-div-header"><div _ngcontent-kok-c106="" class="highlight-div-header-left"><div _ngcontent-kok-c106="" class="handle-button expand-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kok-c106="" class="highlight-div-header-right"><div _ngcontent-kok-c106="" class="handle-button ai-button"></div><div _ngcontent-kok-c106="" class="handle-button line-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kok-c106="" class="handle-button theme-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kok-c106="" class="handle-button copy-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kok-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">interface</span> I {};</li><li>
</li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">B</span> <span class="hljs-keyword">implements</span> I {};</li></ol></pre></div></div>     <p><strong>反例：</strong></p>     <div _ngcontent-kok-c106="" class="highlight-div"><div _ngcontent-kok-c106="" class="highlight-div-header"><div _ngcontent-kok-c106="" class="highlight-div-header-left"><div _ngcontent-kok-c106="" class="handle-button expand-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kok-c106="" class="highlight-div-header-right"><div _ngcontent-kok-c106="" class="handle-button ai-button"></div><div _ngcontent-kok-c106="" class="handle-button line-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kok-c106="" class="handle-button theme-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kok-c106="" class="handle-button copy-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kok-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { lang } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkTS'</span>;</li><li>
</li><li><span class="hljs-keyword">type</span> <span class="hljs-title class_">ISendable</span> = lang.<span class="hljs-property">ISendable</span>;</li><li>
</li><li><span class="hljs-keyword">interface</span> I <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ISendable</span> {};</li><li>
</li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">B</span> <span class="hljs-keyword">implements</span> I {};  <span class="hljs-comment">// I是sendable interface，B不能实现，编译报错</span></li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="sendable类接口成员变量规则">Sendable类/接口成员变量规则<i class="anchor-icon anchor-icon-link" anchorid="sendable类接口成员变量规则" tips="复制节点链接"></i></h2>         </div>    <div class="tiledSection">     <h3 id="必须是sendable支持的数据类型" class="firsth2">必须是Sendable支持的数据类型<i class="anchor-icon anchor-icon-link" anchorid="必须是sendable支持的数据类型" tips="复制节点链接"></i></h3>          <p>Sendable数据不得持有非Sendable数据，因此Sendable类或接口的成员变量必须是<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-sendable#sendable支持的数据类型">Sendable支持的数据类型</a>。</p>     <p><strong>正例：</strong></p>     <div _ngcontent-kok-c106="" class="highlight-div"><div _ngcontent-kok-c106="" class="highlight-div-header"><div _ngcontent-kok-c106="" class="highlight-div-header-left"><div _ngcontent-kok-c106="" class="handle-button expand-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kok-c106="" class="highlight-div-header-right"><div _ngcontent-kok-c106="" class="handle-button ai-button"></div><div _ngcontent-kok-c106="" class="handle-button line-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kok-c106="" class="handle-button theme-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kok-c106="" class="handle-button copy-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kok-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@Sendable</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span> {</li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) {</li><li>  }</li><li>  <span class="hljs-attr">a</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;</li><li>}</li></ol></pre></div></div>     <p><strong>反例：</strong></p>     <div _ngcontent-kok-c106="" class="highlight-div"><div _ngcontent-kok-c106="" class="highlight-div-header"><div _ngcontent-kok-c106="" class="highlight-div-header-left"><div _ngcontent-kok-c106="" class="handle-button expand-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kok-c106="" class="highlight-div-header-right"><div _ngcontent-kok-c106="" class="handle-button ai-button"></div><div _ngcontent-kok-c106="" class="handle-button line-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kok-c106="" class="handle-button theme-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kok-c106="" class="handle-button copy-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kok-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@Sendable</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span> {</li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) {</li><li>  }</li><li>  <span class="hljs-attr">b</span>: <span class="hljs-title class_">Array</span>&lt;<span class="hljs-built_in">number</span>&gt; = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>] <span class="hljs-comment">// 编译报错，需使用collections.Array</span></li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="不支持使用断言">不支持使用!断言<i class="anchor-icon anchor-icon-link" anchorid="不支持使用断言" tips="复制节点链接"></i></h3>          <p>Sendable对象的成员属性必须赋初值，而“!”修饰的变量可以不赋初值，因此不支持使用“!”。</p>     <p><strong>正例：</strong></p>     <div _ngcontent-kok-c106="" class="highlight-div"><div _ngcontent-kok-c106="" class="highlight-div-header"><div _ngcontent-kok-c106="" class="highlight-div-header-left"><div _ngcontent-kok-c106="" class="handle-button expand-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kok-c106="" class="highlight-div-header-right"><div _ngcontent-kok-c106="" class="handle-button ai-button"></div><div _ngcontent-kok-c106="" class="handle-button line-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kok-c106="" class="handle-button theme-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kok-c106="" class="handle-button copy-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kok-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@Sendable</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span> {</li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) {</li><li>  }</li><li>  <span class="hljs-attr">a</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;</li><li>}</li></ol></pre></div></div>     <p><strong>反例：</strong></p>     <div _ngcontent-kok-c106="" class="highlight-div"><div _ngcontent-kok-c106="" class="highlight-div-header"><div _ngcontent-kok-c106="" class="highlight-div-header-left"><div _ngcontent-kok-c106="" class="handle-button expand-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kok-c106="" class="highlight-div-header-right"><div _ngcontent-kok-c106="" class="handle-button ai-button"></div><div _ngcontent-kok-c106="" class="handle-button line-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kok-c106="" class="handle-button theme-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kok-c106="" class="handle-button copy-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kok-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@Sendable</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span> {</li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) {</li><li>  }</li><li>  a!: <span class="hljs-built_in">number</span>; <span class="hljs-comment">// 编译报错，不支持使用“!”</span></li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="不支持使用计算属性名">不支持使用计算属性名<i class="anchor-icon anchor-icon-link" anchorid="不支持使用计算属性名" tips="复制节点链接"></i></h3>          <p>Sendable对象的布局不可更改，因为计算属性无法静态确定对象布局，所以不支持。</p>     <p><strong>正例：</strong></p>     <div _ngcontent-kok-c106="" class="highlight-div"><div _ngcontent-kok-c106="" class="highlight-div-header"><div _ngcontent-kok-c106="" class="highlight-div-header-left"><div _ngcontent-kok-c106="" class="handle-button expand-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kok-c106="" class="highlight-div-header-right"><div _ngcontent-kok-c106="" class="handle-button ai-button"></div><div _ngcontent-kok-c106="" class="handle-button line-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kok-c106="" class="handle-button theme-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kok-c106="" class="handle-button copy-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kok-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@Sendable</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span> {</li><li>    <span class="hljs-attr">num1</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">1</span>;</li><li>    <span class="hljs-attr">num2</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">2</span>;</li><li>    <span class="hljs-title function_">add</span>(): <span class="hljs-built_in">number</span> {</li><li>      <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">num1</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">num2</span>;</li><li>    }</li><li>}</li></ol></pre></div></div>     <p><strong>反例：</strong></p>     <div _ngcontent-kok-c106="" class="highlight-div"><div _ngcontent-kok-c106="" class="highlight-div-header"><div _ngcontent-kok-c106="" class="highlight-div-header-left"><div _ngcontent-kok-c106="" class="handle-button expand-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kok-c106="" class="highlight-div-header-right"><div _ngcontent-kok-c106="" class="handle-button ai-button"></div><div _ngcontent-kok-c106="" class="handle-button line-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kok-c106="" class="handle-button theme-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kok-c106="" class="handle-button copy-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kok-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">enum</span> B {</li><li>    b1 = <span class="hljs-string">"bbb"</span></li><li>}</li><li><span class="hljs-meta">@Sendable</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span> {</li><li>    [<span class="hljs-string">"aaa"</span>]: <span class="hljs-built_in">number</span> = <span class="hljs-number">1</span>; <span class="hljs-comment">// 编译报错，不支持["aaa"]</span></li><li>    [B.<span class="hljs-property">b1</span>]: <span class="hljs-built_in">number</span> = <span class="hljs-number">2</span>; <span class="hljs-comment">// 编译报错，不支持[B.b1]</span></li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="不支持使用类型别名">不支持使用类型别名<i class="anchor-icon anchor-icon-link" anchorid="不支持使用类型别名" tips="复制节点链接"></i></h3>          <p>Sendable类的成员变量不能使用类型别名（即使用type关键字定义的别名）。</p>     <p><strong>正例：</strong></p>     <div _ngcontent-kok-c106="" class="highlight-div"><div _ngcontent-kok-c106="" class="highlight-div-header"><div _ngcontent-kok-c106="" class="highlight-div-header-left"><div _ngcontent-kok-c106="" class="handle-button expand-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kok-c106="" class="highlight-div-header-right"><div _ngcontent-kok-c106="" class="handle-button ai-button"></div><div _ngcontent-kok-c106="" class="handle-button line-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kok-c106="" class="handle-button theme-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kok-c106="" class="handle-button copy-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kok-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@Sendable</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">B</span> {</li><li>  <span class="hljs-attr">num1</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">1</span>;</li><li>  <span class="hljs-attr">num2</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">2</span>;</li><li>  <span class="hljs-title function_">add</span>(): <span class="hljs-built_in">number</span> {</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">num1</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">num2</span>;</li><li>  }</li><li>}</li></ol></pre></div></div>     <p><strong>反例：</strong></p>     <div _ngcontent-kok-c106="" class="highlight-div"><div _ngcontent-kok-c106="" class="highlight-div-header"><div _ngcontent-kok-c106="" class="highlight-div-header-left"><div _ngcontent-kok-c106="" class="handle-button expand-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kok-c106="" class="highlight-div-header-right"><div _ngcontent-kok-c106="" class="handle-button ai-button"></div><div _ngcontent-kok-c106="" class="handle-button line-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kok-c106="" class="handle-button theme-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kok-c106="" class="handle-button copy-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kok-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">type</span> A = <span class="hljs-built_in">number</span>;</li><li>
</li><li><span class="hljs-meta">@Sendable</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">B</span> {</li><li>  <span class="hljs-attr">num1</span>: A = <span class="hljs-number">1</span>; <span class="hljs-comment">// 运行报错，不支持使用类型别名</span></li><li>  <span class="hljs-attr">num2</span>: A = <span class="hljs-number">2</span>; <span class="hljs-comment">// 运行报错，不支持使用类型别名</span></li><li>  <span class="hljs-title function_">add</span>(): <span class="hljs-built_in">number</span> {</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">num1</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">num2</span>;</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="泛型规则">泛型规则<i class="anchor-icon anchor-icon-link" anchorid="泛型规则" tips="复制节点链接"></i></h2>         </div>    <div class="tiledSection">     <h3 id="泛型类中的sendable类sendablelrucachecollectionsarraycollectionsmap和collectionsset的模板类型必须是sendable类型" class="firsth2">泛型类中的Sendable类、SendableLruCache、collections.Array、collections.Map和collections.Set的模板类型必须是Sendable类型<i class="anchor-icon anchor-icon-link" anchorid="泛型类中的sendable类sendablelrucachecollectionsarraycollectionsmap和collectionsset的模板类型必须是sendable类型" tips="复制节点链接"></i></h3>          <p>Sendable数据不能持有非Sendable数据，因此泛型类中的Sendable数据的模版类型必须是Sendable类型。</p>     <p><strong>正例：</strong></p>     <div _ngcontent-kok-c106="" class="highlight-div"><div _ngcontent-kok-c106="" class="highlight-div-header"><div _ngcontent-kok-c106="" class="highlight-div-header-left"><div _ngcontent-kok-c106="" class="handle-button expand-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kok-c106="" class="highlight-div-header-right"><div _ngcontent-kok-c106="" class="handle-button ai-button"></div><div _ngcontent-kok-c106="" class="handle-button line-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kok-c106="" class="handle-button theme-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kok-c106="" class="handle-button copy-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kok-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { collections } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkTS'</span>;</li><li>
</li><li><span class="hljs-keyword">try</span> {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">arr1</span>: collections.<span class="hljs-property">Array</span>&lt;<span class="hljs-built_in">number</span>&gt; = <span class="hljs-keyword">new</span> collections.<span class="hljs-property">Array</span>&lt;<span class="hljs-built_in">number</span>&gt;();</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">num</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">1</span>;</li><li>  arr1.<span class="hljs-title function_">push</span>(num);</li><li>} <span class="hljs-keyword">catch</span> (e) {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`taskpool execute: Code: <span class="hljs-subst">${e.code}</span>, message: <span class="hljs-subst">${e.message}</span>`</span>);</li><li>}</li></ol></pre></div></div>     <p><strong>反例：</strong></p>     <div _ngcontent-kok-c106="" class="highlight-div"><div _ngcontent-kok-c106="" class="highlight-div-header"><div _ngcontent-kok-c106="" class="highlight-div-header-left"><div _ngcontent-kok-c106="" class="handle-button expand-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kok-c106="" class="highlight-div-header-right"><div _ngcontent-kok-c106="" class="handle-button ai-button"></div><div _ngcontent-kok-c106="" class="handle-button line-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kok-c106="" class="handle-button theme-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kok-c106="" class="handle-button copy-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kok-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { collections } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkTS'</span>;</li><li>
</li><li><span class="hljs-keyword">try</span> {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">arr1</span>: collections.<span class="hljs-property">Array</span>&lt;<span class="hljs-title class_">Array</span>&lt;<span class="hljs-built_in">number</span>&gt;&gt; = <span class="hljs-keyword">new</span> collections.<span class="hljs-property">Array</span>&lt;<span class="hljs-title class_">Array</span>&lt;<span class="hljs-built_in">number</span>&gt;&gt;(); <span class="hljs-comment">// 编译报错，模板类型必须是Sendable类型</span></li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">arr2</span>: <span class="hljs-title class_">Array</span>&lt;<span class="hljs-built_in">number</span>&gt; = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>&lt;<span class="hljs-built_in">number</span>&gt;();</li><li>  arr2.<span class="hljs-title function_">push</span>(<span class="hljs-number">1</span>);</li><li>  arr1.<span class="hljs-title function_">push</span>(arr2);</li><li>} <span class="hljs-keyword">catch</span> (e) {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`taskpool execute: Code: <span class="hljs-subst">${e.code}</span>, message: <span class="hljs-subst">${e.message}</span>`</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="上下文访问规则">上下文访问规则<i class="anchor-icon anchor-icon-link" anchorid="上下文访问规则" tips="复制节点链接"></i></h2>         </div>    <div class="tiledSection">     <h3 id="sendable类的内部不允许使用当前模块内上下文环境中定义的变量" class="firsth2">Sendable类的内部不允许使用当前模块内上下文环境中定义的变量<i class="anchor-icon anchor-icon-link" anchorid="sendable类的内部不允许使用当前模块内上下文环境中定义的变量" tips="复制节点链接"></i></h3>          <p>由于Sendable对象在不同并发实例间的上下文环境不同，属于单个虚拟机实例，如果直接访问会有非预期行为。不支持Sendable对象使用当前模块内上下文环境中定义的变量，违反此规则会在编译阶段报错。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>从API version 12开始，Sendable class的内部支持使用top level的Sendable class对象。</p>      </div></div></div>     <p><strong>正例：</strong></p>     <div _ngcontent-kok-c106="" class="highlight-div"><div _ngcontent-kok-c106="" class="highlight-div-header"><div _ngcontent-kok-c106="" class="highlight-div-header-left"><div _ngcontent-kok-c106="" class="handle-button expand-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kok-c106="" class="highlight-div-header-right"><div _ngcontent-kok-c106="" class="handle-button ai-button"></div><div _ngcontent-kok-c106="" class="handle-button line-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kok-c106="" class="handle-button theme-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kok-c106="" class="handle-button copy-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kok-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { lang } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkTS'</span>;</li><li>
</li><li><span class="hljs-keyword">type</span> <span class="hljs-title class_">ISendable</span> = lang.<span class="hljs-property">ISendable</span>;</li><li>
</li><li><span class="hljs-keyword">interface</span> I <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ISendable</span> {}</li><li>
</li><li><span class="hljs-meta">@Sendable</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">B</span> <span class="hljs-keyword">implements</span> I {</li><li>  <span class="hljs-keyword">static</span> <span class="hljs-attr">o</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">1</span>;</li><li>  <span class="hljs-keyword">static</span> <span class="hljs-title function_">bar</span>(): B {</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title function_">B</span>();</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-meta">@Sendable</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">C</span> {</li><li>  <span class="hljs-attr">v</span>: I = <span class="hljs-keyword">new</span> <span class="hljs-title function_">B</span>();</li><li>  <span class="hljs-attr">u</span>: <span class="hljs-built_in">number</span> = B.<span class="hljs-property">o</span>;</li><li>
</li><li>  <span class="hljs-title function_">foo</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">return</span> B.<span class="hljs-title function_">bar</span>();</li><li>  }</li><li>}</li></ol></pre></div></div>     <p><strong>反例：</strong></p>     <div _ngcontent-kok-c106="" class="highlight-div"><div _ngcontent-kok-c106="" class="highlight-div-header"><div _ngcontent-kok-c106="" class="highlight-div-header-left"><div _ngcontent-kok-c106="" class="handle-button expand-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kok-c106="" class="highlight-div-header-right"><div _ngcontent-kok-c106="" class="handle-button ai-button"></div><div _ngcontent-kok-c106="" class="handle-button line-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kok-c106="" class="handle-button theme-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kok-c106="" class="handle-button copy-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kok-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { lang } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkTS'</span>;</li><li>
</li><li><span class="hljs-keyword">type</span> <span class="hljs-title class_">ISendable</span> = lang.<span class="hljs-property">ISendable</span>;</li><li>
</li><li><span class="hljs-keyword">interface</span> I <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ISendable</span> {}</li><li>
</li><li><span class="hljs-meta">@Sendable</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">B</span> <span class="hljs-keyword">implements</span> I {}</li><li>
</li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">bar</span>(<span class="hljs-params"></span>): B {</li><li>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title function_">B</span>();</li><li>}</li><li>
</li><li><span class="hljs-keyword">let</span> b = <span class="hljs-keyword">new</span> <span class="hljs-title function_">B</span>();</li><li>
</li><li>{</li><li>  <span class="hljs-meta">@Sendable</span></li><li>  <span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span> <span class="hljs-keyword">implements</span> I {}</li><li>
</li><li>  <span class="hljs-meta">@Sendable</span></li><li>  <span class="hljs-keyword">class</span> <span class="hljs-title class_">C</span> {</li><li>    <span class="hljs-attr">u</span>: I = <span class="hljs-title function_">bar</span>(); <span class="hljs-comment">// bar不是sendable class对象，编译报错</span></li><li>    <span class="hljs-attr">v</span>: I = <span class="hljs-keyword">new</span> <span class="hljs-title function_">A</span>(); <span class="hljs-comment">// A不是定义在top level中，编译报错</span></li><li>
</li><li>    <span class="hljs-title function_">foo</span>(<span class="hljs-params"></span>) {</li><li>      <span class="hljs-keyword">return</span> b; <span class="hljs-comment">// b不是sendable class对象，而是sendable class的实例，编译报错</span></li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="sendable装饰器使用规则">@Sendable装饰器使用规则<i class="anchor-icon anchor-icon-link" anchorid="sendable装饰器使用规则" tips="复制节点链接"></i></h2>         </div>    <div class="tiledSection">     <h3 id="sendable装饰器仅支持修饰类和函数" class="firsth2">@Sendable装饰器仅支持修饰类和函数<i class="anchor-icon anchor-icon-link" anchorid="sendable装饰器仅支持修饰类和函数" tips="复制节点链接"></i></h3>          <p>当前仅支持修饰类和函数。</p>     <p><strong>正例：</strong></p>     <div _ngcontent-kok-c106="" class="highlight-div"><div _ngcontent-kok-c106="" class="highlight-div-header"><div _ngcontent-kok-c106="" class="highlight-div-header-left"><div _ngcontent-kok-c106="" class="handle-button expand-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kok-c106="" class="highlight-div-header-right"><div _ngcontent-kok-c106="" class="handle-button ai-button"></div><div _ngcontent-kok-c106="" class="handle-button line-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kok-c106="" class="handle-button theme-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kok-c106="" class="handle-button copy-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kok-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@Sendable</span></li><li><span class="hljs-keyword">type</span> <span class="hljs-title class_">SendableFuncType</span> = <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">void</span>;</li><li>
</li><li><span class="hljs-meta">@Sendable</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">C</span> {}</li><li>
</li><li><span class="hljs-meta">@Sendable</span></li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">SendableFunc</span>(<span class="hljs-params"></span>) {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"Sendable func"</span>);</li><li>}</li></ol></pre></div></div>     <p><strong>反例：</strong></p>     <div _ngcontent-kok-c106="" class="highlight-div"><div _ngcontent-kok-c106="" class="highlight-div-header"><div _ngcontent-kok-c106="" class="highlight-div-header-left"><div _ngcontent-kok-c106="" class="handle-button expand-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kok-c106="" class="highlight-div-header-right"><div _ngcontent-kok-c106="" class="handle-button ai-button"></div><div _ngcontent-kok-c106="" class="handle-button line-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kok-c106="" class="handle-button theme-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kok-c106="" class="handle-button copy-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kok-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@Sendable</span></li><li><span class="hljs-keyword">type</span> A = <span class="hljs-built_in">number</span>; <span class="hljs-comment">// 编译报错</span></li><li>
</li><li><span class="hljs-meta">@Sendable</span></li><li><span class="hljs-keyword">type</span> D = C; <span class="hljs-comment">// 编译报错</span></li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="sendable类和sendable函数禁止使用除sendable外的装饰器">Sendable类和Sendable函数禁止使用除@Sendable外的装饰器<i class="anchor-icon anchor-icon-link" anchorid="sendable类和sendable函数禁止使用除sendable外的装饰器" tips="复制节点链接"></i></h3>          <p>在ts文件中定义类装饰器时，可能会改变类的结构，进而引发运行时错误。</p>     <p><strong>正例：</strong></p>     <div _ngcontent-kok-c106="" class="highlight-div"><div _ngcontent-kok-c106="" class="highlight-div-header"><div _ngcontent-kok-c106="" class="highlight-div-header-left"><div _ngcontent-kok-c106="" class="handle-button expand-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kok-c106="" class="highlight-div-header-right"><div _ngcontent-kok-c106="" class="handle-button ai-button"></div><div _ngcontent-kok-c106="" class="handle-button line-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kok-c106="" class="handle-button theme-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kok-c106="" class="handle-button copy-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kok-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@Sendable</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span> {</li><li>  <span class="hljs-attr">num</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">1</span>;</li><li>}</li></ol></pre></div></div>     <p><strong>反例：</strong></p>     <div _ngcontent-kok-c106="" class="highlight-div"><div _ngcontent-kok-c106="" class="highlight-div-header"><div _ngcontent-kok-c106="" class="highlight-div-header-left"><div _ngcontent-kok-c106="" class="handle-button expand-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kok-c106="" class="highlight-div-header-right"><div _ngcontent-kok-c106="" class="handle-button ai-button"></div><div _ngcontent-kok-c106="" class="handle-button line-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kok-c106="" class="handle-button theme-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kok-c106="" class="handle-button copy-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kok-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@Sendable</span></li><li><span class="hljs-meta">@Observed</span> <span class="hljs-comment">// 编译报错</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">C</span> {</li><li>  <span class="hljs-attr">num</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">1</span>;</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="初始化规则">初始化规则<i class="anchor-icon anchor-icon-link" anchorid="初始化规则" tips="复制节点链接"></i></h2>         </div>    <div class="tiledSection">     <h3 id="禁止使用对象字面量数组字面量初始化sendable对象" class="firsth2">禁止使用对象字面量/数组字面量初始化Sendable对象<i class="anchor-icon anchor-icon-link" anchorid="禁止使用对象字面量数组字面量初始化sendable对象" tips="复制节点链接"></i></h3>          <p>对象字面量和数组字面量不是Sendable类型。Sendable类型必须通过Sendable类型的new表达式创建。</p>     <p><strong>正例：</strong></p>     <div _ngcontent-kok-c106="" class="highlight-div"><div _ngcontent-kok-c106="" class="highlight-div-header"><div _ngcontent-kok-c106="" class="highlight-div-header-left"><div _ngcontent-kok-c106="" class="handle-button expand-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kok-c106="" class="highlight-div-header-right"><div _ngcontent-kok-c106="" class="handle-button ai-button"></div><div _ngcontent-kok-c106="" class="handle-button line-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kok-c106="" class="handle-button theme-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kok-c106="" class="handle-button copy-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kok-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { collections } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkTS'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">arr1</span>: collections.<span class="hljs-property">Array</span>&lt;<span class="hljs-built_in">number</span>&gt; = <span class="hljs-keyword">new</span> collections.<span class="hljs-property">Array</span>&lt;<span class="hljs-built_in">number</span>&gt;(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>); <span class="hljs-comment">// 是Sendable类型</span></li></ol></pre></div></div>     <p><strong>反例：</strong></p>     <div _ngcontent-kok-c106="" class="highlight-div"><div _ngcontent-kok-c106="" class="highlight-div-header"><div _ngcontent-kok-c106="" class="highlight-div-header-left"><div _ngcontent-kok-c106="" class="handle-button expand-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kok-c106="" class="highlight-div-header-right"><div _ngcontent-kok-c106="" class="handle-button ai-button"></div><div _ngcontent-kok-c106="" class="handle-button line-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kok-c106="" class="handle-button theme-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kok-c106="" class="handle-button copy-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kok-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { collections } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkTS'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">arr2</span>: collections.<span class="hljs-property">Array</span>&lt;<span class="hljs-built_in">number</span>&gt; = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]; <span class="hljs-comment">// 不是Sendable类型，编译报错</span></li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">arr3</span>: <span class="hljs-built_in">number</span>[] = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]; <span class="hljs-comment">// 不是Sendable类型，正例，不报错</span></li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">arr4</span>: <span class="hljs-built_in">number</span>[] = <span class="hljs-keyword">new</span> collections.<span class="hljs-property">Array</span>&lt;<span class="hljs-built_in">number</span>&gt;(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>); <span class="hljs-comment">// 编译报错</span></li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="类型转换规则">类型转换规则<i class="anchor-icon anchor-icon-link" anchorid="类型转换规则" tips="复制节点链接"></i></h2>         </div>    <div class="tiledSection">     <h3 id="禁止非sendable类型强制转换为sendable" class="firsth2">禁止非Sendable类型强制转换为Sendable<i class="anchor-icon anchor-icon-link" anchorid="禁止非sendable类型强制转换为sendable" tips="复制节点链接"></i></h3>          <p>除了Object类型，非Sendable类型不能强转成Sendable类型。非Sendable类型通过as强转成Sendable类型后，实际数据仍为非Sendable类型，会导致错误使用。Sendable类型在不违反Sendable规则的前提下，需要和非Sendable类型行为兼容，因此Sendable类型可以通过as强转成非Sendable类型。</p>     <p><strong>正例：</strong></p>     <div _ngcontent-kok-c106="" class="highlight-div"><div _ngcontent-kok-c106="" class="highlight-div-header"><div _ngcontent-kok-c106="" class="highlight-div-header-left"><div _ngcontent-kok-c106="" class="handle-button expand-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kok-c106="" class="highlight-div-header-right"><div _ngcontent-kok-c106="" class="handle-button ai-button"></div><div _ngcontent-kok-c106="" class="handle-button line-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kok-c106="" class="handle-button theme-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kok-c106="" class="handle-button copy-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kok-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span> {</li><li>  <span class="hljs-attr">state</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;</li><li>}</li><li>
</li><li><span class="hljs-meta">@Sendable</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">SendableA</span> {</li><li>  <span class="hljs-attr">state</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;</li><li>}</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">a1</span>: A = <span class="hljs-keyword">new</span> <span class="hljs-title class_">SendableA</span>() <span class="hljs-keyword">as</span> A;</li></ol></pre></div></div>     <p><strong>反例：</strong></p>     <div _ngcontent-kok-c106="" class="highlight-div"><div _ngcontent-kok-c106="" class="highlight-div-header"><div _ngcontent-kok-c106="" class="highlight-div-header-left"><div _ngcontent-kok-c106="" class="handle-button expand-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kok-c106="" class="highlight-div-header-right"><div _ngcontent-kok-c106="" class="handle-button ai-button"></div><div _ngcontent-kok-c106="" class="handle-button line-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kok-c106="" class="handle-button theme-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kok-c106="" class="handle-button copy-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kok-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span> {</li><li>  <span class="hljs-attr">state</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;</li><li>}</li><li>
</li><li><span class="hljs-meta">@Sendable</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">SendableA</span> {</li><li>  <span class="hljs-attr">state</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;</li><li>}</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">a2</span>: <span class="hljs-title class_">SendableA</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_">A</span>() <span class="hljs-keyword">as</span> <span class="hljs-title class_">SendableA</span>; <span class="hljs-comment">// 编译报错</span></li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="函数规则">函数规则<i class="anchor-icon anchor-icon-link" anchorid="函数规则" tips="复制节点链接"></i></h2>         </div>    <div class="tiledSection">     <h3 id="箭头函数不可标记为sendable" class="firsth2">箭头函数不可标记为Sendable<i class="anchor-icon anchor-icon-link" anchorid="箭头函数不可标记为sendable" tips="复制节点链接"></i></h3>          <p>箭头函数不支持@Sendable装饰器，因此它是非Sendable函数，因此不支持共享。</p>     <p><strong>正例：</strong></p>     <div _ngcontent-kok-c106="" class="highlight-div"><div _ngcontent-kok-c106="" class="highlight-div-header"><div _ngcontent-kok-c106="" class="highlight-div-header-left"><div _ngcontent-kok-c106="" class="handle-button expand-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kok-c106="" class="highlight-div-header-right"><div _ngcontent-kok-c106="" class="handle-button ai-button"></div><div _ngcontent-kok-c106="" class="handle-button line-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kok-c106="" class="handle-button theme-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kok-c106="" class="handle-button copy-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kok-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@Sendable</span></li><li><span class="hljs-keyword">type</span> <span class="hljs-title class_">SendableFuncType</span> = <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">void</span>;</li><li>
</li><li><span class="hljs-meta">@Sendable</span></li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">SendableFunc</span>(<span class="hljs-params"></span>) {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"Sendable func"</span>);</li><li>}</li><li>
</li><li><span class="hljs-meta">@Sendable</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">SendableClass</span> {</li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">f: SendableFuncType</span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">func</span> = f;</li><li>  }</li><li>  <span class="hljs-attr">func</span>: <span class="hljs-title class_">SendableFuncType</span>;</li><li>}</li><li>
</li><li><span class="hljs-keyword">let</span> sendableClass = <span class="hljs-keyword">new</span> <span class="hljs-title class_">SendableClass</span>(<span class="hljs-title class_">SendableFunc</span>);</li></ol></pre></div></div>     <p><strong>反例：</strong></p>     <div _ngcontent-kok-c106="" class="highlight-div"><div _ngcontent-kok-c106="" class="highlight-div-header"><div _ngcontent-kok-c106="" class="highlight-div-header-left"><div _ngcontent-kok-c106="" class="handle-button expand-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kok-c106="" class="highlight-div-header-right"><div _ngcontent-kok-c106="" class="handle-button ai-button"></div><div _ngcontent-kok-c106="" class="handle-button line-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kok-c106="" class="handle-button theme-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kok-c106="" class="handle-button copy-button"><div _ngcontent-kok-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kok-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@Sendable</span></li><li><span class="hljs-keyword">type</span> <span class="hljs-title class_">SendableFuncType</span> = <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">void</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">func</span>: <span class="hljs-title class_">SendableFuncType</span> = <span class="hljs-function">() =&gt;</span> {}; <span class="hljs-comment">// 编译报错</span></li><li>
</li><li><span class="hljs-meta">@Sendable</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">SendableClass</span> {</li><li>  <span class="hljs-attr">func</span>: <span class="hljs-title class_">SendableFuncType</span> = <span class="hljs-function">() =&gt;</span> {}; <span class="hljs-comment">// 编译报错</span></li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="与tsjs交互的规则">与TS/JS交互的规则<i class="anchor-icon anchor-icon-link" anchorid="与tsjs交互的规则" tips="复制节点链接"></i></h2>         </div>    <div class="tiledSection">     <h3 id="arkts通用规则目前只针对sendable对象" class="firsth2">ArkTS通用规则（目前只针对Sendable对象）<i class="anchor-icon anchor-icon-link" anchorid="arkts通用规则目前只针对sendable对象" tips="复制节点链接"></i></h3>          <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.25.2.1.2.1.1" valign="top" width="100%">规则</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="100%">Sendable对象传入TS/JS的接口中，禁止操作其对象布局（增、删属性，改变属性类型）。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="100%">Sendable对象设置到TS/JS的对象上，TS中获取到Sendable对象后，禁止操作其对象布局（增、删属性，改变属性类型）。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="100%">Sendable对象放入TS/JS的容器中，TS中获取到Sendable对象后，禁止操作其对象布局（增、删属性，改变属性类型）。</td>        </tr>             </tbody></table></div>     </div>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>改变属性类型不包括Sendable对象类型的改变，例如从Sendable class A变为Sendable class B。</p>      </div></div></div>    </div>    <div class="tiledSection">     <h3 id="napi规则目前只针对sendable对象">NAPI规则（目前只针对Sendable对象）<i class="anchor-icon anchor-icon-link" anchorid="napi规则目前只针对sendable对象" tips="复制节点链接"></i></h3>          <p>NAPI相关接口请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/use-napi-about-extension#sendable相关">Sendable相关的NAPI接口</a>，具体使用请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/use-sendable-napi">Native与Sendable ArkTS对象绑定</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.26.3.1.2.1.1" valign="top" width="100%">规则</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="100%">禁止删除属性。不能使用napi_delete_property接口。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="100%">禁止新增属性。不能使用napi_set_property、napi_set_named_property、napi_define_properties接口。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="100%">禁止修改属性类型。不能使用napi_set_property、napi_set_named_property、napi_define_properties接口。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="100%">不支持Symbol相关接口和类型。不能使用napi_create_symbol、napi_is_symbol_object、napi_symbol接口。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="与ui交互的规则">与UI交互的规则<i class="anchor-icon anchor-icon-link" anchorid="与ui交互的规则" tips="复制节点链接"></i></h2>          <p>Sendable数据需要与<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-new-makeobserved">makeObserved</a>配合使用，才可以观察Sendable对象的数据变化，具体使用请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-new-makeobserved#makeobserved和sendable装饰的class配合使用">makeObserved和@Sendable装饰的class配合文档</a>。</p>    </div>    <div class="tiledSection">     <h2 id="在har包中的使用规则">在HAR包中的使用规则<i class="anchor-icon anchor-icon-link" anchorid="在har包中的使用规则" tips="复制节点链接"></i></h2>          <p>HAR中使用Sendable时，需启用编译生成TS文件的配置。具体使用请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/har-package#编译生成ts文件">编译生成TS文件</a>。</p>    </div>   </div>   <div></div></div>