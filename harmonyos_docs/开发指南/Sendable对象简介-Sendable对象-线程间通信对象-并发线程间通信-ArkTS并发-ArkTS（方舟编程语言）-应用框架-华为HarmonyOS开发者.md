<h1 _ngcontent-lkr-c119="" class="doc-title ng-star-inserted" title="Sendable对象简介"> Sendable对象简介 </h1>

<div _ngcontent-lkr-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p>在传统JS引擎中，要优化对象的并发通信开销，唯一的方法是将实现下沉到Native侧，通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/transferabled-object">Transferable对象</a>的转移或共享来降低开销。然而，开发者仍有大量对象并发通信的需求，这个问题在业界JS引擎中尚未解决。</p>    <p>ArkTS提供了Sendable对象类型，在并发通信时支持通过引用传递来解决上述问题。</p>    <p>Sendable对象可共享，跨线程前后指向同一个JS对象。如果包含JS或Native内容，可以直接共享。如果底层是Native实现，则需要确保线程安全性。通信过程如下图所示：</p>    <p><span><img originheight="946" originwidth="1200" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114951.57670718293785013334261822463155:50001231000000:2800:C147406BDD35AD0C975F226D3739060EC0069E42D94715B5A7FA63269509295F.png" width="920" height="725.2666666666668"></span></p>    <p>与其它ArkTS数据对象不同，符合Sendable协议的数据对象在运行时应为类型固定的对象。</p>    <p>当多个并发实例尝试同时更新Sendable数据时，会发生数据竞争，例如<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-collections-introduction">ArkTS共享容器</a>的多线程操作。因此，ArkTS提供<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-async-lock-introduction">异步锁</a>机制来避免不同并发实例间的数据竞争，并提供了<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-condition-variable-introduction">异步等待</a>机制来控制多线程处理数据的时序。同时，还可以通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/sendable-freeze">对象冻结接口</a>将对象冻结为只读，从而避免数据竞争。</p>    <p>Sendable对象提供了并发实例间高效的通信能力，即引用传递，适用于开发者自定义大对象需要线程间通信的场景，例如子线程读取数据库数据并返回给宿主线程，具体代码实现可参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/sendable-guide#跨并发实例传输大数据场景">跨并发实例传输大数据场景</a>。</p>    <div class="tiledSection">     <h2 id="基础概念">基础概念<i class="anchor-icon anchor-icon-link" anchorid="基础概念" tips="复制节点链接"></i></h2>         </div>    <div class="tiledSection">     <h3 id="sendable协议" class="firsth2">Sendable协议<i class="anchor-icon anchor-icon-link" anchorid="sendable协议" tips="复制节点链接"></i></h3>          <p>Sendable协议定义了ArkTS的可共享对象体系及其规格约束。符合Sendable协议的数据（以下简称Sendable数据）可以在ArkTS并发实例间传递。</p>     <p>默认情况下，Sendable数据在ArkTS并发实例间（包括UI主线程、TaskPool线程、Worker线程）传递时采用引用传递。ArkTS还支持在这些实例间对Sendable数据进行拷贝传递。</p>    </div>    <div class="tiledSection">     <h3 id="isendable">ISendable<i class="anchor-icon anchor-icon-link" anchorid="isendable" tips="复制节点链接"></i></h3>          <p>在ArkTS语言基础库<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-arkts-lang" target="_blank">@arkts.lang</a>中引入了interface ISendable，没有任何方法或属性。ISendable是所有Sendable类型（除了null和undefined）的父类型。ISendable主要用于开发者自定义Sendable数据结构的场景中。类装饰器<a href="/consumer/cn/doc/harmonyos-guides/arkts-sendable#sendable装饰器">@Sendable装饰器</a>是implement ISendable的语法糖。</p>    </div>    <div class="tiledSection">     <h3 id="sendable-class">Sendable class<i class="anchor-icon anchor-icon-link" anchorid="sendable-class" tips="复制节点链接"></i></h3>          <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>从API version 11开始，支持使用@Sendable装饰器校验Sendable class。</p>      </div></div></div>     <p>Sendable class需同时满足以下两个规则：</p>     <ol>      <li>       <p>当且仅当被标注了<a href="/consumer/cn/doc/harmonyos-guides/arkts-sendable#sendable装饰器">@Sendable装饰器</a>。</p></li>      <li>       <p>需满足Sendable约束，详情可查<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/sendable-constraints">Sendable使用规则</a>。</p></li>     </ol>    </div>    <div class="tiledSection">     <h3 id="sendable-function">Sendable function<i class="anchor-icon anchor-icon-link" anchorid="sendable-function" tips="复制节点链接"></i></h3>          <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <ul>        <li>         <p>从API version 12开始，支持使用@Sendable装饰器校验Sendable function。</p></li>        <li>         <p>针对API version 12的工程，开发者使用@Sendable装饰器校验Sendable function时，需在工程中配置"compatibleSdkVersionStage": "beta3"，否则其Sendable特性将不生效。参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/ide-hvigor-build-profile-V5" target="_blank">build-profile.json5配置文件说明</a>。</p></li>        <li>         <p>针对API version大于12的工程，可直接使用@Sendable装饰器校验Sendable function，无需再进行其他配置。</p></li>       </ul>      </div></div></div>     <p>Sendable function需同时满足以下两个规则：</p>     <ol>      <li>       <p>当且仅当被标注了<a href="/consumer/cn/doc/harmonyos-guides/arkts-sendable#sendable装饰器">@Sendable装饰器</a>。</p></li>      <li>       <p>需满足Sendable约束，具体可参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/sendable-constraints">Sendable使用规则</a>。</p></li>     </ol>    </div>    <div class="tiledSection">     <h3 id="sendable-interface">Sendable interface<i class="anchor-icon anchor-icon-link" anchorid="sendable-interface" tips="复制节点链接"></i></h3>          <p>Sendable interface需同时满足以下两个规则：</p>     <ol>      <li>       <p>当且仅当是<a href="/consumer/cn/doc/harmonyos-guides/arkts-sendable#isendable">ISendable</a>或者继承了ISendable。</p></li>      <li>       <p>需满足Sendable约束，具体可参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/sendable-constraints">Sendable使用规则</a>。</p></li>     </ol>    </div>    <div class="tiledSection">     <h3 id="sendable支持的数据类型">Sendable支持的数据类型<i class="anchor-icon anchor-icon-link" anchorid="sendable支持的数据类型" tips="复制节点链接"></i></h3>          <ul>      <li>       <p>ArkTS基本数据类型：boolean、number、string、bigint、null、undefined。</p></li>      <li>       <p>ArkTS数据类型：const enum（常量枚举）。</p></li>      <li>       <p>ArkTS语言标准库中定义的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-collections-introduction">容器类型数据</a>（须显式引入<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-arkts-collections" target="_blank">@arkts.collections</a>）。</p></li>      <li>       <p>ArkTS语言标准库中定义的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-async-lock-introduction">异步锁对象</a>（须显式引入<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-arkts-utils" target="_blank">@arkts.utils</a>）。</p></li>      <li>       <p>ArkTS语言标准库中定义的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-condition-variable-introduction">异步等待对象</a>（须显式引入<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-arkts-utils" target="_blank">@arkts.utils</a>）。</p></li>      <li>       <p>ArkTS语言标准库中定义的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-arkts-utils-sendablelrucache" target="_blank">SendableLruCache对象</a>（须显式引入<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-arkts-utils" target="_blank">@arkts.utils</a>）。</p></li>      <li>       <p>继承了<a href="/consumer/cn/doc/harmonyos-guides/arkts-sendable#isendable">ISendable</a>的interface。</p></li>      <li>       <p>标注了<a href="/consumer/cn/doc/harmonyos-guides/arkts-sendable#sendable装饰器">@Sendable装饰器</a>的class。</p></li>      <li>       <p>标注了<a href="/consumer/cn/doc/harmonyos-guides/arkts-sendable#sendable装饰器">@Sendable装饰器</a>的function。</p></li>      <li>       <p>接入Sendable的系统对象：</p>       <ul>        <li><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-data-sendablepreferences" target="_blank">共享用户首选项</a></li>        <li><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-sendablecolorspacemanager" target="_blank">可共享的色彩管理</a></li>        <li><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-sendableimage" target="_blank">基于Sendable对象的图片处理</a></li>        <li><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-sendable-resource-manager" target="_blank">资源管理</a></li>        <li><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-sendablecontextmanager" target="_blank">SendableContext对象管理</a></li>       </ul></li>      <li>       <p>元素均为Sendable类型的union type数据。</p></li>      <li>       <p>开发者自定义的Native Sendable对象。ArkTS支持开发者自定义Native Sendable对象，详情参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/napi-define-sendable-object">自定义Native Sendable对象的多线程操作场景</a>。</p></li>     </ul>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <ul>        <li>         <p>JS内置对象在并发实例间传递时遵循结构化克隆算法，跨线程行为是拷贝传递。因此，JS内置对象的实例不是Sendable类型。</p></li>        <li>         <p>对象字面量和数组字面量在并发实例间传递时遵循结构化克隆算法，跨线程行为是拷贝传递。因此，对象字面量和数组字面量不是Sendable类型。</p></li>       </ul>      </div></div></div>     <p><strong>Sendable支持const enum类型使用示例：</strong></p>     <div _ngcontent-lkr-c106="" class="highlight-div"><div _ngcontent-lkr-c106="" class="highlight-div-header"><div _ngcontent-lkr-c106="" class="highlight-div-header-left"><div _ngcontent-lkr-c106="" class="handle-button expand-button"><div _ngcontent-lkr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-lkr-c106="" class="highlight-div-header-right"><div _ngcontent-lkr-c106="" class="handle-button ai-button"></div><div _ngcontent-lkr-c106="" class="handle-button line-button"><div _ngcontent-lkr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-lkr-c106="" class="handle-button theme-button"><div _ngcontent-lkr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-lkr-c106="" class="handle-button copy-button"><div _ngcontent-lkr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-lkr-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// Test.ets</span></li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-keyword">enum</span> <span class="hljs-title class_">ModelState</span> {</li><li>  <span class="hljs-variable constant_">ACTIVE</span>,</li><li>  <span class="hljs-variable constant_">INACTIVE</span></li><li>}</li></ol></pre></div></div>     <div _ngcontent-lkr-c106="" class="highlight-div"><div _ngcontent-lkr-c106="" class="highlight-div-header"><div _ngcontent-lkr-c106="" class="highlight-div-header-left"><div _ngcontent-lkr-c106="" class="handle-button expand-button"><div _ngcontent-lkr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-lkr-c106="" class="highlight-div-header-right"><div _ngcontent-lkr-c106="" class="handle-button ai-button"></div><div _ngcontent-lkr-c106="" class="handle-button line-button"><div _ngcontent-lkr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-lkr-c106="" class="handle-button theme-button"><div _ngcontent-lkr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-lkr-c106="" class="handle-button copy-button"><div _ngcontent-lkr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-lkr-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// Index.ets</span></li><li><span class="hljs-keyword">import</span> { taskpool } <span class="hljs-keyword">from</span> <span class="hljs-string">"@kit.ArkTS"</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">ModelState</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"./Test"</span>;</li><li>
</li><li><span class="hljs-meta">@Sendable</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Model</span> {</li><li>  <span class="hljs-attr">state</span>: <span class="hljs-title class_">ModelState</span> = <span class="hljs-title class_">ModelState</span>.<span class="hljs-property">ACTIVE</span>;</li><li>
</li><li>  <span class="hljs-title function_">getState</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"model state is "</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">setState</span>(<span class="hljs-params">state: ModelState</span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">state</span> = state;</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-meta">@Concurrent</span></li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">setModelState</span>(<span class="hljs-params">model: Model</span>) {</li><li>  model.<span class="hljs-title function_">setState</span>(<span class="hljs-title class_">ModelState</span>.<span class="hljs-property">INACTIVE</span>);</li><li>  model.<span class="hljs-title function_">getState</span>();</li><li>}</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'Hello World'</span>;</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">num</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">RelativeContainer</span>() {</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span>)</li><li>        .<span class="hljs-title function_">id</span>(<span class="hljs-string">'HelloWorld'</span>)</li><li>        .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">50</span>)</li><li>        .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)</li><li>        .<span class="hljs-title function_">alignRules</span>({</li><li>          <span class="hljs-attr">center</span>: { <span class="hljs-attr">anchor</span>: <span class="hljs-string">'__container__'</span>, <span class="hljs-attr">align</span>: <span class="hljs-title class_">VerticalAlign</span>.<span class="hljs-property">Center</span> },</li><li>          <span class="hljs-attr">middle</span>: { <span class="hljs-attr">anchor</span>: <span class="hljs-string">'__container__'</span>, <span class="hljs-attr">align</span>: <span class="hljs-title class_">HorizontalAlign</span>.<span class="hljs-property">Center</span> }</li><li>        })</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-keyword">async</span> () =&gt; {</li><li>          <span class="hljs-keyword">let</span> model = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Model</span>();</li><li>          model.<span class="hljs-title function_">getState</span>();</li><li>          <span class="hljs-keyword">let</span> task = <span class="hljs-keyword">new</span> taskpool.<span class="hljs-title class_">Task</span>(setModelState, model);</li><li>          <span class="hljs-keyword">await</span> taskpool.<span class="hljs-title function_">execute</span>(task);</li><li>        })</li><li>    }</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="sendable的实现原理">Sendable的实现原理<i class="anchor-icon anchor-icon-link" anchorid="sendable的实现原理" tips="复制节点链接"></i></h2>          <p>为了实现<a href="/consumer/cn/doc/harmonyos-guides/arkts-sendable#sendable支持的数据类型">Sendable数据</a>在不同并发实例间的引用传递，Sendable共享对象分配在共享堆中，实现跨并发实例的内存共享。</p>     <p>共享堆（SharedHeap）是进程级别的堆空间，与虚拟机本地堆（LocalHeap）不同，LocalHeap仅限单个并发实例访问，而SharedHeap可被所有线程访问。Sendable对象的跨线程行为为引用传递，因此，一个Sendable对象可能被多个并发实例引用。判断该Sendable对象是否存活，取决于所有并发实例是否存在对此Sendable对象的引用。</p>     <p><strong>SharedHeap与LocalHeap关系图</strong></p>     <p><span><img originheight="348" originwidth="592" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114951.93685637183346371736584980039757:50001231000000:2800:0B16EB2202C6B9FB0C4745DD17E3D1E7085048123342B51296D4550F501FA502.png" width="592" height="348"></span></p>     <p>各个并发实例的LocalHeap是隔离的。SharedHeap是进程级别的堆，可以被所有并发实例共享，但SharedHeap不能引用LocalHeap中的对象。</p>    </div>    <div class="tiledSection">     <h2 id="sendable装饰器">@Sendable装饰器<i class="anchor-icon anchor-icon-link" anchorid="sendable装饰器" tips="复制节点链接"></i></h2>          <p>声明并校验Sendable class和Sendable function。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.16.3.1.3.1.1" valign="top" width="50%">@Sendable装饰器</th>         <th align="left" class="cellrowborder" id="mcps1.3.16.3.1.3.1.2" valign="top" width="50%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="50%">装饰器参数</td>         <td class="cellrowborder" valign="top" width="50%">无。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">使用场景限制</td>         <td class="cellrowborder" valign="top" width="50%">仅支持在Stage模型的.ets文件中使用。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">装饰的函数类型限制</td>         <td class="cellrowborder" valign="top" width="50%">仅支持装饰普通function和Async function类型。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">装饰的类继承关系限制</td>         <td class="cellrowborder" valign="top" width="50%">Sendable class只能继承Sendable class，普通Class不可继承Sendable class。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">装饰的对象内的属性类型限制</td>         <td class="cellrowborder" valign="top" width="50%">          <p>1. 支持string、number、boolean、bigint、null、undefined、Sendable class、collections容器集、ArkTSUtils.locks.AsyncLock、ArkTSUtils.SendableLruCache、ArkTSUtils.locks.ConditionVariable以及自定义的Sendable函数类型。</p>          <p>2. 禁止使用闭包变量，定义在顶层的Sendable class和Sendable function除外。</p>          <p>3. 不支持通过#定义私有属性，需用private。</p>          <p>4. 不支持计算属性。</p></td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">装饰的对象内的属性的其他限制</td>         <td class="cellrowborder" valign="top" width="50%">          <p>1. 成员属性必须显式初始化，不能使用感叹号。</p>          <p>2. 不支持增加或删除属性，允许修改属性，修改前后属性的类型必须一致，不支持修改方法。</p></td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">装饰的函数或类对象内的方法参数限制</td>         <td class="cellrowborder" valign="top" width="50%">允许使用local变量、入参和通过import引入的变量。禁止使用闭包变量，但定义在顶层的Sendable class和Sendable function除外。从API version 18开始，支持访问本文件导出的变量。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">适用场景</td>         <td class="cellrowborder" valign="top" width="50%">          <p>1. 在TaskPool或Worker中使用类方法或Sendable函数。</p>          <p>2. 传输对象数据量较大的场景。序列化耗时会随着数据量增大而增大，使用Sendable对数据进行改造后，传输100KB数据效率提升约20倍，传输1M数据效率提升约100倍。</p></td>        </tr>             </tbody></table></div>     </div>     <p><strong>装饰器修饰Class使用示例：</strong></p>     <div _ngcontent-lkr-c106="" class="highlight-div"><div _ngcontent-lkr-c106="" class="highlight-div-header"><div _ngcontent-lkr-c106="" class="highlight-div-header-left"><div _ngcontent-lkr-c106="" class="handle-button expand-button"><div _ngcontent-lkr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-lkr-c106="" class="highlight-div-header-right"><div _ngcontent-lkr-c106="" class="handle-button ai-button"></div><div _ngcontent-lkr-c106="" class="handle-button line-button"><div _ngcontent-lkr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-lkr-c106="" class="handle-button theme-button"><div _ngcontent-lkr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-lkr-c106="" class="handle-button copy-button"><div _ngcontent-lkr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-lkr-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@Sendable</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">SendableTestClass</span> {</li><li>  <span class="hljs-attr">desc</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">"sendable: this is SendableTestClass "</span>;</li><li>  <span class="hljs-attr">num</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">5</span>;</li><li>  <span class="hljs-title function_">printName</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"sendable: SendableTestClass desc is: "</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">desc</span>);</li><li>  }</li><li>  <span class="hljs-title function_">getNum</span>(): <span class="hljs-built_in">number</span> {</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">num</span>;</li><li>  }</li><li>}</li></ol></pre></div></div>     <p><strong>装饰器修饰Function使用示例：</strong></p>     <div _ngcontent-lkr-c106="" class="highlight-div"><div _ngcontent-lkr-c106="" class="highlight-div-header"><div _ngcontent-lkr-c106="" class="highlight-div-header-left"><div _ngcontent-lkr-c106="" class="handle-button expand-button"><div _ngcontent-lkr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-lkr-c106="" class="highlight-div-header-right"><div _ngcontent-lkr-c106="" class="handle-button ai-button"></div><div _ngcontent-lkr-c106="" class="handle-button line-button"><div _ngcontent-lkr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-lkr-c106="" class="handle-button theme-button"><div _ngcontent-lkr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-lkr-c106="" class="handle-button copy-button"><div _ngcontent-lkr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-lkr-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@Sendable</span></li><li><span class="hljs-keyword">type</span> <span class="hljs-title class_">SendableFuncType</span> = <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">void</span>;</li><li>
</li><li><span class="hljs-meta">@Sendable</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">TopLevelSendableClass</span> {</li><li>  <span class="hljs-attr">num</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">1</span>;</li><li>  <span class="hljs-title class_">PrintNum</span>() {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"Top level sendable class"</span>);</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-meta">@Sendable</span></li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">TopLevelSendableFunction</span>(<span class="hljs-params"></span>) {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"Top level sendable function"</span>);</li><li>}</li><li>
</li><li><span class="hljs-meta">@Sendable</span></li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">SendableTestFunction</span>(<span class="hljs-params"></span>) {</li><li>  <span class="hljs-keyword">const</span> topClass = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TopLevelSendableClass</span>(); <span class="hljs-comment">// 顶层sendable class</span></li><li>  topClass.<span class="hljs-title class_">PrintNum</span>();</li><li>  <span class="hljs-title class_">TopLevelSendableFunction</span>(); <span class="hljs-comment">// 顶层sendable function</span></li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"Sendable test function"</span>);</li><li>}</li><li>
</li><li><span class="hljs-meta">@Sendable</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">SendableTestClass</span> {</li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">func: SendableFuncType</span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">callback</span> = func;</li><li>  }</li><li>  <span class="hljs-attr">callback</span>: <span class="hljs-title class_">SendableFuncType</span>; <span class="hljs-comment">// 顶层sendable function</span></li><li>
</li><li>  <span class="hljs-title class_">CallSendableFunc</span>() {</li><li>    <span class="hljs-title class_">SendableTestFunction</span>(); <span class="hljs-comment">// 顶层sendable function</span></li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-keyword">let</span> sendableClass = <span class="hljs-keyword">new</span> <span class="hljs-title class_">SendableTestClass</span>(<span class="hljs-title class_">SendableTestFunction</span>);</li><li>sendableClass.<span class="hljs-title function_">callback</span>();</li><li>sendableClass.<span class="hljs-title class_">CallSendableFunc</span>();</li></ol></pre></div></div>    </div>   </div>   <div></div></div>