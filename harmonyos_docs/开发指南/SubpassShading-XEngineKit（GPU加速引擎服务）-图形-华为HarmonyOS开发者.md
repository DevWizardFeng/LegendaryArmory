<h1 _ngcontent-bxg-c119="" class="doc-title ng-star-inserted" title="Subpass Shading"> Subpass Shading </h1>

<div _ngcontent-bxg-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div><p>随着游戏场景的复杂化，越来越多的光照效果被应用到游戏场景中，随之也带来大量的光照计算以及带宽消耗。目前通过Tile-Based Deferred Rendering（<span style="color: rgb(29,29,26);">TBDR</span>）<span style="color: rgb(29,29,26);">和</span><span style="color: rgb(29,29,26);">Forward+</span>等方法可以解决大量光照的渲染时间消耗，但是大量带宽的占用问题还是没有解决，Subpass Shading能力主要减少计算过程中的读写从而减少带宽的占用。</p> <p>下图说明Subpass Shading节省渲染通道1和Compute Pass从Device memory上面的一次读写带宽。</p> <div class="fignone"><span class="figcap"><b>图1 </b>Forward+读取过程</span><br><span><img height="273.315" originheight="2331" originwidth="4464" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114349.68435100898937129567680692111812:50001231000000:2800:F7A90A5B43CF3BF0215BB3E7B94CB1A95E69F51030E7937B23C8AF7DE572F90C.png" title="点击放大" width="523.6875"></span></div> <div class="fignone"><span class="figcap"><b>图2 </b>Subpass Shading读取过程</span><br><span><img height="251.37" originheight="2336" originwidth="4859" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114350.85866068078646279335138517358815:50001231000000:2800:5B5D2BE0BA4EE89D7F1616958112A80C964936CD3325A632915DC6D306D47EA4.png" title="点击放大" width="523.6875"></span></div> <div class="tiledSection"><h2 id="section624112515458">约束与限制<i class="anchor-icon anchor-icon-link" anchorid="section624112515458" tips="复制节点链接"></i></h2><p>支持的设备类型：Phone，从5.0.2(14)版本开始，新增支持Tablet、PC/2in1设备，从5.1.0(18)版本开始新增支持TV设备。</p> </div> <div class="tiledSection"><h2 id="section1890013261807">接口说明<i class="anchor-icon anchor-icon-link" anchorid="section1890013261807" tips="复制节点链接"></i></h2><p>通过Vulkan扩展接口<a href="https://registry.khronos.org/vulkan/specs/latest/man/html/VK_HUAWEI_subpass_shading.html" target="_blank">VK_HUAWEI_subpass_shading</a>提供Subpass Shading API，<span style="color: rgb(29,29,26);">该扩展支持在</span><span style="color: rgb(29,29,26);">Subpass</span><span style="color: rgb(29,29,26);">中使用</span><span style="color: rgb(29,29,26);">Compute Shader</span><span style="color: rgb(29,29,26);">，并在</span><span style="color: rgb(29,29,26);">Compute Shader</span><span style="color: rgb(29,29,26);">中使用</span><span style="color: rgb(29,29,26);">SubpassLoad</span><span style="color: rgb(29,29,26);">从</span><span style="color: rgb(29,29,26);">Tile buffer</span><span style="color: rgb(29,29,26);">中直接读取数据，可用</span>于降低DDR带宽<span style="color: rgb(29,29,26);">，适用于</span><span style="color: rgb(29,29,26);">TBDR</span><span style="color: rgb(29,29,26);">和</span><span style="color: rgb(29,29,26);">Forward+</span><span style="color: rgb(29,29,26);">管线。</span></p> </div> <p>Subpass Shading能力具体使用请参见<a href="https://gitcode.com/harmonyos_samples/xengine-samplecode-subpass-shading-demo-cpp" target="_blank">Demo（GPU加速引擎-Subpass Shading）</a>。</p> </div> <div></div></div>