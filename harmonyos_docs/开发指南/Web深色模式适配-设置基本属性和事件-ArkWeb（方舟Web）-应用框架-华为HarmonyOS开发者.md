<h1 _ngcontent-wrm-c119="" class="doc-title ng-star-inserted" title="Web深色模式适配"> Web深色模式适配 </h1>

<div _ngcontent-wrm-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p>系统提供浅色和深色的主题模式供用户选择。深色模式在低光环境下能够降低屏幕亮度，减少光线刺激，改善阅读体验。Web组件根据网页样式进行渲染。若网页未适配深色模式，会造成与系统主题的割裂感。网页开发者应考虑用户的主题偏好，适配深色模式，以保证用户体验的一致性。</p>    <p>ArkWeb提供灵活控制Web组件深色模式的能力，支持独立于系统进行设置。此外，ArkWeb还可以强制不同网页适配深色模式，以兼容不同的系统主题。</p>    <div class="tiledSection">     <h2 id="网页深色模式适配">网页深色模式适配<i class="anchor-icon anchor-icon-link" anchorid="网页深色模式适配" tips="复制节点链接"></i></h2>          <p>在网页开发过程中，可以使用color-scheme和prefers-color-scheme属性进行深色模式适配。</p>     <ul>      <li>       <p>color-scheme是一个CSS属性，用于表示网页支持的配色方案，可以影响表单、滚动条和CSS系统颜色。CSS系统颜色指Web组件内置的颜色，是部分元素未定义样式时应用的默认颜色。</p>       <p>当声明支持深色配色方案时，Web组件可以将网页内的表单、滚动条以及使用CSS系统颜色的元素切换为深色样式。如果元素自定义了颜色样式，则不受color-scheme的影响，保持自定义的颜色样式。</p>       <p>color-scheme未设置时，默认为normal，表示未指定配色方案，使用Web组件的默认配色方案，表现与light一致。使用样例如下：</p>       <div _ngcontent-wrm-c106="" class="highlight-div"><div _ngcontent-wrm-c106="" class="highlight-div-header"><div _ngcontent-wrm-c106="" class="highlight-div-header-left"><div _ngcontent-wrm-c106="" class="handle-button expand-button"><div _ngcontent-wrm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wrm-c106="" class="highlight-div-header-right"><div _ngcontent-wrm-c106="" class="handle-button ai-button"></div><div _ngcontent-wrm-c106="" class="handle-button line-button"><div _ngcontent-wrm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wrm-c106="" class="handle-button theme-button"><div _ngcontent-wrm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wrm-c106="" class="handle-button copy-button"><div _ngcontent-wrm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wrm-c106="" class="highlight-scroll-div"><pre class="html prettyprint linenums hljs language-xml" hw-language="html" data-highlighted="yes"><ol class="linenums"><li>/* 使用方式1：使用meta标签全局设置 */</li><li><span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"color-scheme"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"light"</span>&gt;</span> /* 只支持浅色模式 */</li><li>
</li><li>/* 使用方式2：使用style全局设置 */</li><li>:root {</li><li>  color-scheme: light dark; /* 支持浅色和深色模式，跟随系统切换 */</li><li>}</li><li>
</li><li>/* 使用方式3：使用style针对特定元素设置 */</li><li>div {</li><li>  color-scheme: light; /* 只支持浅色模式 */</li><li>}</li></ol></pre></div></div>       <p>例如，color-scheme.html页面在Web深色模式关闭和开启时的渲染效果如下图所示。关闭深色模式，网页采用浅色配色方案，input2应用自定义背景样式。开启深色模式，网页采用深色配色方案，input2保持自定义样式，而网页背景、字体、表单、进度条及按钮的颜色均自动切换为深色配色。</p>       <div _ngcontent-wrm-c106="" class="highlight-div"><div _ngcontent-wrm-c106="" class="highlight-div-header"><div _ngcontent-wrm-c106="" class="highlight-div-header-left"><div _ngcontent-wrm-c106="" class="handle-button expand-button"><div _ngcontent-wrm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wrm-c106="" class="highlight-div-header-right"><div _ngcontent-wrm-c106="" class="handle-button ai-button"></div><div _ngcontent-wrm-c106="" class="handle-button line-button"><div _ngcontent-wrm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wrm-c106="" class="handle-button theme-button"><div _ngcontent-wrm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wrm-c106="" class="handle-button copy-button"><div _ngcontent-wrm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wrm-c106="" class="highlight-scroll-div"><pre class="html prettyprint linenums hljs language-xml" hw-language="html" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">&lt;!-- color-scheme.html --&gt;</span></li><li><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span></li><li><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span></li><li><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span></li><li>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"</span>&gt;</span></li><li>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"color-scheme"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"light dark"</span>&gt;</span></li><li><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span></li><li><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span></li><li>  <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Example page<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span></li><li>  <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"input1"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"please enter text"</span>&gt;</span></li><li>  <span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span></li><li>  <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"input2"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"please enter text"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"background-color: Lightgray;"</span>&gt;</span></li><li>  <span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span></li><li>  <span class="hljs-tag">&lt;<span class="hljs-name">progress</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"50"</span> <span class="hljs-attr">max</span>=<span class="hljs-string">"100"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">progress</span>&gt;</span></li><li>  <span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span></li><li>  <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"checkbox"</span>&gt;</span></li><li>  <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"checkbox"</span> <span class="hljs-attr">checked</span>&gt;</span></li><li>  <span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span></li><li>  <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>submit<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></li><li><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></li><li><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></li></ol></pre></div></div>       <p><strong>图1</strong> color-scheme效果图</p>       <p><span><img originheight="410" originwidth="724" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114733.63543469519580327796434099289721:50001231000000:2800:670FD457903F7C677DB814DA0258662FAB12A4B772034562A1F196D57A15A2C2.png" width="724" height="410"></span></p></li>      <li>       <p>prefers-color-scheme是CSS中的一个媒体查询功能，可以检测系统的主题颜色。网页开发者可以通过该特性，为不同的系统主题颜色定义不同的网页CSS样式，以适应用户的主题偏好。使用样例如下：</p>       <div _ngcontent-wrm-c106="" class="highlight-div"><div _ngcontent-wrm-c106="" class="highlight-div-header"><div _ngcontent-wrm-c106="" class="highlight-div-header-left"><div _ngcontent-wrm-c106="" class="handle-button expand-button"><div _ngcontent-wrm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wrm-c106="" class="highlight-div-header-right"><div _ngcontent-wrm-c106="" class="handle-button ai-button"></div><div _ngcontent-wrm-c106="" class="handle-button line-button"><div _ngcontent-wrm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wrm-c106="" class="handle-button theme-button"><div _ngcontent-wrm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wrm-c106="" class="handle-button copy-button"><div _ngcontent-wrm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wrm-c106="" class="highlight-scroll-div"><pre class="html prettyprint linenums hljs language-xml" hw-language="html" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="language-css"></span></li><li><span class="language-css">  <span class="hljs-comment">/* 默认样式 */</span></span></li><li><span class="language-css">  <span class="hljs-selector-tag">body</span> { <span class="hljs-attribute">background-color</span>: White; }</span></li><li><span class="language-css"></span></li><li><span class="language-css">  <span class="hljs-comment">/* 浅色样式，Web关闭深色模式时覆盖默认样式 */</span></span></li><li><span class="language-css">  <span class="hljs-keyword">@media</span> (<span class="hljs-attribute">prefers-color-scheme</span>: light) {</span></li><li><span class="language-css">    <span class="hljs-selector-tag">body</span> { <span class="hljs-attribute">background-color</span>: Gray; }</span></li><li><span class="language-css">  }</span></li><li><span class="language-css"></span></li><li><span class="language-css">  <span class="hljs-comment">/* 深色样式，Web开启深色模式时覆盖默认样式 */</span></span></li><li><span class="language-css">  <span class="hljs-keyword">@media</span> (<span class="hljs-attribute">prefers-color-scheme</span>: dark) {</span></li><li><span class="language-css">    <span class="hljs-selector-tag">body</span> { <span class="hljs-attribute">background-color</span>: Black; }</span></li><li><span class="language-css">  }</span></li><li><span class="language-css"></span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span></li></ol></pre></div></div>       <p>color-scheme可声明网页配色方案，切换网页元素的默认样式。然而，其作用范围有限，使用prefers-color-scheme可以更灵活地定义网页深色模式。prefers-color-scheme可以结合color-scheme使用。</p>       <p>例如，在color-scheme.html中增加以下样式定义。当Web深色模式开启时，网页将应用深色配色，并应用@media (prefers-color-scheme: dark)中定义的样式，渲染效果如图2所示。</p>       <div _ngcontent-wrm-c106="" class="highlight-div"><div _ngcontent-wrm-c106="" class="highlight-div-header"><div _ngcontent-wrm-c106="" class="highlight-div-header-left"><div _ngcontent-wrm-c106="" class="handle-button expand-button"><div _ngcontent-wrm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wrm-c106="" class="highlight-div-header-right"><div _ngcontent-wrm-c106="" class="handle-button ai-button"></div><div _ngcontent-wrm-c106="" class="handle-button line-button"><div _ngcontent-wrm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wrm-c106="" class="handle-button theme-button"><div _ngcontent-wrm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wrm-c106="" class="handle-button copy-button"><div _ngcontent-wrm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wrm-c106="" class="highlight-scroll-div"><pre class="html prettyprint linenums hljs language-xml" hw-language="html" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="language-css"></span></li><li><span class="language-css">  <span class="hljs-keyword">@media</span> (<span class="hljs-attribute">prefers-color-scheme</span>: dark) {</span></li><li><span class="language-css">    <span class="hljs-selector-tag">body</span> { <span class="hljs-attribute">background-color</span>: Gray; <span class="hljs-attribute">color</span>: LightYellow; }</span></li><li><span class="language-css">    <span class="hljs-selector-tag">input</span> { <span class="hljs-attribute">background-color</span>: Lightgray; }</span></li><li><span class="language-css">  }</span></li><li><span class="language-css"></span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span></li></ol></pre></div></div>       <p><strong>图2</strong> prefers-color-scheme效果图</p>       <p><span><img originheight="300" originwidth="304" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114734.04464335977004668422656499294895:50001231000000:2800:4115700ADA3DA80055DD91519119EBF3ECB5CF077738A357673806D076E2DDF9.png" width="304" height="300"></span></p></li>     </ul>    </div>    <div class="tiledSection">     <h2 id="web深色模式设置">Web深色模式设置<i class="anchor-icon anchor-icon-link" anchorid="web深色模式设置" tips="复制节点链接"></i></h2>          <p>通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-basic-components-web-attributes#darkmode9" target="_blank">darkMode()</a>接口可以配置Web深色模式，默认状态为关闭。应用可设置<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-basic-components-web-e#webdarkmode9" target="_blank">WebDarkMode.Auto</a>，表示Web深色模式跟随系统设置。也可以手动设置<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-basic-components-web-e#webdarkmode9" target="_blank">WebDarkMode.On</a>或<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-basic-components-web-e#webdarkmode9" target="_blank">WebDarkMode.Off</a>来控制深色模式的开启与关闭。</p>     <p>设置<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-basic-components-web-e#webdarkmode9" target="_blank">WebDarkMode.On</a>，或设置<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-basic-components-web-e#webdarkmode9" target="_blank">WebDarkMode.Auto</a>并启用系统深色模式时，Web将进入深色模式。在深色模式下，Web会应用媒体查询@media(prefers-color-scheme: dark)中定义的深色样式。如果网页未定义深色样式，则保持原有样式。</p>     <p>若要使未适配深色模式的网页强制转换为深色样式，可以使用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-basic-components-web-attributes#forcedarkaccess9" target="_blank">forceDarkAccess()</a>接口开启强制深色模式。强制深色模式可以覆盖网页默认样式，转换网页背景和文字的颜色，以适应在深色模式下显示。强制深色模式无法保证所有颜色转换符合预期。</p>     <p>在强制深色模式下，高亮度色值将被转换为适合低光环境的色值，低亮度色值则保持不变。具体色值转换算法沿用Chromium内核标准，随Chromium内核的更新迭代。色值转换只针对不支持深色配色方案的元素。如果网页全局声明支持深色配色方案，则整个网页的色值均不会被Web转换。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>若在@media(prefers-color-scheme: dark)中定义了元素的深色样式但未通过color-scheme声明支持深色配色方案，Web会在该深色样式的色值基础上进行转换，如表1所示。</p>      </div></div></div>     <p><strong>表1</strong> 深色模式/强制深色模式/color-scheme三者关系</p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.4.8.1.5.1.1" valign="top" width="25%">深色模式</th>         <th align="left" class="cellrowborder" id="mcps1.3.4.8.1.5.1.2" valign="top" width="25%">强制深色模式</th>         <th align="left" class="cellrowborder" id="mcps1.3.4.8.1.5.1.3" valign="top" width="25%">color-scheme</th>         <th align="left" class="cellrowborder" id="mcps1.3.4.8.1.5.1.4" valign="top" width="25%">预期结果</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="25%">关闭</td>         <td class="cellrowborder" valign="top" width="25%">无影响</td>         <td class="cellrowborder" valign="top" width="25%">-</td>         <td class="cellrowborder" valign="top" width="25%">网页采用color-scheme支持的配色方案。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="25%">开启</td>         <td class="cellrowborder" valign="top" width="25%">关闭</td>         <td class="cellrowborder" valign="top" width="25%">-</td>         <td class="cellrowborder" valign="top" width="25%">网页采用color-scheme支持的配色方案，并应用@media(prefers-color-scheme: dark)中定义的样式。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="25%">开启</td>         <td class="cellrowborder" valign="top" width="25%">开启</td>         <td class="cellrowborder" valign="top" width="25%">支持深色</td>         <td class="cellrowborder" valign="top" width="25%">网页采用深色配色方案，并应用@media(prefers-color-scheme: dark)中定义的样式。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="25%">开启</td>         <td class="cellrowborder" valign="top" width="25%">开启</td>         <td class="cellrowborder" valign="top" width="25%">不支持深色</td>         <td class="cellrowborder" valign="top" width="25%">根据算法转换网页高亮元素色值。若网页在@media(prefers-color-scheme: dark)中定义了样式，则会在该样式色值上进行转换。</td>        </tr>             </tbody></table></div>     </div>     <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-basic-components-web-attributes#forcedarkaccess9" target="_blank">forceDarkAccess()</a>接口仅在Web深色模式开启时生效。在下面的示例中，应用设置Web深色模式跟随系统。系统开启深色模式时，Web进入强制深色模式。</p>     <div _ngcontent-wrm-c106="" class="highlight-div"><div _ngcontent-wrm-c106="" class="highlight-div-header"><div _ngcontent-wrm-c106="" class="highlight-div-header-left"><div _ngcontent-wrm-c106="" class="handle-button expand-button"><div _ngcontent-wrm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wrm-c106="" class="highlight-div-header-right"><div _ngcontent-wrm-c106="" class="handle-button ai-button"></div><div _ngcontent-wrm-c106="" class="handle-button line-button"><div _ngcontent-wrm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wrm-c106="" class="handle-button theme-button"><div _ngcontent-wrm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wrm-c106="" class="handle-button copy-button"><div _ngcontent-wrm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wrm-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// xxx.ets</span></li><li><span class="hljs-keyword">import</span> { webview } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkWeb'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">WebComponent</span> {</li><li>  <span class="hljs-attr">controller</span>: webview.<span class="hljs-property">WebviewController</span> = <span class="hljs-keyword">new</span> webview.<span class="hljs-title class_">WebviewController</span>();</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">mode</span>: <span class="hljs-title class_">WebDarkMode</span> = <span class="hljs-title class_">WebDarkMode</span>.<span class="hljs-property">Auto</span>;</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">access</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">true</span>;</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Web</span>({ <span class="hljs-attr">src</span>: $rawfile(<span class="hljs-string">'index.html'</span>), <span class="hljs-attr">controller</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span> })</li><li>        .<span class="hljs-title function_">darkMode</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">mode</span>)</li><li>        .<span class="hljs-title function_">forceDarkAccess</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">access</span>)</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>     <p>index.html页面代码如下：</p>     <div _ngcontent-wrm-c106="" class="highlight-div"><div _ngcontent-wrm-c106="" class="highlight-div-header"><div _ngcontent-wrm-c106="" class="highlight-div-header-left"><div _ngcontent-wrm-c106="" class="handle-button expand-button"><div _ngcontent-wrm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wrm-c106="" class="highlight-div-header-right"><div _ngcontent-wrm-c106="" class="handle-button ai-button"></div><div _ngcontent-wrm-c106="" class="handle-button line-button"><div _ngcontent-wrm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wrm-c106="" class="handle-button theme-button"><div _ngcontent-wrm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wrm-c106="" class="handle-button copy-button"><div _ngcontent-wrm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wrm-c106="" class="highlight-scroll-div"><pre class="html prettyprint linenums hljs language-xml" hw-language="html" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">&lt;!-- index.html --&gt;</span></li><li><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span></li><li><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span></li><li><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span></li><li>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"</span>&gt;</span></li><li>    <span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/css"</span>&gt;</span><span class="language-css"></span></li><li><span class="language-css">        <span class="hljs-selector-tag">body</span> { <span class="hljs-attribute">background</span>: LightBlue; <span class="hljs-attribute">color</span>: Black; }</span></li><li><span class="language-css">        <span class="hljs-keyword">@media</span> (<span class="hljs-attribute">prefers-color-scheme</span>: dark) {</span></li><li><span class="language-css">            <span class="hljs-selector-tag">body</span> { <span class="hljs-attribute">background</span>: LightGray; <span class="hljs-attribute">color</span>: Brown; }</span></li><li><span class="language-css">        }</span></li><li><span class="language-css">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span></li><li><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span></li><li><span class="hljs-tag">&lt;<span class="hljs-name">body</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"contentCss"</span>&gt;</span></li><li>  <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Dark mode debug page<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></li><li>  <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"input1"</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"please enter text"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"color-scheme: light dark;"</span>&gt;</span></li><li>  <span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span></li><li>  <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"input2"</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"please enter text"</span>&gt;</span></li><li><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></li><li><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></li></ol></pre></div></div>     <p>index.html页面在深色模式关闭、深色模式开启及强制深色模式开启时的样式如图3所示。关闭深色模式，网页采用默认样式。开启深色模式，input1的配色方案切换为深色，网页应用@media(prefers-color-scheme: dark)中定义的灰色背景、棕色文字样式。开启强制深色模式，input1的配色方案为深色，未被Web转换，而网页背景色、文字颜色及input2背景色均依据(2)中色值转换为(3)所示。</p>     <p><strong>图3</strong> Web深色模式和强制深色模式效果图</p>     <p><span><img originheight="409" originwidth="1027" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114734.50519914228680233942844967258356:50001231000000:2800:A92C383D08386447D76B21287850E3F93D216BA4C158FE0032D5E58BC56D5DDA.png" width="920" height="366.38753651411884"></span></p>    </div>    <div class="tiledSection">     <h2 id="web组件背景色适配">Web组件背景色适配<i class="anchor-icon anchor-icon-link" anchorid="web组件背景色适配" tips="复制节点链接"></i></h2>          <p>Web组件发生旋转或大小改变等事件时，Web网页尺寸改变，变化过程中可能会漏出Web组件的背景色。深色模式下，建议将Web组件背景色置为黑色，与网页背景保持一致，以提升用户体验。</p>     <p>Web组件背景色可通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-universal-attributes-background#backgroundcolor" target="_blank">backgroundColor()</a>设置。未设置背景色时，Web组件默认背景色为白色。仅当强制深色模式下，默认背景色变为黑色。未开启强制深色模式时，可通过以下方法进行适配。</p>     <ul>      <li>       <p>应用侧设置<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-basic-components-web-e#webdarkmode9" target="_blank">WebDarkMode.On</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-basic-components-web-e#webdarkmode9" target="_blank">WebDarkMode.Off</a>控制深色模式开启和关闭时，背景色跟随深色模式开启和关闭状态改变。</p>       <div _ngcontent-wrm-c106="" class="highlight-div"><div _ngcontent-wrm-c106="" class="highlight-div-header"><div _ngcontent-wrm-c106="" class="highlight-div-header-left"><div _ngcontent-wrm-c106="" class="handle-button expand-button"><div _ngcontent-wrm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wrm-c106="" class="highlight-div-header-right"><div _ngcontent-wrm-c106="" class="handle-button ai-button"></div><div _ngcontent-wrm-c106="" class="handle-button line-button"><div _ngcontent-wrm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wrm-c106="" class="handle-button theme-button"><div _ngcontent-wrm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wrm-c106="" class="handle-button copy-button"><div _ngcontent-wrm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wrm-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// xxx.ets</span></li><li><span class="hljs-keyword">import</span> { webview } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkWeb'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">WebComponent</span> {</li><li>  <span class="hljs-attr">controller</span>: webview.<span class="hljs-property">WebviewController</span> = <span class="hljs-keyword">new</span> webview.<span class="hljs-title class_">WebviewController</span>();</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">isDark</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">false</span>;</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Web</span>({ <span class="hljs-attr">src</span>: $rawfile(<span class="hljs-string">'index.html'</span>), <span class="hljs-attr">controller</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span> })</li><li>        .<span class="hljs-title function_">darkMode</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">isDark</span> ? <span class="hljs-title class_">WebDarkMode</span>.<span class="hljs-property">On</span> : <span class="hljs-title class_">WebDarkMode</span>.<span class="hljs-property">Off</span>)</li><li>        .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">isDark</span> ? <span class="hljs-title class_">Color</span>.<span class="hljs-property">Black</span> : <span class="hljs-title class_">Color</span>.<span class="hljs-property">White</span>)</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div></li>      <li>       <p>应用侧设置<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-basic-components-web-e#webdarkmode9" target="_blank">WebDarkMode.Auto</a>跟随系统深色模式时，监听系统设置，背景色跟随系统改变。</p>       <div _ngcontent-wrm-c106="" class="highlight-div"><div _ngcontent-wrm-c106="" class="highlight-div-header"><div _ngcontent-wrm-c106="" class="highlight-div-header-left"><div _ngcontent-wrm-c106="" class="handle-button expand-button"><div _ngcontent-wrm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wrm-c106="" class="highlight-div-header-right"><div _ngcontent-wrm-c106="" class="handle-button ai-button"></div><div _ngcontent-wrm-c106="" class="handle-button line-button"><div _ngcontent-wrm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wrm-c106="" class="handle-button theme-button"><div _ngcontent-wrm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wrm-c106="" class="handle-button copy-button"><div _ngcontent-wrm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wrm-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// EntryAbility.ets</span></li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onCreate</span>(<span class="hljs-attr">want</span>: <span class="hljs-title class_">Want</span>, <span class="hljs-attr">launchParam</span>: <span class="hljs-title class_">AbilityConstant</span>.<span class="hljs-property">LaunchParam</span>): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-comment">// 将当前colorMode放在AppStorage中</span></li><li>    <span class="hljs-title class_">AppStorage</span>.<span class="hljs-property">setOrCreate</span>&lt;<span class="hljs-title class_">ConfigurationConstant</span>.<span class="hljs-property">ColorMode</span>&gt;(<span class="hljs-string">'currentColorMode'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-property">config</span>.<span class="hljs-property">colorMode</span>);</li><li>    hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">'%{public}s'</span>, <span class="hljs-string">'Ability onCreate'</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-comment">// ...</span></li><li>
</li><li>  <span class="hljs-title function_">onConfigurationUpdate</span>(<span class="hljs-attr">newConfig</span>: <span class="hljs-title class_">Configuration</span>): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-comment">// 动态更新深浅色状态</span></li><li>    <span class="hljs-keyword">const</span> <span class="hljs-attr">currentColorMode</span>: <span class="hljs-title class_">ConfigurationConstant</span>.<span class="hljs-property">ColorMode</span> | <span class="hljs-literal">undefined</span> = <span class="hljs-title class_">AppStorage</span>.<span class="hljs-title function_">get</span>(<span class="hljs-string">'currentColorMode'</span>);</li><li>    <span class="hljs-keyword">if</span> (currentColorMode !== newConfig.<span class="hljs-property">colorMode</span>) {</li><li>      <span class="hljs-title class_">AppStorage</span>.<span class="hljs-property">setOrCreate</span>&lt;<span class="hljs-title class_">ConfigurationConstant</span>.<span class="hljs-property">ColorMode</span>&gt;(<span class="hljs-string">'currentColorMode'</span>, newConfig.<span class="hljs-property">colorMode</span>);</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>       <div _ngcontent-wrm-c106="" class="highlight-div"><div _ngcontent-wrm-c106="" class="highlight-div-header"><div _ngcontent-wrm-c106="" class="highlight-div-header-left"><div _ngcontent-wrm-c106="" class="handle-button expand-button"><div _ngcontent-wrm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wrm-c106="" class="highlight-div-header-right"><div _ngcontent-wrm-c106="" class="handle-button ai-button"></div><div _ngcontent-wrm-c106="" class="handle-button line-button"><div _ngcontent-wrm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wrm-c106="" class="handle-button theme-button"><div _ngcontent-wrm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wrm-c106="" class="handle-button copy-button"><div _ngcontent-wrm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wrm-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// xxx.ets</span></li><li><span class="hljs-keyword">import</span> { webview } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkWeb'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">ConfigurationConstant</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">WebComponent</span> {</li><li>  <span class="hljs-attr">controller</span>: webview.<span class="hljs-property">WebviewController</span> = <span class="hljs-keyword">new</span> webview.<span class="hljs-title class_">WebviewController</span>();</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">bgColor</span>: <span class="hljs-title class_">Color</span> = <span class="hljs-title class_">Color</span>.<span class="hljs-property">White</span>;</li><li>  <span class="hljs-meta">@StorageProp</span>(<span class="hljs-string">'currentColorMode'</span>) <span class="hljs-meta">@Watch</span>(<span class="hljs-string">'onCurrentColorModeChange'</span>)</li><li>  <span class="hljs-attr">currentColorMode</span>: <span class="hljs-title class_">ConfigurationConstant</span>.<span class="hljs-property">ColorMode</span> = <span class="hljs-title class_">ConfigurationConstant</span>.<span class="hljs-property">ColorMode</span>.<span class="hljs-property">COLOR_MODE_NOT_SET</span>;</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Web</span>({ <span class="hljs-attr">src</span>: $rawfile(<span class="hljs-string">'index.html'</span>), <span class="hljs-attr">controller</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span> })</li><li>        .<span class="hljs-title function_">darkMode</span>(<span class="hljs-title class_">WebDarkMode</span>.<span class="hljs-property">Auto</span>)</li><li>        .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">bgColor</span>)</li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">onCurrentColorModeChange</span>(): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-comment">// 根据系统设置切换背景色</span></li><li>    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">currentColorMode</span> === <span class="hljs-title class_">ConfigurationConstant</span>.<span class="hljs-property">ColorMode</span>.<span class="hljs-property">COLOR_MODE_DARK</span>) {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">bgColor</span> = <span class="hljs-title class_">Color</span>.<span class="hljs-property">Black</span>;</li><li>    } <span class="hljs-keyword">else</span> {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">bgColor</span> = <span class="hljs-title class_">Color</span>.<span class="hljs-property">White</span>;</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div></li>     </ul>    </div>    <div class="tiledSection">     <h2 id="常见问题">常见问题<i class="anchor-icon anchor-icon-link" anchorid="常见问题" tips="复制节点链接"></i></h2>         </div>    <div class="tiledSection">     <h3 id="网页未切换为深色样式" class="firsth2">网页未切换为深色样式<i class="anchor-icon anchor-icon-link" anchorid="网页未切换为深色样式" tips="复制节点链接"></i></h3>          <p><strong>问题现象</strong></p>     <p>网页未切换为深色样式。</p>     <p><strong>解决措施</strong></p>     <p>网页未切换为深色样式的原因有多种，可以按以下步骤排查：</p>     <ol>      <li>       <p>检查Web是否开启深色模式。Web深色模式接口<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-basic-components-web-attributes#darkmode9" target="_blank">darkMode()</a>默认状态为关闭，需显式声明为<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-basic-components-web-e#webdarkmode9" target="_blank">WebDarkMode.On</a>或<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-basic-components-web-e#webdarkmode9" target="_blank">WebDarkMode.Auto</a>，才能开启深色模式。</p></li>      <li>       <p>Web已开启深色模式时，检查网页是否定义深色样式。网页的深色样式需要网页开发者适配。如果未定义深色样式，即使Web开启深色模式，网页样式也会保持不变。若需强制适配，可以使用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-basic-components-web-attributes#forcedarkaccess9" target="_blank">forceDarkAccess()</a>接口开启强制深色模式。</p></li>      <li>       <p>Web已开启强制深色模式时，检查网页是否声明支持深色配色方案。通过color-scheme声明支持深色配色方案的网页，在强制深色模式下色值不会被Web转换。同时，如果网页内元素自定义了颜色样式，则不会被color-scheme影响。因此表现为网页样式未切换为深色样式。此时，需要网页开发者进行适配修改。</p></li>     </ol>    </div>    <div class="tiledSection">     <h3 id="强制深色模式开启后网页样式异常">强制深色模式开启后，网页样式异常<i class="anchor-icon anchor-icon-link" anchorid="强制深色模式开启后网页样式异常" tips="复制节点链接"></i></h3>          <p><strong>问题现象</strong></p>     <p>强制深色模式开启，网页样式转换显示异常，例如字体显示不清、样式不美观或颜色转换不当等。</p>     <p><strong>解决措施</strong></p>     <p>强制深色模式下，Web使用Chromium色值转换算法自动调整元素颜色样式。不同网页的布局和样式写法各异，算法无法确保所有转换均符合预期。建议网页开发者自定义深色样式。</p>    </div>    <div class="tiledSection">     <h3 id="未开启深色模式但web网页背景变深">未开启深色模式，但Web网页背景变深<i class="anchor-icon anchor-icon-link" anchorid="未开启深色模式但web网页背景变深" tips="复制节点链接"></i></h3>          <p><strong>问题现象</strong></p>     <p>Web组件未开启深色模式，但Web网页背景变深。</p>     <p><strong>解决措施</strong></p>     <p>Web网页未设置背景颜色，或者设置背景颜色透明时，会呈现Web组件的背景颜色。因此出现该问题时，可排查Web组件是否设置了深色的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-universal-attributes-background#backgroundcolor" target="_blank">backgroundColor()</a>。</p>    </div>   </div>   <div></div></div>