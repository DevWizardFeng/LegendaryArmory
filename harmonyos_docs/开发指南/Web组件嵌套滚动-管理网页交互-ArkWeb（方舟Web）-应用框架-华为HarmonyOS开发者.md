<h1 _ngcontent-tdn-c119="" class="doc-title ng-star-inserted" title="Web组件嵌套滚动"> Web组件嵌套滚动 </h1>

<div _ngcontent-tdn-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p>Web组件嵌套滚动的典型应用场景为，在页面中，多个独立区域需进行滚动，当用户滚动Web区域内容时，可联动其他滚动区域，实现上下左右全方位滑动页面的嵌套滚动体验。内嵌于可滚动容器（<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-grid" target="_blank">Grid</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-list" target="_blank">List</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-scroll" target="_blank">Scroll</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-swiper" target="_blank">Swiper</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-tabs" target="_blank">Tabs</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-waterflow" target="_blank">WaterFlow</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-refresh" target="_blank">Refresh</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-universal-attributes-sheet-transition#bindsheet" target="_blank">bindSheet</a>）中的Web组件，接收到滑动手势事件后，需要设置ArkUI的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-appendix-enums#nestedscrollmode10" target="_blank">NestedScrollMode</a>枚举属性，实现Web组件与ArkUI可滚动容器的嵌套滚动。</p>    <p>Web组件嵌套滚动可通过<a href="/consumer/cn/doc/harmonyos-guides/web-nested-scrolling#使用nestedscroll属性实现嵌套滚动">方案1：使用nestedScroll属性实现嵌套滚动</a>或<a href="/consumer/cn/doc/harmonyos-guides/web-nested-scrolling#滚动偏移量由滚动父组件统一派发">方案2：滚动偏移量由滚动父组件统一派发</a>两个方案实现，方案的选择应取决于应用嵌套滚动的具体业务场景。如果只是简单的Web组件与其他父组件联动滚动建议通过方案1实现；如果应用需要自定义控制Web组件和其他滚动组件滚动，以及一些复杂场景建议使用方案2。</p>    <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">      <p>如果Web组件用到了全量展开的场景（layoutMode为WebLayoutMode.FIT_CONTENT），需要显式指明渲染模式(RenderMode.SYNC_RENDER)，详见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-basic-components-web-attributes#layoutmode11" target="_blank">layoutMode</a>。</p>     </div></div></div>    <div class="tiledSection">     <h2 id="使用nestedscroll属性实现嵌套滚动">使用nestedScroll属性实现嵌套滚动<i class="anchor-icon anchor-icon-link" anchorid="使用nestedscroll属性实现嵌套滚动" tips="复制节点链接"></i></h2>          <p>使用Web组件<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-basic-components-web-attributes#nestedscroll11" target="_blank">nestedScroll</a>属性来设置上下左右四个方向，或者设置向前、向后两个方向的嵌套滚动模式，实现与父组件的滚动联动，同时也允许在过程中动态改变嵌套滚动的模式。</p>     <p><strong>完整代码</strong></p>     <div _ngcontent-tdn-c106="" class="highlight-div"><div _ngcontent-tdn-c106="" class="highlight-div-header"><div _ngcontent-tdn-c106="" class="highlight-div-header-left"><div _ngcontent-tdn-c106="" class="handle-button expand-button"><div _ngcontent-tdn-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-tdn-c106="" class="highlight-div-header-right"><div _ngcontent-tdn-c106="" class="handle-button ai-button"></div><div _ngcontent-tdn-c106="" class="handle-button line-button"><div _ngcontent-tdn-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-tdn-c106="" class="handle-button theme-button"><div _ngcontent-tdn-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-tdn-c106="" class="handle-button copy-button"><div _ngcontent-tdn-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-tdn-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// xxx.ets</span></li><li><span class="hljs-keyword">import</span> { webview } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkWeb'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@ComponentV2</span></li><li>struct <span class="hljs-title class_">NestedScroll</span> {</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">scrollerForScroll</span>: <span class="hljs-title class_">Scroller</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scroller</span>()</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">listScroller</span>: <span class="hljs-title class_">Scroller</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scroller</span>()</li><li>  <span class="hljs-attr">controller</span>: webview.<span class="hljs-property">WebviewController</span> = <span class="hljs-keyword">new</span> webview.<span class="hljs-title class_">WebviewController</span>();</li><li>  <span class="hljs-meta">@Local</span> <span class="hljs-attr">arr</span>: <span class="hljs-title class_">Array</span>&lt;<span class="hljs-built_in">number</span>&gt; = []</li><li>
</li><li>  <span class="hljs-title function_">aboutToAppear</span>(): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++) {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">arr</span>.<span class="hljs-title function_">push</span>(i)</li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Scroll</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">scrollerForScroll</span>) {</li><li>      <span class="hljs-title class_">Column</span>() {</li><li>        <span class="hljs-title class_">Web</span>({ <span class="hljs-attr">src</span>: $rawfile(<span class="hljs-string">"index.html"</span>), <span class="hljs-attr">controller</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span> })</li><li>          .<span class="hljs-title function_">nestedScroll</span>({</li><li>            <span class="hljs-attr">scrollUp</span>: <span class="hljs-title class_">NestedScrollMode</span>.<span class="hljs-property">PARENT_FIRST</span>,<span class="hljs-comment">//向上滚动父组件优先</span></li><li>            <span class="hljs-attr">scrollDown</span>: <span class="hljs-title class_">NestedScrollMode</span>.<span class="hljs-property">SELF_FIRST</span>,<span class="hljs-comment">//向下滚动子组件优先</span></li><li>          }).<span class="hljs-title function_">height</span>(<span class="hljs-string">"100%"</span>)</li><li>        <span class="hljs-title class_">Repeat</span>&lt;<span class="hljs-built_in">number</span>&gt;(<span class="hljs-variable language_">this</span>.<span class="hljs-property">arr</span>)</li><li>          .<span class="hljs-title function_">each</span>(<span class="hljs-function">(<span class="hljs-params">item: RepeatItem&lt;<span class="hljs-built_in">number</span>&gt;</span>) =&gt;</span> {</li><li>            <span class="hljs-title class_">Text</span>(<span class="hljs-string">"Scroll Area"</span>)</li><li>              .<span class="hljs-title function_">width</span>(<span class="hljs-string">"100%"</span>)</li><li>              .<span class="hljs-title function_">height</span>(<span class="hljs-string">"40%"</span>)</li><li>              .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-number">0X330000FF</span>)</li><li>              .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">16</span>)</li><li>              .<span class="hljs-title function_">textAlign</span>(<span class="hljs-title class_">TextAlign</span>.<span class="hljs-property">Center</span>)</li><li>          })</li><li>      }</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>     <p>加载的html文件。</p>     <div _ngcontent-tdn-c106="" class="highlight-div"><div _ngcontent-tdn-c106="" class="highlight-div-header"><div _ngcontent-tdn-c106="" class="highlight-div-header-left"><div _ngcontent-tdn-c106="" class="handle-button expand-button"><div _ngcontent-tdn-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-tdn-c106="" class="highlight-div-header-right"><div _ngcontent-tdn-c106="" class="handle-button ai-button"></div><div _ngcontent-tdn-c106="" class="handle-button line-button"><div _ngcontent-tdn-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-tdn-c106="" class="handle-button theme-button"><div _ngcontent-tdn-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-tdn-c106="" class="handle-button copy-button"><div _ngcontent-tdn-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-tdn-c106="" class="highlight-scroll-div"><pre class="html prettyprint linenums hljs language-xml" hw-language="html" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">&lt;!-- index.html --&gt;</span></li><li><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span></li><li><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span></li><li><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span></li><li>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span></li><li>    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="language-css"></span></li><li><span class="language-css">        <span class="hljs-selector-class">.blue</span> {</span></li><li><span class="language-css">          <span class="hljs-attribute">background-color</span>: lightblue;</span></li><li><span class="language-css">        }</span></li><li><span class="language-css">        <span class="hljs-selector-class">.green</span> {</span></li><li><span class="language-css">          <span class="hljs-attribute">background-color</span>: lightgreen;</span></li><li><span class="language-css">        }</span></li><li><span class="language-css">        <span class="hljs-selector-class">.blue</span>, <span class="hljs-selector-class">.green</span> {</span></li><li><span class="language-css">         <span class="hljs-attribute">font-size</span>:<span class="hljs-number">16px</span>;</span></li><li><span class="language-css">         <span class="hljs-attribute">height</span>:<span class="hljs-number">200px</span>;</span></li><li><span class="language-css">         <span class="hljs-attribute">text-align</span>: center;       <span class="hljs-comment">/* 水平居中 */</span></span></li><li><span class="language-css">         <span class="hljs-attribute">line-height</span>: <span class="hljs-number">200px</span>;       <span class="hljs-comment">/* 垂直居中（值等于容器高度） */</span></span></li><li><span class="language-css">        }</span></li><li><span class="language-css">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span></li><li><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span></li><li><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span></li><li><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"blue"</span> &gt;</span>webArea<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></li><li><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"green"</span>&gt;</span>webArea<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></li><li><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"blue"</span>&gt;</span>webArea<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></li><li><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"green"</span>&gt;</span>webArea<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></li><li><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"blue"</span>&gt;</span>webArea<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></li><li><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"green"</span>&gt;</span>webArea<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></li><li><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"blue"</span>&gt;</span>webArea<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></li><li><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></li><li><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></li></ol></pre></div></div>     <p><span><img originheight="858" originwidth="424" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114722.47170723661165878431241877409621:50001231000000:2800:D24AA7D3390FC67F3C93945E2C66C2650D7B5D6C19F16E17319A369E262471C7.gif" width="424" height="858"></span></p>    </div>    <div class="tiledSection">     <h2 id="滚动偏移量由滚动父组件统一派发">滚动偏移量由滚动父组件统一派发<i class="anchor-icon anchor-icon-link" anchorid="滚动偏移量由滚动父组件统一派发" tips="复制节点链接"></i></h2>          <p><strong>实现思路</strong></p>     <ol>      <li>       <p>手指向上滑动：</p>       <p>(1) 如果Web页面没有滚动到底部，Scroll组件将滚动偏移量派发给Web，Scroll组件自身不滚动。</p>       <p>(2) 如果Web页面滚动至底部，而Scroll组件尚未滚动至底部，则仅Scroll组件自身滚动，不向Web组件和List组件传递滚动位移。</p>       <p>(3) 如果Scroll组件滚动到底部，则滚动偏移量派发给List组件，Scroll组件自身不滚动。</p></li>      <li>       <p>手指向下滑动：</p>       <p>(1) 如果List组件没有滚动到顶部，则Scroll组件将滚动偏移量派发给List组件，Scroll组件自身不滚动。</p>       <p>(2) 当List组件滚动至顶部，而Scroll组件未到达顶部时，Scroll组件将自行滚动，滚动偏移量不会派发给List组件和Web组件。</p>       <p>(3) 如果Scroll组件滚动到顶部，则滚动偏移量派发给Web，Scroll组件自身不滚动。</p></li>     </ol>     <p><strong>关键实现</strong></p>     <ol>      <li>       <p>如何禁用Web组件滚动手势。</p>       <p>(1) 首先调用Web组件滚动控制器方法，设置Web禁用触摸（<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-webview-webviewcontroller#setscrollable12" target="_blank">setScrollable</a>）的滚动。</p>       <div _ngcontent-tdn-c106="" class="highlight-div"><div _ngcontent-tdn-c106="" class="highlight-div-header"><div _ngcontent-tdn-c106="" class="highlight-div-header-left"><div _ngcontent-tdn-c106="" class="handle-button expand-button"><div _ngcontent-tdn-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-tdn-c106="" class="highlight-div-header-right"><div _ngcontent-tdn-c106="" class="handle-button ai-button"></div><div _ngcontent-tdn-c106="" class="handle-button line-button"><div _ngcontent-tdn-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-tdn-c106="" class="handle-button theme-button"><div _ngcontent-tdn-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-tdn-c106="" class="handle-button copy-button"><div _ngcontent-tdn-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-tdn-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-variable language_">this</span>.<span class="hljs-property">webController</span>.<span class="hljs-title function_">setScrollable</span>(<span class="hljs-literal">false</span>, webview.<span class="hljs-property">ScrollType</span>.<span class="hljs-property">EVENT</span>);</li></ol></pre></div></div>       <p>(2) 再使用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-gesture-blocking-enhancement#ongesturerecognizerjudgebegin13" target="_blank">onGestureRecognizerJudgeBegin</a>方法，禁止Web组件自带的滑动手势触发。</p>       <div _ngcontent-tdn-c106="" class="highlight-div"><div _ngcontent-tdn-c106="" class="highlight-div-header"><div _ngcontent-tdn-c106="" class="highlight-div-header-left"><div _ngcontent-tdn-c106="" class="handle-button expand-button"><div _ngcontent-tdn-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-tdn-c106="" class="highlight-div-header-right"><div _ngcontent-tdn-c106="" class="handle-button ai-button"></div><div _ngcontent-tdn-c106="" class="handle-button line-button"><div _ngcontent-tdn-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-tdn-c106="" class="handle-button theme-button"><div _ngcontent-tdn-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-tdn-c106="" class="handle-button copy-button"><div _ngcontent-tdn-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-tdn-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li>.<span class="hljs-title function_">onGestureRecognizerJudgeBegin</span>(<span class="hljs-function">(<span class="hljs-params">event: BaseGestureEvent, current: GestureRecognizer, otherArray&lt;GestureRecognizer&gt;</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (current.<span class="hljs-title function_">isBuiltIn</span>() &amp;&amp; current.<span class="hljs-title function_">getType</span>() == <span class="hljs-title class_">GestureControl</span>.<span class="hljs-property">GestureType</span>.<span class="hljs-property">PAN_GESTURE</span>) {</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-title class_">GestureJudgeResult</span>.<span class="hljs-property">REJECT</span>;</li><li>  }</li><li>  <span class="hljs-keyword">return</span> <span class="hljs-title class_">GestureJudgeResult</span>.<span class="hljs-property">CONTINUE</span>;</li><li>})</li></ol></pre></div></div></li>      <li>       <p>如何禁止<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-list" target="_blank">List</a>组件的手势。</p>       <div _ngcontent-tdn-c106="" class="highlight-div"><div _ngcontent-tdn-c106="" class="highlight-div-header"><div _ngcontent-tdn-c106="" class="highlight-div-header-left"><div _ngcontent-tdn-c106="" class="handle-button expand-button"><div _ngcontent-tdn-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-tdn-c106="" class="highlight-div-header-right"><div _ngcontent-tdn-c106="" class="handle-button ai-button"></div><div _ngcontent-tdn-c106="" class="handle-button line-button"><div _ngcontent-tdn-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-tdn-c106="" class="handle-button theme-button"><div _ngcontent-tdn-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-tdn-c106="" class="handle-button copy-button"><div _ngcontent-tdn-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-tdn-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li>  .<span class="hljs-title function_">enableScrollInteraction</span>(<span class="hljs-literal">false</span>)</li></ol></pre></div></div></li>      <li>       <p>如何检测List组件、Scroll组件是否滚动到边界。</p>       <p>(1) 滚动到上边界：scroller.currentOffset().yOffset &lt;= 0;</p>       <p>(2) 滚动到下边界：scroller.isAtEnd() == true;</p></li>      <li>       <p>如何检测Web组件是否滚动到边界。</p>       <p>(1) 获取Web组件自身高度、内容高度和当前滚动偏移量来判定。</p>       <p>(2) 判断Web组件是否滚动到顶部：webController.getPageOffset().y == 0;</p>       <p>(3) 判断Web组件是否滚动到底部：webController.getPageOffset().y + this.webHeight &gt;= webController.getPageHeight();</p>       <p>(4) 获取Web组件自身高度：webController.<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-webview-webviewcontroller#getpageheight" target="_blank">getPageHeight()</a>;</p>       <p>(5) 获取Web组件窗口高度：webController?.<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-webview-webviewcontroller#runjavascriptext10" target="_blank">runJavaScriptExt</a>('window. innerHeight');</p>       <p>(6) 获取Web组件的滚动偏移量：webController.<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-webview-webviewcontroller#getpageoffset20" target="_blank">getPageOffset()</a>;</p></li>      <li>       <p>如何让Scroll组件不滚动。</p>       <p>Scroll组件绑定<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-scroll#onscrollframebegin9" target="_blank">onScrollFrameBegin</a>事件，将剩余滚动偏移量返回0，scroll组件就不滚动，也不会停止惯性滚动动画。</p></li>      <li>       <p>滚动偏移量如何派发给List。</p>       <div _ngcontent-tdn-c106="" class="highlight-div"><div _ngcontent-tdn-c106="" class="highlight-div-header"><div _ngcontent-tdn-c106="" class="highlight-div-header-left"><div _ngcontent-tdn-c106="" class="handle-button expand-button"><div _ngcontent-tdn-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-tdn-c106="" class="highlight-div-header-right"><div _ngcontent-tdn-c106="" class="handle-button ai-button"></div><div _ngcontent-tdn-c106="" class="handle-button line-button"><div _ngcontent-tdn-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-tdn-c106="" class="handle-button theme-button"><div _ngcontent-tdn-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-tdn-c106="" class="handle-button copy-button"><div _ngcontent-tdn-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-tdn-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li>  <span class="hljs-variable language_">this</span>.<span class="hljs-property">listScroller</span>.<span class="hljs-title function_">scrollBy</span>(<span class="hljs-number">0</span>, offset)</li></ol></pre></div></div></li>      <li>       <p>滚动偏移量如何派发给Web。</p>       <div _ngcontent-tdn-c106="" class="highlight-div"><div _ngcontent-tdn-c106="" class="highlight-div-header"><div _ngcontent-tdn-c106="" class="highlight-div-header-left"><div _ngcontent-tdn-c106="" class="handle-button expand-button"><div _ngcontent-tdn-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-tdn-c106="" class="highlight-div-header-right"><div _ngcontent-tdn-c106="" class="handle-button ai-button"></div><div _ngcontent-tdn-c106="" class="handle-button line-button"><div _ngcontent-tdn-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-tdn-c106="" class="handle-button theme-button"><div _ngcontent-tdn-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-tdn-c106="" class="handle-button copy-button"><div _ngcontent-tdn-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-tdn-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li>  <span class="hljs-variable language_">this</span>.<span class="hljs-property">webController</span>.<span class="hljs-title function_">scrollBy</span>(<span class="hljs-number">0</span>, offset)</li></ol></pre></div></div></li>      <li>       <p>设置Web组件<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-basic-components-web-attributes#bypassvsynccondition20" target="_blank">bypassVsyncCondition</a>为WebBypassVsyncCondition.SCROLLBY_FROM_ZERO_OFFSET，加快Web组件首帧滚动绘制。</p>       <div _ngcontent-tdn-c106="" class="highlight-div"><div _ngcontent-tdn-c106="" class="highlight-div-header"><div _ngcontent-tdn-c106="" class="highlight-div-header-left"><div _ngcontent-tdn-c106="" class="handle-button expand-button"><div _ngcontent-tdn-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-tdn-c106="" class="highlight-div-header-right"><div _ngcontent-tdn-c106="" class="handle-button ai-button"></div><div _ngcontent-tdn-c106="" class="handle-button line-button"><div _ngcontent-tdn-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-tdn-c106="" class="handle-button theme-button"><div _ngcontent-tdn-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-tdn-c106="" class="handle-button copy-button"><div _ngcontent-tdn-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-tdn-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li>  .<span class="hljs-title function_">bypassVsyncCondition</span>(<span class="hljs-title class_">WebBypassVsyncCondition</span>.<span class="hljs-property">SCROLLBY_FROM_ZERO_OFFSET</span>)</li></ol></pre></div></div></li>     </ol>     <p><strong>完整代码</strong></p>     <div _ngcontent-tdn-c106="" class="highlight-div"><div _ngcontent-tdn-c106="" class="highlight-div-header"><div _ngcontent-tdn-c106="" class="highlight-div-header-left"><div _ngcontent-tdn-c106="" class="handle-button expand-button"><div _ngcontent-tdn-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-tdn-c106="" class="highlight-div-header-right"><div _ngcontent-tdn-c106="" class="handle-button ai-button"></div><div _ngcontent-tdn-c106="" class="handle-button line-button"><div _ngcontent-tdn-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-tdn-c106="" class="handle-button theme-button"><div _ngcontent-tdn-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-tdn-c106="" class="handle-button copy-button"><div _ngcontent-tdn-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-tdn-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// xxx.ets</span></li><li><span class="hljs-keyword">import</span> { webview } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkWeb'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@ComponentV2</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">scroller</span>:<span class="hljs-title class_">Scroller</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scroller</span>()</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">listScroller</span>:<span class="hljs-title class_">Scroller</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scroller</span>()</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">webController</span>: webview.<span class="hljs-property">WebviewController</span> = <span class="hljs-keyword">new</span> webview.<span class="hljs-title class_">WebviewController</span>()</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">isWebAtEnd</span>:<span class="hljs-built_in">boolean</span> = <span class="hljs-literal">false</span></li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">webHeight</span>:<span class="hljs-built_in">number</span> = <span class="hljs-number">0</span></li><li>  <span class="hljs-meta">@Local</span> <span class="hljs-attr">arr</span>: <span class="hljs-title class_">Array</span>&lt;<span class="hljs-built_in">number</span>&gt; = []</li><li>
</li><li>  <span class="hljs-title function_">aboutToAppear</span>(): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++) {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">arr</span>.<span class="hljs-title function_">push</span>(i)</li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">getWebHeight</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">webController</span>?.<span class="hljs-title function_">runJavaScriptExt</span>(<span class="hljs-string">'window.innerHeight'</span>,</li><li>        <span class="hljs-function">(<span class="hljs-params">error, result</span>) =&gt;</span> {</li><li>          <span class="hljs-keyword">if</span> (error || !result) {</li><li>            <span class="hljs-keyword">return</span>;</li><li>          }</li><li>          <span class="hljs-keyword">if</span> (result.<span class="hljs-title function_">getType</span>() === webview.<span class="hljs-property">JsMessageType</span>.<span class="hljs-property">NUMBER</span>) {</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">webHeight</span> = result.<span class="hljs-title function_">getNumber</span>()</li><li>          }</li><li>        })</li><li>    } <span class="hljs-keyword">catch</span> (error) {</li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">checkScrollBottom</span>(<span class="hljs-params"></span>) {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">isWebAtEnd</span> = <span class="hljs-literal">false</span>;</li><li>      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">webController</span>.<span class="hljs-title function_">getPageOffset</span>().<span class="hljs-property">y</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">webHeight</span> &gt;= <span class="hljs-variable language_">this</span>.<span class="hljs-property">webController</span>.<span class="hljs-title function_">getPageHeight</span>()) {</li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">isWebAtEnd</span> = <span class="hljs-literal">true</span>;</li><li>      }</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Scroll</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">scroller</span>) {</li><li>      <span class="hljs-title class_">Column</span>() {</li><li>        <span class="hljs-title class_">Web</span>({</li><li>          <span class="hljs-attr">src</span>: $rawfile(<span class="hljs-string">"index.html"</span>),</li><li>          <span class="hljs-attr">controller</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">webController</span>,</li><li>        }).<span class="hljs-title function_">height</span>(<span class="hljs-string">"100%"</span>)</li><li>          .<span class="hljs-title function_">bypassVsyncCondition</span>(<span class="hljs-title class_">WebBypassVsyncCondition</span>.<span class="hljs-property">SCROLLBY_FROM_ZERO_OFFSET</span>)</li><li>          .<span class="hljs-title function_">onPageEnd</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">webController</span>.<span class="hljs-title function_">setScrollable</span>(<span class="hljs-literal">false</span>, webview.<span class="hljs-property">ScrollType</span>.<span class="hljs-property">EVENT</span>);</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getWebHeight</span>();</li><li>          })</li><li>            <span class="hljs-comment">// 在识别器即将要成功时，根据当前组件状态，设置识别器使能状态</span></li><li>          .<span class="hljs-title function_">onGestureRecognizerJudgeBegin</span>(<span class="hljs-function">(<span class="hljs-params">event: BaseGestureEvent, current: GestureRecognizer, others: <span class="hljs-built_in">Array</span>&lt;GestureRecognizer&gt;</span>) =&gt;</span> {</li><li>            <span class="hljs-keyword">if</span> (current.<span class="hljs-title function_">isBuiltIn</span>() &amp;&amp; current.<span class="hljs-title function_">getType</span>() == <span class="hljs-title class_">GestureControl</span>.<span class="hljs-property">GestureType</span>.<span class="hljs-property">PAN_GESTURE</span>) {</li><li>              <span class="hljs-keyword">return</span> <span class="hljs-title class_">GestureJudgeResult</span>.<span class="hljs-property">REJECT</span>;</li><li>            }</li><li>            <span class="hljs-keyword">return</span> <span class="hljs-title class_">GestureJudgeResult</span>.<span class="hljs-property">CONTINUE</span>;</li><li>          })</li><li>        <span class="hljs-title class_">List</span>({ <span class="hljs-attr">scroller</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">listScroller</span> }) {</li><li>          <span class="hljs-title class_">Repeat</span>&lt;<span class="hljs-built_in">number</span>&gt;(<span class="hljs-variable language_">this</span>.<span class="hljs-property">arr</span>)</li><li>            .<span class="hljs-title function_">each</span>(<span class="hljs-function">(<span class="hljs-params">item: RepeatItem&lt;<span class="hljs-built_in">number</span>&gt;</span>) =&gt;</span> {</li><li>              <span class="hljs-title class_">ListItem</span>() {</li><li>                <span class="hljs-title class_">Text</span>(<span class="hljs-string">"Scroll Area"</span>)</li><li>                  .<span class="hljs-title function_">width</span>(<span class="hljs-string">"100%"</span>)</li><li>                  .<span class="hljs-title function_">height</span>(<span class="hljs-string">"40%"</span>)</li><li>                  .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-number">0X330000FF</span>)</li><li>                  .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">16</span>)</li><li>                  .<span class="hljs-title function_">textAlign</span>(<span class="hljs-title class_">TextAlign</span>.<span class="hljs-property">Center</span>)</li><li>              }</li><li>            })</li><li>        }.<span class="hljs-title function_">height</span>(<span class="hljs-string">"100%"</span>)</li><li>        .<span class="hljs-title function_">maintainVisibleContentPosition</span>(<span class="hljs-literal">true</span>)</li><li>        .<span class="hljs-title function_">enableScrollInteraction</span>(<span class="hljs-literal">false</span>)</li><li>      }</li><li>    }</li><li>    .<span class="hljs-title function_">onScrollFrameBegin</span>(<span class="hljs-function">(<span class="hljs-params">offset: <span class="hljs-built_in">number</span>, state: ScrollState</span>)=&gt;</span>{</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">checkScrollBottom</span>();</li><li>      <span class="hljs-keyword">if</span> (offset &gt; <span class="hljs-number">0</span>) {</li><li>        <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">isWebAtEnd</span>) {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">webController</span>.<span class="hljs-title function_">scrollBy</span>(<span class="hljs-number">0</span>, offset)</li><li>          <span class="hljs-keyword">return</span> {<span class="hljs-attr">offsetRemain</span>:<span class="hljs-number">0</span>}</li><li>        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">scroller</span>.<span class="hljs-title function_">isAtEnd</span>()) {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">listScroller</span>.<span class="hljs-title function_">scrollBy</span>(<span class="hljs-number">0</span>, offset)</li><li>          <span class="hljs-keyword">return</span> {<span class="hljs-attr">offsetRemain</span>:<span class="hljs-number">0</span>}</li><li>        }</li><li>      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (offset &lt; <span class="hljs-number">0</span>) {</li><li>        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">listScroller</span>.<span class="hljs-title function_">currentOffset</span>().<span class="hljs-property">yOffset</span> &gt; <span class="hljs-number">0</span>) {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">listScroller</span>.<span class="hljs-title function_">scrollBy</span>(<span class="hljs-number">0</span>, offset)</li><li>          <span class="hljs-keyword">return</span> {<span class="hljs-attr">offsetRemain</span>:<span class="hljs-number">0</span>}</li><li>        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">scroller</span>.<span class="hljs-title function_">currentOffset</span>().<span class="hljs-property">yOffset</span> &lt;= <span class="hljs-number">0</span>) {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">webController</span>.<span class="hljs-title function_">scrollBy</span>(<span class="hljs-number">0</span>, offset)</li><li>          <span class="hljs-keyword">return</span> {<span class="hljs-attr">offsetRemain</span>:<span class="hljs-number">0</span>}</li><li>        }</li><li>      }</li><li>      <span class="hljs-keyword">return</span> {<span class="hljs-attr">offsetRemain</span>:offset}</li><li>    })</li><li>  }</li><li>}</li></ol></pre></div></div>     <p>加载的html文件。</p>     <div _ngcontent-tdn-c106="" class="highlight-div"><div _ngcontent-tdn-c106="" class="highlight-div-header"><div _ngcontent-tdn-c106="" class="highlight-div-header-left"><div _ngcontent-tdn-c106="" class="handle-button expand-button"><div _ngcontent-tdn-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-tdn-c106="" class="highlight-div-header-right"><div _ngcontent-tdn-c106="" class="handle-button ai-button"></div><div _ngcontent-tdn-c106="" class="handle-button line-button"><div _ngcontent-tdn-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-tdn-c106="" class="handle-button theme-button"><div _ngcontent-tdn-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-tdn-c106="" class="handle-button copy-button"><div _ngcontent-tdn-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-tdn-c106="" class="highlight-scroll-div"><pre class="html prettyprint linenums hljs language-xml" hw-language="html" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">&lt;!-- index.html --&gt;</span></li><li><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span></li><li><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span></li><li><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span></li><li>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span></li><li>    <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><span class="language-css"></span></li><li><span class="language-css">        <span class="hljs-selector-class">.blue</span> {</span></li><li><span class="language-css">          <span class="hljs-attribute">background-color</span>: lightblue;</span></li><li><span class="language-css">        }</span></li><li><span class="language-css">        <span class="hljs-selector-class">.green</span> {</span></li><li><span class="language-css">          <span class="hljs-attribute">background-color</span>: lightgreen;</span></li><li><span class="language-css">        }</span></li><li><span class="language-css">        <span class="hljs-selector-class">.blue</span>, <span class="hljs-selector-class">.green</span> {</span></li><li><span class="language-css">         <span class="hljs-attribute">font-size</span>:<span class="hljs-number">16px</span>;</span></li><li><span class="language-css">         <span class="hljs-attribute">height</span>:<span class="hljs-number">200px</span>;</span></li><li><span class="language-css">         <span class="hljs-attribute">text-align</span>: center;       <span class="hljs-comment">/* 水平居中 */</span></span></li><li><span class="language-css">         <span class="hljs-attribute">line-height</span>: <span class="hljs-number">200px</span>;       <span class="hljs-comment">/* 垂直居中（值等于容器高度） */</span></span></li><li><span class="language-css">        }</span></li><li><span class="language-css">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span></li><li><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span></li><li><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span></li><li><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"blue"</span> &gt;</span>webArea<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></li><li><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"green"</span>&gt;</span>webArea<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></li><li><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"blue"</span>&gt;</span>webArea<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></li><li><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"green"</span>&gt;</span>webArea<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></li><li><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"blue"</span>&gt;</span>webArea<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></li><li><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"green"</span>&gt;</span>webArea<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></li><li><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"blue"</span>&gt;</span>webArea<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></li><li><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></li><li><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></li></ol></pre></div></div>     <p><span><img originheight="858" originwidth="424" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114722.77127749742330063880781419073581:50001231000000:2800:2EEBC2D61F461DB5E3366E1AB2505A5A1E7705739CA7DDF9F83C1264A2D854B4.gif" width="424" height="858"></span></p>    </div>    <div class="tiledSection">     <h2 id="示例代码">示例代码<i class="anchor-icon anchor-icon-link" anchorid="示例代码" tips="复制节点链接"></i></h2>          <ul>      <li><a href="https://gitcode.com/harmonyos_samples/web-scroller" target="_blank">Web组件嵌套滑动</a></li>     </ul>    </div>   </div>   <div></div></div>