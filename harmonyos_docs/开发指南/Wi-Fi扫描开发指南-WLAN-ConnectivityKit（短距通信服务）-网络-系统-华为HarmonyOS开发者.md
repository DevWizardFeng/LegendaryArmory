<h1 _ngcontent-weo-c119="" class="doc-title ng-star-inserted" title="Wi-Fi扫描开发指南"> Wi-Fi扫描开发指南 </h1>

<div _ngcontent-weo-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <div class="tiledSection">     <h2 id="简介">简介<i class="anchor-icon anchor-icon-link" anchorid="简介" tips="复制节点链接"></i></h2>          <p>Wi-Fi扫描是指设备（如手机、电脑、路由器等）搜索周围可用Wi-Fi网络的过程。通过扫描，设备可以获取附近网络的基本信息（如网络名称、信号强度、加密方式等），从而实现连接、管理或分析周围网络。</p>    </div>    <div class="tiledSection">     <h2 id="场景介绍">场景介绍<i class="anchor-icon anchor-icon-link" anchorid="场景介绍" tips="复制节点链接"></i></h2>          <ul>      <li><a href="/consumer/cn/doc/harmonyos-guides/scan-development-guide#wi-fi扫描">Wi-Fi扫描</a></li>      <li><a href="/consumer/cn/doc/harmonyos-guides/scan-development-guide#pno扫描">PNO扫描</a></li>      <li><a href="/consumer/cn/doc/harmonyos-guides/scan-development-guide#周期扫描">周期扫描</a></li>      <li><a href="/consumer/cn/doc/harmonyos-guides/scan-development-guide#扫描管控">扫描管控</a></li>     </ul>    </div>    <div class="tiledSection">     <h2 id="接口说明">接口说明<i class="anchor-icon anchor-icon-link" anchorid="接口说明" tips="复制节点链接"></i></h2>          <p>完整的JS API说明以及示例代码请参考：<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-wifimanager" target="_blank">SCAN接口</a>。</p>     <p>接口具体说明如下表所示。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.3.4.1.3.1.1" valign="top" width="50%">接口名</th>         <th align="left" class="cellrowborder" id="mcps1.3.3.4.1.3.1.2" valign="top" width="50%">功能描述</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="50%">getScanInfoList()</td>         <td class="cellrowborder" valign="top" width="50%">获取扫描结果。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">on(type: 'wifiScanStateChange')</td>         <td class="cellrowborder" valign="top" width="50%">注册扫描状态改变事件。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">off(type: 'wifiScanStateChange')</td>         <td class="cellrowborder" valign="top" width="50%">取消注册扫描状态改变事件。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="开发步骤">开发步骤<i class="anchor-icon anchor-icon-link" anchorid="开发步骤" tips="复制节点链接"></i></h2>         </div>    <div class="tiledSection">     <h3 id="wi-fi扫描" class="firsth2">Wi-Fi扫描<i class="anchor-icon anchor-icon-link" anchorid="wi-fi扫描" tips="复制节点链接"></i></h3>          <ol>      <li>导入需要的Wi-Fi模块。</li>      <li>需要SystemCapability.Communication.WiFi.STA系统能力。</li>      <li>需要权限ohos.permission.GET_WIFI_INFO。</li>      <li>开启设备的Wi-Fi。</li>      <li>示例代码：</li>     </ol>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>主动扫描接口，从API version 10开始废弃。替代接口仅向系统应用开放。</p>      </div></div></div>     <div _ngcontent-weo-c106="" class="highlight-div"><div _ngcontent-weo-c106="" class="highlight-div-header"><div _ngcontent-weo-c106="" class="highlight-div-header-left"><div _ngcontent-weo-c106="" class="handle-button expand-button"><div _ngcontent-weo-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-weo-c106="" class="highlight-div-header-right"><div _ngcontent-weo-c106="" class="handle-button ai-button"></div><div _ngcontent-weo-c106="" class="handle-button line-button"><div _ngcontent-weo-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-weo-c106="" class="handle-button theme-button"><div _ngcontent-weo-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-weo-c106="" class="handle-button copy-button"><div _ngcontent-weo-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-weo-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { wifiManager } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ConnectivityKit'</span>;</li><li>
</li><li><span class="hljs-keyword">try</span> {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-title function_">recvWifiScanStateChangeFunc</span> = (<span class="hljs-params">result:<span class="hljs-built_in">number</span></span>) =&gt; {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"Receive Wifi scan state change event: "</span> + result);</li><li>  }</li><li>
</li><li>  <span class="hljs-comment">// 获取扫描状态 0：扫描失败；1：扫描成功。</span></li><li>  wifiManager.<span class="hljs-title function_">on</span>(<span class="hljs-string">"wifiScanStateChange"</span>, recvWifiScanStateChangeFunc);</li><li>
</li><li>  <span class="hljs-keyword">let</span> isWifiActive = wifiManager.<span class="hljs-title function_">isWifiActive</span>();</li><li>  <span class="hljs-keyword">if</span> (!isWifiActive) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"wifi not enable"</span>); <span class="hljs-comment">// 请先手动打开WiFi</span></li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">let</span> scanInfoList = wifiManager.<span class="hljs-title function_">getScanInfoList</span>();</li><li>
</li><li>  <span class="hljs-keyword">let</span> len = scanInfoList.<span class="hljs-property">length</span>;</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"wifi received scan info: "</span> + len);</li><li>  <span class="hljs-keyword">if</span>(len &gt; <span class="hljs-number">0</span>){</li><li>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; len; ++i) {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"ssid: "</span> + scanInfoList[i].<span class="hljs-property">ssid</span>);</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"bssid: "</span> + scanInfoList[i].<span class="hljs-property">bssid</span>);</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"capabilities: "</span> + scanInfoList[i].<span class="hljs-property">capabilities</span>);</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"securityType: "</span> + scanInfoList[i].<span class="hljs-property">securityType</span>);</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"rssi: "</span> + scanInfoList[i].<span class="hljs-property">rssi</span>);</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"band: "</span> + scanInfoList[i].<span class="hljs-property">band</span>);</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"frequency: "</span> + scanInfoList[i].<span class="hljs-property">frequency</span>);</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"channelWidth: "</span> + scanInfoList[i].<span class="hljs-property">channelWidth</span>);</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"timestamp: "</span> + scanInfoList[i].<span class="hljs-property">timestamp</span>);</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"supportedWifiCategory: "</span> + scanInfoList[i].<span class="hljs-property">supportedWifiCategory</span>);</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"isHiLinkNetwork: "</span> + scanInfoList[i].<span class="hljs-property">isHiLinkNetwork</span>);</li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-comment">// 取消注册，停止获取扫描状态。</span></li><li>  wifiManager.<span class="hljs-title function_">off</span>(<span class="hljs-string">"wifiScanStateChange"</span>, recvWifiScanStateChangeFunc);</li><li>} <span class="hljs-keyword">catch</span> (error) {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`WiFi scan fail. <span class="hljs-subst">${error.message}</span>`</span>);</li><li>}</li></ol></pre></div></div>     <ol>      <li>错误码详情请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-wifi" target="_blank">WIFI错误码</a>。</li>     </ol>    </div>    <div class="tiledSection">     <h3 id="pno扫描">PNO扫描<i class="anchor-icon anchor-icon-link" anchorid="pno扫描" tips="复制节点链接"></i></h3>          <p>PNO扫描即首选分流网络扫描（Preferred Network Offload scanning），是一种用于降低移动设备功耗的Wi-Fi扫描技术。</p>     <p>触发PNO扫描条件：当设备未连接Wi-Fi且屏幕关闭后，会触发PNO扫描，支持设备在后台寻找并连接首选的Wi-Fi网络。</p>    </div>    <div class="tiledSection">     <h3 id="周期扫描">周期扫描<i class="anchor-icon anchor-icon-link" anchorid="周期扫描" tips="复制节点链接"></i></h3>          <p>WiFi周期扫描是指无线设备（如智能手机、平板电脑、笔记本电脑等）按照一定的时间间隔，自动搜索周围可用的WiFi网络的过程。</p>     <p>触发场景描述：</p>     <ol>      <li>       <p>设备亮屏且与Wi-Fi已连接：判断当前链路是否支持上网。支持上网，扫描间隔1h；不支持上网，判断是否静止，静止场景下扫描周期从20s开始倍增，最大300s；非静止场景扫描周期从20s开始，最大160s。</p></li>      <li>设备亮屏且与Wi-Fi未连接：静止场景扫描周期从20s开始倍增，最大300s；非静止场景扫描周期从20s开始，最大160s。</li>     </ol>    </div>    <div class="tiledSection">     <h3 id="扫描管控">扫描管控<i class="anchor-icon anchor-icon-link" anchorid="扫描管控" tips="复制节点链接"></i></h3>          <p>WiFi扫描管控是指对无线设备扫描WiFi网络的行为进行管理和控制。</p>     <p>以下是一些常见的管控方式和应用场景：</p>     <ol>      <li>       <p>WiFi在关闭的情况下不触发周期扫描和PNO扫描。</p></li>      <li>       <p>WiFi连接过程中不允许触发扫描。</p></li>      <li>       <p>前台应用2分钟内最多发起4次扫描。</p></li>      <li>       <p>设备温度达到阈值，设备扫描会被管控。</p></li>      <li>       <p>扫描接口从API version 9开始支持，从API version 10开始废弃，替代接口仅向系统应用开放。</p></li>      <li>扫描结果获取真实bssid，需要申请ohos.permission.GET_WIFI_PEERS_MAC权限。</li>     </ol>    </div>   </div>   <div></div></div>