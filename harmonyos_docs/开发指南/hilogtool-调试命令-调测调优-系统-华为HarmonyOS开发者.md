<h1 _ngcontent-dph-c119="" class="doc-title ng-star-inserted" title="hilogtool"> hilogtool </h1>

<div _ngcontent-dph-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div><div class="tiledSection"><h2 id="section138065185380">使用场景<i class="anchor-icon anchor-icon-link" anchorid="section138065185380" tips="复制节点链接"></i></h2><p>当前hilog日志为编码后二进制形式保存的gz格式文件，开发者从设备/data/log/hilog路径下导出后无法直接解压查看，需要使用hilogtool工具进行解析，将转换为明文hilog日志。</p> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p>当前机制下：kmsg日志不受影响，可直接查看；<span style="color: rgb(29,29,26);">hilog</span><span style="color: rgb(29,29,26);">日志，在shell窗口直接使用hilog命令在线查看日志，不受影响</span>。</p> </div></div></div> </div> <div class="tiledSection"><h2 id="section364801454117">使用指导<i class="anchor-icon anchor-icon-link" anchorid="section364801454117" tips="复制节点链接"></i></h2></div> <div class="tiledSection"><h3 id="section1197632813446" class="firsth2">工具获取<i class="anchor-icon anchor-icon-link" anchorid="section1197632813446" tips="复制节点链接"></i></h3><p>下载HarmonyOS SDK，hilogtool解析工具默认在对应平台的 hms/toolchains目录下。</p> </div> <div class="tiledSection"><h3 id="section1892151154515">环境配置<i class="anchor-icon anchor-icon-link" anchorid="section1892151154515" tips="复制节点链接"></i></h3><p><strong>Windows环境变量设置方法</strong></p> <p>在此电脑 &gt; 属性 &gt; 高级系统设置 &gt; 高级 &gt; 环境变量 &gt; Path &gt; 编辑 中，将hilogtool.exe所在路径添加到 Path，环境变量配置完成后，请重启电脑，即可在cmd 窗口执行hilogtool命令。</p> <p></p> <p><strong>MacOS环境变量设置方法</strong></p> <p>1）打开终端工具，执行以下命令，根据输出结果分别执行不同命令。</p> <p><span style="color: rgb(111,121,169);">        echo</span> <span style="color: rgb(73,179,172);">$SHELL</span></p> <p>        a. 如果输出结果为/bin/bash，则执行以下命令，打开.bash_profile文件。</p> <p><span style="color: rgb(40,113,204);">                vi</span> ~/<span style="color: rgb(230,154,58);">.bash_profile</span></p> <p>        b. 如果输出结果为/bin/zsh，则执行以下命令，打开.zshrc文件。</p> <p><span style="color: rgb(40,113,204);">                vi</span> ~/<span style="color: rgb(230,154,58);">.zshrc</span></p> <p>2) 单击字母“i”，进入Insert模式。</p> <p>3) 输入以下内容，添加PATH信息。</p> <p>export PATH=$PATH:/path/to/your/hilogtool</p> <p>4) 编辑完成后，单击Esc键，退出编辑模式，然后输入“:wq”，单击Enter键保存。</p> <p>5) 执行以下命令，使配置的环境变量生效。</p> <p>        a. 如果步骤a时打开的是.bash_profile文件，请执行如下命令：</p> <p><span style="color: rgb(111,121,169);">                source</span> ~/.bash_profile</p> <p>        b. 如果步骤a时打开的是.zshrc文件，请执行如下命令：</p> <p><span style="color: rgb(111,121,169);">                source</span> ~/.zshrc</p> <p>6) 环境变量配置完成后，重启电脑。</p> </div> <div class="tiledSection"><h3 id="section474818417500">使用方法<i class="anchor-icon anchor-icon-link" anchorid="section474818417500" tips="复制节点链接"></i></h3><p><strong>命令：</strong></p> <p>hilogtool parse -i xxx -o xxx -d xxx</p> <p>hilogtool parse --input xxx --output xxx --dict xxx</p> <p></p> <p><strong>解析命令参数列表：</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.5.7.1.4.1.1" valign="top" width="15.58%"><p>选项</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.5.7.1.4.1.2" valign="top" width="37.26%"><p>描述</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.5.7.1.4.1.3" valign="top" width="47.160000000000004%"><p>举例</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="15.58%"><p>-h/--help</p> </td> <td class="cellrowborder" valign="top" width="37.26%"><p>查看帮助使用文档。</p> </td> <td class="cellrowborder" valign="top" width="47.160000000000004%"><p>hilogtool -h</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="15.58%"><p>-i/–-input <em>inputDir</em></p> </td> <td class="cellrowborder" valign="top" width="37.26%"><p>用于指定输入路径，会扫描该目录下所有的hilog流水日志文件并进行解析；</p> <p>缺省时，为命令行当前所在路径。</p> <p></p> </td> <td class="cellrowborder" valign="top" width="47.160000000000004%"><p>解析指定目录(D:\temp\hilog)下的所有hilog文件：</p> <p>hilogtool parse -i D:\temp\hilog</p> <p>解析当前目录下的所有hilog文件：</p> <p>hilogtool parse -i .\</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="15.58%"><p>-i/–-input <em>inputFile</em></p> </td> <td class="cellrowborder" valign="top" width="37.26%"><p>解析指定的单个hilog文件。</p> <p></p> </td> <td class="cellrowborder" valign="top" width="47.160000000000004%"><p>解析指定的hilog文件:</p> <p>hilogtool parse -i D:\temp\data\log\hilog.706.20230711-071816.gz</p> <p>hilogtool parse -i .\hilog.706.20230711-071816.gz</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="15.58%"><p>-o/–-output <em>outputDir</em></p> </td> <td class="cellrowborder" valign="top" width="37.26%"><p>用于指定输出路径，即解析后的日志文件保存路径；</p> <p>缺省时，为解析的hilog原日志文件所在路径。</p> </td> <td class="cellrowborder" valign="top" width="47.160000000000004%"><p>解析当前目录下的日志文件到D:\temp目录:</p> <p>hilogtool parse -i .\ -o D:\temp</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="15.58%"><p>-d/--dict dictFile</p> </td> <td class="cellrowborder" valign="top" width="37.26%"><p>用于指定数据字典的路径；</p> <p>缺省时，会在命令行当前所在路径下匹配最新的数据字典文件（格式：hilog_dict.20230908-142200.zip）。</p> </td> <td class="cellrowborder" valign="top" width="47.160000000000004%"><p>解析指定目录(D:\temp\hilog)下的所有hilog文件，并且指定使用该目录下的数据字典：</p> <p>hilogtool parse -i D:\temp\hilog -d D:\temp\hilog\hilog_dict.20230908-142200.zip</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="15.58%"><p>-v/--version</p> </td> <td class="cellrowborder" valign="top" width="37.26%"><p>查看当前版本号。</p> </td> <td class="cellrowborder" valign="top" width="47.160000000000004%"><p>hilogtool -v</p> </td> </tr>  </tbody></table></div> </div> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p>1.数据字典文件在data/log/hilog目录下，格式为：hilog_dict.2024xxxx-xxxxxx.zip，是设备启动时自动生成的，在解析日志时需要这个文件。</p> <p>若缺少数据字典，会导致部分日志解析失败；重启设备可以重新生成该数据字典。</p> <p></p> <p>2.落盘的hilog日志文件默认格式为hilog\\.\\d{3}\\.\\d{8}-\\d{6}\\.gz$，若开发过程中使用了hilog -w start -f xxx 命令自定义了落盘文件名，可能导致日志无法被正常解析，需要升级hilogtool工具至1.0.0b版本及以上，才支持解析自定义文件名的hilog日志。</p> </div></div></div> </div> <div class="tiledSection"><h2 id="section742131815517">常用解析命令示例<i class="anchor-icon anchor-icon-link" anchorid="section742131815517" tips="复制节点链接"></i></h2></div> <div class="tiledSection"><h3 id="section6757163395116" class="firsth2">解析当前目录下所有的hilog文件（推荐）<i class="anchor-icon anchor-icon-link" anchorid="section6757163395116" tips="复制节点链接"></i></h3><p>在当前日志所在目录，通过cmd进入shell窗口，在shell窗口直接执行hilogtool parse，即可进行解析操作，如下图：</p> <p><span><img height="307.62559339525285" originheight="536" originwidth="1603" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211115024.10434733625647802632529318501621:50001231000000:2800:77438B59505849EE01A5CC2D43E44637B5710D3610C3795CE2CF42935ECDA04F.png" title="点击放大" width="920"></span></p> </div> <div class="tiledSection"><h3 id="section952842618529">解析指定目录下的hilog文件<i class="anchor-icon anchor-icon-link" anchorid="section952842618529" tips="复制节点链接"></i></h3><p>hilogtool parse -i D:\09-temp\dict-test -d D:\09-temp\dict-test</p> <p><span><img height="320.46191950464396" originheight="697" originwidth="2001" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211115024.77232183309246256718292142376139:50001231000000:2800:82CD5619225991A249F992206E267BD80A919917B23BF54F128953CA901B0C6F.png" title="点击放大" width="920"></span></p> </div> <div class="tiledSection"><h3 id="section207264115314">解析单个hilog文件<i class="anchor-icon anchor-icon-link" anchorid="section207264115314" tips="复制节点链接"></i></h3><p>hilogtool parse -i D:\09-temp\dict-test\hilog.025.20231020-154659.gz -d D:\09-temp\dict-test</p> <p><span><img height="223.9046439628483" originheight="487" originwidth="2001" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211115024.96774838239029546080451009463420:50001231000000:2800:6FB6CF60AE1B5F73E3D2DB33A8158014C247A39F05DCBF9C6FEABA896D54740E.png" title="点击放大" width="920"></span></p> </div> <div class="tiledSection"><h2 id="section883415018564">自动化脚本<i class="anchor-icon anchor-icon-link" anchorid="section883415018564" tips="复制节点链接"></i></h2><p>自动化调试脚本，将脚本与hilogtool工具放在同一目录下，执行get_hilog.bat，脚本会导出设备中的data/log/hilog日志，并且自动解析生成明文日志。</p> </div> <div class="tiledSection"><h3 id="section1675910310575" class="firsth2">windows平台脚本<i class="anchor-icon anchor-icon-link" anchorid="section1675910310575" tips="复制节点链接"></i></h3><p>windows平台 get_hilog.bat 脚本内容参考：</p> <div _ngcontent-dph-c106="" class="highlight-div"><div _ngcontent-dph-c106="" class="highlight-div-header"><div _ngcontent-dph-c106="" class="highlight-div-header-left"><div _ngcontent-dph-c106="" class="handle-button expand-button"><div _ngcontent-dph-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-dph-c106="" class="highlight-div-header-right"><div _ngcontent-dph-c106="" class="handle-button ai-button"></div><div _ngcontent-dph-c106="" class="handle-button line-button"><div _ngcontent-dph-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-dph-c106="" class="handle-button theme-button"><div _ngcontent-dph-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-dph-c106="" class="handle-button copy-button"><div _ngcontent-dph-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-dph-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-less" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-variable">@set</span> Ymd=%<span class="hljs-attribute">date</span>:~<span class="hljs-number">0</span>,<span class="hljs-number">4%</span>_%<span class="hljs-attribute">date</span>:~<span class="hljs-number">5</span>,<span class="hljs-number">2%</span>%<span class="hljs-attribute">date</span>:~<span class="hljs-number">8</span>,<span class="hljs-number">2%</span>_%<span class="hljs-attribute">time</span>:~<span class="hljs-number">0</span>,<span class="hljs-number">2%</span>%<span class="hljs-attribute">time</span>:~<span class="hljs-number">3</span>,<span class="hljs-number">2%</span>%<span class="hljs-attribute">time</span>:~<span class="hljs-number">6</span>,<span class="hljs-number">2%</span></li><li><span class="hljs-variable">@set</span> Ymd=%<span class="hljs-attribute">Ymd</span>: =<span class="hljs-number">0%</span></li><li><span class="hljs-variable">@set</span> Dir=LOG_%YMD%</li><li>md %Dir%</li><li>hdc file recv /data/log/hilog/ .\%Dir%\</li><li>hilogtool parse -i .\%Dir% -d .\%Dir%</li><li>pause</li></ol></pre></div></div> <p>脚本运行结果：</p> <p><span><img height="276.80345724526364" originheight="451" originwidth="1499" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211115024.55229112241718197620642621419568:50001231000000:2800:AE6342926E29A42E690D4F0A500BC562458679979B910625765BAECBD7F2E2FC.png" title="点击放大" width="920"></span></p> </div> <div class="tiledSection"><h3 id="section17967252712">mac平台脚本<i class="anchor-icon anchor-icon-link" anchorid="section17967252712" tips="复制节点链接"></i></h3><p>mac平台脚本内容参考：</p> <div _ngcontent-dph-c106="" class="highlight-div"><div _ngcontent-dph-c106="" class="highlight-div-header"><div _ngcontent-dph-c106="" class="highlight-div-header-left"><div _ngcontent-dph-c106="" class="handle-button expand-button"><div _ngcontent-dph-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-dph-c106="" class="highlight-div-header-right"><div _ngcontent-dph-c106="" class="handle-button ai-button"></div><div _ngcontent-dph-c106="" class="handle-button line-button"><div _ngcontent-dph-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-dph-c106="" class="handle-button theme-button"><div _ngcontent-dph-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-dph-c106="" class="handle-button copy-button"><div _ngcontent-dph-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-dph-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-perl" data-highlighted="yes"><ol class="linenums"><li>Ymd=$(date <span class="hljs-string">"+%Y_%m%d_%H%M%S"</span>)</li><li>Dir=LOG<span class="hljs-number">_</span>$Ymd</li><li><span class="hljs-keyword">mkdir</span> $Dir</li><li>hdc file <span class="hljs-keyword">recv</span> /data/<span class="hljs-keyword">log</span>/hilog/ ./$Dir/</li><li>./hilogtool parse -i ./$Dir -d ./$Dir</li></ol></pre></div></div> </div> <div class="tiledSection"><h2 id="section10299651138">可能有影响的场景<i class="anchor-icon anchor-icon-link" anchorid="section10299651138" tips="复制节点链接"></i></h2></div> <div class="tiledSection"><h3 id="section17785116348" class="firsth2">自动化分析日志<i class="anchor-icon anchor-icon-link" anchorid="section17785116348" tips="复制节点链接"></i></h3><p>部分领域涉及到自动化分析/data/log/hilog目录下的明文日志文件，目前hilog轻量化后，日志以二进制保存，需要使用上述解析工具适配一下自动化反编译二进制日志动作。</p> </div> <div class="tiledSection"><h3 id="section1104202049">日志转发他人<i class="anchor-icon anchor-icon-link" anchorid="section1104202049" tips="复制节点链接"></i></h3><p>直接从手机/data/log/hilog目录下recv出来的日志文件为二进制日志文件，直接发送给他人，无法正常查看，建议解析后再发送，或者将二进制日志文件与数据字典一同转发。</p> </div> <div class="tiledSection"><h2 id="section15158460811">错误码<i class="anchor-icon anchor-icon-link" anchorid="section15158460811" tips="复制节点链接"></i></h2> <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.16.2.1.4.1.1" valign="top" width="9.560956095609562%"><p>错误码</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.16.2.1.4.1.2" valign="top" width="39.33393339333933%"><p>含义</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.16.2.1.4.1.3" valign="top" width="51.10511051105111%"><p>处理方法</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="9.560956095609562%"><p>200</p> </td> <td class="cellrowborder" valign="top" width="39.33393339333933%"><p>解码成功</p> </td> <td class="cellrowborder" valign="top" width="51.10511051105111%"><p>不涉及</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="9.560956095609562%"><p>300</p> </td> <td class="cellrowborder" valign="top" width="39.33393339333933%"><p>解码失败，存在部分领域的日志和字典不匹配</p> </td> <td class="cellrowborder" valign="top" width="51.10511051105111%"><p>1.只有部分日志解析失败，一般不影响开发自调试，可不用关注</p> <p>2、若影响自调试，可参考下方常见问题，增量生成数据字典</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="9.560956095609562%"><p>500</p> </td> <td class="cellrowborder" valign="top" width="39.33393339333933%"><p>解析工具版本不匹配</p> </td> <td class="cellrowborder" valign="top" width="51.10511051105111%"><p>更新hilogtool解析工具版本</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="9.560956095609562%"><p>999</p> </td> <td class="cellrowborder" valign="top" width="39.33393339333933%"><p>日志是明文落盘的，不需要解析</p> </td> <td class="cellrowborder" valign="top" width="51.10511051105111%"><p>不涉及</p> </td> </tr>  </tbody></table></div> </div> </div> <div class="tiledSection"><h2 id="section333113391154">常见问题<i class="anchor-icon anchor-icon-link" anchorid="section333113391154" tips="复制节点链接"></i></h2><p><strong>问题现象</strong></p> <p>工具解析时，显示  there is no hilog dict zip in xxx, use -d to specify ，或者 open dict xxx fail, errno is: No such file or directory</p> <p>解析完的日志中，显示  OpenUuidFile fail, unknown log, uuid is: xxxxxx</p> <p></p> <p><strong>可能原因</strong></p> <p>解析日志时，未找到对应的数据字典导致的。</p> <p></p> <p><strong>解决措施</strong></p> <p>1、解析命令使用错误，具体参考<a href="/consumer/cn/doc/harmonyos-guides/hilog-tool#section742131815517">常用解析命令示例</a>。</p> <p>2、开发本地替换bin/so调试的场景，需要触发生成新的数据字典，才能解析，以下触发命令三选一即可。</p> <p>（1）使用增量生成数据字典命令：hilog -d xxx</p> <p>例如推送hilog相关测试程序bin文件hilogTest到 /system/bin/下面，想查看hilogTest打印的日志，需要执行以下命令，增量生成hilogTest的数据字典：</p> <p>hdc shell hilog -d /system/bin/hilogTest</p> <p>数据字典生成成功后hilogTest则可以正常打印日志。</p> <p>（2）重启hilogd：service_control stop hilogd &amp;&amp; service_control start hilogd</p> <p>（3）重启设备；</p> <p>3、数据字典被删掉了，检查导出的日志中是否存在hilog_dict.2024xxxx-xxxxxx.zip格式的数据字典文件</p> <p>若不存在，则大概率是被 rm -rf data/log/hilog/* 命令删除掉了，需要重启设备生成新的数据字典，然后解析。</p> </div> </div> <div></div></div>