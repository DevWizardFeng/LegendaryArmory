<h1 _ngcontent-rdu-c119="" class="doc-title ng-star-inserted" title="hitrace"> hitrace </h1>

<div _ngcontent-rdu-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p>hitrace命令行工具提供trace信息采集能力，支持采集系统提供的打点和开发者使用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/hitracemeter-intro">HitraceMeter接口</a>在应用中设置的打点。该工具支持多种方式采集文本格式或二进制格式的trace信息，帮助开发者观测程序运行情况和定位故障问题。</p>    <div class="tiledSection">     <h2 id="环境要求">环境要求<i class="anchor-icon anchor-icon-link" anchorid="环境要求" tips="复制节点链接"></i></h2>          <ul>      <li>       <p>根据hdc命令行工具指导，完成<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/hdc#环境准备">hdc环境准备</a>。</p></li>      <li>       <p>确保设备已正常连接，并执行hdc shell。</p></li>     </ul>    </div>    <div class="tiledSection">     <h2 id="命令行说明">命令行说明<i class="anchor-icon anchor-icon-link" anchorid="命令行说明" tips="复制节点链接"></i></h2>          <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.3.2.1.3.1.1" valign="top" width="50%">命令</th>         <th align="left" class="cellrowborder" id="mcps1.3.3.2.1.3.1.2" valign="top" width="50%">含义说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="50%">-h/--help</td>         <td class="cellrowborder" valign="top" width="50%">查看帮助。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">-l/--list_categories</td>         <td class="cellrowborder" valign="top" width="50%">查看tag列表。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">--trace_begin</td>         <td class="cellrowborder" valign="top" width="50%">开始捕获trace。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">--trace_finish</td>         <td class="cellrowborder" valign="top" width="50%">结束捕获trace。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">--trace_finish_nodump</td>         <td class="cellrowborder" valign="top" width="50%">结束捕获trace，与--trace_finish的区别是不输出trace信息。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">--trace_dump</td>         <td class="cellrowborder" valign="top" width="50%">导出trace信息。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">--record</td>         <td class="cellrowborder" valign="top" width="50%">使能录制模式，允许长时间采集并落盘trace数据，必须和--trace_begin或--trace_finish一起使用。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">--overwrite</td>         <td class="cellrowborder" valign="top" width="50%">设置内核缓冲区满之后的行为，未设置此选项时默认丢弃最老数据，设置此选项后丢弃最新数据。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">--file_size</td>         <td class="cellrowborder" valign="top" width="50%">设置文件大小（单位为KB），仅在采集二进制格式trace数据时有效。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">-b N/--buffer_size N</td>         <td class="cellrowborder" valign="top" width="50%">设置用于存储和读取trace的缓冲区大小（单位为KB）。最小值为512，最大值与设备当前可用内存有关。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">-t N/--time N</td>         <td class="cellrowborder" valign="top" width="50%">设置hitrace采集时长，单位为s。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">-o/--output filename</td>         <td class="cellrowborder" valign="top" width="50%">指定目标文件的名称（导出trace格式为文本时默认为stdout，如需保存到文件，建议使用/data/local/tmp路径。导出trace格式为二进制时不支持此选项）。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">-z</td>         <td class="cellrowborder" valign="top" width="50%">压缩捕获的trace数据。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">--text</td>         <td class="cellrowborder" valign="top" width="50%">导出trace数据为文本格式（默认为文本格式）。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">--raw</td>         <td class="cellrowborder" valign="top" width="50%">导出trace数据为二进制格式（默认为文本格式）。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">--trace_clock</td>         <td class="cellrowborder" valign="top" width="50%">          <p>设置向trace添加时间戳的时钟类型，可以是boot（默认）、global、mono、uptime或perf。不同设备支持的时钟类型不同，建议使用默认的boot进行采集，其时间为从本次开机起的时间戳，单位为s。每种时间类型的说明如下：</p>          <p>- boot：系统启动后的时间戳，休眠或系统挂起时也会计时。</p>          <p>- global：全局同步的时钟，可能有性能开销。</p>          <p>- mono：系统启动后的时间戳，休眠或系统挂起时不会计时。</p>          <p>- uptime：系统启动后的时间戳，类似于mono。</p>          <p>- perf：高性能计数器，适合性能分析。</p></td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">--start_bgsrv</td>         <td class="cellrowborder" valign="top" width="50%">开启快照模式trace捕获。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">--dump_bgsrv</td>         <td class="cellrowborder" valign="top" width="50%">触发快照模式trace输出到文件。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">--stop_bgsrv</td>         <td class="cellrowborder" valign="top" width="50%">关闭快照模式trace捕获。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">--trace_level</td>         <td class="cellrowborder" valign="top" width="50%">          <p>设置trace输出级别阈值，输出级别可以是Debug、Info、Critical、Commercial或其对应缩写D、I、C、M。</p>          <p><strong>说明</strong>：从API version 19开始，支持该命令。</p></td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">--get_level</td>         <td class="cellrowborder" valign="top" width="50%">          <p>查询trace输出级别阈值。</p>          <p><strong>说明</strong>：从API version 20开始，支持该命令。</p></td>        </tr>             </tbody></table></div>     </div>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>trace信息可以用两种不同的格式保存，分别为文本格式和二进制格式。文本格式的trace可以直接用文本编辑器查看，二进制格式的trace可以使用<a href="https://gitcode.com/openharmony/developtools_smartperf_host" target="_blank">Smartperf_Host</a>工具进行可视化trace分析。工具下载链接：<a href="https://gitcode.com/openharmony/developtools_smartperf_host/releases" target="_blank">developtools_smartperf_host官方发行版</a>。</p>      </div></div></div>    </div>    <div class="tiledSection">     <h2 id="常用命令">常用命令<i class="anchor-icon anchor-icon-link" anchorid="常用命令" tips="复制节点链接"></i></h2>         </div>    <div class="tiledSection">     <h3 id="查看帮助信息" class="firsth2">查看帮助信息<i class="anchor-icon anchor-icon-link" anchorid="查看帮助信息" tips="复制节点链接"></i></h3>          <div _ngcontent-rdu-c106="" class="highlight-div"><div _ngcontent-rdu-c106="" class="highlight-div-header"><div _ngcontent-rdu-c106="" class="highlight-div-header-left"><div _ngcontent-rdu-c106="" class="handle-button expand-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rdu-c106="" class="highlight-div-header-right"><div _ngcontent-rdu-c106="" class="handle-button ai-button"></div><div _ngcontent-rdu-c106="" class="handle-button line-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rdu-c106="" class="handle-button theme-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rdu-c106="" class="handle-button copy-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rdu-c106="" class="highlight-scroll-div"><pre class="shell prettyprint linenums hljs language-shell" hw-language="shell" data-highlighted="yes"><ol class="linenums"><li>hitrace -h</li></ol></pre></div></div>     <p><strong>使用样例</strong>：</p>     <div _ngcontent-rdu-c106="" class="highlight-div"><div _ngcontent-rdu-c106="" class="highlight-div-header"><div _ngcontent-rdu-c106="" class="highlight-div-header-left"><div _ngcontent-rdu-c106="" class="handle-button expand-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rdu-c106="" class="highlight-div-header-right"><div _ngcontent-rdu-c106="" class="handle-button ai-button"></div><div _ngcontent-rdu-c106="" class="handle-button line-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rdu-c106="" class="handle-button theme-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rdu-c106="" class="handle-button copy-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rdu-c106="" class="highlight-scroll-div"><pre class="shell prettyprint linenums hljs language-shell" hw-language="shell" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta prompt_">$ </span><span class="language-bash">hitrace -h</span></li><li>2025/05/28 15:19:52 hitrace enter, running_state is SHOW_HELP</li><li>usage: hitrace [options] [categories...]</li><li>options include:</li><li>  -b N                   Set the size of the buffer (KB) for storing and reading traces.</li><li>                         The default buffer size is 18432 KB.</li><li>  --buffer_size N        Like "-b N".</li><li>  -l                     List available hitrace categories.</li><li>  --list_categories      Like "-l".</li><li>  -t N                   Set the hitrace running duration in seconds (5s by default), which depends on</li><li>                         the time required for analysis.</li><li>  --time N               Like "-t N".</li><li>  --trace_clock clock    Sets the type of the clock for adding a timestamp to a trace, which can be</li><li>                         boot (default), global, mono, uptime, or perf.</li><li>  --trace_begin          Start capturing traces.</li><li>  --trace_dump           Dump traces to a specified path (stdout by default).</li><li>  --trace_finish         Stop capturing traces and dumps traces to a specified path (stdout by default).</li><li>  --trace_finish_nodump  Stop capturing traces and not dumps traces.</li><li>  --record               Enable or disable long-term trace collection tasks in conjunction with</li><li>                         "--trace_begin" and "--trace_finish".</li><li>  --overwrite            Set the action to take when the buffer is full. If this option is used,</li><li>                         the latest traces are discarded; if this option is not used (default setting),</li><li>                         the earliest traces are discarded.</li><li>  -o filename            Specifies the name of the target file (stdout by default).</li><li>  --output filename      Like "-o filename".</li><li>  -z                     Compresses a captured trace.</li><li>  --text                 Specify the output format of trace as text.</li><li>  --raw                  Specify the output format of trace as raw trace, the default format is text.</li><li>  --start_bgsrv          Enable trace_service in snapshot mode.</li><li>  --dump_bgsrv           Trigger the dump trace task of the trace_service.</li><li>  --stop_bgsrv           Disable trace_service in snapshot mode.</li><li>  --file_size            Sets the size of the raw trace (KB). The default file size is 102400 KB.</li><li>                         Only effective in raw trace mode</li><li>  --trace_level level    Set the system parameter "persist.hitrace.level.threshold", which can control</li><li>                         the level threshold of tracing. Valid values for "level" include</li><li>                         D or Debug, I or Info, C or Critical, M or Commercial.</li><li>  --get_level            Query the system parameter "persist.hitrace.level.threshold",</li><li>                         which can control the level threshold of tracing.</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="查看hitrace包含的tag">查看hitrace包含的tag<i class="anchor-icon anchor-icon-link" anchorid="查看hitrace包含的tag" tips="复制节点链接"></i></h3>          <div _ngcontent-rdu-c106="" class="highlight-div"><div _ngcontent-rdu-c106="" class="highlight-div-header"><div _ngcontent-rdu-c106="" class="highlight-div-header-left"><div _ngcontent-rdu-c106="" class="handle-button expand-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rdu-c106="" class="highlight-div-header-right"><div _ngcontent-rdu-c106="" class="handle-button ai-button"></div><div _ngcontent-rdu-c106="" class="handle-button line-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rdu-c106="" class="handle-button theme-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rdu-c106="" class="handle-button copy-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rdu-c106="" class="highlight-scroll-div"><pre class="shell prettyprint linenums hljs language-shell" hw-language="shell" data-highlighted="yes"><ol class="linenums"><li>hitrace -l</li></ol></pre></div></div>     <p><strong>使用样例</strong>：</p>     <div _ngcontent-rdu-c106="" class="highlight-div"><div _ngcontent-rdu-c106="" class="highlight-div-header"><div _ngcontent-rdu-c106="" class="highlight-div-header-left"><div _ngcontent-rdu-c106="" class="handle-button expand-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rdu-c106="" class="highlight-div-header-right"><div _ngcontent-rdu-c106="" class="handle-button ai-button"></div><div _ngcontent-rdu-c106="" class="handle-button line-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rdu-c106="" class="handle-button theme-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rdu-c106="" class="handle-button copy-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rdu-c106="" class="highlight-scroll-div"><pre class="shell prettyprint linenums hljs language-shell" hw-language="shell" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta prompt_">$ </span><span class="language-bash">hitrace -l</span></li><li>2025/05/27 16:24:38 hitrace enter, running_state is SHOW_LIST_CATEGORY</li><li>            tagName:   description:</li><li>             ability - Ability Manager</li><li>       accesscontrol - Access Control Module</li><li>       accessibility - Accessibility Manager</li><li>             account - Account Manager</li><li>                 ace - ACE development framework</li><li>           animation - Animation</li><li>                 app - APP Module</li><li>                 ark - ARK Module</li><li>              binder - Binder kernel Info</li><li>           bluetooth - communication bluetooth</li><li>               cloud - Cloud subsystem tag</li><li>          commercial - Commercial version tag</li><li>       commonlibrary - commonlibrary subsystem</li><li>              daudio - Distributed Audio</li><li>             dcamera - Distributed Camera</li><li>          deviceauth - Device Auth</li><li>       devicemanager - Device Manager</li><li>       deviceprofile - Device Profile</li><li>               dhfwk - Distributed Hardware FWK</li><li>              dinput - Distributed Input</li><li>                disk - Disk I/O</li><li>  distributeddatamgr - Distributed Data Manager</li><li>              dlpcre - Dlp Credential Service</li><li>                 drm - Digital Rights Management</li><li>              dsched - Distributed Schedule</li><li>             dscreen - Distributed Screen</li><li>                dslm - device security level</li><li>            dsoftbus - Distributed Softbus</li><li>                ffrt - ffrt tasks</li><li>      filemanagement - filemanagement</li><li>                freq - CPU Frequency</li><li>             graphic - Graphic Module</li><li>           gresource - Global Resource Manager</li><li>                hdcd - hdcd</li><li>                 hdf - hdf subsystem</li><li>                hmfs - HMFS commands</li><li>                huks - Universal KeyStore</li><li>                 i2c - I2C Events</li><li>                idle - CPU Idle</li><li>           interconn - Interconnection subsystem</li><li>                 ipa - thermal power allocator</li><li>                 irq - IRQ Events</li><li>              irqoff - IRQ-disabled code section tracing</li><li>                load - CPU Load</li><li>                mdfs - Mobile Distributed File System</li><li>              membus - Memory Bus Utilization</li><li>              memory - Memory</li><li>          memreclaim - Kernel Memory Reclaim</li><li>                misc - Misc Module</li><li>                 mmc - eMMC commands</li><li>                msdp - Multimodal Sensor Data Platform</li><li>     multimodalinput - HITRACE_TAG_MULTIMODALINPUT</li><li>                musl - musl module</li><li>                 net - net</li><li>        notification - Notification Module</li><li>                nweb - NWEB Module</li><li>                ohos - HarmonyOS</li><li>           pagecache - Page cache</li><li>               power - Power Manager</li><li>          preemptoff - Preempt-disabled code section tracing</li><li>                push - Push subsystem</li><li>          regulators - Voltage and Current Regulators</li><li>                 rpc - RPC and IPC</li><li>               samgr - samgr</li><li>               sched - CPU Scheduling</li><li>            security - Security subsystem</li><li>             sensors - Sensors Module</li><li>                sync - Synchronization</li><li>                 ufs - UFS commands</li><li>                 usb - usb subsystem</li><li>             useriam - useriam</li><li>               virse - Virtualization Service</li><li>              window - Window Manager</li><li>               workq - Kernel Workqueues</li><li>              zaudio - HarmonyOS Audio Module</li><li>             zbinder - HarmonyOS binder communication</li><li>             zcamera - HarmonyOS Camera Module</li><li>              zimage - HarmonyOS Image Module</li><li>              zmedia - HarmonyOS Media Module</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="捕获指定时长文本格式trace">捕获指定时长文本格式trace<i class="anchor-icon anchor-icon-link" anchorid="捕获指定时长文本格式trace" tips="复制节点链接"></i></h3>          <p>不指定-o参数时，默认将捕获到的trace内容显示在命令行窗口。下面参数是指定采集10秒的数据，缓冲区大小为204800KB，采集的tag为app。</p>     <div _ngcontent-rdu-c106="" class="highlight-div"><div _ngcontent-rdu-c106="" class="highlight-div-header"><div _ngcontent-rdu-c106="" class="highlight-div-header-left"><div _ngcontent-rdu-c106="" class="handle-button expand-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rdu-c106="" class="highlight-div-header-right"><div _ngcontent-rdu-c106="" class="handle-button ai-button"></div><div _ngcontent-rdu-c106="" class="handle-button line-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rdu-c106="" class="handle-button theme-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rdu-c106="" class="handle-button copy-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rdu-c106="" class="highlight-scroll-div"><pre class="shell prettyprint linenums hljs language-shell" hw-language="shell" data-highlighted="yes"><ol class="linenums"><li>hitrace -t 10 -b 204800 app</li></ol></pre></div></div>     <p><strong>使用样例</strong>：</p>     <div _ngcontent-rdu-c106="" class="highlight-div"><div _ngcontent-rdu-c106="" class="highlight-div-header"><div _ngcontent-rdu-c106="" class="highlight-div-header-left"><div _ngcontent-rdu-c106="" class="handle-button expand-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rdu-c106="" class="highlight-div-header-right"><div _ngcontent-rdu-c106="" class="handle-button ai-button"></div><div _ngcontent-rdu-c106="" class="handle-button line-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rdu-c106="" class="handle-button theme-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rdu-c106="" class="handle-button copy-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rdu-c106="" class="highlight-scroll-div"><pre class="shell prettyprint linenums hljs language-shell" hw-language="shell" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta prompt_">$ </span><span class="language-bash">hitrace -t 10 -b 204800 app</span></li><li>2025/06/04 10:14:52 start capture, please wait 10s ...</li><li><span class="hljs-meta prompt_"># </span><span class="language-bash">tracer: nop</span></li><li><span class="hljs-meta prompt_"># </span><span class="language-bash">                                         _-----=&gt; irqs-off</span></li><li><span class="hljs-meta prompt_"># </span><span class="language-bash">                                        / _----=&gt; need-resched</span></li><li><span class="hljs-meta prompt_"># </span><span class="language-bash">                                       | / _---=&gt; hardirq/softirq</span></li><li><span class="hljs-meta prompt_"># </span><span class="language-bash">                                       || / _--=&gt; preempt-depth</span></li><li><span class="hljs-meta prompt_"># </span><span class="language-bash">                                       ||| /     delay</span></li><li><span class="hljs-meta prompt_"># </span><span class="language-bash">          TASK-PID       TGID    CPU<span class="hljs-comment">#  ||||   TIMESTAMP  FUNCTION</span></span></li><li><span class="hljs-meta prompt_"># </span><span class="language-bash">             | |           |       |   ||||      |         |</span></li><li> KstateRecvThrea-1132    (    952) [003] .... 589942.951387: tracing_mark_write: B|952|H:CheckMsgFromNetlink|I62</li><li> KstateRecvThrea-1132    (    952) [003] .... 589942.951554: tracing_mark_write: B|952|H:OnKstateCallback, mask: 8, data: [PID 15461 KILLED][SIG 9]|I62</li><li> KstateRecvThrea-1132    (    952) [003] .... 589942.951693: tracing_mark_write: E|952|I62</li><li> KstateRecvThrea-1132    (    952) [003] .... 589942.951737: tracing_mark_write: E|952|I62</li><li> state_change_ha-1139    (    952) [001] .... 589942.951909: tracing_mark_write: B|952|H:ProcessEvent, eventId: 6|I62</li><li> state_change_ha-1139    (    952) [001] .... 589942.952510: tracing_mark_write: E|952|I62</li><li>2025/06/04 10:15:02 TraceFinish done.</li></ol></pre></div></div>     <p>指定-o参数时，可以将trace信息保存到指定目录，建议保存在/data/local/tmp路径下。</p>     <div _ngcontent-rdu-c106="" class="highlight-div"><div _ngcontent-rdu-c106="" class="highlight-div-header"><div _ngcontent-rdu-c106="" class="highlight-div-header-left"><div _ngcontent-rdu-c106="" class="handle-button expand-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rdu-c106="" class="highlight-div-header-right"><div _ngcontent-rdu-c106="" class="handle-button ai-button"></div><div _ngcontent-rdu-c106="" class="handle-button line-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rdu-c106="" class="handle-button theme-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rdu-c106="" class="handle-button copy-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rdu-c106="" class="highlight-scroll-div"><pre class="shell prettyprint linenums hljs language-shell" hw-language="shell" data-highlighted="yes"><ol class="linenums"><li>hitrace -t 10 -b 204800 app -o /data/local/tmp/test.ftrace</li></ol></pre></div></div>     <p><strong>使用样例</strong>：</p>     <div _ngcontent-rdu-c106="" class="highlight-div"><div _ngcontent-rdu-c106="" class="highlight-div-header"><div _ngcontent-rdu-c106="" class="highlight-div-header-left"><div _ngcontent-rdu-c106="" class="handle-button expand-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rdu-c106="" class="highlight-div-header-right"><div _ngcontent-rdu-c106="" class="handle-button ai-button"></div><div _ngcontent-rdu-c106="" class="handle-button line-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rdu-c106="" class="handle-button theme-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rdu-c106="" class="handle-button copy-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rdu-c106="" class="highlight-scroll-div"><pre class="shell prettyprint linenums hljs language-shell" hw-language="shell" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta prompt_">$ </span><span class="language-bash">hitrace -t 10 -b 204800 app -o /data/local/tmp/test.ftrace</span></li><li>2025/06/04 10:19:47 start capture, please wait 10s ...</li><li>2025/06/04 10:19:57 capture done, start to read trace.</li><li>2025/06/04 10:19:57 trace read done, output: /data/local/tmp/test.ftrace</li><li>2025/06/04 10:19:57 TraceFinish done.</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="捕获指定时长二进制格式trace">捕获指定时长二进制格式trace<i class="anchor-icon anchor-icon-link" anchorid="捕获指定时长二进制格式trace" tips="复制节点链接"></i></h3>          <p>命令带--raw参数时可捕获二进制格式trace，捕获二进制格式trace时不支持指定路径，固定保存在路径/data/log/hitrace下。采集结束后，采集结束后生成文件的绝对路径会显示在命令行窗口。</p>     <div _ngcontent-rdu-c106="" class="highlight-div"><div _ngcontent-rdu-c106="" class="highlight-div-header"><div _ngcontent-rdu-c106="" class="highlight-div-header-left"><div _ngcontent-rdu-c106="" class="handle-button expand-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rdu-c106="" class="highlight-div-header-right"><div _ngcontent-rdu-c106="" class="handle-button ai-button"></div><div _ngcontent-rdu-c106="" class="handle-button line-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rdu-c106="" class="handle-button theme-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rdu-c106="" class="handle-button copy-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rdu-c106="" class="highlight-scroll-div"><pre class="shell prettyprint linenums hljs language-shell" hw-language="shell" data-highlighted="yes"><ol class="linenums"><li>hitrace -t 10 -b 204800 app --raw</li></ol></pre></div></div>     <p><strong>使用样例</strong>：</p>     <div _ngcontent-rdu-c106="" class="highlight-div"><div _ngcontent-rdu-c106="" class="highlight-div-header"><div _ngcontent-rdu-c106="" class="highlight-div-header-left"><div _ngcontent-rdu-c106="" class="handle-button expand-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rdu-c106="" class="highlight-div-header-right"><div _ngcontent-rdu-c106="" class="handle-button ai-button"></div><div _ngcontent-rdu-c106="" class="handle-button line-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rdu-c106="" class="handle-button theme-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rdu-c106="" class="handle-button copy-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rdu-c106="" class="highlight-scroll-div"><pre class="shell prettyprint linenums hljs language-shell" hw-language="shell" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta prompt_">$ </span><span class="language-bash">hitrace -t 10 -b 204800 app --raw</span></li><li>2025/06/04 10:21:16 hitrace enter, running_state is RECORDING_SHORT_RAW</li><li>2025/06/04 10:21:16 args: tags:app bufferSize:204800 overwrite:1</li><li>2025/06/04 10:21:16 start capture, please wait 10s ...</li><li>2025/06/04 10:21:27 capture done, output files:</li><li>    /data/log/hitrace/record_trace_20250604102116@590322-695861087.sys</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="快照模式捕获文本格式trace">快照模式捕获文本格式trace<i class="anchor-icon anchor-icon-link" anchorid="快照模式捕获文本格式trace" tips="复制节点链接"></i></h3>          <p>快照模式下，trace信息保存在内核缓冲区。当数据量超出缓冲区大小时，默认丢弃最早的数据。</p>     <p>使用以下命令开启快照模式，指定缓冲区大小为204800KB，采集的tag为app和graphic。</p>     <div _ngcontent-rdu-c106="" class="highlight-div"><div _ngcontent-rdu-c106="" class="highlight-div-header"><div _ngcontent-rdu-c106="" class="highlight-div-header-left"><div _ngcontent-rdu-c106="" class="handle-button expand-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rdu-c106="" class="highlight-div-header-right"><div _ngcontent-rdu-c106="" class="handle-button ai-button"></div><div _ngcontent-rdu-c106="" class="handle-button line-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rdu-c106="" class="handle-button theme-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rdu-c106="" class="handle-button copy-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rdu-c106="" class="highlight-scroll-div"><pre class="shell prettyprint linenums hljs language-shell" hw-language="shell" data-highlighted="yes"><ol class="linenums"><li>hitrace --trace_begin -b 204800 app graphic</li></ol></pre></div></div>     <p><strong>使用样例</strong>：</p>     <div _ngcontent-rdu-c106="" class="highlight-div"><div _ngcontent-rdu-c106="" class="highlight-div-header"><div _ngcontent-rdu-c106="" class="highlight-div-header-left"><div _ngcontent-rdu-c106="" class="handle-button expand-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rdu-c106="" class="highlight-div-header-right"><div _ngcontent-rdu-c106="" class="handle-button ai-button"></div><div _ngcontent-rdu-c106="" class="handle-button line-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rdu-c106="" class="handle-button theme-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rdu-c106="" class="handle-button copy-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rdu-c106="" class="highlight-scroll-div"><pre class="shell prettyprint linenums hljs language-shell" hw-language="shell" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta prompt_">$ </span><span class="language-bash">hitrace --trace_begin -b 204800 app graphic</span></li><li>2025/06/04 16:03:39 hitrace enter, running_state is RECORDING_LONG_BEGIN</li><li>2025/06/04 16:03:39 args: tags:app,graphic bufferSize:204800 overwrite:1</li><li>2025/06/04 16:03:39 OpenRecording done.</li></ol></pre></div></div>     <p>在开启快照模式后，可以使用下面的命令将当前缓冲区内的数据导出。默认将trace信息显示到命令行窗口。</p>     <div _ngcontent-rdu-c106="" class="highlight-div"><div _ngcontent-rdu-c106="" class="highlight-div-header"><div _ngcontent-rdu-c106="" class="highlight-div-header-left"><div _ngcontent-rdu-c106="" class="handle-button expand-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rdu-c106="" class="highlight-div-header-right"><div _ngcontent-rdu-c106="" class="handle-button ai-button"></div><div _ngcontent-rdu-c106="" class="handle-button line-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rdu-c106="" class="handle-button theme-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rdu-c106="" class="handle-button copy-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rdu-c106="" class="highlight-scroll-div"><pre class="shell prettyprint linenums hljs language-shell" hw-language="shell" data-highlighted="yes"><ol class="linenums"><li>hitrace --trace_dump</li></ol></pre></div></div>     <p><strong>使用样例</strong>：</p>     <div _ngcontent-rdu-c106="" class="highlight-div"><div _ngcontent-rdu-c106="" class="highlight-div-header"><div _ngcontent-rdu-c106="" class="highlight-div-header-left"><div _ngcontent-rdu-c106="" class="handle-button expand-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rdu-c106="" class="highlight-div-header-right"><div _ngcontent-rdu-c106="" class="handle-button ai-button"></div><div _ngcontent-rdu-c106="" class="handle-button line-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rdu-c106="" class="handle-button theme-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rdu-c106="" class="handle-button copy-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rdu-c106="" class="highlight-scroll-div"><pre class="shell prettyprint linenums hljs language-shell" hw-language="shell" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta prompt_">$ </span><span class="language-bash">hitrace --trace_dump</span></li><li>2025/06/04 16:07:57 start to read trace.</li><li><span class="hljs-meta prompt_"># </span><span class="language-bash">tracer: nop</span></li><li><span class="hljs-meta prompt_"># </span><span class="language-bash">                                         _-----=&gt; irqs-off</span></li><li><span class="hljs-meta prompt_"># </span><span class="language-bash">                                        / _----=&gt; need-resched</span></li><li><span class="hljs-meta prompt_"># </span><span class="language-bash">                                       | / _---=&gt; hardirq/softirq</span></li><li><span class="hljs-meta prompt_"># </span><span class="language-bash">                                       || / _--=&gt; preempt-depth</span></li><li><span class="hljs-meta prompt_"># </span><span class="language-bash">                                       ||| /     delay</span></li><li><span class="hljs-meta prompt_"># </span><span class="language-bash">          TASK-PID       TGID    CPU<span class="hljs-comment">#  ||||   TIMESTAMP  FUNCTION</span></span></li><li><span class="hljs-meta prompt_"># </span><span class="language-bash">             | |           |       |   ||||      |         |</span></li><li> KstateRecvThrea-1132    (    952) [002] .... 610865.463378: tracing_mark_write: B|952|H:CheckMsgFromNetlink|I62</li><li> KstateRecvThrea-1132    (    952) [002] .... 610865.463503: tracing_mark_write: B|952|H:OnKstateCallback, mask: 8, data: [PID 14446 KILLED][SIG 9]|I62</li><li> KstateRecvThrea-1132    (    952) [002] .... 610865.463626: tracing_mark_write: E|952|I62</li><li> KstateRecvThrea-1132    (    952) [002] .... 610865.463654: tracing_mark_write: E|952|I62</li><li> state_change_ha-1139    (    952) [001] .... 610865.463767: tracing_mark_write: B|952|H:ProcessEvent, eventId: 6|I62</li><li> state_change_ha-1139    (    952) [001] .... 610865.463879: tracing_mark_write: E|952|I62</li><li> state_change_ha-1139    (    952) [001] .... 610866.506055: tracing_mark_write: B|952|H:ProcessEvent, eventId: 0|I62</li><li> state_change_ha-1139    (    952) [001] .... 610866.506297: tracing_mark_write: B|952|H:HandleStateTransition, 20020111_com.ohos.medialibrary.medialibrarydata_[6255]|I62</li><li> state_change_ha-1139    (    952) [001] .... 610866.506782: tracing_mark_write: E|952|I62</li><li> state_change_ha-1139    (    952) [001] .... 610866.506824: tracing_mark_write: E|952|I62</li><li> state_change_ha-1139    (    952) [001] .... 610866.557458: tracing_mark_write: B|952|H:ProcessEvent, eventId: 0|I62</li><li> state_change_ha-1139    (    952) [001] .... 610866.558060: tracing_mark_write: E|952|I62</li><li> state_change_ha-1139    (    952) [001] .... 610866.558101: tracing_mark_write: E|952|I62</li></ol></pre></div></div>     <p>导出时也可以使用-o命令保存到指定文件，建议保存到/data/local/tmp路径下。</p>     <div _ngcontent-rdu-c106="" class="highlight-div"><div _ngcontent-rdu-c106="" class="highlight-div-header"><div _ngcontent-rdu-c106="" class="highlight-div-header-left"><div _ngcontent-rdu-c106="" class="handle-button expand-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rdu-c106="" class="highlight-div-header-right"><div _ngcontent-rdu-c106="" class="handle-button ai-button"></div><div _ngcontent-rdu-c106="" class="handle-button line-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rdu-c106="" class="handle-button theme-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rdu-c106="" class="handle-button copy-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rdu-c106="" class="highlight-scroll-div"><pre class="shell prettyprint linenums hljs language-shell" hw-language="shell" data-highlighted="yes"><ol class="linenums"><li>hitrace --trace_dump -o /data/local/tmp/test.ftrace</li></ol></pre></div></div>     <p><strong>使用样例</strong>：</p>     <div _ngcontent-rdu-c106="" class="highlight-div"><div _ngcontent-rdu-c106="" class="highlight-div-header"><div _ngcontent-rdu-c106="" class="highlight-div-header-left"><div _ngcontent-rdu-c106="" class="handle-button expand-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rdu-c106="" class="highlight-div-header-right"><div _ngcontent-rdu-c106="" class="handle-button ai-button"></div><div _ngcontent-rdu-c106="" class="handle-button line-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rdu-c106="" class="handle-button theme-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rdu-c106="" class="handle-button copy-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rdu-c106="" class="highlight-scroll-div"><pre class="shell prettyprint linenums hljs language-shell" hw-language="shell" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta prompt_">$ </span><span class="language-bash">hitrace --trace_dump -o /data/local/tmp/test.ftrace</span></li><li>2025/06/04 16:09:10 start to read trace.</li><li>2025/06/04 16:09:10 trace read done, output: /data/local/tmp/test.ftrace</li></ol></pre></div></div>     <p>需要停止采集时，有如下三种命令：</p>     <ol>      <li>       <p>停止采集，并将当前缓冲区内的trace信息显示到命令行窗口。</p>       <div _ngcontent-rdu-c106="" class="highlight-div"><div _ngcontent-rdu-c106="" class="highlight-div-header"><div _ngcontent-rdu-c106="" class="highlight-div-header-left"><div _ngcontent-rdu-c106="" class="handle-button expand-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rdu-c106="" class="highlight-div-header-right"><div _ngcontent-rdu-c106="" class="handle-button ai-button"></div><div _ngcontent-rdu-c106="" class="handle-button line-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rdu-c106="" class="handle-button theme-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rdu-c106="" class="handle-button copy-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rdu-c106="" class="highlight-scroll-div"><pre class="shell prettyprint linenums hljs language-shell" hw-language="shell" data-highlighted="yes"><ol class="linenums"><li>hitrace --trace_finish</li></ol></pre></div></div>       <p><strong>使用样例</strong>：</p>       <div _ngcontent-rdu-c106="" class="highlight-div"><div _ngcontent-rdu-c106="" class="highlight-div-header"><div _ngcontent-rdu-c106="" class="highlight-div-header-left"><div _ngcontent-rdu-c106="" class="handle-button expand-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rdu-c106="" class="highlight-div-header-right"><div _ngcontent-rdu-c106="" class="handle-button ai-button"></div><div _ngcontent-rdu-c106="" class="handle-button line-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rdu-c106="" class="handle-button theme-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rdu-c106="" class="handle-button copy-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rdu-c106="" class="highlight-scroll-div"><pre class="shell prettyprint linenums hljs language-shell" hw-language="shell" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta prompt_">$ </span><span class="language-bash">hitrace --trace_finish</span></li><li>2025/06/04 16:22:02 start to read trace.</li><li><span class="hljs-meta prompt_"># </span><span class="language-bash">tracer: nop</span></li><li><span class="hljs-meta prompt_"># </span><span class="language-bash">                                         _-----=&gt; irqs-off</span></li><li><span class="hljs-meta prompt_"># </span><span class="language-bash">                                        / _----=&gt; need-resched</span></li><li><span class="hljs-meta prompt_"># </span><span class="language-bash">                                       | / _---=&gt; hardirq/softirq</span></li><li><span class="hljs-meta prompt_"># </span><span class="language-bash">                                       || / _--=&gt; preempt-depth</span></li><li><span class="hljs-meta prompt_"># </span><span class="language-bash">                                       ||| /     delay</span></li><li><span class="hljs-meta prompt_"># </span><span class="language-bash">          TASK-PID       TGID    CPU<span class="hljs-comment">#  ||||   TIMESTAMP  FUNCTION</span></span></li><li><span class="hljs-meta prompt_"># </span><span class="language-bash">             | |           |       |   ||||      |         |</span></li><li>KstateRecvThrea-1132    (    952) [002] .... 610865.463378: tracing_mark_write: B|952|H:CheckMsgFromNetlink|I62</li><li>KstateRecvThrea-1132    (    952) [002] .... 610865.463503: tracing_mark_write: B|952|H:OnKstateCallback, mask: 8, data: [PID 14446 KILLED][SIG 9]|I62</li><li>KstateRecvThrea-1132    (    952) [002] .... 610865.463626: tracing_mark_write: E|952|I62</li><li>KstateRecvThrea-1132    (    952) [002] .... 610865.463654: tracing_mark_write: E|952|I62</li></ol></pre></div></div></li>      <li>       <p>停止采集，并将当前缓冲区内的trace信息保存到指定文件。建议保存路径为/data/local/tmp。</p>       <div _ngcontent-rdu-c106="" class="highlight-div"><div _ngcontent-rdu-c106="" class="highlight-div-header"><div _ngcontent-rdu-c106="" class="highlight-div-header-left"><div _ngcontent-rdu-c106="" class="handle-button expand-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rdu-c106="" class="highlight-div-header-right"><div _ngcontent-rdu-c106="" class="handle-button ai-button"></div><div _ngcontent-rdu-c106="" class="handle-button line-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rdu-c106="" class="handle-button theme-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rdu-c106="" class="handle-button copy-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rdu-c106="" class="highlight-scroll-div"><pre class="shell prettyprint linenums hljs language-shell" hw-language="shell" data-highlighted="yes"><ol class="linenums"><li>hitrace --trace_finish -o /data/local/tmp/test.ftrace</li></ol></pre></div></div>       <p><strong>使用样例</strong>：</p>       <div _ngcontent-rdu-c106="" class="highlight-div"><div _ngcontent-rdu-c106="" class="highlight-div-header"><div _ngcontent-rdu-c106="" class="highlight-div-header-left"><div _ngcontent-rdu-c106="" class="handle-button expand-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rdu-c106="" class="highlight-div-header-right"><div _ngcontent-rdu-c106="" class="handle-button ai-button"></div><div _ngcontent-rdu-c106="" class="handle-button line-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rdu-c106="" class="handle-button theme-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rdu-c106="" class="handle-button copy-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rdu-c106="" class="highlight-scroll-div"><pre class="shell prettyprint linenums hljs language-shell" hw-language="shell" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta prompt_">$ </span><span class="language-bash">hitrace --trace_finish -o /data/local/tmp/test.ftrace</span></li><li>2025/06/04 16:24:52 start to read trace.</li><li>2025/06/04 16:24:52 trace read done, output: /data/local/tmp/test.ftrace</li><li>2025/06/04 16:24:52 Trace Closed.</li></ol></pre></div></div></li>      <li>       <p>停止采集，不输出trace信息。</p>       <div _ngcontent-rdu-c106="" class="highlight-div"><div _ngcontent-rdu-c106="" class="highlight-div-header"><div _ngcontent-rdu-c106="" class="highlight-div-header-left"><div _ngcontent-rdu-c106="" class="handle-button expand-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rdu-c106="" class="highlight-div-header-right"><div _ngcontent-rdu-c106="" class="handle-button ai-button"></div><div _ngcontent-rdu-c106="" class="handle-button line-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rdu-c106="" class="handle-button theme-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rdu-c106="" class="handle-button copy-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rdu-c106="" class="highlight-scroll-div"><pre class="shell prettyprint linenums hljs language-shell" hw-language="shell" data-highlighted="yes"><ol class="linenums"><li>hitrace --trace_finish_nodump</li></ol></pre></div></div>       <p><strong>使用样例</strong>：</p>       <div _ngcontent-rdu-c106="" class="highlight-div"><div _ngcontent-rdu-c106="" class="highlight-div-header"><div _ngcontent-rdu-c106="" class="highlight-div-header-left"><div _ngcontent-rdu-c106="" class="handle-button expand-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rdu-c106="" class="highlight-div-header-right"><div _ngcontent-rdu-c106="" class="handle-button ai-button"></div><div _ngcontent-rdu-c106="" class="handle-button line-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rdu-c106="" class="handle-button theme-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rdu-c106="" class="handle-button copy-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rdu-c106="" class="highlight-scroll-div"><pre class="shell prettyprint linenums hljs language-shell" hw-language="shell" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta prompt_">$ </span><span class="language-bash">hitrace --trace_finish_nodump</span></li><li>2025/06/04 16:26:11 hitrace enter, running_state is RECORDING_LONG_FINISH_NODUMP</li><li>2025/06/04 16:26:11 end capture trace.</li></ol></pre></div></div></li>     </ol>    </div>    <div class="tiledSection">     <h3 id="快照模式捕获二进制格式trace">快照模式捕获二进制格式trace<i class="anchor-icon anchor-icon-link" anchorid="快照模式捕获二进制格式trace" tips="复制节点链接"></i></h3>          <p>快照模式下捕获二进制格式trace时不支持指定tag，默认采集以下tag。</p>     <div _ngcontent-rdu-c106="" class="highlight-div"><div _ngcontent-rdu-c106="" class="highlight-div-header"><div _ngcontent-rdu-c106="" class="highlight-div-header-left"><div _ngcontent-rdu-c106="" class="handle-button expand-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rdu-c106="" class="highlight-div-header-right"><div _ngcontent-rdu-c106="" class="handle-button ai-button"></div><div _ngcontent-rdu-c106="" class="handle-button line-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rdu-c106="" class="handle-button theme-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rdu-c106="" class="handle-button copy-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rdu-c106="" class="highlight-scroll-div"><pre class="shell prettyprint linenums hljs language-shell" hw-language="shell" data-highlighted="yes"><ol class="linenums"><li>"net", "dsched", "graphic", "multimodalinput", "dinput", "ark", "ace", "window","zaudio", "daudio", "zmedia", "dcamera", "zcamera", "dhfwk", "app", "gresource", "ability", "power", "samgr", "ffrt", "nweb", "hdf", "virse", "workq", "ipa", "sched", "freq", "disk", "sync", "binder", "mmc", "membus", "load"</li></ol></pre></div></div>     <p>使用下面的命令开启捕获二进制trace。</p>     <div _ngcontent-rdu-c106="" class="highlight-div"><div _ngcontent-rdu-c106="" class="highlight-div-header"><div _ngcontent-rdu-c106="" class="highlight-div-header-left"><div _ngcontent-rdu-c106="" class="handle-button expand-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rdu-c106="" class="highlight-div-header-right"><div _ngcontent-rdu-c106="" class="handle-button ai-button"></div><div _ngcontent-rdu-c106="" class="handle-button line-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rdu-c106="" class="handle-button theme-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rdu-c106="" class="handle-button copy-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rdu-c106="" class="highlight-scroll-div"><pre class="shell prettyprint linenums hljs language-shell" hw-language="shell" data-highlighted="yes"><ol class="linenums"><li>hitrace --start_bgsrv</li></ol></pre></div></div>     <p><strong>使用样例</strong>：</p>     <div _ngcontent-rdu-c106="" class="highlight-div"><div _ngcontent-rdu-c106="" class="highlight-div-header"><div _ngcontent-rdu-c106="" class="highlight-div-header-left"><div _ngcontent-rdu-c106="" class="handle-button expand-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rdu-c106="" class="highlight-div-header-right"><div _ngcontent-rdu-c106="" class="handle-button ai-button"></div><div _ngcontent-rdu-c106="" class="handle-button line-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rdu-c106="" class="handle-button theme-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rdu-c106="" class="handle-button copy-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rdu-c106="" class="highlight-scroll-div"><pre class="shell prettyprint linenums hljs language-shell" hw-language="shell" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta prompt_">$ </span><span class="language-bash">hitrace --start_bgsrv</span></li><li>2025/06/04 16:44:54 hitrace enter, running_state is SNAPSHOT_START</li><li>2025/06/04 16:44:54 OpenSnapshot done.</li></ol></pre></div></div>     <p>使用以下命令将当前缓冲区的trace信息导出到文件。二进制格式trace不支持指定路径导出或显示到命令行窗口，导出的文件路径会显示在命令行窗口。</p>     <div _ngcontent-rdu-c106="" class="highlight-div"><div _ngcontent-rdu-c106="" class="highlight-div-header"><div _ngcontent-rdu-c106="" class="highlight-div-header-left"><div _ngcontent-rdu-c106="" class="handle-button expand-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rdu-c106="" class="highlight-div-header-right"><div _ngcontent-rdu-c106="" class="handle-button ai-button"></div><div _ngcontent-rdu-c106="" class="handle-button line-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rdu-c106="" class="handle-button theme-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rdu-c106="" class="handle-button copy-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rdu-c106="" class="highlight-scroll-div"><pre class="shell prettyprint linenums hljs language-shell" hw-language="shell" data-highlighted="yes"><ol class="linenums"><li>hitrace --dump_bgsrv</li></ol></pre></div></div>     <p><strong>使用样例</strong>：</p>     <div _ngcontent-rdu-c106="" class="highlight-div"><div _ngcontent-rdu-c106="" class="highlight-div-header"><div _ngcontent-rdu-c106="" class="highlight-div-header-left"><div _ngcontent-rdu-c106="" class="handle-button expand-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rdu-c106="" class="highlight-div-header-right"><div _ngcontent-rdu-c106="" class="handle-button ai-button"></div><div _ngcontent-rdu-c106="" class="handle-button line-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rdu-c106="" class="handle-button theme-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rdu-c106="" class="handle-button copy-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rdu-c106="" class="highlight-scroll-div"><pre class="shell prettyprint linenums hljs language-shell" hw-language="shell" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta prompt_">$ </span><span class="language-bash">hitrace --dump_bgsrv</span></li><li>2025/06/04 16:50:34 hitrace enter, running_state is SNAPSHOT_DUMP</li><li>2025/06/04 16:50:35 DumpSnapshot done, output:</li><li>    /data/log/hitrace/trace_20250604164454@613340-339960.sys</li></ol></pre></div></div>     <p>在结束捕获时，可以使用下面的命令停止采集。</p>     <div _ngcontent-rdu-c106="" class="highlight-div"><div _ngcontent-rdu-c106="" class="highlight-div-header"><div _ngcontent-rdu-c106="" class="highlight-div-header-left"><div _ngcontent-rdu-c106="" class="handle-button expand-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rdu-c106="" class="highlight-div-header-right"><div _ngcontent-rdu-c106="" class="handle-button ai-button"></div><div _ngcontent-rdu-c106="" class="handle-button line-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rdu-c106="" class="handle-button theme-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rdu-c106="" class="handle-button copy-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rdu-c106="" class="highlight-scroll-div"><pre class="shell prettyprint linenums hljs language-shell" hw-language="shell" data-highlighted="yes"><ol class="linenums"><li>hitrace --stop_bgsrv</li></ol></pre></div></div>     <p><strong>使用样例</strong>：</p>     <div _ngcontent-rdu-c106="" class="highlight-div"><div _ngcontent-rdu-c106="" class="highlight-div-header"><div _ngcontent-rdu-c106="" class="highlight-div-header-left"><div _ngcontent-rdu-c106="" class="handle-button expand-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rdu-c106="" class="highlight-div-header-right"><div _ngcontent-rdu-c106="" class="handle-button ai-button"></div><div _ngcontent-rdu-c106="" class="handle-button line-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rdu-c106="" class="handle-button theme-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rdu-c106="" class="handle-button copy-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rdu-c106="" class="highlight-scroll-div"><pre class="shell prettyprint linenums hljs language-shell" hw-language="shell" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta prompt_">$ </span><span class="language-bash">hitrace --stop_bgsrv</span></li><li>2025/06/04 16:52:51 hitrace enter, running_state is SNAPSHOT_STOP</li><li>2025/06/04 16:52:52 CloseSnapshot done.</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="录制模式捕获trace">录制模式捕获trace<i class="anchor-icon anchor-icon-link" anchorid="录制模式捕获trace" tips="复制节点链接"></i></h3>          <p>录制模式下，系统会持续保存运行时生成的二进制格式trace，文件大小超过设定的值时会生成新文件。不支持指定保存路径。</p>     <p>使用以下命令开启录制模式。缓冲区大小设定为204800KB，文件大小设为102400KB，采集的tag为app和graphic。</p>     <div _ngcontent-rdu-c106="" class="highlight-div"><div _ngcontent-rdu-c106="" class="highlight-div-header"><div _ngcontent-rdu-c106="" class="highlight-div-header-left"><div _ngcontent-rdu-c106="" class="handle-button expand-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rdu-c106="" class="highlight-div-header-right"><div _ngcontent-rdu-c106="" class="handle-button ai-button"></div><div _ngcontent-rdu-c106="" class="handle-button line-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rdu-c106="" class="handle-button theme-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rdu-c106="" class="handle-button copy-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rdu-c106="" class="highlight-scroll-div"><pre class="shell prettyprint linenums hljs language-shell" hw-language="shell" data-highlighted="yes"><ol class="linenums"><li>hitrace --trace_begin --record -b 204800 --file_size 102400 app graphic</li></ol></pre></div></div>     <p><strong>使用样例</strong>：</p>     <div _ngcontent-rdu-c106="" class="highlight-div"><div _ngcontent-rdu-c106="" class="highlight-div-header"><div _ngcontent-rdu-c106="" class="highlight-div-header-left"><div _ngcontent-rdu-c106="" class="handle-button expand-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rdu-c106="" class="highlight-div-header-right"><div _ngcontent-rdu-c106="" class="handle-button ai-button"></div><div _ngcontent-rdu-c106="" class="handle-button line-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rdu-c106="" class="handle-button theme-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rdu-c106="" class="handle-button copy-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rdu-c106="" class="highlight-scroll-div"><pre class="shell prettyprint linenums hljs language-shell" hw-language="shell" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta prompt_">$ </span><span class="language-bash">hitrace --trace_begin --record -b 204800 --file_size 102400 app graphic</span></li><li>2025/06/04 17:03:37 hitrace enter, running_state is RECORDING_LONG_BEGIN_RECORD</li><li>2025/06/04 17:03:37 args: tags:app,graphic bufferSize:204800 overwrite:1 fileSize:102400</li><li>2025/06/04 17:03:37 trace capturing.</li></ol></pre></div></div>     <p>采集结束时，使用以下命令停止采集，命令行窗口会显示生成的文件的绝对路径。</p>     <div _ngcontent-rdu-c106="" class="highlight-div"><div _ngcontent-rdu-c106="" class="highlight-div-header"><div _ngcontent-rdu-c106="" class="highlight-div-header-left"><div _ngcontent-rdu-c106="" class="handle-button expand-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rdu-c106="" class="highlight-div-header-right"><div _ngcontent-rdu-c106="" class="handle-button ai-button"></div><div _ngcontent-rdu-c106="" class="handle-button line-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rdu-c106="" class="handle-button theme-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rdu-c106="" class="handle-button copy-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rdu-c106="" class="highlight-scroll-div"><pre class="shell prettyprint linenums hljs language-shell" hw-language="shell" data-highlighted="yes"><ol class="linenums"><li>hitrace --trace_finish --record</li></ol></pre></div></div>     <p><strong>使用样例</strong>：</p>     <div _ngcontent-rdu-c106="" class="highlight-div"><div _ngcontent-rdu-c106="" class="highlight-div-header"><div _ngcontent-rdu-c106="" class="highlight-div-header-left"><div _ngcontent-rdu-c106="" class="handle-button expand-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rdu-c106="" class="highlight-div-header-right"><div _ngcontent-rdu-c106="" class="handle-button ai-button"></div><div _ngcontent-rdu-c106="" class="handle-button line-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rdu-c106="" class="handle-button theme-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rdu-c106="" class="handle-button copy-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rdu-c106="" class="highlight-scroll-div"><pre class="shell prettyprint linenums hljs language-shell" hw-language="shell" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta prompt_">$ </span><span class="language-bash">hitrace --trace_finish --record</span></li><li>2025/06/04 17:06:14 hitrace enter, running_state is RECORDING_LONG_FINISH_RECORD</li><li>2025/06/04 17:06:15 capture done, output files:</li><li>    /data/log/hitrace/record_trace_20250604170337@614463-183970330.sys</li><li>    /data/log/hitrace/record_trace_20250604170423@614508-554071886.sys</li><li>    /data/log/hitrace/record_trace_20250604170552@614597-598551039.sys</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="捕获trace后进行压缩">捕获trace后进行压缩<i class="anchor-icon anchor-icon-link" anchorid="捕获trace后进行压缩" tips="复制节点链接"></i></h3>          <div _ngcontent-rdu-c106="" class="highlight-div"><div _ngcontent-rdu-c106="" class="highlight-div-header"><div _ngcontent-rdu-c106="" class="highlight-div-header-left"><div _ngcontent-rdu-c106="" class="handle-button expand-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rdu-c106="" class="highlight-div-header-right"><div _ngcontent-rdu-c106="" class="handle-button ai-button"></div><div _ngcontent-rdu-c106="" class="handle-button line-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rdu-c106="" class="handle-button theme-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rdu-c106="" class="handle-button copy-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rdu-c106="" class="highlight-scroll-div"><pre class="shell prettyprint linenums hljs language-shell" hw-language="shell" data-highlighted="yes"><ol class="linenums"><li>hitrace -z -b 102400 -t 10 sched freq idle disk -o /data/local/tmp/test.ftrace</li></ol></pre></div></div>     <p><strong>使用样例</strong>：</p>     <div _ngcontent-rdu-c106="" class="highlight-div"><div _ngcontent-rdu-c106="" class="highlight-div-header"><div _ngcontent-rdu-c106="" class="highlight-div-header-left"><div _ngcontent-rdu-c106="" class="handle-button expand-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rdu-c106="" class="highlight-div-header-right"><div _ngcontent-rdu-c106="" class="handle-button ai-button"></div><div _ngcontent-rdu-c106="" class="handle-button line-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rdu-c106="" class="handle-button theme-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rdu-c106="" class="handle-button copy-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rdu-c106="" class="highlight-scroll-div"><pre class="shell prettyprint linenums hljs language-shell" hw-language="shell" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta prompt_">$ </span><span class="language-bash">hitrace -z -b 102400 -t 10 <span class="hljs-built_in">sched</span> freq idle disk -o /data/local/tmp/test.ftrace</span></li><li>2024/11/14 12:00:18 start capture, please wait 10s ...</li><li>2024/11/14 12:00:28 capture done, start to read trace.</li><li>2024/11/14 12:00:29 trace read done, output: /data/local/tmp/test.ftrace</li><li>2024/11/14 12:00:29 TraceFinish done.</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="设置和查询trace输出级别阈值">设置和查询trace输出级别阈值<i class="anchor-icon anchor-icon-link" anchorid="设置和查询trace输出级别阈值" tips="复制节点链接"></i></h3>          <p>打点级别优先级从高到低分别为 M（Commercial）、C（Critical）、I（Info）、D（Debug），低于trace输出级别阈值的打点将不会生效。</p>     <p>开发者可使用带trace级别的打点接口（参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-hitracemeter" target="_blank">js-apis-hitracemeter</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-trace-h" target="_blank">_hitrace</a>中的API version 19的trace打点接口），测试不同阈值下的trace输出是否符合预期。</p>     <div _ngcontent-rdu-c106="" class="highlight-div"><div _ngcontent-rdu-c106="" class="highlight-div-header"><div _ngcontent-rdu-c106="" class="highlight-div-header-left"><div _ngcontent-rdu-c106="" class="handle-button expand-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rdu-c106="" class="highlight-div-header-right"><div _ngcontent-rdu-c106="" class="handle-button ai-button"></div><div _ngcontent-rdu-c106="" class="handle-button line-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rdu-c106="" class="handle-button theme-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rdu-c106="" class="handle-button copy-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rdu-c106="" class="highlight-scroll-div"><pre class="shell prettyprint linenums hljs language-shell" hw-language="shell" data-highlighted="yes"><ol class="linenums"><li>// 设置trace输出级别阈值</li><li>hitrace --trace_level D/I/C/M</li><li>hitrace --trace_level Debug/Info/Critical/Commercial</li><li>// 查询trace输出级别阈值</li><li>hitrace --get_level</li></ol></pre></div></div>     <p><strong>使用样例</strong>：</p>     <div _ngcontent-rdu-c106="" class="highlight-div"><div _ngcontent-rdu-c106="" class="highlight-div-header"><div _ngcontent-rdu-c106="" class="highlight-div-header-left"><div _ngcontent-rdu-c106="" class="handle-button expand-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rdu-c106="" class="highlight-div-header-right"><div _ngcontent-rdu-c106="" class="handle-button ai-button"></div><div _ngcontent-rdu-c106="" class="handle-button line-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rdu-c106="" class="handle-button theme-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rdu-c106="" class="handle-button copy-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rdu-c106="" class="highlight-scroll-div"><pre class="shell prettyprint linenums hljs language-shell" hw-language="shell" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta prompt_">$ </span><span class="language-bash">hitrace --trace_level Info</span></li><li>2025/08/16 10:34:23 hitrace enter, running_state is SET_TRACE_LEVEL</li><li>2025/08/16 10:34:23 success to set trace level.</li><li><span class="hljs-meta prompt_">$ </span><span class="language-bash">hitrace --get_level</span></li><li>2025/08/16 10:34:29 hitrace enter, running_state is GET_TRACE_LEVEL</li><li>2025/08/16 10:34:29 the current trace level threshold is Info</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="trace文件名说明">trace文件名说明<i class="anchor-icon anchor-icon-link" anchorid="trace文件名说明" tips="复制节点链接"></i></h2>          <p>使用hitrace命令行工具采集二进制格式trace信息时，不支持指定文件路径。默认保存在/data/log/hitrace路径下，hitrace自动生成文件名并将绝对路径显示在命令行窗口。</p>     <p>快照模式下生成的trace文件名以trace开头，录制模式下生成的trace文件名以record开头，后面为本地时间和boot time（从开机时间开始的时间戳）。</p>     <p>以下面这个文件名为例：20250701215441说明这个文件生成的时间为2025年7月1日21时54分41秒，此时对应的boot time为6016.653165227。</p>     <div _ngcontent-rdu-c106="" class="highlight-div"><div _ngcontent-rdu-c106="" class="highlight-div-header"><div _ngcontent-rdu-c106="" class="highlight-div-header-left"><div _ngcontent-rdu-c106="" class="handle-button expand-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rdu-c106="" class="highlight-div-header-right"><div _ngcontent-rdu-c106="" class="handle-button ai-button"></div><div _ngcontent-rdu-c106="" class="handle-button line-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rdu-c106="" class="handle-button theme-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rdu-c106="" class="handle-button copy-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rdu-c106="" class="highlight-scroll-div"><pre class="shell prettyprint linenums hljs language-shell" hw-language="shell" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta prompt_">$ </span><span class="language-bash">hitrace --dump_bgsrv</span></li><li>2025/07/01 21:54:41 hitrace enter, running_state is SNAPSHOT_DUMP</li><li>2025/07/01 21:54:42 DumpSnapshot done, output:</li><li>    /data/log/hitrace/trace_20250701215441@6016-653165227.sys</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="常见问题">常见问题<i class="anchor-icon anchor-icon-link" anchorid="常见问题" tips="复制节点链接"></i></h2>         </div>    <div class="tiledSection">     <h3 id="执行hitrace命令后显示错误码1" class="firsth2">执行hitrace命令后显示错误码1<i class="anchor-icon anchor-icon-link" anchorid="执行hitrace命令后显示错误码1" tips="复制节点链接"></i></h3>          <p><strong>现象描述</strong></p>     <p>执行hitrace命令后报错，错误码为1。</p>     <div _ngcontent-rdu-c106="" class="highlight-div"><div _ngcontent-rdu-c106="" class="highlight-div-header"><div _ngcontent-rdu-c106="" class="highlight-div-header-left"><div _ngcontent-rdu-c106="" class="handle-button expand-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rdu-c106="" class="highlight-div-header-right"><div _ngcontent-rdu-c106="" class="handle-button ai-button"></div><div _ngcontent-rdu-c106="" class="handle-button line-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rdu-c106="" class="handle-button theme-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rdu-c106="" class="handle-button copy-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rdu-c106="" class="highlight-scroll-div"><pre class="shell prettyprint linenums hljs language-shell" hw-language="shell" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta prompt_">$ </span><span class="language-bash">hitrace --dump_bgsrv</span></li><li>2025/07/04 17:20:38 hitrace enter, running_state is SNAPSHOT_DUMP</li><li>2025/07/04 17:20:38 error: DumpSnapshot failed, errorCode(1)</li></ol></pre></div></div>     <p><strong>可能原因&amp;解决方法</strong></p>     <p>错误码1表示hiview进程状态异常，可以尝试重启手机后重新采集。</p>    </div>    <div class="tiledSection">     <h3 id="执行hitrace命令后报错not-support-category-on-this-device">执行hitrace命令后报错“not support category on this device”<i class="anchor-icon anchor-icon-link" anchorid="执行hitrace命令后报错not-support-category-on-this-device" tips="复制节点链接"></i></h3>          <p><strong>现象描述</strong></p>     <p>执行hitrace命令后报错，命令行窗口显示“not support category on this device”。</p>     <div _ngcontent-rdu-c106="" class="highlight-div"><div _ngcontent-rdu-c106="" class="highlight-div-header"><div _ngcontent-rdu-c106="" class="highlight-div-header-left"><div _ngcontent-rdu-c106="" class="handle-button expand-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rdu-c106="" class="highlight-div-header-right"><div _ngcontent-rdu-c106="" class="handle-button ai-button"></div><div _ngcontent-rdu-c106="" class="handle-button line-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rdu-c106="" class="handle-button theme-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rdu-c106="" class="handle-button copy-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rdu-c106="" class="highlight-scroll-div"><pre class="shell prettyprint linenums hljs language-shell" hw-language="shell" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta prompt_">$ </span><span class="language-bash">hitrace -t 10 aaa</span></li><li>2025/07/04 17:24:21 error: aaa is not support category on this device.</li><li>2025/07/04 17:24:21 error: parsing args failed, exit.</li></ol></pre></div></div>     <p><strong>可能原因&amp;解决方法</strong></p>     <p>命令中指定的tag不存在，建议使用“hitrace -l”命令查看支持的tag范围。</p>    </div>    <div class="tiledSection">     <h3 id="执行hitrace命令后显示错误码1004">执行hitrace命令后显示错误码1004<i class="anchor-icon anchor-icon-link" anchorid="执行hitrace命令后显示错误码1004" tips="复制节点链接"></i></h3>          <p><strong>现象描述</strong></p>     <p>执行hitrace命令后报错，错误码为1004。</p>     <div _ngcontent-rdu-c106="" class="highlight-div"><div _ngcontent-rdu-c106="" class="highlight-div-header"><div _ngcontent-rdu-c106="" class="highlight-div-header-left"><div _ngcontent-rdu-c106="" class="handle-button expand-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rdu-c106="" class="highlight-div-header-right"><div _ngcontent-rdu-c106="" class="handle-button ai-button"></div><div _ngcontent-rdu-c106="" class="handle-button line-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rdu-c106="" class="handle-button theme-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rdu-c106="" class="handle-button copy-button"><div _ngcontent-rdu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rdu-c106="" class="highlight-scroll-div"><pre class="shell prettyprint linenums hljs language-shell" hw-language="shell" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta prompt_">$ </span><span class="language-bash">hitrace --dump_bgsrv</span></li><li>2025/07/04 17:25:58 hitrace enter, running_state is SNAPSHOT_DUMP</li><li>2025/07/04 17:25:58 error: DumpSnapshot failed, errorCode(1004)</li></ol></pre></div></div>     <p><strong>可能原因&amp;解决方法</strong></p>     <p>1004表示写入文件错误，可能的原因包括：</p>     <ol>      <li>       <p>采集文本格式trace时，使用-o参数指定输出的文件路径不存在或无权限。建议将trace保存到/data/local/tmp路径下。</p></li>      <li>       <p>磁盘空间已满时，不会生成新的trace文件，建议释放磁盘空间，确保空闲空间大于500MB，然后重新采集。</p></li>     </ol>    </div>   </div>   <div></div></div>