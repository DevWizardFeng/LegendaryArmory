<h1 _ngcontent-srp-c119="" class="doc-title ng-star-inserted" title="ohpm-repo deploy"> ohpm-repo deploy </h1>

<div _ngcontent-srp-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div id="body0000001796357497"><p id="ZH-CN_TOPIC_0000002478333722__zh-cn_topic_0000001745217290_p1677270292171146">使用备份文件部署新的ohpm-repo实例。</p> <div class="tiledSection"><h2 id="section154219368103">前提条件<i class="anchor-icon anchor-icon-link" anchorid="section154219368103" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002478333722__p1062571765515">已获得由<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-ohpm-repo-pack">pack 命令</a>打包的.zip文件。</p> </div> <div class="tiledSection"><h2 id="zh-cn_topic_0000001745217290_命令格式">命令格式<i class="anchor-icon anchor-icon-link" anchorid="zh-cn_topic_0000001745217290_命令格式" tips="复制节点链接"></i></h2><div _ngcontent-srp-c106="" class="highlight-div"><div _ngcontent-srp-c106="" class="highlight-div-header"><div _ngcontent-srp-c106="" class="highlight-div-header-left"><div _ngcontent-srp-c106="" class="handle-button expand-button"><div _ngcontent-srp-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-srp-c106="" class="highlight-div-header-right"><div _ngcontent-srp-c106="" class="handle-button ai-button"></div><div _ngcontent-srp-c106="" class="handle-button line-button"><div _ngcontent-srp-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-srp-c106="" class="handle-button theme-button"><div _ngcontent-srp-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-srp-c106="" class="handle-button copy-button"><div _ngcontent-srp-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-srp-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" id="ZH-CN_TOPIC_0000002478333722__zh-cn_topic_0000001745217290_screen460374229171146" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-variable">ohpm</span>-<span class="hljs-variable">repo</span> <span class="hljs-title class_">deploy</span> &lt;<span class="hljs-title class_">file_path</span>&gt; [<span class="hljs-variable">options</span>]</li></ol></pre></div></div> </div> <div class="tiledSection"><h2 id="zh-cn_topic_0000001745217290_功能描述">功能描述<i class="anchor-icon anchor-icon-link" anchorid="zh-cn_topic_0000001745217290_功能描述" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002478333722__zh-cn_topic_0000001745217290_p2052759684171146">命令将使用由ohpm-repo pack得到的打包产物部署新的ohpm-repo实例。 命令要求数据存储必须使用mysql，文件存储必须使用sftp或者custom ，且在命令执行时，会检查数据库mysql中存储的ohpm-repo实例列表与配置的sftp或者custom存储目录中的ohpm-repo实例列表是否一致，若不一致则命令执行失败。</p> </div> <div class="tiledSection"><h2 id="zh-cn_topic_0000001745217290_参数">参数<i class="anchor-icon anchor-icon-link" anchorid="zh-cn_topic_0000001745217290_参数" tips="复制节点链接"></i></h2></div> <div class="tiledSection"><h3 id="zh-cn_topic_0000001745217290_file_path" class="firsth2">&lt;file_path&gt;<i class="anchor-icon anchor-icon-link" anchorid="zh-cn_topic_0000001745217290_file_path" tips="复制节点链接"></i></h3><ul id="ZH-CN_TOPIC_0000002478333722__zh-cn_topic_0000001745217290_ul12318011171146"><li id="zh-cn_topic_0000001745217290_li1197985604171146">类型：String</li><li id="zh-cn_topic_0000001745217290_li45678886171146">必填参数</li></ul> <p id="ZH-CN_TOPIC_0000002478333722__zh-cn_topic_0000001745217290_p1307658141171146">必须在deploy命令后面配置&lt;file_path&gt;参数，指定打包产物路径。</p> </div> <div class="tiledSection"><h2 id="zh-cn_topic_0000001745217290_选项">选项<i class="anchor-icon anchor-icon-link" anchorid="zh-cn_topic_0000001745217290_选项" tips="复制节点链接"></i></h2></div> <div class="tiledSection"><h3 id="zh-cn_topic_0000001745217290_deploy_root" class="firsth2">deploy_root<i class="anchor-icon anchor-icon-link" anchorid="zh-cn_topic_0000001745217290_deploy_root" tips="复制节点链接"></i></h3><ul id="ZH-CN_TOPIC_0000002478333722__zh-cn_topic_0000001745217290_ul225242714171146"><li id="zh-cn_topic_0000001745217290_li1269097168171146">windows系统默认值："~/AppData/Roaming/Huawei/ohpm-repo"</li><li id="zh-cn_topic_0000001745217290_li829053185171146">其他系统默认值："~/ohpm-repo"</li><li id="zh-cn_topic_0000001745217290_li380012120171146">类型： String</li></ul> <p id="ZH-CN_TOPIC_0000002478333722__zh-cn_topic_0000001745217290_p277144341171146">可以在deploy命令后面配置--deploy_root &lt;string&gt;参数，未配置将使用默认值。支持相对和绝对路径配置，当配置为相对路径时，以当前命令行工作路径为根目录。</p> </div> <div class="tiledSection"><h3 id="zh-cn_topic_0000001745217290_logs">logs<i class="anchor-icon anchor-icon-link" anchorid="zh-cn_topic_0000001745217290_logs" tips="复制节点链接"></i></h3><ul id="ZH-CN_TOPIC_0000002478333722__zh-cn_topic_0000001745217290_ul1256423128171146"><li id="zh-cn_topic_0000001745217290_li1271503323171146">类型： String</li></ul> <p id="ZH-CN_TOPIC_0000002478333722__zh-cn_topic_0000001745217290_p1697620246171146">可以在deploy命令后面配置--logs &lt;string&gt;参数，指定log目录，优先级高于config.yaml中的配置，支持相对和绝对路径配置，当配置为相对路径时，以当前命令行工作路径为根目录。</p> </div> <div class="tiledSection"><h3 id="zh-cn_topic_0000001745217290_uplinkcachepath">uplinkCachePath<i class="anchor-icon anchor-icon-link" anchorid="zh-cn_topic_0000001745217290_uplinkcachepath" tips="复制节点链接"></i></h3><ul id="ZH-CN_TOPIC_0000002478333722__zh-cn_topic_0000001745217290_ul1583583848171146"><li id="zh-cn_topic_0000001745217290_li461523226171146">类型： String</li></ul> <p id="ZH-CN_TOPIC_0000002478333722__zh-cn_topic_0000001745217290_p1519979818171146">可以在deploy命令后面配置--uplinkCachePath &lt;string&gt;参数，指定远程包缓存路径，优先级高于config.yaml中的配置，支持相对和绝对路径配置，当配置为相对路径时，以当前命令行工作路径为根目录。</p> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p id="ZH-CN_TOPIC_0000002478333722__zh-cn_topic_0000001745217290_p214775355811">部署实例成功后，命令行所配置的deploy_root，logs和uplinkCachePath会写入到运行时配置文件中，可从&lt;deploy_root&gt;/conf目录中的配置文件config.yaml中查看。</p> </div></div></div> </div> <div class="tiledSection"><h3 id="section11983224184512">skip-db<i class="anchor-icon anchor-icon-link" anchorid="section11983224184512" tips="复制节点链接"></i></h3><ul id="ZH-CN_TOPIC_0000002478333722__ul1591211411014"><li id="li149127411019">默认值：false</li><li id="li1771371308">类型：Boolean</li><li id="li1399516186013">别名：sd</li></ul> <p id="ZH-CN_TOPIC_0000002478333722__p13895834503">在deploy命令后面配置-sd或者--skip-db，指定是否跳过对mysql数据库中数据表的初始化；默认会读取ohpm-repo解压目录中的schema.sql文件，对mysql数据库中的表进行初始化。</p> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p id="ZH-CN_TOPIC_0000002478333722__p16544625112">在ohpm-repo配置文件config.yaml中，配置项db.type只有为mysql时，此参数才生效。</p> </div></div></div> </div> <div class="tiledSection"><h2 id="zh-cn_topic_0000001745217290_示例">示例<i class="anchor-icon anchor-icon-link" anchorid="zh-cn_topic_0000001745217290_示例" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002478333722__zh-cn_topic_0000001745217290_p1748226806171146">执行以下命令：</p> <div _ngcontent-srp-c106="" class="highlight-div"><div _ngcontent-srp-c106="" class="highlight-div-header"><div _ngcontent-srp-c106="" class="highlight-div-header-left"><div _ngcontent-srp-c106="" class="handle-button expand-button"><div _ngcontent-srp-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-srp-c106="" class="highlight-div-header-right"><div _ngcontent-srp-c106="" class="handle-button ai-button"></div><div _ngcontent-srp-c106="" class="handle-button line-button"><div _ngcontent-srp-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-srp-c106="" class="handle-button theme-button"><div _ngcontent-srp-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-srp-c106="" class="handle-button copy-button"><div _ngcontent-srp-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-srp-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" id="ZH-CN_TOPIC_0000002478333722__zh-cn_topic_0000001745217290_screen574479325171146" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-variable">ohpm</span>-<span class="hljs-variable">repo</span> <span class="hljs-variable">deploy</span> <span class="hljs-variable">D</span>:\<span class="hljs-title class_">ohpm</span>-<span class="hljs-title class_">repo</span>\<span class="hljs-title class_">bin</span>\<span class="hljs-title class_">pack_1695805599689</span>.<span class="hljs-title class_">zip</span> --<span class="hljs-title class_">deploy_root</span> <span class="hljs-title class_">D</span>:\<span class="hljs-title class_">new</span>-<span class="hljs-title class_">ohpm</span>-<span class="hljs-title class_">repo</span>\<span class="hljs-title class_">ohpm</span>-<span class="hljs-title class_">repo</span>-<span class="hljs-title class_">deploy</span></li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002478333722__zh-cn_topic_0000001745217290_p2087051215171146">结果示例：</p> <p id="ZH-CN_TOPIC_0000002478333722__zh-cn_topic_0000001745217290_p15723174104214"><span><img height="112.803285" originheight="175" originwidth="1097" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104736.75231806521335747262467390546898:50001231000000:2800:89D957636ED8200336F45805C5CBB5DE989D05B0DD4E417E62C2F0A0640261FD.png" title="点击放大" width="707.2275000000001"></span></p> </div> </div> <div></div></div>