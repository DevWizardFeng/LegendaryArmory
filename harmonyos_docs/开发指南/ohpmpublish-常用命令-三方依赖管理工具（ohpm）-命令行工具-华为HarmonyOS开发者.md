<h1 _ngcontent-euc-c119="" class="doc-title ng-star-inserted" title="ohpm publish"> ohpm publish </h1>

<div _ngcontent-euc-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div id="body0000001796357437">    <p id="ZH-CN_TOPIC_0000002510294265__zh-cn_topic_0000001792256145_p1571292671204137">发布一个三方库。</p>    <div class="tiledSection">     <h2 id="zh-cn_topic_0000001792256145_命令格式">命令格式<i class="anchor-icon anchor-icon-link" anchorid="zh-cn_topic_0000001792256145_命令格式" tips="复制节点链接"></i></h2>          <div _ngcontent-euc-c106="" class="highlight-div"><div _ngcontent-euc-c106="" class="highlight-div-header"><div _ngcontent-euc-c106="" class="highlight-div-header-left"><div _ngcontent-euc-c106="" class="handle-button expand-button"><div _ngcontent-euc-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-euc-c106="" class="highlight-div-header-right"><div _ngcontent-euc-c106="" class="handle-button ai-button"></div><div _ngcontent-euc-c106="" class="handle-button line-button"><div _ngcontent-euc-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-euc-c106="" class="handle-button theme-button"><div _ngcontent-euc-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-euc-c106="" class="handle-button copy-button"><div _ngcontent-euc-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-euc-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-css" id="ZH-CN_TOPIC_0000002510294265__zh-cn_topic_0000001792256145_screen845190943204137" data-highlighted="yes"><ol class="linenums"><li>ohpm publish <span class="hljs-selector-attr">[options]</span> &lt;har_or_tgz_file&gt;</li></ol></pre></div></div>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <ul id="ZH-CN_TOPIC_0000002510294265__zh-cn_topic_0000001792256145_ul464978000204137">        <li id="zh-cn_topic_0000001792256145_li1415466166204137">har_or_tgz_file：压缩包路径，可以是 .har 包格式和由 hsp 模块打包出来的 .tgz 包格式，必选参数。</li>        <li id="li22345488010">ohpm 命令行 1.3.0 之前版本仅支持发布 .har 包，从 1.3.0 版本开始支持发布 .tgz 包。</li>        <li id="li5916916172913">ohpm命令行 5.0.1 版本开始支持发布与下载最大300M的.har/.tgz包。</li>       </ul>      </div></div></div>    </div>    <div class="tiledSection">     <h2 id="zh-cn_topic_0000001792256145_功能描述">功能描述<i class="anchor-icon anchor-icon-link" anchorid="zh-cn_topic_0000001792256145_功能描述" tips="复制节点链接"></i></h2>          <ul id="ZH-CN_TOPIC_0000002510294265__ul53507166017">      <li id="li153504161604">将三方库发布到 OpenHarmony 三方库中心仓，以便可按名称安装它。 发布前，需要完成公钥私钥生成，把公钥上传服务端，并在ohpmrc 文件中配置公仓的发布码和私钥路径。</li>      <li id="li1135071610016">默认情况下，ohpm 将发布到 <a href="https://ohpm.openharmony.cn/#/cn/home" target="_blank">OpenHarmony 三方库中心仓</a>，但仍可以通过指定不同的 publish_registry 值（详情可查阅 <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-ohpmrc">ohpmrc</a> 章节 中 publish_registry 描述信息），发布到指定的仓库。</li>      <li id="li435011161901">如果指定的仓库中已存在三方库名称和版本组合，则发布失败。</li>      <li id="li1635015166019">一旦三方库以给定的名称和版本发布并审核通过后，该特定名称及对应的版本号将被占用，无法再次使用，即使它已被 <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-ohpm-unpublish">ohpm unpublish</a> 下架。</li>     </ul>     <div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content">       <ul id="ZH-CN_TOPIC_0000002510294265__ul20489831113012">        <li id="li10489153116301">为了保证.har 和 .tgz 包的编译与运行正常，包中的 oh-package.json5 必须包含该包的所有直接依赖，若有依赖通过项目级别的 oh-package.json5 引入，则相应的依赖也必须写入包中对应的 oh-package.json5 中。</li>        <li id="li201871135249">请注意debug模式构建的HAR包中含有源码，便于本地调试，请注意代码安全，详细请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-hvigor-build-har">构建HAR</a>。</li>        <li id="li14104173473018">发布包前请务必检查待发布包 oh-package.json5 的配置是否满足要求，具体要求请参考：<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-oh-package-json5#zh-cn_topic_0000001792256137_oh-packagejson5-字段说明">oh-package.json5 字段说明</a></li>       </ul>      </div></div></div>    </div>    <div class="tiledSection">     <h2 id="zh-cn_topic_0000001792256145_发布校验规则">发布校验规则<i class="anchor-icon anchor-icon-link" anchorid="zh-cn_topic_0000001792256145_发布校验规则" tips="复制节点链接"></i></h2>         </div>    <div class="tiledSection">     <h3 id="zh-cn_topic_0000001792256145_三方库校验规则" class="firsth2">三方库校验规则<i class="anchor-icon anchor-icon-link" anchorid="zh-cn_topic_0000001792256145_三方库校验规则" tips="复制节点链接"></i></h3>          <ol id="ZH-CN_TOPIC_0000002510294265__zh-cn_topic_0000001792256145_ol93424175204137">      <li id="zh-cn_topic_0000001792256145_li1986083878204137">ohpm打包的三方库须以.har和.tgz作为其扩展名；</li>      <li id="zh-cn_topic_0000001792256145_li1628644775204137">三方库所有内容须放置在package目录内，且package目录内需包含oh-package.json5配置文件、README.md文件、LICENSE文件和CHANGELOG.md文件，其中oh-package.json5配置文件须包含必选字段（请参阅<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-oh-package-json5">oh-package.json5</a>文件字段说明）；       <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">         <p id="ZH-CN_TOPIC_0000002510294265__p691511516262">README.md文件、LICENSE文件和CHANGELOG.md三个文件在该HAR包发布至<a href="https://ohpm.openharmony.cn/#/cn/help/publishrequirefile" target="_blank">OpenHarmony 三方库中心仓</a>时必须包含，且不能为空。</p>        </div></div></div></li>      <li id="li20991273410">将package目录压缩为tgz包，并将后缀名改为.har，即可获得三方库的HAR包。</li>     </ol>    </div>    <div class="tiledSection">     <h3 id="zh-cn_topic_0000001792256145_开闭源规则">开闭源规则<i class="anchor-icon anchor-icon-link" anchorid="zh-cn_topic_0000001792256145_开闭源规则" tips="复制节点链接"></i></h3>          <ol id="ZH-CN_TOPIC_0000002510294265__zh-cn_topic_0000001792256145_ol329138499204137">      <li id="zh-cn_topic_0000001792256145_li1408680688204137">       <p id="ZH-CN_TOPIC_0000002510294265__zh-cn_topic_0000001792256145_p1097515580204137">开源</p>       <p id="ZH-CN_TOPIC_0000002510294265__zh-cn_topic_0000001792256145_p1482758362204137">不进行 ArkTS 代码相关编译的，只进行 cpp 代码编译和 OpenHarmony 资源处理，还有模块的部分原始配置文件会被打包。其 oh-package.json5 文件中的 "artifactType" 字段值为 original。</p></li>      <li id="zh-cn_topic_0000001792256145_li1461078437204137">       <p id="ZH-CN_TOPIC_0000002510294265__zh-cn_topic_0000001792256145_p1919451781204137">闭源</p>       <p id="ZH-CN_TOPIC_0000002510294265__zh-cn_topic_0000001792256145_p530866268204137">ArkTS 代码会被编译成混淆的 js 和 d.ets 和 d.ts 等声明文件，进行 cpp 代码编译和 OpenHarmony 资源处理，还有模块的部分原始配置文件会被打包。其 oh-package.json5 文件中 "artifactType" 属性值为 obfuscation。此时则检查 oh-package.json5 文件中 "types" 属性中定义的声明文件是否带有扩展名 ".d.ts/.d.ets"，且对应路径下存在该文件。若无则进行报错，且不会发布。</p></li>     </ol>    </div>    <div class="tiledSection">     <h2 id="zh-cn_topic_0000001792256145_options">Options<i class="anchor-icon anchor-icon-link" anchorid="zh-cn_topic_0000001792256145_options" tips="复制节点链接"></i></h2>         </div>    <div class="tiledSection">     <h3 id="section10937415125116" class="firsth2">publish_id<i class="anchor-icon anchor-icon-link" anchorid="section10937415125116" tips="复制节点链接"></i></h3>          <ul id="ZH-CN_TOPIC_0000002510294265__ul11219193016517">      <li id="li021923012512">默认值：""</li>      <li id="li182191330185113">类型：String</li>     </ul>     <p id="ZH-CN_TOPIC_0000002510294265__p6219193065113">可以在 publish 命令后面配置 --publish_id &lt;id&gt; 参数，指定发布码。</p>    </div>    <div class="tiledSection">     <h3 id="section1259174395215">key_path<i class="anchor-icon anchor-icon-link" anchorid="section1259174395215" tips="复制节点链接"></i></h3>          <ul id="ZH-CN_TOPIC_0000002510294265__ul188541354175218">      <li id="li385465465210">默认值：""</li>      <li id="li1854155445218">类型：String</li>     </ul>     <p id="ZH-CN_TOPIC_0000002510294265__p4854185435210">可以在 publish 命令后面配置 --key_path &lt;p&gt; 参数，指定ssh私钥路径。</p>    </div>    <div class="tiledSection">     <h3 id="zh-cn_topic_0000001792256145_tag">tag<i class="anchor-icon anchor-icon-link" anchorid="zh-cn_topic_0000001792256145_tag" tips="复制节点链接"></i></h3>          <ul id="ZH-CN_TOPIC_0000002510294265__zh-cn_topic_0000001792256145_ul1021226189204137">      <li id="zh-cn_topic_0000001792256145_li980305980204137">默认值：无</li>      <li id="zh-cn_topic_0000001792256145_li73356457204137">类型：String</li>      <li id="zh-cn_topic_0000001792256145_li244738067204137">别名：t</li>     </ul>     <p id="ZH-CN_TOPIC_0000002510294265__zh-cn_topic_0000001792256145_p1281930221204137">可以在 publish 命令后面配置 -t &lt;tag_name&gt;或者 --tag &lt;tag_name&gt; 参数，给将要发布的三方库打上标签。</p>    </div>    <div class="tiledSection">     <h3 id="zh-cn_topic_0000001792256145_publish_registry">publish_registry<i class="anchor-icon anchor-icon-link" anchorid="zh-cn_topic_0000001792256145_publish_registry" tips="复制节点链接"></i></h3>          <ul id="ZH-CN_TOPIC_0000002510294265__zh-cn_topic_0000001792256145_ul267704099204137">      <li id="zh-cn_topic_0000001792256145_li446305995204137">默认值：""</li>      <li id="zh-cn_topic_0000001792256145_li1886279686204137">类型：URL</li>     </ul>     <p id="ZH-CN_TOPIC_0000002510294265__zh-cn_topic_0000001792256145_p925157274204137">可以在 publish 命令后面配置 --publish_registry &lt;r&gt; 参数，指定发布仓库地址。如果未指定，默认从配置中获取发布仓库地址。</p>    </div>    <div class="tiledSection">     <h3 id="zh-cn_topic_0000001792256145_fetch_timeout">fetch_timeout<i class="anchor-icon anchor-icon-link" anchorid="zh-cn_topic_0000001792256145_fetch_timeout" tips="复制节点链接"></i></h3>          <ul id="ZH-CN_TOPIC_0000002510294265__zh-cn_topic_0000001792256145_ul1234407645204137">      <li id="zh-cn_topic_0000001792256145_li1347809524204137">默认值：60000</li>      <li id="zh-cn_topic_0000001792256145_li1094095951204137">类型： Number</li>      <li id="zh-cn_topic_0000001792256145_li1753555120204137">别名：ft</li>     </ul>     <p id="ZH-CN_TOPIC_0000002510294265__zh-cn_topic_0000001792256145_p137827259204137">可以在 publish 命令后面配置 --ft &lt;number&gt;或者 --fetch_timeout &lt;number&gt; 参数，设置操作的超时时间，如果没有指定，默认超时时间为60000ms。</p>    </div>    <div class="tiledSection">     <h3 id="zh-cn_topic_0000001792256145_strict_ssl">strict_ssl<i class="anchor-icon anchor-icon-link" anchorid="zh-cn_topic_0000001792256145_strict_ssl" tips="复制节点链接"></i></h3>          <ul id="ZH-CN_TOPIC_0000002510294265__zh-cn_topic_0000001792256145_ul697136662204137">      <li id="zh-cn_topic_0000001792256145_li1919960674204137">默认值：true</li>      <li id="zh-cn_topic_0000001792256145_li1580339764204137">类型： Boolean</li>     </ul>     <p id="ZH-CN_TOPIC_0000002510294265__zh-cn_topic_0000001792256145_p330125925204137">可以在 publish 命令后面配置 --strict_ssl true 参数，校验 https 证书；配置 --strict_ssl false 参数，不校验 https 证书。</p>    </div>    <div class="tiledSection">     <h2 id="zh-cn_topic_0000001792256145_示例">示例<i class="anchor-icon anchor-icon-link" anchorid="zh-cn_topic_0000001792256145_示例" tips="复制节点链接"></i></h2>          <p id="ZH-CN_TOPIC_0000002510294265__zh-cn_topic_0000001792256145_p316210891204137">发布工作目录下的三方库，执行以下命令：</p>     <div _ngcontent-euc-c106="" class="highlight-div"><div _ngcontent-euc-c106="" class="highlight-div-header"><div _ngcontent-euc-c106="" class="highlight-div-header-left"><div _ngcontent-euc-c106="" class="handle-button expand-button"><div _ngcontent-euc-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-euc-c106="" class="highlight-div-header-right"><div _ngcontent-euc-c106="" class="handle-button ai-button"></div><div _ngcontent-euc-c106="" class="handle-button line-button"><div _ngcontent-euc-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-euc-c106="" class="handle-button theme-button"><div _ngcontent-euc-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-euc-c106="" class="handle-button copy-button"><div _ngcontent-euc-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-euc-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-undefined" id="ZH-CN_TOPIC_0000002510294265__zh-cn_topic_0000001792256145_screen1348780636204137" data-highlighted="yes"><ol class="linenums"><li>ohpm publish publish_test.har</li></ol></pre></div></div>     <p id="ZH-CN_TOPIC_0000002510294265__zh-cn_topic_0000001792256145_p717266427204137">结果示例：</p>     <p id="ZH-CN_TOPIC_0000002510294265__zh-cn_topic_0000001792256145_p1526514489618"><span><img originheight="579" originwidth="570" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104949.18067288789053554311414807111665:50001231000000:2800:E4703BDEE518CB55E79D1D1110F402C4C58DF38D9FD3C33285CF5EBB42B0D869.png" width="570" height="579"></span></p>    </div>   </div>   <div></div></div>