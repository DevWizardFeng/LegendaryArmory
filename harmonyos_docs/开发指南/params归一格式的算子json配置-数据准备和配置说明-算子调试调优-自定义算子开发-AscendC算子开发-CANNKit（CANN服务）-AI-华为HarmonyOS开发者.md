<h1 _ngcontent-jao-c119="" class="doc-title ng-star-inserted" title="params归一格式的算子json配置"> params归一格式的算子json配置 </h1>

<div _ngcontent-jao-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div><div class="tiledSection"><h2 id="section1531mcpsimp">json配置说明<i class="anchor-icon anchor-icon-link" anchorid="section1531mcpsimp" tips="复制节点链接"></i></h2><p>为了支持输入/输出参数交叉配置的场景，params归一配置格式应运而生，所有输入/输出参数均放在“params”配置项中。该算子json配置文件中参数可以按<strong>输入/输出规则排布</strong>，也可以按<strong>输入/输出交叉排布</strong>，只要保证参数顺序与Kernel入口函数的参数顺序保持一致即可。</p> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><ul><li><strong>调试工具暂不支持该配置</strong>。</li></ul> <ul><li><strong>输入/输出规则排布</strong>（所有输出参数排布在输入参数之后）：例如Kernel入口函数的参数排布为extern "C" __global__ __aicore__ void add_custom(GM_ADDR input1, GM_ADDR input2, GM_ADDR  input3,<strong> GM_ADDR output</strong>)。</li></ul> <ul><li><strong>输入/输出交叉排布</strong>（输入/输出参数排布顺序有交叉）：例如Kernel入口函数的参数排布为extern "C" __global__ __aicore__ void add_custom(GM_ADDR input1, GM_ADDR input2, <strong>GM_ADDR output</strong>, GM_ADDR input3)，output参数排在input3之前。</li></ul> <ul><li><strong>核函数直调工程场景</strong>的开发人员一般按此方式配置。</li></ul> </div></div></div> <p>以AddCustom算子为例，对应的json配置示例如下，参数说明参见表1。</p> <div _ngcontent-jao-c106="" class="highlight-div"><div _ngcontent-jao-c106="" class="highlight-div-header"><div _ngcontent-jao-c106="" class="highlight-div-header-left"><div _ngcontent-jao-c106="" class="handle-button expand-button"><div _ngcontent-jao-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jao-c106="" class="highlight-div-header-right"><div _ngcontent-jao-c106="" class="handle-button ai-button"></div><div _ngcontent-jao-c106="" class="handle-button line-button"><div _ngcontent-jao-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jao-c106="" class="handle-button theme-button"><div _ngcontent-jao-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jao-c106="" class="handle-button copy-button"><div _ngcontent-jao-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jao-c106="" class="highlight-scroll-div"><pre class="json prettyprint linenums hljs language-json" hw-language="json" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-punctuation">{</span> </li><li>    <span class="hljs-attr">"op_type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"add_custom"</span><span class="hljs-punctuation">,</span> </li><li>    <span class="hljs-attr">"data_script"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">""</span><span class="hljs-punctuation">,</span> </li><li>    <span class="hljs-attr">"gen_data"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span> </li><li>    <span class="hljs-attr">"</span><strong><span class="hljs-attr">params</span></strong><span class="hljs-attr">"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-punctuation">{</span> </li><li>                <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"</span><strong><span class="hljs-string">x</span></strong><span class="hljs-string">"</span><span class="hljs-punctuation">,</span> </li><li>                <span class="hljs-attr">"dtype"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"float16"</span><span class="hljs-punctuation">,</span> </li><li>                <span class="hljs-attr">"param_type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"</span><strong><span class="hljs-string">input</span></strong><span class="hljs-string">"</span><span class="hljs-punctuation">,</span> </li><li>                <span class="hljs-attr">"shape"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span><span class="hljs-number">16384</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> </li><li>                <span class="hljs-attr">"data_file"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"x.bin"</span> </li><li>            <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span> </li><li>            <span class="hljs-punctuation">{</span> </li><li>                <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"z"</span><span class="hljs-punctuation">,</span> </li><li>                <span class="hljs-attr">"dtype"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"float16"</span><span class="hljs-punctuation">,</span> </li><li>                <span class="hljs-attr">"param_type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"</span><strong><span class="hljs-string">output</span></strong><span class="hljs-string">"</span><span class="hljs-punctuation">,</span> </li><li>                <span class="hljs-attr">"shape"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span><span class="hljs-number">16384</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> </li><li>                <span class="hljs-attr">"data_file"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"golden_z.bin"</span> </li><li>            <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span> </li><li>            <span class="hljs-punctuation">{</span> </li><li>                <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"</span><strong><span class="hljs-string">y</span></strong><span class="hljs-string">"</span><span class="hljs-punctuation">,</span> </li><li>                <span class="hljs-attr">"dtype"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"float16"</span><span class="hljs-punctuation">,</span> </li><li>                <span class="hljs-attr">"param_type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"input"</span><span class="hljs-punctuation">,</span> </li><li>                <span class="hljs-attr">"shape"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span><span class="hljs-number">16384</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> </li><li>                <span class="hljs-attr">"data_file"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"y.bin"</span> </li><li>            <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span> </li><li>    <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> </li><li>    <span class="hljs-attr">"</span><strong><span class="hljs-attr">kernel_info</span></strong><span class="hljs-attr">"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span> </li><li>        <span class="hljs-attr">"kernel_source"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"add_custom.cpp"</span><span class="hljs-punctuation">,</span> </li><li>        <span class="hljs-attr">"kernel_name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"add_custom"</span><span class="hljs-punctuation">,</span> </li><li>        <span class="hljs-attr">"kernel_includes"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-punctuation">]</span> </li><li>    <span class="hljs-punctuation">}</span> </li><li><span class="hljs-punctuation">}</span></li></ol></pre></div></div>  <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><caption><b>表1 </b>params归一格式的算子json全量参数说明</caption><thead><tr><th align="left" class="cellrowborder" colspan="2" id="mcps1.3.1.6.2.7.1.1" valign="top"><p>参数名</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.1.6.2.7.1.2" valign="top"><p>数据类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.1.6.2.7.1.3" valign="top"><p>参数说明</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.1.6.2.7.1.4" valign="top"><p>取值说明</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.1.6.2.7.1.5" valign="top"><p>是否必选</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" colspan="2" valign="top"><p>op_type</p> </td> <td class="cellrowborder" valign="top"><p>string</p> </td> <td class="cellrowborder" valign="top"><p>算子名。</p> </td> <td class="cellrowborder" valign="top"><p>与待调测算子严格匹配。</p> </td> <td class="cellrowborder" valign="top"><p>是</p> </td> </tr> <tr><td class="cellrowborder" colspan="2" valign="top"><p>data_script</p> </td> <td class="cellrowborder" valign="top"><p>string</p> </td> <td class="cellrowborder" valign="top"><p>数据生成脚本(python)，用于生成输入和标杆数据。</p> </td> <td class="cellrowborder" valign="top"><p>根据实际情况设置，如"/home/flash_attention_golden.py"。</p> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p>若无数据生成脚本，填写空字符或null。</p> </div></div></div> </td> <td class="cellrowborder" valign="top"><p>否</p> </td> </tr> <tr><td class="cellrowborder" colspan="2" valign="top"><p>gen_data</p> </td> <td class="cellrowborder" valign="top"><p>bool</p> </td> <td class="cellrowborder" valign="top"><p>是否根据data_script生成输入和标杆数据。</p> </td> <td class="cellrowborder" valign="top"><ul><li>true：采用脚本生成数据。</li><li>false：不采用脚本生成数据，默认false。</li></ul> </td> <td class="cellrowborder" valign="top"><p>是</p> </td> </tr> <tr><td class="cellrowborder" rowspan="6" valign="top" width="15.000000000000002%"><p>params</p> </td> <td class="cellrowborder" valign="top" width="12.000000000000002%"><p>name</p> </td> <td class="cellrowborder" valign="top" width="10.000000000000002%"><p>string</p> </td> <td class="cellrowborder" valign="top" width="24.000000000000004%"><p>核函数输入/输出的参数名。</p> </td> <td class="cellrowborder" valign="top" width="31.000000000000007%"><p>根据实际情况设置。</p> </td> <td class="cellrowborder" valign="top" width="8.000000000000002%"><p>是</p> </td> </tr> <tr><td class="cellrowborder" valign="top"><p>dtype</p> </td> <td class="cellrowborder" valign="top"><p>string</p> </td> <td class="cellrowborder" valign="top"><p>输入/输出的数据类型。</p> </td> <td class="cellrowborder" valign="top"><p>目前支持bool、int、int8、int16、int32、int64、uint8、uint16、uint32、uint64、float16、float32、float64、bfloat16。</p> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p>算子json配置时dtype仅允许输入一种数据类型，不支持多种数据类型。</p> </div></div></div> </td> <td class="cellrowborder" valign="top"><p>是</p> </td> </tr> <tr><td class="cellrowborder" valign="top"><p>param_type</p> </td> <td class="cellrowborder" valign="top"><p>string</p> </td> <td class="cellrowborder" valign="top"><p>标识该节点是输入或输出。</p> </td> <td class="cellrowborder" valign="top"><ul><li>input：表示为输入节点。</li><li>output：表示为输出节点。</li></ul> </td> <td class="cellrowborder" valign="top"><p>是</p> </td> </tr> <tr><td class="cellrowborder" valign="top"><p>shape</p> </td> <td class="cellrowborder" valign="top"><p>list</p> </td> <td class="cellrowborder" valign="top"><p>输入/输出的shape。</p> </td> <td class="cellrowborder" valign="top"><p>根据算子实际shape填写，例如[24, 20, 144, 8]。</p> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p>当输入为Scalar时，shape填null。</p> </div></div></div> </td> <td class="cellrowborder" valign="top"><p>是</p> </td> </tr> <tr><td class="cellrowborder" valign="top"><p>data_file</p> </td> <td class="cellrowborder" valign="top"><p>string</p> </td> <td class="cellrowborder" valign="top"><ul><li>当param_type为input：指定输入数据bin文件。</li><li>当param_type为output：指定标杆数据bin文件。</li></ul> </td> <td class="cellrowborder" valign="top"><p>根据实际情况设置数据bin文件路径，必须为绝对路径，例如"/home/data.bin"。</p> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><ul><li>当data_file设为空字符或null，表示不对运行输出作精度比对。</li><li>当输入为Scalar时，data_file字段删除，只需配置data_value。</li></ul> </div></div></div> </td> <td class="cellrowborder" valign="top"><p>否</p> </td> </tr> <tr><td class="cellrowborder" valign="top"><p>data_value</p> </td> <td class="cellrowborder" valign="top"><p>由dtype确定</p> </td> <td class="cellrowborder" valign="top"><p>输入的Scalar值。</p> </td> <td class="cellrowborder" valign="top"><p>根据实际情况填写。</p> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><ul><li>仅当param_type为input才可以配置该参数。</li><li>data_value与data_file互斥。若配置data_value则data_file必须删除，且shape必须为null，表示本节点是Scalar输入。</li></ul> </div></div></div> </td> <td class="cellrowborder" valign="top"><p>否</p> </td> </tr> <tr><td class="cellrowborder" rowspan="3" valign="top" width="15.000000000000002%"><p>kernel_info</p> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p>仅<strong>核函数直调工程场景</strong>需要设置kernel文件相关的配置。</p> </div></div></div> </td> <td class="cellrowborder" valign="top" width="12.000000000000002%"><p>kernel_source</p> </td> <td class="cellrowborder" valign="top" width="10.000000000000002%"><p>string</p> </td> <td class="cellrowborder" valign="top" width="24.000000000000004%"><p>Kernel入口源文件绝对路径，注意格式是“绝对路径+文件名”。</p> </td> <td class="cellrowborder" valign="top" width="31.000000000000007%"><p>根据开发的核函数信息填写。</p> </td> <td class="cellrowborder" valign="top" width="8.000000000000002%"><p>是</p> </td> </tr> <tr><td class="cellrowborder" valign="top"><p>kernel_name</p> </td> <td class="cellrowborder" valign="top"><p>string</p> </td> <td class="cellrowborder" valign="top"><p>Kernel入口函数名。</p> </td> <td class="cellrowborder" valign="top"><p>根据开发的核函数信息填写。</p> </td> <td class="cellrowborder" valign="top"><p>是</p> </td> </tr> <tr><td class="cellrowborder" valign="top"><p>kernel_includes</p> </td> <td class="cellrowborder" valign="top"><p>list</p> </td> <td class="cellrowborder" valign="top"><p>Kernel文件依赖的头文件所在的路径。</p> </td> <td class="cellrowborder" valign="top"><p>可为[]，也可填入多个路径。</p> </td> <td class="cellrowborder" valign="top"><p>是</p> </td> </tr>  </tbody></table></div> </div> </div> <div class="tiledSection"><h2 id="section1740mcpsimp">特殊格式输入<i class="anchor-icon anchor-icon-link" anchorid="section1740mcpsimp" tips="复制节点链接"></i></h2><ul><li><strong>场景1：支持Scalar格式的输入。</strong><p>当输入为Scalar格式，json中“params”配置项中删除data_file，param_type配为“input”，shape配为null，data_value配为指定的标量值。</p> <div _ngcontent-jao-c106="" class="highlight-div"><div _ngcontent-jao-c106="" class="highlight-div-header"><div _ngcontent-jao-c106="" class="highlight-div-header-left"><div _ngcontent-jao-c106="" class="handle-button expand-button"><div _ngcontent-jao-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jao-c106="" class="highlight-div-header-right"><div _ngcontent-jao-c106="" class="handle-button ai-button"></div><div _ngcontent-jao-c106="" class="handle-button line-button"><div _ngcontent-jao-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jao-c106="" class="handle-button theme-button"><div _ngcontent-jao-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jao-c106="" class="handle-button copy-button"><div _ngcontent-jao-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jao-c106="" class="highlight-scroll-div"><pre class="json prettyprint linenums hljs language-json" hw-language="json" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-punctuation">{</span> </li><li>     <span class="hljs-attr">"op_type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"xxxx"</span><span class="hljs-punctuation">,</span> </li><li>     <span class="hljs-attr">"data_script"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">""</span><span class="hljs-punctuation">,</span> </li><li>     <span class="hljs-attr">"gen_data"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span> </li><li>     <span class="hljs-attr">"params"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-punctuation">{</span> </li><li>                 <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"input_1"</span><span class="hljs-punctuation">,</span> </li><li>                 <span class="hljs-attr">"dtype"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"float16"</span><span class="hljs-punctuation">,</span> </li><li>                 <span class="hljs-attr">"param_type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"input"</span><span class="hljs-punctuation">,</span> </li><li>                 <span class="hljs-attr">"shape"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">,</span> </li><li>                 <span class="hljs-attr">"data_value"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">8</span> </li><li>             <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span> </li><li>             <span class="hljs-comment">// ... </span></li><li>     <span class="hljs-punctuation">]</span> </li><li> <span class="hljs-punctuation">}</span></li></ol></pre></div></div> </li><li><strong>场景2：支持TensorList格式的输入。</strong><p>当输入为TensorList格式，该参数需要用<strong>[ ]</strong>表示，List中的每一项表示一个Tensor，示例如下。</p> <div _ngcontent-jao-c106="" class="highlight-div"><div _ngcontent-jao-c106="" class="highlight-div-header"><div _ngcontent-jao-c106="" class="highlight-div-header-left"><div _ngcontent-jao-c106="" class="handle-button expand-button"><div _ngcontent-jao-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jao-c106="" class="highlight-div-header-right"><div _ngcontent-jao-c106="" class="handle-button ai-button"></div><div _ngcontent-jao-c106="" class="handle-button line-button"><div _ngcontent-jao-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jao-c106="" class="handle-button theme-button"><div _ngcontent-jao-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jao-c106="" class="handle-button copy-button"><div _ngcontent-jao-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jao-c106="" class="highlight-scroll-div"><pre class="json prettyprint linenums hljs language-json" hw-language="json" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-punctuation">{</span> </li><li>     <span class="hljs-attr">"op_type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"xxxx"</span><span class="hljs-punctuation">,</span> </li><li>     <span class="hljs-attr">"data_script"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">""</span><span class="hljs-punctuation">,</span> </li><li>     <span class="hljs-attr">"gen_data"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span> </li><li>     <span class="hljs-attr">"params"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span> </li><li>             <span class="hljs-punctuation">[</span><span class="hljs-punctuation">{</span></li><li>                 <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"input_1"</span><span class="hljs-punctuation">,</span></li><li>                 <span class="hljs-attr">"dtype"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"float16"</span><span class="hljs-punctuation">,</span></li><li>                 <span class="hljs-attr">"param_type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"input"</span><span class="hljs-punctuation">,</span></li><li>                 <span class="hljs-attr">"shape"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span><span class="hljs-number">16384</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span></li><li>                 <span class="hljs-attr">"data_file"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"input_1.bin"</span></li><li>             <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>  </li><li>             <span class="hljs-punctuation">{</span></li><li>                 <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"input_2"</span><span class="hljs-punctuation">,</span></li><li>                 <span class="hljs-attr">"dtype"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"float16"</span><span class="hljs-punctuation">,</span></li><li>                 <span class="hljs-attr">"param_type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"input"</span><span class="hljs-punctuation">,</span></li><li>                 <span class="hljs-attr">"shape"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span><span class="hljs-number">16384</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span></li><li>                 <span class="hljs-attr">"data_file"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"input_2.bin"</span></li><li>             <span class="hljs-punctuation">}</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span></li><li>             <span class="hljs-punctuation">{</span>  </li><li>                 <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"output"</span><span class="hljs-punctuation">,</span> </li><li>                 <span class="hljs-attr">"dtype"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"float16"</span><span class="hljs-punctuation">,</span> </li><li>                 <span class="hljs-attr">"param_type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"output"</span><span class="hljs-punctuation">,</span> </li><li>                 <span class="hljs-attr">"shape"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span><span class="hljs-number">16384</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> </li><li>                 <span class="hljs-attr">"data_file"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"golden.bin"</span> </li><li>             <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span> </li><li>     <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> </li><li>     <span class="hljs-attr">"kernel_info"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span> </li><li>         <span class="hljs-attr">"kernel_source"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"add_custom.cpp"</span><span class="hljs-punctuation">,</span> </li><li>         <span class="hljs-attr">"kernel_name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"add_custom"</span><span class="hljs-punctuation">,</span> </li><li>         <span class="hljs-attr">"kernel_includes"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-punctuation">]</span> </li><li>     <span class="hljs-punctuation">}</span> </li><li> <span class="hljs-punctuation">}</span></li></ol></pre></div></div> </li><li><strong>场景3：支持原地算子格式的输入。</strong><p>当算子为<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/cannkit-commissioning-tools#section13493310121218">原地算子(in-place op)</a>时，输入和输出地址一样，配置算子json时除了“param_type”和“data_file”不同，其他配置项均保持一致。配置示例如下。</p> <ul><li>param_type：分别配为input、output。</li><li>data_file：输入数据为x.bin，输出数据为标杆数据golden_x.bin。</li></ul> <div _ngcontent-jao-c106="" class="highlight-div"><div _ngcontent-jao-c106="" class="highlight-div-header"><div _ngcontent-jao-c106="" class="highlight-div-header-left"><div _ngcontent-jao-c106="" class="handle-button expand-button"><div _ngcontent-jao-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jao-c106="" class="highlight-div-header-right"><div _ngcontent-jao-c106="" class="handle-button ai-button"></div><div _ngcontent-jao-c106="" class="handle-button line-button"><div _ngcontent-jao-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jao-c106="" class="handle-button theme-button"><div _ngcontent-jao-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jao-c106="" class="handle-button copy-button"><div _ngcontent-jao-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jao-c106="" class="highlight-scroll-div"><pre class="json prettyprint linenums hljs language-json" hw-language="json" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-punctuation">{</span> </li><li>     <span class="hljs-attr">"op_type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"add_custom"</span><span class="hljs-punctuation">,</span> </li><li>     <span class="hljs-attr">"data_script"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">""</span><span class="hljs-punctuation">,</span> </li><li>     <span class="hljs-attr">"gen_data"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span> </li><li>     <span class="hljs-attr">"params"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-punctuation">{</span> </li><li>                 <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"x"</span><span class="hljs-punctuation">,</span> </li><li>                 <span class="hljs-attr">"dtype"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"float16"</span><span class="hljs-punctuation">,</span> </li><li>                 <span class="hljs-attr">"param_type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"input"</span><span class="hljs-punctuation">,</span> </li><li>                 <span class="hljs-attr">"shape"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span><span class="hljs-number">16384</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> </li><li>                 <span class="hljs-attr">"data_file"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"x.bin"</span>       </li><li>             <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span> </li><li>             <span class="hljs-punctuation">{</span> </li><li>                 <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"x"</span><span class="hljs-punctuation">,</span> </li><li>                 <span class="hljs-attr">"dtype"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"float16"</span><span class="hljs-punctuation">,</span> </li><li>                 <span class="hljs-attr">"param_type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"output"</span><span class="hljs-punctuation">,</span> </li><li>                 <span class="hljs-attr">"shape"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span><span class="hljs-number">16384</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> </li><li>                 <span class="hljs-attr">"data_file"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"golden_x.bin"</span> </li><li>             <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span> </li><li>             <span class="hljs-punctuation">{</span> </li><li>                 <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"y"</span><span class="hljs-punctuation">,</span> </li><li>                 <span class="hljs-attr">"dtype"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"float16"</span><span class="hljs-punctuation">,</span> </li><li>                 <span class="hljs-attr">"param_type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"input"</span><span class="hljs-punctuation">,</span> </li><li>                 <span class="hljs-attr">"shape"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span><span class="hljs-number">16384</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> </li><li>                 <span class="hljs-attr">"data_file"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"y.bin"</span> </li><li>             <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span> </li><li>     <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> </li><li>     <span class="hljs-attr">"kernel_info"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span> </li><li>         <span class="hljs-attr">"kernel_source"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"add_custom.cpp"</span><span class="hljs-punctuation">,</span> </li><li>         <span class="hljs-attr">"kernel_name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"add_custom"</span><span class="hljs-punctuation">,</span> </li><li>         <span class="hljs-attr">"kernel_includes"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-punctuation">]</span> </li><li>     <span class="hljs-punctuation">}</span> </li><li> <span class="hljs-punctuation">}</span></li></ol></pre></div></div> </li></ul> </div> </div> <div></div></div>