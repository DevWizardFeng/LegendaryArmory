<h1 _ngcontent-wih-c119="" class="doc-title ng-star-inserted" title="printf/PRINTF功能"> printf/PRINTF功能 </h1>

<div _ngcontent-wih-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div><div class="tiledSection"><h2 id="section2664mcpsimp">功能介绍<i class="anchor-icon anchor-icon-link" anchorid="section2664mcpsimp" tips="复制节点链接"></i></h2><p>使用工具进行算子调测时，支持printf/PRINTF功能，可以打印Scalar数据。</p> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><ul><li>CPU调测场景支持printf和PRINTF打印，其中printf采用C++自身打印功能，不受dump-mode参数控制。</li></ul> <ul><li>simulator调测场景支持printf和PRINTF打印，受dump mode参数控制。</li></ul> <ul><li>固定为每个核分配的打印数据的最大可使用空间为1M，目前该大小不支持修改，若打印超过1M，打印内容不再显示，请开发者控制待打印的数据量。</li></ul> </div></div></div> </div> <div class="tiledSection"><h2 id="section2676mcpsimp">使用方法（命令行）<i class="anchor-icon anchor-icon-link" anchorid="section2676mcpsimp" tips="复制节点链接"></i></h2><ol><li><span>在核函数代码中按需在目标位置加上printf或PRINTF语句，接口说明参见表1，以PRINTF打印为例：</span><p></p><div _ngcontent-wih-c106="" class="highlight-div"><div _ngcontent-wih-c106="" class="highlight-div-header"><div _ngcontent-wih-c106="" class="highlight-div-header-left"><div _ngcontent-wih-c106="" class="handle-button expand-button"><div _ngcontent-wih-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wih-c106="" class="highlight-div-header-right"><div _ngcontent-wih-c106="" class="handle-button ai-button"></div><div _ngcontent-wih-c106="" class="handle-button line-button"><div _ngcontent-wih-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wih-c106="" class="handle-button theme-button"><div _ngcontent-wih-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wih-c106="" class="handle-button copy-button"><div _ngcontent-wih-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wih-c106="" class="highlight-scroll-div"><pre class="cpp prettyprint linenums hljs language-cpp" hw-language="cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-built_in">PRINTF</span>(<span class="hljs-string">"1 fmt string d %d\n"</span>, <span class="hljs-number">6666</span>); </li><li><span class="hljs-built_in">PRINTF</span>(<span class="hljs-string">"1 fmt string lf %lf\n"</span>, <span class="hljs-built_in">float</span>(<span class="hljs-number">61.556</span>));</li></ol></pre></div></div> <p></p></li><li><span>simulator调测场景执行如下命令，使能Dump开关。同时修改</span><p></p><div _ngcontent-wih-c106="" class="highlight-div"><div _ngcontent-wih-c106="" class="highlight-div-header"><div _ngcontent-wih-c106="" class="highlight-div-header-left"><div _ngcontent-wih-c106="" class="handle-button expand-button"><div _ngcontent-wih-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wih-c106="" class="highlight-div-header-right"><div _ngcontent-wih-c106="" class="handle-button ai-button"></div><div _ngcontent-wih-c106="" class="handle-button line-button"><div _ngcontent-wih-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wih-c106="" class="handle-button theme-button"><div _ngcontent-wih-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wih-c106="" class="handle-button copy-button"><div _ngcontent-wih-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wih-c106="" class="highlight-scroll-div"><pre class="shell prettyprint linenums hljs language-shell" hw-language="shell" data-highlighted="yes"><ol class="linenums"><li>ascendebug kernel<strong> --backend</strong> simulator<strong> --dump-mode</strong> normal ... {其他simulator调测参数}</li></ol></pre></div></div> <p>--dump-mode取normal，开启通用打印Scalar模式，其他参数参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/cannkit-cli-parameters#section1351011652416">NPU调测参数</a>按需配置。</p> <p></p></li><li><span>查看屏显打印结果，示例如下。</span><p></p><p class="msonormal"><span><img height="47.88" originheight="106" originwidth="1014" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114310.13314213348403442683973762831436:50001231000000:2800:D5E700F8859102FC73808A7A47E01C9455193DEBD88122EFD8C78A31EC1F8145.png" title="点击放大" width="469.49"></span></p> <p></p></li></ol> </div> <div class="tiledSection"><h2 id="section2691mcpsimp">接口说明<i class="anchor-icon anchor-icon-link" anchorid="section2691mcpsimp" tips="复制节点链接"></i></h2> <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><caption><b>表1 </b>printf/PRINTF接口说明表</caption><tbody><tr><th class="firstcol" id="mcps1.3.3.2.2.4.1.1" valign="top"><p>函数原型</p> </th> <td class="cellrowborder" colspan="2" valign="top"><p>template &lt;class... Args&gt;</p> <ul><li>void printf(__gm__ const char* fmt, Args&amp;&amp;... args);</li><li>void PRINTF(__gm__ const char* fmt, Args&amp;&amp;... args);</li></ul> </td> </tr> <tr><th class="firstcol" id="mcps1.3.3.2.2.4.2.1" valign="top"><p>函数功能</p> </th> <td class="cellrowborder" colspan="2" valign="top"><p>打印Scalar数据。</p> </td> </tr> <tr><th class="firstcol" id="mcps1.3.3.2.2.4.3.1" rowspan="2" valign="top" width="23%"><p>参数(IN)</p> </th> <td class="cellrowborder" valign="top" width="16%"><p>fmt</p> </td> <td class="cellrowborder" valign="top" width="61%"><p>格式控制字符串，包含两种类型的对象：普通字符和转换说明。</p> <ul><li>普通字符将原样不动地打印输出。</li><li>转换说明并不直接输出而是用于控制printf中参数的转换和打印。每个转换说明都由一个百分号字符（%）开始，以转换说明结束，从而说明输出数据的类型 。<p>支持的转换类型包括：</p> <ul><li>%d / %i：输出十进制数，支持打印的数据类型：bool/int8_t/int16_t/int32_t/int64_t</li><li>%f：输出实数，支持打印的数据类型：float/half/bfloat16_t</li><li>%x：输出十六进制整数，支持打印的数据类型：int8_t/int16_t/int32_t/int64_t/uint8_t/uint16_t/uint32_t/uint64_t</li><li>%s：输出字符串</li><li>%u：输出unsigned类型数据，支持打印的数据类型：bool/uint8_t/uint16_t/uint32_t/uint64_t</li><li>%p：输出指针地址</li></ul> </li></ul> </td> </tr> <tr><td class="cellrowborder" valign="top"><p>args</p> </td> <td class="cellrowborder" valign="top"><p>附加参数，个数和类型可变的输出列表：根据不同的fmt字符串，函数可能需要一系列的附加参数，每个参数包含了一个要被插入的值，替换了fmt参数中指定的每个%标签。参数的个数应与%标签的个数相同。</p> </td> </tr> <tr><th class="firstcol" id="mcps1.3.3.2.2.4.5.1" valign="top" width="23%"><p>参数(OUT)</p> </th> <td class="cellrowborder" valign="top" width="16%"><p>NA</p> </td> <td class="cellrowborder" valign="top" width="61%"><p>-</p> </td> </tr> <tr><th class="firstcol" id="mcps1.3.3.2.2.4.6.1" valign="top" width="23%"><p>返回值</p> </th> <td class="cellrowborder" valign="top" width="16%"><p>NA</p> </td> <td class="cellrowborder" valign="top" width="61%"><p>-</p> </td> </tr> <tr><th class="firstcol" id="mcps1.3.3.2.2.4.7.1" valign="top"><p>使用约束</p> </th> <td class="cellrowborder" colspan="2" valign="top"><ul><li>不支持转义字符打印。</li><li>当前支持的打印类型：<ul><li>%d / %i：输出十进制数。</li><li>%f：输出实数。</li><li>%x：输出十六进制整数。</li><li>%s：输出字符串。</li><li>%u：输出unsigned类型数据。</li><li>%p：输出指针地址。</li></ul> </li></ul> </td> </tr> <tr><th class="firstcol" id="mcps1.3.3.2.2.4.8.1" valign="top"><p>调用示例</p> </th> <td class="cellrowborder" colspan="2" valign="top"><div _ngcontent-wih-c106="" class="highlight-div"><div _ngcontent-wih-c106="" class="highlight-div-header"><div _ngcontent-wih-c106="" class="highlight-div-header-left"><div _ngcontent-wih-c106="" class="handle-button expand-button"><div _ngcontent-wih-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wih-c106="" class="highlight-div-header-right"><div _ngcontent-wih-c106="" class="handle-button ai-button"></div><div _ngcontent-wih-c106="" class="handle-button line-button"><div _ngcontent-wih-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wih-c106="" class="handle-button theme-button"><div _ngcontent-wih-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wih-c106="" class="handle-button copy-button"><div _ngcontent-wih-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wih-c106="" class="highlight-scroll-div"><pre class="cpp prettyprint linenums hljs language-cpp" hw-language="cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 整型打印：</span></li><li> <span class="hljs-built_in">printf</span>(<span class="hljs-string">"fmt string %d"</span>, <span class="hljs-number">0x123</span>); </li><li> <span class="hljs-built_in">PRINTF</span>(<span class="hljs-string">"fmt string %d"</span>, <span class="hljs-number">0x123</span>); </li><li> <span class="hljs-comment">// 指针打印：</span></li><li> <span class="hljs-type">int</span> *a; </li><li> <span class="hljs-built_in">printf</span>(<span class="hljs-string">"TEST %p"</span>, a); </li><li> <span class="hljs-built_in">PRINTF</span>(<span class="hljs-string">"TEST %p"</span>, a);</li></ol></pre></div></div> </td> </tr>  </tbody></table></div> </div> </div> </div> <div></div></div>