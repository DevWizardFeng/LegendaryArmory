<h1 _ngcontent-jmq-c119="" class="doc-title ng-star-inserted" title="不依赖UI组件的全局气泡提示 (openPopup)"> 不依赖UI组件的全局气泡提示 (openPopup) </h1>

<div _ngcontent-jmq-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-popup-and-menu-components-popup">气泡提示（Popup）</a>在使用时依赖绑定UI组件，否则无法使用。从API version 18开始，可以通过使用全局接口<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-uicontext-promptaction#openpopup18" target="_blank">openPopup</a>的方式，在无UI组件的场景下直接或封装使用，例如在事件回调中使用或封装后对外提供能力。</p>    <div class="tiledSection">     <h2 id="弹出气泡">弹出气泡<i class="anchor-icon anchor-icon-link" anchorid="弹出气泡" tips="复制节点链接"></i></h2>          <p>通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-uicontext-promptaction#openpopup18" target="_blank">openPopup</a>可以弹出气泡。</p>     <div _ngcontent-jmq-c106="" class="highlight-div"><div _ngcontent-jmq-c106="" class="highlight-div-header"><div _ngcontent-jmq-c106="" class="highlight-div-header-left"><div _ngcontent-jmq-c106="" class="handle-button expand-button"><div _ngcontent-jmq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jmq-c106="" class="highlight-div-header-right"><div _ngcontent-jmq-c106="" class="handle-button ai-button"></div><div _ngcontent-jmq-c106="" class="handle-button line-button"><div _ngcontent-jmq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jmq-c106="" class="handle-button theme-button"><div _ngcontent-jmq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jmq-c106="" class="handle-button copy-button"><div _ngcontent-jmq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jmq-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li>promptAction.<span class="hljs-title function_">openPopup</span>(contentNode, { <span class="hljs-attr">id</span>: targetId }, {</li><li>  <span class="hljs-attr">enableArrow</span>: <span class="hljs-literal">true</span></li><li>})</li><li>  .<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'openPopup success'</span>);</li><li>  })</li><li>  .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'openPopup error: '</span> + err.<span class="hljs-property">code</span> + <span class="hljs-string">' '</span> + err.<span class="hljs-property">message</span>);</li><li>  })</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="创建componentcontent" class="firsth2">创建ComponentContent<i class="anchor-icon anchor-icon-link" anchorid="创建componentcontent" tips="复制节点链接"></i></h3>          <p>通过调用openPopup接口弹出其气泡，需要提供用于定义自定义弹出框的内容<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-arkui-componentcontent" target="_blank">ComponentContent</a>。其中，wrapBuilder(buildText)封装自定义组件，new Params(this.message)是自定义组件的入参，可以缺省，也可以传入基础数据类型。</p>     <div _ngcontent-jmq-c106="" class="highlight-div"><div _ngcontent-jmq-c106="" class="highlight-div-header"><div _ngcontent-jmq-c106="" class="highlight-div-header-left"><div _ngcontent-jmq-c106="" class="handle-button expand-button"><div _ngcontent-jmq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jmq-c106="" class="highlight-div-header-right"><div _ngcontent-jmq-c106="" class="handle-button ai-button"></div><div _ngcontent-jmq-c106="" class="handle-button line-button"><div _ngcontent-jmq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jmq-c106="" class="handle-button theme-button"><div _ngcontent-jmq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jmq-c106="" class="handle-button copy-button"><div _ngcontent-jmq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jmq-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">private</span> <span class="hljs-attr">contentNode</span>: <span class="hljs-title class_">ComponentContent</span>&lt;<span class="hljs-title class_">Object</span>&gt; = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ComponentContent</span>(uiContext, <span class="hljs-title function_">wrapBuilder</span>(buildText), <span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span>);</li></ol></pre></div></div>     <p>如果在wrapBuilder中包含其他组件（例如：<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ohos-arkui-advanced-popup" target="_blank">Popup</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ohos-arkui-advanced-chip" target="_blank">Chip</a>组件），则<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-arkui-componentcontent#componentcontent-1" target="_blank">ComponentContent</a>应采用带有四个参数的构造函数constructor，其中options参数应传递{ nestingBuilderSupported: true }。</p>     <div _ngcontent-jmq-c106="" class="highlight-div"><div _ngcontent-jmq-c106="" class="highlight-div-header"><div _ngcontent-jmq-c106="" class="highlight-div-header-left"><div _ngcontent-jmq-c106="" class="handle-button expand-button"><div _ngcontent-jmq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jmq-c106="" class="highlight-div-header-right"><div _ngcontent-jmq-c106="" class="handle-button ai-button"></div><div _ngcontent-jmq-c106="" class="handle-button line-button"><div _ngcontent-jmq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jmq-c106="" class="handle-button theme-button"><div _ngcontent-jmq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jmq-c106="" class="handle-button copy-button"><div _ngcontent-jmq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jmq-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@Builder</span></li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">buildText</span>(<span class="hljs-params">params: Params</span>) {</li><li>  <span class="hljs-title class_">Popup</span>({</li><li>    <span class="hljs-comment">// 类型设置图标内容</span></li><li>    <span class="hljs-attr">icon</span>: {</li><li>      <span class="hljs-attr">image</span>: $r(<span class="hljs-string">'app.media.app_icon'</span>),</li><li>      <span class="hljs-attr">width</span>: <span class="hljs-number">32</span>,</li><li>      <span class="hljs-attr">height</span>: <span class="hljs-number">32</span>,</li><li>      <span class="hljs-attr">fillColor</span>: <span class="hljs-title class_">Color</span>.<span class="hljs-property">White</span>,</li><li>      <span class="hljs-attr">borderRadius</span>: <span class="hljs-number">10</span></li><li>    } <span class="hljs-keyword">as</span> <span class="hljs-title class_">PopupIconOptions</span>,</li><li>    <span class="hljs-comment">// 设置文字内容</span></li><li>    <span class="hljs-attr">title</span>: {</li><li>      <span class="hljs-attr">text</span>: <span class="hljs-string">`This is a Popup title 1`</span>,</li><li>      <span class="hljs-attr">fontSize</span>: <span class="hljs-number">20</span>,</li><li>      <span class="hljs-attr">fontColor</span>: <span class="hljs-title class_">Color</span>.<span class="hljs-property">Black</span>,</li><li>      <span class="hljs-attr">fontWeight</span>: <span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Normal</span></li><li>    } <span class="hljs-keyword">as</span> <span class="hljs-title class_">PopupTextOptions</span>,</li><li>    <span class="hljs-comment">// 设置文字内容</span></li><li>    <span class="hljs-attr">message</span>: {</li><li>      <span class="hljs-attr">text</span>: <span class="hljs-string">`This is a Popup message 1`</span>,</li><li>      <span class="hljs-attr">fontSize</span>: <span class="hljs-number">15</span>,</li><li>      <span class="hljs-attr">fontColor</span>: <span class="hljs-title class_">Color</span>.<span class="hljs-property">Black</span></li><li>    } <span class="hljs-keyword">as</span> <span class="hljs-title class_">PopupTextOptions</span>,</li><li>    <span class="hljs-comment">// 设置按钮内容</span></li><li>    <span class="hljs-attr">buttons</span>: [{</li><li>      <span class="hljs-attr">text</span>: <span class="hljs-string">'confirm'</span>,</li><li>      <span class="hljs-attr">action</span>: <span class="hljs-function">() =&gt;</span> {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'confirm button click'</span>);</li><li>      },</li><li>      <span class="hljs-attr">fontSize</span>: <span class="hljs-number">15</span>,</li><li>      <span class="hljs-attr">fontColor</span>: <span class="hljs-title class_">Color</span>.<span class="hljs-property">Black</span>,</li><li>    },</li><li>      {</li><li>        <span class="hljs-attr">text</span>: <span class="hljs-string">'cancel'</span>,</li><li>        <span class="hljs-attr">action</span>: <span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'cancel button click'</span>);</li><li>        },</li><li>        <span class="hljs-attr">fontSize</span>: <span class="hljs-number">15</span>,</li><li>        <span class="hljs-attr">fontColor</span>: <span class="hljs-title class_">Color</span>.<span class="hljs-property">Black</span></li><li>      },] <span class="hljs-keyword">as</span> [<span class="hljs-title class_">PopupButtonOptions</span>?, <span class="hljs-title class_">PopupButtonOptions</span>?]</li><li>  })</li><li>}</li><li>
</li><li><span class="hljs-keyword">private</span> <span class="hljs-attr">contentNode</span>: <span class="hljs-title class_">ComponentContent</span>&lt;<span class="hljs-title class_">Object</span>&gt; = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ComponentContent</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">uiContext</span>, <span class="hljs-title function_">wrapBuilder</span>(buildText), <span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span>, { <span class="hljs-attr">nestingBuilderSupported</span>: <span class="hljs-literal">true</span> });</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="绑定组件信息">绑定组件信息<i class="anchor-icon anchor-icon-link" anchorid="绑定组件信息" tips="复制节点链接"></i></h3>          <p>通过调用openPopup接口弹出气泡，需要提供绑定组件的信息<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-uicontext-i#targetinfo18" target="_blank">TargetInfo</a>。若未传入有效的target，则无法弹出气泡。</p>     <div _ngcontent-jmq-c106="" class="highlight-div"><div _ngcontent-jmq-c106="" class="highlight-div-header"><div _ngcontent-jmq-c106="" class="highlight-div-header-left"><div _ngcontent-jmq-c106="" class="handle-button expand-button"><div _ngcontent-jmq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jmq-c106="" class="highlight-div-header-right"><div _ngcontent-jmq-c106="" class="handle-button ai-button"></div><div _ngcontent-jmq-c106="" class="handle-button line-button"><div _ngcontent-jmq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jmq-c106="" class="handle-button theme-button"><div _ngcontent-jmq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jmq-c106="" class="handle-button copy-button"><div _ngcontent-jmq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jmq-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">let</span> <span class="hljs-attr">frameNode</span>: <span class="hljs-title class_">FrameNode</span> | <span class="hljs-literal">null</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">ctx</span>.<span class="hljs-title function_">getFrameNodeByUniqueId</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUniqueId</span>());</li><li><span class="hljs-keyword">let</span> targetId = frameNode?.<span class="hljs-title function_">getChild</span>(<span class="hljs-number">0</span>)?.<span class="hljs-title function_">getUniqueId</span>();</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="设置弹出气泡样式">设置弹出气泡样式<i class="anchor-icon anchor-icon-link" anchorid="设置弹出气泡样式" tips="复制节点链接"></i></h3>          <p>通过调用openPopup接口弹出气泡，可以设置<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-universal-attributes-popup#popupcommonoptions18类型说明" target="_blank">PopupCommonOptions</a>属性调整气泡样式。</p>     <div _ngcontent-jmq-c106="" class="highlight-div"><div _ngcontent-jmq-c106="" class="highlight-div-header"><div _ngcontent-jmq-c106="" class="highlight-div-header-left"><div _ngcontent-jmq-c106="" class="handle-button expand-button"><div _ngcontent-jmq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jmq-c106="" class="highlight-div-header-right"><div _ngcontent-jmq-c106="" class="handle-button ai-button"></div><div _ngcontent-jmq-c106="" class="handle-button line-button"><div _ngcontent-jmq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jmq-c106="" class="handle-button theme-button"><div _ngcontent-jmq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jmq-c106="" class="handle-button copy-button"><div _ngcontent-jmq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jmq-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">private</span> <span class="hljs-attr">options</span>: <span class="hljs-title class_">PopupCommonOptions</span> = { <span class="hljs-attr">enableArrow</span>: <span class="hljs-literal">true</span> };</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="更新气泡样式">更新气泡样式<i class="anchor-icon anchor-icon-link" anchorid="更新气泡样式" tips="复制节点链接"></i></h2>          <p>从API version 18开始，通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-uicontext-promptaction#updatepopup18" target="_blank">updatePopup</a>可以更新气泡的样式。支持全量更新和增量更新其气泡样式，不支持更新showInSubWindow、focusable、onStateChange、onWillDismiss和transition。</p>     <div _ngcontent-jmq-c106="" class="highlight-div"><div _ngcontent-jmq-c106="" class="highlight-div-header"><div _ngcontent-jmq-c106="" class="highlight-div-header-left"><div _ngcontent-jmq-c106="" class="handle-button expand-button"><div _ngcontent-jmq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jmq-c106="" class="highlight-div-header-right"><div _ngcontent-jmq-c106="" class="handle-button ai-button"></div><div _ngcontent-jmq-c106="" class="handle-button line-button"><div _ngcontent-jmq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jmq-c106="" class="handle-button theme-button"><div _ngcontent-jmq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jmq-c106="" class="handle-button copy-button"><div _ngcontent-jmq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jmq-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li>promptAction.<span class="hljs-title function_">updatePopup</span>(contentNode, {</li><li>  <span class="hljs-attr">enableArrow</span>: <span class="hljs-literal">false</span></li><li>}, <span class="hljs-literal">true</span>)</li><li>  .<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'updatePopup success'</span>);</li><li>  })</li><li>  .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'updatePopup error: '</span> + err.<span class="hljs-property">code</span> + <span class="hljs-string">' '</span> + err.<span class="hljs-property">message</span>);</li><li>  })</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="关闭气泡">关闭气泡<i class="anchor-icon anchor-icon-link" anchorid="关闭气泡" tips="复制节点链接"></i></h2>          <p>从API version 18开始，通过调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-uicontext-promptaction#closepopup18" target="_blank">closePopup</a>可以关闭气泡。</p>     <div _ngcontent-jmq-c106="" class="highlight-div"><div _ngcontent-jmq-c106="" class="highlight-div-header"><div _ngcontent-jmq-c106="" class="highlight-div-header-left"><div _ngcontent-jmq-c106="" class="handle-button expand-button"><div _ngcontent-jmq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jmq-c106="" class="highlight-div-header-right"><div _ngcontent-jmq-c106="" class="handle-button ai-button"></div><div _ngcontent-jmq-c106="" class="handle-button line-button"><div _ngcontent-jmq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jmq-c106="" class="handle-button theme-button"><div _ngcontent-jmq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jmq-c106="" class="handle-button copy-button"><div _ngcontent-jmq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jmq-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li>promptAction.<span class="hljs-title function_">closePopup</span>(contentNode)</li><li>  .<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'closePopup success'</span>);</li><li>  })</li><li>  .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'closePopup error: '</span> + err.<span class="hljs-property">code</span> + <span class="hljs-string">' '</span> + err.<span class="hljs-property">message</span>);</li><li>  })</li></ol></pre></div></div>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>由于<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-uicontext-promptaction#updatepopup18" target="_blank">updatePopup</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-uicontext-promptaction#closepopup18" target="_blank">closePopup</a>依赖content来更新或者关闭指定的气泡，开发者需自行维护传入的content。</p>      </div></div></div>    </div>    <div class="tiledSection">     <h2 id="在har包中使用全局气泡提示">在HAR包中使用全局气泡提示<i class="anchor-icon anchor-icon-link" anchorid="在har包中使用全局气泡提示" tips="复制节点链接"></i></h2>          <p>以下示例通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/har-package">HAR</a>包封装一个Popup，从而对外提供气泡的弹出、更新和关闭能力。</p>     <div _ngcontent-jmq-c106="" class="highlight-div"><div _ngcontent-jmq-c106="" class="highlight-div-header"><div _ngcontent-jmq-c106="" class="highlight-div-header-left"><div _ngcontent-jmq-c106="" class="handle-button expand-button"><div _ngcontent-jmq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jmq-c106="" class="highlight-div-header-right"><div _ngcontent-jmq-c106="" class="handle-button ai-button"></div><div _ngcontent-jmq-c106="" class="handle-button line-button"><div _ngcontent-jmq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jmq-c106="" class="handle-button theme-button"><div _ngcontent-jmq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jmq-c106="" class="handle-button copy-button"><div _ngcontent-jmq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jmq-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// library/src/main/ets/components/MainPage.ets</span></li><li>
</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">ComponentContent</span>, <span class="hljs-title class_">TargetInfo</span>, <span class="hljs-title class_">PromptAction</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PromptActionClass</span> {</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">promptAction</span>: <span class="hljs-title class_">PromptAction</span> | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">contentNode</span>: <span class="hljs-title class_">ComponentContent</span>&lt;<span class="hljs-title class_">Object</span>&gt; | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">options</span>: <span class="hljs-title class_">PopupCommonOptions</span> | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">target</span>: <span class="hljs-title class_">TargetInfo</span> | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">isPartialUpdate</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">false</span>;</li><li>
</li><li>  <span class="hljs-keyword">public</span> <span class="hljs-title function_">setPromptAction</span>(<span class="hljs-params">promptAction: PromptAction</span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">promptAction</span> = promptAction;</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">public</span> <span class="hljs-title function_">setContentNode</span>(<span class="hljs-params">node: ComponentContent&lt;<span class="hljs-built_in">Object</span>&gt;</span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">contentNode</span> = node;</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">public</span> <span class="hljs-title function_">setTarget</span>(<span class="hljs-params">target: TargetInfo</span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">target</span> = target;</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">public</span> <span class="hljs-title function_">setOptions</span>(<span class="hljs-params">options: PopupCommonOptions</span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span> = options;</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">public</span> <span class="hljs-title function_">setIsPartialUpdate</span>(<span class="hljs-params">isPartialUpdate: <span class="hljs-built_in">boolean</span></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">isPartialUpdate</span> = isPartialUpdate;</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">public</span> <span class="hljs-title function_">openPopup</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">promptAction</span> != <span class="hljs-literal">null</span>) {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">promptAction</span>.<span class="hljs-title function_">openPopup</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">contentNode</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">target</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>)</li><li>        .<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'openPopup success'</span>);</li><li>        })</li><li>        .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'openPopup error: '</span> + err.<span class="hljs-property">code</span> + <span class="hljs-string">' '</span> + err.<span class="hljs-property">message</span>);</li><li>        })</li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">public</span> <span class="hljs-title function_">closePopup</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">promptAction</span> != <span class="hljs-literal">null</span>) {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">promptAction</span>.<span class="hljs-title function_">closePopup</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">contentNode</span>)</li><li>        .<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'closePopup success'</span>);</li><li>        })</li><li>        .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'closePopup error: '</span> + err.<span class="hljs-property">code</span> + <span class="hljs-string">' '</span> + err.<span class="hljs-property">message</span>);</li><li>        })</li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">public</span> <span class="hljs-title function_">updatePopup</span>(<span class="hljs-params">options: PopupCommonOptions</span>) {</li><li>    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">promptAction</span> != <span class="hljs-literal">null</span>) {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">promptAction</span>.<span class="hljs-title function_">updatePopup</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">contentNode</span>, options, <span class="hljs-variable language_">this</span>.<span class="hljs-property">isPartialUpdate</span>)</li><li>        .<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'updatePopup success'</span>);</li><li>        })</li><li>        .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'updatePopup error: '</span> + err.<span class="hljs-property">code</span> + <span class="hljs-string">' '</span> + err.<span class="hljs-property">message</span>);</li><li>        })</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>     <div _ngcontent-jmq-c106="" class="highlight-div"><div _ngcontent-jmq-c106="" class="highlight-div-header"><div _ngcontent-jmq-c106="" class="highlight-div-header-left"><div _ngcontent-jmq-c106="" class="handle-button expand-button"><div _ngcontent-jmq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jmq-c106="" class="highlight-div-header-right"><div _ngcontent-jmq-c106="" class="handle-button ai-button"></div><div _ngcontent-jmq-c106="" class="handle-button line-button"><div _ngcontent-jmq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jmq-c106="" class="handle-button theme-button"><div _ngcontent-jmq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jmq-c106="" class="handle-button copy-button"><div _ngcontent-jmq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jmq-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// entry/src/main/ets/pages/Index.ets</span></li><li>
</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">PromptActionClass</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"library"</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">ComponentContent</span>, <span class="hljs-title class_">PromptAction</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span>;</li><li>
</li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Params</span> {</li><li>  <span class="hljs-attr">text</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">""</span>;</li><li>  <span class="hljs-attr">promptActionClass</span>: <span class="hljs-title class_">PromptActionClass</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PromptActionClass</span>();</li><li>
</li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">text: <span class="hljs-built_in">string</span>, promptActionClass: PromptActionClass</span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">text</span> = text;</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">promptActionClass</span> = promptActionClass;</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-meta">@Builder</span></li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">buildText</span>(<span class="hljs-params">params: Params</span>) {</li><li>  <span class="hljs-title class_">Column</span>() {</li><li>    <span class="hljs-title class_">Text</span>(params.<span class="hljs-property">text</span>)</li><li>      .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">20</span>)</li><li>      .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">10</span> })</li><li>    <span class="hljs-title class_">Button</span>(<span class="hljs-string">'Update'</span>)</li><li>      .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">10</span> })</li><li>      .<span class="hljs-title function_">width</span>(<span class="hljs-number">100</span>)</li><li>      .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>        params.<span class="hljs-property">promptActionClass</span>.<span class="hljs-title function_">updatePopup</span>({</li><li>          <span class="hljs-attr">enableArrow</span>: <span class="hljs-literal">false</span>,</li><li>        });</li><li>      })</li><li>    <span class="hljs-title class_">Button</span>(<span class="hljs-string">'Close'</span>)</li><li>      .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">10</span> })</li><li>      .<span class="hljs-title function_">width</span>(<span class="hljs-number">100</span>)</li><li>      .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>        params.<span class="hljs-property">promptActionClass</span>.<span class="hljs-title function_">closePopup</span>();</li><li>      })</li><li>  }.<span class="hljs-title function_">width</span>(<span class="hljs-number">130</span>).<span class="hljs-title function_">height</span>(<span class="hljs-number">150</span>)</li><li>}</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">"hello"</span>;</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">uiContext</span>: <span class="hljs-title class_">UIContext</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>();</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">promptAction</span>: <span class="hljs-title class_">PromptAction</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">uiContext</span>.<span class="hljs-title function_">getPromptAction</span>();</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">promptActionClass</span>: <span class="hljs-title class_">PromptActionClass</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">PromptActionClass</span>();</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">targetId</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">contentNode</span>: <span class="hljs-title class_">ComponentContent</span>&lt;<span class="hljs-title class_">Object</span>&gt; =</li><li>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">ComponentContent</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">uiContext</span>, <span class="hljs-title function_">wrapBuilder</span>(buildText), <span class="hljs-keyword">new</span> <span class="hljs-title class_">Params</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">promptActionClass</span>));</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">options</span>: <span class="hljs-title class_">PopupCommonOptions</span> = { <span class="hljs-attr">enableArrow</span>: <span class="hljs-literal">true</span> };</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">"openPopup"</span>)</li><li>        .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">50</span>, <span class="hljs-attr">left</span>: <span class="hljs-number">100</span> })</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-keyword">let</span> <span class="hljs-attr">frameNode</span>: <span class="hljs-title class_">FrameNode</span> | <span class="hljs-literal">null</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">uiContext</span>.<span class="hljs-title function_">getFrameNodeByUniqueId</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUniqueId</span>());</li><li>          <span class="hljs-keyword">let</span> targetId = frameNode?.<span class="hljs-title function_">getChild</span>(<span class="hljs-number">0</span>)?.<span class="hljs-title function_">getUniqueId</span>();</li><li>          <span class="hljs-keyword">if</span> (targetId == <span class="hljs-literal">undefined</span>) {</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">targetId</span> = <span class="hljs-number">0</span>;</li><li>          } <span class="hljs-keyword">else</span> {</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">targetId</span> = targetId;</li><li>          }</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">promptActionClass</span>.<span class="hljs-title function_">setPromptAction</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">promptAction</span>);</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">promptActionClass</span>.<span class="hljs-title function_">setContentNode</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">contentNode</span>);</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">promptActionClass</span>.<span class="hljs-title function_">setOptions</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">options</span>);</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">promptActionClass</span>.<span class="hljs-title function_">setIsPartialUpdate</span>(<span class="hljs-literal">false</span>);</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">promptActionClass</span>.<span class="hljs-title function_">setTarget</span>({ <span class="hljs-attr">id</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">targetId</span> });</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">promptActionClass</span>.<span class="hljs-title function_">openPopup</span>();</li><li>        })</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>     <p><span><img originheight="492" originwidth="340" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114924.02488821441876793081669541022012:50001231000000:2800:6DCB32AB81D611EE64049F4F75A7E12B9BBF6DC93B51D03707D8ADDCF38E0157.gif" width="340" height="492"></span></p>    </div>   </div>   <div></div></div>