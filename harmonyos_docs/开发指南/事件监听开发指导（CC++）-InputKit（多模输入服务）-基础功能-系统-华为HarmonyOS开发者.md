<h1 _ngcontent-pwo-c119="" class="doc-title ng-star-inserted" title="事件监听开发指导（C/C++）"> 事件监听开发指导（C/C++） </h1>

<div _ngcontent-pwo-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <div class="tiledSection">     <h2 id="功能介绍">功能介绍<i class="anchor-icon anchor-icon-link" anchorid="功能介绍" tips="复制节点链接"></i></h2>          <p>从API version 12开始，多模为应用提供了按键、输入事件（鼠标、触屏和轴事件）监听能力，当前仅支持录屏类应用。使用场景例如：用户在录屏应用开启录屏时，监听设备的按键、鼠标、触摸和轴事件。</p>    </div>    <div class="tiledSection">     <h2 id="接口说明">接口说明<i class="anchor-icon anchor-icon-link" anchorid="接口说明" tips="复制节点链接"></i></h2>          <p>创建和删除事件监听相关接口如下表所示，接口详细介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-input" target="_blank">Input文档</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.2.3.1.3.1.1" valign="top" width="50%">接口名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.2.3.1.3.1.2" valign="top" width="50%">描述</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="50%">Input_Result OH_Input_AddKeyEventMonitor(Input_KeyEventCallback callback)</td>         <td class="cellrowborder" valign="top" width="50%">创建按键事件监听。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">Input_Result OH_Input_AddMouseEventMonitor(Input_MouseEventCallback callback)</td>         <td class="cellrowborder" valign="top" width="50%">创建鼠标事件监听。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">Input_Result OH_Input_AddTouchEventMonitor(Input_TouchEventCallback callback)</td>         <td class="cellrowborder" valign="top" width="50%">创建触摸事件监听。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">Input_Result OH_Input_AddAxisEventMonitorForAll(Input_AxisEventCallback callback)</td>         <td class="cellrowborder" valign="top" width="50%">创建所有类型轴事件监听。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">Input_Result OH_Input_AddAxisEventMonitor(InputEvent_AxisEventType axisEventType, Input_AxisEventCallback callback)</td>         <td class="cellrowborder" valign="top" width="50%">创建指定类型轴事件监听。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">Input_Result OH_Input_RemoveKeyEventMonitor(Input_KeyEventCallback callback)</td>         <td class="cellrowborder" valign="top" width="50%">删除按键事件监听。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">Input_Result OH_Input_RemoveMouseEventMonitor(Input_MouseEventCallback callback)</td>         <td class="cellrowborder" valign="top" width="50%">删除鼠标事件监听。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">Input_Result OH_Input_RemoveTouchEventMonitor(Input_TouchEventCallback callback)</td>         <td class="cellrowborder" valign="top" width="50%">删除触摸事件监听。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">Input_Result OH_Input_RemoveAxisEventMonitorForAll(Input_AxisEventCallback callback)</td>         <td class="cellrowborder" valign="top" width="50%">删除所有类型轴事件监听。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">Input_Result OH_Input_RemoveAxisEventMonitor(InputEvent_AxisEventType axisEventType, Input_AxisEventCallback callback)</td>         <td class="cellrowborder" valign="top" width="50%">删除指定类型轴事件监听。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="开发步骤">开发步骤<i class="anchor-icon anchor-icon-link" anchorid="开发步骤" tips="复制节点链接"></i></h2>         </div>    <div class="tiledSection">     <h3 id="链接动态库" class="firsth2">链接动态库<i class="anchor-icon anchor-icon-link" anchorid="链接动态库" tips="复制节点链接"></i></h3>          <p>调用创建和删除事件拦截前，需链接相关动态库。链接动态库的方法是，在CMakeList.txt文件中新增如下配置：</p>     <div _ngcontent-pwo-c106="" class="highlight-div"><div _ngcontent-pwo-c106="" class="highlight-div-header"><div _ngcontent-pwo-c106="" class="highlight-div-header-left"><div _ngcontent-pwo-c106="" class="handle-button expand-button"><div _ngcontent-pwo-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pwo-c106="" class="highlight-div-header-right"><div _ngcontent-pwo-c106="" class="handle-button ai-button"></div><div _ngcontent-pwo-c106="" class="handle-button line-button"><div _ngcontent-pwo-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pwo-c106="" class="handle-button theme-button"><div _ngcontent-pwo-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pwo-c106="" class="handle-button copy-button"><div _ngcontent-pwo-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pwo-c106="" class="highlight-scroll-div"><pre class="txt prettyprint linenums hljs language-plaintext" hw-language="txt" data-highlighted="yes"><ol class="linenums"><li>target_link_libraries(entry PUBLIC libohinput.so)</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="申请所需权限">申请所需权限<i class="anchor-icon anchor-icon-link" anchorid="申请所需权限" tips="复制节点链接"></i></h3>          <p>应用需要在module.json5中添加下面权限的配置，详细的配置方法参考声明<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/declare-permissions">声明权限文档</a>。</p>     <div _ngcontent-pwo-c106="" class="highlight-div"><div _ngcontent-pwo-c106="" class="highlight-div-header"><div _ngcontent-pwo-c106="" class="highlight-div-header-left"><div _ngcontent-pwo-c106="" class="handle-button expand-button"><div _ngcontent-pwo-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pwo-c106="" class="highlight-div-header-right"><div _ngcontent-pwo-c106="" class="handle-button ai-button"></div><div _ngcontent-pwo-c106="" class="handle-button line-button"><div _ngcontent-pwo-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pwo-c106="" class="handle-button theme-button"><div _ngcontent-pwo-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pwo-c106="" class="handle-button copy-button"><div _ngcontent-pwo-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pwo-c106="" class="highlight-scroll-div"><pre class="json prettyprint linenums hljs language-json" hw-language="json" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-attr">"requestPermissions"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span></li><li>    <span class="hljs-punctuation">{</span></li><li>        <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ohos.permission.INPUT_MONITORING"</span></li><li>    <span class="hljs-punctuation">}</span></li><li><span class="hljs-punctuation">]</span></li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="创建事件监听">创建事件监听<i class="anchor-icon anchor-icon-link" anchorid="创建事件监听" tips="复制节点链接"></i></h3>          <ul>      <li><strong>按键事件</strong></li>     </ul>     <div _ngcontent-pwo-c106="" class="highlight-div"><div _ngcontent-pwo-c106="" class="highlight-div-header"><div _ngcontent-pwo-c106="" class="highlight-div-header-left"><div _ngcontent-pwo-c106="" class="handle-button expand-button"><div _ngcontent-pwo-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pwo-c106="" class="highlight-div-header-right"><div _ngcontent-pwo-c106="" class="handle-button ai-button"></div><div _ngcontent-pwo-c106="" class="handle-button line-button"><div _ngcontent-pwo-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pwo-c106="" class="handle-button theme-button"><div _ngcontent-pwo-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pwo-c106="" class="handle-button copy-button"><div _ngcontent-pwo-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pwo-c106="" class="highlight-scroll-div"><pre class="prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"multimodalinput/oh_input_manager.h"</span></span></li><li>
</li><li><span class="hljs-keyword">struct</span> <span class="hljs-title class_">KeyEvent</span> {</li><li>    <span class="hljs-type">int32_t</span> action;</li><li>    <span class="hljs-type">int32_t</span> keyCode;</li><li>    <span class="hljs-type">int64_t</span> actionTime { <span class="hljs-number">-1</span> };</li><li>};</li><li>
</li><li><span class="hljs-comment">//定义按键事件回调函数</span></li><li><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">OnKeyEventCallback</span><span class="hljs-params">(<span class="hljs-type">const</span> Input_KeyEvent* keyEvent)</span></span></li><li><span class="hljs-function"></span>{</li><li>    KeyEvent event;</li><li>    <span class="hljs-comment">//Input_KeyEvent的生命周期仅限于回调函数内，回调函数执行完毕后会被自动销毁</span></li><li>    event.action = <span class="hljs-built_in">OH_Input_GetKeyEventAction</span>(keyEvent);</li><li>    event.keyCode = <span class="hljs-built_in">OH_Input_GetKeyEventKeyCode</span>(keyEvent);</li><li>    event.actionTime = <span class="hljs-built_in">OH_Input_GetKeyEventActionTime</span>(keyEvent);</li><li>}</li><li>
</li><li><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">TestKeyEventMonitor</span><span class="hljs-params">()</span></span></li><li><span class="hljs-function"></span>{</li><li>    <span class="hljs-comment">//添加按键事件监听</span></li><li>    Input_Result ret = <span class="hljs-built_in">OH_Input_AddKeyEventMonitor</span>(OnKeyEventCallback);</li><li>    <span class="hljs-comment">//移除按键事件监听</span></li><li>    ret = <span class="hljs-built_in">OH_Input_RemoveKeyEventMonitor</span>(OnKeyEventCallback);</li><li>}</li></ol></pre></div></div>     <ul>      <li><strong>鼠标事件</strong></li>     </ul>     <div _ngcontent-pwo-c106="" class="highlight-div"><div _ngcontent-pwo-c106="" class="highlight-div-header"><div _ngcontent-pwo-c106="" class="highlight-div-header-left"><div _ngcontent-pwo-c106="" class="handle-button expand-button"><div _ngcontent-pwo-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pwo-c106="" class="highlight-div-header-right"><div _ngcontent-pwo-c106="" class="handle-button ai-button"></div><div _ngcontent-pwo-c106="" class="handle-button line-button"><div _ngcontent-pwo-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pwo-c106="" class="handle-button theme-button"><div _ngcontent-pwo-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pwo-c106="" class="handle-button copy-button"><div _ngcontent-pwo-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pwo-c106="" class="highlight-scroll-div"><pre class="prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"multimodalinput/oh_input_manager.h"</span></span></li><li>
</li><li><span class="hljs-keyword">struct</span> <span class="hljs-title class_">MouseEvent</span> {</li><li>    <span class="hljs-type">int32_t</span> action;</li><li>    <span class="hljs-type">int32_t</span> displayX;</li><li>    <span class="hljs-type">int32_t</span> displayY;</li><li>    <span class="hljs-type">int32_t</span> button { <span class="hljs-number">-1</span> };</li><li>    <span class="hljs-type">int32_t</span> axisType { <span class="hljs-number">-1</span> };</li><li>    <span class="hljs-type">float</span> axisValue { <span class="hljs-number">0.0f</span> };</li><li>    <span class="hljs-type">int64_t</span> actionTime { <span class="hljs-number">-1</span> };</li><li>};</li><li>
</li><li><span class="hljs-comment">//定义鼠标事件回调函数</span></li><li><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">OnMouseEventCallback</span><span class="hljs-params">(<span class="hljs-type">const</span> Input_MouseEvent* mouseEvent)</span></span></li><li><span class="hljs-function"></span>{</li><li>    MouseEvent event;</li><li>    <span class="hljs-comment">//Input_MouseEvent的生命周期仅限于回调函数内，回调函数执行完毕后会被自动销毁</span></li><li>    event.action = <span class="hljs-built_in">OH_Input_GetMouseEventAction</span>(mouseEvent);</li><li>    event.displayX = <span class="hljs-built_in">OH_Input_GetMouseEventDisplayX</span>(mouseEvent);</li><li>    event.displayY = <span class="hljs-built_in">OH_Input_GetMouseEventDisplayY</span>(mouseEvent);</li><li>    event.button = <span class="hljs-built_in">OH_Input_GetMouseEventButton</span>(mouseEvent);</li><li>    event.axisType = <span class="hljs-built_in">OH_Input_GetMouseEventAxisType</span>(mouseEvent);</li><li>    event.axisValue = <span class="hljs-built_in">OH_Input_GetMouseEventAxisValue</span>(mouseEvent);</li><li>    event.actionTime = <span class="hljs-built_in">OH_Input_GetMouseEventActionTime</span>(mouseEvent);</li><li>}</li><li>
</li><li><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">TestMouseEventMonitor</span><span class="hljs-params">()</span></span></li><li><span class="hljs-function"></span>{</li><li>    <span class="hljs-comment">//添加鼠标事件监听</span></li><li>    Input_Result ret = <span class="hljs-built_in">OH_Input_AddMouseEventMonitor</span>(OnMouseEventCallback);</li><li>    <span class="hljs-comment">//移除鼠标事件监听</span></li><li>    ret = <span class="hljs-built_in">OH_Input_RemoveMouseEventMonitor</span>(OnMouseEventCallback);</li><li>}</li></ol></pre></div></div>     <ul>      <li><strong>触摸事件</strong></li>     </ul>     <div _ngcontent-pwo-c106="" class="highlight-div"><div _ngcontent-pwo-c106="" class="highlight-div-header"><div _ngcontent-pwo-c106="" class="highlight-div-header-left"><div _ngcontent-pwo-c106="" class="handle-button expand-button"><div _ngcontent-pwo-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pwo-c106="" class="highlight-div-header-right"><div _ngcontent-pwo-c106="" class="handle-button ai-button"></div><div _ngcontent-pwo-c106="" class="handle-button line-button"><div _ngcontent-pwo-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pwo-c106="" class="handle-button theme-button"><div _ngcontent-pwo-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pwo-c106="" class="handle-button copy-button"><div _ngcontent-pwo-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pwo-c106="" class="highlight-scroll-div"><pre class="prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"multimodalinput/oh_input_manager.h"</span></span></li><li>
</li><li><span class="hljs-keyword">struct</span> <span class="hljs-title class_">TouchEvent</span> {</li><li>    <span class="hljs-type">int32_t</span> action;</li><li>    <span class="hljs-type">int32_t</span> id;</li><li>    <span class="hljs-type">int32_t</span> displayX;</li><li>    <span class="hljs-type">int32_t</span> displayY;</li><li>    <span class="hljs-type">int64_t</span> actionTime { <span class="hljs-number">-1</span> };</li><li>};</li><li>
</li><li><span class="hljs-comment">//定义触摸事件回调函数</span></li><li><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">OnTouchEventCallback</span><span class="hljs-params">(<span class="hljs-type">const</span> Input_TouchEvent* touchEvent)</span></span></li><li><span class="hljs-function"></span>{</li><li>    TouchEvent event;</li><li>    <span class="hljs-comment">//Input_TouchEvent的生命周期仅限于回调函数内，回调函数执行完毕后会被自动销毁</span></li><li>    event.action = <span class="hljs-built_in">OH_Input_GetTouchEventAction</span>(touchEvent);</li><li>    event.id = <span class="hljs-built_in">OH_Input_GetTouchEventFingerId</span>(touchEvent);</li><li>    event.displayX = <span class="hljs-built_in">OH_Input_GetTouchEventDisplayX</span>(touchEvent);</li><li>    event.displayY = <span class="hljs-built_in">OH_Input_GetTouchEventDisplayY</span>(touchEvent);</li><li>    event.actionTime = <span class="hljs-built_in">OH_Input_GetTouchEventActionTime</span>(touchEvent);</li><li>}</li><li>
</li><li><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">TestTouchEventMonitor</span><span class="hljs-params">()</span></span></li><li><span class="hljs-function"></span>{</li><li>    <span class="hljs-comment">//添加触摸事件监听</span></li><li>    Input_Result ret = <span class="hljs-built_in">OH_Input_AddTouchEventMonitor</span>(OnTouchEventCallback);</li><li>    <span class="hljs-comment">//移除触摸事件监听</span></li><li>    ret = <span class="hljs-built_in">OH_Input_RemoveTouchEventMonitor</span>(OnTouchEventCallback);</li><li>}</li></ol></pre></div></div>     <ul>      <li><strong>轴事件</strong></li>     </ul>     <div _ngcontent-pwo-c106="" class="highlight-div"><div _ngcontent-pwo-c106="" class="highlight-div-header"><div _ngcontent-pwo-c106="" class="highlight-div-header-left"><div _ngcontent-pwo-c106="" class="handle-button expand-button"><div _ngcontent-pwo-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pwo-c106="" class="highlight-div-header-right"><div _ngcontent-pwo-c106="" class="handle-button ai-button"></div><div _ngcontent-pwo-c106="" class="handle-button line-button"><div _ngcontent-pwo-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pwo-c106="" class="handle-button theme-button"><div _ngcontent-pwo-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pwo-c106="" class="handle-button copy-button"><div _ngcontent-pwo-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pwo-c106="" class="highlight-scroll-div"><pre class="prettyprint linenums hljs language-cangjie" data-highlighted="yes"><ol class="linenums"><li>#<span class="hljs-variable">include</span> <span class="hljs-string">"multimodalinput/oh_input_manager.h"</span></li><li>#<span class="hljs-title class_">include</span> &lt;<span class="hljs-title class_">map</span>&gt;</li><li>
</li><li><span class="hljs-keyword">struct</span> <span class="hljs-title class_">AxisEvent</span> {</li><li>    <span class="hljs-variable">int32_t</span> <span class="hljs-variable">axisAction</span>;</li><li>    <span class="hljs-variable">float</span> <span class="hljs-variable">displayX</span>;</li><li>    <span class="hljs-variable">float</span> <span class="hljs-variable">displayY</span>;</li><li>    <span class="hljs-variable">std</span>::<span class="hljs-title class_">map</span>&lt;<span class="hljs-title class_">int32_t</span>, <span class="hljs-title class_">double</span>&gt; <span class="hljs-title class_">axisValues</span>;</li><li>    <span class="hljs-variable">int64_t</span> <span class="hljs-variable">actionTime</span> { -<span class="hljs-number">1</span> };</li><li>    <span class="hljs-variable">int32_t</span> <span class="hljs-variable">sourceType</span>;</li><li>    <span class="hljs-variable">int32_t</span> <span class="hljs-variable">axisEventType</span> { -<span class="hljs-number">1</span> };</li><li>};</li><li>
</li><li><span class="hljs-comment">//定义所有类型轴事件回调函数</span></li><li><span class="hljs-variable">void</span> <span class="hljs-title function_">OnAllAxisEventCallback</span>(<span class="hljs-keyword">const</span> <span class="hljs-variable">Input_AxisEvent</span>* <span class="hljs-variable">axisEvent</span>)</li><li>{</li><li>    <span class="hljs-variable">AxisEvent</span> <span class="hljs-variable">event</span>;</li><li>    </li><li>    <span class="hljs-comment">//Input_AxisEvent的生命周期仅限于回调函数内，回调函数执行完毕后会被自动销毁</span></li><li>    <span class="hljs-variable">InputEvent_AxisAction</span> <span class="hljs-variable">action</span>;</li><li>    <span class="hljs-variable">Input_Result</span> <span class="hljs-variable">ret</span> = <span class="hljs-title function_">OH_Input_GetAxisEventAction</span>(<span class="hljs-variable">axisEvent</span>, &amp;<span class="hljs-title class_">action</span>);</li><li>    <span class="hljs-variable">event</span>.<span class="hljs-variable">axisAction</span> = <span class="hljs-variable">action</span>;</li><li>    <span class="hljs-variable">ret</span> = <span class="hljs-title function_">OH_Input_GetAxisEventDisplayX</span>(<span class="hljs-variable">axisEvent</span>, &amp;<span class="hljs-title class_">event</span>.<span class="hljs-variable">displayX</span>);</li><li>    <span class="hljs-variable">ret</span> = <span class="hljs-title function_">OH_Input_GetAxisEventDisplayY</span>(<span class="hljs-variable">axisEvent</span>, &amp;<span class="hljs-title class_">event</span>.<span class="hljs-variable">displayY</span>);</li><li>    <span class="hljs-variable">ret</span> = <span class="hljs-title function_">OH_Input_GetAxisEventActionTime</span>(<span class="hljs-variable">axisEvent</span>, &amp;<span class="hljs-title class_">event</span>.<span class="hljs-variable">actionTime</span>);</li><li>    <span class="hljs-variable">InputEvent_SourceType</span> <span class="hljs-variable">sourceType</span>;</li><li>    <span class="hljs-variable">ret</span> = <span class="hljs-title function_">OH_Input_GetAxisEventSourceType</span>(<span class="hljs-variable">axisEvent</span>, &amp;<span class="hljs-title class_">sourceType</span>);</li><li>    <span class="hljs-variable">event</span>.<span class="hljs-variable">sourceType</span> = <span class="hljs-variable">sourceType</span>;</li><li>    <span class="hljs-variable">InputEvent_AxisEventType</span> <span class="hljs-variable">axisEventType</span>;</li><li>    <span class="hljs-variable">ret</span> = <span class="hljs-title function_">OH_Input_GetAxisEventType</span>(<span class="hljs-variable">axisEvent</span>, &amp;<span class="hljs-title class_">axisEventType</span>);</li><li>    <span class="hljs-variable">event</span>.<span class="hljs-variable">axisEventType</span> = <span class="hljs-variable">axisEventType</span>;</li><li>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">event</span>.<span class="hljs-variable">axisEventType</span> == <span class="hljs-variable">AXIS_EVENT_TYPE_PINCH</span>) {</li><li>        <span class="hljs-variable">double</span> <span class="hljs-variable">value</span> = <span class="hljs-number">0</span>;</li><li>        <span class="hljs-variable">ret</span> = <span class="hljs-title function_">OH_Input_GetAxisEventAxisValue</span>(<span class="hljs-variable">axisEvent</span>, <span class="hljs-variable">AXIS_TYPE_PINCH</span>, &amp;<span class="hljs-title class_">value</span>);</li><li>        <span class="hljs-variable">event</span>.<span class="hljs-variable">axisValues</span>.<span class="hljs-title function_">insert</span>(<span class="hljs-variable">std</span>::<span class="hljs-title class_">make_pair</span>(<span class="hljs-title class_">AXIS_TYPE_PINCH</span>, <span class="hljs-title class_">value</span>));</li><li>        <span class="hljs-variable">ret</span> = <span class="hljs-title function_">OH_Input_GetAxisEventAxisValue</span>(<span class="hljs-variable">axisEvent</span>, <span class="hljs-variable">AXIS_TYPE_ROTATE</span>, &amp;<span class="hljs-title class_">value</span>);</li><li>        <span class="hljs-variable">event</span>.<span class="hljs-variable">axisValues</span>.<span class="hljs-title function_">insert</span>(<span class="hljs-variable">std</span>::<span class="hljs-title class_">make_pair</span>(<span class="hljs-title class_">AXIS_TYPE_ROTATE</span>, <span class="hljs-title class_">value</span>));</li><li>    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-variable">event</span>.<span class="hljs-variable">axisEventType</span> == <span class="hljs-variable">AXIS_EVENT_TYPE_SCROLL</span>) {</li><li>        <span class="hljs-variable">double</span> <span class="hljs-variable">value</span> = <span class="hljs-number">0</span>;</li><li>        <span class="hljs-variable">ret</span> = <span class="hljs-title function_">OH_Input_GetAxisEventAxisValue</span>(<span class="hljs-variable">axisEvent</span>, <span class="hljs-variable">AXIS_TYPE_SCROLL_VERTICAL</span>, &amp;<span class="hljs-title class_">value</span>);</li><li>        <span class="hljs-variable">event</span>.<span class="hljs-variable">axisValues</span>.<span class="hljs-title function_">insert</span>(<span class="hljs-variable">std</span>::<span class="hljs-title class_">make_pair</span>(<span class="hljs-title class_">AXIS_TYPE_SCROLL_VERTICAL</span>, <span class="hljs-title class_">value</span>));</li><li>        <span class="hljs-variable">ret</span> = <span class="hljs-title function_">OH_Input_GetAxisEventAxisValue</span>(<span class="hljs-variable">axisEvent</span>, <span class="hljs-variable">AXIS_TYPE_SCROLL_HORIZONTAL</span>, &amp;<span class="hljs-title class_">value</span>);</li><li>        <span class="hljs-variable">event</span>.<span class="hljs-variable">axisValues</span>.<span class="hljs-title function_">insert</span>(<span class="hljs-variable">std</span>::<span class="hljs-title class_">make_pair</span>(<span class="hljs-title class_">AXIS_TYPE_SCROLL_HORIZONTAL</span>, <span class="hljs-title class_">value</span>));</li><li>    }</li><li>}</li><li>
</li><li><span class="hljs-comment">//定义捏合类型轴事件回调函数</span></li><li><span class="hljs-variable">void</span> <span class="hljs-title function_">OnPinchAxisEventCallback</span>(<span class="hljs-keyword">const</span> <span class="hljs-variable">Input_AxisEvent</span>* <span class="hljs-variable">axisEvent</span>)</li><li>{</li><li>    <span class="hljs-variable">AxisEvent</span> <span class="hljs-variable">event</span>;</li><li>    </li><li>    <span class="hljs-comment">//Input_AxisEvent的生命周期仅限于回调函数内，回调函数执行完毕后会被自动销毁</span></li><li>    <span class="hljs-variable">InputEvent_AxisAction</span> <span class="hljs-variable">action</span>;</li><li>    <span class="hljs-variable">Input_Result</span> <span class="hljs-variable">ret</span> = <span class="hljs-title function_">OH_Input_GetAxisEventAction</span>(<span class="hljs-variable">axisEvent</span>, &amp;<span class="hljs-title class_">action</span>);</li><li>    <span class="hljs-variable">event</span>.<span class="hljs-variable">axisAction</span> = <span class="hljs-variable">action</span>;</li><li>    <span class="hljs-variable">ret</span> = <span class="hljs-title function_">OH_Input_GetAxisEventDisplayX</span>(<span class="hljs-variable">axisEvent</span>, &amp;<span class="hljs-title class_">event</span>.<span class="hljs-variable">displayX</span>);</li><li>    <span class="hljs-variable">ret</span> = <span class="hljs-title function_">OH_Input_GetAxisEventDisplayY</span>(<span class="hljs-variable">axisEvent</span>, &amp;<span class="hljs-title class_">event</span>.<span class="hljs-variable">displayY</span>);</li><li>    <span class="hljs-variable">ret</span> = <span class="hljs-title function_">OH_Input_GetAxisEventActionTime</span>(<span class="hljs-variable">axisEvent</span>, &amp;<span class="hljs-title class_">event</span>.<span class="hljs-variable">actionTime</span>);</li><li>    <span class="hljs-variable">InputEvent_SourceType</span> <span class="hljs-variable">sourceType</span>;</li><li>    <span class="hljs-variable">ret</span> = <span class="hljs-title function_">OH_Input_GetAxisEventSourceType</span>(<span class="hljs-variable">axisEvent</span>, &amp;<span class="hljs-title class_">sourceType</span>);</li><li>    <span class="hljs-variable">event</span>.<span class="hljs-variable">sourceType</span> = <span class="hljs-variable">sourceType</span>;</li><li>    <span class="hljs-variable">InputEvent_AxisEventType</span> <span class="hljs-variable">axisEventType</span>;</li><li>    <span class="hljs-variable">ret</span> = <span class="hljs-title function_">OH_Input_GetAxisEventType</span>(<span class="hljs-variable">axisEvent</span>, &amp;<span class="hljs-title class_">axisEventType</span>);</li><li>    <span class="hljs-variable">event</span>.<span class="hljs-variable">axisEventType</span> = <span class="hljs-variable">axisEventType</span>;</li><li>    <span class="hljs-variable">double</span> <span class="hljs-variable">value</span> = <span class="hljs-number">0</span>;</li><li>    <span class="hljs-variable">ret</span> = <span class="hljs-title function_">OH_Input_GetAxisEventAxisValue</span>(<span class="hljs-variable">axisEvent</span>, <span class="hljs-variable">AXIS_TYPE_PINCH</span>, &amp;<span class="hljs-title class_">value</span>);</li><li>    <span class="hljs-variable">event</span>.<span class="hljs-variable">axisValues</span>.<span class="hljs-title function_">insert</span>(<span class="hljs-variable">std</span>::<span class="hljs-title class_">make_pair</span>(<span class="hljs-title class_">AXIS_TYPE_PINCH</span>, <span class="hljs-title class_">value</span>));</li><li>    <span class="hljs-variable">ret</span> = <span class="hljs-title function_">OH_Input_GetAxisEventAxisValue</span>(<span class="hljs-variable">axisEvent</span>, <span class="hljs-variable">AXIS_TYPE_ROTATE</span>, &amp;<span class="hljs-title class_">value</span>);</li><li>    <span class="hljs-variable">event</span>.<span class="hljs-variable">axisValues</span>.<span class="hljs-title function_">insert</span>(<span class="hljs-variable">std</span>::<span class="hljs-title class_">make_pair</span>(<span class="hljs-title class_">AXIS_TYPE_ROTATE</span>, <span class="hljs-title class_">value</span>));</li><li>}</li><li>
</li><li><span class="hljs-comment">//定义滚轮类型轴事件回调函数</span></li><li><span class="hljs-variable">void</span> <span class="hljs-title function_">OnScrollAxisEventCallback</span>(<span class="hljs-keyword">const</span> <span class="hljs-variable">Input_AxisEvent</span>* <span class="hljs-variable">axisEvent</span>)</li><li>{</li><li>    <span class="hljs-variable">AxisEvent</span> <span class="hljs-variable">event</span>;</li><li>    </li><li>    <span class="hljs-comment">//Input_AxisEvent的生命周期仅限于回调函数内，回调函数执行完毕后会被自动销毁</span></li><li>    <span class="hljs-variable">InputEvent_AxisAction</span> <span class="hljs-variable">action</span>;</li><li>    <span class="hljs-variable">Input_Result</span> <span class="hljs-variable">ret</span> = <span class="hljs-title function_">OH_Input_GetAxisEventAction</span>(<span class="hljs-variable">axisEvent</span>, &amp;<span class="hljs-title class_">action</span>);</li><li>    <span class="hljs-variable">event</span>.<span class="hljs-variable">axisAction</span> = <span class="hljs-variable">action</span>;</li><li>    <span class="hljs-variable">ret</span> = <span class="hljs-title function_">OH_Input_GetAxisEventDisplayX</span>(<span class="hljs-variable">axisEvent</span>, &amp;<span class="hljs-title class_">event</span>.<span class="hljs-variable">displayX</span>);</li><li>    <span class="hljs-variable">ret</span> = <span class="hljs-title function_">OH_Input_GetAxisEventDisplayY</span>(<span class="hljs-variable">axisEvent</span>, &amp;<span class="hljs-title class_">event</span>.<span class="hljs-variable">displayY</span>);</li><li>    <span class="hljs-variable">ret</span> = <span class="hljs-title function_">OH_Input_GetAxisEventActionTime</span>(<span class="hljs-variable">axisEvent</span>, &amp;<span class="hljs-title class_">event</span>.<span class="hljs-variable">actionTime</span>);</li><li>    <span class="hljs-variable">InputEvent_SourceType</span> <span class="hljs-variable">sourceType</span>;</li><li>    <span class="hljs-variable">ret</span> = <span class="hljs-title function_">OH_Input_GetAxisEventSourceType</span>(<span class="hljs-variable">axisEvent</span>, &amp;<span class="hljs-title class_">sourceType</span>);</li><li>    <span class="hljs-variable">event</span>.<span class="hljs-variable">sourceType</span> = <span class="hljs-variable">sourceType</span>;</li><li>    <span class="hljs-variable">InputEvent_AxisEventType</span> <span class="hljs-variable">axisEventType</span>;</li><li>    <span class="hljs-variable">ret</span> = <span class="hljs-title function_">OH_Input_GetAxisEventType</span>(<span class="hljs-variable">axisEvent</span>, &amp;<span class="hljs-title class_">axisEventType</span>);</li><li>    <span class="hljs-variable">event</span>.<span class="hljs-variable">axisEventType</span> = <span class="hljs-variable">axisEventType</span>;</li><li>    <span class="hljs-variable">double</span> <span class="hljs-variable">value</span> = <span class="hljs-number">0</span>;</li><li>    <span class="hljs-variable">ret</span> = <span class="hljs-title function_">OH_Input_GetAxisEventAxisValue</span>(<span class="hljs-variable">axisEvent</span>, <span class="hljs-variable">AXIS_TYPE_SCROLL_VERTICAL</span>, &amp;<span class="hljs-title class_">value</span>);</li><li>    <span class="hljs-variable">event</span>.<span class="hljs-variable">axisValues</span>.<span class="hljs-title function_">insert</span>(<span class="hljs-variable">std</span>::<span class="hljs-title class_">make_pair</span>(<span class="hljs-title class_">AXIS_TYPE_SCROLL_VERTICAL</span>, <span class="hljs-title class_">value</span>));</li><li>    <span class="hljs-variable">ret</span> = <span class="hljs-title function_">OH_Input_GetAxisEventAxisValue</span>(<span class="hljs-variable">axisEvent</span>, <span class="hljs-variable">AXIS_TYPE_SCROLL_HORIZONTAL</span>, &amp;<span class="hljs-title class_">value</span>);</li><li>    <span class="hljs-variable">event</span>.<span class="hljs-variable">axisValues</span>.<span class="hljs-title function_">insert</span>(<span class="hljs-variable">std</span>::<span class="hljs-title class_">make_pair</span>(<span class="hljs-title class_">AXIS_TYPE_SCROLL_HORIZONTAL</span>, <span class="hljs-title class_">value</span>));</li><li>}</li><li>
</li><li><span class="hljs-variable">void</span> <span class="hljs-title function_">TestAxisEventMonitor</span>()</li><li>{</li><li>    <span class="hljs-comment">//添加所有类型轴事件监听</span></li><li>    <span class="hljs-variable">Input_Result</span> <span class="hljs-variable">ret</span> = <span class="hljs-title function_">OH_Input_AddAxisEventMonitorForAll</span>(<span class="hljs-variable">OnAllAxisEventCallback</span>);</li><li>    <span class="hljs-comment">//移除所有类型轴事件监听</span></li><li>    <span class="hljs-variable">ret</span> = <span class="hljs-title function_">OH_Input_RemoveAxisEventMonitorForAll</span>(<span class="hljs-variable">OnAllAxisEventCallback</span>);</li><li>
</li><li>    <span class="hljs-comment">//添加捏合类型轴事件监听</span></li><li>    <span class="hljs-variable">ret</span> = <span class="hljs-title function_">OH_Input_AddAxisEventMonitor</span>(<span class="hljs-variable">AXIS_EVENT_TYPE_PINCH</span>, <span class="hljs-variable">OnPinchAxisEventCallback</span>);</li><li>    <span class="hljs-comment">//移除捏合类型轴事件监听</span></li><li>    <span class="hljs-variable">ret</span> = <span class="hljs-title function_">OH_Input_RemoveAxisEventMonitor</span>(<span class="hljs-variable">AXIS_EVENT_TYPE_PINCH</span>, <span class="hljs-variable">OnPinchAxisEventCallback</span>);</li><li>
</li><li>    <span class="hljs-comment">//添加滚轮类型轴事件监听</span></li><li>    <span class="hljs-variable">ret</span> = <span class="hljs-title function_">OH_Input_AddAxisEventMonitor</span>(<span class="hljs-variable">AXIS_EVENT_TYPE_SCROLL</span>, <span class="hljs-variable">OnScrollAxisEventCallback</span>);</li><li>    <span class="hljs-comment">//移除滚轮类型轴事件监听</span></li><li>    <span class="hljs-variable">ret</span> = <span class="hljs-title function_">OH_Input_RemoveAxisEventMonitor</span>(<span class="hljs-variable">AXIS_EVENT_TYPE_SCROLL</span>, <span class="hljs-variable">OnScrollAxisEventCallback</span>);</li><li>}</li></ol></pre></div></div>    </div>   </div>   <div></div></div>