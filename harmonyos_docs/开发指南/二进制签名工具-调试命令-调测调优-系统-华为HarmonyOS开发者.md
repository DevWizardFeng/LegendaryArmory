<h1 _ngcontent-hxj-c119="" class="doc-title ng-star-inserted" title="二进制签名工具"> 二进制签名工具 </h1>

<div _ngcontent-hxj-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div><p>Binary Sign Tool （二进制签名工具），是用于在HarmonyOS PC/2in1设备上对二进制文件进行代码签名的工具，支持通过命令行的方式对标准ELF文件进行代码签名或打印已签名ELF的证书信息。</p> <p>工具可以在本地下载的HarmonyOS的SDK库toolchains/lib中找到，文件名为binary-sign-tool。</p>  <div class="tiledSection"><h2 id="环境说明">环境说明<i class="anchor-icon anchor-icon-link" anchorid="环境说明" tips="复制节点链接"></i></h2><p>在使用本工具前，开发者需要先获取<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/hdc">hdc</a>工具，执行hdc shell命令。</p> </div>  <div class="tiledSection"><h2 id="二进制签名工具命令列表">二进制签名工具命令列表<i class="anchor-icon anchor-icon-link" anchorid="二进制签名工具命令列表" tips="复制节点链接"></i></h2> <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.4.2.1.3.1.1" valign="top" width="50%">命令</th> <th align="left" class="cellrowborder" id="mcps1.3.4.2.1.3.1.2" valign="top" width="50%">描述</th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="50%">help</td> <td class="cellrowborder" valign="top" width="50%">帮助命令，用于查询工具支持的命令信息。</td> </tr> <tr><td class="cellrowborder" valign="top" width="50%">sign</td> <td class="cellrowborder" valign="top" width="50%">二进制文件签名。</td> </tr> <tr><td class="cellrowborder" valign="top" width="50%">display-sign</td> <td class="cellrowborder" valign="top" width="50%">打印文件签名证书信息。</td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h2 id="帮助命令help">帮助命令（help）<i class="anchor-icon anchor-icon-link" anchorid="帮助命令help" tips="复制节点链接"></i></h2><div _ngcontent-hxj-c106="" class="highlight-div"><div _ngcontent-hxj-c106="" class="highlight-div-header"><div _ngcontent-hxj-c106="" class="highlight-div-header-left"><div _ngcontent-hxj-c106="" class="handle-button expand-button"><div _ngcontent-hxj-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-hxj-c106="" class="highlight-div-header-right"><div _ngcontent-hxj-c106="" class="handle-button ai-button"></div><div _ngcontent-hxj-c106="" class="handle-button line-button"><div _ngcontent-hxj-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-hxj-c106="" class="handle-button theme-button"><div _ngcontent-hxj-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-hxj-c106="" class="handle-button copy-button"><div _ngcontent-hxj-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-hxj-c106="" class="highlight-scroll-div"><pre class="bash prettyprint linenums hljs language-bash" hw-language="bash" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment"># 显示帮助信息</span></li><li>binary-sign-tool -<span class="hljs-built_in">help</span></li></ol></pre></div></div> </div>  <div class="tiledSection"><h2 id="签名命令sign">签名命令（sign）<i class="anchor-icon anchor-icon-link" anchorid="签名命令sign" tips="复制节点链接"></i></h2><p><strong>命令参数列表</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.6.3.1.3.1.1" valign="top" width="50%">参数</th> <th align="left" class="cellrowborder" id="mcps1.3.6.3.1.3.1.2" valign="top" width="50%">参数说明</th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="50%">-keyAlias</td> <td class="cellrowborder" valign="top" width="50%">密钥别名，必填项，不区分大小写。</td> </tr> <tr><td class="cellrowborder" valign="top" width="50%">-keyPwd</td> <td class="cellrowborder" valign="top" width="50%">密钥口令，可选项。</td> </tr> <tr><td class="cellrowborder" valign="top" width="50%">-appCertFile</td> <td class="cellrowborder" valign="top" width="50%">签名证书文件（证书链，顺序为实体证书-中间CA证书-根证书），必填项。</td> </tr> <tr><td class="cellrowborder" valign="top" width="50%">-profileFile</td> <td class="cellrowborder" valign="top" width="50%">签名后的Provision Profile文件名，p7b格式，可选项。</td> </tr> <tr><td class="cellrowborder" valign="top" width="50%">-profileSigned</td> <td class="cellrowborder" valign="top" width="50%">指示profile文件是否带有签名，1表示有签名，0表示没有签名，默认为1。可选项。</td> </tr> <tr><td class="cellrowborder" valign="top" width="50%">-signAlg</td> <td class="cellrowborder" valign="top" width="50%">签名算法，必填项，包括SHA256withECDSA或SHA384withECDSA。</td> </tr> <tr><td class="cellrowborder" valign="top" width="50%">-keystoreFile</td> <td class="cellrowborder" valign="top" width="50%">密钥库文件，非自签名模式时为必填项。</td> </tr> <tr><td class="cellrowborder" valign="top" width="50%">-keystorePwd</td> <td class="cellrowborder" valign="top" width="50%">密钥库口令，可选项。</td> </tr> <tr><td class="cellrowborder" valign="top" width="50%">-inFile</td> <td class="cellrowborder" valign="top" width="50%">输入的原始elf文件，必填项。</td> </tr> <tr><td class="cellrowborder" valign="top" width="50%">-outFile</td> <td class="cellrowborder" valign="top" width="50%">输出签名后文件，必填项。</td> </tr> <tr><td class="cellrowborder" valign="top" width="50%">-moduleFile</td> <td class="cellrowborder" valign="top" width="50%">权限module.json文件，可选项。</td> </tr> <tr><td class="cellrowborder" valign="top" width="50%">-selfSign</td> <td class="cellrowborder" valign="top" width="50%">是否本机自签名模式，1表示自签名，0表示证书签名，默认为0，可选项。</td> </tr>  </tbody></table></div> </div> <p><strong>示例</strong>：</p> <div _ngcontent-hxj-c106="" class="highlight-div"><div _ngcontent-hxj-c106="" class="highlight-div-header"><div _ngcontent-hxj-c106="" class="highlight-div-header-left"><div _ngcontent-hxj-c106="" class="handle-button expand-button"><div _ngcontent-hxj-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-hxj-c106="" class="highlight-div-header-right"><div _ngcontent-hxj-c106="" class="handle-button ai-button"></div><div _ngcontent-hxj-c106="" class="handle-button line-button"><div _ngcontent-hxj-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-hxj-c106="" class="handle-button theme-button"><div _ngcontent-hxj-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-hxj-c106="" class="handle-button copy-button"><div _ngcontent-hxj-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-hxj-c106="" class="highlight-scroll-div"><pre class="bash prettyprint linenums hljs language-bash" hw-language="bash" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment"># 对二进制文件签名</span></li><li>binary-sign-tool sign -keyAlias <span class="hljs-string">"oh-app1-key-v1"</span> -signAlg <span class="hljs-string">"SHA256withECDSA"</span> -appCertFile <span class="hljs-string">"app1.pem"</span> -profileFile <span class="hljs-string">"app1-profile.p7b"</span> -profileSigned <span class="hljs-string">"1"</span> -inFile <span class="hljs-string">"unsigned-elf"</span> -keystoreFile <span class="hljs-string">"ohtest.p12"</span> -outFile <span class="hljs-string">"signed-elf"</span> -keyPwd <span class="hljs-string">"123456"</span> -keystorePwd <span class="hljs-string">"123456"</span> -moduleFile <span class="hljs-string">"module.json"</span></li><li><span class="hljs-comment"># 执行结果</span></li><li>write code sign data success.</li></ol></pre></div></div> </div>  <div class="tiledSection"><h2 id="打印签名证书信息命令display-sign">打印签名证书信息命令（display-sign）<i class="anchor-icon anchor-icon-link" anchorid="打印签名证书信息命令display-sign" tips="复制节点链接"></i></h2><p><strong>命令参数列表</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.7.3.1.3.1.1" valign="top" width="50%">参数</th> <th align="left" class="cellrowborder" id="mcps1.3.7.3.1.3.1.2" valign="top" width="50%">参数说明</th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="50%">-inFile</td> <td class="cellrowborder" valign="top" width="50%">输入的elf文件，必填项。</td> </tr>  </tbody></table></div> </div> <p><strong>示例</strong>：</p> <div _ngcontent-hxj-c106="" class="highlight-div"><div _ngcontent-hxj-c106="" class="highlight-div-header"><div _ngcontent-hxj-c106="" class="highlight-div-header-left"><div _ngcontent-hxj-c106="" class="handle-button expand-button"><div _ngcontent-hxj-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-hxj-c106="" class="highlight-div-header-right"><div _ngcontent-hxj-c106="" class="handle-button ai-button"></div><div _ngcontent-hxj-c106="" class="handle-button line-button"><div _ngcontent-hxj-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-hxj-c106="" class="handle-button theme-button"><div _ngcontent-hxj-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-hxj-c106="" class="handle-button copy-button"><div _ngcontent-hxj-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-hxj-c106="" class="highlight-scroll-div"><pre class="bash prettyprint linenums hljs language-bash" hw-language="bash" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment"># 打印二进制文件签名证书信息</span></li><li>binary-sign-tool display-sign -inFile <span class="hljs-string">"signed-elf"</span></li><li><span class="hljs-comment"># 执行结果</span></li><li><span class="hljs-comment"># 1. 无代码签名</span></li><li>code signature is not found</li><li><span class="hljs-comment"># 2. 自签名模式</span></li><li>code signature is self-sign</li><li><span class="hljs-comment"># 3. 输出签名证书</span></li></ol></pre></div></div> </div>  <div class="tiledSection"><h2 id="错误信息">错误信息<i class="anchor-icon anchor-icon-link" anchorid="错误信息" tips="复制节点链接"></i></h2></div>  <div class="tiledSection"><h3 id="file_not_found" class="firsth2">FILE_NOT_FOUND<i class="anchor-icon anchor-icon-link" anchorid="file_not_found" tips="复制节点链接"></i></h3><p><strong>错误描述</strong></p> <p>执行命令，报错提示：ERROR - FILE_NOT_FOUND, code: -102. Details: The 'HarmonyOS.p12' file does not exist or the path is invalid, parameter name '-keystoreFile'</p> <p><strong>可能原因</strong></p> <p>输入文件不存在或路径不正确。</p> <p><strong>处理步骤</strong></p> <p>检查输入文件路径或文件名是否正确。</p> </div>  <div class="tiledSection"><h3 id="command_param_error">COMMAND_PARAM_ERROR<i class="anchor-icon anchor-icon-link" anchorid="command_param_error" tips="复制节点链接"></i></h3><p><strong>错误描述</strong></p> <p>执行命令，报错提示：ERROR - COMMAND_PARAM_ERROR, code: -107. Details: 'generate-cert' Parameters error, Param key - value must in pairs</p> <p><strong>可能原因</strong></p> <ol><li>粘贴命令时，多粘贴了一段内容，导致出现COMMAND_PARAM_ERROR错误。</li><li>填写命令时，如果最后一个参数的value值未填写，将导致COMMAND_PARAM_ERROR错误。</li></ol> <p><strong>处理步骤</strong></p> <p>检查并修正命令中的多余或错误部分。</p> </div>  <div class="tiledSection"><h3 id="key_password_error">KEY_PASSWORD_ERROR<i class="anchor-icon anchor-icon-link" anchorid="key_password_error" tips="复制节点链接"></i></h3><p><strong>错误描述</strong></p> <p>执行命令，报错提示：ERROR - KEY_PASSWORD_ERROR, code: -114. Details: 'oh-app1-key-v1' keypair password error</p> <p><strong>可能原因</strong></p> <p>当密钥对密码错误时，会导致KEY_PASSWORD_ERROR错误。</p> <p><strong>处理步骤</strong></p> <p>检查命令中的密码参数是否正确。确保访问不同密钥库时，填写各自的密钥对密码。</p> </div>  <div class="tiledSection"><h3 id="not_support_error">NOT_SUPPORT_ERROR<i class="anchor-icon anchor-icon-link" anchorid="not_support_error" tips="复制节点链接"></i></h3><p><strong>错误描述</strong></p> <p>执行命令，报错提示：ERROR - NOT_SUPPORT_ERROR, code: -104. Details: Not support file: ./HarmonyOS.p12</p> <p><strong>可能原因</strong></p> <p>填写错误的密钥库文件类型会导致NOT_SUPPORT_ERROR错误。</p> <p><strong>处理步骤</strong></p> <p>确保密钥库文件的后缀为 .p12。</p> </div>  <div class="tiledSection"><h3 id="key_alias_error">KEY_ALIAS_ERROR<i class="anchor-icon anchor-icon-link" anchorid="key_alias_error" tips="复制节点链接"></i></h3><p><strong>错误描述</strong></p> <p>执行命令，报错提示：ERROR - KEY_ALIAS_ERROR, code: -109. Details: 'XXX' key alias already exists and cannot be generated repeatedly</p> <p><strong>可能原因</strong></p> <p>密钥库中已存在该别名的密钥对，将导致KEY_ALIAS_ERROR错误。</p> <p><strong>处理步骤</strong></p> <p>替换需要生成密钥对的别名为其他名称。</p> </div>  <div class="tiledSection"><h3 id="sign_error">SIGN_ERROR<i class="anchor-icon anchor-icon-link" anchorid="sign_error" tips="复制节点链接"></i></h3><p><strong>错误描述</strong></p> <p>执行命令后，报错提示：ERROR - SIGN_ERROR, code: -105. Details: No certificates configured for sign</p> <p><strong>可能原因</strong></p> <p>签名密钥与实体证书不匹配。</p> <p><strong>处理步骤</strong></p> <ol><li>检查keyAlias密钥是否使用正确。</li><li>检查appCertFile是否使用正确，确保密钥与证书匹配。</li></ol> </div> </div> <div></div></div>