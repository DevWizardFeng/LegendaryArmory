<h1 _ngcontent-vwj-c119="" class="doc-title ng-star-inserted" title="人脸核身实人验证场景"> 人脸核身实人验证场景 </h1>

<div _ngcontent-vwj-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <div class="tiledSection">     <h2 id="section1880231055910">场景介绍<i class="anchor-icon anchor-icon-link" anchorid="section1880231055910" tips="复制节点链接"></i></h2>          <p>从5.1.1(19)版本开始，新增支持人脸核身实人验证场景。</p>     <p>开发者需要验证当前应用/元服务操作的用户的信息且验证是否为用户本人操作时，可接入人脸核身实人验证能力。</p>     <p>支持商户模型：不涉及</p>     <p>人脸核身实人验证页面展示：</p>     <div class="tablenoborder">      <div class="tbBox"><table style="border-style: none;" class="layoutFixed idpTab">               <tbody><tr>         <td align="center" class="nocellnorowborder" style="border: none;" valign="top" width="33.333333333333336%">          <p><span><img height="425.6" originheight="1026" originwidth="494" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114549.02399000146106716550614103703332:50001231000000:2800:4C4D52029A51314A7DAFE08006475CEBD54C17F4E9BF73B31E4868B3D7A14493.png" title="点击放大" width="204.91310000000001"></span></p></td>         <td align="center" class="nocellnorowborder" style="border: none;" valign="top" width="33.333333333333336%">          <p><span><img height="425.6" originheight="1026" originwidth="494" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114549.47027663667660050165282664033528:50001231000000:2800:E0D28FE39336F84620D65D105667EF5C8C6331BAF81757D547284A6EA75DC155.png" title="点击放大" width="204.91310000000001"></span></p></td>         <td align="center" class="cell-norowborder" style="border: none;" valign="top" width="33.333333333333336%">&nbsp;&nbsp;</td>        </tr>        <tr>         <td align="center" class="row-nocellborder" style="border: none;" valign="top" width="33.333333333333336%">          <p>人脸核身实人验证授权页面</p></td>         <td align="center" class="row-nocellborder" style="border: none;" valign="top" width="33.333333333333336%">          <p>人脸核身实人验证通过页面</p></td>         <td align="center" class="cellrowborder" style="border: none;" valign="top" width="33.333333333333336%">&nbsp;&nbsp;</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="section1382301116184">约束与限制<i class="anchor-icon anchor-icon-link" anchorid="section1382301116184" tips="复制节点链接"></i></h2>         </div>    <p>为确保人脸识别的准确性，必须在全屏模式下调用人脸核身实人验证功能。</p>    <p>以下场景均不支持：</p>    <ol>     <li>特殊显示模式：半模态、上下分屏、左右分屏、单手模式、分栏、悬浮窗、智慧多窗、自由多窗等。</li>     <li>设备模式：PC模式、直板机横屏模式。</li>     <li>折叠设备：上下折叠手机外屏、折叠电脑全展开状态。</li>    </ol>    <div class="tiledSection">     <h2 id="section1255816408300">接入流程<i class="anchor-icon anchor-icon-link" anchorid="section1255816408300" tips="复制节点链接"></i></h2>          <p>华为支付人脸核身实人验证接入流程如下：</p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.6.3.1.3.1.1" valign="top" width="25.85%">          <p>步骤</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.6.3.1.3.1.2" valign="top" width="74.15%">          <p>说明</p></th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="25.85%">          <p>开发准备</p></td>         <td class="cellrowborder" valign="top" width="74.15%">          <p>请先完成开发准备后再进行下面的开发接入。</p>          <ul>           <li><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/payment-config-app-identity-info">端侧应用配置</a></li>           <li><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/payment-real-name-preparations">用户身份验证服务接入准备</a></li>          </ul></td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="25.85%">          <p>接入人脸核身实人验证</p></td>         <td class="cellrowborder" valign="top" width="74.15%">          <p>根据人脸核身实人验证场景<a href="/consumer/cn/doc/harmonyos-guides/payment-real-name-face-verification#section9187179113620">开发步骤</a>完成接入。</p></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="section1818915573916">业务流程<i class="anchor-icon anchor-icon-link" anchorid="section1818915573916" tips="复制节点链接"></i></h2>          <p>开发者通过接入人脸核身实人验证能力，可以简便快捷的实现用户信息验证及本人操作的验证。具体接入流程如下：</p>     <p><span><img height="479.40944444444443" originheight="661" originwidth="1274" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114549.43216319303902450091500219700919:50001231000000:2800:3FE4FA35D5292AEF5041F800A54A9D89EF91F0BD5AA37A221D7FF81F85EB5613.png" title="点击放大" width="920"></span></p>     <ol>      <li>开发者客户端收集用户实名信息加密后请求开发者服务端发起人脸核身实人预验证。</li>      <li>开发者服务端请求Payment Kit服务端<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-api-common-face-verifactaion-preverify" target="_blank">人脸核身实人预验证</a>接口获取预验证ID（preVerifyId）。</li>      <li>Payment Kit服务端解密并获取请求传入的用户实名信息进行验证处理。</li>      <li>Payment Kit服务端验证用户实名信息通过后，返回预验证ID给开发者服务端。</li>      <li>开发者服务端返回预验证信息给开发者客户端。</li>      <li>开发者客户端使用预验证ID调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-realnameservice#section9137162021115" target="_blank">startFaceVerification</a>接口拉起人脸核身实人验证页面。</li>      <li>Payment Kit客户端展示验证信息。</li>      <li>用户同意并完成人脸验证，Payment Kit客户端请求Payment Kit服务端处理验证。</li>      <li>Payment Kit服务端完成人脸验证处理并返回验证结果给Payment Kit客户端。</li>      <li>Payment Kit客户端将验证结果展示给用户。</li>      <li>Payment Kit客户端同步返回身份信息验证ID给开发者客户端。</li>      <li>开发者客户端使用身份信息验证Id请求开发者服务端查询身份信息验证结果。</li>      <li>开发者服务端请求Payment Kit服务端<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-api-common-face-verifactaion-result" target="_blank">人脸核身实人验证</a>接口查询验证结果。</li>      <li>Payment Kit服务端返回人脸核身实人验证结果给开发者服务端。</li>      <li>开发者服务端将人脸核身实人验证结果返回给开发者客户端，开发者客户端根据验证结果进行下一步业务处理。</li>     </ol>    </div>    <div class="tiledSection">     <h2 id="section5906121818412">接口说明<i class="anchor-icon anchor-icon-link" anchorid="section5906121818412" tips="复制节点链接"></i></h2>          <p>拉起用户人脸核身实人验证页面的接口。具体API说明详见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-realnameservice#section9137162021115" target="_blank">接口文档</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.8.3.1.3.1.1" valign="top" width="49.96%">          <p>接口名</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.8.3.1.3.1.2" valign="top" width="50.03999999999999%">          <p>描述</p></th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="49.96%">          <p>startFaceVerification(context: common.UIAbilityContext | common.UIExtensionContext, preVerifyId: string): Promise&lt;string&gt;;</p></td>         <td class="cellrowborder" valign="top" width="50.03999999999999%">          <p>拉起用户人脸核身实人验证（人脸验证）页面。</p></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="section9187179113620">开发步骤<i class="anchor-icon anchor-icon-link" anchorid="section9187179113620" tips="复制节点链接"></i></h2>         </div>    <div class="tiledSection">     <h3 id="section126982401468" class="firsth2">发起人脸核身预验证（服务器开发）<i class="anchor-icon anchor-icon-link" anchorid="section126982401468" tips="复制节点链接"></i></h3>          <p>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-api-common-face-verifactaion-preverify" target="_blank">人脸核身实人预验证</a>接口获取预验证ID后返回给端侧拉起人脸核身实人验证页面。服务器开发步骤可参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/payment-real-name-verification#section13180123511">实名信息验证/授权场景</a>服务器开发实现。</p>    </div>    <div class="tiledSection">     <h3 id="section19371156173617">拉起人脸核身实人验证（端侧开发）<i class="anchor-icon anchor-icon-link" anchorid="section19371156173617" tips="复制节点链接"></i></h3>          <div class="p">      开发者客户端使用后端服务返回的预授权ID作为参数调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-realnameservice#section9137162021115" target="_blank">startFaceVerification</a>接口拉起用户人脸核身实人验证页面。当接口通过.then()方法返回时，则表示当前接口请求成功，通过.catch()方法返回表示接口请求失败。当此次请求有异常时，可通过<strong>error.code</strong>获取错误码，错误码相关信息请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-error-code" target="_blank">错误码</a>。示例代码如下：      <div _ngcontent-vwj-c106="" class="highlight-div"><div _ngcontent-vwj-c106="" class="highlight-div-header"><div _ngcontent-vwj-c106="" class="highlight-div-header-left"><div _ngcontent-vwj-c106="" class="handle-button expand-button"><div _ngcontent-vwj-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-vwj-c106="" class="highlight-div-header-right"><div _ngcontent-vwj-c106="" class="handle-button ai-button"></div><div _ngcontent-vwj-c106="" class="handle-button line-button"><div _ngcontent-vwj-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-vwj-c106="" class="handle-button theme-button"><div _ngcontent-vwj-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-vwj-c106="" class="handle-button copy-button"><div _ngcontent-vwj-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-vwj-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { realNameService } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PaymentKit'</span>;</li><li><span class="hljs-keyword">import</span> { common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li> </li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-attr">context</span>: common.<span class="hljs-property">UIAbilityContext</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li>  <span class="hljs-title function_">requestStartFaceVerificationPromise</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-comment">// use your own preVerifyId</span></li><li>    <span class="hljs-keyword">let</span> preVerifyId = <span class="hljs-string">'后端服务获取有效的预验证ID'</span>;</li><li>    realNameService.<span class="hljs-title function_">startFaceVerification</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>, preVerifyId)</li><li>      .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">verifyResultId: <span class="hljs-built_in">string</span> </span>) =&gt;</span> {</li><li>        <span class="hljs-comment">// face verification success</span></li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`succeeded in face verifying, verifyResultId: <span class="hljs-subst">${verifyResultId}</span>`</span>);</li><li>      })</li><li>      .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error: BusinessError</span>) =&gt;</span> {</li><li>        <span class="hljs-comment">// failed to face verification</span></li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`failed to face verification, error.code: <span class="hljs-subst">${error.code}</span>, error.message: <span class="hljs-subst">${error.message}</span>`</span>);</li><li>      });</li><li>  }</li><li> </li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'requestStartFaceVerificationPromise'</span>)</li><li>        .<span class="hljs-title function_">type</span>(<span class="hljs-title class_">ButtonType</span>.<span class="hljs-property">Capsule</span>)</li><li>        .<span class="hljs-title function_">width</span>(<span class="hljs-string">'50%'</span>)</li><li>        .<span class="hljs-title function_">margin</span>(<span class="hljs-number">20</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">requestStartFaceVerificationPromise</span>();</li><li>        })</li><li>      }</li><li>    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div>     </div>    </div>    <div class="tiledSection">     <h3 id="section16986183742618">查询人脸核身实人验证结果（服务器开发）<i class="anchor-icon anchor-icon-link" anchorid="section16986183742618" tips="复制节点链接"></i></h3>          <p>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-api-common-face-verifactaion-result" target="_blank">人脸核身实人验证</a>接口查询验证结果。</p>    </div>   </div>   <div></div></div>