<h1 _ngcontent-ffb-c119="" class="doc-title ng-star-inserted" title="企业联系人信息来去电页面显示"> 企业联系人信息来去电页面显示 </h1>

<div _ngcontent-ffb-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p>本功能仅供企业应用开发者接入。</p>    <div class="tiledSection">     <h2 id="section1757220465117">场景介绍<i class="anchor-icon anchor-icon-link" anchorid="section1757220465117" tips="复制节点链接"></i></h2>          <p>来去电时，页面显示已安装企业应用的联系人信息，方便用户识别来去电人信息，快速回应，增强企业内部沟通效率。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>来去电页面或横幅仅展示一个联系人信息，对于多个应用里存在相同联系人的情况，按照应用包名的字典序排序，展示首个查询结果。</p>      </div></div></div>    </div>    <div class="tiledSection">     <h2 id="section16377114915516">接口说明<i class="anchor-icon anchor-icon-link" anchorid="section16377114915516" tips="复制节点链接"></i></h2>          <p>具体API说明详见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/callservicekit-callerinfoquery-extension-ability#section1220554318191" target="_blank">接口文档</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.3.3.1.3.1.1" valign="top" width="50%">          <p>接口名</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.3.3.1.3.1.2" valign="top" width="50%">          <p>描述</p></th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="50%">          <p>onQueryCallerInfo(phoneNumber: string)：Promise&lt;CallerInfo&gt;</p></td>         <td class="cellrowborder" valign="top" width="50%">          <p>查询联系人信息接口</p></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="section9684181513312">申请接入<i class="anchor-icon anchor-icon-link" anchorid="section9684181513312" tips="复制节点链接"></i></h2>          <p>该API使用受限，如需接入需要申请，方式如下：</p>     <p>企业应用开发者将申请信息发送至公共邮箱agconnect@huawei.com。</p>     <p>邮件标题：【申请公司名】—企业来电显示能力—Developer ID</p>     <p>邮件内容需包括：开发者接入企业来电显示能力的应用使用主体、应用名称、应用ID、应用包名、场景说明（具体描述该应用对应通讯录量级等使用的必要信息）。</p>    </div>    <div class="tiledSection">     <h2 id="section8182151483918">替换调试Profile<i class="anchor-icon anchor-icon-link" anchorid="section8182151483918" tips="复制节点链接"></i></h2>          <p>当企业联系人信息来去电页面显示能力申请成功后，需要重新<a href="https://developer.huawei.com/consumer/cn/doc/app/agc-help-add-debugprofile-0000001914423102" target="_blank">申请调试Profile</a>。并且在DevEco Studio中替换新申请的调试Profile。</p>    </div>    <div class="tiledSection">     <h2 id="section16977152055218">开发步骤<i class="anchor-icon anchor-icon-link" anchorid="section16977152055218" tips="复制节点链接"></i></h2>          <ol>      <li>在工程内创建一个ExtensionAbility类型的自定义组件并继承<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/callservicekit-callerinfoquery-extension-ability" target="_blank">CallerInfoQueryExtensionAbility</a>，完成onQueryCallerInfo方法的复写。       <p>说明：</p>       <p>由于调用onQueryCallerInfo方法时，系统先创建应用的AbilityStage实例，请勿在AbilityStage中添加过于复杂耗时的逻辑，避免调用超时。</p>       <div class="p">        代码示例：        <div _ngcontent-ffb-c106="" class="highlight-div"><div _ngcontent-ffb-c106="" class="highlight-div-header"><div _ngcontent-ffb-c106="" class="highlight-div-header-left"><div _ngcontent-ffb-c106="" class="handle-button expand-button"><div _ngcontent-ffb-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ffb-c106="" class="highlight-div-header-right"><div _ngcontent-ffb-c106="" class="handle-button ai-button"></div><div _ngcontent-ffb-c106="" class="handle-button line-button"><div _ngcontent-ffb-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ffb-c106="" class="handle-button theme-button"><div _ngcontent-ffb-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ffb-c106="" class="handle-button copy-button"><div _ngcontent-ffb-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ffb-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class=""><span class="hljs-keyword">import</span></span> { <span class=""><span class="hljs-title class_">CallerInfoQueryExtensionAbility</span></span>, <span class=""><span class="hljs-title class_">CallerInfo</span></span> } <span class=""><span class="hljs-keyword">from</span></span> <span class=""><span class="hljs-string">'@kit.CallServiceKit'</span></span>;</li><li>
</li><li><span class=""><span class="hljs-keyword">export</span></span> <span class=""><span class="hljs-keyword">default</span></span> <span class=""><span class="hljs-keyword">class</span></span> <span class=""><span class="hljs-title class_">EntryCallerInfoQueryExtAbility</span></span> <span class=""><span class="hljs-keyword">extends</span></span> <span class=""><span class="hljs-title class_ inherited__">CallerInfoQueryExtensionAbility</span></span> {</li><li> <span class=""><span class="hljs-comment">// 来去电时由系统通话应用主动调用该接口查询企业联系人信息</span></span></li><li>  <span class=""><span class="hljs-title function_">onQueryCallerInfo</span></span>(<span class=""><span class="hljs-attr">phoneNumber</span></span>: <span class=""><span class="hljs-built_in">string</span></span>): <span class=""><span class="hljs-title class_">Promise</span></span>&lt;<span class=""><span class="hljs-title class_">CallerInfo</span></span>&gt; {</li><li>    <span class=""><span class="hljs-keyword">return</span></span> <span class=""><span class="hljs-keyword">new</span></span> <span class=""><span class="hljs-title class_">Promise</span></span>&lt;<span class=""><span class="hljs-title class_">CallerInfo</span></span>&gt;(<span class="hljs-function">(</span><span class=""><span class="hljs-function"><span class="hljs-params">resolve</span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class=""><span class="hljs-function"><span class="hljs-params">reject</span></span></span><span class="hljs-function">) </span><span class=""><span class="hljs-function">=</span></span><span class=""><span class="hljs-function">&gt;</span></span> {</li><li>      <span class=""><span class="hljs-keyword">let</span></span> <span class="">isSuccess</span> = <span class=""><span class="hljs-literal">true</span></span>;</li><li>      <span class=""><span class="hljs-comment">// 在此处实现根据号码查询企业联系人的业务逻辑</span></span></li><li>      <span class=""><span class="hljs-keyword">if</span></span> (<span class="">isSuccess</span>) {</li><li>        <span class=""><span class="hljs-comment">// 查询成功，返回结果</span></span></li><li>        <span class=""><span class="hljs-title function_">resolve</span></span>({</li><li>          <span class=""><span class="hljs-attr">contactName</span>:</span><span class=""><span class="hljs-string">"xxxx"</span></span>,</li><li>          <span class=""><span class="hljs-attr">employeeId</span>:</span><span class=""><span class="hljs-string">"xxxx"</span></span>,</li><li>          <span class=""><span class="hljs-attr">department</span>:</span><span class=""><span class="hljs-string">"xxxx"</span></span>,</li><li>          <span class=""><span class="hljs-attr">position</span>:</span><span class=""><span class="hljs-string">"xxxx"</span></span></li><li>        });</li><li>      } <span class=""><span class="hljs-keyword">else</span></span> {</li><li>        <span class=""><span class="hljs-comment">// 查询失败，返回错误原因</span></span></li><li>        <span class=""><span class="hljs-title function_">reject</span></span>(<span class=""><span class="hljs-string">"error reason"</span></span>);</li><li>      }</li><li>    });</li><li>  }</li><li>}</li></ol></pre></div></div>       </div></li>      <li>在应用配置文件module.json5中注册extensionAbilities，具体详见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/module-configuration-file" target="_blank">module.json5配置</a>。       <p>配置文件示例：</p>       <div _ngcontent-ffb-c106="" class="highlight-div"><div _ngcontent-ffb-c106="" class="highlight-div-header"><div _ngcontent-ffb-c106="" class="highlight-div-header-left"><div _ngcontent-ffb-c106="" class="handle-button expand-button"><div _ngcontent-ffb-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ffb-c106="" class="highlight-div-header-right"><div _ngcontent-ffb-c106="" class="handle-button ai-button"></div><div _ngcontent-ffb-c106="" class="handle-button line-button"><div _ngcontent-ffb-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ffb-c106="" class="handle-button theme-button"><div _ngcontent-ffb-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ffb-c106="" class="handle-button copy-button"><div _ngcontent-ffb-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ffb-c106="" class="highlight-scroll-div"><pre class="json prettyprint linenums hljs language-json" hw-language="json" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-punctuation">{</span></li><li>    <span class=""><span class="hljs-attr">"extensionAbilities"</span></span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span></li><li>      <span class="hljs-punctuation">{</span></li><li>        <span class=""><span class="hljs-attr">"name"</span></span><span class="hljs-punctuation">:</span> <span class=""><span class="hljs-string">"EntryCallerInfoQueryExtAbility"</span></span><span class="hljs-punctuation">,</span></li><li>        <span class=""><span class="hljs-attr">"srcEntry"</span></span><span class="hljs-punctuation">:</span> <span class=""><span class="hljs-string">"./ets/callerinfoquery/EntryCallerInfoQueryExtAbility.ets"</span></span><span class="hljs-punctuation">,</span></li><li>        <span class=""><span class="hljs-attr">"type"</span></span><span class="hljs-punctuation">:</span> <span class=""><span class="hljs-string">"callerInfoQuery"</span></span></li><li>      <span class="hljs-punctuation">}</span></li><li>    <span class="hljs-punctuation">]</span></li><li><span class="hljs-punctuation">}</span></li></ol></pre></div></div>       <ul>        <li>type标签需设为"callerInfoQuery"，表示该拓展类型为CallerInfoQueryExtensionAbility。</li>        <li>srcEntry标签表示上述ExtensionAbility组件所对应的代码路径。</li>       </ul></li>      <li>在调试设备上，前往“电话”，点击右上角的“更多”图标，前往“设置”&gt;“陌生号码和信息识别”，打开对应企业应用的号码识别功能开关，进行调试。</li>     </ol>    </div>   </div>   <div></div></div>