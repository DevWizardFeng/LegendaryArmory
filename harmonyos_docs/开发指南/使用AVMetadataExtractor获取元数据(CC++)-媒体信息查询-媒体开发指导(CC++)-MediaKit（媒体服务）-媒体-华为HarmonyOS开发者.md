<h1 _ngcontent-fht-c119="" class="doc-title ng-star-inserted" title="使用AVMetadataExtractor获取元数据(C/C++)"> 使用AVMetadataExtractor获取元数据(C/C++) </h1>

<div _ngcontent-fht-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p>使用AVMetadataExtractor可以实现从原始媒体资源中获取元数据，本开发指导将以获取一个媒体资源的元数据作为示例，向开发者讲解AVMetadataExtractor元数据相关功能。</p>    <p>获取媒体资源的元数据的全流程包含：创建AVMetadataExtractor、设置资源、获取元数据、销毁资源。</p>    <div class="tiledSection">     <h2 id="开发步骤及注意事项">开发步骤及注意事项<i class="anchor-icon anchor-icon-link" anchorid="开发步骤及注意事项" tips="复制节点链接"></i></h2>          <p>在 CMake 脚本中链接动态库。</p>     <div _ngcontent-fht-c106="" class="highlight-div"><div _ngcontent-fht-c106="" class="highlight-div-header"><div _ngcontent-fht-c106="" class="highlight-div-header-left"><div _ngcontent-fht-c106="" class="handle-button expand-button"><div _ngcontent-fht-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fht-c106="" class="highlight-div-header-right"><div _ngcontent-fht-c106="" class="handle-button ai-button"></div><div _ngcontent-fht-c106="" class="handle-button line-button"><div _ngcontent-fht-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fht-c106="" class="handle-button theme-button"><div _ngcontent-fht-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fht-c106="" class="handle-button copy-button"><div _ngcontent-fht-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fht-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-scss" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-built_in">target_link_libraries</span>(entry PUBLIC libavmetadata_extractor.so libace_napi.z.so )</li></ol></pre></div></div>     <p>使用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-native-avformat-h" target="_blank">OH_AVFormat</a>相关接口时，需引入如下头文件。</p>     <div _ngcontent-fht-c106="" class="highlight-div"><div _ngcontent-fht-c106="" class="highlight-div-header"><div _ngcontent-fht-c106="" class="highlight-div-header-left"><div _ngcontent-fht-c106="" class="handle-button expand-button"><div _ngcontent-fht-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fht-c106="" class="highlight-div-header-right"><div _ngcontent-fht-c106="" class="handle-button ai-button"></div><div _ngcontent-fht-c106="" class="handle-button line-button"><div _ngcontent-fht-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fht-c106="" class="handle-button theme-button"><div _ngcontent-fht-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fht-c106="" class="handle-button copy-button"><div _ngcontent-fht-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fht-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;multimedia/player_framework/native_avformat.h&gt;</span></span></li></ol></pre></div></div>     <p>并在 CMake 脚本中链接如下动态库。</p>     <div _ngcontent-fht-c106="" class="highlight-div"><div _ngcontent-fht-c106="" class="highlight-div-header"><div _ngcontent-fht-c106="" class="highlight-div-header-left"><div _ngcontent-fht-c106="" class="handle-button expand-button"><div _ngcontent-fht-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fht-c106="" class="highlight-div-header-right"><div _ngcontent-fht-c106="" class="handle-button ai-button"></div><div _ngcontent-fht-c106="" class="handle-button line-button"><div _ngcontent-fht-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fht-c106="" class="handle-button theme-button"><div _ngcontent-fht-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fht-c106="" class="handle-button copy-button"><div _ngcontent-fht-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fht-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-scss" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-built_in">target_link_libraries</span>(entry PUBLIC libnative_media_core.so)</li></ol></pre></div></div>     <p>使用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-pixelmap-native-h#oh_pixelmapnative_convertpixelmapnativetonapi" target="_blank">OH_PixelmapNative_ConvertPixelmapNativeToNapi()</a>接口将nativePixelMap对象转换为PixelMapnapi对象、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-pixelmap-native-h#oh_pixelmapnative_release" target="_blank">OH_PixelmapNative_Release()</a>接口释放OH_PixelmapNative对象资源，需引入如下头文件。</p>     <div _ngcontent-fht-c106="" class="highlight-div"><div _ngcontent-fht-c106="" class="highlight-div-header"><div _ngcontent-fht-c106="" class="highlight-div-header-left"><div _ngcontent-fht-c106="" class="handle-button expand-button"><div _ngcontent-fht-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fht-c106="" class="highlight-div-header-right"><div _ngcontent-fht-c106="" class="handle-button ai-button"></div><div _ngcontent-fht-c106="" class="handle-button line-button"><div _ngcontent-fht-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fht-c106="" class="handle-button theme-button"><div _ngcontent-fht-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fht-c106="" class="handle-button copy-button"><div _ngcontent-fht-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fht-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;multimedia/image_framework/image/pixelmap_native.h&gt;</span></span></li></ol></pre></div></div>     <p>并在 CMake 脚本中链接如下动态库。</p>     <div _ngcontent-fht-c106="" class="highlight-div"><div _ngcontent-fht-c106="" class="highlight-div-header"><div _ngcontent-fht-c106="" class="highlight-div-header-left"><div _ngcontent-fht-c106="" class="handle-button expand-button"><div _ngcontent-fht-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fht-c106="" class="highlight-div-header-right"><div _ngcontent-fht-c106="" class="handle-button ai-button"></div><div _ngcontent-fht-c106="" class="handle-button line-button"><div _ngcontent-fht-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fht-c106="" class="handle-button theme-button"><div _ngcontent-fht-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fht-c106="" class="handle-button copy-button"><div _ngcontent-fht-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fht-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-scss" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-built_in">target_link_libraries</span>(entry PUBLIC libpixelmap.so libpixelmap_ndk.z.so)</li></ol></pre></div></div>     <p>开发者使用系统日志能力时，需引入如下头文件。</p>     <div _ngcontent-fht-c106="" class="highlight-div"><div _ngcontent-fht-c106="" class="highlight-div-header"><div _ngcontent-fht-c106="" class="highlight-div-header-left"><div _ngcontent-fht-c106="" class="handle-button expand-button"><div _ngcontent-fht-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fht-c106="" class="highlight-div-header-right"><div _ngcontent-fht-c106="" class="handle-button ai-button"></div><div _ngcontent-fht-c106="" class="handle-button line-button"><div _ngcontent-fht-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fht-c106="" class="handle-button theme-button"><div _ngcontent-fht-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fht-c106="" class="handle-button copy-button"><div _ngcontent-fht-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fht-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;hilog/log.h&gt;</span></span></li></ol></pre></div></div>     <p>并需要在 CMake 脚本中链接如下动态库。</p>     <div _ngcontent-fht-c106="" class="highlight-div"><div _ngcontent-fht-c106="" class="highlight-div-header"><div _ngcontent-fht-c106="" class="highlight-div-header-left"><div _ngcontent-fht-c106="" class="handle-button expand-button"><div _ngcontent-fht-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fht-c106="" class="highlight-div-header-right"><div _ngcontent-fht-c106="" class="handle-button ai-button"></div><div _ngcontent-fht-c106="" class="handle-button line-button"><div _ngcontent-fht-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fht-c106="" class="handle-button theme-button"><div _ngcontent-fht-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fht-c106="" class="handle-button copy-button"><div _ngcontent-fht-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fht-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-scss" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-built_in">target_link_libraries</span>(entry PUBLIC libhilog_ndk.z.so)</li></ol></pre></div></div>     <p>开发者通过引入<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-avmetadata-extractor-h" target="_blank">avmetadata_extractor.h</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-avmetadata-extractor-base-h" target="_blank">avmetadata_extractor_base.h</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-native-averrors-h" target="_blank">native_averrors.h</a>头文件，使用获取元数据相关API。</p>     <p>详细的API说明请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-avmetadataextractor" target="_blank">AVMetadataExtractor API参考</a>。</p>     <ol>      <li>       <p>使用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-avmetadata-extractor-h#oh_avmetadataextractor_create" target="_blank">OH_AVMetadataExtractor_Create()</a>创建实例。</p>       <div _ngcontent-fht-c106="" class="highlight-div"><div _ngcontent-fht-c106="" class="highlight-div-header"><div _ngcontent-fht-c106="" class="highlight-div-header-left"><div _ngcontent-fht-c106="" class="handle-button expand-button"><div _ngcontent-fht-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fht-c106="" class="highlight-div-header-right"><div _ngcontent-fht-c106="" class="handle-button ai-button"></div><div _ngcontent-fht-c106="" class="handle-button line-button"><div _ngcontent-fht-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fht-c106="" class="handle-button theme-button"><div _ngcontent-fht-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fht-c106="" class="handle-button copy-button"><div _ngcontent-fht-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fht-c106="" class="highlight-scroll-div"><pre class="c prettyprint linenums hljs language-c" hw-language="c" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;multimedia/player_framework/avmetadata_extractor.h&gt;</span></span></li><li><span class="hljs-comment">// 创建OH_AVMetadataExtractor实例。</span></li><li>OH_AVMetadataExtractor* mainExtractor = OH_AVMetadataExtractor_Create();</li></ol></pre></div></div></li>      <li>       <p>设置媒体资源的文件描述符：调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-avmetadata-extractor-h#oh_avmetadataextractor_setfdsource" target="_blank">OH_AVMetadataExtractor_SetFDSoucre()</a>。</p>       <ul>        <li>不同AVMetadataExtractor或者<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-avimagegenerator" target="_blank">AVImageGenerator</a>实例，如果需要操作同一资源，需要多次打开文件描述符，不要共用同一文件描述符。</li>       </ul>       <div _ngcontent-fht-c106="" class="highlight-div"><div _ngcontent-fht-c106="" class="highlight-div-header"><div _ngcontent-fht-c106="" class="highlight-div-header-left"><div _ngcontent-fht-c106="" class="handle-button expand-button"><div _ngcontent-fht-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fht-c106="" class="highlight-div-header-right"><div _ngcontent-fht-c106="" class="handle-button ai-button"></div><div _ngcontent-fht-c106="" class="handle-button line-button"><div _ngcontent-fht-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fht-c106="" class="handle-button theme-button"><div _ngcontent-fht-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fht-c106="" class="handle-button copy-button"><div _ngcontent-fht-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fht-c106="" class="highlight-scroll-div"><pre class="c prettyprint linenums hljs language-c" hw-language="c" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"napi/native_api.h"</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;multimedia/player_framework/avmetadata_extractor.h&gt;</span></span></li><li><span class="hljs-type">int64_t</span> offset = <span class="hljs-number">0</span>; <span class="hljs-comment">// 媒体源在文件描述符中的偏移量。</span></li><li><span class="hljs-type">int32_t</span> fileDescribe = <span class="hljs-number">-1</span>; <span class="hljs-comment">// 媒体文件描述符。</span></li><li><span class="hljs-type">int32_t</span> fileSize = <span class="hljs-number">0</span>; <span class="hljs-comment">// 媒体文件大小。</span></li><li>
</li><li><span class="hljs-comment">// GetInputParams为辅助函数，用于获取FetchAlbumCover、FetchMetadata的输入参数，实现见完整示例。</span></li><li><span class="hljs-keyword">if</span> (!GetInputParams(env, info, offset, fileDescribe, fileSize)) {</li><li>    <span class="hljs-keyword">return</span> nullptr;</li><li>}</li><li> <span class="hljs-comment">// 设置媒体资源的文件描述符。</span></li><li>OH_AVErrCode avErrCode = OH_AVMetadataExtractor_SetFDSource(mainExtractor, fileDescribe, offset, fileSize);</li><li><span class="hljs-comment">// 异常处理。</span></li><li><span class="hljs-keyword">if</span> (avErrCode != AV_ERR_OK) {</li><li>    OH_AVMetadataExtractor_Release(mainExtractor);</li><li>    napi_throw_error(env, <span class="hljs-string">"EFAILED"</span>, <span class="hljs-string">"SetFDSource for metadata extractor failed"</span>);</li><li>    <span class="hljs-keyword">return</span> nullptr;</li><li>}</li></ol></pre></div></div></li>      <li>       <p>获取元数据：调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-avmetadata-extractor-h#oh_avmetadataextractor_fetchmetadata" target="_blank">OH_AVMetadataExtractor_FetchMetadata()</a>。</p>       <ul>        <li>需要先调用OH_AVFormat_Create()函数创建一个OH_AVFormat对象，通过访问该对象的各个键值对，可以获取到元数据。使用完成需要调用OH_AVFormat_Destroy销毁该对象，防止产生内存泄漏，详细使用方法请参阅<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-native-avformat-h" target="_blank">OH_AVFormat</a>。</li>       </ul>       <div _ngcontent-fht-c106="" class="highlight-div"><div _ngcontent-fht-c106="" class="highlight-div-header"><div _ngcontent-fht-c106="" class="highlight-div-header-left"><div _ngcontent-fht-c106="" class="handle-button expand-button"><div _ngcontent-fht-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fht-c106="" class="highlight-div-header-right"><div _ngcontent-fht-c106="" class="handle-button ai-button"></div><div _ngcontent-fht-c106="" class="handle-button line-button"><div _ngcontent-fht-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fht-c106="" class="handle-button theme-button"><div _ngcontent-fht-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fht-c106="" class="handle-button copy-button"><div _ngcontent-fht-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fht-c106="" class="highlight-scroll-div"><pre class="c prettyprint linenums hljs language-c" hw-language="c" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 获取元数据。</span></li><li>avErrCode = OH_AVMetadataExtractor_FetchMetadata(mainExtractor, avMetadata);</li></ol></pre></div></div></li>      <li>       <p>对于视频资源：可以通过OH_AVMetadataExtractor_FetchMetadata设置的OH_AVFormat对象，根据每种元信息的类型，通过OH_AVFormat_GetIntValue、GetStringValueFromAVFormat等函数获取宽、高等数据。</p>       <div _ngcontent-fht-c106="" class="highlight-div"><div _ngcontent-fht-c106="" class="highlight-div-header"><div _ngcontent-fht-c106="" class="highlight-div-header-left"><div _ngcontent-fht-c106="" class="handle-button expand-button"><div _ngcontent-fht-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fht-c106="" class="highlight-div-header-right"><div _ngcontent-fht-c106="" class="handle-button ai-button"></div><div _ngcontent-fht-c106="" class="handle-button line-button"><div _ngcontent-fht-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fht-c106="" class="handle-button theme-button"><div _ngcontent-fht-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fht-c106="" class="handle-button copy-button"><div _ngcontent-fht-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fht-c106="" class="highlight-scroll-div"><pre class="c prettyprint linenums hljs language-c" hw-language="c" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 从OH_AVFormat对象中解析出int32_t类型的视频资源宽高信息。</span></li><li><span class="hljs-type">int32_t</span> width = <span class="hljs-number">0</span>;</li><li><span class="hljs-type">int32_t</span> height = <span class="hljs-number">0</span>;</li><li>OH_AVFormat_GetIntValue(avMetadata, OH_AVMETADATA_EXTRACTOR_VIDEO_WIDTH, &amp;width);</li><li>OH_AVFormat_GetIntValue(avMetadata, OH_AVMETADATA_EXTRACTOR_VIDEO_HEIGHT, &amp;height);</li></ol></pre></div></div></li>      <li>       <p>对于音频资源而言，除了可以通过OH_AVFormat对象来获取音频资源的标题、时长等元数据外，还可以获取专辑封面（例如，调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-avmetadata-extractor-h#oh_avmetadataextractor_fetchalbumcover" target="_blank">OH_AVMetadataExtractor_FetchAlbumCover()</a>，可以获取到专辑封面）。</p>       <ul>        <li>使用完成需要调用OH_PixelmapNative_Release释放OH_PixelmapNative对象资源，详细使用方法请参阅<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-pixelmap-native-h#oh_pixelmapnative_release" target="_blank">Image_NativeModule</a>。</li>       </ul>       <div _ngcontent-fht-c106="" class="highlight-div"><div _ngcontent-fht-c106="" class="highlight-div-header"><div _ngcontent-fht-c106="" class="highlight-div-header-left"><div _ngcontent-fht-c106="" class="handle-button expand-button"><div _ngcontent-fht-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fht-c106="" class="highlight-div-header-right"><div _ngcontent-fht-c106="" class="handle-button ai-button"></div><div _ngcontent-fht-c106="" class="handle-button line-button"><div _ngcontent-fht-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fht-c106="" class="handle-button theme-button"><div _ngcontent-fht-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fht-c106="" class="handle-button copy-button"><div _ngcontent-fht-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fht-c106="" class="highlight-scroll-div"><pre class="c prettyprint linenums hljs language-c" hw-language="c" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;multimedia/image_framework/image/pixelmap_native.h&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;multimedia/player_framework/avmetadata_extractor.h&gt;</span></span></li><li>
</li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;hilog/log.h&gt;</span></span></li><li><span class="hljs-comment">// 获取专辑封面。</span></li><li>OH_PixelmapNative* pixelMap = nullptr;</li><li>avErrCode = OH_AVMetadataExtractor_FetchAlbumCover(mainExtractor, &amp;pixelMap);</li></ol></pre></div></div></li>      <li>       <p>释放资源：调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-avmetadata-extractor-h#oh_avmetadataextractor_release" target="_blank">OH_AVMetadataExtractor_Release()</a>销毁实例，释放资源。</p>       <div _ngcontent-fht-c106="" class="highlight-div"><div _ngcontent-fht-c106="" class="highlight-div-header"><div _ngcontent-fht-c106="" class="highlight-div-header-left"><div _ngcontent-fht-c106="" class="handle-button expand-button"><div _ngcontent-fht-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fht-c106="" class="highlight-div-header-right"><div _ngcontent-fht-c106="" class="handle-button ai-button"></div><div _ngcontent-fht-c106="" class="handle-button line-button"><div _ngcontent-fht-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fht-c106="" class="handle-button theme-button"><div _ngcontent-fht-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fht-c106="" class="handle-button copy-button"><div _ngcontent-fht-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fht-c106="" class="highlight-scroll-div"><pre class="c prettyprint linenums hljs language-c" hw-language="c" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 释放OH_AVMetadataExtractor资源。</span></li><li>OH_AVMetadataExtractor_Release(mainExtractor);</li></ol></pre></div></div></li>     </ol>    </div>    <div class="tiledSection">     <h2 id="运行示例工程">运行示例工程<i class="anchor-icon anchor-icon-link" anchorid="运行示例工程" tips="复制节点链接"></i></h2>          <p>参考以下示例，获取一个音频的元数据和专辑封面。</p>     <ol>      <li>新建工程，下载<a href="https://gitcode.com/openharmony/applications_app_samples/tree/master/code/DocsSample/Media/AVMetadataExtractor/AVMetadataExtractorNDK" target="_blank">完整示例工程</a>，并将示例工程的资源复制到对应目录。       <div _ngcontent-fht-c106="" class="highlight-div"><div _ngcontent-fht-c106="" class="highlight-div-header"><div _ngcontent-fht-c106="" class="highlight-div-header-left"><div _ngcontent-fht-c106="" class="handle-button expand-button"><div _ngcontent-fht-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fht-c106="" class="highlight-div-header-right"><div _ngcontent-fht-c106="" class="handle-button ai-button"></div><div _ngcontent-fht-c106="" class="handle-button line-button"><div _ngcontent-fht-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fht-c106="" class="handle-button theme-button"><div _ngcontent-fht-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fht-c106="" class="handle-button copy-button"><div _ngcontent-fht-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fht-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-css" data-highlighted="yes"><ol class="linenums"><li>AVMetadataExtractorNDK</li><li>entry/<span class="hljs-attribute">src</span>/<span class="hljs-selector-tag">main</span>/ets/</li><li>└── pages</li><li>    └── Index<span class="hljs-selector-class">.ets</span> (获取元数据界面)</li><li>entry/<span class="hljs-attribute">src</span>/<span class="hljs-selector-tag">main</span>/</li><li>├── cpp</li><li>│   ├── types</li><li>│   │   └── libentry</li><li>│   │       └── Index<span class="hljs-selector-class">.d</span><span class="hljs-selector-class">.ts</span> (NDK函数对应的js映射)</li><li>│   ├── CMakeLists<span class="hljs-selector-class">.txt</span> (CMake脚本)</li><li>│   └── napi_init<span class="hljs-selector-class">.cpp</span> (NDK函数)</li><li>└── resources</li><li>    ├── base</li><li>    │   ├── element</li><li>    │   │   ├── <span class="hljs-attribute">color</span><span class="hljs-selector-class">.json</span></li><li>    │   │   ├── <span class="hljs-attribute">float</span><span class="hljs-selector-class">.json</span></li><li>    │   │   └── string<span class="hljs-selector-class">.json</span></li><li>    │   └── media</li><li>    │</li><li>    └── rawfile</li><li>        └── test<span class="hljs-selector-class">.mp3</span> (音频资源)</li></ol></pre></div></div></li>      <li>编译新建工程并运行。</li>     </ol>    </div>   </div>   <div></div></div>