<h1 _ngcontent-swk-c119="" class="doc-title ng-star-inserted" title="使用Node-API进行class相关开发"> 使用Node-API进行class相关开发 </h1>

<div _ngcontent-swk-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div> <div class="tiledSection"><h2 id="简介">简介<i class="anchor-icon anchor-icon-link" anchorid="简介" tips="复制节点链接"></i></h2><p>使用Node-API接口进行class相关开发，处理ArkTS中的类，例如定义类、构造实例等。</p> </div>  <div class="tiledSection"><h2 id="基本概念">基本概念<i class="anchor-icon anchor-icon-link" anchorid="基本概念" tips="复制节点链接"></i></h2><p>在使用Node-API接口进行class相关开发时，需要理解以下基本概念：</p> <ul><li><strong>类</strong>：类是用于创建对象的模板。它提供了一种封装数据和行为的方式，以便于对数据进行处理和操作。类在ArkTS中是建立在原型（prototype）的基础上的，并且还引入了一些类独有的语法和语义。</li><li><strong>实例</strong>：实例是通过类创建具体的对象。类定义了对象的结构和行为，而实例则是类的具体表现。通过实例化类，我们可以访问类中定义的属性和方法，并且每个实例都具有自己的属性值。</li><li><strong>原型</strong>：ArkTS也采用Class的概念来实现类型之间的继承，早期EcmaScript规范定义了原型的概念，对象通过原型链的方式来实现继承的。原型的概念可以参考<a href="https://262.ecma-international.org/#sec-terms-and-definitions-prototype" target="_blank">EcmaScript的社区规范</a>。</li></ul> </div>  <div class="tiledSection"><h2 id="场景和功能介绍">场景和功能介绍<i class="anchor-icon anchor-icon-link" anchorid="场景和功能介绍" tips="复制节点链接"></i></h2><p>以下Node-API接口主要用于处理class。他们的使用场景如下：</p>  <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.3.3.1.3.1.1" valign="top" width="50%">接口</th> <th align="left" class="cellrowborder" id="mcps1.3.3.3.1.3.1.2" valign="top" width="50%">描述</th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="50%">napi_new_instance</td> <td class="cellrowborder" valign="top" width="50%">需要通过给定的构造函数构建一个实例时，可以使用这个函数。</td> </tr> <tr><td class="cellrowborder" valign="top" width="50%">napi_get_new_target</td> <td class="cellrowborder" valign="top" width="50%">使用此函数获取构造函数调用的new.target。</td> </tr> <tr><td class="cellrowborder" valign="top" width="50%">napi_define_class</td> <td class="cellrowborder" valign="top" width="50%">在Node-API模块定义与ArkTS类相对应的类。这个函数允许将Node-API模块类绑定到ArkTS类。</td> </tr> <tr><td class="cellrowborder" valign="top" width="50%">napi_wrap</td> <td class="cellrowborder" valign="top" width="50%">在ArkTS对象上绑定一个Node-API模块对象实例。这个函数通常在将Node-API模块对象与ArkTS对象进行绑定时使用，以便在ArkTS中使用本地对象的方法和属性。</td> </tr> <tr><td class="cellrowborder" valign="top" width="50%">napi_unwrap</td> <td class="cellrowborder" valign="top" width="50%">从ArkTS对象上获取之前绑定的Node-API模块对象实例。</td> </tr> <tr><td class="cellrowborder" valign="top" width="50%">napi_remove_wrap</td> <td class="cellrowborder" valign="top" width="50%">从ArkTS对象上获取之前绑定的Node-API模块对象实例，并解除绑定。</td> </tr>  </tbody></table></div> </div> </div>  <div class="tiledSection"><h2 id="使用示例">使用示例<i class="anchor-icon anchor-icon-link" anchorid="使用示例" tips="复制节点链接"></i></h2><p>Node-API接口开发流程参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/use-napi-process">使用Node-API实现跨语言交互开发流程</a>，本文仅对接口对应C++及ArkTS相关代码进行展示。</p> </div>  <div class="tiledSection"><h3 id="napi_new_instance" class="firsth2">napi_new_instance<i class="anchor-icon anchor-icon-link" anchorid="napi_new_instance" tips="复制节点链接"></i></h3><p>通过给定的构造函数实例化一个对象，将这个对象返回ArkTS侧使用。</p> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"> <p>参数constructor不是function类型则返回napi_function_expected。</p>  </div></div></div> <p>cpp部分代码</p> <div _ngcontent-swk-c106="" class="highlight-div"><div _ngcontent-swk-c106="" class="highlight-div-header"><div _ngcontent-swk-c106="" class="highlight-div-header-left"><div _ngcontent-swk-c106="" class="handle-button expand-button"><div _ngcontent-swk-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-swk-c106="" class="highlight-div-header-right"><div _ngcontent-swk-c106="" class="handle-button ai-button"></div><div _ngcontent-swk-c106="" class="handle-button line-button"><div _ngcontent-swk-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-swk-c106="" class="handle-button theme-button"><div _ngcontent-swk-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-swk-c106="" class="handle-button copy-button"><div _ngcontent-swk-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-swk-c106="" class="highlight-scroll-div"><pre class="cpp prettyprint linenums hljs language-cpp" hw-language="cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"napi/native_api.h"</span></span></li><li>
</li><li><span class="hljs-function"><span class="hljs-type">static</span> napi_value <span class="hljs-title">NewInstance</span><span class="hljs-params">(napi_env env, napi_callback_info info)</span></span></li><li><span class="hljs-function"></span>{</li><li>    <span class="hljs-comment">// 传入并解析参数，第一个参数为传入的构造函数，第二个参数为需要传入构造函数的参数</span></li><li>    <span class="hljs-type">size_t</span> argc = <span class="hljs-number">2</span>;</li><li>    napi_value args[<span class="hljs-number">2</span>] = {<span class="hljs-literal">nullptr</span>};</li><li>    <span class="hljs-built_in">napi_get_cb_info</span>(env, info, &amp;argc, args, <span class="hljs-literal">nullptr</span>, <span class="hljs-literal">nullptr</span>);</li><li>    <span class="hljs-comment">// 调用napi_new_instance接口，实例化一个对象，将这个对象返回</span></li><li>    napi_value result = <span class="hljs-literal">nullptr</span>;</li><li>    <span class="hljs-built_in">napi_new_instance</span>(env, args[<span class="hljs-number">0</span>], <span class="hljs-number">1</span>, &amp;args[<span class="hljs-number">1</span>], &amp;result);</li><li>    <span class="hljs-keyword">return</span> result;</li><li>}</li></ol></pre></div></div> <p>接口声明</p> <div _ngcontent-swk-c106="" class="highlight-div"><div _ngcontent-swk-c106="" class="highlight-div-header"><div _ngcontent-swk-c106="" class="highlight-div-header-left"><div _ngcontent-swk-c106="" class="handle-button expand-button"><div _ngcontent-swk-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-swk-c106="" class="highlight-div-header-right"><div _ngcontent-swk-c106="" class="handle-button ai-button"></div><div _ngcontent-swk-c106="" class="handle-button line-button"><div _ngcontent-swk-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-swk-c106="" class="handle-button theme-button"><div _ngcontent-swk-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-swk-c106="" class="handle-button copy-button"><div _ngcontent-swk-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-swk-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// index.d.ts</span></li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-attr">newInstance</span>: <span class="hljs-function">(<span class="hljs-params">obj: <span class="hljs-built_in">Object</span>, param: <span class="hljs-built_in">string</span></span>) =&gt;</span> <span class="hljs-title class_">Object</span>;</li></ol></pre></div></div> <p>ArkTS侧示例代码</p> <div _ngcontent-swk-c106="" class="highlight-div"><div _ngcontent-swk-c106="" class="highlight-div-header"><div _ngcontent-swk-c106="" class="highlight-div-header-left"><div _ngcontent-swk-c106="" class="handle-button expand-button"><div _ngcontent-swk-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-swk-c106="" class="highlight-div-header-right"><div _ngcontent-swk-c106="" class="handle-button ai-button"></div><div _ngcontent-swk-c106="" class="handle-button line-button"><div _ngcontent-swk-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-swk-c106="" class="handle-button theme-button"><div _ngcontent-swk-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-swk-c106="" class="handle-button copy-button"><div _ngcontent-swk-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-swk-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li><span class="hljs-keyword">import</span> testNapi <span class="hljs-keyword">from</span> <span class="hljs-string">'libentry.so'</span>;</li><li>
</li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Fruit</span> {</li><li>  <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;</li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name: <span class="hljs-built_in">string</span></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;</li><li>  }</li><li>}</li><li><span class="hljs-comment">// 调用函数，用变量obj接收函数返回的实例化对象</span></li><li><span class="hljs-keyword">let</span> obj = testNapi.<span class="hljs-title function_">newInstance</span>(<span class="hljs-title class_">Fruit</span>, <span class="hljs-string">'test'</span>);</li><li><span class="hljs-comment">// 打印实例化对象obj的信息</span></li><li>hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'Node-API'</span>, <span class="hljs-string">'napi_new_instance %{public}s'</span>, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(obj));</li></ol></pre></div></div> </div>  <div class="tiledSection"><h3 id="napi_get_new_target">napi_get_new_target<i class="anchor-icon anchor-icon-link" anchorid="napi_get_new_target" tips="复制节点链接"></i></h3><p>用于获取构造函数的new.target值。在ArkTS中，new.target是一个特殊的元属性，用于在构造函数中判断是否通过new关键字调用了该构造函数。</p> <p>示例代码可以参考链接：</p> <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/use-napi-object-wrap">Native与ArkTS对象绑定</a></p> </div>  <div class="tiledSection"><h3 id="napi_define_class">napi_define_class<i class="anchor-icon anchor-icon-link" anchorid="napi_define_class" tips="复制节点链接"></i></h3><p>用于定义一个ArkTS类。该函数允许在Node-API模块中创建一个ArkTS类，并将类的方法和属性与相应的Node-API模块关联起来。</p> <p>示例代码可以参考链接：</p> <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/use-napi-object-wrap">Native与ArkTS对象绑定</a></p> </div>  <div class="tiledSection"><h3 id="napi_wrap">napi_wrap<i class="anchor-icon anchor-icon-link" anchorid="napi_wrap" tips="复制节点链接"></i></h3><p>在ArkTS object上绑定一个native对象实例。</p> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"> <p>参数js_object不为object类型或function类型时返回napi_object_expected。</p>  </div></div></div> </div>  <div class="tiledSection"><h3 id="napi_unwrap">napi_unwrap<i class="anchor-icon anchor-icon-link" anchorid="napi_unwrap" tips="复制节点链接"></i></h3><p>从一个被包装的对象中获取与之关联的数据指针。</p> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"> <p>参数js_object不为object类型或function类型时返回napi_object_expected。</p>  </div></div></div> </div>  <div class="tiledSection"><h3 id="napi_remove_wrap">napi_remove_wrap<i class="anchor-icon anchor-icon-link" anchorid="napi_remove_wrap" tips="复制节点链接"></i></h3><p>从ArkTS object上获取先前绑定的native对象实例，并解除绑定。</p> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"> <p>参数js_object不为object类型或function类型时返回napi_object_expected。</p>  </div></div></div> <p>cpp部分代码</p> <div _ngcontent-swk-c106="" class="highlight-div"><div _ngcontent-swk-c106="" class="highlight-div-header"><div _ngcontent-swk-c106="" class="highlight-div-header-left"><div _ngcontent-swk-c106="" class="handle-button expand-button"><div _ngcontent-swk-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-swk-c106="" class="highlight-div-header-right"><div _ngcontent-swk-c106="" class="handle-button ai-button"></div><div _ngcontent-swk-c106="" class="handle-button line-button"><div _ngcontent-swk-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-swk-c106="" class="handle-button theme-button"><div _ngcontent-swk-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-swk-c106="" class="handle-button copy-button"><div _ngcontent-swk-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-swk-c106="" class="highlight-scroll-div"><pre class="cpp prettyprint linenums hljs language-cpp" hw-language="cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;hilog/log.h&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"napi/native_api.h"</span></span></li><li>
</li><li><span class="hljs-type">static</span> <span class="hljs-keyword">constexpr</span> <span class="hljs-type">int</span> INT_ARG_18 = <span class="hljs-number">18</span>; <span class="hljs-comment">// 年龄18岁</span></li><li>
</li><li><span class="hljs-keyword">struct</span> <span class="hljs-title class_">Object</span> {</li><li>    std::string name;</li><li>    <span class="hljs-type">int32_t</span> age;</li><li>};</li><li>
</li><li><span class="hljs-function"><span class="hljs-type">static</span> <span class="hljs-type">void</span> <span class="hljs-title">DerefItem</span><span class="hljs-params">(napi_env env, <span class="hljs-type">void</span> *data, <span class="hljs-type">void</span> *hint)</span> </span>{</li><li>    <span class="hljs-comment">// 可选的原生回调，用于在ArkTS对象被垃圾回收时释放原生实例</span></li><li>    <span class="hljs-built_in">OH_LOG_INFO</span>(LOG_APP, <span class="hljs-string">"Node-API DerefItem"</span>);</li><li>    Object *obj = <span class="hljs-built_in">reinterpret_cast</span>&lt;Object *&gt;(data);</li><li>    <span class="hljs-keyword">if</span> (obj != <span class="hljs-literal">nullptr</span>) {</li><li>        <span class="hljs-keyword">delete</span> obj;</li><li>    }</li><li>}</li><li>
</li><li><span class="hljs-function"><span class="hljs-type">static</span> napi_value <span class="hljs-title">Wrap</span><span class="hljs-params">(napi_env env, napi_callback_info info)</span></span></li><li><span class="hljs-function"></span>{</li><li>    <span class="hljs-built_in">OH_LOG_INFO</span>(LOG_APP, <span class="hljs-string">"Node-API wrap"</span>);</li><li>    <span class="hljs-comment">// 初始化Node-API模块的object</span></li><li>    <span class="hljs-keyword">struct</span> <span class="hljs-title class_">Object</span> *obj = <span class="hljs-keyword">new</span> <span class="hljs-keyword">struct</span> <span class="hljs-built_in">Object</span>();</li><li>    obj-&gt;name = <span class="hljs-string">"liLei"</span>;</li><li>    obj-&gt;age = INT_ARG_18;</li><li>    <span class="hljs-type">size_t</span> argc = <span class="hljs-number">1</span>;</li><li>    napi_value toWrap;</li><li>    <span class="hljs-comment">// 调用napi_wrap将Node-API模块的object绑定到ArkTS object上</span></li><li>    napi_status status_cb = <span class="hljs-built_in">napi_get_cb_info</span>(env, info, &amp;argc, &amp;toWrap, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);</li><li>    <span class="hljs-keyword">if</span> (status_cb != napi_ok) {</li><li>        <span class="hljs-built_in">OH_LOG_ERROR</span>(LOG_APP, <span class="hljs-string">"napi_get_cb_info failed"</span>);</li><li>        <span class="hljs-keyword">delete</span> obj;</li><li>        <span class="hljs-keyword">return</span> <span class="hljs-literal">nullptr</span>;</li><li>    }</li><li>    napi_status status = <span class="hljs-built_in">napi_wrap</span>(env, toWrap, <span class="hljs-built_in">reinterpret_cast</span>&lt;<span class="hljs-type">void</span> *&gt;(obj), DerefItem, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);</li><li>    <span class="hljs-keyword">if</span> (status != napi_ok) {</li><li>        <span class="hljs-comment">// 主动释放内存</span></li><li>        <span class="hljs-keyword">delete</span> obj;</li><li>    }</li><li>
</li><li>    <span class="hljs-keyword">return</span> toWrap;</li><li>}</li><li>
</li><li><span class="hljs-function"><span class="hljs-type">static</span> napi_value <span class="hljs-title">RemoveWrap</span><span class="hljs-params">(napi_env env, napi_callback_info info)</span></span></li><li><span class="hljs-function"></span>{</li><li>    <span class="hljs-built_in">OH_LOG_INFO</span>(LOG_APP, <span class="hljs-string">"Node-API removeWrap"</span>);</li><li>    <span class="hljs-type">size_t</span> argc = <span class="hljs-number">1</span>;</li><li>    napi_value wrapped = <span class="hljs-literal">nullptr</span>;</li><li>    <span class="hljs-type">void</span> *data = <span class="hljs-literal">nullptr</span>;</li><li>    <span class="hljs-comment">// 调用napi_remove_wrap从一个被包装的对象中解除包装</span></li><li>    <span class="hljs-built_in">napi_get_cb_info</span>(env, info, &amp;argc, &amp;wrapped, <span class="hljs-literal">nullptr</span>, <span class="hljs-literal">nullptr</span>);</li><li>    <span class="hljs-built_in">napi_remove_wrap</span>(env, wrapped, &amp;data);</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-literal">nullptr</span>;</li><li>}</li><li>
</li><li><span class="hljs-function"><span class="hljs-type">static</span> napi_value <span class="hljs-title">UnWrap</span><span class="hljs-params">(napi_env env, napi_callback_info info)</span></span></li><li><span class="hljs-function"></span>{</li><li>    <span class="hljs-built_in">OH_LOG_INFO</span>(LOG_APP, <span class="hljs-string">"Node-API unWrap"</span>);</li><li>    <span class="hljs-type">size_t</span> argc = <span class="hljs-number">1</span>;</li><li>    napi_value wrapped = <span class="hljs-literal">nullptr</span>;</li><li>    <span class="hljs-built_in">napi_get_cb_info</span>(env, info, &amp;argc, &amp;wrapped, <span class="hljs-literal">nullptr</span>, <span class="hljs-literal">nullptr</span>);</li><li>    <span class="hljs-comment">// 调用napi_unwrap取出绑定在ArkTS object中的数据并打印</span></li><li>    <span class="hljs-keyword">struct</span> <span class="hljs-title class_">Object</span> *data = <span class="hljs-literal">nullptr</span>;</li><li>    napi_status status = <span class="hljs-built_in">napi_unwrap</span>(env, wrapped, <span class="hljs-built_in">reinterpret_cast</span>&lt;<span class="hljs-type">void</span> **&gt;(&amp;data));</li><li>    <span class="hljs-keyword">if</span> (status != napi_ok || data == <span class="hljs-literal">nullptr</span>) {</li><li>        <span class="hljs-built_in">OH_LOG_ERROR</span>(LOG_APP, <span class="hljs-string">"Node-API napi_unwrap failed or data is nullptr"</span>);</li><li>        <span class="hljs-keyword">return</span> <span class="hljs-literal">nullptr</span>;</li><li>    }</li><li>    <span class="hljs-built_in">OH_LOG_INFO</span>(LOG_APP, <span class="hljs-string">"Node-API name: %{public}s"</span>, data-&gt;name.<span class="hljs-built_in">c_str</span>());</li><li>    <span class="hljs-built_in">OH_LOG_INFO</span>(LOG_APP, <span class="hljs-string">"Node-API age: %{public}d"</span>, data-&gt;age);</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-literal">nullptr</span>;</li><li>}</li></ol></pre></div></div> <p>接口声明</p> <div _ngcontent-swk-c106="" class="highlight-div"><div _ngcontent-swk-c106="" class="highlight-div-header"><div _ngcontent-swk-c106="" class="highlight-div-header-left"><div _ngcontent-swk-c106="" class="handle-button expand-button"><div _ngcontent-swk-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-swk-c106="" class="highlight-div-header-right"><div _ngcontent-swk-c106="" class="handle-button ai-button"></div><div _ngcontent-swk-c106="" class="handle-button line-button"><div _ngcontent-swk-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-swk-c106="" class="handle-button theme-button"><div _ngcontent-swk-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-swk-c106="" class="handle-button copy-button"><div _ngcontent-swk-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-swk-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// index.d.ts</span></li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-attr">wrap</span>: <span class="hljs-function">(<span class="hljs-params">obj: <span class="hljs-built_in">Object</span></span>) =&gt;</span> <span class="hljs-title class_">Object</span>;</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-attr">unWrap</span>: <span class="hljs-function">(<span class="hljs-params">obj: <span class="hljs-built_in">Object</span></span>) =&gt;</span> <span class="hljs-built_in">void</span>;</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-attr">removeWrap</span>: <span class="hljs-function">(<span class="hljs-params">obj: <span class="hljs-built_in">Object</span></span>) =&gt;</span> <span class="hljs-built_in">void</span>;</li></ol></pre></div></div> <p>ArkTS侧示例代码</p> <div _ngcontent-swk-c106="" class="highlight-div"><div _ngcontent-swk-c106="" class="highlight-div-header"><div _ngcontent-swk-c106="" class="highlight-div-header-left"><div _ngcontent-swk-c106="" class="handle-button expand-button"><div _ngcontent-swk-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-swk-c106="" class="highlight-div-header-right"><div _ngcontent-swk-c106="" class="handle-button ai-button"></div><div _ngcontent-swk-c106="" class="handle-button line-button"><div _ngcontent-swk-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-swk-c106="" class="handle-button theme-button"><div _ngcontent-swk-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-swk-c106="" class="handle-button copy-button"><div _ngcontent-swk-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-swk-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li><span class="hljs-keyword">import</span> testNapi <span class="hljs-keyword">from</span> <span class="hljs-string">'libentry.so'</span>;</li><li>
</li><li><span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">class</span> <span class="hljs-title class_">Obj</span> {}</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">obj</span>: <span class="hljs-title class_">Obj</span> = {};</li><li>    testNapi.<span class="hljs-title function_">wrap</span>(obj)</li><li>    testNapi.<span class="hljs-title function_">unWrap</span>(obj)</li><li>    testNapi.<span class="hljs-title function_">removeWrap</span>(obj)</li><li>} <span class="hljs-keyword">catch</span> (error) {</li><li>    hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">'Test Node-API error: %{public}s'</span>, error.<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div> <p>以上代码如果要在native cpp中打印日志，需在CMakeLists.txt文件中添加以下配置信息（并添加头文件：#include "hilog/log.h"）：</p> <div _ngcontent-swk-c106="" class="highlight-div"><div _ngcontent-swk-c106="" class="highlight-div-header"><div _ngcontent-swk-c106="" class="highlight-div-header-left"><div _ngcontent-swk-c106="" class="handle-button expand-button"><div _ngcontent-swk-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-swk-c106="" class="highlight-div-header-right"><div _ngcontent-swk-c106="" class="handle-button ai-button"></div><div _ngcontent-swk-c106="" class="handle-button line-button"><div _ngcontent-swk-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-swk-c106="" class="handle-button theme-button"><div _ngcontent-swk-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-swk-c106="" class="handle-button copy-button"><div _ngcontent-swk-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-swk-c106="" class="highlight-scroll-div"><pre class="text prettyprint linenums hljs language-plaintext" hw-language="text" data-highlighted="yes"><ol class="linenums"><li>// CMakeLists.txt</li><li>add_definitions( "-DLOG_DOMAIN=0xd0d0" )</li><li>add_definitions( "-DLOG_TAG=\"testTag\"" )</li><li>target_link_libraries(entry PUBLIC libace_napi.z.so libhilog_ndk.z.so)</li></ol></pre></div></div> </div> </div> <div></div></div>