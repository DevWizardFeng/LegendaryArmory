<h1 _ngcontent-baf-c119="" class="doc-title ng-star-inserted" title="使用OpenSL ES开发音频播放功能(C/C++)"> 使用OpenSL ES开发音频播放功能(C/C++) </h1>

<div _ngcontent-baf-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div><p>OpenSL ES全称为Open Sound Library for Embedded Systems，是一个嵌入式、跨平台、免费的音频处理库。为嵌入式移动多媒体设备上的应用开发者提供标准化、高性能、低延迟的API。HarmonyOS的Native API基于<a href="https://www.khronos.org/" target="_blank">Khronos Group</a>开发的<a href="https://www.khronos.org/opensles/" target="_blank">OpenSL ES</a> 1.0.1 API 规范实现，开发者可以通过&lt;OpenSLES.h&gt;和&lt;OpenSLES_OpenHarmony.h&gt;在HarmonyOS上使用相关API。</p>  <div class="tiledSection"><h2 id="使用ohaudio替代opensl-es">使用OHAudio替代OpenSL ES<i class="anchor-icon anchor-icon-link" anchorid="使用ohaudio替代opensl-es" tips="复制节点链接"></i></h2><p>HarmonyOS上的OpenSL ES接口，是早期SDK8版本开始提供，用于支持应用Native层音频开发的接口。但随着版本演进，接口定义的可扩展性不足，不再能满足音频系统的能力拓展，因此当前已不再推荐应用开发者继续使用此接口进行音频功能开发，可能存在一些接口能力不足的缺陷。</p> <p>在SDK10版本，HarmonyOS推出了OHAudio接口，并将系统具备的所有音频功能都通过此接口开放。OHAudio接口已能够覆盖OpenSL ES在HarmonyOS中已提供的所有能力，并拓展支持音频焦点事件，低时延等新版本特性。</p> <p>OHAudio的开发指南见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/using-ohaudio-for-playback">使用OHAudio开发音频播放功能(C/C++)</a>。</p> <p>考虑到一些接入HarmonyOS较早的应用开发者，这里提供了一份OpenSL ES接口切换到OHAudio的对照参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/replace-opensles-by-ohaudio">OpenSL ES接口切换OHAudio参考</a>，便于开发者能够更快的在新版本切换到使用新接口。</p> </div>  <div class="tiledSection"><h2 id="harmonyos上的opensl-es">HarmonyOS上的OpenSL ES<i class="anchor-icon anchor-icon-link" anchorid="harmonyos上的opensl-es" tips="复制节点链接"></i></h2><p>OpenSL ES中提供了以下的接口，HarmonyOS当前仅实现了部分<a href="https://gitcode.com/openharmony/third_party_opensles/blob/master/api/1.0.1/OpenSLES.h" target="_blank">接口</a>，可以实现音频播放的基础功能。</p> <p>调用未实现接口后会返回<strong>SL_RESULT_FEATURE_UNSUPPORTED</strong>, 当前没有相关扩展可以使用。</p> <p>以下列表列举了HarmonyOS上已实现的OpenSL ES的接口，具体说明请参考<a href="https://www.khronos.org/opensles/" target="_blank">OpenSL ES</a>规范：</p> <ul><li><p><strong>HarmonyOS上支持的SLInterfaceID：</strong></p>   <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.3.5.1.2.1.3.1.1" valign="top" width="50%">SLInterfaceID</th> <th align="left" class="cellrowborder" id="mcps1.3.3.5.1.2.1.3.1.2" valign="top" width="50%">说明</th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="50%">SL_IID_ENGINE</td> <td class="cellrowborder" valign="top" width="50%">通用引擎，提供创建播放对象接口。</td> </tr> <tr><td class="cellrowborder" valign="top" width="50%">SL_IID_PLAY</td> <td class="cellrowborder" valign="top" width="50%">提供播放状态接口。</td> </tr> <tr><td class="cellrowborder" valign="top" width="50%">SL_IID_VOLUME</td> <td class="cellrowborder" valign="top" width="50%">提供音频播放流音量调节和读取接口。</td> </tr> <tr><td class="cellrowborder" valign="top" width="50%">SL_IID_OH_BUFFERQUEUE</td> <td class="cellrowborder" valign="top" width="50%">提供音频播放流数据回调注册接口。</td> </tr>  </tbody></table></div> </div>  </li><li><p><strong>HarmonyOS上支持的Engine接口：</strong></p>  <ul><li>SLresult (*CreateAudioPlayer) (SLEngineItf self, SLObjectItf * pPlayer, SLDataSource *pAudioSrc, SLDataSink *pAudioSnk, SLuint32 numInterfaces, const SLInterfaceID * pInterfaceIds, const SLboolean * pInterfaceRequired)</li><li>SLresult (*CreateAudioRecorder) (SLEngineItf self, SLObjectItf * pRecorder, SLDataSource *pAudioSrc, SLDataSink *pAudioSnk, SLuint32 numInterfaces, const SLInterfaceID * pInterfaceIds, const SLboolean * pInterfaceRequired)</li><li>SLresult (*CreateOutputMix) (SLEngineItf self, SLObjectItf * pMix, SLuint32 numInterfaces, const SLInterfaceID * pInterfaceIds, const SLboolean * pInterfaceRequired)</li></ul>  </li><li><p><strong>HarmonyOS上支持的Object接口：</strong></p>  <ul><li>SLresult (*Realize) (SLObjectItf self, SLboolean async)</li><li>SLresult (*GetState) (SLObjectItf self, SLuint32 * pState)</li><li>SLresult (*GetInterface) (SLObjectItf self, const SLInterfaceID iid, void * pInterface)</li><li>void (*Destroy) (SLObjectItf self)</li></ul>  </li><li><p><strong>HarmonyOS上支持的Playback接口：</strong></p>  <ul><li>SLresult (*SetPlayState) (SLPlayItf self, SLuint32 state)</li><li>SLresult (*GetPlayState) (SLPlayItf self, SLuint32 *pState)</li></ul>  </li><li><p><strong>HarmonyOS上支持的Volume控制接口：</strong></p>  <ul><li>SLresult (*SetVolumeLevel) (SLVolumeItf self, SLmillibel level)</li><li>SLresult (*GetVolumeLevel) (SLVolumeItf self, SLmillibel *pLevel)</li><li>SLresult (*GetMaxVolumeLevel) (SLVolumeItf self, SLmillibel *pMaxLevel)</li></ul>  </li><li><p><strong>HarmonyOS上支持的BufferQueue接口：</strong></p>  <p> 以下接口需引入&lt;OpenSLES_OpenHarmony.h&gt;使用。</p>   <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.3.5.6.3.1.3.1.1" valign="top" width="50%">接口</th> <th align="left" class="cellrowborder" id="mcps1.3.3.5.6.3.1.3.1.2" valign="top" width="50%">说明</th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="50%">SLresult (*Enqueue) (SLOHBufferQueueItf self, const void *buffer, SLuint32 size)</td> <td class="cellrowborder" valign="top" width="50%"><p>根据情况将buffer加到相应队列中。</p> <p>如果是播放操作，则将带有音频数据的buffer插入到filledBufferQ_队列中；如果是录音操作，则将录音使用后的空闲buffer插入到freeBufferQ_队列中。</p> <p>self：表示调用该函数的BufferQueue接口对象。</p> <p>buffer：播放时表示带有音频数据的buffer，录音时表示已存储完录音数据后的空闲buffer。</p> <p>size：表示buffer的大小。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="50%">SLresult (*Clear) (SLOHBufferQueueItf self)</td> <td class="cellrowborder" valign="top" width="50%"><p>释放BufferQueue接口对象。</p> <p>self：表示调用该函数的BufferQueue接口对象将被释放。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="50%">SLresult (*GetState) (SLOHBufferQueueItf self, SLOHBufferQueueState *state)</td> <td class="cellrowborder" valign="top" width="50%"><p>获取BufferQueue接口对象状态。</p> <p>self：表示调用该函数的BufferQueue接口对象。</p> <p>state：BufferQueue的当前状态。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="50%">SLresult (*RegisterCallback) (SLOHBufferQueueItf self, SlOHBufferQueueCallback callback, void* pContext)</td> <td class="cellrowborder" valign="top" width="50%"><p>注册回调函数。</p> <p>self：表示调用该函数的BufferQueue接口对象。</p> <p>callback：播放/录音时注册的回调函数。</p> <p>pContext：播放时传入待播放音频文件，录音时传入将要录制的音频文件。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="50%">SLresult (*GetBuffer) (SLOHBufferQueueItf self, SLuint8** buffer, SLuint32* size)</td> <td class="cellrowborder" valign="top" width="50%"><p>根据情况获取相应的buffer。</p> <p>如果是播放操作，则从freeBufferQ_队列中获取空闲buffer；如果是录音操作，则从filledBufferQ_队列中获取携带录音数据的buffer。</p> <p>self：表示调用该函数的BufferQueue接口对象。</p> <p>buffer：播放时表示空闲的buffer，录音时表示携带录音数据的buffer。</p> <p>size：表示buffer的大小。</p> </td> </tr>  </tbody></table></div> </div>  </li></ul> </div>  <div class="tiledSection"><h2 id="完整示例">完整示例<i class="anchor-icon anchor-icon-link" anchorid="完整示例" tips="复制节点链接"></i></h2></div>  <div class="tiledSection"><h3 id="在-cmake-脚本中链接动态库" class="firsth2">在 CMake 脚本中链接动态库<i class="anchor-icon anchor-icon-link" anchorid="在-cmake-脚本中链接动态库" tips="复制节点链接"></i></h3><div _ngcontent-baf-c106="" class="highlight-div"><div _ngcontent-baf-c106="" class="highlight-div-header"><div _ngcontent-baf-c106="" class="highlight-div-header-left"><div _ngcontent-baf-c106="" class="handle-button expand-button"><div _ngcontent-baf-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-baf-c106="" class="highlight-div-header-right"><div _ngcontent-baf-c106="" class="handle-button ai-button"></div><div _ngcontent-baf-c106="" class="handle-button line-button"><div _ngcontent-baf-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-baf-c106="" class="handle-button theme-button"><div _ngcontent-baf-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-baf-c106="" class="handle-button copy-button"><div _ngcontent-baf-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-baf-c106="" class="highlight-scroll-div"><pre class="cmake prettyprint linenums hljs language-scss" hw-language="cmake" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-built_in">target_link_libraries</span>(sample PUBLIC libOpenSLES.so)</li></ol></pre></div></div> <p>参考以下示例代码，播放一个音频文件。</p> <ol><li><p>添加头文件。</p>  <div _ngcontent-baf-c106="" class="highlight-div"><div _ngcontent-baf-c106="" class="highlight-div-header"><div _ngcontent-baf-c106="" class="highlight-div-header-left"><div _ngcontent-baf-c106="" class="handle-button expand-button"><div _ngcontent-baf-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-baf-c106="" class="highlight-div-header-right"><div _ngcontent-baf-c106="" class="handle-button ai-button"></div><div _ngcontent-baf-c106="" class="handle-button line-button"><div _ngcontent-baf-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-baf-c106="" class="handle-button theme-button"><div _ngcontent-baf-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-baf-c106="" class="handle-button copy-button"><div _ngcontent-baf-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-baf-c106="" class="highlight-scroll-div"><pre class="cpp prettyprint linenums hljs language-cpp" hw-language="cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"SLES/OpenSLES.h"</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"SLES/OpenSLES_OpenHarmony.h"</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"SLES/OpenSLES_Platform.h"</span></span></li></ol></pre></div></div>  </li><li><p>使用slCreateEngine接口和获取engine实例。</p>  <div _ngcontent-baf-c106="" class="highlight-div"><div _ngcontent-baf-c106="" class="highlight-div-header"><div _ngcontent-baf-c106="" class="highlight-div-header-left"><div _ngcontent-baf-c106="" class="handle-button expand-button"><div _ngcontent-baf-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-baf-c106="" class="highlight-div-header-right"><div _ngcontent-baf-c106="" class="handle-button ai-button"></div><div _ngcontent-baf-c106="" class="handle-button line-button"><div _ngcontent-baf-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-baf-c106="" class="handle-button theme-button"><div _ngcontent-baf-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-baf-c106="" class="handle-button copy-button"><div _ngcontent-baf-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-baf-c106="" class="highlight-scroll-div"><pre class="cpp prettyprint linenums hljs language-cpp" hw-language="cpp" data-highlighted="yes"><ol class="linenums"><li>SLObjectItf engineObject = <span class="hljs-literal">nullptr</span>;</li><li><span class="hljs-built_in">slCreateEngine</span>(&amp;engineObject, <span class="hljs-number">0</span>, <span class="hljs-literal">nullptr</span>, <span class="hljs-number">0</span>, <span class="hljs-literal">nullptr</span>, <span class="hljs-literal">nullptr</span>);</li><li>(*engineObject)-&gt;<span class="hljs-built_in">Realize</span>(engineObject, SL_BOOLEAN_FALSE);</li></ol></pre></div></div>  </li><li><p>获取接口SL_IID_ENGINE的engineEngine实例。</p>  <div _ngcontent-baf-c106="" class="highlight-div"><div _ngcontent-baf-c106="" class="highlight-div-header"><div _ngcontent-baf-c106="" class="highlight-div-header-left"><div _ngcontent-baf-c106="" class="handle-button expand-button"><div _ngcontent-baf-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-baf-c106="" class="highlight-div-header-right"><div _ngcontent-baf-c106="" class="handle-button ai-button"></div><div _ngcontent-baf-c106="" class="handle-button line-button"><div _ngcontent-baf-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-baf-c106="" class="handle-button theme-button"><div _ngcontent-baf-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-baf-c106="" class="handle-button copy-button"><div _ngcontent-baf-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-baf-c106="" class="highlight-scroll-div"><pre class="cpp prettyprint linenums hljs language-cpp" hw-language="cpp" data-highlighted="yes"><ol class="linenums"><li>SLEngineItf engineEngine = <span class="hljs-literal">nullptr</span>;</li><li>(*engineObject)-&gt;<span class="hljs-built_in">GetInterface</span>(engineObject, SL_IID_ENGINE, &amp;engineEngine);</li></ol></pre></div></div>  </li><li><p>配置播放器信息，创建AudioPlayer。</p>  <div _ngcontent-baf-c106="" class="highlight-div"><div _ngcontent-baf-c106="" class="highlight-div-header"><div _ngcontent-baf-c106="" class="highlight-div-header-left"><div _ngcontent-baf-c106="" class="handle-button expand-button"><div _ngcontent-baf-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-baf-c106="" class="highlight-div-header-right"><div _ngcontent-baf-c106="" class="handle-button ai-button"></div><div _ngcontent-baf-c106="" class="handle-button line-button"><div _ngcontent-baf-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-baf-c106="" class="handle-button theme-button"><div _ngcontent-baf-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-baf-c106="" class="handle-button copy-button"><div _ngcontent-baf-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-baf-c106="" class="highlight-scroll-div"><pre class="cpp prettyprint linenums hljs language-cpp" hw-language="cpp" data-highlighted="yes"><ol class="linenums"><li>SLDataLocator_BufferQueue slBufferQueue = {</li><li>    SL_DATALOCATOR_BUFFERQUEUE,</li><li>    <span class="hljs-number">1</span></li><li>};</li><li>
</li><li><span class="hljs-comment">// 具体参数需要根据音频文件格式进行适配。</span></li><li>SLDataFormat_PCM pcmFormat = {</li><li>    SL_DATAFORMAT_PCM,</li><li>    <span class="hljs-number">2</span>,                           <span class="hljs-comment">// 通道数。</span></li><li>    SL_SAMPLINGRATE_48,          <span class="hljs-comment">// 采样率。</span></li><li>    SL_PCMSAMPLEFORMAT_FIXED_16, <span class="hljs-comment">// 音频采样格式。</span></li><li>    <span class="hljs-number">16</span>,</li><li>    SL_SPEAKER_FRONT_LEFT | SL_SPEAKER_FRONT_RIGHT,</li><li>    SL_BYTEORDER_LITTLEENDIAN</li><li>};</li><li>SLDataSource slSource = {</li><li>   &amp;slBufferQueue,</li><li>   &amp;pcmFormat</li><li>};</li><li>SLObjectItf pcmPlayerObject = <span class="hljs-literal">nullptr</span>;</li><li>(*engineEngine)-&gt;<span class="hljs-built_in">CreateAudioPlayer</span>(engineEngine,</li><li>                                   &amp;pcmPlayerObject,</li><li>                                   &amp;slSource,</li><li>                                   &amp;slSink,</li><li>                                   <span class="hljs-number">0</span>,</li><li>                                   <span class="hljs-literal">nullptr</span>,</li><li>                                   <span class="hljs-literal">nullptr</span>);</li><li>(*pcmPlayerObject)-&gt;<span class="hljs-built_in">Realize</span>(pcmPlayerObject, SL_BOOLEAN_FALSE);</li></ol></pre></div></div>  </li><li><p>获取接口SL_IID_OH_BUFFERQUEUE的bufferQueueItf实例。</p>  <div _ngcontent-baf-c106="" class="highlight-div"><div _ngcontent-baf-c106="" class="highlight-div-header"><div _ngcontent-baf-c106="" class="highlight-div-header-left"><div _ngcontent-baf-c106="" class="handle-button expand-button"><div _ngcontent-baf-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-baf-c106="" class="highlight-div-header-right"><div _ngcontent-baf-c106="" class="handle-button ai-button"></div><div _ngcontent-baf-c106="" class="handle-button line-button"><div _ngcontent-baf-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-baf-c106="" class="handle-button theme-button"><div _ngcontent-baf-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-baf-c106="" class="handle-button copy-button"><div _ngcontent-baf-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-baf-c106="" class="highlight-scroll-div"><pre class="cpp prettyprint linenums hljs language-cpp" hw-language="cpp" data-highlighted="yes"><ol class="linenums"><li>SLOHBufferQueueItf bufferQueueItf;</li><li>(*pcmPlayerObject)-&gt;<span class="hljs-built_in">GetInterface</span>(pcmPlayerObject, SL_IID_OH_BUFFERQUEUE, &amp;bufferQueueItf);</li></ol></pre></div></div>  </li><li><p>打开音频文件，注册BufferQueueCallback回调。</p>  <div _ngcontent-baf-c106="" class="highlight-div"><div _ngcontent-baf-c106="" class="highlight-div-header"><div _ngcontent-baf-c106="" class="highlight-div-header-left"><div _ngcontent-baf-c106="" class="handle-button expand-button"><div _ngcontent-baf-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-baf-c106="" class="highlight-div-header-right"><div _ngcontent-baf-c106="" class="handle-button ai-button"></div><div _ngcontent-baf-c106="" class="handle-button line-button"><div _ngcontent-baf-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-baf-c106="" class="handle-button theme-button"><div _ngcontent-baf-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-baf-c106="" class="handle-button copy-button"><div _ngcontent-baf-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-baf-c106="" class="highlight-scroll-div"><pre class="cpp prettyprint linenums hljs language-cpp" hw-language="cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-function"><span class="hljs-type">static</span> <span class="hljs-type">void</span> <span class="hljs-title">BufferQueueCallback</span> <span class="hljs-params">(SLOHBufferQueueItf bufferQueueItf, <span class="hljs-type">void</span> *pContext, SLuint32 size)</span></span></li><li><span class="hljs-function"></span>{</li><li>    SLuint8 *buffer = <span class="hljs-literal">nullptr</span>;</li><li>    SLuint32 pSize;</li><li>    (*bufferQueueItf)-&gt;<span class="hljs-built_in">GetBuffer</span>(bufferQueueItf, &amp;buffer, &amp;pSize);</li><li>    <span class="hljs-comment">// 将待播放音频数据写入buffer。</span></li><li>    (*bufferQueueItf)-&gt;<span class="hljs-built_in">Enqueue</span>(bufferQueueItf, buffer, size);</li><li>}</li><li><span class="hljs-type">void</span> *pContext; <span class="hljs-comment">// 可传入自定义的上下文信息，会在Callback内收到。</span></li><li>(*bufferQueueItf)-&gt;<span class="hljs-built_in">RegisterCallback</span>(bufferQueueItf, BufferQueueCallback, pContext);</li></ol></pre></div></div>  </li><li><p>获取接口SL_PLAYSTATE_PLAYING的playItf实例，开始播放。</p>  <div _ngcontent-baf-c106="" class="highlight-div"><div _ngcontent-baf-c106="" class="highlight-div-header"><div _ngcontent-baf-c106="" class="highlight-div-header-left"><div _ngcontent-baf-c106="" class="handle-button expand-button"><div _ngcontent-baf-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-baf-c106="" class="highlight-div-header-right"><div _ngcontent-baf-c106="" class="handle-button ai-button"></div><div _ngcontent-baf-c106="" class="handle-button line-button"><div _ngcontent-baf-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-baf-c106="" class="handle-button theme-button"><div _ngcontent-baf-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-baf-c106="" class="handle-button copy-button"><div _ngcontent-baf-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-baf-c106="" class="highlight-scroll-div"><pre class="cpp prettyprint linenums hljs language-cpp" hw-language="cpp" data-highlighted="yes"><ol class="linenums"><li>SLPlayItf playItf = <span class="hljs-literal">nullptr</span>;</li><li>(*pcmPlayerObject)-&gt;<span class="hljs-built_in">GetInterface</span>(pcmPlayerObject, SL_IID_PLAY, &amp;playItf);</li><li>(*playItf)-&gt;<span class="hljs-built_in">SetPlayState</span>(playItf, SL_PLAYSTATE_PLAYING);</li></ol></pre></div></div>  </li><li><p>结束音频播放。</p>  <div _ngcontent-baf-c106="" class="highlight-div"><div _ngcontent-baf-c106="" class="highlight-div-header"><div _ngcontent-baf-c106="" class="highlight-div-header-left"><div _ngcontent-baf-c106="" class="handle-button expand-button"><div _ngcontent-baf-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-baf-c106="" class="highlight-div-header-right"><div _ngcontent-baf-c106="" class="handle-button ai-button"></div><div _ngcontent-baf-c106="" class="handle-button line-button"><div _ngcontent-baf-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-baf-c106="" class="handle-button theme-button"><div _ngcontent-baf-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-baf-c106="" class="handle-button copy-button"><div _ngcontent-baf-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-baf-c106="" class="highlight-scroll-div"><pre class="cpp prettyprint linenums hljs language-cpp" hw-language="cpp" data-highlighted="yes"><ol class="linenums"><li>(*playItf)-&gt;<span class="hljs-built_in">SetPlayState</span>(playItf, SL_PLAYSTATE_STOPPED);</li><li>(*pcmPlayerObject)-&gt;<span class="hljs-built_in">Destroy</span>(pcmPlayerObject);</li><li>(*engineObject)-&gt;<span class="hljs-built_in">Destroy</span>(engineObject);</li></ol></pre></div></div>  </li></ol> </div> </div> <div></div></div>