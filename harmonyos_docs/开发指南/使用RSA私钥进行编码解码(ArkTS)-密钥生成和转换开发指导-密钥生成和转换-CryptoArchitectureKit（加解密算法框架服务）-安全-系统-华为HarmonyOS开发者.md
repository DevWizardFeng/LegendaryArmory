<h1 _ngcontent-nut-c119="" class="doc-title ng-star-inserted" title="使用RSA私钥进行编码解码(ArkTS)"> 使用RSA私钥进行编码解码(ArkTS) </h1>

<div _ngcontent-nut-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p><strong>编码</strong></p>    <ol>     <li>      <p>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-cryptoframework#cryptoframeworkcreateasykeygenerator" target="_blank">cryptoFramework.createAsyKeyGenerator</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-cryptoframework#generatekeypair-1" target="_blank">AsyKeyGenerator.generateKeyPair</a>，生成RSA密钥类型为RSA1024、素数个数为2的非对称密钥对（KeyPair）。KeyPair对象中包括公钥PubKey、私钥PriKey。</p>      <p>如何生成RSA非对称密钥对，开发者可参考下文示例，并结合<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/crypto-asym-key-generation-conversion-spec#rsa">非对称密钥生成和转换规格：RSA</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/crypto-generate-asym-key-pair-randomly">随机生成非对称密钥对</a>理解，参考文档与当前示例可能存在入参差异，请在阅读时注意区分。</p></li>     <li>      <p>传入参数<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-cryptoframework#keyencodingconfig18" target="_blank">KeyEncodingConfig</a>，参数PKCS1/PKCS8，调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-cryptoframework#getencodedpem18" target="_blank">prikey.getEncodedPem</a>生成编码后的私钥字符串。</p></li>    </ol>    <p><strong>解码</strong></p>    <ol>     <li>      <p>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-cryptoframework#cryptoframeworkcreateasykeygenerator" target="_blank">cryptoFramework.createAsyKeyGenerator</a>生成RSA非对称密钥生成器asyKeyGenerator。</p>      <p>如何生成RSA非对称密钥对，开发者可参考下文示例，并结合<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/crypto-asym-key-generation-conversion-spec#rsa">非对称密钥生成和转换规格：RSA</a>。</p>      <div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content">        <p>解码应该与编码传入的算法一致。</p>       </div></div></div></li>     <li>      <p>调用异步<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-cryptoframework#convertpemkey18" target="_blank">asyKeyGenerator.convertPemKey</a>或者同步方法<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-cryptoframework#convertpemkeysync18" target="_blank">asyKeyGenerator.convertPemKeySync</a>，传入编码后的私钥字符串与编码口令。最后返回编码前的私钥字符串。</p></li>    </ol>    <ul>     <li>      <p>编码示例：</p>      <div _ngcontent-nut-c106="" class="highlight-div"><div _ngcontent-nut-c106="" class="highlight-div-header"><div _ngcontent-nut-c106="" class="highlight-div-header-left"><div _ngcontent-nut-c106="" class="handle-button expand-button"><div _ngcontent-nut-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-nut-c106="" class="highlight-div-header-right"><div _ngcontent-nut-c106="" class="handle-button ai-button"></div><div _ngcontent-nut-c106="" class="handle-button line-button"><div _ngcontent-nut-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-nut-c106="" class="handle-button theme-button"><div _ngcontent-nut-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-nut-c106="" class="handle-button copy-button"><div _ngcontent-nut-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-nut-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { cryptoFramework } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.CryptoArchitectureKit'</span>;</li><li>
</li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">TestPriKeyPkcs1Encoded</span>(<span class="hljs-params"></span>) {</li><li>  <span class="hljs-keyword">let</span> rsaGenerator = cryptoFramework.<span class="hljs-title function_">createAsyKeyGenerator</span>(<span class="hljs-string">'RSA1024'</span>);</li><li>  <span class="hljs-keyword">let</span> keyPair = rsaGenerator.<span class="hljs-title function_">generateKeyPairSync</span>();</li><li>  <span class="hljs-keyword">let</span> options : cryptoFramework.<span class="hljs-property">KeyEncodingConfig</span> = {</li><li>      <span class="hljs-attr">password</span>: <span class="hljs-string">"123456"</span>,</li><li>      <span class="hljs-attr">cipherName</span>: <span class="hljs-string">"AES-128-CBC"</span></li><li>  }</li><li>  <span class="hljs-keyword">let</span> priPemKey = keyPair.<span class="hljs-property">priKey</span>;</li><li>  <span class="hljs-keyword">let</span> priString = priPemKey.<span class="hljs-title function_">getEncodedPem</span>(<span class="hljs-string">'PKCS1'</span>, options);</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"[sync]TestPriKeyPkcs1Encoded priString output is "</span> + priString);</li><li>}</li></ol></pre></div></div></li>     <li>      <p>解码示例：</p>      <div _ngcontent-nut-c106="" class="highlight-div"><div _ngcontent-nut-c106="" class="highlight-div-header"><div _ngcontent-nut-c106="" class="highlight-div-header-left"><div _ngcontent-nut-c106="" class="handle-button expand-button"><div _ngcontent-nut-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-nut-c106="" class="highlight-div-header-right"><div _ngcontent-nut-c106="" class="handle-button ai-button"></div><div _ngcontent-nut-c106="" class="handle-button line-button"><div _ngcontent-nut-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-nut-c106="" class="handle-button theme-button"><div _ngcontent-nut-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-nut-c106="" class="handle-button copy-button"><div _ngcontent-nut-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-nut-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { cryptoFramework } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.CryptoArchitectureKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> priKeyPkcs1EncodingStr : <span class="hljs-built_in">string</span> =</li><li><span class="hljs-string">"-----BEGIN RSA PRIVATE KEY-----\n"</span></li><li>  +<span class="hljs-string">"Proc-Type: 4,ENCRYPTED\n"</span></li><li>  +<span class="hljs-string">"DEK-Info: AES-128-CBC,815A066131BF05CF87CE610A59CC69AE\n\n"</span></li><li>  +<span class="hljs-string">"7Jd0vmOmYGFZ2yRY8fqRl3+6rQlFtNcMILvcb5KWHDSrxA0ULmJE7CW0DSRikHoA\n"</span></li><li>  +<span class="hljs-string">"t0KgafhYXeQXh0dRy9lvVRAFSLHCLJVjchx90V7ZSivBFEq7+iTozVp4AlbgYsJP\n"</span></li><li>  +<span class="hljs-string">"vx/1sfZD2WAcyMJ7IDmJyft7xnpVSXsyWGTT4f3eaHJIh1dqjwrso7ucAW0FK6rp\n"</span></li><li>  +<span class="hljs-string">"/TONyOoXNfXtRbVtxNyCWBxt4HCSclDZFvS9y8fz9ZwmCUV7jei/YdzyQI2wnE13\n"</span></li><li>  +<span class="hljs-string">"W8cKlpzRFL6BWi8XPrUtAw5MWeHBAPUgPWMfcmiaeyi5BJFhQCrHLi+Gj4EEJvp7\n"</span></li><li>  +<span class="hljs-string">"mP5cbnQAx6+paV5z9m71SKrI/WSc4ixsYYdVmlL/qwAK9YliFfoPl030YJWW6rFf\n"</span></li><li>  +<span class="hljs-string">"T7J9BUlHGUJ0RB2lURNNLakM+UZRkeE9TByzCzgTxuQtyv5Lwsh2mAk3ia5x0kUO\n"</span></li><li>  +<span class="hljs-string">"LHg3Eoabhdh+YZA5hHaxnpF7VjspB78E0F9Btq+A41rSJ6zDOdToHey4MJ2nxdey\n"</span></li><li>  +<span class="hljs-string">"Z3bi81TZ6Fp4IuROrvZ2B/Xl3uNKR7n+AHRKnaAO87ywzyltvjwSh2y3xhJueiRs\n"</span></li><li>  +<span class="hljs-string">"BiYkyL3/fnocD3pexTdN6h3JgQGgO5GV8zw/NrxA85mw8o9im0HreuFObmNj36T9\n"</span></li><li>  +<span class="hljs-string">"k5N+R/QIXW83cIQOLaWK1ThYcluytf0tDRiMoKqULiaA6HvDMigExLxuhCtnoF8I\n"</span></li><li>  +<span class="hljs-string">"iOLN1cPdEVQjzwDHLqXP2DbWW1z9iRepLZlEm1hLRLEmOrTGKezYupVv306SSa6J\n"</span></li><li>  +<span class="hljs-string">"OA55lAeXMbyjFaYCr54HWrpt4NwNBX1efMUURc+1LcHpzFrBTTLbfjIyq6as49pH\n"</span></li><li>  +<span class="hljs-string">"-----END RSA PRIVATE KEY-----\n"</span></li><li>
</li><li><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">TestConvertPemKeyByPromise</span>(<span class="hljs-params"></span>) {</li><li>  <span class="hljs-keyword">let</span> asyKeyGenerator = cryptoFramework.<span class="hljs-title function_">createAsyKeyGenerator</span>(<span class="hljs-string">'RSA1024'</span>);</li><li>  asyKeyGenerator.<span class="hljs-title function_">convertPemKey</span>(<span class="hljs-literal">null</span>, priKeyPkcs1EncodingStr, <span class="hljs-string">"123456"</span>)</li><li>    .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">keyPair</span> =&gt;</span> {</li><li>      <span class="hljs-keyword">let</span> priKey = keyPair.<span class="hljs-property">priKey</span>;</li><li>      <span class="hljs-keyword">if</span> (priKey) {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'convertPemKey success.'</span>);</li><li>      }</li><li>    }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error: BusinessError</span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"convertPemKey error, error message is "</span> + error.<span class="hljs-property">message</span>);</li><li>  });</li><li>}</li></ol></pre></div></div></li>    </ul>   </div>   <div></div></div>