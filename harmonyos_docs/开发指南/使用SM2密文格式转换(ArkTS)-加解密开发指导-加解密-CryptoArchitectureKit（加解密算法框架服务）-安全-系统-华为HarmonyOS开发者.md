<h1 _ngcontent-ves-c119="" class="doc-title ng-star-inserted" title="使用SM2密文格式转换(ArkTS)"> 使用SM2密文格式转换(ArkTS) </h1>

<div _ngcontent-ves-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p>当前支持的SM2密文格式为国密标准的ASN.1格式，其中各参数组合顺序为C1C3C2，具体参数含义请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/crypto-asym-encrypt-decrypt-spec#转换sm2密文格式">转换SM2密文格式</a>。</p>    <p>开发者可指定SM2密文的参数，将其转换成符合国密标准的ASN.1格式密文。反之，也可以从国密标准的ASN.1格式密文中取出具体的SM2密文参数，便于开发者自行组合成其他格式的SM2密文。</p>    <p><strong>指定密文参数，生成标准ASN.1密文</strong></p>    <ol>     <li>      <p>构造<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-cryptoframework#sm2ciphertextspec12" target="_blank">SM2CipherTextSpec</a>对象，用于指定SM2密文参数。如果开发者使用的不是国密标准的ASN.1格式密文，需自行提取所需要的参数。</p></li>     <li>      <p>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-cryptoframework#genciphertextbyspec12" target="_blank">genCipherTextBySpec</a>，将SM2CipherTextSpec对象传入，生成符合国密标准的ASN.1格式的SM2密文。</p></li>     <li>      <p>生成的密文可直接使用cryptoFramework进行SM2解密。</p></li>    </ol>    <div _ngcontent-ves-c106="" class="highlight-div"><div _ngcontent-ves-c106="" class="highlight-div-header"><div _ngcontent-ves-c106="" class="highlight-div-header-left"><div _ngcontent-ves-c106="" class="handle-button expand-button"><div _ngcontent-ves-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ves-c106="" class="highlight-div-header-right"><div _ngcontent-ves-c106="" class="handle-button ai-button"></div><div _ngcontent-ves-c106="" class="handle-button line-button"><div _ngcontent-ves-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ves-c106="" class="handle-button theme-button"><div _ngcontent-ves-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ves-c106="" class="handle-button copy-button"><div _ngcontent-ves-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ves-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { cryptoFramework } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.CryptoArchitectureKit'</span>;</li><li>
</li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">testGenCipherTextBySpec</span>(<span class="hljs-params"></span>) {</li><li>  <span class="hljs-keyword">let</span> spec : cryptoFramework.<span class="hljs-property">SM2CipherTextSpec</span> = {</li><li>      <span class="hljs-attr">xCoordinate</span>: <span class="hljs-title class_">BigInt</span>(<span class="hljs-string">'20625015362595980457695435345498579729138244358573902431560627260141789922999'</span>),</li><li>      <span class="hljs-attr">yCoordinate</span>: <span class="hljs-title class_">BigInt</span>(<span class="hljs-string">'48563164792857017065725892921053777369510340820930241057309844352421738767712'</span>),</li><li>      <span class="hljs-attr">cipherTextData</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>([<span class="hljs-number">100</span>, <span class="hljs-number">227</span>, <span class="hljs-number">78</span>, <span class="hljs-number">195</span>, <span class="hljs-number">249</span>, <span class="hljs-number">179</span>, <span class="hljs-number">43</span>, <span class="hljs-number">70</span>, <span class="hljs-number">242</span>, <span class="hljs-number">69</span>, <span class="hljs-number">169</span>, <span class="hljs-number">10</span>, <span class="hljs-number">65</span>, <span class="hljs-number">123</span>]),</li><li>      <span class="hljs-attr">hashData</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>([<span class="hljs-number">87</span>, <span class="hljs-number">167</span>, <span class="hljs-number">167</span>, <span class="hljs-number">247</span>, <span class="hljs-number">88</span>, <span class="hljs-number">146</span>, <span class="hljs-number">203</span>, <span class="hljs-number">234</span>, <span class="hljs-number">83</span>, <span class="hljs-number">126</span>, <span class="hljs-number">117</span>, <span class="hljs-number">129</span>, <span class="hljs-number">52</span>, <span class="hljs-number">142</span>, <span class="hljs-number">82</span>, <span class="hljs-number">54</span>, <span class="hljs-number">152</span>, <span class="hljs-number">226</span>, <span class="hljs-number">201</span>, <span class="hljs-number">111</span>, <span class="hljs-number">143</span>, <span class="hljs-number">115</span>, <span class="hljs-number">169</span>, <span class="hljs-number">125</span>, <span class="hljs-number">128</span>, <span class="hljs-number">42</span>, <span class="hljs-number">157</span>, <span class="hljs-number">31</span>, <span class="hljs-number">114</span>, <span class="hljs-number">198</span>, <span class="hljs-number">109</span>, <span class="hljs-number">244</span>])</li><li>  }</li><li>  <span class="hljs-comment">// 此处的data可直接使用cryptoFramework进行SM2解密。</span></li><li>  <span class="hljs-keyword">let</span> data = cryptoFramework.<span class="hljs-property">SM2CryptoUtil</span>.<span class="hljs-title function_">genCipherTextBySpec</span>(spec, <span class="hljs-string">'C1C3C2'</span>);</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'genCipherTextBySpec success'</span>);</li><li>}</li></ol></pre></div></div>    <p><strong>从标准ASN.1密文中，获取密文参数</strong></p>    <ol>     <li>      <p>准备符合国密标准的ASN.1格式的SM2密文。</p></li>     <li>      <p>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-cryptoframework#genciphertextbyspec12" target="_blank">getCipherTextSpec</a>，从标准密文中，获取具体的SM2密文参数。</p></li>     <li>      <p>根据业务需要，自行拼接SM2密文参数，形成其他格式的SM2密文。</p></li>    </ol>    <div _ngcontent-ves-c106="" class="highlight-div"><div _ngcontent-ves-c106="" class="highlight-div-header"><div _ngcontent-ves-c106="" class="highlight-div-header-left"><div _ngcontent-ves-c106="" class="handle-button expand-button"><div _ngcontent-ves-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ves-c106="" class="highlight-div-header-right"><div _ngcontent-ves-c106="" class="handle-button ai-button"></div><div _ngcontent-ves-c106="" class="handle-button line-button"><div _ngcontent-ves-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ves-c106="" class="handle-button theme-button"><div _ngcontent-ves-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ves-c106="" class="handle-button copy-button"><div _ngcontent-ves-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ves-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { cryptoFramework } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.CryptoArchitectureKit'</span>;</li><li>
</li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">testGetCipherTextSpec</span>(<span class="hljs-params"></span>) {</li><li>  <span class="hljs-keyword">let</span> cipherTextArray = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>([<span class="hljs-number">48</span>, <span class="hljs-number">118</span>, <span class="hljs-number">2</span>, <span class="hljs-number">32</span>, <span class="hljs-number">45</span>, <span class="hljs-number">153</span>, <span class="hljs-number">88</span>, <span class="hljs-number">82</span>, <span class="hljs-number">104</span>, <span class="hljs-number">221</span>, <span class="hljs-number">226</span>, <span class="hljs-number">43</span>, <span class="hljs-number">174</span>, <span class="hljs-number">21</span>, <span class="hljs-number">122</span>, <span class="hljs-number">248</span>, <span class="hljs-number">5</span>, <span class="hljs-number">232</span>, <span class="hljs-number">105</span>, <span class="hljs-number">41</span>, <span class="hljs-number">92</span>, <span class="hljs-number">95</span>, <span class="hljs-number">102</span>, <span class="hljs-number">224</span>, <span class="hljs-number">216</span>, <span class="hljs-number">149</span>, <span class="hljs-number">85</span>, <span class="hljs-number">236</span>, <span class="hljs-number">110</span>, <span class="hljs-number">6</span>, <span class="hljs-number">64</span>, <span class="hljs-number">188</span>, <span class="hljs-number">149</span>, <span class="hljs-number">70</span>, <span class="hljs-number">70</span>, <span class="hljs-number">183</span>, <span class="hljs-number">2</span>, <span class="hljs-number">32</span>, <span class="hljs-number">107</span>, <span class="hljs-number">93</span>, <span class="hljs-number">198</span>, <span class="hljs-number">247</span>, <span class="hljs-number">119</span>, <span class="hljs-number">18</span>, <span class="hljs-number">40</span>, <span class="hljs-number">110</span>, <span class="hljs-number">90</span>, <span class="hljs-number">156</span>, <span class="hljs-number">193</span>, <span class="hljs-number">158</span>, <span class="hljs-number">205</span>, <span class="hljs-number">113</span>, <span class="hljs-number">170</span>, <span class="hljs-number">128</span>, <span class="hljs-number">146</span>, <span class="hljs-number">109</span>, <span class="hljs-number">75</span>, <span class="hljs-number">17</span>, <span class="hljs-number">181</span>, <span class="hljs-number">109</span>, <span class="hljs-number">110</span>, <span class="hljs-number">91</span>, <span class="hljs-number">149</span>, <span class="hljs-number">5</span>, <span class="hljs-number">110</span>, <span class="hljs-number">233</span>, <span class="hljs-number">209</span>, <span class="hljs-number">78</span>, <span class="hljs-number">229</span>, <span class="hljs-number">96</span>, <span class="hljs-number">4</span>, <span class="hljs-number">32</span>, <span class="hljs-number">87</span>, <span class="hljs-number">167</span>, <span class="hljs-number">167</span>, <span class="hljs-number">247</span>, <span class="hljs-number">88</span>, <span class="hljs-number">146</span>, <span class="hljs-number">203</span>, <span class="hljs-number">234</span>, <span class="hljs-number">83</span>, <span class="hljs-number">126</span>, <span class="hljs-number">117</span>, <span class="hljs-number">129</span>, <span class="hljs-number">52</span>, <span class="hljs-number">142</span>, <span class="hljs-number">82</span>, <span class="hljs-number">54</span>, <span class="hljs-number">152</span>, <span class="hljs-number">226</span>, <span class="hljs-number">201</span>, <span class="hljs-number">111</span>, <span class="hljs-number">143</span>, <span class="hljs-number">115</span>, <span class="hljs-number">169</span>, <span class="hljs-number">125</span>, <span class="hljs-number">128</span>, <span class="hljs-number">42</span>, <span class="hljs-number">157</span>, <span class="hljs-number">31</span>, <span class="hljs-number">114</span>, <span class="hljs-number">198</span>, <span class="hljs-number">109</span>, <span class="hljs-number">244</span>, <span class="hljs-number">4</span>, <span class="hljs-number">14</span>, <span class="hljs-number">100</span>, <span class="hljs-number">227</span>, <span class="hljs-number">78</span>, <span class="hljs-number">195</span>, <span class="hljs-number">249</span>, <span class="hljs-number">179</span>, <span class="hljs-number">43</span>, <span class="hljs-number">70</span>, <span class="hljs-number">242</span>, <span class="hljs-number">69</span>, <span class="hljs-number">169</span>, <span class="hljs-number">10</span>, <span class="hljs-number">65</span>, <span class="hljs-number">123</span>]);</li><li>  <span class="hljs-keyword">let</span> cipherText : cryptoFramework.<span class="hljs-property">DataBlob</span> = {data : cipherTextArray};</li><li>  <span class="hljs-keyword">let</span> spec : cryptoFramework.<span class="hljs-property">SM2CipherTextSpec</span> = cryptoFramework.<span class="hljs-property">SM2CryptoUtil</span>.<span class="hljs-title function_">getCipherTextSpec</span>(cipherText, <span class="hljs-string">'C1C3C2'</span>);</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'getCipherTextSpec success'</span>);</li><li>}</li></ol></pre></div></div>   </div>   <div></div></div>