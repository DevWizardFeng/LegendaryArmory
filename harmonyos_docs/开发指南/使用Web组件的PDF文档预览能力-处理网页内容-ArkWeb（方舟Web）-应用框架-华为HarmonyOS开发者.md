<h1 _ngcontent-hqv-c119="" class="doc-title ng-star-inserted" title="使用Web组件的PDF文档预览能力"> 使用Web组件的PDF文档预览能力 </h1>

<div _ngcontent-hqv-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-basic-components-web" target="_blank">Web组件</a>支持在网页中预览PDF。应用通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-basic-components-web-i#weboptions" target="_blank">WebOptions</a>的src参数和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-webview-webviewcontroller#loadurl" target="_blank">loadUrl()</a>接口加载PDF文档。具体场景包括：网络PDF文档、应用沙箱内PDF文档和本地PDF文档。</p>    <p>若涉及网络文档获取，需在module.json5中配置网络访问权限。添加方法请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/declare-permissions#在配置文件中声明权限">在配置文件中声明权限</a>。</p>    <div _ngcontent-hqv-c106="" class="highlight-div"><div _ngcontent-hqv-c106="" class="highlight-div-header"><div _ngcontent-hqv-c106="" class="highlight-div-header-left"><div _ngcontent-hqv-c106="" class="handle-button expand-button"><div _ngcontent-hqv-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-hqv-c106="" class="highlight-div-header-right"><div _ngcontent-hqv-c106="" class="handle-button ai-button"></div><div _ngcontent-hqv-c106="" class="handle-button line-button"><div _ngcontent-hqv-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-hqv-c106="" class="handle-button theme-button"><div _ngcontent-hqv-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-hqv-c106="" class="handle-button copy-button"><div _ngcontent-hqv-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-hqv-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-string">"requestPermissions"</span>:[</li><li>    {</li><li>      <span class="hljs-string">"name"</span> : <span class="hljs-string">"ohos.permission.INTERNET"</span></li><li>    }</li><li>  ]</li></ol></pre></div></div>    <div class="tiledSection">     <h2 id="通过不同的方式加载pdf文档">通过不同的方式加载PDF文档<i class="anchor-icon anchor-icon-link" anchorid="通过不同的方式加载pdf文档" tips="复制节点链接"></i></h2>          <p>在下面的示例中，Web组件创建时指定默认加载的网络PDF文档https://www.example.com/test.pdf。使用时需替换为真实可访问地址。</p>     <div _ngcontent-hqv-c106="" class="highlight-div"><div _ngcontent-hqv-c106="" class="highlight-div-header"><div _ngcontent-hqv-c106="" class="highlight-div-header-left"><div _ngcontent-hqv-c106="" class="handle-button expand-button"><div _ngcontent-hqv-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-hqv-c106="" class="highlight-div-header-right"><div _ngcontent-hqv-c106="" class="handle-button ai-button"></div><div _ngcontent-hqv-c106="" class="handle-button line-button"><div _ngcontent-hqv-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-hqv-c106="" class="handle-button theme-button"><div _ngcontent-hqv-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-hqv-c106="" class="handle-button copy-button"><div _ngcontent-hqv-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-hqv-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// xxx.ets</span></li><li><span class="hljs-keyword">import</span> { webview } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkWeb'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">WebComponent</span> {</li><li>  <span class="hljs-attr">controller</span>: webview.<span class="hljs-property">WebviewController</span> = <span class="hljs-keyword">new</span> webview.<span class="hljs-title class_">WebviewController</span>();</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Web</span>({</li><li>          <span class="hljs-attr">src</span>:</li><li>          <span class="hljs-string">"https://www.example.com/test.pdf"</span>,                     <span class="hljs-comment">// 方式一 加载网络PDF文档</span></li><li>          <span class="hljs-comment">// this.getUIContext().getHostContext()!.filesDir + "/test.pdf", // 方式二 加载本地应用沙箱内PDF文档</span></li><li>          <span class="hljs-comment">// "resource://rawfile/test.pdf",                         // 方式三 本地PDF文档 (格式一)</span></li><li>          <span class="hljs-comment">// $rawfile('test.pdf'),                                 // 方式三 本地PDF文档 (格式二)</span></li><li>          <span class="hljs-attr">controller</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span></li><li>      })</li><li>        .<span class="hljs-title function_">domStorageAccess</span>(<span class="hljs-literal">true</span>)</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>     <p>PDF预览页面会根据用户操作使用window.localStorage记录侧导航栏的展开状态，因此需要开启文档对象模型存储<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-basic-components-web-attributes#domstorageaccess" target="_blank">domStorageAccess</a>权限:</p>     <div _ngcontent-hqv-c106="" class="highlight-div"><div _ngcontent-hqv-c106="" class="highlight-div-header"><div _ngcontent-hqv-c106="" class="highlight-div-header-left"><div _ngcontent-hqv-c106="" class="handle-button expand-button"><div _ngcontent-hqv-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-hqv-c106="" class="highlight-div-header-right"><div _ngcontent-hqv-c106="" class="handle-button ai-button"></div><div _ngcontent-hqv-c106="" class="handle-button line-button"><div _ngcontent-hqv-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-hqv-c106="" class="handle-button theme-button"><div _ngcontent-hqv-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-hqv-c106="" class="handle-button copy-button"><div _ngcontent-hqv-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-hqv-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-title class_">Web</span>().<span class="hljs-title function_">domStorageAccess</span>(<span class="hljs-literal">true</span>)</li></ol></pre></div></div>     <p>在创建<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-basic-components-web" target="_blank">Web组件</a>时，指定默认加载的PDF文档。默认PDF文档加载完成后，若需变更Web组件显示的PDF文档，通过调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-webview-webviewcontroller#loadurl" target="_blank">loadUrl()</a>接口加载指定的PDF文档。<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-basic-components-web-i#weboptions" target="_blank">WebOptions</a>的第一个参数变量src不能通过状态变量（例如：@State）动态更改地址，如需更改，请通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-webview-webviewcontroller#loadurl" target="_blank">loadUrl()</a>重新加载。</p>     <p>包含三种PDF文档加载预览场景：</p>     <ul>      <li>       <p>预览加载网络PDF文档。</p>       <div _ngcontent-hqv-c106="" class="highlight-div"><div _ngcontent-hqv-c106="" class="highlight-div-header"><div _ngcontent-hqv-c106="" class="highlight-div-header-left"><div _ngcontent-hqv-c106="" class="handle-button expand-button"><div _ngcontent-hqv-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-hqv-c106="" class="highlight-div-header-right"><div _ngcontent-hqv-c106="" class="handle-button ai-button"></div><div _ngcontent-hqv-c106="" class="handle-button line-button"><div _ngcontent-hqv-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-hqv-c106="" class="handle-button theme-button"><div _ngcontent-hqv-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-hqv-c106="" class="handle-button copy-button"><div _ngcontent-hqv-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-hqv-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-title class_">Web</span>({</li><li>  <span class="hljs-attr">src</span>: <span class="hljs-string">"https://www.example.com/test.pdf"</span>,</li><li>  <span class="hljs-attr">controller</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span></li><li>})</li><li>  .<span class="hljs-title function_">domStorageAccess</span>(<span class="hljs-literal">true</span>)</li></ol></pre></div></div></li>      <li>       <p>预览加载应用沙箱内PDF文档需要开启文件系统的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-basic-components-web-attributes#fileaccess" target="_blank">fileAccess</a>权限。</p>       <div _ngcontent-hqv-c106="" class="highlight-div"><div _ngcontent-hqv-c106="" class="highlight-div-header"><div _ngcontent-hqv-c106="" class="highlight-div-header-left"><div _ngcontent-hqv-c106="" class="handle-button expand-button"><div _ngcontent-hqv-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-hqv-c106="" class="highlight-div-header-right"><div _ngcontent-hqv-c106="" class="handle-button ai-button"></div><div _ngcontent-hqv-c106="" class="handle-button line-button"><div _ngcontent-hqv-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-hqv-c106="" class="handle-button theme-button"><div _ngcontent-hqv-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-hqv-c106="" class="handle-button copy-button"><div _ngcontent-hqv-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-hqv-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-title class_">Web</span>({</li><li>  <span class="hljs-attr">src</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>()!.<span class="hljs-property">filesDir</span> + <span class="hljs-string">"/test.pdf"</span>,</li><li>  <span class="hljs-attr">controller</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span></li><li>})</li><li>  .<span class="hljs-title function_">domStorageAccess</span>(<span class="hljs-literal">true</span>)</li><li>  .<span class="hljs-title function_">fileAccess</span>(<span class="hljs-literal">true</span>)</li></ol></pre></div></div></li>      <li>       <p>预览加载本地PDF文档。</p>       <div _ngcontent-hqv-c106="" class="highlight-div"><div _ngcontent-hqv-c106="" class="highlight-div-header"><div _ngcontent-hqv-c106="" class="highlight-div-header-left"><div _ngcontent-hqv-c106="" class="handle-button expand-button"><div _ngcontent-hqv-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-hqv-c106="" class="highlight-div-header-right"><div _ngcontent-hqv-c106="" class="handle-button ai-button"></div><div _ngcontent-hqv-c106="" class="handle-button line-button"><div _ngcontent-hqv-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-hqv-c106="" class="handle-button theme-button"><div _ngcontent-hqv-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-hqv-c106="" class="handle-button copy-button"><div _ngcontent-hqv-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-hqv-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-title class_">Web</span>({</li><li>  <span class="hljs-attr">src</span>: <span class="hljs-string">"resource://rawfile/test.pdf"</span>,            <span class="hljs-comment">// 格式一 加载本地PDF文档</span></li><li>  <span class="hljs-comment">// src: $rawfile('test.pdf'),                  // 格式二 加载本地PDF文档</span></li><li>  <span class="hljs-attr">controller</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span></li><li>})</li><li>  .<span class="hljs-title function_">domStorageAccess</span>(<span class="hljs-literal">true</span>)</li></ol></pre></div></div></li>     </ul>    </div>    <div class="tiledSection">     <h2 id="通过配置pdf文件预览参数控制打开预览时页面状态">通过配置PDF文件预览参数，控制打开预览时页面状态<i class="anchor-icon anchor-icon-link" anchorid="通过配置pdf文件预览参数控制打开预览时页面状态" tips="复制节点链接"></i></h2>          <p>当前支持如下参数:</p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.5.3.1.3.1.1" valign="top" width="50%">语法</th>         <th align="left" class="cellrowborder" id="mcps1.3.5.3.1.3.1.2" valign="top" width="50%">描述</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="50%">nameddest=destination</td>         <td class="cellrowborder" valign="top" width="50%">指定PDF文档中的命名目标。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">page=pagenum</td>         <td class="cellrowborder" valign="top" width="50%">使用整数指定文档中的页码，文档第一页的pagenum值为1。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">zoom=scale zoom=scale,left,top</td>         <td class="cellrowborder" valign="top" width="50%">使用浮点或整数值设置缩放和滚动系数。例如：缩放值100表示缩放值为100%。 向左和向上滚动值位于坐标系中，0,0 表示可见页面的左上角，无论文档如何旋转。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">toolbar=1 | 0</td>         <td class="cellrowborder" valign="top" width="50%">打开或关闭顶部工具栏。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">navpanes=1 | 0</td>         <td class="cellrowborder" valign="top" width="50%">打开或关闭侧边导航窗格。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">pdfbackgroundcolor=color</td>         <td class="cellrowborder" valign="top" width="50%">从HarmonyOS 6.0系统版本开始，支持指定PDF文档背景色，color为标准的六位十六进制RGB（取值范围为000000~ffffff，例如白色为：ffffff）。</td>        </tr>             </tbody></table></div>     </div>     <p>URL示例:</p>     <div _ngcontent-hqv-c106="" class="highlight-div"><div _ngcontent-hqv-c106="" class="highlight-div-header"><div _ngcontent-hqv-c106="" class="highlight-div-header-left"><div _ngcontent-hqv-c106="" class="handle-button expand-button"><div _ngcontent-hqv-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-hqv-c106="" class="highlight-div-header-right"><div _ngcontent-hqv-c106="" class="handle-button ai-button"></div><div _ngcontent-hqv-c106="" class="handle-button line-button"><div _ngcontent-hqv-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-hqv-c106="" class="handle-button theme-button"><div _ngcontent-hqv-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-hqv-c106="" class="handle-button copy-button"><div _ngcontent-hqv-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-hqv-c106="" class="highlight-scroll-div"><pre class="txt prettyprint linenums hljs language-plaintext" hw-language="txt" data-highlighted="yes"><ol class="linenums"><li>https://example.com/test.pdf#nameddest=Chapter6</li><li>https://example.com/test.pdf#page=3</li><li>https://example.com/test.pdf#zoom=50</li><li>https://example.com/test.pdf#page=3&amp;zoom=200,250,100</li><li>https://example.com/test.pdf#toolbar=0</li><li>https://example.com/test.pdf#navpanes=0</li><li>https://example.com/test.pdf#pdfbackgroundcolor=ffffff</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="pdf文档预览回调功能">PDF文档预览回调功能<i class="anchor-icon anchor-icon-link" anchorid="pdf文档预览回调功能" tips="复制节点链接"></i></h2>          <p>从API version 20开始，PDF文档预览支持两种回调功能：加载成功/失败回调和滚动预览到底回调。</p>     <p>在下面的示例中，Web组件创建时指定默认加载的网络PDF文档https://www.example.com/test.pdf。使用时需替换为真实可访问地址。</p>     <ul>      <li>       <p>加载成功/失败回调。</p>       <div _ngcontent-hqv-c106="" class="highlight-div"><div _ngcontent-hqv-c106="" class="highlight-div-header"><div _ngcontent-hqv-c106="" class="highlight-div-header-left"><div _ngcontent-hqv-c106="" class="handle-button expand-button"><div _ngcontent-hqv-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-hqv-c106="" class="highlight-div-header-right"><div _ngcontent-hqv-c106="" class="handle-button ai-button"></div><div _ngcontent-hqv-c106="" class="handle-button line-button"><div _ngcontent-hqv-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-hqv-c106="" class="handle-button theme-button"><div _ngcontent-hqv-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-hqv-c106="" class="handle-button copy-button"><div _ngcontent-hqv-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-hqv-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-title class_">Web</span>({</li><li>  <span class="hljs-attr">src</span>: <span class="hljs-string">'https://www.example.com/test.pdf'</span>,</li><li>  <span class="hljs-attr">controller</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span></li><li>})</li><li>  .<span class="hljs-title function_">onPdfLoadEvent</span>(</li><li>    <span class="hljs-function">(<span class="hljs-params">eventInfo: OnPdfLoadEvent</span>) =&gt;</span> {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`Load event callback called. url: <span class="hljs-subst">${eventInfo.url}</span>, result: <span class="hljs-subst">${eventInfo.result}</span>.`</span>)</li><li>    }</li><li>  )</li></ol></pre></div></div></li>      <li>       <p>滚动预览到底回调。</p>       <div _ngcontent-hqv-c106="" class="highlight-div"><div _ngcontent-hqv-c106="" class="highlight-div-header"><div _ngcontent-hqv-c106="" class="highlight-div-header-left"><div _ngcontent-hqv-c106="" class="handle-button expand-button"><div _ngcontent-hqv-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-hqv-c106="" class="highlight-div-header-right"><div _ngcontent-hqv-c106="" class="handle-button ai-button"></div><div _ngcontent-hqv-c106="" class="handle-button line-button"><div _ngcontent-hqv-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-hqv-c106="" class="handle-button theme-button"><div _ngcontent-hqv-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-hqv-c106="" class="handle-button copy-button"><div _ngcontent-hqv-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-hqv-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-title class_">Web</span>({</li><li>  <span class="hljs-attr">src</span>: <span class="hljs-string">'https://www.example.com/test.pdf'</span>,</li><li>  <span class="hljs-attr">controller</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span></li><li>})</li><li>  .<span class="hljs-title function_">onPdfScrollAtBottom</span>(</li><li>    <span class="hljs-function">(<span class="hljs-params">eventInfo: OnPdfScrollEvent</span>) =&gt;</span> {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`Scroll at bottom callback called. url: <span class="hljs-subst">${eventInfo.url}</span>.`</span>)</li><li>    }</li><li>  )</li></ol></pre></div></div></li>     </ul>    </div>    <div class="tiledSection">     <h2 id="示例代码">示例代码<i class="anchor-icon anchor-icon-link" anchorid="示例代码" tips="复制节点链接"></i></h2>          <ul>      <li><a href="https://gitcode.com/harmonyos_samples/web-pdfviewer" target="_blank">Web组件预览PDF文件</a></li>     </ul>    </div>   </div>   <div></div></div>