<h1 _ngcontent-jpf-c119="" class="doc-title ng-star-inserted" title="使用Web组件的智能分词能力"> 使用Web组件的智能分词能力 </h1>

<div _ngcontent-jpf-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p>从API version 20开始，ArkWeb提供了H5页面内的文本分词识别功能，支持文本分词高亮、分词长按预览及文本选择菜单扩展等。这些功能需将<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-basic-components-web-attributes#enabledatadetector20" target="_blank">enableDataDetector</a>设置为true，默认为false。</p>    <p>此功能主要用于单页H5页面内容的实体识别，能够自动识别页面中的电话号码、网址等信息，并提供便捷的交互操作。启用此功能后，用户可以直接在页面中与识别的实体交互，如点击电话号码进行呼叫，点击地址在地图中查看，从而提升用户体验。</p>    <p>可识别的实体类型包括电话、链接、邮箱、地址和时间，详见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-text-common#textdatadetectortype11枚举说明" target="_blank">TextDataDetectorType</a>。</p>    <div class="tiledSection">     <h2 id="文本分词高亮">文本分词高亮<i class="anchor-icon anchor-icon-link" anchorid="文本分词高亮" tips="复制节点链接"></i></h2>          <p>Web组件内的H5页面加载完成后，自动识别并高亮标注页面内的特殊实体。页面变化后新出现的实体不会被高亮标注。</p>     <p>特殊实体的高亮过滤规则如下：</p>     <ul>      <li>不处理输入框内、可编辑区域内的文本实体。</li>      <li>不处理&lt;a&gt;&lt;/a&gt;标签内的文本实体。</li>      <li>不处理跨域iframe内、两层及以上嵌套iframe内的文本实体。</li>      <li>跨节点的实体不会被高亮，如&lt;p&gt;星&lt;span&gt;期六&lt;/span&gt;&lt;/p&gt;。</li>     </ul>     <p>页面中文本实体高亮后，将转变为超链接形式。触摸点击或鼠标左键点击实体，会根据实体类型弹出操作菜单。</p>     <div _ngcontent-jpf-c106="" class="highlight-div"><div _ngcontent-jpf-c106="" class="highlight-div-header"><div _ngcontent-jpf-c106="" class="highlight-div-header-left"><div _ngcontent-jpf-c106="" class="handle-button expand-button"><div _ngcontent-jpf-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jpf-c106="" class="highlight-div-header-right"><div _ngcontent-jpf-c106="" class="handle-button ai-button"></div><div _ngcontent-jpf-c106="" class="handle-button line-button"><div _ngcontent-jpf-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jpf-c106="" class="handle-button theme-button"><div _ngcontent-jpf-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jpf-c106="" class="handle-button copy-button"><div _ngcontent-jpf-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jpf-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// xxx.ets</span></li><li><span class="hljs-keyword">import</span> { webview } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkWeb'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'Hello World'</span>;</li><li>  <span class="hljs-attr">webController</span>: webview.<span class="hljs-property">WebviewController</span> = <span class="hljs-keyword">new</span> webview.<span class="hljs-title class_">WebviewController</span>();</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Row</span>() {</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">'Refresh'</span>)</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">webController</span>.<span class="hljs-title function_">refresh</span>();</li><li>          })</li><li>      }</li><li>
</li><li>      <span class="hljs-title class_">Web</span>({</li><li>        <span class="hljs-attr">src</span>: $rawfile(<span class="hljs-string">'index.html'</span>),</li><li>        <span class="hljs-attr">controller</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">webController</span></li><li>      })</li><li>        .<span class="hljs-title function_">enableDataDetector</span>(<span class="hljs-literal">true</span>)</li><li>        .<span class="hljs-title function_">dataDetectorConfig</span>({</li><li>          <span class="hljs-attr">types</span>: []  <span class="hljs-comment">// 实体识别类型，为空则识别所有类型</span></li><li>        })</li><li>    }</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div>     <p>加载的html文件。</p>     <div _ngcontent-jpf-c106="" class="highlight-div"><div _ngcontent-jpf-c106="" class="highlight-div-header"><div _ngcontent-jpf-c106="" class="highlight-div-header-left"><div _ngcontent-jpf-c106="" class="handle-button expand-button"><div _ngcontent-jpf-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jpf-c106="" class="highlight-div-header-right"><div _ngcontent-jpf-c106="" class="handle-button ai-button"></div><div _ngcontent-jpf-c106="" class="handle-button line-button"><div _ngcontent-jpf-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jpf-c106="" class="handle-button theme-button"><div _ngcontent-jpf-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jpf-c106="" class="handle-button copy-button"><div _ngcontent-jpf-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jpf-c106="" class="highlight-scroll-div"><pre class="html prettyprint linenums hljs language-xml" hw-language="html" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">&lt;!-- index.html --&gt;</span></li><li><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span></li><li><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span></li><li><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span></li><li>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Test<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span></li><li>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>&gt;</span></li><li><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span></li><li><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span></li><li>    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>电话：400-123-4567<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></li><li>    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>邮箱：test@example.com<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></li><li>    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>网址：https://www.example.com/<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></li><li>    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>日期：2025.06.01<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></li><li>    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>地址：北京市海淀区中关村<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></li><li>    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>不会高亮的星<span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>期六<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>与会高亮的星期六<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></li><li><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></li><li><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></li></ol></pre></div></div>     <p>点击实体文本，弹出对应的操作菜单，如下图。</p>     <p><span><img originheight="360" originwidth="381" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114745.63936772230216841460871514699063:50001231000000:2800:03649E628BCE7637782CADBB5A8C78D194328A2BDF749E003002F2D00778B999.gif" width="381" height="360"></span></p>     <p>鼠标右键点击、鼠标拖拽将触发超链接的默认行为。</p>     <p>接口<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-basic-components-web-attributes#datadetectorconfig20" target="_blank">dataDetectorConfig</a>未被使用，或其参数<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-text-common#textdatadetectorconfig11对象说明" target="_blank">TextDataDetectorConfig</a>的enablePreviewMenu设置为false时，长按、拖拽将触发超链接的默认行为，如下图。</p>     <p><span><img originheight="304" originwidth="381" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114745.59776729283606977686783347939938:50001231000000:2800:999AE507F7A32C9AB2DF83697560CCBD348B049038DC804EDAD557DF12755971.gif" width="381" height="304"></span></p>     <p>页面文本元素的计算样式存在user-select:none时，实体菜单中“选择文本”的选项无效，但在<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-basic-components-web-attributes#copyoptions11" target="_blank">copyOptions</a>不为CopyOptions.None时，仍可以复制实体文本。</p>    </div>    <div class="tiledSection">     <h2 id="分词长按预览">分词长按预览<i class="anchor-icon anchor-icon-link" anchorid="分词长按预览" tips="复制节点链接"></i></h2>          <p>使用分词长按预览功能时，需要额外配置<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-basic-components-web-attributes#datadetectorconfig20" target="_blank">dataDetectorConfig</a>：</p>     <div _ngcontent-jpf-c106="" class="highlight-div"><div _ngcontent-jpf-c106="" class="highlight-div-header"><div _ngcontent-jpf-c106="" class="highlight-div-header-left"><div _ngcontent-jpf-c106="" class="handle-button expand-button"><div _ngcontent-jpf-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jpf-c106="" class="highlight-div-header-right"><div _ngcontent-jpf-c106="" class="handle-button ai-button"></div><div _ngcontent-jpf-c106="" class="handle-button line-button"><div _ngcontent-jpf-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jpf-c106="" class="handle-button theme-button"><div _ngcontent-jpf-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jpf-c106="" class="handle-button copy-button"><div _ngcontent-jpf-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jpf-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-title class_">Web</span>({</li><li>  <span class="hljs-attr">src</span>: $rawfile(<span class="hljs-string">'index.html'</span>),</li><li>  <span class="hljs-attr">controller</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">webController</span></li><li>})</li><li>  .<span class="hljs-title function_">enableDataDetector</span>(<span class="hljs-literal">true</span>)</li><li>  .<span class="hljs-title function_">dataDetectorConfig</span>({</li><li>    <span class="hljs-attr">enablePreviewMenu</span>: <span class="hljs-literal">true</span>,  <span class="hljs-comment">// 配置分词长按预览功能</span></li><li>    <span class="hljs-attr">types</span>: []</li><li>  })</li></ol></pre></div></div>     <p>在<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-basic-components-web-attributes#copyoptions11" target="_blank">copyOptions</a>不为CopyOptions.None时，长按被高亮的实体文本，会弹出预览菜单，如下图。</p>     <p><span><img originheight="304" originwidth="381" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114745.37087267324559633251064300327422:50001231000000:2800:A83220058B1584D25CD709CE5801BA068EBAABE813157CCECC4A1EE73044B4B7.gif" width="381" height="304"></span></p>     <p>通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-basic-components-web-attributes#bindselectionmenu13" target="_blank">bindSelectionMenu</a>绑定的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/web_menu#自定义菜单">自定义菜单</a>与分词长按预览菜单互不影响。长按被高亮的分词超链接不会弹出自定义超链接菜单，长按普通超链接也不会弹出分词预览菜单。</p>    </div>    <div class="tiledSection">     <h2 id="文本选择菜单扩展">文本选择菜单扩展<i class="anchor-icon anchor-icon-link" anchorid="文本选择菜单扩展" tips="复制节点链接"></i></h2>          <p>在非编辑区域中，选中的文本满足以下条件时，文本选择菜单将展示对应的AI菜单选项：</p>     <ul>      <li>选中文本经过UTF-8编码转换后，其字节长度不超过255字节。</li>      <li>选中文本中仅包含一个匹配识别类型的实体词（可通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-basic-components-web-attributes#datadetectorconfig20" target="_blank">dataDetectorConfig</a>配置支持的识别类型）。</li>      <li>不处于“全选”操作状态下的文本。</li>     </ul>     <p><span><img originheight="304" originwidth="381" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114746.18059933687872370948470961463158:50001231000000:2800:7DA348CEC5BC44BE07EFBE8BD52DC2F9F9FC7D31827AD9EBE1F12C5235B89A92.gif" width="381" height="304"></span></p>     <p>AI菜单项的出现与是否选中高亮的实体文本无关，只要满足上述条件，AI菜单项就会显示。</p>    </div>   </div>   <div></div></div>