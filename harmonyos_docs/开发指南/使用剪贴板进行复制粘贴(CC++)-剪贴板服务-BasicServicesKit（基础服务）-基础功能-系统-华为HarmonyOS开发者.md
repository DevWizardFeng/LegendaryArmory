<h1 _ngcontent-nkw-c119="" class="doc-title ng-star-inserted" title="使用剪贴板进行复制粘贴 (C/C++)"> 使用剪贴板进行复制粘贴 (C/C++) </h1>

<div _ngcontent-nkw-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <div class="tiledSection">     <h2 id="场景介绍">场景介绍<i class="anchor-icon anchor-icon-link" anchorid="场景介绍" tips="复制节点链接"></i></h2>          <p>剪贴板为开发者提供数据的复制粘贴能力。支持对纯文本、超文本、URI等内容的操作。</p>    </div>    <div class="tiledSection">     <h2 id="基本概念">基本概念<i class="anchor-icon anchor-icon-link" anchorid="基本概念" tips="复制节点链接"></i></h2>          <ul>      <li><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-pasteboard-oh-pasteboardobserver" target="_blank"><strong>OH_PasteboardObserver</strong></a>：剪贴板数据变更观察者对象，用以监听剪贴板数据变更事件。</li>      <li><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-pasteboard-oh-pasteboard" target="_blank"><strong>OH_Pasteboard</strong></a>：剪贴板对象，用来进行查询、写入等操作。</li>      <li><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-udmf-oh-udmfdata" target="_blank"><strong>OH_UdmfData</strong></a>：统一数据对象。</li>     </ul>    </div>    <div class="tiledSection">     <h2 id="约束限制">约束限制<i class="anchor-icon anchor-icon-link" anchorid="约束限制" tips="复制节点链接"></i></h2>          <ul>      <li>剪贴板内容包含剪贴板系统服务元数据和应用设置的数据，总大小上限默认为128MB，PC/2in1设备可通过系统配置修改上限，有效范围为128MB~2GB。</li>      <li>为保证剪贴板数据的准确性，同一时间只能支持一个复制操作。</li>      <li>当前支持的数据类型：纯文本类型(OH_UdsPlainText)、超文本标记语言类型(OH_UdsHtml)、文件Uri类型(OH_UdsFileUri)、像素图片类型(OH_UdsPixelMap)、超链接类型(OH_UdsHyperlink)、桌面图标类型(OH_UdsAppItem)、自定义类型。ArkTS接口与NDK接口支持数据类型不完全一致，使用时须匹配接口支持类型，详情见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/use-pasteboard-to-copy-and-paste">ArkTS接口与NDK接口数据类型对应关系</a>。</li>      <li>自定义类型数据在复制粘贴时，指定的类型名称不能和已有的类型名称重复。</li>      <li>API version 12及之后，系统为提升用户隐私安全保护能力，剪贴板读取接口增加<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/get-pastedata-permission-guidelines">权限管控</a>。</li>      <li>API version 12中新增的复制、粘贴接口<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-pasteboard#setunifieddata12" target="_blank">setUnifiedData</a>/<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-pasteboard#getunifieddata12" target="_blank">getUnifiedData</a>与本文档中的复制、粘贴接口<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-oh-pasteboard-h#oh_pasteboard_setdata" target="_blank">OH_Pasteboard_SetData</a>/<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-oh-pasteboard-h#oh_pasteboard_getdata" target="_blank">OH_Pasteboard_GetData</a>当前相互独立，进行写入、读取操作时请使用对应配套接口。</li>     </ul>    </div>    <div class="tiledSection">     <h2 id="接口说明">接口说明<i class="anchor-icon anchor-icon-link" anchorid="接口说明" tips="复制节点链接"></i></h2>          <p>详细接口见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-pasteboard" target="_blank">Pasteboard文档</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.4.3.1.3.1.1" valign="top" width="50%">接口名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.4.3.1.3.1.2" valign="top" width="50%">描述</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="50%">OH_PasteboardObserver* OH_PasteboardObserver_Create()</td>         <td class="cellrowborder" valign="top" width="50%">创建一个剪贴板数据变更观察者对象。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">OH_PasteboardObserver_Destroy(OH_PasteboardObserver* observer)</td>         <td class="cellrowborder" valign="top" width="50%">销毁剪贴板数据变更观察者对象。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">int OH_PasteboardObserver_SetData(OH_PasteboardObserver* observer, void* context, const Pasteboard_Notify callback, const Pasteboard_Finalize finalize)</td>         <td class="cellrowborder" valign="top" width="50%">将剪贴板变更回调函数设置到剪贴板数据变更观察者对象中。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">OH_Pasteboard* OH_Pasteboard_Create()</td>         <td class="cellrowborder" valign="top" width="50%">创建一个剪贴板实例。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">void OH_Pasteboard_Destroy(OH_Pasteboard* pasteboard)</td>         <td class="cellrowborder" valign="top" width="50%">销毁剪贴板实例。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">int OH_Pasteboard_Subscribe(OH_Pasteboard* pasteboard, int type, const OH_PasteboardObserver* observer)</td>         <td class="cellrowborder" valign="top" width="50%">订阅剪贴板的数据变更。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">int OH_Pasteboard_Unsubscribe(OH_Pasteboard* pasteboard, int type, const OH_PasteboardObserver* observer)</td>         <td class="cellrowborder" valign="top" width="50%">取消对剪贴板数据变更的订阅。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">bool OH_Pasteboard_IsRemoteData(OH_Pasteboard* pasteboard)</td>         <td class="cellrowborder" valign="top" width="50%">判断剪贴板中的数据是否来自远端设备。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">int OH_Pasteboard_GetDataSource(OH_Pasteboard* pasteboard, char* source, unsigned int len)</td>         <td class="cellrowborder" valign="top" width="50%">获取剪贴板中数据的数据源。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">bool OH_Pasteboard_HasType(OH_Pasteboard* pasteboard, const char* type)</td>         <td class="cellrowborder" valign="top" width="50%">判断剪贴板中是否有指定类型的数据。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">bool OH_Pasteboard_HasData(OH_Pasteboard* pasteboard)</td>         <td class="cellrowborder" valign="top" width="50%">检查剪贴板中是否有数据。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">OH_UdmfData* OH_Pasteboard_GetData(OH_Pasteboard* pasteboard, int* status)</td>         <td class="cellrowborder" valign="top" width="50%">获取剪贴板中的数据。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">int OH_Pasteboard_SetData(OH_Pasteboard* pasteboard, OH_UdmfData* data)</td>         <td class="cellrowborder" valign="top" width="50%">向剪贴板中写入数据。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">int OH_Pasteboard_ClearData(OH_Pasteboard* pasteboard)</td>         <td class="cellrowborder" valign="top" width="50%">清空剪贴板中的数据。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">void (*Pasteboard_Notify)(void* context, Pasteboard_NotifyType type)</td>         <td class="cellrowborder" valign="top" width="50%">剪贴板中数据变更回调函数。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">void (*Pasteboard_Finalize)(void* context)</td>         <td class="cellrowborder" valign="top" width="50%">剪贴板数据变更观察者对象销毁时，释放context上下文资源。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="开发步骤">开发步骤<i class="anchor-icon anchor-icon-link" anchorid="开发步骤" tips="复制节点链接"></i></h2>          <ol>      <li>       <p>添加动态链接库。</p>       <div _ngcontent-nkw-c106="" class="highlight-div"><div _ngcontent-nkw-c106="" class="highlight-div-header"><div _ngcontent-nkw-c106="" class="highlight-div-header-left"><div _ngcontent-nkw-c106="" class="handle-button expand-button"><div _ngcontent-nkw-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-nkw-c106="" class="highlight-div-header-right"><div _ngcontent-nkw-c106="" class="handle-button ai-button"></div><div _ngcontent-nkw-c106="" class="handle-button line-button"><div _ngcontent-nkw-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-nkw-c106="" class="handle-button theme-button"><div _ngcontent-nkw-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-nkw-c106="" class="handle-button copy-button"><div _ngcontent-nkw-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-nkw-c106="" class="highlight-scroll-div"><pre class="CMake prettyprint linenums hljs language-bash" hw-language="CMake" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment"># CMakeLists.txt中添加以下lib</span></li><li>libudmf.so</li><li>libpasteboard.so</li></ol></pre></div></div></li>      <li>       <p>引用头文件。</p>       <div _ngcontent-nkw-c106="" class="highlight-div"><div _ngcontent-nkw-c106="" class="highlight-div-header"><div _ngcontent-nkw-c106="" class="highlight-div-header-left"><div _ngcontent-nkw-c106="" class="handle-button expand-button"><div _ngcontent-nkw-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-nkw-c106="" class="highlight-div-header-right"><div _ngcontent-nkw-c106="" class="handle-button ai-button"></div><div _ngcontent-nkw-c106="" class="handle-button line-button"><div _ngcontent-nkw-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-nkw-c106="" class="handle-button theme-button"><div _ngcontent-nkw-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-nkw-c106="" class="handle-button copy-button"><div _ngcontent-nkw-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-nkw-c106="" class="highlight-scroll-div"><pre class="c prettyprint linenums hljs language-c" hw-language="c" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstdio&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstring&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;hilog/log.h&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;database/pasteboard/oh_pasteboard.h&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;database/udmf/udmf.h&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;database/udmf/uds.h&gt;</span></span></li></ol></pre></div></div></li>      <li>       <p>定义剪贴板变化监听的回调函数。</p>       <div _ngcontent-nkw-c106="" class="highlight-div"><div _ngcontent-nkw-c106="" class="highlight-div-header"><div _ngcontent-nkw-c106="" class="highlight-div-header-left"><div _ngcontent-nkw-c106="" class="handle-button expand-button"><div _ngcontent-nkw-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-nkw-c106="" class="highlight-div-header-right"><div _ngcontent-nkw-c106="" class="handle-button ai-button"></div><div _ngcontent-nkw-c106="" class="handle-button line-button"><div _ngcontent-nkw-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-nkw-c106="" class="handle-button theme-button"><div _ngcontent-nkw-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-nkw-c106="" class="handle-button copy-button"><div _ngcontent-nkw-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-nkw-c106="" class="highlight-scroll-div"><pre class="c prettyprint linenums hljs language-c" hw-language="c" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 定义剪贴板数据内容变更时的通知回调函数</span></li><li><span class="hljs-type">static</span> <span class="hljs-type">void</span> <span class="hljs-title function_">PasteboardNotifyImpl2</span><span class="hljs-params">(<span class="hljs-type">void</span>* context, Pasteboard_NotifyType type)</span></li><li>{</li><li>    OH_LOG_INFO(LOG_APP, <span class="hljs-string">"Pasteboard_NotifyType, type: %d"</span>, type);</li><li>}</li><li><span class="hljs-comment">// 定义剪贴板数据变更观察者对象销毁时的通知回调函数</span></li><li><span class="hljs-type">static</span> <span class="hljs-type">void</span> <span class="hljs-title function_">PasteboardFinalizeImpl2</span><span class="hljs-params">(<span class="hljs-type">void</span>* context)</span></li><li>{</li><li>    OH_LOG_INFO(LOG_APP, <span class="hljs-string">"callback: Pasteboard_Finalize"</span>);</li><li>}</li></ol></pre></div></div></li>      <li>       <p>订阅剪贴板变化。</p>       <div _ngcontent-nkw-c106="" class="highlight-div"><div _ngcontent-nkw-c106="" class="highlight-div-header"><div _ngcontent-nkw-c106="" class="highlight-div-header-left"><div _ngcontent-nkw-c106="" class="handle-button expand-button"><div _ngcontent-nkw-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-nkw-c106="" class="highlight-div-header-right"><div _ngcontent-nkw-c106="" class="handle-button ai-button"></div><div _ngcontent-nkw-c106="" class="handle-button line-button"><div _ngcontent-nkw-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-nkw-c106="" class="handle-button theme-button"><div _ngcontent-nkw-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-nkw-c106="" class="handle-button copy-button"><div _ngcontent-nkw-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-nkw-c106="" class="highlight-scroll-div"><pre class="c prettyprint linenums hljs language-c" hw-language="c" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-type">static</span> <span class="hljs-type">void</span> <span class="hljs-title function_">PasteboardTestObserver</span><span class="hljs-params">()</span></li><li>{</li><li>    <span class="hljs-comment">// 1. 创建一个剪贴板实例</span></li><li>    OH_Pasteboard* pasteboard = OH_Pasteboard_Create();</li><li>    <span class="hljs-comment">// 2. 创建一个剪贴板数据变更观察者实例</span></li><li>    OH_PasteboardObserver* observer = OH_PasteboardObserver_Create();</li><li>    <span class="hljs-comment">// 3. 将两个回调函数设置到观察者实例</span></li><li>    OH_PasteboardObserver_SetData(observer, (<span class="hljs-type">void</span>*)pasteboard, PasteboardNotifyImpl2, PasteboardFinalizeImpl2);</li><li>    <span class="hljs-comment">// 4. 设置对剪贴板本端数据变化的订阅</span></li><li>    OH_Pasteboard_Subscribe(pasteboard, NOTIFY_LOCAL_DATA_CHANGE, observer);</li><li>}</li></ol></pre></div></div></li>      <li>       <p>向剪贴板写入数据。</p>       <div _ngcontent-nkw-c106="" class="highlight-div"><div _ngcontent-nkw-c106="" class="highlight-div-header"><div _ngcontent-nkw-c106="" class="highlight-div-header-left"><div _ngcontent-nkw-c106="" class="handle-button expand-button"><div _ngcontent-nkw-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-nkw-c106="" class="highlight-div-header-right"><div _ngcontent-nkw-c106="" class="handle-button ai-button"></div><div _ngcontent-nkw-c106="" class="handle-button line-button"><div _ngcontent-nkw-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-nkw-c106="" class="handle-button theme-button"><div _ngcontent-nkw-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-nkw-c106="" class="handle-button copy-button"><div _ngcontent-nkw-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-nkw-c106="" class="highlight-scroll-div"><pre class="c prettyprint linenums hljs language-c" hw-language="c" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-type">static</span> napi_value <span class="hljs-title function_">NAPI_Pasteboard_set</span><span class="hljs-params">(napi_env env, napi_callback_info info)</span></li><li>{</li><li>    napi_value args[<span class="hljs-number">1</span>];</li><li>    <span class="hljs-type">size_t</span> argc = <span class="hljs-number">1</span>;</li><li>    napi_status status = napi_get_cb_info(env, info, &amp;argc, args, nullptr, nullptr);</li><li>    <span class="hljs-type">char</span> text[<span class="hljs-number">256</span>];</li><li>    <span class="hljs-type">size_t</span> value0Size;</li><li>    status = napi_get_value_string_utf8(env, args[<span class="hljs-number">0</span>], text, <span class="hljs-keyword">sizeof</span>(text), &amp;value0Size);</li><li>    <span class="hljs-comment">// 1. 创建一个剪贴板实例</span></li><li>    OH_Pasteboard* pasteboard = OH_Pasteboard_Create();</li><li>    <span class="hljs-keyword">if</span> (pasteboard == nullptr) {</li><li>        OH_LOG_INFO(LOG_APP, <span class="hljs-string">"Failed to create pasteboard instance."</span>);</li><li>    };</li><li>    <span class="hljs-comment">// 2. 创建OH_UdmfRecord对象，并向OH_UdmfRecord中添加文本类型数据</span></li><li>    OH_UdsPlainText* udsPlainText = OH_UdsPlainText_Create();</li><li>    OH_UdsPlainText_SetContent(udsPlainText, text);</li><li>    OH_UdsHtml* udsHtml = OH_UdsHtml_Create();</li><li>    OH_UdsHtml_SetContent(udsHtml, <span class="hljs-string">"hello world"</span>);</li><li>    OH_UdmfRecord* record = OH_UdmfRecord_Create();</li><li>    OH_UdmfRecord_AddPlainText(record, udsPlainText);</li><li>    OH_UdmfRecord_AddHtml(record, udsHtml);</li><li>    <span class="hljs-comment">// 3. 创建OH_UdmfData对象，并向OH_UdmfData中添加OH_UdmfRecord</span></li><li>    OH_UdmfData* data = OH_UdmfData_Create();</li><li>    OH_UdmfData_AddRecord(data, record);</li><li>    <span class="hljs-comment">// 4. 将数据写入剪贴板</span></li><li>    OH_Pasteboard_SetData(pasteboard, data);</li><li>    <span class="hljs-comment">// 5. 使用完销毁指针</span></li><li>    OH_UdsPlainText_Destroy(udsPlainText);</li><li>    OH_UdsHtml_Destroy(udsHtml);</li><li>    OH_UdmfRecord_Destroy(record);</li><li>    OH_UdmfData_Destroy(data);</li><li>    OH_Pasteboard_Destroy(pasteboard);</li><li>    <span class="hljs-comment">// ...</span></li><li>}</li></ol></pre></div></div></li>      <li>       <p>从剪贴板读取数据。</p>       <div _ngcontent-nkw-c106="" class="highlight-div"><div _ngcontent-nkw-c106="" class="highlight-div-header"><div _ngcontent-nkw-c106="" class="highlight-div-header-left"><div _ngcontent-nkw-c106="" class="handle-button expand-button"><div _ngcontent-nkw-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-nkw-c106="" class="highlight-div-header-right"><div _ngcontent-nkw-c106="" class="handle-button ai-button"></div><div _ngcontent-nkw-c106="" class="handle-button line-button"><div _ngcontent-nkw-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-nkw-c106="" class="handle-button theme-button"><div _ngcontent-nkw-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-nkw-c106="" class="handle-button copy-button"><div _ngcontent-nkw-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-nkw-c106="" class="highlight-scroll-div"><pre class="c prettyprint linenums hljs language-c" hw-language="c" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-type">static</span> napi_value <span class="hljs-title function_">NAPI_Pasteboard_get</span><span class="hljs-params">(napi_env env, napi_callback_info info)</span></li><li>{</li><li>    <span class="hljs-comment">// 1. 创建一个剪贴板实例</span></li><li>    OH_Pasteboard* pasteboard = OH_Pasteboard_Create();</li><li>    <span class="hljs-keyword">if</span> (pasteboard == nullptr) {</li><li>        OH_LOG_INFO(LOG_APP, <span class="hljs-string">"Failed to create pasteboard instance."</span>);</li><li>    };</li><li>    <span class="hljs-comment">// 2. 判断剪贴板中是否有文本类型数据</span></li><li>    <span class="hljs-type">bool</span> hasPlainTextData = OH_Pasteboard_HasType(pasteboard, <span class="hljs-string">"text/plain"</span>);</li><li>    <span class="hljs-keyword">if</span> (hasPlainTextData) {</li><li>        <span class="hljs-comment">// 3. 从剪贴板中获取统一类型数据OH_UdmfData</span></li><li>        <span class="hljs-type">int</span> ret = <span class="hljs-number">0</span>;</li><li>        OH_UdmfData* udmfData = OH_Pasteboard_GetData(pasteboard, &amp;ret);</li><li>        <span class="hljs-keyword">if</span> (udmfData == nullptr) {</li><li>            OH_LOG_INFO(LOG_APP, <span class="hljs-string">"Failed to get data from pasteboard."</span>);</li><li>        };</li><li>        <span class="hljs-comment">// 4. 从OH_UdmfData中获取第一个数据记录</span></li><li>        OH_UdmfRecord* record = OH_UdmfData_GetRecord(udmfData, <span class="hljs-number">0</span>);</li><li>        <span class="hljs-keyword">if</span> (record == nullptr) {</li><li>            OH_LOG_INFO(LOG_APP, <span class="hljs-string">"Failed to get record from udmfData."</span>);</li><li>        };</li><li>        <span class="hljs-comment">// 5. 从数据记录中获取文本数据内容</span></li><li>        OH_UdsPlainText* plainText = OH_UdsPlainText_Create();</li><li>        <span class="hljs-keyword">if</span> (plainText == nullptr) {</li><li>            OH_LOG_INFO(LOG_APP, <span class="hljs-string">"Failed to create plain text object."</span>);</li><li>        };</li><li>        OH_UdmfRecord_GetPlainText(record, plainText);</li><li>        <span class="hljs-type">const</span> <span class="hljs-type">char</span>* content = OH_UdsPlainText_GetContent(plainText);</li><li>        <span class="hljs-keyword">if</span> (content == nullptr) {</li><li>            OH_LOG_INFO(LOG_APP, <span class="hljs-string">"Failed to get content from plain text."</span>);</li><li>        }</li><li>        napi_value result;</li><li>        napi_create_string_utf8(env, content, <span class="hljs-built_in">strlen</span>(content), &amp;result);</li><li>        <span class="hljs-comment">// 6. 使用完销毁指针</span></li><li>        OH_UdsPlainText_Destroy(plainText);</li><li>        OH_UdmfRecord_Destroy(record);</li><li>        <span class="hljs-keyword">return</span> result;</li><li>    } <span class="hljs-keyword">else</span> {</li><li>        OH_LOG_INFO(LOG_APP, <span class="hljs-string">"No plain text data in pasteboard."</span>);</li><li>    }</li><li>    OH_Pasteboard_Destroy(pasteboard);</li><li>}</li></ol></pre></div></div></li>     </ol>    </div>   </div>   <div></div></div>