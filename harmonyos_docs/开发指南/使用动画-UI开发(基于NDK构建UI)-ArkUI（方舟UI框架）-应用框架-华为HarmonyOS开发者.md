<h1 _ngcontent-udy-c119="" class="doc-title ng-star-inserted" title="使用动画"> 使用动画 </h1>

<div _ngcontent-udy-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <div class="tiledSection">     <h2 id="使用属性动画">使用属性动画<i class="anchor-icon anchor-icon-link" anchorid="使用属性动画" tips="复制节点链接"></i></h2>          <p>ArkUI开发框架在NDK接口主要提供属性动画，实现组件出现/消失转场。同时，可以通过Node-API桥接ArkTS侧帧动画能力，实现Native侧的动画效果。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <ul>        <li>         <p>需要从ArkTS侧获取<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-custom-component-api#getuicontext" target="_blank">this.getUIContext()</a>，传入到Native侧。</p></li>        <li>         <p>在Native侧通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-native-node-napi-h" target="_blank">OH_ArkUI_GetContextFromNapiValue</a>方法获取context。</p></li>        <li>         <p>需要执行的动画属性变化必须写在<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-arkui-nativemodule-arkui-contextcallback" target="_blank">ArkUI_ContextCallback</a>中的callback中。</p></li>        <li>         <p>需要执行的动画属性，必须在执行动画之前设置过。</p></li>        <li>         <p>本篇示例仅提供核心接口的调用方法，完整的示例工程请参考<a href="https://gitcode.com/HarmonyOS_Samples/guide-snippets/tree/master/ArkUIKit/AnimationNDK" target="_blank">AnimationNDK</a>。</p></li>       </ul>      </div></div></div>     <p>提供全局animateTo显式动画接口，来指定由于闭包代码导致的状态变化插入过渡动效。同属性动画，布局类改变宽高的动画，内容都是直接到终点状态。</p>     <ol>      <li>       <p>在.ets文件中获取<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-uicontext-uicontext" target="_blank">UIContext</a>，把this.getUIContext()当做参数输出到Native方法中。</p>       <div _ngcontent-udy-c106="" class="highlight-div"><div _ngcontent-udy-c106="" class="highlight-div-header"><div _ngcontent-udy-c106="" class="highlight-div-header-left"><div _ngcontent-udy-c106="" class="handle-button expand-button"><div _ngcontent-udy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-udy-c106="" class="highlight-div-header-right"><div _ngcontent-udy-c106="" class="handle-button ai-button"></div><div _ngcontent-udy-c106="" class="handle-button line-button"><div _ngcontent-udy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-udy-c106="" class="handle-button theme-button"><div _ngcontent-udy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-udy-c106="" class="handle-button copy-button"><div _ngcontent-udy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-udy-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// createNativeNode是Native侧暴露的方法</span></li><li>nativeNode.<span class="hljs-title function_">createNativeNode</span>(<span class="hljs-string">"xcomponentId"</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>());</li></ol></pre></div></div></li>      <li>       <p>解析UIContext转换C中的context对象。</p>       <div _ngcontent-udy-c106="" class="highlight-div"><div _ngcontent-udy-c106="" class="highlight-div-header"><div _ngcontent-udy-c106="" class="highlight-div-header-left"><div _ngcontent-udy-c106="" class="handle-button expand-button"><div _ngcontent-udy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-udy-c106="" class="highlight-div-header-right"><div _ngcontent-udy-c106="" class="handle-button ai-button"></div><div _ngcontent-udy-c106="" class="handle-button line-button"><div _ngcontent-udy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-udy-c106="" class="handle-button theme-button"><div _ngcontent-udy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-udy-c106="" class="handle-button copy-button"><div _ngcontent-udy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-udy-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 获取ets测传入的context</span></li><li>ArkUI_ContextHandle context = <span class="hljs-literal">nullptr</span>;</li><li><span class="hljs-comment">// 通过code 判断是否获取成功</span></li><li><span class="hljs-keyword">auto</span> code = <span class="hljs-built_in">OH_ArkUI_GetContextFromNapiValue</span>(env, args[<span class="hljs-number">1</span>], &amp;context);</li></ol></pre></div></div></li>      <li>       <p>获取ArkUI_NativeAnimateAPI_1 对象。</p>       <div _ngcontent-udy-c106="" class="highlight-div"><div _ngcontent-udy-c106="" class="highlight-div-header"><div _ngcontent-udy-c106="" class="highlight-div-header-left"><div _ngcontent-udy-c106="" class="handle-button expand-button"><div _ngcontent-udy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-udy-c106="" class="highlight-div-header-right"><div _ngcontent-udy-c106="" class="handle-button ai-button"></div><div _ngcontent-udy-c106="" class="handle-button line-button"><div _ngcontent-udy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-udy-c106="" class="handle-button theme-button"><div _ngcontent-udy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-udy-c106="" class="handle-button copy-button"><div _ngcontent-udy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-udy-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 获取ArkUI_NativeAnimateAPI接口</span></li><li>ArkUI_NativeAnimateAPI_1 *animateApi = <span class="hljs-literal">nullptr</span>;</li><li><span class="hljs-built_in">OH_ArkUI_GetModuleInterface</span>(ARKUI_NATIVE_ANIMATE, ArkUI_NativeAnimateAPI_1, animateApi);</li></ol></pre></div></div></li>      <li>       <p>设置 ArkUI_AnimateOption参数，通过提供的C方法设置对应的参数。</p>       <div _ngcontent-udy-c106="" class="highlight-div"><div _ngcontent-udy-c106="" class="highlight-div-header"><div _ngcontent-udy-c106="" class="highlight-div-header-left"><div _ngcontent-udy-c106="" class="handle-button expand-button"><div _ngcontent-udy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-udy-c106="" class="highlight-div-header-right"><div _ngcontent-udy-c106="" class="handle-button ai-button"></div><div _ngcontent-udy-c106="" class="handle-button line-button"><div _ngcontent-udy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-udy-c106="" class="handle-button theme-button"><div _ngcontent-udy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-udy-c106="" class="handle-button copy-button"><div _ngcontent-udy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-udy-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-vbnet" data-highlighted="yes"><ol class="linenums"><li>ArkUI_AnimateOption *<span class="hljs-keyword">option</span> = OH_ArkUI_AnimateOption_Create();</li><li>OH_ArkUI_AnimateOption_SetDuration(<span class="hljs-keyword">option</span>, <span class="hljs-number">2000</span>);</li><li>OH_ArkUI_AnimateOption_SetTempo(<span class="hljs-keyword">option</span>, <span class="hljs-number">1.1</span>);</li><li>OH_ArkUI_AnimateOption_SetCurve(<span class="hljs-keyword">option</span>, ARKUI_CURVE_EASE);</li><li>OH_ArkUI_AnimateOption_SetDelay(<span class="hljs-keyword">option</span>, <span class="hljs-number">20</span>);</li><li>OH_ArkUI_AnimateOption_SetIterations(<span class="hljs-keyword">option</span>, <span class="hljs-number">1</span>);</li><li>OH_ArkUI_AnimateOption_SetPlayMode(<span class="hljs-keyword">option</span>, ARKUI_ANIMATION_PLAY_MODE_REVERSE);</li><li>ArkUI_ExpectedFrameRateRange *range = <span class="hljs-built_in">new</span> ArkUI_ExpectedFrameRateRange;</li><li>range-&gt;min = <span class="hljs-number">10</span>;</li><li>range-&gt;max = <span class="hljs-number">120</span>;</li><li>range-&gt;expected = <span class="hljs-number">60</span>;</li><li>OH_ArkUI_AnimateOption_SetExpectedFrameRateRange(<span class="hljs-keyword">option</span>, range);</li></ol></pre></div></div></li>      <li>       <p>设置回调参数。</p>       <div _ngcontent-udy-c106="" class="highlight-div"><div _ngcontent-udy-c106="" class="highlight-div-header"><div _ngcontent-udy-c106="" class="highlight-div-header-left"><div _ngcontent-udy-c106="" class="handle-button expand-button"><div _ngcontent-udy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-udy-c106="" class="highlight-div-header-right"><div _ngcontent-udy-c106="" class="handle-button ai-button"></div><div _ngcontent-udy-c106="" class="handle-button line-button"><div _ngcontent-udy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-udy-c106="" class="handle-button theme-button"><div _ngcontent-udy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-udy-c106="" class="handle-button copy-button"><div _ngcontent-udy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-udy-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 用户自定义参数</span></li><li><span class="hljs-keyword">struct</span> <span class="hljs-title class_">UserData</span>{</li><li>    <span class="hljs-variable">int32_t</span> <span class="hljs-variable">data</span>;</li><li>};</li><li><span class="hljs-variable">UserData</span> *<span class="hljs-variable">onFinishUser</span> = <span class="hljs-variable">new</span> <span class="hljs-variable">UserData</span>;</li><li><span class="hljs-variable">onFinishUser</span>-&gt;<span class="hljs-title class_">data</span>= <span class="hljs-number">101</span>;</li><li><span class="hljs-comment">// 设置完成的回调</span></li><li><span class="hljs-variable">ArkUI_AnimateCompleteCallback</span> *<span class="hljs-variable">completeCallback</span> = <span class="hljs-variable">new</span> <span class="hljs-variable">ArkUI_AnimateCompleteCallback</span>;</li><li><span class="hljs-variable">completeCallback</span>-&gt;<span class="hljs-title class_">userData</span> = <span class="hljs-variable">onFinishUser</span>;</li><li><span class="hljs-variable">completeCallback</span>-&gt;<span class="hljs-keyword">type</span> = <span class="hljs-variable">ARKUI_FINISH_CALLBACK_REMOVED</span>;</li><li><span class="hljs-variable">completeCallback</span>-&gt;<span class="hljs-title class_">callback</span> = [](<span class="hljs-variable">void</span> *<span class="hljs-variable">userData</span>) {</li><li>    <span class="hljs-title function_">OH_LOG_Print</span>(<span class="hljs-variable">LOG_APP</span>, <span class="hljs-variable">LOG_INFO</span>, <span class="hljs-variable">LOG_PRINT_DOMAIN</span>, <span class="hljs-string">"Manager"</span>, <span class="hljs-string">"CreateNativeNode  onFinishCallback %{public}d"</span>,</li><li>                 <span class="hljs-title class_">reinterpret_cast</span>&lt;<span class="hljs-title class_">AA</span> *&gt;(<span class="hljs-variable">userData</span>)-&gt;<span class="hljs-title class_">a</span>);</li><li>};</li><li><span class="hljs-comment">// 用户自定义参数</span></li><li><span class="hljs-variable">UserData</span> *<span class="hljs-variable">eventUser</span> = <span class="hljs-variable">new</span> <span class="hljs-variable">UserData</span> ;</li><li><span class="hljs-variable">eventUser</span>-&gt;<span class="hljs-title class_">data</span>= <span class="hljs-number">201</span>;</li><li><span class="hljs-keyword">static</span> <span class="hljs-variable">bool</span> <span class="hljs-variable">isback</span> = <span class="hljs-keyword">true</span>;</li><li><span class="hljs-variable">ArkUI_ContextCallback</span> *<span class="hljs-variable">update</span> = <span class="hljs-variable">new</span> <span class="hljs-variable">ArkUI_ContextCallback</span>;</li><li><span class="hljs-variable">update</span>-&gt;<span class="hljs-title class_">userData</span> = <span class="hljs-variable">eventUser</span>;</li><li><span class="hljs-variable">update</span>-&gt;<span class="hljs-title class_">callback</span> = [](<span class="hljs-variable">void</span> *<span class="hljs-variable">user</span>) {</li><li>    <span class="hljs-title function_">OH_LOG_Print</span>(<span class="hljs-variable">LOG_APP</span>, <span class="hljs-variable">LOG_INFO</span>, <span class="hljs-variable">LOG_PRINT_DOMAIN</span>, <span class="hljs-string">"Manager"</span>, <span class="hljs-string">"CreateNativeNode  animateTo %{public}d"</span>,</li><li>                 <span class="hljs-title class_">reinterpret_cast</span>&lt;<span class="hljs-title class_">UserData</span>*&gt;(<span class="hljs-variable">user</span>)-&gt;<span class="hljs-title class_">data</span>);</li><li>    <span class="hljs-comment">// 对应的属性变化 width height</span></li><li>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">isback</span>) {</li><li>        <span class="hljs-variable">ArkUI_NumberValue</span> <span class="hljs-variable">custom_widthValue</span>[] = {<span class="hljs-number">200</span>};</li><li>        <span class="hljs-variable">ArkUI_AttributeItem</span> <span class="hljs-variable">custom_widthItem</span> = {<span class="hljs-variable">custom_widthValue</span>, <span class="hljs-number">1</span>};</li><li>        <span class="hljs-variable">ArkUI_NumberValue</span> <span class="hljs-variable">custom_heightValue1</span>[] = {<span class="hljs-number">80</span>};</li><li>        <span class="hljs-variable">ArkUI_AttributeItem</span> <span class="hljs-variable">custom_heightItem1</span> = {<span class="hljs-variable">custom_heightValue1</span>, <span class="hljs-number">1</span>};</li><li>        <span class="hljs-variable">nodeAPI</span>-&gt;<span class="hljs-title class_">setAttribute</span>(<span class="hljs-title class_">textInput</span>, <span class="hljs-title class_">NODE_WIDTH</span>, &amp;<span class="hljs-title class_">custom_widthItem</span>);</li><li>        <span class="hljs-variable">nodeAPI</span>-&gt;<span class="hljs-title class_">setAttribute</span>(<span class="hljs-title class_">textInput</span>, <span class="hljs-title class_">NODE_HEIGHT</span>, &amp;<span class="hljs-title class_">custom_heightItem1</span>);</li><li>    } <span class="hljs-keyword">else</span> {</li><li>        <span class="hljs-variable">ArkUI_NumberValue</span> <span class="hljs-variable">custom_widthValue</span>[] = {<span class="hljs-number">100</span>};</li><li>        <span class="hljs-variable">ArkUI_AttributeItem</span> <span class="hljs-variable">custom_widthItem</span> = {<span class="hljs-variable">custom_widthValue</span>, <span class="hljs-number">1</span>};</li><li>        <span class="hljs-variable">ArkUI_NumberValue</span> <span class="hljs-variable">custom_heightValue1</span>[] = {<span class="hljs-number">40</span>};</li><li>        <span class="hljs-variable">ArkUI_AttributeItem</span> <span class="hljs-variable">custom_heightItem1</span> = {<span class="hljs-variable">custom_heightValue1</span>, <span class="hljs-number">1</span>};</li><li>        <span class="hljs-variable">nodeAPI</span>-&gt;<span class="hljs-title class_">setAttribute</span>(<span class="hljs-title class_">textInput</span>, <span class="hljs-title class_">NODE_WIDTH</span>, &amp;<span class="hljs-title class_">custom_widthItem</span>);</li><li>        <span class="hljs-variable">nodeAPI</span>-&gt;<span class="hljs-title class_">setAttribute</span>(<span class="hljs-title class_">textInput</span>, <span class="hljs-title class_">NODE_HEIGHT</span>, &amp;<span class="hljs-title class_">custom_heightItem1</span>);</li><li>    }</li><li>};</li><li><span class="hljs-comment">// 执行对应的动画</span></li><li><span class="hljs-variable">animateApi</span>-&gt;<span class="hljs-title class_">animateTo</span>(<span class="hljs-title class_">context</span>, <span class="hljs-title class_">option</span>, <span class="hljs-title class_">update</span>, <span class="hljs-title class_">completeCallback</span>);</li></ol></pre></div></div>       <p><span><img originheight="660" originwidth="479" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114737.79378612190274663930657225272646:50001231000000:2800:80332287714DB6AAF50D85CFA1EFE2E85E64ED11005BD3A9773BD00DAB252197.gif" width="479" height="660"></span></p></li>     </ol>    </div>    <div class="tiledSection">     <h2 id="组件出现消失转场">组件出现/消失转场<i class="anchor-icon anchor-icon-link" anchorid="组件出现消失转场" tips="复制节点链接"></i></h2>          <p>组件内转场通过NODE_XX_TRANSITION属性（XX包括：OPACITY、TRANSLATE、SCALE、ROTATE、MOVE）配置转场参数，在组件插入和删除时显示过渡动效（通过NODE_TRANSFORM_CENTER属性设置NODE_SCALE_TRANSITION和NODE_ROTATE_ROTATE动效的中心点坐标）。主要用于容器组件中子组件插入和删除时，提升用户体验。</p>     <ol>      <li>       <p>创建可交互界面，界面中包含Button，点击可以控制转场节点的添加和移除。其中 ArkUI_NodeContentHandle 类型节点的获取与使用可参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ndk-access-the-arkts-page">接入ArkTS页面</a>。</p>       <div _ngcontent-udy-c106="" class="highlight-div"><div _ngcontent-udy-c106="" class="highlight-div-header"><div _ngcontent-udy-c106="" class="highlight-div-header-left"><div _ngcontent-udy-c106="" class="handle-button expand-button"><div _ngcontent-udy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-udy-c106="" class="highlight-div-header-right"><div _ngcontent-udy-c106="" class="handle-button ai-button"></div><div _ngcontent-udy-c106="" class="handle-button line-button"><div _ngcontent-udy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-udy-c106="" class="handle-button theme-button"><div _ngcontent-udy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-udy-c106="" class="handle-button copy-button"><div _ngcontent-udy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-udy-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-variable">constexpr</span> <span class="hljs-variable">int32_t</span> <span class="hljs-variable">BUTTON_CLICK_ID</span> = <span class="hljs-number">1</span>;</li><li><span class="hljs-variable">bool</span> <span class="hljs-variable">flag</span> = <span class="hljs-keyword">false</span>;</li><li><span class="hljs-variable">ArkUI_NodeHandle</span> <span class="hljs-variable">parentNode</span>;</li><li><span class="hljs-variable">ArkUI_NodeHandle</span> <span class="hljs-variable">childNode</span>;</li><li><span class="hljs-variable">ArkUI_NodeHandle</span> <span class="hljs-variable">buttonNode</span>;</li><li>
</li><li><span class="hljs-variable">void</span> <span class="hljs-title function_">mainViewMethod</span>(<span class="hljs-variable">ArkUI_NodeContentHandle</span> <span class="hljs-variable">handle</span>)</li><li>{</li><li>    <span class="hljs-variable">ArkUI_NativeNodeAPI_1</span> *<span class="hljs-variable">nodeAPI</span> = <span class="hljs-title class_">reinterpret_cast</span>&lt;<span class="hljs-title class_">ArkUI_NativeNodeAPI_1</span> *&gt;(</li><li>        <span class="hljs-title function_">OH_ArkUI_QueryModuleInterfaceByName</span>(<span class="hljs-variable">ARKUI_NATIVE_NODE</span>, <span class="hljs-string">"ArkUI_NativeNodeAPI_1"</span>));</li><li>    <span class="hljs-variable">ArkUI_NodeHandle</span> <span class="hljs-variable">column</span> = <span class="hljs-variable">nodeAPI</span>-&gt;<span class="hljs-title class_">createNode</span>(<span class="hljs-title class_">ARKUI_NODE_COLUMN</span>);</li><li>    <span class="hljs-variable">ArkUI_NumberValue</span> <span class="hljs-variable">widthValue</span>[] = {{.<span class="hljs-variable">f32</span> = <span class="hljs-number">500</span>}};</li><li>    <span class="hljs-variable">ArkUI_AttributeItem</span> <span class="hljs-variable">widthItem</span> = {.<span class="hljs-variable">value</span> = <span class="hljs-variable">widthValue</span>, .<span class="hljs-variable">size</span> = <span class="hljs-title function_">sizeof</span>(<span class="hljs-variable">widthValue</span>) / <span class="hljs-title function_">sizeof</span>(<span class="hljs-variable">ArkUI_NumberValue</span>)};</li><li>    <span class="hljs-variable">nodeAPI</span>-&gt;<span class="hljs-title class_">setAttribute</span>(<span class="hljs-title class_">column</span>, <span class="hljs-title class_">NODE_WIDTH</span>, &amp;<span class="hljs-title class_">widthItem</span>);</li><li>    <span class="hljs-variable">ArkUI_NumberValue</span> <span class="hljs-variable">heightValue</span>[] = {{.<span class="hljs-variable">f32</span> = <span class="hljs-number">500</span>}};</li><li>    <span class="hljs-variable">ArkUI_AttributeItem</span> <span class="hljs-variable">heightItem</span> = {.<span class="hljs-variable">value</span> = <span class="hljs-variable">heightValue</span>, .<span class="hljs-variable">size</span> = <span class="hljs-title function_">sizeof</span>(<span class="hljs-variable">heightValue</span>) / <span class="hljs-title function_">sizeof</span>(<span class="hljs-variable">ArkUI_NumberValue</span>)};</li><li>    <span class="hljs-variable">nodeAPI</span>-&gt;<span class="hljs-title class_">setAttribute</span>(<span class="hljs-title class_">column</span>, <span class="hljs-title class_">NODE_HEIGHT</span>, &amp;<span class="hljs-title class_">heightItem</span>);</li><li>    <span class="hljs-variable">ArkUI_NodeHandle</span> <span class="hljs-variable">buttonShow</span> = <span class="hljs-variable">nodeAPI</span>-&gt;<span class="hljs-title class_">createNode</span>(<span class="hljs-title class_">ARKUI_NODE_BUTTON</span>);</li><li>    <span class="hljs-variable">ArkUI_NumberValue</span> <span class="hljs-variable">buttonWidthValue</span>[] = {{.<span class="hljs-variable">f32</span> = <span class="hljs-number">200</span>}};</li><li>    <span class="hljs-variable">ArkUI_AttributeItem</span> <span class="hljs-variable">buttonWidthItem</span> = {.<span class="hljs-variable">value</span> = <span class="hljs-variable">buttonWidthValue</span>,</li><li>                                           .<span class="hljs-variable">size</span> = <span class="hljs-title function_">sizeof</span>(<span class="hljs-variable">buttonWidthValue</span>) / <span class="hljs-title function_">sizeof</span>(<span class="hljs-variable">ArkUI_NumberValue</span>)};</li><li>    <span class="hljs-variable">nodeAPI</span>-&gt;<span class="hljs-title class_">setAttribute</span>(<span class="hljs-title class_">buttonShow</span>, <span class="hljs-title class_">NODE_WIDTH</span>, &amp;<span class="hljs-title class_">buttonWidthItem</span>);</li><li>    <span class="hljs-variable">ArkUI_NumberValue</span> <span class="hljs-variable">buttonHeightValue</span>[] = {{.<span class="hljs-variable">f32</span> = <span class="hljs-number">50</span>}};</li><li>    <span class="hljs-variable">ArkUI_AttributeItem</span> <span class="hljs-variable">buttonHeightItem</span> = {.<span class="hljs-variable">value</span> = <span class="hljs-variable">buttonHeightValue</span>,</li><li>                                            .<span class="hljs-variable">size</span> = <span class="hljs-title function_">sizeof</span>(<span class="hljs-variable">buttonHeightValue</span>) / <span class="hljs-title function_">sizeof</span>(<span class="hljs-variable">ArkUI_NumberValue</span>)};</li><li>    <span class="hljs-variable">nodeAPI</span>-&gt;<span class="hljs-title class_">setAttribute</span>(<span class="hljs-title class_">buttonShow</span>, <span class="hljs-title class_">NODE_HEIGHT</span>, &amp;<span class="hljs-title class_">buttonHeightItem</span>);</li><li>    <span class="hljs-variable">ArkUI_AttributeItem</span> <span class="hljs-variable">labelItem</span> = {.<span class="hljs-variable">string</span> = <span class="hljs-string">"show"</span>};</li><li>    <span class="hljs-variable">nodeAPI</span>-&gt;<span class="hljs-title class_">setAttribute</span>(<span class="hljs-title class_">buttonShow</span>, <span class="hljs-title class_">NODE_BUTTON_LABEL</span>, &amp;<span class="hljs-title class_">labelItem</span>);</li><li>    <span class="hljs-variable">ArkUI_NumberValue</span> <span class="hljs-variable">buttonOpenTypeValue</span>[] = {{.<span class="hljs-variable">i32</span> = <span class="hljs-title class_">static_cast</span>&lt;<span class="hljs-title class_">int32_t</span>&gt;(<span class="hljs-variable">ARKUI_BUTTON_TYPE_NORMAL</span>)}};</li><li>    <span class="hljs-variable">ArkUI_AttributeItem</span> <span class="hljs-variable">buttonOpenTypeItem</span> = {.<span class="hljs-variable">value</span> = <span class="hljs-variable">buttonOpenTypeValue</span>,</li><li>                                              .<span class="hljs-variable">size</span> = <span class="hljs-title function_">sizeof</span>(<span class="hljs-variable">buttonOpenTypeValue</span>) / <span class="hljs-title function_">sizeof</span>(<span class="hljs-variable">ArkUI_NumberValue</span>)};</li><li>    <span class="hljs-variable">nodeAPI</span>-&gt;<span class="hljs-title class_">setAttribute</span>(<span class="hljs-title class_">buttonShow</span>, <span class="hljs-title class_">NODE_BUTTON_TYPE</span>, &amp;<span class="hljs-title class_">buttonOpenTypeItem</span>);</li><li>    <span class="hljs-variable">ArkUI_NumberValue</span> <span class="hljs-variable">buttonShowMarginValue</span>[] = {{.<span class="hljs-variable">f32</span> = <span class="hljs-number">20</span>}};</li><li>    <span class="hljs-variable">ArkUI_AttributeItem</span> <span class="hljs-variable">buttonShowMarginItem</span> = {.<span class="hljs-variable">value</span> = <span class="hljs-variable">buttonShowMarginValue</span>,</li><li>                                                 .<span class="hljs-variable">size</span> = <span class="hljs-title function_">sizeof</span>(<span class="hljs-variable">buttonShowMarginValue</span>) / <span class="hljs-title function_">sizeof</span>(<span class="hljs-variable">ArkUI_NumberValue</span>)};</li><li>    <span class="hljs-variable">nodeAPI</span>-&gt;<span class="hljs-title class_">setAttribute</span>(<span class="hljs-title class_">buttonShow</span>, <span class="hljs-title class_">NODE_MARGIN</span>, &amp;<span class="hljs-title class_">buttonShowMarginItem</span>);</li><li>    <span class="hljs-variable">nodeAPI</span>-&gt;<span class="hljs-title class_">registerNodeEvent</span>(<span class="hljs-title class_">buttonShow</span>, <span class="hljs-title class_">NODE_ON_CLICK</span>, <span class="hljs-title class_">BUTTON_CLICK_ID</span>, <span class="hljs-title class_">nullptr</span>);</li><li>    <span class="hljs-variable">nodeAPI</span>-&gt;<span class="hljs-title class_">addNodeEventReceiver</span>(<span class="hljs-title class_">buttonShow</span>, <span class="hljs-title class_">OnButtonShowClicked</span>);</li><li>    <span class="hljs-variable">parentNode</span> = <span class="hljs-variable">column</span>;</li><li>    <span class="hljs-variable">buttonNode</span> = <span class="hljs-variable">buttonShow</span>;</li><li>    <span class="hljs-variable">nodeAPI</span>-&gt;<span class="hljs-title class_">addChild</span>(<span class="hljs-title class_">column</span>, <span class="hljs-title class_">buttonShow</span>);</li><li>    <span class="hljs-title function_">OH_ArkUI_NodeContent_AddNode</span>(<span class="hljs-variable">handle</span>, <span class="hljs-variable">column</span>);</li><li>}</li></ol></pre></div></div></li>      <li>       <p>创建一个设置了Transition属性的节点，当目标节点上下树时会播放转场动画。</p>       <div _ngcontent-udy-c106="" class="highlight-div"><div _ngcontent-udy-c106="" class="highlight-div-header"><div _ngcontent-udy-c106="" class="highlight-div-header-left"><div _ngcontent-udy-c106="" class="handle-button expand-button"><div _ngcontent-udy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-udy-c106="" class="highlight-div-header-right"><div _ngcontent-udy-c106="" class="handle-button ai-button"></div><div _ngcontent-udy-c106="" class="handle-button line-button"><div _ngcontent-udy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-udy-c106="" class="handle-button theme-button"><div _ngcontent-udy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-udy-c106="" class="handle-button copy-button"><div _ngcontent-udy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-udy-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-variable">ArkUI_NodeHandle</span> <span class="hljs-title function_">CreateChildNode</span>() {</li><li>    <span class="hljs-variable">ArkUI_NativeNodeAPI_1</span> *<span class="hljs-variable">nodeAPI</span> = <span class="hljs-title class_">reinterpret_cast</span>&lt;<span class="hljs-title class_">ArkUI_NativeNodeAPI_1</span> *&gt;(</li><li>        <span class="hljs-title function_">OH_ArkUI_QueryModuleInterfaceByName</span>(<span class="hljs-variable">ARKUI_NATIVE_NODE</span>, <span class="hljs-string">"ArkUI_NativeNodeAPI_1"</span>));</li><li>    <span class="hljs-variable">ArkUI_NodeHandle</span> <span class="hljs-variable">image</span> = <span class="hljs-variable">nodeAPI</span>-&gt;<span class="hljs-title class_">createNode</span>(<span class="hljs-title class_">ARKUI_NODE_IMAGE</span>);</li><li>    <span class="hljs-variable">ArkUI_AttributeItem</span> <span class="hljs-variable">imageSrcItem</span> = {.<span class="hljs-variable">string</span> = <span class="hljs-string">"/pages/common/scenery.jpg"</span>};</li><li>    <span class="hljs-variable">nodeAPI</span>-&gt;<span class="hljs-title class_">setAttribute</span>(<span class="hljs-title class_">image</span>, <span class="hljs-title class_">NODE_IMAGE_SRC</span>, &amp;<span class="hljs-title class_">imageSrcItem</span>);</li><li>    <span class="hljs-variable">ArkUI_NumberValue</span> <span class="hljs-variable">textWidthValue</span>[] = {{.<span class="hljs-variable">f32</span> = <span class="hljs-number">300</span>}};</li><li>    <span class="hljs-variable">ArkUI_AttributeItem</span> <span class="hljs-variable">textWidthItem</span> = {.<span class="hljs-variable">value</span> = <span class="hljs-variable">textWidthValue</span>,</li><li>                                         .<span class="hljs-variable">size</span> = <span class="hljs-title function_">sizeof</span>(<span class="hljs-variable">textWidthValue</span>) / <span class="hljs-title function_">sizeof</span>(<span class="hljs-variable">ArkUI_NumberValue</span>)};</li><li>    <span class="hljs-variable">nodeAPI</span>-&gt;<span class="hljs-title class_">setAttribute</span>(<span class="hljs-title class_">image</span>, <span class="hljs-title class_">NODE_WIDTH</span>, &amp;<span class="hljs-title class_">textWidthItem</span>);</li><li>    <span class="hljs-variable">ArkUI_NumberValue</span> <span class="hljs-variable">textHeightValue</span>[] = {{.<span class="hljs-variable">f32</span> = <span class="hljs-number">300</span>}};</li><li>    <span class="hljs-variable">ArkUI_AttributeItem</span> <span class="hljs-variable">textHeightItem</span> = {.<span class="hljs-variable">value</span> = <span class="hljs-variable">textHeightValue</span>,</li><li>                                          .<span class="hljs-variable">size</span> = <span class="hljs-title function_">sizeof</span>(<span class="hljs-variable">textWidthValue</span>) / <span class="hljs-title function_">sizeof</span>(<span class="hljs-variable">ArkUI_NumberValue</span>)};</li><li>    <span class="hljs-variable">nodeAPI</span>-&gt;<span class="hljs-title class_">setAttribute</span>(<span class="hljs-title class_">image</span>, <span class="hljs-title class_">NODE_HEIGHT</span>, &amp;<span class="hljs-title class_">textHeightItem</span>);</li><li>    <span class="hljs-variable">ArkUI_NumberValue</span> <span class="hljs-variable">transformCenterValue</span>[] = {<span class="hljs-number">0.0</span><span class="hljs-variable">f</span>, <span class="hljs-number">0.0</span><span class="hljs-variable">f</span>, <span class="hljs-number">0.0</span><span class="hljs-variable">f</span>, <span class="hljs-number">0.5</span><span class="hljs-variable">f</span>, <span class="hljs-number">0.5</span><span class="hljs-variable">f</span>};</li><li>    <span class="hljs-variable">ArkUI_AttributeItem</span> <span class="hljs-variable">transformCenterItem</span> = {.<span class="hljs-variable">value</span> = <span class="hljs-variable">transformCenterValue</span>,</li><li>                                          .<span class="hljs-variable">size</span> = <span class="hljs-title function_">sizeof</span>(<span class="hljs-variable">transformCenterValue</span>) / <span class="hljs-title function_">sizeof</span>(<span class="hljs-variable">ArkUI_NumberValue</span>)};</li><li>    <span class="hljs-variable">nodeAPI</span>-&gt;<span class="hljs-title class_">setAttribute</span>(<span class="hljs-title class_">image</span>, <span class="hljs-title class_">NODE_TRANSFORM_CENTER</span>, &amp;<span class="hljs-title class_">transformCenterItem</span>);</li><li>    <span class="hljs-variable">ArkUI_NumberValue</span> <span class="hljs-variable">rotateAnimationValue</span>[] = {<span class="hljs-number">0.0</span><span class="hljs-variable">f</span>, <span class="hljs-number">0.0</span><span class="hljs-variable">f</span>, <span class="hljs-number">1.0</span><span class="hljs-variable">f</span>, <span class="hljs-number">360.0</span><span class="hljs-variable">f</span>, <span class="hljs-number">0.0</span><span class="hljs-variable">f</span>, {.<span class="hljs-variable">i32</span> = <span class="hljs-number">500</span>}, {.<span class="hljs-variable">i32</span> = <span class="hljs-title class_">static_cast</span>&lt;<span class="hljs-title class_">int32_t</span>&gt;(<span class="hljs-variable">ARKUI_CURVE_SHARP</span>)}};</li><li>    <span class="hljs-variable">ArkUI_AttributeItem</span> <span class="hljs-variable">rotateAnimationItem</span> = {.<span class="hljs-variable">value</span> = <span class="hljs-variable">rotateAnimationValue</span>,</li><li>                                               .<span class="hljs-variable">size</span> = <span class="hljs-title function_">sizeof</span>(<span class="hljs-variable">rotateAnimationValue</span>) / <span class="hljs-title function_">sizeof</span>(<span class="hljs-variable">ArkUI_NumberValue</span>)};</li><li>    <span class="hljs-variable">nodeAPI</span>-&gt;<span class="hljs-title class_">setAttribute</span>(<span class="hljs-title class_">image</span>, <span class="hljs-title class_">NODE_ROTATE_TRANSITION</span>, &amp;<span class="hljs-title class_">rotateAnimationItem</span>);</li><li>    <span class="hljs-variable">ArkUI_NumberValue</span> <span class="hljs-variable">scaleAnimationValue</span>[] = {</li><li>        <span class="hljs-number">0.0</span><span class="hljs-variable">f</span>, <span class="hljs-number">0.0</span><span class="hljs-variable">f</span>, <span class="hljs-number">0.0</span><span class="hljs-variable">f</span>, {.<span class="hljs-variable">i32</span> = <span class="hljs-number">500</span>}, {.<span class="hljs-variable">i32</span> = <span class="hljs-title class_">static_cast</span>&lt;<span class="hljs-title class_">int32_t</span>&gt;(<span class="hljs-variable">ARKUI_CURVE_SHARP</span>)}};</li><li>    <span class="hljs-variable">ArkUI_AttributeItem</span> <span class="hljs-variable">scaleAnimationItem</span> = {.<span class="hljs-variable">value</span> = <span class="hljs-variable">scaleAnimationValue</span>,</li><li>                                               .<span class="hljs-variable">size</span> = <span class="hljs-title function_">sizeof</span>(<span class="hljs-variable">scaleAnimationValue</span>) / <span class="hljs-title function_">sizeof</span>(<span class="hljs-variable">ArkUI_NumberValue</span>)};</li><li>    <span class="hljs-variable">nodeAPI</span>-&gt;<span class="hljs-title class_">setAttribute</span>(<span class="hljs-title class_">image</span>, <span class="hljs-title class_">NODE_SCALE_TRANSITION</span>, &amp;<span class="hljs-title class_">scaleAnimationItem</span>);</li><li>    <span class="hljs-variable">ArkUI_NumberValue</span> <span class="hljs-variable">translateAnimationValue</span>[] = {</li><li>        <span class="hljs-number">200</span>, <span class="hljs-number">200</span>, <span class="hljs-number">0.0</span><span class="hljs-variable">f</span>, {.<span class="hljs-variable">i32</span> = <span class="hljs-number">500</span>}, {.<span class="hljs-variable">i32</span> = <span class="hljs-title class_">static_cast</span>&lt;<span class="hljs-title class_">int32_t</span>&gt;(<span class="hljs-variable">ARKUI_CURVE_SHARP</span>)}};</li><li>    <span class="hljs-variable">ArkUI_AttributeItem</span> <span class="hljs-variable">translateAnimationItem</span> = {.<span class="hljs-variable">value</span> = <span class="hljs-variable">translateAnimationValue</span>,</li><li>                                              .<span class="hljs-variable">size</span> = <span class="hljs-title function_">sizeof</span>(<span class="hljs-variable">translateAnimationValue</span>) / <span class="hljs-title function_">sizeof</span>(<span class="hljs-variable">ArkUI_NumberValue</span>)};</li><li>    <span class="hljs-variable">nodeAPI</span>-&gt;<span class="hljs-title class_">setAttribute</span>(<span class="hljs-title class_">image</span>, <span class="hljs-title class_">NODE_TRANSLATE_TRANSITION</span>, &amp;<span class="hljs-title class_">translateAnimationItem</span>);</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-variable">image</span>;</li><li>}</li></ol></pre></div></div></li>      <li>       <p>在Button的监听回调里添加转场节点上下树逻辑，以此控制转场节点的入场和出场。</p>       <div _ngcontent-udy-c106="" class="highlight-div"><div _ngcontent-udy-c106="" class="highlight-div-header"><div _ngcontent-udy-c106="" class="highlight-div-header-left"><div _ngcontent-udy-c106="" class="handle-button expand-button"><div _ngcontent-udy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-udy-c106="" class="highlight-div-header-right"><div _ngcontent-udy-c106="" class="handle-button ai-button"></div><div _ngcontent-udy-c106="" class="handle-button line-button"><div _ngcontent-udy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-udy-c106="" class="handle-button theme-button"><div _ngcontent-udy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-udy-c106="" class="handle-button copy-button"><div _ngcontent-udy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-udy-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-variable">void</span> <span class="hljs-title function_">OnButtonShowClicked</span>(<span class="hljs-variable">ArkUI_NodeEvent</span>* <span class="hljs-variable">event</span>)</li><li>{</li><li>    <span class="hljs-keyword">if</span> (!<span class="hljs-variable">event</span>) {</li><li>        <span class="hljs-keyword">return</span>;</li><li>    }</li><li>    <span class="hljs-keyword">if</span> (!<span class="hljs-variable">childNode</span>) {</li><li>        <span class="hljs-variable">childNode</span> = <span class="hljs-title function_">CreateChildNode</span>();</li><li>    }</li><li>    <span class="hljs-variable">ArkUI_NativeNodeAPI_1</span> *<span class="hljs-variable">nodeAPI</span> = <span class="hljs-title class_">reinterpret_cast</span>&lt;<span class="hljs-title class_">ArkUI_NativeNodeAPI_1</span> *&gt;(</li><li>        <span class="hljs-title function_">OH_ArkUI_QueryModuleInterfaceByName</span>(<span class="hljs-variable">ARKUI_NATIVE_NODE</span>, <span class="hljs-string">"ArkUI_NativeNodeAPI_1"</span>));</li><li>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">flag</span>) {</li><li>        <span class="hljs-variable">flag</span> = <span class="hljs-keyword">false</span>;</li><li>        <span class="hljs-variable">ArkUI_AttributeItem</span> <span class="hljs-variable">labelItem</span> = {.<span class="hljs-variable">string</span> = <span class="hljs-string">"show"</span>};</li><li>        <span class="hljs-variable">nodeAPI</span>-&gt;<span class="hljs-title class_">setAttribute</span>(<span class="hljs-title class_">buttonNode</span>, <span class="hljs-title class_">NODE_BUTTON_LABEL</span>, &amp;<span class="hljs-title class_">labelItem</span>);</li><li>        <span class="hljs-variable">nodeAPI</span>-&gt;<span class="hljs-title class_">removeChild</span>(<span class="hljs-title class_">parentNode</span>, <span class="hljs-title class_">childNode</span>);</li><li>    } <span class="hljs-keyword">else</span> {</li><li>        <span class="hljs-variable">flag</span> = <span class="hljs-keyword">true</span>;</li><li>        <span class="hljs-variable">ArkUI_AttributeItem</span> <span class="hljs-variable">labelItem</span> = {.<span class="hljs-variable">string</span> = <span class="hljs-string">"hide"</span>};</li><li>        <span class="hljs-variable">nodeAPI</span>-&gt;<span class="hljs-title class_">setAttribute</span>(<span class="hljs-title class_">buttonNode</span>, <span class="hljs-title class_">NODE_BUTTON_LABEL</span>, &amp;<span class="hljs-title class_">labelItem</span>);</li><li>        <span class="hljs-variable">nodeAPI</span>-&gt;<span class="hljs-title class_">addChild</span>(<span class="hljs-title class_">parentNode</span>, <span class="hljs-title class_">childNode</span>);</li><li>    }</li><li>}</li></ol></pre></div></div>       <p><span><img originheight="846" originwidth="563" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114737.74080706801217260736221086778148:50001231000000:2800:3BF4D0B059C202990C53792A43B4E8F57398DB8AF86A34D293A753DB02C767AF.gif" width="563" height="846"></span></p></li>     </ol>    </div>    <div class="tiledSection">     <h2 id="使用关键帧动画">使用关键帧动画<i class="anchor-icon anchor-icon-link" anchorid="使用关键帧动画" tips="复制节点链接"></i></h2>          <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-arkui-nativemodule-arkui-nativeanimateapi-1#keyframeanimateto" target="_blank">keyframeAnimateTo</a>接口来指定若干个关键帧状态，实现分段的动画。同属性动画，布局类改变宽高的动画，内容都是直接到终点状态。</p>     <p>该示例主要演示如何通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-arkui-nativemodule-arkui-nativeanimateapi-1#keyframeanimateto" target="_blank">keyframeAnimateTo</a>来设置关键帧动画，NDK接口开发的UI界面挂载到ArkTS主页面的完整流程可参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ndk-access-the-arkts-page">接入ArkTS页面</a>。</p>     <div _ngcontent-udy-c106="" class="highlight-div"><div _ngcontent-udy-c106="" class="highlight-div-header"><div _ngcontent-udy-c106="" class="highlight-div-header-left"><div _ngcontent-udy-c106="" class="handle-button expand-button"><div _ngcontent-udy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-udy-c106="" class="highlight-div-header-right"><div _ngcontent-udy-c106="" class="handle-button ai-button"></div><div _ngcontent-udy-c106="" class="handle-button line-button"><div _ngcontent-udy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-udy-c106="" class="handle-button theme-button"><div _ngcontent-udy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-udy-c106="" class="handle-button copy-button"><div _ngcontent-udy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-udy-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-variable">auto</span> <span class="hljs-variable">column</span> = <span class="hljs-variable">nodeAPI</span>-&gt;<span class="hljs-title class_">createNode</span>(<span class="hljs-title class_">ARKUI_NODE_COLUMN</span>);</li><li>
</li><li><span class="hljs-comment">// 创建button，后续创建的关键帧动画作用在button组件上</span></li><li><span class="hljs-variable">auto</span> <span class="hljs-variable">button</span> = <span class="hljs-variable">nodeAPI</span>-&gt;<span class="hljs-title class_">createNode</span>(<span class="hljs-title class_">ARKUI_NODE_BUTTON</span>);</li><li><span class="hljs-variable">ArkUI_NumberValue</span> <span class="hljs-variable">widthValue0</span>[] = {<span class="hljs-number">100</span>};</li><li><span class="hljs-variable">ArkUI_AttributeItem</span> <span class="hljs-variable">widthItem0</span> = {<span class="hljs-variable">widthValue0</span>, <span class="hljs-number">1</span>};</li><li><span class="hljs-variable">ArkUI_NumberValue</span> <span class="hljs-variable">heightValue0</span>[] = {<span class="hljs-number">100</span>};</li><li><span class="hljs-variable">ArkUI_AttributeItem</span> <span class="hljs-variable">heightItem0</span> = {<span class="hljs-variable">heightValue0</span>, <span class="hljs-number">1</span>};</li><li><span class="hljs-variable">nodeAPI</span>-&gt;<span class="hljs-title class_">setAttribute</span>(<span class="hljs-title class_">button</span>, <span class="hljs-title class_">NODE_WIDTH</span>, &amp;<span class="hljs-title class_">widthItem0</span>);</li><li><span class="hljs-variable">nodeAPI</span>-&gt;<span class="hljs-title class_">setAttribute</span>(<span class="hljs-title class_">button</span>, <span class="hljs-title class_">NODE_HEIGHT</span>, &amp;<span class="hljs-title class_">heightItem0</span>);</li><li><span class="hljs-variable">ArkUI_NumberValue</span> <span class="hljs-variable">typeValue</span>[] = {{.<span class="hljs-variable">i32</span> = <span class="hljs-variable">ArkUI_ButtonType</span>::<span class="hljs-title class_">ARKUI_BUTTON_TYPE_CIRCLE</span>}};</li><li><span class="hljs-variable">ArkUI_AttributeItem</span> <span class="hljs-variable">typeItem</span> = {<span class="hljs-variable">typeValue</span>, <span class="hljs-number">1</span>};</li><li><span class="hljs-variable">nodeAPI</span>-&gt;<span class="hljs-title class_">setAttribute</span>(<span class="hljs-title class_">button</span>, <span class="hljs-title class_">NODE_BUTTON_TYPE</span>, &amp;<span class="hljs-title class_">typeItem</span>); <span class="hljs-comment">// 设置button的形状为圆形</span></li><li>
</li><li><span class="hljs-keyword">static</span> <span class="hljs-variable">ArkUI_NodeHandle</span> <span class="hljs-variable">buttonSelf</span> = <span class="hljs-variable">button</span>;</li><li><span class="hljs-keyword">static</span> <span class="hljs-variable">ArkUI_NativeNodeAPI_1</span> *<span class="hljs-variable">nodeAPISelf</span> = <span class="hljs-variable">nodeAPI</span>;</li><li>
</li><li><span class="hljs-comment">// 注册点击事件到button上</span></li><li><span class="hljs-variable">nodeAPI</span>-&gt;<span class="hljs-title class_">registerNodeEvent</span>(<span class="hljs-title class_">button</span>, <span class="hljs-title class_">NODE_ON_CLICK</span>, <span class="hljs-number">1</span>, <span class="hljs-title class_">nullptr</span>);</li><li><span class="hljs-variable">auto</span> <span class="hljs-variable">onTouch</span> = [](<span class="hljs-variable">ArkUI_NodeEvent</span> *<span class="hljs-variable">event</span>) {</li><li>    </li><li>    <span class="hljs-comment">// 点击button按钮时触发该逻辑</span></li><li>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_">OH_ArkUI_NodeEvent_GetTargetId</span>(<span class="hljs-variable">event</span>) == <span class="hljs-number">1</span>) {</li><li>        </li><li>        <span class="hljs-comment">// 获取context对象</span></li><li>        <span class="hljs-keyword">static</span> <span class="hljs-variable">ArkUI_ContextHandle</span> <span class="hljs-variable">context</span> = <span class="hljs-variable">nullptr</span>;</li><li>        <span class="hljs-variable">context</span> = <span class="hljs-title function_">OH_ArkUI_GetContextByNode</span>(<span class="hljs-variable">buttonSelf</span>);</li><li>        </li><li>        <span class="hljs-comment">// 获取ArkUI_NativeAnimateAPI接口</span></li><li>        <span class="hljs-variable">ArkUI_NativeAnimateAPI_1</span> *<span class="hljs-variable">animateApi</span> = <span class="hljs-variable">nullptr</span>;</li><li>        <span class="hljs-title function_">OH_ArkUI_GetModuleInterface</span>(<span class="hljs-variable">ARKUI_NATIVE_ANIMATE</span>, <span class="hljs-variable">ArkUI_NativeAnimateAPI_1</span>, <span class="hljs-variable">animateApi</span>);</li><li>        </li><li>        <span class="hljs-comment">// 以下代码为创建关键帧动画的关键流程，包括设置关键帧动画参数、开启关键帧动画</span></li><li>        <span class="hljs-comment">// 设置ArkUI_KeyframeAnimateOption参数，通过提供的C方法设置对应的参数</span></li><li>        <span class="hljs-keyword">static</span> <span class="hljs-variable">ArkUI_KeyframeAnimateOption</span> *<span class="hljs-variable">option</span> =  <span class="hljs-title function_">OH_ArkUI_KeyframeAnimateOption_Create</span>(<span class="hljs-number">2</span>); <span class="hljs-comment">// 关键帧动画状态数</span></li><li>        <span class="hljs-title function_">OH_ArkUI_KeyframeAnimateOption_SetDuration</span>(<span class="hljs-variable">option</span>, <span class="hljs-number">1000</span>, <span class="hljs-number">0</span>); <span class="hljs-comment">// 第一段关键帧动画的持续时间</span></li><li>        <span class="hljs-title function_">OH_ArkUI_KeyframeAnimateOption_SetDuration</span>(<span class="hljs-variable">option</span>, <span class="hljs-number">2000</span>, <span class="hljs-number">1</span>); <span class="hljs-comment">// 第二段关键帧动画的持续时间</span></li><li>        <span class="hljs-title function_">OH_ArkUI_KeyframeAnimateOption_SetIterations</span>(<span class="hljs-variable">option</span>, <span class="hljs-number">5</span>); <span class="hljs-comment">// 关键帧动画播放次数</span></li><li>        <span class="hljs-title function_">OH_ArkUI_KeyframeAnimateOption_RegisterOnEventCallback</span>(<span class="hljs-variable">option</span>, <span class="hljs-variable">nullptr</span>, [](<span class="hljs-variable">void</span> *<span class="hljs-variable">user</span>) {</li><li>            <span class="hljs-variable">ArkUI_NumberValue</span> <span class="hljs-variable">widthValue0</span>[] = {<span class="hljs-number">150</span>};</li><li>            <span class="hljs-variable">ArkUI_AttributeItem</span> <span class="hljs-variable">widthItem0</span> = {<span class="hljs-variable">widthValue0</span>, <span class="hljs-number">1</span>};</li><li>            <span class="hljs-variable">ArkUI_NumberValue</span> <span class="hljs-variable">heightValue0</span>[] = {<span class="hljs-number">150</span>};</li><li>            <span class="hljs-variable">ArkUI_AttributeItem</span> <span class="hljs-variable">heightItem0</span> = {<span class="hljs-variable">heightValue0</span>, <span class="hljs-number">1</span>};</li><li>            <span class="hljs-variable">nodeAPISelf</span>-&gt;<span class="hljs-title class_">setAttribute</span>(<span class="hljs-title class_">buttonSelf</span>, <span class="hljs-title class_">NODE_WIDTH</span>, &amp;<span class="hljs-title class_">widthItem0</span>);</li><li>            <span class="hljs-variable">nodeAPISelf</span>-&gt;<span class="hljs-title class_">setAttribute</span>(<span class="hljs-title class_">buttonSelf</span>, <span class="hljs-title class_">NODE_HEIGHT</span>, &amp;<span class="hljs-title class_">heightItem0</span>);</li><li>        }, <span class="hljs-number">0</span>); <span class="hljs-comment">// 第一段关键帧时刻状态的闭包函数</span></li><li>        <span class="hljs-title function_">OH_ArkUI_KeyframeAnimateOption_RegisterOnEventCallback</span>(<span class="hljs-variable">option</span>, <span class="hljs-variable">nullptr</span>, [](<span class="hljs-variable">void</span> *<span class="hljs-variable">user</span>) {</li><li>            <span class="hljs-variable">ArkUI_NumberValue</span> <span class="hljs-variable">widthValue0</span>[] = {<span class="hljs-number">80</span>};</li><li>            <span class="hljs-variable">ArkUI_AttributeItem</span> <span class="hljs-variable">widthItem0</span> = {<span class="hljs-variable">widthValue0</span>, <span class="hljs-number">1</span>};</li><li>            <span class="hljs-variable">ArkUI_NumberValue</span> <span class="hljs-variable">heightValue0</span>[] = {<span class="hljs-number">80</span>};</li><li>            <span class="hljs-variable">ArkUI_AttributeItem</span> <span class="hljs-variable">heightItem0</span> = {<span class="hljs-variable">heightValue0</span>, <span class="hljs-number">1</span>};</li><li>            <span class="hljs-variable">nodeAPISelf</span>-&gt;<span class="hljs-title class_">setAttribute</span>(<span class="hljs-title class_">buttonSelf</span>, <span class="hljs-title class_">NODE_WIDTH</span>, &amp;<span class="hljs-title class_">widthItem0</span>);</li><li>            <span class="hljs-variable">nodeAPISelf</span>-&gt;<span class="hljs-title class_">setAttribute</span>(<span class="hljs-title class_">buttonSelf</span>, <span class="hljs-title class_">NODE_HEIGHT</span>, &amp;<span class="hljs-title class_">heightItem0</span>);</li><li>        }, <span class="hljs-number">1</span>); <span class="hljs-comment">// 第二段关键帧时刻状态的闭包函数</span></li><li>        <span class="hljs-title function_">OH_ArkUI_KeyframeAnimateOption_RegisterOnFinishCallback</span>(<span class="hljs-variable">option</span>, <span class="hljs-variable">nullptr</span>, [](<span class="hljs-variable">void</span> *<span class="hljs-variable">user</span>) {</li><li>            <span class="hljs-title function_">OH_LOG_Print</span>(<span class="hljs-variable">LOG_APP</span>, <span class="hljs-variable">LOG_INFO</span>, <span class="hljs-variable">LOG_PRINT_DOMAIN</span>, <span class="hljs-string">"Manager"</span>, <span class="hljs-string">"keyframe animate finish"</span>);</li><li>        }); <span class="hljs-comment">// 关键帧动画结束回调</span></li><li>        <span class="hljs-variable">ArkUI_ExpectedFrameRateRange</span> *<span class="hljs-variable">range</span> = <span class="hljs-variable">new</span> <span class="hljs-variable">ArkUI_ExpectedFrameRateRange</span>;</li><li>        <span class="hljs-variable">range</span>-&gt;<span class="hljs-title class_">max</span> = <span class="hljs-number">120</span>;</li><li>        <span class="hljs-variable">range</span>-&gt;<span class="hljs-title class_">expected</span> = <span class="hljs-number">60</span>;</li><li>        <span class="hljs-variable">range</span>-&gt;<span class="hljs-title class_">min</span> = <span class="hljs-number">30</span>;</li><li>        <span class="hljs-title function_">OH_ArkUI_KeyframeAnimateOption_SetExpectedFrameRate</span>(<span class="hljs-variable">option</span>, <span class="hljs-variable">range</span>); <span class="hljs-comment">// 关键帧设置期望帧率</span></li><li>        </li><li>        <span class="hljs-comment">// 执行对应的动画</span></li><li>        <span class="hljs-variable">animateApi</span>-&gt;<span class="hljs-title class_">keyframeAnimateTo</span>(<span class="hljs-title class_">context</span>, <span class="hljs-title class_">option</span>);</li><li>    }</li><li>};</li><li><span class="hljs-variable">nodeAPI</span>-&gt;<span class="hljs-title class_">registerNodeEventReceiver</span>(<span class="hljs-title class_">onTouch</span>);</li><li><span class="hljs-variable">nodeAPI</span>-&gt;<span class="hljs-title class_">addChild</span>(<span class="hljs-title class_">column</span>, <span class="hljs-title class_">button</span>);</li></ol></pre></div></div>     <p><span><img originheight="272" originwidth="318" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114737.63406204559195711647153169117095:50001231000000:2800:EF28C2D87082134C1CEE72C3848C5E8977AEF57ECB65BC480A593A0195F16DA3.gif" width="318" height="272"></span></p>    </div>    <div class="tiledSection">     <h2 id="使用帧动画">使用帧动画<i class="anchor-icon anchor-icon-link" anchorid="使用帧动画" tips="复制节点链接"></i></h2>          <p>帧动画具有逐帧回调的特性，便于开发者在每一帧中调整所需属性。通过提供onFrame逐帧回调，帧动画允许开发者在应用的每一帧设置属性值，从而实现组件属性值变化的自然过渡，营造出流畅的动画效果。帧动画接口可参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-arkui-nativemodule-arkui-nativeanimateapi-1#createanimator" target="_blank">createAnimator</a>。</p>     <p>与属性动画相比，帧动画能让开发者实时感知动画进程，即时调整UI值，并具备事件即时响应和可暂停的优势，但在性能方面略逊于属性动画。当属性动画能满足需求时，建议优先采用属性动画接口实现。<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-arkui-nativemodule-arkui-nativeanimateapi-1#animateto" target="_blank">animateTo</a>接口的使用可参考<a href="/consumer/cn/doc/harmonyos-guides/ndk-use-animation#使用属性动画">使用属性动画</a>。</p>     <p>该示例主要演示如何通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-arkui-nativemodule-arkui-nativeanimateapi-1#createanimator" target="_blank">createAnimator</a>来设置帧动画，完整的示例工程请参考<a href="https://gitcode.com/HarmonyOS_Samples/guide-snippets/tree/master/ArkUIKit/AnimationNDK" target="_blank">AnimationNDK</a>。</p>     <div _ngcontent-udy-c106="" class="highlight-div"><div _ngcontent-udy-c106="" class="highlight-div-header"><div _ngcontent-udy-c106="" class="highlight-div-header-left"><div _ngcontent-udy-c106="" class="handle-button expand-button"><div _ngcontent-udy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-udy-c106="" class="highlight-div-header-right"><div _ngcontent-udy-c106="" class="handle-button ai-button"></div><div _ngcontent-udy-c106="" class="handle-button line-button"><div _ngcontent-udy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-udy-c106="" class="handle-button theme-button"><div _ngcontent-udy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-udy-c106="" class="handle-button copy-button"><div _ngcontent-udy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-udy-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-variable">std</span>::<span class="hljs-title class_">shared_ptr</span>&lt;<span class="hljs-title class_">ArkUIBaseNode</span>&gt; <span class="hljs-title class_">CreateAnimator</span>()</li><li>{</li><li>    <span class="hljs-variable">auto</span> <span class="hljs-variable">column</span> = <span class="hljs-variable">std</span>::<span class="hljs-title class_">make_shared</span>&lt;<span class="hljs-title class_">ArkUIColumnNode</span>&gt;();</li><li>    <span class="hljs-variable">column</span>-&gt;<span class="hljs-title class_">SetWidth</span>(<span class="hljs-number">300</span>);</li><li>    <span class="hljs-variable">column</span>-&gt;<span class="hljs-title class_">SetHeight</span>(<span class="hljs-number">250</span>);</li><li>    <span class="hljs-comment">// 创建文本节点，内容区介绍“这是Animator动画”</span></li><li>    <span class="hljs-variable">auto</span> <span class="hljs-variable">textNode</span> = <span class="hljs-variable">std</span>::<span class="hljs-title class_">make_shared</span>&lt;<span class="hljs-title class_">ArkUITextNode</span>&gt;();</li><li>    <span class="hljs-variable">textNode</span>-&gt;<span class="hljs-title class_">SetTextContent</span>("<span class="hljs-title class_">这是Animator</span>动画");</li><li>    <span class="hljs-variable">textNode</span>-&gt;<span class="hljs-title class_">SetWidth</span>(<span class="hljs-number">150</span>);</li><li>    <span class="hljs-variable">textNode</span>-&gt;<span class="hljs-title class_">SetHeight</span>(<span class="hljs-number">50</span>);</li><li>    <span class="hljs-comment">// 创建createButton，用于初始化Animator参数</span></li><li>    <span class="hljs-variable">auto</span> <span class="hljs-variable">createButton</span> = <span class="hljs-variable">std</span>::<span class="hljs-title class_">make_shared</span>&lt;<span class="hljs-title class_">ArkUIButtonNode</span>&gt;();</li><li>    <span class="hljs-comment">// 创建button，后续创建的Animator动画作用在button组件上</span></li><li>    <span class="hljs-variable">auto</span> <span class="hljs-variable">button</span> = <span class="hljs-variable">std</span>::<span class="hljs-title class_">make_shared</span>&lt;<span class="hljs-title class_">ArkUIButtonNode</span>&gt;();</li><li>    <span class="hljs-comment">// 设置button初始宽高</span></li><li>    <span class="hljs-variable">button</span>-&gt;<span class="hljs-title class_">SetWidth</span>(<span class="hljs-number">100</span>);</li><li>    <span class="hljs-variable">button</span>-&gt;<span class="hljs-title class_">SetHeight</span>(<span class="hljs-number">100</span>);</li><li>    <span class="hljs-comment">// 存储button全局变量，在onTouch注册时需要使用</span></li><li>    <span class="hljs-variable">g_animator_button</span> = <span class="hljs-variable">button</span>;</li><li>    <span class="hljs-comment">// 注册点击事件到button上</span></li><li>    <span class="hljs-variable">createButton</span>-&gt;<span class="hljs-title class_">RegisterNodeEvent</span>(<span class="hljs-variable">createButton</span>-&gt;<span class="hljs-title class_">GetHandle</span>(), <span class="hljs-title class_">NODE_ON_CLICK</span>, <span class="hljs-number">3</span>, <span class="hljs-title class_">nullptr</span>);</li><li>    <span class="hljs-variable">g_animator_text</span> = <span class="hljs-variable">std</span>::<span class="hljs-title class_">make_shared</span>&lt;<span class="hljs-title class_">ArkUITextNode</span>&gt;();</li><li>    <span class="hljs-variable">g_animator_text</span>-&gt;<span class="hljs-title class_">AnimatorToString</span>();</li><li>    <span class="hljs-variable">auto</span> <span class="hljs-variable">onTouch</span> = [](<span class="hljs-variable">ArkUI_NodeEvent</span> *<span class="hljs-variable">event</span>) {</li><li>        <span class="hljs-comment">// 点击button按钮时触发该逻辑</span></li><li>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_">OH_ArkUI_NodeEvent_GetTargetId</span>(<span class="hljs-variable">event</span>) == <span class="hljs-number">3</span>) {</li><li>            <span class="hljs-comment">// 获取context对象</span></li><li>            <span class="hljs-keyword">static</span> <span class="hljs-variable">ArkUI_ContextHandle</span> <span class="hljs-variable">context</span> = <span class="hljs-variable">nullptr</span>;</li><li>            <span class="hljs-variable">context</span> = <span class="hljs-title function_">OH_ArkUI_GetContextByNode</span>(<span class="hljs-variable">g_animator_button</span>-&gt;<span class="hljs-title class_">GetHandle</span>());</li><li>
</li><li>            <span class="hljs-comment">// 获取ArkUI_NativeAnimateAPI接口</span></li><li>            <span class="hljs-variable">ArkUI_NativeAnimateAPI_1</span> *<span class="hljs-variable">animateApi</span> = <span class="hljs-variable">nullptr</span>;</li><li>            <span class="hljs-title function_">OH_ArkUI_GetModuleInterface</span>(<span class="hljs-variable">ARKUI_NATIVE_ANIMATE</span>, <span class="hljs-variable">ArkUI_NativeAnimateAPI_1</span>, <span class="hljs-variable">animateApi</span>);</li><li>            </li><li>            <span class="hljs-comment">// 以下代码为创建Animator动画的关键流程，包括设置Animator动画参数、开启Animator动画</span></li><li>            <span class="hljs-comment">// 设置ArkUI_AnimatorOption参数，通过提供的C方法设置对应的参数</span></li><li>            <span class="hljs-keyword">static</span> <span class="hljs-variable">ArkUI_AnimatorOption</span> *<span class="hljs-variable">option</span> =  <span class="hljs-title function_">OH_ArkUI_AnimatorOption_Create</span>(<span class="hljs-number">0</span>); <span class="hljs-comment">// Animator动画状态数</span></li><li>            <span class="hljs-title function_">OH_ArkUI_AnimatorOption_SetDuration</span>(<span class="hljs-variable">option</span>, <span class="hljs-number">2000</span>);</li><li>            <span class="hljs-title function_">OH_ArkUI_AnimatorOption_SetDelay</span>(<span class="hljs-variable">option</span>, <span class="hljs-number">10</span>);</li><li>            <span class="hljs-title function_">OH_ArkUI_AnimatorOption_SetIterations</span>(<span class="hljs-variable">option</span>, <span class="hljs-number">3</span>);</li><li>            <span class="hljs-title function_">OH_ArkUI_AnimatorOption_SetFill</span>(<span class="hljs-variable">option</span>, <span class="hljs-variable">ARKUI_ANIMATION_FILL_MODE_NONE</span>);</li><li>            <span class="hljs-title function_">OH_ArkUI_AnimatorOption_SetDirection</span>(<span class="hljs-variable">option</span>, <span class="hljs-variable">ARKUI_ANIMATION_DIRECTION_NORMAL</span>);</li><li>            <span class="hljs-variable">ArkUI_CurveHandle</span> <span class="hljs-variable">curve</span> = <span class="hljs-title function_">OH_ArkUI_Curve_CreateCubicBezierCurve</span>(<span class="hljs-number">0.5</span><span class="hljs-variable">f</span>, <span class="hljs-number">4.0</span><span class="hljs-variable">f</span>, <span class="hljs-number">1.2</span><span class="hljs-variable">f</span>, <span class="hljs-number">0.0</span><span class="hljs-variable">f</span>); <span class="hljs-comment">// 构造三阶贝塞尔曲线对象</span></li><li>            <span class="hljs-title function_">OH_ArkUI_AnimatorOption_SetCurve</span>(<span class="hljs-variable">option</span>, <span class="hljs-variable">curve</span>);</li><li>            <span class="hljs-title function_">OH_ArkUI_AnimatorOption_SetBegin</span>(<span class="hljs-variable">option</span>, <span class="hljs-number">100</span>);</li><li>            <span class="hljs-title function_">OH_ArkUI_AnimatorOption_SetEnd</span>(<span class="hljs-variable">option</span>, <span class="hljs-number">150</span>);</li><li>            <span class="hljs-variable">ArkUI_ExpectedFrameRateRange</span> *<span class="hljs-variable">range</span> = <span class="hljs-variable">new</span> <span class="hljs-variable">ArkUI_ExpectedFrameRateRange</span>;</li><li>            <span class="hljs-variable">range</span>-&gt;<span class="hljs-title class_">max</span> = <span class="hljs-number">120</span>;</li><li>            <span class="hljs-variable">range</span>-&gt;<span class="hljs-title class_">expected</span> = <span class="hljs-number">60</span>;</li><li>            <span class="hljs-variable">range</span>-&gt;<span class="hljs-title class_">min</span> = <span class="hljs-number">30</span>;</li><li>            <span class="hljs-title function_">OH_ArkUI_AnimatorOption_SetExpectedFrameRateRange</span>(<span class="hljs-variable">option</span>, <span class="hljs-variable">range</span>);</li><li>            <span class="hljs-title function_">OH_ArkUI_AnimatorOption_SetKeyframe</span>(<span class="hljs-variable">option</span>, <span class="hljs-number">0.5</span>, <span class="hljs-number">120.5</span>, <span class="hljs-number">0</span>); <span class="hljs-comment">// 设置Animator动画关键帧参数</span></li><li>            <span class="hljs-title function_">OH_ArkUI_AnimatorOption_SetKeyframeCurve</span>(<span class="hljs-variable">option</span>, <span class="hljs-variable">curve</span>, <span class="hljs-number">0</span>); <span class="hljs-comment">// 设置Animator动画关键帧曲线类型</span></li><li>            <span class="hljs-title function_">OH_ArkUI_AnimatorOption_RegisterOnFrameCallback</span>(<span class="hljs-variable">option</span>, <span class="hljs-variable">nullptr</span>, [](<span class="hljs-variable">ArkUI_AnimatorOnFrameEvent</span> *<span class="hljs-variable">event</span>){</li><li>                <span class="hljs-title function_">OH_ArkUI_AnimatorOnFrameEvent_GetUserData</span>(<span class="hljs-variable">event</span>); <span class="hljs-comment">// 获取动画事件对象中的用户自定义对象</span></li><li>                <span class="hljs-variable">auto</span> <span class="hljs-variable">value</span> = <span class="hljs-title function_">OH_ArkUI_AnimatorOnFrameEvent_GetValue</span>(<span class="hljs-variable">event</span>); <span class="hljs-comment">// 获取动画事件对象中的当前进度</span></li><li>                <span class="hljs-title function_">OH_LOG_Print</span>(<span class="hljs-variable">LOG_APP</span>, <span class="hljs-variable">LOG_ERROR</span>, <span class="hljs-variable">LOG_PRINT_DOMAIN</span>, <span class="hljs-string">"Init"</span>, <span class="hljs-string">"CXX OH_ArkUI_AnimatorOption_RegisterOnFrameCallback  %{public}f"</span>, <span class="hljs-variable">value</span>);</li><li>                <span class="hljs-variable">g_animator_button</span>-&gt;<span class="hljs-title class_">SetWidth</span>(<span class="hljs-title class_">value</span>);</li><li>            });</li><li>            <span class="hljs-title function_">OH_ArkUI_AnimatorOption_RegisterOnFinishCallback</span>(<span class="hljs-variable">option</span>, <span class="hljs-title class_">reinterpret_cast</span>&lt;<span class="hljs-title class_">void</span>*&gt;(<span class="hljs-variable">option</span>), [](<span class="hljs-variable">ArkUI_AnimatorEvent</span>* <span class="hljs-variable">event</span>){</li><li>                <span class="hljs-title function_">OH_ArkUI_AnimatorEvent_GetUserData</span>(<span class="hljs-variable">event</span>); <span class="hljs-comment">// 获取动画事件对象中的用户自定义对象</span></li><li>            });</li><li>            <span class="hljs-title function_">OH_ArkUI_AnimatorOption_RegisterOnCancelCallback</span>(<span class="hljs-variable">option</span>, <span class="hljs-variable">nullptr</span>, [](<span class="hljs-variable">ArkUI_AnimatorEvent</span>* <span class="hljs-variable">event</span>){</li><li>            });</li><li>            <span class="hljs-title function_">OH_ArkUI_AnimatorOption_RegisterOnRepeatCallback</span>(<span class="hljs-variable">option</span>, <span class="hljs-variable">nullptr</span>, [](<span class="hljs-variable">ArkUI_AnimatorEvent</span>* <span class="hljs-variable">event</span>){</li><li>            });</li><li>            <span class="hljs-comment">// 执行对应的动画</span></li><li>            <span class="hljs-variable">animatorHandle</span> = <span class="hljs-variable">animateApi</span>-&gt;<span class="hljs-title class_">createAnimator</span>(<span class="hljs-title class_">context</span>, <span class="hljs-title class_">option</span>);</li><li>            </li><li>            <span class="hljs-variable">auto</span> <span class="hljs-variable">duration</span> = <span class="hljs-title function_">OH_ArkUI_AnimatorOption_GetDuration</span>(<span class="hljs-variable">option</span>);</li><li>            <span class="hljs-variable">auto</span> <span class="hljs-variable">delay</span> = <span class="hljs-title function_">OH_ArkUI_AnimatorOption_GetDelay</span>(<span class="hljs-variable">option</span>);</li><li>            <span class="hljs-variable">auto</span> <span class="hljs-variable">iterations</span> = <span class="hljs-title function_">OH_ArkUI_AnimatorOption_GetIterations</span>(<span class="hljs-variable">option</span>);</li><li>            <span class="hljs-variable">auto</span> <span class="hljs-variable">fill</span> = <span class="hljs-title function_">OH_ArkUI_AnimatorOption_GetFill</span>(<span class="hljs-variable">option</span>);</li><li>            <span class="hljs-variable">auto</span> <span class="hljs-variable">direction</span> = <span class="hljs-title function_">OH_ArkUI_AnimatorOption_GetDirection</span>(<span class="hljs-variable">option</span>);</li><li>            <span class="hljs-variable">auto</span> <span class="hljs-variable">curves</span> = <span class="hljs-title function_">OH_ArkUI_AnimatorOption_GetCurve</span>(<span class="hljs-variable">option</span>); <span class="hljs-comment">// 获取Animator动画插值曲线</span></li><li>            <span class="hljs-variable">auto</span> <span class="hljs-variable">begin</span> = <span class="hljs-title function_">OH_ArkUI_AnimatorOption_GetBegin</span>(<span class="hljs-variable">option</span>);</li><li>            <span class="hljs-variable">auto</span> <span class="hljs-variable">end</span> = <span class="hljs-title function_">OH_ArkUI_AnimatorOption_GetEnd</span>(<span class="hljs-variable">option</span>); <span class="hljs-comment">// 获取Animator动画插值终点</span></li><li>            <span class="hljs-variable">auto</span> <span class="hljs-variable">expected</span> = <span class="hljs-title function_">OH_ArkUI_AnimatorOption_GetExpectedFrameRateRange</span>(<span class="hljs-variable">option</span>); <span class="hljs-comment">// 获取关键帧动画参数的期望帧率</span></li><li>            <span class="hljs-variable">auto</span> <span class="hljs-variable">keyframeTime</span> = <span class="hljs-title function_">OH_ArkUI_AnimatorOption_GetKeyframeTime</span>(<span class="hljs-variable">option</span>, <span class="hljs-number">0</span>); <span class="hljs-comment">// 获取Animator动画关键帧时间</span></li><li>            <span class="hljs-variable">auto</span> <span class="hljs-variable">keyframeValue</span> = <span class="hljs-title function_">OH_ArkUI_AnimatorOption_GetKeyframeValue</span>(<span class="hljs-variable">option</span>, <span class="hljs-number">0</span>); <span class="hljs-comment">// 获取Animator动画关键帧数值</span></li><li>            <span class="hljs-variable">auto</span> <span class="hljs-variable">keyframeCurve</span> = <span class="hljs-title function_">OH_ArkUI_AnimatorOption_GetKeyframeCurve</span>(<span class="hljs-variable">option</span>, <span class="hljs-number">0</span>); <span class="hljs-comment">// 获取Animator动画关键帧动画插值曲线</span></li><li>            <span class="hljs-variable">g_animator_text</span>-&gt;<span class="hljs-title class_">AnimatorToString</span>(<span class="hljs-title class_">duration</span>, <span class="hljs-title class_">delay</span>, <span class="hljs-title class_">iterations</span>, <span class="hljs-title class_">fill</span>, <span class="hljs-title class_">direction</span>, <span class="hljs-title class_">begin</span>,</li><li>                <span class="hljs-title class_">end</span>, <span class="hljs-variable">*expected</span>, <span class="hljs-title class_">keyframeTime</span>, <span class="hljs-title class_">keyframeValue</span>);</li><li>        }</li><li>    };</li><li>
</li><li>    <span class="hljs-comment">// 注册点击事件的回调函数</span></li><li>    <span class="hljs-variable">createButton</span>-&gt;<span class="hljs-title class_">RegisterNodeEventReceiver</span>(<span class="hljs-title class_">onTouch</span>);</li><li>    <span class="hljs-variable">createButton</span>-&gt;<span class="hljs-title class_">SetButtonLabel</span>("<span class="hljs-title class_">create</span>");</li><li>    <span class="hljs-comment">// 创建容器，用于存放button按键</span></li><li>    <span class="hljs-variable">auto</span> <span class="hljs-variable">buttoColumn</span> = <span class="hljs-variable">std</span>::<span class="hljs-title class_">make_shared</span>&lt;<span class="hljs-title class_">ArkUIColumnNode</span>&gt;();</li><li>    <span class="hljs-variable">buttoColumn</span>-&gt;<span class="hljs-title class_">SetPadding</span>(<span class="hljs-number">30</span>, <span class="hljs-keyword">false</span>); <span class="hljs-comment">// 设置布局格式，调整组件内间距</span></li><li>    <span class="hljs-variable">buttoColumn</span>-&gt;<span class="hljs-title class_">SetWidth</span>(<span class="hljs-number">300</span>);</li><li>    <span class="hljs-comment">// 创建容器，用于存放playButton按键</span></li><li>    <span class="hljs-variable">auto</span> <span class="hljs-variable">playButtonColumn</span> = <span class="hljs-variable">std</span>::<span class="hljs-title class_">make_shared</span>&lt;<span class="hljs-title class_">ArkUIColumnNode</span>&gt;();</li><li>    <span class="hljs-variable">playButtonColumn</span>-&gt;<span class="hljs-title class_">SetPadding</span>(<span class="hljs-number">10</span>, <span class="hljs-keyword">false</span>); <span class="hljs-comment">// 设置布局格式，调整组件内间距</span></li><li>    <span class="hljs-variable">playButtonColumn</span>-&gt;<span class="hljs-title class_">SetWidth</span>(<span class="hljs-number">300</span>);</li><li>    <span class="hljs-comment">// 设置Animator播放按钮</span></li><li>    <span class="hljs-variable">auto</span> <span class="hljs-variable">playButton</span> = <span class="hljs-variable">std</span>::<span class="hljs-title class_">make_shared</span>&lt;<span class="hljs-title class_">ArkUIButtonNode</span>&gt;();</li><li>    <span class="hljs-variable">playButton</span>-&gt;<span class="hljs-title class_">SetButtonLabel</span>("<span class="hljs-title class_">play</span>");</li><li>    <span class="hljs-variable">playButton</span>-&gt;<span class="hljs-title class_">RegisterNodeEvent</span>(<span class="hljs-variable">playButton</span>-&gt;<span class="hljs-title class_">GetHandle</span>(), <span class="hljs-title class_">NODE_ON_CLICK</span>, <span class="hljs-number">4</span>, <span class="hljs-title class_">nullptr</span>);</li><li>    <span class="hljs-variable">auto</span> <span class="hljs-variable">onTouchPlay</span> = [](<span class="hljs-variable">ArkUI_NodeEvent</span> *<span class="hljs-variable">event</span>) {</li><li>        <span class="hljs-comment">// 点击button按钮时触发该逻辑</span></li><li>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_">OH_ArkUI_NodeEvent_GetTargetId</span>(<span class="hljs-variable">event</span>) == <span class="hljs-number">4</span>) {</li><li>            <span class="hljs-title function_">OH_ArkUI_Animator_Play</span>(<span class="hljs-variable">animatorHandle</span>);</li><li>        }</li><li>    };</li><li>    <span class="hljs-variable">playButton</span>-&gt;<span class="hljs-title class_">RegisterNodeEventReceiver</span>(<span class="hljs-title class_">onTouchPlay</span>);</li><li>    <span class="hljs-comment">// 设置Animator结束按钮</span></li><li>    <span class="hljs-variable">auto</span> <span class="hljs-variable">finishButton</span> = <span class="hljs-variable">std</span>::<span class="hljs-title class_">make_shared</span>&lt;<span class="hljs-title class_">ArkUIButtonNode</span>&gt;();</li><li>    <span class="hljs-variable">finishButton</span>-&gt;<span class="hljs-title class_">SetButtonLabel</span>("<span class="hljs-title class_">finish</span>");</li><li>    <span class="hljs-variable">finishButton</span>-&gt;<span class="hljs-title class_">RegisterNodeEvent</span>(<span class="hljs-variable">finishButton</span>-&gt;<span class="hljs-title class_">GetHandle</span>(), <span class="hljs-title class_">NODE_ON_CLICK</span>, <span class="hljs-number">5</span>, <span class="hljs-title class_">nullptr</span>);</li><li>    <span class="hljs-variable">auto</span> <span class="hljs-variable">onTouchFinish</span> = [](<span class="hljs-variable">ArkUI_NodeEvent</span> *<span class="hljs-variable">event</span>) {</li><li>        <span class="hljs-comment">// 点击button按钮时触发该逻辑</span></li><li>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_">OH_ArkUI_NodeEvent_GetTargetId</span>(<span class="hljs-variable">event</span>) == <span class="hljs-number">5</span>) {</li><li>            <span class="hljs-title function_">OH_ArkUI_Animator_Finish</span>(<span class="hljs-variable">animatorHandle</span>);</li><li>        }</li><li>    };</li><li>    <span class="hljs-variable">finishButton</span>-&gt;<span class="hljs-title class_">RegisterNodeEventReceiver</span>(<span class="hljs-title class_">onTouchFinish</span>);</li><li>    <span class="hljs-comment">// 创建容器，用于存放resetButton按键</span></li><li>    <span class="hljs-variable">auto</span> <span class="hljs-variable">resetButtonColumn</span> = <span class="hljs-variable">std</span>::<span class="hljs-title class_">make_shared</span>&lt;<span class="hljs-title class_">ArkUIColumnNode</span>&gt;();</li><li>    <span class="hljs-variable">resetButtonColumn</span>-&gt;<span class="hljs-title class_">SetPadding</span>(<span class="hljs-number">10</span>, <span class="hljs-keyword">false</span>); <span class="hljs-comment">// 设置布局格式，调整组件内间距</span></li><li>    <span class="hljs-variable">resetButtonColumn</span>-&gt;<span class="hljs-title class_">SetWidth</span>(<span class="hljs-number">300</span>);</li><li>    <span class="hljs-comment">// 设置Animator更新按钮</span></li><li>    <span class="hljs-variable">auto</span> <span class="hljs-variable">resetButton</span> = <span class="hljs-variable">std</span>::<span class="hljs-title class_">make_shared</span>&lt;<span class="hljs-title class_">ArkUIButtonNode</span>&gt;();</li><li>    <span class="hljs-variable">resetButton</span>-&gt;<span class="hljs-title class_">SetButtonLabel</span>("<span class="hljs-title class_">reset</span>");</li><li>    <span class="hljs-variable">resetButton</span>-&gt;<span class="hljs-title class_">RegisterNodeEvent</span>(<span class="hljs-variable">resetButton</span>-&gt;<span class="hljs-title class_">GetHandle</span>(), <span class="hljs-title class_">NODE_ON_CLICK</span>, <span class="hljs-number">6</span>, <span class="hljs-title class_">nullptr</span>);</li><li>    <span class="hljs-variable">auto</span> <span class="hljs-variable">onTouchReset</span> = [](<span class="hljs-variable">ArkUI_NodeEvent</span> *<span class="hljs-variable">event</span>) {</li><li>        <span class="hljs-comment">// 点击button按钮时触发该逻辑</span></li><li>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_">OH_ArkUI_NodeEvent_GetTargetId</span>(<span class="hljs-variable">event</span>) == <span class="hljs-number">6</span>) {</li><li>            <span class="hljs-keyword">static</span> <span class="hljs-variable">ArkUI_AnimatorOption</span> *<span class="hljs-variable">option</span> =  <span class="hljs-title function_">OH_ArkUI_AnimatorOption_Create</span>(<span class="hljs-number">0</span>); <span class="hljs-comment">// Animator动画状态数</span></li><li>            <span class="hljs-title function_">OH_ArkUI_AnimatorOption_SetDuration</span>(<span class="hljs-variable">option</span>, <span class="hljs-number">1000</span>);</li><li>            <span class="hljs-title function_">OH_ArkUI_AnimatorOption_SetDelay</span>(<span class="hljs-variable">option</span>, <span class="hljs-number">0</span>);</li><li>            <span class="hljs-title function_">OH_ArkUI_AnimatorOption_SetIterations</span>(<span class="hljs-variable">option</span>, <span class="hljs-number">4</span>);</li><li>            <span class="hljs-comment">// 根据自己得需要选择下述两种曲线适合得去设置OH_ArkUI_AnimatorOption_SetCurve</span></li><li>            <span class="hljs-variable">auto</span> <span class="hljs-variable">curve</span> = <span class="hljs-title function_">OH_ArkUI_Curve_CreateCurveByType</span>(<span class="hljs-variable">ARKUI_CURVE_EASE</span>); <span class="hljs-comment">// 动画以低速开始，然后加快，在结束前变慢</span></li><li>            <span class="hljs-variable">auto</span> <span class="hljs-variable">stepsCurve</span> = <span class="hljs-title function_">OH_ArkUI_Curve_CreateStepsCurve</span>(<span class="hljs-number">20</span>, <span class="hljs-keyword">true</span>); <span class="hljs-comment">// 构造阶梯曲线对象</span></li><li>            <span class="hljs-title function_">OH_ArkUI_AnimatorOption_SetCurve</span>(<span class="hljs-variable">option</span>, <span class="hljs-variable">curve</span>);</li><li>            <span class="hljs-title function_">OH_ArkUI_AnimatorOption_SetBegin</span>(<span class="hljs-variable">option</span>, <span class="hljs-number">200</span>);</li><li>            <span class="hljs-title function_">OH_ArkUI_AnimatorOption_SetEnd</span>(<span class="hljs-variable">option</span>, <span class="hljs-number">100</span>);</li><li>            <span class="hljs-title function_">OH_ArkUI_AnimatorOption_RegisterOnFrameCallback</span>(<span class="hljs-variable">option</span>, <span class="hljs-variable">nullptr</span>, [](<span class="hljs-variable">ArkUI_AnimatorOnFrameEvent</span> *<span class="hljs-variable">event</span>){</li><li>                <span class="hljs-title function_">OH_ArkUI_AnimatorOnFrameEvent_GetUserData</span>(<span class="hljs-variable">event</span>); <span class="hljs-comment">// 获取动画事件对象中的用户自定义对象</span></li><li>                <span class="hljs-variable">auto</span> <span class="hljs-variable">value</span> = <span class="hljs-title function_">OH_ArkUI_AnimatorOnFrameEvent_GetValue</span>(<span class="hljs-variable">event</span>); <span class="hljs-comment">// 获取动画事件对象中的当前进度</span></li><li>                <span class="hljs-variable">g_animator_button</span>-&gt;<span class="hljs-title class_">SetWidth</span>(<span class="hljs-title class_">value</span>);</li><li>            });</li><li>            <span class="hljs-title function_">OH_ArkUI_Animator_ResetAnimatorOption</span>(<span class="hljs-variable">animatorHandle</span>, <span class="hljs-variable">option</span>);</li><li>        }</li><li>    };</li><li>    <span class="hljs-variable">resetButton</span>-&gt;<span class="hljs-title class_">RegisterNodeEventReceiver</span>(<span class="hljs-title class_">onTouchReset</span>);</li><li>    <span class="hljs-comment">// 设置Animator暂停按钮</span></li><li>    <span class="hljs-variable">auto</span> <span class="hljs-variable">pauseButton</span> = <span class="hljs-variable">std</span>::<span class="hljs-title class_">make_shared</span>&lt;<span class="hljs-title class_">ArkUIButtonNode</span>&gt;();</li><li>    <span class="hljs-variable">pauseButton</span>-&gt;<span class="hljs-title class_">SetButtonLabel</span>("<span class="hljs-title class_">pause</span>");</li><li>    <span class="hljs-variable">pauseButton</span>-&gt;<span class="hljs-title class_">RegisterNodeEvent</span>(<span class="hljs-variable">pauseButton</span>-&gt;<span class="hljs-title class_">GetHandle</span>(), <span class="hljs-title class_">NODE_ON_CLICK</span>, <span class="hljs-number">7</span>, <span class="hljs-title class_">nullptr</span>);</li><li>    <span class="hljs-variable">auto</span> <span class="hljs-variable">onTouchPause</span> = [](<span class="hljs-variable">ArkUI_NodeEvent</span> *<span class="hljs-variable">event</span>) {</li><li>        <span class="hljs-comment">// 点击button按钮时触发该逻辑</span></li><li>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_">OH_ArkUI_NodeEvent_GetTargetId</span>(<span class="hljs-variable">event</span>) == <span class="hljs-number">7</span>) {</li><li>            <span class="hljs-title function_">OH_ArkUI_Animator_Pause</span>(<span class="hljs-variable">animatorHandle</span>);</li><li>        }</li><li>    };</li><li>    <span class="hljs-variable">pauseButton</span>-&gt;<span class="hljs-title class_">RegisterNodeEventReceiver</span>(<span class="hljs-title class_">onTouchPause</span>);</li><li>    <span class="hljs-comment">// 创建容器，用于存放cancelButton按键</span></li><li>    <span class="hljs-variable">auto</span> <span class="hljs-variable">cancelButtonColumn</span> = <span class="hljs-variable">std</span>::<span class="hljs-title class_">make_shared</span>&lt;<span class="hljs-title class_">ArkUIColumnNode</span>&gt;();</li><li>    <span class="hljs-variable">cancelButtonColumn</span>-&gt;<span class="hljs-title class_">SetPadding</span>(<span class="hljs-number">10</span>, <span class="hljs-keyword">false</span>); <span class="hljs-comment">// 设置布局格式，调整组件内间距</span></li><li>    <span class="hljs-variable">cancelButtonColumn</span>-&gt;<span class="hljs-title class_">SetWidth</span>(<span class="hljs-number">300</span>);</li><li>    <span class="hljs-comment">// 设置Animator取消按钮</span></li><li>    <span class="hljs-variable">auto</span> <span class="hljs-variable">cancelButton</span> = <span class="hljs-variable">std</span>::<span class="hljs-title class_">make_shared</span>&lt;<span class="hljs-title class_">ArkUIButtonNode</span>&gt;();</li><li>    <span class="hljs-variable">cancelButton</span>-&gt;<span class="hljs-title class_">SetButtonLabel</span>("<span class="hljs-title class_">cancel</span>");</li><li>    <span class="hljs-variable">cancelButton</span>-&gt;<span class="hljs-title class_">RegisterNodeEvent</span>(<span class="hljs-variable">cancelButton</span>-&gt;<span class="hljs-title class_">GetHandle</span>(), <span class="hljs-title class_">NODE_ON_CLICK</span>, <span class="hljs-number">8</span>, <span class="hljs-title class_">nullptr</span>);</li><li>    <span class="hljs-variable">auto</span> <span class="hljs-variable">onTouchCancel</span> = [](<span class="hljs-variable">ArkUI_NodeEvent</span> *<span class="hljs-variable">event</span>) {</li><li>        <span class="hljs-comment">// 点击button按钮时触发该逻辑</span></li><li>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_">OH_ArkUI_NodeEvent_GetTargetId</span>(<span class="hljs-variable">event</span>) == <span class="hljs-number">8</span>) {</li><li>            <span class="hljs-title function_">OH_ArkUI_Animator_Cancel</span>(<span class="hljs-variable">animatorHandle</span>);</li><li>        }</li><li>    };</li><li>    <span class="hljs-variable">cancelButton</span>-&gt;<span class="hljs-title class_">RegisterNodeEventReceiver</span>(<span class="hljs-title class_">onTouchCancel</span>);</li><li>    <span class="hljs-comment">// 设置Animator以相反的顺序播放按钮</span></li><li>    <span class="hljs-variable">auto</span> <span class="hljs-variable">reverseButton</span> = <span class="hljs-variable">std</span>::<span class="hljs-title class_">make_shared</span>&lt;<span class="hljs-title class_">ArkUIButtonNode</span>&gt;();</li><li>    <span class="hljs-variable">reverseButton</span>-&gt;<span class="hljs-title class_">SetButtonLabel</span>("<span class="hljs-title class_">reverse</span>");</li><li>    <span class="hljs-variable">reverseButton</span>-&gt;<span class="hljs-title class_">RegisterNodeEvent</span>(<span class="hljs-variable">reverseButton</span>-&gt;<span class="hljs-title class_">GetHandle</span>(), <span class="hljs-title class_">NODE_ON_CLICK</span>, <span class="hljs-number">9</span>, <span class="hljs-title class_">nullptr</span>);</li><li>    <span class="hljs-variable">auto</span> <span class="hljs-variable">onTouchReverse</span> = [](<span class="hljs-variable">ArkUI_NodeEvent</span> *<span class="hljs-variable">event</span>) {</li><li>        <span class="hljs-comment">// 点击button按钮时触发该逻辑</span></li><li>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_">OH_ArkUI_NodeEvent_GetTargetId</span>(<span class="hljs-variable">event</span>) == <span class="hljs-number">9</span>) {</li><li>            <span class="hljs-title function_">OH_ArkUI_Animator_Reverse</span>(<span class="hljs-variable">animatorHandle</span>);</li><li>        }</li><li>    };</li><li>    <span class="hljs-variable">reverseButton</span>-&gt;<span class="hljs-title class_">RegisterNodeEventReceiver</span>(<span class="hljs-title class_">onTouchReverse</span>);</li><li>    <span class="hljs-comment">// 将button挂载在column上，返回column节点</span></li><li>    <span class="hljs-variable">column</span>-&gt;<span class="hljs-title class_">AddChild</span>(<span class="hljs-title class_">g_animator_text</span>);</li><li>    <span class="hljs-variable">column</span>-&gt;<span class="hljs-title class_">AddChild</span>(<span class="hljs-title class_">textNode</span>);</li><li>    <span class="hljs-variable">column</span>-&gt;<span class="hljs-title class_">AddChild</span>(<span class="hljs-title class_">button</span>);</li><li>    <span class="hljs-variable">buttoColumn</span>-&gt;<span class="hljs-title class_">AddChild</span>(<span class="hljs-title class_">createButton</span>);</li><li>    <span class="hljs-variable">playButtonColumn</span>-&gt;<span class="hljs-title class_">AddChild</span>(<span class="hljs-title class_">playButton</span>);</li><li>    <span class="hljs-variable">buttoColumn</span>-&gt;<span class="hljs-title class_">AddChild</span>(<span class="hljs-title class_">playButtonColumn</span>);</li><li>    <span class="hljs-variable">buttoColumn</span>-&gt;<span class="hljs-title class_">AddChild</span>(<span class="hljs-title class_">finishButton</span>);</li><li>    <span class="hljs-variable">resetButtonColumn</span>-&gt;<span class="hljs-title class_">AddChild</span>(<span class="hljs-title class_">resetButton</span>);</li><li>    <span class="hljs-variable">buttoColumn</span>-&gt;<span class="hljs-title class_">AddChild</span>(<span class="hljs-title class_">resetButtonColumn</span>);</li><li>    <span class="hljs-variable">buttoColumn</span>-&gt;<span class="hljs-title class_">AddChild</span>(<span class="hljs-title class_">pauseButton</span>);</li><li>    <span class="hljs-variable">cancelButtonColumn</span>-&gt;<span class="hljs-title class_">AddChild</span>(<span class="hljs-title class_">cancelButton</span>);</li><li>    <span class="hljs-variable">buttoColumn</span>-&gt;<span class="hljs-title class_">AddChild</span>(<span class="hljs-title class_">cancelButtonColumn</span>);</li><li>    <span class="hljs-variable">buttoColumn</span>-&gt;<span class="hljs-title class_">AddChild</span>(<span class="hljs-title class_">reverseButton</span>);</li><li>    <span class="hljs-variable">column</span>-&gt;<span class="hljs-title class_">AddChild</span>(<span class="hljs-title class_">buttoColumn</span>);</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-variable">column</span>;</li><li>}</li></ol></pre></div></div>     <p><span><img originheight="625" originwidth="293" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114737.69158795985973202964884165834407:50001231000000:2800:98AC105C53AEF467ADBC52D4D12F315CBB51175B5421D2BEAB461DF84AAAE62E.gif" class="notEnlarge" width="293" height="625"></span></p>    </div>   </div>   <div></div></div>