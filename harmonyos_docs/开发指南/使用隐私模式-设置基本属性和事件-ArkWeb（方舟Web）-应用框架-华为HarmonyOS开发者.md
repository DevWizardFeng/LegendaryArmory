<h1 _ngcontent-khs-c119="" class="doc-title ng-star-inserted" title="使用隐私模式"> 使用隐私模式 </h1>

<div _ngcontent-khs-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p>开发者在创建Web组件时，可以将可选参数<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-basic-components-web-i#weboptions" target="_blank">incognitoMode</a>设置为true，来开启Web组件的隐私模式。当使用隐私模式时，浏览网页时的Cookie、Cache Data等数据不会保存在本地的持久化文件，当隐私模式的Web组件被销毁时，Cookie、Cache Data等数据将不被记录下来。</p>    <ul>     <li>      <p>创建隐私模式的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-basic-components-web" target="_blank">Web组件</a>。</p>      <div _ngcontent-khs-c106="" class="highlight-div"><div _ngcontent-khs-c106="" class="highlight-div-header"><div _ngcontent-khs-c106="" class="highlight-div-header-left"><div _ngcontent-khs-c106="" class="handle-button expand-button"><div _ngcontent-khs-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-khs-c106="" class="highlight-div-header-right"><div _ngcontent-khs-c106="" class="handle-button ai-button"></div><div _ngcontent-khs-c106="" class="handle-button line-button"><div _ngcontent-khs-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-khs-c106="" class="handle-button theme-button"><div _ngcontent-khs-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-khs-c106="" class="handle-button copy-button"><div _ngcontent-khs-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-khs-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// xxx.ets</span></li><li><span class="hljs-keyword">import</span> { webview } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkWeb'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">WebComponent</span> {</li><li> <span class="hljs-attr">controller</span>: webview.<span class="hljs-property">WebviewController</span> = <span class="hljs-keyword">new</span> webview.<span class="hljs-title class_">WebviewController</span>();</li><li>
</li><li> <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>   <span class="hljs-title class_">Column</span>() {</li><li>     <span class="hljs-title class_">Web</span>({ <span class="hljs-attr">src</span>: <span class="hljs-string">'www.example.com'</span>, <span class="hljs-attr">controller</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span>, <span class="hljs-attr">incognitoMode</span>: <span class="hljs-literal">true</span> })</li><li>   }</li><li> }</li><li>}</li></ol></pre></div></div></li>     <li>      <p>通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-webview-webviewcontroller#isincognitomode11" target="_blank">isIncognitoMode</a> 判断当前Web组件是否是隐私模式。</p>      <div _ngcontent-khs-c106="" class="highlight-div"><div _ngcontent-khs-c106="" class="highlight-div-header"><div _ngcontent-khs-c106="" class="highlight-div-header-left"><div _ngcontent-khs-c106="" class="handle-button expand-button"><div _ngcontent-khs-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-khs-c106="" class="highlight-div-header-right"><div _ngcontent-khs-c106="" class="handle-button ai-button"></div><div _ngcontent-khs-c106="" class="handle-button line-button"><div _ngcontent-khs-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-khs-c106="" class="handle-button theme-button"><div _ngcontent-khs-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-khs-c106="" class="handle-button copy-button"><div _ngcontent-khs-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-khs-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// xxx.ets</span></li><li><span class="hljs-keyword">import</span> { webview } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkWeb'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">WebComponent</span> {</li><li>  <span class="hljs-attr">controller</span>: webview.<span class="hljs-property">WebviewController</span> = <span class="hljs-keyword">new</span> webview.<span class="hljs-title class_">WebviewController</span>();</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'isIncognitoMode'</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-keyword">try</span> {</li><li>            <span class="hljs-keyword">let</span> result = <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span>.<span class="hljs-title function_">isIncognitoMode</span>();</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'isIncognitoMode'</span> + result);</li><li>          } <span class="hljs-keyword">catch</span> (error) {</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`ErrorCode: <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> BusinessError).code}</span>,  Message: <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> BusinessError).message}</span>`</span>);</li><li>          }</li><li>        })</li><li>      <span class="hljs-title class_">Web</span>({ <span class="hljs-attr">src</span>: <span class="hljs-string">'www.example.com'</span>, <span class="hljs-attr">controller</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span> })</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div></li>    </ul>    <p>隐私模式提供了一系列接口，用于操作地理位置、Cookie以及Cache Data。</p>    <ul>     <li>      <p>通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-webview-geolocationpermissions#allowgeolocation" target="_blank">allowGeolocation</a>设置隐私模式下的Web组件允许指定来源使用地理位置。</p>      <div _ngcontent-khs-c106="" class="highlight-div"><div _ngcontent-khs-c106="" class="highlight-div-header"><div _ngcontent-khs-c106="" class="highlight-div-header-left"><div _ngcontent-khs-c106="" class="handle-button expand-button"><div _ngcontent-khs-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-khs-c106="" class="highlight-div-header-right"><div _ngcontent-khs-c106="" class="handle-button ai-button"></div><div _ngcontent-khs-c106="" class="handle-button line-button"><div _ngcontent-khs-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-khs-c106="" class="handle-button theme-button"><div _ngcontent-khs-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-khs-c106="" class="handle-button copy-button"><div _ngcontent-khs-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-khs-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// xxx.ets</span></li><li><span class="hljs-keyword">import</span> { webview } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkWeb'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">WebComponent</span> {</li><li>  <span class="hljs-attr">controller</span>: webview.<span class="hljs-property">WebviewController</span> = <span class="hljs-keyword">new</span> webview.<span class="hljs-title class_">WebviewController</span>();</li><li>  <span class="hljs-attr">origin</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">"file:///"</span>;</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'allowGeolocation'</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-keyword">try</span> {</li><li>            <span class="hljs-comment">// allowGeolocation第二个参数表示隐私模式（true）或非隐私模式（false）下，允许指定来源使用地理位置。</span></li><li>            webview.<span class="hljs-property">GeolocationPermissions</span>.<span class="hljs-title function_">allowGeolocation</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">origin</span>, <span class="hljs-literal">true</span>);</li><li>          } <span class="hljs-keyword">catch</span> (error) {</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`ErrorCode: <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> BusinessError).code}</span>,  Message: <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> BusinessError).message}</span>`</span>);</li><li>          }</li><li>        })</li><li>      <span class="hljs-title class_">Web</span>({ <span class="hljs-attr">src</span>: <span class="hljs-string">'www.example.com'</span>, <span class="hljs-attr">controller</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span>, <span class="hljs-attr">incognitoMode</span>: <span class="hljs-literal">true</span> })</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div></li>     <li>      <p>通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-webview-geolocationpermissions#deletegeolocation" target="_blank">deleteGeolocation</a>清除隐私模式下指定来源的地理位置权限状态。</p>      <div _ngcontent-khs-c106="" class="highlight-div"><div _ngcontent-khs-c106="" class="highlight-div-header"><div _ngcontent-khs-c106="" class="highlight-div-header-left"><div _ngcontent-khs-c106="" class="handle-button expand-button"><div _ngcontent-khs-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-khs-c106="" class="highlight-div-header-right"><div _ngcontent-khs-c106="" class="handle-button ai-button"></div><div _ngcontent-khs-c106="" class="handle-button line-button"><div _ngcontent-khs-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-khs-c106="" class="handle-button theme-button"><div _ngcontent-khs-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-khs-c106="" class="handle-button copy-button"><div _ngcontent-khs-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-khs-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// xxx.ets</span></li><li><span class="hljs-keyword">import</span> { webview } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkWeb'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">WebComponent</span> {</li><li>  <span class="hljs-attr">controller</span>: webview.<span class="hljs-property">WebviewController</span> = <span class="hljs-keyword">new</span> webview.<span class="hljs-title class_">WebviewController</span>();</li><li>  <span class="hljs-attr">origin</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">"file:///"</span>;</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'deleteGeolocation'</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-keyword">try</span> {</li><li>            <span class="hljs-comment">// deleteGeolocation第二个参数表示隐私模式（true）或非隐私模式（false）下，清除指定来源的地理位置权限状态。</span></li><li>            webview.<span class="hljs-property">GeolocationPermissions</span>.<span class="hljs-title function_">deleteGeolocation</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">origin</span>, <span class="hljs-literal">true</span>);</li><li>          } <span class="hljs-keyword">catch</span> (error) {</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`ErrorCode: <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> BusinessError).code}</span>,  Message: <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> BusinessError).message}</span>`</span>);</li><li>          }</li><li>        })</li><li>      <span class="hljs-title class_">Web</span>({ <span class="hljs-attr">src</span>: <span class="hljs-string">'www.example.com'</span>, <span class="hljs-attr">controller</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span>, <span class="hljs-attr">incognitoMode</span>: <span class="hljs-literal">true</span> })</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div></li>     <li>      <p>通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-webview-geolocationpermissions#getaccessiblegeolocation" target="_blank">getAccessibleGeolocation</a>以回调方式异步获取隐私模式下指定源的地理位置权限状态。</p>      <div _ngcontent-khs-c106="" class="highlight-div"><div _ngcontent-khs-c106="" class="highlight-div-header"><div _ngcontent-khs-c106="" class="highlight-div-header-left"><div _ngcontent-khs-c106="" class="handle-button expand-button"><div _ngcontent-khs-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-khs-c106="" class="highlight-div-header-right"><div _ngcontent-khs-c106="" class="handle-button ai-button"></div><div _ngcontent-khs-c106="" class="handle-button line-button"><div _ngcontent-khs-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-khs-c106="" class="handle-button theme-button"><div _ngcontent-khs-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-khs-c106="" class="handle-button copy-button"><div _ngcontent-khs-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-khs-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// xxx.ets</span></li><li><span class="hljs-keyword">import</span> { webview } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkWeb'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">WebComponent</span> {</li><li>  <span class="hljs-attr">controller</span>: webview.<span class="hljs-property">WebviewController</span> = <span class="hljs-keyword">new</span> webview.<span class="hljs-title class_">WebviewController</span>();</li><li>  <span class="hljs-attr">origin</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">"file:///"</span>;</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'getAccessibleGeolocation'</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-keyword">try</span> {</li><li>            <span class="hljs-comment">// getAccessibleGeolocation第三个参数表示隐私模式（true）或非隐私模式（false）下，以回调方式异步获取指定源的地理位置权限状态。</span></li><li>            webview.<span class="hljs-property">GeolocationPermissions</span>.<span class="hljs-title function_">getAccessibleGeolocation</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">origin</span>, <span class="hljs-function">(<span class="hljs-params">error, result</span>) =&gt;</span> {</li><li>              <span class="hljs-keyword">if</span> (error) {</li><li>                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`getAccessibleGeolocationAsync error: + Code: <span class="hljs-subst">${error.code}</span>, message: <span class="hljs-subst">${error.message}</span>`</span>);</li><li>                <span class="hljs-keyword">return</span>;</li><li>              }</li><li>              <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'getAccessibleGeolocationAsync result: '</span> + result);</li><li>            }, <span class="hljs-literal">true</span>);</li><li>          } <span class="hljs-keyword">catch</span> (error) {</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`ErrorCode: <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> BusinessError).code}</span>,  Message: <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> BusinessError).message}</span>`</span>);</li><li>          }</li><li>        })</li><li>      <span class="hljs-title class_">Web</span>({ <span class="hljs-attr">src</span>: <span class="hljs-string">'www.example.com'</span>, <span class="hljs-attr">controller</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span>, <span class="hljs-attr">incognitoMode</span>: <span class="hljs-literal">true</span> })</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div></li>     <li>      <p>通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-webview-webstorage#deletealldata" target="_blank">deleteAllData</a>清除隐私模式下Web SQL当前使用的所有存储。</p>      <div _ngcontent-khs-c106="" class="highlight-div"><div _ngcontent-khs-c106="" class="highlight-div-header"><div _ngcontent-khs-c106="" class="highlight-div-header-left"><div _ngcontent-khs-c106="" class="handle-button expand-button"><div _ngcontent-khs-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-khs-c106="" class="highlight-div-header-right"><div _ngcontent-khs-c106="" class="handle-button ai-button"></div><div _ngcontent-khs-c106="" class="handle-button line-button"><div _ngcontent-khs-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-khs-c106="" class="handle-button theme-button"><div _ngcontent-khs-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-khs-c106="" class="handle-button copy-button"><div _ngcontent-khs-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-khs-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// xxx.ets</span></li><li><span class="hljs-keyword">import</span> { webview } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkWeb'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">WebComponent</span> {</li><li>  <span class="hljs-attr">controller</span>: webview.<span class="hljs-property">WebviewController</span> = <span class="hljs-keyword">new</span> webview.<span class="hljs-title class_">WebviewController</span>();</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'deleteAllData'</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-keyword">try</span> {</li><li>            <span class="hljs-comment">// deleteAllData参数表示删除所有隐私模式（true）或非隐私模式（false）下，内存中的web数据。</span></li><li>            webview.<span class="hljs-property">WebStorage</span>.<span class="hljs-title function_">deleteAllData</span>(<span class="hljs-literal">true</span>);</li><li>          } <span class="hljs-keyword">catch</span> (error) {</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`ErrorCode: <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> BusinessError).code}</span>,  Message: <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> BusinessError).message}</span>`</span>);</li><li>          }</li><li>        })</li><li>      <span class="hljs-title class_">Web</span>({ <span class="hljs-attr">src</span>: $rawfile(<span class="hljs-string">'index.html'</span>), <span class="hljs-attr">controller</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span>, <span class="hljs-attr">incognitoMode</span>: <span class="hljs-literal">true</span> })</li><li>        .<span class="hljs-title function_">databaseAccess</span>(<span class="hljs-literal">true</span>)</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>      <p>加载的html文件。</p>      <div _ngcontent-khs-c106="" class="highlight-div"><div _ngcontent-khs-c106="" class="highlight-div-header"><div _ngcontent-khs-c106="" class="highlight-div-header-left"><div _ngcontent-khs-c106="" class="handle-button expand-button"><div _ngcontent-khs-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-khs-c106="" class="highlight-div-header-right"><div _ngcontent-khs-c106="" class="handle-button ai-button"></div><div _ngcontent-khs-c106="" class="handle-button line-button"><div _ngcontent-khs-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-khs-c106="" class="handle-button theme-button"><div _ngcontent-khs-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-khs-c106="" class="handle-button copy-button"><div _ngcontent-khs-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-khs-c106="" class="highlight-scroll-div"><pre class="html prettyprint linenums hljs language-xml" hw-language="html" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">&lt;!-- index.html --&gt;</span></li><li><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span></li><li><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span></li><li><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span></li><li> <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span></li><li> <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span></li><li> <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;</span><span class="language-javascript"></span></li><li><span class="language-javascript"></span></li><li><span class="language-javascript">   <span class="hljs-keyword">var</span> db = <span class="hljs-title function_">openDatabase</span>(<span class="hljs-string">'mydb'</span>,<span class="hljs-string">'1.0'</span>,<span class="hljs-string">'Test DB'</span>,<span class="hljs-number">2</span> * <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span>);</span></li><li><span class="language-javascript">   <span class="hljs-keyword">var</span> msg;</span></li><li><span class="language-javascript"></span></li><li><span class="language-javascript">   db.<span class="hljs-title function_">transaction</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">tx</span>){</span></li><li><span class="language-javascript">     tx.<span class="hljs-title function_">executeSql</span>(<span class="hljs-string">'INSERT INTO LOGS (id,log) VALUES(1,"test1")'</span>);</span></li><li><span class="language-javascript">     tx.<span class="hljs-title function_">executeSql</span>(<span class="hljs-string">'INSERT INTO LOGS (id,log) VALUES(2,"test2")'</span>);</span></li><li><span class="language-javascript">     msg = <span class="hljs-string">'&lt;p&gt;数据表已创建,且插入了两条数据。&lt;/p&gt;'</span>;</span></li><li><span class="language-javascript"></span></li><li><span class="language-javascript">     <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'#status'</span>).<span class="hljs-property">innerHTML</span> = msg;</span></li><li><span class="language-javascript">   });</span></li><li><span class="language-javascript"></span></li><li><span class="language-javascript">   db.<span class="hljs-title function_">transaction</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">tx</span>){</span></li><li><span class="language-javascript">     tx.<span class="hljs-title function_">executeSql</span>(<span class="hljs-string">'SELECT * FROM LOGS'</span>, [], <span class="hljs-keyword">function</span> (<span class="hljs-params">tx, results</span>) {</span></li><li><span class="language-javascript">       <span class="hljs-keyword">var</span> len = results.<span class="hljs-property">rows</span>.<span class="hljs-property">length</span>,i;</span></li><li><span class="language-javascript">       msg = <span class="hljs-string">"&lt;p&gt;查询记录条数："</span> + len + <span class="hljs-string">"&lt;/p&gt;"</span>;</span></li><li><span class="language-javascript"></span></li><li><span class="language-javascript">       <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'#status'</span>).<span class="hljs-property">innerHTML</span> += msg;</span></li><li><span class="language-javascript"></span></li><li><span class="language-javascript">           <span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>; i &lt; len; i++){</span></li><li><span class="language-javascript">             msg = <span class="hljs-string">"&lt;p&gt;&lt;b&gt;"</span> + results.<span class="hljs-property">rows</span>.<span class="hljs-title function_">item</span>(i).<span class="hljs-property">log</span> + <span class="hljs-string">"&lt;/b&gt;&lt;/p&gt;"</span>;</span></li><li><span class="language-javascript"></span></li><li><span class="language-javascript">       <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">'#status'</span>).<span class="hljs-property">innerHTML</span> += msg;</span></li><li><span class="language-javascript">       }</span></li><li><span class="language-javascript">     },<span class="hljs-literal">null</span>);</span></li><li><span class="language-javascript">   });</span></li><li><span class="language-javascript"></span></li><li><span class="language-javascript">   </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></li><li><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span></li><li><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span></li><li><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"status"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"status"</span>&gt;</span>状态信息<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></li><li><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></li><li><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></li></ol></pre></div></div></li>     <li>      <p>通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-webview-webcookiemanager#fetchcookiesync11" target="_blank">fetchCookieSync</a>获取隐私模式下指定url对应cookie的值。</p>      <div _ngcontent-khs-c106="" class="highlight-div"><div _ngcontent-khs-c106="" class="highlight-div-header"><div _ngcontent-khs-c106="" class="highlight-div-header-left"><div _ngcontent-khs-c106="" class="handle-button expand-button"><div _ngcontent-khs-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-khs-c106="" class="highlight-div-header-right"><div _ngcontent-khs-c106="" class="handle-button ai-button"></div><div _ngcontent-khs-c106="" class="handle-button line-button"><div _ngcontent-khs-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-khs-c106="" class="handle-button theme-button"><div _ngcontent-khs-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-khs-c106="" class="handle-button copy-button"><div _ngcontent-khs-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-khs-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// xxx.ets</span></li><li><span class="hljs-keyword">import</span> { webview } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkWeb'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">WebComponent</span> {</li><li>  <span class="hljs-attr">controller</span>: webview.<span class="hljs-property">WebviewController</span> = <span class="hljs-keyword">new</span> webview.<span class="hljs-title class_">WebviewController</span>();</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'fetchCookieSync'</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-keyword">try</span> {</li><li>            <span class="hljs-comment">// fetchCookieSync第二个参数表示获取隐私模式（true）或非隐私模式（false）下，webview的内存cookies。</span></li><li>            <span class="hljs-keyword">let</span> value = webview.<span class="hljs-property">WebCookieManager</span>.<span class="hljs-title function_">fetchCookieSync</span>(<span class="hljs-string">'https://www.example.com'</span>, <span class="hljs-literal">true</span>);</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"fetchCookieSync cookie = "</span> + value);</li><li>          } <span class="hljs-keyword">catch</span> (error) {</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`ErrorCode: <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> BusinessError).code}</span>,  Message: <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> BusinessError).message}</span>`</span>);</li><li>          }</li><li>        })</li><li>      <span class="hljs-title class_">Web</span>({ <span class="hljs-attr">src</span>: <span class="hljs-string">'www.example.com'</span>, <span class="hljs-attr">controller</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span>, <span class="hljs-attr">incognitoMode</span>: <span class="hljs-literal">true</span> })</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div></li>     <li>      <p>通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-webview-webcookiemanager#configcookiesync11" target="_blank">configCookieSync</a>设置隐私模式下指定url的单个cookie的值。</p>      <div _ngcontent-khs-c106="" class="highlight-div"><div _ngcontent-khs-c106="" class="highlight-div-header"><div _ngcontent-khs-c106="" class="highlight-div-header-left"><div _ngcontent-khs-c106="" class="handle-button expand-button"><div _ngcontent-khs-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-khs-c106="" class="highlight-div-header-right"><div _ngcontent-khs-c106="" class="handle-button ai-button"></div><div _ngcontent-khs-c106="" class="handle-button line-button"><div _ngcontent-khs-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-khs-c106="" class="handle-button theme-button"><div _ngcontent-khs-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-khs-c106="" class="handle-button copy-button"><div _ngcontent-khs-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-khs-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// xxx.ets</span></li><li><span class="hljs-keyword">import</span> { webview } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkWeb'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">WebComponent</span> {</li><li>  <span class="hljs-attr">controller</span>: webview.<span class="hljs-property">WebviewController</span> = <span class="hljs-keyword">new</span> webview.<span class="hljs-title class_">WebviewController</span>();</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'configCookieSync'</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-keyword">try</span> {</li><li>            <span class="hljs-comment">// configCookieSync第三个参数表示获取隐私模式（true）或非隐私模式（false）下，对应url的cookies。</span></li><li>            webview.<span class="hljs-property">WebCookieManager</span>.<span class="hljs-title function_">configCookieSync</span>(<span class="hljs-string">'https://www.example.com'</span>, <span class="hljs-string">'a=b'</span>, <span class="hljs-literal">true</span>);</li><li>          } <span class="hljs-keyword">catch</span> (error) {</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`ErrorCode: <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> BusinessError).code}</span>,  Message: <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> BusinessError).message}</span>`</span>);</li><li>          }</li><li>        })</li><li>      <span class="hljs-title class_">Web</span>({ <span class="hljs-attr">src</span>: <span class="hljs-string">'www.example.com'</span>, <span class="hljs-attr">controller</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span>, <span class="hljs-attr">incognitoMode</span>: <span class="hljs-literal">true</span> })</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div></li>     <li>      <p>通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-webview-webcookiemanager#existcookie" target="_blank">existCookie</a>查询隐私模式下是否存在cookie。</p>      <div _ngcontent-khs-c106="" class="highlight-div"><div _ngcontent-khs-c106="" class="highlight-div-header"><div _ngcontent-khs-c106="" class="highlight-div-header-left"><div _ngcontent-khs-c106="" class="handle-button expand-button"><div _ngcontent-khs-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-khs-c106="" class="highlight-div-header-right"><div _ngcontent-khs-c106="" class="handle-button ai-button"></div><div _ngcontent-khs-c106="" class="handle-button line-button"><div _ngcontent-khs-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-khs-c106="" class="handle-button theme-button"><div _ngcontent-khs-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-khs-c106="" class="handle-button copy-button"><div _ngcontent-khs-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-khs-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// xxx.ets</span></li><li><span class="hljs-keyword">import</span> { webview } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkWeb'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">WebComponent</span> {</li><li>  <span class="hljs-attr">controller</span>: webview.<span class="hljs-property">WebviewController</span> = <span class="hljs-keyword">new</span> webview.<span class="hljs-title class_">WebviewController</span>();</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'existCookie'</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-comment">// existCookie参数表示隐私模式（true）或非隐私模式（false）下，查询是否存在cookies。</span></li><li>          <span class="hljs-keyword">let</span> result = webview.<span class="hljs-property">WebCookieManager</span>.<span class="hljs-title function_">existCookie</span>(<span class="hljs-literal">true</span>);</li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"result: "</span> + result);</li><li>        })</li><li>      <span class="hljs-title class_">Web</span>({ <span class="hljs-attr">src</span>: <span class="hljs-string">'www.example.com'</span>, <span class="hljs-attr">controller</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span>, <span class="hljs-attr">incognitoMode</span>: <span class="hljs-literal">true</span> })</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div></li>     <li>      <p>通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-webview-webcookiemanager#clearallcookiessync11" target="_blank">clearAllCookiesSync</a>清除隐私模式下所有cookie。</p>      <div _ngcontent-khs-c106="" class="highlight-div"><div _ngcontent-khs-c106="" class="highlight-div-header"><div _ngcontent-khs-c106="" class="highlight-div-header-left"><div _ngcontent-khs-c106="" class="handle-button expand-button"><div _ngcontent-khs-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-khs-c106="" class="highlight-div-header-right"><div _ngcontent-khs-c106="" class="handle-button ai-button"></div><div _ngcontent-khs-c106="" class="handle-button line-button"><div _ngcontent-khs-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-khs-c106="" class="handle-button theme-button"><div _ngcontent-khs-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-khs-c106="" class="handle-button copy-button"><div _ngcontent-khs-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-khs-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// xxx.ets</span></li><li><span class="hljs-keyword">import</span> { webview } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkWeb'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">WebComponent</span> {</li><li>  <span class="hljs-attr">controller</span>: webview.<span class="hljs-property">WebviewController</span> = <span class="hljs-keyword">new</span> webview.<span class="hljs-title class_">WebviewController</span>();</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'clearAllCookiesSync'</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-comment">// clearAllCookiesSync参数表示清除隐私模式（true）或非隐私模式（false）下，webview的所有内存cookies。</span></li><li>          webview.<span class="hljs-property">WebCookieManager</span>.<span class="hljs-title function_">clearAllCookiesSync</span>(<span class="hljs-literal">true</span>);</li><li>        })</li><li>      <span class="hljs-title class_">Web</span>({ <span class="hljs-attr">src</span>: <span class="hljs-string">'www.example.com'</span>, <span class="hljs-attr">controller</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span>, <span class="hljs-attr">incognitoMode</span>: <span class="hljs-literal">true</span> })</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div></li>    </ul>   </div>   <div></div></div>