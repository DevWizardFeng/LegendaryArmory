<h1 _ngcontent-euu-c119="" class="doc-title ng-star-inserted" title="再次向用户申请授权"> 再次向用户申请授权 </h1>

<div _ngcontent-euu-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p>当应用通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-abilityaccessctrl#requestpermissionsfromuser9" target="_blank">requestPermissionsFromUser()</a>拉起弹框<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/request-user-authorization">请求用户授权</a>时，如果用户拒绝授权，应用将无法再次通过requestPermissionsFromUser()拉起弹框。用户需要在系统设置中手动授权。</p>    <p>在“设置”应用中的路径如下：</p>    <ul>     <li>路径一：设置 &gt; 隐私与安全 &gt; 权限类型（如位置信息） &gt; 具体应用</li>     <li>路径二：设置 &gt; 应用和元服务 &gt; 某个应用</li>    </ul>    <p>应用也可以通过调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-abilityaccessctrl#requestpermissiononsetting12" target="_blank">requestPermissionOnSetting()</a>，直接拉起权限设置弹框，引导用户授权。</p>    <p>效果展示：</p>    <p><span><img originheight="641" originwidth="313" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211115107.81570401062021853282359430057482:50001231000000:2800:02945678AC85D0E7B1203F3EE9C77CB9C013B06EC3A35DDB1367532E0EB6C9AB.png" width="313" height="641"></span></p>    <p>以下示例代码展示了如何再次拉起弹框申请ohos.permission.APPROXIMATELY_LOCATION权限。</p>    <div _ngcontent-euu-c106="" class="highlight-div"><div _ngcontent-euu-c106="" class="highlight-div-header"><div _ngcontent-euu-c106="" class="highlight-div-header-left"><div _ngcontent-euu-c106="" class="handle-button expand-button"><div _ngcontent-euu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-euu-c106="" class="highlight-div-header-right"><div _ngcontent-euu-c106="" class="handle-button ai-button"></div><div _ngcontent-euu-c106="" class="handle-button line-button"><div _ngcontent-euu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-euu-c106="" class="handle-button theme-button"><div _ngcontent-euu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-euu-c106="" class="handle-button copy-button"><div _ngcontent-euu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-euu-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { abilityAccessCtrl, <span class="hljs-title class_">Context</span>, common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">atManager</span>: abilityAccessCtrl.<span class="hljs-property">AtManager</span> = abilityAccessCtrl.<span class="hljs-title function_">createAtManager</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">context</span>: <span class="hljs-title class_">Context</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li>atManager.<span class="hljs-title function_">requestPermissionOnSetting</span>(context, [<span class="hljs-string">'ohos.permission.APPROXIMATELY_LOCATION'</span>]).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">data: <span class="hljs-built_in">Array</span>&lt;abilityAccessCtrl.GrantStatus&gt;</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`requestPermissionOnSetting success, result: <span class="hljs-subst">${data}</span>`</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`requestPermissionOnSetting fail, code: <span class="hljs-subst">${err.code}</span>, message: <span class="hljs-subst">${err.message}</span>`</span>);</li><li>});</li></ol></pre></div></div>   </div>   <div></div></div>