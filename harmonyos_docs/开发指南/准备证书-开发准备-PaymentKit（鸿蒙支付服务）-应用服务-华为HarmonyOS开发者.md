<h1 _ngcontent-icy-c119="" class="doc-title ng-star-inserted" title="准备证书"> 准备证书 </h1>

<div _ngcontent-icy-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p>开发者接入华为支付开放API接口，需要通过证书来对请求内容及响应内容做签名和验证签名，以保证请求的安全性和可靠性。</p>    <p>本文将介绍接入过程中相关证书的作用和获取方法。在准备证书前，请在<a href="https://petalpay-merchant.cloud.huawei.com/" target="_blank">华为支付商户平台</a>入网，具体请参见<a href="https://developer.huawei.com/consumer/cn/doc/hwzf-jieruliucheng-0000001251448455" target="_blank">商户入网</a>。</p>    <p>需准备证书：商户证书、华为支付证书（公钥）。</p>    <div class="tiledSection">     <h2 id="section19670184891617">证书说明<i class="anchor-icon anchor-icon-link" anchorid="section19670184891617" tips="复制节点链接"></i></h2>          <p>证书使用如图所示：</p>     <p><span><img height="553.7888888888889" originheight="558" originwidth="927" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114628.11083244742820984612948673791936:50001231000000:2800:C50D7FB319FFC189E1F7E4452DDA628EE4C942AEBEE16AED2948682F75EA24EC.png" title="点击放大" width="920"></span></p>    </div>    <div class="tiledSection">     <h2 id="section1886895941411">商户证书<i class="anchor-icon anchor-icon-link" anchorid="section1886895941411" tips="复制节点链接"></i></h2>          <p>商户证书是指由商户自行生成（参见<a href="/consumer/cn/doc/harmonyos-guides/payment-certificates-config#section08051431101916">生成商户证书</a>）或申请（可自行选择符合资质的CA认证机构申请证书）的，包含商户公钥和私钥信息的证书。</p>     <p>私钥用于商户在华为支付开放API接口请求过程中的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-rest-overview#section174821258151218" target="_blank">签名</a>，公钥用于提供给华为支付侧进行请求验签。</p>     <p>该证书文件要求为pem格式，支持RSA和SM2两种算法类型的证书。</p>    </div>    <p><strong>证书私钥</strong></p>    <p>商户自行生成或申请商户证书时，会配套生成商户私钥。</p>    <ul>     <li>商户私钥用于商户对华为支付开放API请求中的信息进行签名。</li>     <li>请妥善保管好商户私钥文件，不要把私钥文件暴露在公共场合，如上传到Github，写在客户端代码等。</li>    </ul>    <p><strong>证书</strong><strong>公钥</strong></p>    <p>商户自行生成或申请商户证书时，会配套生成商户公钥。</p>    <ul>     <li id="li92221591687"><a name="ZH-CN_TOPIC_0000002419610128__li92221591687"></a><a name="li92221591687"></a>商户需将生成的证书公钥上传到<a href="https://petalpay-merchant.cloud.huawei.com/" target="_blank">华为支付商户平台</a>来获取证书ID，证书ID为请求华为支付开放API接口时请求头鉴权信息<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-model#section11744172016145" target="_blank">PayMercAuth</a>对象中的authId字段以及订单信息参数<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-model#section159202591414" target="_blank">orderStr</a>中的auth_id字段。</li>     <li>证书上传（参见<a href="/consumer/cn/doc/harmonyos-guides/payment-certificates-config#section325481952016">上传商户证书</a>）后，可以在“商户中心 &gt; 证书管理 &gt; 上传商户证书 &gt; 证书ID”处获取。      <p><span><img height="264.74277777777775" originheight="1082" originwidth="3760" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114628.64974672719982590939543869794712:50001231000000:2800:C7F7DA21702EAF97B1D39E03BCC4CEEB0A19F53240059D9D7955FB28033B3751.png" title="点击放大" width="920"></span></p></li>    </ul>    <div class="tiledSection">     <h3 id="section08051431101916" class="firsth2">生成商户证书<i class="anchor-icon anchor-icon-link" anchorid="section08051431101916" tips="复制节点链接"></i></h3>          <p><strong>方式1：使用JavaScript的库线下生成（生成RSA算法类型证书为例，推荐方法）</strong></p>    </div>    <ol>     <li id="li971411417543"><a name="ZH-CN_TOPIC_0000002419610128__li971411417543"></a><a name="li971411417543"></a>配置Node.js执行环境。下面以Windows开发环境为例：      <p><a name="ZH-CN_TOPIC_0000002419610128__li971411417543"></a><a name="li971411417543"></a>登录<a href="https://nodejs.org/en/download/" target="_blank">Node.js</a>官方网站，下载Node.js软件包。请选择LTS版本，并根据电脑操作系统选择对应的软件包。</p>      <p><span><img height="569.9016666666666" originheight="1452" originwidth="2344" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114629.85262368039987013226573930904463:50001231000000:2800:137D16264D95A3916A889525E23285B94957C68223C14F9D6843F2FC59A0E0C0.png" title="点击放大" width="920"></span></p>      <div class="p">       双击下载后的软件包进行安装。全部按照默认设置点击<span class="uicontrol">“Next”</span>，直至<span class="uicontrol">“Finish”</span>。安装过程中，Node.js会自动在系统的path环境变量中配置node.exe的目录路径。       <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">         <p>如果安装Node.js没有选择默认安装目录，则需要在系统变量“path”中手工添加环境变量信息<span class="menucascade">“<span class="uicontrol">我的电脑</span> &gt; <span class="uicontrol">属性</span> &gt; <span class="uicontrol">高级系统设置</span> &gt; <span class="uicontrol">高级</span> &gt; <span class="uicontrol">环境变量</span>”</span>增加Node.js的安装路径。</p>        </div></div></div>      </div>      <p>打开命令行工具，输入<strong>node -v</strong>命令，能正常查询Node.js的版本号，说明Node.js执行环境配置完成。</p>      <p><span><img originheight="49" originwidth="303" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114629.24053863993526368559560237687382:50001231000000:2800:14AE2262AB12490D27E480AEA2966E38B6C7733177E6C1BA5549FA0EDDBAB2EF.png" width="303" height="49"></span></p></li>     <li>使用文本编辑器新建文件（编码为UTF-8），拷贝以下代码到文件中并保存命名为<span class="filepath">“generateKeyPair.js”</span>。      <div _ngcontent-icy-c106="" class="highlight-div"><div _ngcontent-icy-c106="" class="highlight-div-header"><div _ngcontent-icy-c106="" class="highlight-div-header-left"><div _ngcontent-icy-c106="" class="handle-button expand-button"><div _ngcontent-icy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-icy-c106="" class="highlight-div-header-right"><div _ngcontent-icy-c106="" class="handle-button ai-button"></div><div _ngcontent-icy-c106="" class="handle-button line-button"><div _ngcontent-icy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-icy-c106="" class="handle-button theme-button"><div _ngcontent-icy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-icy-c106="" class="handle-button copy-button"><div _ngcontent-icy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-icy-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">const</span> crypto = <span class="hljs-built_in">require</span>(<span class="hljs-string">'crypto'</span>);</li><li><span class="hljs-comment">// 生成密钥对</span></li><li><span class="hljs-keyword">const</span> { publicKey, privateKey } = crypto.<span class="hljs-title function_">generateKeyPairSync</span>(<span class="hljs-string">'rsa'</span>, {</li><li>  <span class="hljs-attr">modulusLength</span>: <span class="hljs-number">3072</span>, <span class="hljs-comment">// 密钥长度，不少于3072 </span></li><li>  <span class="hljs-attr">publicKeyEncoding</span>: {</li><li>    <span class="hljs-attr">type</span>: <span class="hljs-string">'spki'</span>, <span class="hljs-comment">// 公钥编码格式</span></li><li>    <span class="hljs-attr">format</span>: <span class="hljs-string">'pem'</span> <span class="hljs-comment">// 公钥输出格式</span></li><li>  },</li><li>  <span class="hljs-attr">privateKeyEncoding</span>: {</li><li>    <span class="hljs-attr">type</span>: <span class="hljs-string">'pkcs8'</span>, <span class="hljs-comment">// 私钥编码格式</span></li><li>    <span class="hljs-attr">format</span>: <span class="hljs-string">'pem'</span> <span class="hljs-comment">// 私钥输出格式</span></li><li>  }</li><li>});</li><li><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'生成的公钥：'</span>);</li><li><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(publicKey);</li><li><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'生成的私钥：'</span>);</li><li><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(privateKey);</li></ol></pre></div></div></li>     <li>打开命令行工具，进入generateKeyPair.js所在目录，执行<strong>node generateKeyPair.js</strong>命令。</li>     <li>从结果中拷贝生成的公私钥并保存。结果如下图所示：      <p><span><img height="602.8172222222222" originheight="735" originwidth="1119" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114629.72980383242513998985272847046958:50001231000000:2800:2BEAC1446AACC2E6B19DD1FA4A80119656D41AF8644096139BCFA9D8B54F90E1.png" title="点击放大" width="920"></span></p></li>    </ol>    <p><strong>方式2：使用在线工具生成</strong></p>    <p>开发者可自行搜索使用相关开源的在线工具或网站生成相应证书公私钥对。</p>    <div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content">      <p>生成公私钥为敏感操作，请谨慎使用，建议开发者自行生成密钥对。</p>     </div></div></div>    <div class="tiledSection">     <h3 id="section325481952016">上传商户证书<i class="anchor-icon anchor-icon-link" anchorid="section325481952016" tips="复制节点链接"></i></h3>          <p>证书公钥生成后须商户手动上传到<a href="https://petalpay-merchant.cloud.huawei.com/" target="_blank">华为支付商户平台</a>，用于华为支付服务器对支付请求验证签名。</p>    </div>    <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">      <ol>       <li>私钥信息用于对发送请求的内容签名，请妥善保管，请勿公开泄露。</li>       <li>商户成功登录<a href="https://petalpay-merchant.cloud.huawei.com/" target="_blank">华为支付商户平台</a>后，须在证书管理中上传商户证书，上传完商户证书后商户方可进行交易。证书必须与商户号相匹配且是有效的。</li>      </ol>     </div></div></div>    <p>上传的证书公钥需要满足如下要求：</p>    <ul>     <li>后缀要求：<a href="https://petalpay-merchant.cloud.huawei.com/" target="_blank">华为支付商户平台</a>接收的公钥证书格式为“*.pem”。</li>     <li>格式要求：生成RSA公私钥时，密钥长度要求不小于3072，密钥格式为PKCS#8。</li>    </ul>    <p>请登录<a href="https://petalpay-merchant.cloud.huawei.com/" target="_blank">华为支付商户平台</a>，在“证书管理 &gt; 上传商户证书”模块进行商户证书公钥上传。</p>    <div class="p">     待上传公钥信息示例：     <div _ngcontent-icy-c106="" class="highlight-div"><div _ngcontent-icy-c106="" class="highlight-div-header"><div _ngcontent-icy-c106="" class="highlight-div-header-left"><div _ngcontent-icy-c106="" class="handle-button expand-button"><div _ngcontent-icy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-icy-c106="" class="highlight-div-header-right"><div _ngcontent-icy-c106="" class="handle-button ai-button"></div><div _ngcontent-icy-c106="" class="handle-button line-button"><div _ngcontent-icy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-icy-c106="" class="handle-button theme-button"><div _ngcontent-icy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-icy-c106="" class="handle-button copy-button"><div _ngcontent-icy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-icy-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-markdown" data-highlighted="yes"><ol class="linenums"><li>-----BEGIN PUBLIC KEY-----</li><li>MIIBIjANBgkq<span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-emphasis">*vW7gQTM8BHFTezQjdRI</span></li><li><span class="hljs-emphasis">A7xka2TaVHt<span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">***rOA3P5rew9cO96q/7Z</span></span></li><li><span class="hljs-emphasis">kQ6lRd3oVsf**</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">**rGYCrA2RVgr79mRx+</span></li><li><span class="hljs-emphasis">s22qfA5FdTC**</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">***i6I2cRVb1grBQphR</span></li><li><span class="hljs-emphasis">yFBxCGC/NeV**</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">***K1QM1SC4GCORHocS</span></li><li><span class="hljs-emphasis">MQvApBQwQF9**</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">***eEQvwpVfFxg4dGBz</span></li><li><span class="hljs-emphasis">DQIDAQAB</span></li><li><span class="hljs-emphasis">-----END PUBLIC KEY-----</span></li></ol></pre></div></div>    </div>    <p></p>    <div class="tiledSection">     <h2 id="section14253153941510">华为支付证书<i class="anchor-icon anchor-icon-link" anchorid="section14253153941510" tips="复制节点链接"></i></h2>          <p>华为支付证书是指由华为支付提供的，包含华为支付平台标识、公钥信息的证书。该证书算法为SM2。</p>     <ul>      <li>商户请通过<a href="https://petalpay-merchant.cloud.huawei.com/" target="_blank">华为支付商户平台</a>下载华为支付证书。</li>      <li>华为支付证书中的公钥用于商户对回调通知中的信息进行验签。</li>     </ul>    </div>    <div class="tiledSection">     <h3 id="section377312802116" class="firsth2">下载华为支付证书<i class="anchor-icon anchor-icon-link" anchorid="section377312802116" tips="复制节点链接"></i></h3>          <p>登录<a href="https://petalpay-merchant.cloud.huawei.com/" target="_blank">华为支付商户平台</a>后，通过“商户中心 &gt; 证书管理 &gt; 华为支付证书”页签进行华为支付证书下载，该证书用于校验华为支付给商户业务系统发送的信息，如支付结果信息等。</p>    </div>    <p><span><img height="266.22499999999997" originheight="1084" originwidth="3746" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114629.12923832670777011647582623860039:50001231000000:2800:4969197F96C93BC828DE196F9D3AFD6B90308E753C656955F45EFF7E58D561B0.png" title="点击放大" width="920"></span></p>   </div>   <div></div></div>