<h1 _ngcontent-lsi-c119="" class="doc-title ng-star-inserted" title="出现/消失转场"> 出现/消失转场 </h1>

<div _ngcontent-lsi-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-transition-animation-component" target="_blank">transition</a>是基础的组件转场接口，用于实现一个组件出现或者消失时的动画效果。可以通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-transition-animation-component#transitioneffect10对象说明" target="_blank">TransitionEffect对象</a>的组合使用，定义出各式效果。</p>    <p><strong>表1</strong> 转场效果接口</p>    <div class="tablenoborder">     <div class="tbBox"><table class="layoutFixed idpTab">      <thead>       <tr>        <th align="left" class="cellrowborder" id="mcps1.3.3.1.4.1.1" valign="top" width="33.33333333333333%">转场效果</th>        <th align="left" class="cellrowborder" id="mcps1.3.3.1.4.1.2" valign="top" width="33.33333333333333%">说明</th>        <th align="left" class="cellrowborder" id="mcps1.3.3.1.4.1.3" valign="top" width="33.33333333333333%">动画</th>       </tr>      </thead>             <tbody><tr>        <td class="cellrowborder" valign="top" width="33.33333333333333%">IDENTITY</td>        <td class="cellrowborder" valign="top" width="33.33333333333333%">禁用转场效果。</td>        <td class="cellrowborder" valign="top" width="33.33333333333333%">无。</td>       </tr>       <tr>        <td class="cellrowborder" valign="top" width="33.33333333333333%">OPACITY</td>        <td class="cellrowborder" valign="top" width="33.33333333333333%">默认的转场效果，透明度转场。</td>        <td class="cellrowborder" valign="top" width="33.33333333333333%">出现时透明度从0到1，消失时透明度从1到0。</td>       </tr>       <tr>        <td class="cellrowborder" valign="top" width="33.33333333333333%">SLIDE</td>        <td class="cellrowborder" valign="top" width="33.33333333333333%">滑动转场效果。</td>        <td class="cellrowborder" valign="top" width="33.33333333333333%">出现时从窗口左侧滑入，消失时从窗口右侧滑出。</td>       </tr>       <tr>        <td class="cellrowborder" valign="top" width="33.33333333333333%">translate</td>        <td class="cellrowborder" valign="top" width="33.33333333333333%">通过设置组件平移创建转场效果。</td>        <td class="cellrowborder" valign="top" width="33.33333333333333%">出现时为translate接口设置的值到默认值0，消失时为默认值0到translate接口设置的值。</td>       </tr>       <tr>        <td class="cellrowborder" valign="top" width="33.33333333333333%">rotate</td>        <td class="cellrowborder" valign="top" width="33.33333333333333%">通过设置组件旋转创建转场效果。</td>        <td class="cellrowborder" valign="top" width="33.33333333333333%">出现时为rotate接口设置的值到默认值0，消失时为默认值0到rotate接口设置的值。</td>       </tr>       <tr>        <td class="cellrowborder" valign="top" width="33.33333333333333%">opacity</td>        <td class="cellrowborder" valign="top" width="33.33333333333333%">通过设置透明度参数创建转场效果。</td>        <td class="cellrowborder" valign="top" width="33.33333333333333%">出现时为opacity设置的值到默认透明度1，消失时为默认透明度1到opacity设置的值。</td>       </tr>       <tr>        <td class="cellrowborder" valign="top" width="33.33333333333333%">move</td>        <td class="cellrowborder" valign="top" width="33.33333333333333%">通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-transition-animation-component#transitionedge10" target="_blank">TransitionEdge</a>创建从窗口哪条边缘出来的效果。</td>        <td class="cellrowborder" valign="top" width="33.33333333333333%">出现时从TransitionEdge方向滑入，消失时滑出到TransitionEdge方向。</td>       </tr>       <tr>        <td class="cellrowborder" valign="top" width="33.33333333333333%">asymmetric</td>        <td class="cellrowborder" valign="top" width="33.33333333333333%">         <p>通过此方法组合非对称的出现消失转场效果。</p>         <p>- appear:出现转场的效果。</p>         <p>- disappear：消失转场的效果。</p></td>        <td class="cellrowborder" valign="top" width="33.33333333333333%">出现时采用appear设置的TransitionEffect出现效果，消失时采用disappear设置的TransitionEffect消失效果。</td>       </tr>       <tr>        <td class="cellrowborder" valign="top" width="33.33333333333333%">combine</td>        <td class="cellrowborder" valign="top" width="33.33333333333333%">组合其他TransitionEffect。</td>        <td class="cellrowborder" valign="top" width="33.33333333333333%">组合其他TransitionEffect，一起生效。</td>       </tr>       <tr>        <td class="cellrowborder" valign="top" width="33.33333333333333%">animation</td>        <td class="cellrowborder" valign="top" width="33.33333333333333%">         <p>定义转场效果的动画参数：</p>         <p>- 如果不定义会跟随animateTo的动画参数。</p>         <p>- 不支持通过控件的animation接口配置动画参数。</p>         <p>- TransitionEffect中animation的onFinish不生效。</p></td>        <td class="cellrowborder" valign="top" width="33.33333333333333%">调用顺序是从上往下，上面TransitionEffect的animation也会作用到下面TransitionEffect。</td>       </tr>           </tbody></table></div>    </div>    <ol>     <li>      <p>创建TransitionEffect。</p>      <div _ngcontent-lsi-c106="" class="highlight-div"><div _ngcontent-lsi-c106="" class="highlight-div-header"><div _ngcontent-lsi-c106="" class="highlight-div-header-left"><div _ngcontent-lsi-c106="" class="handle-button expand-button"><div _ngcontent-lsi-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-lsi-c106="" class="highlight-div-header-right"><div _ngcontent-lsi-c106="" class="handle-button ai-button"></div><div _ngcontent-lsi-c106="" class="handle-button line-button"><div _ngcontent-lsi-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-lsi-c106="" class="handle-button theme-button"><div _ngcontent-lsi-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-lsi-c106="" class="handle-button copy-button"><div _ngcontent-lsi-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-lsi-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 出现时会是所有转场效果的出现效果叠加，消失时会是所有消失转场效果的叠加</span></li><li><span class="hljs-comment">// 说明各个effect跟随的动画参数</span></li><li><span class="hljs-keyword">private</span> <span class="hljs-attr">effect</span>: <span class="hljs-built_in">object</span> =</li><li>  <span class="hljs-title class_">TransitionEffect</span>.<span class="hljs-property">OPACITY</span> <span class="hljs-comment">// 创建了透明度转场效果，这里没有调用animation接口，会跟随animateTo的动画参数</span></li><li>    <span class="hljs-comment">// 通过combine方法，添加缩放转场效果，并指定了springMotion(0.6, 1.2)曲线</span></li><li>    .<span class="hljs-title function_">combine</span>(<span class="hljs-title class_">TransitionEffect</span>.<span class="hljs-title function_">scale</span>({ <span class="hljs-attr">x</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">0</span> }).<span class="hljs-title function_">animation</span>({ <span class="hljs-attr">curve</span>: curves.<span class="hljs-title function_">springMotion</span>(<span class="hljs-number">0.6</span>, <span class="hljs-number">1.2</span>) }))</li><li>    <span class="hljs-comment">// 添加旋转转场效果，这里的动画参数会跟随上面的TransitionEffect，也就是springMotion(0.6, 1.2)</span></li><li>    .<span class="hljs-title function_">combine</span>(<span class="hljs-title class_">TransitionEffect</span>.<span class="hljs-title function_">rotate</span>({ <span class="hljs-attr">angle</span>: <span class="hljs-number">90</span> }))</li><li>    <span class="hljs-comment">// 添加平移转场效果，动画参数会跟随其之上带animation的TransitionEffect，也就是springMotion(0.6, 1.2)</span></li><li>    .<span class="hljs-title function_">combine</span>(<span class="hljs-title class_">TransitionEffect</span>.<span class="hljs-title function_">translate</span>({ <span class="hljs-attr">x</span>: <span class="hljs-number">150</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">150</span> }))</li><li>    <span class="hljs-comment">// 添加move转场效果，并指定了springMotion曲线</span></li><li>    .<span class="hljs-title function_">combine</span>(<span class="hljs-title class_">TransitionEffect</span>.<span class="hljs-title function_">move</span>(<span class="hljs-title class_">TransitionEdge</span>.<span class="hljs-property">END</span>)).<span class="hljs-title function_">animation</span>({<span class="hljs-attr">curve</span>: curves.<span class="hljs-title function_">springMotion</span>()})</li><li>    <span class="hljs-comment">// 添加非对称的转场效果，由于这里没有设置animation，会跟随上面的TransitionEffect的animation效果，也就是springMotion</span></li><li>    .<span class="hljs-title function_">combine</span>(<span class="hljs-title class_">TransitionEffect</span>.<span class="hljs-title function_">asymmetric</span>(<span class="hljs-title class_">TransitionEffect</span>.<span class="hljs-title function_">scale</span>({ <span class="hljs-attr">x</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">0</span> }), <span class="hljs-title class_">TransitionEffect</span>.<span class="hljs-title function_">rotate</span>({ <span class="hljs-attr">angle</span>: <span class="hljs-number">90</span> })));</li></ol></pre></div></div></li>     <li>      <p>将转场效果通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-transition-animation-component" target="_blank">transition</a>接口设置到组件。</p>      <div _ngcontent-lsi-c106="" class="highlight-div"><div _ngcontent-lsi-c106="" class="highlight-div-header"><div _ngcontent-lsi-c106="" class="highlight-div-header-left"><div _ngcontent-lsi-c106="" class="handle-button expand-button"><div _ngcontent-lsi-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-lsi-c106="" class="highlight-div-header-right"><div _ngcontent-lsi-c106="" class="handle-button ai-button"></div><div _ngcontent-lsi-c106="" class="handle-button line-button"><div _ngcontent-lsi-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-lsi-c106="" class="handle-button theme-button"><div _ngcontent-lsi-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-lsi-c106="" class="handle-button copy-button"><div _ngcontent-lsi-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-lsi-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-title class_">Text</span>(<span class="hljs-string">'test'</span>)</li><li>  .<span class="hljs-title function_">transition</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">effect</span>)</li></ol></pre></div></div></li>     <li>      <p>新增或者删除组件触发转场。</p>      <div _ngcontent-lsi-c106="" class="highlight-div"><div _ngcontent-lsi-c106="" class="highlight-div-header"><div _ngcontent-lsi-c106="" class="highlight-div-header-left"><div _ngcontent-lsi-c106="" class="handle-button expand-button"><div _ngcontent-lsi-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-lsi-c106="" class="highlight-div-header-right"><div _ngcontent-lsi-c106="" class="handle-button ai-button"></div><div _ngcontent-lsi-c106="" class="handle-button line-button"><div _ngcontent-lsi-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-lsi-c106="" class="handle-button theme-button"><div _ngcontent-lsi-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-lsi-c106="" class="handle-button copy-button"><div _ngcontent-lsi-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-lsi-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@State</span> <span class="hljs-attr">isPresent</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">true</span>;</li><li><span class="hljs-comment">// ...</span></li><li><span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">isPresent</span>) {</li><li>  <span class="hljs-title class_">Text</span>(<span class="hljs-string">'test'</span>)</li><li>    .<span class="hljs-title function_">transition</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">effect</span>)</li><li>}</li><li><span class="hljs-comment">// ...</span></li><li><span class="hljs-comment">// 控制新增或者删除组件</span></li><li><span class="hljs-comment">// 方式一：将控制变量放到animateTo闭包内，未通过animation接口定义动画参数的TransitionEffect将跟随animateTo的动画参数</span></li><li><span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>()?.<span class="hljs-title function_">animateTo</span>({ <span class="hljs-attr">curve</span>: curves.<span class="hljs-title function_">springMotion</span>() }, <span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">this</span>.<span class="hljs-property">isPresent</span> = <span class="hljs-literal">false</span>;</li><li>})</li><li>
</li><li><span class="hljs-comment">// 方式二：直接控制删除或者新增组件，动画参数由TransitionEffect的animation接口配置</span></li><li><span class="hljs-variable language_">this</span>.<span class="hljs-property">isPresent</span> = <span class="hljs-literal">false</span>;</li></ol></pre></div></div></li>    </ol>    <p>完整的示例代码和效果如下，示例中采用直接删除或新增组件的方式触发转场，也可以替换为在animateTo闭包内改变控制变量触发转场。</p>    <div _ngcontent-lsi-c106="" class="highlight-div"><div _ngcontent-lsi-c106="" class="highlight-div-header"><div _ngcontent-lsi-c106="" class="highlight-div-header-left"><div _ngcontent-lsi-c106="" class="handle-button expand-button"><div _ngcontent-lsi-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-lsi-c106="" class="highlight-div-header-right"><div _ngcontent-lsi-c106="" class="handle-button ai-button"></div><div _ngcontent-lsi-c106="" class="handle-button line-button"><div _ngcontent-lsi-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-lsi-c106="" class="handle-button theme-button"><div _ngcontent-lsi-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-lsi-c106="" class="handle-button copy-button"><div _ngcontent-lsi-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-lsi-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { curves } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">TransitionEffectDemo</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">isPresent</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">false</span>;</li><li>  <span class="hljs-comment">// 第一步，创建TransitionEffect</span></li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">effect</span>: <span class="hljs-title class_">TransitionEffect</span> =</li><li>    <span class="hljs-comment">// 创建默认透明度转场效果，并指定了springMotion(0.6, 0.8)曲线</span></li><li>    <span class="hljs-title class_">TransitionEffect</span>.<span class="hljs-property">OPACITY</span>.<span class="hljs-title function_">animation</span>({</li><li>      <span class="hljs-attr">curve</span>: curves.<span class="hljs-title function_">springMotion</span>(<span class="hljs-number">0.6</span>, <span class="hljs-number">0.8</span>)</li><li>    })<span class="hljs-comment">// 通过combine方法，这里的动画参数会跟随上面的TransitionEffect，也就是springMotion(0.6, 0.8)</span></li><li>      .<span class="hljs-title function_">combine</span>(<span class="hljs-title class_">TransitionEffect</span>.<span class="hljs-title function_">scale</span>({</li><li>        <span class="hljs-attr">x</span>: <span class="hljs-number">0</span>,</li><li>        <span class="hljs-attr">y</span>: <span class="hljs-number">0</span></li><li>      }))<span class="hljs-comment">// 添加旋转转场效果，这里的动画参数会跟随上面带animation的TransitionEffect，也就是springMotion(0.6, 0.8)</span></li><li>      .<span class="hljs-title function_">combine</span>(<span class="hljs-title class_">TransitionEffect</span>.<span class="hljs-title function_">rotate</span>({ <span class="hljs-attr">angle</span>: <span class="hljs-number">90</span> }))<span class="hljs-comment">// 添加平移转场效果，这里的动画参数使用指定的springMotion()</span></li><li>      .<span class="hljs-title function_">combine</span>(<span class="hljs-title class_">TransitionEffect</span>.<span class="hljs-title function_">translate</span>({ <span class="hljs-attr">y</span>: <span class="hljs-number">150</span> })</li><li>        .<span class="hljs-title function_">animation</span>({ <span class="hljs-attr">curve</span>: curves.<span class="hljs-title function_">springMotion</span>() }))<span class="hljs-comment">// 添加move转场效果，这里的动画参数会跟随上面的TransitionEffect，也就是springMotion()</span></li><li>      .<span class="hljs-title function_">combine</span>(<span class="hljs-title class_">TransitionEffect</span>.<span class="hljs-title function_">move</span>(<span class="hljs-title class_">TransitionEdge</span>.<span class="hljs-property">END</span>));</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Stack</span>() {</li><li>      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">isPresent</span>) {</li><li>        <span class="hljs-title class_">Column</span>() {</li><li>          <span class="hljs-title class_">Text</span>(<span class="hljs-string">'ArkUI'</span>)</li><li>            .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)</li><li>            .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">20</span>)</li><li>            .<span class="hljs-title function_">fontColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">White</span>)</li><li>        }</li><li>        .<span class="hljs-title function_">justifyContent</span>(<span class="hljs-title class_">FlexAlign</span>.<span class="hljs-property">Center</span>)</li><li>        .<span class="hljs-title function_">width</span>(<span class="hljs-number">150</span>)</li><li>        .<span class="hljs-title function_">height</span>(<span class="hljs-number">150</span>)</li><li>        .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">10</span>)</li><li>        .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-number">0xf56c6c</span>)</li><li>        <span class="hljs-comment">// 第二步：将转场效果通过transition接口设置到组件</span></li><li>        .<span class="hljs-title function_">transition</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">effect</span>)</li><li>      }</li><li>
</li><li>      <span class="hljs-comment">// 边框</span></li><li>      <span class="hljs-title class_">Column</span>()</li><li>        .<span class="hljs-title function_">width</span>(<span class="hljs-number">155</span>)</li><li>        .<span class="hljs-title function_">height</span>(<span class="hljs-number">155</span>)</li><li>        .<span class="hljs-title function_">border</span>({</li><li>          <span class="hljs-attr">width</span>: <span class="hljs-number">5</span>,</li><li>          <span class="hljs-attr">radius</span>: <span class="hljs-number">10</span>,</li><li>          <span class="hljs-attr">color</span>: <span class="hljs-title class_">Color</span>.<span class="hljs-property">Black</span></li><li>        })</li><li>
</li><li>      <span class="hljs-comment">// 第三步：新增或者删除组件触发转场，控制新增或者删除组件</span></li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'Click'</span>)</li><li>        .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">320</span> })</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">isPresent</span> = !<span class="hljs-variable language_">this</span>.<span class="hljs-property">isPresent</span>;</li><li>        })</li><li>    }</li><li>    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'60%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div>    <p><span><img originheight="461" originwidth="377" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114914.17330378849500919055350124031640:50001231000000:2800:E188192E4D7C6D4CF6AB42B6E56ADE438E0236B4C926C17C5A514502FC812A16.gif" width="377" height="461"></span></p>    <p>对多个组件添加转场效果时，可以在animation动画参数中配置不同的delay值，实现组件渐次出现消失的效果：</p>    <div _ngcontent-lsi-c106="" class="highlight-div"><div _ngcontent-lsi-c106="" class="highlight-div-header"><div _ngcontent-lsi-c106="" class="highlight-div-header-left"><div _ngcontent-lsi-c106="" class="handle-button expand-button"><div _ngcontent-lsi-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-lsi-c106="" class="highlight-div-header-right"><div _ngcontent-lsi-c106="" class="handle-button ai-button"></div><div _ngcontent-lsi-c106="" class="handle-button line-button"><div _ngcontent-lsi-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-lsi-c106="" class="handle-button theme-button"><div _ngcontent-lsi-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-lsi-c106="" class="handle-button copy-button"><div _ngcontent-lsi-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-lsi-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">ITEM_COUNTS</span> = <span class="hljs-number">9</span>;</li><li><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">ITEM_COLOR</span> = <span class="hljs-string">'#ED6F21'</span>;</li><li><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">INTERVAL</span> = <span class="hljs-number">30</span>;</li><li><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">DURATION</span> = <span class="hljs-number">300</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index1</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">isGridShow</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">false</span>;</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">dataArray</span>: <span class="hljs-built_in">number</span>[] = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>(<span class="hljs-variable constant_">ITEM_COUNTS</span>);</li><li>
</li><li>  <span class="hljs-title function_">aboutToAppear</span>(): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-variable constant_">ITEM_COUNTS</span>; i++) {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">dataArray</span>[i] = i;</li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Stack</span>() {</li><li>      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">isGridShow</span>) {</li><li>        <span class="hljs-title class_">Grid</span>() {</li><li>          <span class="hljs-title class_">ForEach</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">dataArray</span>, <span class="hljs-function">(<span class="hljs-params">item: <span class="hljs-built_in">number</span>, index: <span class="hljs-built_in">number</span></span>) =&gt;</span> {</li><li>            <span class="hljs-title class_">GridItem</span>() {</li><li>              <span class="hljs-title class_">Stack</span>() {</li><li>                <span class="hljs-title class_">Text</span>((item + <span class="hljs-number">1</span>).<span class="hljs-title function_">toString</span>())</li><li>              }</li><li>              .<span class="hljs-title function_">size</span>({ <span class="hljs-attr">width</span>: <span class="hljs-number">50</span>, <span class="hljs-attr">height</span>: <span class="hljs-number">50</span> })</li><li>              .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-variable constant_">ITEM_COLOR</span>)</li><li>              .<span class="hljs-title function_">transition</span>(<span class="hljs-title class_">TransitionEffect</span>.<span class="hljs-property">OPACITY</span></li><li>                .<span class="hljs-title function_">combine</span>(<span class="hljs-title class_">TransitionEffect</span>.<span class="hljs-title function_">scale</span>({ <span class="hljs-attr">x</span>: <span class="hljs-number">0.5</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">0.5</span> }))<span class="hljs-comment">// 对每个方格的转场添加delay，实现组件的渐次出现消失效果</span></li><li>                .<span class="hljs-title function_">animation</span>({ <span class="hljs-attr">duration</span>: <span class="hljs-variable constant_">DURATION</span>, <span class="hljs-attr">curve</span>: <span class="hljs-title class_">Curve</span>.<span class="hljs-property">Friction</span>, <span class="hljs-attr">delay</span>: <span class="hljs-variable constant_">INTERVAL</span> * index }))</li><li>              .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">10</span>)</li><li>            }</li><li>            <span class="hljs-comment">// 消失时，如果不对方格的所有父控件添加转场效果，则方格的消失转场不会生效</span></li><li>            <span class="hljs-comment">// 此处让方格的父控件在出现消失转场时一直以0.99的透明度显示，使得方格的转场效果不受影响</span></li><li>            .<span class="hljs-title function_">transition</span>(<span class="hljs-title class_">TransitionEffect</span>.<span class="hljs-title function_">opacity</span>(<span class="hljs-number">0.99</span>))</li><li>          }, <span class="hljs-function">(<span class="hljs-params">item: <span class="hljs-built_in">number</span></span>) =&gt;</span> item.<span class="hljs-title function_">toString</span>())</li><li>        }</li><li>        .<span class="hljs-title function_">columnsTemplate</span>(<span class="hljs-string">'1fr 1fr 1fr'</span>)</li><li>        .<span class="hljs-title function_">rowsGap</span>(<span class="hljs-number">15</span>)</li><li>        .<span class="hljs-title function_">columnsGap</span>(<span class="hljs-number">15</span>)</li><li>        .<span class="hljs-title function_">size</span>({ <span class="hljs-attr">width</span>: <span class="hljs-number">180</span>, <span class="hljs-attr">height</span>: <span class="hljs-number">180</span> })</li><li>        <span class="hljs-comment">// 消失时，如果不对方格的所有父控件添加转场效果，则方格的消失转场不会生效</span></li><li>        <span class="hljs-comment">// 此处让父控件在出现消失转场时一直以0.99的透明度显示，使得方格的转场效果不受影响</span></li><li>        .<span class="hljs-title function_">transition</span>(<span class="hljs-title class_">TransitionEffect</span>.<span class="hljs-title function_">opacity</span>(<span class="hljs-number">0.99</span>))</li><li>      }</li><li>    }</li><li>    .<span class="hljs-title function_">size</span>({ <span class="hljs-attr">width</span>: <span class="hljs-string">'100%'</span>, <span class="hljs-attr">height</span>: <span class="hljs-string">'100%'</span> })</li><li>    .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>()?.<span class="hljs-title function_">animateTo</span>({</li><li>        <span class="hljs-attr">duration</span>: <span class="hljs-variable constant_">DURATION</span> + <span class="hljs-variable constant_">INTERVAL</span> * (<span class="hljs-variable constant_">ITEM_COUNTS</span> - <span class="hljs-number">1</span>),</li><li>        <span class="hljs-attr">curve</span>: <span class="hljs-title class_">Curve</span>.<span class="hljs-property">Friction</span></li><li>      }, <span class="hljs-function">() =&gt;</span> {</li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">isGridShow</span> = !<span class="hljs-variable language_">this</span>.<span class="hljs-property">isGridShow</span>;</li><li>      })</li><li>    })</li><li>  }</li><li>}</li></ol></pre></div></div>    <p><span><img originheight="556" originwidth="380" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114914.20972815606657413736133680861672:50001231000000:2800:2EBD648748BD817C6AF3EEB433C4F6009EB50CF7D6116EFAD93785D4AF61C962.gif" width="380" height="556"></span></p>   </div>   <div></div></div>