<h1 _ngcontent-ilr-c119="" class="doc-title ng-star-inserted" title="分享App Linking直达应用"> 分享App Linking直达应用 </h1>

<div _ngcontent-ilr-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p>提供如何通过隔空传送分享实现直达应用，应用需接入App Linking以确保端到端完整的体验。参考：<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/app-linking-startup" target="_blank">使用App Linking实现应用间跳转</a>。</p>    <div class="tiledSection">     <h2 id="section20891956638">注意事项<i class="anchor-icon anchor-icon-link" anchorid="section20891956638" tips="复制节点链接"></i></h2>          <ol>      <li>当进入可分享页面时，使用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/share-harmony-share#section79507713161" target="_blank">harmonyShare.on('gesturesShare')</a>方法注册隔空传送监听事件。</li>      <li>当离开可分享页面（包括<strong>应用退至后台</strong>等场景）时，使用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/share-harmony-share#section3951197151616" target="_blank">harmonyShare.off('gesturesShare')</a>方法取消隔空传送监听事件。</li>     </ol>    </div>    <div class="tiledSection">     <h2 id="section58681637213">开发步骤<i class="anchor-icon anchor-icon-link" anchorid="section58681637213" tips="复制节点链接"></i></h2>          <ol>      <li>导入相关模块。       <div _ngcontent-ilr-c106="" class="highlight-div"><div _ngcontent-ilr-c106="" class="highlight-div-header"><div _ngcontent-ilr-c106="" class="highlight-div-header-left"><div _ngcontent-ilr-c106="" class="handle-button expand-button"><div _ngcontent-ilr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ilr-c106="" class="highlight-div-header-right"><div _ngcontent-ilr-c106="" class="handle-button ai-button"></div><div _ngcontent-ilr-c106="" class="handle-button line-button"><div _ngcontent-ilr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ilr-c106="" class="handle-button theme-button"><div _ngcontent-ilr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ilr-c106="" class="handle-button copy-button"><div _ngcontent-ilr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ilr-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { uniformTypeDescriptor <span class="hljs-keyword">as</span> utd } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkData'</span>;</li><li><span class="hljs-keyword">import</span> { systemShare, harmonyShare } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ShareKit'</span>;</li><li><span class="hljs-keyword">import</span> { fileUri } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.CoreFileKit'</span>;</li></ol></pre></div></div></li>      <li>定义隔空传送分享事件监听/取消监听方法（收到隔空传送分享事件回调后，建议3秒内调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/share-harmony-share#section1862171812120" target="_blank">sharableTarget.share()</a>方法发起分享，否则可能导致超时失败）。       <div _ngcontent-ilr-c106="" class="highlight-div"><div _ngcontent-ilr-c106="" class="highlight-div-header"><div _ngcontent-ilr-c106="" class="highlight-div-header-left"><div _ngcontent-ilr-c106="" class="handle-button expand-button"><div _ngcontent-ilr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ilr-c106="" class="highlight-div-header-right"><div _ngcontent-ilr-c106="" class="handle-button ai-button"></div><div _ngcontent-ilr-c106="" class="handle-button line-button"><div _ngcontent-ilr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ilr-c106="" class="handle-button theme-button"><div _ngcontent-ilr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ilr-c106="" class="handle-button copy-button"><div _ngcontent-ilr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ilr-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">private</span> immersiveCallback = <span class="hljs-function">(<span class="hljs-params">sharableTarget: harmonyShare.SharableTarget</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">uiContext</span>: <span class="hljs-title class_">UIContext</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>();</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">contextFaker</span>: <span class="hljs-title class_">Context</span> = uiContext.<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> <span class="hljs-title class_">Context</span>;</li><li>  <span class="hljs-keyword">let</span> filePath = contextFaker.<span class="hljs-property">filesDir</span> + <span class="hljs-string">'/exampleKnock1.jpg'</span>; <span class="hljs-comment">// 仅为示例 请替换正确的文件路径</span></li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">shareData</span>: systemShare.<span class="hljs-property">SharedData</span> = <span class="hljs-keyword">new</span> systemShare.<span class="hljs-title class_">SharedData</span>({</li><li>    <span class="hljs-attr">utd</span>: utd.<span class="hljs-property">UniformDataType</span>.<span class="hljs-property">HYPERLINK</span>,</li><li>    <span class="hljs-attr">content</span>: <span class="hljs-string">'https://sharekitdemo.drcn.agconnect.link/ZB3p'</span>,</li><li>    <span class="hljs-attr">thumbnailUri</span>: fileUri.<span class="hljs-title function_">getUriFromPath</span>(filePath),</li><li>    <span class="hljs-attr">title</span>: <span class="hljs-string">'隔空传送分享卡片标题'</span>,</li><li>    <span class="hljs-attr">description</span>: <span class="hljs-string">'隔空传送分享卡片描述'</span></li><li>  });</li><li>  sharableTarget.<span class="hljs-title function_">share</span>(shareData);</li><li>}</li><li>
</li><li><span class="hljs-keyword">private</span> <span class="hljs-title function_">immersiveListening</span>(<span class="hljs-params"></span>) {</li><li>  harmonyShare.<span class="hljs-title function_">on</span>(<span class="hljs-string">'gesturesShare'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">immersiveCallback</span>);</li><li>}</li><li>
</li><li><span class="hljs-keyword">private</span> <span class="hljs-title function_">immersiveDisablingListening</span>(<span class="hljs-params"></span>) {</li><li>  harmonyShare.<span class="hljs-title function_">off</span>(<span class="hljs-string">'gesturesShare'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">immersiveCallback</span>);</li><li>}</li></ol></pre></div></div></li>      <li>进入可分享页面时，注册隔空传送分享监听事件；离开可分享页面（包括<strong>应用退至后台</strong>等场景）时，取消隔空传送分享监听事件。       <div _ngcontent-ilr-c106="" class="highlight-div"><div _ngcontent-ilr-c106="" class="highlight-div-header"><div _ngcontent-ilr-c106="" class="highlight-div-header-left"><div _ngcontent-ilr-c106="" class="handle-button expand-button"><div _ngcontent-ilr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ilr-c106="" class="highlight-div-header-right"><div _ngcontent-ilr-c106="" class="handle-button ai-button"></div><div _ngcontent-ilr-c106="" class="handle-button line-button"><div _ngcontent-ilr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ilr-c106="" class="handle-button theme-button"><div _ngcontent-ilr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ilr-c106="" class="handle-button copy-button"><div _ngcontent-ilr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ilr-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// Entry Component 代码片段</span></li><li><span class="hljs-title function_">onPageHide</span>(): <span class="hljs-built_in">void</span> {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">uiContext</span>: <span class="hljs-title class_">UIContext</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>();</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">context</span>: <span class="hljs-title class_">Context</span> = uiContext.<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> <span class="hljs-title class_">Context</span>;</li><li>  context.<span class="hljs-property">eventHub</span>.<span class="hljs-title function_">emit</span>(<span class="hljs-string">'onBackGround'</span>);</li><li>}</li></ol></pre></div></div>       <div _ngcontent-ilr-c106="" class="highlight-div"><div _ngcontent-ilr-c106="" class="highlight-div-header"><div _ngcontent-ilr-c106="" class="highlight-div-header-left"><div _ngcontent-ilr-c106="" class="handle-button expand-button"><div _ngcontent-ilr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ilr-c106="" class="highlight-div-header-right"><div _ngcontent-ilr-c106="" class="handle-button ai-button"></div><div _ngcontent-ilr-c106="" class="handle-button line-button"><div _ngcontent-ilr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ilr-c106="" class="handle-button theme-button"><div _ngcontent-ilr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ilr-c106="" class="handle-button copy-button"><div _ngcontent-ilr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ilr-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-title function_">aboutToAppear</span>(): <span class="hljs-built_in">void</span> {</li><li>  <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">immersiveListening</span>();</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">uiContext</span>: <span class="hljs-title class_">UIContext</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>();</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">context</span>: <span class="hljs-title class_">Context</span> = uiContext.<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> <span class="hljs-title class_">Context</span>;</li><li>  context.<span class="hljs-property">eventHub</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">'onBackGround'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">onBackGround</span>);</li><li>}</li><li>
</li><li><span class="hljs-title function_">aboutToDisappear</span>(): <span class="hljs-built_in">void</span> {</li><li>  <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">immersiveDisablingListening</span>();</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">uiContext</span>: <span class="hljs-title class_">UIContext</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>();</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">context</span>: <span class="hljs-title class_">Context</span> = uiContext.<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> <span class="hljs-title class_">Context</span>;</li><li>  context.<span class="hljs-property">eventHub</span>.<span class="hljs-title function_">off</span>(<span class="hljs-string">'onBackGround'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">onBackGround</span>);</li><li>}</li><li>
</li><li><span class="hljs-keyword">private</span> onBackGround = <span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">immersiveDisablingListening</span>();</li><li>}</li></ol></pre></div></div></li>     </ol>    </div>   </div>   <div></div></div>