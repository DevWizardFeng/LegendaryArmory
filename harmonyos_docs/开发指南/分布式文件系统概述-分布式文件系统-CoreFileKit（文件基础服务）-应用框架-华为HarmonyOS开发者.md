<h1 _ngcontent-bvu-c119="" class="doc-title ng-star-inserted" title="分布式文件系统概述"> 分布式文件系统概述 </h1>

<div _ngcontent-bvu-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p>分布式文件系统（hmdfs，HarmonyOS Distributed File System）提供跨设备的文件访问能力，适用于以下场景：</p>    <ul>     <li>      <p>两台设备组网，用户可以利用一台设备上的编辑软件编辑另外一台设备上的文档。</p></li>     <li>      <p>平板保存的音乐，车载系统直接可见并可播放。</p></li>     <li>      <p>户外拍摄的照片，回家打开平板直接访问原设备拍摄的照片。</p></li>    </ul>    <p>hmdfs在分布式软总线动态组网的基础上，为网络上各个设备结点提供一个全局一致的访问视图，支持开发者通过基础文件系统的接口进行读写访问，具有高性能、低延时等优点。</p>    <div class="tiledSection">     <h2 id="分布式文件系统架构">分布式文件系统架构<i class="anchor-icon anchor-icon-link" anchorid="分布式文件系统架构" tips="复制节点链接"></i></h2>          <p><span><img originheight="1052" originwidth="1804" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114724.87102339847217802608265516055289:50001231000000:2800:3B39BF634B3661F5535EDADF616AADF21483DC1F48666A4A51942614796AC808.png" width="920" height="536.4966740576497"></span></p>     <ul>      <li>       <p>distributedfile_daemon：主要负责设备上线监听、通过软总线建立链路，并根据分布式的设备安全等级执行不同的数据流转策略。</p></li>      <li>       <p>hmdfs：实现在内核的网络文件系统，包括缓存管理、文件访问、元数据管理和冲突管理等。</p>       <ul>        <li>缓存管理         <ul>          <li>设备分布式组网后，hmdfs提供文件的互访能力，但不会主动进行文件数据传输和拷贝。如果应用需要将数据保存到本地，需主动拷贝。</li>          <li>hmdfs保证Close-to-Open的一致性，即一端写关闭后，另外一端可以读取到最新数据，不保证文件内容的实时一致性。</li>          <li>数据在远端写入，但是由于网络原因未及时回刷，文件系统会在下次网络接入时回刷本地，但是如果远端已修改则无法回刷。</li>         </ul></li>        <li>文件访问         <ul>          <li>文件访问接口与本地一致（<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-file-fs" target="_blank">ohos.file.fs</a>）。</li>          <li>如果文件在本地，则堆叠访问本地文件系统。</li>          <li>如果文件在其他设备，则同步网络访问远端设备文件。           <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">             <p>symlink：不支持。</p>            </div></div></div></li>         </ul></li>        <li>元数据管理         <ul>          <li>分布式组网下，文件一端创建、删除、修改，另一端可以“立即”查看到最新文件，查看速度取决于网络情况。</li>          <li>远端设备离线后，该设备数据将不再在本端设备呈现。但由于设备离线的感知具有延迟，可能会造成部分消息4s超时，因此开发者需要考虑接口的网络超时或一些文件虽然可以看到，但实际设备可能已离线的场景。</li>         </ul></li>        <li>冲突处理         <ul>          <li>本地与远端冲突 ，远端文件被重命名，看到的同名文件是本地同名文件，远端文件被重命名。</li>          <li>远端多个设备冲突，以接入本设备ID为顺序，显示设备ID小的同名文件，其他文件被依次重命名。</li>          <li>如果组网场景，目录树下已经有远端文件，创建同名文件，提示文件已存在。</li>          <li>冲突文件显示_conflict_dev后依次加id，id从1自动递增。</li>          <li>同名目录之间仅融合不存在冲突，文件和远端目录同名冲突，远端目录后缀加_remote_directory。</li>         </ul></li>       </ul></li>     </ul>    </div>   </div>   <div></div></div>