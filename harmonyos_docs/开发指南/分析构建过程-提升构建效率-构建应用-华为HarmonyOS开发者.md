<h1 _ngcontent-hyn-c119="" class="doc-title ng-star-inserted" title="分析构建过程"> 分析构建过程 </h1>

<div _ngcontent-hyn-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div id="body0000001778674605"><p id="ZH-CN_TOPIC_0000002510294259__p126429104615">使用Build Analyzer可以显示编译构建过程的重要信息，开发者可以可视化分析排查构建过程中的性能、内存问题。</p> <div class="tiledSection"><h2 id="section843719194565">进入Build Analyzer<i class="anchor-icon anchor-icon-link" anchorid="section843719194565" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510294259__p22245010285">Build Analyzer会在每次构建应用时默认生成一份报告，并在Build Analyzer窗口进行展示。</p> <p id="ZH-CN_TOPIC_0000002510294259__p1777122114581">可以在构建完成后通过以下方式打开Build Analyzer窗口：</p> <ul id="ZH-CN_TOPIC_0000002510294259__ul2028013566586"><li id="li5332519193517">点击菜单栏<strong>Build &gt; Build Analyzer</strong>进行查看。</li><li id="li11614101163518">在Build窗口中的Build Output页签，点击左侧边栏<span><img originheight="23" originwidth="23" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104906.76680574063122141337056257042501:50001231000000:2800:FDFCD445FF22226F634E98B5179F244FF167A797C0EDB7E98BFFA467078AB38E.png" class="IconPic notEnlarge" width="23" height="23"></span>，打开Build Analyzer页签。</li><li id="li38251949171410">构建成功且使用构建分析能力时，在Build窗口Build Output页签下的日志下方点击链接，跳转至Build Analyzer页签。</li></ul> </div> <div class="tiledSection"><h2 id="section121811843185618">查看构建历史记录<i class="anchor-icon anchor-icon-link" anchorid="section121811843185618" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510294259__p17342140144216">Build Analyzer左侧的Build History窗口中按时间顺序显示构建历史记录，包括本工程的构建历史数据和<a href="/consumer/cn/doc/harmonyos-guides/ide-hvigor-build-analyzer#section26761217305">导入的日志数据</a>。点击构建历史记录可以显示对应概览和可视化图谱界面。</p> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p id="ZH-CN_TOPIC_0000002510294259__p44368411522">本工程的构建历史数据保存在./hvigor/report目录下，超过10条记录后，最久的历史数据将会被自动清理。</p> </div></div></div> <p id="ZH-CN_TOPIC_0000002510294259__p15501140113611"><span><img originheight="274" originwidth="262" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104906.09679601584015924134108453830234:50001231000000:2800:FAA15C69AF283813CBCC5DC6F381D16956841EC17E368043E0DBDC37B75C4F4C.png" class="notEnlarge" width="262" height="274"></span></p> </div> <div class="tiledSection"><h2 id="section12764105465615">查看构建任务时间图谱<i class="anchor-icon anchor-icon-link" anchorid="section12764105465615" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510294259__p226955619165">完成构建后首次打开Build Analyzer 时，窗口会显示构建分析概览，如下图所示：</p> <p id="ZH-CN_TOPIC_0000002510294259__p327413382614"><span><img originheight="371" originwidth="1881" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104906.95056423089235079480284199012118:50001231000000:2800:8CF5405923244DA5AFD1052C11EC645D2BB06AD9AF063B836AEAC7AA2998BA81.png" width="920" height="181.45667198298779"></span></p> <p id="ZH-CN_TOPIC_0000002510294259__p3708831133110">如需查看构建任务时间图谱，请从下拉菜单中点击Tasks，默认进入时间图谱界面。该界面会分块显示构建历史记录、构建任务时长图谱、构建日志以及对应的日志详情信息，如下图所示：</p> <p id="ZH-CN_TOPIC_0000002510294259__p18392440193418"><span><img originheight="380" originwidth="1882" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104906.03772210733877562144265885187951:50001231000000:2800:EF95DEA5B44FD592CB028C14A456EE813AF7BA9FDDD8BA0307CF4231C6525362.png" width="920" height="185.75982996811902"></span></p> <p id="ZH-CN_TOPIC_0000002510294259__p094312201347">图谱中的构建任务展示按照各个任务总时长占比，以相对长度进行展示。可以对时间块进行缩小放大，查看具体的任务名称及耗时信息。</p> <p id="ZH-CN_TOPIC_0000002510294259__p239910151459">图谱中构建子任务默认是折叠的，可点击Build TimeLine的节点信息，展开查看子任务的构建时长图谱。</p> <p id="ZH-CN_TOPIC_0000002510294259__p103721127657">图谱与日志信息是联动的，可点击图谱中的任务信息，即可联动对应的日志以及日志详情；相同的，点击日志时，也可联动对应的上方图谱信息。</p> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p id="ZH-CN_TOPIC_0000002510294259__p1057810425513">Build Analyzer不会全部显示构建操作中的所有任务，而是重点显示决定构建总时长的任务。</p> </div></div></div> </div> <p id="ZH-CN_TOPIC_0000002510294259__p15751059679">图谱下方日志模块，展示每次构建的所有日志信息，并按日志级别（Info、Debug、Warn、Error）进行区分，并提供日志搜索功能。</p> <p id="ZH-CN_TOPIC_0000002510294259__p15937161717576">点击日志，可与上方图谱和右侧Details模块，进行联动显示。</p> <p id="ZH-CN_TOPIC_0000002510294259__p731813613310"><span><img originheight="376" originwidth="1880" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104906.23406332293718268164229151093835:50001231000000:2800:83B35BE0186056E470678568B7720077E161C5626BFF27A2CAC54A69DFB279A5.png" width="920" height="184"></span></p> <div class="tiledSection"><h2 id="section10555838153912">查看构建任务占比图谱<i class="anchor-icon anchor-icon-link" anchorid="section10555838153912" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510294259__p1764712149525">如需查看决定着构建时长的任务的占比细分数据，请点击概览页面上的<strong>Common views into this build</strong>下方链接 ，您也可以从下拉菜单中选择<strong>Tasks</strong>并确认您要的任务分组类别。任务以模块、业务类别、Target以及同一模块下的Target、同一模块下的业务类别和同一Target下的业务类别进行分组。图表中任务按照时间占比从大到小排列，点击子任务可详细了解其执行情况。</p> <p id="ZH-CN_TOPIC_0000002510294259__p18630162919327"><span><img originheight="377" originwidth="1881" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104906.86682644462874703518893036347995:50001231000000:2800:CA4F7EA77592895665463827DD9B8ED56A4537D81AD76453ED49436265ECB54B.png" width="920" height="184.3912812333865"></span></p> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p id="ZH-CN_TOPIC_0000002510294259__p66471939205411">1. 由于并行线程的存在，分类任务计算时间可能会比实际总时间长；</p> <p id="ZH-CN_TOPIC_0000002510294259__p1357717471556">2. 饼图中Configuration代表未记录的任务占比。</p> </div></div></div> </div> <div class="tiledSection"><h2 id="section71431248981">查看构建过程内存消耗曲线图<i class="anchor-icon anchor-icon-link" anchorid="section71431248981" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510294259__p1240315186382">如果要分析构建过程的内存消耗情况，需要先<a href="/consumer/cn/doc/harmonyos-guides/ide-hvigor-build-analyzer#section207890565217">设置构建分析模式为Advanced</a>，启用内存监测，构建后会生成内存消耗曲线图。从DevEco Studio 5.1.1 Beta1版本开始支持。</p> <p id="ZH-CN_TOPIC_0000002510294259__p102131152585">点击概览页面上<strong>Common views into this build</strong>下方的链接<strong>Memory Usage During Build</strong>，也可以从下拉菜单中选择<strong>Tasks</strong>和<strong>Memory Usage</strong>分组，查看内存消耗曲线图。</p> <p id="ZH-CN_TOPIC_0000002510294259__p1572816337106"><span><img originheight="383" originwidth="1913" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104906.93900632587275713843423333218746:50001231000000:2800:9BEE05B52AC3ED3E0BEC1979F210B867CFCC4FA19C16B7BF4F288D8ACF2CEF58.png" width="920" height="184.19236800836384"></span></p> </div> <div class="tiledSection"><h2 id="section91784250499">导出日志<i class="anchor-icon anchor-icon-link" anchorid="section91784250499" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510294259__p3698161985114">如需查看本次构建日志，您可以点击导出按钮进行日志导出。</p> <p id="ZH-CN_TOPIC_0000002510294259__p587453123815"><span><img originheight="349" originwidth="1881" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104906.58825658008600309617121207986854:50001231000000:2800:6E95A3FF0286AC1BE6723D3E13AACFF085A10EC07BEE1962F908C573D79B8FF2.png" width="920" height="170.69643806485914"></span></p> <p id="ZH-CN_TOPIC_0000002510294259__p54461518135010">导出内容有：</p> <ul id="ZH-CN_TOPIC_0000002510294259__ul121782511516"><li id="li18606230175214">分析统计本次构建的html文件。</li><li id="li69823339163">记录构建日志的build.log文件。</li><li id="li554445219381">记录构建daemon日志的daemon.log文件。</li><li id="li537112556523">记录构建任务耗时的report.json文件。</li><li id="li873923915402">记录构建过程内存消耗的report-monitor.json文件。</li></ul> </div> <div class="tiledSection"><h2 id="section26761217305">导入日志<i class="anchor-icon anchor-icon-link" anchorid="section26761217305" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510294259__p16331111173013">如需查看历史或其他工程的构建日志，您可以点击导入按钮导入report.json文件，导入的文件保存在工程./hvigor/report/upload目录下，导入后可在Build Analyzer左侧的Build History窗口中查看。upload目录下最多保存10条记录，超过10条记录后，最久的历史数据将会被自动清理。</p> <p id="ZH-CN_TOPIC_0000002510294259__p28021371967"><span><img originheight="346" originwidth="1882" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104906.52022280454018622986444506281461:50001231000000:2800:AB8967CDC77338391AA8437103C4C1C7A82E6CEB5CD9189D79F033513C79707E.png" width="920" height="169.13921360255048"></span></p> </div> <div class="tiledSection"><h2 id="section207890565217">设置构建分析模式<i class="anchor-icon anchor-icon-link" anchorid="section207890565217" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510294259__p1216019132227">进入<strong>File &gt; Settings</strong>（macOS为<strong>DevEco Studio &gt; Preferences/Settings</strong>）<strong> &gt; Build, Execution, Deployment &gt; Build Tools &gt; Hvigor</strong>下，查看<strong>Use build analysis mode</strong>选项：</p> <ul id="ZH-CN_TOPIC_0000002510294259__ul958315213228"><li id="li5767193942013">勾选此项：<ul id="ZH-CN_TOPIC_0000002510294259__ul16624104552013"><li id="li558311215225">模式选择为Normal，即为普通模式（默认选项），记录简单打点数据进行分析。</li><li id="li834320420248">模式选择为Advanced，即为高级模式，记录详细打点数据进行分析（此模式下，建议搭配使用node 18版本）。</li><li id="li1778163275713">模式选择为Ultrafine，即超精细化模式，与Advanced模式相比，在ArkTS编译阶段记录更详细的打点数据，但开启后可能导致编译构建时间更长。从DevEco Studio 6.0.0 Beta1版本开始支持。</li></ul> </li><li id="li1870782092510">取消勾选，即为不记录该次构建数据，不进行分析。</li></ul> <p id="ZH-CN_TOPIC_0000002510294259__p1682545410274"><span><img originheight="486" originwidth="916" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104907.22762189469015989023891734996860:50001231000000:2800:7B181CCE068EBE0E6A88A43CC2E6040E5035E89014064EAED50465215A363EB8.png" width="916" height="486"></span></p> </div> <div class="tiledSection"><h2 id="section1162010491106">生成构建可视化html文件<i class="anchor-icon anchor-icon-link" anchorid="section1162010491106" tips="复制节点链接"></i></h2></div> <ul id="ZH-CN_TOPIC_0000002510294259__ul18783165301213"><li id="li1078315361220">通过命令行方式生成构建可视化html文件。如生成HAP模块的构建可视化html文件，命令如下：<div _ngcontent-hyn-c106="" class="highlight-div"><div _ngcontent-hyn-c106="" class="highlight-div-header"><div _ngcontent-hyn-c106="" class="highlight-div-header-left"><div _ngcontent-hyn-c106="" class="handle-button expand-button"><div _ngcontent-hyn-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-hyn-c106="" class="highlight-div-header-right"><div _ngcontent-hyn-c106="" class="handle-button ai-button"></div><div _ngcontent-hyn-c106="" class="handle-button line-button"><div _ngcontent-hyn-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-hyn-c106="" class="handle-button theme-button"><div _ngcontent-hyn-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-hyn-c106="" class="handle-button copy-button"><div _ngcontent-hyn-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-hyn-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-bash" id="ZH-CN_TOPIC_0000002510294259__screen105116577202" data-highlighted="yes"><ol class="linenums"><li>hvigorw assembleHap --analyze=normal --config properties.hvigor.analyzeHtml=<span class="hljs-literal">true</span></li></ol></pre></div></div> </li></ul> <ul id="ZH-CN_TOPIC_0000002510294259__ul23965717138"><li id="li6396572138">通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-hvigor-set-options">hvigor-config.json5</a>配置文件中properties.hvigor.analyzeHtml字段生成构建可视化html文件：<div _ngcontent-hyn-c106="" class="highlight-div"><div _ngcontent-hyn-c106="" class="highlight-div-header"><div _ngcontent-hyn-c106="" class="highlight-div-header-left"><div _ngcontent-hyn-c106="" class="handle-button expand-button"><div _ngcontent-hyn-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-hyn-c106="" class="highlight-div-header-right"><div _ngcontent-hyn-c106="" class="handle-button ai-button"></div><div _ngcontent-hyn-c106="" class="handle-button line-button"><div _ngcontent-hyn-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-hyn-c106="" class="handle-button theme-button"><div _ngcontent-hyn-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-hyn-c106="" class="handle-button copy-button"><div _ngcontent-hyn-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-hyn-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" id="ZH-CN_TOPIC_0000002510294259__screen8887191572816" data-highlighted="yes"><ol class="linenums"><li>{</li><li>  <span class="hljs-string">"modelVersion"</span>: <span class="hljs-string">"6.0.1"</span>,</li><li>  <span class="hljs-string">"dependencies"</span>: {</li><li>  },</li><li>  <span class="hljs-string">"execution"</span>: {</li><li>  },</li><li>  <span class="hljs-string">"logging"</span>: {</li><li>  },</li><li>  <span class="hljs-string">"debugging"</span>: {</li><li>  },</li><li>  <span class="hljs-string">"nodeOptions"</span>: {</li><li>  },</li><li>  <span class="hljs-string">"properties"</span>: {</li><li>    <span class="hljs-string">"hvigor.analyzeHtml"</span>: <span class="hljs-keyword">true</span>  <span class="hljs-comment">// 生成构建可视化html文件</span></li><li>  }</li><li>}</li></ol></pre></div></div> <div class="p" id="ZH-CN_TOPIC_0000002510294259__p5399191732712">再执行构建，例如执行以下命令：<div _ngcontent-hyn-c106="" class="highlight-div"><div _ngcontent-hyn-c106="" class="highlight-div-header"><div _ngcontent-hyn-c106="" class="highlight-div-header-left"><div _ngcontent-hyn-c106="" class="handle-button expand-button"><div _ngcontent-hyn-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-hyn-c106="" class="highlight-div-header-right"><div _ngcontent-hyn-c106="" class="handle-button ai-button"></div><div _ngcontent-hyn-c106="" class="handle-button line-button"><div _ngcontent-hyn-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-hyn-c106="" class="handle-button theme-button"><div _ngcontent-hyn-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-hyn-c106="" class="handle-button copy-button"><div _ngcontent-hyn-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-hyn-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-lua" id="ZH-CN_TOPIC_0000002510294259__screen10282116122717" data-highlighted="yes"><ol class="linenums"><li>hvigorw assembleHap <span class="hljs-comment">--analyze=normal</span></li></ol></pre></div></div> </div> </li></ul> <p id="ZH-CN_TOPIC_0000002510294259__p5322424191615">执行以上命令后，在工程的.hvigor/report目录下生成对应的html文件，该文件可直接在浏览器中打开。</p> </div> <div></div></div>