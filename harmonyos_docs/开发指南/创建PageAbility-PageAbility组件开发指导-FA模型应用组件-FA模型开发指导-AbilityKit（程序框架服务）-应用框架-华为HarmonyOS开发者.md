<h1 _ngcontent-pfg-c119="" class="doc-title ng-star-inserted" title="创建PageAbility"> 创建PageAbility </h1>

<div _ngcontent-pfg-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div><p>通过DevEco Studio开发平台创建PageAbility时，DevEco Studio会在app.js/app.ets中默认生成onCreate()和onDestroy()方法，其他方法需要开发者自行实现。接口说明参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/pageability-lifecycle">PageAbility的生命周期</a>，创建PageAbility示例如下：</p> <div _ngcontent-pfg-c106="" class="highlight-div"><div _ngcontent-pfg-c106="" class="highlight-div-header"><div _ngcontent-pfg-c106="" class="highlight-div-header-left"><div _ngcontent-pfg-c106="" class="handle-button expand-button"><div _ngcontent-pfg-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pfg-c106="" class="highlight-div-header-right"><div _ngcontent-pfg-c106="" class="handle-button ai-button"></div><div _ngcontent-pfg-c106="" class="handle-button line-button"><div _ngcontent-pfg-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pfg-c106="" class="handle-button theme-button"><div _ngcontent-pfg-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pfg-c106="" class="handle-button copy-button"><div _ngcontent-pfg-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pfg-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> featureAbility <span class="hljs-keyword">from</span> <span class="hljs-string">'@ohos.ability.featureAbility'</span>;</li><li><span class="hljs-keyword">import</span> hilog <span class="hljs-keyword">from</span> <span class="hljs-string">'@ohos.hilog'</span>;</li><li>
</li><li><span class="hljs-keyword">const</span> <span class="hljs-attr">TAG</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'MainAbility'</span>;</li><li><span class="hljs-keyword">const</span> <span class="hljs-attr">domain</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0xFF00</span>;</li><li>
</li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">MainAbility</span> {</li><li>  <span class="hljs-title function_">onCreate</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-comment">// 获取context并调用相关方法</span></li><li>    <span class="hljs-keyword">let</span> context = featureAbility.<span class="hljs-title function_">getContext</span>();</li><li>    context.<span class="hljs-title function_">getBundleName</span>(<span class="hljs-function">(<span class="hljs-params">data, bundleName</span>) =&gt;</span> {</li><li>      hilog.<span class="hljs-title function_">info</span>(domain, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'ability bundleName:'</span> ,bundleName);</li><li>    });</li><li>    hilog.<span class="hljs-title function_">info</span>(domain, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'Application onCreate'</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">onDestroy</span>(<span class="hljs-params"></span>) {</li><li>    hilog.<span class="hljs-title function_">info</span>(domain, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'Application onDestroy'</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">onShow</span>(): <span class="hljs-built_in">void</span> {</li><li>    hilog.<span class="hljs-title function_">info</span>(domain, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'Application onShow'</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">onHide</span>(): <span class="hljs-built_in">void</span> {</li><li>    hilog.<span class="hljs-title function_">info</span>(domain, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'Application onHide'</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">onActive</span>(): <span class="hljs-built_in">void</span> {</li><li>    hilog.<span class="hljs-title function_">info</span>(domain, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'Application onActive'</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">onInactive</span>(): <span class="hljs-built_in">void</span> {</li><li>    hilog.<span class="hljs-title function_">info</span>(domain, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'Application onInactive'</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">onNewWant</span>(<span class="hljs-params"></span>) {</li><li>    hilog.<span class="hljs-title function_">info</span>(domain, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'Application onNewWant'</span>);</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MainAbility</span>();</li></ol></pre></div></div> <p>PageAbility创建成功后，其abilities相关的配置项在config.json中体现，一个名字为EntryAbility的config.json配置文件示例如下：</p> <div _ngcontent-pfg-c106="" class="highlight-div"><div _ngcontent-pfg-c106="" class="highlight-div-header"><div _ngcontent-pfg-c106="" class="highlight-div-header-left"><div _ngcontent-pfg-c106="" class="handle-button expand-button"><div _ngcontent-pfg-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pfg-c106="" class="highlight-div-header-right"><div _ngcontent-pfg-c106="" class="handle-button ai-button"></div><div _ngcontent-pfg-c106="" class="handle-button line-button"><div _ngcontent-pfg-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pfg-c106="" class="handle-button theme-button"><div _ngcontent-pfg-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pfg-c106="" class="handle-button copy-button"><div _ngcontent-pfg-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pfg-c106="" class="highlight-scroll-div"><pre class="json prettyprint linenums hljs language-json" hw-language="json" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-punctuation">{</span></li><li>  ...</li><li>  <span class="hljs-attr">"module"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>    ...</li><li>    <span class="hljs-attr">"abilities"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span></li><li>      <span class="hljs-punctuation">{</span></li><li>        <span class="hljs-attr">"skills"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span></li><li>          <span class="hljs-punctuation">{</span></li><li>            <span class="hljs-attr">"entities"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span></li><li>              <span class="hljs-string">"entity.system.home"</span></li><li>            <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span></li><li>            <span class="hljs-attr">"actions"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span></li><li>              <span class="hljs-string">"action.system.home"</span></li><li>            <span class="hljs-punctuation">]</span></li><li>          <span class="hljs-punctuation">}</span></li><li>        <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span></li><li>        <span class="hljs-attr">"orientation"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"unspecified"</span><span class="hljs-punctuation">,</span></li><li>        <span class="hljs-attr">"formsEnabled"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span></li><li>        <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">".MainAbility"</span><span class="hljs-punctuation">,</span></li><li>        <span class="hljs-attr">"srcLanguage"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"ets"</span><span class="hljs-punctuation">,</span></li><li>        <span class="hljs-attr">"srcPath"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"MainAbility"</span><span class="hljs-punctuation">,</span></li><li>        <span class="hljs-attr">"icon"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"$media:icon"</span><span class="hljs-punctuation">,</span></li><li>        <span class="hljs-attr">"description"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"$string:MainAbility_desc"</span><span class="hljs-punctuation">,</span></li><li>        <span class="hljs-attr">"label"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"$string:MainAbility_label"</span><span class="hljs-punctuation">,</span></li><li>        <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"page"</span><span class="hljs-punctuation">,</span></li><li>        <span class="hljs-attr">"visible"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span></li><li>        <span class="hljs-attr">"launchType"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"singleton"</span></li><li>      <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span></li><li>      ...</li><li>    <span class="hljs-punctuation">]</span></li><li>    ...</li><li>  <span class="hljs-punctuation">}</span></li><li><span class="hljs-punctuation">}</span></li></ol></pre></div></div> <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ability-terminology#fa模型">FA模型</a>中，可以通过featureAbility的getContext接口获取应用上下文，进而使用上下文提供的能力。</p> <p> <strong>表1</strong> featureAbility接口说明</p>  <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.7.1.3.1.1" valign="top" width="50%">接口名</th> <th align="left" class="cellrowborder" id="mcps1.3.7.1.3.1.2" valign="top" width="50%">接口描述</th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="50%">getContext()</td> <td class="cellrowborder" valign="top" width="50%">获取应用上下文。</td> </tr>  </tbody></table></div> </div> <p>通过getContext获取应用上下文并获取分布式目录的示例如下：</p> <div _ngcontent-pfg-c106="" class="highlight-div"><div _ngcontent-pfg-c106="" class="highlight-div-header"><div _ngcontent-pfg-c106="" class="highlight-div-header-left"><div _ngcontent-pfg-c106="" class="handle-button expand-button"><div _ngcontent-pfg-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pfg-c106="" class="highlight-div-header-right"><div _ngcontent-pfg-c106="" class="handle-button ai-button"></div><div _ngcontent-pfg-c106="" class="handle-button line-button"><div _ngcontent-pfg-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pfg-c106="" class="handle-button theme-button"><div _ngcontent-pfg-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pfg-c106="" class="handle-button copy-button"><div _ngcontent-pfg-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pfg-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> featureAbility <span class="hljs-keyword">from</span> <span class="hljs-string">'@ohos.ability.featureAbility'</span>;</li><li><span class="hljs-keyword">import</span> fs <span class="hljs-keyword">from</span> <span class="hljs-string">'@ohos.file.fs'</span>;</li><li><span class="hljs-keyword">import</span> promptAction <span class="hljs-keyword">from</span> <span class="hljs-string">'@ohos.promptAction'</span>;</li><li><span class="hljs-keyword">import</span> hilog <span class="hljs-keyword">from</span> <span class="hljs-string">'@ohos.hilog'</span>;</li><li>
</li><li><span class="hljs-keyword">const</span> <span class="hljs-attr">TAG</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'PagePageAbilityFirst'</span>;</li><li><span class="hljs-keyword">const</span> <span class="hljs-attr">domain</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0xFF00</span>;</li></ol></pre></div></div> <div _ngcontent-pfg-c106="" class="highlight-div"><div _ngcontent-pfg-c106="" class="highlight-div-header"><div _ngcontent-pfg-c106="" class="highlight-div-header-left"><div _ngcontent-pfg-c106="" class="handle-button expand-button"><div _ngcontent-pfg-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pfg-c106="" class="highlight-div-header-right"><div _ngcontent-pfg-c106="" class="handle-button ai-button"></div><div _ngcontent-pfg-c106="" class="handle-button line-button"><div _ngcontent-pfg-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pfg-c106="" class="handle-button theme-button"><div _ngcontent-pfg-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pfg-c106="" class="handle-button copy-button"><div _ngcontent-pfg-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pfg-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li>(<span class="hljs-keyword">async</span> (): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; =&gt; {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">dir</span>: <span class="hljs-built_in">string</span>;</li><li>  <span class="hljs-keyword">try</span> {</li><li>    hilog.<span class="hljs-title function_">info</span>(domain, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'Begin to getOrCreateDistributedDir'</span>);</li><li>    dir = <span class="hljs-keyword">await</span> featureAbility.<span class="hljs-title function_">getContext</span>().<span class="hljs-title function_">getOrCreateDistributedDir</span>();</li><li>    promptAction.<span class="hljs-title function_">showToast</span>({</li><li>      <span class="hljs-attr">message</span>: dir</li><li>    });</li><li>    hilog.<span class="hljs-title function_">info</span>(domain, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'distribute dir is '</span> + dir);</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">fd</span>: <span class="hljs-built_in">number</span>;</li><li>    <span class="hljs-keyword">let</span> path = dir + <span class="hljs-string">'/a.txt'</span>;</li><li>    fd = fs.<span class="hljs-title function_">openSync</span>(path, fs.<span class="hljs-property">OpenMode</span>.<span class="hljs-property">READ_WRITE</span>).<span class="hljs-property">fd</span>;</li><li>    fs.<span class="hljs-title function_">close</span>(fd);</li><li>  } <span class="hljs-keyword">catch</span> (error) {</li><li>    hilog.<span class="hljs-title function_">error</span>(domain, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'getOrCreateDistributedDir failed with : '</span> + error);</li><li>  }</li><li>})()</li></ol></pre></div></div> </div> <div></div></div>