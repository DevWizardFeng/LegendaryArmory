<h1 _ngcontent-lgw-c119="" class="doc-title ng-star-inserted" title="创建Wallet Kit服务"> 创建Wallet Kit服务 </h1>

<div _ngcontent-lgw-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div><p>请先参考“<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/application-dev-overview" target="_blank">应用开发准备</a>”完成基本准备工作和指纹配置，再继续以下开发活动。</p> <ol><li><span>登录<a href="https://developer.huawei.com/consumer/cn/service/josp/agc/index.html" target="_blank">AppGallery Connect</a>，选择“我的项目”。</span></li><li><span>点击进入对应的项目，在左侧“项目设置”页签，上侧导航选择“开放能力管理”，打开华为钱包的开关。用于钱包对车钥匙管理台向钱包服务器发起http/https请求时的权限控制。关闭状态下，开发者服务器将访问不了钱包服务器。</span><p></p><p><span><img height="281.752786" originheight="686" originwidth="1628" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114507.56316295343858874069903753675365:50001231000000:2800:FEA1499BFB7AF0DC3A748EDC4C46AA1D88F8240F1EDD0AF6C1F0AC6B3383AD6D.png" title="点击放大" width="669.3225"></span></p> <p></p> <p></p></li><li><span>在“项目设置”页签，左侧导航选择“盈利 &gt; 华为钱包”，点击“申请Wallet Kit服务”，进入申请Wallet Kit服务。</span><p></p><p><span><img height="249.749129" originheight="617" originwidth="1887" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114507.62690001577005278561428450122515:50001231000000:2800:039CB4D42DC256DD35840C12A91513B931534C9CBFF4F6AFEF0064200B78B36E.png" title="点击放大" width="672.081585"></span></p> <p></p> <p></p></li><li><span>点击“产品接入华为钱包服务”的“点击申请”按钮。</span><p></p><p><span><img height="256.731629" originheight="628" originwidth="1667" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114508.91685648310092405772699737747953:50001231000000:2800:8D3210C0D645306B9D37762A34BCBBEC5D378DF1012225C35E96A6DD2BCE914E.png" title="点击放大" width="681.4501050000001"></span></p> <p></p></li><li id="li69221528123212"><a name="ZH-CN_TOPIC_0000002218367257__li69221528123212"></a><a name="li69221528123212"></a><span>各业务场景对应的参数有差异，具体参数请参考各业务的Wallet Kit服务基本信息。</span><p></p><p><span><img height="306.606629" originheight="834" originwidth="1871" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114508.74823985672974986790129137174209:50001231000000:2800:87E1B03DC56F0BB75ECF58E62F1AB4E90390C829B95BAE243FA4C02E3642EFE5.png" title="点击放大" width="687.866025"></span></p> <p></p> <div class="p"> <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.2.5.2.3.1.1.3.1.1" valign="top" width="20.57%"><p>Wallet Kit服务参数名称</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.2.5.2.3.1.1.3.1.2" valign="top" width="79.43%"><p>参数值</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="20.57%"><p>服务类型</p> </td> <td class="cellrowborder" valign="top" width="79.43%"><p>分为卡、票、券、钥匙等，暂时只支持车钥匙和交通卡，开发者选择其中的一种。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="20.57%"><p>服务项目</p> </td> <td class="cellrowborder" valign="top" width="79.43%"><p>服务项目依赖所选择的服务类型，不同的服务类型，有不同的服务项目。例如当服务类型选择“卡”时，对应的服务项目有：“会员卡”、“公交卡”、“礼品卡”。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="20.57%"><p>服务名称</p> </td> <td class="cellrowborder" valign="top" width="79.43%"><p>Wallet Kit首页列表展示该开发者所有创建的服务时，服务名称用于区分不同的服务。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="20.57%"><p>服务号</p> </td> <td class="cellrowborder" valign="top" width="79.43%"><p>用于Wallet Kit服务器区分不同的服务且保证唯一性。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="20.57%"><p>接入方式</p> </td> <td class="cellrowborder" valign="top" width="79.43%"><p>国内支持三种接入方式，App接入，云端接入，代理接入。商户可以根据自己的需求选择适合自己类型的接入方式。选择云端接入时用户需要填写“回调地址”、“用户公钥”二项资料，选择App接入则只需要上传证书请求文件生成证书即可，选择代理接入时用户需要填写“回调地址”一项资料，而用户公钥则会发送默认值到Wallet Kit服务器。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="20.57%"><p>回调地址</p> </td> <td class="cellrowborder" valign="top" width="79.43%"><p>开发者提供给Wallet Kit的地址，用于Wallet Kit回调开发者，用户领卡成功或删卡时回调开发者。</p> <p>注：如果不需要Wallet Kit通知开发者用户领卡或删卡的状态，可以不填该字段。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="20.57%"><p>用户公钥</p> </td> <td class="cellrowborder" valign="top" width="79.43%"><p>开发者将生成的公钥复制粘贴到此处，后续该公钥将作为Wallet Kit服务器认证开发者身份的方式，参考如下公钥生成方式。</p> </td> </tr>  </tbody></table></div> </div> </div> <p><strong>公钥生成方式：</strong></p> <p>（1）配置好node执行环境并使用文本编辑器新建文件，拷贝以下代码到文件中并保存命名为<span class="filepath">“generateKeyPair.js”</span>。</p> <div _ngcontent-lgw-c106="" class="highlight-div"><div _ngcontent-lgw-c106="" class="highlight-div-header"><div _ngcontent-lgw-c106="" class="highlight-div-header-left"><div _ngcontent-lgw-c106="" class="handle-button expand-button"><div _ngcontent-lgw-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-lgw-c106="" class="highlight-div-header-right"><div _ngcontent-lgw-c106="" class="handle-button ai-button"></div><div _ngcontent-lgw-c106="" class="handle-button line-button"><div _ngcontent-lgw-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-lgw-c106="" class="handle-button theme-button"><div _ngcontent-lgw-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-lgw-c106="" class="handle-button copy-button"><div _ngcontent-lgw-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-lgw-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">const</span> crypto = <span class="hljs-built_in">require</span>(<span class="hljs-string">'crypto'</span>);</li><li><span class="hljs-comment">// 生成密钥对</span></li><li><span class="hljs-keyword">const</span> { publicKey, privateKey } = crypto.<span class="hljs-title function_">generateKeyPairSync</span>(<span class="hljs-string">'rsa'</span>, {</li><li>  <span class="hljs-attr">modulusLength</span>: <span class="hljs-number">4096</span>, <span class="hljs-comment">// 密钥长度，不少于4096 </span></li><li>  <span class="hljs-attr">publicKeyEncoding</span>: {</li><li>    <span class="hljs-attr">type</span>: <span class="hljs-string">'spki'</span>, <span class="hljs-comment">// 公钥编码格式</span></li><li>    <span class="hljs-attr">format</span>: <span class="hljs-string">'pem'</span> <span class="hljs-comment">// 公钥输出格式</span></li><li>  },</li><li>  <span class="hljs-attr">privateKeyEncoding</span>: {</li><li>    <span class="hljs-attr">type</span>: <span class="hljs-string">'pkcs8'</span>, <span class="hljs-comment">// 私钥编码格式</span></li><li>    <span class="hljs-attr">format</span>: <span class="hljs-string">'pem'</span> <span class="hljs-comment">// 私钥输出格式</span></li><li>  }</li><li>});</li><li><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'生成的公钥：'</span>);</li><li><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(publicKey);</li><li><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'生成的私钥：'</span>);</li><li><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(privateKey);</li></ol></pre></div></div> <p>（2）打开命令行工具，执行<strong>node generateKeyPair.js</strong>命令。</p> <p>（3）从结果中拷贝生成的公私钥并保存。结果如下图所示：</p> <p><span><img originheight="736" originwidth="1122" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114508.66470937361803102727705771650656:50001231000000:2800:8C2AD91506327F51D37BBE55865680D762A242658DBFCCE4EF18AD3B28A59384.png" width="920" height="603.49376114082"></span></p> <p></p> <p></p></li><li><span>点击“下一步”，进入NFC参数设置页面，各业务场景对应的参数有差异，具体参数请参考各业务的NFC参数。</span><p></p><p><span><img height="302.2425" originheight="693" originwidth="1199" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114508.19334689121545942298743589044375:50001231000000:2800:BEDAEC7F7B27304A7ADEAA67F537B0FEC6512401EE575782BB6BE534F8B97CE8.png" title="点击放大" width="523.6875"></span></p> <div class="p"> <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.2.6.2.2.1.1.3.1.1" valign="top" width="24.83%"><p>NFC参数名称</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.2.6.2.2.1.1.3.1.2" valign="top" width="75.17%"><p>参数值</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="24.83%"><p>是否支持跨移动设备同步</p> </td> <td class="cellrowborder" valign="top" width="75.17%"><p>用户领取卡券后可通过此能力在同一账号下的多设备中共享此卡券。商户默认选择“否”即可。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="24.83%"><p>是否开通NFC能力</p> </td> <td class="cellrowborder" valign="top" width="75.17%"><p>服务类型为门钥匙、一卡通、门禁卡、交通卡、社会保障卡、港澳通行证、护照时，需要开通NFC能力，同时需要配置应用号和文件参数。其余的服务类型可以选择不开通NFC能力。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="24.83%"><p>应用ID</p> </td> <td class="cellrowborder" valign="top" width="75.17%"><p>通过“获取AID”按钮创建新应用ID，内容格式为16进制数（字符为 0-F），最大长度为32（推荐32位），建议以“A000000048575041590100”开头。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="24.83%"><p>外部认证密钥</p> </td> <td class="cellrowborder" valign="top" width="75.17%"><p>用于离线读写卡时外部认证校验。内容格式为16进制数（字符为 0-F），最大长度为32（推荐32位）。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="24.83%"><p>文件参数定义</p> </td> <td class="cellrowborder" valign="top" width="75.17%"><p>密钥信息，用于对指定文件区域读写权限的控制。内容格式为16进制数（字符为 0-F），最大长度为32（推荐32位）。</p> </td> </tr>  </tbody></table></div> </div> </div> <p></p></li><li><span>点击“下一步”，创建完成后，返回Wallet Kit服务创建页面，可对所创建的服务进行查看、修改和删除。</span></li></ol> </div> <div></div></div>