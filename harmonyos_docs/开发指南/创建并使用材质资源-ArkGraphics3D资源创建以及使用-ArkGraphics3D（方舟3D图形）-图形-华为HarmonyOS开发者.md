<h1 _ngcontent-kbn-c119="" class="doc-title ng-star-inserted" title="创建并使用材质资源"> 创建并使用材质资源 </h1>

<div _ngcontent-kbn-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p>材质（Material）：材质是用于定义物体表面视觉效果的重要资源。材质决定了物体如何与光线交互，从而影响其最终的渲染效果，如颜色、金属感、粗糙度等外观属性。</p>    <p>ArkGraphics 3D采用基于物理的渲染（PBR, Physically-Based Rendering）模型，其材质实现遵循通用的PBR原理。开发者既可以使用标准材质快速实现真实感效果，也可以通过自定义Shader材质灵活控制渲染逻辑。</p>    <div class="tiledSection">     <h2 id="基本概念">基本概念<i class="anchor-icon anchor-icon-link" anchorid="基本概念" tips="复制节点链接"></i></h2>          <p>着色器（Shader）：着色器是GPU上可以执行的一段程序，可以控制GPU执行哪些并行计算操作。AGP引擎提供的默认着色器实现了PBR渲染，开发者只需要指定对应的参数就可以完成不同的PBR渲染。</p>     <p>ArkGraphics 3D支持开发者创建自定义的着色器，开发者可以通过自定义着色器自定义渲染计算过程，完全控制渲染计算流程，比如控制某物体不受某光源的影响、自定义边缘描边、高亮效果等个性化视觉呈现。</p>     <p>着色器通常配合MaterialType.SHADER材质使用，是实现个性化渲染的重要手段。其创建依赖名称及沙箱路径，创建后可绑定至材质上，替代默认的渲染行为。</p>    </div>    <div class="tiledSection">     <h2 id="材质类型materialtype">材质类型（MaterialType）<i class="anchor-icon anchor-icon-link" anchorid="材质类型materialtype" tips="复制节点链接"></i></h2>          <p>ArkGraphics 3D中的材质类型通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-scene-resources#materialtype" target="_blank">MaterialType</a>枚举指定，目前支持以下两种类型：</p>     <ul>      <li>       <p>MaterialType.SHADER：基于Shader（着色器）的材质类型，支持绑定自定义着色器，开发者可通过自定义渲染程序实现个性化的视觉表现，适用于高级图形渲染需求。</p></li>      <li>       <p>MaterialType.METALLIC_ROUGHNESS：基于金属-粗糙度模型的标准PBR材质类型，符合glTF材质规范，适合快速构建真实感渲染效果，支持设置基础色、金属度、粗糙度、法线贴图等常见属性。</p></li>     </ul>     <p>材质的创建一般通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-scene#creatematerial" target="_blank">SceneResourceFactory.createMaterial()</a>方法完成，需指定材质名称和类型。不同类型的材质支持不同的参数配置，开发者可按需选择以实现预期的渲染效果。</p>    </div>    <div class="tiledSection">     <h2 id="材质的属性">材质的属性<i class="anchor-icon anchor-icon-link" anchorid="材质的属性" tips="复制节点链接"></i></h2>          <p>材质的属性定义了其在渲染时的视觉表现行为，例如颜色、金属感、粗糙度、光照响应以及透明度控制等。通过设置这些属性，开发者可以精准控制物体在场景中的外观效果。</p>     <p>在ArkGraphics 3D中，材质属性设计既提供了统一的基础能力，也根据材质类型提供了差异化扩展，满足从基础场景搭建到高级视觉定制的多样需求。</p>    </div>    <div class="tiledSection">     <h3 id="通用属性" class="firsth2">通用属性<i class="anchor-icon anchor-icon-link" anchorid="通用属性" tips="复制节点链接"></i></h3>          <p>所有材质均具备以下基础属性（如materialType、shadowReceiver、blend等）可通过设置<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-scene-resources#material" target="_blank">Material</a>类型对象实现，用于控制材质的类型及其渲染基础行为：</p>     <ul>      <li>       <p>materialType：材质类型，标识该材质是标准PBR材质还是基于Shader的自定义材质。</p>       <p>适用场景：当需要快速使用预设真实感材质时选择PBR材质，需实现个性化或特殊渲染效果时选择Shader材质。</p></li>      <li>       <p>shadowReceiver：材质是否可以接收场景中的阴影投射，true表示可以接收，false表示不能接收，默认为false。</p>       <p>适用场景：需要表现阴影效果的物体，如地面、墙体、角色等开启；纯发光物体或不参与阴影计算的可关闭以优化性能。</p></li>      <li>       <p>cullMode：剔除模式，决定是否剔除背面几何体，默认值为BACK，即剔除背面。</p>       <p>适用场景：普通实体模型一般开启剔除背面提升渲染效率；透明或双面材质（如树叶、布料）需要禁用剔除以显示完整模型。</p></li>      <li>       <p>blend：是否启用材质的透明效果模式。true表示开启透明，false表示关闭透明，默认值为false。</p>       <p>适用场景：表现透明或半透明材质时开启，如玻璃、水面、烟雾、透明塑料等。</p></li>      <li>       <p>alphaCutoff：透明度阈值，取值范围[0,1]，默认值为1。像素的alpha值低于该阈值时不进行渲染，用于实现透明裁剪效果。</p>       <p>适用场景：需要硬透明裁剪的材质，比如树叶、铁丝网、布料边缘等带有透明区域但无半透明渐变的模型。通过设置阈值，可以快速裁剪掉透明部分像素。</p></li>      <li>       <p>renderSort：渲染排序设置，用于控制材质在渲染队列中的渲染顺序，确保透明或特殊效果材质正确叠加显示。</p>       <p>适用场景：多重透明材质、叠加特效、UI元素等需要严格渲染顺序的场景。</p></li>     </ul>    </div>    <div class="tiledSection">     <h3 id="pbr材质属性">PBR材质属性<i class="anchor-icon anchor-icon-link" anchorid="pbr材质属性" tips="复制节点链接"></i></h3>          <p>符合glTF标准的基于物理渲染（PBR）的金属-粗糙度材质，通过设置<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-scene-resources#metallicroughnessmaterial20" target="_blank">MetallicRoughnessMaterial</a>实现，其中各项属性采用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-scene-resources#materialproperty20" target="_blank">MaterialProperty</a>类型封装，支持绑定纹理和设置因子（factor）值。具体属性包括：</p>     <ul>      <li>       <p>baseColor：基础颜色和透明度，包含纹理及对应因子，用于定义材质表面的主色调。</p>       <p>适用场景：所有材质的基本颜色设置，适用于任何物体表面，尤其是需要表现颜色和透明度的模型。</p></li>      <li>       <p>normal：法线贴图，用于模拟表面细节凹凸，增强光照效果的真实感。</p>       <p>适用场景：需要表现表面细节如石材纹理、皮肤毛孔、木纹凹凸等，提升真实感的模型。</p></li>      <li>       <p>material：金属度、粗糙度与反射率参数，描述材质表面的光学特性。</p>       <p>适用场景：区分金属和非金属表面，控制材质的光滑或粗糙程度，常用于金属件、塑料、橡胶等多种材质。</p></li>      <li>       <p>ambientOcclusion：环境光遮蔽贴图，提升材质细节处的阴影层次和真实感。</p>       <p>适用场景：增强模型细节阴影效果，适合复杂结构或细节丰富的物体，如建筑物裂缝、机械零件缝隙。</p></li>      <li>       <p>emissive：自发光颜色及纹理，表达材质自发光的效果。</p>       <p>适用场景：灯光、屏幕、发光标志、荧光材料等需要表现光源或自发光效果的材质。</p></li>      <li>       <p>clearCoat：清漆层强度，模拟车漆等具有透明反光层的材质。</p>       <p>适用场景：汽车车身、家具表面等有光泽涂层的材质，表现透明光泽和反射。</p></li>      <li>       <p>clearCoatRoughness：清漆层的粗糙度，控制清漆层的反光细节。</p>       <p>适用场景：配合clearCoat使用，调节涂层表面的光滑度或粗糙感。</p></li>      <li>       <p>clearCoatNormal：清漆层法线贴图，增强清漆层的光照变化。</p>       <p>适用场景：清漆层带有细节纹理时使用，增加涂层的真实光照反馈。</p></li>      <li>       <p>sheen：微纤维漫反射层，用于表现布料、织物的光泽感。</p>       <p>适用场景：衣物、窗帘、沙发等纺织品，表现柔和的光泽和细腻质感。</p></li>      <li>       <p>specular：镜面反射属性，控制非金属材质的高光反射强度。</p>       <p>适用场景：玻璃、水面、塑料等非金属材质的高光表现，增强材质的镜面反射效果。</p></li>     </ul>    </div>    <div class="tiledSection">     <h2 id="开发步骤">开发步骤<i class="anchor-icon anchor-icon-link" anchorid="开发步骤" tips="复制节点链接"></i></h2>          <ol>      <li>       <p>获取资源工厂。</p>       <p>使用场景对象Scene或其他接口，获取资源工厂SceneResourceFactory实例，用于创建材质资源。</p>       <div _ngcontent-kbn-c106="" class="highlight-div"><div _ngcontent-kbn-c106="" class="highlight-div-header"><div _ngcontent-kbn-c106="" class="highlight-div-header-left"><div _ngcontent-kbn-c106="" class="handle-button expand-button"><div _ngcontent-kbn-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kbn-c106="" class="highlight-div-header-right"><div _ngcontent-kbn-c106="" class="handle-button ai-button"></div><div _ngcontent-kbn-c106="" class="handle-button line-button"><div _ngcontent-kbn-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kbn-c106="" class="handle-button theme-button"><div _ngcontent-kbn-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kbn-c106="" class="handle-button copy-button"><div _ngcontent-kbn-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kbn-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 加载场景资源，支持.gltf和.glb格式，路径和文件名可根据项目实际资源自定义</span></li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">scenePromise</span>: <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">Scene</span>&gt; = <span class="hljs-title class_">Scene</span>.<span class="hljs-title function_">load</span>($rawfile(<span class="hljs-string">"gltf/ExampleModel.glb"</span>));</li><li>scenePromise.<span class="hljs-title function_">then</span>(<span class="hljs-keyword">async</span> (<span class="hljs-attr">scene</span>: <span class="hljs-title class_">Scene</span>) =&gt; {</li><li><span class="hljs-keyword">if</span> (!scene.<span class="hljs-property">root</span>) {</li><li>  <span class="hljs-keyword">return</span>;</li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">rf</span>: <span class="hljs-title class_">SceneResourceFactory</span> = scene.<span class="hljs-title function_">getResourceFactory</span>();</li><li><span class="hljs-comment">// 后续操作可基于rf进行</span></li><li>});</li></ol></pre></div></div></li>      <li>       <p>创建材质并指定材质类型。</p>       <p>调用createMaterial()接口，指定材质类型（如MaterialType.METALLIC_ROUGHNESS或MaterialType.SHADER），异步创建材质对象。</p>       <ul>        <li>         <p>可创建基于Shader的材质，当开发者需要自定义渲染效果时，可通过自定义Shader实现。示例代码如下：</p>         <div _ngcontent-kbn-c106="" class="highlight-div"><div _ngcontent-kbn-c106="" class="highlight-div-header"><div _ngcontent-kbn-c106="" class="highlight-div-header-left"><div _ngcontent-kbn-c106="" class="handle-button expand-button"><div _ngcontent-kbn-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kbn-c106="" class="highlight-div-header-right"><div _ngcontent-kbn-c106="" class="handle-button ai-button"></div><div _ngcontent-kbn-c106="" class="handle-button line-button"><div _ngcontent-kbn-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kbn-c106="" class="handle-button theme-button"><div _ngcontent-kbn-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kbn-c106="" class="handle-button copy-button"><div _ngcontent-kbn-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kbn-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">let</span> shaderMaterialPromise = <span class="hljs-keyword">await</span> rf.<span class="hljs-title function_">createMaterial</span>({ <span class="hljs-attr">name</span>: <span class="hljs-string">"shaderMat"</span> }, <span class="hljs-title class_">MaterialType</span>.<span class="hljs-property">SHADER</span>);</li><li><span class="hljs-keyword">let</span> shaderMat = shaderMaterialPromise <span class="hljs-keyword">as</span> <span class="hljs-title class_">ShaderMaterial</span>;</li><li><span class="hljs-comment">// 绑定自定义Shader代码示例（创建shader资源，路径和文件名可根据项目实际资源自定义）</span></li><li><span class="hljs-keyword">let</span> shader = <span class="hljs-keyword">await</span> rf.<span class="hljs-title function_">createShader</span>({ <span class="hljs-attr">name</span>: <span class="hljs-string">"MyShader"</span>, <span class="hljs-attr">uri</span>: $rawfile(<span class="hljs-string">"shaders/my_shader.shader"</span>) });</li><li>shaderMat.<span class="hljs-property">colorShader</span> = shader;</li></ol></pre></div></div></li>        <li>         <p>也可创建基于PBR的材质，当开发者需要快速构建真实感渲染效果时，可使用预设的参数快速实现。示例代码如下：</p>         <div _ngcontent-kbn-c106="" class="highlight-div"><div _ngcontent-kbn-c106="" class="highlight-div-header"><div _ngcontent-kbn-c106="" class="highlight-div-header-left"><div _ngcontent-kbn-c106="" class="handle-button expand-button"><div _ngcontent-kbn-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kbn-c106="" class="highlight-div-header-right"><div _ngcontent-kbn-c106="" class="handle-button ai-button"></div><div _ngcontent-kbn-c106="" class="handle-button line-button"><div _ngcontent-kbn-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kbn-c106="" class="handle-button theme-button"><div _ngcontent-kbn-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kbn-c106="" class="handle-button copy-button"><div _ngcontent-kbn-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kbn-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">let</span> pbrMaterialPromise = <span class="hljs-keyword">await</span> rf.<span class="hljs-title function_">createMaterial</span>({ <span class="hljs-attr">name</span>: <span class="hljs-string">"pbrMat"</span> }, <span class="hljs-title class_">MaterialType</span>.<span class="hljs-property">METALLIC_ROUGHNESS</span>);</li><li><span class="hljs-keyword">let</span> pbrMat = pbrMaterialPromise <span class="hljs-keyword">as</span> <span class="hljs-title class_">MetallicRoughnessMaterial</span>;</li><li><span class="hljs-comment">// 设置基础颜色贴图和因子</span></li><li><span class="hljs-comment">// 加载图片资源，路径和文件名可根据项目实际资源自定义，但PBR材质贴图类型必须与材质属性匹配</span></li><li><span class="hljs-keyword">let</span> baseColorImage = <span class="hljs-keyword">await</span> rf.<span class="hljs-title function_">createImage</span>({ <span class="hljs-attr">name</span>: <span class="hljs-string">"baseColorTex"</span>, <span class="hljs-attr">uri</span>: $rawfile(<span class="hljs-string">"textures/baseColor.png"</span>) });</li><li>pbrMat.<span class="hljs-property">baseColor</span>.<span class="hljs-property">image</span> = baseColorImage;</li><li>pbrMat.<span class="hljs-property">baseColor</span>.<span class="hljs-property">factor</span> = { <span class="hljs-attr">x</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">z</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">w</span>: <span class="hljs-number">1</span> };</li></ol></pre></div></div></li>       </ul></li>      <li>       <p>设置材质属性。</p>       <ul>        <li>         <p>设置材质通用属性。示例代码如下：</p>         <div _ngcontent-kbn-c106="" class="highlight-div"><div _ngcontent-kbn-c106="" class="highlight-div-header"><div _ngcontent-kbn-c106="" class="highlight-div-header-left"><div _ngcontent-kbn-c106="" class="handle-button expand-button"><div _ngcontent-kbn-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kbn-c106="" class="highlight-div-header-right"><div _ngcontent-kbn-c106="" class="handle-button ai-button"></div><div _ngcontent-kbn-c106="" class="handle-button line-button"><div _ngcontent-kbn-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kbn-c106="" class="handle-button theme-button"><div _ngcontent-kbn-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kbn-c106="" class="handle-button copy-button"><div _ngcontent-kbn-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kbn-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li>material.<span class="hljs-property">shadowReceiver</span> = <span class="hljs-literal">true</span>;  <span class="hljs-comment">// 启用阴影接收</span></li><li>material.<span class="hljs-property">cullMode</span> = <span class="hljs-title class_">CullMode</span>.<span class="hljs-property">BACK</span>;  <span class="hljs-comment">// 剔除背面</span></li><li>material.<span class="hljs-property">blend</span> = { <span class="hljs-attr">enabled</span>: <span class="hljs-literal">true</span> };  <span class="hljs-comment">// 启用透明混合</span></li><li>material.<span class="hljs-property">alphaCutoff</span> = <span class="hljs-number">0.5</span>;  <span class="hljs-comment">// 透明裁剪阈值</span></li><li>material.<span class="hljs-property">renderSort</span> = { <span class="hljs-attr">renderSortLayer</span>: <span class="hljs-number">32</span>, <span class="hljs-attr">renderSortLayerOrder</span>: <span class="hljs-number">1</span> };  <span class="hljs-comment">// 渲染排序</span></li></ol></pre></div></div></li>        <li>         <p>当创建的材质类型为PBR材质时，还可以设置PBR材质属性。示例代码如下：</p>         <p>不同属性的贴图内容通常不同，需分别创建；如多个材质共用相同贴图，可复用同一个Image实例以节省内存。所有材质属性中的factor各分量取值范围均为[0, 1]。</p>         <div _ngcontent-kbn-c106="" class="highlight-div"><div _ngcontent-kbn-c106="" class="highlight-div-header"><div _ngcontent-kbn-c106="" class="highlight-div-header-left"><div _ngcontent-kbn-c106="" class="handle-button expand-button"><div _ngcontent-kbn-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kbn-c106="" class="highlight-div-header-right"><div _ngcontent-kbn-c106="" class="handle-button ai-button"></div><div _ngcontent-kbn-c106="" class="handle-button line-button"><div _ngcontent-kbn-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kbn-c106="" class="handle-button theme-button"><div _ngcontent-kbn-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kbn-c106="" class="handle-button copy-button"><div _ngcontent-kbn-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kbn-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 图片路径和文件名可根据项目实际资源自定义，但PBR材质贴图类型必须与材质属性匹配</span></li><li><span class="hljs-comment">// 设置基础颜色贴图和颜色因子（支持透明通道）</span></li><li><span class="hljs-keyword">let</span> baseColorImage = <span class="hljs-keyword">await</span> rf.<span class="hljs-title function_">createImage</span>({ <span class="hljs-attr">name</span>: <span class="hljs-string">"baseColorTex"</span>, <span class="hljs-attr">uri</span>: $rawfile(<span class="hljs-string">"textures/baseColor.png"</span>) });</li><li>pbrMat.<span class="hljs-property">baseColor</span>.<span class="hljs-property">image</span> = baseColorImage;</li><li>pbrMat.<span class="hljs-property">baseColor</span>.<span class="hljs-property">factor</span> = { <span class="hljs-attr">x</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">z</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">w</span>: <span class="hljs-number">1</span> }; <span class="hljs-comment">// xyz分量控制颜色，w为透明度（0~1）</span></li><li><span class="hljs-comment">// 设置法线贴图（控制细节凹凸感）</span></li><li><span class="hljs-keyword">let</span> normalImage = <span class="hljs-keyword">await</span> rf.<span class="hljs-title function_">createImage</span>({ <span class="hljs-attr">name</span>: <span class="hljs-string">"normalTex"</span>, <span class="hljs-attr">uri</span>: $rawfile(<span class="hljs-string">"textures/normal.png"</span>) });</li><li>pbrMat.<span class="hljs-property">normal</span>.<span class="hljs-property">image</span> = normalImage;</li><li>pbrMat.<span class="hljs-property">normal</span>.<span class="hljs-property">factor</span>.<span class="hljs-property">x</span> = <span class="hljs-number">0.6</span>; <span class="hljs-comment">// x分量：法线强度（0~1）</span></li><li><span class="hljs-comment">// 设置金属度、粗糙度和反射率属性（可共享一张贴图），通常使用y, z, w分量分别控制</span></li><li><span class="hljs-keyword">let</span> metallicRoughnessImage = <span class="hljs-keyword">await</span> rf.<span class="hljs-title function_">createImage</span>({ <span class="hljs-attr">name</span>: <span class="hljs-string">"materialTex"</span>, <span class="hljs-attr">uri</span>: $rawfile(<span class="hljs-string">"textures/material_texture.png"</span>) });</li><li>pbrMat.<span class="hljs-property">material</span>.<span class="hljs-property">image</span> = metallicRoughnessImage;</li><li>pbrMat.<span class="hljs-property">material</span>.<span class="hljs-property">factor</span>.<span class="hljs-property">y</span> = <span class="hljs-number">1.0</span>;  <span class="hljs-comment">// y 分量：粗糙度（Roughness, 0~1），0表示光滑，1表示粗糙</span></li><li>pbrMat.<span class="hljs-property">material</span>.<span class="hljs-property">factor</span>.<span class="hljs-property">z</span> = <span class="hljs-number">0.5</span>;  <span class="hljs-comment">// z 分量：金属度（Metallic, 0~1），0表示非金属，1表示金属</span></li><li>pbrMat.<span class="hljs-property">material</span>.<span class="hljs-property">factor</span>.<span class="hljs-property">w</span> = <span class="hljs-number">0.5</span>;  <span class="hljs-comment">// w 分量：反射率（Specular, 0~1）</span></li><li><span class="hljs-comment">// 设置环境光遮蔽贴图，常用x分量控制遮蔽强度</span></li><li><span class="hljs-keyword">let</span> ambientOcclusionImage = <span class="hljs-keyword">await</span> rf.<span class="hljs-title function_">createImage</span>({ <span class="hljs-attr">name</span>: <span class="hljs-string">"ambientOcclusionTex"</span>, <span class="hljs-attr">uri</span>: $rawfile(<span class="hljs-string">"textures/ambientOcclusion.png"</span>) });</li><li>pbrMat.<span class="hljs-property">ambientOcclusion</span>.<span class="hljs-property">image</span> = ambientOcclusionImage;</li><li>pbrMat.<span class="hljs-property">ambientOcclusion</span>.<span class="hljs-property">factor</span>.<span class="hljs-property">x</span> = <span class="hljs-number">1.0</span>; <span class="hljs-comment">// 遮蔽强度（0~1）</span></li><li><span class="hljs-comment">// 设置自发光贴图和颜色因子（用于夜光效果）</span></li><li><span class="hljs-keyword">let</span> emissiveImage = <span class="hljs-keyword">await</span> rf.<span class="hljs-title function_">createImage</span>({ <span class="hljs-attr">name</span>: <span class="hljs-string">"emissiveTex"</span>, <span class="hljs-attr">uri</span>: $rawfile(<span class="hljs-string">"textures/emissive.png"</span>) });</li><li>pbrMat.<span class="hljs-property">emissive</span>.<span class="hljs-property">image</span> = emissiveImage;</li><li>pbrMat.<span class="hljs-property">emissive</span>.<span class="hljs-property">factor</span> = { <span class="hljs-attr">x</span>: <span class="hljs-number">1.0</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">1.0</span>, <span class="hljs-attr">z</span>: <span class="hljs-number">0.8</span>, <span class="hljs-attr">w</span>: <span class="hljs-number">1</span> }; <span class="hljs-comment">// xyz分量控制发光颜色，w为强度（0~1）</span></li><li><span class="hljs-comment">// 设置clearCoat强度与粗糙度</span></li><li>pbrMat.<span class="hljs-property">clearCoat</span>.<span class="hljs-property">factor</span>.<span class="hljs-property">x</span> = <span class="hljs-number">1.0</span>; <span class="hljs-comment">// x分量：clearCoat强度（0~1）</span></li><li>pbrMat.<span class="hljs-property">clearCoatRoughness</span>.<span class="hljs-property">factor</span>.<span class="hljs-property">y</span> = <span class="hljs-number">0.5</span>; <span class="hljs-comment">// y分量：clearCoat粗糙度（0~1）</span></li><li><span class="hljs-comment">// 设置clearCoat法线贴图,常用x，y，z控制方向</span></li><li><span class="hljs-keyword">let</span> clearCoatNormalImage = <span class="hljs-keyword">await</span> rf.<span class="hljs-title function_">createImage</span>({ <span class="hljs-attr">name</span>: <span class="hljs-string">"clearCoatNormalTex"</span>, <span class="hljs-attr">uri</span>: $rawfile(<span class="hljs-string">"textures/clearCoatNormal.png"</span>) });</li><li>pbrMat.<span class="hljs-property">clearCoatNormal</span>.<span class="hljs-property">image</span> = clearCoatNormalImage;</li><li>pbrMat.<span class="hljs-property">clearCoatNormal</span>.<span class="hljs-property">factor</span>.<span class="hljs-property">x</span> = <span class="hljs-number">1.0</span>;</li><li>pbrMat.<span class="hljs-property">clearCoatNormal</span>.<span class="hljs-property">factor</span>.<span class="hljs-property">y</span> = <span class="hljs-number">1.0</span>;</li><li>pbrMat.<span class="hljs-property">clearCoatNormal</span>.<span class="hljs-property">factor</span>.<span class="hljs-property">z</span> = <span class="hljs-number">1.0</span>;</li><li><span class="hljs-comment">// 更多PBR属性可按需设置，如sheen、specular等。</span></li><li><span class="hljs-comment">// sheen：控制光泽强度</span></li><li><span class="hljs-comment">// pbrMat.sheen.factor = { x: 1.0, y: 0.5, z: 0.3, w: 1.0 }; // xyz控制光泽的颜色，w为强度（0~1）</span></li><li>
</li><li><span class="hljs-comment">// specular：控制高光</span></li><li><span class="hljs-comment">// pbrMat.specular.factor = { x: 1.0, y: 1.0, z: 1.0, w: 0.7 }; // xyz为高光颜色，w为高光强度（0~1）</span></li></ol></pre></div></div></li>        <li>         <p>针对Shader材质，需绑定自定义Shader资源以实现个性化渲染效果。具体使用方式可参考<a href="/consumer/cn/doc/harmonyos-guides/arkgraphics3d-resource-material#创建shader材质并设置属性">创建Shader材质并设置属性</a>。</p></li>       </ul></li>      <li>       <p>绑定材质到网格。</p>       <p>将创建的材质赋值给几何体（Geometry）的material或subMeshes[i].material字段，使其生效。常见绑定方式有两种：</p>       <ul>        <li>         <p>通过资源工厂新建网格和几何体，再绑定材质（适用于创建新几何体的情况）。示例代码如下：</p>         <div _ngcontent-kbn-c106="" class="highlight-div"><div _ngcontent-kbn-c106="" class="highlight-div-header"><div _ngcontent-kbn-c106="" class="highlight-div-header-left"><div _ngcontent-kbn-c106="" class="handle-button expand-button"><div _ngcontent-kbn-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kbn-c106="" class="highlight-div-header-right"><div _ngcontent-kbn-c106="" class="handle-button ai-button"></div><div _ngcontent-kbn-c106="" class="handle-button line-button"><div _ngcontent-kbn-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kbn-c106="" class="handle-button theme-button"><div _ngcontent-kbn-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kbn-c106="" class="handle-button copy-button"><div _ngcontent-kbn-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kbn-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">let</span> mesh = <span class="hljs-keyword">await</span> resourceFactory.<span class="hljs-title function_">createMesh</span>({ <span class="hljs-attr">name</span>: <span class="hljs-string">"mesh"</span> }, geometry);</li><li><span class="hljs-keyword">let</span> geometryInstance = <span class="hljs-keyword">await</span> resourceFactory.<span class="hljs-title function_">createGeometry</span>({ <span class="hljs-attr">name</span>: <span class="hljs-string">"geometry"</span> }, mesh);</li><li>geometryInstance.<span class="hljs-property">mesh</span>.<span class="hljs-property">subMeshes</span>[<span class="hljs-number">0</span>].<span class="hljs-property">material</span> = pbrMat;  <span class="hljs-comment">// 绑定材质</span></li></ol></pre></div></div></li>        <li>         <p>通过scene.root.getNodeByPath直接获取已有几何节点，修改绑定材质（适用于加载场景后修改材质）。示例代码如下：</p>         <div _ngcontent-kbn-c106="" class="highlight-div"><div _ngcontent-kbn-c106="" class="highlight-div-header"><div _ngcontent-kbn-c106="" class="highlight-div-header-left"><div _ngcontent-kbn-c106="" class="handle-button expand-button"><div _ngcontent-kbn-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kbn-c106="" class="highlight-div-header-right"><div _ngcontent-kbn-c106="" class="handle-button ai-button"></div><div _ngcontent-kbn-c106="" class="handle-button line-button"><div _ngcontent-kbn-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kbn-c106="" class="handle-button theme-button"><div _ngcontent-kbn-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kbn-c106="" class="handle-button copy-button"><div _ngcontent-kbn-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kbn-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">let</span> pbrNode = scene.<span class="hljs-property">root</span>.<span class="hljs-title function_">getNodeByPath</span>(<span class="hljs-string">"path/to/node"</span>);</li><li><span class="hljs-keyword">if</span> (pbrNode) {</li><li>  <span class="hljs-keyword">let</span> geometry = pbrNode <span class="hljs-keyword">as</span> <span class="hljs-title class_">Geometry</span>;</li><li>  <span class="hljs-keyword">if</span> (geometry.<span class="hljs-property">mesh</span>?.<span class="hljs-property">subMeshes</span>?.[<span class="hljs-number">0</span>]) {</li><li>    geometry.<span class="hljs-property">mesh</span>.<span class="hljs-property">subMeshes</span>[<span class="hljs-number">0</span>].<span class="hljs-property">material</span> = pbrMat;  <span class="hljs-comment">// 绑定材质</span></li><li>  }</li><li>}</li></ol></pre></div></div></li>       </ul></li>      <li>       <p>渲染并观察效果。运行渲染流程，观察材质的最终视觉表现。</p></li>     </ol>    </div>    <div class="tiledSection">     <h2 id="完整代码">完整代码<i class="anchor-icon anchor-icon-link" anchorid="完整代码" tips="复制节点链接"></i></h2>         </div>    <div class="tiledSection">     <h3 id="创建shader材质并设置属性" class="firsth2">创建Shader材质并设置属性<i class="anchor-icon anchor-icon-link" anchorid="创建shader材质并设置属性" tips="复制节点链接"></i></h3>          <div _ngcontent-kbn-c106="" class="highlight-div"><div _ngcontent-kbn-c106="" class="highlight-div-header"><div _ngcontent-kbn-c106="" class="highlight-div-header-left"><div _ngcontent-kbn-c106="" class="handle-button expand-button"><div _ngcontent-kbn-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kbn-c106="" class="highlight-div-header-right"><div _ngcontent-kbn-c106="" class="handle-button ai-button"></div><div _ngcontent-kbn-c106="" class="handle-button line-button"><div _ngcontent-kbn-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kbn-c106="" class="handle-button theme-button"><div _ngcontent-kbn-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kbn-c106="" class="handle-button copy-button"><div _ngcontent-kbn-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kbn-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">MaterialType</span>, <span class="hljs-title class_">ShaderMaterial</span>, <span class="hljs-title class_">SceneResourceParameters</span>, <span class="hljs-title class_">SceneResourceFactory</span>, <span class="hljs-title class_">Scene</span>, <span class="hljs-title class_">Geometry</span>,</li><li>  <span class="hljs-title class_">CullMode</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkGraphics3D'</span>;</li><li>
</li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">createAndApplyShaderMaterial</span>(<span class="hljs-params"></span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {</li><li>  <span class="hljs-comment">// 加载场景资源，支持.gltf和.glb格式，路径和文件名可根据项目实际资源自定义</span></li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">scenePromise</span>: <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">Scene</span>&gt; = <span class="hljs-title class_">Scene</span>.<span class="hljs-title function_">load</span>($rawfile(<span class="hljs-string">"gltf/CubeWithFloor/glTF/AnimatedCube.glb"</span>));</li><li>  <span class="hljs-keyword">return</span> scenePromise.<span class="hljs-title function_">then</span>(<span class="hljs-keyword">async</span> (<span class="hljs-attr">scene</span>: <span class="hljs-title class_">Scene</span>) =&gt; {</li><li>    <span class="hljs-keyword">if</span> (!scene.<span class="hljs-property">root</span>) {</li><li>      <span class="hljs-keyword">return</span>;</li><li>    }</li><li>    <span class="hljs-comment">// 获取资源工厂</span></li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">rf</span>: <span class="hljs-title class_">SceneResourceFactory</span> = scene.<span class="hljs-title function_">getResourceFactory</span>();</li><li>    <span class="hljs-comment">// 创建Shader材质</span></li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">materialParams</span>: <span class="hljs-title class_">SceneResourceParameters</span> = { <span class="hljs-attr">name</span>: <span class="hljs-string">"material"</span> };</li><li>    <span class="hljs-keyword">let</span> material = <span class="hljs-keyword">await</span> rf.<span class="hljs-title function_">createMaterial</span>(materialParams, <span class="hljs-title class_">MaterialType</span>.<span class="hljs-property">SHADER</span>);</li><li>    <span class="hljs-keyword">let</span> shaderMat = material <span class="hljs-keyword">as</span> <span class="hljs-title class_">ShaderMaterial</span>;</li><li>    <span class="hljs-comment">// 加载并绑定自定义Shader代码（创建shader资源，路径和文件名可根据项目实际资源自定义）</span></li><li>    <span class="hljs-keyword">let</span> shader = <span class="hljs-keyword">await</span> rf.<span class="hljs-title function_">createShader</span>({</li><li>      <span class="hljs-attr">name</span>: <span class="hljs-string">"shaderResource"</span>,</li><li>      <span class="hljs-attr">uri</span>: $rawfile(<span class="hljs-string">"shaders/custom_shader/custom_material_sample.shader"</span>)</li><li>    });</li><li>    shaderMat.<span class="hljs-property">colorShader</span> = shader;</li><li>    <span class="hljs-comment">// 设置通用属性</span></li><li>    shaderMat.<span class="hljs-property">shadowReceiver</span> = <span class="hljs-literal">true</span>;</li><li>    shaderMat.<span class="hljs-property">cullMode</span> = <span class="hljs-title class_">CullMode</span>.<span class="hljs-property">BACK</span>;</li><li>    shaderMat.<span class="hljs-property">blend</span> = { <span class="hljs-attr">enabled</span>: <span class="hljs-literal">true</span> }; <span class="hljs-comment">// 例如启用透明混合</span></li><li>    shaderMat.<span class="hljs-property">alphaCutoff</span> = <span class="hljs-number">0.5</span>;</li><li>    <span class="hljs-comment">// 绑定材质到已有网格节点</span></li><li>    <span class="hljs-keyword">let</span> shaderNode = scene.<span class="hljs-property">root</span>.<span class="hljs-title function_">getNodeByPath</span>(<span class="hljs-string">"rootNode_/Unnamed Node 1/AnimatedCube"</span>);</li><li>    <span class="hljs-keyword">if</span> (shaderNode) {</li><li>      <span class="hljs-keyword">let</span> geometry = shaderNode <span class="hljs-keyword">as</span> <span class="hljs-title class_">Geometry</span>;</li><li>      <span class="hljs-keyword">if</span> (geometry.<span class="hljs-property">mesh</span>?.<span class="hljs-property">subMeshes</span>?.[<span class="hljs-number">0</span>]) {</li><li>        geometry.<span class="hljs-property">mesh</span>.<span class="hljs-property">subMeshes</span>[<span class="hljs-number">0</span>].<span class="hljs-property">material</span> = shaderMat;</li><li>      }</li><li>    }</li><li>    <span class="hljs-comment">// 后续执行渲染观察效果</span></li><li>  });</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="创建pbr材质并设置属性">创建PBR材质并设置属性<i class="anchor-icon anchor-icon-link" anchorid="创建pbr材质并设置属性" tips="复制节点链接"></i></h3>          <p>不同模型支持的PBR属性可能有所不同，设置材质前建议根据模型内容进行适配。本例使用CompareClearcoat模型作为示例，设置其支持的PBR属性，开发者可根据需要使用对应模型并设置相关属性。</p>     <div _ngcontent-kbn-c106="" class="highlight-div"><div _ngcontent-kbn-c106="" class="highlight-div-header"><div _ngcontent-kbn-c106="" class="highlight-div-header-left"><div _ngcontent-kbn-c106="" class="handle-button expand-button"><div _ngcontent-kbn-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kbn-c106="" class="highlight-div-header-right"><div _ngcontent-kbn-c106="" class="handle-button ai-button"></div><div _ngcontent-kbn-c106="" class="handle-button line-button"><div _ngcontent-kbn-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kbn-c106="" class="handle-button theme-button"><div _ngcontent-kbn-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kbn-c106="" class="handle-button copy-button"><div _ngcontent-kbn-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kbn-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">MaterialType</span>, <span class="hljs-title class_">SceneResourceParameters</span>, <span class="hljs-title class_">SceneResourceFactory</span>, <span class="hljs-title class_">Scene</span>, <span class="hljs-title class_">MetallicRoughnessMaterial</span>, <span class="hljs-title class_">Geometry</span>,</li><li>  <span class="hljs-title class_">CullMode</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkGraphics3D'</span>;</li><li>
</li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">createAndApplyPBRMaterial</span>(<span class="hljs-params"></span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {</li><li>  <span class="hljs-comment">// 加载场景资源，支持.gltf和.glb格式，路径和文件名可根据项目实际资源自定义</span></li><li>  <span class="hljs-comment">// 不同模型支持的PBR属性可能有所不同，设置材质前建议根据模型内容进行适配，本例使用CompareClearcoat模型作为示例。</span></li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">scenePromise</span>: <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">Scene</span>&gt; = <span class="hljs-title class_">Scene</span>.<span class="hljs-title function_">load</span>($rawfile(<span class="hljs-string">"CompareClearcoat.glb"</span>));</li><li>  <span class="hljs-keyword">return</span> scenePromise.<span class="hljs-title function_">then</span>(<span class="hljs-keyword">async</span> (<span class="hljs-attr">scene</span>: <span class="hljs-title class_">Scene</span>) =&gt; {</li><li>    <span class="hljs-keyword">if</span> (!scene.<span class="hljs-property">root</span>) {</li><li>      <span class="hljs-keyword">return</span>;</li><li>    }</li><li>    <span class="hljs-comment">// 获取资源工厂</span></li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">rf</span>: <span class="hljs-title class_">SceneResourceFactory</span> = scene.<span class="hljs-title function_">getResourceFactory</span>();</li><li>    <span class="hljs-comment">// 创建PBR材质</span></li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">materialParams</span>: <span class="hljs-title class_">SceneResourceParameters</span> = { <span class="hljs-attr">name</span>: <span class="hljs-string">"MyPBRMaterial"</span> };</li><li>    <span class="hljs-keyword">let</span> material = <span class="hljs-keyword">await</span> rf.<span class="hljs-title function_">createMaterial</span>(materialParams, <span class="hljs-title class_">MaterialType</span>.<span class="hljs-property">METALLIC_ROUGHNESS</span>);</li><li>    <span class="hljs-keyword">let</span> pbrMat = material <span class="hljs-keyword">as</span> <span class="hljs-title class_">MetallicRoughnessMaterial</span>;</li><li>
</li><li>    <span class="hljs-comment">// 加载共享的metallic-roughness贴图（可复用，节省资源），图片路径和文件名可根据项目实际资源自定义，但贴图类型必须与材质属性匹配</span></li><li>    <span class="hljs-keyword">let</span> metallicImage = <span class="hljs-keyword">await</span> rf.<span class="hljs-title function_">createImage</span>({</li><li>      <span class="hljs-attr">name</span>: <span class="hljs-string">"materialTex"</span>,</li><li>      <span class="hljs-attr">uri</span>: $rawfile(<span class="hljs-string">"gltf/DamagedHelmet/glTF/Default_metalRoughness.jpg"</span>)</li><li>    });</li><li>    pbrMat.<span class="hljs-property">material</span>.<span class="hljs-property">image</span> = metallicImage;</li><li>    <span class="hljs-comment">// 配置y，z，w分量控制粗糙度、金属度、反射率</span></li><li>    pbrMat.<span class="hljs-property">material</span>.<span class="hljs-property">factor</span> = { <span class="hljs-attr">x</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">0.8</span>, <span class="hljs-attr">z</span>: <span class="hljs-number">0.4</span>, <span class="hljs-attr">w</span>: <span class="hljs-number">0.6</span> };</li><li>    <span class="hljs-comment">// 配置环境光遮蔽贴图</span></li><li>    pbrMat.<span class="hljs-property">ambientOcclusion</span>.<span class="hljs-property">factor</span>.<span class="hljs-property">x</span> = <span class="hljs-number">1.0</span>;</li><li>    <span class="hljs-comment">// 配置clearCoat强度与粗糙度</span></li><li>    pbrMat.<span class="hljs-property">clearCoat</span>.<span class="hljs-property">factor</span>.<span class="hljs-property">x</span> = <span class="hljs-number">1.0</span>;</li><li>    pbrMat.<span class="hljs-property">clearCoatRoughness</span>.<span class="hljs-property">factor</span>.<span class="hljs-property">y</span> = <span class="hljs-number">0.5</span>;</li><li>    <span class="hljs-comment">// 配置sheen光泽属性</span></li><li>    pbrMat.<span class="hljs-property">sheen</span>.<span class="hljs-property">factor</span> = { <span class="hljs-attr">x</span>: <span class="hljs-number">1.0</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">0.2</span>, <span class="hljs-attr">z</span>: <span class="hljs-number">0.2</span>, <span class="hljs-attr">w</span>: <span class="hljs-number">0.8</span> };</li><li>
</li><li>    <span class="hljs-comment">// 设置通用属性</span></li><li>    pbrMat.<span class="hljs-property">shadowReceiver</span> = <span class="hljs-literal">true</span>;</li><li>    pbrMat.<span class="hljs-property">cullMode</span> = <span class="hljs-title class_">CullMode</span>.<span class="hljs-property">BACK</span>;</li><li>    pbrMat.<span class="hljs-property">blend</span> = { <span class="hljs-attr">enabled</span>: <span class="hljs-literal">false</span> };</li><li>    pbrMat.<span class="hljs-property">alphaCutoff</span> = <span class="hljs-number">0.5</span>;</li><li>    <span class="hljs-comment">// 绑定材质到已有网格节点</span></li><li>    <span class="hljs-keyword">let</span> pbrNode = scene.<span class="hljs-property">root</span>.<span class="hljs-title function_">getNodeByPath</span>(<span class="hljs-string">"Unnamed Node 1/GeoSphere002"</span>);</li><li>    <span class="hljs-keyword">if</span> (pbrNode) {</li><li>      <span class="hljs-keyword">let</span> geometry = pbrNode <span class="hljs-keyword">as</span> <span class="hljs-title class_">Geometry</span>;</li><li>      geometry.<span class="hljs-property">mesh</span>.<span class="hljs-property">subMeshes</span>[<span class="hljs-number">0</span>].<span class="hljs-property">material</span> = pbrMat;</li><li>    }</li><li>    <span class="hljs-comment">// 运行渲染流程，观察材质的最终视觉表现</span></li><li>  });</li><li>}</li></ol></pre></div></div>    </div>   </div>   <div></div></div>