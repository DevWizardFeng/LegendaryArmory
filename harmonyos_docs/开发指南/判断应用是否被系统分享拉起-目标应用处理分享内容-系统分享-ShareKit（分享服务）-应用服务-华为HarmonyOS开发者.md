<h1 _ngcontent-oig-c119="" class="doc-title ng-star-inserted" title="判断应用是否被系统分享拉起"> 判断应用是否被系统分享拉起 </h1>

<div _ngcontent-oig-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div><p>从5.1.0(18)版本开始，支持应用判断是否被系统分享拉起。</p> <p>作为目标应用接入系统分享时，当应用被拉起，需要判断本次启动原因是被系统分享拉起的，以便处理对应的分享业务。</p> <ul><li>通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability" target="_blank">UIAbility</a>处理分享内容时，可使用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability#oncreate" target="_blank">onCreate</a>或<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability#onnewwant" target="_blank">onNewWant</a>的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-abilityconstant#launchparam" target="_blank">LaunchParam.launchReasonMessage</a>字段是否为'ReasonMessage_SystemShare'判断。</li><li>通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiextensionability" target="_blank">UIExtensionAbility</a>处理分享内容时，可使用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiextensionability#oncreate" target="_blank">onCreate</a>的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-abilityconstant#launchparam" target="_blank">LaunchParam.launchReasonMessage</a>字段是否为'ReasonMessage_SystemShare'判断。</li></ul> <div class="tiledSection"><h2 id="section121193673710">示例代码<i class="anchor-icon anchor-icon-link" anchorid="section121193673710" tips="复制节点链接"></i></h2><ul><li>通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability" target="_blank">UIAbility</a>处理分享内容。<div _ngcontent-oig-c106="" class="highlight-div"><div _ngcontent-oig-c106="" class="highlight-div-header"><div _ngcontent-oig-c106="" class="highlight-div-header-left"><div _ngcontent-oig-c106="" class="handle-button expand-button"><div _ngcontent-oig-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-oig-c106="" class="highlight-div-header-right"><div _ngcontent-oig-c106="" class="handle-button ai-button"></div><div _ngcontent-oig-c106="" class="handle-button line-button"><div _ngcontent-oig-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-oig-c106="" class="handle-button theme-button"><div _ngcontent-oig-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-oig-c106="" class="handle-button copy-button"><div _ngcontent-oig-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-oig-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-variable">AbilityConstant</span>, <span class="hljs-variable">UIAbility</span>, <span class="hljs-variable">Want</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-variable">window</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span>;</li><li>
</li><li><span class="hljs-variable">export</span> <span class="hljs-variable">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ShareUIAbility</span> <span class="hljs-variable">extends</span> <span class="hljs-variable">UIAbility</span> {</li><li>  <span class="hljs-title function_">onCreate</span>(<span class="hljs-variable">want</span>: <span class="hljs-title class_">Want</span>, <span class="hljs-variable">launchParam</span>: <span class="hljs-title class_">AbilityConstant</span>.<span class="hljs-title class_">LaunchParam</span>): <span class="hljs-title class_">void</span> {</li><li>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">launchParam</span>.<span class="hljs-variable">launchReasonMessage</span> === <span class="hljs-string">'ReasonMessage_SystemShare'</span>) {</li><li>      <span class="hljs-comment">// 识别为被系统分享拉起</span></li><li>      <span class="hljs-variable">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'被拉起原因：系统分享'</span>);</li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">onNewWant</span>(<span class="hljs-variable">want</span>: <span class="hljs-title class_">Want</span>, <span class="hljs-variable">launchParam</span>: <span class="hljs-title class_">AbilityConstant</span>.<span class="hljs-title class_">LaunchParam</span>): <span class="hljs-title class_">void</span> {</li><li>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">launchParam</span>.<span class="hljs-variable">launchReasonMessage</span> === <span class="hljs-string">'ReasonMessage_SystemShare'</span>) {</li><li>      <span class="hljs-comment">// 识别为被系统分享拉起</span></li><li>      <span class="hljs-variable">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'被拉起原因：系统分享'</span>);</li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">onWindowStageCreate</span>(<span class="hljs-variable">windowStage</span>: <span class="hljs-title class_">window</span>.<span class="hljs-title class_">WindowStage</span>): <span class="hljs-title class_">void</span> {</li><li>    <span class="hljs-variable">windowStage</span>.<span class="hljs-title function_">loadContent</span>(<span class="hljs-string">'pages/ShareUIPage'</span>); <span class="hljs-comment">// 此路径仅为示例 请替换实际路径</span></li><li>  }</li><li>}</li></ol></pre></div></div> </li><li>通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiextensionability" target="_blank">UIExtensionAbility</a>处理分享内容。<div _ngcontent-oig-c106="" class="highlight-div"><div _ngcontent-oig-c106="" class="highlight-div-header"><div _ngcontent-oig-c106="" class="highlight-div-header-left"><div _ngcontent-oig-c106="" class="handle-button expand-button"><div _ngcontent-oig-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-oig-c106="" class="highlight-div-header-right"><div _ngcontent-oig-c106="" class="handle-button ai-button"></div><div _ngcontent-oig-c106="" class="handle-button line-button"><div _ngcontent-oig-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-oig-c106="" class="handle-button theme-button"><div _ngcontent-oig-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-oig-c106="" class="handle-button copy-button"><div _ngcontent-oig-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-oig-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-variable">AbilityConstant</span>, <span class="hljs-variable">ShareExtensionAbility</span>, <span class="hljs-variable">UIExtensionContentSession</span>, <span class="hljs-variable">Want</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-variable">export</span> <span class="hljs-variable">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ShareExtAbility</span> <span class="hljs-variable">extends</span> <span class="hljs-variable">ShareExtensionAbility</span> {</li><li>  <span class="hljs-title function_">onCreate</span>(<span class="hljs-variable">launchParam</span>: <span class="hljs-title class_">AbilityConstant</span>.<span class="hljs-title class_">LaunchParam</span>): <span class="hljs-title class_">void</span> {</li><li>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">launchParam</span>.<span class="hljs-variable">launchReasonMessage</span> === <span class="hljs-string">'ReasonMessage_SystemShare'</span>) {</li><li>      <span class="hljs-comment">// 识别为被系统分享拉起</span></li><li>      <span class="hljs-variable">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'被拉起原因：系统分享'</span>);</li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">onSessionCreate</span>(<span class="hljs-variable">want</span>: <span class="hljs-title class_">Want</span>, <span class="hljs-variable">session</span>: <span class="hljs-title class_">UIExtensionContentSession</span>) {</li><li>    <span class="hljs-variable">session</span>.<span class="hljs-title function_">loadContent</span>(<span class="hljs-string">'pages/ShareExtDialog'</span>); <span class="hljs-comment">// 此路径仅为示例 请替换实际路径</span></li><li>  }</li><li>}</li></ol></pre></div></div> </li></ul> </div> </div> <div></div></div>