<h1 _ngcontent-opg-c119="" class="doc-title ng-star-inserted" title="刷新本地图片和网络图片"> 刷新本地图片和网络图片 </h1>

<div _ngcontent-opg-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p>在卡片上通常需要展示本地图片或从网络上下载的图片，获取本地图片和网络图片需要通过FormExtensionAbility来实现，如下示例代码介绍了如何在卡片上显示本地图片和网络图片。</p>    <ol>     <li>      <p>下载网络图片需要使用到网络能力，需要申请ohos.permission.INTERNET权限，配置方式请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/declare-permissions">声明权限</a>。</p></li>     <li>      <p>在EntryFormAbility中的onAddForm生命周期回调中实现本地文件的刷新。</p>      <div _ngcontent-opg-c106="" class="highlight-div"><div _ngcontent-opg-c106="" class="highlight-div-header"><div _ngcontent-opg-c106="" class="highlight-div-header-left"><div _ngcontent-opg-c106="" class="handle-button expand-button"><div _ngcontent-opg-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-opg-c106="" class="highlight-div-header-right"><div _ngcontent-opg-c106="" class="handle-button ai-button"></div><div _ngcontent-opg-c106="" class="handle-button line-button"><div _ngcontent-opg-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-opg-c106="" class="handle-button theme-button"><div _ngcontent-opg-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-opg-c106="" class="handle-button copy-button"><div _ngcontent-opg-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-opg-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Want</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { fileIo } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.CoreFileKit'</span>;</li><li><span class="hljs-keyword">import</span> { formBindingData, <span class="hljs-title class_">FormExtensionAbility</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.FormKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li>
</li><li><span class="hljs-keyword">const</span> <span class="hljs-attr">TAG</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'WgtImgUpdateEntryFormAbility'</span>;</li><li><span class="hljs-keyword">const</span> <span class="hljs-attr">DOMAIN_NUMBER</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0xFF00</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WgtImgUpdateEntryFormAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">FormExtensionAbility</span> {</li><li>  <span class="hljs-comment">// 在添加卡片时，打开一个本地图片并将图片内容传递给卡片页面显示</span></li><li>  <span class="hljs-title function_">onAddForm</span>(<span class="hljs-attr">want</span>: <span class="hljs-title class_">Want</span>): formBindingData.<span class="hljs-property">FormBindingData</span> {</li><li>    <span class="hljs-comment">// 假设在当前卡片应用的tmp目录下有一个本地图片：head.PNG</span></li><li>    <span class="hljs-keyword">let</span> tempDir = <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">getApplicationContext</span>().<span class="hljs-property">tempDir</span>;</li><li>    hilog.<span class="hljs-title function_">info</span>(<span class="hljs-variable constant_">DOMAIN_NUMBER</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">`tempDir: <span class="hljs-subst">${tempDir}</span>`</span>);</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">imgMap</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">number</span>&gt; = {};</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-comment">// 打开本地图片并获取其打开后的fd, FormExtensionAbility进程销毁时释放</span></li><li>      <span class="hljs-keyword">let</span> file = fileIo.<span class="hljs-title function_">openSync</span>(tempDir + <span class="hljs-string">'/'</span> + <span class="hljs-string">'head.PNG'</span>);</li><li>      imgMap[<span class="hljs-string">'imgBear'</span>] = file.<span class="hljs-property">fd</span>;</li><li>    } <span class="hljs-keyword">catch</span> (e) {</li><li>      hilog.<span class="hljs-title function_">error</span>(<span class="hljs-variable constant_">DOMAIN_NUMBER</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">`openSync failed: <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(e <span class="hljs-keyword">as</span> BusinessError)}</span>`</span>);</li><li>    }</li><li>
</li><li>    <span class="hljs-keyword">class</span> <span class="hljs-title class_">FormDataClass</span> {</li><li>      <span class="hljs-attr">text</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'Image: Bear'</span>;</li><li>      <span class="hljs-attr">loaded</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">true</span>;</li><li>      <span class="hljs-comment">// 卡片需要显示图片场景, 必须和下列字段formImages 中的key 'imgBear' 相同。</span></li><li>      <span class="hljs-attr">imgName</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'imgBear'</span>;</li><li>      <span class="hljs-comment">// 卡片需要显示图片场景, 必填字段(formImages 不可缺省或改名), 'imgBear' 对应 fd</span></li><li>      <span class="hljs-attr">formImages</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">number</span>&gt; = imgMap;</li><li>    }</li><li>
</li><li>    <span class="hljs-keyword">let</span> formData = <span class="hljs-keyword">new</span> <span class="hljs-title class_">FormDataClass</span>();</li><li>    <span class="hljs-comment">// 将fd封装在formData中并返回至卡片页面</span></li><li>    <span class="hljs-keyword">return</span> formBindingData.<span class="hljs-title function_">createFormBindingData</span>(formData);</li><li>  }</li><li>  <span class="hljs-comment">//...</span></li><li>}</li></ol></pre></div></div></li>     <li>      <p>在EntryFormAbility中的onFormEvent生命周期回调中实现网络文件的刷新。</p>      <div _ngcontent-opg-c106="" class="highlight-div"><div _ngcontent-opg-c106="" class="highlight-div-header"><div _ngcontent-opg-c106="" class="highlight-div-header-left"><div _ngcontent-opg-c106="" class="handle-button expand-button"><div _ngcontent-opg-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-opg-c106="" class="highlight-div-header-right"><div _ngcontent-opg-c106="" class="handle-button ai-button"></div><div _ngcontent-opg-c106="" class="handle-button line-button"><div _ngcontent-opg-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-opg-c106="" class="handle-button theme-button"><div _ngcontent-opg-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-opg-c106="" class="handle-button copy-button"><div _ngcontent-opg-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-opg-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { fileIo } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.CoreFileKit'</span>;</li><li><span class="hljs-keyword">import</span> { formBindingData, <span class="hljs-title class_">FormExtensionAbility</span>, formProvider } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.FormKit'</span>;</li><li><span class="hljs-keyword">import</span> { http } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NetworkKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li>
</li><li><span class="hljs-keyword">const</span> <span class="hljs-attr">TAG</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'WgtImgUpdateEntryFormAbility'</span>;</li><li><span class="hljs-keyword">const</span> <span class="hljs-attr">DOMAIN_NUMBER</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0xFF00</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">WgtImgUpdateEntryFormAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">FormExtensionAbility</span> {</li><li>  <span class="hljs-keyword">async</span> <span class="hljs-title function_">onFormEvent</span>(<span class="hljs-attr">formId</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">param</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">string</span>&gt; = {</li><li>      <span class="hljs-string">'text'</span>: <span class="hljs-string">'刷新中...'</span></li><li>    };</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">formInfo</span>: formBindingData.<span class="hljs-property">FormBindingData</span> = formBindingData.<span class="hljs-title function_">createFormBindingData</span>(param);</li><li>    formProvider.<span class="hljs-title function_">updateForm</span>(formId, formInfo);</li><li>
</li><li>    <span class="hljs-comment">// 注意：FormExtensionAbility在触发生命周期回调时被拉起，仅能在后台存在5秒</span></li><li>    <span class="hljs-comment">// 建议下载能快速下载完成的小文件，如在5秒内未下载完成，则此次网络图片无法刷新至卡片页面上</span></li><li>    <span class="hljs-keyword">let</span> netFile = <span class="hljs-string">'https://cn-assets.gitee.com/assets/mini_app-e5eee5a21c552b69ae6bf2cf87406b59.jpg'</span>; <span class="hljs-comment">// 需要在此处使用真实的网络图片下载链接</span></li><li>    <span class="hljs-keyword">let</span> tempDir = <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">getApplicationContext</span>().<span class="hljs-property">tempDir</span>;</li><li>    <span class="hljs-keyword">let</span> fileName = <span class="hljs-string">'file'</span> + <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();</li><li>    <span class="hljs-keyword">let</span> tmpFile = tempDir + <span class="hljs-string">'/'</span> + fileName;</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">imgMap</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">number</span>&gt; = {};</li><li>
</li><li>    <span class="hljs-keyword">class</span> <span class="hljs-title class_">FormDataClass</span> {</li><li>      <span class="hljs-attr">text</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'Image: Bear'</span> + fileName;</li><li>      <span class="hljs-attr">loaded</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">true</span>;</li><li>      <span class="hljs-comment">// 卡片需要显示图片场景, 必须和下列字段formImages 中的key fileName 相同。</span></li><li>      <span class="hljs-attr">imgName</span>: <span class="hljs-built_in">string</span> = fileName;</li><li>      <span class="hljs-comment">// 卡片需要显示图片场景, 必填字段(formImages 不可缺省或改名), fileName 对应 fd</span></li><li>      <span class="hljs-attr">formImages</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">number</span>&gt; = imgMap;</li><li>    }</li><li>
</li><li>    <span class="hljs-keyword">let</span> httpRequest = http.<span class="hljs-title function_">createHttp</span>()</li><li>    <span class="hljs-keyword">let</span> data = <span class="hljs-keyword">await</span> httpRequest.<span class="hljs-title function_">request</span>(netFile);</li><li>    <span class="hljs-keyword">if</span> (data?.<span class="hljs-property">responseCode</span> == http.<span class="hljs-property">ResponseCode</span>.<span class="hljs-property">OK</span>) {</li><li>      <span class="hljs-keyword">try</span> {</li><li>        <span class="hljs-keyword">let</span> imgFile = fileIo.<span class="hljs-title function_">openSync</span>(tmpFile, fileIo.<span class="hljs-property">OpenMode</span>.<span class="hljs-property">READ_WRITE</span> | fileIo.<span class="hljs-property">OpenMode</span>.<span class="hljs-property">CREATE</span>);</li><li>        imgMap[fileName] = imgFile.<span class="hljs-property">fd</span>;</li><li>        <span class="hljs-keyword">try</span>{</li><li>          <span class="hljs-keyword">let</span> <span class="hljs-attr">writeLen</span>: <span class="hljs-built_in">number</span> = <span class="hljs-keyword">await</span> fileIo.<span class="hljs-title function_">write</span>(imgFile.<span class="hljs-property">fd</span>, data.<span class="hljs-property">result</span> <span class="hljs-keyword">as</span> <span class="hljs-title class_">ArrayBuffer</span>);</li><li>          hilog.<span class="hljs-title function_">info</span>(<span class="hljs-variable constant_">DOMAIN_NUMBER</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">"write data to file succeed and size is:"</span> + writeLen);</li><li>          hilog.<span class="hljs-title function_">info</span>(<span class="hljs-variable constant_">DOMAIN_NUMBER</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'ArkTSCard download complete: %{public}s'</span>, tmpFile);</li><li>          <span class="hljs-keyword">try</span> {</li><li>            <span class="hljs-keyword">let</span> formData = <span class="hljs-keyword">new</span> <span class="hljs-title class_">FormDataClass</span>();</li><li>            <span class="hljs-keyword">let</span> formInfo = formBindingData.<span class="hljs-title function_">createFormBindingData</span>(formData);</li><li>            <span class="hljs-keyword">await</span> formProvider.<span class="hljs-title function_">updateForm</span>(formId, formInfo);</li><li>            hilog.<span class="hljs-title function_">info</span>(<span class="hljs-variable constant_">DOMAIN_NUMBER</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'%{public}s'</span>, <span class="hljs-string">'FormAbility updateForm success.'</span>);</li><li>          } <span class="hljs-keyword">catch</span> (error) {</li><li>            hilog.<span class="hljs-title function_">error</span>(<span class="hljs-variable constant_">DOMAIN_NUMBER</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">`FormAbility updateForm failed: <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(error)}</span>`</span>);</li><li>          }</li><li>        } <span class="hljs-keyword">catch</span> (err) {</li><li>          hilog.<span class="hljs-title function_">error</span>(<span class="hljs-variable constant_">DOMAIN_NUMBER</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">"write data to file failed with error message: "</span> + err.<span class="hljs-property">message</span> + <span class="hljs-string">", error code: "</span> + err.<span class="hljs-property">code</span>);</li><li>        } <span class="hljs-keyword">finally</span> {</li><li>          <span class="hljs-comment">// 在fileIo.closeSync执行之前，确保formProvider.updateForm已执行完毕。</span></li><li>          fileIo.<span class="hljs-title function_">closeSync</span>(imgFile);</li><li>        };</li><li>      } <span class="hljs-keyword">catch</span> (e) {</li><li>        hilog.<span class="hljs-title function_">error</span>(<span class="hljs-variable constant_">DOMAIN_NUMBER</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">`openSync failed: <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(e <span class="hljs-keyword">as</span> BusinessError)}</span>`</span>);</li><li>      }</li><li>
</li><li>    } <span class="hljs-keyword">else</span> {</li><li>      hilog.<span class="hljs-title function_">error</span>(<span class="hljs-variable constant_">DOMAIN_NUMBER</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">`ArkTSCard download task failed`</span>);</li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">param</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">string</span>&gt; = {</li><li>        <span class="hljs-string">'text'</span>: <span class="hljs-string">'刷新失败'</span></li><li>      };</li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">formInfo</span>: formBindingData.<span class="hljs-property">FormBindingData</span> = formBindingData.<span class="hljs-title function_">createFormBindingData</span>(param);</li><li>      formProvider.<span class="hljs-title function_">updateForm</span>(formId, formInfo);</li><li>    }</li><li>    httpRequest.<span class="hljs-title function_">destroy</span>();</li><li>  }</li><li>}</li></ol></pre></div></div></li>     <li>      <p>在卡片页面通过backgroundImage属性展示EntryFormAbility传递过来的卡片内容。</p>      <div _ngcontent-opg-c106="" class="highlight-div"><div _ngcontent-opg-c106="" class="highlight-div-header"><div _ngcontent-opg-c106="" class="highlight-div-header-left"><div _ngcontent-opg-c106="" class="handle-button expand-button"><div _ngcontent-opg-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-opg-c106="" class="highlight-div-header-right"><div _ngcontent-opg-c106="" class="handle-button ai-button"></div><div _ngcontent-opg-c106="" class="handle-button line-button"><div _ngcontent-opg-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-opg-c106="" class="handle-button theme-button"><div _ngcontent-opg-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-opg-c106="" class="handle-button copy-button"><div _ngcontent-opg-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-opg-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">let</span> storageWidgetImageUpdate = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LocalStorage</span>();</li><li>
</li><li><span class="hljs-meta">@Entry</span>(storageWidgetImageUpdate)</li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">WidgetImageUpdateCard</span> {</li><li>  <span class="hljs-meta">@LocalStorageProp</span>(<span class="hljs-string">'text'</span>) <span class="hljs-attr">text</span>: <span class="hljs-title class_">ResourceStr</span> = $r(<span class="hljs-string">'app.string.loading'</span>);</li><li>  <span class="hljs-meta">@LocalStorageProp</span>(<span class="hljs-string">'loaded'</span>) <span class="hljs-attr">loaded</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">false</span>;</li><li>  <span class="hljs-meta">@LocalStorageProp</span>(<span class="hljs-string">'imgName'</span>) <span class="hljs-attr">imgName</span>: <span class="hljs-title class_">ResourceStr</span> = $r(<span class="hljs-string">'app.string.imgName'</span>);</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Column</span>() {</li><li>        <span class="hljs-title class_">Text</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">text</span>)</li><li>          .<span class="hljs-title function_">fontColor</span>(<span class="hljs-string">'#FFFFFF'</span>)</li><li>          .<span class="hljs-title function_">opacity</span>(<span class="hljs-number">0.9</span>)</li><li>          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">12</span>)</li><li>          .<span class="hljs-title function_">textOverflow</span>({ <span class="hljs-attr">overflow</span>: <span class="hljs-title class_">TextOverflow</span>.<span class="hljs-property">Ellipsis</span> })</li><li>          .<span class="hljs-title function_">maxLines</span>(<span class="hljs-number">1</span>)</li><li>          .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-string">'8%'</span>, <span class="hljs-attr">left</span>: <span class="hljs-string">'10%'</span> })</li><li>      }.<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>).<span class="hljs-title function_">height</span>(<span class="hljs-string">'50%'</span>)</li><li>      .<span class="hljs-title function_">alignItems</span>(<span class="hljs-title class_">HorizontalAlign</span>.<span class="hljs-property">Start</span>)</li><li>
</li><li>      <span class="hljs-title class_">Row</span>() {</li><li>        <span class="hljs-title class_">Button</span>() {</li><li>          <span class="hljs-title class_">Text</span>($r(<span class="hljs-string">'app.string.update'</span>))</li><li>            .<span class="hljs-title function_">fontColor</span>(<span class="hljs-string">'#45A6F4'</span>)</li><li>            .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">12</span>)</li><li>        }</li><li>        .<span class="hljs-title function_">width</span>(<span class="hljs-number">120</span>)</li><li>        .<span class="hljs-title function_">height</span>(<span class="hljs-number">32</span>)</li><li>        .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-string">'30%'</span>, <span class="hljs-attr">bottom</span>: <span class="hljs-string">'10%'</span> })</li><li>        .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">'#FFFFFF'</span>)</li><li>        .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">16</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-title function_">postCardAction</span>(<span class="hljs-variable language_">this</span>, {</li><li>            <span class="hljs-attr">action</span>: <span class="hljs-string">'message'</span>,</li><li>            <span class="hljs-attr">params</span>: {</li><li>              <span class="hljs-attr">info</span>: <span class="hljs-string">'refreshImage'</span></li><li>            }</li><li>          });</li><li>        })</li><li>      }.<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>).<span class="hljs-title function_">height</span>(<span class="hljs-string">'40%'</span>)</li><li>      .<span class="hljs-title function_">justifyContent</span>(<span class="hljs-title class_">FlexAlign</span>.<span class="hljs-property">Center</span>)</li><li>    }</li><li>    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>).<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>    .<span class="hljs-title function_">backgroundImage</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">loaded</span> ? <span class="hljs-string">'memory://'</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">imgName</span> : $r(<span class="hljs-string">'app.media.ImageDisp'</span>))</li><li>    .<span class="hljs-title function_">backgroundImageSize</span>(<span class="hljs-title class_">ImageSize</span>.<span class="hljs-property">Cover</span>)</li><li>  }</li><li>}</li></ol></pre></div></div></li>    </ol>    <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">      <ul>       <li>        <p>Image组件通过入参(memory://fileName)中的(memory://)标识来进行远端内存图片显示，其中fileName需要和EntryFormAbility传递对象('formImages': {key: fd})中的key相对应。</p></li>       <li>        <p>Image组件通过传入的参数是否有变化来决定是否刷新图片，因此EntryFormAbility每次传递过来的imgName都需要不同，连续传递两个相同的imgName时，图片不会刷新。</p></li>      </ul>     </div></div></div>   </div>   <div></div></div>