<h1 _ngcontent-ldg-c119="" class="doc-title ng-star-inserted" title="加解密(C/C++)"> 加解密(C/C++) </h1>

<div _ngcontent-ldg-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p>以AES256密钥为例，完成加解密。具体的场景介绍及支持的算法规格，请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/huks-encryption-decryption-overview#支持的算法">加解密支持的算法</a>。</p>    <div class="tiledSection">     <h2 id="在cmake脚本中链接相关动态库">在CMake脚本中链接相关动态库<i class="anchor-icon anchor-icon-link" anchorid="在cmake脚本中链接相关动态库" tips="复制节点链接"></i></h2>          <div _ngcontent-ldg-c106="" class="highlight-div"><div _ngcontent-ldg-c106="" class="highlight-div-header"><div _ngcontent-ldg-c106="" class="highlight-div-header-left"><div _ngcontent-ldg-c106="" class="handle-button expand-button"><div _ngcontent-ldg-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ldg-c106="" class="highlight-div-header-right"><div _ngcontent-ldg-c106="" class="handle-button ai-button"></div><div _ngcontent-ldg-c106="" class="handle-button line-button"><div _ngcontent-ldg-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ldg-c106="" class="handle-button theme-button"><div _ngcontent-ldg-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ldg-c106="" class="handle-button copy-button"><div _ngcontent-ldg-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ldg-c106="" class="highlight-scroll-div"><pre class="txt prettyprint linenums hljs language-plaintext" hw-language="txt" data-highlighted="yes"><ol class="linenums"><li>target_link_libraries(entry PUBLIC libhuks_ndk.z.so)</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="开发步骤">开发步骤<i class="anchor-icon anchor-icon-link" anchorid="开发步骤" tips="复制节点链接"></i></h2>          <p><strong>生成密钥</strong></p>     <ol>      <li>       <p>指定密钥别名，密钥别名命名规范参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/huks-key-generation-overview">密钥生成介绍及算法规格</a>。</p></li>      <li>       <p>初始化密钥属性集。</p></li>      <li>       <p>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-native-huks-api-h#oh_huks_generatekeyitem" target="_blank">OH_Huks_GenerateKeyItem</a>生成密钥，具体请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/huks-key-generation-overview">密钥生成</a>。</p></li>     </ol>     <p>除此之外，开发者也可以参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/huks-key-import-overview">密钥导入</a>，导入已有的密钥。</p>     <p><strong>加密</strong></p>     <ol>      <li>       <p>获取密钥别名。</p></li>      <li>       <p>获取待加密的数据。</p></li>      <li>       <p>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-native-huks-param-h#oh_huks_initparamset" target="_blank">OH_Huks_InitParamSet</a>指定算法参数配置。在下方示例中，使用算法AES进行加密时，必须要选择其对应分组模式以及填充模式，用例中选取的分组模式为CBC、填充模式为PKCS7，此时必须要填参数IV。</p></li>      <li>       <p>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-native-huks-api-h#oh_huks_initsession" target="_blank">OH_Huks_InitSession</a>初始化密钥会话，并获取会话的句柄handle。</p></li>      <li>       <p>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-native-huks-api-h#oh_huks_finishsession" target="_blank">OH_Huks_FinishSession</a>结束密钥会话，获取加密后的密文。</p></li>     </ol>     <p><strong>解密</strong></p>     <ol>      <li>       <p>获取密钥别名。</p></li>      <li>       <p>获取待解密的密文。</p></li>      <li>       <p>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-native-huks-param-h#oh_huks_initparamset" target="_blank">OH_Huks_InitParamSet</a>指定算法参数配置。在下方示例中，使用算法AES进行解密时，必须要选择其对应分组模式以及填充模式，用例中选取的分组模式为CBC、填充模式为PKCS7，此时必须要填参数IV。</p></li>      <li>       <p>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-native-huks-api-h#oh_huks_initsession" target="_blank">OH_Huks_InitSession</a>初始化密钥会话，并获取会话的句柄handle。</p></li>      <li>       <p>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-native-huks-api-h#oh_huks_finishsession" target="_blank">OH_Huks_FinishSession</a>结束密钥会话，获取解密后的数据。</p></li>     </ol>     <p><strong>删除密钥</strong></p>     <p>当密钥废弃不用时，需要调用OH_Huks_DeleteKeyItem删除密钥，具体请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/huks-delete-key-ndk">密钥删除</a>。</p>     <div _ngcontent-ldg-c106="" class="highlight-div"><div _ngcontent-ldg-c106="" class="highlight-div-header"><div _ngcontent-ldg-c106="" class="highlight-div-header-left"><div _ngcontent-ldg-c106="" class="handle-button expand-button"><div _ngcontent-ldg-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ldg-c106="" class="highlight-div-header-right"><div _ngcontent-ldg-c106="" class="handle-button ai-button"></div><div _ngcontent-ldg-c106="" class="handle-button line-button"><div _ngcontent-ldg-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ldg-c106="" class="handle-button theme-button"><div _ngcontent-ldg-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ldg-c106="" class="handle-button copy-button"><div _ngcontent-ldg-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ldg-c106="" class="highlight-scroll-div"><pre class="prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"huks/native_huks_api.h"</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"huks/native_huks_param.h"</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"napi/native_api.h"</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span></li><li><span class="hljs-function">OH_Huks_Result <span class="hljs-title">InitParamSet</span><span class="hljs-params">(</span></span></li><li><span class="hljs-function">    <span class="hljs-keyword">struct</span> OH_Huks_ParamSet **paramSet,</span></li><li><span class="hljs-function">    <span class="hljs-type">const</span> <span class="hljs-keyword">struct</span> OH_Huks_Param *params,</span></li><li><span class="hljs-function">    <span class="hljs-type">uint32_t</span> paramCount)</span></li><li><span class="hljs-function"></span>{</li><li>    OH_Huks_Result ret = <span class="hljs-built_in">OH_Huks_InitParamSet</span>(paramSet);</li><li>    <span class="hljs-keyword">if</span> (ret.errorCode != OH_HUKS_SUCCESS) {</li><li>        <span class="hljs-keyword">return</span> ret;</li><li>    }</li><li>    ret = <span class="hljs-built_in">OH_Huks_AddParams</span>(*paramSet, params, paramCount);</li><li>    <span class="hljs-keyword">if</span> (ret.errorCode != OH_HUKS_SUCCESS) {</li><li>        <span class="hljs-built_in">OH_Huks_FreeParamSet</span>(paramSet);</li><li>        <span class="hljs-keyword">return</span> ret;</li><li>    }</li><li>    ret = <span class="hljs-built_in">OH_Huks_BuildParamSet</span>(paramSet);</li><li>    <span class="hljs-keyword">if</span> (ret.errorCode != OH_HUKS_SUCCESS) {</li><li>        <span class="hljs-built_in">OH_Huks_FreeParamSet</span>(paramSet);</li><li>        <span class="hljs-keyword">return</span> ret;</li><li>    }</li><li>    <span class="hljs-keyword">return</span> ret;</li><li>}</li><li><span class="hljs-type">static</span> <span class="hljs-type">const</span> <span class="hljs-type">uint32_t</span> IV_SIZE = <span class="hljs-number">16</span>;</li><li><span class="hljs-type">static</span> <span class="hljs-type">uint8_t</span> IV[IV_SIZE] = { <span class="hljs-number">0</span> }; <span class="hljs-comment">// this is a test value, for real use the iv should be different every time.</span></li><li><span class="hljs-type">static</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">OH_Huks_Param</span> g_genEncDecParams[] = {</li><li>    {</li><li>        .tag = OH_HUKS_TAG_ALGORITHM,</li><li>        .uint32Param = OH_HUKS_ALG_AES</li><li>    }, {</li><li>        .tag = OH_HUKS_TAG_PURPOSE,</li><li>        .uint32Param = OH_HUKS_KEY_PURPOSE_ENCRYPT | OH_HUKS_KEY_PURPOSE_DECRYPT</li><li>    }, {</li><li>        .tag = OH_HUKS_TAG_KEY_SIZE,</li><li>        .uint32Param = OH_HUKS_AES_KEY_SIZE_256</li><li>    }, {</li><li>        .tag = OH_HUKS_TAG_PADDING,</li><li>        .uint32Param = OH_HUKS_PADDING_NONE</li><li>    }, {</li><li>        .tag = OH_HUKS_TAG_BLOCK_MODE,</li><li>        .uint32Param = OH_HUKS_MODE_CBC</li><li>    }</li><li>};</li><li><span class="hljs-type">static</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">OH_Huks_Param</span> g_encryptParams[] = {</li><li>    {</li><li>        .tag = OH_HUKS_TAG_ALGORITHM,</li><li>        .uint32Param = OH_HUKS_ALG_AES</li><li>    }, {</li><li>        .tag = OH_HUKS_TAG_PURPOSE,</li><li>        .uint32Param = OH_HUKS_KEY_PURPOSE_ENCRYPT</li><li>    }, {</li><li>        .tag = OH_HUKS_TAG_KEY_SIZE,</li><li>        .uint32Param = OH_HUKS_AES_KEY_SIZE_256</li><li>    }, {</li><li>        .tag = OH_HUKS_TAG_PADDING,</li><li>        .uint32Param = OH_HUKS_PADDING_NONE</li><li>    }, {</li><li>        .tag = OH_HUKS_TAG_BLOCK_MODE,</li><li>        .uint32Param = OH_HUKS_MODE_CBC</li><li>    }, {</li><li>        .tag = OH_HUKS_TAG_IV,</li><li>        .blob = {</li><li>            .size = IV_SIZE,</li><li>            .data = (<span class="hljs-type">uint8_t</span> *)IV <span class="hljs-comment">// this is a test value, for real use the iv should be different every time.</span></li><li>        }</li><li>    }</li><li>};</li><li><span class="hljs-type">static</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">OH_Huks_Param</span> g_decryptParams[] = {</li><li>    {</li><li>        .tag = OH_HUKS_TAG_ALGORITHM,</li><li>        .uint32Param = OH_HUKS_ALG_AES</li><li>    }, {</li><li>        .tag = OH_HUKS_TAG_PURPOSE,</li><li>        .uint32Param = OH_HUKS_KEY_PURPOSE_DECRYPT</li><li>    }, {</li><li>        .tag = OH_HUKS_TAG_KEY_SIZE,</li><li>        .uint32Param = OH_HUKS_AES_KEY_SIZE_256</li><li>    }, {</li><li>        .tag = OH_HUKS_TAG_PADDING,</li><li>        .uint32Param = OH_HUKS_PADDING_NONE</li><li>    }, {</li><li>        .tag = OH_HUKS_TAG_BLOCK_MODE,</li><li>        .uint32Param = OH_HUKS_MODE_CBC</li><li>    }, {</li><li>        .tag = OH_HUKS_TAG_IV,</li><li>        .blob = {</li><li>            .size = IV_SIZE,</li><li>            .data = (<span class="hljs-type">uint8_t</span> *)IV <span class="hljs-comment">// this is a test value, for real use the iv should be different every time.</span></li><li>        }</li><li>    }</li><li>};</li><li><span class="hljs-type">static</span> <span class="hljs-type">const</span> <span class="hljs-type">uint32_t</span> AES_COMMON_SIZE = <span class="hljs-number">1024</span>;</li><li><span class="hljs-function">OH_Huks_Result <span class="hljs-title">HksAesCipherTestEncrypt</span><span class="hljs-params">(</span></span></li><li><span class="hljs-function">        <span class="hljs-type">const</span> <span class="hljs-keyword">struct</span> OH_Huks_Blob *keyAlias, <span class="hljs-type">const</span> <span class="hljs-keyword">struct</span> OH_Huks_ParamSet *encryptParamSet,</span></li><li><span class="hljs-function">        <span class="hljs-type">const</span> <span class="hljs-keyword">struct</span> OH_Huks_Blob *inData, <span class="hljs-keyword">struct</span> OH_Huks_Blob *cipherText)</span></li><li><span class="hljs-function"></span>{</li><li>    <span class="hljs-type">uint8_t</span> handleE[<span class="hljs-built_in">sizeof</span>(<span class="hljs-type">uint64_t</span>)] = {<span class="hljs-number">0</span>};</li><li>    <span class="hljs-keyword">struct</span> <span class="hljs-title class_">OH_Huks_Blob</span> handleEncrypt = {<span class="hljs-built_in">sizeof</span>(<span class="hljs-type">uint64_t</span>), handleE};</li><li>    OH_Huks_Result ret = <span class="hljs-built_in">OH_Huks_InitSession</span>(keyAlias, encryptParamSet, &amp;handleEncrypt, <span class="hljs-literal">nullptr</span>);</li><li>    <span class="hljs-keyword">if</span> (ret.errorCode != OH_HUKS_SUCCESS) {</li><li>        <span class="hljs-keyword">return</span> ret;</li><li>    }</li><li>    ret = <span class="hljs-built_in">OH_Huks_FinishSession</span>(&amp;handleEncrypt, encryptParamSet, inData, cipherText);</li><li>    <span class="hljs-keyword">return</span> ret;</li><li>}</li><li><span class="hljs-function">OH_Huks_Result <span class="hljs-title">HksAesCipherTestDecrypt</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-keyword">struct</span> OH_Huks_Blob *keyAlias,</span></span></li><li><span class="hljs-function">    <span class="hljs-type">const</span> <span class="hljs-keyword">struct</span> OH_Huks_ParamSet *decryptParamSet, <span class="hljs-type">const</span> <span class="hljs-keyword">struct</span> OH_Huks_Blob *cipherText,</span></li><li><span class="hljs-function">    <span class="hljs-keyword">struct</span> OH_Huks_Blob *plainText, <span class="hljs-type">const</span> <span class="hljs-keyword">struct</span> OH_Huks_Blob *inData)</span></li><li><span class="hljs-function"></span>{</li><li>    <span class="hljs-type">uint8_t</span> handleD[<span class="hljs-built_in">sizeof</span>(<span class="hljs-type">uint64_t</span>)] = {<span class="hljs-number">0</span>};</li><li>    <span class="hljs-keyword">struct</span> <span class="hljs-title class_">OH_Huks_Blob</span> handleDecrypt = {<span class="hljs-built_in">sizeof</span>(<span class="hljs-type">uint64_t</span>), handleD};</li><li>    OH_Huks_Result ret = <span class="hljs-built_in">OH_Huks_InitSession</span>(keyAlias, decryptParamSet, &amp;handleDecrypt, <span class="hljs-literal">nullptr</span>);</li><li>    <span class="hljs-keyword">if</span> (ret.errorCode != OH_HUKS_SUCCESS) {</li><li>        <span class="hljs-keyword">return</span> ret;</li><li>    }</li><li>    ret = <span class="hljs-built_in">OH_Huks_FinishSession</span>(&amp;handleDecrypt, decryptParamSet, cipherText, plainText);</li><li>    <span class="hljs-keyword">return</span> ret;</li><li>}</li><li><span class="hljs-function"><span class="hljs-type">static</span> napi_value <span class="hljs-title">EncDecKey</span><span class="hljs-params">(napi_env env, napi_callback_info info)</span></span></li><li><span class="hljs-function"></span>{</li><li>    <span class="hljs-type">char</span> tmpKeyAlias[] = <span class="hljs-string">"test_enc_dec"</span>;</li><li>    <span class="hljs-keyword">struct</span> <span class="hljs-title class_">OH_Huks_Blob</span> keyAlias = { (<span class="hljs-type">uint32_t</span>)<span class="hljs-built_in">strlen</span>(tmpKeyAlias), (<span class="hljs-type">uint8_t</span> *)tmpKeyAlias };</li><li>    <span class="hljs-keyword">struct</span> <span class="hljs-title class_">OH_Huks_ParamSet</span> *genParamSet = <span class="hljs-literal">nullptr</span>;</li><li>    <span class="hljs-keyword">struct</span> <span class="hljs-title class_">OH_Huks_ParamSet</span> *encryptParamSet = <span class="hljs-literal">nullptr</span>;</li><li>    <span class="hljs-keyword">struct</span> <span class="hljs-title class_">OH_Huks_ParamSet</span> *decryptParamSet = <span class="hljs-literal">nullptr</span>;</li><li>    OH_Huks_Result ohResult;</li><li>    <span class="hljs-keyword">do</span> {</li><li>        <span class="hljs-comment">/* 1. Generate Key */</span></li><li>        <span class="hljs-comment">/*</span></li><li><span class="hljs-comment">        * 模拟生成密钥场景</span></li><li><span class="hljs-comment">        * 1.1. 确定密钥别名</span></li><li><span class="hljs-comment">        */</span></li><li>        <span class="hljs-comment">/*</span></li><li><span class="hljs-comment">        * 1.2. 获取生成密钥算法参数配置</span></li><li><span class="hljs-comment">        */</span></li><li>        ohResult = <span class="hljs-built_in">InitParamSet</span>(&amp;genParamSet, g_genEncDecParams, <span class="hljs-built_in">sizeof</span>(g_genEncDecParams) / <span class="hljs-built_in">sizeof</span>(OH_Huks_Param));</li><li>        <span class="hljs-keyword">if</span> (ohResult.errorCode != OH_HUKS_SUCCESS) {</li><li>            <span class="hljs-keyword">break</span>;</li><li>        }</li><li>        <span class="hljs-comment">/*</span></li><li><span class="hljs-comment">        * 1.3. 调用generateKeyItem</span></li><li><span class="hljs-comment">        */</span></li><li>        ohResult = <span class="hljs-built_in">OH_Huks_GenerateKeyItem</span>(&amp;keyAlias, genParamSet, <span class="hljs-literal">nullptr</span>);</li><li>        <span class="hljs-keyword">if</span> (ohResult.errorCode != OH_HUKS_SUCCESS) {</li><li>            <span class="hljs-keyword">break</span>;</li><li>        }</li><li>        <span class="hljs-comment">/* 2. Encrypt */</span></li><li>        <span class="hljs-comment">/*</span></li><li><span class="hljs-comment">        * 模拟加密场景</span></li><li><span class="hljs-comment">        * 2.1. 获取密钥别名</span></li><li><span class="hljs-comment">        */</span></li><li>        <span class="hljs-comment">/*</span></li><li><span class="hljs-comment">        * 2.2. 获取待加密的数据</span></li><li><span class="hljs-comment">        */</span></li><li>        <span class="hljs-comment">/*</span></li><li><span class="hljs-comment">        * 2.3. 获取加密算法参数配置</span></li><li><span class="hljs-comment">        */</span></li><li>        ohResult = <span class="hljs-built_in">InitParamSet</span>(&amp;encryptParamSet, g_encryptParams, <span class="hljs-built_in">sizeof</span>(g_encryptParams) / <span class="hljs-built_in">sizeof</span>(OH_Huks_Param));</li><li>        <span class="hljs-keyword">if</span> (ohResult.errorCode != OH_HUKS_SUCCESS) {</li><li>            <span class="hljs-keyword">break</span>;</li><li>        }</li><li>        <span class="hljs-type">char</span> tmpInData[] = <span class="hljs-string">"AES_ECB_INDATA_1"</span>;</li><li>        <span class="hljs-keyword">struct</span> <span class="hljs-title class_">OH_Huks_Blob</span> inData = { (<span class="hljs-type">uint32_t</span>)<span class="hljs-built_in">strlen</span>(tmpInData), (<span class="hljs-type">uint8_t</span> *)tmpInData };</li><li>        <span class="hljs-type">uint8_t</span> cipher[AES_COMMON_SIZE] = {<span class="hljs-number">0</span>};</li><li>        <span class="hljs-keyword">struct</span> <span class="hljs-title class_">OH_Huks_Blob</span> cipherText = {AES_COMMON_SIZE, cipher};</li><li>        <span class="hljs-comment">/*</span></li><li><span class="hljs-comment">        * 2.4. 调用initSession获取handle</span></li><li><span class="hljs-comment">        */</span></li><li>        <span class="hljs-comment">/*</span></li><li><span class="hljs-comment">        * 2.5. 调用finishSession获取加密后的密文</span></li><li><span class="hljs-comment">        */</span></li><li>        ohResult = <span class="hljs-built_in">HksAesCipherTestEncrypt</span>(&amp;keyAlias, encryptParamSet, &amp;inData, &amp;cipherText);</li><li>        <span class="hljs-keyword">if</span> (ohResult.errorCode != OH_HUKS_SUCCESS) {</li><li>            <span class="hljs-keyword">break</span>;</li><li>        }</li><li>        <span class="hljs-comment">/* 3. Decrypt */</span></li><li>        <span class="hljs-comment">/*</span></li><li><span class="hljs-comment">        * 模拟解密场景</span></li><li><span class="hljs-comment">        * 3.1. 获取密钥别名</span></li><li><span class="hljs-comment">        */</span></li><li>        <span class="hljs-comment">/*</span></li><li><span class="hljs-comment">        * 3.2. 获取待解密的密文</span></li><li><span class="hljs-comment">        */</span></li><li>        <span class="hljs-comment">/*</span></li><li><span class="hljs-comment">        * 3.3. 获取解密算法参数配置</span></li><li><span class="hljs-comment">        */</span></li><li>        ohResult = <span class="hljs-built_in">InitParamSet</span>(&amp;decryptParamSet, g_decryptParams, <span class="hljs-built_in">sizeof</span>(g_decryptParams) / <span class="hljs-built_in">sizeof</span>(OH_Huks_Param));</li><li>        <span class="hljs-keyword">if</span> (ohResult.errorCode != OH_HUKS_SUCCESS) {</li><li>            <span class="hljs-keyword">break</span>;</li><li>        }</li><li>        <span class="hljs-type">uint8_t</span> plain[AES_COMMON_SIZE] = {<span class="hljs-number">0</span>};</li><li>        <span class="hljs-keyword">struct</span> <span class="hljs-title class_">OH_Huks_Blob</span> plainText = {AES_COMMON_SIZE, plain};</li><li>        <span class="hljs-comment">/*</span></li><li><span class="hljs-comment">        * 3.4. 调用initSession获取handle</span></li><li><span class="hljs-comment">        */</span></li><li>        <span class="hljs-comment">/*</span></li><li><span class="hljs-comment">        * 3.5. 调用finishSession获取解密后的数据</span></li><li><span class="hljs-comment">        */</span></li><li>        ohResult = <span class="hljs-built_in">HksAesCipherTestDecrypt</span>(&amp;keyAlias, decryptParamSet, &amp;cipherText, &amp;plainText, &amp;inData);</li><li>    } <span class="hljs-keyword">while</span> (<span class="hljs-number">0</span>);</li><li>    <span class="hljs-comment">/* 4. Delete Key */</span></li><li>    <span class="hljs-comment">/*</span></li><li><span class="hljs-comment">    * 模拟删除密钥场景</span></li><li><span class="hljs-comment">    * 4.1. 获取密钥别名</span></li><li><span class="hljs-comment">    */</span></li><li>    <span class="hljs-comment">/*</span></li><li><span class="hljs-comment">    * 4.2. 调用deleteKeyItem删除密钥</span></li><li><span class="hljs-comment">    */</span></li><li>    (<span class="hljs-type">void</span>)<span class="hljs-built_in">OH_Huks_DeleteKeyItem</span>(&amp;keyAlias, genParamSet);</li><li>        </li><li>    <span class="hljs-built_in">OH_Huks_FreeParamSet</span>(&amp;genParamSet);</li><li>    <span class="hljs-built_in">OH_Huks_FreeParamSet</span>(&amp;encryptParamSet);</li><li>    <span class="hljs-built_in">OH_Huks_FreeParamSet</span>(&amp;decryptParamSet);</li><li>    </li><li>    napi_value ret;</li><li>    <span class="hljs-built_in">napi_create_int32</span>(env, ohResult.errorCode, &amp;ret);</li><li>    <span class="hljs-keyword">return</span> ret;</li><li>}</li></ol></pre></div></div>    </div>   </div>   <div></div></div>