<h1 _ngcontent-ljm-c119="" class="doc-title ng-star-inserted" title="动态加载"> 动态加载 </h1>

<div _ngcontent-ljm-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p>动态import支持条件延迟加载，支持部分反射功能，可以提升页面的加载速度；动态import支持加载HSP模块/HAR模块/OHPM包/Native库等，并且HAR模块间只有变量动态import时还可以进行模块解耦。</p>    <div class="tiledSection">     <h2 id="技术适用场景介绍">技术适用场景介绍<i class="anchor-icon anchor-icon-link" anchorid="技术适用场景介绍" tips="复制节点链接"></i></h2>          <p>应用开发的有些场景中，如果希望根据条件导入模块或者按需导入模块，可以使用动态import代替<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/introduction-to-arkts#导入">静态import</a>。下面是可能会需要动态import的场景：</p>     <ul>      <li>当静态import的模块明显降低了代码的加载速度且很少被使用，或者并不需要马上使用它。</li>      <li>当静态import的模块明显占用了大量的系统内存且很少被使用。</li>      <li>当被导入的模块，在加载时并不存在，需要异步获取。</li>      <li>当需要动态构建模块说明符时，应使用动态import。静态import仅支持静态说明符。</li>      <li>当导入的模块存在副作用（即模块中包含直接运行的代码），这些副作用仅在满足特定条件时才需要。</li>     </ul>    </div>    <div class="tiledSection">     <h2 id="业务扩展场景介绍">业务扩展场景介绍<i class="anchor-icon anchor-icon-link" anchorid="业务扩展场景介绍" tips="复制节点链接"></i></h2>          <p>动态import在业务上除了能实现条件延迟加载，还可以实现部分反射功能。实例如下，HAP动态import HAR包harlibrary，并调用类Calc的静态成员函数staticAdd()、成员函数instanceAdd()，以及全局方法addHarLibrary()。</p>     <div _ngcontent-ljm-c106="" class="highlight-div"><div _ngcontent-ljm-c106="" class="highlight-div-header"><div _ngcontent-ljm-c106="" class="highlight-div-header-left"><div _ngcontent-ljm-c106="" class="handle-button expand-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ljm-c106="" class="highlight-div-header-right"><div _ngcontent-ljm-c106="" class="handle-button ai-button"></div><div _ngcontent-ljm-c106="" class="handle-button line-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ljm-c106="" class="handle-button theme-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ljm-c106="" class="handle-button copy-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ljm-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// harlibrary's src/main/ets/utils/Calc.ets</span></li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Calc</span> {</li><li>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-title function_">staticAdd</span>(<span class="hljs-attr">a</span>: <span class="hljs-built_in">number</span>, <span class="hljs-attr">b</span>: <span class="hljs-built_in">number</span>): <span class="hljs-built_in">number</span> {</li><li>    <span class="hljs-keyword">let</span> c = a + b;</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'DynamicImport I am harlibrary in staticAdd, %d + %d = %d'</span>, a, b, c);</li><li>    <span class="hljs-keyword">return</span> c;</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">public</span> <span class="hljs-title function_">instanceAdd</span>(<span class="hljs-attr">a</span>: <span class="hljs-built_in">number</span>, <span class="hljs-attr">b</span>: <span class="hljs-built_in">number</span>): <span class="hljs-built_in">number</span> {</li><li>    <span class="hljs-keyword">let</span> c = a + b;</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'DynamicImport I am harlibrary in instanceAdd, %d + %d = %d'</span>, a, b, c);</li><li>    <span class="hljs-keyword">return</span> c;</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">addHarLibrary</span>(<span class="hljs-params">a: <span class="hljs-built_in">number</span>, b: <span class="hljs-built_in">number</span></span>): <span class="hljs-built_in">number</span> {</li><li>  <span class="hljs-keyword">let</span> c = a + b;</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'DynamicImport I am harlibrary in addHarLibrary, %d + %d = %d'</span>, a, b, c);</li><li>  <span class="hljs-keyword">return</span> c;</li><li>}</li></ol></pre></div></div>     <div _ngcontent-ljm-c106="" class="highlight-div"><div _ngcontent-ljm-c106="" class="highlight-div-header"><div _ngcontent-ljm-c106="" class="highlight-div-header-left"><div _ngcontent-ljm-c106="" class="handle-button expand-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ljm-c106="" class="highlight-div-header-right"><div _ngcontent-ljm-c106="" class="handle-button ai-button"></div><div _ngcontent-ljm-c106="" class="handle-button line-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ljm-c106="" class="handle-button theme-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ljm-c106="" class="handle-button copy-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ljm-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// harlibrary's Index.ets</span></li><li><span class="hljs-keyword">export</span> { <span class="hljs-title class_">Calc</span>, addHarLibrary } <span class="hljs-keyword">from</span> <span class="hljs-string">'./src/main/ets/utils/Calc'</span></li></ol></pre></div></div>     <div _ngcontent-ljm-c106="" class="highlight-div"><div _ngcontent-ljm-c106="" class="highlight-div-header"><div _ngcontent-ljm-c106="" class="highlight-div-header-left"><div _ngcontent-ljm-c106="" class="handle-button expand-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ljm-c106="" class="highlight-div-header-right"><div _ngcontent-ljm-c106="" class="handle-button ai-button"></div><div _ngcontent-ljm-c106="" class="handle-button line-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ljm-c106="" class="handle-button theme-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ljm-c106="" class="handle-button copy-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ljm-c106="" class="highlight-scroll-div"><pre class="json5 prettyprint linenums hljs language-cangjie" hw-language="json5" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// HAP's oh-package.json5</span></li><li><span class="hljs-string">"dependencies"</span>: {</li><li>  <span class="hljs-string">"harlibrary"</span>: <span class="hljs-string">"file:../harlibrary"</span></li><li>}</li></ol></pre></div></div>     <div _ngcontent-ljm-c106="" class="highlight-div"><div _ngcontent-ljm-c106="" class="highlight-div-header"><div _ngcontent-ljm-c106="" class="highlight-div-header-left"><div _ngcontent-ljm-c106="" class="handle-button expand-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ljm-c106="" class="highlight-div-header-right"><div _ngcontent-ljm-c106="" class="handle-button ai-button"></div><div _ngcontent-ljm-c106="" class="handle-button line-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ljm-c106="" class="handle-button theme-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ljm-c106="" class="handle-button copy-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ljm-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// HAP's src/main/ets/pages/Index.ets</span></li><li><span class="hljs-keyword">import</span>(<span class="hljs-string">'harlibrary'</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">ns:ESObject</span>) =&gt;</span> {</li><li>  ns.<span class="hljs-property">Calc</span>.<span class="hljs-title function_">staticAdd</span>(<span class="hljs-number">8</span>, <span class="hljs-number">9</span>);  <span class="hljs-comment">// 调用静态成员函数staticAdd()</span></li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">calc</span>:<span class="hljs-title class_">ESObject</span> = <span class="hljs-keyword">new</span> ns.<span class="hljs-title class_">Calc</span>();  <span class="hljs-comment">// 实例化类Calc</span></li><li>  calc.<span class="hljs-title function_">instanceAdd</span>(<span class="hljs-number">10</span>, <span class="hljs-number">11</span>);  <span class="hljs-comment">// 调用成员函数instanceAdd()</span></li><li>  ns.<span class="hljs-title function_">addHarLibrary</span>(<span class="hljs-number">6</span>, <span class="hljs-number">7</span>);  <span class="hljs-comment">// 调用全局方法addHarLibrary()</span></li><li>
</li><li>  <span class="hljs-comment">// 使用类、成员函数和方法的字符串名字进行反射调用</span></li><li>  <span class="hljs-keyword">let</span> className = <span class="hljs-string">'Calc'</span>;</li><li>  <span class="hljs-keyword">let</span> methodName = <span class="hljs-string">'instanceAdd'</span>;</li><li>  <span class="hljs-keyword">let</span> staticMethod = <span class="hljs-string">'staticAdd'</span>;</li><li>  <span class="hljs-keyword">let</span> functionName = <span class="hljs-string">'addHarLibrary'</span>;</li><li>  ns[className][staticMethod](<span class="hljs-number">12</span>, <span class="hljs-number">13</span>);  <span class="hljs-comment">// 调用静态成员函数staticAdd()</span></li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">calc1</span>:<span class="hljs-title class_">ESObject</span> = <span class="hljs-keyword">new</span> ns[className]();  <span class="hljs-comment">// 实例化类Calc</span></li><li>  calc1[methodName](<span class="hljs-number">14</span>, <span class="hljs-number">15</span>);  <span class="hljs-comment">// 调用成员函数instanceAdd()</span></li><li>  ns[functionName](<span class="hljs-number">16</span>, <span class="hljs-number">17</span>);  <span class="hljs-comment">// 调用全局方法addHarLibrary()</span></li><li>});</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="动态import实现方案介绍">动态import实现方案介绍<i class="anchor-icon anchor-icon-link" anchorid="动态import实现方案介绍" tips="复制节点链接"></i></h2>          <p>动态import根据入参是常量或变量，分为动态import常量表达式和动态import变量表达式两大特性规格。</p>     <p>以下是动态import支持的规格列表：</p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.4.4.1.4.1.1" valign="top" width="33.33333333333333%">动态import场景</th>         <th align="left" class="cellrowborder" id="mcps1.3.4.4.1.4.1.2" valign="top" width="33.33333333333333%">动态import详细分类</th>         <th align="left" class="cellrowborder" id="mcps1.3.4.4.1.4.1.3" valign="top" width="33.33333333333333%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">本地工程模块</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">动态import模块内文件路径</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">要求路径以./或../开头。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">本地工程模块</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">动态import HSP模块名</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">-</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">本地工程模块</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">动态import HSP模块文件路径</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">-</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">本地工程模块</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">动态import HAR模块名</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">-</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">本地工程模块</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">动态import HAR模块文件路径</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">-</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">远程包</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">动态import远程HAR模块名</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">-</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">远程包</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">动态import ohpm包名</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">-</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">API</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">动态import @system.*</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">-</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">API</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">动态import @ohos.*</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">-</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">API</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">动态import @arkui-x.*</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">-</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">模块Native库</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">动态import libNativeLibrary.so</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">-</td>        </tr>             </tbody></table></div>     </div>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>1.当前所有import中使用的模块名都是依赖方oh-package.json5文件中dependencies项的别名。</p>       <p>2.本地模块在依赖方的dependencies中配置的别名建议与moduleName以及packageName三者一致。moduleName指的是被依赖的HSP/HAR的module.json5中配置的名字，packageName指的是被依赖的HSP/HAR的oh-package.json5中配置的名字。</p>       <p>3.import一个模块名，实际的行为是import该模块的入口文件，一般为Index.ets/ts。</p>      </div></div></div>    </div>    <div class="tiledSection">     <h2 id="动态import实现中的关键点">动态import实现中的关键点<i class="anchor-icon anchor-icon-link" anchorid="动态import实现中的关键点" tips="复制节点链接"></i></h2>         </div>    <div class="tiledSection">     <h3 id="动态import常量表达式" class="firsth2">动态import常量表达式<i class="anchor-icon anchor-icon-link" anchorid="动态import常量表达式" tips="复制节点链接"></i></h3>          <p>动态import常量表达式是指动态import的入参为常量的场景。下面以HAP引用其他模块的API的示例来说明典型用法。</p>     <p>本文示例代码中的路径，如Index.ets，是根据当前DevEco Studio的模块配置设置的。如果后续有变化，请调整文件的位置和相对路径。</p>     <ul>      <li>       <p><strong>HAP常量动态import HAR模块名</strong></p>       <div _ngcontent-ljm-c106="" class="highlight-div"><div _ngcontent-ljm-c106="" class="highlight-div-header"><div _ngcontent-ljm-c106="" class="highlight-div-header-left"><div _ngcontent-ljm-c106="" class="handle-button expand-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ljm-c106="" class="highlight-div-header-right"><div _ngcontent-ljm-c106="" class="handle-button ai-button"></div><div _ngcontent-ljm-c106="" class="handle-button line-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ljm-c106="" class="handle-button theme-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ljm-c106="" class="handle-button copy-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ljm-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// HAR's Index.ets</span></li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">a: <span class="hljs-built_in">number</span>, b: <span class="hljs-built_in">number</span></span>): <span class="hljs-built_in">number</span> {</li><li>  <span class="hljs-keyword">let</span> c = a + b;</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'DynamicImport I am a HAR, %d + %d = %d'</span>, a, b, c);</li><li>  <span class="hljs-keyword">return</span> c;</li><li>}</li></ol></pre></div></div>       <div _ngcontent-ljm-c106="" class="highlight-div"><div _ngcontent-ljm-c106="" class="highlight-div-header"><div _ngcontent-ljm-c106="" class="highlight-div-header-left"><div _ngcontent-ljm-c106="" class="handle-button expand-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ljm-c106="" class="highlight-div-header-right"><div _ngcontent-ljm-c106="" class="handle-button ai-button"></div><div _ngcontent-ljm-c106="" class="handle-button line-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ljm-c106="" class="handle-button theme-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ljm-c106="" class="handle-button copy-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ljm-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// HAP's src/main/ets/pages/Index.ets</span></li><li><span class="hljs-keyword">import</span>(<span class="hljs-string">'myhar'</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">ns:ESObject</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'DynamicImport ns.add(3, 5) = %d'</span>, ns.<span class="hljs-title function_">add</span>(<span class="hljs-number">3</span>, <span class="hljs-number">5</span>));</li><li>});</li><li>
</li><li><span class="hljs-comment">// 可使用 await 处理动态import (必须在 async 函数内使用)</span></li><li><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">asyncDynamicImport</span>(<span class="hljs-params"></span>) {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">ns</span>:<span class="hljs-title class_">ESObject</span> = <span class="hljs-keyword">await</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'myhar'</span>);</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'DynamicImport ns.add(3, 5) = %d'</span>, ns.<span class="hljs-title function_">add</span>(<span class="hljs-number">3</span>, <span class="hljs-number">5</span>));</li><li>}</li></ol></pre></div></div>       <div _ngcontent-ljm-c106="" class="highlight-div"><div _ngcontent-ljm-c106="" class="highlight-div-header"><div _ngcontent-ljm-c106="" class="highlight-div-header-left"><div _ngcontent-ljm-c106="" class="handle-button expand-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ljm-c106="" class="highlight-div-header-right"><div _ngcontent-ljm-c106="" class="handle-button ai-button"></div><div _ngcontent-ljm-c106="" class="handle-button line-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ljm-c106="" class="handle-button theme-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ljm-c106="" class="handle-button copy-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ljm-c106="" class="highlight-scroll-div"><pre class="json5 prettyprint linenums hljs language-cangjie" hw-language="json5" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// HAP's oh-package.json5</span></li><li><span class="hljs-string">"dependencies"</span>: {</li><li>  <span class="hljs-string">"myhar"</span>: <span class="hljs-string">"file:../myhar"</span></li><li>}</li></ol></pre></div></div></li>      <li>       <p><strong>HAP常量动态import HAR模块文件路径</strong></p>       <div _ngcontent-ljm-c106="" class="highlight-div"><div _ngcontent-ljm-c106="" class="highlight-div-header"><div _ngcontent-ljm-c106="" class="highlight-div-header-left"><div _ngcontent-ljm-c106="" class="handle-button expand-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ljm-c106="" class="highlight-div-header-right"><div _ngcontent-ljm-c106="" class="handle-button ai-button"></div><div _ngcontent-ljm-c106="" class="handle-button line-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ljm-c106="" class="handle-button theme-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ljm-c106="" class="handle-button copy-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ljm-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// HAR's Index.ets</span></li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">a: <span class="hljs-built_in">number</span>, b: <span class="hljs-built_in">number</span></span>): <span class="hljs-built_in">number</span> {</li><li>  <span class="hljs-keyword">let</span> c = a + b;</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'DynamicImport I am a HAR, %d + %d = %d'</span>, a, b, c);</li><li>  <span class="hljs-keyword">return</span> c;</li><li>}</li></ol></pre></div></div>       <div _ngcontent-ljm-c106="" class="highlight-div"><div _ngcontent-ljm-c106="" class="highlight-div-header"><div _ngcontent-ljm-c106="" class="highlight-div-header-left"><div _ngcontent-ljm-c106="" class="handle-button expand-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ljm-c106="" class="highlight-div-header-right"><div _ngcontent-ljm-c106="" class="handle-button ai-button"></div><div _ngcontent-ljm-c106="" class="handle-button line-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ljm-c106="" class="handle-button theme-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ljm-c106="" class="handle-button copy-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ljm-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// HAP's src/main/ets/pages/Index.ets</span></li><li><span class="hljs-keyword">import</span>(<span class="hljs-string">'myhar/Index'</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">ns:ESObject</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'DynamicImport ns.add(3, 5) = %d'</span>, ns.<span class="hljs-title function_">add</span>(<span class="hljs-number">3</span>, <span class="hljs-number">5</span>));</li><li>});</li></ol></pre></div></div>       <div _ngcontent-ljm-c106="" class="highlight-div"><div _ngcontent-ljm-c106="" class="highlight-div-header"><div _ngcontent-ljm-c106="" class="highlight-div-header-left"><div _ngcontent-ljm-c106="" class="handle-button expand-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ljm-c106="" class="highlight-div-header-right"><div _ngcontent-ljm-c106="" class="handle-button ai-button"></div><div _ngcontent-ljm-c106="" class="handle-button line-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ljm-c106="" class="handle-button theme-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ljm-c106="" class="handle-button copy-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ljm-c106="" class="highlight-scroll-div"><pre class="json5 prettyprint linenums hljs language-cangjie" hw-language="json5" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// HAP's oh-package.json5</span></li><li><span class="hljs-string">"dependencies"</span>: {</li><li>  <span class="hljs-string">"myhar"</span>: <span class="hljs-string">"file:../myhar"</span></li><li>}</li></ol></pre></div></div></li>      <li>       <p><strong>HAP常量动态import HSP模块名</strong></p>       <div _ngcontent-ljm-c106="" class="highlight-div"><div _ngcontent-ljm-c106="" class="highlight-div-header"><div _ngcontent-ljm-c106="" class="highlight-div-header-left"><div _ngcontent-ljm-c106="" class="handle-button expand-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ljm-c106="" class="highlight-div-header-right"><div _ngcontent-ljm-c106="" class="handle-button ai-button"></div><div _ngcontent-ljm-c106="" class="handle-button line-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ljm-c106="" class="handle-button theme-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ljm-c106="" class="handle-button copy-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ljm-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// HSP's Index.ets</span></li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">a: <span class="hljs-built_in">number</span>, b: <span class="hljs-built_in">number</span></span>): <span class="hljs-built_in">number</span> {</li><li>  <span class="hljs-keyword">let</span> c = a + b;</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'DynamicImport I am a HSP, %d + %d = %d'</span>, a, b, c);</li><li>  <span class="hljs-keyword">return</span> c;</li><li>}</li></ol></pre></div></div>       <div _ngcontent-ljm-c106="" class="highlight-div"><div _ngcontent-ljm-c106="" class="highlight-div-header"><div _ngcontent-ljm-c106="" class="highlight-div-header-left"><div _ngcontent-ljm-c106="" class="handle-button expand-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ljm-c106="" class="highlight-div-header-right"><div _ngcontent-ljm-c106="" class="handle-button ai-button"></div><div _ngcontent-ljm-c106="" class="handle-button line-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ljm-c106="" class="handle-button theme-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ljm-c106="" class="handle-button copy-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ljm-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// HAP's src/main/ets/pages/Index.ets</span></li><li><span class="hljs-keyword">import</span>(<span class="hljs-string">'myhsp'</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">ns:ESObject</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'DynamicImport ns.add(3, 5) = %d'</span>, ns.<span class="hljs-title function_">add</span>(<span class="hljs-number">3</span>, <span class="hljs-number">5</span>));</li><li>});</li></ol></pre></div></div>       <div _ngcontent-ljm-c106="" class="highlight-div"><div _ngcontent-ljm-c106="" class="highlight-div-header"><div _ngcontent-ljm-c106="" class="highlight-div-header-left"><div _ngcontent-ljm-c106="" class="handle-button expand-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ljm-c106="" class="highlight-div-header-right"><div _ngcontent-ljm-c106="" class="handle-button ai-button"></div><div _ngcontent-ljm-c106="" class="handle-button line-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ljm-c106="" class="handle-button theme-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ljm-c106="" class="handle-button copy-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ljm-c106="" class="highlight-scroll-div"><pre class="json5 prettyprint linenums hljs language-cangjie" hw-language="json5" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// HAP's oh-package.json5</span></li><li><span class="hljs-string">"dependencies"</span>: {</li><li>  <span class="hljs-string">"myhsp"</span>: <span class="hljs-string">"file:../myhsp"</span></li><li>}</li></ol></pre></div></div></li>      <li>       <p><strong>HAP常量动态import HSP模块名文件路径</strong></p>       <div _ngcontent-ljm-c106="" class="highlight-div"><div _ngcontent-ljm-c106="" class="highlight-div-header"><div _ngcontent-ljm-c106="" class="highlight-div-header-left"><div _ngcontent-ljm-c106="" class="handle-button expand-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ljm-c106="" class="highlight-div-header-right"><div _ngcontent-ljm-c106="" class="handle-button ai-button"></div><div _ngcontent-ljm-c106="" class="handle-button line-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ljm-c106="" class="handle-button theme-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ljm-c106="" class="handle-button copy-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ljm-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// HSP's Index.ets</span></li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">a: <span class="hljs-built_in">number</span>, b: <span class="hljs-built_in">number</span></span>): <span class="hljs-built_in">number</span> {</li><li>  <span class="hljs-keyword">let</span> c = a + b;</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'DynamicImport I am a HSP, %d + %d = %d'</span>, a, b, c);</li><li>  <span class="hljs-keyword">return</span> c;</li><li>}</li></ol></pre></div></div>       <div _ngcontent-ljm-c106="" class="highlight-div"><div _ngcontent-ljm-c106="" class="highlight-div-header"><div _ngcontent-ljm-c106="" class="highlight-div-header-left"><div _ngcontent-ljm-c106="" class="handle-button expand-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ljm-c106="" class="highlight-div-header-right"><div _ngcontent-ljm-c106="" class="handle-button ai-button"></div><div _ngcontent-ljm-c106="" class="handle-button line-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ljm-c106="" class="handle-button theme-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ljm-c106="" class="handle-button copy-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ljm-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// HAP's src/main/ets/pages/Index.ets</span></li><li><span class="hljs-keyword">import</span>(<span class="hljs-string">'myhsp/Index'</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">ns:ESObject</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'DynamicImport ns.add(3, 5) = %d'</span>, ns.<span class="hljs-title function_">add</span>(<span class="hljs-number">3</span>, <span class="hljs-number">5</span>));</li><li>});</li></ol></pre></div></div>       <div _ngcontent-ljm-c106="" class="highlight-div"><div _ngcontent-ljm-c106="" class="highlight-div-header"><div _ngcontent-ljm-c106="" class="highlight-div-header-left"><div _ngcontent-ljm-c106="" class="handle-button expand-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ljm-c106="" class="highlight-div-header-right"><div _ngcontent-ljm-c106="" class="handle-button ai-button"></div><div _ngcontent-ljm-c106="" class="handle-button line-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ljm-c106="" class="handle-button theme-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ljm-c106="" class="handle-button copy-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ljm-c106="" class="highlight-scroll-div"><pre class="json5 prettyprint linenums hljs language-cangjie" hw-language="json5" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// HAP's oh-package.json5</span></li><li><span class="hljs-string">"dependencies"</span>: {</li><li>  <span class="hljs-string">"myhsp"</span>: <span class="hljs-string">"file:../myhsp"</span></li><li>}</li></ol></pre></div></div></li>      <li>       <p><strong>HAP常量动态import远程HAR模块名</strong></p>       <div _ngcontent-ljm-c106="" class="highlight-div"><div _ngcontent-ljm-c106="" class="highlight-div-header"><div _ngcontent-ljm-c106="" class="highlight-div-header-left"><div _ngcontent-ljm-c106="" class="handle-button expand-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ljm-c106="" class="highlight-div-header-right"><div _ngcontent-ljm-c106="" class="handle-button ai-button"></div><div _ngcontent-ljm-c106="" class="handle-button line-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ljm-c106="" class="handle-button theme-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ljm-c106="" class="handle-button copy-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ljm-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// HAP's src/main/ets/pages/Index.ets</span></li><li><span class="hljs-keyword">import</span>(<span class="hljs-string">'@ohos/crypto-js'</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">ns:ESObject</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'DynamicImport @ohos/crypto-js: '</span> + ns.<span class="hljs-property">CryptoJS</span>.<span class="hljs-title class_">MD5</span>(<span class="hljs-number">123456</span>));</li><li>});</li></ol></pre></div></div>       <div _ngcontent-ljm-c106="" class="highlight-div"><div _ngcontent-ljm-c106="" class="highlight-div-header"><div _ngcontent-ljm-c106="" class="highlight-div-header-left"><div _ngcontent-ljm-c106="" class="handle-button expand-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ljm-c106="" class="highlight-div-header-right"><div _ngcontent-ljm-c106="" class="handle-button ai-button"></div><div _ngcontent-ljm-c106="" class="handle-button line-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ljm-c106="" class="handle-button theme-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ljm-c106="" class="handle-button copy-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ljm-c106="" class="highlight-scroll-div"><pre class="json5 prettyprint linenums hljs language-cangjie" hw-language="json5" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// HAP's oh-package.json5</span></li><li><span class="hljs-string">"dependencies"</span>: {</li><li>  <span class="hljs-string">"@ohos/crypto-js"</span>: <span class="hljs-string">"2.0.3-rc.0"</span></li><li>}</li></ol></pre></div></div></li>      <li>       <p><strong>HAP常量动态import ohpm包</strong></p>       <div _ngcontent-ljm-c106="" class="highlight-div"><div _ngcontent-ljm-c106="" class="highlight-div-header"><div _ngcontent-ljm-c106="" class="highlight-div-header-left"><div _ngcontent-ljm-c106="" class="handle-button expand-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ljm-c106="" class="highlight-div-header-right"><div _ngcontent-ljm-c106="" class="handle-button ai-button"></div><div _ngcontent-ljm-c106="" class="handle-button line-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ljm-c106="" class="handle-button theme-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ljm-c106="" class="handle-button copy-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ljm-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// HAP's src/main/ets/pages/Index.ets</span></li><li><span class="hljs-keyword">import</span>(<span class="hljs-string">'json5'</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">ns:ESObject</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'DynamicImport json5'</span>);</li><li>});</li></ol></pre></div></div>       <div _ngcontent-ljm-c106="" class="highlight-div"><div _ngcontent-ljm-c106="" class="highlight-div-header"><div _ngcontent-ljm-c106="" class="highlight-div-header-left"><div _ngcontent-ljm-c106="" class="handle-button expand-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ljm-c106="" class="highlight-div-header-right"><div _ngcontent-ljm-c106="" class="handle-button ai-button"></div><div _ngcontent-ljm-c106="" class="handle-button line-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ljm-c106="" class="handle-button theme-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ljm-c106="" class="handle-button copy-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ljm-c106="" class="highlight-scroll-div"><pre class="json5 prettyprint linenums hljs language-cangjie" hw-language="json5" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// HAP's oh-package.json5</span></li><li><span class="hljs-string">"dependencies"</span>: {</li><li>  <span class="hljs-string">"json5"</span>: <span class="hljs-string">"1.0.2"</span></li><li>}</li></ol></pre></div></div></li>      <li>       <p><strong>HAP常量动态import自己的单文件</strong></p>       <div _ngcontent-ljm-c106="" class="highlight-div"><div _ngcontent-ljm-c106="" class="highlight-div-header"><div _ngcontent-ljm-c106="" class="highlight-div-header-left"><div _ngcontent-ljm-c106="" class="handle-button expand-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ljm-c106="" class="highlight-div-header-right"><div _ngcontent-ljm-c106="" class="handle-button ai-button"></div><div _ngcontent-ljm-c106="" class="handle-button line-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ljm-c106="" class="handle-button theme-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ljm-c106="" class="handle-button copy-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ljm-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// HAP's src/main/ets/Calc.ets</span></li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">a: <span class="hljs-built_in">number</span>, b: <span class="hljs-built_in">number</span></span>): <span class="hljs-built_in">number</span> {</li><li>  <span class="hljs-keyword">let</span> c = a + b;</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'DynamicImport I am a HAP, %d + %d = %d'</span>, a, b, c);</li><li>  <span class="hljs-keyword">return</span> c;</li><li>}</li></ol></pre></div></div>       <div _ngcontent-ljm-c106="" class="highlight-div"><div _ngcontent-ljm-c106="" class="highlight-div-header"><div _ngcontent-ljm-c106="" class="highlight-div-header-left"><div _ngcontent-ljm-c106="" class="handle-button expand-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ljm-c106="" class="highlight-div-header-right"><div _ngcontent-ljm-c106="" class="handle-button ai-button"></div><div _ngcontent-ljm-c106="" class="handle-button line-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ljm-c106="" class="handle-button theme-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ljm-c106="" class="handle-button copy-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ljm-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// HAP's src/main/ets/pages/Index.ets</span></li><li><span class="hljs-keyword">import</span>(<span class="hljs-string">'../Calc'</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">ns:ESObject</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'DynamicImport ns.add(3, 5) = %d'</span>, ns.<span class="hljs-title function_">add</span>(<span class="hljs-number">3</span>, <span class="hljs-number">5</span>));</li><li>});</li></ol></pre></div></div></li>      <li>       <p><strong>HAP常量动态import自己的Native库</strong></p>       <div _ngcontent-ljm-c106="" class="highlight-div"><div _ngcontent-ljm-c106="" class="highlight-div-header"><div _ngcontent-ljm-c106="" class="highlight-div-header-left"><div _ngcontent-ljm-c106="" class="handle-button expand-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ljm-c106="" class="highlight-div-header-right"><div _ngcontent-ljm-c106="" class="handle-button ai-button"></div><div _ngcontent-ljm-c106="" class="handle-button line-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ljm-c106="" class="handle-button theme-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ljm-c106="" class="handle-button copy-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ljm-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// libnativeapi.so's index.d.ts</span></li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-attr">add</span>: <span class="hljs-function">(<span class="hljs-params">a: <span class="hljs-built_in">number</span>, b: <span class="hljs-built_in">number</span></span>) =&gt;</span> <span class="hljs-built_in">number</span>;</li></ol></pre></div></div>       <div _ngcontent-ljm-c106="" class="highlight-div"><div _ngcontent-ljm-c106="" class="highlight-div-header"><div _ngcontent-ljm-c106="" class="highlight-div-header-left"><div _ngcontent-ljm-c106="" class="handle-button expand-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ljm-c106="" class="highlight-div-header-right"><div _ngcontent-ljm-c106="" class="handle-button ai-button"></div><div _ngcontent-ljm-c106="" class="handle-button line-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ljm-c106="" class="handle-button theme-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ljm-c106="" class="handle-button copy-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ljm-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// HAP's src/main/ets/pages/Index.ets</span></li><li><span class="hljs-keyword">import</span>(<span class="hljs-string">'libnativeapi.so'</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">ns:ESObject</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'DynamicImport libnativeapi.so: '</span> + ns.<span class="hljs-property">default</span>.<span class="hljs-title function_">add</span>(<span class="hljs-number">2</span>, <span class="hljs-number">3</span>));</li><li>});</li></ol></pre></div></div>       <div _ngcontent-ljm-c106="" class="highlight-div"><div _ngcontent-ljm-c106="" class="highlight-div-header"><div _ngcontent-ljm-c106="" class="highlight-div-header-left"><div _ngcontent-ljm-c106="" class="handle-button expand-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ljm-c106="" class="highlight-div-header-right"><div _ngcontent-ljm-c106="" class="handle-button ai-button"></div><div _ngcontent-ljm-c106="" class="handle-button line-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ljm-c106="" class="handle-button theme-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ljm-c106="" class="handle-button copy-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ljm-c106="" class="highlight-scroll-div"><pre class="json5 prettyprint linenums hljs language-cangjie" hw-language="json5" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// HAP's oh-package.json5</span></li><li><span class="hljs-string">"dependencies"</span>: {</li><li>  <span class="hljs-string">"libnativeapi.so"</span>: <span class="hljs-string">"file:./src/main/cpp/types/libnativeapi"</span></li><li>}</li></ol></pre></div></div></li>      <li>       <p><strong>HAP常量动态import加载API</strong></p>       <div _ngcontent-ljm-c106="" class="highlight-div"><div _ngcontent-ljm-c106="" class="highlight-div-header"><div _ngcontent-ljm-c106="" class="highlight-div-header-left"><div _ngcontent-ljm-c106="" class="handle-button expand-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ljm-c106="" class="highlight-div-header-right"><div _ngcontent-ljm-c106="" class="handle-button ai-button"></div><div _ngcontent-ljm-c106="" class="handle-button line-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ljm-c106="" class="handle-button theme-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ljm-c106="" class="handle-button copy-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ljm-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// HAP's src/main/ets/pages/Index.ets</span></li><li><span class="hljs-keyword">import</span>(<span class="hljs-string">'@system.app'</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">ns:ESObject</span>) =&gt;</span> { ns.<span class="hljs-property">default</span>.<span class="hljs-title function_">terminate</span>(); });</li><li><span class="hljs-keyword">import</span>(<span class="hljs-string">'@system.router'</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">ns:ESObject</span>) =&gt;</span> { ns.<span class="hljs-property">default</span>.<span class="hljs-title function_">clear</span>(); });</li><li><span class="hljs-keyword">import</span>(<span class="hljs-string">'@ohos.curves'</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">ns:ESObject</span>) =&gt;</span> { ns.<span class="hljs-property">default</span>.<span class="hljs-title function_">springMotion</span>(<span class="hljs-number">0.555</span>, <span class="hljs-number">0.75</span>, <span class="hljs-number">0.001</span>); });</li><li><span class="hljs-keyword">import</span>(<span class="hljs-string">'@ohos.matrix4'</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">ns:ESObject</span>) =&gt;</span> { ns.<span class="hljs-property">default</span>.<span class="hljs-title function_">identity</span>(); });</li><li><span class="hljs-keyword">import</span>(<span class="hljs-string">'@ohos.hilog'</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">ns:ESObject</span>) =&gt;</span> { ns.<span class="hljs-property">default</span>.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">'%{public}s'</span>, <span class="hljs-string">'DynamicImport @ohos.hilog.'</span>); });</li></ol></pre></div></div></li>     </ul>    </div>    <div class="tiledSection">     <h3 id="动态import变量表达式">动态import变量表达式<i class="anchor-icon anchor-icon-link" anchorid="动态import变量表达式" tips="复制节点链接"></i></h3>          <p>DevEco Studio中模块间的依赖关系通过oh-package.json5中的dependencies字段进行配置。dependencies列表中所有的模块默认都会进行安装（本地模块）或下载（远程模块），但是不会默认参与编译。HAP/HSP编译时会以入口文件（一般为Index.ets/Index.ts）开始搜索依赖关系，搜索到的模块或文件才会加入编译。</p>     <p>在编译期，静态import和常量动态import可以被打包工具rollup及其插件识别解析，加入依赖树中，参与编译流程，最终生成方舟字节码。但是，如果是变量动态import，该变量值可能需要进行运算或外部传入才能得到，在编译态无法解析其内容，也就无法加入编译。为了将这部分模块/文件加入编译，还需要额外增加一个runtimeOnly的buildOption配置，用于指定动态import的变量实际的模块名或文件路径。</p>     <p><strong>1. runtimeOnly字段schema配置格式</strong></p>     <p>在HAP/HSP/HAR的build-profile.json5中的buildOption中增加runtimeOnly配置项，仅在通过变量动态import时配置，静态import和常量动态import无需配置；并且，通过变量动态import加载API时也无需配置runtimeOnly。如下实例说明如何配置通过变量动态import其他模块，以及变量动态import本模块自己的单文件：</p>     <div _ngcontent-ljm-c106="" class="highlight-div"><div _ngcontent-ljm-c106="" class="highlight-div-header"><div _ngcontent-ljm-c106="" class="highlight-div-header-left"><div _ngcontent-ljm-c106="" class="handle-button expand-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ljm-c106="" class="highlight-div-header-right"><div _ngcontent-ljm-c106="" class="handle-button ai-button"></div><div _ngcontent-ljm-c106="" class="handle-button line-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ljm-c106="" class="handle-button theme-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ljm-c106="" class="handle-button copy-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ljm-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 变量动态import其他模块myhar</span></li><li><span class="hljs-keyword">let</span> harName = <span class="hljs-string">'myhar'</span>;</li><li><span class="hljs-keyword">import</span>(harName).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">obj: ESObject</span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'DynamicImport I am a har'</span>);</li><li>})</li><li>
</li><li><span class="hljs-comment">// 变量动态import本模块自己的单文件src/main/ets/index.ets</span></li><li><span class="hljs-keyword">let</span> filePath = <span class="hljs-string">'./utils/Calc'</span>;</li><li><span class="hljs-keyword">import</span>(filePath).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">obj: ESObject</span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'DynamicImport I am a file'</span>);</li><li>})</li></ol></pre></div></div>     <p>对应的runtimeOnly配置：</p>     <div _ngcontent-ljm-c106="" class="highlight-div"><div _ngcontent-ljm-c106="" class="highlight-div-header"><div _ngcontent-ljm-c106="" class="highlight-div-header-left"><div _ngcontent-ljm-c106="" class="handle-button expand-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ljm-c106="" class="highlight-div-header-right"><div _ngcontent-ljm-c106="" class="handle-button ai-button"></div><div _ngcontent-ljm-c106="" class="handle-button line-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ljm-c106="" class="handle-button theme-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ljm-c106="" class="handle-button copy-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ljm-c106="" class="highlight-scroll-div"><pre class="json prettyprint linenums hljs language-json" hw-language="json" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-attr">"buildOption"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>  <span class="hljs-attr">"arkOptions"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>    <span class="hljs-attr">"runtimeOnly"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>      <span class="hljs-attr">"packages"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span> <span class="hljs-string">"myhar"</span> <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>  <span class="hljs-comment">// 配置本模块变量动态import其他模块名，要求与dependencies中配置的名字一致。</span></li><li>      <span class="hljs-attr">"sources"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span> <span class="hljs-string">"./src/main/ets/utils/Calc.ets"</span> <span class="hljs-punctuation">]</span>  <span class="hljs-comment">// 配置本模块变量动态import自己的文件路径，路径相对于当前build-profile.json5文件。</span></li><li>    <span class="hljs-punctuation">}</span></li><li>  <span class="hljs-punctuation">}</span></li><li><span class="hljs-punctuation">}</span></li></ol></pre></div></div>     <p>"runtimeOnly"的"packages"：用于配置本模块变量动态import其他模块名，要求与dependencies中配置的名字一致。</p>     <p>"runtimeOnly"的"sources"：用于配置本模块变量动态import自己的文件路径，路径相对于当前build-profile.json5文件。</p>     <p><strong>2. 使用实例</strong></p>     <ul>      <li>       <p><strong>HAP变量动态import HAR模块名</strong></p>       <div _ngcontent-ljm-c106="" class="highlight-div"><div _ngcontent-ljm-c106="" class="highlight-div-header"><div _ngcontent-ljm-c106="" class="highlight-div-header-left"><div _ngcontent-ljm-c106="" class="handle-button expand-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ljm-c106="" class="highlight-div-header-right"><div _ngcontent-ljm-c106="" class="handle-button ai-button"></div><div _ngcontent-ljm-c106="" class="handle-button line-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ljm-c106="" class="handle-button theme-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ljm-c106="" class="handle-button copy-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ljm-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// HAR's Index.ets</span></li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">a: <span class="hljs-built_in">number</span>, b: <span class="hljs-built_in">number</span></span>): <span class="hljs-built_in">number</span> {</li><li>  <span class="hljs-keyword">let</span> c = a + b;</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'DynamicImport I am a HAR, %d + %d = %d'</span>, a, b, c);</li><li>  <span class="hljs-keyword">return</span> c;</li><li>}</li></ol></pre></div></div>       <div _ngcontent-ljm-c106="" class="highlight-div"><div _ngcontent-ljm-c106="" class="highlight-div-header"><div _ngcontent-ljm-c106="" class="highlight-div-header-left"><div _ngcontent-ljm-c106="" class="handle-button expand-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ljm-c106="" class="highlight-div-header-right"><div _ngcontent-ljm-c106="" class="handle-button ai-button"></div><div _ngcontent-ljm-c106="" class="handle-button line-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ljm-c106="" class="handle-button theme-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ljm-c106="" class="handle-button copy-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ljm-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// HAP's src/main/ets/pages/Index.ets</span></li><li><span class="hljs-keyword">let</span> packageName = <span class="hljs-string">'myhar'</span>;</li><li><span class="hljs-keyword">import</span>(packageName).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">ns:ESObject</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'DynamicImport ns.add(3, 5) = %d'</span>, ns.<span class="hljs-title function_">add</span>(<span class="hljs-number">3</span>, <span class="hljs-number">5</span>));</li><li>});</li></ol></pre></div></div>       <div _ngcontent-ljm-c106="" class="highlight-div"><div _ngcontent-ljm-c106="" class="highlight-div-header"><div _ngcontent-ljm-c106="" class="highlight-div-header-left"><div _ngcontent-ljm-c106="" class="handle-button expand-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ljm-c106="" class="highlight-div-header-right"><div _ngcontent-ljm-c106="" class="handle-button ai-button"></div><div _ngcontent-ljm-c106="" class="handle-button line-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ljm-c106="" class="handle-button theme-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ljm-c106="" class="handle-button copy-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ljm-c106="" class="highlight-scroll-div"><pre class="json5 prettyprint linenums hljs language-cangjie" hw-language="json5" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// HAP's oh-package.json5</span></li><li><span class="hljs-string">"dependencies"</span>: {</li><li>  <span class="hljs-string">"myhar"</span>: <span class="hljs-string">"file:../myhar"</span></li><li>}</li></ol></pre></div></div>       <div _ngcontent-ljm-c106="" class="highlight-div"><div _ngcontent-ljm-c106="" class="highlight-div-header"><div _ngcontent-ljm-c106="" class="highlight-div-header-left"><div _ngcontent-ljm-c106="" class="handle-button expand-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ljm-c106="" class="highlight-div-header-right"><div _ngcontent-ljm-c106="" class="handle-button ai-button"></div><div _ngcontent-ljm-c106="" class="handle-button line-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ljm-c106="" class="handle-button theme-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ljm-c106="" class="handle-button copy-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ljm-c106="" class="highlight-scroll-div"><pre class="json5 prettyprint linenums hljs language-cangjie" hw-language="json5" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// HAP's build-profile.json5</span></li><li><span class="hljs-string">"buildOption"</span>: {</li><li>  <span class="hljs-string">"arkOptions"</span>: {</li><li>    <span class="hljs-string">"runtimeOnly"</span>: {</li><li>      <span class="hljs-string">"packages"</span>: [</li><li>        <span class="hljs-string">"myhar"</span>  <span class="hljs-comment">// 仅用于使用变量动态import其他模块名场景，静态import或常量动态import无需配置。</span></li><li>      ]</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div></li>      <li>       <p><strong>HAP变量动态import HSP模块名</strong></p>       <div _ngcontent-ljm-c106="" class="highlight-div"><div _ngcontent-ljm-c106="" class="highlight-div-header"><div _ngcontent-ljm-c106="" class="highlight-div-header-left"><div _ngcontent-ljm-c106="" class="handle-button expand-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ljm-c106="" class="highlight-div-header-right"><div _ngcontent-ljm-c106="" class="handle-button ai-button"></div><div _ngcontent-ljm-c106="" class="handle-button line-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ljm-c106="" class="handle-button theme-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ljm-c106="" class="handle-button copy-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ljm-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// HSP's Index.ets</span></li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">a: <span class="hljs-built_in">number</span>, b: <span class="hljs-built_in">number</span></span>): <span class="hljs-built_in">number</span> {</li><li>  <span class="hljs-keyword">let</span> c = a + b;</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'DynamicImport I am a HSP, %d + %d = %d'</span>, a, b, c);</li><li>  <span class="hljs-keyword">return</span> c;</li><li>}</li></ol></pre></div></div>       <div _ngcontent-ljm-c106="" class="highlight-div"><div _ngcontent-ljm-c106="" class="highlight-div-header"><div _ngcontent-ljm-c106="" class="highlight-div-header-left"><div _ngcontent-ljm-c106="" class="handle-button expand-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ljm-c106="" class="highlight-div-header-right"><div _ngcontent-ljm-c106="" class="handle-button ai-button"></div><div _ngcontent-ljm-c106="" class="handle-button line-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ljm-c106="" class="handle-button theme-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ljm-c106="" class="handle-button copy-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ljm-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// HAP's src/main/ets/pages/Index.ets</span></li><li><span class="hljs-keyword">let</span> packageName = <span class="hljs-string">'myhsp'</span>;</li><li><span class="hljs-keyword">import</span>(packageName).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">ns:ESObject</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'DynamicImport ns.add(3, 5) = %d'</span>, ns.<span class="hljs-title function_">add</span>(<span class="hljs-number">3</span>, <span class="hljs-number">5</span>));</li><li>});</li></ol></pre></div></div>       <div _ngcontent-ljm-c106="" class="highlight-div"><div _ngcontent-ljm-c106="" class="highlight-div-header"><div _ngcontent-ljm-c106="" class="highlight-div-header-left"><div _ngcontent-ljm-c106="" class="handle-button expand-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ljm-c106="" class="highlight-div-header-right"><div _ngcontent-ljm-c106="" class="handle-button ai-button"></div><div _ngcontent-ljm-c106="" class="handle-button line-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ljm-c106="" class="handle-button theme-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ljm-c106="" class="handle-button copy-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ljm-c106="" class="highlight-scroll-div"><pre class="json5 prettyprint linenums hljs language-cangjie" hw-language="json5" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// HAP's oh-package.json5</span></li><li><span class="hljs-string">"dependencies"</span>: {</li><li>  <span class="hljs-string">"myhsp"</span>: <span class="hljs-string">"file:../myhsp"</span></li><li>}</li></ol></pre></div></div>       <div _ngcontent-ljm-c106="" class="highlight-div"><div _ngcontent-ljm-c106="" class="highlight-div-header"><div _ngcontent-ljm-c106="" class="highlight-div-header-left"><div _ngcontent-ljm-c106="" class="handle-button expand-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ljm-c106="" class="highlight-div-header-right"><div _ngcontent-ljm-c106="" class="handle-button ai-button"></div><div _ngcontent-ljm-c106="" class="handle-button line-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ljm-c106="" class="handle-button theme-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ljm-c106="" class="handle-button copy-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ljm-c106="" class="highlight-scroll-div"><pre class="json5 prettyprint linenums hljs language-cangjie" hw-language="json5" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// HAP's build-profile.json5</span></li><li><span class="hljs-string">"buildOption"</span>: {</li><li>  <span class="hljs-string">"arkOptions"</span>: {</li><li>    <span class="hljs-string">"runtimeOnly"</span>: {</li><li>      <span class="hljs-string">"packages"</span>: [</li><li>        <span class="hljs-string">"myhsp"</span>  <span class="hljs-comment">// 仅用于使用变量动态import其他模块名场景，静态import或常量动态import无需配置。</span></li><li>      ]</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div></li>      <li>       <p><strong>HAP变量动态import远程HAR模块名</strong></p>       <div _ngcontent-ljm-c106="" class="highlight-div"><div _ngcontent-ljm-c106="" class="highlight-div-header"><div _ngcontent-ljm-c106="" class="highlight-div-header-left"><div _ngcontent-ljm-c106="" class="handle-button expand-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ljm-c106="" class="highlight-div-header-right"><div _ngcontent-ljm-c106="" class="handle-button ai-button"></div><div _ngcontent-ljm-c106="" class="handle-button line-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ljm-c106="" class="handle-button theme-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ljm-c106="" class="handle-button copy-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ljm-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// HAP's src/main/ets/pages/Index.ets</span></li><li><span class="hljs-keyword">let</span> packageName = <span class="hljs-string">'@ohos/crypto-js'</span>;</li><li><span class="hljs-keyword">import</span>(packageName).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">ns:ESObject</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'DynamicImport @ohos/crypto-js: '</span> + ns.<span class="hljs-property">CryptoJS</span>.<span class="hljs-title class_">MD5</span>(<span class="hljs-number">123456</span>));</li><li>});</li></ol></pre></div></div>       <div _ngcontent-ljm-c106="" class="highlight-div"><div _ngcontent-ljm-c106="" class="highlight-div-header"><div _ngcontent-ljm-c106="" class="highlight-div-header-left"><div _ngcontent-ljm-c106="" class="handle-button expand-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ljm-c106="" class="highlight-div-header-right"><div _ngcontent-ljm-c106="" class="handle-button ai-button"></div><div _ngcontent-ljm-c106="" class="handle-button line-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ljm-c106="" class="handle-button theme-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ljm-c106="" class="handle-button copy-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ljm-c106="" class="highlight-scroll-div"><pre class="json5 prettyprint linenums hljs language-cangjie" hw-language="json5" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// HAP's oh-package.json5</span></li><li><span class="hljs-string">"dependencies"</span>: {</li><li>  <span class="hljs-string">"@ohos/crypto-js"</span>: <span class="hljs-string">"2.0.3-rc.0"</span></li><li>}</li></ol></pre></div></div>       <div _ngcontent-ljm-c106="" class="highlight-div"><div _ngcontent-ljm-c106="" class="highlight-div-header"><div _ngcontent-ljm-c106="" class="highlight-div-header-left"><div _ngcontent-ljm-c106="" class="handle-button expand-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ljm-c106="" class="highlight-div-header-right"><div _ngcontent-ljm-c106="" class="handle-button ai-button"></div><div _ngcontent-ljm-c106="" class="handle-button line-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ljm-c106="" class="handle-button theme-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ljm-c106="" class="handle-button copy-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ljm-c106="" class="highlight-scroll-div"><pre class="json5 prettyprint linenums hljs language-cangjie" hw-language="json5" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// HAP's build-profile.json5</span></li><li><span class="hljs-string">"buildOption"</span>: {</li><li>  <span class="hljs-string">"arkOptions"</span>: {</li><li>    <span class="hljs-string">"runtimeOnly"</span>: {</li><li>      <span class="hljs-string">"packages"</span>: [</li><li>        <span class="hljs-string">"@ohos/crypto-js"</span>  <span class="hljs-comment">// 仅用于使用变量动态import其他模块名场景，静态import或常量动态import无需配置。</span></li><li>      ]</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div></li>      <li>       <p><strong>HAP变量动态import ohpm包</strong></p>       <div _ngcontent-ljm-c106="" class="highlight-div"><div _ngcontent-ljm-c106="" class="highlight-div-header"><div _ngcontent-ljm-c106="" class="highlight-div-header-left"><div _ngcontent-ljm-c106="" class="handle-button expand-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ljm-c106="" class="highlight-div-header-right"><div _ngcontent-ljm-c106="" class="handle-button ai-button"></div><div _ngcontent-ljm-c106="" class="handle-button line-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ljm-c106="" class="handle-button theme-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ljm-c106="" class="handle-button copy-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ljm-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// HAP's src/main/ets/pages/Index.ets</span></li><li><span class="hljs-keyword">let</span> packageName = <span class="hljs-string">'json5'</span>;</li><li><span class="hljs-keyword">import</span>(packageName).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">ns:ESObject</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'DynamicImport json5'</span>);</li><li>});</li></ol></pre></div></div>       <div _ngcontent-ljm-c106="" class="highlight-div"><div _ngcontent-ljm-c106="" class="highlight-div-header"><div _ngcontent-ljm-c106="" class="highlight-div-header-left"><div _ngcontent-ljm-c106="" class="handle-button expand-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ljm-c106="" class="highlight-div-header-right"><div _ngcontent-ljm-c106="" class="handle-button ai-button"></div><div _ngcontent-ljm-c106="" class="handle-button line-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ljm-c106="" class="handle-button theme-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ljm-c106="" class="handle-button copy-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ljm-c106="" class="highlight-scroll-div"><pre class="json5 prettyprint linenums hljs language-cangjie" hw-language="json5" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// HAP's oh-package.json5</span></li><li><span class="hljs-string">"dependencies"</span>: {</li><li>  <span class="hljs-string">"json5"</span>: <span class="hljs-string">"1.0.2"</span></li><li>}</li></ol></pre></div></div>       <div _ngcontent-ljm-c106="" class="highlight-div"><div _ngcontent-ljm-c106="" class="highlight-div-header"><div _ngcontent-ljm-c106="" class="highlight-div-header-left"><div _ngcontent-ljm-c106="" class="handle-button expand-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ljm-c106="" class="highlight-div-header-right"><div _ngcontent-ljm-c106="" class="handle-button ai-button"></div><div _ngcontent-ljm-c106="" class="handle-button line-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ljm-c106="" class="handle-button theme-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ljm-c106="" class="handle-button copy-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ljm-c106="" class="highlight-scroll-div"><pre class="json5 prettyprint linenums hljs language-cangjie" hw-language="json5" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// HAP's build-profile.json5</span></li><li><span class="hljs-string">"buildOption"</span>: {</li><li>  <span class="hljs-string">"arkOptions"</span>: {</li><li>    <span class="hljs-string">"runtimeOnly"</span>: {</li><li>      <span class="hljs-string">"packages"</span>: [</li><li>        <span class="hljs-string">"json5"</span>  <span class="hljs-comment">// 仅用于使用变量动态import其他模块名场景，静态import或常量动态import无需配置。</span></li><li>      ]</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div></li>      <li>       <p><strong>HAP变量动态import自己的单文件</strong></p>       <div _ngcontent-ljm-c106="" class="highlight-div"><div _ngcontent-ljm-c106="" class="highlight-div-header"><div _ngcontent-ljm-c106="" class="highlight-div-header-left"><div _ngcontent-ljm-c106="" class="handle-button expand-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ljm-c106="" class="highlight-div-header-right"><div _ngcontent-ljm-c106="" class="handle-button ai-button"></div><div _ngcontent-ljm-c106="" class="handle-button line-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ljm-c106="" class="handle-button theme-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ljm-c106="" class="handle-button copy-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ljm-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// HAP's src/main/ets/Calc.ets</span></li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">a: <span class="hljs-built_in">number</span>, b: <span class="hljs-built_in">number</span></span>): <span class="hljs-built_in">number</span> {</li><li>  <span class="hljs-keyword">let</span> c = a + b;</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'DynamicImport I am a HAP, %d + %d = %d'</span>, a, b, c);</li><li>  <span class="hljs-keyword">return</span> c;</li><li>}</li></ol></pre></div></div>       <div _ngcontent-ljm-c106="" class="highlight-div"><div _ngcontent-ljm-c106="" class="highlight-div-header"><div _ngcontent-ljm-c106="" class="highlight-div-header-left"><div _ngcontent-ljm-c106="" class="handle-button expand-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ljm-c106="" class="highlight-div-header-right"><div _ngcontent-ljm-c106="" class="handle-button ai-button"></div><div _ngcontent-ljm-c106="" class="handle-button line-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ljm-c106="" class="handle-button theme-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ljm-c106="" class="handle-button copy-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ljm-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// HAP's src/main/ets/pages/Index.ets</span></li><li><span class="hljs-keyword">let</span> filePath = <span class="hljs-string">'../Calc'</span>;</li><li><span class="hljs-keyword">import</span>(filePath).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">ns:ESObject</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'DynamicImport ns.add(3, 5) = %d'</span>, ns.<span class="hljs-title function_">add</span>(<span class="hljs-number">3</span>, <span class="hljs-number">5</span>));</li><li>});</li></ol></pre></div></div>       <div _ngcontent-ljm-c106="" class="highlight-div"><div _ngcontent-ljm-c106="" class="highlight-div-header"><div _ngcontent-ljm-c106="" class="highlight-div-header-left"><div _ngcontent-ljm-c106="" class="handle-button expand-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ljm-c106="" class="highlight-div-header-right"><div _ngcontent-ljm-c106="" class="handle-button ai-button"></div><div _ngcontent-ljm-c106="" class="handle-button line-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ljm-c106="" class="handle-button theme-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ljm-c106="" class="handle-button copy-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ljm-c106="" class="highlight-scroll-div"><pre class="json5 prettyprint linenums hljs language-cangjie" hw-language="json5" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// HAP's build-profile.json5</span></li><li><span class="hljs-string">"buildOption"</span>: {</li><li>  <span class="hljs-string">"arkOptions"</span>: {</li><li>    <span class="hljs-string">"runtimeOnly"</span>: {</li><li>      <span class="hljs-string">"sources"</span>: [</li><li>        <span class="hljs-string">"./src/main/ets/Calc.ets"</span>  <span class="hljs-comment">// 仅用于使用变量动态import模块自己单文件场景，静态import或常量动态import无需配置。</span></li><li>      ]</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div></li>      <li>       <p><strong>HAP变量动态import自己的Native库</strong></p>       <div _ngcontent-ljm-c106="" class="highlight-div"><div _ngcontent-ljm-c106="" class="highlight-div-header"><div _ngcontent-ljm-c106="" class="highlight-div-header-left"><div _ngcontent-ljm-c106="" class="handle-button expand-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ljm-c106="" class="highlight-div-header-right"><div _ngcontent-ljm-c106="" class="handle-button ai-button"></div><div _ngcontent-ljm-c106="" class="handle-button line-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ljm-c106="" class="handle-button theme-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ljm-c106="" class="handle-button copy-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ljm-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// libnativeapi.so's index.d.ts</span></li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-attr">add</span>: <span class="hljs-function">(<span class="hljs-params">a: <span class="hljs-built_in">number</span>, b: <span class="hljs-built_in">number</span></span>) =&gt;</span> <span class="hljs-built_in">number</span>;</li></ol></pre></div></div>       <div _ngcontent-ljm-c106="" class="highlight-div"><div _ngcontent-ljm-c106="" class="highlight-div-header"><div _ngcontent-ljm-c106="" class="highlight-div-header-left"><div _ngcontent-ljm-c106="" class="handle-button expand-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ljm-c106="" class="highlight-div-header-right"><div _ngcontent-ljm-c106="" class="handle-button ai-button"></div><div _ngcontent-ljm-c106="" class="handle-button line-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ljm-c106="" class="handle-button theme-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ljm-c106="" class="handle-button copy-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ljm-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// HAP's src/main/ets/pages/Index.ets</span></li><li><span class="hljs-keyword">let</span> soName = <span class="hljs-string">'libnativeapi.so'</span>;</li><li><span class="hljs-keyword">import</span>(soName).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">ns:ESObject</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'DynamicImport libnativeapi.so: '</span> + ns.<span class="hljs-property">default</span>.<span class="hljs-title function_">add</span>(<span class="hljs-number">2</span>, <span class="hljs-number">3</span>));</li><li>});</li></ol></pre></div></div>       <div _ngcontent-ljm-c106="" class="highlight-div"><div _ngcontent-ljm-c106="" class="highlight-div-header"><div _ngcontent-ljm-c106="" class="highlight-div-header-left"><div _ngcontent-ljm-c106="" class="handle-button expand-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ljm-c106="" class="highlight-div-header-right"><div _ngcontent-ljm-c106="" class="handle-button ai-button"></div><div _ngcontent-ljm-c106="" class="handle-button line-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ljm-c106="" class="handle-button theme-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ljm-c106="" class="handle-button copy-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ljm-c106="" class="highlight-scroll-div"><pre class="json5 prettyprint linenums hljs language-cangjie" hw-language="json5" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// HAP's oh-package.json5</span></li><li><span class="hljs-string">"dependencies"</span>: {</li><li>  <span class="hljs-string">"libnativeapi.so"</span>: <span class="hljs-string">"file:./src/main/cpp/types/libnativeapi"</span></li><li>}</li></ol></pre></div></div>       <div _ngcontent-ljm-c106="" class="highlight-div"><div _ngcontent-ljm-c106="" class="highlight-div-header"><div _ngcontent-ljm-c106="" class="highlight-div-header-left"><div _ngcontent-ljm-c106="" class="handle-button expand-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ljm-c106="" class="highlight-div-header-right"><div _ngcontent-ljm-c106="" class="handle-button ai-button"></div><div _ngcontent-ljm-c106="" class="handle-button line-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ljm-c106="" class="handle-button theme-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ljm-c106="" class="handle-button copy-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ljm-c106="" class="highlight-scroll-div"><pre class="json5 prettyprint linenums hljs language-cangjie" hw-language="json5" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// HAP's build-profile.json5</span></li><li><span class="hljs-string">"buildOption"</span>: {</li><li>  <span class="hljs-string">"arkOptions"</span>: {</li><li>    <span class="hljs-string">"runtimeOnly"</span>: {</li><li>      <span class="hljs-string">"packages"</span>: [</li><li>        <span class="hljs-string">"libnativeapi.so"</span>  <span class="hljs-comment">// 仅用于使用变量动态import其他模块名场景，静态import或常量动态import无需配置。</span></li><li>      ]</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div></li>      <li>       <p><strong>HAP变量动态import加载API</strong></p>       <div _ngcontent-ljm-c106="" class="highlight-div"><div _ngcontent-ljm-c106="" class="highlight-div-header"><div _ngcontent-ljm-c106="" class="highlight-div-header-left"><div _ngcontent-ljm-c106="" class="handle-button expand-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ljm-c106="" class="highlight-div-header-right"><div _ngcontent-ljm-c106="" class="handle-button ai-button"></div><div _ngcontent-ljm-c106="" class="handle-button line-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ljm-c106="" class="handle-button theme-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ljm-c106="" class="handle-button copy-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ljm-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// HAP's src/main/ets/pages/Index.ets</span></li><li><span class="hljs-keyword">let</span> packageName = <span class="hljs-string">'@system.app'</span>;</li><li><span class="hljs-keyword">import</span>(packageName).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">ns:ESObject</span>) =&gt;</span> { ns.<span class="hljs-property">default</span>.<span class="hljs-title function_">terminate</span>(); });</li><li>packageName = <span class="hljs-string">'@system.router'</span>;</li><li><span class="hljs-keyword">import</span>(packageName).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">ns:ESObject</span>) =&gt;</span> { ns.<span class="hljs-property">default</span>.<span class="hljs-title function_">clear</span>(); });</li><li>packageName = <span class="hljs-string">'@ohos.curves'</span>;</li><li><span class="hljs-keyword">import</span>(packageName).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">ns:ESObject</span>) =&gt;</span> { ns.<span class="hljs-property">default</span>.<span class="hljs-title function_">springMotion</span>(<span class="hljs-number">0.555</span>, <span class="hljs-number">0.75</span>, <span class="hljs-number">0.001</span>); });</li><li>packageName = <span class="hljs-string">'@ohos.matrix4'</span>;</li><li><span class="hljs-keyword">import</span>(packageName).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">ns:ESObject</span>) =&gt;</span> { ns.<span class="hljs-property">default</span>.<span class="hljs-title function_">identity</span>(); });</li><li>packageName = <span class="hljs-string">'@ohos.hilog'</span>;</li><li><span class="hljs-keyword">import</span>(packageName).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">ns:ESObject</span>) =&gt;</span> { ns.<span class="hljs-property">default</span>.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">'%{public}s'</span>, <span class="hljs-string">'DynamicImport @ohos.hilog.'</span>); });</li></ol></pre></div></div></li>     </ul>     <p>通过变量动态import加载API时无需配置runtimeOnly。</p>    </div>    <div class="tiledSection">     <h3 id="har模块间动态import依赖解耦">HAR模块间动态import依赖解耦<i class="anchor-icon anchor-icon-link" anchorid="har模块间动态import依赖解耦" tips="复制节点链接"></i></h3>          <p>当应用包含多个HAR包，HAR包之间的依赖关系比较复杂。在DevEco Studio中配置依赖关系时，可能会形成循环依赖。这时，如果HAR之间的依赖关系中仅有变量动态import，可以将HAR包之间直接依赖关系转移到HAP/HSP中配置，HAR包之间无需配置依赖关系，从而达到HAR包间依赖解耦的目的。如下示意图：</p>     <p><span><img originheight="173" originwidth="568" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114805.64801086459220478651171885544756:50001231000000:2800:32D42210F050A61DC87FEA6AF25B54E583B1852D556F4694334723428A2464B6.png" width="568" height="173"></span></p>     <p>HAR之间的依赖关系转移至HAP/HSP后：</p>     <p><span><img originheight="283" originwidth="374" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114805.68134428856993544487026626654417:50001231000000:2800:A69EBD4C04E32A67C8D4F0E5F83D5503A7FC4CD94EB59071BD7E25095ED00B87.png" width="374" height="283"></span></p>     <p><strong>使用限制</strong></p>     <ul>      <li>仅限在本地源码HAR包之间存在循环依赖时，使用该规避方案。</li>      <li>被转移依赖的HAR之间只能通过变量动态import，不能有静态import或常量动态import。</li>      <li>转移依赖时，需同时转移<strong>dependencies</strong>和<strong>runtimeOnly</strong>依赖配置。</li>      <li>HSP不支持转移依赖。即：HAP-&gt;HSP1-&gt;HSP2-&gt;HSP3，这里的HSP2和HSP3不能转移到HAP上面。</li>      <li>转移依赖的整个链路上只能有HAR包，不能跨越HSP转移。即：HAP-&gt;HAR1-&gt;HAR2-&gt;HSP-&gt;HAR3-&gt;HAR4，HAR1对HAR2的依赖可以转移到HAP上，HAR3对HAR4的依赖可以转移到HSP上。但是，不能将HAR3或HAR4转移到HAP上。</li>      <li>如果引用了其他工程模块、远程包或集成HSP，需确保<strong>useNormalizedOHMUrl</strong>配置一致，同时设置为true或false，否则可能导致运行错误：<strong>Cannot find dynamic-import module library</strong>。</li>     </ul>     <p><strong>使用实例</strong></p>     <p>下面的实例通过在单向依赖HAP-&gt;HAR1-&gt;HAR2-&gt;HAR3之上增加依赖HAR2-&gt;HAR1、HAR3-&gt;HAR1，形成了循环依赖。</p>     <p><span><img originheight="173" originwidth="568" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114805.96201624980141160350257900622306:50001231000000:2800:F54E15B8A9011B6C3058C3E2539C67F36A6965FA750DEF9A0114A878983E2AE4.png" width="568" height="173"></span></p>     <div _ngcontent-ljm-c106="" class="highlight-div"><div _ngcontent-ljm-c106="" class="highlight-div-header"><div _ngcontent-ljm-c106="" class="highlight-div-header-left"><div _ngcontent-ljm-c106="" class="handle-button expand-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ljm-c106="" class="highlight-div-header-right"><div _ngcontent-ljm-c106="" class="handle-button ai-button"></div><div _ngcontent-ljm-c106="" class="handle-button line-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ljm-c106="" class="handle-button theme-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ljm-c106="" class="handle-button copy-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ljm-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// HAP's src/main/ets/pages/Index.ets</span></li><li><span class="hljs-keyword">let</span> harName = <span class="hljs-string">'har1'</span></li><li><span class="hljs-keyword">import</span>(harName).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">ns: ESObject</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'[DynamicImport] hap -&gt; har1, 0 + 1 = '</span> + ns.<span class="hljs-property">classHar1</span>.<span class="hljs-title function_">add</span>(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>));</li><li>})</li><li>
</li><li><span class="hljs-comment">// HAR1's src/main/ets/utils/Calc.ets</span></li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">classHar1</span> {</li><li>  <span class="hljs-keyword">static</span> <span class="hljs-attr">isImportedHar2</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">false</span>;</li><li>
</li><li>  <span class="hljs-keyword">static</span> <span class="hljs-title function_">add</span>(<span class="hljs-attr">a</span>: <span class="hljs-built_in">number</span>, <span class="hljs-attr">b</span>: <span class="hljs-built_in">number</span>): <span class="hljs-built_in">number</span> {</li><li>    <span class="hljs-keyword">const</span> c = a + b;</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'[DynamicImport] classHar1.add(), %d + %d = %d'</span>, a, b, c);</li><li>
</li><li>    <span class="hljs-keyword">if</span> (!classHar1.<span class="hljs-property">isImportedHar2</span>) {</li><li>      <span class="hljs-keyword">const</span> harName = <span class="hljs-string">'har2'</span>;</li><li>      <span class="hljs-keyword">import</span>(harName).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">ns: ESObject</span>) =&gt;</span> {</li><li>        classHar1.<span class="hljs-property">isImportedHar2</span> = <span class="hljs-literal">true</span>;</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'[DynamicImport] har1 -&gt; har2, 1 + 2 = '</span> + ns.<span class="hljs-property">classHar2</span>.<span class="hljs-title function_">add</span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>));</li><li>      })</li><li>    }</li><li>
</li><li>    <span class="hljs-keyword">return</span> c;</li><li>  }</li><li>}</li><li><span class="hljs-comment">// HAR1's Index.ets</span></li><li><span class="hljs-keyword">export</span> { classHar1 } <span class="hljs-keyword">from</span> <span class="hljs-string">'./src/main/ets/utils/Calc'</span>;</li><li>
</li><li><span class="hljs-comment">// HAR2's src/main/ets/utils/Calc.ets</span></li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">classHar2</span> {</li><li>  <span class="hljs-keyword">static</span> <span class="hljs-attr">isImportedHar1</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">false</span>;</li><li>  <span class="hljs-keyword">static</span> <span class="hljs-attr">isImportedHar3</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">false</span>;</li><li>
</li><li>  <span class="hljs-keyword">static</span> <span class="hljs-title function_">add</span>(<span class="hljs-attr">a</span>: <span class="hljs-built_in">number</span>, <span class="hljs-attr">b</span>: <span class="hljs-built_in">number</span>): <span class="hljs-built_in">number</span> {</li><li>    <span class="hljs-keyword">const</span> c = a + b;</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'[DynamicImport] classHar2.add(), %d + %d = %d'</span>, a, b, c);</li><li>
</li><li>    <span class="hljs-keyword">if</span> (!classHar2.<span class="hljs-property">isImportedHar1</span>) {</li><li>      <span class="hljs-keyword">const</span> harName = <span class="hljs-string">'har1'</span>;</li><li>      <span class="hljs-keyword">import</span>(harName).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">ns: ESObject</span>) =&gt;</span> {</li><li>        classHar2.<span class="hljs-property">isImportedHar1</span> = <span class="hljs-literal">true</span>;</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'[DynamicImport] har2 -&gt; har1, 2 + 1 = '</span> + ns.<span class="hljs-property">classHar1</span>.<span class="hljs-title function_">add</span>(<span class="hljs-number">2</span>, <span class="hljs-number">1</span>));</li><li>      })</li><li>    }</li><li>
</li><li>    <span class="hljs-keyword">if</span> (!classHar2.<span class="hljs-property">isImportedHar3</span>) {</li><li>      <span class="hljs-keyword">const</span> harName = <span class="hljs-string">'har3'</span>;</li><li>      <span class="hljs-keyword">import</span>(harName).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">ns: ESObject</span>) =&gt;</span> {</li><li>        classHar2.<span class="hljs-property">isImportedHar3</span> = <span class="hljs-literal">true</span>;</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'[DynamicImport] har2 -&gt; har3, 2 + 3 = '</span> + ns.<span class="hljs-property">classHar3</span>.<span class="hljs-title function_">add</span>(<span class="hljs-number">2</span>, <span class="hljs-number">3</span>));</li><li>      })</li><li>    }</li><li>
</li><li>    <span class="hljs-keyword">return</span> c;</li><li>  }</li><li>}</li><li><span class="hljs-comment">// HAR2's Index.ets</span></li><li><span class="hljs-keyword">export</span> { classHar2 } <span class="hljs-keyword">from</span> <span class="hljs-string">'./src/main/ets/utils/Calc'</span>;</li><li>
</li><li><span class="hljs-comment">// HAR3's src/main/ets/utils/Calc.ets</span></li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">classHar3</span> {</li><li>  <span class="hljs-keyword">static</span> <span class="hljs-attr">isImportedHar1</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">false</span>;</li><li>
</li><li>  <span class="hljs-keyword">static</span> <span class="hljs-title function_">add</span>(<span class="hljs-attr">a</span>: <span class="hljs-built_in">number</span>, <span class="hljs-attr">b</span>: <span class="hljs-built_in">number</span>): <span class="hljs-built_in">number</span> {</li><li>    <span class="hljs-keyword">const</span> c = a + b;</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'[DynamicImport] classHar3.add(), %d + %d = %d'</span>, a, b, c);</li><li>
</li><li>    <span class="hljs-keyword">if</span> (!classHar3.<span class="hljs-property">isImportedHar1</span>) {</li><li>      <span class="hljs-keyword">const</span> harName = <span class="hljs-string">'har1'</span>;</li><li>      <span class="hljs-keyword">import</span>(harName).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">ns: ESObject</span>) =&gt;</span> {</li><li>        classHar3.<span class="hljs-property">isImportedHar1</span> = <span class="hljs-literal">true</span>;</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'[DynamicImport] har3 -&gt; har1, 3 + 1 = '</span> + ns.<span class="hljs-property">classHar1</span>.<span class="hljs-title function_">add</span>(<span class="hljs-number">3</span>, <span class="hljs-number">1</span>));</li><li>      })</li><li>    }</li><li>
</li><li>    <span class="hljs-keyword">return</span> c;</li><li>  }</li><li>}</li><li><span class="hljs-comment">// HAR3's Index.ets</span></li><li><span class="hljs-keyword">export</span> { classHar3 } <span class="hljs-keyword">from</span> <span class="hljs-string">'./src/main/ets/utils/Calc'</span>;</li></ol></pre></div></div>     <p>若未对HAR之间的<strong>dependencies</strong>和<strong>runtimeOnly</strong>配置进行依赖解耦，ohpm无法解决循环依赖，依赖安装失败。</p>     <div _ngcontent-ljm-c106="" class="highlight-div"><div _ngcontent-ljm-c106="" class="highlight-div-header"><div _ngcontent-ljm-c106="" class="highlight-div-header-left"><div _ngcontent-ljm-c106="" class="handle-button expand-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ljm-c106="" class="highlight-div-header-right"><div _ngcontent-ljm-c106="" class="handle-button ai-button"></div><div _ngcontent-ljm-c106="" class="handle-button line-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ljm-c106="" class="handle-button theme-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ljm-c106="" class="handle-button copy-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ljm-c106="" class="highlight-scroll-div"><pre class="json5 prettyprint linenums hljs language-cangjie" hw-language="json5" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// HAP's oh-package.json5</span></li><li><span class="hljs-string">"dependencies"</span>: {</li><li>  <span class="hljs-string">"har1"</span>: <span class="hljs-string">"file:../har1"</span></li><li>}</li><li><span class="hljs-comment">// HAP's build-profile.json5</span></li><li><span class="hljs-string">"buildOption"</span>: {</li><li>  <span class="hljs-string">"arkOptions"</span>: {</li><li>    <span class="hljs-string">"runtimeOnly"</span>: {</li><li>      <span class="hljs-string">"packages"</span>: [ <span class="hljs-comment">// 仅用于变量动态加载的场景，静态加载或常量动态加载无需配置。</span></li><li>        <span class="hljs-string">"har1"</span></li><li>      ]</li><li>    }</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-comment">// HAR1's oh-package.json5</span></li><li><span class="hljs-string">"dependencies"</span>: {</li><li>  <span class="hljs-string">"har2"</span>: <span class="hljs-string">"file:../har2"</span></li><li>}</li><li><span class="hljs-comment">// HAR1's build-profile.json5</span></li><li><span class="hljs-string">"buildOption"</span>: {</li><li>  <span class="hljs-string">"arkOptions"</span>: {</li><li>    <span class="hljs-string">"runtimeOnly"</span>: {</li><li>      <span class="hljs-string">"packages"</span>: [ <span class="hljs-comment">// 仅用于变量动态加载的场景，静态加载或常量动态加载无需配置。</span></li><li>        <span class="hljs-string">"har2"</span></li><li>      ]</li><li>    }</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-comment">// HAR2's oh-package.json5</span></li><li><span class="hljs-string">"dependencies"</span>: {</li><li>  <span class="hljs-string">"har1"</span>: <span class="hljs-string">"file:../har1"</span>,</li><li>  <span class="hljs-string">"har3"</span>: <span class="hljs-string">"file:../har3"</span></li><li>}</li><li><span class="hljs-comment">// HAR2's build-profile.json5</span></li><li><span class="hljs-string">"buildOption"</span>: {</li><li>  <span class="hljs-string">"arkOptions"</span>: {</li><li>    <span class="hljs-string">"runtimeOnly"</span>: {</li><li>      <span class="hljs-string">"packages"</span>: [ <span class="hljs-comment">// 仅用于变量动态加载的场景，静态加载或常量动态加载无需配置。</span></li><li>        <span class="hljs-string">"har1"</span>,</li><li>        <span class="hljs-string">"har3"</span></li><li>      ]</li><li>    }</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-comment">// HAR3's oh-package.json5</span></li><li><span class="hljs-string">"dependencies"</span>: {</li><li>  <span class="hljs-string">"har1"</span>: <span class="hljs-string">"file:../har1"</span>,</li><li>}</li><li><span class="hljs-comment">// HAR3's build-profile.json5</span></li><li><span class="hljs-string">"buildOption"</span>: {</li><li>  <span class="hljs-string">"arkOptions"</span>: {</li><li>    <span class="hljs-string">"runtimeOnly"</span>: {</li><li>      <span class="hljs-string">"packages"</span>: [ <span class="hljs-comment">// 仅用于变量动态加载的场景，静态加载或常量动态加载无需配置。</span></li><li>        <span class="hljs-string">"har1"</span></li><li>      ]</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>     <p><strong>对应的报错信息如下：</strong></p>     <div _ngcontent-ljm-c106="" class="highlight-div"><div _ngcontent-ljm-c106="" class="highlight-div-header"><div _ngcontent-ljm-c106="" class="highlight-div-header-left"><div _ngcontent-ljm-c106="" class="handle-button expand-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ljm-c106="" class="highlight-div-header-right"><div _ngcontent-ljm-c106="" class="handle-button ai-button"></div><div _ngcontent-ljm-c106="" class="handle-button line-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ljm-c106="" class="handle-button theme-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ljm-c106="" class="handle-button copy-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ljm-c106="" class="highlight-scroll-div"><pre class="text prettyprint linenums hljs language-plaintext" hw-language="text" data-highlighted="yes"><ol class="linenums"><li>ohpm ERROR: Run install command failed</li><li>Error: 00618005 Invalid Dependency</li><li>Error Message: Invalid dependency har2@~\Coupled\har2 -&gt; har2@1.0.0.</li><li>
</li><li>Try the following:</li><li>The name of an indirect dependency cannot be the same as the module name.</li></ol></pre></div></div>     <p>将HAR之间的<strong>dependencies</strong>和<strong>runtimeOnly</strong>配置转移到HAP中，解耦了包间循环依赖，程序能够正确运行。</p>     <div _ngcontent-ljm-c106="" class="highlight-div"><div _ngcontent-ljm-c106="" class="highlight-div-header"><div _ngcontent-ljm-c106="" class="highlight-div-header-left"><div _ngcontent-ljm-c106="" class="handle-button expand-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ljm-c106="" class="highlight-div-header-right"><div _ngcontent-ljm-c106="" class="handle-button ai-button"></div><div _ngcontent-ljm-c106="" class="handle-button line-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ljm-c106="" class="handle-button theme-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ljm-c106="" class="handle-button copy-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ljm-c106="" class="highlight-scroll-div"><pre class="json5 prettyprint linenums hljs language-cangjie" hw-language="json5" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// HAP's oh-package.json5</span></li><li><span class="hljs-string">"dependencies"</span>: {</li><li>  <span class="hljs-string">"har1"</span>: <span class="hljs-string">"file:../har1"</span>,</li><li>  <span class="hljs-string">"har2"</span>: <span class="hljs-string">"file:../har2"</span>,</li><li>  <span class="hljs-string">"har3"</span>: <span class="hljs-string">"file:../har3"</span></li><li>}</li><li><span class="hljs-comment">// HAP's build-profiles.json5</span></li><li><span class="hljs-string">"buildOption"</span>: {</li><li>  <span class="hljs-string">"arkOptions"</span>: {</li><li>    <span class="hljs-string">"runtimeOnly"</span>: {</li><li>      <span class="hljs-string">"packages"</span> : [ <span class="hljs-comment">// 仅用于变量动态加载的场景，静态加载或常量动态加载无需配置。</span></li><li>        <span class="hljs-string">"har1"</span>,</li><li>        <span class="hljs-string">"har2"</span>,</li><li>        <span class="hljs-string">"har3"</span></li><li>      ]</li><li>    }</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-comment">// HAR1's oh-package.json5</span></li><li><span class="hljs-string">"dependencies"</span>: {}</li><li><span class="hljs-comment">// HAR1's build-profile.json5</span></li><li><span class="hljs-string">"buildOption"</span>: {}</li><li>
</li><li><span class="hljs-comment">// HAR2's oh-package.json5</span></li><li><span class="hljs-string">"dependencies"</span>: {}</li><li><span class="hljs-comment">// HAR2's build-profile.json5</span></li><li><span class="hljs-string">"buildOption"</span>: {}</li><li>
</li><li><span class="hljs-comment">// HAR3's oh-package.json5</span></li><li><span class="hljs-string">"dependencies"</span>: {}</li><li><span class="hljs-comment">// HAR3's build-profile.json5</span></li><li><span class="hljs-string">"buildOption"</span>: {}</li></ol></pre></div></div>     <p><strong>对应的运行日志如下：</strong></p>     <div _ngcontent-ljm-c106="" class="highlight-div"><div _ngcontent-ljm-c106="" class="highlight-div-header"><div _ngcontent-ljm-c106="" class="highlight-div-header-left"><div _ngcontent-ljm-c106="" class="handle-button expand-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ljm-c106="" class="highlight-div-header-right"><div _ngcontent-ljm-c106="" class="handle-button ai-button"></div><div _ngcontent-ljm-c106="" class="handle-button line-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ljm-c106="" class="handle-button theme-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ljm-c106="" class="handle-button copy-button"><div _ngcontent-ljm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ljm-c106="" class="highlight-scroll-div"><pre class="text prettyprint linenums hljs language-plaintext" hw-language="text" data-highlighted="yes"><ol class="linenums"><li>[DynamicImport] classHar1.add(), 0 + 1 = 1</li><li>[DynamicImport] hap -&gt; har1, 0 + 1 = 1</li><li>[DynamicImport] classHar2.add(), 1 + 2 = 3</li><li>[DynamicImport] har1 -&gt; har2, 1 + 2 = 3</li><li>[DynamicImport] classHar1.add(), 2 + 1 = 3</li><li>[DynamicImport] har2 -&gt; har1, 2 + 1 = 3</li><li>[DynamicImport] classHar3.add(), 2 + 3 = 5</li><li>[DynamicImport] har2 -&gt; har3, 2 + 3 = 5</li><li>[DynamicImport] classHar1.add(), 3 + 1 = 4</li><li>[DynamicImport] har3 -&gt; har1, 3 + 1 = 4</li></ol></pre></div></div>    </div>   </div>   <div></div></div>