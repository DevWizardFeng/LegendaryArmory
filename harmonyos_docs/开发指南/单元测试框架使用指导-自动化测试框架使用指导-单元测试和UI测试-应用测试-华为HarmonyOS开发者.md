<h1 _ngcontent-jbo-c119="" class="doc-title ng-star-inserted" title="单元测试框架使用指导"> 单元测试框架使用指导 </h1>

<div _ngcontent-jbo-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div id="body1177342613100314"><div class="tiledSection"><h2 id="概述">概述<i class="anchor-icon anchor-icon-link" anchorid="概述" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002506226433__p1633172712100314">单元测试框架（JsUnit），是自动化测试框架基础底座，提供测试脚本识别、调度、执行和结果汇总的能力。开发者可在测试脚本中调用UI测试框架和白盒性能测试框架接口编写测试用例。</p> <p id="ZH-CN_TOPIC_0000002506226433__p1418502353100314">本指南介绍单元测试框架的主要功能、实现原理和开发步骤。</p> </div> <div class="tiledSection"><h2 id="框架能力全景">框架能力全景<i class="anchor-icon anchor-icon-link" anchorid="框架能力全景" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002506226433__p518893271100314">单元测试框架支持的功能特性如下。</p>  <div class="tablenoborder"><div class="tbBox"><table id="table1918664111100314" class="layoutFixed idpTab"><thead><tr id="ZH-CN_TOPIC_0000002506226433__row288664200100314"><th align="left" class="cellrowborder" id="mcps1.3.2.3.1.3.1.1" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry2048709159100314p0">特性</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.2.3.1.3.1.2" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry1859234680100314p0">功能说明</p> </th> </tr> </thead> <tbody><tr id="ZH-CN_TOPIC_0000002506226433__row912833704100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry1426148214100314p0"><a href="/consumer/cn/doc/harmonyos-guides/unittest-guidelines#基础流程能力">基础流程能力</a></p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry832396693100314p0">支持测试用例识别调度及异步执行测试用例。</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row1079429404100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry466246231100314p0"><a href="/consumer/cn/doc/harmonyos-guides/unittest-guidelines#断言能力">断言能力</a></p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry526910670100314p0">判断用例实际结果值与预期值是否相符。</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row284512434100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry2028716561100314p0"><a href="/consumer/cn/doc/harmonyos-guides/unittest-guidelines#mock能力">Mock能力</a></p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry83647542100314p0">支持函数级Mock能力，对定义的函数进行Mock并修改函数的行为，使其返回指定的值或者执行指定操作。</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row1385621831100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry1542808316100314p0"><a href="/consumer/cn/doc/harmonyos-guides/unittest-guidelines#数据驱动">数据驱动能力</a></p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry1976869869100314p0">提供数据驱动能力，支持复用同一个测试脚本，使用不同输入数据驱动测试脚本执行。</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row1287866769100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry833671795100314p0"><a href="/consumer/cn/doc/harmonyos-guides/unittest-guidelines#命令行执行测试脚本">专项能力</a></p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry74327788100314p0">支持测试套与用例筛选、随机执行、压力测试、超时设置、遇错即停模式和跳过执行模式。</p> </td> </tr>  </tbody></table></div> </div> <p id="ZH-CN_TOPIC_0000002506226433__p206380424100314"><strong>图1.单元测试框架主要功能</strong></p> <p id="ZH-CN_TOPIC_0000002506226433__p353170045100314"><span><img originheight="320" originwidth="614" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251120201410.96152549081675963535580174570900:50001231000000:2800:5F49B78FCFBB827713EDEEDD4B858C6D2962F7FDF3BB4668401EA5B93871B08C.png" width="614" height="320"></span></p> </div> <div class="tiledSection"><h2 id="单元测试框架发布方式">单元测试框架发布方式<i class="anchor-icon anchor-icon-link" anchorid="单元测试框架发布方式" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002506226433__p1589958291100314">单元测试框架以ohpm包独立发布，版本信息详见<a href="https://ohpm.openharmony.cn/#/cn/detail/@ohos%2Fhypium" target="_blank">服务组件官网</a>。开发者下载DevEco Studio后，在应用工程中的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-oh-package-json5" target="_blank">oh-package.json5</a>文件中devDependencies节点中配置版本号即可使用对应版本框架功能。</p> <p id="ZH-CN_TOPIC_0000002506226433__p1577816859100314"><strong>配置示例</strong></p> <div _ngcontent-jbo-c106="" class="highlight-div"><div _ngcontent-jbo-c106="" class="highlight-div-header"><div _ngcontent-jbo-c106="" class="highlight-div-header-left"><div _ngcontent-jbo-c106="" class="handle-button expand-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jbo-c106="" class="highlight-div-header-right"><div _ngcontent-jbo-c106="" class="handle-button ai-button"></div><div _ngcontent-jbo-c106="" class="handle-button line-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jbo-c106="" class="handle-button theme-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jbo-c106="" class="handle-button copy-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jbo-c106="" class="highlight-scroll-div"><pre class="json prettyprint linenums hljs language-json" id="ZH-CN_TOPIC_0000002506226433__screen594518630100314" hw-language="json" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-attr">"devDependencies"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>    <span class="hljs-attr">"@ohos/hypium"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"1.0.24"</span></li><li>  <span class="hljs-punctuation">}</span></li></ol></pre></div></div> </div> <div class="tiledSection"><h2 id="基于arkts编写和执行测试脚本">基于ArkTS编写和执行测试脚本<i class="anchor-icon anchor-icon-link" anchorid="基于arkts编写和执行测试脚本" tips="复制节点链接"></i></h2></div> <div class="tiledSection"><h3 id="搭建环境" class="firsth2">搭建环境<i class="anchor-icon anchor-icon-link" anchorid="搭建环境" tips="复制节点链接"></i></h3><p id="ZH-CN_TOPIC_0000002506226433__p411820479100314">测试脚本基于DevEco Studio编写，请下载<a href="https://developer.huawei.com/consumer/cn/download/" target="_blank">DevEco Studio</a>并完成<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/hdc#环境准备" target="_blank">hdc配置</a>。</p> </div> <div class="tiledSection"><h3 id="新建测试脚本">新建测试脚本<i class="anchor-icon anchor-icon-link" anchorid="新建测试脚本" tips="复制节点链接"></i></h3><p id="ZH-CN_TOPIC_0000002506226433__p412856370100314">参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-instrument-test#section36049271219" target="_blank">DevEco Studio指导</a>创建ArkTS测试用例。</p> </div> <div class="tiledSection"><h3 id="编写单元测试脚本">编写单元测试脚本<i class="anchor-icon anchor-icon-link" anchorid="编写单元测试脚本" tips="复制节点链接"></i></h3><p id="ZH-CN_TOPIC_0000002506226433__p902183782100314">一个完整的测试脚本需要包含以下基本元素：</p> <ol id="ZH-CN_TOPIC_0000002506226433__ol1520162572100314"><li id="li1651489848100314">依赖导包，以便使用单元测试框架提供的接口，以及其他测试脚本中需要依赖使用的接口。</li><li id="li672084396100314">测试代码编写，编写测试用例的相关测试逻辑。</li><li id="li257640118100314">断言接口调用，设置测试代码中的检查点，用于检查用例是否符合预期。</li></ol> <p id="ZH-CN_TOPIC_0000002506226433__p1203308828100314">下面提供一个简单示例，测试场景：启动被测试页面，检查设备当前显示的页面是否为预期启动的页面。</p> <div _ngcontent-jbo-c106="" class="highlight-div"><div _ngcontent-jbo-c106="" class="highlight-div-header"><div _ngcontent-jbo-c106="" class="highlight-div-header-left"><div _ngcontent-jbo-c106="" class="handle-button expand-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jbo-c106="" class="highlight-div-header-right"><div _ngcontent-jbo-c106="" class="handle-button ai-button"></div><div _ngcontent-jbo-c106="" class="handle-button line-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jbo-c106="" class="handle-button theme-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jbo-c106="" class="handle-button copy-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jbo-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" id="ZH-CN_TOPIC_0000002506226433__screen311364551100314" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { describe, it, expect, <span class="hljs-title class_">Level</span>, <span class="hljs-title class_">Size</span>, <span class="hljs-title class_">TestType</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@ohos/hypium'</span>;</li><li><span class="hljs-keyword">import</span> { abilityDelegatorRegistry } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.TestKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span>, <span class="hljs-title class_">Want</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-keyword">const</span> delegator = abilityDelegatorRegistry.<span class="hljs-title function_">getAbilityDelegator</span>();</li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">sleep</span>(<span class="hljs-params">time: <span class="hljs-built_in">number</span></span>) {</li><li>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt;(<span class="hljs-function">(<span class="hljs-params">resolve: <span class="hljs-built_in">Function</span></span>) =&gt;</span> <span class="hljs-built_in">setTimeout</span>(resolve, time));</li><li>}</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">abilityTest</span>(<span class="hljs-params"></span>) {</li><li>  <span class="hljs-title function_">describe</span>(<span class="hljs-string">'ActsAbilityTest'</span>, <span class="hljs-function">() =&gt;</span>{</li><li>  <span class="hljs-comment">// 测试套名称为ActsAbilityTest</span></li><li>    <span class="hljs-comment">// 可根据此处设置的用例类型、用例规模、用例级别进行用例筛选</span></li><li>    <span class="hljs-title function_">it</span>(<span class="hljs-string">'testExample'</span>,<span class="hljs-title class_">TestType</span>.<span class="hljs-property">FUNCTION</span> | <span class="hljs-title class_">Size</span>.<span class="hljs-property">MEDIUMTEST</span> | <span class="hljs-title class_">Level</span>.<span class="hljs-property">LEVEL1</span>, <span class="hljs-keyword">async</span> (<span class="hljs-attr">done</span>: <span class="hljs-title class_">Function</span>) =&gt; {</li><li>    <span class="hljs-comment">// 测试用例名称为testExample</span></li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"unitTest: TestExample begin"</span>);</li><li>      <span class="hljs-keyword">await</span> <span class="hljs-title function_">sleep</span>(<span class="hljs-number">500</span>);</li><li>      <span class="hljs-keyword">const</span> bundleName = abilityDelegatorRegistry.<span class="hljs-title function_">getArguments</span>().<span class="hljs-property">bundleName</span>;</li><li>      <span class="hljs-comment">// 启动被测试Ability</span></li><li>      <span class="hljs-keyword">const</span> <span class="hljs-attr">want</span>: <span class="hljs-title class_">Want</span> = {</li><li>        <span class="hljs-attr">bundleName</span>: bundleName,</li><li>        <span class="hljs-attr">abilityName</span>: <span class="hljs-string">'EntryAbility'</span></li><li>      }</li><li>      <span class="hljs-keyword">await</span> delegator.<span class="hljs-title function_">startAbility</span>(want);</li><li>      <span class="hljs-keyword">await</span> <span class="hljs-title function_">sleep</span>(<span class="hljs-number">500</span>);</li><li>      <span class="hljs-comment">// 获取设备上前台显示的页面并断言检查</span></li><li>      <span class="hljs-keyword">const</span> <span class="hljs-attr">ability</span>: <span class="hljs-title class_">UIAbility</span> = <span class="hljs-keyword">await</span> delegator.<span class="hljs-title function_">getCurrentTopAbility</span>();</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"get top ability"</span>);</li><li>      <span class="hljs-title function_">expect</span>(ability.<span class="hljs-property">context</span>.<span class="hljs-property">abilityInfo</span>.<span class="hljs-property">name</span>).<span class="hljs-title function_">assertEqual</span>(<span class="hljs-string">'EntryAbility'</span>);</li><li>      <span class="hljs-title function_">done</span>();</li><li>    })</li><li>  })</li><li>}</li></ol></pre></div></div> </div> <div class="tiledSection"><h3 id="deveco-stuido执行测试脚本">DevEco Stuido执行测试脚本<i class="anchor-icon anchor-icon-link" anchorid="deveco-stuido执行测试脚本" tips="复制节点链接"></i></h3><p id="ZH-CN_TOPIC_0000002506226433__p1534531531100314">连接目标测试设备（如手机），在DevEco Studio页面点击对应按钮执行测试脚本，当前支持以下四种方式：</p> <ol id="ZH-CN_TOPIC_0000002506226433__ol966878566100314"><li id="li912357064100314">测试包级别执行，即执行测试包内的全部用例。</li><li id="li328558333100314">测试类级别执行，即执行*.ets文件里的所有测试用例。</li><li id="li1516309335100314">测试套级别执行，即执行describe接口中定义的全部测试用例。</li><li id="li55562730100314">测试用例级别执行，即执行指定it接口也就是单条测试用例。</li></ol> <p id="ZH-CN_TOPIC_0000002506226433__p904768621100314">下面给出测试类级别即测试文件执行示例，其他请查考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-instrument-test#section1574003717165" target="_blank">运行模式</a>。</p> <p id="ZH-CN_TOPIC_0000002506226433__p667244088100314"><span><img originheight="476" originwidth="459" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251120201410.84085876629004737047314282839311:50001231000000:2800:76F421AF4B14910105902B96C3B954504FAFAAA6E304E53F0DD88B0CFEF7FB6D.png" width="459" height="476"></span></p> <ul id="ZH-CN_TOPIC_0000002506226433__ul1304698234100314"><li id="li249604604100314">查看测试结果</li></ul> <p id="ZH-CN_TOPIC_0000002506226433__p2097190749100314">测试执行后可直接在DevEco Studio中查看测试结果。</p> <p id="ZH-CN_TOPIC_0000002506226433__p1957956055100314"><span><img originheight="508" originwidth="1742" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251120201410.47940666798641772612886900407958:50001231000000:2800:9F7D3CA1284B73929AE337ACF2C99273E97180B1A993AB56C3542AFCE3CA185A.png" width="920" height="268.2893226176808"></span></p> <ul id="ZH-CN_TOPIC_0000002506226433__ul1964191141100314"><li id="li1950258197100314">查看测试用例覆盖率</li></ul> <p id="ZH-CN_TOPIC_0000002506226433__p902983054100314">执行测试用例后可以查看测试用例覆盖率，具体操作请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-instrument-test#section1989615417457" target="_blank">覆盖率统计模式</a>章节内的内容。</p> </div> <div class="tiledSection"><h3 id="命令行执行测试脚本">命令行执行测试脚本<i class="anchor-icon anchor-icon-link" anchorid="命令行执行测试脚本" tips="复制节点链接"></i></h3><p id="ZH-CN_TOPIC_0000002506226433__p1948885374100314">脚本执行需连接硬件设备，开发者安装测试包到连接设备上，在命令行窗口中通过执行aa test命令并设置执行参数，触发执行测试用例。</p> <ul id="ZH-CN_TOPIC_0000002506226433__ul1601886415100314"><li id="li1953208429100314">aa test工具命令列表</li></ul> <p id="ZH-CN_TOPIC_0000002506226433__p1830168723100314">以下是单元测试过程中的常用命令，其他aa test命令及含义说明参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/aa-tool" target="_blank">命令指南说明</a>。</p>  <div class="tablenoborder"><div class="tbBox"><table id="table1322023138100314" class="layoutFixed idpTab"><thead><tr id="ZH-CN_TOPIC_0000002506226433__row1052209860100314"><th align="left" class="cellrowborder" id="mcps1.3.9.5.1.4.1.1" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__entry419030958100314p0">参数</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.9.5.1.4.1.2" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__entry341207025100314p0">参数说明</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.9.5.1.4.1.3" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__entry1189173226100314p0">示例</p> </th> </tr> </thead> <tbody><tr id="ZH-CN_TOPIC_0000002506226433__row1509775446100314"><td class="cellrowborder" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__entry367987332100314p0">--bundleName/-b</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__entry1178409594100314p0">指定应用Bundle名称。</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__entry409422363100314p0">- b com.test.example</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row1804885040100314"><td class="cellrowborder" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__entry276206988100314p0">--packageName/-p</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__entry1414549853100314p0">指定应用模块名，适用于FA模型应用。</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__entry957538031100314p0">- p com.test.example.entry</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row1153835281100314"><td class="cellrowborder" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__entry1044512408100314p0">--moduleName/-m</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__entry1359267764100314p0">指定应用模块名，适用于Stage模型应用。</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__entry356197661100314p0">-m entry</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row786586407100314"><td class="cellrowborder" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__entry2010507789100314p0">-s</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__entry48853265100314p0">特定参数，以&lt;key, value&gt;键值对方式传入。框架支持通过-s参数键值配置多种用例执行方式，-s的参数及对应含义参见下表。</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__entry1975886846100314p0">- s unittest /ets/testrunner/OpenHarmonyTestRunner</p> </td> </tr>  </tbody></table></div> </div>  <div class="tablenoborder"><div class="tbBox"><table id="table2016123440100314" class="layoutFixed idpTab"><thead><tr id="ZH-CN_TOPIC_0000002506226433__row1511093235100314"><th align="left" class="cellrowborder" id="mcps1.3.9.6.1.4.1.1" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__entry1971468088100314p0">参数</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.9.6.1.4.1.2" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__entry955763848100314p0">参数含义及取值</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.9.6.1.4.1.3" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__entry225935220100314p0">示例</p> </th> </tr> </thead> <tbody><tr id="ZH-CN_TOPIC_0000002506226433__row1378317920100314"><td class="cellrowborder" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__entry1679638415100314p0">unittest</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__entry1244026765100314p0">用例执行所使用OpenHarmonyTestRunner对象，取值可为OpenHarmonyTestRunner或用户自定义runner名称。</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__entry775360124100314p0">-s unittest OpenHarmonyTestRunner</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row37953152100314"><td class="cellrowborder" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__entry2088826707100314p0">class</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__entry489118185100314p0">筛选执行方式，即指定要执行的测试套或测试用例。取值为describeName，describeName#itName，其中describeName为测试套名称、itName为测试用例名称。</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__entry2093725198100314p0">-s class attributeTest#testAttributeIt</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row591190650100314"><td class="cellrowborder" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__entry1937285557100314p0">notClass</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__entry1330913289100314p0">排除执行方式，即指定不需要执行的测试套或测试用例。取值为describeName，describeName#itName，其中describeName为测试套名称、itName为测试用例名称。</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__entry1019064688100314p0">-s notClass attributeTest#testAttributeIt</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row276276687100314"><td class="cellrowborder" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__entry1813113110100314p0">itName</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__entry798631074100314p0">筛选执行方式， 指定要执行的测试用例。取值为itName。</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__entry1641325905100314p0">-s itName testAttributeIt</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row360160277100314"><td class="cellrowborder" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__entry1657075525100314p0">timeout</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__entry2110058345100314p0">设置测试用例执行的超时时间。取值为正整数（单位ms），默认值：5000。</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__entry297920741100314p0">-s timeout 15000</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row474933127100314"><td class="cellrowborder" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__entry447599149100314p0">breakOnError</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__p1990375743100314">遇错即停方式，设置是否在用例失败时立即停止测试。取值为true（停止）/false（继续），默认为false。</p> <p id="ZH-CN_TOPIC_0000002506226433__p718127363100314"><strong>说明</strong>：从@ohos/hypium 1.0.6版本开始支持。</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__entry436885334100314p0">-s breakOnError true</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row1492361543100314"><td class="cellrowborder" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__entry1968504725100314p0">random</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__p1147898423100314">随机执行方式，设置为true时随机顺序执行测试用例。取值为true（设置）/false（不设置），默认为false。</p> <p id="ZH-CN_TOPIC_0000002506226433__p1313972706100314"><strong>说明</strong>：从@ohos/hypium 1.0.3版本开始支持。</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__entry880952695100314p0">-s random true</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row328519508100314"><td class="cellrowborder" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__entry303195187100314p0">testType</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__entry1803270129100314p0">筛选执行方式，指定筛选执行的用例类型。取值为function，performance，power，reliability，security，global，compatibility，user，standard，safety，resilience。</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__entry1603465134100314p0">-s testType function</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row876081099100314"><td class="cellrowborder" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__entry1796540411100314p0">level</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__entry167732719100314p0">筛选执行方式，指定筛选执行的用例级别。取值为0，1，2，3，4。</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__entry1096056783100314p0">-s level 0</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row52554149100314"><td class="cellrowborder" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__entry1839692679100314p0">size</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__entry1733793891100314p0">筛选执行方式，指定筛选执行的用例规模。取值为small，medium，large。</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__entry1033509983100314p0">-s size small</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row387196284100314"><td class="cellrowborder" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__entry1161698850100314p0">stress</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__p187462058100314">压力执行方式，指定执行用例的执行次数，设置后框架按照设置次数重复执行。取值为正整数。</p> <p id="ZH-CN_TOPIC_0000002506226433__p1255679597100314"><strong>说明</strong>：从@ohos/hypium 1.0.5版本开始支持。</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__entry574072164100314p0">-s stress 1000</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row1053337118100314"><td class="cellrowborder" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__entry431953391100314p0">skipMessage</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__p1815105142100314">控制显示待执行的测试用例信息全集中，是否包含被设置跳过执行的测试套和用例的信息。取值为true（不显示相关信息）/false（显示相关信息），默认为false。</p> <p id="ZH-CN_TOPIC_0000002506226433__p1877388724100314"><strong>说明</strong>：从@ohos/hypium 1.0.17版本开始支持。</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__entry1468107824100314p0">-s skipMessage true</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row1411683505100314"><td class="cellrowborder" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__entry1495307413100314p0">runSkipped</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__p1973053028100314">跳过执行方式，指定要执行的跳过测试套&amp;跳过用例。取值为all，skipped，describeName#itName。</p> <p id="ZH-CN_TOPIC_0000002506226433__p226018976100314"><strong>说明</strong>：从@ohos/hypium 1.0.17版本开始支持。</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__entry2034466463100314p0">-s runSkipped all</p> </td> </tr>  </tbody></table></div> </div> <ul id="ZH-CN_TOPIC_0000002506226433__ul775619780100314"><li id="li1361810863100314">执行测试脚本</li></ul> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p id="ZH-CN_TOPIC_0000002506226433__p1538672819100314">下文参数配置和命令示例均基于Stage模型。</p> <p id="ZH-CN_TOPIC_0000002506226433__p1766771090100314">执行命令参数需基于@ohos/hypium框架发布版本，且测试应用包需集成该版本，否则命令参数无法响应，具体配置方式参考<a href="/consumer/cn/doc/harmonyos-guides/unittest-guidelines#单元测试框架发布方式">发布方式</a>。</p> </div></div></div> <p id="ZH-CN_TOPIC_0000002506226433__p1723163790100314"><strong>示例代码1</strong>：执行所有测试用例</p> <div _ngcontent-jbo-c106="" class="highlight-div"><div _ngcontent-jbo-c106="" class="highlight-div-header"><div _ngcontent-jbo-c106="" class="highlight-div-header-left"><div _ngcontent-jbo-c106="" class="handle-button expand-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jbo-c106="" class="highlight-div-header-right"><div _ngcontent-jbo-c106="" class="handle-button ai-button"></div><div _ngcontent-jbo-c106="" class="handle-button line-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jbo-c106="" class="handle-button theme-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jbo-c106="" class="handle-button copy-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jbo-c106="" class="highlight-scroll-div"><pre class="shell prettyprint linenums hljs language-shell" id="ZH-CN_TOPIC_0000002506226433__screen1048589496100314" hw-language="shell" data-highlighted="yes"><ol class="linenums"><li> hdc shell aa test -b xxx -m xxx -s unittest OpenHarmonyTestRunner</li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002506226433__p1341013844100314"><strong>示例代码2</strong>：执行指定的describe测试套用例，指定多个需用逗号隔开</p> <div _ngcontent-jbo-c106="" class="highlight-div"><div _ngcontent-jbo-c106="" class="highlight-div-header"><div _ngcontent-jbo-c106="" class="highlight-div-header-left"><div _ngcontent-jbo-c106="" class="handle-button expand-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jbo-c106="" class="highlight-div-header-right"><div _ngcontent-jbo-c106="" class="handle-button ai-button"></div><div _ngcontent-jbo-c106="" class="handle-button line-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jbo-c106="" class="handle-button theme-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jbo-c106="" class="handle-button copy-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jbo-c106="" class="highlight-scroll-div"><pre class="shell prettyprint linenums hljs language-shell" id="ZH-CN_TOPIC_0000002506226433__screen1747577372100314" hw-language="shell" data-highlighted="yes"><ol class="linenums"><li>  hdc shell aa test -b xxx -m xxx -s unittest OpenHarmonyTestRunner -s class s1,s2</li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002506226433__p25777344100314"><strong>示例代码3</strong>：执行指定测试套中指定的用例，指定多个需用逗号隔开</p> <div _ngcontent-jbo-c106="" class="highlight-div"><div _ngcontent-jbo-c106="" class="highlight-div-header"><div _ngcontent-jbo-c106="" class="highlight-div-header-left"><div _ngcontent-jbo-c106="" class="handle-button expand-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jbo-c106="" class="highlight-div-header-right"><div _ngcontent-jbo-c106="" class="handle-button ai-button"></div><div _ngcontent-jbo-c106="" class="handle-button line-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jbo-c106="" class="handle-button theme-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jbo-c106="" class="handle-button copy-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jbo-c106="" class="highlight-scroll-div"><pre class="shell prettyprint linenums hljs language-shell" id="ZH-CN_TOPIC_0000002506226433__screen1752864168100314" hw-language="shell" data-highlighted="yes"><ol class="linenums"><li>  hdc shell aa test -b xxx -m xxx -s unittest OpenHarmonyTestRunner -s class testStop#stop_1,testStop1#stop_0</li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002506226433__p1017404214100314"><strong>示例代码4</strong>：执行除指定配置外的所有用例，设置不执行多个测试套需用逗号隔开</p> <div _ngcontent-jbo-c106="" class="highlight-div"><div _ngcontent-jbo-c106="" class="highlight-div-header"><div _ngcontent-jbo-c106="" class="highlight-div-header-left"><div _ngcontent-jbo-c106="" class="handle-button expand-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jbo-c106="" class="highlight-div-header-right"><div _ngcontent-jbo-c106="" class="handle-button ai-button"></div><div _ngcontent-jbo-c106="" class="handle-button line-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jbo-c106="" class="handle-button theme-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jbo-c106="" class="handle-button copy-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jbo-c106="" class="highlight-scroll-div"><pre class="shell prettyprint linenums hljs language-shell" id="ZH-CN_TOPIC_0000002506226433__screen609952213100314" hw-language="shell" data-highlighted="yes"><ol class="linenums"><li>  hdc shell aa test -b xxx -m xxx -s unittest OpenHarmonyTestRunner -s notClass testStop</li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002506226433__p1085243380100314"><strong>示例代码5</strong>：执行指定it名称的所有用例，指定多个需用逗号隔开</p> <div _ngcontent-jbo-c106="" class="highlight-div"><div _ngcontent-jbo-c106="" class="highlight-div-header"><div _ngcontent-jbo-c106="" class="highlight-div-header-left"><div _ngcontent-jbo-c106="" class="handle-button expand-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jbo-c106="" class="highlight-div-header-right"><div _ngcontent-jbo-c106="" class="handle-button ai-button"></div><div _ngcontent-jbo-c106="" class="handle-button line-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jbo-c106="" class="handle-button theme-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jbo-c106="" class="handle-button copy-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jbo-c106="" class="highlight-scroll-div"><pre class="shell prettyprint linenums hljs language-shell" id="ZH-CN_TOPIC_0000002506226433__screen909946489100314" hw-language="shell" data-highlighted="yes"><ol class="linenums"><li>  hdc shell aa test -b xxx -m xxx -s unittest OpenHarmonyTestRunner -s itName stop_0</li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002506226433__p225609214100314"><strong>示例代码6</strong>：用例执行超时时长配置</p> <div _ngcontent-jbo-c106="" class="highlight-div"><div _ngcontent-jbo-c106="" class="highlight-div-header"><div _ngcontent-jbo-c106="" class="highlight-div-header-left"><div _ngcontent-jbo-c106="" class="handle-button expand-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jbo-c106="" class="highlight-div-header-right"><div _ngcontent-jbo-c106="" class="handle-button ai-button"></div><div _ngcontent-jbo-c106="" class="handle-button line-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jbo-c106="" class="handle-button theme-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jbo-c106="" class="handle-button copy-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jbo-c106="" class="highlight-scroll-div"><pre class="shell prettyprint linenums hljs language-shell" id="ZH-CN_TOPIC_0000002506226433__screen955312704100314" hw-language="shell" data-highlighted="yes"><ol class="linenums"><li>  hdc shell aa test -b xxx -m xxx -s unittest OpenHarmonyTestRunner -s timeout 15000</li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002506226433__p170872876100314"><strong>示例代码7</strong>：用例以遇错即停模式执行用例</p> <div _ngcontent-jbo-c106="" class="highlight-div"><div _ngcontent-jbo-c106="" class="highlight-div-header"><div _ngcontent-jbo-c106="" class="highlight-div-header-left"><div _ngcontent-jbo-c106="" class="handle-button expand-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jbo-c106="" class="highlight-div-header-right"><div _ngcontent-jbo-c106="" class="handle-button ai-button"></div><div _ngcontent-jbo-c106="" class="handle-button line-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jbo-c106="" class="handle-button theme-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jbo-c106="" class="handle-button copy-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jbo-c106="" class="highlight-scroll-div"><pre class="shell prettyprint linenums hljs language-shell" id="ZH-CN_TOPIC_0000002506226433__screen320777032100314" hw-language="shell" data-highlighted="yes"><ol class="linenums"><li>  hdc shell aa test -b xxx -m xxx -s unittest OpenHarmonyTestRunner -s breakOnError true</li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002506226433__p1184810405100314"><strong>示例代码8</strong>：执行测试类型匹配的测试用例</p> <div _ngcontent-jbo-c106="" class="highlight-div"><div _ngcontent-jbo-c106="" class="highlight-div-header"><div _ngcontent-jbo-c106="" class="highlight-div-header-left"><div _ngcontent-jbo-c106="" class="handle-button expand-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jbo-c106="" class="highlight-div-header-right"><div _ngcontent-jbo-c106="" class="handle-button ai-button"></div><div _ngcontent-jbo-c106="" class="handle-button line-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jbo-c106="" class="handle-button theme-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jbo-c106="" class="handle-button copy-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jbo-c106="" class="highlight-scroll-div"><pre class="shell prettyprint linenums hljs language-shell" id="ZH-CN_TOPIC_0000002506226433__screen100175517100314" hw-language="shell" data-highlighted="yes"><ol class="linenums"><li>  hdc shell aa test -b xxx -m xxx -s unittest OpenHarmonyTestRunner -s testType function</li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002506226433__p1995483121100314"><strong>示例代码9</strong>：执行测试级别匹配的测试用例</p> <div _ngcontent-jbo-c106="" class="highlight-div"><div _ngcontent-jbo-c106="" class="highlight-div-header"><div _ngcontent-jbo-c106="" class="highlight-div-header-left"><div _ngcontent-jbo-c106="" class="handle-button expand-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jbo-c106="" class="highlight-div-header-right"><div _ngcontent-jbo-c106="" class="handle-button ai-button"></div><div _ngcontent-jbo-c106="" class="handle-button line-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jbo-c106="" class="handle-button theme-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jbo-c106="" class="handle-button copy-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jbo-c106="" class="highlight-scroll-div"><pre class="shell prettyprint linenums hljs language-shell" id="ZH-CN_TOPIC_0000002506226433__screen1320888425100314" hw-language="shell" data-highlighted="yes"><ol class="linenums"><li>  hdc shell aa test -b xxx -m xxx -s unittest OpenHarmonyTestRunner -s level 0</li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002506226433__p1611849236100314"><strong>示例代码10</strong>：执行测试规模匹配的测试用例</p> <div _ngcontent-jbo-c106="" class="highlight-div"><div _ngcontent-jbo-c106="" class="highlight-div-header"><div _ngcontent-jbo-c106="" class="highlight-div-header-left"><div _ngcontent-jbo-c106="" class="handle-button expand-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jbo-c106="" class="highlight-div-header-right"><div _ngcontent-jbo-c106="" class="handle-button ai-button"></div><div _ngcontent-jbo-c106="" class="handle-button line-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jbo-c106="" class="handle-button theme-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jbo-c106="" class="handle-button copy-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jbo-c106="" class="highlight-scroll-div"><pre class="shell prettyprint linenums hljs language-shell" id="ZH-CN_TOPIC_0000002506226433__screen1871971437100314" hw-language="shell" data-highlighted="yes"><ol class="linenums"><li>  hdc shell aa test -b xxx -m xxx -s unittest OpenHarmonyTestRunner -s size small</li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002506226433__p70516248100314"><strong>示例代码11</strong>：执行测试用例指定次数</p> <div _ngcontent-jbo-c106="" class="highlight-div"><div _ngcontent-jbo-c106="" class="highlight-div-header"><div _ngcontent-jbo-c106="" class="highlight-div-header-left"><div _ngcontent-jbo-c106="" class="handle-button expand-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jbo-c106="" class="highlight-div-header-right"><div _ngcontent-jbo-c106="" class="handle-button ai-button"></div><div _ngcontent-jbo-c106="" class="handle-button line-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jbo-c106="" class="handle-button theme-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jbo-c106="" class="handle-button copy-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jbo-c106="" class="highlight-scroll-div"><pre class="shell prettyprint linenums hljs language-shell" id="ZH-CN_TOPIC_0000002506226433__screen1426537548100314" hw-language="shell" data-highlighted="yes"><ol class="linenums"><li>  hdc shell aa test -b xxx -m xxx -s unittest OpenHarmonyTestRunner -s stress 1000</li></ol></pre></div></div> <ul id="ZH-CN_TOPIC_0000002506226433__ul1547121133100314"><li id="li9716745100314">查看测试结果</li></ul> <ol id="ZH-CN_TOPIC_0000002506226433__ol499434054100314"><li id="li398954255100314">在命令行模式执行过程中，框架会打印如下日志信息。<div _ngcontent-jbo-c106="" class="highlight-div"><div _ngcontent-jbo-c106="" class="highlight-div-header"><div _ngcontent-jbo-c106="" class="highlight-div-header-left"><div _ngcontent-jbo-c106="" class="handle-button expand-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jbo-c106="" class="highlight-div-header-right"><div _ngcontent-jbo-c106="" class="handle-button ai-button"></div><div _ngcontent-jbo-c106="" class="handle-button line-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jbo-c106="" class="handle-button theme-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jbo-c106="" class="handle-button copy-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jbo-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" id="ZH-CN_TOPIC_0000002506226433__screen12170421100314" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-variable">OHOS_REPORT_STATUS</span>: <span class="hljs-keyword">class</span>=<span class="hljs-variable">ActsAbilityTest</span></li><li><span class="hljs-variable">OHOS_REPORT_STATUS</span>: <span class="hljs-title class_">current</span>=<span class="hljs-number">1</span></li><li><span class="hljs-variable">OHOS_REPORT_STATUS</span>: <span class="hljs-title class_">id</span>=<span class="hljs-variable">JS</span></li><li><span class="hljs-variable">OHOS_REPORT_STATUS</span>: <span class="hljs-title class_">numtests</span>=<span class="hljs-number">447</span></li><li><span class="hljs-variable">OHOS_REPORT_STATUS</span>: <span class="hljs-title class_">stream</span>=</li><li><span class="hljs-variable">OHOS_REPORT_STATUS</span>: <span class="hljs-title class_">test</span>=<span class="hljs-variable">testExample</span></li><li><span class="hljs-variable">OHOS_REPORT_STATUS_CODE</span>: <span class="hljs-number">1</span></li><li>
</li><li><span class="hljs-variable">OHOS_REPORT_STATUS</span>: <span class="hljs-keyword">class</span>=<span class="hljs-variable">ActsAbilityTest</span></li><li><span class="hljs-variable">OHOS_REPORT_STATUS</span>: <span class="hljs-title class_">current</span>=<span class="hljs-number">1</span></li><li><span class="hljs-variable">OHOS_REPORT_STATUS</span>: <span class="hljs-title class_">id</span>=<span class="hljs-variable">JS</span></li><li><span class="hljs-variable">OHOS_REPORT_STATUS</span>: <span class="hljs-title class_">numtests</span>=<span class="hljs-number">447</span></li><li><span class="hljs-variable">OHOS_REPORT_STATUS</span>: <span class="hljs-title class_">stream</span>=</li><li><span class="hljs-variable">OHOS_REPORT_STATUS</span>: <span class="hljs-title class_">test</span>=<span class="hljs-variable">testExample</span></li><li><span class="hljs-variable">OHOS_REPORT_STATUS_CODE</span>: <span class="hljs-number">0</span></li><li><span class="hljs-variable">OHOS_REPORT_STATUS</span>: <span class="hljs-title class_">consuming</span>=<span class="hljs-number">4</span></li></ol></pre></div></div>  <div class="tablenoborder"><div class="tbBox"><table id="table1556710730100314" class="layoutFixed idpTab"><thead><tr id="ZH-CN_TOPIC_0000002506226433__row502503168100314"><th align="left" class="cellrowborder" id="mcps1.3.9.32.1.2.1.3.1.1" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry1492688669100314p0">日志输出字段</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.9.32.1.2.1.3.1.2" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry1362522830100314p0">日志输出字段含义</p> </th> </tr> </thead> <tbody><tr id="ZH-CN_TOPIC_0000002506226433__row1445642570100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry879257923100314p0">OHOS_REPORT_SUM</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry1273027918100314p0">当前执行的测试套中用例总数。</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row1008025507100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry719771992100314p0">OHOS_REPORT_STATUS: class</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry788968919100314p0">当前执行用例所属测试套名称。</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row650857901100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry1255765200100314p0">OHOS_REPORT_STATUS: id</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry831271688100314p0">当前用例执行语言，默认JS。</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row1286091839100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry1108329643100314p0">OHOS_REPORT_STATUS: numtests</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry1792078935100314p0">当前测试包中测试用例总数。</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row1539474995100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry345647609100314p0">OHOS_REPORT_STATUS: stream</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry1064334691100314p0">当前用例发生错误时，记录错误信息。</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row895268273100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry1680015606100314p0">OHOS_REPORT_STATUS: test</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry1281462091100314p0">当前用例执行的it name。</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row1612238213100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry494017696100314p0">OHOS_REPORT_STATUS_CODE</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry1134942318100314p0">当前用例执行结果状态。1表示用例开始执行，0表示用例执行通过，-1表示用例执行报错，-2表示用例执行失败。</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row1760413304100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry2068528564100314p0">OHOS_REPORT_STATUS: consuming</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry1239618360100314p0">当前用例执行消耗的时长（ms）。</p> </td> </tr>  </tbody></table></div> </div> </li><li id="li765808470100314">命令行执行完成后，框架会打印如下相关日志信息。<div _ngcontent-jbo-c106="" class="highlight-div"><div _ngcontent-jbo-c106="" class="highlight-div-header"><div _ngcontent-jbo-c106="" class="highlight-div-header-left"><div _ngcontent-jbo-c106="" class="handle-button expand-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jbo-c106="" class="highlight-div-header-right"><div _ngcontent-jbo-c106="" class="handle-button ai-button"></div><div _ngcontent-jbo-c106="" class="handle-button line-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jbo-c106="" class="handle-button theme-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jbo-c106="" class="handle-button copy-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jbo-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" id="ZH-CN_TOPIC_0000002506226433__screen775196157100314" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-variable">OHOS_REPORT_RESULT</span>: <span class="hljs-title class_">stream</span>=<span class="hljs-variable">Tests</span> <span class="hljs-variable">run</span>: <span class="hljs-number">447</span>, <span class="hljs-variable">Failure</span>: <span class="hljs-number">0</span>, <span class="hljs-variable">Error</span>: <span class="hljs-number">1</span>, <span class="hljs-variable">Pass</span>: <span class="hljs-number">201</span>, <span class="hljs-variable">Ignore</span>: <span class="hljs-number">245</span></li><li><span class="hljs-variable">OHOS_REPORT_CODE</span>: <span class="hljs-number">0</span></li><li>
</li><li><span class="hljs-variable">OHOS_REPORT_RESULT</span>: <span class="hljs-title class_">breakOnError</span> <span class="hljs-title class_">model</span>, <span class="hljs-variable">Stopping</span> <span class="hljs-variable">whole</span> <span class="hljs-variable">test</span> <span class="hljs-variable">suite</span> <span class="hljs-keyword">if</span> <span class="hljs-variable">one</span> <span class="hljs-variable">specific</span> <span class="hljs-variable">test</span> <span class="hljs-keyword">case</span> <span class="hljs-variable">failed</span> <span class="hljs-variable">or</span> <span class="hljs-variable">error</span></li><li><span class="hljs-variable">OHOS_REPORT_STATUS</span>: <span class="hljs-title class_">taskconsuming</span>=<span class="hljs-number">16029</span></li></ol></pre></div></div>  <div class="tablenoborder"><div class="tbBox"><table id="table890019621100314" class="layoutFixed idpTab"><thead><tr id="ZH-CN_TOPIC_0000002506226433__row849407598100314"><th align="left" class="cellrowborder" id="mcps1.3.9.32.2.2.1.3.1.1" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry505999978100314p0">日志输出字段</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.9.32.2.2.1.3.1.2" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry1837439118100314p0">日志输出字段含义</p> </th> </tr> </thead> <tbody><tr id="ZH-CN_TOPIC_0000002506226433__row1689545051100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry556813355100314p0">run</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry1745682961100314p0">当前测试包用例总数。</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row205918243100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry1373889613100314p0">Failure</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry1556140223100314p0">当前测试失败用例数量。</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row783566298100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry203938015100314p0">Error</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry1855672691100314p0">当前执行用例发生错误用例数量。</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row1348378193100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry1129565778100314p0">Pass</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry2146252984100314p0">当前执行用例通过用例数量。</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row110750066100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry1239280956100314p0">Ignore</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry681127716100314p0">当前未执行用例数量。</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row1200632877100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry26730884100314p0">taskconsuming</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry367556818100314p0">执行当前测试用例总耗时（ms）。</p> </td> </tr>  </tbody></table></div> </div> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p id="ZH-CN_TOPIC_0000002506226433__p1090278120100314">当按照遇错即停方式执行时，用例发生错误时，注意查看Ignore字段以及错误中断时的提示信息。</p> </div></div></div> </li></ol> </div> <div class="tiledSection"><h2 id="单元测试框架能力使用说明">单元测试框架能力使用说明<i class="anchor-icon anchor-icon-link" anchorid="单元测试框架能力使用说明" tips="复制节点链接"></i></h2></div> <div class="tiledSection"><h3 id="基础流程能力" class="firsth2">基础流程能力<i class="anchor-icon anchor-icon-link" anchorid="基础流程能力" tips="复制节点链接"></i></h3><p id="ZH-CN_TOPIC_0000002506226433__p843678180100314">单元测试框架提供执行测试脚本所需的基础流程接口，开发者需要实现相关接口，框架侧在运行时通过基础流程接口识别测试用例，调度执行并汇总测试结果。当前支持的基础流程接口如下表所示：</p>  <div class="tablenoborder"><div class="tbBox"><table id="table1455674478100314" class="layoutFixed idpTab"><thead><tr id="ZH-CN_TOPIC_0000002506226433__row1715571718100314"><th align="left" class="cellrowborder" id="mcps1.3.11.3.1.3.1.1" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry91142914100314p0">接口名</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.11.3.1.3.1.2" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry194647040100314p0">功能说明</p> </th> </tr> </thead> <tbody><tr id="ZH-CN_TOPIC_0000002506226433__row284747481100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry1259981522100314p0">describe</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry185832551100314p0">定义一个测试套，测试套中可以定义多个测试用例函数，但不支持异步函数。</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row1497398267100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry1664901679100314p0">it</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry2066820119100314p0">定义一条测试用例。</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row559496242100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry251219424100314p0">beforeAll</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry2102840393100314p0">在测试套内定义一个预置条件，在所有测试用例开始前执行且仅执行一次。</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row1372855920100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry2045471375100314p0">beforeEach</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry285884799100314p0">在测试套内定义一个预置条件，在每条测试用例开始前执行，执行次数与it定义的测试用例数一致。</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row1458196780100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry355005239100314p0">afterEach</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry1526096705100314p0">在测试套内定义一个单元清理条件，在每条测试用例结束后执行，执行次数与it定义的测试用例数一致。</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row217242556100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry710978744100314p0">afterAll</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry351526298100314p0">在测试套内定义一个清理条件，在所有测试用例结束后执行且仅执行一次。</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row560767887100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry1268116146100314p0">beforeItSpecified</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__p1024853063100314">在测试套内定义一个单元预置条件，仅在指定测试用例开始前执行。</p> <p id="ZH-CN_TOPIC_0000002506226433__p536797461100314"><strong>说明</strong>：从@ohos/hypium 1.0.15版本开始支持。</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row1512133486100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry656888350100314p0">afterItSpecified</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__p36046195100314">在测试套内定义一个单元清理条件，仅在指定测试用例结束后执行。</p> <p id="ZH-CN_TOPIC_0000002506226433__p1766749188100314"><strong>说明</strong>：从@ohos/hypium 1.0.15版本开始支持。</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row146527751100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry1780288364100314p0">expect</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry801439588100314p0">支持bool类型判断等多种断言能力。</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row2078096705100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry732887034100314p0">xdescribe</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__p15717304100314">定义一个跳过的测试套，测试套中可以定义多个测试用例函数，但不支持异步函数。</p> <p id="ZH-CN_TOPIC_0000002506226433__p927028330100314"><strong>说明</strong>：从@ohos/hypium 1.0.17版本开始支持。</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row2067977078100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry394428269100314p0">xit</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__p608559640100314">定义一条跳过的测试用例。</p> <p id="ZH-CN_TOPIC_0000002506226433__p742909102100314"><strong>说明</strong>：从@ohos/hypium 1.0.17版本开始支持。</p> </td> </tr>  </tbody></table></div> </div> <p id="ZH-CN_TOPIC_0000002506226433__p323548946100314"><strong>示例代码1</strong>：beforeAll/beforeEach/afterEach/afterAll使用示例</p> <div _ngcontent-jbo-c106="" class="highlight-div"><div _ngcontent-jbo-c106="" class="highlight-div-header"><div _ngcontent-jbo-c106="" class="highlight-div-header-left"><div _ngcontent-jbo-c106="" class="handle-button expand-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jbo-c106="" class="highlight-div-header-right"><div _ngcontent-jbo-c106="" class="handle-button ai-button"></div><div _ngcontent-jbo-c106="" class="handle-button line-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jbo-c106="" class="handle-button theme-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jbo-c106="" class="handle-button copy-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jbo-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" id="ZH-CN_TOPIC_0000002506226433__screen2011462535100314" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { describe, beforeAll, beforeEach, afterEach, afterAll, it, expect, <span class="hljs-title class_">Level</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@ohos/hypium'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">exampleTest</span>(<span class="hljs-params"></span>) {</li><li>  </li><li>  <span class="hljs-title function_">describe</span>(<span class="hljs-string">'ExampleTest'</span>, <span class="hljs-function">() =&gt;</span>{</li><li>    <span class="hljs-keyword">let</span> testNumA : <span class="hljs-built_in">number</span> = <span class="hljs-number">1</span>;</li><li>    <span class="hljs-keyword">let</span> testNumB : <span class="hljs-built_in">number</span> = <span class="hljs-number">1</span>;</li><li>    </li><li>    <span class="hljs-title function_">beforeAll</span>(<span class="hljs-function">() =&gt;</span> {</li><li>      testNumA++;</li><li>    })</li><li>  </li><li>    <span class="hljs-title function_">beforeEach</span>(<span class="hljs-function">() =&gt;</span> {</li><li>      testNumA++;</li><li>      testNumB++;</li><li>    })</li><li> </li><li>    <span class="hljs-title function_">afterEach</span>(<span class="hljs-function">() =&gt;</span> {</li><li>      testNumA++;</li><li>    })</li><li>  </li><li>    <span class="hljs-title function_">afterAll</span>(<span class="hljs-function">() =&gt;</span> {</li><li>      <span class="hljs-title function_">expect</span>(testNumA).<span class="hljs-title function_">assertEqual</span>(<span class="hljs-number">5</span>);</li><li>    })</li><li>     </li><li>    <span class="hljs-title function_">it</span>(<span class="hljs-string">'testExampleA'</span>,<span class="hljs-title class_">Level</span>.<span class="hljs-property">LEVEL1</span>, <span class="hljs-keyword">async</span> (<span class="hljs-attr">done</span>: <span class="hljs-title class_">Function</span>) =&gt; {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"unitTest: testExampleA begin"</span>);</li><li>      <span class="hljs-title function_">expect</span>(testNumA).<span class="hljs-title function_">assertEqual</span>(<span class="hljs-number">3</span>);</li><li>      <span class="hljs-title function_">expect</span>(testNumB).<span class="hljs-title function_">assertEqual</span>(<span class="hljs-number">2</span>);</li><li>      <span class="hljs-title function_">done</span>();</li><li>    })</li><li>
</li><li>    <span class="hljs-title function_">it</span>(<span class="hljs-string">'testExampleB'</span>,<span class="hljs-title class_">Level</span>.<span class="hljs-property">LEVEL1</span>, <span class="hljs-keyword">async</span> (<span class="hljs-attr">done</span>: <span class="hljs-title class_">Function</span>) =&gt; {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"unitTest: testExampleB begin"</span>);</li><li>      <span class="hljs-title function_">expect</span>(testNumA).<span class="hljs-title function_">assertEqual</span>(<span class="hljs-number">5</span>);</li><li>      <span class="hljs-title function_">expect</span>(testNumB).<span class="hljs-title function_">assertEqual</span>(<span class="hljs-number">3</span>);</li><li>      <span class="hljs-title function_">done</span>();</li><li>    })</li><li>  })</li><li>}</li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002506226433__p1356571695100314"><strong>示例代码2</strong>：beforeItSpecified/afterItSpecified使用示例，从1.0.15版本开始支持</p> <div _ngcontent-jbo-c106="" class="highlight-div"><div _ngcontent-jbo-c106="" class="highlight-div-header"><div _ngcontent-jbo-c106="" class="highlight-div-header-left"><div _ngcontent-jbo-c106="" class="handle-button expand-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jbo-c106="" class="highlight-div-header-right"><div _ngcontent-jbo-c106="" class="handle-button ai-button"></div><div _ngcontent-jbo-c106="" class="handle-button line-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jbo-c106="" class="handle-button theme-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jbo-c106="" class="handle-button copy-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jbo-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" id="ZH-CN_TOPIC_0000002506226433__screen1774894990100314" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { describe, beforeItSpecified, afterItSpecified, it, expect, <span class="hljs-title class_">Level</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@ohos/hypium'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">exampleTest</span>(<span class="hljs-params"></span>) {</li><li>    </li><li>  <span class="hljs-title function_">describe</span>(<span class="hljs-string">'ExampleTest'</span>, <span class="hljs-function">() =&gt;</span>{</li><li>   <span class="hljs-keyword">let</span> testNumA : <span class="hljs-built_in">number</span> = <span class="hljs-number">1</span>;</li><li>   <span class="hljs-keyword">let</span> testNumB : <span class="hljs-built_in">number</span> = <span class="hljs-number">1</span>;</li><li>
</li><li>   <span class="hljs-title function_">beforeItSpecified</span>([<span class="hljs-string">'testExampleB'</span>], <span class="hljs-function">() =&gt;</span> {</li><li>      testNumB++;</li><li>    })</li><li>   <span class="hljs-title function_">afterItSpecified</span>([<span class="hljs-string">'testExampleA'</span>], <span class="hljs-function">() =&gt;</span> {</li><li>      testNumA++;</li><li>    })</li><li>      </li><li>    <span class="hljs-title function_">it</span>(<span class="hljs-string">'testExampleA'</span>,<span class="hljs-title class_">Level</span>.<span class="hljs-property">LEVEL1</span>, <span class="hljs-keyword">async</span> (<span class="hljs-attr">done</span>: <span class="hljs-title class_">Function</span>) =&gt; {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"unitTest: testExampleA begin"</span>);</li><li>      <span class="hljs-title function_">expect</span>(testNumA).<span class="hljs-title function_">assertEqual</span>(<span class="hljs-number">1</span>);</li><li>      <span class="hljs-title function_">expect</span>(testNumB).<span class="hljs-title function_">assertEqual</span>(<span class="hljs-number">1</span>);</li><li>      <span class="hljs-title function_">done</span>();</li><li>    })</li><li>
</li><li>    <span class="hljs-title function_">it</span>(<span class="hljs-string">'testExampleB'</span>,<span class="hljs-title class_">Level</span>.<span class="hljs-property">LEVEL1</span>, <span class="hljs-keyword">async</span> (<span class="hljs-attr">done</span>: <span class="hljs-title class_">Function</span>) =&gt; {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"unitTest: testExampleB begin"</span>);</li><li>      <span class="hljs-title function_">expect</span>(testNumA).<span class="hljs-title function_">assertEqual</span>(<span class="hljs-number">2</span>);</li><li>      <span class="hljs-title function_">expect</span>(testNumB).<span class="hljs-title function_">assertEqual</span>(<span class="hljs-number">2</span>);</li><li>      <span class="hljs-title function_">done</span>();</li><li>    })</li><li>  })</li><li>}</li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002506226433__p1143656182100314"><strong>示例代码3</strong>：xit使用示例，从1.0.17版本开始支持</p> <div _ngcontent-jbo-c106="" class="highlight-div"><div _ngcontent-jbo-c106="" class="highlight-div-header"><div _ngcontent-jbo-c106="" class="highlight-div-header-left"><div _ngcontent-jbo-c106="" class="handle-button expand-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jbo-c106="" class="highlight-div-header-right"><div _ngcontent-jbo-c106="" class="handle-button ai-button"></div><div _ngcontent-jbo-c106="" class="handle-button line-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jbo-c106="" class="handle-button theme-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jbo-c106="" class="handle-button copy-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jbo-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" id="ZH-CN_TOPIC_0000002506226433__screen928933921100314" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { describe, xit, it, <span class="hljs-title class_">Level</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@ohos/hypium'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">describeExampleTest</span>(<span class="hljs-params"></span>) {</li><li>  </li><li>  <span class="hljs-title function_">describe</span>(<span class="hljs-string">'ExampleTest'</span>, <span class="hljs-function">() =&gt;</span>{</li><li>    <span class="hljs-title function_">xit</span>(<span class="hljs-string">'testExampleA'</span>,<span class="hljs-title class_">Level</span>.<span class="hljs-property">LEVEL1</span>, <span class="hljs-keyword">async</span> (<span class="hljs-attr">done</span>: <span class="hljs-title class_">Function</span>) =&gt; {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"unitTest: testExampleA begin"</span>);</li><li>      <span class="hljs-title function_">done</span>();</li><li>    })</li><li>
</li><li>    <span class="hljs-title function_">it</span>(<span class="hljs-string">'testExampleB'</span>,<span class="hljs-title class_">Level</span>.<span class="hljs-property">LEVEL1</span>, <span class="hljs-keyword">async</span> (<span class="hljs-attr">done</span>: <span class="hljs-title class_">Function</span>) =&gt; {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"unitTest: testExampleB begin"</span>);</li><li>      <span class="hljs-title function_">done</span>();</li><li>    })</li><li>  })</li><li>}</li></ol></pre></div></div> </div> <div class="tiledSection"><h3 id="断言能力">断言能力<i class="anchor-icon anchor-icon-link" anchorid="断言能力" tips="复制节点链接"></i></h3><p id="ZH-CN_TOPIC_0000002506226433__p896678074100314">单元测试框架提供了丰富的断言接口，供开发者在不同测试场景下使用，详细接口可查看下表。</p>  <div class="tablenoborder"><div class="tbBox"><table id="table154825305100314" class="layoutFixed idpTab"><thead><tr id="ZH-CN_TOPIC_0000002506226433__row96566927100314"><th align="left" class="cellrowborder" id="mcps1.3.12.3.1.3.1.1" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry1612522614100314p0">接口名</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.12.3.1.3.1.2" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry705263595100314p0">功能说明</p> </th> </tr> </thead> <tbody><tr id="ZH-CN_TOPIC_0000002506226433__row1877847629100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry247085684100314p0">assertClose</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry977987295100314p0">检验实际值和预期值之间的数值差异是否在指定的允许误差范围内。</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row1742818537100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry1704638669100314p0">assertContain</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry228135139100314p0">检验实际值中是否包含预期值。</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row1344144318100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry108431660100314p0">assertEqual</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry926290874100314p0">检验实际值是否等于预期值。</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row630731062100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry174208859100314p0">assertFail</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry894148539100314p0">抛出一个错误。</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row1249715238100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry893333033100314p0">assertFalse</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry2100428906100314p0">检验实际值是否是false。</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row307192952100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry1212056602100314p0">assertTrue</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry287620562100314p0">检验实际值是否是true。</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row1141056112100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry1983048963100314p0">assertInstanceOf</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry833074030100314p0">检验实际值是否是预期类型，支持基础类型。</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row223458803100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry798920103100314p0">assertLarger</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry524575299100314p0">检验实际值是否大于预期值。</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row1142093712100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry341033284100314p0">assertLargerOrEqual</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry1658509727100314p0">检验实际值是否大于或等于预期值。</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row1005888178100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry1549087868100314p0">assertLess</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry1639499617100314p0">检验实际值是否小于预期值。</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row180630934100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry1512131038100314p0">assertLessOrEqual</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry977516778100314p0">检验实际值是否小于或等于预期值。</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row1103075046100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry337560651100314p0">assertNull</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry549184470100314p0">检验实际值是否是null。</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row2144402167100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry568685629100314p0">assertThrowError</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry831659667100314p0">检验实际值抛出Error内容是否为预期的异常类型。</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row1126403208100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry1636481502100314p0">assertUndefined</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry1676358938100314p0">检验实际值是否是undefined。</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row142850090100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry583749189100314p0">assertNaN</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__p740690560100314">检验实际值是否是NaN。</p> <p id="ZH-CN_TOPIC_0000002506226433__p1530788780100314"><strong>说明</strong>：从@ohos/hypium 1.0.4版本开始支持。</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row1496130696100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry1121967799100314p0">assertNegUnlimited</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__p1701142317100314">检验实际值是否等于Number.NEGATIVE_INFINITY。</p> <p id="ZH-CN_TOPIC_0000002506226433__p1496175724100314"><strong>说明</strong>：从@ohos/hypium 1.0.4版本开始支持。</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row213651680100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry110141696100314p0">assertPosUnlimited</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__p347436631100314">检验实际值是否等于Number.POSITIVE_INFINITY。</p> <p id="ZH-CN_TOPIC_0000002506226433__p894804392100314"><strong>说明</strong>：从@ohos/hypium 1.0.4版本开始支持。</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row1690488577100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry1634793573100314p0">assertDeepEquals</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__p146882401100314">检验实际值和预期值是否完全相等。</p> <p id="ZH-CN_TOPIC_0000002506226433__p339067426100314"><strong>说明</strong>：从@ohos/hypium 1.0.4版本开始支持。</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row1844477328100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry173851041100314p0">assertPromiseIsPending</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__p698579031100314">检验Promise是否处于Pending状态。</p> <p id="ZH-CN_TOPIC_0000002506226433__p1154252858100314"><strong>说明</strong>：从@ohos/hypium 1.0.4版本开始支持。</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row803403394100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry1648643658100314p0">assertPromiseIsRejected</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__p1289272384100314">检验Promise是否处于Rejected状态。</p> <p id="ZH-CN_TOPIC_0000002506226433__p1730466495100314"><strong>说明</strong>：从@ohos/hypium 1.0.4版本开始支持。</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row330976791100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry792646460100314p0">assertPromiseIsRejectedWith</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__p1127433114100314">检验Promise是否处于Rejected状态，并且比较执行的结果值。</p> <p id="ZH-CN_TOPIC_0000002506226433__p1516560847100314"><strong>说明</strong>：从@ohos/hypium 1.0.4版本开始支持。</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row1262715711100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry1899822035100314p0">assertPromiseIsRejectedWithError</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__p1700504101100314">检验Promise是否处于Rejected状态并包含异常，比较异常类型和异常信息。</p> <p id="ZH-CN_TOPIC_0000002506226433__p1087011287100314"><strong>说明</strong>：从@ohos/hypium 1.0.4版本开始支持。</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row1728759549100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry1073247031100314p0">assertPromiseIsResolved</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__p1693669233100314">检验Promise是否处于Resolved状态。</p> <p id="ZH-CN_TOPIC_0000002506226433__p2063150008100314"><strong>说明</strong>：从@ohos/hypium 1.0.4版本开始支持。</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row2003918209100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry1859853774100314p0">assertPromiseIsResolvedWith</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__p876953068100314">检验Promise是否处于Resolved状态并比较结果值。</p> <p id="ZH-CN_TOPIC_0000002506226433__p379301646100314"><strong>说明</strong>：从@ohos/hypium 1.0.4版本开始支持。</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row551792675100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry899059985100314p0">not</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__p38870123100314">断言取反，支持上述所有断言功能。</p> <p id="ZH-CN_TOPIC_0000002506226433__p1749387242100314"><strong>说明</strong>：从@ohos/hypium 1.0.4版本开始支持。</p> </td> </tr>  </tbody></table></div> </div> <p id="ZH-CN_TOPIC_0000002506226433__p476598415100314"><strong>示例代码</strong>：</p> <div _ngcontent-jbo-c106="" class="highlight-div"><div _ngcontent-jbo-c106="" class="highlight-div-header"><div _ngcontent-jbo-c106="" class="highlight-div-header-left"><div _ngcontent-jbo-c106="" class="handle-button expand-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jbo-c106="" class="highlight-div-header-right"><div _ngcontent-jbo-c106="" class="handle-button ai-button"></div><div _ngcontent-jbo-c106="" class="handle-button line-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jbo-c106="" class="handle-button theme-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jbo-c106="" class="handle-button copy-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jbo-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" id="ZH-CN_TOPIC_0000002506226433__screen1614018609100314" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { describe, it, expect, <span class="hljs-title class_">Level</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@ohos/hypium'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">exampleTest</span>(<span class="hljs-params"></span>) {</li><li>  <span class="hljs-title function_">describe</span>(<span class="hljs-string">'ExampleTest'</span>, <span class="hljs-function">() =&gt;</span>{</li><li>    <span class="hljs-title function_">it</span>(<span class="hljs-string">'assertCloseTest'</span>, <span class="hljs-title class_">Level</span>.<span class="hljs-property">LEVEL1</span>, <span class="hljs-function">() =&gt;</span> {</li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">a</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">100</span>;</li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">b</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0.1</span>;</li><li>      <span class="hljs-title function_">expect</span>(a).<span class="hljs-title function_">assertClose</span>(<span class="hljs-number">99</span>, b);</li><li>    })</li><li>
</li><li>    <span class="hljs-title function_">it</span>(<span class="hljs-string">'assertContain_1'</span>, <span class="hljs-title class_">Level</span>.<span class="hljs-property">LEVEL1</span>, <span class="hljs-function">() =&gt;</span> {</li><li>      <span class="hljs-keyword">let</span> a = <span class="hljs-string">"abc"</span>;</li><li>      <span class="hljs-title function_">expect</span>(a).<span class="hljs-title function_">assertContain</span>(<span class="hljs-string">'b'</span>);</li><li>    })</li><li>
</li><li>    <span class="hljs-title function_">it</span>(<span class="hljs-string">'assertContain_2'</span>, <span class="hljs-title class_">Level</span>.<span class="hljs-property">LEVEL1</span>, <span class="hljs-function">() =&gt;</span> {</li><li>      <span class="hljs-keyword">let</span> a = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>];</li><li>      <span class="hljs-title function_">expect</span>(a).<span class="hljs-title function_">assertContain</span>(<span class="hljs-number">1</span>);</li><li>    })</li><li>
</li><li>    <span class="hljs-title function_">it</span>(<span class="hljs-string">'assertEqualTest'</span>, <span class="hljs-title class_">Level</span>.<span class="hljs-property">LEVEL1</span>, <span class="hljs-function">() =&gt;</span> {</li><li>      <span class="hljs-title function_">expect</span>(<span class="hljs-number">3</span>).<span class="hljs-title function_">assertEqual</span>(<span class="hljs-number">3</span>);</li><li>    })</li><li>
</li><li>    <span class="hljs-title function_">it</span>(<span class="hljs-string">'assertFailTest'</span>, <span class="hljs-title class_">Level</span>.<span class="hljs-property">LEVEL1</span>, <span class="hljs-function">() =&gt;</span> {</li><li>      <span class="hljs-title function_">expect</span>().<span class="hljs-title function_">assertFail</span>(); <span class="hljs-comment">// 用例失败</span></li><li>    })</li><li>
</li><li>    <span class="hljs-title function_">it</span>(<span class="hljs-string">'assertFalseTest'</span>, <span class="hljs-title class_">Level</span>.<span class="hljs-property">LEVEL1</span>, <span class="hljs-function">() =&gt;</span> {</li><li>      <span class="hljs-title function_">expect</span>(<span class="hljs-literal">false</span>).<span class="hljs-title function_">assertFalse</span>();</li><li>    })</li><li>
</li><li>    <span class="hljs-title function_">it</span>(<span class="hljs-string">'assertTrueTest'</span>, <span class="hljs-title class_">Level</span>.<span class="hljs-property">LEVEL1</span>, <span class="hljs-function">() =&gt;</span> {</li><li>      <span class="hljs-title function_">expect</span>(<span class="hljs-literal">true</span>).<span class="hljs-title function_">assertTrue</span>();</li><li>    })</li><li>
</li><li>    <span class="hljs-title function_">it</span>(<span class="hljs-string">'assertInstanceOfTest'</span>, <span class="hljs-title class_">Level</span>.<span class="hljs-property">LEVEL1</span>, <span class="hljs-function">() =&gt;</span> {</li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">a</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'strTest'</span>;</li><li>      <span class="hljs-title function_">expect</span>(a).<span class="hljs-title function_">assertInstanceOf</span>(<span class="hljs-string">'String'</span>);</li><li>    })</li><li>
</li><li>    <span class="hljs-title function_">it</span>(<span class="hljs-string">'assertLargerTest'</span>, <span class="hljs-title class_">Level</span>.<span class="hljs-property">LEVEL1</span>, <span class="hljs-function">() =&gt;</span> {</li><li>      <span class="hljs-title function_">expect</span>(<span class="hljs-number">3</span>).<span class="hljs-title function_">assertLarger</span>(<span class="hljs-number">2</span>);</li><li>    })</li><li>
</li><li>    <span class="hljs-title function_">it</span>(<span class="hljs-string">'assertLessTest'</span>, <span class="hljs-title class_">Level</span>.<span class="hljs-property">LEVEL1</span>, <span class="hljs-function">() =&gt;</span> {</li><li>      <span class="hljs-title function_">expect</span>(<span class="hljs-number">2</span>).<span class="hljs-title function_">assertLess</span>(<span class="hljs-number">3</span>);</li><li>    })</li><li>
</li><li>    <span class="hljs-title function_">it</span>(<span class="hljs-string">'assertNullTest'</span>, <span class="hljs-title class_">Level</span>.<span class="hljs-property">LEVEL1</span>, <span class="hljs-function">() =&gt;</span> {</li><li>      <span class="hljs-title function_">expect</span>(<span class="hljs-literal">null</span>).<span class="hljs-title function_">assertNull</span>();</li><li>    })</li><li>
</li><li>    <span class="hljs-title function_">it</span>(<span class="hljs-string">'assertThrowErrorTest'</span>, <span class="hljs-title class_">Level</span>.<span class="hljs-property">LEVEL1</span>, <span class="hljs-function">() =&gt;</span> {</li><li>      <span class="hljs-title function_">expect</span>(<span class="hljs-function">() =&gt;</span> {</li><li>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'test'</span>);</li><li>      }).<span class="hljs-title function_">assertThrowError</span>(<span class="hljs-string">'test'</span>);</li><li>    })</li><li>
</li><li>    <span class="hljs-title function_">it</span>(<span class="hljs-string">'assertUndefinedTest'</span>, <span class="hljs-title class_">Level</span>.<span class="hljs-property">LEVEL1</span>, <span class="hljs-function">() =&gt;</span> {</li><li>      <span class="hljs-title function_">expect</span>(<span class="hljs-literal">undefined</span>).<span class="hljs-title function_">assertUndefined</span>();</li><li>    })</li><li>
</li><li>    <span class="hljs-title function_">it</span>(<span class="hljs-string">'assertLargerOrEqualTest'</span>, <span class="hljs-title class_">Level</span>.<span class="hljs-property">LEVEL1</span>, <span class="hljs-function">() =&gt;</span> {</li><li>      <span class="hljs-title function_">expect</span>(<span class="hljs-number">3</span>).<span class="hljs-title function_">assertLargerOrEqual</span>(<span class="hljs-number">3</span>);</li><li>    })</li><li>
</li><li>    <span class="hljs-title function_">it</span>(<span class="hljs-string">'assertLessOrEqualTest'</span>, <span class="hljs-title class_">Level</span>.<span class="hljs-property">LEVEL1</span>, <span class="hljs-function">() =&gt;</span> {</li><li>      <span class="hljs-title function_">expect</span>(<span class="hljs-number">3</span>).<span class="hljs-title function_">assertLessOrEqual</span>(<span class="hljs-number">3</span>);</li><li>    })</li><li>
</li><li>    <span class="hljs-title function_">it</span>(<span class="hljs-string">'assertNaNTest'</span>, <span class="hljs-title class_">Level</span>.<span class="hljs-property">LEVEL1</span>, <span class="hljs-function">() =&gt;</span> {</li><li>      <span class="hljs-title function_">expect</span>(<span class="hljs-title class_">Number</span>.<span class="hljs-property">NaN</span>).<span class="hljs-title function_">assertNaN</span>(); <span class="hljs-comment">// true</span></li><li>    })</li><li>
</li><li>    <span class="hljs-title function_">it</span>(<span class="hljs-string">'assertNegUnlimitedTest'</span>, <span class="hljs-title class_">Level</span>.<span class="hljs-property">LEVEL1</span>, <span class="hljs-function">() =&gt;</span> {</li><li>      <span class="hljs-title function_">expect</span>(<span class="hljs-title class_">Number</span>.<span class="hljs-property">NEGATIVE_INFINITY</span>).<span class="hljs-title function_">assertNegUnlimited</span>(); <span class="hljs-comment">// true</span></li><li>    })</li><li>
</li><li>    <span class="hljs-title function_">it</span>(<span class="hljs-string">'assertPosUnlimitedTest'</span>, <span class="hljs-title class_">Level</span>.<span class="hljs-property">LEVEL1</span>, <span class="hljs-function">() =&gt;</span> {</li><li>      <span class="hljs-title function_">expect</span>(<span class="hljs-title class_">Number</span>.<span class="hljs-property">POSITIVE_INFINITY</span>).<span class="hljs-title function_">assertPosUnlimited</span>(); <span class="hljs-comment">// true</span></li><li>    })</li><li>
</li><li>    <span class="hljs-title function_">it</span>(<span class="hljs-string">'deepEquals_null_true'</span>, <span class="hljs-title class_">Level</span>.<span class="hljs-property">LEVEL1</span>, <span class="hljs-function">() =&gt;</span> {</li><li>      <span class="hljs-title function_">expect</span>(<span class="hljs-literal">null</span>).<span class="hljs-title function_">assertDeepEquals</span>(<span class="hljs-literal">null</span>);</li><li>    })</li><li>
</li><li>    <span class="hljs-title function_">it</span>(<span class="hljs-string">'deepEquals_array_not_have_true'</span>, <span class="hljs-title class_">Level</span>.<span class="hljs-property">LEVEL1</span>, <span class="hljs-function">() =&gt;</span> {</li><li>      <span class="hljs-keyword">const</span> <span class="hljs-attr">a</span>: <span class="hljs-title class_">Array</span>&lt;<span class="hljs-built_in">number</span>&gt; = [];</li><li>      <span class="hljs-keyword">const</span> <span class="hljs-attr">b</span>: <span class="hljs-title class_">Array</span>&lt;<span class="hljs-built_in">number</span>&gt; = [];</li><li>      <span class="hljs-title function_">expect</span>(a).<span class="hljs-title function_">assertDeepEquals</span>(b);</li><li>    })</li><li>
</li><li>    <span class="hljs-title function_">it</span>(<span class="hljs-string">'deepEquals_map_equal_length_success'</span>, <span class="hljs-title class_">Level</span>.<span class="hljs-property">LEVEL1</span>, <span class="hljs-function">() =&gt;</span> {</li><li>      <span class="hljs-keyword">const</span> <span class="hljs-attr">a</span>: <span class="hljs-title class_">Map</span>&lt;<span class="hljs-built_in">number</span>, <span class="hljs-built_in">number</span>&gt; = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();</li><li>      <span class="hljs-keyword">const</span> <span class="hljs-attr">b</span>: <span class="hljs-title class_">Map</span>&lt;<span class="hljs-built_in">number</span>, <span class="hljs-built_in">number</span>&gt; = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();</li><li>      a.<span class="hljs-title function_">set</span>(<span class="hljs-number">1</span>, <span class="hljs-number">100</span>);</li><li>      a.<span class="hljs-title function_">set</span>(<span class="hljs-number">2</span>, <span class="hljs-number">200</span>);</li><li>      b.<span class="hljs-title function_">set</span>(<span class="hljs-number">1</span>, <span class="hljs-number">100</span>);</li><li>      b.<span class="hljs-title function_">set</span>(<span class="hljs-number">2</span>, <span class="hljs-number">200</span>);</li><li>      <span class="hljs-title function_">expect</span>(a).<span class="hljs-title function_">assertDeepEquals</span>(b);</li><li>    })</li><li>
</li><li>    <span class="hljs-title function_">it</span>(<span class="hljs-string">"deepEquals_obj_success_1"</span>, <span class="hljs-title class_">Level</span>.<span class="hljs-property">LEVEL1</span>, <span class="hljs-function">() =&gt;</span> {</li><li>      <span class="hljs-keyword">const</span> <span class="hljs-attr">a</span>: <span class="hljs-title class_">SampleTest</span> = {<span class="hljs-attr">x</span>: <span class="hljs-number">1</span>};</li><li>      <span class="hljs-keyword">const</span> <span class="hljs-attr">b</span>: <span class="hljs-title class_">SampleTest</span> = {<span class="hljs-attr">x</span>: <span class="hljs-number">1</span>};</li><li>      <span class="hljs-title function_">expect</span>(a).<span class="hljs-title function_">assertDeepEquals</span>(b);</li><li>    })</li><li>
</li><li>    <span class="hljs-title function_">it</span>(<span class="hljs-string">"deepEquals_regExp_success_0"</span>, <span class="hljs-title class_">Level</span>.<span class="hljs-property">LEVEL1</span>, <span class="hljs-function">() =&gt;</span> {</li><li>      <span class="hljs-keyword">const</span> <span class="hljs-attr">a</span>: <span class="hljs-title class_">RegExp</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">RegExp</span>(<span class="hljs-string">"/test/"</span>);</li><li>      <span class="hljs-keyword">const</span> <span class="hljs-attr">b</span>: <span class="hljs-title class_">RegExp</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">RegExp</span>(<span class="hljs-string">"/test/"</span>);</li><li>      <span class="hljs-title function_">expect</span>(a).<span class="hljs-title function_">assertDeepEquals</span>(b);</li><li>    })</li><li>
</li><li>    <span class="hljs-title function_">it</span>(<span class="hljs-string">'assertPromiseIsPendingTest'</span>, <span class="hljs-title class_">Level</span>.<span class="hljs-property">LEVEL1</span>, <span class="hljs-keyword">async</span> () =&gt; {</li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">p</span>: <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt;(<span class="hljs-function">() =&gt;</span> {});</li><li>      <span class="hljs-keyword">await</span> <span class="hljs-title function_">expect</span>(p).<span class="hljs-title function_">assertPromiseIsPending</span>();</li><li>    })</li><li>
</li><li>    <span class="hljs-title function_">it</span>(<span class="hljs-string">'assertPromiseIsRejectedTest'</span>, <span class="hljs-title class_">Level</span>.<span class="hljs-property">LEVEL1</span>, <span class="hljs-keyword">async</span> () =&gt; {</li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">info</span>: <span class="hljs-title class_">PromiseInfo</span> = {<span class="hljs-attr">res</span>: <span class="hljs-string">"no"</span>};</li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">p</span>: <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">PromiseInfo</span>&gt; = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(info);</li><li>      <span class="hljs-keyword">await</span> <span class="hljs-title function_">expect</span>(p).<span class="hljs-title function_">assertPromiseIsRejected</span>();</li><li>    })</li><li>
</li><li>    <span class="hljs-title function_">it</span>(<span class="hljs-string">'assertPromiseIsRejectedWithTest'</span>, <span class="hljs-title class_">Level</span>.<span class="hljs-property">LEVEL1</span>, <span class="hljs-keyword">async</span> () =&gt; {</li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">info</span>: <span class="hljs-title class_">PromiseInfo</span> = {<span class="hljs-attr">res</span>: <span class="hljs-string">"reject value"</span>};</li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">p</span>: <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">PromiseInfo</span>&gt; = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(info);</li><li>      <span class="hljs-keyword">await</span> <span class="hljs-title function_">expect</span>(p).<span class="hljs-title function_">assertPromiseIsRejectedWith</span>(info);</li><li>    })</li><li>
</li><li>    <span class="hljs-title function_">it</span>(<span class="hljs-string">'assertPromiseIsRejectedWithErrorTest'</span>, <span class="hljs-title class_">Level</span>.<span class="hljs-property">LEVEL1</span>, <span class="hljs-keyword">async</span> () =&gt; {</li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">p1</span>: <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">TypeError</span>&gt; = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">reject</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeError</span>(<span class="hljs-string">'number'</span>));</li><li>      <span class="hljs-keyword">await</span> <span class="hljs-title function_">expect</span>(p1).<span class="hljs-title function_">assertPromiseIsRejectedWithError</span>(<span class="hljs-title class_">TypeError</span>);</li><li>    })</li><li>    </li><li>    <span class="hljs-title function_">it</span>(<span class="hljs-string">'assertPromiseIsResolvedTest'</span>, <span class="hljs-title class_">Level</span>.<span class="hljs-property">LEVEL1</span>, <span class="hljs-keyword">async</span> () =&gt; {</li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">info</span>: <span class="hljs-title class_">PromiseInfo</span> = {<span class="hljs-attr">res</span>: <span class="hljs-string">"result value"</span>};</li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">p</span>: <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">PromiseInfo</span>&gt; = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(info);</li><li>      <span class="hljs-keyword">await</span> <span class="hljs-title function_">expect</span>(p).<span class="hljs-title function_">assertPromiseIsResolved</span>();</li><li>    })</li><li>
</li><li>    <span class="hljs-title function_">it</span>(<span class="hljs-string">'assertPromiseIsResolvedWithTest'</span>, <span class="hljs-title class_">Level</span>.<span class="hljs-property">LEVEL1</span>, <span class="hljs-keyword">async</span> () =&gt; {</li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">info</span>: <span class="hljs-title class_">PromiseInfo</span> = {<span class="hljs-attr">res</span>: <span class="hljs-string">"result value"</span>};</li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">p</span>: <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">PromiseInfo</span>&gt; = <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>(info);</li><li>      <span class="hljs-keyword">await</span> <span class="hljs-title function_">expect</span>(p).<span class="hljs-title function_">assertPromiseIsResolvedWith</span>(info);</li><li>    })</li><li>
</li><li>    <span class="hljs-title function_">it</span>(<span class="hljs-string">"test_message"</span>, <span class="hljs-title class_">Level</span>.<span class="hljs-property">LEVEL1</span>, <span class="hljs-function">() =&gt;</span> {</li><li>      <span class="hljs-title function_">expect</span>(<span class="hljs-number">1</span>).<span class="hljs-title function_">message</span>(<span class="hljs-string">'1 is not equal 2!'</span>).<span class="hljs-title function_">assertEqual</span>(<span class="hljs-number">2</span>); <span class="hljs-comment">// fail</span></li><li>    })</li><li>  })</li><li>}</li><li>
</li><li><span class="hljs-keyword">interface</span> <span class="hljs-title class_">SampleTest</span> {</li><li>  <span class="hljs-attr">x</span>: <span class="hljs-built_in">number</span>;</li><li>}</li><li>
</li><li><span class="hljs-keyword">interface</span> <span class="hljs-title class_">PromiseInfo</span> {</li><li>  <span class="hljs-attr">res</span>: <span class="hljs-built_in">string</span>;</li><li>}</li></ol></pre></div></div> </div> <div class="tiledSection"><h3 id="mock能力">Mock能力<i class="anchor-icon anchor-icon-link" anchorid="mock能力" tips="复制节点链接"></i></h3><p id="ZH-CN_TOPIC_0000002506226433__p1133357512100314">从@ohos/hypium 1.0.1版本开始，单元测试框架支持Mock能力。配置方式参考上文<a href="/consumer/cn/doc/harmonyos-guides/unittest-guidelines#单元测试框架发布方式">发布方式</a>。</p> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p id="ZH-CN_TOPIC_0000002506226433__p1808622134100314">仅支持Mock应用工程中自定义对象，不支持Mock系统API对象。如需Mock系统API，请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-test-mock#section8353132513310" target="_blank">系统模块Mock指南</a>。</p> <p id="ZH-CN_TOPIC_0000002506226433__p1727816946100314">不支持Mock对象的私有函数。</p> </div></div></div> <p id="ZH-CN_TOPIC_0000002506226433__p30508543100314"><strong>基础类</strong></p> <p id="ZH-CN_TOPIC_0000002506226433__p404754544100314">Mockit是Mock的基础类，用于指定需要Mock的实例和函数。</p>  <div class="tablenoborder"><div class="tbBox"><table id="table1827924269100314" class="layoutFixed idpTab"><thead><tr id="ZH-CN_TOPIC_0000002506226433__row1052770941100314"><th align="left" class="cellrowborder" id="mcps1.3.13.6.1.3.1.1" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry1478140991100314p0">接口名</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.13.6.1.3.1.2" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry1650345168100314p0">功能说明</p> </th> </tr> </thead> <tbody><tr id="ZH-CN_TOPIC_0000002506226433__row1606895005100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry1336930929100314p0">mockFunc</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry1900085039100314p0">Mock某个类实例中的函数，支持使用异步函数。</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row616756133100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry847982909100314p0">verify</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry634583412100314p0">验证函数在对应参数下的执行行为是否符合预期，返回一个VerificationMode类。</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row2111287443100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry431594708100314p0">ignoreMock</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry1308901605100314p0">使用ignoreMock可以还原实例中被Mock后的函数，对被Mock后的函数有效。</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row1528647860100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry1724647590100314p0">clear</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry1033318394100314p0">用例执行完毕后，对被Mock对象实例进行还原处理（还原之后对象恢复被Mock之前的功能）。</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row171040773100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry469549646100314p0">clearAll</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry1641077738100314p0">用例执行完毕后，进行数据和内存清理，不会还原实例中被Mock后的函数。</p> </td> </tr>  </tbody></table></div> </div> <p id="ZH-CN_TOPIC_0000002506226433__p427257453100314"><strong>VerificationMode</strong></p> <p id="ZH-CN_TOPIC_0000002506226433__p586571846100314">VerificationMode用于验证被Mock函数的被调用次数，需同verify函数结合使用。</p>  <div class="tablenoborder"><div class="tbBox"><table id="table2108873674100314" class="layoutFixed idpTab"><thead><tr id="ZH-CN_TOPIC_0000002506226433__row1045775096100314"><th align="left" class="cellrowborder" id="mcps1.3.13.9.1.3.1.1" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry1725988598100314p0">接口名</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.13.9.1.3.1.2" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry850966704100314p0">功能说明</p> </th> </tr> </thead> <tbody><tr id="ZH-CN_TOPIC_0000002506226433__row946594652100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry1331802585100314p0">times</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry1007637488100314p0">验证函数被调用过的次数符合预期。</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row431270909100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry1926259617100314p0">once</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry649909792100314p0">验证函数被调用过一次。</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row1800916958100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry1847774354100314p0">atLeast</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry1872200710100314p0">验证函数最少被调用的次数符合预期。</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row1121292950100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry339327590100314p0">atMost</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry564692890100314p0">验证函数最多被调用的次数符合预期。</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row380930311100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry1008320417100314p0">never</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry689950705100314p0">验证函数从未被调用过。</p> </td> </tr>  </tbody></table></div> </div> <p id="ZH-CN_TOPIC_0000002506226433__p1791285000100314"><strong>when</strong></p> <p id="ZH-CN_TOPIC_0000002506226433__p807636543100314">when是一个函数，用于设置函数期望被Mock的值。</p>  <div class="tablenoborder"><div class="tbBox"><table id="table1127251604100314" class="layoutFixed idpTab"><thead><tr id="ZH-CN_TOPIC_0000002506226433__row809948628100314"><th align="left" class="cellrowborder" id="mcps1.3.13.12.1.3.1.1" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry1149708062100314p0">接口名</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.13.12.1.3.1.2" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry619242125100314p0">功能说明</p> </th> </tr> </thead> <tbody><tr id="ZH-CN_TOPIC_0000002506226433__row1574574375100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry1044735131100314p0">when</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry1351476239100314p0">对传入后函数做检查，检查是否被Mock并标记过，返回一个内置函数，函数执行后返回一个类用于设置Mock值。</p> </td> </tr>  </tbody></table></div> </div> <p id="ZH-CN_TOPIC_0000002506226433__p1214716573100314">使用when函数之后，需使用如下函数设置函数被Mock后的返回值。</p>  <div class="tablenoborder"><div class="tbBox"><table id="table578237804100314" class="layoutFixed idpTab"><thead><tr id="ZH-CN_TOPIC_0000002506226433__row1623196564100314"><th align="left" class="cellrowborder" id="mcps1.3.13.14.1.3.1.1" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry1441401830100314p0">接口名</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.13.14.1.3.1.2" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry1927743033100314p0">功能说明</p> </th> </tr> </thead> <tbody><tr id="ZH-CN_TOPIC_0000002506226433__row1723066096100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry741339857100314p0">afterReturn</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry762970974100314p0">设定一个自定义的期望返回值，比如某个字符串或者一个Promise。</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row132988236100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry1572818089100314p0">afterReturnNothing</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry1265481740100314p0">设定预期没有返回值，即undefined。</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row49885565100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry885586637100314p0">afterAction</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry278806483100314p0">设定预期返回一个函数执行的操作。</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row684331343100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry650842719100314p0">afterThrow</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry540634057100314p0">设定预期抛出异常，并指定异常描述信息。</p> </td> </tr>  </tbody></table></div> </div> <p id="ZH-CN_TOPIC_0000002506226433__p648478301100314"><strong>ArgumentMatchers相关接口</strong></p> <p id="ZH-CN_TOPIC_0000002506226433__p236623711100314">ArgumentMatchers用于用户自定义函数参数，当开发者想基于某类规则设定预期返回值时，可以使用。它以枚举值或函数的形式提供给开发者使用。</p>  <div class="tablenoborder"><div class="tbBox"><table id="table1073506984100314" class="layoutFixed idpTab"><thead><tr id="ZH-CN_TOPIC_0000002506226433__row908155470100314"><th align="left" class="cellrowborder" id="mcps1.3.13.17.1.3.1.1" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry2110026197100314p0">枚举名</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.13.17.1.3.1.2" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry225478171100314p0">功能说明</p> </th> </tr> </thead> <tbody><tr id="ZH-CN_TOPIC_0000002506226433__row922537586100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry1060488936100314p0">any</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry1173532526100314p0">设定用户传任何类型参数（undefined和null除外），执行的结果返回所设置的预期值，使用ArgumentMatchers.any方式调用。</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row79622199100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry1311977791100314p0">anyString</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry1619948015100314p0">设定用户传任何字符串参数，执行的结果都是预期的值，使用ArgumentMatchers.anyString方式调用。</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row1152350991100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry159008252100314p0">anyBoolean</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry427645947100314p0">设定用户传任何boolean类型参数，执行的结果都是预期的值，使用ArgumentMatchers.anyBoolean方式调用。</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row2101073991100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry627718689100314p0">anyFunction</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry1499937287100314p0">设定用户传任何function类型参数，执行的结果都是预期的值，使用ArgumentMatchers.anyFunction方式调用。</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row250785480100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry3720269100314p0">anyNumber</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry1929727126100314p0">设定用户传任何数字类型参数，执行的结果都是预期的值，使用ArgumentMatchers.anyNumber方式调用。</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row784761650100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry901282476100314p0">anyObj</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry1432721561100314p0">设定用户传任何对象类型参数，执行的结果都是预期的值，使用ArgumentMatchers.anyObj方式调用。</p> </td> </tr>  </tbody></table></div> </div>  <div class="tablenoborder"><div class="tbBox"><table id="table968568902100314" class="layoutFixed idpTab"><thead><tr id="ZH-CN_TOPIC_0000002506226433__row247418200100314"><th align="left" class="cellrowborder" id="mcps1.3.13.18.1.3.1.1" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry947768962100314p0">接口名</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.13.18.1.3.1.2" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry287388878100314p0">功能说明</p> </th> </tr> </thead> <tbody><tr id="ZH-CN_TOPIC_0000002506226433__row1257476016100314"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry1382831460100314p0">matchRegexs</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002506226433__entry2051334881100314p0">设定用户传任何符合正则表达式验证的参数，执行的结果都是预期的值，使用ArgumentMatchers.matchRegexs(Regex)方式调用。</p> </td> </tr>  </tbody></table></div> </div> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p id="ZH-CN_TOPIC_0000002506226433__p750254221100314">使用Mock能力时必须导入Mock能力模块： MockKit，when，开发者可根据实际需求导入对应模块。</p> <p id="ZH-CN_TOPIC_0000002506226433__p437131910100314">例如：import { describe, expect, it, MockKit, when} from '@ohos/hypium'</p> </div></div></div> <p id="ZH-CN_TOPIC_0000002506226433__p1635236824100314"><strong>示例代码1</strong>：使用afterReturn/afterReturnNothing设置预期返回值</p> <div _ngcontent-jbo-c106="" class="highlight-div"><div _ngcontent-jbo-c106="" class="highlight-div-header"><div _ngcontent-jbo-c106="" class="highlight-div-header-left"><div _ngcontent-jbo-c106="" class="handle-button expand-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jbo-c106="" class="highlight-div-header-right"><div _ngcontent-jbo-c106="" class="handle-button ai-button"></div><div _ngcontent-jbo-c106="" class="handle-button line-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jbo-c106="" class="handle-button theme-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jbo-c106="" class="handle-button copy-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jbo-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" id="ZH-CN_TOPIC_0000002506226433__screen1341399054100314" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { describe, expect, it, <span class="hljs-title class_">MockKit</span>, when } <span class="hljs-keyword">from</span> <span class="hljs-string">'@ohos/hypium'</span>;</li><li>
</li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">ClassName</span> {</li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) {</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">method_1</span>(<span class="hljs-params">arg: <span class="hljs-built_in">string</span></span>) {</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-string">'888888'</span>;</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">method_2</span>(<span class="hljs-params">arg: <span class="hljs-built_in">string</span></span>) {</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-string">'999999'</span>;</li><li>  }</li><li>}</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">afterReturnTest</span>(<span class="hljs-params"></span>) {</li><li>  <span class="hljs-title function_">describe</span>(<span class="hljs-string">'afterReturnTest'</span>, <span class="hljs-function">() =&gt;</span> {</li><li>    <span class="hljs-title function_">it</span>(<span class="hljs-string">'afterReturnTest'</span>, <span class="hljs-number">0</span>, <span class="hljs-function">() =&gt;</span> {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"it1 begin"</span>);</li><li>      <span class="hljs-comment">// 创建一个Mock能力的对象MockKit</span></li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">mocker</span>: <span class="hljs-title class_">MockKit</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MockKit</span>();</li><li>      <span class="hljs-comment">// 初始化ClassName的对象claser，作为被Mock的对象实例</span></li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">claser</span>: <span class="hljs-title class_">ClassName</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ClassName</span>();</li><li>      <span class="hljs-comment">// 进行Mock操作，对ClassName类的method_1函数进行Mock</span></li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">mockfunc</span>: <span class="hljs-title class_">Function</span> = mocker.<span class="hljs-title function_">mockFunc</span>(claser, claser.<span class="hljs-property">method_1</span>);</li><li>      <span class="hljs-comment">// 期望claser.method_1函数被Mock后, 以'testA'为入参时调用函数返回结果'1',以'testB''为入参时调用函数返回结果undefined</span></li><li>      <span class="hljs-title function_">when</span>(mockfunc)(<span class="hljs-string">'testA'</span>).<span class="hljs-title function_">afterReturn</span>(<span class="hljs-string">'1'</span>);</li><li>      <span class="hljs-title function_">when</span>(mockfunc)(<span class="hljs-string">'testB'</span>).<span class="hljs-title function_">afterReturnNothing</span>();</li><li>      <span class="hljs-comment">// 对Mock后的函数进行断言，看是否符合预期。分别传入参数'testA'和'testB'时，应该返回自定义的预期结果1和undefined</span></li><li>      <span class="hljs-title function_">expect</span>(claser.<span class="hljs-title function_">method_1</span>(<span class="hljs-string">'testA'</span>)).<span class="hljs-title function_">assertEqual</span>(<span class="hljs-string">'1'</span>); <span class="hljs-comment">// 断言执行通过</span></li><li>      <span class="hljs-title function_">expect</span>(claser.<span class="hljs-title function_">method_1</span>(<span class="hljs-string">'testB'</span>)).<span class="hljs-title function_">assertUndefined</span>(); <span class="hljs-comment">// 断言执行通过</span></li><li>    })</li><li>  })</li><li>}</li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002506226433__p1958646281100314"><strong>示例代码2</strong>：使用ArgumentMatchers设定参数类型为any即接受任何参数（undefined和null除外）</p> <div _ngcontent-jbo-c106="" class="highlight-div"><div _ngcontent-jbo-c106="" class="highlight-div-header"><div _ngcontent-jbo-c106="" class="highlight-div-header-left"><div _ngcontent-jbo-c106="" class="handle-button expand-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jbo-c106="" class="highlight-div-header-right"><div _ngcontent-jbo-c106="" class="handle-button ai-button"></div><div _ngcontent-jbo-c106="" class="handle-button line-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jbo-c106="" class="handle-button theme-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jbo-c106="" class="handle-button copy-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jbo-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" id="ZH-CN_TOPIC_0000002506226433__screen33754648100314" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { describe, expect, it, <span class="hljs-title class_">MockKit</span>, when, <span class="hljs-title class_">ArgumentMatchers</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@ohos/hypium'</span>;</li><li>
</li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">ClassName</span> {</li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) {</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">method_1</span>(<span class="hljs-params">arg: <span class="hljs-built_in">string</span></span>) {</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-string">'888888'</span>;</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">method_2</span>(<span class="hljs-params">arg: <span class="hljs-built_in">string</span></span>) {</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-string">'999999'</span>;</li><li>  }</li><li>}</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">argumentMatchersAnyTest</span>(<span class="hljs-params"></span>) {</li><li>  <span class="hljs-title function_">describe</span>(<span class="hljs-string">'argumentMatchersAnyTest'</span>, <span class="hljs-function">() =&gt;</span> {</li><li>    <span class="hljs-title function_">it</span>(<span class="hljs-string">'testMockfunc'</span>, <span class="hljs-number">0</span>, <span class="hljs-function">() =&gt;</span> {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"it1 begin"</span>);</li><li>      <span class="hljs-comment">// 创建一个Mock能力的对象MockKit</span></li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">mocker</span>: <span class="hljs-title class_">MockKit</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MockKit</span>();</li><li>      <span class="hljs-comment">// 初始化ClassName的对象claser</span></li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">claser</span>: <span class="hljs-title class_">ClassName</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ClassName</span>();</li><li>      <span class="hljs-comment">// 进行Mock操作，对ClassName类的method_1函数进行Mock</span></li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">mockfunc</span>: <span class="hljs-title class_">Function</span> = mocker.<span class="hljs-title function_">mockFunc</span>(claser, claser.<span class="hljs-property">method_1</span>);</li><li>      <span class="hljs-comment">// 期望claser.method_1函数被Mock后, 参数为任一类型在被调用时均返回结果'1'</span></li><li>      <span class="hljs-title function_">when</span>(mockfunc)(<span class="hljs-title class_">ArgumentMatchers</span>.<span class="hljs-property">any</span>).<span class="hljs-title function_">afterReturn</span>(<span class="hljs-string">'1'</span>);</li><li>      <span class="hljs-comment">// 传入不同参数验证是否符合预期</span></li><li>      <span class="hljs-title function_">expect</span>(claser.<span class="hljs-title function_">method_1</span>(<span class="hljs-string">'test'</span>)).<span class="hljs-title function_">assertEqual</span>(<span class="hljs-string">'1'</span>); <span class="hljs-comment">// 断言执行通过</span></li><li>      <span class="hljs-title function_">expect</span>(claser.<span class="hljs-title function_">method_1</span>(<span class="hljs-string">"123"</span>)).<span class="hljs-title function_">assertEqual</span>(<span class="hljs-string">'1'</span>);<span class="hljs-comment">// 断言执行通过</span></li><li>      <span class="hljs-title function_">expect</span>(claser.<span class="hljs-title function_">method_1</span>(<span class="hljs-string">"true"</span>)).<span class="hljs-title function_">assertEqual</span>(<span class="hljs-string">'1'</span>);<span class="hljs-comment">// 断言执行通过</span></li><li>    })</li><li>  })</li><li>}</li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002506226433__p1509044703100314"><strong>示例代码3</strong>：使用ArgumentMatchers设定参数类型为String</p> <div _ngcontent-jbo-c106="" class="highlight-div"><div _ngcontent-jbo-c106="" class="highlight-div-header"><div _ngcontent-jbo-c106="" class="highlight-div-header-left"><div _ngcontent-jbo-c106="" class="handle-button expand-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jbo-c106="" class="highlight-div-header-right"><div _ngcontent-jbo-c106="" class="handle-button ai-button"></div><div _ngcontent-jbo-c106="" class="handle-button line-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jbo-c106="" class="handle-button theme-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jbo-c106="" class="handle-button copy-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jbo-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" id="ZH-CN_TOPIC_0000002506226433__screen1377970998100314" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { describe, expect, it, <span class="hljs-title class_">MockKit</span>, when, <span class="hljs-title class_">ArgumentMatchers</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@ohos/hypium'</span>;</li><li>
</li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">ClassName</span> {</li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) {</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">method_1</span>(<span class="hljs-params">arg: <span class="hljs-built_in">string</span></span>) {</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-string">'888888'</span>;</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">method_2</span>(<span class="hljs-params">arg: <span class="hljs-built_in">string</span></span>) {</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-string">'999999'</span>;</li><li>  }</li><li>}</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">argumentMatchersTest</span>(<span class="hljs-params"></span>) {</li><li>  <span class="hljs-title function_">describe</span>(<span class="hljs-string">'argumentMatchersTest'</span>, <span class="hljs-function">() =&gt;</span> {</li><li>    <span class="hljs-title function_">it</span>(<span class="hljs-string">'testMockfunc'</span>, <span class="hljs-number">0</span>, <span class="hljs-function">() =&gt;</span> {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"it1 begin"</span>);</li><li>      <span class="hljs-comment">// 创建一个Mock能力的对象MockKit</span></li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">mocker</span>: <span class="hljs-title class_">MockKit</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MockKit</span>();</li><li>      <span class="hljs-comment">// 初始化ClassName的对象claser</span></li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">claser</span>: <span class="hljs-title class_">ClassName</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ClassName</span>();</li><li>      <span class="hljs-comment">// 进行Mock操作,对ClassName类的method_1函数进行Mock</span></li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">mockfunc</span>: <span class="hljs-title class_">Function</span> = mocker.<span class="hljs-title function_">mockFunc</span>(claser, claser.<span class="hljs-property">method_1</span>);</li><li>      <span class="hljs-comment">// 期望claser.method_1函数被Mock后, 以任何string类型为参数调用函数时返回结果'1'</span></li><li>      <span class="hljs-title function_">when</span>(mockfunc)(<span class="hljs-title class_">ArgumentMatchers</span>.<span class="hljs-property">anyString</span>).<span class="hljs-title function_">afterReturn</span>(<span class="hljs-string">'1'</span>);</li><li>      <span class="hljs-comment">// 传入不同string类型参数，验证是否符合预期</span></li><li>      <span class="hljs-title function_">expect</span>(claser.<span class="hljs-title function_">method_1</span>(<span class="hljs-string">'test'</span>)).<span class="hljs-title function_">assertEqual</span>(<span class="hljs-string">'1'</span>); <span class="hljs-comment">// 断言执行通过</span></li><li>      <span class="hljs-title function_">expect</span>(claser.<span class="hljs-title function_">method_1</span>(<span class="hljs-string">'abc'</span>)).<span class="hljs-title function_">assertEqual</span>(<span class="hljs-string">'1'</span>); <span class="hljs-comment">// 断言执行通过</span></li><li>    })</li><li>  })</li><li>}</li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002506226433__p811380067100314"><strong>示例代码4</strong>：使用ArgumentMatchers设定参数类型为matchRegexs（Regex）即正则表达式</p> <div _ngcontent-jbo-c106="" class="highlight-div"><div _ngcontent-jbo-c106="" class="highlight-div-header"><div _ngcontent-jbo-c106="" class="highlight-div-header-left"><div _ngcontent-jbo-c106="" class="handle-button expand-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jbo-c106="" class="highlight-div-header-right"><div _ngcontent-jbo-c106="" class="handle-button ai-button"></div><div _ngcontent-jbo-c106="" class="handle-button line-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jbo-c106="" class="handle-button theme-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jbo-c106="" class="handle-button copy-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jbo-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" id="ZH-CN_TOPIC_0000002506226433__screen97974542100314" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { describe, expect, it, <span class="hljs-title class_">MockKit</span>, when, <span class="hljs-title class_">ArgumentMatchers</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@ohos/hypium'</span>;</li><li>
</li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">ClassName</span> {</li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) {</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">method_1</span>(<span class="hljs-params">arg: <span class="hljs-built_in">string</span></span>) {</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-string">'888888'</span>;</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">method_2</span>(<span class="hljs-params">arg: <span class="hljs-built_in">string</span></span>) {</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-string">'999999'</span>;</li><li>  }</li><li>}</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">matchRegexsTest</span>(<span class="hljs-params"></span>) {</li><li>  <span class="hljs-title function_">describe</span>(<span class="hljs-string">'matchRegexsTest'</span>, <span class="hljs-function">() =&gt;</span> {</li><li>    <span class="hljs-title function_">it</span>(<span class="hljs-string">'testMockfunc'</span>, <span class="hljs-number">0</span>, <span class="hljs-function">() =&gt;</span> {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"it1 begin"</span>);</li><li>      <span class="hljs-comment">// 创建一个Mock能力的对象MockKit</span></li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">mocker</span>: <span class="hljs-title class_">MockKit</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MockKit</span>();</li><li>      <span class="hljs-comment">// 初始化ClassName的对象claser</span></li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">claser</span>: <span class="hljs-title class_">ClassName</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ClassName</span>();</li><li>      <span class="hljs-comment">// 进行Mock操作，对ClassName类的method_1函数进行Mock</span></li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">mockfunc</span>: <span class="hljs-title class_">Function</span> = mocker.<span class="hljs-title function_">mockFunc</span>(claser, claser.<span class="hljs-property">method_1</span>);</li><li>      <span class="hljs-comment">// 期望claser.method_1函数被Mock后, 以"test"为入参调用函数时返回结果'1'</span></li><li>      <span class="hljs-title function_">when</span>(mockfunc)(<span class="hljs-title class_">ArgumentMatchers</span>.<span class="hljs-title function_">matchRegexs</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">RegExp</span>(<span class="hljs-string">"test"</span>))).<span class="hljs-title function_">afterReturn</span>(<span class="hljs-string">'1'</span>);</li><li>      <span class="hljs-comment">// 传入test参数后验证是否符合预期</span></li><li>      <span class="hljs-title function_">expect</span>(claser.<span class="hljs-title function_">method_1</span>(<span class="hljs-string">'test'</span>)).<span class="hljs-title function_">assertEqual</span>(<span class="hljs-string">'1'</span>); <span class="hljs-comment">// 断言执行通过</span></li><li>    })</li><li>  })</li><li>}</li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002506226433__p425211633100314"><strong>示例代码5</strong>：使用verify函数验证被Mock函数在对应参数下的执行行为是否符合预期</p> <div _ngcontent-jbo-c106="" class="highlight-div"><div _ngcontent-jbo-c106="" class="highlight-div-header"><div _ngcontent-jbo-c106="" class="highlight-div-header-left"><div _ngcontent-jbo-c106="" class="handle-button expand-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jbo-c106="" class="highlight-div-header-right"><div _ngcontent-jbo-c106="" class="handle-button ai-button"></div><div _ngcontent-jbo-c106="" class="handle-button line-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jbo-c106="" class="handle-button theme-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jbo-c106="" class="handle-button copy-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jbo-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" id="ZH-CN_TOPIC_0000002506226433__screen1100192620100314" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { describe, it, <span class="hljs-title class_">MockKit</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@ohos/hypium'</span>;</li><li>
</li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">ClassName</span> {</li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) {</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">method_1</span>(<span class="hljs-params">...arg: <span class="hljs-built_in">string</span>[]</span>) {</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-string">'888888'</span>;</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">method_2</span>(<span class="hljs-params">...arg: <span class="hljs-built_in">string</span>[]</span>) {</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-string">'999999'</span>;</li><li>  }</li><li>}</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">verifyTest</span>(<span class="hljs-params"></span>) {</li><li>  <span class="hljs-title function_">describe</span>(<span class="hljs-string">'verifyTest'</span>, <span class="hljs-function">() =&gt;</span> {</li><li>    <span class="hljs-title function_">it</span>(<span class="hljs-string">'testMockfunc'</span>, <span class="hljs-number">0</span>, <span class="hljs-function">() =&gt;</span> {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"it1 begin"</span>);</li><li>      <span class="hljs-comment">// 创建一个Mock能力的对象MockKit</span></li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">mocker</span>: <span class="hljs-title class_">MockKit</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MockKit</span>();</li><li>      <span class="hljs-comment">// 初始化ClassName的对象claser</span></li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">claser</span>: <span class="hljs-title class_">ClassName</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ClassName</span>();</li><li>      <span class="hljs-comment">// 进行Mock操作，对ClassName类的method_1和method_2两个函数进行Mock</span></li><li>      mocker.<span class="hljs-title function_">mockFunc</span>(claser, claser.<span class="hljs-property">method_1</span>);</li><li>      mocker.<span class="hljs-title function_">mockFunc</span>(claser, claser.<span class="hljs-property">method_2</span>);</li><li>      <span class="hljs-comment">// 函数调用</span></li><li>      claser.<span class="hljs-title function_">method_1</span>(<span class="hljs-string">'abc'</span>, <span class="hljs-string">'ppp'</span>);</li><li>      claser.<span class="hljs-title function_">method_1</span>(<span class="hljs-string">'abc'</span>);</li><li>      claser.<span class="hljs-title function_">method_1</span>(<span class="hljs-string">'xyz'</span>);</li><li>      claser.<span class="hljs-title function_">method_1</span>();</li><li>      claser.<span class="hljs-title function_">method_1</span>(<span class="hljs-string">'abc'</span>, <span class="hljs-string">'xxx'</span>, <span class="hljs-string">'yyy'</span>);</li><li>      claser.<span class="hljs-title function_">method_1</span>();</li><li>      claser.<span class="hljs-title function_">method_2</span>(<span class="hljs-string">'111'</span>);</li><li>      claser.<span class="hljs-title function_">method_2</span>(<span class="hljs-string">'111'</span>, <span class="hljs-string">'222'</span>);</li><li>      <span class="hljs-comment">// 对Mock后的两个函数进行验证，验证method_2,参数仅为'111'时执行过一次</span></li><li>      mocker.<span class="hljs-title function_">verify</span>(<span class="hljs-string">'method_2'</span>,[<span class="hljs-string">'111'</span>]).<span class="hljs-title function_">once</span>(); <span class="hljs-comment">// 断言执行通过</span></li><li>    })</li><li>  })</li><li>}</li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002506226433__p675366589100314"><strong>示例代码6</strong>：使用ignoreMock函数还原指定被Mock函数实现</p> <div _ngcontent-jbo-c106="" class="highlight-div"><div _ngcontent-jbo-c106="" class="highlight-div-header"><div _ngcontent-jbo-c106="" class="highlight-div-header-left"><div _ngcontent-jbo-c106="" class="handle-button expand-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jbo-c106="" class="highlight-div-header-right"><div _ngcontent-jbo-c106="" class="handle-button ai-button"></div><div _ngcontent-jbo-c106="" class="handle-button line-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jbo-c106="" class="handle-button theme-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jbo-c106="" class="handle-button copy-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jbo-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" id="ZH-CN_TOPIC_0000002506226433__screen576862520100314" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { describe, expect, it, <span class="hljs-title class_">MockKit</span>, when, <span class="hljs-title class_">ArgumentMatchers</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@ohos/hypium'</span>;</li><li>
</li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">ClassName</span> {</li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) {</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">method_1</span>(<span class="hljs-params">...arg: <span class="hljs-built_in">number</span>[]</span>) {</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-string">'888888'</span>;</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">method_2</span>(<span class="hljs-params">...arg: <span class="hljs-built_in">number</span>[]</span>) {</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-string">'999999'</span>;</li><li>  }</li><li>}</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">ignoreMockTest</span>(<span class="hljs-params"></span>) {</li><li>  <span class="hljs-title function_">describe</span>(<span class="hljs-string">'ignoreMockTest'</span>, <span class="hljs-function">() =&gt;</span> {</li><li>    <span class="hljs-title function_">it</span>(<span class="hljs-string">'testMockfunc'</span>, <span class="hljs-number">0</span>, <span class="hljs-function">() =&gt;</span> {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"it1 begin"</span>);</li><li>      <span class="hljs-comment">// 创建一个Mock能力的对象MockKit</span></li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">mocker</span>: <span class="hljs-title class_">MockKit</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MockKit</span>();</li><li>      <span class="hljs-comment">// 初始化ClassName的对象claser</span></li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">claser</span>: <span class="hljs-title class_">ClassName</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ClassName</span>();</li><li>      <span class="hljs-comment">// 进行Mock操作，对ClassName类的method_1和method_2两个函数进行Mock</span></li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">func_1</span>: <span class="hljs-title class_">Function</span> = mocker.<span class="hljs-title function_">mockFunc</span>(claser, claser.<span class="hljs-property">method_1</span>);</li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">func_2</span>: <span class="hljs-title class_">Function</span> = mocker.<span class="hljs-title function_">mockFunc</span>(claser, claser.<span class="hljs-property">method_2</span>);</li><li>      <span class="hljs-comment">// 期望claser.method_1函数被Mock后, 以number类型为入参时调用函数返回结果'4'</span></li><li>      <span class="hljs-title function_">when</span>(func_1)(<span class="hljs-title class_">ArgumentMatchers</span>.<span class="hljs-property">anyNumber</span>).<span class="hljs-title function_">afterReturn</span>(<span class="hljs-string">'4'</span>);</li><li>      <span class="hljs-comment">// 期望claser.method_2函数被Mock后, 以number类型为入参时调用函数返回结果'5'</span></li><li>      <span class="hljs-title function_">when</span>(func_2)(<span class="hljs-title class_">ArgumentMatchers</span>.<span class="hljs-property">anyNumber</span>).<span class="hljs-title function_">afterReturn</span>(<span class="hljs-string">'5'</span>);</li><li>      <span class="hljs-comment">// 函数调用</span></li><li>      <span class="hljs-title function_">expect</span>(claser.<span class="hljs-title function_">method_1</span>(<span class="hljs-number">123</span>)).<span class="hljs-title function_">assertEqual</span>(<span class="hljs-string">"4"</span>);</li><li>      <span class="hljs-title function_">expect</span>(claser.<span class="hljs-title function_">method_2</span>(<span class="hljs-number">456</span>)).<span class="hljs-title function_">assertEqual</span>(<span class="hljs-string">"5"</span>);</li><li>      <span class="hljs-comment">// 现在对Mock后的两个函数的其中一个函数method_1进行还原处理</span></li><li>      mocker.<span class="hljs-title function_">ignoreMock</span>(claser, claser.<span class="hljs-property">method_1</span>);</li><li>      <span class="hljs-comment">// 调用claser.method_1函数</span></li><li>      <span class="hljs-title function_">expect</span>(claser.<span class="hljs-title function_">method_1</span>(<span class="hljs-number">123</span>)).<span class="hljs-title function_">assertEqual</span>(<span class="hljs-string">'888888'</span>);<span class="hljs-comment">// 断言执行通过</span></li><li>    })</li><li>  })</li><li>}</li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002506226433__p331268987100314"><strong>示例代码7</strong>：使用clear函数还原类中所有被Mock函数原有实现</p> <div _ngcontent-jbo-c106="" class="highlight-div"><div _ngcontent-jbo-c106="" class="highlight-div-header"><div _ngcontent-jbo-c106="" class="highlight-div-header-left"><div _ngcontent-jbo-c106="" class="handle-button expand-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jbo-c106="" class="highlight-div-header-right"><div _ngcontent-jbo-c106="" class="handle-button ai-button"></div><div _ngcontent-jbo-c106="" class="handle-button line-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jbo-c106="" class="handle-button theme-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jbo-c106="" class="handle-button copy-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jbo-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" id="ZH-CN_TOPIC_0000002506226433__screen1677478164100314" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { describe, expect, it, <span class="hljs-title class_">MockKit</span>, when, <span class="hljs-title class_">ArgumentMatchers</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@ohos/hypium'</span>;</li><li>
</li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">ClassName</span> {</li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) {</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">method_1</span>(<span class="hljs-params">...arg: <span class="hljs-built_in">number</span>[]</span>) {</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-string">'888888'</span>;</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">method_2</span>(<span class="hljs-params">...arg: <span class="hljs-built_in">number</span>[]</span>) {</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-string">'999999'</span>;</li><li>  }</li><li>}</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">clearTest</span>(<span class="hljs-params"></span>) {</li><li>  <span class="hljs-title function_">describe</span>(<span class="hljs-string">'clearTest'</span>, <span class="hljs-function">() =&gt;</span> {</li><li>    <span class="hljs-title function_">it</span>(<span class="hljs-string">'testMockfunc'</span>, <span class="hljs-number">0</span>, <span class="hljs-function">() =&gt;</span> {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"it1 begin"</span>);</li><li>      <span class="hljs-comment">// 创建一个Mock能力的对象MockKit</span></li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">mocker</span>: <span class="hljs-title class_">MockKit</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MockKit</span>();</li><li>      <span class="hljs-comment">// 初始化ClassName的对象claser</span></li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">claser</span>: <span class="hljs-title class_">ClassName</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ClassName</span>();</li><li>      <span class="hljs-comment">// 进行Mock操作，对ClassName类的method_1和method_2两个函数进行Mock</span></li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">func_1</span>: <span class="hljs-title class_">Function</span> = mocker.<span class="hljs-title function_">mockFunc</span>(claser, claser.<span class="hljs-property">method_1</span>);</li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">func_2</span>: <span class="hljs-title class_">Function</span> = mocker.<span class="hljs-title function_">mockFunc</span>(claser, claser.<span class="hljs-property">method_2</span>);</li><li>      <span class="hljs-comment">// 期望claser.method_1函数被Mock后, 以任何number类型为参数调用函数时返回结果'4'</span></li><li>      <span class="hljs-title function_">when</span>(func_1)(<span class="hljs-title class_">ArgumentMatchers</span>.<span class="hljs-property">anyNumber</span>).<span class="hljs-title function_">afterReturn</span>(<span class="hljs-string">'4'</span>);</li><li>      <span class="hljs-comment">// 期望claser.method_2函数被Mock后, 以任何number类型为参数调用函数时返回结果'5'</span></li><li>      <span class="hljs-title function_">when</span>(func_2)(<span class="hljs-title class_">ArgumentMatchers</span>.<span class="hljs-property">anyNumber</span>).<span class="hljs-title function_">afterReturn</span>(<span class="hljs-string">'5'</span>);</li><li>      <span class="hljs-comment">// 函数调用</span></li><li>      <span class="hljs-title function_">expect</span>(claser.<span class="hljs-title function_">method_1</span>(<span class="hljs-number">123</span>)).<span class="hljs-title function_">assertEqual</span>(<span class="hljs-string">'4'</span>);</li><li>      <span class="hljs-title function_">expect</span>(claser.<span class="hljs-title function_">method_2</span>(<span class="hljs-number">123</span>)).<span class="hljs-title function_">assertEqual</span>(<span class="hljs-string">'5'</span>);</li><li>      <span class="hljs-comment">// 还原obj上所有的Mock能力</span></li><li>      mocker.<span class="hljs-title function_">clear</span>(claser);</li><li>      <span class="hljs-comment">// 调用claser.method_1,claser.method_2函数，测试结果</span></li><li>      <span class="hljs-title function_">expect</span>(claser.<span class="hljs-title function_">method_1</span>(<span class="hljs-number">123</span>)).<span class="hljs-title function_">assertEqual</span>(<span class="hljs-string">'888888'</span>);<span class="hljs-comment">// 断言执行通过</span></li><li>      <span class="hljs-title function_">expect</span>(claser.<span class="hljs-title function_">method_2</span>(<span class="hljs-number">123</span>)).<span class="hljs-title function_">assertEqual</span>(<span class="hljs-string">'999999'</span>);<span class="hljs-comment">// 断言执行通过</span></li><li>    })</li><li>  })</li><li>}</li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002506226433__p954516461100314"><strong>示例代码8</strong>：使用afterThrow函数抛出指定异常信息</p> <div _ngcontent-jbo-c106="" class="highlight-div"><div _ngcontent-jbo-c106="" class="highlight-div-header"><div _ngcontent-jbo-c106="" class="highlight-div-header-left"><div _ngcontent-jbo-c106="" class="handle-button expand-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jbo-c106="" class="highlight-div-header-right"><div _ngcontent-jbo-c106="" class="handle-button ai-button"></div><div _ngcontent-jbo-c106="" class="handle-button line-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jbo-c106="" class="handle-button theme-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jbo-c106="" class="handle-button copy-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jbo-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" id="ZH-CN_TOPIC_0000002506226433__screen1811225495100314" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { describe, expect, it, <span class="hljs-title class_">MockKit</span>, when } <span class="hljs-keyword">from</span> <span class="hljs-string">'@ohos/hypium'</span>;</li><li>
</li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">ClassName</span> {</li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) {</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">method_1</span>(<span class="hljs-params">arg: <span class="hljs-built_in">string</span></span>) {</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-string">'888888'</span>;</li><li>  }</li><li>}</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">afterThrowTest</span>(<span class="hljs-params"></span>) {</li><li>  <span class="hljs-title function_">describe</span>(<span class="hljs-string">'afterThrowTest'</span>, <span class="hljs-function">() =&gt;</span> {</li><li>    <span class="hljs-title function_">it</span>(<span class="hljs-string">'testMockfunc'</span>, <span class="hljs-number">0</span>, <span class="hljs-function">() =&gt;</span> {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"it1 begin"</span>);</li><li>      <span class="hljs-comment">// 创建一个Mock能力的对象MockKit</span></li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">mocker</span>: <span class="hljs-title class_">MockKit</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MockKit</span>();</li><li>      <span class="hljs-comment">// 初始化ClassName的对象claser</span></li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">claser</span>: <span class="hljs-title class_">ClassName</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ClassName</span>();</li><li>      <span class="hljs-comment">// 进行Mock操作,对ClassName类的method_1函数进行Mock</span></li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">mockfunc</span>: <span class="hljs-title class_">Function</span> = mocker.<span class="hljs-title function_">mockFunc</span>(claser, claser.<span class="hljs-property">method_1</span>);</li><li>      <span class="hljs-comment">// 期望claser.method_1函数被Mock后, 以'test'为参数调用函数时抛出error xxx异常</span></li><li>      <span class="hljs-title function_">when</span>(mockfunc)(<span class="hljs-string">'test'</span>).<span class="hljs-title function_">afterThrow</span>(<span class="hljs-string">'error xxx'</span>);</li><li>      <span class="hljs-comment">// 执行Mock后的函数，捕捉异常并使用assertEqual对比msg否符合预期</span></li><li>      <span class="hljs-keyword">try</span> {</li><li>        claser.<span class="hljs-title function_">method_1</span>(<span class="hljs-string">'test'</span>);</li><li>      } <span class="hljs-keyword">catch</span> (e) {</li><li>        <span class="hljs-title function_">expect</span>(e).<span class="hljs-title function_">assertEqual</span>(<span class="hljs-string">'error xxx'</span>); <span class="hljs-comment">// 断言执行通过</span></li><li>      }</li><li>    })</li><li>  })</li><li>}</li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002506226433__p958006664100314"><strong>示例代码9</strong>：Mock异步返回Promise对象</p> <div _ngcontent-jbo-c106="" class="highlight-div"><div _ngcontent-jbo-c106="" class="highlight-div-header"><div _ngcontent-jbo-c106="" class="highlight-div-header-left"><div _ngcontent-jbo-c106="" class="handle-button expand-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jbo-c106="" class="highlight-div-header-right"><div _ngcontent-jbo-c106="" class="handle-button ai-button"></div><div _ngcontent-jbo-c106="" class="handle-button line-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jbo-c106="" class="handle-button theme-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jbo-c106="" class="handle-button copy-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jbo-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" id="ZH-CN_TOPIC_0000002506226433__screen1341151527100314" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { describe, expect, it, <span class="hljs-title class_">MockKit</span>, when } <span class="hljs-keyword">from</span> <span class="hljs-string">'@ohos/hypium'</span>;</li><li>
</li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">ClassName</span> {</li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) {</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">async</span> <span class="hljs-title function_">method_1</span>(<span class="hljs-params">arg: <span class="hljs-built_in">string</span></span>) {</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">string</span>&gt;(<span class="hljs-function">(<span class="hljs-params">resolve: <span class="hljs-built_in">Function</span>, reject: <span class="hljs-built_in">Function</span></span>) =&gt;</span> {</li><li>      <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'执行'</span>);</li><li>        <span class="hljs-title function_">resolve</span>(<span class="hljs-string">'数据传递'</span>);</li><li>      }, <span class="hljs-number">2000</span>);</li><li>    });</li><li>  }</li><li>}</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">mockPromiseTest</span>(<span class="hljs-params"></span>) {</li><li>  <span class="hljs-title function_">describe</span>(<span class="hljs-string">'mockPromiseTest'</span>, <span class="hljs-function">() =&gt;</span> {</li><li>    <span class="hljs-title function_">it</span>(<span class="hljs-string">'testMockfunc'</span>, <span class="hljs-number">0</span>, <span class="hljs-keyword">async</span> (<span class="hljs-attr">done</span>: <span class="hljs-title class_">Function</span>) =&gt; {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"it1 begin"</span>);</li><li>      <span class="hljs-comment">// 创建一个Mock能力的对象MockKit</span></li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">mocker</span>: <span class="hljs-title class_">MockKit</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MockKit</span>();</li><li>      <span class="hljs-comment">// 初始化ClassName的对象claser</span></li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">claser</span>: <span class="hljs-title class_">ClassName</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ClassName</span>();</li><li>      <span class="hljs-comment">// 进行Mock操作对ClassName类的method_1函数进行Mock</span></li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">mockfunc</span>: <span class="hljs-title class_">Function</span> = mocker.<span class="hljs-title function_">mockFunc</span>(claser, claser.<span class="hljs-property">method_1</span>);</li><li>      <span class="hljs-comment">// 期望claser.method_1函数被Mock后, 以'test'为参数调用函数时返回一个Promise对象</span></li><li>      <span class="hljs-title function_">when</span>(mockfunc)(<span class="hljs-string">'test'</span>).<span class="hljs-title function_">afterReturn</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">string</span>&gt;(<span class="hljs-function">(<span class="hljs-params">resolve: <span class="hljs-built_in">Function</span>, reject: <span class="hljs-built_in">Function</span></span>) =&gt;</span> {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"do something"</span>);</li><li>        <span class="hljs-title function_">resolve</span>(<span class="hljs-string">'success something'</span>);</li><li>      }));</li><li>      <span class="hljs-comment">// 执行Mock后的函数，即对定义的Promise进行后续执行</span></li><li>      <span class="hljs-keyword">let</span> result = <span class="hljs-keyword">await</span> claser.<span class="hljs-title function_">method_1</span>(<span class="hljs-string">'test'</span>);</li><li>      <span class="hljs-title function_">expect</span>(result).<span class="hljs-title function_">assertEqual</span>(<span class="hljs-string">"success something"</span>);<span class="hljs-comment">// 断言执行通过</span></li><li>      <span class="hljs-title function_">done</span>();</li><li>    })</li><li>  })</li><li>}</li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002506226433__p926146418100314"><strong>示例代码10</strong>：使用times/atLeast函数验证被Mock函数调用次数</p> <div _ngcontent-jbo-c106="" class="highlight-div"><div _ngcontent-jbo-c106="" class="highlight-div-header"><div _ngcontent-jbo-c106="" class="highlight-div-header-left"><div _ngcontent-jbo-c106="" class="handle-button expand-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jbo-c106="" class="highlight-div-header-right"><div _ngcontent-jbo-c106="" class="handle-button ai-button"></div><div _ngcontent-jbo-c106="" class="handle-button line-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jbo-c106="" class="handle-button theme-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jbo-c106="" class="handle-button copy-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jbo-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" id="ZH-CN_TOPIC_0000002506226433__screen1417539770100314" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { describe, it, <span class="hljs-title class_">MockKit</span>, when } <span class="hljs-keyword">from</span> <span class="hljs-string">'@ohos/hypium'</span></li><li>
</li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">ClassName</span> {</li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) {</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">method_1</span>(<span class="hljs-params">...arg: <span class="hljs-built_in">string</span>[]</span>) {</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-string">'888888'</span>;</li><li>  }</li><li>}</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">verifyTimesTest</span>(<span class="hljs-params"></span>) {</li><li>  <span class="hljs-title function_">describe</span>(<span class="hljs-string">'verifyTimesTest'</span>, <span class="hljs-function">() =&gt;</span> {</li><li>    <span class="hljs-title function_">it</span>(<span class="hljs-string">'test_verify_times'</span>, <span class="hljs-number">0</span>, <span class="hljs-function">() =&gt;</span> {</li><li>      <span class="hljs-comment">// 创建一个Mock能力的对象MockKit</span></li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">mocker</span>: <span class="hljs-title class_">MockKit</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MockKit</span>();</li><li>      <span class="hljs-comment">// 初始化ClassName的对象claser</span></li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">claser</span>: <span class="hljs-title class_">ClassName</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ClassName</span>();</li><li>      <span class="hljs-comment">// 进行Mock操作对ClassName类的method_1函数进行Mock</span></li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">func_1</span>: <span class="hljs-title class_">Function</span> = mocker.<span class="hljs-title function_">mockFunc</span>(claser, claser.<span class="hljs-property">method_1</span>);</li><li>      <span class="hljs-comment">// 期望被Mock后的函数返回结果'4'</span></li><li>      <span class="hljs-title function_">when</span>(func_1)(<span class="hljs-string">'123'</span>).<span class="hljs-title function_">afterReturn</span>(<span class="hljs-string">'4'</span>);</li><li>      <span class="hljs-comment">// 函数调用</span></li><li>      claser.<span class="hljs-title function_">method_1</span>(<span class="hljs-string">'123'</span>, <span class="hljs-string">'ppp'</span>);</li><li>      claser.<span class="hljs-title function_">method_1</span>(<span class="hljs-string">'abc'</span>);</li><li>      claser.<span class="hljs-title function_">method_1</span>(<span class="hljs-string">'xyz'</span>);</li><li>      claser.<span class="hljs-title function_">method_1</span>();</li><li>      claser.<span class="hljs-title function_">method_1</span>(<span class="hljs-string">'abc'</span>, <span class="hljs-string">'xxx'</span>, <span class="hljs-string">'yyy'</span>);</li><li>      claser.<span class="hljs-title function_">method_1</span>(<span class="hljs-string">'abc'</span>);</li><li>      claser.<span class="hljs-title function_">method_1</span>();</li><li>      <span class="hljs-comment">// 验证函数method_1且参数为'abc'时，执行过的次数是否为2</span></li><li>      mocker.<span class="hljs-title function_">verify</span>(<span class="hljs-string">'method_1'</span>, [<span class="hljs-string">'abc'</span>]).<span class="hljs-title function_">times</span>(<span class="hljs-number">2</span>);<span class="hljs-comment">// 断言执行通过</span></li><li>       <span class="hljs-comment">// 验证函数method_1且参数为空时，是否至少执行过2次</span></li><li>      mocker.<span class="hljs-title function_">verify</span>(<span class="hljs-string">'method_1'</span>, []).<span class="hljs-title function_">atLeast</span>(<span class="hljs-number">2</span>);<span class="hljs-comment">// 断言执行通过</span></li><li>    })</li><li>  })</li><li>}</li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002506226433__p1802308527100314"><strong>示例代码11</strong>：Mock静态函数（从@ohos/hypium 1.0.16版本开始支持）</p> <div _ngcontent-jbo-c106="" class="highlight-div"><div _ngcontent-jbo-c106="" class="highlight-div-header"><div _ngcontent-jbo-c106="" class="highlight-div-header-left"><div _ngcontent-jbo-c106="" class="handle-button expand-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jbo-c106="" class="highlight-div-header-right"><div _ngcontent-jbo-c106="" class="handle-button ai-button"></div><div _ngcontent-jbo-c106="" class="handle-button line-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jbo-c106="" class="handle-button theme-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jbo-c106="" class="handle-button copy-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jbo-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" id="ZH-CN_TOPIC_0000002506226433__screen2057740387100314" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { describe, it, expect, <span class="hljs-title class_">MockKit</span>, when, <span class="hljs-title class_">ArgumentMatchers</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@ohos/hypium'</span>;</li><li>
</li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">ClassName</span> {</li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) {</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">static</span> <span class="hljs-title function_">method_1</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-string">'ClassName_method_1_call'</span>;</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">staticTest</span>(<span class="hljs-params"></span>) {</li><li>  <span class="hljs-title function_">describe</span>(<span class="hljs-string">'staticTest'</span>, <span class="hljs-function">() =&gt;</span> {</li><li>    <span class="hljs-title function_">it</span>(<span class="hljs-string">'staticTest_001'</span>, <span class="hljs-number">0</span>, <span class="hljs-function">() =&gt;</span> {</li><li>      <span class="hljs-keyword">let</span> really_result = <span class="hljs-title class_">ClassName</span>.<span class="hljs-title function_">method_1</span>();</li><li>      <span class="hljs-title function_">expect</span>(really_result).<span class="hljs-title function_">assertEqual</span>(<span class="hljs-string">'ClassName_method_1_call'</span>);</li><li>      <span class="hljs-comment">// 创建MockKit对象</span></li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">mocker</span>: <span class="hljs-title class_">MockKit</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MockKit</span>();</li><li>      <span class="hljs-comment">// Mock类ClassName对象的某个函数method_1</span></li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">func_1</span>: <span class="hljs-title class_">Function</span> = mocker.<span class="hljs-title function_">mockFunc</span>(<span class="hljs-title class_">ClassName</span>, <span class="hljs-title class_">ClassName</span>.<span class="hljs-property">method_1</span>);</li><li>      <span class="hljs-comment">// 期望被mock后的函数返回结果'mock_data'</span></li><li>      <span class="hljs-title function_">when</span>(func_1)(<span class="hljs-title class_">ArgumentMatchers</span>.<span class="hljs-property">any</span>).<span class="hljs-title function_">afterReturn</span>(<span class="hljs-string">'mock_data'</span>);</li><li>      <span class="hljs-keyword">let</span> mock_result = <span class="hljs-title class_">ClassName</span>.<span class="hljs-title function_">method_1</span>();</li><li>      <span class="hljs-title function_">expect</span>(mock_result).<span class="hljs-title function_">assertEqual</span>(<span class="hljs-string">'mock_data'</span>);<span class="hljs-comment">// 断言执行通过</span></li><li>      <span class="hljs-comment">// 清除Mock能力</span></li><li>      mocker.<span class="hljs-title function_">clear</span>(<span class="hljs-title class_">ClassName</span>);</li><li>      <span class="hljs-keyword">let</span> really_result1 = <span class="hljs-title class_">ClassName</span>.<span class="hljs-title function_">method_1</span>();</li><li>      <span class="hljs-title function_">expect</span>(really_result1).<span class="hljs-title function_">assertEqual</span>(<span class="hljs-string">'ClassName_method_1_call'</span>);<span class="hljs-comment">// 断言执行通过</span></li><li>    })</li><li>  })</li><li>}</li></ol></pre></div></div> </div> <div class="tiledSection"><h3 id="数据驱动">数据驱动<i class="anchor-icon anchor-icon-link" anchorid="数据驱动" tips="复制节点链接"></i></h3><p id="ZH-CN_TOPIC_0000002506226433__p103704684100314">单元测试框架的数据驱动能力从<a href="https://ohpm.openharmony.cn/#/cn/detail/@ohos%2Fhypium" target="_blank">@ohos/hypium 1.0.2版本</a>开始支持。开发者可以复用测试用例代码，通过数据配置文件配置输入数据和预期结果数据，在用例实现中获取数据进行相应实现和断言处理，减少冗余测试代码。</p> <p id="ZH-CN_TOPIC_0000002506226433__p422900481100314">数据驱动能力可以根据测试数据配置来驱动测试用例的执行次数和每次执行时传入的参数，使用时依赖data.json配置文件，文件内容如下：</p> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p id="ZH-CN_TOPIC_0000002506226433__p168592507100314">data.json与测试用例*.test.js或*.test.ets文件同目录。</p> <p id="ZH-CN_TOPIC_0000002506226433__p256119493100314">data.json文件中的参数配置名称需同测试用例中定义参数名称保持一致。</p> </div></div></div> <div _ngcontent-jbo-c106="" class="highlight-div"><div _ngcontent-jbo-c106="" class="highlight-div-header"><div _ngcontent-jbo-c106="" class="highlight-div-header-left"><div _ngcontent-jbo-c106="" class="handle-button expand-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jbo-c106="" class="highlight-div-header-right"><div _ngcontent-jbo-c106="" class="handle-button ai-button"></div><div _ngcontent-jbo-c106="" class="handle-button line-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jbo-c106="" class="handle-button theme-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jbo-c106="" class="handle-button copy-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jbo-c106="" class="highlight-scroll-div"><pre class="json prettyprint linenums hljs language-json" id="ZH-CN_TOPIC_0000002506226433__screen1565644599100314" hw-language="json" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-punctuation">{</span></li><li>  <span class="hljs-attr">"suites"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-punctuation">{</span></li><li>    <span class="hljs-attr">"describe"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"AbilityTest"</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span></li><li>    <span class="hljs-attr">"stress"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span></li><li>    <span class="hljs-attr">"params"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>      <span class="hljs-attr">"suiteParams1"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"suiteParams001"</span><span class="hljs-punctuation">,</span></li><li>      <span class="hljs-attr">"suiteParams2"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"suiteParams002"</span></li><li>    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span></li><li>    <span class="hljs-attr">"items"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-punctuation">{</span></li><li>      <span class="hljs-attr">"it"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"testDataDriverAsync"</span><span class="hljs-punctuation">,</span></li><li>      <span class="hljs-attr">"stress"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span></li><li>      <span class="hljs-attr">"params"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-punctuation">{</span></li><li>        <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"tom"</span><span class="hljs-punctuation">,</span></li><li>        <span class="hljs-attr">"value"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">5</span></li><li>      <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span> <span class="hljs-punctuation">{</span></li><li>        <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"jerry"</span><span class="hljs-punctuation">,</span></li><li>        <span class="hljs-attr">"value"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">4</span></li><li>      <span class="hljs-punctuation">}</span><span class="hljs-punctuation">]</span></li><li>    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span> <span class="hljs-punctuation">{</span></li><li>      <span class="hljs-attr">"it"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"testDataDriver"</span><span class="hljs-punctuation">,</span></li><li>      <span class="hljs-attr">"stress"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">3</span></li><li>    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">]</span></li><li>  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">]</span></li><li><span class="hljs-punctuation">}</span></li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002506226433__p1418488014100314">配置参数说明：</p>  <div class="tablenoborder"><div class="tbBox"><table id="table297747457100314" class="layoutFixed idpTab"><thead><tr id="ZH-CN_TOPIC_0000002506226433__row189371307100314"><th align="left" class="cellrowborder" id="mcps1.3.14.7.1.4.1.1" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__entry1304359108100314p0">配置项名称</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.14.7.1.4.1.2" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__entry463003699100314p0">功能</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.14.7.1.4.1.3" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__entry1720258469100314p0">必填</p> </th> </tr> </thead> <tbody><tr id="ZH-CN_TOPIC_0000002506226433__row1735065258100314"><td class="cellrowborder" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__entry1227895237100314p0">"suite"</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__entry976533859100314p0">测试套配置。</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__entry1114454462100314p0">是</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row1649812954100314"><td class="cellrowborder" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__entry878861350100314p0">"describe"</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__entry1370765210100314p0">测试套名称。</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__entry607801226100314p0">是</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row40048165100314"><td class="cellrowborder" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__entry2106041682100314p0">"items"</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__entry649719333100314p0">测试用例。</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__entry2082244880100314p0">是</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row564524636100314"><td class="cellrowborder" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__entry358050511100314p0">"it"</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__entry1652405497100314p0">测试用例名称。</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__entry1120647101100314p0">是</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row427486733100314"><td class="cellrowborder" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__entry1352142743100314p0">"params"</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__entry593525351100314p0">测试套/测试用例可传入使用的参数。</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__entry2110831636100314p0">否</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002506226433__row454548353100314"><td class="cellrowborder" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__entry1374489233100314p0">"stress"</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__entry869650121100314p0">测试套/测试用例指定执行次数。</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p id="ZH-CN_TOPIC_0000002506226433__entry800844085100314p0">否</p> </td> </tr>  </tbody></table></div> </div> <p id="ZH-CN_TOPIC_0000002506226433__p843419850100314"><strong>示例代码</strong></p> <p id="ZH-CN_TOPIC_0000002506226433__p2017056597100314">Stage模型在测试工程中的TestAbility目录下TestAbility.ets文件中导入data.json（FA模型在测试工程中的TestAbility目录下的app.js或app.ets文件中导入data.json），并在文件中的Hypium.hypiumTest()函数执行前设置参数数据，参考下面示例代码。</p> <div _ngcontent-jbo-c106="" class="highlight-div"><div _ngcontent-jbo-c106="" class="highlight-div-header"><div _ngcontent-jbo-c106="" class="highlight-div-header-left"><div _ngcontent-jbo-c106="" class="handle-button expand-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jbo-c106="" class="highlight-div-header-right"><div _ngcontent-jbo-c106="" class="handle-button ai-button"></div><div _ngcontent-jbo-c106="" class="handle-button line-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jbo-c106="" class="handle-button theme-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jbo-c106="" class="handle-button copy-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jbo-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" id="ZH-CN_TOPIC_0000002506226433__screen322263317100314" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { abilityDelegatorRegistry } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.TestKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Hypium</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@ohos/hypium'</span>;</li><li><span class="hljs-keyword">import</span> testsuite <span class="hljs-keyword">from</span> <span class="hljs-string">'../test/List.test'</span>;<span class="hljs-comment">//导入测试用例集合文件</span></li><li><span class="hljs-keyword">import</span> data <span class="hljs-keyword">from</span> <span class="hljs-string">'../test/data.json'</span>;<span class="hljs-comment">//导入参数数据文件</span></li><li>
</li><li>...</li><li><span class="hljs-keyword">let</span> abilityDelegator = abilityDelegatorRegistry.<span class="hljs-title function_">getAbilityDelegator</span>();</li><li><span class="hljs-keyword">let</span> abilityDelegatorArguments = abilityDelegatorRegistry.<span class="hljs-title function_">getArguments</span>();</li><li><span class="hljs-title class_">Hypium</span>.<span class="hljs-title function_">setData</span>(data);<span class="hljs-comment">//设置参数数据</span></li><li><span class="hljs-title class_">Hypium</span>.<span class="hljs-title function_">hypiumTest</span>(abilityDelegator, abilityDelegatorArguments, testsuite);</li><li>...</li></ol></pre></div></div> <div _ngcontent-jbo-c106="" class="highlight-div"><div _ngcontent-jbo-c106="" class="highlight-div-header"><div _ngcontent-jbo-c106="" class="highlight-div-header-left"><div _ngcontent-jbo-c106="" class="handle-button expand-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jbo-c106="" class="highlight-div-header-right"><div _ngcontent-jbo-c106="" class="handle-button ai-button"></div><div _ngcontent-jbo-c106="" class="handle-button line-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jbo-c106="" class="handle-button theme-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jbo-c106="" class="handle-button copy-button"><div _ngcontent-jbo-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jbo-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" id="ZH-CN_TOPIC_0000002506226433__screen919343696100314" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li> <span class="hljs-keyword">import</span> { describe, it } <span class="hljs-keyword">from</span> <span class="hljs-string">'@ohos/hypium'</span>;</li><li>
</li><li> <span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">abilityTest</span>(<span class="hljs-params"></span>) {</li><li>  <span class="hljs-title function_">describe</span>(<span class="hljs-string">'AbilityTest'</span>, <span class="hljs-function">() =&gt;</span> {</li><li>    <span class="hljs-title function_">it</span>(<span class="hljs-string">'testDataDriverAsync'</span>, <span class="hljs-number">0</span>, <span class="hljs-keyword">async</span> (<span class="hljs-attr">done</span>: <span class="hljs-title class_">Function</span>, <span class="hljs-attr">data</span>: <span class="hljs-title class_">ParmObj</span>) =&gt; {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'name: '</span> + data.<span class="hljs-property">name</span>);</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'value: '</span> + data.<span class="hljs-property">value</span>);</li><li>      <span class="hljs-title function_">done</span>();</li><li>    });</li><li>
</li><li>    <span class="hljs-title function_">it</span>(<span class="hljs-string">'testDataDriver'</span>, <span class="hljs-number">0</span>, <span class="hljs-function">() =&gt;</span> {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'stress test'</span>);</li><li>    })</li><li>  })</li><li>}</li><li> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">ParmObj</span> {</li><li>   <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>,</li><li>   <span class="hljs-attr">value</span>: <span class="hljs-built_in">string</span></li><li> }</li></ol></pre></div></div> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p id="ZH-CN_TOPIC_0000002506226433__p1553264246100314">若要使用数据驱动传入参数功能，测试用例it的func必须传入两个参数：done和data，且入参顺序不可调整。若不使用数据驱动传入参数功能，func可以不传参或仅传入done。</p> </div></div></div> </div> <div class="tiledSection"><h3 id="专项能力">专项能力<i class="anchor-icon anchor-icon-link" anchorid="专项能力" tips="复制节点链接"></i></h3><p id="ZH-CN_TOPIC_0000002506226433__p749034417100314">专项能力提供脚本执行配置能力，包括筛选执行、压力执行、随机执行等，通过命令行方式执行，具体用法请参考<a href="/consumer/cn/doc/harmonyos-guides/unittest-guidelines#命令行执行测试脚本">命令行执行测试脚本</a>章节介绍。</p> </div> <div class="tiledSection"><h2 id="单元测试框架常见问题">单元测试框架常见问题<i class="anchor-icon anchor-icon-link" anchorid="单元测试框架常见问题" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002506226433__p557297405100314"><strong>用例中增加的打印日志在用例结果之后才打印</strong></p> <p id="ZH-CN_TOPIC_0000002506226433__p2109316918100314"><strong>问题描述</strong></p> <p id="ZH-CN_TOPIC_0000002506226433__p1668359931100314">用例中新增的日志打印信息未在执行过程中出现，而是在执行结束之后才显示。</p> <p id="ZH-CN_TOPIC_0000002506226433__p521784736100314"><strong>可能原因</strong></p> <p id="ZH-CN_TOPIC_0000002506226433__p1384699407100314">此类情况仅在用例调用异步接口时出现。为确保日志正确捕获执行过程，用例中所有日志信息必须在用例执行结束前打印。</p> <p id="ZH-CN_TOPIC_0000002506226433__p680075386100314"><strong>解决方法</strong></p> <p id="ZH-CN_TOPIC_0000002506226433__p1885785206100314">当被调用的异步接口数量超过两个时，建议将接口调用封装成Promise方式调用。</p> <p id="ZH-CN_TOPIC_0000002506226433__p681496860100314"><strong>执行用例时报用例超时错误</strong></p> <p id="ZH-CN_TOPIC_0000002506226433__p1528632898100314"><strong>问题描述</strong></p> <p id="ZH-CN_TOPIC_0000002506226433__p1491208538100314">用例执行结束，控制台提示execute time XXms错误，即用例执行超时。</p> <p id="ZH-CN_TOPIC_0000002506226433__p1196910891100314"><strong>可能原因</strong></p> <ol id="ZH-CN_TOPIC_0000002506226433__ol4532905100314"><li id="li1149164551100314">用例执行异步接口时，如果未调用done函数，会导致用例无法正常结束，最终超时。</li><li id="li1520530193100314">用例调用函数耗时过长，超过用例执行设置的超时时间（默认5000ms）。</li><li id="li183989842100314">用例调用函数时断言失败抛出异常，导致用例执行超时终止。</li></ol> <p id="ZH-CN_TOPIC_0000002506226433__p7069232100314"><strong>解决方法</strong></p> <ol id="ZH-CN_TOPIC_0000002506226433__ol1959655205100314"><li id="li1622212143100314">检查用例代码逻辑，确保断言失败时能走到done函数，完成用例执行。</li><li id="li1098742046100314">可在DevEco Studio的Run/Debug Configurations中修改用例执行超时参数，避免执行超时。</li><li id="li1077199492100314">检查用例代码逻辑，确保断言通过。</li></ol> </div> </div> <div></div></div>