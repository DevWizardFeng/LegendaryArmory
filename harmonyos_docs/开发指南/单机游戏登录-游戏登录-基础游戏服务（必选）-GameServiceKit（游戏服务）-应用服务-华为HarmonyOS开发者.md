<h1 _ngcontent-twq-c119="" class="doc-title ng-star-inserted" title="单机游戏登录"> 单机游戏登录 </h1>

<div _ngcontent-twq-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div><p>单机游戏是指数据本地化存储，不依赖服务器的游戏。</p> <p>单机游戏接入基础游戏服务后，支持玩家使用华为账号快速进入游戏，且单机游戏的华为账号实名认证、未成年人防沉迷功能由基础游戏服务实现。</p> <div class="tiledSection"><h2 id="section514211453114">开发准备<i class="anchor-icon anchor-icon-link" anchorid="section514211453114" tips="复制节点链接"></i></h2></div> <div class="tiledSection"><h3 id="section13243172782312" class="firsth2">创建游戏<i class="anchor-icon anchor-icon-link" anchorid="section13243172782312" tips="复制节点链接"></i></h3><p id="ZH-CN_TOPIC_0000002452758878__zh-cn_topic_0000002452599310_zh-cn_topic_0000002385861065_p14583100125519">在华为应用市场发布游戏，要求前往AppGallery Connect创建游戏类应用，具体操作请参见<a href="https://developer.huawei.com/consumer/cn/doc/app/agc-help-create-app-0000002247955506" target="_blank">创建HarmonyOS应用</a>。其中：</p> <ul id="ZH-CN_TOPIC_0000002452758878__zh-cn_topic_0000002452599310_zh-cn_topic_0000002385861065_ul193371138195813"><li id="zh-cn_topic_0000002452599310_zh-cn_topic_0000002385861065_li16337183818589">“应用类型”：选择“HarmonyOS应用”。</li><li id="zh-cn_topic_0000002452599310_zh-cn_topic_0000002385861065_li1733713810589">“应用分类”：选择“游戏”。</li></ul> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p id="ZH-CN_TOPIC_0000002452758878__zh-cn_topic_0000002452599310_zh-cn_topic_0000002385861065_p69611011125713">用于正式上架的游戏包名建议不要包含test、dev等信息。</p> </div></div></div> </div> <div class="tiledSection"><h3 id="section11331193420240">申请版署实名认证<i class="anchor-icon anchor-icon-link" anchorid="section11331193420240" tips="复制节点链接"></i></h3><p id="ZH-CN_TOPIC_0000002452758878__zh-cn_topic_0000002452599310_p22941540114419">按照版署《关于开展网络游戏防沉迷实名认证系统接口对接工作的通知》，各游戏出版运营企业均要求在2021年6月1日前完成接入<a href="https://wlc.nppa.gov.cn/fcm_company/index.html#/login?redirect=/" target="_blank">网络游戏防沉迷实名认证系统</a>，并获取“bizID（游戏备案识别码）”，再将bizID配置到AppGallery Connect，华为将为游戏自动对接国家新闻出版署的实名认证系统并开启强制实名认证，开发者无需进行额外的开发。具体操作请参见<a href="https://developer.huawei.com/consumer/cn/doc/games-guides/game-center-identification-applyfor-0000002392353221" target="_blank">版署实名认证申请</a>。</p> </div> <div class="tiledSection"><h3 id="section3930231192311">生成签名证书<i class="anchor-icon anchor-icon-link" anchorid="section3930231192311" tips="复制节点链接"></i></h3><p id="ZH-CN_TOPIC_0000002452758878__zh-cn_topic_0000002452599310_zh-cn_topic_0000002385861065_p01071448135718">数字证书和Profile文件等签名信息可以确保游戏的完整性：</p> <ul id="ZH-CN_TOPIC_0000002452758878__zh-cn_topic_0000002452599310_zh-cn_topic_0000002279275420_zh-cn_topic_0000002385861065_ul932175510581"><li id="zh-cn_topic_0000002452599310_zh-cn_topic_0000002279275420_zh-cn_topic_0000002385861065_li1032135517588">调试阶段：<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-signing#section297715173233" target="_blank">手动签名</a>、<a href="https://developer.huawei.com/consumer/cn/doc/app/agc-help-debug-cert-0000002283256797" target="_blank">申请调试证书</a>、<a href="https://developer.huawei.com/consumer/cn/doc/app/agc-help-debug-profile-0000002248181278" target="_blank">申请调试Profile</a>。</li><li id="zh-cn_topic_0000002452599310_zh-cn_topic_0000002279275420_zh-cn_topic_0000002385861065_li1647610235919">发布阶段：<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-signing#section297715173233" target="_blank">手动签名</a>、<a href="https://developer.huawei.com/consumer/cn/doc/app/agc-help-release-cert-0000002283336729" target="_blank">申请发布证书</a>、<a href="https://developer.huawei.com/consumer/cn/doc/app/agc-help-release-profile-0000002248341090" target="_blank">申请发布Profile</a>。</li></ul> </div> <div class="tiledSection"><h3 id="section205943551234">配置签名证书指纹<i class="anchor-icon anchor-icon-link" anchorid="section205943551234" tips="复制节点链接"></i></h3><p id="ZH-CN_TOPIC_0000002452758878__zh-cn_topic_0000002452599310_zh-cn_topic_0000002385861065_p123590396535">AppGallery Connect会自动生成证书对应的公钥信息，并计算出对应的SHA256指纹。开发者前往AppGallery Connect获取并配置SHA256指纹，且每个游戏至多添加4个签名证书指纹，配置签名证书指纹的具体操作请参见<a href="https://developer.huawei.com/consumer/cn/doc/app/agc-help-cert-fingerprint-0000002278002933" target="_blank">配置公钥指纹</a>。</p> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p id="ZH-CN_TOPIC_0000002452758878__zh-cn_topic_0000002452599310_zh-cn_topic_0000002385861065_p698615514914">请在调试阶段添加调试证书对应的指纹，在发布阶段添加发布证书对应的指纹。</p> </div></div></div> </div> <div class="tiledSection"><h3 id="section7658201162412">配置APP ID和Client ID<i class="anchor-icon anchor-icon-link" anchorid="section7658201162412" tips="复制节点链接"></i></h3><ol id="ZH-CN_TOPIC_0000002452758878__zh-cn_topic_0000002452599310_zh-cn_topic_0000002385861065_ol465374784615"><li id="zh-cn_topic_0000002452599310_zh-cn_topic_0000002385861065_li13661164319451">登录<a href="https://developer.huawei.com/consumer/cn/service/josp/agc/index.html" target="_blank">AppGallery Connect</a>，在“开发与服务”下选择项目及项目下的游戏，获取“应用”下的APP ID和Client ID。<p id="ZH-CN_TOPIC_0000002452758878__zh-cn_topic_0000002452599310_zh-cn_topic_0000002385861065_p19912854315"><span><img originheight="544" originwidth="1304" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114700.31346372517298158812355267779974:50001231000000:2800:7D71FBB2EBB0A643EFEE0FFDA65503D8A221BA749B2109B6467A38BDE2BDC815.png" width="920" height="383.8036809815951"></span></p> </li><li id="zh-cn_topic_0000002452599310_zh-cn_topic_0000002385861065_li8636653203411">在工程的entry模块module.json5文件中，新增metadata并配置client_id和app_id，同时新增requestPermissions以配置网络权限。如下所示：<div _ngcontent-twq-c106="" class="highlight-div"><div _ngcontent-twq-c106="" class="highlight-div-header"><div _ngcontent-twq-c106="" class="highlight-div-header-left"><div _ngcontent-twq-c106="" class="handle-button expand-button"><div _ngcontent-twq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-twq-c106="" class="highlight-div-header-right"><div _ngcontent-twq-c106="" class="handle-button ai-button"></div><div _ngcontent-twq-c106="" class="handle-button line-button"><div _ngcontent-twq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-twq-c106="" class="handle-button theme-button"><div _ngcontent-twq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-twq-c106="" class="handle-button copy-button"><div _ngcontent-twq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-twq-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" id="ZH-CN_TOPIC_0000002452758878__zh-cn_topic_0000002452599310_zh-cn_topic_0000002385861065_screen859849122816" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class=""><span class="hljs-string">"module"</span></span><span class="">: </span>{</li><li>  <span class=""><span class="hljs-string">"name"</span></span><span class="">: </span><span class=""><span class="hljs-string">"entry"</span></span><span class="">,</span></li><li>  <span class=""><span class="hljs-string">"type"</span></span><span class="">: </span><span class=""><span class="hljs-string">"xxx"</span></span><span class="">,</span></li><li>  <span class=""><span class="hljs-string">"description"</span></span><span class="">: </span><span class=""><span class="hljs-string">"xxxx"</span></span><span class="">,</span></li><li><span class="">  <span class="hljs-string">"mainElement"</span></span><span class="">: </span><span class=""><span class="hljs-string">"xxxx"</span></span><span class="">,</span></li><li>  <span class=""><span class="hljs-string">"deviceTypes"</span></span><span class="">: </span>[]<span class="">,</span></li><li>  <span class=""><span class="hljs-string">"pages"</span></span><span class="">: </span><span class=""><span class="hljs-string">"xxxx"</span></span><span class="">,</span></li><li>  <span class=""><span class="hljs-string">"abilities"</span></span><span class="">: </span>[]<span class="">,</span></li><li><span class="">  <span class="hljs-string">"metadata"</span></span><span class="">: </span>[ <span class=""><span class="hljs-comment">/</span></span><span class=""><span class="hljs-comment">/ </span></span><span class=""><span class="hljs-comment">配置如下信息</span></span></li><li>    {</li><li>      <span class=""><span class="hljs-string">"name"</span></span><span class="">: </span><span class=""><span class="hljs-string">"client_id"</span></span><span class="">,</span></li><li>      <span class=""><span class="hljs-string">"value"</span></span><span class="">: </span><span class=""><span class="hljs-string">"xxxxxx"</span></span> <span class="hljs-comment">// 配置为前面步骤中获取的Client ID</span></li><li>    },</li><li>    {</li><li>      <span class=""><span class="hljs-string">"name"</span></span><span class="">: </span><span class=""><span class="hljs-string">"app_id"</span></span><span class="">,</span></li><li>      <span class=""><span class="hljs-string">"value"</span></span><span class="">: </span><span class=""><span class="hljs-string">"xxxxxx"</span></span> <span class="hljs-comment">// 配置为前面步骤中获取的APP ID</span></li><li>    }</li><li>  ],</li><li>  <span class="hljs-string">"requestPermissions"</span>: [ <span class="hljs-comment">// 配置网络权限</span></li><li>    {</li><li>      <span class="hljs-string">"name"</span>: <span class="hljs-string">"ohos.permission.INTERNET"</span></li><li>    }</li><li>  ]</li><li>}</li></ol></pre></div></div> </li></ol> </div> <div class="tiledSection"><h3 id="section3907114313255">配置APP ID映射关系<i class="anchor-icon anchor-icon-link" anchorid="section3907114313255" tips="复制节点链接"></i></h3><ol><li>登录<a href="https://developer.huawei.com/consumer/cn/service/josp/agc/index.html" target="_blank">AppGallery Connect</a>，在“开发与服务”下选择项目及项目下的游戏，左侧菜单选择“构建 &gt; 游戏服务”，在右侧点击“新增配置”。<p id="ZH-CN_TOPIC_0000002452758878__zh-cn_topic_0000002452599310_zh-cn_topic_0000002385861065_p1090693643318"><span><img originheight="444" originwidth="1224" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114700.62429202602614891167638800762602:50001231000000:2800:87E33CEC885AC29495291FC80F62AFC8ACCB3735425872354F2E347B4340E253.png" width="920" height="333.72549019607845"></span></p> </li><li>在弹出的“新增配置信息”窗口中选择HAP游戏和APK游戏，完成后点击“下一步”。<p><span><img originheight="374" originwidth="602" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114700.30849298735510266991547197400369:50001231000000:2800:BED2A72F634337D32B8D97C00BD91BF334534D85253B4FF1E6198F20E034B0FB.png" width="602" height="374"></span></p>  <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.9.2.2.2.1.3.1.1" valign="top" width="30%"><p>信息项</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.9.2.2.2.1.3.1.2" valign="top" width="70%"><p>说明</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="30%"><p>HarmonyOS 5.0及以上游戏</p> </td> <td class="cellrowborder" valign="top" width="70%"><p>请选择待上架的HAP游戏。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="30%"><p>HarmonyOS 4及以下游戏</p> </td> <td class="cellrowborder" valign="top" width="70%"><p>请选择已上架或待上架的APK游戏。</p> </td> </tr>  </tbody></table></div> </div> </li><li>在弹出的窗口中继续填写信息，完成后点击“下一步”。<p><span><img originheight="354" originwidth="524" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114700.70818503369607550730596674500519:50001231000000:2800:3E7FC87F5AA5860A3AC5671F0B6F142CF15BC7D311C08B1C301C6B073932E7E7.png" width="524" height="354"></span></p> </li><li>（可选）填写开发者服务器的回调地址，回调地址要求支持HTTPS协议，且具有合法商用证书，完成后点击“确定”提交APP ID映射关系的审批申请。<p><span><img originheight="244" originwidth="594" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114700.48181078263310091999182680160047:50001231000000:2800:D4F64775CC4315474E0C9AEE253D526BB0F4A88BCA08391493A7447F2EC12923.png" width="594" height="244"></span></p> </li><li>若出现异常情况，将在提示框以红字提醒。<p>建议点击“取消”重新配置映射关系。若忽略异常情况点击“确定”继续提交申请，可能会造成映射关系审批不通过。</p> <p><span><img originheight="461" originwidth="714" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114701.46782035260426481635432148473754:50001231000000:2800:80C60990293CD44BC92D920753E2716844697171FA11ED8041C4AD7554A179DD.png" width="714" height="461"></span></p> </li><li>提交申请后，华为工作人员完成审核需要1~3个工作日，请耐心等待。<p>APP ID映射关系生效后想要重新配置，请先提交映射关系的删除申请。</p> <p><span><img originheight="264" originwidth="1084" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114701.13197921491058197518048518225218:50001231000000:2800:0A4A5E188A87921542A273B4D13B7DA7552B8B879CF849908F51CD5E4C6CF5D0.png" width="920" height="224.0590405904059"></span></p> <p>配置/删除APP ID映射关系的审核结果将通过互动中心或邮件进行通知。</p> <p><span><img originheight="805" originwidth="1114" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114701.42160967874617668165496555819112:50001231000000:2800:D7504A97C0457EBC1A9DCAEC1869B5432EECDD619D92D12806A0DC00AFE52246.png" width="920" height="664.8114901256732"></span></p> </li></ol> </div> <div class="tiledSection"><h2 id="section16511881336">业务流程<i class="anchor-icon anchor-icon-link" anchorid="section16511881336" tips="复制节点链接"></i></h2><div class="p"><span><img originheight="439" originwidth="808" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114701.57096868480691827988268418753771:50001231000000:2800:5F11EBE2A875B62C9AE31B5444CCCB82D7EEE88FB0759197BDCBC84F9EC15D5B.png" width="808" height="439"></span><ol><li>玩家启动游戏。</li><li>游戏调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/gameservice-gameplayer#section225333655719" target="_blank">init</a>接口初始化Game Service Kit。初始化后，弹出华为隐私协议，玩家签署协议后，则继续往下执行。</li><li>游戏调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/gameservice-gameplayer#section157848375136" target="_blank">unionLogin</a>接口，要求showLoginDialog参数为false，thirdAccountInfos参数传空数组。</li><li>游戏顶部弹出欢迎横幅，并向游戏返回accountName（使用华为账号登录返回值为hw_account），gamePlayerId等信息。</li><li>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/gameservice-gameplayer#section15119154416715" target="_blank">verifyLocalPlayer</a>接口，对用户设备登录的华为账号进行如下合规校验。合规校验通过后，玩家进入游戏。<ol><li>若玩家未完成实名认证，<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/gameservice-gameplayer#section15119154416715" target="_blank">verifyLocalPlayer</a>接口自动弹出实名认证窗口要求玩家进行实名认证。</li><li>若玩家账号实名认证为未成年人，<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/gameservice-gameplayer#section15119154416715" target="_blank">verifyLocalPlayer</a>接口将自动检测未成年人的游戏时间。若玩家不在指定时间内登录游戏，将强制玩家退出游戏并返回<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/gameservice-error-code#section4418848101513" target="_blank">1002000006</a>错误码。</li></ol> </li></ol> </div> </div> <div class="tiledSection"><h2 id="section1212682065918">接口说明<i class="anchor-icon anchor-icon-link" anchorid="section1212682065918" tips="复制节点链接"></i></h2><p>具体API说明请详见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/gameservice-gameplayer" target="_blank">接口文档</a>。</p>  <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.11.3.1.3.1.1" valign="top" width="53.769999999999996%"><p>接口名</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.11.3.1.3.1.2" valign="top" width="46.23%"><p>描述</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="53.769999999999996%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/gameservice-gameplayer#section225333655719" target="_blank">init</a>(context: common.UIAbilityContext, callback: AsyncCallback&lt;void&gt;): void</p> </td> <td class="cellrowborder" valign="top" width="46.23%"><p>游戏初始化接口，使用默认的上下文信息，使用callback回调。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="53.769999999999996%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/gameservice-gameplayer#section157848375136" target="_blank">unionLogin</a>(context: common.UIAbilityContext, loginParam: UnionLoginParam): Promise&lt;UnionLoginResult&gt;</p> </td> <td class="cellrowborder" valign="top" width="46.23%"><p>登录接口，通过Promise对象获取返回值。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="53.769999999999996%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/gameservice-gameplayer#section15119154416715" target="_blank">verifyLocalPlayer</a>(context: common.UIAbilityContext, thirdUserInfo: ThirdUserInfo): Promise&lt;void&gt;</p> </td> <td class="cellrowborder" valign="top" width="46.23%"><p>合规校验接口，校验当前设备登录的华为账号的实名认证、游戏防沉迷信息，通过Promise对象获取返回值。</p> </td> </tr>  </tbody></table></div> </div> </div> <div class="tiledSection"><h2 id="section12241161921910">开发步骤<i class="anchor-icon anchor-icon-link" anchorid="section12241161921910" tips="复制节点链接"></i></h2></div> <div class="tiledSection"><h3 id="section148743784818" class="firsth2">导入模块<i class="anchor-icon anchor-icon-link" anchorid="section148743784818" tips="复制节点链接"></i></h3><p>导入Game Service Kit模块及相关公共模块。</p> <div _ngcontent-twq-c106="" class="highlight-div"><div _ngcontent-twq-c106="" class="highlight-div-header"><div _ngcontent-twq-c106="" class="highlight-div-header-left"><div _ngcontent-twq-c106="" class="handle-button expand-button"><div _ngcontent-twq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-twq-c106="" class="highlight-div-header-right"><div _ngcontent-twq-c106="" class="handle-button ai-button"></div><div _ngcontent-twq-c106="" class="handle-button line-button"><div _ngcontent-twq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-twq-c106="" class="handle-button theme-button"><div _ngcontent-twq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-twq-c106="" class="handle-button copy-button"><div _ngcontent-twq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-twq-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { gamePlayer } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.GameServiceKit'</span>;</li><li><span class="hljs-keyword">import</span> { common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-variable language_">window</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span>;</li></ol></pre></div></div> </div> <div class="tiledSection"><h3 id="section188422114487">初始化<i class="anchor-icon anchor-icon-link" anchorid="section188422114487" tips="复制节点链接"></i></h3><p>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/gameservice-gameplayer#section225333655719" target="_blank">init</a>接口初始化Game Service Kit。</p> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><ul><li>调用接口时严格要求继承UIAbility，并且获取上下文的时机是onWindowStageCreate生命周期中页面加载成功后。</li><li>要求游戏先成功调用初始化<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/gameservice-gameplayer#section225333655719" target="_blank">init</a>接口后再调用其他接口，否则将导致审核被驳回。</li></ul> </div></div></div> <div _ngcontent-twq-c106="" class="highlight-div"><div _ngcontent-twq-c106="" class="highlight-div-header"><div _ngcontent-twq-c106="" class="highlight-div-header-left"><div _ngcontent-twq-c106="" class="handle-button expand-button"><div _ngcontent-twq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-twq-c106="" class="highlight-div-header-right"><div _ngcontent-twq-c106="" class="handle-button ai-button"></div><div _ngcontent-twq-c106="" class="handle-button line-button"><div _ngcontent-twq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-twq-c106="" class="handle-button theme-button"><div _ngcontent-twq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-twq-c106="" class="handle-button copy-button"><div _ngcontent-twq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-twq-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-title function_">onWindowStageCreate</span>(<span class="hljs-params">windowStage: <span class="hljs-variable language_">window</span>.WindowStage</span>) {</li><li>  windowStage.<span class="hljs-title function_">loadContent</span>(<span class="hljs-string">"pages/index"</span>, <span class="hljs-function">(<span class="hljs-params">err, data</span>) =&gt;</span> {</li><li>    <span class="hljs-keyword">try</span> {</li><li>      gamePlayer.<span class="hljs-title function_">init</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>,<span class="hljs-function">()=&gt;</span>{</li><li>        hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">`Succeeded in initing.`</span>);</li><li>      });</li><li>    } <span class="hljs-keyword">catch</span> (error) {</li><li>      <span class="hljs-keyword">let</span> err = error <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>;</li><li>      hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">`Failed to init. Code: <span class="hljs-subst">${err.code}</span>, message: <span class="hljs-subst">${err.message}</span>`</span>);</li><li>    }</li><li>  });</li><li>}</li></ol></pre></div></div> </div> <p>初始化后，游戏弹出华为隐私协议窗口，用户同意签署协议，则继续往下执行。</p> <p><span><img height="302.841" originheight="878" originwidth="1928" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114701.44763275927221543365392639455533:50001231000000:2800:232438D3CC99B359270BCDD9110947EBF3AA00D63B5E3B787E5072859B89DFE3.png" title="点击放大" width="665"></span></p> <p>若当前华为账号同意过游戏服务隐私协议，后续使用该华为账号登录的游戏将不会再弹出隐私协议窗口。</p> <div class="tiledSection"><h3 id="section1178692184813">登录游戏<i class="anchor-icon anchor-icon-link" anchorid="section1178692184813" tips="复制节点链接"></i></h3><div class="p">调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/gameservice-gameplayer#section157848375136" target="_blank">unionLogin</a>接口登录游戏。<div _ngcontent-twq-c106="" class="highlight-div"><div _ngcontent-twq-c106="" class="highlight-div-header"><div _ngcontent-twq-c106="" class="highlight-div-header-left"><div _ngcontent-twq-c106="" class="handle-button expand-button"><div _ngcontent-twq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-twq-c106="" class="highlight-div-header-right"><div _ngcontent-twq-c106="" class="handle-button ai-button"></div><div _ngcontent-twq-c106="" class="handle-button line-button"><div _ngcontent-twq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-twq-c106="" class="handle-button theme-button"><div _ngcontent-twq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-twq-c106="" class="handle-button copy-button"><div _ngcontent-twq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-twq-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">let</span> context = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>()?.<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">request</span>: gamePlayer.<span class="hljs-property">UnionLoginParam</span> = {</li><li>  <span class="hljs-attr">showLoginDialog</span>: <span class="hljs-literal">false</span>, <span class="hljs-comment">// 是否弹出联合登录面板。true表示强制弹出面板，false表示优先使用玩家上一次的登录选择，不弹出联合登录面板，若玩家首次登录或卸载重装，则正常弹出。</span></li><li>  <span class="hljs-attr">thirdAccountInfos</span>: [] <span class="hljs-comment">// 单机游戏请传空数组。</span></li><li>};</li><li><span class="hljs-keyword">try</span> {</li><li>  gamePlayer.<span class="hljs-title function_">unionLogin</span>(context, request).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">result: gamePlayer.UnionLoginResult</span>) =&gt;</span> {</li><li>    hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">`Succeeded in logining: <span class="hljs-subst">${result?.accountName}</span>`</span>);</li><li>  }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error: BusinessError</span>) =&gt;</span> {</li><li>    hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">`Failed to login. Code: <span class="hljs-subst">${error.code}</span>, message: <span class="hljs-subst">${error.message}</span>`</span>);</li><li>  });</li><li>} <span class="hljs-keyword">catch</span> (error) {</li><li>  <span class="hljs-keyword">let</span> err = error <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>;</li><li>  hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">`Failed to login. Code: <span class="hljs-subst">${err.code}</span>, message: <span class="hljs-subst">${err.message}</span>`</span>);</li><li>}</li></ol></pre></div></div> </div> <p>用户完成登录流程后，游戏顶部弹出欢迎横幅，并向游戏返回accountName（华为账号登录返回值为hw_account）、gamePlayerId等信息。</p> <p><span><img height="302.8543" originheight="429" originwidth="942" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114701.63112728300678089520039676470281:50001231000000:2800:7213CACAAFD354E50E608F76C7C918B7BB4CA4CDF6D605F99DA149405E7D39B2.png" title="点击放大" width="665"></span></p> </div> <div class="tiledSection"><h3 id="section1843482554811">合规校验<i class="anchor-icon anchor-icon-link" anchorid="section1843482554811" tips="复制节点链接"></i></h3><p>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/gameservice-gameplayer#section15119154416715" target="_blank">verifyLocalPlayer</a>接口对用户设备登录华为账号的实名认证和未成年人防沉迷进行合规校验，校验通过后，玩家进入游戏。</p> <div _ngcontent-twq-c106="" class="highlight-div"><div _ngcontent-twq-c106="" class="highlight-div-header"><div _ngcontent-twq-c106="" class="highlight-div-header-left"><div _ngcontent-twq-c106="" class="handle-button expand-button"><div _ngcontent-twq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-twq-c106="" class="highlight-div-header-right"><div _ngcontent-twq-c106="" class="handle-button ai-button"></div><div _ngcontent-twq-c106="" class="handle-button line-button"><div _ngcontent-twq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-twq-c106="" class="handle-button theme-button"><div _ngcontent-twq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-twq-c106="" class="handle-button copy-button"><div _ngcontent-twq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-twq-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">let</span> context = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>()?.<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">request</span>: gamePlayer.<span class="hljs-property">ThirdUserInfo</span> = {</li><li>  <span class="hljs-attr">thirdOpenId</span>: <span class="hljs-string">''</span> <span class="hljs-comment">// 单机游戏传空</span></li><li>};</li><li><span class="hljs-keyword">try</span> {</li><li>  gamePlayer.<span class="hljs-title function_">verifyLocalPlayer</span>(context, request).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>    hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">`Succeeded in verifying.`</span>);</li><li>  }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error: BusinessError</span>) =&gt;</span> {</li><li>    hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">`Failed to verify. Code: <span class="hljs-subst">${error.code}</span>, message: <span class="hljs-subst">${error.message}</span>`</span>);</li><li>  });</li><li>} <span class="hljs-keyword">catch</span> (error) {</li><li>  <span class="hljs-keyword">let</span> err = error <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>;</li><li>  hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">`Failed to verify. Code: <span class="hljs-subst">${err.code}</span>, message: <span class="hljs-subst">${err.message}</span>`</span>);</li><li>}</li></ol></pre></div></div> </div> <p>华为账号的实名认证、未成年人防沉迷由基础游戏服务实现，华为账号的支付合规控制（例如未成年人支付限额）由IAP Kit（应用内支付服务）实现。</p>  <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.21.1.5.1.1" valign="top" width="10%"><p>合规校验</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.21.1.5.1.2" valign="top" width="20%"><p>校验项</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.21.1.5.1.3" valign="top" width="30%"><p>国家政策</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.21.1.5.1.4" valign="top" width="40%"><p>解决方案</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="10%"><p>华为账号实名认证</p> </td> <td class="cellrowborder" valign="top" width="20%"><p>校验用户设备登录的华为账号是否已实名认证。</p> </td> <td class="cellrowborder" valign="top" width="30%"><p>根据相关法律法规要求，所有网络游戏玩家必须使用真实有效身份信息注册并登录网络游戏。</p> </td> <td class="cellrowborder" valign="top" width="40%"><p>若玩家使用未实名认证的华为账号登录游戏时，基础游戏服务向玩家弹出实名认证窗口，要求玩家进行实名认证。若玩家取消实名认证，则返回<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/gameservice-error-code#section206921217496" target="_blank">1002000004</a>错误码。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="10%"><p>未成年人防沉迷</p> </td> <td class="cellrowborder" valign="top" width="20%"><p>校验已实名认证为未成年人的华为账号是否在规定时间内登录游戏。</p> </td> <td class="cellrowborder" valign="top" width="30%"><p>根据国家新闻出版署的最新规定，所有网络游戏企业仅可在周五、周六、周日和法定节假日每日20时至21时向未成年人提供1小时网络游戏服务，其他时间均不得以任何形式向未成年人提供网络游戏服务。</p> </td> <td class="cellrowborder" valign="top" width="40%"><ul><li>已实名认证为未成年人的华为账号在规定时间内登录游戏，当游戏进行到晚上21时，基础游戏服务会弹窗提示玩家已到游戏时间，强制玩家退出游戏并返回<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/gameservice-error-code#section4418848101513" target="_blank">1002000006</a>错误码。</li><li>已实名认证为未成年人的华为账号在非规定游戏时间内登录游戏，基础游戏服务会弹框提示玩家不允许游戏，强制玩家退出游戏并返回<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/gameservice-error-code#section4418848101513" target="_blank">1002000006</a>错误码。</li></ul> </td> </tr> <tr><td class="cellrowborder" valign="top" width="10%"><p>未成年人支付限额</p> </td> <td class="cellrowborder" valign="top" width="20%"><p>校验已实名认证为未成年人的华为账号是否限额付费。</p> </td> <td class="cellrowborder" valign="top" width="30%"><p>根据国家新闻出版署的最新规定，网络游戏企业不得为未满8周岁的用户提供游戏付费服务。同一网络游戏企业所提供的游戏付费服务，8周岁以上未满16周岁的用户，单次充值金额不得超过50元人民币，每月充值金额累计不得超过200元人民币；16周岁以上未满18周岁的用户，单次充值金额不得超过100元人民币，每月充值金额累计不得超过400元人民币。</p> </td> <td class="cellrowborder" valign="top" width="40%"><p>已实名认证为未成年人的华为账号在游戏内超额付费，IAP Kit会弹窗提示消费金额超出限制。</p> <p>用户在使用华为应用内支付时，华为会自动根据国家新闻出版署的要求进行支付限额控制，您无需处理。</p> </td> </tr>  </tbody></table></div> </div>  <div class="tablenoborder"><div class="tbBox"><table style="border-style: none;" class="layoutFixed idpTab"><tbody><tr><td align="center" class="row-nocellborder" style="border: none;" valign="top" width="33%"><p><span><img height="126.752" originheight="720" originwidth="1584" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114701.49554685314856317023295947352630:50001231000000:2800:52EE5BE642A5B88831BDE604C41AC8AF1DA21F5856D7292E56947BDB127A7CE6.png" title="点击放大" width="279.6"></span></p> <p>华为账号实名认证</p> </td> <td align="center" class="row-nocellborder" style="border: none;" valign="top" width="33%"><p><span><img height="126.752" originheight="720" originwidth="1584" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114701.76493286730301544833255433768881:50001231000000:2800:649E00A5F8639B8CC10484FF91528D146AF27638F7D7929B72BBDE7E7F056750.png" title="点击放大" width="279.6"></span></p> <p>未成年人防沉迷</p> </td> <td align="center" class="cellrowborder" style="border: none;" valign="top" width="34%"><p><span><img height="131.47138666666666" originheight="428" originwidth="940" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114701.55130798002735399476381571805528:50001231000000:2800:42F166F3B15EFAEE5A70F5220A9EBA310B074DDBFE481B009F92E64BCD6A30A6.png" title="点击放大" width="288.8"></span></p> <p>未成年人支付限额</p> </td> </tr>  </tbody></table></div> </div> </div> <div></div></div>