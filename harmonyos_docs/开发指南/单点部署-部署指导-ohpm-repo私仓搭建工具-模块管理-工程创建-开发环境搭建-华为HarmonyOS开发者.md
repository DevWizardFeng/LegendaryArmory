<h1 _ngcontent-adn-c119="" class="doc-title ng-star-inserted" title="单点部署"> 单点部署 </h1>

<div _ngcontent-adn-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div id="body0000001749596688"><div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p id="ZH-CN_TOPIC_0000002510293669__p177311219195811">ohpm-repo私仓不允许在Linux或macOS系统中使用root用户启动，请使用普通用户安装运行。</p> </div></div></div> <div class="tiledSection"><h2 id="zh-cn_topic_0000001745217302_安装私仓工具">安装ohpm-repo工具<i class="anchor-icon anchor-icon-link" anchorid="zh-cn_topic_0000001745217302_安装私仓工具" tips="复制节点链接"></i></h2><ol id="ZH-CN_TOPIC_0000002510293669__ol16473520165612"><li id="li135331469512"><p id="ZH-CN_TOPIC_0000002510293669__p12531446357">ohpm-repo依赖于Node运行，支持Node.js 18.x及以上版本，请提前安装Nodejs，并完成环境变量的配置。Node.js安装请参考<a href="https://nodejs.org/download/release/latest/" target="_blank">Node.js官方网站</a>。</p> </li><li id="zh-cn_topic_0000001792256157_li730839562171146"><p id="ZH-CN_TOPIC_0000002510293669__zh-cn_topic_0000001792256157_p304453132171146">下载ohpm-repo工具包，<a href="https://developer.huawei.com/consumer/cn/download/ohpm-repo" target="_blank">点击链接获取</a><strong>。</strong></p> </li><li id="zh-cn_topic_0000001792256157_li1540077834171146"><p id="ZH-CN_TOPIC_0000002510293669__zh-cn_topic_0000001792256157_p671094527171146">解压ohpm-repo私仓工具包。</p> <p id="ZH-CN_TOPIC_0000002510293669__zh-cn_topic_0000001792256157_p1079984994010"><span><img originheight="280" originwidth="258" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104724.71775890194820698162907439899274:50001231000000:2800:46F85478FE31250044372D3DAAE04395CBA128C88DE822748B73F162F70E27A9.png" class="notEnlarge" width="258" height="280"></span></p> </li></ol><ol id="ZH-CN_TOPIC_0000002510293669__ol1329182053113" start="4"><li id="li1932916201314">请将ohpm-repo工具包解压目录中bin目录的路径配置到<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-ohpm-repo-faq#section24117279211">系统环境变量</a>path中，执行如下查询命令:<div _ngcontent-adn-c106="" class="highlight-div"><div _ngcontent-adn-c106="" class="highlight-div-header"><div _ngcontent-adn-c106="" class="highlight-div-header-left"><div _ngcontent-adn-c106="" class="handle-button expand-button"><div _ngcontent-adn-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-adn-c106="" class="highlight-div-header-right"><div _ngcontent-adn-c106="" class="handle-button ai-button"></div><div _ngcontent-adn-c106="" class="handle-button line-button"><div _ngcontent-adn-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-adn-c106="" class="handle-button theme-button"><div _ngcontent-adn-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-adn-c106="" class="handle-button copy-button"><div _ngcontent-adn-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-adn-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-undefined" id="ZH-CN_TOPIC_0000002510293669__zh-cn_topic_0000001792256157_screen1454857881171146" data-highlighted="yes"><ol class="linenums"><li>ohpm-repo -v</li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002510293669__zh-cn_topic_0000001792256157_p2084915518171146">终端输出版本号（如：2.0.0），则表示安装包解压无问题。如有报错，请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-ohpm-repo-faq#section82-执行命令-ohpm-repo-command报错-ohpm-repo-不存在或者-command-命令不存在">FAQ</a>解决。</p> <div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content"><p id="ZH-CN_TOPIC_0000002510293669__p20805710123314">针对Linux和Mac系统，建议使用bash作为命令行界面。</p> </div></div></div> </li><li id="li126685329365">进入ohpm-repo解压目录的conf目录中，修改配置文件config.yaml：<ul id="ZH-CN_TOPIC_0000002510293669__zh-cn_topic_0000001745217302_ul1662250668171146"><li id="li1443721713301">检查<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-ohpm-repo-configuration#zh-cn_topic_0000001745376470_listen">listen</a>配置，默认配置为localhost:8088 ，表示仅支持监听本机地址；如果希望其他机器通过ip/域名访问，则建议修改listen配置为ohpm-repo部署机器的ip：<div _ngcontent-adn-c106="" class="highlight-div"><div _ngcontent-adn-c106="" class="highlight-div-header"><div _ngcontent-adn-c106="" class="highlight-div-header-left"><div _ngcontent-adn-c106="" class="handle-button expand-button"><div _ngcontent-adn-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-adn-c106="" class="highlight-div-header-right"><div _ngcontent-adn-c106="" class="handle-button ai-button"></div><div _ngcontent-adn-c106="" class="handle-button line-button"><div _ngcontent-adn-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-adn-c106="" class="handle-button theme-button"><div _ngcontent-adn-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-adn-c106="" class="handle-button copy-button"><div _ngcontent-adn-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-adn-c106="" class="highlight-scroll-div"><pre class="yaml prettyprint linenums hljs language-yaml" id="ZH-CN_TOPIC_0000002510293669__zh-cn_topic_0000001792256157_screen114479211171146" hw-language="yaml" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-attr">listen:</span> <span class="hljs-string">&lt;部署ohpm-repo机器的ip&gt;:8088</span></li></ol></pre></div></div> </li><li id="li146065312305">检查<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-ohpm-repo-configuration#zh-cn_topic_0000001745376470_deploy_root">deploy_root</a>配置：如果选择不配置，会存储在默认地址中。禁止该路径配置为ohpm-repo解压根目录。</li><li id="zh-cn_topic_0000001745217302_li1974028566171146"><p id="ZH-CN_TOPIC_0000002510293669__zh-cn_topic_0000001745217302_p2003729062171146">数据存储db模块使用filedb：</p> <div _ngcontent-adn-c106="" class="highlight-div"><div _ngcontent-adn-c106="" class="highlight-div-header"><div _ngcontent-adn-c106="" class="highlight-div-header-left"><div _ngcontent-adn-c106="" class="handle-button expand-button"><div _ngcontent-adn-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-adn-c106="" class="highlight-div-header-right"><div _ngcontent-adn-c106="" class="handle-button ai-button"></div><div _ngcontent-adn-c106="" class="handle-button line-button"><div _ngcontent-adn-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-adn-c106="" class="handle-button theme-button"><div _ngcontent-adn-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-adn-c106="" class="handle-button copy-button"><div _ngcontent-adn-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-adn-c106="" class="highlight-scroll-div"><pre class="yaml prettyprint linenums hljs language-yaml" id="ZH-CN_TOPIC_0000002510293669__zh-cn_topic_0000001745217302_screen1385545361171146" hw-language="yaml" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-attr">db:</span></li><li>  <span class="hljs-attr">type:</span> <span class="hljs-string">filedb</span></li><li>  <span class="hljs-attr">config:</span></li><li>    <span class="hljs-attr">path:</span> <span class="hljs-string">./db</span></li></ol></pre></div></div> </li><li id="li81211739203714"><p id="ZH-CN_TOPIC_0000002510293669__p2121939133718">文件存储store模块使用fs：</p> <div _ngcontent-adn-c106="" class="highlight-div"><div _ngcontent-adn-c106="" class="highlight-div-header"><div _ngcontent-adn-c106="" class="highlight-div-header-left"><div _ngcontent-adn-c106="" class="handle-button expand-button"><div _ngcontent-adn-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-adn-c106="" class="highlight-div-header-right"><div _ngcontent-adn-c106="" class="handle-button ai-button"></div><div _ngcontent-adn-c106="" class="handle-button line-button"><div _ngcontent-adn-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-adn-c106="" class="handle-button theme-button"><div _ngcontent-adn-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-adn-c106="" class="handle-button copy-button"><div _ngcontent-adn-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-adn-c106="" class="highlight-scroll-div"><pre class="yaml prettyprint linenums hljs language-yaml" id="ZH-CN_TOPIC_0000002510293669__screen12121153903713" hw-language="yaml" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-attr">store:</span></li><li>  <span class="hljs-attr">type:</span> <span class="hljs-string">fs</span></li><li>  <span class="hljs-attr">config:</span></li><li>    <span class="hljs-attr">path:</span> <span class="hljs-string">./storage</span></li><li>    <span class="hljs-comment">#server: http://localhost:8088</span></li></ol></pre></div></div> </li><li id="zh-cn_topic_0000001792256157_li1192739177171146"><p id="ZH-CN_TOPIC_0000002510293669__zh-cn_topic_0000001792256157_p237223803171146">检查是否配置了<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-ohpm-repo-configuration#zh-cn_topic_0000001745376470_store">store.config.server</a>，用于指定ohpm-repo仓库内容的下载地址，不配置取默认值，具体请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-ohpm-repo-configuration#zh-cn_topic_0000001745376470_li922300957171146">server: 仓库内容的下载地址</a>。如果<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-ohpm-repo-configuration#zh-cn_topic_0000001745376470_listen">listen</a>的host为0.0.0.0，且本机存在多个网络接口，那么该值必须配置，建议手动修改server的host为本机指定的ip/域名，例如listen为0.0.0.0:8088，故server需配置为http://&lt;指定部署机器的ip/域名&gt;:8088。</p> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><ul id="ZH-CN_TOPIC_0000002510293669__ul1393703915611"><li id="li49379399564">如果为ohpm-repo服务配置了反向代理服务器，则<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-ohpm-repo-configuration#zh-cn_topic_0000001745376470_store">store.config.server</a>必须填写为反向代理服务器的ip/域名地址，且需要配置<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-ohpm-repo-configuration#section1074004784011">use_reverse_proxy</a>值为true。</li><li id="li793783920569">config.yaml中各项配置的详细描述请见：<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-ohpm-repo-configuration">配置文件</a>。</li></ul> </div></div></div> </li></ul> </li><li id="li15297112328">进入ohpm-repo解压目录的bin目录下，执行安装命令:<div _ngcontent-adn-c106="" class="highlight-div"><div _ngcontent-adn-c106="" class="highlight-div-header"><div _ngcontent-adn-c106="" class="highlight-div-header-left"><div _ngcontent-adn-c106="" class="handle-button expand-button"><div _ngcontent-adn-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-adn-c106="" class="highlight-div-header-right"><div _ngcontent-adn-c106="" class="handle-button ai-button"></div><div _ngcontent-adn-c106="" class="handle-button line-button"><div _ngcontent-adn-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-adn-c106="" class="handle-button theme-button"><div _ngcontent-adn-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-adn-c106="" class="handle-button copy-button"><div _ngcontent-adn-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-adn-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-undefined" id="ZH-CN_TOPIC_0000002510293669__zh-cn_topic_0000001745217302_screen1686451292171146" data-highlighted="yes"><ol class="linenums"><li>ohpm-repo install </li></ol></pre></div></div> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p id="ZH-CN_TOPIC_0000002510293669__p17629419113217">不配置参数--config，默认使用ohpm-repo根目录中conf目录内自带的配置文件config.yaml。</p> </div></div></div> <p id="ZH-CN_TOPIC_0000002510293669__zh-cn_topic_0000001745217302_p141632310566">启动成功日志信息如下：</p> <p id="ZH-CN_TOPIC_0000002510293669__zh-cn_topic_0000001745217302_p17932103765514"></p> <div _ngcontent-adn-c106="" class="highlight-div"><div _ngcontent-adn-c106="" class="highlight-div-header"><div _ngcontent-adn-c106="" class="highlight-div-header-left"><div _ngcontent-adn-c106="" class="handle-button expand-button"><div _ngcontent-adn-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-adn-c106="" class="highlight-div-header-right"><div _ngcontent-adn-c106="" class="handle-button ai-button"></div><div _ngcontent-adn-c106="" class="handle-button line-button"><div _ngcontent-adn-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-adn-c106="" class="handle-button theme-button"><div _ngcontent-adn-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-adn-c106="" class="handle-button copy-button"><div _ngcontent-adn-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-adn-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-csharp" id="ZH-CN_TOPIC_0000002510293669__screen1735710435295" data-highlighted="yes"><ol class="linenums"><li>PS D:\&gt; ohpm-repo install</li><li>[<span class="hljs-meta">2025-08-26T14:29:15.153</span>] [WARN] <span class="hljs-literal">default</span> - <span class="hljs-string">"listen"</span> protocol <span class="hljs-keyword">is</span> <span class="hljs-keyword">set</span> to <span class="hljs-string">'http'</span> <span class="hljs-keyword">in</span> <span class="hljs-string">"config.yaml"</span> file, which <span class="hljs-keyword">is</span> insecure, advise to use the more secure <span class="hljs-string">'https'</span> protocol instead.</li><li>[<span class="hljs-meta">2025-08-26T14:29:15.178</span>] [INFO] <span class="hljs-literal">default</span> - initialize encryption component successfully.</li><li>[<span class="hljs-meta">2025-08-26T14:29:15.179</span>] [INFO] <span class="hljs-literal">default</span> - initialize <span class="hljs-string">"file database"</span> successfully.</li><li>[<span class="hljs-meta">2025-08-26T14:29:15.184</span>] [INFO] <span class="hljs-literal">default</span> - initialize <span class="hljs-string">"file storage"</span> successfully.</li><li>。。。</li><li>[<span class="hljs-meta">2025-08-26T14:29:15.194</span>] [INFO] console - install successfully.</li><li>[<span class="hljs-meta">2025-08-26T14:29:15.195</span>] [INFO] <span class="hljs-literal">default</span> - <span class="hljs-string">"deploy_root"</span> environment variables: <span class="hljs-string">"OHPM_REPO_DEPLOY_ROOT = C:\Users\xxx\AppData\Roaming\Huawei\ohpm-repo"</span>.</li></ol></pre></div></div> </li><li id="li250132817324">安装成功后，必须根据给出的提示信息及时刷新环境变量，针对Windows系统和Linux/Mac系统，有不同处理方式：<div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><ul id="ZH-CN_TOPIC_0000002510293669__zh-cn_topic_0000001745217302_ul1718201014171146"><li id="zh-cn_topic_0000001745217302_li70223595171146">Windows系统： 关闭当前窗口，重新开启一个窗口。</li><li id="zh-cn_topic_0000001745217302_li1251592455171146">Linux系统或Mac系统： 在命令行中执行刷新命令：当shell为bash时执行<em><strong>source ~/.bashrc</strong></em> 或者 .<strong><em> ~/.bashrc</em></strong> ；当shell为zsh时，执行<em>source ~/.zshrc</em> 或者 .<em> ~/.zshrc</em> 。</li></ul> </div></div></div> </li></ol> </div> <div class="tiledSection"><h2 id="section115745219378">启动ohpm-repo<i class="anchor-icon anchor-icon-link" anchorid="section115745219378" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510293669__p457311283716">执行start命令启动ohpm-repo。</p> <div _ngcontent-adn-c106="" class="highlight-div"><div _ngcontent-adn-c106="" class="highlight-div-header"><div _ngcontent-adn-c106="" class="highlight-div-header-left"><div _ngcontent-adn-c106="" class="handle-button expand-button"><div _ngcontent-adn-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-adn-c106="" class="highlight-div-header-right"><div _ngcontent-adn-c106="" class="handle-button ai-button"></div><div _ngcontent-adn-c106="" class="handle-button line-button"><div _ngcontent-adn-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-adn-c106="" class="handle-button theme-button"><div _ngcontent-adn-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-adn-c106="" class="handle-button copy-button"><div _ngcontent-adn-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-adn-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-sql" id="ZH-CN_TOPIC_0000002510293669__screen155731273713" data-highlighted="yes"><ol class="linenums"><li>ohpm<span class="hljs-operator">-</span>repo <span class="hljs-keyword">start</span> </li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002510293669__p7574192153712">启动成功日志信息如下：</p> <div _ngcontent-adn-c106="" class="highlight-div"><div _ngcontent-adn-c106="" class="highlight-div-header"><div _ngcontent-adn-c106="" class="highlight-div-header-left"><div _ngcontent-adn-c106="" class="handle-button expand-button"><div _ngcontent-adn-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-adn-c106="" class="highlight-div-header-right"><div _ngcontent-adn-c106="" class="handle-button ai-button"></div><div _ngcontent-adn-c106="" class="handle-button line-button"><div _ngcontent-adn-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-adn-c106="" class="handle-button theme-button"><div _ngcontent-adn-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-adn-c106="" class="handle-button copy-button"><div _ngcontent-adn-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-adn-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" id="ZH-CN_TOPIC_0000002510293669__screen4181373214" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-variable">PS</span> <span class="hljs-variable">D</span>:\&gt; <span class="hljs-title class_">ohpm</span>-<span class="hljs-title class_">repo</span> <span class="hljs-title class_">start</span></li><li>[<span class="hljs-number">2025</span>-<span class="hljs-number">08</span>-<span class="hljs-number">26</span><span class="hljs-variable">T14</span>:<span class="hljs-number">31</span>:<span class="hljs-number">22.209</span>] [<span class="hljs-variable">WARN</span>] <span class="hljs-variable">default</span> - <span class="hljs-string">"listen"</span> <span class="hljs-variable">protocol</span> <span class="hljs-keyword">is</span> <span class="hljs-variable">set</span> <span class="hljs-variable">to</span> <span class="hljs-string">'http'</span> <span class="hljs-keyword">in</span> <span class="hljs-string">"config.yaml"</span> <span class="hljs-variable">file</span>, <span class="hljs-variable">which</span> <span class="hljs-keyword">is</span> <span class="hljs-variable">insecure</span>, <span class="hljs-variable">advise</span> <span class="hljs-variable">to</span> <span class="hljs-variable">use</span> <span class="hljs-variable">the</span> <span class="hljs-variable">more</span> <span class="hljs-variable">secure</span> <span class="hljs-string">'https'</span> <span class="hljs-variable">protocol</span> <span class="hljs-variable">instead</span>.</li><li>[<span class="hljs-number">2025</span>-<span class="hljs-number">08</span>-<span class="hljs-number">26</span><span class="hljs-variable">T14</span>:<span class="hljs-number">31</span>:<span class="hljs-number">22.211</span>] [<span class="hljs-variable">INFO</span>] <span class="hljs-variable">default</span> - <span class="hljs-variable">config</span> <span class="hljs-variable">file</span> <span class="hljs-variable">path</span>: <span class="hljs-string">"C:\Users\xxx\AppData\Roaming\Huawei\ohpm-repo\conf\config.yaml"</span>.</li><li>[<span class="hljs-number">2025</span>-<span class="hljs-number">08</span>-<span class="hljs-number">26</span><span class="hljs-variable">T14</span>:<span class="hljs-number">31</span>:<span class="hljs-number">22.216</span>] [<span class="hljs-variable">INFO</span>] <span class="hljs-variable">default</span> - <span class="hljs-variable">initialize</span> <span class="hljs-string">"file database"</span> <span class="hljs-variable">successfully</span>.</li><li>[<span class="hljs-number">2025</span>-<span class="hljs-number">08</span>-<span class="hljs-number">26</span><span class="hljs-variable">T14</span>:<span class="hljs-number">31</span>:<span class="hljs-number">22.217</span>] [<span class="hljs-variable">INFO</span>] <span class="hljs-variable">default</span> - <span class="hljs-variable">initialize</span> <span class="hljs-string">"file storage"</span> <span class="hljs-variable">successfully</span>.</li><li>[<span class="hljs-number">2025</span>-<span class="hljs-number">08</span>-<span class="hljs-number">26</span><span class="hljs-variable">T14</span>:<span class="hljs-number">31</span>:<span class="hljs-number">22.237</span>] [<span class="hljs-variable">INFO</span>] <span class="hljs-variable">console</span> - <span class="hljs-variable">http</span> <span class="hljs-variable">address</span> - <span class="hljs-variable">localhost</span>:<span class="hljs-number">8088</span> - <span class="hljs-title class_">ohpm</span>-<span class="hljs-title class_">repo</span>/<span class="hljs-number">5.1</span><span class="hljs-number">.5</span>.</li></ol></pre></div></div> </div> </div> <div></div></div>