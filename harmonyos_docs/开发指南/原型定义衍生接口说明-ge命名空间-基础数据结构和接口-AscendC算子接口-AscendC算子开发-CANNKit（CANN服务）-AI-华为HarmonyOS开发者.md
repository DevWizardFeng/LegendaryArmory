<h1 _ngcontent-mxx-c119="" class="doc-title ng-star-inserted" title="原型定义衍生接口说明"> 原型定义衍生接口说明 </h1>

<div _ngcontent-mxx-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div><p>算子原型定义的相关接口会自动生成对应的衍生接口，可用于IR模型构建。</p> <div class="tiledSection"><h2 id="section109057mcpsimp">REG_OP<i class="anchor-icon anchor-icon-link" anchorid="section109057mcpsimp" tips="复制节点链接"></i></h2><p>注册算子类型后，会自动生成算子类型的两个构造函数。</p> <p>例如，注册算子的类型名称Conv2D，可调用REG_OP(Conv2D)接口，调用该接口后，定义了算子的类型名称Conv2D，同时产生Conv2D的两个构造函数，其中，<strong>Conv2D(const AscendString&amp; name)</strong>需指定算子名称，Conv2D()使用默认算子名称。</p> <div _ngcontent-mxx-c106="" class="highlight-div"><div _ngcontent-mxx-c106="" class="highlight-div-header"><div _ngcontent-mxx-c106="" class="highlight-div-header-left"><div _ngcontent-mxx-c106="" class="handle-button expand-button"><div _ngcontent-mxx-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mxx-c106="" class="highlight-div-header-right"><div _ngcontent-mxx-c106="" class="handle-button ai-button"></div><div _ngcontent-mxx-c106="" class="handle-button line-button"><div _ngcontent-mxx-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mxx-c106="" class="handle-button theme-button"><div _ngcontent-mxx-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mxx-c106="" class="handle-button copy-button"><div _ngcontent-mxx-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mxx-c106="" class="highlight-scroll-div"><pre class="cpp prettyprint linenums hljs language-cpp" hw-language="cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Conv2D</span> : <span class="hljs-keyword">public</span> Operator { </li><li>    <span class="hljs-keyword">typedef</span> Conv2D _THIS_TYPE; </li><li><span class="hljs-keyword">public</span>: </li><li>    <span class="hljs-function"><span class="hljs-keyword">explicit</span> <span class="hljs-title">Conv2D</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span> *name)</span></span>; </li><li>    <span class="hljs-function"><span class="hljs-keyword">explicit</span> <span class="hljs-title">Conv2D</span><span class="hljs-params">()</span></span>; </li><li>}</li></ol></pre></div></div> </div> <div class="tiledSection"><h2 id="section109062mcpsimp">INPUT<i class="anchor-icon anchor-icon-link" anchorid="section109062mcpsimp" tips="复制节点链接"></i></h2><p>注册算子输入信息成功后，自动生成算子输入的相关接口，用于获取算子输入的名称、设置算子输入的对应描述等。</p> <p>例如，注册算子输入x，算子输入支持的数据类型为TensorType{DT_FLOAT}，可调用<strong>INPUT(x, TensorType{DT_FLOAT})</strong>接口，注册算子输入成功后，自动生成以下相关接口：</p> <div _ngcontent-mxx-c106="" class="highlight-div"><div _ngcontent-mxx-c106="" class="highlight-div-header"><div _ngcontent-mxx-c106="" class="highlight-div-header-left"><div _ngcontent-mxx-c106="" class="handle-button expand-button"><div _ngcontent-mxx-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mxx-c106="" class="highlight-div-header-right"><div _ngcontent-mxx-c106="" class="handle-button ai-button"></div><div _ngcontent-mxx-c106="" class="handle-button line-button"><div _ngcontent-mxx-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mxx-c106="" class="handle-button theme-button"><div _ngcontent-mxx-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mxx-c106="" class="handle-button copy-button"><div _ngcontent-mxx-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mxx-c106="" class="highlight-scroll-div"><pre class="cpp prettyprint linenums hljs language-cpp" hw-language="cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-function"><span class="hljs-type">static</span> <span class="hljs-type">const</span> string <span class="hljs-title">name_in_x</span><span class="hljs-params">()</span></span>; <span class="hljs-comment">// 返回输入的名称，即“x” </span></li><li><span class="hljs-function">_THIS_TYPE &amp;<span class="hljs-title">set_input_x</span><span class="hljs-params">(Operator&amp; v, <span class="hljs-type">const</span> string&amp; srcName)</span></span>; <span class="hljs-comment">// 指定输入x与算子对象v的输出srcName存在连接关系，返回算子对象本身 </span></li><li><span class="hljs-function">_THIS_TYPE &amp;<span class="hljs-title">set_input_x_by_name</span><span class="hljs-params">(Operator&amp; v, <span class="hljs-type">const</span> <span class="hljs-type">char</span> *srcName)</span></span>;   <span class="hljs-comment">// 指定输入x与算子对象v的输出srcName存在连接关系，返回算子对象本身 </span></li><li><span class="hljs-function">_THIS_TYPE &amp;<span class="hljs-title">set_input_x</span><span class="hljs-params">(Operator &amp;v, <span class="hljs-type">uint32_t</span> index)</span></span>; <span class="hljs-comment">// 指定输入x与算子对象v的索引为index的输出存在连接关系，返回算子对象本身 </span></li><li><span class="hljs-function">_THIS_TYPE &amp;<span class="hljs-title">set_input_x</span><span class="hljs-params">(Operator&amp; v)</span></span>; <span class="hljs-comment">// 指定输入x与算子对象v的索引0的输出存在连接关系，返回算子对象本身 </span></li><li><span class="hljs-function">TensorDesc <span class="hljs-title">get_input_desc_x</span><span class="hljs-params">()</span></span>; <span class="hljs-comment">// 返回输入x对应的描述 </span></li><li><span class="hljs-function">graphStatus <span class="hljs-title">update_input_desc_x</span><span class="hljs-params">(<span class="hljs-type">const</span> TensorDesc&amp; tensorDesc)</span></span>;<span class="hljs-comment">// 设置输入x对应的描述，包括Shape、DataType、Format等信息，graphStatus即uint32_t类型，返回非0表示出错</span></li></ol></pre></div></div> </div> <div class="tiledSection"><h2 id="section109067mcpsimp">OPTIONAL_INPUT<i class="anchor-icon anchor-icon-link" anchorid="section109067mcpsimp" tips="复制节点链接"></i></h2><p>注册可选算子输入信息成功后，自动生成算子输入的相关接口，用于获取算子输入的名称、设置算子输入的对应描述等。</p> <p>例如，注册算子输入b，算子输入支持的数据类型为TensorType{DT_FLOAT}，可调用<strong>OPTIONAL_INPUT(b, TensorType{DT_FLOAT})</strong>接口，注册算子输入成功后，自动生成以下相关接口：</p> <div _ngcontent-mxx-c106="" class="highlight-div"><div _ngcontent-mxx-c106="" class="highlight-div-header"><div _ngcontent-mxx-c106="" class="highlight-div-header-left"><div _ngcontent-mxx-c106="" class="handle-button expand-button"><div _ngcontent-mxx-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mxx-c106="" class="highlight-div-header-right"><div _ngcontent-mxx-c106="" class="handle-button ai-button"></div><div _ngcontent-mxx-c106="" class="handle-button line-button"><div _ngcontent-mxx-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mxx-c106="" class="handle-button theme-button"><div _ngcontent-mxx-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mxx-c106="" class="handle-button copy-button"><div _ngcontent-mxx-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mxx-c106="" class="highlight-scroll-div"><pre class="cpp prettyprint linenums hljs language-cpp" hw-language="cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-function"><span class="hljs-type">static</span> <span class="hljs-type">const</span> string <span class="hljs-title">name_in_b</span><span class="hljs-params">()</span></span>; <span class="hljs-comment">// 返回输入的名称，即“b” </span></li><li><span class="hljs-function">_THIS_TYPE&amp; <span class="hljs-title">set_input_b</span><span class="hljs-params">(Operator&amp; v, <span class="hljs-type">const</span> string&amp; srcName)</span></span>;<span class="hljs-comment">// 指定输入b与算子对象v的输出srcName存在连接关系，返回算子对象本身 </span></li><li><span class="hljs-function">_THIS_TYPE&amp; <span class="hljs-title">set_input_b_by_name</span><span class="hljs-params">(Operator&amp; v, <span class="hljs-type">const</span> <span class="hljs-type">char</span> *srcName)</span></span>;<span class="hljs-comment">// 指定输入b与算子对象v的输出srcName存在连接关系，返回算子对象本身 </span></li><li><span class="hljs-function">_THIS_TYPE&amp; <span class="hljs-title">set_input_b</span><span class="hljs-params">(Operator&amp; v)</span></span>; <span class="hljs-comment">// 指定输入b与算子对象v的索引0的输出存在连接关系，返回算子对象本身 </span></li><li><span class="hljs-function">TensorDesc <span class="hljs-title">get_input_desc_b</span><span class="hljs-params">()</span></span>; <span class="hljs-comment">// 返回输入b对应的描述 </span></li><li><span class="hljs-function">graphStatus <span class="hljs-title">update_input_desc_b</span><span class="hljs-params">(<span class="hljs-type">const</span> TensorDesc&amp; tensorDesc)</span></span>;<span class="hljs-comment">// 设置输入b对应的描述，包括Shape、DataType、Format等信息</span></li></ol></pre></div></div> </div> <div class="tiledSection"><h2 id="section109072mcpsimp">DYNAMIC_INPUT<i class="anchor-icon anchor-icon-link" anchorid="section109072mcpsimp" tips="复制节点链接"></i></h2><p>注册动态算子输入信息成功后，自动生成算子输入的相关接口，用于创建动态输入、设置算子输入的对应描述等。</p> <p>例如，注册算子的动态输入d，算子输入支持的数据类型为TensorType{DT_FLOAT}，可调用<strong>DYNAMIC_INPUT(d, TensorType{DT_FLOAT})</strong>接口，注册算子的动态输入成功后，自动生成以下相关接口：</p> <div _ngcontent-mxx-c106="" class="highlight-div"><div _ngcontent-mxx-c106="" class="highlight-div-header"><div _ngcontent-mxx-c106="" class="highlight-div-header-left"><div _ngcontent-mxx-c106="" class="handle-button expand-button"><div _ngcontent-mxx-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mxx-c106="" class="highlight-div-header-right"><div _ngcontent-mxx-c106="" class="handle-button ai-button"></div><div _ngcontent-mxx-c106="" class="handle-button line-button"><div _ngcontent-mxx-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mxx-c106="" class="handle-button theme-button"><div _ngcontent-mxx-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mxx-c106="" class="handle-button copy-button"><div _ngcontent-mxx-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mxx-c106="" class="highlight-scroll-div"><pre class="cpp prettyprint linenums hljs language-cpp" hw-language="cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-function">_THIS_TYPE&amp; <span class="hljs-title">create_dynamic_input_d</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> num)</span></span>; <span class="hljs-comment">// 创建动态输入d，包括num个输入，并且把这个输入做为算子最后的输入 </span></li><li><span class="hljs-function">_THIS_TYPE &amp;<span class="hljs-title">create_dynamic_input_byindex_d</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> num, <span class="hljs-type">size_t</span> index)</span> <span class="hljs-comment">// 创建动态输入d，包括num个输入，插入到索引为index的位置，和create_dynamic_input_d不能同时使用 </span></span></li><li><span class="hljs-function">TensorDesc <span class="hljs-title">get_dynamic_input_desc_d</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> index)</span></span>;<span class="hljs-comment">// 返回动态输入d第index个描述，包括Shape、DataType、Format等信息 </span></li><li><span class="hljs-function">graphStatus <span class="hljs-title">update_dynamic_input_desc_d</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> index, <span class="hljs-type">const</span> TensorDesc&amp; tensorDesc)</span></span>;<span class="hljs-comment">// 更新动态输入d的第index个描述 </span></li><li><span class="hljs-function">_THIS_TYPE&amp; <span class="hljs-title">set_dynamic_input_d</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> dstIndex, Operator &amp;v)</span></span>; <span class="hljs-comment">// 设置输入d的第dstIndex个输入与算子对象v的索引0的输出存在连接关系，返回算子对象本身 </span></li><li><span class="hljs-function">_THIS_TYPE&amp; <span class="hljs-title">set_dynamic_input_d</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> dstIndex, Operator &amp;v, <span class="hljs-type">const</span> string &amp;srcName)</span></span>; <span class="hljs-comment">// 指定动态输入d的第dstIndex个输入与算子对象v的输出srcName存在连接关系，返回算子对象本身 </span></li><li><span class="hljs-function">_THIS_TYPE&amp; <span class="hljs-title">set_dynamic_input_d</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> dstIndex, Operator &amp;v, <span class="hljs-type">const</span> <span class="hljs-type">char</span> *srcName)</span></span>; <span class="hljs-comment">// 指定动态输入d的第dstIndex个输入与算子对象v的输出srcName存在连接关系，返回算子对象本身</span></li></ol></pre></div></div> </div> <div class="tiledSection"><h2 id="section109077mcpsimp">OUTPUT<i class="anchor-icon anchor-icon-link" anchorid="section109077mcpsimp" tips="复制节点链接"></i></h2><p>注册算子输出信息成功后，自动生成算子输出的相关接口，开发者获取算子输出的名称、获取算子输出的描述、设置算子输出的描述。</p> <p>例如，注册算子输出y，算子输出支持的数据类型为TensorType{DT_FLOAT}，可调用<strong>OUTPUT(y, TensorType{DT_FLOAT})</strong>接口，注册算子输出成功后，自动生成以下相关接口：</p> <div _ngcontent-mxx-c106="" class="highlight-div"><div _ngcontent-mxx-c106="" class="highlight-div-header"><div _ngcontent-mxx-c106="" class="highlight-div-header-left"><div _ngcontent-mxx-c106="" class="handle-button expand-button"><div _ngcontent-mxx-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mxx-c106="" class="highlight-div-header-right"><div _ngcontent-mxx-c106="" class="handle-button ai-button"></div><div _ngcontent-mxx-c106="" class="handle-button line-button"><div _ngcontent-mxx-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mxx-c106="" class="handle-button theme-button"><div _ngcontent-mxx-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mxx-c106="" class="handle-button copy-button"><div _ngcontent-mxx-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mxx-c106="" class="highlight-scroll-div"><pre class="cpp prettyprint linenums hljs language-cpp" hw-language="cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-function"><span class="hljs-type">static</span> <span class="hljs-type">const</span> string <span class="hljs-title">name_out_y</span><span class="hljs-params">()</span></span>;<span class="hljs-comment">// 返回输出的名称，即“y” </span></li><li><span class="hljs-function">TensorDesc <span class="hljs-title">get_output_desc_y</span><span class="hljs-params">()</span></span>;<span class="hljs-comment">// 返回输出y对应的描述 </span></li><li><span class="hljs-function">graphStatus <span class="hljs-title">update_output_desc_y</span><span class="hljs-params">(<span class="hljs-type">const</span> TensorDesc&amp; tensorDesc)</span></span>; <span class="hljs-comment">// 设置输出y对应的描述，包括Shape、DataType、Format等信息</span></li></ol></pre></div></div> </div> <div class="tiledSection"><h2 id="section109082mcpsimp">DYNAMIC_OUTPUT<i class="anchor-icon anchor-icon-link" anchorid="section109082mcpsimp" tips="复制节点链接"></i></h2><p>注册动态算子输出信息成功后，自动生成动态算子输出的相关接口，包括用于创建动态输出、设置算子输出的对应描述等。</p> <p>例如，注册动态算子输出d，算子输出支持的数据类型为TensorType{DT_FLOAT}，可调用<strong>DYNAMIC_OUTPUT(d, TensorType{DT_FLOAT})</strong>接口，注册动态算子输出成功后，自动生成以下相关接口：</p> <div _ngcontent-mxx-c106="" class="highlight-div"><div _ngcontent-mxx-c106="" class="highlight-div-header"><div _ngcontent-mxx-c106="" class="highlight-div-header-left"><div _ngcontent-mxx-c106="" class="handle-button expand-button"><div _ngcontent-mxx-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mxx-c106="" class="highlight-div-header-right"><div _ngcontent-mxx-c106="" class="handle-button ai-button"></div><div _ngcontent-mxx-c106="" class="handle-button line-button"><div _ngcontent-mxx-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mxx-c106="" class="handle-button theme-button"><div _ngcontent-mxx-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mxx-c106="" class="handle-button copy-button"><div _ngcontent-mxx-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mxx-c106="" class="highlight-scroll-div"><pre class="cpp prettyprint linenums hljs language-cpp" hw-language="cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-function">_THIS_TYPE&amp; <span class="hljs-title">create_dynamic_output_d</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> num)</span></span>; <span class="hljs-comment">// 创建动态输出d，包括num个输出 </span></li><li><span class="hljs-function">TensorDesc <span class="hljs-title">get_dynamic_output_desc_d</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> index)</span></span>;<span class="hljs-comment">// 返回动态输出d第index个描述，包括Shape、DataType、Format等信息 </span></li><li><span class="hljs-function">graphStatus <span class="hljs-title">update_dynamic_output_desc_d</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> index, <span class="hljs-type">const</span> TensorDesc&amp; tensorDesc)</span></span>;<span class="hljs-comment">// 更新动态输出d的第index个描述</span></li></ol></pre></div></div> </div> <div class="tiledSection"><h2 id="section109087mcpsimp">REQUIRED_ATTR<i class="anchor-icon anchor-icon-link" anchorid="section109087mcpsimp" tips="复制节点链接"></i></h2><p>注册算子属性成功后，自动生成算子属性的3个对外接口，用于获取属性的名称、获取属性的值、设置属性的值。</p> <p>例如，注册类型为int64_t的属性mode，可调用<strong>REQUIRED_ATTR(mode, Int)</strong>接口，注册算子属性成功后，会自动生成如下接口：</p> <div _ngcontent-mxx-c106="" class="highlight-div"><div _ngcontent-mxx-c106="" class="highlight-div-header"><div _ngcontent-mxx-c106="" class="highlight-div-header-left"><div _ngcontent-mxx-c106="" class="handle-button expand-button"><div _ngcontent-mxx-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mxx-c106="" class="highlight-div-header-right"><div _ngcontent-mxx-c106="" class="handle-button ai-button"></div><div _ngcontent-mxx-c106="" class="handle-button line-button"><div _ngcontent-mxx-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mxx-c106="" class="handle-button theme-button"><div _ngcontent-mxx-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mxx-c106="" class="handle-button copy-button"><div _ngcontent-mxx-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mxx-c106="" class="highlight-scroll-div"><pre class="cpp prettyprint linenums hljs language-cpp" hw-language="cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-function"><span class="hljs-type">static</span> <span class="hljs-type">const</span> string <span class="hljs-title">name_attr_mode</span><span class="hljs-params">()</span></span>; <span class="hljs-comment">// 返回属性的名称，即“mode” </span></li><li><span class="hljs-function"><span class="hljs-type">static</span> <span class="hljs-type">const</span> <span class="hljs-type">void</span> <span class="hljs-title">name_attr_mode</span><span class="hljs-params">(AscendString &amp;attr_name)</span></span>;<span class="hljs-comment">// 出参获取属性的名称，即“mode” </span></li><li><span class="hljs-function">OpInt <span class="hljs-title">get_attr_mode</span><span class="hljs-params">()</span> <span class="hljs-type">const</span></span>; <span class="hljs-comment">// 返回mode属性的值，OpInt即int64_t </span></li><li><span class="hljs-function">_THIS_TYPE&amp; <span class="hljs-title">set_attr_mode</span><span class="hljs-params">(<span class="hljs-type">const</span> OpInt&amp; v)</span></span>; <span class="hljs-comment">// 设置mode属性的值，返回算子对象本身</span></li></ol></pre></div></div> </div> <div class="tiledSection"><h2 id="section109092mcpsimp">ATTR<i class="anchor-icon anchor-icon-link" anchorid="section109092mcpsimp" tips="复制节点链接"></i></h2><p>注册算子属性成功后，自动生成算子属性的3个对外接口，用于获取属性的名称、获取属性的值、设置属性的值。</p> <p>下面以注册类型为int64_t的属性、类型为int64_t列表两种场景为例，说明所生成的算子属性接口：</p> <ul><li>调用ATTR(mode, Int, 1)接口，注册属性mode，属性类型为int64_t，默认值为1。<p>注册属性成功后，自动生成以下接口：</p> <div _ngcontent-mxx-c106="" class="highlight-div"><div _ngcontent-mxx-c106="" class="highlight-div-header"><div _ngcontent-mxx-c106="" class="highlight-div-header-left"><div _ngcontent-mxx-c106="" class="handle-button expand-button"><div _ngcontent-mxx-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mxx-c106="" class="highlight-div-header-right"><div _ngcontent-mxx-c106="" class="handle-button ai-button"></div><div _ngcontent-mxx-c106="" class="handle-button line-button"><div _ngcontent-mxx-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mxx-c106="" class="handle-button theme-button"><div _ngcontent-mxx-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mxx-c106="" class="handle-button copy-button"><div _ngcontent-mxx-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mxx-c106="" class="highlight-scroll-div"><pre class="cpp prettyprint linenums hljs language-cpp" hw-language="cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-function"><span class="hljs-type">static</span> <span class="hljs-type">const</span> string <span class="hljs-title">name_attr_mode</span><span class="hljs-params">()</span></span>; <span class="hljs-comment">// 返回属性的名称，即“mode” </span></li><li> <span class="hljs-function"><span class="hljs-type">static</span> <span class="hljs-type">const</span> <span class="hljs-type">void</span> <span class="hljs-title">name_attr_mode</span><span class="hljs-params">(AscendString &amp;attr_name)</span></span>;<span class="hljs-comment">// 出参获取属性的名称，即“mode” </span></li><li> <span class="hljs-function">OpInt <span class="hljs-title">get_attr_mode</span><span class="hljs-params">()</span> <span class="hljs-type">const</span></span>; <span class="hljs-comment">// 返回mode属性的值，OpInt即int64_t </span></li><li> <span class="hljs-function">_THIS_TYPE&amp; <span class="hljs-title">set_attr_mode</span><span class="hljs-params">(<span class="hljs-type">const</span> OpInt&amp; v)</span></span>; <span class="hljs-comment">// 设置mode属性的值，返回算子对象本身</span></li></ol></pre></div></div> </li><li>调用ATTR(pad, ListInt, {0, 0, 0, 0})接口，注册属性pad，属性类型为int64_t列表，默认值为{0,0,0,0}。<p>注册属性成功后，自动生成以下接口：</p> <div _ngcontent-mxx-c106="" class="highlight-div"><div _ngcontent-mxx-c106="" class="highlight-div-header"><div _ngcontent-mxx-c106="" class="highlight-div-header-left"><div _ngcontent-mxx-c106="" class="handle-button expand-button"><div _ngcontent-mxx-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mxx-c106="" class="highlight-div-header-right"><div _ngcontent-mxx-c106="" class="handle-button ai-button"></div><div _ngcontent-mxx-c106="" class="handle-button line-button"><div _ngcontent-mxx-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mxx-c106="" class="handle-button theme-button"><div _ngcontent-mxx-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mxx-c106="" class="handle-button copy-button"><div _ngcontent-mxx-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mxx-c106="" class="highlight-scroll-div"><pre class="cpp prettyprint linenums hljs language-cpp" hw-language="cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-function"><span class="hljs-type">static</span> <span class="hljs-type">const</span> string <span class="hljs-title">name_attr_pad</span><span class="hljs-params">()</span></span>; <span class="hljs-comment">// 返回属性的名称，即“pad” </span></li><li> <span class="hljs-function"><span class="hljs-type">static</span> <span class="hljs-type">const</span> <span class="hljs-type">void</span> <span class="hljs-title">name_attr_pad</span><span class="hljs-params">(AscendString &amp;attr_name)</span></span>;<span class="hljs-comment">// 出参获取属性的名称，即“pad” </span></li><li> <span class="hljs-function">OpListInt <span class="hljs-title">get_attr_pad</span><span class="hljs-params">()</span> <span class="hljs-type">const</span></span>;  <span class="hljs-comment">// 返回属性pad的值，OpListInt即vector&lt;int64_t&gt; </span></li><li> <span class="hljs-function">_THIS_TYPE&amp; <span class="hljs-title">set_attr_pad</span><span class="hljs-params">(<span class="hljs-type">const</span> OpListInt&amp; v)</span></span>; <span class="hljs-comment">// 设置属性pad的值，返回算子对象本身</span></li></ol></pre></div></div> </li></ul> <p>下面以注册类型为string属性场景为例，说明所生成的算子属性接口：</p> <p>调用ATTR(data_format, String, "NHWC")接口，注册属性data_format，属性类型为string。</p> <div _ngcontent-mxx-c106="" class="highlight-div"><div _ngcontent-mxx-c106="" class="highlight-div-header"><div _ngcontent-mxx-c106="" class="highlight-div-header-left"><div _ngcontent-mxx-c106="" class="handle-button expand-button"><div _ngcontent-mxx-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mxx-c106="" class="highlight-div-header-right"><div _ngcontent-mxx-c106="" class="handle-button ai-button"></div><div _ngcontent-mxx-c106="" class="handle-button line-button"><div _ngcontent-mxx-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mxx-c106="" class="handle-button theme-button"><div _ngcontent-mxx-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mxx-c106="" class="handle-button copy-button"><div _ngcontent-mxx-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mxx-c106="" class="highlight-scroll-div"><pre class="cpp prettyprint linenums hljs language-cpp" hw-language="cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-function"><span class="hljs-type">static</span> <span class="hljs-type">const</span> string <span class="hljs-title">name_attr_data_format</span><span class="hljs-params">()</span></span>; <span class="hljs-comment">// 返回属性的名称，即“data_format” </span></li><li><span class="hljs-function"><span class="hljs-type">static</span> <span class="hljs-type">const</span> <span class="hljs-type">void</span> <span class="hljs-title">name_attr_data_format</span><span class="hljs-params">(AscendString &amp;attr_name)</span></span>;<span class="hljs-comment">// 出参获取属性的名称，即“data_format” </span></li><li><span class="hljs-function">OpString <span class="hljs-title">get_attr_data_format</span><span class="hljs-params">()</span> <span class="hljs-type">const</span></span>; <span class="hljs-comment">// 返回data_format属性的值，OpString即string </span></li><li><span class="hljs-function">graphStatus <span class="hljs-title">get_attr_data_format</span><span class="hljs-params">(AscendString &amp;val)</span></span>;<span class="hljs-comment">// 出参返回data_format属性的值  </span></li><li><span class="hljs-function">_THIS_TYPE&amp; <span class="hljs-title">set_attr_data_format</span><span class="hljs-params">(<span class="hljs-type">const</span> string&amp; v)</span></span>; <span class="hljs-comment">// 设置data_format属性的值，返回算子对象本身 </span></li><li><span class="hljs-function">_THIS_TYPE&amp; <span class="hljs-title">set_attr_data_format</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span>* v)</span></span>; <span class="hljs-comment">// 设置data_format属性的值，返回算子对象本身</span></li></ol></pre></div></div> </div> <div class="tiledSection"><h2 id="section109111mcpsimp">GRAPH<i class="anchor-icon anchor-icon-link" anchorid="section109111mcpsimp" tips="复制节点链接"></i></h2><p>注册算子子图信息成功后，自动生成算子子图的相关接口，开发者获取算子子图的名称、获取算子子图的描述、设置算子子图的描述。</p> <p>例如，注册算子子图y，可调用<strong>GRAPH(y)</strong>接口，注册算子子图成功后，自动生成以下相关接口：</p> <div _ngcontent-mxx-c106="" class="highlight-div"><div _ngcontent-mxx-c106="" class="highlight-div-header"><div _ngcontent-mxx-c106="" class="highlight-div-header-left"><div _ngcontent-mxx-c106="" class="handle-button expand-button"><div _ngcontent-mxx-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mxx-c106="" class="highlight-div-header-right"><div _ngcontent-mxx-c106="" class="handle-button ai-button"></div><div _ngcontent-mxx-c106="" class="handle-button line-button"><div _ngcontent-mxx-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mxx-c106="" class="handle-button theme-button"><div _ngcontent-mxx-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mxx-c106="" class="handle-button copy-button"><div _ngcontent-mxx-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mxx-c106="" class="highlight-scroll-div"><pre class="cpp prettyprint linenums hljs language-cpp" hw-language="cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-function"><span class="hljs-type">static</span> <span class="hljs-type">const</span> string <span class="hljs-title">name_graph_y</span><span class="hljs-params">()</span></span>;<span class="hljs-comment">// 返回算子子图的名称，即“y” </span></li><li><span class="hljs-function">SubgraphBuilder <span class="hljs-title">get_subgraph_builder_y</span><span class="hljs-params">()</span> <span class="hljs-type">const</span></span>;<span class="hljs-comment">// 返回子图y对应的构建函数对象 </span></li><li><span class="hljs-function">_THIS_TYPE &amp;<span class="hljs-title">set_subgraph_builder_y</span><span class="hljs-params">(<span class="hljs-type">const</span> SubgraphBuilder &amp;v)</span></span>;<span class="hljs-comment">// 设置子图y对应的构建函数对象 </span></li><li><span class="hljs-function">Graph <span class="hljs-title">get_subgraph_y</span><span class="hljs-params">()</span> <span class="hljs-type">const</span></span>;<span class="hljs-comment">// 获取子图y对应的graph对象</span></li></ol></pre></div></div> </div> <div class="tiledSection"><h2 id="section109116mcpsimp">DYNAMIC_GRAPH<i class="anchor-icon anchor-icon-link" anchorid="section109116mcpsimp" tips="复制节点链接"></i></h2><p>注册动态算子子图信息成功后，自动生成动态算子子图的相关接口，包括用于创建动态子图、设置算子子图的对应描述等。</p> <p>例如，注册动态算子子图branches，可调用<strong>DYNAMIC_GRAPH(branches)</strong>接口，注册动态算子子图成功后，自动生成以下相关接口：</p> <div _ngcontent-mxx-c106="" class="highlight-div"><div _ngcontent-mxx-c106="" class="highlight-div-header"><div _ngcontent-mxx-c106="" class="highlight-div-header-left"><div _ngcontent-mxx-c106="" class="handle-button expand-button"><div _ngcontent-mxx-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mxx-c106="" class="highlight-div-header-right"><div _ngcontent-mxx-c106="" class="handle-button ai-button"></div><div _ngcontent-mxx-c106="" class="handle-button line-button"><div _ngcontent-mxx-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mxx-c106="" class="handle-button theme-button"><div _ngcontent-mxx-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mxx-c106="" class="handle-button copy-button"><div _ngcontent-mxx-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mxx-c106="" class="highlight-scroll-div"><pre class="cpp prettyprint linenums hljs language-cpp" hw-language="cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-function">_THIS_TYPE&amp; <span class="hljs-title">create_dynamic_subgraph_branches</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> num)</span></span>; <span class="hljs-comment">// 创建动态子图branches，包括num个子图 </span></li><li><span class="hljs-function">SubgraphBuilder <span class="hljs-title">get_dynamic_subgraph_builder_branches</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> index)</span> </span>;<span class="hljs-comment">// 返回动态输子图第index个子图构建函数对象 </span></li><li><span class="hljs-function">Graph <span class="hljs-title">get_dynamic_subgraph_branches</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> index)</span> </span>;<span class="hljs-comment">// 返回动态输子图第index个子图对象 </span></li><li><span class="hljs-function">_THIS_TYPE &amp;<span class="hljs-title">set_dynamic_subgraph_builder_branches</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> index,<span class="hljs-type">const</span> SubgraphBuilder &amp;v)</span></span>;<span class="hljs-comment">// 设置动态子图branches的第index个子图构建函数对象</span></li></ol></pre></div></div> </div> </div> <div></div></div>