<h1 _ngcontent-swu-c119="" class="doc-title ng-star-inserted" title="原生广告"> 原生广告 </h1>

<div _ngcontent-swu-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div><div class="tiledSection"><h2 id="section17817731534">场景介绍<i class="anchor-icon anchor-icon-link" anchorid="section17817731534" tips="复制节点链接"></i></h2><p>原生广告是与应用内容融于一体的广告，通过“和谐”的内容呈现广告信息，在不破坏用户体验的前提下，为用户提供有价值的信息，展示形式包含图片和视频，支持您自由定制界面。</p> <p><span><img originheight="661" originwidth="320" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114554.90025964419753661320136752595622:50001231000000:2800:D3BA2278232C83B2525293DE595659B929ACA6E2167B5EC40FB7D71FFD7AF502.png" width="320" height="661"></span></p> </div> <div class="tiledSection"><h2 id="section65401229123616">接口说明<i class="anchor-icon anchor-icon-link" anchorid="section65401229123616" tips="复制节点链接"></i></h2> <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.2.2.1.3.1.1" valign="top" width="50%"><p>接口名</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.2.2.1.3.1.2" valign="top" width="50%"><p>描述</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="50%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-advertising#loadad" target="_blank">loadAd</a>(adParam: AdRequestParams, adOptions: AdOptions, listener: AdLoadListener): void</p> </td> <td class="cellrowborder" valign="top" width="50%"><p>请求单广告位广告，通过AdRequestParams、AdOptions进行广告请求参数设置，通过AdLoadListener监听广告请求回调。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="50%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-advertising#loadadwithmultislots" target="_blank">loadAdWithMultiSlots</a>(adParams: AdRequestParams[], adOptions: AdOptions, listener: MultiSlotsAdLoadListener): void</p> </td> <td class="cellrowborder" valign="top" width="50%"><p>请求多广告位广告，通过AdRequestParams[]、AdOptions进行广告请求参数设置，通过MultiSlotsAdLoadListener监听广告请求回调。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="50%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-adcomponent" target="_blank">AdComponent</a>({ads: advertising.Advertisement[], displayOptions: advertising.AdDisplayOptions, interactionListener: advertising.AdInteractionListener, @BuilderParam adRenderer?: () =&gt; void, @Prop rollPlayState?: number})</p> </td> <td class="cellrowborder" valign="top" width="50%"><p>展示广告，通过AdDisplayOptions进行广告展示参数设置，通过AdInteractionListener监听广告状态回调。</p> <p><strong>说明：</strong>为了保证广告能正确展示，该接口必须和请求广告接口配套使用。</p> </td> </tr>  </tbody></table></div> </div> </div> <div class="tiledSection"><h2 id="section1545144014228">AdComponent组件建议宽高<i class="anchor-icon anchor-icon-link" anchorid="section1545144014228" tips="复制节点链接"></i></h2> <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.3.2.1.3.1.1" valign="top" width="50%"><p>样式</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.3.2.1.3.1.2" valign="top" width="50%"><p>建议宽高</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="50%"><p>原生信息流</p> </td> <td class="cellrowborder" valign="top" width="50%"><p>width：与信息流内容保持一致。</p> <p>height：无需设置。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="50%"><p>原生插图</p> </td> <td class="cellrowborder" valign="top" width="50%"><p>width：312vp。</p> <p>height：284vp。</p> </td> </tr>  </tbody></table></div> </div> </div> <div class="tiledSection"><h2 id="section0420810836">开发步骤<i class="anchor-icon anchor-icon-link" anchorid="section0420810836" tips="复制节点链接"></i></h2></div> <div class="tiledSection"><h3 id="section138565238522" class="firsth2">请求广告<i class="anchor-icon anchor-icon-link" anchorid="section138565238522" tips="复制节点链接"></i></h3><ol><li><span>导入相关模块。</span><p></p><div _ngcontent-swu-c106="" class="highlight-div"><div _ngcontent-swu-c106="" class="highlight-div-header"><div _ngcontent-swu-c106="" class="highlight-div-header-left"><div _ngcontent-swu-c106="" class="handle-button expand-button"><div _ngcontent-swu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-swu-c106="" class="highlight-div-header-right"><div _ngcontent-swu-c106="" class="handle-button ai-button"></div><div _ngcontent-swu-c106="" class="handle-button line-button"><div _ngcontent-swu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-swu-c106="" class="handle-button theme-button"><div _ngcontent-swu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-swu-c106="" class="handle-button copy-button"><div _ngcontent-swu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-swu-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { abilityAccessCtrl, common, <span class="hljs-title class_">PermissionRequestResult</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { advertising, identifier } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AdsKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li></ol></pre></div></div> <p></p></li><li><span>获取OAID。</span><p></p><p>若需提升广告推送精准度，可以在请求参数<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-advertising#adrequestparams" target="_blank">AdRequestParams</a>中添加oaid属性。</p> <p>如何获取OAID参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/oaid-service" target="_blank">获取OAID信息</a>。</p> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p>使用以下示例中提供的测试广告位时，必须先获取OAID信息。</p> </div></div></div> <p></p></li><li><span>请求广告。</span><p></p><p>请求广告需要创建一个AdLoader对象。</p> <ul><li>如果要请求单广告位广告，通过AdLoader的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-advertising#loadad" target="_blank">loadAd</a>方法请求广告，通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-advertising#adloadlistener" target="_blank">AdLoadListener</a>来监听广告的加载状态。</li><li>如果要请求多广告位广告，通过AdLoader的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-advertising#loadadwithmultislots" target="_blank">loadAdWithMultiSlots</a>方法请求广告，通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-advertising#multislotsadloadlistener" target="_blank">MultiSlotsAdLoadListener</a>来监听广告的加载状态。</li></ul> <div class="p">请求广告关键参数如下所示： <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.5.2.3.2.3.1.1.5.1.1" valign="top" width="14.21%"><p>请求广告参数名</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.5.2.3.2.3.1.1.5.1.2" valign="top" width="13.900000000000002%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.5.2.3.2.3.1.1.5.1.3" valign="top" width="9.89%"><p>必填</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.5.2.3.2.3.1.1.5.1.4" valign="top" width="62%"><p>说明</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="14.21%"><p>adType</p> </td> <td class="cellrowborder" valign="top" width="13.900000000000002%"><p>number</p> </td> <td class="cellrowborder" valign="top" width="9.89%"><p>是</p> </td> <td class="cellrowborder" valign="top" width="62%"><p>请求广告类型，原生广告类型为3。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="14.21%"><p>adId</p> </td> <td class="cellrowborder" valign="top" width="13.900000000000002%"><p>string</p> </td> <td class="cellrowborder" valign="top" width="9.89%"><p>是</p> </td> <td class="cellrowborder" valign="top" width="62%"><p>广告位ID。</p> <ul><li>如果仅调测广告，可使用测试广告位ID：testy63txaom86（原生视频），testu7m3hc4gvm（原生大图），testb65czjivt9（原生小图），testr6w14o0hqz（原生三图）。</li><li>如果要接入正式广告，则需要申请正式的广告位ID。可在应用发布前进入<a href="https://developer.huawei.com/consumer/cn/monetize" target="_blank">流量变现官网</a>，点击“开始变现”，登录<a href="https://developer.huawei.com/consumer/cn/service/ads/publisher/html/index.html?lang=zh" target="_blank">鲸鸿动能媒体服务平台</a>进行申请，具体操作详情请参见<a href="https://developer.huawei.com/consumer/cn/doc/monetize/zhanshiweichuangjian-0000001132700049" target="_blank">展示位创建</a>。</li></ul> </td> </tr> <tr><td class="cellrowborder" valign="top" width="14.21%"><p>oaid</p> </td> <td class="cellrowborder" valign="top" width="13.900000000000002%"><p>string</p> </td> <td class="cellrowborder" valign="top" width="9.89%"><p>否</p> </td> <td class="cellrowborder" valign="top" width="62%"><p>开放匿名设备标识符，用于精准推送广告。不填无法获取到个性化广告。</p> </td> </tr>  </tbody></table></div> </div> </div> <p>以请求多广告位广告为例，示例代码如下所示：</p> <div _ngcontent-swu-c106="" class="highlight-div"><div _ngcontent-swu-c106="" class="highlight-div-header"><div _ngcontent-swu-c106="" class="highlight-div-header-left"><div _ngcontent-swu-c106="" class="handle-button expand-button"><div _ngcontent-swu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-swu-c106="" class="highlight-div-header-right"><div _ngcontent-swu-c106="" class="handle-button ai-button"></div><div _ngcontent-swu-c106="" class="handle-button line-button"><div _ngcontent-swu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-swu-c106="" class="handle-button theme-button"><div _ngcontent-swu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-swu-c106="" class="handle-button copy-button"><div _ngcontent-swu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-swu-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">ads</span>: advertising.<span class="hljs-property">Advertisement</span>[] = [];</li><li>  <span class="hljs-comment">// ...</span></li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">context</span>: common.<span class="hljs-property">UIAbilityContext</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li>
</li><li>  <span class="hljs-title function_">aboutToAppear</span>(): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-comment">// 调用loadAd加载广告</span></li><li>    <span class="hljs-comment">// ...</span></li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">loadAd</span>(...<span class="hljs-attr">adIds</span>: <span class="hljs-built_in">string</span>[]): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {</li><li>    <span class="hljs-comment">// 广告请求参数</span></li><li>    <span class="hljs-keyword">const</span> <span class="hljs-attr">adRequestParamsArray</span>: advertising.<span class="hljs-property">AdRequestParams</span>[] = [];</li><li>    <span class="hljs-keyword">const</span> <span class="hljs-attr">oaid</span>: <span class="hljs-built_in">string</span> | <span class="hljs-literal">undefined</span> = <span class="hljs-keyword">await</span> <span class="hljs-title function_">requestOAID</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>);</li><li>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> adId <span class="hljs-keyword">of</span> adIds) {</li><li>      adRequestParamsArray.<span class="hljs-title function_">push</span>({</li><li>        <span class="hljs-comment">// 广告位ID</span></li><li>        <span class="hljs-attr">adId</span>: adId,</li><li>        <span class="hljs-comment">// 原生广告类型</span></li><li>        <span class="hljs-attr">adType</span>: <span class="hljs-number">3</span>,</li><li>        <span class="hljs-comment">// 原生广告扩展参数，是否直接返回广告，不用等待所有广告素材下载完成</span></li><li>        <span class="hljs-attr">enableDirectReturnVideoAd</span>: <span class="hljs-literal">true</span>,</li><li>        <span class="hljs-comment">// 开放匿名设备标识符</span></li><li>        <span class="hljs-attr">oaid</span>: oaid</li><li>      });</li><li>    }</li><li>    <span class="hljs-comment">// 广告配置参数，开发者可根据项目实际情况设置</span></li><li>    <span class="hljs-keyword">const</span> <span class="hljs-attr">adOptions</span>: advertising.<span class="hljs-property">AdOptions</span> = {};</li><li>    <span class="hljs-comment">// 广告请求回调监听</span></li><li>    <span class="hljs-keyword">const</span> <span class="hljs-attr">multiSlotsAdLoaderListener</span>: advertising.<span class="hljs-property">MultiSlotsAdLoadListener</span> = {</li><li>      <span class="hljs-attr">onAdLoadFailure</span>: <span class="hljs-function">(<span class="hljs-params">errorCode: <span class="hljs-built_in">number</span>, errorMsg: <span class="hljs-built_in">string</span></span>) =&gt;</span> {</li><li>        hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">`Failed to load multiSlots ad. Code is <span class="hljs-subst">${errorCode}</span>, message is <span class="hljs-subst">${errorMsg}</span>`</span>);</li><li>      },</li><li>      <span class="hljs-attr">onAdLoadSuccess</span>: <span class="hljs-function">(<span class="hljs-params">ads: <span class="hljs-built_in">Map</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">Array</span>&lt;advertising.Advertisement&gt;&gt;</span>) =&gt;</span> {</li><li>        hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">'Succeeded in loading multiSlots ad'</span>);</li><li>        <span class="hljs-keyword">const</span> <span class="hljs-attr">returnAds</span>: advertising.<span class="hljs-property">Advertisement</span>[] = [];</li><li>        ads.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">adsArray</span>) =&gt;</span> returnAds.<span class="hljs-title function_">push</span>(...adsArray));</li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">ads</span> = returnAds;</li><li>      }</li><li>    };</li><li>    <span class="hljs-comment">// 创建AdLoader广告对象</span></li><li>    <span class="hljs-keyword">const</span> <span class="hljs-attr">adLoader</span>: advertising.<span class="hljs-property">AdLoader</span> = <span class="hljs-keyword">new</span> advertising.<span class="hljs-title class_">AdLoader</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>);</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-comment">// 调用广告请求接口</span></li><li>      adLoader.<span class="hljs-title function_">loadAdWithMultiSlots</span>(adRequestParamsArray, adOptions, multiSlotsAdLoaderListener);</li><li>    } <span class="hljs-keyword">catch</span> (e) {</li><li>      hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">`Failed to load multiSlots ad. Code is <span class="hljs-subst">${e.code}</span>, message is <span class="hljs-subst">${e.message}</span>`</span>);</li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-comment">// ...</span></li><li>  }</li><li>
</li><li>  <span class="hljs-comment">// ...</span></li><li>}</li><li>
</li><li><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">requestOAID</span>(<span class="hljs-params">context: Context</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">string</span> | <span class="hljs-literal">undefined</span>&gt; {</li><li>  <span class="hljs-comment">// 向用户请求授权广告跨应用关联访问权限</span></li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">isPermissionGranted</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">false</span>;</li><li>  <span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">const</span> <span class="hljs-attr">atManager</span>: abilityAccessCtrl.<span class="hljs-property">AtManager</span> = abilityAccessCtrl.<span class="hljs-title function_">createAtManager</span>();</li><li>    <span class="hljs-keyword">const</span> <span class="hljs-attr">result</span>: <span class="hljs-title class_">PermissionRequestResult</span> =</li><li>      <span class="hljs-keyword">await</span> atManager.<span class="hljs-title function_">requestPermissionsFromUser</span>(context, [<span class="hljs-string">'ohos.permission.APP_TRACKING_CONSENT'</span>]);</li><li>    isPermissionGranted = result.<span class="hljs-property">authResults</span>[<span class="hljs-number">0</span>] === abilityAccessCtrl.<span class="hljs-property">GrantStatus</span>.<span class="hljs-property">PERMISSION_GRANTED</span>;</li><li>  } <span class="hljs-keyword">catch</span> (err) {</li><li>    hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">`Failed to request permission. Code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>  }</li><li>  <span class="hljs-keyword">if</span> (isPermissionGranted) {</li><li>    hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">'Succeeded in requesting permission'</span>);</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-keyword">const</span> oaid = <span class="hljs-keyword">await</span> identifier.<span class="hljs-title function_">getOAID</span>();</li><li>      hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">'Succeeded in getting OAID'</span>);</li><li>      <span class="hljs-keyword">return</span> oaid;</li><li>    } <span class="hljs-keyword">catch</span> (err) {</li><li>      hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">`Failed to get OAID. Code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>    }</li><li>  } <span class="hljs-keyword">else</span> {</li><li>    hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">'Failed to request permission. User rejected'</span>);</li><li>  }</li><li>  <span class="hljs-keyword">return</span> <span class="hljs-literal">undefined</span>;</li><li>}</li></ol></pre></div></div> <p></p> <p></p></li></ol> </div> <div class="tiledSection"><h3 id="section1233381115719">展示广告<i class="anchor-icon anchor-icon-link" anchorid="section1233381115719" tips="复制节点链接"></i></h3><ol><li><span>导入相关模块。</span><p></p><div _ngcontent-swu-c106="" class="highlight-div"><div _ngcontent-swu-c106="" class="highlight-div-header"><div _ngcontent-swu-c106="" class="highlight-div-header-left"><div _ngcontent-swu-c106="" class="handle-button expand-button"><div _ngcontent-swu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-swu-c106="" class="highlight-div-header-right"><div _ngcontent-swu-c106="" class="handle-button ai-button"></div><div _ngcontent-swu-c106="" class="handle-button line-button"><div _ngcontent-swu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-swu-c106="" class="handle-button theme-button"><div _ngcontent-swu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-swu-c106="" class="handle-button copy-button"><div _ngcontent-swu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-swu-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AdComponent</span>, advertising } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AdsKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li></ol></pre></div></div> <p></p></li><li><span>展示广告。</span><p></p><p>展示广告通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-advertising#adinteractionlistener" target="_blank">AdInteractionListener</a>监听广告状态回调，涉及的回调状态如下所示：</p>  <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.6.2.2.2.2.1.4.1.1" valign="top" width="17.1%"><p>回调状态</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.6.2.2.2.2.1.4.1.2" valign="top" width="17.130000000000003%"><p>说明</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.6.2.2.2.2.1.4.1.3" valign="top" width="65.77%"><p>使用建议</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="17.1%"><p>onAdOpen</p> </td> <td class="cellrowborder" valign="top" width="17.130000000000003%"><p>打开广告。</p> </td> <td class="cellrowborder" valign="top" width="65.77%"><p>-</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="17.1%"><p>onAdClick</p> </td> <td class="cellrowborder" valign="top" width="17.130000000000003%"><p>点击广告。</p> </td> <td class="cellrowborder" valign="top" width="65.77%"><p>-</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="17.1%"><p>onAdClose</p> </td> <td class="cellrowborder" valign="top" width="17.130000000000003%"><p>关闭广告。</p> </td> <td class="cellrowborder" valign="top" width="65.77%"><p>用户点击负反馈或关闭广告时触发，需要将广告组件隐藏。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="17.1%"><p>onAdFail</p> </td> <td class="cellrowborder" valign="top" width="17.130000000000003%"><p>广告加载失败。</p> </td> <td class="cellrowborder" valign="top" width="65.77%"><p>广告展示失败时触发，需要将广告组件隐藏。</p> </td> </tr>  </tbody></table></div> </div> <p>原生信息流广告通常不需要显式设置广告展示组件<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-adcomponent" target="_blank">AdComponent</a>的高度，组件会自动调整高度以适应需要展示的内容。</p> <p>示例代码如下所示：</p> <div _ngcontent-swu-c106="" class="highlight-div"><div _ngcontent-swu-c106="" class="highlight-div-header"><div _ngcontent-swu-c106="" class="highlight-div-header-left"><div _ngcontent-swu-c106="" class="handle-button expand-button"><div _ngcontent-swu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-swu-c106="" class="highlight-div-header-right"><div _ngcontent-swu-c106="" class="handle-button ai-button"></div><div _ngcontent-swu-c106="" class="handle-button line-button"><div _ngcontent-swu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-swu-c106="" class="handle-button theme-button"><div _ngcontent-swu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-swu-c106="" class="handle-button copy-button"><div _ngcontent-swu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-swu-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">ads</span>: advertising.<span class="hljs-property">Advertisement</span>[] = [];</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">visibilityState</span>: <span class="hljs-title class_">Visibility</span> = <span class="hljs-title class_">Visibility</span>.<span class="hljs-property">Visible</span>;</li><li>  <span class="hljs-comment">// ...</span></li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">ads</span>.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {</li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">inFeedNativeAd</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">ads</span>[<span class="hljs-number">0</span>])</li><li>        <span class="hljs-comment">// ...</span></li><li>      }</li><li>    }</li><li>    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>
</li><li>  <span class="hljs-meta">@Builder</span></li><li>  <span class="hljs-title function_">inFeedNativeAd</span>(<span class="hljs-attr">ad</span>: advertising.<span class="hljs-property">Advertisement</span>): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-title class_">Row</span>() {</li><li>      <span class="hljs-title class_">AdComponent</span>({</li><li>        <span class="hljs-attr">ads</span>: [ad],</li><li>        <span class="hljs-comment">// 广告展示参数，开发者可根据项目实际情况设置</span></li><li>        <span class="hljs-attr">displayOptions</span>: {</li><li>          <span class="hljs-comment">// 是否静音</span></li><li>          <span class="hljs-attr">mute</span>: <span class="hljs-literal">true</span></li><li>        },</li><li>        <span class="hljs-attr">interactionListener</span>: {</li><li>          <span class="hljs-attr">onStatusChanged</span>: <span class="hljs-function">(<span class="hljs-params">status: <span class="hljs-built_in">string</span>, ad: advertising.Advertisement, data: <span class="hljs-built_in">string</span></span>) =&gt;</span> {</li><li>            <span class="hljs-keyword">switch</span> (status) {</li><li>              <span class="hljs-keyword">case</span> <span class="hljs-string">'onAdOpen'</span>:</li><li>                hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">'Status is onAdOpen'</span>);</li><li>                <span class="hljs-keyword">break</span>;</li><li>              <span class="hljs-keyword">case</span> <span class="hljs-string">'onAdClick'</span>:</li><li>                hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">'Status is onAdClick'</span>);</li><li>                <span class="hljs-keyword">break</span>;</li><li>              <span class="hljs-keyword">case</span> <span class="hljs-string">'onAdClose'</span>:</li><li>                hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">'Status is onAdClose'</span>);</li><li>                <span class="hljs-variable language_">this</span>.<span class="hljs-property">visibilityState</span> = <span class="hljs-title class_">Visibility</span>.<span class="hljs-property">None</span>;</li><li>                <span class="hljs-keyword">break</span>;</li><li>              <span class="hljs-keyword">case</span> <span class="hljs-string">'onAdFail'</span>:</li><li>                hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">'Status is onAdFail'</span>);</li><li>                <span class="hljs-variable language_">this</span>.<span class="hljs-property">visibilityState</span> = <span class="hljs-title class_">Visibility</span>.<span class="hljs-property">None</span>;</li><li>                <span class="hljs-keyword">break</span>;</li><li>            }</li><li>          }</li><li>        }</li><li>      })</li><li>      <span class="hljs-comment">// 原生信息流样式，不建议设置高度，宽度建议设置为100%，撑满父容器</span></li><li>        .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    }</li><li>    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    .<span class="hljs-title function_">padding</span>({ <span class="hljs-attr">left</span>: <span class="hljs-number">16</span>, <span class="hljs-attr">right</span>: <span class="hljs-number">16</span> })</li><li>    .<span class="hljs-title function_">visibility</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">visibilityState</span>)</li><li>  }</li><li>
</li><li>  <span class="hljs-comment">// ...</span></li><li>}</li></ol></pre></div></div> <p>原生插图广告宽高为固定值312vp*284vp，开发者可以将广告展示组件<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-adcomponent" target="_blank">AdComponent</a>居中展示。</p> <p>示例代码如下所示：</p> <div _ngcontent-swu-c106="" class="highlight-div"><div _ngcontent-swu-c106="" class="highlight-div-header"><div _ngcontent-swu-c106="" class="highlight-div-header-left"><div _ngcontent-swu-c106="" class="handle-button expand-button"><div _ngcontent-swu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-swu-c106="" class="highlight-div-header-right"><div _ngcontent-swu-c106="" class="handle-button ai-button"></div><div _ngcontent-swu-c106="" class="handle-button line-button"><div _ngcontent-swu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-swu-c106="" class="handle-button theme-button"><div _ngcontent-swu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-swu-c106="" class="handle-button copy-button"><div _ngcontent-swu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-swu-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">ads</span>: advertising.<span class="hljs-property">Advertisement</span>[] = [];</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">visibilityState</span>: <span class="hljs-title class_">Visibility</span> = <span class="hljs-title class_">Visibility</span>.<span class="hljs-property">Visible</span>;</li><li>  <span class="hljs-comment">// ...</span></li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">ads</span>.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) {</li><li>        <span class="hljs-comment">// ...</span></li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">nativeCardAd</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">ads</span>[<span class="hljs-number">0</span>])</li><li>      }</li><li>    }</li><li>    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>
</li><li>  <span class="hljs-comment">// ...</span></li><li>
</li><li>  <span class="hljs-meta">@Builder</span></li><li>  <span class="hljs-title function_">nativeCardAd</span>(<span class="hljs-attr">ad</span>: advertising.<span class="hljs-property">Advertisement</span>): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-title class_">Row</span>() {</li><li>      <span class="hljs-title class_">AdComponent</span>({</li><li>        <span class="hljs-attr">ads</span>: [ad],</li><li>        <span class="hljs-comment">// 广告展示参数，开发者可根据项目实际情况设置</span></li><li>        <span class="hljs-attr">displayOptions</span>: {</li><li>          <span class="hljs-comment">// 是否静音</span></li><li>          <span class="hljs-attr">mute</span>: <span class="hljs-literal">true</span></li><li>        },</li><li>        <span class="hljs-attr">interactionListener</span>: {</li><li>          <span class="hljs-attr">onStatusChanged</span>: <span class="hljs-function">(<span class="hljs-params">status: <span class="hljs-built_in">string</span>, ad: advertising.Advertisement, data: <span class="hljs-built_in">string</span></span>) =&gt;</span> {</li><li>            <span class="hljs-keyword">switch</span> (status) {</li><li>              <span class="hljs-keyword">case</span> <span class="hljs-string">'onAdOpen'</span>:</li><li>                hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">'Status is onAdOpen'</span>);</li><li>                <span class="hljs-keyword">break</span>;</li><li>              <span class="hljs-keyword">case</span> <span class="hljs-string">'onAdClick'</span>:</li><li>                hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">'Status is onAdClick'</span>);</li><li>                <span class="hljs-keyword">break</span>;</li><li>              <span class="hljs-keyword">case</span> <span class="hljs-string">'onAdClose'</span>:</li><li>                hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">'Status is onAdClose'</span>);</li><li>                <span class="hljs-variable language_">this</span>.<span class="hljs-property">visibilityState</span> = <span class="hljs-title class_">Visibility</span>.<span class="hljs-property">None</span>;</li><li>                <span class="hljs-keyword">break</span>;</li><li>              <span class="hljs-keyword">case</span> <span class="hljs-string">'onAdFail'</span>:</li><li>                hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">'Status is onAdFail'</span>);</li><li>                <span class="hljs-variable language_">this</span>.<span class="hljs-property">visibilityState</span> = <span class="hljs-title class_">Visibility</span>.<span class="hljs-property">None</span>;</li><li>                <span class="hljs-keyword">break</span>;</li><li>            }</li><li>          }</li><li>        }</li><li>      })</li><li>      <span class="hljs-comment">// 原生插图样式，宽高为固定值，为312vp*284vp</span></li><li>        .<span class="hljs-title function_">width</span>(<span class="hljs-number">312</span>)</li><li>        .<span class="hljs-title function_">height</span>(<span class="hljs-number">284</span>)</li><li>    }</li><li>    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    <span class="hljs-comment">// 宽高固定无法撑满父容器，将广告居中展示</span></li><li>    .<span class="hljs-title function_">justifyContent</span>(<span class="hljs-title class_">FlexAlign</span>.<span class="hljs-property">Center</span>)</li><li>    .<span class="hljs-title function_">visibility</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">visibilityState</span>)</li><li>  }</li><li>}</li></ol></pre></div></div> <p></p></li></ol> </div> </div> <div></div></div>