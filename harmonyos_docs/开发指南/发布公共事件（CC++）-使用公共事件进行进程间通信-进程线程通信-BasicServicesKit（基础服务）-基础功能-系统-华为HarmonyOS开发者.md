<h1 _ngcontent-xkm-c119="" class="doc-title ng-star-inserted" title="发布公共事件（C/C++）"> 发布公共事件（C/C++） </h1>

<div _ngcontent-xkm-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <div class="tiledSection">     <h2 id="场景介绍">场景介绍<i class="anchor-icon anchor-icon-link" anchorid="场景介绍" tips="复制节点链接"></i></h2>          <p>当需要发布某个公共事件时，可以通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-oh-commonevent-h#oh_commonevent_publish" target="_blank">OH_CommonEvent_Publish</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-oh-commonevent-h#oh_commonevent_publishwithinfo" target="_blank">OH_CommonEvent_PublishWithInfo</a>方法发布事件。发布的公共事件可以携带数据，供订阅者解析并进行下一步处理。</p>    </div>    <div class="tiledSection">     <h2 id="接口说明">接口说明<i class="anchor-icon anchor-icon-link" anchorid="接口说明" tips="复制节点链接"></i></h2>          <p>详细的API说明请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-oh-commonevent-h" target="_blank">CommonEvent API参考</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.2.3.1.3.1.1" valign="top" width="50%">接口名</th>         <th align="left" class="cellrowborder" id="mcps1.3.2.3.1.3.1.2" valign="top" width="50%">描述</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-oh-commonevent-commonevent-publishinfo" target="_blank">struct CommonEvent_PublishInfo</a></td>         <td class="cellrowborder" valign="top" width="50%">发布公共事件时使用的公共事件属性对象。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-oh-commonevent-h#oh_commonevent_publish" target="_blank">CommonEvent_ErrCode OH_CommonEvent_Publish(const char* event)</a></td>         <td class="cellrowborder" valign="top" width="50%">发布公共事件。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-oh-commonevent-h#oh_commonevent_publishwithinfo" target="_blank">CommonEvent_ErrCode OH_CommonEvent_PublishWithInfo(const char* event, const CommonEvent_PublishInfo* info)</a></td>         <td class="cellrowborder" valign="top" width="50%">发布带有指定属性的公共事件。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-oh-commonevent-h#oh_commonevent_createpublishinfo" target="_blank">CommonEvent_PublishInfo* OH_CommonEvent_CreatePublishInfo(bool ordered)</a></td>         <td class="cellrowborder" valign="top" width="50%">创建公共事件属性对象。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-oh-commonevent-h#oh_commonevent_destroypublishinfo" target="_blank">void OH_CommonEvent_DestroyPublishInfo(CommonEvent_PublishInfo* info)</a></td>         <td class="cellrowborder" valign="top" width="50%">销毁公共事件属性对象。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-oh-commonevent-h#oh_commonevent_createparameters" target="_blank">CommonEvent_Parameters* OH_CommonEvent_CreateParameters()</a></td>         <td class="cellrowborder" valign="top" width="50%">创建公共事件附加信息对象。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-oh-commonevent-h#oh_commonevent_destroyparameters" target="_blank">void OH_CommonEvent_DestroyParameters(CommonEvent_Parameters* param)</a></td>         <td class="cellrowborder" valign="top" width="50%">销毁公共事件附加信息对象。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="开发步骤">开发步骤<i class="anchor-icon anchor-icon-link" anchorid="开发步骤" tips="复制节点链接"></i></h2>          <ol>      <li>       <p>引用头文件。</p>       <div _ngcontent-xkm-c106="" class="highlight-div"><div _ngcontent-xkm-c106="" class="highlight-div-header"><div _ngcontent-xkm-c106="" class="highlight-div-header-left"><div _ngcontent-xkm-c106="" class="handle-button expand-button"><div _ngcontent-xkm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xkm-c106="" class="highlight-div-header-right"><div _ngcontent-xkm-c106="" class="handle-button ai-button"></div><div _ngcontent-xkm-c106="" class="handle-button line-button"><div _ngcontent-xkm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xkm-c106="" class="handle-button theme-button"><div _ngcontent-xkm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xkm-c106="" class="handle-button copy-button"><div _ngcontent-xkm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xkm-c106="" class="highlight-scroll-div"><pre class="prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstdint&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstdio&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cwchar&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"hilog/log.h"</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"BasicServicesKit/oh_commonevent.h"</span></span></li></ol></pre></div></div></li>      <li>       <p>在CMake脚本中添加动态链接库。</p>       <div _ngcontent-xkm-c106="" class="highlight-div"><div _ngcontent-xkm-c106="" class="highlight-div-header"><div _ngcontent-xkm-c106="" class="highlight-div-header-left"><div _ngcontent-xkm-c106="" class="handle-button expand-button"><div _ngcontent-xkm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xkm-c106="" class="highlight-div-header-right"><div _ngcontent-xkm-c106="" class="handle-button ai-button"></div><div _ngcontent-xkm-c106="" class="handle-button line-button"><div _ngcontent-xkm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xkm-c106="" class="handle-button theme-button"><div _ngcontent-xkm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xkm-c106="" class="handle-button copy-button"><div _ngcontent-xkm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xkm-c106="" class="highlight-scroll-div"><pre class="txt prettyprint linenums hljs language-plaintext" hw-language="txt" data-highlighted="yes"><ol class="linenums"><li>target_link_libraries(entry PUBLIC</li><li>    libace_napi.z.so</li><li>    libhilog_ndk.z.so</li><li>    libohcommonevent.so</li><li>)</li></ol></pre></div></div></li>      <li>       <p>（可选）创建公共事件属性对象。</p>       <p>发布携带数据的公共事件时，需要通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-oh-commonevent-h#oh_commonevent_createpublishinfo" target="_blank">OH_CommonEvent_CreatePublishInfo</a>创建公共事件属性对象，并通过以下接口设置公共事件属性。</p>       <div _ngcontent-xkm-c106="" class="highlight-div"><div _ngcontent-xkm-c106="" class="highlight-div-header"><div _ngcontent-xkm-c106="" class="highlight-div-header-left"><div _ngcontent-xkm-c106="" class="handle-button expand-button"><div _ngcontent-xkm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xkm-c106="" class="highlight-div-header-right"><div _ngcontent-xkm-c106="" class="handle-button ai-button"></div><div _ngcontent-xkm-c106="" class="handle-button line-button"><div _ngcontent-xkm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xkm-c106="" class="handle-button theme-button"><div _ngcontent-xkm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xkm-c106="" class="handle-button copy-button"><div _ngcontent-xkm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xkm-c106="" class="highlight-scroll-div"><pre class="prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 创建并添加公共事件属性附加信息</span></li><li><span class="hljs-function">CommonEvent_Parameters* <span class="hljs-title">CreateParameters</span><span class="hljs-params">()</span></span></li><li><span class="hljs-function"></span>{</li><li>    <span class="hljs-type">int32_t</span> ret = <span class="hljs-number">-1</span>;</li><li>    <span class="hljs-comment">// 创建公共事件附加信息</span></li><li>    CommonEvent_Parameters* param = <span class="hljs-built_in">OH_CommonEvent_CreateParameters</span>();</li><li>    </li><li>    <span class="hljs-comment">// 设置int类型附加信息和key</span></li><li>    ret = <span class="hljs-built_in">OH_CommonEvent_SetIntToParameters</span>(param, <span class="hljs-string">"intKey"</span>, <span class="hljs-number">10</span>);</li><li>    <span class="hljs-built_in">OH_LOG_Print</span>(LOG_APP, LOG_INFO, <span class="hljs-number">1</span>, <span class="hljs-string">"CES_TEST"</span>, <span class="hljs-string">"OH_CommonEvent_SetIntToParameters ret &lt;%{public}d&gt;."</span>, ret);</li><li>
</li><li>    <span class="hljs-comment">// 设置int数组类型附加信息和key</span></li><li>    <span class="hljs-type">int</span> intArray[] = {<span class="hljs-number">123</span>, <span class="hljs-number">234</span>, <span class="hljs-number">567</span>};</li><li>    <span class="hljs-type">size_t</span> arraySize = <span class="hljs-number">3</span>;</li><li>    ret = <span class="hljs-built_in">OH_CommonEvent_SetIntArrayToParameters</span>(param, <span class="hljs-string">"intArrayKey"</span>, intArray, arraySize);</li><li>    <span class="hljs-built_in">OH_LOG_Print</span>(LOG_APP, LOG_INFO, <span class="hljs-number">1</span>, <span class="hljs-string">"CES_TEST"</span>, <span class="hljs-string">"OH_CommonEvent_SetIntArrayToParameters ret &lt;%{public}d&gt;."</span>, ret);</li><li>    </li><li>    <span class="hljs-comment">// 设置long类型附加信息和key</span></li><li>    ret = <span class="hljs-built_in">OH_CommonEvent_SetLongToParameters</span>(param, <span class="hljs-string">"longKey"</span>, <span class="hljs-number">2147483646</span>);</li><li>    <span class="hljs-built_in">OH_LOG_Print</span>(LOG_APP, LOG_INFO, <span class="hljs-number">1</span>, <span class="hljs-string">"CES_TEST"</span>, <span class="hljs-string">"OH_CommonEvent_SetLongToParameters ret &lt;%{public}d&gt;."</span>, ret);</li><li>
</li><li>    <span class="hljs-comment">// 设置long数组类型附加信息和key</span></li><li>    <span class="hljs-type">long</span> longArray[] = {<span class="hljs-number">2147483646</span>, <span class="hljs-number">555</span>, <span class="hljs-number">2147483645</span>};</li><li>    ret = <span class="hljs-built_in">OH_CommonEvent_SetLongArrayToParameters</span>(param, <span class="hljs-string">"longArrayKey"</span>, longArray, arraySize);</li><li>    <span class="hljs-built_in">OH_LOG_Print</span>(LOG_APP, LOG_INFO, <span class="hljs-number">1</span>, <span class="hljs-string">"CES_TEST"</span>, <span class="hljs-string">"OH_CommonEvent_SetLongArrayToParameters ret &lt;%{public}d&gt;."</span>, ret);</li><li>    </li><li>    <span class="hljs-comment">// 设置double类型附加信息和key</span></li><li>    ret = <span class="hljs-built_in">OH_CommonEvent_SetDoubleToParameters</span>(param, <span class="hljs-string">"doubleKey"</span>, <span class="hljs-number">11.22</span>);</li><li>    <span class="hljs-built_in">OH_LOG_Print</span>(LOG_APP, LOG_INFO, <span class="hljs-number">1</span>, <span class="hljs-string">"CES_TEST"</span>, <span class="hljs-string">"OH_CommonEvent_SetDoubleToParameters ret &lt;%{public}d&gt;."</span>, ret);</li><li>
</li><li>    <span class="hljs-comment">// 设置double数组类型附加信息和key</span></li><li>    <span class="hljs-type">double</span> doubleArray[] = {<span class="hljs-number">11.22</span>, <span class="hljs-number">33.44</span>, <span class="hljs-number">55.66</span>};</li><li>    ret = <span class="hljs-built_in">OH_CommonEvent_SetDoubleArrayToParameters</span>(param, <span class="hljs-string">"doubleArrayKey"</span>, doubleArray, arraySize);</li><li>    <span class="hljs-built_in">OH_LOG_Print</span>(LOG_APP, LOG_INFO, <span class="hljs-number">1</span>, <span class="hljs-string">"CES_TEST"</span>, <span class="hljs-string">"OH_CommonEvent_SetDoubleArrayToParameters ret &lt;%{public}d&gt;."</span>, ret);</li><li>    </li><li>    <span class="hljs-comment">// 设置boolean类型附加信息和key</span></li><li>    ret = <span class="hljs-built_in">OH_CommonEvent_SetBoolToParameters</span>(param, <span class="hljs-string">"boolKey"</span>, <span class="hljs-literal">true</span>);</li><li>    <span class="hljs-built_in">OH_LOG_Print</span>(LOG_APP, LOG_INFO, <span class="hljs-number">1</span>, <span class="hljs-string">"CES_TEST"</span>, <span class="hljs-string">"OH_CommonEvent_SetBoolToParameters ret &lt;%{public}d&gt;."</span>, ret);</li><li>
</li><li>    <span class="hljs-comment">// 设置boolean数组类型附加信息和key</span></li><li>    <span class="hljs-type">bool</span> boolArray[] = {<span class="hljs-literal">true</span>, <span class="hljs-literal">false</span>, <span class="hljs-literal">true</span>};</li><li>    ret = <span class="hljs-built_in">OH_CommonEvent_SetBoolArrayToParameters</span>(param, <span class="hljs-string">"boolArrayKey"</span>, boolArray, arraySize);</li><li>    <span class="hljs-built_in">OH_LOG_Print</span>(LOG_APP, LOG_INFO, <span class="hljs-number">1</span>, <span class="hljs-string">"CES_TEST"</span>, <span class="hljs-string">"OH_CommonEvent_SetBoolArrayToParameters ret &lt;%{public}d&gt;."</span>, ret);</li><li>    </li><li>    <span class="hljs-comment">// 设置char类型附加信息和key</span></li><li>    ret = <span class="hljs-built_in">OH_CommonEvent_SetCharToParameters</span>(param, <span class="hljs-string">"charKey"</span>, <span class="hljs-string">'A'</span>);</li><li>    <span class="hljs-built_in">OH_LOG_Print</span>(LOG_APP, LOG_INFO, <span class="hljs-number">1</span>, <span class="hljs-string">"CES_TEST"</span>, <span class="hljs-string">"OH_CommonEvent_SetCharToParameters ret &lt;%{public}d&gt;."</span>, ret);</li><li>
</li><li>    <span class="hljs-comment">// 设置char数组类型附加信息和key</span></li><li>    <span class="hljs-type">const</span> <span class="hljs-type">char</span>* value= <span class="hljs-string">"Char Array"</span>;</li><li>    <span class="hljs-type">size_t</span> valueLength = <span class="hljs-built_in">strlen</span>(value);</li><li>    ret = <span class="hljs-built_in">OH_CommonEvent_SetCharArrayToParameters</span>(param, <span class="hljs-string">"charArrayKey"</span>, value, valueLength);</li><li>    <span class="hljs-built_in">OH_LOG_Print</span>(LOG_APP, LOG_INFO, <span class="hljs-number">1</span>, <span class="hljs-string">"CES_TEST"</span>, <span class="hljs-string">"OH_CommonEvent_SetCharArrayToParameters ret &lt;%{public}d&gt;."</span>, ret);</li><li>    <span class="hljs-keyword">return</span> param;</li><li>}</li><li>
</li><li><span class="hljs-comment">// 设置公共事件属性</span></li><li><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">SetPublishInfo</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span>* bundleName, <span class="hljs-type">const</span> <span class="hljs-type">char</span>* permissions[], <span class="hljs-type">int32_t</span> num, <span class="hljs-type">const</span> <span class="hljs-type">int32_t</span> code, <span class="hljs-type">const</span> <span class="hljs-type">char</span>* data)</span></span></li><li><span class="hljs-function"></span>{</li><li>    <span class="hljs-type">int32_t</span> ret = <span class="hljs-number">-1</span>;</li><li>    <span class="hljs-comment">// 创建publishInfo，设置是否为有序公共事件，取值为true，表示有序公共事件；取值为false，表示无序公共事件</span></li><li>    CommonEvent_PublishInfo* info = <span class="hljs-built_in">OH_CommonEvent_CreatePublishInfo</span>(<span class="hljs-literal">true</span>);</li><li>
</li><li>    <span class="hljs-comment">// 设置公共事件包名称</span></li><li>    ret = <span class="hljs-built_in">OH_CommonEvent_SetPublishInfoBundleName</span>(info, bundleName);</li><li>    <span class="hljs-built_in">OH_LOG_Print</span>(LOG_APP, LOG_INFO, <span class="hljs-number">1</span>, <span class="hljs-string">"CES_TEST"</span>, <span class="hljs-string">"OH_CommonEvent_SetPublishInfoBundleName ret &lt;%{public}d&gt;."</span>, ret);</li><li>
</li><li>    <span class="hljs-comment">// 设置公共事件权限，参数为权限数组和权限的数量</span></li><li>    ret = <span class="hljs-built_in">OH_CommonEvent_SetPublishInfoPermissions</span>(info, permissions, num);</li><li>    <span class="hljs-built_in">OH_LOG_Print</span>(LOG_APP, LOG_INFO, <span class="hljs-number">1</span>, <span class="hljs-string">"CES_TEST"</span>, <span class="hljs-string">"OH_CommonEvent_SetPublishInfoPermissions ret &lt;%{public}d&gt;."</span>, ret);</li><li>
</li><li>    <span class="hljs-comment">// 设置公共事件结果码</span></li><li>    ret = <span class="hljs-built_in">OH_CommonEvent_SetPublishInfoCode</span>(info, code);</li><li>    <span class="hljs-built_in">OH_LOG_Print</span>(LOG_APP, LOG_INFO, <span class="hljs-number">1</span>, <span class="hljs-string">"CES_TEST"</span>, <span class="hljs-string">"OH_CommonEvent_SetPublishInfoCode ret &lt;%{public}d&gt;."</span>, ret);</li><li>
</li><li>    <span class="hljs-comment">// 设置公共事件结果数据</span></li><li>    <span class="hljs-type">size_t</span> dataLength = <span class="hljs-built_in">strlen</span>(data);</li><li>    ret = <span class="hljs-built_in">OH_CommonEvent_SetPublishInfoData</span>(info, data, dataLength);</li><li>    <span class="hljs-built_in">OH_LOG_Print</span>(LOG_APP, LOG_INFO, <span class="hljs-number">1</span>, <span class="hljs-string">"CES_TEST"</span>, <span class="hljs-string">"OH_CommonEvent_SetPublishInfoData ret &lt;%{public}d&gt;."</span>, ret);</li><li>
</li><li>    <span class="hljs-comment">// 设置公共事件附加信息</span></li><li>    CommonEvent_Parameters* param = <span class="hljs-built_in">CreateParameters</span>();</li><li>    ret = <span class="hljs-built_in">OH_CommonEvent_SetPublishInfoParameters</span>(info, param);</li><li>    <span class="hljs-built_in">OH_LOG_Print</span>(LOG_APP, LOG_INFO, <span class="hljs-number">1</span>, <span class="hljs-string">"CES_TEST"</span>, <span class="hljs-string">"OH_CommonEvent_SetPublishInfoParameters ret &lt;%{public}d&gt;."</span>, ret);</li><li>}</li></ol></pre></div></div></li>      <li>       <p>发布公共事件。</p>       <ul>        <li>         <p>通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-oh-commonevent-h#oh_commonevent_publish" target="_blank">OH_CommonEvent_Publish</a>发布不携带信息的公共事件。</p>         <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">           <p>不携带信息的公共事件，只能发布为无序公共事件。</p>          </div></div></div>         <div _ngcontent-xkm-c106="" class="highlight-div"><div _ngcontent-xkm-c106="" class="highlight-div-header"><div _ngcontent-xkm-c106="" class="highlight-div-header-left"><div _ngcontent-xkm-c106="" class="handle-button expand-button"><div _ngcontent-xkm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xkm-c106="" class="highlight-div-header-right"><div _ngcontent-xkm-c106="" class="handle-button ai-button"></div><div _ngcontent-xkm-c106="" class="handle-button line-button"><div _ngcontent-xkm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xkm-c106="" class="handle-button theme-button"><div _ngcontent-xkm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xkm-c106="" class="handle-button copy-button"><div _ngcontent-xkm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xkm-c106="" class="highlight-scroll-div"><pre class="prettyprint linenums hljs language-csharp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">Publish</span>(<span class="hljs-params"><span class="hljs-keyword">const</span> <span class="hljs-built_in">char</span>* <span class="hljs-keyword">event</span></span>)</span></li><li>{</li><li>    int32_t ret = OH_CommonEvent_Publish(<span class="hljs-keyword">event</span>);</li><li>    OH_LOG_Print(LOG_APP, LOG_INFO, <span class="hljs-number">1</span>, <span class="hljs-string">"CES_TEST"</span>, <span class="hljs-string">"OH_CommonEvent_Publish ret &lt;%{public}d&gt;."</span>, ret);</li><li>}</li></ol></pre></div></div></li>        <li>         <p>通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-oh-commonevent-h#oh_commonevent_publishwithinfo" target="_blank">OH_CommonEvent_PublishWithInfo</a>发布携带信息的公共事件。</p>         <div _ngcontent-xkm-c106="" class="highlight-div"><div _ngcontent-xkm-c106="" class="highlight-div-header"><div _ngcontent-xkm-c106="" class="highlight-div-header-left"><div _ngcontent-xkm-c106="" class="handle-button expand-button"><div _ngcontent-xkm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xkm-c106="" class="highlight-div-header-right"><div _ngcontent-xkm-c106="" class="handle-button ai-button"></div><div _ngcontent-xkm-c106="" class="handle-button line-button"><div _ngcontent-xkm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xkm-c106="" class="handle-button theme-button"><div _ngcontent-xkm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xkm-c106="" class="handle-button copy-button"><div _ngcontent-xkm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xkm-c106="" class="highlight-scroll-div"><pre class="prettyprint linenums hljs language-csharp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">PublishWithInfo</span>(<span class="hljs-params"><span class="hljs-keyword">const</span> <span class="hljs-built_in">char</span>* <span class="hljs-keyword">event</span>, CommonEvent_PublishInfo* info</span>)</span></li><li>{</li><li>    <span class="hljs-comment">// 创建时带入公共事件属性对象</span></li><li>    int32_t ret = OH_CommonEvent_PublishWithInfo(<span class="hljs-keyword">event</span>, info);</li><li>    OH_LOG_Print(LOG_APP, LOG_INFO, <span class="hljs-number">1</span>, <span class="hljs-string">"CES_TEST"</span>, <span class="hljs-string">"OH_CommonEvent_PublishWithInfo ret &lt;%{public}d&gt;."</span>, ret);</li><li>}</li></ol></pre></div></div></li>       </ul></li>      <li>       <p>销毁公共事件对象。</p>       <p>如果后续无需使用已创建的公共事件对象来发布公共事件，需要先通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-oh-commonevent-h#oh_commonevent_destroyparameters" target="_blank">OH_CommonEvent_DestroyParameters</a>销毁CommonEvent_Parameters对象，然后再通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-oh-commonevent-h#oh_commonevent_destroypublishinfo" target="_blank">OH_CommonEvent_DestroyPublishInfo</a>销毁公共事件对象。</p>       <div _ngcontent-xkm-c106="" class="highlight-div"><div _ngcontent-xkm-c106="" class="highlight-div-header"><div _ngcontent-xkm-c106="" class="highlight-div-header-left"><div _ngcontent-xkm-c106="" class="handle-button expand-button"><div _ngcontent-xkm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xkm-c106="" class="highlight-div-header-right"><div _ngcontent-xkm-c106="" class="handle-button ai-button"></div><div _ngcontent-xkm-c106="" class="handle-button line-button"><div _ngcontent-xkm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xkm-c106="" class="handle-button theme-button"><div _ngcontent-xkm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xkm-c106="" class="handle-button copy-button"><div _ngcontent-xkm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xkm-c106="" class="highlight-scroll-div"><pre class="prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">DestroyPublishInfo</span><span class="hljs-params">(CommonEvent_Parameters* param, CommonEvent_PublishInfo* info)</span></span></li><li><span class="hljs-function"></span>{</li><li>    <span class="hljs-comment">// 先销毁Parameters</span></li><li>    <span class="hljs-built_in">OH_CommonEvent_DestroyParameters</span>(param);</li><li>    param = <span class="hljs-literal">nullptr</span>;</li><li>    <span class="hljs-comment">// 销毁PublishInfo</span></li><li>    <span class="hljs-built_in">OH_CommonEvent_DestroyPublishInfo</span>(info);</li><li>    info = <span class="hljs-literal">nullptr</span>;</li><li>}</li></ol></pre></div></div></li>     </ol>    </div>   </div>   <div></div></div>