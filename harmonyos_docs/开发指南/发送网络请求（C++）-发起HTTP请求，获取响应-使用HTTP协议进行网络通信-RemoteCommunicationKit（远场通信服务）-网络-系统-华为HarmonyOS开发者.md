<h1 _ngcontent-nks-c119="" class="doc-title ng-star-inserted" title="发送网络请求（C++）"> 发送网络请求（C++） </h1>

<div _ngcontent-nks-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <div class="tiledSection">     <h2 id="section15385135185019">约束与限制<i class="anchor-icon anchor-icon-link" anchorid="section15385135185019" tips="复制节点链接"></i></h2>          <p>发送网络请求能力支持Phone、2in1、Tablet、Wearable设备。并且从5.1.1(19)开始，新增支持TV设备。</p>    </div>    <div class="tiledSection">     <h2 id="section2025152641613">如何使用fetchsync发起网络请求<i class="anchor-icon anchor-icon-link" anchorid="section2025152641613" tips="复制节点链接"></i></h2>          <p>发送一个同步HTTP请求，也可以设置请求头和请求体等参数，并返回来自服务器的HTTP响应。常用于获取资源，支持通过拦截器来处理请求和响应。</p>    </div>    <div class="tiledSection">     <h3 id="section295mcpsimp" class="firsth2">接口说明<i class="anchor-icon anchor-icon-link" anchorid="section295mcpsimp" tips="复制节点链接"></i></h3>          <p>具体API说明详见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/remote-communication-overview#ga48a83535a4658e9872ded4b0dd8c812f" target="_blank">接口文档</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.3.3.1.3.1.1" valign="top" width="50%">          <p>接口名</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.3.3.1.3.1.2" valign="top" width="50%">          <p>描述</p></th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="50%">          <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/remote-communication-overview#gaefca0869b44c6d31f91db0b3476f7863" target="_blank">Rcp_Response</a> *HMS_Rcp_FetchSync(<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/remote-communication-overview#ga4f3a7d39c18fe6fdf01c52759213ddcd" target="_blank">Rcp_Session</a> *session, <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/remote-communication-overview#ga98dde966841135537e05053bf4da4d5b" target="_blank">Rcp_Request</a> *request, uint32_t *errCode);</p></td>         <td class="cellrowborder" valign="top" width="50%">          <p>发送一个HTTP请求，并直接返回来自服务器的HTTP响应。</p></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h3 id="section9228131010255">使用示例<i class="anchor-icon anchor-icon-link" anchorid="section9228131010255" tips="复制节点链接"></i></h3>          <ol>      <li><span>CPP侧导入模块。</span>       <p></p>       <div _ngcontent-nks-c106="" class="highlight-div"><div _ngcontent-nks-c106="" class="highlight-div-header"><div _ngcontent-nks-c106="" class="highlight-div-header-left"><div _ngcontent-nks-c106="" class="handle-button expand-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-nks-c106="" class="highlight-div-header-right"><div _ngcontent-nks-c106="" class="handle-button ai-button"></div><div _ngcontent-nks-c106="" class="handle-button line-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-nks-c106="" class="handle-button theme-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-nks-c106="" class="handle-button copy-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-nks-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"RemoteCommunicationKit/rcp.h"</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span></li></ol></pre></div></div>       <p></p></li>      <li><span>CMakeLists.txt中添加以下lib。（具体请见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/remote-communication-preparations#section2095732915253">C API开发准备</a>）。</span>       <p></p>       <div _ngcontent-nks-c106="" class="highlight-div"><div _ngcontent-nks-c106="" class="highlight-div-header"><div _ngcontent-nks-c106="" class="highlight-div-header-left"><div _ngcontent-nks-c106="" class="handle-button expand-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-nks-c106="" class="highlight-div-header-right"><div _ngcontent-nks-c106="" class="handle-button ai-button"></div><div _ngcontent-nks-c106="" class="handle-button line-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-nks-c106="" class="handle-button theme-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-nks-c106="" class="handle-button copy-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-nks-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-undefined" data-highlighted="yes"><ol class="linenums"><li>librcp_c.so</li></ol></pre></div></div>       <p></p></li>      <li><span>创建Request对象。"https://www.example.com"请根据实际情况替换为想要请求的URL地址。（实际使用时请将该代码块放入main函数或者其他函数区域内）。</span>       <p></p>       <div _ngcontent-nks-c106="" class="highlight-div"><div _ngcontent-nks-c106="" class="highlight-div-header"><div _ngcontent-nks-c106="" class="highlight-div-header-left"><div _ngcontent-nks-c106="" class="handle-button expand-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-nks-c106="" class="highlight-div-header-right"><div _ngcontent-nks-c106="" class="handle-button ai-button"></div><div _ngcontent-nks-c106="" class="handle-button line-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-nks-c106="" class="handle-button theme-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-nks-c106="" class="handle-button copy-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-nks-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-type">const</span> <span class="hljs-type">char</span> *kHttpServerAddress = <span class="hljs-string">"http://www.example.com"</span>;</li><li>Rcp_Request *request = <span class="hljs-built_in">HMS_Rcp_CreateRequest</span>(kHttpServerAddress);</li></ol></pre></div></div>       <p></p></li>      <li><span>创建会话。（实际使用时请将该代码块放入main函数或者其他函数区域内）。</span>       <p></p>       <div _ngcontent-nks-c106="" class="highlight-div"><div _ngcontent-nks-c106="" class="highlight-div-header"><div _ngcontent-nks-c106="" class="highlight-div-header-left"><div _ngcontent-nks-c106="" class="handle-button expand-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-nks-c106="" class="highlight-div-header-right"><div _ngcontent-nks-c106="" class="handle-button ai-button"></div><div _ngcontent-nks-c106="" class="handle-button line-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-nks-c106="" class="handle-button theme-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-nks-c106="" class="handle-button copy-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-nks-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-type">uint32_t</span> errCode = <span class="hljs-number">0</span>;</li><li>Rcp_Session *session = <span class="hljs-built_in">HMS_Rcp_CreateSession</span>(<span class="hljs-literal">NULL</span>, &amp;errCode);</li></ol></pre></div></div>       <p></p></li>      <li><span>发起请求，并处理返回结果。（实际使用时请将该代码块放入main函数或者其他函数区域内）。</span>       <p></p>       <div _ngcontent-nks-c106="" class="highlight-div"><div _ngcontent-nks-c106="" class="highlight-div-header"><div _ngcontent-nks-c106="" class="highlight-div-header-left"><div _ngcontent-nks-c106="" class="handle-button expand-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-nks-c106="" class="highlight-div-header-right"><div _ngcontent-nks-c106="" class="handle-button ai-button"></div><div _ngcontent-nks-c106="" class="handle-button line-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-nks-c106="" class="handle-button theme-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-nks-c106="" class="handle-button copy-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-nks-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-perl" data-highlighted="yes"><ol class="linenums"><li>Rcp_Response *response = HMS_Rcp_FetchSync(session, request, &amp;errCode);</li><li><span class="hljs-keyword">if</span> (response != NULL) {</li><li>    <span class="hljs-keyword">printf</span>(<span class="hljs-string">"Response status: %d\n"</span>, response-&gt;statusCode);</li><li>} <span class="hljs-keyword">else</span> {</li><li>    <span class="hljs-keyword">printf</span>(<span class="hljs-string">"Fetch failed: errCode: %u\n"</span>, errCode);</li><li>}</li></ol></pre></div></div>       <p></p></li>      <li><span>清理response响应和request请求。最后关闭session。（实际使用时请将该代码块放入main函数或者其他函数区域内）。</span>       <p></p>       <div _ngcontent-nks-c106="" class="highlight-div"><div _ngcontent-nks-c106="" class="highlight-div-header"><div _ngcontent-nks-c106="" class="highlight-div-header-left"><div _ngcontent-nks-c106="" class="handle-button expand-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-nks-c106="" class="highlight-div-header-right"><div _ngcontent-nks-c106="" class="handle-button ai-button"></div><div _ngcontent-nks-c106="" class="handle-button line-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-nks-c106="" class="handle-button theme-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-nks-c106="" class="handle-button copy-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-nks-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 清理request</span></li><li><span class="hljs-title function_">HMS_Rcp_DestroyRequest</span>(<span class="hljs-variable">request</span>);</li><li><span class="hljs-comment">// 处理response，并清理response</span></li><li><span class="hljs-keyword">if</span> (<span class="hljs-variable">response</span> != <span class="hljs-variable">NULL</span>) {</li><li>    <span class="hljs-variable">response</span>-&gt;<span class="hljs-title class_">destroyResponse</span>(<span class="hljs-title class_">response</span>);</li><li>}</li><li><span class="hljs-comment">// 关闭session</span></li><li><span class="hljs-variable">errCode</span> = <span class="hljs-title function_">HMS_Rcp_CloseSession</span>(&amp;<span class="hljs-title class_">session</span>);</li><li><span class="hljs-comment">// 处理errCode</span></li></ol></pre></div></div>       <p></p></li>     </ol>    </div>    <div class="tiledSection">     <h2 id="section5464153582210">如何使用fetch发起异步网络请求<i class="anchor-icon anchor-icon-link" anchorid="section5464153582210" tips="复制节点链接"></i></h2>          <p>发送一个异步HTTP请求，也可以设置请求头和请求体等参数，并返回来自服务器的HTTP响应。常用于获取资源，支持通过拦截器来处理请求和响应。</p>    </div>    <div class="tiledSection">     <h3 id="section349363115128" class="firsth2">接口说明<i class="anchor-icon anchor-icon-link" anchorid="section349363115128" tips="复制节点链接"></i></h3>          <p>具体API说明详见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/remote-communication-overview#ga7ea546b69b9ea60ea4716ee64e8b04cb" target="_blank">接口文档</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.6.3.1.3.1.1" valign="top" width="50%">          <p>接口名</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.6.3.1.3.1.2" valign="top" width="50%">          <p>描述</p></th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="50%">          <p>uint32_t HMS_Rcp_Fetch(<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/remote-communication-overview#ga4f3a7d39c18fe6fdf01c52759213ddcd" target="_blank">Rcp_Session</a> *session, <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/remote-communication-overview#ga98dde966841135537e05053bf4da4d5b" target="_blank">Rcp_Request</a> *request, const <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/remote-communication-overview#ga815137188d22749aff74afef7387860a" target="_blank">Rcp_ResponseCallbackObject</a> *responseCallback);</p></td>         <td class="cellrowborder" valign="top" width="50%">          <p>发送一个HTTP请求，并返回来自服务器的HTTP响应。使用responseCallback异步回调。</p></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h3 id="section15711350112316">使用示例<i class="anchor-icon anchor-icon-link" anchorid="section15711350112316" tips="复制节点链接"></i></h3>          <ol>      <li><span>CPP侧导入模块。</span>       <p></p>       <div _ngcontent-nks-c106="" class="highlight-div"><div _ngcontent-nks-c106="" class="highlight-div-header"><div _ngcontent-nks-c106="" class="highlight-div-header-left"><div _ngcontent-nks-c106="" class="handle-button expand-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-nks-c106="" class="highlight-div-header-right"><div _ngcontent-nks-c106="" class="handle-button ai-button"></div><div _ngcontent-nks-c106="" class="handle-button line-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-nks-c106="" class="handle-button theme-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-nks-c106="" class="handle-button copy-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-nks-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"RemoteCommunicationKit/rcp.h"</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstring&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;unistd.h&gt;</span></span></li></ol></pre></div></div>       <p></p></li>      <li><span>CMakeLists.txt中添加以下lib。（具体请见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/remote-communication-preparations#section2095732915253">C API开发准备</a>）。</span>       <p></p>       <div _ngcontent-nks-c106="" class="highlight-div"><div _ngcontent-nks-c106="" class="highlight-div-header"><div _ngcontent-nks-c106="" class="highlight-div-header-left"><div _ngcontent-nks-c106="" class="handle-button expand-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-nks-c106="" class="highlight-div-header-right"><div _ngcontent-nks-c106="" class="handle-button ai-button"></div><div _ngcontent-nks-c106="" class="handle-button line-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-nks-c106="" class="handle-button theme-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-nks-c106="" class="handle-button copy-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-nks-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-undefined" data-highlighted="yes"><ol class="linenums"><li>librcp_c.so</li></ol></pre></div></div>       <p></p></li>      <li><span>创建Request对象。"https://www.example.com"请根据实际情况替换为想要请求的URL地址。（完整见步骤5）</span>       <p></p>       <div _ngcontent-nks-c106="" class="highlight-div"><div _ngcontent-nks-c106="" class="highlight-div-header"><div _ngcontent-nks-c106="" class="highlight-div-header-left"><div _ngcontent-nks-c106="" class="handle-button expand-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-nks-c106="" class="highlight-div-header-right"><div _ngcontent-nks-c106="" class="handle-button ai-button"></div><div _ngcontent-nks-c106="" class="handle-button line-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-nks-c106="" class="handle-button theme-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-nks-c106="" class="handle-button copy-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-nks-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-type">const</span> <span class="hljs-type">char</span> *kHttpServerAddress = <span class="hljs-string">"http://www.example.com"</span>;</li><li>Rcp_Request *request = <span class="hljs-built_in">HMS_Rcp_CreateRequest</span>(kHttpServerAddress);</li></ol></pre></div></div>       <p></p></li>      <li><span>创建会话。（完整见步骤5）</span>       <p></p>       <div _ngcontent-nks-c106="" class="highlight-div"><div _ngcontent-nks-c106="" class="highlight-div-header"><div _ngcontent-nks-c106="" class="highlight-div-header-left"><div _ngcontent-nks-c106="" class="handle-button expand-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-nks-c106="" class="highlight-div-header-right"><div _ngcontent-nks-c106="" class="handle-button ai-button"></div><div _ngcontent-nks-c106="" class="handle-button line-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-nks-c106="" class="handle-button theme-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-nks-c106="" class="handle-button copy-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-nks-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-type">uint32_t</span> errCode = <span class="hljs-number">0</span>;</li><li>Rcp_Session *session = <span class="hljs-built_in">HMS_Rcp_CreateSession</span>(<span class="hljs-literal">NULL</span>, &amp;errCode);</li></ol></pre></div></div>       <p></p></li>      <li><span>发起请求，并处理返回结果。最后关闭session。</span>       <p></p>       <div _ngcontent-nks-c106="" class="highlight-div"><div _ngcontent-nks-c106="" class="highlight-div-header"><div _ngcontent-nks-c106="" class="highlight-div-header-left"><div _ngcontent-nks-c106="" class="handle-button expand-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-nks-c106="" class="highlight-div-header-right"><div _ngcontent-nks-c106="" class="handle-button ai-button"></div><div _ngcontent-nks-c106="" class="handle-button line-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-nks-c106="" class="handle-button theme-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-nks-c106="" class="handle-button copy-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-nks-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 异步请求的响应处理回调，请用户自定义</span></li><li><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">ResponseCallback</span><span class="hljs-params">(<span class="hljs-type">void</span> *usrCtx, Rcp_Response *response, <span class="hljs-type">uint32_t</span> errCode)</span></span></li><li><span class="hljs-function"></span>{</li><li>    (<span class="hljs-type">void</span> *)usrCtx;</li><li>    <span class="hljs-keyword">if</span> (response != <span class="hljs-literal">NULL</span>) {</li><li>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Response status: %d\n"</span>, response-&gt;statusCode);</li><li>    } <span class="hljs-keyword">else</span> {</li><li>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Fetch failed: errCode: %u\n"</span>, errCode);</li><li>    }</li><li>    <span class="hljs-comment">// 注意清理响应</span></li><li>    <span class="hljs-keyword">if</span> (response != <span class="hljs-literal">NULL</span>) {</li><li>        response-&gt;<span class="hljs-built_in">destroyResponse</span>(response);</li><li>    }</li><li>}</li><li>
</li><li><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{</li><li>    <span class="hljs-type">const</span> <span class="hljs-type">char</span> *kHttpServerAddress = <span class="hljs-string">"http://www.example.com"</span>;</li><li>    <span class="hljs-comment">// 请求配置</span></li><li>    Rcp_Configuration config;</li><li>    <span class="hljs-comment">// 初始化配置参数</span></li><li>    (<span class="hljs-type">void</span>)<span class="hljs-built_in">memset</span>(&amp;config, <span class="hljs-number">0</span>, <span class="hljs-built_in">sizeof</span>(Rcp_Configuration));</li><li>    <span class="hljs-comment">// 重新设置自动重定向</span></li><li>    config.transferConfiguration.autoRedirect = <span class="hljs-literal">true</span>;</li><li>    <span class="hljs-comment">// 重新设置请求超时配置参数</span></li><li>    config.transferConfiguration.timeout.transferMs = <span class="hljs-number">1000</span> * <span class="hljs-number">10</span>;</li><li>    config.transferConfiguration.timeout.connectMs = <span class="hljs-number">1000</span> * <span class="hljs-number">10</span>;</li><li>    Rcp_Request *request = <span class="hljs-built_in">HMS_Rcp_CreateRequest</span>(kHttpServerAddress);</li><li>    request-&gt;method = RCP_METHOD_GET;</li><li>    request-&gt;configuration = &amp;config;</li><li>    <span class="hljs-type">uint32_t</span> errCode = <span class="hljs-number">0</span>;</li><li>    <span class="hljs-comment">// 创建session</span></li><li>    Rcp_Session *session = <span class="hljs-built_in">HMS_Rcp_CreateSession</span>(<span class="hljs-literal">NULL</span>, &amp;errCode);</li><li>    <span class="hljs-comment">// 配置请求回调</span></li><li>    Rcp_ResponseCallbackObject responseCallback = {ResponseCallback, <span class="hljs-literal">NULL</span>};</li><li>    <span class="hljs-comment">// 发起fetch请求</span></li><li>    errCode = <span class="hljs-built_in">HMS_Rcp_Fetch</span>(session, request, &amp;responseCallback);</li><li>    <span class="hljs-comment">// 等待fetch结果，仅是等待异步调用完成，开发者可根据自己实际场景处理回调。</span></li><li>    <span class="hljs-built_in">usleep</span>(<span class="hljs-number">1000</span> * <span class="hljs-number">1000</span> * <span class="hljs-number">3</span>);</li><li>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Fetch completed, errCode: %u\n"</span>, errCode);</li><li>    <span class="hljs-comment">// 在退出前取消可能还在执行的requests</span></li><li>    errCode = <span class="hljs-built_in">HMS_Rcp_CancelSession</span>(session);</li><li>    <span class="hljs-comment">// 清理request</span></li><li>    <span class="hljs-built_in">HMS_Rcp_DestroyRequest</span>(request);</li><li>    <span class="hljs-comment">// 关闭session</span></li><li>    errCode = <span class="hljs-built_in">HMS_Rcp_CloseSession</span>(&amp;session);</li><li>    <span class="hljs-comment">// 处理errCode</span></li><li>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;</li><li>}</li></ol></pre></div></div>       <p></p></li>     </ol>    </div>    <div class="tiledSection">     <h2 id="section3810114814277">如何使用get发送网络请求<i class="anchor-icon anchor-icon-link" anchorid="section3810114814277" tips="复制节点链接"></i></h2>          <p>发送一个带有默认HTTP参数的HTTP GET请求，并返回来自服务器的HTTP响应。采用异步回调的方式进行处理，提高应用的响应性和效率。常用于从服务器获取数据。</p>    </div>    <div class="tiledSection">     <h3 id="section18908737131118" class="firsth2">使用示例<i class="anchor-icon anchor-icon-link" anchorid="section18908737131118" tips="复制节点链接"></i></h3>          <ol>      <li><span>CPP侧导入模块。</span>       <p></p>       <div _ngcontent-nks-c106="" class="highlight-div"><div _ngcontent-nks-c106="" class="highlight-div-header"><div _ngcontent-nks-c106="" class="highlight-div-header-left"><div _ngcontent-nks-c106="" class="handle-button expand-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-nks-c106="" class="highlight-div-header-right"><div _ngcontent-nks-c106="" class="handle-button ai-button"></div><div _ngcontent-nks-c106="" class="handle-button line-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-nks-c106="" class="handle-button theme-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-nks-c106="" class="handle-button copy-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-nks-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"RemoteCommunicationKit/rcp.h"</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstring&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;unistd.h&gt;</span></span></li></ol></pre></div></div>       <p></p></li>      <li><span>CMakeLists.txt中添加以下lib。（具体请见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/remote-communication-preparations#section2095732915253">C API开发准备</a>）。</span>       <p></p>       <div _ngcontent-nks-c106="" class="highlight-div"><div _ngcontent-nks-c106="" class="highlight-div-header"><div _ngcontent-nks-c106="" class="highlight-div-header-left"><div _ngcontent-nks-c106="" class="handle-button expand-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-nks-c106="" class="highlight-div-header-right"><div _ngcontent-nks-c106="" class="handle-button ai-button"></div><div _ngcontent-nks-c106="" class="handle-button line-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-nks-c106="" class="handle-button theme-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-nks-c106="" class="handle-button copy-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-nks-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-undefined" data-highlighted="yes"><ol class="linenums"><li>librcp_c.so</li></ol></pre></div></div>       <p></p></li>      <li><span>创建会话，会话发起get请求。“http://www.example.com”请根据实际情况替换为想要请求的URL地址。等待响应返回后，销毁request并关闭session。</span>       <p></p>       <div _ngcontent-nks-c106="" class="highlight-div"><div _ngcontent-nks-c106="" class="highlight-div-header"><div _ngcontent-nks-c106="" class="highlight-div-header-left"><div _ngcontent-nks-c106="" class="handle-button expand-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-nks-c106="" class="highlight-div-header-right"><div _ngcontent-nks-c106="" class="handle-button ai-button"></div><div _ngcontent-nks-c106="" class="handle-button line-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-nks-c106="" class="handle-button theme-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-nks-c106="" class="handle-button copy-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-nks-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">ResponseCallback</span><span class="hljs-params">(<span class="hljs-type">void</span> *usrCtx, Rcp_Response *response, <span class="hljs-type">uint32_t</span> errCode)</span></span></li><li><span class="hljs-function"></span>{</li><li>    (<span class="hljs-type">void</span> *)usrCtx;</li><li>    <span class="hljs-keyword">if</span> (response != <span class="hljs-literal">NULL</span>) {</li><li>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Response status: %d\n"</span>, response-&gt;statusCode);</li><li>    } <span class="hljs-keyword">else</span> {</li><li>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Fetch failed: errCode: %u\n"</span>, errCode);</li><li>    }</li><li>    <span class="hljs-comment">// 注意清理响应</span></li><li>    <span class="hljs-keyword">if</span> (response != <span class="hljs-literal">NULL</span>) {</li><li>        response-&gt;<span class="hljs-built_in">destroyResponse</span>(response);</li><li>    }</li><li>}</li><li>
</li><li><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{</li><li>    <span class="hljs-type">const</span> <span class="hljs-type">char</span> *kHttpServerAddress = <span class="hljs-string">"http://www.example.com"</span>;</li><li>    <span class="hljs-comment">// 请求配置</span></li><li>    Rcp_Configuration config;</li><li>    <span class="hljs-comment">// 初始化配置参数</span></li><li>    (<span class="hljs-type">void</span>)<span class="hljs-built_in">memset</span>(&amp;config, <span class="hljs-number">0</span>, <span class="hljs-built_in">sizeof</span>(Rcp_Configuration));</li><li>    <span class="hljs-comment">// 重新设置自动重定向</span></li><li>    config.transferConfiguration.autoRedirect = <span class="hljs-literal">true</span>;</li><li>    <span class="hljs-comment">// 重新设置请求超时配置参数</span></li><li>    config.transferConfiguration.timeout.transferMs = <span class="hljs-number">1000</span> * <span class="hljs-number">10</span>;</li><li>    config.transferConfiguration.timeout.connectMs = <span class="hljs-number">1000</span> * <span class="hljs-number">10</span>;</li><li>    Rcp_Request *request = <span class="hljs-built_in">HMS_Rcp_CreateRequest</span>(kHttpServerAddress);</li><li>    request-&gt;method = RCP_METHOD_GET;</li><li>    request-&gt;configuration = &amp;config;</li><li>    <span class="hljs-type">uint32_t</span> errCode = <span class="hljs-number">0</span>;</li><li>    <span class="hljs-comment">// 创建session</span></li><li>    Rcp_Session *session = <span class="hljs-built_in">HMS_Rcp_CreateSession</span>(<span class="hljs-literal">NULL</span>, &amp;errCode);</li><li>    <span class="hljs-comment">// 配置请求回调</span></li><li>    Rcp_ResponseCallbackObject responseCallback = {ResponseCallback, <span class="hljs-literal">NULL</span>};</li><li>    <span class="hljs-comment">// 发起请求</span></li><li>    errCode = <span class="hljs-built_in">HMS_Rcp_Fetch</span>(session, request, &amp;responseCallback);</li><li>    <span class="hljs-comment">// 等待结果，仅是等待异步调用完成，开发者可根据自己实际场景处理回调。</span></li><li>    <span class="hljs-built_in">usleep</span>(<span class="hljs-number">1000</span> * <span class="hljs-number">1000</span> * <span class="hljs-number">3</span>);</li><li>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Fetch completed, errCode: %u\n"</span>, errCode);</li><li>    <span class="hljs-comment">// 在退出前取消可能还在执行的requests</span></li><li>    errCode = <span class="hljs-built_in">HMS_Rcp_CancelSession</span>(session);</li><li>    <span class="hljs-comment">// 清理request</span></li><li>    <span class="hljs-built_in">HMS_Rcp_DestroyRequest</span>(request);</li><li>    <span class="hljs-comment">// 关闭session</span></li><li>    errCode = <span class="hljs-built_in">HMS_Rcp_CloseSession</span>(&amp;session);</li><li>    <span class="hljs-comment">// 处理errCode</span></li><li>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;</li><li>}</li></ol></pre></div></div>       <p></p></li>     </ol>    </div>    <div class="tiledSection">     <h2 id="section86905851310">如何使用post发送网络请求<i class="anchor-icon anchor-icon-link" anchorid="section86905851310" tips="复制节点链接"></i></h2>          <p>发送一个带有默认HTTP参数的HTTP POST请求，并返回来自服务器的HTTP响应。使用异步回调。常用于向服务器提交数据。与GET请求不同，POST请求将参数包含在请求主体中，适用于创建新资源、提交表单数据或执行某些操作。</p>    </div>    <div class="tiledSection">     <h3 id="section378753661415" class="firsth2">使用示例<i class="anchor-icon anchor-icon-link" anchorid="section378753661415" tips="复制节点链接"></i></h3>          <ol>      <li><span>CPP侧导入模块。</span>       <p></p>       <div _ngcontent-nks-c106="" class="highlight-div"><div _ngcontent-nks-c106="" class="highlight-div-header"><div _ngcontent-nks-c106="" class="highlight-div-header-left"><div _ngcontent-nks-c106="" class="handle-button expand-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-nks-c106="" class="highlight-div-header-right"><div _ngcontent-nks-c106="" class="handle-button ai-button"></div><div _ngcontent-nks-c106="" class="handle-button line-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-nks-c106="" class="handle-button theme-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-nks-c106="" class="handle-button copy-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-nks-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"RemoteCommunicationKit/rcp.h"</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstdlib&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstring&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;unistd.h&gt;</span></span></li></ol></pre></div></div>       <p></p></li>      <li><span>CMakeLists.txt中添加以下lib。（具体请见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/remote-communication-preparations#section2095732915253">C API开发准备</a>）。</span>       <p></p>       <div _ngcontent-nks-c106="" class="highlight-div"><div _ngcontent-nks-c106="" class="highlight-div-header"><div _ngcontent-nks-c106="" class="highlight-div-header-left"><div _ngcontent-nks-c106="" class="handle-button expand-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-nks-c106="" class="highlight-div-header-right"><div _ngcontent-nks-c106="" class="handle-button ai-button"></div><div _ngcontent-nks-c106="" class="handle-button line-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-nks-c106="" class="handle-button theme-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-nks-c106="" class="handle-button copy-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-nks-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-undefined" data-highlighted="yes"><ol class="linenums"><li>librcp_c.so</li></ol></pre></div></div>       <p></p></li>      <li><span>创建会话，会话发起post请求。“http://www.example.com”请根据实际情况替换为想要请求的URL地址。等待响应返回后，销毁request并关闭session。</span>       <p></p>       <div _ngcontent-nks-c106="" class="highlight-div"><div _ngcontent-nks-c106="" class="highlight-div-header"><div _ngcontent-nks-c106="" class="highlight-div-header-left"><div _ngcontent-nks-c106="" class="handle-button expand-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-nks-c106="" class="highlight-div-header-right"><div _ngcontent-nks-c106="" class="handle-button ai-button"></div><div _ngcontent-nks-c106="" class="handle-button line-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-nks-c106="" class="handle-button theme-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-nks-c106="" class="handle-button copy-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-nks-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-variable">void</span> <span class="hljs-title function_">ResponseCallback</span>(<span class="hljs-variable">void</span> *<span class="hljs-variable">usrCtx</span>, <span class="hljs-variable">Rcp_Response</span> *<span class="hljs-variable">response</span>, <span class="hljs-variable">uint32_t</span> <span class="hljs-variable">errCode</span>)</li><li>{</li><li>    (<span class="hljs-variable">void</span> *)<span class="hljs-variable">usrCtx</span>;</li><li>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">response</span> != <span class="hljs-variable">NULL</span>) {</li><li>        <span class="hljs-title function_">printf</span>(<span class="hljs-string">"Response status: %d\n"</span>, <span class="hljs-variable">response</span>-&gt;<span class="hljs-title class_">statusCode</span>);</li><li>    } <span class="hljs-keyword">else</span> {</li><li>        <span class="hljs-title function_">printf</span>(<span class="hljs-string">"Fetch failed: errCode: %u\n"</span>, <span class="hljs-variable">errCode</span>);</li><li>    }</li><li>    <span class="hljs-comment">// 注意清理响应</span></li><li>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">response</span> != <span class="hljs-variable">NULL</span>) {</li><li>        <span class="hljs-variable">response</span>-&gt;<span class="hljs-title class_">destroyResponse</span>(<span class="hljs-title class_">response</span>);</li><li>    }</li><li>}</li><li>
</li><li><span class="hljs-variable">int</span> <span class="hljs-keyword">main</span>() {</li><li>    <span class="hljs-keyword">const</span> <span class="hljs-variable">char</span> *<span class="hljs-variable">kHttpServerAddress</span> = <span class="hljs-string">"http://www.example.com"</span>;</li><li>    <span class="hljs-keyword">const</span> <span class="hljs-variable">char</span> *<span class="hljs-variable">content</span> = <span class="hljs-string">"content"</span>;</li><li>    <span class="hljs-variable">Rcp_Request</span> *<span class="hljs-variable">request</span> = <span class="hljs-title function_">HMS_Rcp_CreateRequest</span>(<span class="hljs-variable">kHttpServerAddress</span>);</li><li>    <span class="hljs-comment">// 设置request参数</span></li><li>    <span class="hljs-variable">request</span>-&gt;<span class="hljs-title class_">method</span> = <span class="hljs-variable">RCP_METHOD_POST</span>;</li><li>    <span class="hljs-variable">request</span>-&gt;<span class="hljs-title class_">content</span> = (<span class="hljs-variable">Rcp_RequestContent</span> *)<span class="hljs-title function_">calloc</span>(<span class="hljs-number">1</span>, <span class="hljs-title function_">sizeof</span>(<span class="hljs-variable">Rcp_RequestContent</span>));</li><li>    <span class="hljs-variable">request</span>-&gt;<span class="hljs-title class_">content</span>-&gt;<span class="hljs-keyword">type</span> = <span class="hljs-variable">RCP_CONTENT_TYPE_STRING</span>;</li><li>    <span class="hljs-variable">request</span>-&gt;<span class="hljs-title class_">content</span>-&gt;<span class="hljs-title class_">data</span>.<span class="hljs-title class_">contentStr</span>.<span class="hljs-title class_">buffer</span> = <span class="hljs-variable">content</span>;</li><li>    <span class="hljs-variable">request</span>-&gt;<span class="hljs-title class_">content</span>-&gt;<span class="hljs-title class_">data</span>.<span class="hljs-title class_">contentStr</span>.<span class="hljs-title class_">length</span> = <span class="hljs-title function_">strlen</span>(<span class="hljs-variable">content</span>);</li><li>    <span class="hljs-comment">// 请求配置</span></li><li>    <span class="hljs-variable">Rcp_Configuration</span> <span class="hljs-variable">config</span>;</li><li>    <span class="hljs-comment">// 初始化配置参数</span></li><li>    (<span class="hljs-variable">void</span>)<span class="hljs-title function_">memset</span>(&amp;<span class="hljs-title class_">config</span>, <span class="hljs-number">0</span>, <span class="hljs-title function_">sizeof</span>(<span class="hljs-variable">Rcp_Configuration</span>));</li><li>    <span class="hljs-comment">// 重新设置自动重定向</span></li><li>    <span class="hljs-variable">config</span>.<span class="hljs-variable">transferConfiguration</span>.<span class="hljs-variable">autoRedirect</span> = <span class="hljs-keyword">true</span>;</li><li>    <span class="hljs-comment">// 重新设置请求超时配置参数</span></li><li>    <span class="hljs-variable">config</span>.<span class="hljs-variable">transferConfiguration</span>.<span class="hljs-variable">timeout</span>.<span class="hljs-variable">transferMs</span> = <span class="hljs-number">1000</span> * <span class="hljs-number">10</span>;</li><li>    <span class="hljs-variable">config</span>.<span class="hljs-variable">transferConfiguration</span>.<span class="hljs-variable">timeout</span>.<span class="hljs-variable">connectMs</span> = <span class="hljs-number">1000</span> * <span class="hljs-number">10</span>;</li><li>    <span class="hljs-variable">request</span>-&gt;<span class="hljs-title class_">configuration</span> = &amp;<span class="hljs-title class_">config</span>;</li><li>    <span class="hljs-variable">uint32_t</span> <span class="hljs-variable">errCode</span> = <span class="hljs-number">0</span>;</li><li>    <span class="hljs-comment">// 创建session</span></li><li>    <span class="hljs-variable">Rcp_Session</span> *<span class="hljs-variable">session</span> = <span class="hljs-title function_">HMS_Rcp_CreateSession</span>(<span class="hljs-variable">NULL</span>, &amp;<span class="hljs-title class_">errCode</span>);</li><li>    <span class="hljs-comment">// 配置请求回调</span></li><li>    <span class="hljs-variable">Rcp_ResponseCallbackObject</span> <span class="hljs-variable">responseCallback</span> = {<span class="hljs-variable">ResponseCallback</span>, <span class="hljs-variable">NULL</span>};</li><li>    <span class="hljs-comment">// 发起请求</span></li><li>    <span class="hljs-variable">errCode</span> = <span class="hljs-title function_">HMS_Rcp_Fetch</span>(<span class="hljs-variable">session</span>, <span class="hljs-variable">request</span>, &amp;<span class="hljs-title class_">responseCallback</span>);</li><li>    <span class="hljs-comment">// 等待fetch结果，仅是等待异步调用完成，开发者可根据自己实际场景处理回调。</span></li><li>    <span class="hljs-title function_">usleep</span>(<span class="hljs-number">1000</span> * <span class="hljs-number">1000</span> * <span class="hljs-number">3</span>);</li><li>    <span class="hljs-title function_">printf</span>(<span class="hljs-string">"Fetch completed, errCode: %u\n"</span>, <span class="hljs-variable">errCode</span>);</li><li>    <span class="hljs-comment">// 清理request</span></li><li>    <span class="hljs-title function_">HMS_Rcp_DestroyRequest</span>(<span class="hljs-variable">request</span>);</li><li>    <span class="hljs-comment">// 清理request-&gt;content</span></li><li>    <span class="hljs-title function_">free</span>(<span class="hljs-variable">request</span>-&gt;<span class="hljs-title class_">content</span>);</li><li>    <span class="hljs-comment">// 关闭session</span></li><li>    <span class="hljs-variable">errCode</span> = <span class="hljs-title function_">HMS_Rcp_CloseSession</span>(&amp;<span class="hljs-title class_">session</span>);</li><li>    <span class="hljs-comment">// 处理errCode</span></li><li>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;</li><li>}</li></ol></pre></div></div>       <p></p></li>     </ol>    </div>    <div class="tiledSection">     <h2 id="section16960145318">如何使用put发送网络请求<i class="anchor-icon anchor-icon-link" anchorid="section16960145318" tips="复制节点链接"></i></h2>          <p>发送一个带有默认HTTP参数的HTTP PUT请求，并返回来自服务器的HTTP响应。使用异步回调。常用于向服务器更新资源。PUT请求将更新的数据发送到特定的URL，用于替换指定资源的全部内容。</p>    </div>    <div class="tiledSection">     <h3 id="section113041736183112" class="firsth2">使用示例<i class="anchor-icon anchor-icon-link" anchorid="section113041736183112" tips="复制节点链接"></i></h3>          <ol>      <li><span>CPP侧导入模块。</span>       <p></p>       <div _ngcontent-nks-c106="" class="highlight-div"><div _ngcontent-nks-c106="" class="highlight-div-header"><div _ngcontent-nks-c106="" class="highlight-div-header-left"><div _ngcontent-nks-c106="" class="handle-button expand-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-nks-c106="" class="highlight-div-header-right"><div _ngcontent-nks-c106="" class="handle-button ai-button"></div><div _ngcontent-nks-c106="" class="handle-button line-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-nks-c106="" class="handle-button theme-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-nks-c106="" class="handle-button copy-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-nks-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"RemoteCommunicationKit/rcp.h"</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstdlib&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstring&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;unistd.h&gt;</span></span></li></ol></pre></div></div>       <p></p></li>      <li><span>CMakeLists.txt中添加以下lib。（具体请见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/remote-communication-preparations#section2095732915253">C API开发准备</a>）。</span>       <p></p>       <div _ngcontent-nks-c106="" class="highlight-div"><div _ngcontent-nks-c106="" class="highlight-div-header"><div _ngcontent-nks-c106="" class="highlight-div-header-left"><div _ngcontent-nks-c106="" class="handle-button expand-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-nks-c106="" class="highlight-div-header-right"><div _ngcontent-nks-c106="" class="handle-button ai-button"></div><div _ngcontent-nks-c106="" class="handle-button line-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-nks-c106="" class="handle-button theme-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-nks-c106="" class="handle-button copy-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-nks-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-undefined" data-highlighted="yes"><ol class="linenums"><li>librcp_c.so</li></ol></pre></div></div>       <p></p></li>      <li><span>创建会话，会话发起put请求。“http://www.example.com”请根据实际情况替换为想要请求的URL地址。等待响应返回后，销毁request并关闭session。</span>       <p></p>       <div _ngcontent-nks-c106="" class="highlight-div"><div _ngcontent-nks-c106="" class="highlight-div-header"><div _ngcontent-nks-c106="" class="highlight-div-header-left"><div _ngcontent-nks-c106="" class="handle-button expand-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-nks-c106="" class="highlight-div-header-right"><div _ngcontent-nks-c106="" class="handle-button ai-button"></div><div _ngcontent-nks-c106="" class="handle-button line-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-nks-c106="" class="handle-button theme-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-nks-c106="" class="handle-button copy-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-nks-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-variable">void</span> <span class="hljs-title function_">ResponseCallback</span>(<span class="hljs-variable">void</span> *<span class="hljs-variable">usrCtx</span>, <span class="hljs-variable">Rcp_Response</span> *<span class="hljs-variable">response</span>, <span class="hljs-variable">uint32_t</span> <span class="hljs-variable">errCode</span>)</li><li>{</li><li>    (<span class="hljs-variable">void</span> *)<span class="hljs-variable">usrCtx</span>;</li><li>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">response</span> != <span class="hljs-variable">NULL</span>) {</li><li>        <span class="hljs-title function_">printf</span>(<span class="hljs-string">"Response status: %d\n"</span>, <span class="hljs-variable">response</span>-&gt;<span class="hljs-title class_">statusCode</span>);</li><li>    } <span class="hljs-keyword">else</span> {</li><li>        <span class="hljs-title function_">printf</span>(<span class="hljs-string">"Fetch failed: errCode: %u\n"</span>, <span class="hljs-variable">errCode</span>);</li><li>    }</li><li>    <span class="hljs-comment">// 注意清理响应</span></li><li>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">response</span> != <span class="hljs-variable">NULL</span>) {</li><li>        <span class="hljs-variable">response</span>-&gt;<span class="hljs-title class_">destroyResponse</span>(<span class="hljs-title class_">response</span>);</li><li>    }</li><li>}</li><li>
</li><li><span class="hljs-variable">int</span> <span class="hljs-keyword">main</span>() {</li><li>    <span class="hljs-keyword">const</span> <span class="hljs-variable">char</span> *<span class="hljs-variable">kHttpServerAddress</span> = <span class="hljs-string">"http://www.example.com"</span>;</li><li>    <span class="hljs-keyword">const</span> <span class="hljs-variable">char</span> *<span class="hljs-variable">content</span> = <span class="hljs-string">"content"</span>;</li><li>    <span class="hljs-comment">// 创建request，并设置request的参数</span></li><li>    <span class="hljs-variable">Rcp_Request</span> *<span class="hljs-variable">request</span> = <span class="hljs-title function_">HMS_Rcp_CreateRequest</span>(<span class="hljs-variable">kHttpServerAddress</span>);</li><li>    <span class="hljs-variable">request</span>-&gt;<span class="hljs-title class_">method</span> = <span class="hljs-variable">RCP_METHOD_PUT</span>;</li><li>    <span class="hljs-variable">request</span>-&gt;<span class="hljs-title class_">content</span> = (<span class="hljs-variable">Rcp_RequestContent</span> *)<span class="hljs-title function_">calloc</span>(<span class="hljs-number">1</span>, <span class="hljs-title function_">sizeof</span>(<span class="hljs-variable">Rcp_RequestContent</span>));</li><li>    <span class="hljs-variable">request</span>-&gt;<span class="hljs-title class_">content</span>-&gt;<span class="hljs-keyword">type</span> = <span class="hljs-variable">RCP_CONTENT_TYPE_STRING</span>;</li><li>    <span class="hljs-variable">request</span>-&gt;<span class="hljs-title class_">content</span>-&gt;<span class="hljs-title class_">data</span>.<span class="hljs-title class_">contentStr</span>.<span class="hljs-title class_">buffer</span> = <span class="hljs-variable">content</span>;</li><li>    <span class="hljs-variable">request</span>-&gt;<span class="hljs-title class_">content</span>-&gt;<span class="hljs-title class_">data</span>.<span class="hljs-title class_">contentStr</span>.<span class="hljs-title class_">length</span> = <span class="hljs-title function_">strlen</span>(<span class="hljs-variable">content</span>);</li><li>    <span class="hljs-comment">// 请求配置</span></li><li>    <span class="hljs-variable">Rcp_Configuration</span> <span class="hljs-variable">config</span>;</li><li>    <span class="hljs-comment">// 初始化配置参数</span></li><li>    (<span class="hljs-variable">void</span>)<span class="hljs-title function_">memset</span>(&amp;<span class="hljs-title class_">config</span>, <span class="hljs-number">0</span>, <span class="hljs-title function_">sizeof</span>(<span class="hljs-variable">Rcp_Configuration</span>));</li><li>    <span class="hljs-comment">// 重新设置自动重定向</span></li><li>    <span class="hljs-variable">config</span>.<span class="hljs-variable">transferConfiguration</span>.<span class="hljs-variable">autoRedirect</span> = <span class="hljs-keyword">true</span>;</li><li>    <span class="hljs-comment">// 重新设置请求超时配置参数</span></li><li>    <span class="hljs-variable">config</span>.<span class="hljs-variable">transferConfiguration</span>.<span class="hljs-variable">timeout</span>.<span class="hljs-variable">transferMs</span> = <span class="hljs-number">1000</span> * <span class="hljs-number">10</span>;</li><li>    <span class="hljs-variable">config</span>.<span class="hljs-variable">transferConfiguration</span>.<span class="hljs-variable">timeout</span>.<span class="hljs-variable">connectMs</span> = <span class="hljs-number">1000</span> * <span class="hljs-number">10</span>;</li><li>    <span class="hljs-variable">request</span>-&gt;<span class="hljs-title class_">configuration</span> = &amp;<span class="hljs-title class_">config</span>;</li><li>    <span class="hljs-variable">uint32_t</span> <span class="hljs-variable">errCode</span> = <span class="hljs-number">0</span>;</li><li>    <span class="hljs-comment">// 创建session</span></li><li>    <span class="hljs-variable">Rcp_Session</span> *<span class="hljs-variable">session</span> = <span class="hljs-title function_">HMS_Rcp_CreateSession</span>(<span class="hljs-variable">NULL</span>, &amp;<span class="hljs-title class_">errCode</span>);</li><li>    <span class="hljs-comment">// 配置请求回调</span></li><li>    <span class="hljs-variable">Rcp_ResponseCallbackObject</span> <span class="hljs-variable">responseCallback</span> = {<span class="hljs-variable">ResponseCallback</span>, <span class="hljs-variable">NULL</span>};</li><li>    <span class="hljs-comment">// 发起fetch请求</span></li><li>    <span class="hljs-variable">errCode</span> = <span class="hljs-title function_">HMS_Rcp_Fetch</span>(<span class="hljs-variable">session</span>, <span class="hljs-variable">request</span>, &amp;<span class="hljs-title class_">responseCallback</span>);</li><li>    <span class="hljs-comment">// 等待结果，仅是等待异步调用完成，开发者可根据自己实际场景处理回调。</span></li><li>    <span class="hljs-title function_">usleep</span>(<span class="hljs-number">1000</span> * <span class="hljs-number">1000</span> * <span class="hljs-number">3</span>);</li><li>    <span class="hljs-title function_">printf</span>(<span class="hljs-string">"Fetch completed, errCode: %u\n"</span>, <span class="hljs-variable">errCode</span>);</li><li>    <span class="hljs-comment">// 在退出前取消可能还在执行的requests </span></li><li>    <span class="hljs-variable">errCode</span> = <span class="hljs-title function_">HMS_Rcp_CancelSession</span>(<span class="hljs-variable">session</span>);</li><li>    <span class="hljs-comment">// 清理request</span></li><li>    <span class="hljs-title function_">HMS_Rcp_DestroyRequest</span>(<span class="hljs-variable">request</span>);</li><li>    <span class="hljs-comment">// 关闭session</span></li><li>    <span class="hljs-variable">errCode</span> = <span class="hljs-title function_">HMS_Rcp_CloseSession</span>(&amp;<span class="hljs-title class_">session</span>);</li><li>    <span class="hljs-comment">// 处理errCode</span></li><li>    <span class="hljs-comment">// 清理request content</span></li><li>    <span class="hljs-title function_">free</span>(<span class="hljs-variable">request</span>-&gt;<span class="hljs-title class_">content</span>);</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;</li><li>}</li></ol></pre></div></div>       <p></p></li>     </ol>    </div>    <div class="tiledSection">     <h2 id="section173281419325">如何使用head发送网络请求<i class="anchor-icon anchor-icon-link" anchorid="section173281419325" tips="复制节点链接"></i></h2>          <p>发送一个带有默认HTTP参数的HTTP HEAD请求，并返回来自服务器的HTTP响应。使用异步回调。类似GET请求，但只返回响应头，不返回实体内容。可以获取资源的元信息，如文件大小、修改日期等。</p>    </div>    <div class="tiledSection">     <h3 id="section65472332329" class="firsth2">使用示例<i class="anchor-icon anchor-icon-link" anchorid="section65472332329" tips="复制节点链接"></i></h3>          <ol>      <li><span>CPP侧导入模块。</span>       <p></p>       <div _ngcontent-nks-c106="" class="highlight-div"><div _ngcontent-nks-c106="" class="highlight-div-header"><div _ngcontent-nks-c106="" class="highlight-div-header-left"><div _ngcontent-nks-c106="" class="handle-button expand-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-nks-c106="" class="highlight-div-header-right"><div _ngcontent-nks-c106="" class="handle-button ai-button"></div><div _ngcontent-nks-c106="" class="handle-button line-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-nks-c106="" class="handle-button theme-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-nks-c106="" class="handle-button copy-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-nks-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"RemoteCommunicationKit/rcp.h"</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstring&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;unistd.h&gt;</span></span></li></ol></pre></div></div>       <p></p></li>      <li><span>CMakeLists.txt中添加以下lib。（具体请见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/remote-communication-preparations#section2095732915253">C API开发准备</a>）。</span>       <p></p>       <div _ngcontent-nks-c106="" class="highlight-div"><div _ngcontent-nks-c106="" class="highlight-div-header"><div _ngcontent-nks-c106="" class="highlight-div-header-left"><div _ngcontent-nks-c106="" class="handle-button expand-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-nks-c106="" class="highlight-div-header-right"><div _ngcontent-nks-c106="" class="handle-button ai-button"></div><div _ngcontent-nks-c106="" class="handle-button line-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-nks-c106="" class="handle-button theme-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-nks-c106="" class="handle-button copy-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-nks-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-undefined" data-highlighted="yes"><ol class="linenums"><li>librcp_c.so</li></ol></pre></div></div>       <p></p></li>      <li><span>创建会话，会话发起head请求。“http://www.example.com”请根据实际情况替换为想要请求的URL地址。等待响应返回后，销毁request并关闭session。</span>       <p></p>       <div _ngcontent-nks-c106="" class="highlight-div"><div _ngcontent-nks-c106="" class="highlight-div-header"><div _ngcontent-nks-c106="" class="highlight-div-header-left"><div _ngcontent-nks-c106="" class="handle-button expand-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-nks-c106="" class="highlight-div-header-right"><div _ngcontent-nks-c106="" class="handle-button ai-button"></div><div _ngcontent-nks-c106="" class="handle-button line-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-nks-c106="" class="handle-button theme-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-nks-c106="" class="handle-button copy-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-nks-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">ResponseCallback</span><span class="hljs-params">(<span class="hljs-type">void</span> *usrCtx, Rcp_Response *response, <span class="hljs-type">uint32_t</span> errCode)</span></span></li><li><span class="hljs-function"></span>{</li><li>    (<span class="hljs-type">void</span> *)usrCtx;</li><li>    <span class="hljs-keyword">if</span> (response != <span class="hljs-literal">NULL</span>) {</li><li>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Response status: %d\n"</span>, response-&gt;statusCode);</li><li>    } <span class="hljs-keyword">else</span> {</li><li>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Fetch failed: errCode: %u\n"</span>, errCode);</li><li>    }</li><li>    <span class="hljs-comment">// 注意清理响应</span></li><li>    <span class="hljs-keyword">if</span> (response != <span class="hljs-literal">NULL</span>) {</li><li>        response-&gt;<span class="hljs-built_in">destroyResponse</span>(response);</li><li>    }</li><li>}</li><li>
</li><li><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{</li><li>    <span class="hljs-type">const</span> <span class="hljs-type">char</span> *kHttpServerAddress = <span class="hljs-string">"http://www.example.com/head"</span>;</li><li>    Rcp_Request *request = <span class="hljs-built_in">HMS_Rcp_CreateRequest</span>(kHttpServerAddress);</li><li>    request-&gt;method = RCP_METHOD_HEAD;</li><li>    <span class="hljs-comment">// 请求配置</span></li><li>    Rcp_Configuration config;</li><li>    <span class="hljs-comment">// 初始化配置参数</span></li><li>    (<span class="hljs-type">void</span>)<span class="hljs-built_in">memset</span>(&amp;config, <span class="hljs-number">0</span>, <span class="hljs-built_in">sizeof</span>(Rcp_Configuration));</li><li>    <span class="hljs-comment">// 重新设置自动重定向</span></li><li>    config.transferConfiguration.autoRedirect = <span class="hljs-literal">true</span>;</li><li>    <span class="hljs-comment">// 重新设置请求超时配置参数</span></li><li>    config.transferConfiguration.timeout.transferMs = <span class="hljs-number">1000</span> * <span class="hljs-number">10</span>;</li><li>    config.transferConfiguration.timeout.connectMs = <span class="hljs-number">1000</span> * <span class="hljs-number">10</span>;</li><li>    request-&gt;configuration = &amp;config;</li><li>    <span class="hljs-type">uint32_t</span> errCode = <span class="hljs-number">0</span>;</li><li>    <span class="hljs-comment">// 创建session</span></li><li>    Rcp_Session *session = <span class="hljs-built_in">HMS_Rcp_CreateSession</span>(<span class="hljs-literal">NULL</span>, &amp;errCode);</li><li>    <span class="hljs-comment">// 配置请求回调</span></li><li>    Rcp_ResponseCallbackObject responseCallback = {ResponseCallback, <span class="hljs-literal">NULL</span>};</li><li>    <span class="hljs-comment">// 发起fetch请求</span></li><li>    errCode = <span class="hljs-built_in">HMS_Rcp_Fetch</span>(session, request, &amp;responseCallback);</li><li>    <span class="hljs-comment">// 等待fetch结果，仅是等待异步调用完成，开发者可根据自己实际场景处理回调。</span></li><li>    <span class="hljs-built_in">usleep</span>(<span class="hljs-number">1000</span> * <span class="hljs-number">1000</span> * <span class="hljs-number">3</span>);</li><li>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Fetch completed, errCode: %u\n"</span>, errCode);</li><li>    <span class="hljs-comment">// 在退出前取消可能还在执行的requests </span></li><li>    errCode = <span class="hljs-built_in">HMS_Rcp_CancelSession</span>(session);</li><li>    <span class="hljs-comment">// 清理request</span></li><li>    <span class="hljs-built_in">HMS_Rcp_DestroyRequest</span>(request);</li><li>    <span class="hljs-comment">// 关闭session</span></li><li>    errCode = <span class="hljs-built_in">HMS_Rcp_CloseSession</span>(&amp;session);</li><li>    <span class="hljs-comment">// 处理errCode</span></li><li>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;</li><li>}</li></ol></pre></div></div>       <p></p></li>     </ol>    </div>    <div class="tiledSection">     <h2 id="section25363497327">如何使用delete发送网络请求<i class="anchor-icon anchor-icon-link" anchorid="section25363497327" tips="复制节点链接"></i></h2>          <p>发送一个带有默认HTTP参数的HTTP DELETE请求，并返回来自服务器的HTTP响应，用于从服务器删除资源，通过向指定URL发送DELETE请求，可以删除该URL上对应的资源。使用异步回调。</p>    </div>    <div class="tiledSection">     <h3 id="section76712803313" class="firsth2">使用示例<i class="anchor-icon anchor-icon-link" anchorid="section76712803313" tips="复制节点链接"></i></h3>          <ol>      <li><span>CPP侧导入模块。</span>       <p></p>       <div _ngcontent-nks-c106="" class="highlight-div"><div _ngcontent-nks-c106="" class="highlight-div-header"><div _ngcontent-nks-c106="" class="highlight-div-header-left"><div _ngcontent-nks-c106="" class="handle-button expand-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-nks-c106="" class="highlight-div-header-right"><div _ngcontent-nks-c106="" class="handle-button ai-button"></div><div _ngcontent-nks-c106="" class="handle-button line-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-nks-c106="" class="handle-button theme-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-nks-c106="" class="handle-button copy-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-nks-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"RemoteCommunicationKit/rcp.h"</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstring&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;unistd.h&gt;</span></span></li></ol></pre></div></div>       <p></p></li>      <li><span>CMakeLists.txt中添加以下lib。（具体请见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/remote-communication-preparations#section2095732915253">C API开发准备</a>）。</span>       <p></p>       <div _ngcontent-nks-c106="" class="highlight-div"><div _ngcontent-nks-c106="" class="highlight-div-header"><div _ngcontent-nks-c106="" class="highlight-div-header-left"><div _ngcontent-nks-c106="" class="handle-button expand-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-nks-c106="" class="highlight-div-header-right"><div _ngcontent-nks-c106="" class="handle-button ai-button"></div><div _ngcontent-nks-c106="" class="handle-button line-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-nks-c106="" class="handle-button theme-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-nks-c106="" class="handle-button copy-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-nks-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-undefined" data-highlighted="yes"><ol class="linenums"><li>librcp_c.so</li></ol></pre></div></div>       <p></p></li>      <li><span>创建会话，会话发起delete请求。“http://www.example.com”请根据实际情况替换为想要请求的URL地址。等待响应返回后，销毁request并关闭session。</span>       <p></p>       <div _ngcontent-nks-c106="" class="highlight-div"><div _ngcontent-nks-c106="" class="highlight-div-header"><div _ngcontent-nks-c106="" class="highlight-div-header-left"><div _ngcontent-nks-c106="" class="handle-button expand-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-nks-c106="" class="highlight-div-header-right"><div _ngcontent-nks-c106="" class="handle-button ai-button"></div><div _ngcontent-nks-c106="" class="handle-button line-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-nks-c106="" class="handle-button theme-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-nks-c106="" class="handle-button copy-button"><div _ngcontent-nks-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-nks-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">ResponseCallback</span><span class="hljs-params">(<span class="hljs-type">void</span> *usrCtx, Rcp_Response *response, <span class="hljs-type">uint32_t</span> errCode)</span></span></li><li><span class="hljs-function"></span>{</li><li>    (<span class="hljs-type">void</span> *)usrCtx;</li><li>    <span class="hljs-keyword">if</span> (response != <span class="hljs-literal">NULL</span>) {</li><li>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Response status: %d\n"</span>, response-&gt;statusCode);</li><li>    } <span class="hljs-keyword">else</span> {</li><li>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Fetch failed: errCode: %u\n"</span>, errCode);</li><li>    }</li><li>    <span class="hljs-keyword">if</span> (response != <span class="hljs-literal">NULL</span>) {</li><li>        response-&gt;<span class="hljs-built_in">destroyResponse</span>(response);</li><li>    }</li><li>}</li><li>
</li><li><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>{</li><li>    <span class="hljs-type">const</span> <span class="hljs-type">char</span> *kHttpServerAddress = <span class="hljs-string">"http://www.example.com/delete"</span>;</li><li>    Rcp_Request *request = <span class="hljs-built_in">HMS_Rcp_CreateRequest</span>(kHttpServerAddress);</li><li>    request-&gt;method = RCP_METHOD_DELETE;</li><li>    <span class="hljs-comment">// 请求配置</span></li><li>    Rcp_Configuration config;</li><li>    <span class="hljs-comment">// 初始化配置参数</span></li><li>    (<span class="hljs-type">void</span>)<span class="hljs-built_in">memset</span>(&amp;config, <span class="hljs-number">0</span>, <span class="hljs-built_in">sizeof</span>(Rcp_Configuration));</li><li>    <span class="hljs-comment">// 重新设置自动重定向</span></li><li>    config.transferConfiguration.autoRedirect = <span class="hljs-literal">true</span>;</li><li>    <span class="hljs-comment">// 重新设置请求超时配置参数</span></li><li>    config.transferConfiguration.timeout.transferMs = <span class="hljs-number">1000</span> * <span class="hljs-number">10</span>;</li><li>    config.transferConfiguration.timeout.connectMs = <span class="hljs-number">1000</span> * <span class="hljs-number">10</span>;</li><li>    request-&gt;configuration = &amp;config;</li><li>    <span class="hljs-type">uint32_t</span> errCode = <span class="hljs-number">0</span>;</li><li>    <span class="hljs-comment">// 创建session</span></li><li>    Rcp_Session *session = <span class="hljs-built_in">HMS_Rcp_CreateSession</span>(<span class="hljs-literal">NULL</span>, &amp;errCode);</li><li>    <span class="hljs-comment">// 配置请求回调</span></li><li>    Rcp_ResponseCallbackObject responseCallback = {ResponseCallback, <span class="hljs-literal">NULL</span>};</li><li>    <span class="hljs-comment">// 发起fetch请求</span></li><li>    errCode = <span class="hljs-built_in">HMS_Rcp_Fetch</span>(session, request, &amp;responseCallback);</li><li>    <span class="hljs-comment">// 等待fetch结果，仅是等待异步调用完成，开发者可根据自己实际场景处理回调。</span></li><li>    <span class="hljs-built_in">usleep</span>(<span class="hljs-number">1000</span> * <span class="hljs-number">1000</span> * <span class="hljs-number">3</span>);</li><li>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"Fetch completed, errCode: %u\n"</span>, errCode);</li><li>    <span class="hljs-comment">// 在退出前取消可能还在执行的requests </span></li><li>    errCode = <span class="hljs-built_in">HMS_Rcp_CancelSession</span>(session);</li><li>    <span class="hljs-comment">// 清理request</span></li><li>    <span class="hljs-built_in">HMS_Rcp_DestroyRequest</span>(request);</li><li>    <span class="hljs-comment">// 关闭session</span></li><li>    errCode = <span class="hljs-built_in">HMS_Rcp_CloseSession</span>(&amp;session);</li><li>    <span class="hljs-comment">// 处理errCode</span></li><li>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;</li><li>}</li></ol></pre></div></div>       <p></p></li>     </ol>    </div>   </div>   <div></div></div>