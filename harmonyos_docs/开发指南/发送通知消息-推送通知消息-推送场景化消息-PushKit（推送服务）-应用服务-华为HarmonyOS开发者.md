<h1 _ngcontent-jml-c119="" class="doc-title ng-star-inserted" title="发送通知消息"> 发送通知消息 </h1>

<div _ngcontent-jml-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <div class="tiledSection">     <h2 id="section2815134374220">场景介绍<i class="anchor-icon anchor-icon-link" anchorid="section2815134374220" tips="复制节点链接"></i></h2>          <p>通知消息通过Push Kit通道直接下发，可在终端设备的通知中心、锁屏、横幅等展示，用户点击后拉起应用。您可以通过<a href="/consumer/cn/doc/harmonyos-guides/push-send-alert#section5164103925811">设置通知消息样式</a>来吸引用户。</p>    </div>    <div class="tiledSection">     <h2 id="section842412232016">约束与限制<i class="anchor-icon anchor-icon-link" anchorid="section842412232016" tips="复制节点链接"></i></h2>          <p>发送通知消息能力支持Phone、Tablet、PC/2in1设备。并且从5.1.0(18)版本开始新增支持Wearable设备；从5.1.1(19)版本开始，新增支持TV设备。</p>    </div>    <div class="tiledSection">     <h2 id="section15809122792917">开通权益<i class="anchor-icon anchor-icon-link" anchorid="section15809122792917" tips="复制节点链接"></i></h2>          <p>Push Kit根据消息内容，将通知消息分类为<strong>服务与通讯</strong>、<strong>资讯营销</strong>两大类别，开放通知消息自分类权益。</p>     <p>两种类型的通知消息在<strong>提醒方式、消息展示位置、推送数量</strong>上皆存在差异。更多说明与权益申请详情参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/push-apply-right#section16708911111611">申请通知消息自分类权益</a>。</p>     <div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content">       <ul>        <li><strong>若您未申请通知消息自分类权益，则推送的通知消息默认为资讯营销类（<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/push-scenariozed-api-request-param#section17371529101117" target="_blank">category</a>取值为MARKETING）消息</strong>；若您仅需发送资讯营销类消息，则无需申请通知消息自分类权益。</li>        <li>资讯营销类消息每天可发送消息数量根据应用类型分为<strong>2条</strong>或<strong>5条</strong>，详情请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/push-apply-right#section1128516504398">通知消息推送数量管理规则</a>。若您发送通知消息被频控，请尝试发送测试消息或申请自分类权益，详情请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/push-msg-freq-control" target="_blank">消息频控</a>。</li>       </ul>      </div></div></div>    </div>    <div class="tiledSection">     <h2 id="section1927341155110">频控规则<i class="anchor-icon anchor-icon-link" anchorid="section1927341155110" tips="复制节点链接"></i></h2>          <p><strong>调测阶段</strong>，每个项目每日全网最多可推送<span id="ZH-CN_TOPIC_0000002368545948__zh-cn_topic_0000002368705820_text54316313257">1000</span>条测试消息。发送测试消息需设置<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/push-scenariozed-api-request-param#section418321011212" target="_blank">testMessage</a>为true。</p>     <p><strong>正式发布阶段</strong>，单设备单应用下每日推送消息总条数受<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/push-msg-freq-control#section993063213715" target="_blank">设备消息频控</a>限制，系统会根据现网使用场景和流量进行管控，不合理的使用场景系统会进行频控。</p>     <p>服务通讯类消息与资讯营销类消息存在不同的频控策略，详情请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/push-apply-right#section1128516504398">通知消息推送数量管理规则</a>。</p>    </div>    <div class="tiledSection">     <h2 id="section17790171616598">开发步骤<i class="anchor-icon anchor-icon-link" anchorid="section17790171616598" tips="复制节点链接"></i></h2>          <ol>      <li><span>参见指导<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/push-get-token">获取Push Token</a>。</span></li>      <li><span>为确保应用可正常收到消息，应用发送通知前需调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-notificationmanager#notificationmanagerrequestenablenotification10-1" target="_blank">requestEnableNotification</a>()方法弹出提醒，告知用户需要允许接收通知消息。示例代码如下：</span>       <p></p>       <div _ngcontent-jml-c106="" class="highlight-div"><div _ngcontent-jml-c106="" class="highlight-div-header"><div _ngcontent-jml-c106="" class="highlight-div-header-left"><div _ngcontent-jml-c106="" class="handle-button expand-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jml-c106="" class="highlight-div-header-right"><div _ngcontent-jml-c106="" class="handle-button ai-button"></div><div _ngcontent-jml-c106="" class="handle-button line-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jml-c106="" class="handle-button theme-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jml-c106="" class="handle-button copy-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jml-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 文件路径: src/main/ets/entryability/EntryAbility.ets</span></li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-variable language_">window</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li><span class="hljs-keyword">import</span> { notificationManager } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.NotificationKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onWindowStageCreate</span>(<span class="hljs-params">windowStage: <span class="hljs-variable language_">window</span>.WindowStage</span>) {</li><li>    hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">'%{public}s'</span>, <span class="hljs-string">'Ability onWindowStageCreate'</span>);</li><li>    windowStage.<span class="hljs-title function_">loadContent</span>(<span class="hljs-string">'pages/Index'</span>, <span class="hljs-function">(<span class="hljs-params">err, data</span>) =&gt;</span> {</li><li>      <span class="hljs-keyword">if</span> (err.<span class="hljs-property">code</span>) {</li><li>        hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">'Failed to load the content. Cause: %{public}s'</span>, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err) ?? <span class="hljs-string">''</span>);</li><li>        <span class="hljs-keyword">return</span>;</li><li>      }</li><li>      hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">'Succeeded in loading the content. Data: %{public}s'</span>, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data) ?? <span class="hljs-string">''</span>);</li><li>      notificationManager.<span class="hljs-title function_">requestEnableNotification</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>        hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">`[ANS] requestEnableNotification success`</span>);</li><li>      }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>        hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">`[ANS] requestEnableNotification failed, code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>      });</li><li>    });</li><li>  }</li><li>}</li></ol></pre></div></div>       <p></p></li>      <li><span>为确保点击消息可以正常跳转应用页面，在应用项目中完成skills标签配置，详情请参见<a href="/consumer/cn/doc/harmonyos-guides/push-send-alert#section697519219136">点击消息动作</a>。</span></li>      <li><span>应用服务端调用Push Kit服务端的REST API推送通知消息。若未<a href="/consumer/cn/doc/harmonyos-guides/push-send-alert#section15809122792917">开通权益</a>，或开通的权益类型与<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/push-scenes-send">调用REST API推送场景化消息</a>时，请求体中携带的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/push-scenariozed-api-request-param#section17371529101117" target="_blank">category</a>字段值不一致，消息将会默认归为<strong>资讯营销类消息</strong>，则会受到“单个应用每日每设备推送数量为2条或5条”的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/push-apply-right#section1128516504398">频控</a>限制。</span>       <p></p>       <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">         <ul>          <li>本示例仅包含REST API中部分消息字段，关于服务端开发的更多详情请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/push-server">端云调试</a>。</li>         </ul>         <ul>          <li>请使用V3版本的请求URL（https://push-api.cloud.huawei.com/v3/[projectId]/messages:send）进行消息推送。           <p>请求URL版本为V3（https://push-api.cloud.huawei.com/v3/[projectId]/messages:send）时，仅支持给HarmonyOS Next/5.x及之后的系统版本推送通知；版本为V2（https://push-api.cloud.huawei.com/v2/[projectId]/messages:send）时，仅支持给HarmonyOS 3.x/4.x的系统版本推送通知。</p></li>         </ul>        </div></div></div>       <div class="p">        请求示例如下（注意category参数设置为实际消息类型）：        <div _ngcontent-jml-c106="" class="highlight-div"><div _ngcontent-jml-c106="" class="highlight-div-header"><div _ngcontent-jml-c106="" class="highlight-div-header-left"><div _ngcontent-jml-c106="" class="handle-button expand-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jml-c106="" class="highlight-div-header-right"><div _ngcontent-jml-c106="" class="handle-button ai-button"></div><div _ngcontent-jml-c106="" class="handle-button line-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jml-c106="" class="handle-button theme-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jml-c106="" class="handle-button copy-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jml-c106="" class="highlight-scroll-div"><pre class="json prettyprint linenums hljs language-json" hw-language="json" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// Request URL</span></li><li>POST <span class="hljs-string">"https://push-api.cloud.huawei.com/v3/</span><strong><span class="hljs-string">[projectId]</span></strong><span class="hljs-string">/messages:send"</span></li><li>
</li><li><span class="hljs-comment">// Request Header</span></li><li>Content-Type<span class="hljs-punctuation">:</span> application/json</li><li>Authorization<span class="hljs-punctuation">:</span> Bearer eyJr*****OiIx---****.eyJh*****iJodHR--***.QRod*****<span class="hljs-number">4</span>Gp---****</li><li>push-type<span class="hljs-punctuation">:</span> <span class="hljs-number">0</span></li><li>
</li><li><span class="hljs-comment">// Request Body</span></li><li><span class="hljs-punctuation">{</span></li><li>  <span class="hljs-attr">"payload"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>    <strong><span class="hljs-attr">"notification"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></strong></li><li>      <span class="hljs-attr">"category"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"xxxxxx"</span><span class="hljs-punctuation">,</span><span class="hljs-comment">// 替换为实际消息类型</span></li><li>      <span class="hljs-attr">"title"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"普通通知标题"</span><span class="hljs-punctuation">,</span></li><li>      <span class="hljs-attr">"body"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"普通通知内容"</span><span class="hljs-punctuation">,</span></li><li>      <span class="hljs-attr">"clickAction"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>        <span class="hljs-attr">"actionType"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span></li><li>      <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span></li><li>      <span class="hljs-comment">// 通知是否在应用在前台情况下展示，仅对push-type为0的通知消息生效</span></li><li>      <span class="hljs-attr">"foregroundShow"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span></li><li>      <span class="hljs-attr">"notifyId"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">12345</span></li><li><strong>    <span class="hljs-punctuation">}</span></strong></li><li>  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span></li><li>  <span class="hljs-attr">"target"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>    <span class="hljs-attr">"token"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"MAMzLg**********lPW"</span><span class="hljs-punctuation">]</span></li><li>  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span></li><li>  <span class="hljs-attr">"pushOptions"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>   <span class="hljs-attr">"testMessage"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span></li><li><strong>    </strong><span class="hljs-attr">"ttl"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">86400</span></li><li>  <span class="hljs-punctuation">}</span></li><li><span class="hljs-punctuation">}</span></li></ol></pre></div></div>        <ul>         <li>[projectId]：项目ID，登录<a href="https://developer.huawei.com/consumer/cn/service/josp/agc/index.html" target="_blank">AppGallery Connect</a>网站，选择“开发与服务”，在项目列表中选择对应的项目，左侧导航栏选择“项目设置”，在该页面获取。</li>         <li>Authorization：JWT格式字符串，可参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/push-scenariozed-api-request-struct#section20573634202313" target="_blank">Authorization</a>获取。</li>         <li>push-type：0表示Alert消息，此处为通知消息场景。</li>         <li>category：表示通知消息自分类的类别，MARKETING为资讯营销类消息，更多类别可参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/push-scenariozed-api-request-param#section17371529101117" target="_blank">category</a>获取。</li>         <li>actionType：0表示<a href="/consumer/cn/doc/harmonyos-guides/push-send-alert#section1792616175914">点击消息进入应用首页</a>，1表示<a href="/consumer/cn/doc/harmonyos-guides/push-send-alert#section8794131614597">点击消息后进入应用内页</a>。</li>         <li>token：Push Token，可参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/push-get-token">获取Push Token</a>获取。</li>         <li>testMessage：（选填）测试消息标识，true表示测试消息。每个项目每天限制发送1000条测试消息，单次推送可发送Token数不超过10个。详情请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/push-scenariozed-api-request-param#section418321011212" target="_blank">testMessage</a>。</li>         <li>ttl：（选填）消息缓存时间，详见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/push-scenariozed-api-request-param#section418321011212" target="_blank">ttl</a>。</li>         <li>notifyId：（选填）自定义消息标识字段。不携带或者设置-1时，推送服务自动为每条消息生成一个唯一标识；不同的通知消息可以拥有相同的notifyId，实现新消息覆盖旧消息功能。仅支持数字，范围 [0, 2147483647]，若要<strong>用于消息撤回则必填</strong>。详情请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/push-scenariozed-api-request-param#section17371529101117" target="_blank">notifyId</a>。</li>         <li>foregroundShow：（选填）通知消息是否在应用在前台时候展示。true表示应用在前后台都展示。false表示应用只在后台展示，应用在前台时，通知栏消息将不会展示。默认为true。foregroundShow为true时，<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/push-pushservice#section125883044911" target="_blank">receiveMessage</a>不会被触发，无法获取消息数据。</li>        </ul>       </div>       <p></p></li>      <li><span>发送消息推送请求，请求响应请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/push-scenariozed-api-response" target="_blank">响应参数</a>。请求发送成功后，可检查设备是否收到通知消息，如果设备未收到通知消息，请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/push-faq-2">常见问题</a>进行排查。</span></li>     </ol>    </div>    <div class="tiledSection">     <h2 id="section697519219136">点击消息动作<i class="anchor-icon anchor-icon-link" anchorid="section697519219136" tips="复制节点链接"></i></h2>         </div>    <div class="tiledSection">     <h3 id="section1792616175914" class="firsth2">点击消息进入应用首页<i class="anchor-icon anchor-icon-link" anchorid="section1792616175914" tips="复制节点链接"></i></h3>          <ol>      <li><span>检查项目模块级别下的<strong>src/main/module.json5</strong>中的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/module-configuration-file#skills标签" target="_blank">skills标签</a>配置，其中用于标识<strong>应用首页</strong>的skill（即配置了"entity.system.home"和"ohos.want.action.home"的skill）中<strong>不要配置uris，否则消息会接收不到</strong>。</span>       <p></p>       <div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content">         <p>module.json5文件中的skills标签下可以同时存在多个skill对象，每个对象对应一种能力。</p>         <p>若您需要同时设置推送消息跳转能力和其他跳转能力（如NFC跳转、浏览器跳转等），需要在skills数组中创建不同的skill对象，分别映射对应的能力。</p>        </div></div></div>       <div class="p">        点击消息进入应用首页skills标签配置示例：        <div _ngcontent-jml-c106="" class="highlight-div"><div _ngcontent-jml-c106="" class="highlight-div-header"><div _ngcontent-jml-c106="" class="highlight-div-header-left"><div _ngcontent-jml-c106="" class="handle-button expand-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jml-c106="" class="highlight-div-header-right"><div _ngcontent-jml-c106="" class="handle-button ai-button"></div><div _ngcontent-jml-c106="" class="handle-button line-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jml-c106="" class="handle-button theme-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jml-c106="" class="handle-button copy-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jml-c106="" class="highlight-scroll-div"><pre class="json prettyprint linenums hljs language-json" hw-language="json" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-punctuation">{</span></li><li>  <span class="hljs-attr">"module"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>    <span class="hljs-comment">// ...</span></li><li>    <span class="hljs-attr">"abilities"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span></li><li>      <span class="hljs-punctuation">{</span></li><li>        <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"TestAbility"</span><span class="hljs-punctuation">,</span></li><li>        <span class="hljs-attr">"srcEntry"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"./ets/abilities/TestAbility.ets"</span><span class="hljs-punctuation">,</span></li><li>        <span class="hljs-attr">"exported"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span></li><li>        <span class="hljs-attr">"startWindowIcon"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"$media:startIcon"</span><span class="hljs-punctuation">,</span></li><li>        <span class="hljs-attr">"startWindowBackground"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"$color:start_window_background"</span><span class="hljs-punctuation">,</span></li><li>        <span class="hljs-attr">"skills"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span></li><li>          <span class="hljs-comment">// 该skill标识应用首页，不要配置uris</span></li><li>          <span class="hljs-punctuation">{</span></li><li>            <span class="hljs-attr">"entities"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span></li><li>              <span class="hljs-string">"entity.system.home"</span></li><li>            <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span></li><li>            <span class="hljs-attr">"actions"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span></li><li>              <span class="hljs-comment">// "action.system.home"为API19以下版本配置，已废弃</span></li><li>              <span class="hljs-string">"ohos.want.action.home"</span></li><li>            <span class="hljs-punctuation">]</span></li><li>          <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span></li><li>          <span class="hljs-comment">// 其他skill配置</span></li><li>          <span class="hljs-punctuation">{</span><span class="hljs-punctuation">}</span></li><li>        <span class="hljs-punctuation">]</span></li><li>      <span class="hljs-punctuation">}</span></li><li>    <span class="hljs-punctuation">]</span></li><li>  <span class="hljs-punctuation">}</span></li><li><span class="hljs-punctuation">}</span></li></ol></pre></div></div>       </div>       <p></p></li>      <li><span>发送消息时设置<strong>actionType</strong>字段为0。</span>       <p></p>       <div _ngcontent-jml-c106="" class="highlight-div"><div _ngcontent-jml-c106="" class="highlight-div-header"><div _ngcontent-jml-c106="" class="highlight-div-header-left"><div _ngcontent-jml-c106="" class="handle-button expand-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jml-c106="" class="highlight-div-header-right"><div _ngcontent-jml-c106="" class="handle-button ai-button"></div><div _ngcontent-jml-c106="" class="handle-button line-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jml-c106="" class="handle-button theme-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jml-c106="" class="handle-button copy-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jml-c106="" class="highlight-scroll-div"><pre class="json prettyprint linenums hljs language-json" hw-language="json" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// Request URL</span></li><li>POST <span class="hljs-string">"https://push-api.cloud.huawei.com/v3/</span><strong><span class="hljs-string">[projectId]</span></strong><span class="hljs-string">/messages:send"</span></li><li>
</li><li><span class="hljs-comment">// Request Header</span></li><li>Content-Type<span class="hljs-punctuation">:</span> application/json</li><li>Authorization<span class="hljs-punctuation">:</span> Bearer eyJr*****OiIx---****.eyJh*****iJodHR--***.QRod*****<span class="hljs-number">4</span>Gp---****</li><li><strong>push-type<span class="hljs-punctuation">:</span> <span class="hljs-number">0</span></strong></li><li>
</li><li><span class="hljs-comment">// Request Body</span></li><li><span class="hljs-punctuation">{</span></li><li>  <span class="hljs-attr">"payload"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>    <strong><span class="hljs-attr">"notification"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></strong></li><li>      <span class="hljs-attr">"category"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"MARKETING"</span><span class="hljs-punctuation">,</span></li><li>      <span class="hljs-attr">"title"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"普通通知标题"</span><span class="hljs-punctuation">,</span></li><li>      <span class="hljs-attr">"body"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"普通通知内容"</span><span class="hljs-punctuation">,</span></li><li>      <strong><span class="hljs-attr">"clickAction"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></strong></li><li><strong>        <span class="hljs-attr">"actionType"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span></strong></li><li><strong>        <span class="hljs-attr">"data"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span><span class="hljs-attr">"testKey"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"testValue"</span><span class="hljs-punctuation">}</span></strong></li><li><strong>      <span class="hljs-punctuation">}</span></strong></li><li><strong>    <span class="hljs-punctuation">}</span></strong></li><li>  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span></li><li>  <span class="hljs-attr">"target"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>    <span class="hljs-attr">"token"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"MAMzLg**********lPW"</span><span class="hljs-punctuation">]</span></li><li>  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span></li><li>  <span class="hljs-attr">"pushOptions"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>    <span class="hljs-attr">"testMessage"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span></li><li>  <span class="hljs-punctuation">}</span></li><li><span class="hljs-punctuation">}</span></li></ol></pre></div></div>       <ul>        <li>actionType：点击消息的动作，0表示点击消息后进入首页（即入口Ability当前所在页面，入口Ability通常为EntryAbility）。         <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">           <p>场景化消息<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/push-scenariozed-api-request-struct" target="_blank">请求体</a>中，接口URL版本为V3（https://push-api.cloud.huawei.com/v3/[projectId]/messages:send）时，仅支持给HarmonyOS Next/5.x及之后的系统版本推送通知；接口URL版本为V2（https://push-api.cloud.huawei.com/v2/[projectId]/messages:send）时，仅支持给HarmonyOS 3.x/4.x的系统版本推送通知。</p>          </div></div></div></li>       </ul>       <p></p></li>     </ol>    </div>    <div class="tiledSection">     <h3 id="section8794131614597">点击消息进入应用内页<i class="anchor-icon anchor-icon-link" anchorid="section8794131614597" tips="复制节点链接"></i></h3>          <ol>      <li><span>在您的项目模块级别下的<strong>src/main/module.json5</strong> 中设置目标Ability中<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/module-configuration-file#skills标签" target="_blank">skills标签</a>的actions或uris值，两种方式如下：</span>       <p></p>       <p>方式一：在<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/module-configuration-file#skills标签" target="_blank">skills标签</a>中新增一个<strong>独立的skill</strong><strong>对象</strong>，配置<strong>actions参数</strong>用于点击消息进入应用内页，示例如下：</p>       <div _ngcontent-jml-c106="" class="highlight-div"><div _ngcontent-jml-c106="" class="highlight-div-header"><div _ngcontent-jml-c106="" class="highlight-div-header-left"><div _ngcontent-jml-c106="" class="handle-button expand-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jml-c106="" class="highlight-div-header-right"><div _ngcontent-jml-c106="" class="handle-button ai-button"></div><div _ngcontent-jml-c106="" class="handle-button line-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jml-c106="" class="handle-button theme-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jml-c106="" class="handle-button copy-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jml-c106="" class="highlight-scroll-div"><pre class="json prettyprint linenums hljs language-json" hw-language="json" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-punctuation">{</span></li><li>  <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"TestAbility"</span><span class="hljs-punctuation">,</span></li><li>  <span class="hljs-attr">"srcEntry"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"./ets/abilities/TestAbility.ets"</span><span class="hljs-punctuation">,</span></li><li>  <span class="hljs-attr">"exported"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span></li><li>  <span class="hljs-attr">"startWindowIcon"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"$media:startIcon"</span><span class="hljs-punctuation">,</span></li><li>  <span class="hljs-attr">"startWindowBackground"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"$color:start_window_background"</span><span class="hljs-punctuation">,</span></li><li>  <span class="hljs-attr">"skills"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span></li><li>    <span class="hljs-comment">// 保持现有skill对象不变</span></li><li>    <span class="hljs-punctuation">{</span></li><li>      <span class="hljs-attr">"actions"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span></li><li>        <span class="hljs-string">"com.app.action"</span></li><li>      <span class="hljs-punctuation">]</span></li><li>    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span></li><li>    <span class="hljs-comment">// 新增一个独立的skill对象，配置actions参数</span></li><li>    <span class="hljs-punctuation">{</span></li><li>      <span class="hljs-attr">"actions"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span></li><li>        <span class="hljs-string">"com.test.action"</span></li><li>      <span class="hljs-punctuation">]</span></li><li>    <span class="hljs-punctuation">}</span></li><li>  <span class="hljs-punctuation">]</span></li><li><span class="hljs-punctuation">}</span></li></ol></pre></div></div>       <p>方式二：在<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/module-configuration-file#skills标签" target="_blank">skills标签</a>中新增一个<strong>独立的skill</strong><strong>对象</strong>，配置<strong>uris参数</strong>用于点击消息进入应用内页（<strong>必须同时配置actions参数和uris参数，actions参数为空</strong>），示例如下：</p>       <div _ngcontent-jml-c106="" class="highlight-div"><div _ngcontent-jml-c106="" class="highlight-div-header"><div _ngcontent-jml-c106="" class="highlight-div-header-left"><div _ngcontent-jml-c106="" class="handle-button expand-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jml-c106="" class="highlight-div-header-right"><div _ngcontent-jml-c106="" class="handle-button ai-button"></div><div _ngcontent-jml-c106="" class="handle-button line-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jml-c106="" class="handle-button theme-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jml-c106="" class="handle-button copy-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jml-c106="" class="highlight-scroll-div"><pre class="json prettyprint linenums hljs language-json" hw-language="json" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-punctuation">{</span></li><li>  <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"TestAbility"</span><span class="hljs-punctuation">,</span></li><li>  <span class="hljs-attr">"srcEntry"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"./ets/abilities/TestAbility.ets"</span><span class="hljs-punctuation">,</span></li><li>  <span class="hljs-attr">"exported"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span></li><li>  <span class="hljs-attr">"startWindowIcon"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"$media:startIcon"</span><span class="hljs-punctuation">,</span></li><li>  <span class="hljs-attr">"startWindowBackground"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"$color:start_window_background"</span><span class="hljs-punctuation">,</span></li><li>  <span class="hljs-attr">"skills"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span></li><li>    <span class="hljs-comment">// 保持现有skill对象不变</span></li><li>    <span class="hljs-punctuation">{</span></li><li>      <span class="hljs-attr">"actions"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span></li><li>        <span class="hljs-string">"com.app.action"</span></li><li>      <span class="hljs-punctuation">]</span></li><li>    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span></li><li>    <span class="hljs-comment">// 新增一个独立的skill对象，配置uris参数，且必须同时配置actions参数，actions参数为空字符串</span></li><li>    <span class="hljs-punctuation">{</span></li><li>      <span class="hljs-attr">"actions"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">""</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span></li><li>      <span class="hljs-attr">"uris"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span></li><li>        <span class="hljs-punctuation">{</span></li><li>          <span class="hljs-attr">"scheme"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"https"</span><span class="hljs-punctuation">,</span></li><li>          <span class="hljs-attr">"host"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"www.xxx.com"</span><span class="hljs-punctuation">,</span></li><li>          <span class="hljs-attr">"port"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"8080"</span><span class="hljs-punctuation">,</span></li><li>          <span class="hljs-attr">"path"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"push/test"</span></li><li>        <span class="hljs-punctuation">}</span></li><li>      <span class="hljs-punctuation">]</span></li><li>    <span class="hljs-punctuation">}</span></li><li>  <span class="hljs-punctuation">]</span></li><li><span class="hljs-punctuation">}</span></li></ol></pre></div></div>       <div class="p">        <div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content">          <p>module.json5文件中的skills标签下可以同时存在多个skill对象，每个对象对应一种能力。</p>          <p>若您需要同时设置推送消息跳转能力和其他跳转能力（如NFC跳转、浏览器跳转等），需要在skills数组中创建不同的skill对象，分别映射对应的能力。</p>         </div></div></div>       </div>       <p></p></li>      <li><span>发送消息时<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/push-scenariozed-api-request-param#section152462191216" target="_blank">clickAction</a>中设置<strong>actionType</strong>字段为1。</span>       <p></p>       <div _ngcontent-jml-c106="" class="highlight-div"><div _ngcontent-jml-c106="" class="highlight-div-header"><div _ngcontent-jml-c106="" class="highlight-div-header-left"><div _ngcontent-jml-c106="" class="handle-button expand-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jml-c106="" class="highlight-div-header-right"><div _ngcontent-jml-c106="" class="handle-button ai-button"></div><div _ngcontent-jml-c106="" class="handle-button line-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jml-c106="" class="handle-button theme-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jml-c106="" class="handle-button copy-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jml-c106="" class="highlight-scroll-div"><pre class="json prettyprint linenums hljs language-json" hw-language="json" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// Request URL</span></li><li>POST <span class="hljs-string">"https://push-api.cloud.huawei.com/v3/</span><strong><span class="hljs-string">[projectId]</span></strong><span class="hljs-string">/messages:send"</span></li><li>
</li><li><span class="hljs-comment">// Request Header</span></li><li>Content-Type<span class="hljs-punctuation">:</span> application/json</li><li>Authorization<span class="hljs-punctuation">:</span> Bearer eyJr*****OiIx---****.eyJh*****iJodHR--***.QRod*****<span class="hljs-number">4</span>Gp---****</li><li><strong>push-type<span class="hljs-punctuation">:</span> <span class="hljs-number">0</span></strong></li><li>
</li><li><span class="hljs-comment">// Request Body</span></li><li><span class="hljs-punctuation">{</span></li><li>  <span class="hljs-attr">"payload"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>    <strong><span class="hljs-attr">"notification"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></strong></li><li>      <span class="hljs-attr">"category"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"MARKETING"</span><span class="hljs-punctuation">,</span></li><li>      <span class="hljs-attr">"title"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"普通通知标题"</span><span class="hljs-punctuation">,</span></li><li>      <span class="hljs-attr">"body"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"普通通知内容"</span><span class="hljs-punctuation">,</span></li><li>      <strong><span class="hljs-attr">"clickAction"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></strong></li><li><strong>        <span class="hljs-attr">"actionType"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span></strong></li><li>        <strong><span class="hljs-attr">"action"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"com.test.action"</span><span class="hljs-punctuation">,</span></strong></li><li><strong>        <span class="hljs-attr">"uri"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"https://www.xxx.com:8080/push/test"</span><span class="hljs-punctuation">,</span></strong></li><li><strong>        <span class="hljs-attr">"data"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span><span class="hljs-attr">"testKey"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"testValue"</span><span class="hljs-punctuation">}</span></strong></li><li><strong>      <span class="hljs-punctuation">}</span></strong></li><li><strong>    <span class="hljs-punctuation">}</span></strong></li><li>  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span></li><li>  <span class="hljs-attr">"target"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>    <span class="hljs-attr">"token"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"MAMzLg**********lPW"</span><span class="hljs-punctuation">]</span></li><li>  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span></li><li>  <span class="hljs-attr">"pushOptions"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>    <span class="hljs-attr">"testMessage"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span></li><li>  <span class="hljs-punctuation">}</span></li><li><span class="hljs-punctuation">}</span></li></ol></pre></div></div>       <ul>        <li>actionType：点击消息动作，1表示点击消息后进入应用内页。当本字段设置为1时，uri和action至少填写一个，若都填写优先寻找与action匹配的应用页面。若action和uri都未匹配到应用页面，则点击消息后会进入应用首页。</li>        <li>action：表示能够接收<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-ability-want" target="_blank">Want</a>的action值的集合，取值可以自定义。</li>        <li>uri：表示与<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-ability-want" target="_blank">Want</a>中uris相匹配的集合，uris规则请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/module-configuration-file#skills标签" target="_blank">skills标签</a>。</li>       </ul>       <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">         <ul>          <li>场景化消息<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/push-scenariozed-api-request-struct" target="_blank">请求体</a>中，接口URL版本为V3（https://push-api.cloud.huawei.com/v3/[projectId]/messages:send）时，仅支持给HarmonyOS Next/5.x及之后的系统版本推送通知；接口URL版本为V2（https://push-api.cloud.huawei.com/v2/[projectId]/messages:send）时，仅支持给HarmonyOS 3.x/4.x的系统版本推送通知。</li>         </ul>         <ul>          <li>若action和uri都未匹配成功，则点击消息后会进入应用首页。</li>         </ul>        </div></div></div>       <p></p></li>     </ol>    </div>    <div class="tiledSection">     <h3 id="section108252081117">数据传递<i class="anchor-icon anchor-icon-link" anchorid="section108252081117" tips="复制节点链接"></i></h3>          <p>应用服务端调用Push Kit服务端的REST API推送通知消息时，可携带<strong>data</strong>字段，当用户点击消息时将传递数据至客户端应用。</p>     <ol>      <li><span>调用REST API推送通知消息，消息体中<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/push-scenariozed-api-request-param#section152462191216" target="_blank">clickAction</a>携带<strong>data</strong>字段。</span>       <p></p>       <div _ngcontent-jml-c106="" class="highlight-div"><div _ngcontent-jml-c106="" class="highlight-div-header"><div _ngcontent-jml-c106="" class="highlight-div-header-left"><div _ngcontent-jml-c106="" class="handle-button expand-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jml-c106="" class="highlight-div-header-right"><div _ngcontent-jml-c106="" class="handle-button ai-button"></div><div _ngcontent-jml-c106="" class="handle-button line-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jml-c106="" class="handle-button theme-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jml-c106="" class="handle-button copy-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jml-c106="" class="highlight-scroll-div"><pre class="json prettyprint linenums hljs language-json" hw-language="json" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-punctuation">{</span></li><li>  <span class="hljs-attr">"payload"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>    <strong><span class="hljs-attr">"notification"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></strong></li><li>      <span class="hljs-attr">"category"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"MARKETING"</span><span class="hljs-punctuation">,</span></li><li>      <span class="hljs-attr">"title"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"普通通知标题"</span><span class="hljs-punctuation">,</span></li><li>      <span class="hljs-attr">"body"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"普通通知内容"</span><span class="hljs-punctuation">,</span></li><li>      <strong><span class="hljs-attr">"clickAction"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></strong></li><li><strong>        <span class="hljs-attr">"actionType"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span></strong></li><li><strong>        <span class="hljs-attr">"data"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span><span class="hljs-attr">"testKey"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"testValue"</span><span class="hljs-punctuation">}</span></strong> <span class="hljs-comment">// 携带</span><strong><span class="hljs-comment">data</span></strong><span class="hljs-comment">字段</span></li><li><strong>      <span class="hljs-punctuation">}</span></strong></li><li><strong>    <span class="hljs-punctuation">}</span></strong></li><li>  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span></li><li>  <span class="hljs-attr">"target"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>    <span class="hljs-attr">"token"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"MAMzLg**********lPW"</span><span class="hljs-punctuation">]</span></li><li>  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span></li><li>  <span class="hljs-attr">"pushOptions"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>    <span class="hljs-attr">"testMessage"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span></li><li>  <span class="hljs-punctuation">}</span></li><li><span class="hljs-punctuation">}</span></li></ol></pre></div></div>       <ul>        <li>data：点击消息时携带的JSON格式的数据。</li>       </ul>       <p></p></li>      <li><span>在待跳转页面（以TestAbility为例）中的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability#oncreate" target="_blank">onCreate</a>()方法中覆写如下代码（<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/uiability-intra-device-interaction#目标uiability冷启动" target="_blank">冷启动</a>时进入该生命周期回调）：</span>       <p></p>       <div _ngcontent-jml-c106="" class="highlight-div"><div _ngcontent-jml-c106="" class="highlight-div-header"><div _ngcontent-jml-c106="" class="highlight-div-header-left"><div _ngcontent-jml-c106="" class="handle-button expand-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jml-c106="" class="highlight-div-header-right"><div _ngcontent-jml-c106="" class="handle-button ai-button"></div><div _ngcontent-jml-c106="" class="handle-button line-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jml-c106="" class="handle-button theme-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jml-c106="" class="handle-button copy-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jml-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 文件路径: src/main/ets/abilities/TestAbility.ets</span></li><li><span class=""><span class="hljs-keyword">import</span> </span><span class="">{ <span class="hljs-title class_">UIAbility</span>, <span class="hljs-title class_">Want</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</span></li><li><span class=""><span class="hljs-keyword">import</span> </span><span class="">{ hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</span></li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TestAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onCreate</span>(<span class="hljs-attr">want</span>: <span class="hljs-title class_">Want</span>): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-comment">// 获取消息中传递的data数据</span></li><li>    <span class="hljs-keyword">const</span> data = <span class="">want</span><span class="">.</span><span class=""><span class="hljs-property">parameters</span></span>;</li><li>    <span class="hljs-keyword">const</span> value = want.<span class="hljs-property">parameters</span>?.[<span class="hljs-string">"testKey"</span>]; <span class="hljs-comment">// value: "testValue"</span></li><li>    hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">'Succeeded in getting message data, value is %{public}s'</span>, value);</li><li>    <span class="hljs-comment">// 根据实际业务场景对data进行处理</span></li><li>  }</li><li>}</li></ol></pre></div></div>       <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability#onnewwant" target="_blank">onNewWant</a>()方法中覆写如下代码（<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/uiability-intra-device-interaction#目标uiability热启动" target="_blank">热启动</a>时进入该生命周期回调）：</p>       <div _ngcontent-jml-c106="" class="highlight-div"><div _ngcontent-jml-c106="" class="highlight-div-header"><div _ngcontent-jml-c106="" class="highlight-div-header-left"><div _ngcontent-jml-c106="" class="handle-button expand-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jml-c106="" class="highlight-div-header-right"><div _ngcontent-jml-c106="" class="handle-button ai-button"></div><div _ngcontent-jml-c106="" class="handle-button line-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jml-c106="" class="handle-button theme-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jml-c106="" class="handle-button copy-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jml-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 文件路径: src/main/ets/abilities/TestAbility.ets</span></li><li><span class=""><span class="hljs-keyword">import</span> </span><span class="">{ <span class="hljs-title class_">UIAbility</span>, <span class="hljs-title class_">Want</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</span></li><li><span class=""><span class="hljs-keyword">import</span> </span><span class="">{ hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</span></li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TestAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onNewWant</span>(<span class="hljs-attr">want</span>: <span class="hljs-title class_">Want</span>): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-comment">// 获取消息中传递的data数据</span></li><li>    <span class="hljs-keyword">const</span> data = want.<span class="hljs-property">parameters</span>;</li><li>    <span class="hljs-keyword">const</span> value = want.<span class="hljs-property">parameters</span>?.[<span class="hljs-string">"testKey"</span>]; <span class="hljs-comment">// value: "testValue"</span></li><li>    hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">'Succeeded in getting message data, value is %{public}s'</span>, value);</li><li>    <span class="hljs-comment">// 根据实际业务场景对data进行处理</span></li><li>  }</li><li>}</li></ol></pre></div></div>       <div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content">         <p>onNewWant()方法仅在单例（singleton）模式下可用。</p>        </div></div></div>       <p></p></li>     </ol>    </div>    <div class="tiledSection">     <h2 id="section5164103925811">设置通知消息样式<i class="anchor-icon anchor-icon-link" anchorid="section5164103925811" tips="复制节点链接"></i></h2>          <p>Push Kit提供了多种通知消息样式，您可以自定义其中内容来吸引用户，从而提高应用的日活跃用户数量。</p>    </div>    <div class="tiledSection">     <h3 id="section1263543065915" class="firsth2">普通通知<i class="anchor-icon anchor-icon-link" anchorid="section1263543065915" tips="复制节点链接"></i></h3>          <p>您在发送通知消息时<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/push-scenariozed-api-request-param#section17371529101117" target="_blank">notification</a>参数中必须携带<strong>title</strong>与<strong>body</strong>字段，来设置应用收到通知消息后展示在通知中心的标题与内容。文本内容最多显示3行，超出3行以“...”截断。</p>     <p><span><img originheight="146" originwidth="420" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114649.06495007761711575316580576388302:50001231000000:2800:06046EB8F1B7B6DB9DB6660547F9AAF3536B4D549F9EB0AC0E38C074E1DCCDC4.png" width="420" height="146"></span></p>     <p></p>     <p>消息体示例：</p>     <div _ngcontent-jml-c106="" class="highlight-div"><div _ngcontent-jml-c106="" class="highlight-div-header"><div _ngcontent-jml-c106="" class="highlight-div-header-left"><div _ngcontent-jml-c106="" class="handle-button expand-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jml-c106="" class="highlight-div-header-right"><div _ngcontent-jml-c106="" class="handle-button ai-button"></div><div _ngcontent-jml-c106="" class="handle-button line-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jml-c106="" class="handle-button theme-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jml-c106="" class="handle-button copy-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jml-c106="" class="highlight-scroll-div"><pre class="json prettyprint linenums hljs language-json" hw-language="json" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-punctuation">{</span></li><li>  <span class="hljs-attr">"payload"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>    <span class="hljs-attr">"notification"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>      <span class="hljs-attr">"category"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"MARKETING"</span><span class="hljs-punctuation">,</span></li><li>      <strong><span class="hljs-attr">"title"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"推送服务"</span><span class="hljs-punctuation">,</span></strong></li><li><strong>      <span class="hljs-attr">"body"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"推送服务（Push Kit）是华为提供的消息推送平台，建立了从云端到终端的消息推送通道。您通过集成推送服务，可以向客户端应用实时推送消息，构筑良好的用户关系，提升用户的感知度和活跃度。"</span><span class="hljs-punctuation">,</span></strong></li><li>      <span class="hljs-attr">"clickAction"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>        <span class="hljs-attr">"actionType"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span></li><li>      <span class="hljs-punctuation">}</span></li><li>    <span class="hljs-punctuation">}</span></li><li>  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span></li><li>  <span class="hljs-attr">"target"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>    <span class="hljs-attr">"token"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"MAMzLg**********lPW"</span><span class="hljs-punctuation">]</span></li><li>  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span></li><li>  <span class="hljs-attr">"pushOptions"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>    <span class="hljs-attr">"testMessage"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span></li><li>  <span class="hljs-punctuation">}</span></li><li><span class="hljs-punctuation">}</span></li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="section077534865917">通知角标<i class="anchor-icon anchor-icon-link" anchorid="section077534865917" tips="复制节点链接"></i></h3>          <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>Wearable、TV不支持此通知样式。</p>      </div></div></div>     <p>您可以发送通知消息时携带<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/push-scenariozed-api-request-param#section266310382145" target="_blank">badge</a>字段来设置应用收到通知消息后以数字的形式展示角标，提醒用户查看消息。</p>     <p><span><img height="261.637334" originheight="290" originwidth="314" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114649.79485013919634942722349923714811:50001231000000:2800:B8F438F68626298842A5CD02118607A8F6BC13CADF39CD0DD6C7246C8E24381C.png" title="点击放大" width="283.29"></span></p>     <p></p>     <p>消息体示例：</p>     <div _ngcontent-jml-c106="" class="highlight-div"><div _ngcontent-jml-c106="" class="highlight-div-header"><div _ngcontent-jml-c106="" class="highlight-div-header-left"><div _ngcontent-jml-c106="" class="handle-button expand-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jml-c106="" class="highlight-div-header-right"><div _ngcontent-jml-c106="" class="handle-button ai-button"></div><div _ngcontent-jml-c106="" class="handle-button line-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jml-c106="" class="handle-button theme-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jml-c106="" class="handle-button copy-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jml-c106="" class="highlight-scroll-div"><pre class="json prettyprint linenums hljs language-json" hw-language="json" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-punctuation">{</span></li><li>  <span class="hljs-attr">"payload"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>    <span class="hljs-attr">"notification"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>      <span class="hljs-attr">"category"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"MARKETING"</span><span class="hljs-punctuation">,</span></li><li>      <span class="hljs-attr">"title"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"通知标题"</span><span class="hljs-punctuation">,</span></li><li>      <span class="hljs-attr">"body"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"通知内容"</span><span class="hljs-punctuation">,</span></li><li>      <strong><span class="hljs-attr">"badge"</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">{</span></strong></li><li><strong>        <span class="hljs-attr">"addNum"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span></strong><span class="hljs-punctuation">,</span></li><li>        <strong><span class="hljs-attr">"setNum"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">99</span></strong></li><li><strong>      <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span></strong></li><li>      <span class="hljs-attr">"clickAction"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>        <span class="hljs-attr">"actionType"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span></li><li>      <span class="hljs-punctuation">}</span></li><li>    <span class="hljs-punctuation">}</span></li><li>  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span></li><li>  <span class="hljs-attr">"target"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>    <span class="hljs-attr">"token"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"MAMzLg**********lPW"</span><span class="hljs-punctuation">]</span></li><li>  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span></li><li>  <span class="hljs-attr">"pushOptions"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>    <span class="hljs-attr">"testMessage"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span></li><li>  <span class="hljs-punctuation">}</span></li><li><span class="hljs-punctuation">}</span></li></ol></pre></div></div>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <ul>        <li>addNum设置后为应用角标累加数字，非应用角标实际显示数字。</li>        <li>setNum设置后为应用角标实际显示数字。setNum优先级高于addNum。</li>        <li>打开应用或者点击、清理通知消息并不会清理角标数字，开发者可通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-notificationmanager#notificationmanagersetbadgenumber10" target="_blank">setBadgeNumber</a>()方法清理角标，使用前需先<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-notificationmanager#导入模块" target="_blank">导入模块</a>。</li>        <li>当setBadgeNumber()方法中的badgeNumber设置为0时，可以实现清理效果。</li>       </ul>      </div></div></div>    </div>    <div class="tiledSection">     <h3 id="section62011739001">通知大图标<i class="anchor-icon anchor-icon-link" anchorid="section62011739001" tips="复制节点链接"></i></h3>          <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>Wearable不支持此通知样式。</p>       <p><strong>推送服务禁止推送包含敏感信息的图片。</strong></p>      </div></div></div>     <p>您可以发送通知消息时携带<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/push-scenariozed-api-request-param#section17371529101117" target="_blank">image</a>字段设置消息大图标内容，提醒用户查看消息。</p>     <p><span><img originheight="98" originwidth="417" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114650.47993124630380517974533864113235:50001231000000:2800:848A2F501F2840F2D9CEE2713F31977A6E4A6699993178A23E43CEEE48D3D9C4.png" width="417" height="98"></span></p>     <p></p>     <div class="p">      消息体示例：      <div _ngcontent-jml-c106="" class="highlight-div"><div _ngcontent-jml-c106="" class="highlight-div-header"><div _ngcontent-jml-c106="" class="highlight-div-header-left"><div _ngcontent-jml-c106="" class="handle-button expand-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jml-c106="" class="highlight-div-header-right"><div _ngcontent-jml-c106="" class="handle-button ai-button"></div><div _ngcontent-jml-c106="" class="handle-button line-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jml-c106="" class="handle-button theme-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jml-c106="" class="handle-button copy-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jml-c106="" class="highlight-scroll-div"><pre class="json prettyprint linenums hljs language-json" hw-language="json" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-punctuation">{</span></li><li>  <span class="hljs-attr">"payload"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>    <span class="hljs-attr">"notification"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>      <span class="hljs-attr">"category"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"MARKETING"</span><span class="hljs-punctuation">,</span></li><li>      <span class="hljs-attr">"title"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"推送服务"</span><span class="hljs-punctuation">,</span></li><li>      <span class="hljs-attr">"body"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"推送服务是华为提供的消息推送平台"</span><span class="hljs-punctuation">,</span></li><li><strong>      <span class="hljs-attr">"image"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"https://***.png"</span></strong><span class="hljs-punctuation">,</span> <span class="hljs-comment">// 支持的图片格式为PNG、JPG、JPEG、BMP，图片长*宽建议小于128*128像素，若超过49152像素，则图片不展示。</span></li><li>      <span class="hljs-attr">"clickAction"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>        <span class="hljs-attr">"actionType"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span></li><li>      <span class="hljs-punctuation">}</span></li><li>    <span class="hljs-punctuation">}</span></li><li>  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span></li><li>  <span class="hljs-attr">"target"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>    <span class="hljs-attr">"token"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"MAMzLg**********lPW"</span><span class="hljs-punctuation">]</span></li><li>  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span></li><li>  <span class="hljs-attr">"pushOptions"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>    <span class="hljs-attr">"testMessage"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span></li><li>  <span class="hljs-punctuation">}</span></li><li><span class="hljs-punctuation">}</span></li></ol></pre></div></div>     </div>    </div>    <div class="tiledSection">     <h3 id="section77234163220">多行文本样式<i class="anchor-icon anchor-icon-link" anchorid="section77234163220" tips="复制节点链接"></i></h3>          <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>Wearable不支持此通知样式。</p>      </div></div></div>     <p>您可以发送通知消息时在<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/push-scenariozed-api-request-param#section17371529101117" target="_blank">notification</a>中携带<strong>inboxContent</strong>和<strong>style</strong>字段设置通知消息为多行文本样式。最多可展示3行内容，每行内容无法完全展示时以“...”截断。</p>     <p></p>     <p><span><img originheight="148" originwidth="422" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114650.37147593366947783621642086166363:50001231000000:2800:86E0A27D1CEF61D65B9DE69C67A14C6F9C7F811E0448CF87AC8E4EE569BE72B7.png" width="422" height="148"></span></p>     <p></p>     <p>消息体示例：</p>     <div _ngcontent-jml-c106="" class="highlight-div"><div _ngcontent-jml-c106="" class="highlight-div-header"><div _ngcontent-jml-c106="" class="highlight-div-header-left"><div _ngcontent-jml-c106="" class="handle-button expand-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jml-c106="" class="highlight-div-header-right"><div _ngcontent-jml-c106="" class="handle-button ai-button"></div><div _ngcontent-jml-c106="" class="handle-button line-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jml-c106="" class="handle-button theme-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jml-c106="" class="handle-button copy-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jml-c106="" class="highlight-scroll-div"><pre class="json prettyprint linenums hljs language-json" hw-language="json" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-punctuation">{</span></li><li>  <span class="hljs-attr">"payload"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>    <span class="hljs-attr">"notification"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>      <span class="hljs-attr">"category"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"MARKETING"</span><span class="hljs-punctuation">,</span></li><li>      <span class="hljs-attr">"title"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"推送个性化显示"</span><span class="hljs-punctuation">,</span></li><li>      <span class="hljs-attr">"body"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"通知内容"</span><span class="hljs-punctuation">,</span></li><li><strong>      <span class="hljs-attr">"style"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">3</span><span class="hljs-punctuation">,</span></strong></li><li><strong>      </strong><strong><span class="hljs-attr">"inboxContent"</span></strong><strong><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span></strong></li><li><strong>          <span class="hljs-string">"1. 通知栏消息样式"</span><span class="hljs-punctuation">,</span> </strong></li><li><strong>          <span class="hljs-string">"2. 通知栏消息提醒方式和展示方式"</span><span class="hljs-punctuation">,</span> </strong></li><li><strong>          <span class="hljs-string">"3. 通知栏消息语言本地化"</span></strong></li><li><strong>          <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span></strong></li><li>      <span class="hljs-attr">"clickAction"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>        <span class="hljs-attr">"actionType"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span></li><li>      <span class="hljs-punctuation">}</span></li><li>    <span class="hljs-punctuation">}</span></li><li>  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span></li><li>  <span class="hljs-attr">"target"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>    <span class="hljs-attr">"token"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"MAMzLg**********lPW"</span><span class="hljs-punctuation">]</span></li><li>  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span></li><li>  <span class="hljs-attr">"pushOptions"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>    <span class="hljs-attr">"testMessage"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span></li><li>  <span class="hljs-punctuation">}</span></li><li><span class="hljs-punctuation">}</span></li></ol></pre></div></div>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <ul>        <li>多行文本样式需要设置style字段为3。</li>        <li>当您发送多条通知消息导致用户通知消息折叠时，多行文本样式在展开前显示的标题与内容取自title与body字段。</li>        <li>当用户展开多行文本消息，或仅存在一条多行文本消息时，通知中显示的标题与内容取自title与inboxContent字段。</li>       </ul>      </div></div></div>    </div>    <div class="tiledSection">     <h2 id="section1677618118810">开发通知消息账号校验<i class="anchor-icon anchor-icon-link" anchorid="section1677618118810" tips="复制节点链接"></i></h2>          <p>Push Kit提供了账号校验功能，该功能支持您根据终端设备上不同账户属性来推送消息，将通知发送给对应设备上的对应账号。</p>     <p>举例：华为手机上某个应用存在账号A和账号B，若当前登录的账号A切换至账号B后，发送给账号A的通知消息在到达设备后不会进行展示，以避免账号B看到账号A的消息。</p>     <div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content">       <ul>        <li>当Push Token变更后，账号与应用的绑定关系自动解除。</li>        <li>绑定的应用内账号数量最大为10。</li>       </ul>      </div></div></div>     <p></p>     <p>Push Kit支持华为账号和应用账号两种账号类型：</p>     <ul>      <li><strong>华为账号</strong>       <p>该profileId为应用通过华为账号映射的唯一匿名标识。</p>       <p>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/push-pushservice#section20575105524912" target="_blank">bindAppProfileId</a>()绑定接口时机：</p>       <ul>        <li>在应用内通过华为账号授权登录后。</li>        <li>在应用内从其他账号切换到当前华为账号后。</li>       </ul>       <p>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/push-pushservice#section915174525214" target="_blank">unbindAppProfileId</a>()解绑接口时机：</p>       <ul>        <li>在应用内登出华为账号后。</li>       </ul>       <p>举例： 用户选择华为账号作为应用登录账号并登录账号A成功后，调用Push Kit绑定接口<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/push-pushservice#section20575105524912" target="_blank">bindAppProfileId</a>()将账号A的profileId绑定到当前设备的应用token上。应用服务器发送通知消息时若携带该账号A的profileId，则只有当前登录的华为账号为账号A时，才会展示通知消息；若不携带profileId，则无论当前登录的华为账号是否为账号A，都正常展示通知消息。</p></li>      <li><strong>应用账号</strong>       <p>该profileId为应用通过自己的账号映射的唯一匿名标识。</p>       <p>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/push-pushservice#section20575105524912" target="_blank">bindAppProfileId</a>()绑定接口时机：</p>       <ul>        <li>在应用内登录应用账号后。</li>        <li>在应用内从其他应用账号切换到当前应用账号后。</li>       </ul>       <p>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/push-pushservice#section915174525214" target="_blank">unbindAppProfileId</a>()解绑接口时机：</p>       <ul>        <li>在应用内登出应用账号后。</li>       </ul>       <p>举例： 用户成功登录应用的账号A后，调用Push Kit绑定接口<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/push-pushservice#section20575105524912" target="_blank">bindAppProfileId</a>()将账号A的profileId绑定到当前设备的应用token上。应用服务器发送通知消息时若携带账号A的profileId，则只有当前登录的应用账号为账号A时，才会展示通知消息；若不携带profileId，则无论当前登录的应用账号是否为账号A，都正常展示通知消息。</p></li>     </ul>     <div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content">       <p>若在账号登出时未做<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/push-pushservice#section915174525214" target="_blank">unbindAppProfileId</a>()解绑，或者在账号切换时未做<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/push-pushservice#section20575105524912" target="_blank">bindAppProfileId</a>()重新绑定，则会导致应用依然能接收到原账号的通知消息。</p>      </div></div></div>     <p></p>     <ol>      <li><span>参见指导<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/push-get-token">获取Push Token</a>。</span></li>      <li><span>为确保应用可正常收到通知消息，建议应用发送通知前调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-notificationmanager#notificationmanagerrequestenablenotification10-1" target="_blank">requestEnableNotification</a>()方法弹出提醒，告知用户需要允许接收通知消息。详情请参见Notification Kit-<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/notification-enable" target="_blank">请求通知授权</a>。</span></li>      <li><span>为待绑定的账号生成一个非空唯一的profileId（<span style="color: rgb(73,73,73);">不建议使用真实的账号</span><span style="color: rgb(73,73,73);">id</span><span style="color: rgb(73,73,73);">，推荐使用账号</span><span style="color: rgb(73,73,73);">id</span><span style="color: rgb(73,73,73);">自行生成对应的匿名标识，能与该账号id建立唯一映射关系即可，生成算法无限制</span>），调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/push-pushservice#section20575105524912" target="_blank">bindAppProfileId</a>()方法，添加当前设备上该用户与应用的关系，代码示例：</span>       <p></p>       <div _ngcontent-jml-c106="" class="highlight-div"><div _ngcontent-jml-c106="" class="highlight-div-header"><div _ngcontent-jml-c106="" class="highlight-div-header-left"><div _ngcontent-jml-c106="" class="handle-button expand-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jml-c106="" class="highlight-div-header-right"><div _ngcontent-jml-c106="" class="handle-button ai-button"></div><div _ngcontent-jml-c106="" class="handle-button line-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jml-c106="" class="handle-button theme-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jml-c106="" class="handle-button copy-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jml-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li><span class="hljs-keyword">import</span> { pushCommon, pushService } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PushKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li> </li><li><span class="hljs-comment">// 定义需要绑定的profileId，</span><span class=""><span class="hljs-comment">建议使用账号</span></span><span class=""><span class="hljs-comment">id</span></span><span class=""><span class="hljs-comment">对应的</span></span><span class=""><span class="hljs-comment">匿名标识</span></span></li><li><span class="hljs-keyword">const</span> profileId = <span class="hljs-string">'111***222'</span>;</li><li><span class="hljs-comment">// 绑定应用账号</span></li><li>pushService.<span class="hljs-title function_">bindAppProfileId</span>(pushCommon.<span class="hljs-property">AppProfileType</span>.<span class="hljs-property">PROFILE_TYPE_APPLICATION_ACCOUNT</span>, profileId).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">'Succeeded in binding app profile id'</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">'Failed to bind app profile id: %{public}d %{public}s'</span>, err.<span class="hljs-property">code</span>, err.<span class="hljs-property">message</span>);</li><li>});</li></ol></pre></div></div>       <p></p></li>      <li><span>建议您将Push Token和生成的profileId上报到应用服务端，便于应用服务端向终端推送消息。</span></li>      <li><span>应用服务端调用REST API推送通知消息，通知消息示例如下：</span>       <p></p>       <div _ngcontent-jml-c106="" class="highlight-div"><div _ngcontent-jml-c106="" class="highlight-div-header"><div _ngcontent-jml-c106="" class="highlight-div-header-left"><div _ngcontent-jml-c106="" class="handle-button expand-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jml-c106="" class="highlight-div-header-right"><div _ngcontent-jml-c106="" class="handle-button ai-button"></div><div _ngcontent-jml-c106="" class="handle-button line-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jml-c106="" class="handle-button theme-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jml-c106="" class="handle-button copy-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jml-c106="" class="highlight-scroll-div"><pre class="json prettyprint linenums hljs language-json" hw-language="json" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// Request URL</span></li><li>POST <span class="hljs-string">"https://push-api.cloud.huawei.com/v3/</span><strong><span class="hljs-string">[projectId]</span></strong><span class="hljs-string">/messages:send"</span></li><li>
</li><li><span class="hljs-comment">// Request Header</span></li><li>Content-Type<span class="hljs-punctuation">:</span> application<span class="">/</span>json</li><li>Authorization<span class="hljs-punctuation">:</span> Bearer eyJr*****OiIx---****.eyJh*****iJodHR--***.QRod*****<span class="hljs-number">4</span>Gp---****</li><li>push-type<span class="hljs-punctuation">:</span> <span class="hljs-number">0</span></li><li>
</li><li><span class="hljs-comment">// Request Body</span></li><li><span class="hljs-punctuation">{</span></li><li>  <span class="hljs-attr">"payload"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>    <strong><span class="hljs-attr">"notification"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></strong></li><li>      <span class="hljs-attr">"category"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"MARKETING"</span><span class="hljs-punctuation">,</span></li><li>      <span class="hljs-attr">"title"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"普通通知标题"</span><span class="hljs-punctuation">,</span></li><li>      <span class="hljs-attr">"body"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"普通通知内容"</span><span class="hljs-punctuation">,</span></li><li>      <strong><span class="hljs-attr">"profileId"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"111***222"</span></strong><span class="hljs-punctuation">,</span></li><li>      <span class="hljs-attr">"clickAction"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>        <span class="hljs-attr">"actionType"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span></li><li>      <span class="hljs-punctuation">}</span></li><li><strong>    <span class="hljs-punctuation">}</span></strong></li><li>  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span></li><li>  <span class="hljs-attr">"target"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>    <span class="hljs-attr">"token"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"MAMzLg**********lPW"</span><span class="hljs-punctuation">]</span></li><li>  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span></li><li>  <span class="hljs-attr">"pushOptions"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>    <span class="hljs-attr">"testMessage"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span></li><li>  <span class="hljs-punctuation">}</span></li><li><span class="hljs-punctuation">}</span></li></ol></pre></div></div>       <ul>        <li>[projectId]：项目ID，登录<a href="https://developer.huawei.com/consumer/cn/service/josp/agc/index.html" target="_blank">AppGallery Connect</a>网站，选择“开发与服务”，在项目列表中选择对应的项目，左侧导航栏选择“项目设置”，在该页面获取。</li>        <li>Authorization：JWT格式字符串，可参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/push-scenariozed-api-request-struct#section20573634202313" target="_blank">Authorization</a>获取。</li>        <li>push-type：0表示通知消息场景。</li>        <li>actionType：0表示点击消息打开应用首页。</li>        <li>token：Push Token，可参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/push-get-token">获取Push Token</a>获取。</li>        <li>profileId：<span style="color: rgb(73,73,73);">应用内账号</span><span style="color: rgb(73,73,73);">id</span>匿名标识。详情请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/push-scenariozed-api-request-param#section17371529101117" target="_blank">profileId</a>。</li>       </ul>       <p></p>       <div class="p">        消息发送成功后，Push Kit会先校验绑定账号时的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/push-pushcommon#section411410371767" target="_blank">AppProfileType</a>（华为账号或应用账号）：        <ul>         <li>若绑定华为账号则先校验下发消息中携带的profileId和之前应用绑定的profileId是否一致，再校验当前登录的华为账号和绑定时登录的分布式账号是否一致，若全部满足则展示消息，否则不展示消息。</li>         <li>若绑定应用账号则校验下发消息中携带的profileId和之前应用绑定的profileId是否一致，若满足则展示消息，否则不展示消息。          <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">            <p>场景化消息<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/push-scenariozed-api-request-struct" target="_blank">请求体</a>中，接口URL版本为V3（https://push-api.cloud.huawei.com/v3/[projectId]/messages:send）时，仅支持给HarmonyOS Next/5.x及之后的系统版本推送通知；接口URL版本为V2（https://push-api.cloud.huawei.com/v2/[projectId]/messages:send）时，仅支持给HarmonyOS 3.x/4.x的系统版本推送通知。</p>           </div></div></div></li>        </ul>       </div>       <p></p></li>     </ol>    </div>    <div class="tiledSection">     <h2 id="section99251359545">应用在前台时处理通知消息<i class="anchor-icon anchor-icon-link" anchorid="section99251359545" tips="复制节点链接"></i></h2>          <p>为实现应用在后台时展示通知消息，在前台时只接收通知消息并自行完成业务处理，需要服务端和客户端协同配置，具体步骤可以参考以下：</p>     <ol>      <li><span>服务端调用REST API推送通知消息，消息体中携带<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/push-scenariozed-api-request-param#section17371529101117" target="_blank">foregroundShow</a>字段，并且<strong>设置为false（默认为true，表示前后台都展示）</strong>，则应用在前台时不会展示通知消息。</span>       <p></p>       <div _ngcontent-jml-c106="" class="highlight-div"><div _ngcontent-jml-c106="" class="highlight-div-header"><div _ngcontent-jml-c106="" class="highlight-div-header-left"><div _ngcontent-jml-c106="" class="handle-button expand-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jml-c106="" class="highlight-div-header-right"><div _ngcontent-jml-c106="" class="handle-button ai-button"></div><div _ngcontent-jml-c106="" class="handle-button line-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jml-c106="" class="handle-button theme-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jml-c106="" class="handle-button copy-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jml-c106="" class="highlight-scroll-div"><pre class="json prettyprint linenums hljs language-json" hw-language="json" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-punctuation">{</span></li><li>  <span class="hljs-attr">"payload"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>    <strong><span class="hljs-attr">"notification"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></strong></li><li>      <span class="hljs-attr">"category"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"MARKETING"</span><span class="hljs-punctuation">,</span></li><li>      <span class="hljs-attr">"title"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"普通通知标题"</span><span class="hljs-punctuation">,</span></li><li>      <span class="hljs-attr">"body"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"普通通知内容"</span><span class="hljs-punctuation">,</span></li><li>      <span class="hljs-attr">"clickAction"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>        <span class="hljs-attr">"actionType"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span></li><li>      <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span></li><li>      <span class="hljs-attr">"foregroundShow"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span>  <span class="hljs-comment">// 设置为false则应用在前台时不会展示通知消息</span></li><li><strong>    <span class="hljs-punctuation">}</span></strong></li><li>  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span></li><li>  <span class="hljs-attr">"target"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>    <span class="hljs-attr">"token"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"MAMzLg**********lPW"</span><span class="hljs-punctuation">]</span></li><li>  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span></li><li>  <span class="hljs-attr">"pushOptions"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>    <span class="hljs-attr">"testMessage"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span></li><li>  <span class="hljs-punctuation">}</span></li><li><span class="hljs-punctuation">}</span></li></ol></pre></div></div>       <p></p></li>      <li><span>在客户端项目模块的<strong>src/main/module.json5</strong>文件的对应Ability配置中（以PushMessageAbility为例），skills标签的actions属性内容配置为<strong> action.ohos.push.listener</strong>（<strong>项目中有且只能有一个ability定义该action</strong>）。</span>       <p></p>       <div _ngcontent-jml-c106="" class="highlight-div"><div _ngcontent-jml-c106="" class="highlight-div-header"><div _ngcontent-jml-c106="" class="highlight-div-header-left"><div _ngcontent-jml-c106="" class="handle-button expand-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jml-c106="" class="highlight-div-header-right"><div _ngcontent-jml-c106="" class="handle-button ai-button"></div><div _ngcontent-jml-c106="" class="handle-button line-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jml-c106="" class="handle-button theme-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jml-c106="" class="handle-button copy-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jml-c106="" class="highlight-scroll-div"><pre class="json prettyprint linenums hljs language-json" hw-language="json" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-punctuation">{</span></li><li>  <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"PushMessageAbility"</span><span class="hljs-punctuation">,</span></li><li>  <span class="hljs-attr">"srcEntry"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"./ets/abilities/PushMessageAbility.ets"</span><span class="hljs-punctuation">,</span></li><li>  <span class="hljs-attr">"launchType"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"singleton"</span><span class="hljs-punctuation">,</span></li><li>  <span class="hljs-attr">"startWindowIcon"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"$media:startIcon"</span><span class="hljs-punctuation">,</span></li><li>  <span class="hljs-attr">"startWindowBackground"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"$color:start_window_background"</span><span class="hljs-punctuation">,</span></li><li>  <span class="hljs-attr">"exported"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><span class="hljs-punctuation">,</span></li><li>  <span class="hljs-attr">"skills"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span></li><li>    <span class="hljs-comment">// 保持现有skill对象不变</span></li><li>    <span class="hljs-punctuation">{</span></li><li>      <span class="hljs-attr">"actions"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span></li><li>        <span class="hljs-string">"com.app.action"</span></li><li>      <span class="hljs-punctuation">]</span></li><li>    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span></li><li>    <span class="hljs-comment">// 新增一个独立的skill对象，配置actions参数</span></li><li>    <span class="hljs-punctuation">{</span></li><li>      <span class="hljs-attr">"actions"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span></li><li>        <strong><span class="hljs-string">"action.ohos.push.listener"</span></strong></li><li>      <span class="hljs-punctuation">]</span></li><li>    <span class="hljs-punctuation">}</span></li><li>  <span class="hljs-punctuation">]</span></li><li><span class="hljs-punctuation">}</span></li></ol></pre></div></div>       <p></p></li>      <li><span>在客户端项目中，已经通过步骤2配置了actions属性内容的UIAbility类的onCreate()中（以PushMessageAbility为例），通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/push-pushservice#section125883044911" target="_blank">receiveMessage</a>()方法传入<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/push-pushservice#section5507492425" target="_blank">PushType</a>为"DEFAULT"获取通知消息，用于应用在前台时接收通知消息，示例代码如下：</span>       <p></p>       <div _ngcontent-jml-c106="" class="highlight-div"><div _ngcontent-jml-c106="" class="highlight-div-header"><div _ngcontent-jml-c106="" class="highlight-div-header-left"><div _ngcontent-jml-c106="" class="handle-button expand-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jml-c106="" class="highlight-div-header-right"><div _ngcontent-jml-c106="" class="handle-button ai-button"></div><div _ngcontent-jml-c106="" class="handle-button line-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jml-c106="" class="handle-button theme-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jml-c106="" class="handle-button copy-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jml-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 文件路径: src/main/ets/abilities/PushMessageAbility.ets</span></li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { pushService } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PushKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li>
</li><li><span class="hljs-comment">/**</span></li><li><span class="hljs-comment"> * 此处以PushMessageAbility为例，用于应用在前台时接收通知消息</span></li><li><span class="hljs-comment"> */</span></li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PushMessageAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onCreate</span>(): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-comment">// receiveMessage中的参数固定为DEFAULT</span></li><li>      pushService.<span class="hljs-title function_">receiveMessage</span>(<span class="hljs-string">'DEFAULT'</span>, <span class="hljs-variable language_">this</span>, <span class="hljs-function">(<span class="hljs-params">payload</span>) =&gt;</span> {</li><li>        <span class="hljs-keyword">try</span> {</li><li>          <span class="hljs-comment">// 获取服务端传递的数据</span></li><li>          <span class="hljs-keyword">const</span> <span class="hljs-attr">data</span>: <span class="hljs-built_in">string</span> = payload.<span class="hljs-property">data</span>;</li><li>          <span class="hljs-comment">// TODO：业务自行处理</span></li><li>          hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">'Succeeded in getting notification,data=%{public}s'</span>,</li><li>            <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(data)?.<span class="hljs-property">notification</span>));</li><li>        } <span class="hljs-keyword">catch</span> (e) {</li><li>          <span class="hljs-keyword">let</span> <span class="hljs-attr">errRes</span>: <span class="hljs-title class_">BusinessError</span> = e <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>;</li><li>          hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">'Failed to process data: %{public}d %{public}s'</span>,</li><li>            errRes.<span class="hljs-property">code</span>, errRes.<span class="hljs-property">message</span>);</li><li>        }</li><li>      });</li><li>    } <span class="hljs-keyword">catch</span> (err) {</li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">e</span>: <span class="hljs-title class_">BusinessError</span> = err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>;</li><li>      hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">'Failed to get message: %{public}d %{public}s'</span>, e.<span class="hljs-property">code</span>,</li><li>        e.<span class="hljs-property">message</span>);</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>       <p></p></li>     </ol>    </div>    <div class="tiledSection">     <h2 id="section2569155413322">通知消息自定义铃声实现<i class="anchor-icon anchor-icon-link" anchorid="section2569155413322" tips="复制节点链接"></i></h2>          <p>当用户终端收到通知消息时，通知提示会播放系统默认通知铃声。如需实现自定义铃声功能（category取值为MARKETING不支持该功能）， 消息需要携带<strong><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/push-scenariozed-api-request-param#section17371529101117" target="_blank">sound</a></strong>字段。此功能需要服务端和客户端协同配置，具体步骤可以参考以下：</p>     <ol>      <li><span>将自定义铃声文件放在<strong>客户端</strong>工程中/resources/rawfile路径下（例如设置为<strong>alert.mp3</strong>，对应本地的<strong>/resources/rawfile/alert.mp3</strong>文件），重新编译安装应用程序包。</span></li>      <li><span><strong>服务端</strong>调用REST API推送通知消息，消息体中携带<strong>sound</strong>字段。</span>       <p></p>       <div _ngcontent-jml-c106="" class="highlight-div"><div _ngcontent-jml-c106="" class="highlight-div-header"><div _ngcontent-jml-c106="" class="highlight-div-header-left"><div _ngcontent-jml-c106="" class="handle-button expand-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jml-c106="" class="highlight-div-header-right"><div _ngcontent-jml-c106="" class="handle-button ai-button"></div><div _ngcontent-jml-c106="" class="handle-button line-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jml-c106="" class="handle-button theme-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jml-c106="" class="handle-button copy-button"><div _ngcontent-jml-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jml-c106="" class="highlight-scroll-div"><pre class="json prettyprint linenums hljs language-json" hw-language="json" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// Request URL</span></li><li>POST <span class="hljs-string">"https://push-api.cloud.huawei.com/v3/</span><strong><span class="hljs-string">[projectId]</span></strong><span class="hljs-string">/messages:send"</span></li><li>
</li><li><span class="hljs-comment">// Request Header</span></li><li>Content-Type<span class="hljs-punctuation">:</span> application<span class="">/</span>json</li><li>Authorization<span class="hljs-punctuation">:</span> Bearer eyJr*****OiIx---****.eyJh*****iJodHR--***.QRod*****<span class="hljs-number">4</span>Gp---****</li><li>push-type<span class="hljs-punctuation">:</span> <span class="hljs-number">0</span></li><li>
</li><li><span class="hljs-comment">// Request Body</span></li><li><span class="hljs-punctuation">{</span></li><li>  <span class="hljs-attr">"payload"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>    <span class="hljs-attr">"notification"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>      <span class="hljs-attr">"category"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"TRAVEL"</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// 替换为实际消息类型</span></li><li>      <span class="hljs-attr">"title"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"普通通知标题"</span><span class="hljs-punctuation">,</span></li><li>      <span class="hljs-attr">"body"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"普通通知内容"</span><span class="hljs-punctuation">,</span></li><li>      <span class="hljs-attr">"clickAction"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>        <span class="hljs-attr">"actionType"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span></li><li>      <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span></li><li>      <span class="hljs-attr">"notifyId"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">12345</span><span class="hljs-punctuation">,</span></li><li>      <span class="hljs-attr">"sound"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"alert.mp3"</span><span class="hljs-punctuation">,</span>  <span class="hljs-comment">// category取值为MARKETING时，不支持该功能</span></li><li>      <span class="hljs-attr">"soundDuration"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">10</span>  <span class="hljs-comment">// 请求同时携带sound字段时才会生效</span></li><li>    <span class="hljs-punctuation">}</span></li><li>  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span></li><li>  <span class="hljs-attr">"target"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>    <span class="hljs-attr">"token"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"MAMzLg**********lPW"</span><span class="hljs-punctuation">]</span></li><li>  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span></li><li>  <span class="hljs-attr">"pushOptions"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>   <span class="hljs-attr">"testMessage"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span></li><li>    <span class="hljs-attr">"ttl"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">86400</span></li><li>  <span class="hljs-punctuation">}</span></li><li><span class="hljs-punctuation">}</span></li></ol></pre></div></div>       <ul>        <li>sound：（选填）自定义消息通知铃声。此处设置的铃声文件必须放在应用的/resources/rawfile路径下。例如设置为<strong>alert.mp3</strong>，对应应用本地的<strong>/resources/rawfile/alert.mp3</strong>文件。详情请见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/push-scenariozed-api-request-param#section17371529101117" target="_blank">sound</a>。category取值为MARKETING时，不支持该功能。</li>        <li>soundDuration：（选填）自定义消息通知铃声时长，仅支持数字，单位为秒，取值范围 [1, 60]，在请求同时携带<strong>sound字段</strong>时才会生效。sound字段传入的自定义消息通知铃声会播放至soundDuration字段值后停止，若自定义消息通知铃声对应的时长不足soundDuration字段值则会循环播放，在达到soundDuration字段值后停止。详情请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/push-scenariozed-api-request-param#section17371529101117" target="_blank">soundDuration</a>。</li>       </ul>       <p></p></li>     </ol>    </div>   </div>   <div></div></div>