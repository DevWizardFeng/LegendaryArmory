<h1 _ngcontent-vls-c119="" class="doc-title ng-star-inserted" title="取消网络请求（ArkTS）"> 取消网络请求（ArkTS） </h1>

<div _ngcontent-vls-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p>在远场通信服务的框架中，没有明确指定任何request的情况下，通过调用session.cancel，可以取消所有正在进行的网络请求。当开发者需要取消特定的一个网络请求时，可以使用session.cancel方法，并传入需要取消的请求，以实现这一目标。这样，开发者们就能根据具体需求，灵活地管理和控制网络请求的执行。</p>    <div class="tiledSection">     <h2 id="section15385135185019">约束与限制<i class="anchor-icon anchor-icon-link" anchorid="section15385135185019" tips="复制节点链接"></i></h2>          <p>取消网络请求能力支持Phone、2in1、Tablet、Wearable设备。并且从5.1.1(19)开始，新增支持TV设备。</p>    </div>    <div class="tiledSection">     <h2 id="section201843551369">接口说明<i class="anchor-icon anchor-icon-link" anchorid="section201843551369" tips="复制节点链接"></i></h2>          <p>具体API说明详见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/remote-communication-rcp#section14571174220320" target="_blank">接口文档</a>。</p>    </div>    <div class="tablenoborder">     <div class="tbBox"><table class="layoutFixed idpTab">      <thead>       <tr>        <th align="left" class="cellrowborder" id="mcps1.3.4.1.3.1.1" valign="top" width="50.22%">         <p>接口名</p></th>        <th align="left" class="cellrowborder" id="mcps1.3.4.1.3.1.2" valign="top" width="49.78%">         <p>描述</p></th>       </tr>      </thead>             <tbody><tr>        <td class="cellrowborder" valign="top" width="50.22%">         <p>cancel(requestToCancel?: <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/remote-communication-rcp#section10768169134510" target="_blank">Request</a>| <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/remote-communication-rcp#section10768169134510" target="_blank">Request</a>[]): void</p></td>        <td class="cellrowborder" valign="top" width="49.78%">         <ul>          <li>取消指定网络请求：传入需要取消的请求，返回值为空。</li>          <li>取消所有网络请求：无需传入参数，直接调用，返回值为空。</li>         </ul></td>       </tr>           </tbody></table></div>    </div>    <div class="tiledSection">     <h2 id="section1687192153717">使用示例<i class="anchor-icon anchor-icon-link" anchorid="section1687192153717" tips="复制节点链接"></i></h2>          <ol>      <li><span>导入模块。</span>       <p></p>       <div _ngcontent-vls-c106="" class="highlight-div"><div _ngcontent-vls-c106="" class="highlight-div-header"><div _ngcontent-vls-c106="" class="highlight-div-header-left"><div _ngcontent-vls-c106="" class="handle-button expand-button"><div _ngcontent-vls-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-vls-c106="" class="highlight-div-header-right"><div _ngcontent-vls-c106="" class="handle-button ai-button"></div><div _ngcontent-vls-c106="" class="handle-button line-button"><div _ngcontent-vls-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-vls-c106="" class="handle-button theme-button"><div _ngcontent-vls-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-vls-c106="" class="handle-button copy-button"><div _ngcontent-vls-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-vls-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { rcp } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.RemoteCommunicationKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li></ol></pre></div></div>       <p></p></li>      <li><span>创建会话并创建两个Request，分别发起请求，在请求完成后进行cancel操作。</span>       <p></p>       <ul>        <li>单独取消某个请求         <div _ngcontent-vls-c106="" class="highlight-div"><div _ngcontent-vls-c106="" class="highlight-div-header"><div _ngcontent-vls-c106="" class="highlight-div-header-left"><div _ngcontent-vls-c106="" class="handle-button expand-button"><div _ngcontent-vls-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-vls-c106="" class="highlight-div-header-right"><div _ngcontent-vls-c106="" class="handle-button ai-button"></div><div _ngcontent-vls-c106="" class="handle-button line-button"><div _ngcontent-vls-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-vls-c106="" class="handle-button theme-button"><div _ngcontent-vls-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-vls-c106="" class="handle-button copy-button"><div _ngcontent-vls-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-vls-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 创建会话</span></li><li><span class="hljs-keyword">const</span> session = rcp.<span class="hljs-title function_">createSession</span>();</li><li><span class="hljs-comment">// 创建request1、request2</span></li><li><span class="hljs-keyword">let</span> request1 = <span class="hljs-keyword">new</span> rcp.<span class="hljs-title class_">Request</span>(<span class="hljs-string">"https://www.example.com"</span>);</li><li><span class="hljs-keyword">let</span> request2 = <span class="hljs-keyword">new</span> rcp.<span class="hljs-title class_">Request</span>(<span class="hljs-string">"https://www.example.com"</span>);</li><li>
</li><li><span class="hljs-comment">// 分别发起请求</span></li><li>session.<span class="hljs-title function_">fetch</span>(request1).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">response: rcp.Response</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`The response1 code is <span class="hljs-subst">${response.statusCode}</span>`</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Request1 error code is <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(err.code)}</span>, error message is <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(err)}</span>`</span>);</li><li>})</li><li>
</li><li>session.<span class="hljs-title function_">fetch</span>(request2).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">response: rcp.Response</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`The response2 code is <span class="hljs-subst">${response.statusCode}</span>`</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Request2 error code is <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(err.code)}</span>, error message is <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(err)}</span>`</span>);</li><li>})</li><li>
</li><li><span class="hljs-comment">// 单独取消Request1、request2</span></li><li>session.<span class="hljs-title function_">cancel</span>(request1);</li><li>session.<span class="hljs-title function_">cancel</span>(request2);</li></ol></pre></div></div></li>        <li>取消全部请求         <div _ngcontent-vls-c106="" class="highlight-div"><div _ngcontent-vls-c106="" class="highlight-div-header"><div _ngcontent-vls-c106="" class="highlight-div-header-left"><div _ngcontent-vls-c106="" class="handle-button expand-button"><div _ngcontent-vls-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-vls-c106="" class="highlight-div-header-right"><div _ngcontent-vls-c106="" class="handle-button ai-button"></div><div _ngcontent-vls-c106="" class="handle-button line-button"><div _ngcontent-vls-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-vls-c106="" class="handle-button theme-button"><div _ngcontent-vls-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-vls-c106="" class="handle-button copy-button"><div _ngcontent-vls-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-vls-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 创建会话</span></li><li><span class="hljs-keyword">const</span> session = rcp.<span class="hljs-title function_">createSession</span>();</li><li><span class="hljs-comment">// 创建request1、request2</span></li><li><span class="hljs-keyword">let</span> request1 = <span class="hljs-keyword">new</span> rcp.<span class="hljs-title class_">Request</span>(<span class="hljs-string">"https://www.example.com"</span>);</li><li><span class="hljs-keyword">let</span> request2 = <span class="hljs-keyword">new</span> rcp.<span class="hljs-title class_">Request</span>(<span class="hljs-string">"https://www.example.com"</span>);</li><li>
</li><li><span class="hljs-comment">// 分别发起请求</span></li><li>session.<span class="hljs-title function_">fetch</span>(request1).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">response: rcp.Response</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`The response1 code is <span class="hljs-subst">${response.statusCode}</span>`</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Request1 error code is <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(err.code)}</span>, error message is <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(err)}</span>`</span>);</li><li>})</li><li>
</li><li>session.<span class="hljs-title function_">fetch</span>(request2).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">response: rcp.Response</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`The response2 code is <span class="hljs-subst">${response.statusCode}</span>`</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Request2 error code is <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(err.code)}</span>, error message is <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(err)}</span>`</span>);</li><li>})</li><li><span class="hljs-comment">// 取消全部request</span></li><li>session.<span class="hljs-title function_">cancel</span>();</li></ol></pre></div></div></li>       </ul>       <p></p></li>     </ol>    </div>   </div>   <div></div></div>