<h1 _ngcontent-iab-c119="" class="doc-title ng-star-inserted" title="启动应用内的UIAbility组件"> 启动应用内的UIAbility组件 </h1>

<div _ngcontent-iab-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability" target="_blank">UIAbility</a>是系统调度的最小单元。在设备内的功能模块之间跳转时，会涉及到启动特定的UIAbility，包括应用内的其他UIAbility、或者其他应用的UIAbility（例如启动三方支付UIAbility）。</p>    <p>本文主要介绍启动应用内的UIAbility组件的方式。应用间的组件跳转详见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/link-between-apps-overview">应用间跳转</a>。</p>    <ul>     <li><a href="/consumer/cn/doc/harmonyos-guides/uiability-intra-device-interaction#启动应用内的uiability">启动应用内的UIAbility</a></li>     <li><a href="/consumer/cn/doc/harmonyos-guides/uiability-intra-device-interaction#启动应用内的uiability并获取返回结果">启动应用内的UIAbility并获取返回结果</a></li>     <li><a href="/consumer/cn/doc/harmonyos-guides/uiability-intra-device-interaction#启动uiability的指定页面">启动UIAbility的指定页面</a></li>    </ul>    <div class="tiledSection">     <h2 id="启动应用内的uiability">启动应用内的UIAbility<i class="anchor-icon anchor-icon-link" anchorid="启动应用内的uiability" tips="复制节点链接"></i></h2>          <p>当一个应用内包含多个<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability" target="_blank">UIAbility</a>时，存在应用内启动UIAbility的场景。例如在支付应用中从入口UIAbility启动收付款UIAbility。</p>     <p>假设应用中有两个UIAbility：EntryAbility和FuncAbility（可以在同一个Module中，也可以在不同的Module中），需要从EntryAbility的页面中启动FuncAbility。</p>     <ol>      <li>       <p>在EntryAbility中，通过调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext#startability" target="_blank">startAbility()</a>方法启动UIAbility，<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-want" target="_blank">want</a>为UIAbility实例启动的入口参数，其中bundleName为待启动应用的Bundle名称，abilityName为待启动的Ability名称，moduleName在待启动的UIAbility属于不同的Module时添加，parameters为自定义信息参数。示例中的context的获取方式请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/uiability-usage#获取uiability的上下文信息">获取UIAbility的上下文信息</a>。</p>       <div _ngcontent-iab-c106="" class="highlight-div"><div _ngcontent-iab-c106="" class="highlight-div-header"><div _ngcontent-iab-c106="" class="highlight-div-header-left"><div _ngcontent-iab-c106="" class="handle-button expand-button"><div _ngcontent-iab-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-iab-c106="" class="highlight-div-header-right"><div _ngcontent-iab-c106="" class="handle-button ai-button"></div><div _ngcontent-iab-c106="" class="handle-button line-button"><div _ngcontent-iab-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-iab-c106="" class="handle-button theme-button"><div _ngcontent-iab-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-iab-c106="" class="handle-button copy-button"><div _ngcontent-iab-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-iab-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { common, <span class="hljs-title class_">Want</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">const</span> <span class="hljs-attr">TAG</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'[Page_UIAbilityComponentsInteractive]'</span>;</li><li><span class="hljs-keyword">const</span> <span class="hljs-attr">DOMAIN_NUMBER</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0xFF00</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Page</span>_UIAbilityComponentsInteractive {</li><li>  <span class="hljs-keyword">private</span> context = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-comment">//...</span></li><li>      <span class="hljs-title class_">List</span>({ <span class="hljs-attr">initialIndex</span>: <span class="hljs-number">0</span> }) {</li><li>        <span class="hljs-title class_">ListItem</span>() {</li><li>          <span class="hljs-title class_">Row</span>() {</li><li>            <span class="hljs-comment">//...</span></li><li>          }</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-comment">// context为Ability对象的成员，在非Ability对象内部调用需要</span></li><li>            <span class="hljs-comment">// 将Context对象传递过去</span></li><li>            <span class="hljs-keyword">let</span> <span class="hljs-attr">wantInfo</span>: <span class="hljs-title class_">Want</span> = {</li><li>              <span class="hljs-attr">deviceId</span>: <span class="hljs-string">''</span>, <span class="hljs-comment">// deviceId为空表示本设备</span></li><li>              <span class="hljs-attr">bundleName</span>: <span class="hljs-string">'com.samples.stagemodelabilitydevelop'</span>,</li><li>              <span class="hljs-attr">moduleName</span>: <span class="hljs-string">'entry'</span>, <span class="hljs-comment">// moduleName非必选</span></li><li>              <span class="hljs-attr">abilityName</span>: <span class="hljs-string">'FuncAbilityA'</span>,</li><li>              <span class="hljs-attr">parameters</span>: {</li><li>                <span class="hljs-comment">// 自定义信息</span></li><li>                <span class="hljs-attr">info</span>: <span class="hljs-string">'来自EntryAbility Page_UIAbilityComponentsInteractive页面'</span></li><li>              },</li><li>            };</li><li>            <span class="hljs-comment">// context为调用方UIAbility的UIAbilityContext</span></li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">startAbility</span>(wantInfo).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>              hilog.<span class="hljs-title function_">info</span>(<span class="hljs-variable constant_">DOMAIN_NUMBER</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'startAbility success.'</span>);</li><li>            }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error: BusinessError</span>) =&gt;</span> {</li><li>              hilog.<span class="hljs-title function_">error</span>(<span class="hljs-variable constant_">DOMAIN_NUMBER</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'startAbility failed.'</span>);</li><li>            });</li><li>          })</li><li>        }</li><li>        <span class="hljs-comment">//...</span></li><li>      }</li><li>      <span class="hljs-comment">//...</span></li><li>    }</li><li>    <span class="hljs-comment">//...</span></li><li>  }</li><li>}</li></ol></pre></div></div></li>      <li>       <p>在FuncAbility的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability#oncreate" target="_blank">onCreate()</a>或者<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability#onnewwant" target="_blank">onNewWant()</a>生命周期回调文件中接收EntryAbility传递过来的参数。</p>       <div _ngcontent-iab-c106="" class="highlight-div"><div _ngcontent-iab-c106="" class="highlight-div-header"><div _ngcontent-iab-c106="" class="highlight-div-header-left"><div _ngcontent-iab-c106="" class="handle-button expand-button"><div _ngcontent-iab-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-iab-c106="" class="highlight-div-header-right"><div _ngcontent-iab-c106="" class="handle-button ai-button"></div><div _ngcontent-iab-c106="" class="handle-button line-button"><div _ngcontent-iab-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-iab-c106="" class="handle-button theme-button"><div _ngcontent-iab-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-iab-c106="" class="handle-button copy-button"><div _ngcontent-iab-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-iab-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AbilityConstant</span>, <span class="hljs-title class_">UIAbility</span>, <span class="hljs-title class_">Want</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FuncAbilityA</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-title function_">onCreate</span>(<span class="hljs-attr">want</span>: <span class="hljs-title class_">Want</span>, <span class="hljs-attr">launchParam</span>: <span class="hljs-title class_">AbilityConstant</span>.<span class="hljs-property">LaunchParam</span>): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-comment">// 接收调用方UIAbility传过来的参数</span></li><li>    <span class="hljs-keyword">let</span> funcAbilityWant = want;</li><li>    <span class="hljs-keyword">let</span> info = funcAbilityWant?.<span class="hljs-property">parameters</span>?.<span class="hljs-property">info</span>;</li><li>  }</li><li>  <span class="hljs-comment">//...</span></li><li>}</li></ol></pre></div></div>       <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">         <p>在被拉起的FuncAbility中，可以通过获取传递过来的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-want" target="_blank">want</a>参数的parameters来获取拉起方<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability" target="_blank">UIAbility</a>的PID、Bundle Name等信息。</p>        </div></div></div></li>      <li>       <p>在FuncAbility业务完成之后，如需要停止当前<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability" target="_blank">UIAbility</a>实例，在FuncAbility中通过调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext#terminateself" target="_blank">terminateSelf()</a>方法实现。</p>       <div _ngcontent-iab-c106="" class="highlight-div"><div _ngcontent-iab-c106="" class="highlight-div-header"><div _ngcontent-iab-c106="" class="highlight-div-header-left"><div _ngcontent-iab-c106="" class="handle-button expand-button"><div _ngcontent-iab-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-iab-c106="" class="highlight-div-header-right"><div _ngcontent-iab-c106="" class="handle-button ai-button"></div><div _ngcontent-iab-c106="" class="handle-button line-button"><div _ngcontent-iab-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-iab-c106="" class="handle-button theme-button"><div _ngcontent-iab-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-iab-c106="" class="handle-button copy-button"><div _ngcontent-iab-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-iab-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li>
</li><li><span class="hljs-keyword">const</span> <span class="hljs-attr">TAG</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'[Page_FromStageModel]'</span>;</li><li><span class="hljs-keyword">const</span> <span class="hljs-attr">DOMAIN_NUMBER</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0xFF00</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Page</span>_FromStageModel {</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-comment">//...</span></li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'FuncAbilityB'</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-keyword">let</span> context = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>; <span class="hljs-comment">// UIAbilityContext</span></li><li>          <span class="hljs-comment">// context为需要停止的UIAbility实例的AbilityContext</span></li><li>          context.<span class="hljs-title function_">terminateSelf</span>(<span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> {</li><li>            <span class="hljs-keyword">if</span> (err.<span class="hljs-property">code</span>) {</li><li>              hilog.<span class="hljs-title function_">error</span>(<span class="hljs-variable constant_">DOMAIN_NUMBER</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">`Failed to terminate self. Code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>              <span class="hljs-keyword">return</span>;</li><li>            }</li><li>          });</li><li>        })</li><li>    }</li><li>    <span class="hljs-comment">//...</span></li><li>  }</li><li>}</li></ol></pre></div></div>       <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">         <p>调用terminateSelf()方法停止当前UIAbility实例时，默认会保留该实例的快照（Snapshot），即在最近任务列表中仍然能查看到该实例对应的任务。如不需要保留该实例的快照，可以在其对应UIAbility的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/module-configuration-file">module.json5配置文件</a>中，将<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/module-configuration-file#abilities标签">abilities标签</a>的removeMissionAfterTerminate字段配置为true。</p>        </div></div></div></li>      <li>       <p>如需要关闭应用所有的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability" target="_blank">UIAbility</a>实例，可以调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-applicationcontext" target="_blank">ApplicationContext</a>的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-applicationcontext#applicationcontextkillallprocesses" target="_blank">killAllProcesses()</a>方法实现关闭应用所有的进程。</p></li>     </ol>    </div>    <div class="tiledSection">     <h2 id="启动应用内的uiability并获取返回结果">启动应用内的UIAbility并获取返回结果<i class="anchor-icon anchor-icon-link" anchorid="启动应用内的uiability并获取返回结果" tips="复制节点链接"></i></h2>          <p>在一个EntryAbility启动另外一个FuncAbility时，希望在被启动的FuncAbility完成相关业务后，能将结果返回给调用方。例如在应用中将入口功能和账号登录功能分别设计为两个独立的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability" target="_blank">UIAbility</a>，在账号登录UIAbility中完成登录操作后，需要将登录的结果返回给入口UIAbility。</p>     <ol>      <li>       <p>在EntryAbility中，调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext#startabilityforresult-2" target="_blank">startAbilityForResult()</a>接口启动FuncAbility，异步回调中的data用于接收FuncAbility停止自身后返回给EntryAbility的信息。示例中的context的获取方式请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/uiability-usage#获取uiability的上下文信息">获取UIAbility的上下文信息</a>。</p>       <div _ngcontent-iab-c106="" class="highlight-div"><div _ngcontent-iab-c106="" class="highlight-div-header"><div _ngcontent-iab-c106="" class="highlight-div-header-left"><div _ngcontent-iab-c106="" class="handle-button expand-button"><div _ngcontent-iab-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-iab-c106="" class="highlight-div-header-right"><div _ngcontent-iab-c106="" class="handle-button ai-button"></div><div _ngcontent-iab-c106="" class="handle-button line-button"><div _ngcontent-iab-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-iab-c106="" class="handle-button theme-button"><div _ngcontent-iab-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-iab-c106="" class="handle-button copy-button"><div _ngcontent-iab-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-iab-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { common, <span class="hljs-title class_">Want</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">const</span> <span class="hljs-attr">TAG</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'[Page_UIAbilityComponentsInteractive]'</span>;</li><li><span class="hljs-keyword">const</span> <span class="hljs-attr">DOMAIN_NUMBER</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0xFF00</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Page</span>_UIAbilityComponentsInteractive {</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-comment">//...</span></li><li>      <span class="hljs-title class_">List</span>({ <span class="hljs-attr">initialIndex</span>: <span class="hljs-number">0</span> }) {</li><li>        <span class="hljs-title class_">ListItem</span>() {</li><li>          <span class="hljs-title class_">Row</span>() {</li><li>            <span class="hljs-comment">//...</span></li><li>          }</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-keyword">let</span> context = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>; <span class="hljs-comment">// UIAbilityContext</span></li><li>            <span class="hljs-keyword">const</span> <span class="hljs-attr">RESULT_CODE</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">1001</span>;</li><li>            <span class="hljs-keyword">let</span> <span class="hljs-attr">want</span>: <span class="hljs-title class_">Want</span> = {</li><li>              <span class="hljs-attr">deviceId</span>: <span class="hljs-string">''</span>, <span class="hljs-comment">// deviceId为空表示本设备</span></li><li>              <span class="hljs-attr">bundleName</span>: <span class="hljs-string">'com.samples.stagemodelabilitydevelop'</span>,</li><li>              <span class="hljs-attr">moduleName</span>: <span class="hljs-string">'entry'</span>, <span class="hljs-comment">// moduleName非必选</span></li><li>              <span class="hljs-attr">abilityName</span>: <span class="hljs-string">'FuncAbilityA'</span>,</li><li>              <span class="hljs-attr">parameters</span>: {</li><li>                <span class="hljs-comment">// 自定义信息</span></li><li>                <span class="hljs-attr">info</span>: <span class="hljs-string">'来自EntryAbility UIAbilityComponentsInteractive页面'</span></li><li>              }</li><li>            };</li><li>            context.<span class="hljs-title function_">startAbilityForResult</span>(want).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {</li><li>              <span class="hljs-keyword">if</span> (data?.<span class="hljs-property">resultCode</span> === <span class="hljs-variable constant_">RESULT_CODE</span>) {</li><li>                <span class="hljs-comment">// 解析被调用方UIAbility返回的信息</span></li><li>                <span class="hljs-keyword">let</span> info = data.<span class="hljs-property">want</span>?.<span class="hljs-property">parameters</span>?.<span class="hljs-property">info</span>;</li><li>                hilog.<span class="hljs-title function_">info</span>(<span class="hljs-variable constant_">DOMAIN_NUMBER</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(info) ?? <span class="hljs-string">''</span>);</li><li>                <span class="hljs-keyword">if</span> (info !== <span class="hljs-literal">null</span>) {</li><li>                  <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getPromptAction</span>().<span class="hljs-title function_">showToast</span>({</li><li>                    <span class="hljs-attr">message</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(info)</li><li>                  });</li><li>                }</li><li>              }</li><li>              hilog.<span class="hljs-title function_">info</span>(<span class="hljs-variable constant_">DOMAIN_NUMBER</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data.<span class="hljs-property">resultCode</span>) ?? <span class="hljs-string">''</span>);</li><li>            }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>              hilog.<span class="hljs-title function_">error</span>(<span class="hljs-variable constant_">DOMAIN_NUMBER</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">`Failed to start ability for result. Code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>            });</li><li>          })</li><li>        }</li><li>        <span class="hljs-comment">//...</span></li><li>      }</li><li>      <span class="hljs-comment">//...</span></li><li>    }</li><li>    <span class="hljs-comment">//...</span></li><li>  }</li><li>}</li></ol></pre></div></div></li>      <li>       <p>在FuncAbility停止自身时，需要调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext#terminateselfwithresult" target="_blank">terminateSelfWithResult()</a>方法，入参<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-ability-abilityresult" target="_blank">abilityResult</a>为FuncAbility需要返回给EntryAbility的信息。</p>       <div _ngcontent-iab-c106="" class="highlight-div"><div _ngcontent-iab-c106="" class="highlight-div-header"><div _ngcontent-iab-c106="" class="highlight-div-header-left"><div _ngcontent-iab-c106="" class="handle-button expand-button"><div _ngcontent-iab-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-iab-c106="" class="highlight-div-header-right"><div _ngcontent-iab-c106="" class="handle-button ai-button"></div><div _ngcontent-iab-c106="" class="handle-button line-button"><div _ngcontent-iab-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-iab-c106="" class="handle-button theme-button"><div _ngcontent-iab-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-iab-c106="" class="handle-button copy-button"><div _ngcontent-iab-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-iab-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li>
</li><li><span class="hljs-keyword">const</span> <span class="hljs-attr">TAG</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'[Page_FuncAbilityA]'</span>;</li><li><span class="hljs-keyword">const</span> <span class="hljs-attr">DOMAIN_NUMBER</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0xFF00</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Page</span>_FuncAbilityA {</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-comment">//...</span></li><li>      <span class="hljs-title class_">List</span>({ <span class="hljs-attr">initialIndex</span>: <span class="hljs-number">0</span> }) {</li><li>        <span class="hljs-title class_">ListItem</span>() {</li><li>          <span class="hljs-title class_">Row</span>() {</li><li>            <span class="hljs-comment">//...</span></li><li>          }</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-keyword">let</span> context = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>; <span class="hljs-comment">// UIAbilityContext</span></li><li>            <span class="hljs-keyword">const</span> <span class="hljs-attr">RESULT_CODE</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">1001</span>;</li><li>            <span class="hljs-keyword">let</span> <span class="hljs-attr">abilityResult</span>: common.<span class="hljs-property">AbilityResult</span> = {</li><li>              <span class="hljs-attr">resultCode</span>: <span class="hljs-variable constant_">RESULT_CODE</span>,</li><li>              <span class="hljs-attr">want</span>: {</li><li>                <span class="hljs-attr">bundleName</span>: <span class="hljs-string">'com.samples.stagemodelabilitydevelop'</span>,</li><li>                <span class="hljs-attr">moduleName</span>: <span class="hljs-string">'entry'</span>, <span class="hljs-comment">// moduleName非必选</span></li><li>                <span class="hljs-attr">abilityName</span>: <span class="hljs-string">'FuncAbilityB'</span>,</li><li>                <span class="hljs-attr">parameters</span>: {</li><li>                  <span class="hljs-attr">info</span>: <span class="hljs-string">'来自FuncAbility Index页面'</span></li><li>                },</li><li>              },</li><li>            };</li><li>            context.<span class="hljs-title function_">terminateSelfWithResult</span>(abilityResult, <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> {</li><li>              <span class="hljs-keyword">if</span> (err.<span class="hljs-property">code</span>) {</li><li>                hilog.<span class="hljs-title function_">error</span>(<span class="hljs-variable constant_">DOMAIN_NUMBER</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">`Failed to terminate self with result. Code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>                <span class="hljs-keyword">return</span>;</li><li>              }</li><li>            });</li><li>          })</li><li>        }</li><li>        <span class="hljs-comment">//...</span></li><li>      }</li><li>      <span class="hljs-comment">//...</span></li><li>    }</li><li>    <span class="hljs-comment">//...</span></li><li>  }</li><li>}</li></ol></pre></div></div></li>      <li>       <p>FuncAbility停止自身后，EntryAbility通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext#startabilityforresult-2" target="_blank">startAbilityForResult()</a>方法回调接收被FuncAbility返回的信息，RESULT_CODE需要与前面的数值保持一致。</p>       <div _ngcontent-iab-c106="" class="highlight-div"><div _ngcontent-iab-c106="" class="highlight-div-header"><div _ngcontent-iab-c106="" class="highlight-div-header-left"><div _ngcontent-iab-c106="" class="handle-button expand-button"><div _ngcontent-iab-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-iab-c106="" class="highlight-div-header-right"><div _ngcontent-iab-c106="" class="handle-button ai-button"></div><div _ngcontent-iab-c106="" class="handle-button line-button"><div _ngcontent-iab-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-iab-c106="" class="handle-button theme-button"><div _ngcontent-iab-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-iab-c106="" class="handle-button copy-button"><div _ngcontent-iab-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-iab-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { common, <span class="hljs-title class_">Want</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">const</span> <span class="hljs-attr">TAG</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'[Page_UIAbilityComponentsInteractive]'</span>;</li><li><span class="hljs-keyword">const</span> <span class="hljs-attr">DOMAIN_NUMBER</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0xFF00</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Page</span>_UIAbilityComponentsInteractive {</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-comment">//...</span></li><li>      <span class="hljs-title class_">List</span>({ <span class="hljs-attr">initialIndex</span>: <span class="hljs-number">0</span> }) {</li><li>        <span class="hljs-title class_">ListItem</span>() {</li><li>          <span class="hljs-title class_">Row</span>() {</li><li>            <span class="hljs-comment">//...</span></li><li>          }</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-keyword">let</span> context = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>; <span class="hljs-comment">// UIAbilityContext</span></li><li>            <span class="hljs-keyword">const</span> <span class="hljs-attr">RESULT_CODE</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">1001</span>;</li><li>
</li><li>            <span class="hljs-keyword">let</span> <span class="hljs-attr">want</span>: <span class="hljs-title class_">Want</span> = {</li><li>              <span class="hljs-attr">deviceId</span>: <span class="hljs-string">''</span>, <span class="hljs-comment">// deviceId为空表示本设备</span></li><li>              <span class="hljs-attr">bundleName</span>: <span class="hljs-string">'com.samples.stagemodelabilitydevelop'</span>,</li><li>              <span class="hljs-attr">moduleName</span>: <span class="hljs-string">'entry'</span>, <span class="hljs-comment">// moduleName非必选</span></li><li>              <span class="hljs-attr">abilityName</span>: <span class="hljs-string">'FuncAbilityA'</span>,</li><li>              <span class="hljs-attr">parameters</span>: {</li><li>                <span class="hljs-comment">// 自定义信息</span></li><li>                <span class="hljs-attr">info</span>: <span class="hljs-string">'来自EntryAbility UIAbilityComponentsInteractive页面'</span></li><li>              }</li><li>            };</li><li>            context.<span class="hljs-title function_">startAbilityForResult</span>(want).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {</li><li>              <span class="hljs-keyword">if</span> (data?.<span class="hljs-property">resultCode</span> === <span class="hljs-variable constant_">RESULT_CODE</span>) {</li><li>                <span class="hljs-comment">// 解析被调用方UIAbility返回的信息</span></li><li>                <span class="hljs-keyword">let</span> info = data.<span class="hljs-property">want</span>?.<span class="hljs-property">parameters</span>?.<span class="hljs-property">info</span>;</li><li>                hilog.<span class="hljs-title function_">info</span>(<span class="hljs-variable constant_">DOMAIN_NUMBER</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(info) ?? <span class="hljs-string">''</span>);</li><li>                <span class="hljs-keyword">if</span> (info !== <span class="hljs-literal">null</span>) {</li><li>                  <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getPromptAction</span>().<span class="hljs-title function_">showToast</span>({</li><li>                    <span class="hljs-attr">message</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(info)</li><li>                  });</li><li>                }</li><li>              }</li><li>              hilog.<span class="hljs-title function_">info</span>(<span class="hljs-variable constant_">DOMAIN_NUMBER</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data.<span class="hljs-property">resultCode</span>) ?? <span class="hljs-string">''</span>);</li><li>            }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>              hilog.<span class="hljs-title function_">error</span>(<span class="hljs-variable constant_">DOMAIN_NUMBER</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">`Failed to start ability for result. Code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>            });</li><li>          })</li><li>        }</li><li>        <span class="hljs-comment">//...</span></li><li>      }</li><li>      <span class="hljs-comment">//...</span></li><li>    }</li><li>    <span class="hljs-comment">//...</span></li><li>  }</li><li>}</li></ol></pre></div></div></li>     </ol>    </div>    <div class="tiledSection">     <h2 id="启动uiability的指定页面">启动UIAbility的指定页面<i class="anchor-icon anchor-icon-link" anchorid="启动uiability的指定页面" tips="复制节点链接"></i></h2>         </div>    <div class="tiledSection">     <h3 id="概述" class="firsth2">概述<i class="anchor-icon anchor-icon-link" anchorid="概述" tips="复制节点链接"></i></h3>          <p>一个<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability" target="_blank">UIAbility</a>可以对应多个页面，在不同的场景下启动该UIAbility时需要展示不同的页面，例如从一个UIAbility的页面中跳转到另外一个UIAbility时，希望启动目标UIAbility的指定页面。</p>     <p>UIAbility的启动分为两种情况：UIAbility冷启动和UIAbility热启动。</p>     <ul>      <li>UIAbility冷启动：指的是UIAbility实例处于完全关闭状态下被启动，这需要完整地加载和初始化UIAbility实例的代码、资源等。</li>      <li>UIAbility热启动：指的是UIAbility实例已经启动并在前台运行过，由于某些原因切换到后台，再次启动该UIAbility实例，这种情况下可以快速恢复UIAbility实例的状态。</li>     </ul>     <p>本文主要讲解<a href="/consumer/cn/doc/harmonyos-guides/uiability-intra-device-interaction#目标uiability冷启动">目标UIAbility冷启动</a>和<a href="/consumer/cn/doc/harmonyos-guides/uiability-intra-device-interaction#目标uiability热启动">目标UIAbility热启动</a>两种启动指定页面的场景，以及在讲解启动指定页面之前会讲解到在调用方如何指定启动页面。</p>    </div>    <div class="tiledSection">     <h3 id="调用方uiability指定启动页面">调用方UIAbility指定启动页面<i class="anchor-icon anchor-icon-link" anchorid="调用方uiability指定启动页面" tips="复制节点链接"></i></h3>          <p>调用方<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability" target="_blank">UIAbility</a>启动另外一个UIAbility时，通常需要跳转到指定的页面。例如FuncAbility包含两个页面（Index对应首页，Second对应功能A页面），此时需要在传入的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-want" target="_blank">want</a>参数中配置指定的页面路径信息，可以通过want中的parameters参数增加一个自定义参数传递页面跳转信息。示例中的context的获取方式请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/uiability-usage#获取uiability的上下文信息">获取UIAbility的上下文信息</a>。</p>     <div _ngcontent-iab-c106="" class="highlight-div"><div _ngcontent-iab-c106="" class="highlight-div-header"><div _ngcontent-iab-c106="" class="highlight-div-header-left"><div _ngcontent-iab-c106="" class="handle-button expand-button"><div _ngcontent-iab-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-iab-c106="" class="highlight-div-header-right"><div _ngcontent-iab-c106="" class="handle-button ai-button"></div><div _ngcontent-iab-c106="" class="handle-button line-button"><div _ngcontent-iab-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-iab-c106="" class="handle-button theme-button"><div _ngcontent-iab-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-iab-c106="" class="handle-button copy-button"><div _ngcontent-iab-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-iab-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { common, <span class="hljs-title class_">Want</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">const</span> <span class="hljs-attr">TAG</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'[Page_UIAbilityComponentsInteractive]'</span>;</li><li><span class="hljs-keyword">const</span> <span class="hljs-attr">DOMAIN_NUMBER</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0xFF00</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Page</span>_UIAbilityComponentsInteractive {</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-comment">//...</span></li><li>      <span class="hljs-title class_">List</span>({ <span class="hljs-attr">initialIndex</span>: <span class="hljs-number">0</span> }) {</li><li>        <span class="hljs-title class_">ListItem</span>() {</li><li>          <span class="hljs-title class_">Row</span>() {</li><li>            <span class="hljs-comment">//...</span></li><li>          }</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-keyword">let</span> context = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>; <span class="hljs-comment">// UIAbilityContext</span></li><li>            <span class="hljs-keyword">let</span> <span class="hljs-attr">want</span>: <span class="hljs-title class_">Want</span> = {</li><li>              <span class="hljs-attr">deviceId</span>: <span class="hljs-string">''</span>, <span class="hljs-comment">// deviceId为空表示本设备</span></li><li>              <span class="hljs-attr">bundleName</span>: <span class="hljs-string">'com.samples.stagemodelabilityinteraction'</span>,</li><li>              <span class="hljs-attr">moduleName</span>: <span class="hljs-string">'entry'</span>, <span class="hljs-comment">// moduleName非必选</span></li><li>              <span class="hljs-attr">abilityName</span>: <span class="hljs-string">'FuncAbility'</span>,</li><li>              <span class="hljs-attr">parameters</span>: { <span class="hljs-comment">// 自定义参数传递页面信息</span></li><li>                <span class="hljs-attr">router</span>: <span class="hljs-string">'funcA'</span></li><li>              }</li><li>            };</li><li>            <span class="hljs-comment">// context为调用方UIAbility的UIAbilityContext</span></li><li>            context.<span class="hljs-title function_">startAbility</span>(want).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>              hilog.<span class="hljs-title function_">info</span>(<span class="hljs-variable constant_">DOMAIN_NUMBER</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'Succeeded in starting ability.'</span>);</li><li>            }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>              hilog.<span class="hljs-title function_">error</span>(<span class="hljs-variable constant_">DOMAIN_NUMBER</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">`Failed to start ability. Code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>            });</li><li>          })</li><li>        }</li><li>        <span class="hljs-comment">//...</span></li><li>      }</li><li>      <span class="hljs-comment">//...</span></li><li>    }</li><li>    <span class="hljs-comment">//...</span></li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="目标uiability冷启动">目标UIAbility冷启动<i class="anchor-icon anchor-icon-link" anchorid="目标uiability冷启动" tips="复制节点链接"></i></h3>          <p>目标<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability" target="_blank">UIAbility</a>冷启动时，在目标UIAbility的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability#oncreate" target="_blank">onCreate()</a>生命周期回调中，接收调用方传过来的参数。然后在目标UIAbility的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability#onwindowstagecreate" target="_blank">onWindowStageCreate()</a>生命周期回调中，解析调用方传递过来的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-want" target="_blank">want</a>参数，获取到需要加载的页面信息url，传入<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-window-window#loadcontent9" target="_blank">windowStage.loadContent()</a>方法。</p>     <div _ngcontent-iab-c106="" class="highlight-div"><div _ngcontent-iab-c106="" class="highlight-div-header"><div _ngcontent-iab-c106="" class="highlight-div-header-left"><div _ngcontent-iab-c106="" class="handle-button expand-button"><div _ngcontent-iab-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-iab-c106="" class="highlight-div-header-right"><div _ngcontent-iab-c106="" class="handle-button ai-button"></div><div _ngcontent-iab-c106="" class="handle-button line-button"><div _ngcontent-iab-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-iab-c106="" class="handle-button theme-button"><div _ngcontent-iab-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-iab-c106="" class="handle-button copy-button"><div _ngcontent-iab-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-iab-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AbilityConstant</span>, <span class="hljs-title class_">Want</span>, <span class="hljs-title class_">UIAbility</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-variable language_">window</span>, <span class="hljs-title class_">UIContext</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span>;</li><li>
</li><li><span class="hljs-keyword">const</span> <span class="hljs-attr">DOMAIN_NUMBER</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0xFF00</span>;</li><li><span class="hljs-keyword">const</span> <span class="hljs-attr">TAG</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'[EntryAbility]'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-attr">funcAbilityWant</span>: <span class="hljs-title class_">Want</span> | <span class="hljs-literal">undefined</span> = <span class="hljs-literal">undefined</span>;</li><li>  <span class="hljs-attr">uiContext</span>: <span class="hljs-title class_">UIContext</span> | <span class="hljs-literal">undefined</span> = <span class="hljs-literal">undefined</span>;</li><li>
</li><li>  <span class="hljs-title function_">onCreate</span>(<span class="hljs-attr">want</span>: <span class="hljs-title class_">Want</span>, <span class="hljs-attr">launchParam</span>: <span class="hljs-title class_">AbilityConstant</span>.<span class="hljs-property">LaunchParam</span>): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-comment">// 接收调用方UIAbility传过来的参数</span></li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">funcAbilityWant</span> = want;</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">onWindowStageCreate</span>(<span class="hljs-attr">windowStage</span>: <span class="hljs-variable language_">window</span>.<span class="hljs-property">WindowStage</span>): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-comment">// Main window is created, set main page for this ability</span></li><li>    hilog.<span class="hljs-title function_">info</span>(<span class="hljs-variable constant_">DOMAIN_NUMBER</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'%{public}s'</span>, <span class="hljs-string">'Ability onWindowStageCreate'</span>);</li><li>    <span class="hljs-comment">// Main window is created, set main page for this ability</span></li><li>    <span class="hljs-keyword">let</span> url = <span class="hljs-string">'pages/Index'</span>;</li><li>    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">funcAbilityWant</span>?.<span class="hljs-property">parameters</span>?.<span class="hljs-property">router</span> &amp;&amp; <span class="hljs-variable language_">this</span>.<span class="hljs-property">funcAbilityWant</span>.<span class="hljs-property">parameters</span>.<span class="hljs-property">router</span> === <span class="hljs-string">'funcA'</span>) {</li><li>      url = <span class="hljs-string">'pages/Page_ColdStartUp'</span>;</li><li>    }</li><li>    windowStage.<span class="hljs-title function_">loadContent</span>(url, <span class="hljs-function">(<span class="hljs-params">err, data</span>) =&gt;</span> {</li><li>      <span class="hljs-comment">// ...</span></li><li>    });</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="目标uiability热启动">目标UIAbility热启动<i class="anchor-icon anchor-icon-link" anchorid="目标uiability热启动" tips="复制节点链接"></i></h3>          <p>在应用开发中，会遇到目标<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability" target="_blank">UIAbility</a>实例之前已经启动过的场景，这时再次启动目标UIAbility时，不会重新走初始化逻辑，只会直接触发<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability#onnewwant" target="_blank">onNewWant()</a>生命周期方法。为了实现跳转到指定页面，需要在onNewWant()中解析参数进行处理。</p>     <p>例如短信应用和联系人应用配合使用的场景。</p>     <ol>      <li>用户先打开短信应用，短信应用的UIAbility实例启动，显示短信应用的主页。</li>      <li>用户将设备回到桌面界面，短信应用进入后台运行状态。</li>      <li>用户打开联系人应用，找到联系人张三。</li>      <li>用户点击联系人张三的短信按钮，会重新启动短信应用的UIAbility实例。</li>      <li>由于短信应用的UIAbility实例已经启动过了，此时会触发该UIAbility的onNewWant()回调，而不会再走<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability#oncreate" target="_blank">onCreate()</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability#onwindowstagecreate" target="_blank">onWindowStageCreate()</a>等初始化逻辑。</li>     </ol>     <p>图1 目标UIAbility热启动</p>     <p><span><img originheight="700" originwidth="709" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114942.87629509736542065796166606215815:50001231000000:2800:181D99B31932C148CD73667BDD170CA2C346FADF3753D24F2E4839E21F919940.png" width="709" height="700"></span></p>     <p>开发步骤如下所示。</p>     <ol>      <li>       <p>冷启动短信应用的UIAbility实例时，在<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability#onwindowstagecreate" target="_blank">onWindowStageCreate()</a>生命周期回调中，通过调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-window-window#getuicontext10" target="_blank">getUIContext()</a>接口获取UI上下文实例<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-uicontext-uicontext" target="_blank">UIContext</a>对象。</p>       <div _ngcontent-iab-c106="" class="highlight-div"><div _ngcontent-iab-c106="" class="highlight-div-header"><div _ngcontent-iab-c106="" class="highlight-div-header-left"><div _ngcontent-iab-c106="" class="handle-button expand-button"><div _ngcontent-iab-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-iab-c106="" class="highlight-div-header-right"><div _ngcontent-iab-c106="" class="handle-button ai-button"></div><div _ngcontent-iab-c106="" class="handle-button line-button"><div _ngcontent-iab-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-iab-c106="" class="handle-button theme-button"><div _ngcontent-iab-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-iab-c106="" class="handle-button copy-button"><div _ngcontent-iab-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-iab-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Want</span>, <span class="hljs-title class_">UIAbility</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-variable language_">window</span>, <span class="hljs-title class_">UIContext</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span>;</li><li>
</li><li><span class="hljs-keyword">const</span> <span class="hljs-attr">DOMAIN_NUMBER</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0xFF00</span>;</li><li><span class="hljs-keyword">const</span> <span class="hljs-attr">TAG</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'[EntryAbility]'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-attr">funcAbilityWant</span>: <span class="hljs-title class_">Want</span> | <span class="hljs-literal">undefined</span> = <span class="hljs-literal">undefined</span>;</li><li>  <span class="hljs-attr">uiContext</span>: <span class="hljs-title class_">UIContext</span> | <span class="hljs-literal">undefined</span> = <span class="hljs-literal">undefined</span>;</li><li>
</li><li>  <span class="hljs-comment">// ...</span></li><li>
</li><li>  <span class="hljs-title function_">onWindowStageCreate</span>(<span class="hljs-attr">windowStage</span>: <span class="hljs-variable language_">window</span>.<span class="hljs-property">WindowStage</span>): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-comment">// Main window is created, set main page for this ability</span></li><li>    hilog.<span class="hljs-title function_">info</span>(<span class="hljs-variable constant_">DOMAIN_NUMBER</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'%{public}s'</span>, <span class="hljs-string">'Ability onWindowStageCreate'</span>);</li><li>    <span class="hljs-keyword">let</span> url = <span class="hljs-string">'pages/Index'</span>;</li><li>    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">funcAbilityWant</span>?.<span class="hljs-property">parameters</span>?.<span class="hljs-property">router</span> &amp;&amp; <span class="hljs-variable language_">this</span>.<span class="hljs-property">funcAbilityWant</span>.<span class="hljs-property">parameters</span>.<span class="hljs-property">router</span> === <span class="hljs-string">'funcA'</span>) {</li><li>      url = <span class="hljs-string">'pages/Page_ColdStartUp'</span>;</li><li>    }</li><li>
</li><li>    windowStage.<span class="hljs-title function_">loadContent</span>(url, <span class="hljs-function">(<span class="hljs-params">err, data</span>) =&gt;</span> {</li><li>      <span class="hljs-keyword">if</span> (err.<span class="hljs-property">code</span>) {</li><li>        <span class="hljs-keyword">return</span>;</li><li>      }</li><li>
</li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">windowClass</span>: <span class="hljs-variable language_">window</span>.<span class="hljs-property">Window</span>;</li><li>      windowStage.<span class="hljs-title function_">getMainWindow</span>(<span class="hljs-function">(<span class="hljs-params">err, data</span>) =&gt;</span> {</li><li>        <span class="hljs-keyword">if</span> (err.<span class="hljs-property">code</span>) {</li><li>          hilog.<span class="hljs-title function_">error</span>(<span class="hljs-variable constant_">DOMAIN_NUMBER</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">`Failed to obtain the main window. Code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>          <span class="hljs-keyword">return</span>;</li><li>        }</li><li>        windowClass = data;</li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">uiContext</span> = windowClass.<span class="hljs-title function_">getUIContext</span>();</li><li>      });</li><li>      hilog.<span class="hljs-title function_">info</span>(<span class="hljs-variable constant_">DOMAIN_NUMBER</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'Succeeded in loading the content. Data: %{public}s'</span>, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data) ?? <span class="hljs-string">''</span>);</li><li>    });</li><li>  }</li><li>}</li></ol></pre></div></div></li>      <li>       <p>在短信应用UIAbility的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability#onnewwant" target="_blank">onNewWant()</a>回调中通过AppStorage设置全局变量nameForNavi的值，并进行指定页面的跳转。此时再次启动该短信应用的UIAbility实例时，即可跳转到该短信应用的UIAbility实例的指定页面。</p>       <ol>        <li>         <p>导入相关模块，并在onNewWant()生命周期回调中设置全局变量nameForNavi的值。</p>         <div _ngcontent-iab-c106="" class="highlight-div"><div _ngcontent-iab-c106="" class="highlight-div-header"><div _ngcontent-iab-c106="" class="highlight-div-header-left"><div _ngcontent-iab-c106="" class="handle-button expand-button"><div _ngcontent-iab-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-iab-c106="" class="highlight-div-header-right"><div _ngcontent-iab-c106="" class="handle-button ai-button"></div><div _ngcontent-iab-c106="" class="handle-button line-button"><div _ngcontent-iab-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-iab-c106="" class="handle-button theme-button"><div _ngcontent-iab-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-iab-c106="" class="handle-button copy-button"><div _ngcontent-iab-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-iab-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AbilityConstant</span>, <span class="hljs-title class_">Want</span>, <span class="hljs-title class_">UIAbility</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li>
</li><li><span class="hljs-keyword">const</span> <span class="hljs-attr">DOMAIN_NUMBER</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0xFF00</span>;</li><li><span class="hljs-keyword">const</span> <span class="hljs-attr">TAG</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'[EntryAbility]'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-comment">// ...</span></li><li>  <span class="hljs-title function_">onNewWant</span>(<span class="hljs-attr">want</span>: <span class="hljs-title class_">Want</span>, <span class="hljs-attr">launchParam</span>: <span class="hljs-title class_">AbilityConstant</span>.   <span class="hljs-title class_">LaunchParam</span>): <span class="hljs-built_in">void</span> {</li><li>    hilog.<span class="hljs-title function_">info</span>(<span class="hljs-variable constant_">DOMAIN_NUMBER</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'%{public}s'</span>, <span class="hljs-string">'onNewWant'</span>);</li><li>    <span class="hljs-title class_">AppStorage</span>.<span class="hljs-property">setOrCreate</span>&lt;<span class="hljs-built_in">string</span>&gt;(<span class="hljs-string">'nameForNavi'</span>, <span class="hljs-string">'pageOne'</span>);</li><li>  }</li><li>}</li></ol></pre></div></div></li>        <li>         <p>在Index页面显示时触发onPageShow回调，获取全局变量nameForNavi的值，并进行执行页面的跳转。</p>         <div _ngcontent-iab-c106="" class="highlight-div"><div _ngcontent-iab-c106="" class="highlight-div-header"><div _ngcontent-iab-c106="" class="highlight-div-header-left"><div _ngcontent-iab-c106="" class="handle-button expand-button"><div _ngcontent-iab-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-iab-c106="" class="highlight-div-header-right"><div _ngcontent-iab-c106="" class="handle-button ai-button"></div><div _ngcontent-iab-c106="" class="handle-button line-button"><div _ngcontent-iab-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-iab-c106="" class="handle-button theme-button"><div _ngcontent-iab-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-iab-c106="" class="handle-button copy-button"><div _ngcontent-iab-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-iab-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// Index.ets</span></li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'Index'</span>;</li><li>  <span class="hljs-attr">pathStack</span>: <span class="hljs-title class_">NavPathStack</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">NavPathStack</span>();</li><li>
</li><li>  <span class="hljs-title function_">onPageShow</span>(): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-keyword">let</span> somePage = <span class="hljs-title class_">AppStorage</span>.<span class="hljs-property">get</span>&lt;<span class="hljs-built_in">string</span>&gt;(<span class="hljs-string">'nameForNavi'</span>)</li><li>    <span class="hljs-keyword">if</span> (somePage) {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">pathStack</span>.<span class="hljs-title function_">pushPath</span>({ <span class="hljs-attr">name</span>: somePage }, <span class="hljs-literal">false</span>);</li><li>      <span class="hljs-title class_">AppStorage</span>.<span class="hljs-title function_">delete</span>(<span class="hljs-string">'nameForNavi'</span>);</li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Navigation</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">pathStack</span>) {</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span>)</li><li>        .<span class="hljs-title function_">id</span>(<span class="hljs-string">'Index'</span>)</li><li>        .<span class="hljs-title function_">fontSize</span>($r(<span class="hljs-string">'app.float.page_text_font_size'</span>))</li><li>        .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)</li><li>        .<span class="hljs-title function_">alignRules</span>({</li><li>          <span class="hljs-attr">center</span>: { <span class="hljs-attr">anchor</span>: <span class="hljs-string">'__container__'</span>, <span class="hljs-attr">align</span>: <span class="hljs-title class_">VerticalAlign</span>.<span class="hljs-property">Center</span> },</li><li>          <span class="hljs-attr">middle</span>: { <span class="hljs-attr">anchor</span>: <span class="hljs-string">'__container__'</span>, <span class="hljs-attr">align</span>: <span class="hljs-title class_">HorizontalAlign</span>.<span class="hljs-property">Center</span> }</li><li>        })</li><li>    }</li><li>    .<span class="hljs-title function_">mode</span>(<span class="hljs-title class_">NavigationMode</span>.<span class="hljs-property">Stack</span>)</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    .<span class="hljs-title function_">margin</span>({<span class="hljs-attr">top</span>:<span class="hljs-number">250</span>})</li><li>  }</li><li>}</li></ol></pre></div></div></li>        <li>         <p>实现Navigation子页面。</p>         <div _ngcontent-iab-c106="" class="highlight-div"><div _ngcontent-iab-c106="" class="highlight-div-header"><div _ngcontent-iab-c106="" class="highlight-div-header-left"><div _ngcontent-iab-c106="" class="handle-button expand-button"><div _ngcontent-iab-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-iab-c106="" class="highlight-div-header-right"><div _ngcontent-iab-c106="" class="handle-button ai-button"></div><div _ngcontent-iab-c106="" class="handle-button line-button"><div _ngcontent-iab-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-iab-c106="" class="handle-button theme-button"><div _ngcontent-iab-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-iab-c106="" class="handle-button copy-button"><div _ngcontent-iab-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-iab-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// PageOne.ets</span></li><li><span class="hljs-meta">@Builder</span></li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">PageOneBuilder</span>(<span class="hljs-params"></span>) {</li><li>  <span class="hljs-title class_">PageOne</span>();</li><li>}</li><li>
</li><li><span class="hljs-meta">@Component</span></li><li><span class="hljs-keyword">export</span> struct <span class="hljs-title class_">PageOne</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'PageOne'</span>;</li><li>  <span class="hljs-attr">pathStack</span>: <span class="hljs-title class_">NavPathStack</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">NavPathStack</span>();</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">NavDestination</span>() {</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span>)</li><li>        .<span class="hljs-title function_">id</span>(<span class="hljs-string">'PageOne'</span>)</li><li>        .<span class="hljs-title function_">fontSize</span>($r(<span class="hljs-string">'app.float.page_text_font_size'</span>))</li><li>        .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)</li><li>        .<span class="hljs-title function_">alignRules</span>({</li><li>          <span class="hljs-attr">center</span>: { <span class="hljs-attr">anchor</span>: <span class="hljs-string">'__container__'</span>, <span class="hljs-attr">align</span>: <span class="hljs-title class_">VerticalAlign</span>.<span class="hljs-property">Center</span> },</li><li>          <span class="hljs-attr">middle</span>: { <span class="hljs-attr">anchor</span>: <span class="hljs-string">'__container__'</span>, <span class="hljs-attr">align</span>: <span class="hljs-title class_">HorizontalAlign</span>.<span class="hljs-property">Center</span> }</li><li>        })</li><li>    }</li><li>    .<span class="hljs-title function_">onReady</span>(<span class="hljs-function">(<span class="hljs-params">context: NavDestinationContext</span>) =&gt;</span> {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">pathStack</span> = context.<span class="hljs-property">pathStack</span>;</li><li>    })</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    .<span class="hljs-title function_">margin</span>({<span class="hljs-attr">top</span>:<span class="hljs-number">250</span>})</li><li>  }</li><li>}</li></ol></pre></div></div></li>        <li>         <p>在系统配置文件route_map.json中配置子页信息（参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-navigation-navigation#系统路由表">系统路由表</a>）。</p>         <div _ngcontent-iab-c106="" class="highlight-div"><div _ngcontent-iab-c106="" class="highlight-div-header"><div _ngcontent-iab-c106="" class="highlight-div-header-left"><div _ngcontent-iab-c106="" class="handle-button expand-button"><div _ngcontent-iab-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-iab-c106="" class="highlight-div-header-right"><div _ngcontent-iab-c106="" class="handle-button ai-button"></div><div _ngcontent-iab-c106="" class="handle-button line-button"><div _ngcontent-iab-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-iab-c106="" class="handle-button theme-button"><div _ngcontent-iab-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-iab-c106="" class="handle-button copy-button"><div _ngcontent-iab-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-iab-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// route_map.json</span></li><li>{</li><li>  <span class="hljs-string">"routerMap"</span>: [</li><li>    {</li><li>      <span class="hljs-string">"name"</span>: <span class="hljs-string">"pageOne"</span>,</li><li>      <span class="hljs-string">"pageSourceFile"</span>: <span class="hljs-string">"src/main/ets/pages/PageOne.ets"</span>,</li><li>      <span class="hljs-string">"buildFunction"</span>: <span class="hljs-string">"PageOneBuilder"</span>,</li><li>      <span class="hljs-string">"data"</span>: {</li><li>        <span class="hljs-string">"description"</span>: <span class="hljs-string">"this is pageOne"</span></li><li>      }</li><li>    }</li><li>  ]</li><li>}</li></ol></pre></div></div></li>        <li>         <p>在<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/module-configuration-file#routermap标签">module.json5配置文件</a>中配置routerMap路由映射。</p>         <div _ngcontent-iab-c106="" class="highlight-div"><div _ngcontent-iab-c106="" class="highlight-div-header"><div _ngcontent-iab-c106="" class="highlight-div-header-left"><div _ngcontent-iab-c106="" class="handle-button expand-button"><div _ngcontent-iab-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-iab-c106="" class="highlight-div-header-right"><div _ngcontent-iab-c106="" class="handle-button ai-button"></div><div _ngcontent-iab-c106="" class="handle-button line-button"><div _ngcontent-iab-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-iab-c106="" class="handle-button theme-button"><div _ngcontent-iab-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-iab-c106="" class="handle-button copy-button"><div _ngcontent-iab-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-iab-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// module.json5</span></li><li>{</li><li>  <span class="hljs-string">"module"</span>:{</li><li>    <span class="hljs-comment">// ...</span></li><li>    <span class="hljs-string">"routerMap"</span>: <span class="hljs-string">"$profile:route_map"</span>,</li><li>  }</li><li>}</li></ol></pre></div></div></li>       </ol></li>     </ol>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>当被调用方<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/uiability-launch-type">UIAbility组件启动模式</a>设置为multiton启动模式时，每次启动都会创建一个新的实例，那么onNewWant()回调就不会被用到。</p>      </div></div></div>    </div>   </div>   <div></div></div>