<h1 _ngcontent-clw-c119="" class="doc-title ng-star-inserted" title="商户基础支付场景"> 商户基础支付场景 </h1>

<div _ngcontent-clw-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <div class="tiledSection">     <h2 id="section1880231055910">场景介绍<i class="anchor-icon anchor-icon-link" anchorid="section1880231055910" tips="复制节点链接"></i></h2>          <p>从4.1.0(11)版本开始，新增支持商户基础支付场景。</p>     <p>例如用户出行需要提前预订酒店房间，此时用户可打开商户开发的APP应用/元服务，选好预订房间后发起支付，商户通过接入华为支付拉起华为支付收银台完成单个订单支付。</p>     <p>支持商户模型：直连商户、平台类商户、服务商</p>     <p>华为支付收银台展示：</p>     <div class="tablenoborder">      <div class="tbBox"><table style="border-style: none;" class="layoutFixed idpTab">               <tbody><tr>         <td align="center" class="nocellnorowborder" style="border: none;" valign="top" width="33.333333333333336%">          <p><span><img height="425.6" originheight="1026" originwidth="494" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114517.47162133928668806511227063981242:50001231000000:2800:068E1835EA9C79E67654F89FD8706F4CF7E365E428F11E421A779F1D84723A84.png" title="点击放大" width="204.91310000000001"></span></p></td>         <td align="center" class="nocellnorowborder" style="border: none;" valign="top" width="33.333333333333336%">          <p><span><img height="425.6" originheight="1026" originwidth="494" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114517.64955379675029761828156090038770:50001231000000:2800:988C5271479EBB90C98D99A3421EBECC61D71233773815C7A02C1931F11E787A.png" title="点击放大" width="204.91310000000001"></span></p></td>         <td align="center" class="cell-norowborder" style="border: none;" valign="top" width="33.333333333333336%">          <p><span><img height="425.6" originheight="1026" originwidth="494" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114517.88934263875509468701057052610476:50001231000000:2800:378807A0DD8242EB0B2E5859B17F14C69C6015A4927E18CAD7A9F629AA685B70.png" title="点击放大" width="204.91310000000001"></span></p></td>        </tr>        <tr>         <td align="center" class="row-nocellborder" style="border: none;" valign="top" width="33.333333333333336%">          <p>支付方式选择页面</p></td>         <td align="center" class="row-nocellborder" style="border: none;" valign="top" width="33.333333333333336%">          <p>支付页面</p></td>         <td align="center" class="cellrowborder" style="border: none;" valign="top" width="33.333333333333336%">          <p>支付结果展示页面</p></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="section1818915573916">业务流程<i class="anchor-icon anchor-icon-link" anchorid="section1818915573916" tips="复制节点链接"></i></h2>          <p>开发者通过接入Payment Kit基础支付，可以简便快捷的实现应用的支付能力。具体接入流程如下：</p>     <p><span><img height="532.041111111111" originheight="661" originwidth="1143" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114517.33675115108996901752888040442290:50001231000000:2800:71B99EECBE7FE1A710889422769A4C342EC1A0D7313325D3560E53C716B8C036.png" title="点击放大" width="920"></span></p>     <ol>      <li>商户客户端请求商户服务器创建商品订单。</li>      <li>商户服务器按照商户模型调用Payment Kit服务端<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-prepay" target="_blank">直连商户预下单</a>或<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-agent-prepay" target="_blank">平台类商户/服务商预下单</a>接口。</li>      <li>Payment Kit服务端返回预支付ID（prepayId）。</li>      <li>商户服务端组建订单信息参数<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-model#section159202591414" target="_blank">orderStr</a>返回给商户客户端。</li>      <li>商户客户端调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-paymentservice#section192192415554" target="_blank">requestPayment</a>接口拉起Payment Kit支付收银台。</li>      <li>Payment Kit客户端展示收银台。</li>      <li>用户通过收银台完成支付，Payment Kit客户端会收到支付结果信息并请求Payment Kit服务端处理支付。</li>      <li>Payment Kit服务端成功受理支付订单并异步处理支付。</li>      <li>Payment Kit服务端将支付结果返回给Payment Kit客户端。</li>      <li>Payment Kit客户端展示支付结果页。</li>      <li>用户关闭支付结果页后Payment Kit客户端会返回支付状态给商户客户端。</li>      <li>支付处理完成后，Payment Kit服务端会调用回调接口返回支付结果信息给商户服务端。</li>      <li>商户服务端收到支付结果回调响应后，使用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-rest-overview#section17670192215175" target="_blank">SM2验签方式</a>对支付结果进行验签。</li>     </ol>    </div>    <div class="tiledSection">     <h2 id="section5906121818412">接口说明<i class="anchor-icon anchor-icon-link" anchorid="section5906121818412" tips="复制节点链接"></i></h2>          <p>接口返回值有两种返回形式：Promise和AsyncCallback。Promise和AsyncCallback只是返回方式不一样，功能相同。具体API说明详见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-paymentservice" target="_blank">接口文档</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.3.3.1.3.1.1" valign="top" width="50%">          <p>接口名</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.3.3.1.3.1.2" valign="top" width="50%">          <p>描述</p></th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="50%">          <p>requestPayment(context:common.UIAbilityContext, orderStr: string): Promise&lt;void&gt;;</p></td>         <td class="cellrowborder" rowspan="2" valign="top" width="50%">          <p>拉起Payment Kit支付收银台。</p></td>        </tr>        <tr>         <td class="cellrowborder" valign="top">          <p>requestPayment(context:common.UIAbilityContext, orderStr: string, callback: AsyncCallback&lt;void&gt;): void;</p></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="section9187179113620">开发步骤<i class="anchor-icon anchor-icon-link" anchorid="section9187179113620" tips="复制节点链接"></i></h2>         </div>    <div class="tiledSection">     <h3 id="section126982401468" class="firsth2">预下单（服务器开发）<i class="anchor-icon anchor-icon-link" anchorid="section126982401468" tips="复制节点链接"></i></h3>          <ol>      <li>开发者按照商户模型调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-prepay" target="_blank">直连商户预下单</a>或<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-agent-prepay" target="_blank">平台类商户/服务商预下单</a>接口获取预支付ID（prepayId）。       <p>为保证支付订单的安全性和可靠性需要对请求body和请求头PayMercAuth对象内的入参排序拼接进行签名，可参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-rest-overview#section174821258151218" target="_blank">签名规则</a>。</p></li>      <li>构建订单信息参数<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-model#section159202591414" target="_blank">orderStr</a>。       <p>商户服务器需要将客户端支付接口入参orderStr签名后返回给客户端。</p>       <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">         <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-model#section159202591414" target="_blank">orderStr</a>中sign字段签名规则是将除sign外的参数都做排序拼接后再签名（参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-rest-overview#section174821258151218" target="_blank">签名规则</a>），签名值赋值给sign字段。</p>        </div></div></div>       <p>以下为开放API接口请求及orderStr构建<a href="https://gitcode.com/HarmonyOS_Samples/paymentkit-sample-code-serverdemo-java" target="_blank">示例代码</a>片段：</p>       <div _ngcontent-clw-c106="" class="highlight-div"><div _ngcontent-clw-c106="" class="highlight-div-header"><div _ngcontent-clw-c106="" class="highlight-div-header-left"><div _ngcontent-clw-c106="" class="handle-button expand-button"><div _ngcontent-clw-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-clw-c106="" class="highlight-div-header-right"><div _ngcontent-clw-c106="" class="handle-button ai-button"></div><div _ngcontent-clw-c106="" class="handle-button line-button"><div _ngcontent-clw-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-clw-c106="" class="handle-button theme-button"><div _ngcontent-clw-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-clw-c106="" class="handle-button copy-button"><div _ngcontent-clw-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-clw-c106="" class="highlight-scroll-div"><pre class="java prettyprint linenums hljs language-java" hw-language="java" data-highlighted="yes"><ol class="linenums"><li><span class=""><span class="hljs-keyword">import</span> </span>com.huawei.petalpay.paymentservice.apiservice.client.model.BaseGwRspWithSign;</li><li><span class=""><span class="hljs-keyword">import</span> </span>com.huawei.petalpay.paymentservice.apiservice.client.model.PreOrderCreateRequestV2;</li><li><span class=""><span class="hljs-keyword">import</span> </span>com.huawei.petalpay.paymentservice.apiservice.client.model.PreOrderCreateResponse;</li><li><span class=""><span class="hljs-keyword">import</span> </span>com.huawei.petalpay.paymentservice.apiservice.client.model.PreSignRequestV2;</li><li><span class=""><span class="hljs-keyword">import</span> </span>com.huawei.petalpay.paymentservice.apiservice.client.model.PreSignResponse;</li><li><span class=""><span class="hljs-keyword">import</span> </span>com.huawei.petalpay.paymentservice.core.client.DefaultPetalPayClient;</li><li><span class=""><span class="hljs-keyword">import</span> </span>com.huawei.petalpay.paymentservice.core.client.PetalPayClient;</li><li><span class=""><span class="hljs-keyword">import</span> </span>com.huawei.petalpay.paymentservice.example.common.CommonResponse;</li><li><span class=""><span class="hljs-keyword">import</span> </span>com.huawei.petalpay.paymentservice.example.common.MercConfigUtil;</li><li><span class=""><span class="hljs-keyword">import</span> </span>lombok.extern.slf4j.<span class="">Slf4j</span>;</li><li>
</li><li><span class=""><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> </span><span class="hljs-title class_">MercApiController</span> {</li><li>    <span class=""><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> </span><span class="hljs-type">PetalPayClient</span> <span class=""><span class="hljs-variable">payClient</span> </span><span class="hljs-operator">=</span> <span class=""><span class="hljs-keyword">new</span> </span><span class="hljs-title class_">DefaultPetalPayClient</span>(MercConfigUtil.getMercConfig());</li><li>    <span class=""><span class="hljs-comment">/**</span></span><span class="hljs-comment"></span></li><li><span class="hljs-comment"></span><span class=""><span class="hljs-comment">     * </span></span><span class=""><span class="hljs-comment">预下单接口调用</span></span><span class="hljs-comment"></span></li><li><span class="hljs-comment">     </span><span class=""><span class="hljs-comment">*/</span></span></li><li>    <span class=""><span class="hljs-keyword">public</span> </span>CommonResponse <span class=""><span class="hljs-title function_">aggrPreOrderForAppV2</span></span><span class="hljs-params">()</span> {</li><li>        <span class=""><span class="hljs-comment">// </span></span><span class=""><span class="hljs-comment">组装对象</span></span></li><li>        <span class="hljs-type">PreOrderCreateRequestV2</span> <span class="hljs-variable">preOrderReq</span> <span class="hljs-operator">=</span> getPreOrderCreateRequestV2();</li><li>        <span class="hljs-type">PreOrderCreateResponse</span> <span class="hljs-variable">response</span> <span class="hljs-operator">=</span> <span class=""><span class="hljs-literal">null</span></span>;</li><li>        <span class=""><span class="hljs-keyword">try</span> </span>{</li><li>            response = <span class="">payClient</span>.execute(<span class=""><span class="hljs-string">"POST"</span></span>, <span class=""><span class="hljs-string">"/api/v2/aggr/preorder/create/app"</span></span>, PreOrderCreateResponse.<span class="">class</span>,</li><li>                preOrderReq);</li><li>        } <span class=""><span class="hljs-keyword">catch</span> </span>(Exception e) {</li><li>            <span class=""><span class="hljs-comment">// </span></span><span class=""><span class="hljs-comment">todo </span></span><span class=""><span class="hljs-comment">异常处理</span></span></li><li>            <span class="">log</span>.error(<span class=""><span class="hljs-string">"request error "</span></span>, e);</li><li>            <span class=""><span class="hljs-keyword">return</span> </span>CommonResponse.buildErrorRsp(e.getMessage());</li><li>        }</li><li>        <span class=""><span class="hljs-keyword">if</span> </span>(!validResponse(response)) {</li><li>            <span class=""><span class="hljs-comment">// </span></span><span class=""><span class="hljs-comment">todo </span></span><span class=""><span class="hljs-comment">异常处理</span></span></li><li>            <span class="">log</span>.error(<span class=""><span class="hljs-string">"response is invalid "</span></span>, response);</li><li>            <span class=""><span class="hljs-keyword">return</span> </span>CommonResponse.buildFailRsp(response);</li><li>        }</li><li>        <span class=""><span class="hljs-keyword">return</span> </span>CommonResponse.buildSuccessRsp(<span class="">payClient</span>.buildOrderStr(response.getPrepayId()));</li><li>    }</li><li>    <span class=""><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">boolean</span> </span><span class=""><span class="hljs-title function_">validResponse</span></span><span class="hljs-params">(BaseGwRspWithSign rsp)</span> {</li><li>        <span class=""><span class="hljs-keyword">return</span> </span>rsp != <span class=""><span class="hljs-literal">null</span> </span>&amp;&amp; <span class=""><span class="hljs-string">"000000"</span></span>.equals(rsp.getResultCode());</li><li>    }</li><li>    <span class=""><span class="hljs-comment">/**</span></span><span class="hljs-comment"></span></li><li><span class="hljs-comment"></span><span class=""><span class="hljs-comment">     * </span></span><span class=""><span class="hljs-comment">预下单接口请求参数组装，商户请根据业务自行实现</span></span><span class="hljs-comment"></span></li><li><span class="hljs-comment">     </span><span class=""><span class="hljs-comment">*/</span></span></li><li>    <span class=""><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> </span>PreOrderCreateRequestV2 <span class=""><span class="hljs-title function_">getPreOrderCreateRequestV2</span></span><span class="hljs-params">()</span> {</li><li>        <span class=""><span class="hljs-keyword">return</span> </span>PreOrderCreateRequestV2.builder()</li><li>            .mercOrderNo(<span class=""><span class="hljs-string">"pay-example-"</span> </span>+ System.currentTimeMillis()) <span class=""><span class="hljs-comment">// </span></span><span class=""><span class="hljs-comment">每次订单号都要变，请将</span></span><span class=""><span class="hljs-comment">pay-example-</span></span><span class=""><span class="hljs-comment">修改为商户自己的订单前缀</span></span></li><li>            .appId(MercConfigUtil.<span class="">APP_ID</span>)  <span class=""><span class="hljs-comment">// appId</span></span><span class=""><span class="hljs-comment">，需要配置为与商户绑定的正确的</span></span><span class=""><span class="hljs-comment">appId</span></span></li><li>            .mercNo(MercConfigUtil.<span class="">MERC_NO</span>) <span class=""><span class="hljs-comment">// </span></span><span class=""><span class="hljs-comment">商户的商户号</span></span></li><li>            .tradeSummary(<span class=""><span class="hljs-string">"</span></span><span class=""><span class="hljs-string">请修改为对应的商品简称</span></span><span class=""><span class="hljs-string">"</span></span>) <span class=""><span class="hljs-comment">// </span></span><span class=""><span class="hljs-comment">请修改为商品简称</span></span></li><li>            .totalAmount(<span class=""><span class="hljs-number">2L</span></span>)</li><li>            .callbackUrl(<span class=""><span class="hljs-string">"https://www.xxxxxx.com/hw/pay/callback"</span></span>) <span class=""><span class="hljs-comment">// </span></span><span class=""><span class="hljs-comment">回调通知地址，通知</span></span><span class=""><span class="hljs-comment">URL</span></span><span class=""><span class="hljs-comment">必须为直接可访问的</span></span><span class=""><span class="hljs-comment">URL</span></span><span class=""><span class="hljs-comment">，要求为</span></span><span class=""><span class="hljs-comment">https</span></span><span class=""><span class="hljs-comment">地址。最大长度为</span></span><span class=""><span class="hljs-comment">512</span></span><span class=""><span class="hljs-comment">。请替换为格式正确的结果通知回调地址。</span></span></li><li>            .build();</li><li>    }</li><li>}</li></ol></pre></div></div></li>     </ol>    </div>    <div class="tiledSection">     <h3 id="section19371156173617">拉起华为支付收银台（端侧开发）<i class="anchor-icon anchor-icon-link" anchorid="section19371156173617" tips="复制节点链接"></i></h3>          <p>商户客户端使用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-model#section159202591414" target="_blank">orderStr</a>作为参数调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-paymentservice#section192192415554" target="_blank">requestPayment</a>接口拉起Payment Kit支付收银台。</p>     <div class="p">      当接口通过.then()方法返回时，则表示当前订单支付成功，通过.catch()方法返回表示订单支付失败。当此次请求有异常时，可通过<strong>error.code</strong>获取错误码，错误码相关信息请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-error-code" target="_blank">错误码</a>。示例代码如下：      <div _ngcontent-clw-c106="" class="highlight-div"><div _ngcontent-clw-c106="" class="highlight-div-header"><div _ngcontent-clw-c106="" class="highlight-div-header-left"><div _ngcontent-clw-c106="" class="handle-button expand-button"><div _ngcontent-clw-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-clw-c106="" class="highlight-div-header-right"><div _ngcontent-clw-c106="" class="handle-button ai-button"></div><div _ngcontent-clw-c106="" class="handle-button line-button"><div _ngcontent-clw-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-clw-c106="" class="handle-button theme-button"><div _ngcontent-clw-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-clw-c106="" class="handle-button copy-button"><div _ngcontent-clw-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-clw-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { paymentService } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PaymentKit'</span>;</li><li><span class="hljs-keyword">import</span> { common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-attr">context</span>: common.<span class="hljs-property">UIAbilityContext</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li>  <span class="hljs-title function_">requestPaymentPromise</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-comment">// use your own orderStr</span></li><li>    <span class="hljs-keyword">const</span> orderStr = <span class="hljs-string">'{"app_id":"***","merc_no":"***","prepay_id":"xxx","timestamp":"1680259863114","noncestr":"1487b8a60ed9f9ecc0ba759fbec23f4f","sign":"****","auth_id":"***"}'</span>;</li><li>    paymentService.<span class="hljs-title function_">requestPayment</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>, orderStr)</li><li>      .<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>        <span class="hljs-comment">// pay success</span></li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'succeeded in paying'</span>);</li><li>      })</li><li>      .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error: BusinessError</span>) =&gt;</span> {</li><li>        <span class="hljs-comment">// failed to pay</span></li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`failed to pay, error.code: <span class="hljs-subst">${error.code}</span>, error.message: <span class="hljs-subst">${error.message}</span>`</span>);</li><li>      });</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'requestPaymentPromise'</span>)</li><li>        .<span class="hljs-title function_">type</span>(<span class="hljs-title class_">ButtonType</span>.<span class="hljs-property">Capsule</span>)</li><li>        .<span class="hljs-title function_">width</span>(<span class="hljs-string">'50%'</span>)</li><li>        .<span class="hljs-title function_">margin</span>(<span class="hljs-number">20</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">requestPaymentPromise</span>();</li><li>        })</li><li>      }</li><li>    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div>     </div>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <ul>        <li>如果用户没有提前登录，系统会自动拉起华为账号登录页面让用户登录。</li>        <li>支付成功，不建议以客户端返回作为用户的支付结果，需以服务器接收到的结果通知或者查询API返回为准。</li>       </ul>      </div></div></div>    </div>    <div class="tiledSection">     <h3 id="section6767324125513">支付结果回调通知（服务器开发）<i class="anchor-icon anchor-icon-link" anchorid="section6767324125513" tips="复制节点链接"></i></h3>          <p>支付成功后华为支付服务器会调用开发者提供的回调接口，将支付信息返回给开发者的服务器，回调详细信息按商户模式请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-pay-notify" target="_blank">直连商户支付结果回调通知</a>或<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-agent-pay-notify" target="_blank">平台类商户/服务商支付结果回调通知</a>。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>回调接口是开发者调用预下单时的入参字段callbackUrl。</p>      </div></div></div>     <p>为保证信息合法性，商户服务器需要对返回的支付信息进行<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-rest-overview#section17670192215175" target="_blank">SM2验签</a>，验签注意事项：</p>     <ol>      <li>需直接使用通知的完整内容进行验签。</li>      <li>验签前需要对返回数据进行排序拼接，sign字段是签名值，排序拼接后的待验签内容需要排除sign字段。</li>      <li>验签公钥使用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/payment-certificates-config#section14253153941510">华为支付证书</a>。</li>     </ol>    </div>    <div class="tiledSection">     <h2 id="section2207214587">延伸和拓展<i class="anchor-icon anchor-icon-link" anchorid="section2207214587" tips="复制节点链接"></i></h2>          <p>当开发者完成上述能力之后还可以调用以下API接口完成订单相关操作。</p>    </div>    <div class="tiledSection">     <h3 id="section43419491135" class="firsth2">直连商户<i class="anchor-icon anchor-icon-link" anchorid="section43419491135" tips="复制节点链接"></i></h3>          <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-query-order" target="_blank">查询支付订单</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-service--refund" target="_blank">申请退款</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-query-refund" target="_blank">查询退款订单</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-query-trade-bill" target="_blank">查询对账单</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-query-settle-bill" target="_blank">查询结算账单</a>。</p>    </div>    <div class="tiledSection">     <h3 id="section99363593143">平台类商户/服务商<i class="anchor-icon anchor-icon-link" anchorid="section99363593143" tips="复制节点链接"></i></h3>          <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-agent-query-order" target="_blank">查询支付订单</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-agent-refund" target="_blank">申请退款</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-agentmerc-query-refund" target="_blank">查询退款订单</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-partner-agent-query-trade-bill" target="_blank">查询对账单</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-partner-agent-query-settle-bill" target="_blank">查询结算账单</a>。</p>    </div>   </div>   <div></div></div>