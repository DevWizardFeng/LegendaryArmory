<h1 _ngcontent-wpj-c119="" class="doc-title ng-star-inserted" title="回归测试"> 回归测试 </h1>

<div _ngcontent-wpj-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div id="body0000001771720462"><p id="ZH-CN_TOPIC_0000002473986458__p1296013380015"><span><img originheight="850" originwidth="1352" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251120201424.89196949103501314766553422915273:50001231000000:2800:2D8840BEA87BE9361F54F0E52F19520FC50653AAD1575A45B1746651CA917F83.png" title="点击放大" width="920" height="578.4023668639054"></span></p> <p id="ZH-CN_TOPIC_0000002473986458__p167493299416"></p> <div class="tiledSection"><h2 id="section12324184817324">回归测试<i class="anchor-icon anchor-icon-link" anchorid="section12324184817324" tips="复制节点链接"></i></h2></div> <p id="ZH-CN_TOPIC_0000002473986458__p1628902716014"><strong>回归测试：</strong>针对待测试应用的指定场景，支持通过构建自定义测试包，无需搭建环境即可执行测试用例。用例执行过程中提供实时投屏、步骤截图、步骤结果和测试用例执行日志展示，辅助开发者快速定位问题；此外，测试报告支持指标上报，辅助开发者了解应用的执行性能，助力开发者更高效地打造出高质量应用。</p> <p id="ZH-CN_TOPIC_0000002473986458__p108281227162414"><strong>测试包构建</strong></p> <p id="ZH-CN_TOPIC_0000002473986458__p1380511501244">回归测试的测试对象为应用的核心功能，用户可将应用核心功能的测试用例构建成多个可执行测试包，每个测试包中仅包含单个测试用例，便于观察到核心功能的每个小功能点的质量。</p> <p id="ZH-CN_TOPIC_0000002473986458__p208056509241">测试执行前需先构建测试包，用户利用python的setuptools工具在工程（测试工程构建参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/hypium-python-guidelines">应用UI测试（基于Python）</a>）根目录下构建setup-regression.py、MANIFEST.in文件，setup-regression.py文件中声明用例，MANIFEST.in文件中声明脚本执行过程中需要用到的aw包、config文件夹下的配置文件及其他的资源文件。</p> <p id="ZH-CN_TOPIC_0000002473986458__p38056504242">为方便用户构建测试包，DevEco Testing Hypium（PyCharm插件）已发布，用户可利用插件快速生成可执行测试包。具体操作步骤如下：</p> <p id="ZH-CN_TOPIC_0000002473986458__p48051850152412"><strong>步骤一：</strong>PyCharm中本地安装 DevEco Testing Hypium 插件，安装成功后重启IDE，导航栏中出现相关字样，即为安装成功。</p> <p id="ZH-CN_TOPIC_0000002473986458__p5805165082414"><strong>步骤二：</strong>新建hypium工程，编写用例。以下为示例工程目录：</p> <div _ngcontent-wpj-c106="" class="highlight-div"><div _ngcontent-wpj-c106="" class="highlight-div-header"><div _ngcontent-wpj-c106="" class="highlight-div-header-left"><div _ngcontent-wpj-c106="" class="handle-button expand-button"><div _ngcontent-wpj-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wpj-c106="" class="highlight-div-header-right"><div _ngcontent-wpj-c106="" class="handle-button ai-button"></div><div _ngcontent-wpj-c106="" class="handle-button line-button"><div _ngcontent-wpj-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wpj-c106="" class="handle-button theme-button"><div _ngcontent-wpj-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wpj-c106="" class="handle-button copy-button"><div _ngcontent-wpj-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wpj-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" id="ZH-CN_TOPIC_0000002473986458__screen19368133511251" data-highlighted="yes"><ol class="linenums"><li>HypiumTest</li><li> |     |----aw                                       <span class="hljs-comment">// 工程中自定义模块文件夹</span></li><li> |     |     |----Utils.py                         <span class="hljs-comment">// 示例模块文件</span></li><li> |     |----config                                  <span class="hljs-comment">// 测试工程配置文件夹</span></li><li> |     |     |----user_config.xml             <span class="hljs-comment">// 测试工程配置文件，主要是测试框架的任务配置</span></li><li> |     |----resource                              <span class="hljs-comment">// 测试资源文件夹，测试过程中用到的资源文件默认会优先从当前文件夹进行查找</span></li><li>|     |    |----images            <span class="hljs-comment">// 资源文件子目录</span></li><li>|     |    |    |----icon_mms.png   <span class="hljs-comment">// 资源文件，以png图片为例</span></li><li> |     |----testcases                             <span class="hljs-comment">// 测试用例文件夹，测试过程中的测试用例文件优先会从当前文件夹进行查找</span></li><li> |     |    |----Example.json                  <span class="hljs-comment">// Example测试用例配置文件，配置用例设备信息等</span></li><li> |     |    |----Example.py                     <span class="hljs-comment">// Example测试用例文件，实际的测试逻辑代码</span></li></ol></pre></div></div> <div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content"><p id="ZH-CN_TOPIC_0000002473986458__p176631610152615">在用例脚本中，请导入并使用hypium.advance.deveco_testing.step中的Step方法标记步骤(from hypium.advance.deveco_testing.step import Step)，否则回归测试过程中无法正确读取到测试步骤，并导致指标监控为空。</p> </div></div></div> <p id="ZH-CN_TOPIC_0000002473986458__p848062416267"><strong>步骤三：</strong>在工程根目录下创建setup-regression.py文件和MANIFEST.in文件（用户本地环境需预先安装setuptools模块），参考python的setuptools用法编写setup-regression.py，示例如下：</p> <div _ngcontent-wpj-c106="" class="highlight-div"><div _ngcontent-wpj-c106="" class="highlight-div-header"><div _ngcontent-wpj-c106="" class="highlight-div-header-left"><div _ngcontent-wpj-c106="" class="handle-button expand-button"><div _ngcontent-wpj-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wpj-c106="" class="highlight-div-header-right"><div _ngcontent-wpj-c106="" class="handle-button ai-button"></div><div _ngcontent-wpj-c106="" class="handle-button line-button"><div _ngcontent-wpj-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wpj-c106="" class="handle-button theme-button"><div _ngcontent-wpj-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wpj-c106="" class="handle-button copy-button"><div _ngcontent-wpj-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wpj-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-python" id="ZH-CN_TOPIC_0000002473986458__screen857613513272" data-highlighted="yes"><ol class="linenums"><li><span class=""><span class="hljs-keyword">from</span> </span><span class="">setuptools </span><span class=""><span class="hljs-keyword">import</span> </span><span class="">setup </span></li><li>
</li><li><span class=""> setup(</span></li><li>       <span class="">name</span><span class="">=</span><span class=""><span class="hljs-string">'hypiumTest'</span></span><span class="">,</span></li><li>       <span class="">version</span><span class="">=</span><span class=""><span class="hljs-string">'1.0.0.0'</span></span><span class="">,</span></li><li>       <span class="">author</span><span class="">=</span><span class=""><span class="hljs-string">'xxx'</span></span><span class="">,</span></li><li>       <span class=""><span class="hljs-comment"># py_modules</span></span><span class=""><span class="hljs-comment">指定需要打包的hypium用例py文件</span></span></li><li>       <span class="">py_modules</span><span class="">=[</span><span class=""><span class="hljs-string">'testcases.Example'</span></span><span class="">]</span><span class="">,</span></li><li>       <span class="">include_package_data</span><span class="">=</span><span class=""><span class="hljs-literal">True</span></span></li><li>       <span class="">)</span></li></ol></pre></div></div> <div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content"><p id="ZH-CN_TOPIC_0000002473986458__p10459151423610">回归测试生成的可执行测试包中仅支持单用例（即单个json文件和json中指定的用例文件），编写setup-regression.py时需注意写法，否则会打包失败。</p> </div></div></div> <p id="ZH-CN_TOPIC_0000002473986458__p174809248261">通过MANIFEST.in文件指定需要一起打包的文件，示例如下：</p> <div _ngcontent-wpj-c106="" class="highlight-div"><div _ngcontent-wpj-c106="" class="highlight-div-header"><div _ngcontent-wpj-c106="" class="highlight-div-header-left"><div _ngcontent-wpj-c106="" class="handle-button expand-button"><div _ngcontent-wpj-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wpj-c106="" class="highlight-div-header-right"><div _ngcontent-wpj-c106="" class="handle-button ai-button"></div><div _ngcontent-wpj-c106="" class="handle-button line-button"><div _ngcontent-wpj-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wpj-c106="" class="handle-button theme-button"><div _ngcontent-wpj-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wpj-c106="" class="handle-button copy-button"><div _ngcontent-wpj-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wpj-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-makefile" id="ZH-CN_TOPIC_0000002473986458__screen1215340172618" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment"># 与打包用例对应的json文件</span></li><li> <span class="hljs-keyword">include</span> testcases/Example.json</li><li><span class="hljs-comment"># 用例依赖的aw</span></li><li><span class="hljs-keyword">include</span> aw/*.py</li><li><span class="hljs-comment"># 用例中用到的各类配置文件</span></li><li><span class="hljs-keyword">include</span> config/*.xml</li><li> <span class="hljs-keyword">include</span> config/*.json</li><li> <span class="hljs-keyword">include</span> config/*.txt</li><li><span class="hljs-comment"># 用例中用到的resource</span></li><li><span class="hljs-keyword">include</span> resource/*</li><li><span class="hljs-keyword">include</span> resource/images/*</li></ol></pre></div></div> <div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content"><p id="ZH-CN_TOPIC_0000002473986458__p1158458183020">一定要确保用例所需要的 aw 和配置文件及其他资源全部都写到 MANIFEST.in 中，否则用例包无法正常执行。</p> </div></div></div> <p id="ZH-CN_TOPIC_0000002473986458__p14817244268"><strong>步骤四：</strong>在根目录下右键选择“DevEco Testing Hypium”-“生成测试服务包”，出现下图弹窗，选择“回归测试”，用户需填写待测试应用的名称及测试场景，信息填写完毕后点击“OK”即可在指定目录下查看测试包。</p> <p id="ZH-CN_TOPIC_0000002473986458__p12481024192613"><span><img originheight="240" originwidth="546" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251120201424.09423110188726555186237563993809:50001231000000:2800:711EDE8CB3B8C15A891FAACCCDA4F0A8DB57C471BE0204D1ADE41385C456DFBD.png" width="546" height="240"></span></p> <p id="ZH-CN_TOPIC_0000002473986458__p1948113243262"><span><img originheight="375" originwidth="591" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251120201424.03736630739768924370933565758087:50001231000000:2800:1C46F1B94E31C1D858AD29C065FF0BA068F87E02F20CF05624726A8290A3918F.png" title="点击放大" width="591" height="375"></span></p> <p id="ZH-CN_TOPIC_0000002473986458__p548152472615">生成回归测试测试包，打包好的测试包支持在回归测试服务中本地执行。</p> <p id="ZH-CN_TOPIC_0000002473986458__p286041211289"></p> <p id="ZH-CN_TOPIC_0000002473986458__p6498020079"><strong>创建任务</strong></p> <p id="ZH-CN_TOPIC_0000002473986458__p18289227809">进入DevEco Testing客户端，在左侧菜单栏选择“回归测试”，点击“回归测试”服务卡片，即进入任务创建界面。按需配置任务参数，点击创建任务即开始测试。</p> <p id="ZH-CN_TOPIC_0000002473986458__p3699194617012"><span><img originheight="446" originwidth="787" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251120201424.47949536697143510156877395879074:50001231000000:2800:1829BF11975E0AA8E641C8CBE1E40ACBA6B6B2074A17901B05CF02100986997E.png" title="点击放大" width="787" height="446"></span></p> <p id="ZH-CN_TOPIC_0000002473986458__p06331593211">配置服务参数：</p> <p id="ZH-CN_TOPIC_0000002473986458__p4637153329">任务名称：用于标识任务，系统会根据时间生成默认任务名，支持自定义修改。</p> <p id="ZH-CN_TOPIC_0000002473986458__p91236511349">备注信息：按需填写任务备注信息，便于快速筛选报告。</p> <p id="ZH-CN_TOPIC_0000002473986458__p1563615183216">测试设备：选择一个待测设备。系统版本支持 HarmonyOS 5.0及以上版本。</p> <p id="ZH-CN_TOPIC_0000002473986458__p2632155322">测试包路径：选择待测测试包，服务将对测试包中指定应用进行解析，并执行测试包中测试用例。</p> <p id="ZH-CN_TOPIC_0000002473986458__p82261632193219"><strong>测试包详情：</strong></p> <p id="ZH-CN_TOPIC_0000002473986458__p44471132163217"><span><img originheight="838" originwidth="1143" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251120201424.72152869623341451671643276892901:50001231000000:2800:4B7786BB1BEEFF69BFCD41F085B38487F514E3F9D2D7CE4E8DF5061FAAC380AB.jpg" title="点击放大" width="920" height="674.5056867891514"></span></p> <p id="ZH-CN_TOPIC_0000002473986458__p15199131214332">点击查看测试包详情，即可查看测试包基本信息。</p> <p id="ZH-CN_TOPIC_0000002473986458__p02001312123311">参数配置完成后，点击“创建任务”即开始测试。</p> <p id="ZH-CN_TOPIC_0000002473986458__p13612591328"></p> <p id="ZH-CN_TOPIC_0000002473986458__p1244472310710"><strong>测试执行</strong></p> <p id="ZH-CN_TOPIC_0000002473986458__p1612922616333">任务创建后即进入测试执行页面，测试过程中，在测试页面可以看到设备实时投屏、设备截图、测试步骤结果上报以及指标数据上报。执行过程中如果脚本执行失败，任务会立刻停止，生成的报告中仅包含任务失败前的数据信息。手动停止查看报告时，报告中仅包含报告停止前的数据信息。</p> <p id="ZH-CN_TOPIC_0000002473986458__p17781181116"><span><img originheight="838" originwidth="1143" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251120201424.73532095267289617172928395163463:50001231000000:2800:6E053BA0FA584A214324F7450D2D0D4F673FE5957EDFA9548D59CB6D40EAFD97.jpg" title="点击放大" width="920" height="674.5056867891514"></span></p> <p id="ZH-CN_TOPIC_0000002473986458__p5661144613336"></p> <p id="ZH-CN_TOPIC_0000002473986458__p107856251875"><strong>查看报告</strong></p> <p id="ZH-CN_TOPIC_0000002473986458__p82126372">测试完成后，将自动跳转到报告界面。</p> <p id="ZH-CN_TOPIC_0000002473986458__p121914233710"><span><img originheight="763" originwidth="1117" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251120201424.93564626888082022518472594925476:50001231000000:2800:5BD8C0DFEFC081AE622B58F906959426ACD7EBC3475E6B159AE6CB4EC39EB586.png" title="点击放大" width="920" height="628.433303491495"></span></p> <p id="ZH-CN_TOPIC_0000002473986458__p1546962113418">任务信息：在报告的最上方可查看本次任务的应用信息，运行时间，环境参数和执行日志，点击“打开目录”按钮，可以导出html格式的报告文件。</p> <p id="ZH-CN_TOPIC_0000002473986458__p154696210344">应用信息：基于测试包中指定的待测试应用获取设备上该应用的包名、版本、API版本。</p> <p id="ZH-CN_TOPIC_0000002473986458__p2560454153714">环境参数：展示测试设备信息和参数配置。</p> <p id="ZH-CN_TOPIC_0000002473986458__p1446982163419">测试结论：本次测试任务的执行结果。</p> <p id="ZH-CN_TOPIC_0000002473986458__p134707211340">上报指标：本次任务执行过程中CPU平均使用率、内存平均使用率以及用户在脚本中自定义指标上报，目前不支持自定义指标更新操作，若多次上报同一个指标，仅展示最后一次的指标上报结果。</p> <p id="ZH-CN_TOPIC_0000002473986458__p14701229345">测试截图&amp;CPU使用率：该部分展示了任务执行过程中CPU使用率、内存使用的变化情况，同时移动指针可查看当前时间对应的截图（并非每一秒均存在截图）。</p> <p id="ZH-CN_TOPIC_0000002473986458__p847012193418">执行步骤&amp;执行日志：该部分展示了测试用例执行的所有测试步骤、每一步的执行结果以及用例的执行日志，若某一步执行失败，则后续步骤不再执行。点击每一步，CPU使用率统计图中将会展示出该步骤执行过程中的CPU使用情况，同时该步骤对应的执行日志将会高亮显示。</p> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p id="ZH-CN_TOPIC_0000002473986458__p3729427143410">更多测试服务详情，请前往DevEco Testing客户端 -&gt; 回归测试 -&gt; 回归测试 -&gt; 任务创建页 -&gt; 测试指南中查询。</p> </div></div></div> <p id="ZH-CN_TOPIC_0000002473986458__p1828117181119"></p> </div> <div></div></div>