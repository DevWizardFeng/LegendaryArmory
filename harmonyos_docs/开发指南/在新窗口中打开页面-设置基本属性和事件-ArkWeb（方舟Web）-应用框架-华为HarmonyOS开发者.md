<h1 _ngcontent-uje-c119="" class="doc-title ng-star-inserted" title="在新窗口中打开页面"> 在新窗口中打开页面 </h1>

<div _ngcontent-uje-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p>Web组件提供了在新窗口打开页面的能力，开发者可以通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-basic-components-web-attributes#multiwindowaccess9" target="_blank">multiWindowAccess()</a>接口来设置是否允许网页在新窗口打开。当有新窗口打开时，应用侧会在<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-basic-components-web-events#onwindownew9" target="_blank">onWindowNew()</a>接口中收到Web组件新窗口事件。开发者需要在此接口事件中新建窗口来处理Web组件的窗口请求。</p>    <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">      <ul>       <li>        <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-basic-components-web-attributes#allowwindowopenmethod10" target="_blank">allowWindowOpenMethod()</a>接口设置为true时，前端页面通过JavaScript函数调用的方式打开新窗口。</p></li>       <li>        <p>当在Web页面调用window.open(url, name)打开新窗口时，ArkWeb内核会根据name查找是否存在已绑定的Web组件。若存在，该Web组件将收到<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-basic-components-web-events#onactivatecontent20" target="_blank">onActivateContent()</a>接口通知，以便应用可将其展示至前台；若不存在，ArkWeb内核将通过onWindowNew()接口通知应用创建新窗口。</p></li>       <li>        <p>如果在onWindowNew()接口通知中创建了新窗口，并将ControllerHandler.setWebController()接口的参数设置为新Web组件的WebviewController，则ArkWeb内核会完成name与该新Web组件的绑定。</p></li>       <li>        <p>如果在onWindowNew()接口通知中没有创建新窗口，需要将ControllerHandler.setWebController()接口的参数设置为null。</p></li>      </ul>     </div></div></div>    <p>在下面的本地示例中，当用户点击“新窗口中打开网页”按钮时，应用会在onWindowNew()接口收到Web组件的新窗口事件。</p>    <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">      <ul>       <li>网页要求用户创建新的窗口时触发回调<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-basic-components-web-i#onwindownewevent12" target="_blank">OnWindowNewEvent()</a>，该回调函数中isUserTrigger参数，true代表用户触发，false代表非用户触发。</li>      </ul>     </div></div></div>    <ul>     <li>      <p>应用侧代码。</p>      <div _ngcontent-uje-c106="" class="highlight-div"><div _ngcontent-uje-c106="" class="highlight-div-header"><div _ngcontent-uje-c106="" class="highlight-div-header-left"><div _ngcontent-uje-c106="" class="handle-button expand-button"><div _ngcontent-uje-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-uje-c106="" class="highlight-div-header-right"><div _ngcontent-uje-c106="" class="handle-button ai-button"></div><div _ngcontent-uje-c106="" class="handle-button line-button"><div _ngcontent-uje-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-uje-c106="" class="handle-button theme-button"><div _ngcontent-uje-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-uje-c106="" class="handle-button copy-button"><div _ngcontent-uje-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-uje-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// xxx.ets</span></li><li><span class="hljs-keyword">import</span> { webview } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkWeb'</span>;</li><li>
</li><li><span class="hljs-comment">// 在同一界面有两个Web组件。在WebComponent新开窗口时，会跳转到NewWebViewComp。</span></li><li><span class="hljs-meta">@CustomDialog</span></li><li>struct <span class="hljs-title class_">NewWebViewComp</span> {</li><li>  controller?: <span class="hljs-title class_">CustomDialogController</span>;</li><li>  <span class="hljs-attr">webviewController1</span>: webview.<span class="hljs-property">WebviewController</span> = <span class="hljs-keyword">new</span> webview.<span class="hljs-title class_">WebviewController</span>();</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Web</span>({ <span class="hljs-attr">src</span>: <span class="hljs-string">""</span>, <span class="hljs-attr">controller</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">webviewController1</span> })</li><li>        .<span class="hljs-title function_">javaScriptAccess</span>(<span class="hljs-literal">true</span>)</li><li>        .<span class="hljs-title function_">multiWindowAccess</span>(<span class="hljs-literal">false</span>)</li><li>        .<span class="hljs-title function_">onWindowExit</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"NewWebViewComp onWindowExit"</span>);</li><li>          <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span>) {</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span>.<span class="hljs-title function_">close</span>();</li><li>          }</li><li>        })</li><li>        .<span class="hljs-title function_">onActivateContent</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-comment">//该Web需要展示到前台，建议应用在这里进行tab或window切换的动作</span></li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"NewWebViewComp onActivateContent"</span>)</li><li>        })</li><li>    }</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">WebComponent</span> {</li><li>  <span class="hljs-attr">controller</span>: webview.<span class="hljs-property">WebviewController</span> = <span class="hljs-keyword">new</span> webview.<span class="hljs-title class_">WebviewController</span>();</li><li>  <span class="hljs-attr">dialogController</span>: <span class="hljs-title class_">CustomDialogController</span> | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Web</span>({ <span class="hljs-attr">src</span>: $rawfile(<span class="hljs-string">"window.html"</span>), <span class="hljs-attr">controller</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span> })</li><li>        .<span class="hljs-title function_">javaScriptAccess</span>(<span class="hljs-literal">true</span>)</li><li>          <span class="hljs-comment">// 需要使能multiWindowAccess</span></li><li>        .<span class="hljs-title function_">multiWindowAccess</span>(<span class="hljs-literal">true</span>)</li><li>        .<span class="hljs-title function_">allowWindowOpenMethod</span>(<span class="hljs-literal">true</span>)</li><li>        .<span class="hljs-title function_">onWindowNew</span>(<span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {</li><li>          <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">dialogController</span>) {</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">dialogController</span>.<span class="hljs-title function_">close</span>()</li><li>          }</li><li>          <span class="hljs-keyword">let</span> <span class="hljs-attr">popController</span>: webview.<span class="hljs-property">WebviewController</span> = <span class="hljs-keyword">new</span> webview.<span class="hljs-title class_">WebviewController</span>();</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">dialogController</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">CustomDialogController</span>({</li><li>            <span class="hljs-attr">builder</span>: <span class="hljs-title class_">NewWebViewComp</span>({ <span class="hljs-attr">webviewController1</span>: popController }),</li><li>            <span class="hljs-comment">// isModal设置为false，防止新窗口被销毁而无法触发onActivateContent回调</span></li><li>            <span class="hljs-attr">isModal</span>: <span class="hljs-literal">false</span></li><li>          })</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">dialogController</span>.<span class="hljs-title function_">open</span>();</li><li>          <span class="hljs-comment">// 将新窗口对应WebviewController返回给Web内核。</span></li><li>          <span class="hljs-comment">// 若不调用event.handler.setWebController接口，会造成render进程阻塞。</span></li><li>          <span class="hljs-comment">// 如果没有创建新窗口，调用event.handler.setWebController接口时设置成null，通知Web没有创建新窗口。</span></li><li>          event.<span class="hljs-property">handler</span>.<span class="hljs-title function_">setWebController</span>(popController);</li><li>        })</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div></li>     <li>      <p>window.html页面代码。</p>      <div _ngcontent-uje-c106="" class="highlight-div"><div _ngcontent-uje-c106="" class="highlight-div-header"><div _ngcontent-uje-c106="" class="highlight-div-header-left"><div _ngcontent-uje-c106="" class="handle-button expand-button"><div _ngcontent-uje-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-uje-c106="" class="highlight-div-header-right"><div _ngcontent-uje-c106="" class="handle-button ai-button"></div><div _ngcontent-uje-c106="" class="handle-button line-button"><div _ngcontent-uje-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-uje-c106="" class="handle-button theme-button"><div _ngcontent-uje-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-uje-c106="" class="handle-button copy-button"><div _ngcontent-uje-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-uje-c106="" class="highlight-scroll-div"><pre class="html prettyprint linenums hljs language-xml" hw-language="html" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span></li><li><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span></li><li><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span></li><li>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width"</span>/&gt;</span></li><li>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>WindowEvent<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span></li><li><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span></li><li><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span></li><li><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"button"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"新窗口中打开网页"</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">"OpenNewWindow()"</span>&gt;</span></li><li><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;</span><span class="language-javascript"></span></li><li><span class="language-javascript">    <span class="hljs-keyword">function</span> <span class="hljs-title function_">OpenNewWindow</span>(<span class="hljs-params"></span>)</span></li><li><span class="language-javascript">    {</span></li><li><span class="language-javascript">        <span class="hljs-keyword">var</span> txt = <span class="hljs-string">'打开的窗口'</span>;</span></li><li><span class="language-javascript">        <span class="hljs-keyword">let</span> openedWindow = <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">open</span>(<span class="hljs-string">"about:blank"</span>, <span class="hljs-string">""</span>, <span class="hljs-string">"location=no,status=no,scrollbars=no"</span>);</span></li><li><span class="language-javascript">        openedWindow.<span class="hljs-property">document</span>.<span class="hljs-title function_">write</span>(<span class="hljs-string">"&lt;p&gt;"</span> + <span class="hljs-string">"&lt;br&gt;&lt;br&gt;"</span> + txt + <span class="hljs-string">"&lt;/p&gt;"</span>);</span></li><li><span class="language-javascript">        openedWindow.<span class="hljs-title function_">focus</span>();</span></li><li><span class="language-javascript">    }</span></li><li><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></li><li><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></li><li><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></li></ol></pre></div></div></li>    </ul>    <p><strong>图1</strong> 新窗口中打开页面效果图</p>    <p><span><img originheight="243" originwidth="441" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114738.19881071742874196710979222734701:50001231000000:2800:6E0862F6B8E1E5057A66F38038BB5688151F26CE374B54AACF56342137B037BF.png" width="441" height="243"></span></p>   </div>   <div></div></div>