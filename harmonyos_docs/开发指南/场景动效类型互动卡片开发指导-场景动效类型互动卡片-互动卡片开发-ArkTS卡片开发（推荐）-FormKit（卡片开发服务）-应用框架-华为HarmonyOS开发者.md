<h1 _ngcontent-spe-c119="" class="doc-title ng-star-inserted" title="场景动效类型互动卡片开发指导"> 场景动效类型互动卡片开发指导 </h1>

<div _ngcontent-spe-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p>本文档提供了场景动效类型互动卡片的开发指导，包括卡片非激活态和激活态UI界面开发、卡片配置文件开发。</p>    <div class="tiledSection">     <h2 id="接口说明">接口说明<i class="anchor-icon anchor-icon-link" anchorid="接口说明" tips="复制节点链接"></i></h2>          <p>场景动效类型互动卡片关键接口如下表所示。</p>     <p><strong>表1</strong> 主要接口</p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.2.4.1.3.1.1" valign="top" width="50%">接口名</th>         <th align="left" class="cellrowborder" id="mcps1.3.2.4.1.3.1.2" valign="top" width="50%">描述</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-form-liveformextensionability#onliveformcreate" target="_blank">onLiveFormCreate(liveFormInfo: LiveFormInfo, session: UIExtensionContentSession): void</a></td>         <td class="cellrowborder" valign="top" width="50%">互动卡片界面对象创建的回调函数。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-form-liveformextensionability#onliveformdestroy" target="_blank">onLiveFormDestroy(liveFormInfo: LiveFormInfo): void</a></td>         <td class="cellrowborder" valign="top" width="50%">互动卡片界面对象销毁、资源清理的回调函数。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-application-liveformextensioncontext#startabilitybyliveform" target="_blank">startAbilityByLiveForm(want: Want): Promise&lt;void&gt;</a></td>         <td class="cellrowborder" valign="top" width="50%">拉起互动卡片提供方（应用）的页面。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-form-formprovider#formproviderrequestoverflow20" target="_blank">formProvider.requestOverflow(formId: string, overflowInfo: formInfo.OverflowInfo): Promise&lt;void&gt;</a></td>         <td class="cellrowborder" valign="top" width="50%">卡片提供方发起互动卡片动效请求。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-form-formprovider#formprovidercanceloverflow20" target="_blank">formProvider.cancelOverflow(formId: string): Promise&lt;void&gt;</a></td>         <td class="cellrowborder" valign="top" width="50%">卡片提供方发起取消互动卡片动效请求。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-form-formprovider#formprovidergetformrect20" target="_blank">formProvider.getFormRect(formId: string): Promise&lt;formInfo.Rect&gt;</a></td>         <td class="cellrowborder" valign="top" width="50%">卡片提供方查询卡片位置、尺寸。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="开发流程">开发流程<i class="anchor-icon anchor-icon-link" anchorid="开发流程" tips="复制节点链接"></i></h2>         </div>    <div class="tiledSection">     <h3 id="卡片激活态ui开发" class="firsth2">卡片激活态UI开发<i class="anchor-icon anchor-icon-link" anchorid="卡片激活态ui开发" tips="复制节点链接"></i></h3>          <ol>      <li>       <p>创建互动卡片</p>       <p>通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-form-liveformextensionability" target="_blank">LiveFormExtensionAbility</a>创建互动卡片，创建时加载互动卡片页面。</p>       <div _ngcontent-spe-c106="" class="highlight-div"><div _ngcontent-spe-c106="" class="highlight-div-header"><div _ngcontent-spe-c106="" class="highlight-div-header-left"><div _ngcontent-spe-c106="" class="handle-button expand-button"><div _ngcontent-spe-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-spe-c106="" class="highlight-div-header-right"><div _ngcontent-spe-c106="" class="handle-button ai-button"></div><div _ngcontent-spe-c106="" class="handle-button line-button"><div _ngcontent-spe-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-spe-c106="" class="handle-button theme-button"><div _ngcontent-spe-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-spe-c106="" class="handle-button copy-button"><div _ngcontent-spe-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-spe-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// entry/src/main/ets/myliveformextensionability/MyLiveFormExtensionAbility.ets</span></li><li><span class="hljs-keyword">import</span> { formInfo, <span class="hljs-title class_">LiveFormInfo</span>, <span class="hljs-title class_">LiveFormExtensionAbility</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.FormKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIExtensionContentSession</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyLiveFormExtensionAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">LiveFormExtensionAbility</span> {</li><li>  <span class="hljs-title function_">onLiveFormCreate</span>(<span class="hljs-params">liveFormInfo: LiveFormInfo, session: UIExtensionContentSession</span>) {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">storage</span>: <span class="hljs-title class_">LocalStorage</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LocalStorage</span>();</li><li>    storage.<span class="hljs-title function_">setOrCreate</span>(<span class="hljs-string">'context'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>);</li><li>    storage.<span class="hljs-title function_">setOrCreate</span>(<span class="hljs-string">'session'</span>, session);</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">formId</span>: <span class="hljs-built_in">string</span> = liveFormInfo.<span class="hljs-property">formId</span>;</li><li>    storage.<span class="hljs-title function_">setOrCreate</span>(<span class="hljs-string">'formId'</span>, formId);</li><li>
</li><li>    <span class="hljs-comment">// 获取卡片圆角信息</span></li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">borderRadius</span>: <span class="hljs-built_in">number</span> = liveFormInfo.<span class="hljs-property">borderRadius</span>;</li><li>    storage.<span class="hljs-title function_">setOrCreate</span>(<span class="hljs-string">'borderRadius'</span>, borderRadius);</li><li>
</li><li>    <span class="hljs-comment">// liveFormInfo.rect字段表示非激活态卡片组件相对激活态UI的位置和尺寸信息</span></li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">formRect</span>: formInfo.<span class="hljs-property">Rect</span> = liveFormInfo.<span class="hljs-property">rect</span>;</li><li>    storage.<span class="hljs-title function_">setOrCreate</span>(<span class="hljs-string">'formRect'</span>, formRect);</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`MyLiveFormExtensionAbility onSessionCreate formId: <span class="hljs-subst">${formId}</span>`</span> +</li><li>      <span class="hljs-string">`, borderRadius: <span class="hljs-subst">${borderRadius}</span>, formRectInfo: <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(formRect)}</span>`</span>);</li><li>
</li><li>    <span class="hljs-comment">// 加载互动页面</span></li><li>    session.<span class="hljs-title function_">loadContent</span>(<span class="hljs-string">'myliveformextensionability/pages/MyLiveFormPage'</span>, storage);</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">onLiveFormDestroy</span>(<span class="hljs-params">liveFormInfo: LiveFormInfo</span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`MyLiveFormExtensionAbility onDestroy`</span>);</li><li>  }</li><li>};</li></ol></pre></div></div></li>      <li>       <p>实现互动卡片页面</p>       <div _ngcontent-spe-c106="" class="highlight-div"><div _ngcontent-spe-c106="" class="highlight-div-header"><div _ngcontent-spe-c106="" class="highlight-div-header-left"><div _ngcontent-spe-c106="" class="handle-button expand-button"><div _ngcontent-spe-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-spe-c106="" class="highlight-div-header-right"><div _ngcontent-spe-c106="" class="handle-button ai-button"></div><div _ngcontent-spe-c106="" class="handle-button line-button"><div _ngcontent-spe-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-spe-c106="" class="handle-button theme-button"><div _ngcontent-spe-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-spe-c106="" class="handle-button copy-button"><div _ngcontent-spe-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-spe-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// entry/src/main/ets/myliveformextensionability/pages/MyLiveFormPage.ets</span></li><li><span class="hljs-keyword">import</span> { formInfo, formProvider } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.FormKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-comment">// LiveFormExtensionContext导入编译器会标红，但是可以正常编译运行。</span></li><li><span class="hljs-keyword">import</span> <span class="hljs-title class_">LiveFormExtensionContext</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'application/LiveFormExtensionContext'</span>;</li><li><span class="hljs-comment">// Constants实现参考“互动卡片动效工具函数实现”小节</span></li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Constants</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../../common/Constants'</span>;</li><li>
</li><li><span class="hljs-keyword">const</span> <span class="hljs-attr">ANIMATION_RECT_SIZE</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">100</span>;</li><li><span class="hljs-keyword">const</span> <span class="hljs-attr">END_SCALE</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">1.5</span>;</li><li><span class="hljs-keyword">const</span> <span class="hljs-attr">END_TRANSLATE</span>: <span class="hljs-built_in">number</span> = -<span class="hljs-number">300</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">MyLiveFormPage</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">columnScale</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">1.0</span>;</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">columnTranslate</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0.0</span>;</li><li>
</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">uiContext</span>: <span class="hljs-title class_">UIContext</span> | <span class="hljs-literal">undefined</span> = <span class="hljs-literal">undefined</span>;</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">storageForMyLiveFormPage</span>: <span class="hljs-title class_">LocalStorage</span> | <span class="hljs-literal">undefined</span> = <span class="hljs-literal">undefined</span>;</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">formId</span>: <span class="hljs-built_in">string</span> | <span class="hljs-literal">undefined</span> = <span class="hljs-literal">undefined</span>;</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">formRect</span>: formInfo.<span class="hljs-property">Rect</span> | <span class="hljs-literal">undefined</span> = <span class="hljs-literal">undefined</span>;</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">formBorderRadius</span>: <span class="hljs-built_in">number</span> | <span class="hljs-literal">undefined</span> = <span class="hljs-literal">undefined</span>;</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">liveFormContext</span>: <span class="hljs-title class_">LiveFormExtensionContext</span> | <span class="hljs-literal">undefined</span> = <span class="hljs-literal">undefined</span>;</li><li>
</li><li>  <span class="hljs-title function_">aboutToAppear</span>(): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">uiContext</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>();</li><li>    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">uiContext</span>) {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">"no uiContext"</span>);</li><li>      <span class="hljs-keyword">return</span>;</li><li>    }</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">initParams</span>();</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-title function_">initParams</span>(): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">storageForMyLiveFormPage</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">uiContext</span>?.<span class="hljs-title function_">getSharedLocalStorage</span>();</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">formId</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">storageForMyLiveFormPage</span>?.<span class="hljs-property">get</span>&lt;<span class="hljs-built_in">string</span>&gt;(<span class="hljs-string">'formId'</span>);</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">formRect</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">storageForMyLiveFormPage</span>?.<span class="hljs-property">get</span>&lt;formInfo.<span class="hljs-property">Rect</span>&gt;(<span class="hljs-string">'formRect'</span>);</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">formBorderRadius</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">storageForMyLiveFormPage</span>?.<span class="hljs-property">get</span>&lt;<span class="hljs-built_in">number</span>&gt;(<span class="hljs-string">'borderRadius'</span>);</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">liveFormContext</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">storageForMyLiveFormPage</span>?.<span class="hljs-property">get</span>&lt;<span class="hljs-title class_">LiveFormExtensionContext</span>&gt;(<span class="hljs-string">'context'</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-comment">// 执行动效</span></li><li>  <span class="hljs-keyword">private</span> <span class="hljs-title function_">runAnimation</span>(): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">uiContext</span>?.<span class="hljs-title function_">animateTo</span>({</li><li>      <span class="hljs-attr">duration</span>: <span class="hljs-title class_">Constants</span>.<span class="hljs-property">OVERFLOW_DURATION</span>,</li><li>      <span class="hljs-attr">curve</span>: <span class="hljs-title class_">Curve</span>.<span class="hljs-property">Ease</span></li><li>    }, <span class="hljs-function">() =&gt;</span> {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">columnScale</span> = <span class="hljs-variable constant_">END_SCALE</span>;</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">columnTranslate</span> = <span class="hljs-variable constant_">END_TRANSLATE</span>;</li><li>    });</li><li>  }</li><li>
</li><li>   <span class="hljs-keyword">private</span> <span class="hljs-title function_">startAbilityByLiveForm</span>(): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-comment">// 请开发者替换为实际的want信息</span></li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">liveFormContext</span>?.<span class="hljs-title function_">startAbilityByLiveForm</span>({</li><li>        <span class="hljs-attr">bundleName</span>: <span class="hljs-string">'com.example.liveformdemo'</span>,</li><li>        <span class="hljs-attr">abilityName</span>: <span class="hljs-string">'EntryAbility'</span>,</li><li>      })</li><li>        .<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'startAbilityByLiveForm succeed'</span>);</li><li>        })</li><li>        .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`startAbilityByLiveForm failed, code is <span class="hljs-subst">${err?.code}</span>, message is <span class="hljs-subst">${err?.message}</span>`</span>);</li><li>        });</li><li>    } <span class="hljs-keyword">catch</span> (e) {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`startAbilityByLiveForm failed, code is <span class="hljs-subst">${e?.code}</span>, message is <span class="hljs-subst">${e?.message}</span>`</span>);</li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Stack</span>({<span class="hljs-attr">alignContent</span>: <span class="hljs-title class_">Alignment</span>.<span class="hljs-property">TopStart</span>}) {</li><li>      <span class="hljs-comment">// 背景组件，和普通卡片等大</span></li><li>      <span class="hljs-title class_">Column</span>()</li><li>        .<span class="hljs-title function_">width</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">formRect</span>? <span class="hljs-variable language_">this</span>.<span class="hljs-property">formRect</span>.<span class="hljs-property">width</span> : <span class="hljs-number">0</span>)</li><li>        .<span class="hljs-title function_">height</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">formRect</span>? <span class="hljs-variable language_">this</span>.<span class="hljs-property">formRect</span>.<span class="hljs-property">height</span> : <span class="hljs-number">0</span>)</li><li>        .<span class="hljs-title function_">offset</span>({</li><li>          <span class="hljs-attr">x</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">formRect</span>? <span class="hljs-variable language_">this</span>.<span class="hljs-property">formRect</span>.<span class="hljs-property">left</span> : <span class="hljs-number">0</span>,</li><li>          <span class="hljs-attr">y</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">formRect</span>? <span class="hljs-variable language_">this</span>.<span class="hljs-property">formRect</span>.<span class="hljs-property">top</span> : <span class="hljs-number">0</span>,</li><li>        })</li><li>        .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">formBorderRadius</span> ? <span class="hljs-variable language_">this</span>.<span class="hljs-property">formBorderRadius</span> : <span class="hljs-number">0</span>)</li><li>        .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">'#2875F5'</span>)</li><li>      <span class="hljs-title class_">Stack</span>() {</li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">buildContent</span>();</li><li>      }</li><li>      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>      .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>    }</li><li>    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>    .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'MyLiveFormPage click to start ability'</span>);</li><li>      <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">liveFormContext</span>) {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'MyLiveFormPage liveFormContext is empty'</span>);</li><li>        <span class="hljs-keyword">return</span>;</li><li>      }</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">startAbilityByLiveForm</span>();</li><li>    })</li><li>  }</li><li>
</li><li>  <span class="hljs-meta">@Builder</span></li><li>  <span class="hljs-title function_">buildContent</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Stack</span>()</li><li>      .<span class="hljs-title function_">width</span>(<span class="hljs-variable constant_">ANIMATION_RECT_SIZE</span>)</li><li>      .<span class="hljs-title function_">height</span>(<span class="hljs-variable constant_">ANIMATION_RECT_SIZE</span>)</li><li>      .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">White</span>)</li><li>      .<span class="hljs-title function_">scale</span>({</li><li>        <span class="hljs-attr">x</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">columnScale</span>,</li><li>        <span class="hljs-attr">y</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">columnScale</span>,</li><li>      })</li><li>      .<span class="hljs-title function_">translate</span>({</li><li>        <span class="hljs-attr">y</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">columnTranslate</span></li><li>      })</li><li>      .<span class="hljs-title function_">onAppear</span>(<span class="hljs-function">() =&gt;</span> {</li><li>        <span class="hljs-comment">// 在页面出现时执行动效</span></li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">runAnimation</span>();</li><li>      })</li><li>
</li><li>    <span class="hljs-title class_">Button</span>(<span class="hljs-string">'强制取消动效'</span>)</li><li>      .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Grey</span>)</li><li>      .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>        <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">formId</span>) {</li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'MyLiveFormPage formId is empty, cancel overflow failed'</span>);</li><li>          <span class="hljs-keyword">return</span>;</li><li>        }</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'MyLiveFormPage cancel overflow animation'</span>);</li><li>        formProvider.<span class="hljs-title function_">cancelOverflow</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">formId</span>);</li><li>      })</li><li>  }</li><li>}</li></ol></pre></div></div></li>      <li>       <p>互动卡片LiveFormExtensionAbility配置</p>       <p>在module.json5配置文件中<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/module-configuration-file#extensionabilities标签">extensionAbilities标签</a>下配置LiveFormExtensionAbility。</p>       <div _ngcontent-spe-c106="" class="highlight-div"><div _ngcontent-spe-c106="" class="highlight-div-header"><div _ngcontent-spe-c106="" class="highlight-div-header-left"><div _ngcontent-spe-c106="" class="handle-button expand-button"><div _ngcontent-spe-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-spe-c106="" class="highlight-div-header-right"><div _ngcontent-spe-c106="" class="handle-button ai-button"></div><div _ngcontent-spe-c106="" class="handle-button line-button"><div _ngcontent-spe-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-spe-c106="" class="handle-button theme-button"><div _ngcontent-spe-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-spe-c106="" class="handle-button copy-button"><div _ngcontent-spe-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-spe-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// entry/src/main/module.json5</span></li><li>    ...</li><li>    <span class="hljs-string">"extensionAbilities"</span>: [</li><li>      {</li><li>        <span class="hljs-string">"name"</span>: <span class="hljs-string">"MyLiveFormExtensionAbility"</span>,</li><li>        <span class="hljs-string">"srcEntry"</span>: <span class="hljs-string">"./ets/myliveformextensionability/MyLiveFormExtensionAbility.ets"</span>,</li><li>        <span class="hljs-string">"description"</span>: <span class="hljs-string">"MyLiveFormExtensionAbility"</span>,</li><li>        <span class="hljs-string">"type"</span>: <span class="hljs-string">"liveForm"</span></li><li>      }</li><li>    ]</li><li>    ...</li></ol></pre></div></div>       <p>在main_pages.json文件中声明互动卡片页面。</p>       <div _ngcontent-spe-c106="" class="highlight-div"><div _ngcontent-spe-c106="" class="highlight-div-header"><div _ngcontent-spe-c106="" class="highlight-div-header-left"><div _ngcontent-spe-c106="" class="handle-button expand-button"><div _ngcontent-spe-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-spe-c106="" class="highlight-div-header-right"><div _ngcontent-spe-c106="" class="handle-button ai-button"></div><div _ngcontent-spe-c106="" class="handle-button line-button"><div _ngcontent-spe-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-spe-c106="" class="handle-button theme-button"><div _ngcontent-spe-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-spe-c106="" class="handle-button copy-button"><div _ngcontent-spe-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-spe-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// entry/src/main/resources/base/profile/main_pages.json</span></li><li>{</li><li>  <span class="hljs-string">"src"</span>: [</li><li>    <span class="hljs-string">"pages/Index"</span>,</li><li>    <span class="hljs-string">"myliveformextensionability/pages/MyLiveFormPage"</span></li><li>  ]</li><li>}</li></ol></pre></div></div></li>     </ol>    </div>    <div class="tiledSection">     <h3 id="卡片非激活态ui开发">卡片非激活态UI开发<i class="anchor-icon anchor-icon-link" anchorid="卡片非激活态ui开发" tips="复制节点链接"></i></h3>          <ol>      <li>       <p>非激活态卡片页面实现</p>       <p>非激活态卡片页面开发同普通卡片开发流程完全一致，在widgetCard.ets中完成。widgetCard.ets文件在卡片创建时自动生成，卡片创建流程可以参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-ui-widget-creation">创建ArkTS卡片</a>。在非激活态卡片页面实现点击卡片时，发起卡片动效请求。</p>       <div _ngcontent-spe-c106="" class="highlight-div"><div _ngcontent-spe-c106="" class="highlight-div-header"><div _ngcontent-spe-c106="" class="highlight-div-header-left"><div _ngcontent-spe-c106="" class="handle-button expand-button"><div _ngcontent-spe-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-spe-c106="" class="highlight-div-header-right"><div _ngcontent-spe-c106="" class="handle-button ai-button"></div><div _ngcontent-spe-c106="" class="handle-button line-button"><div _ngcontent-spe-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-spe-c106="" class="handle-button theme-button"><div _ngcontent-spe-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-spe-c106="" class="handle-button copy-button"><div _ngcontent-spe-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-spe-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// entry/src/main/ets/widget/pages/WidgetCard.ets</span></li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">WidgetCard</span> {</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Row</span>() {</li><li>      <span class="hljs-title class_">Column</span>() {</li><li>        <span class="hljs-title class_">Text</span>(<span class="hljs-string">'点击触发互动卡片动效'</span>)</li><li>          .<span class="hljs-title function_">fontSize</span>($r(<span class="hljs-string">'app.float.font_size'</span>))</li><li>          .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Medium</span>)</li><li>          .<span class="hljs-title function_">fontColor</span>($r(<span class="hljs-string">'sys.color.font_primary'</span>))</li><li>      }</li><li>      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    }</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>    .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>      <span class="hljs-comment">// 点击卡片时，选择向EntryFormAbility发送消息，并在其onFormEvent回调中调用formProvider.requestOverflow，请求卡片动效</span></li><li>      <span class="hljs-title function_">postCardAction</span>(<span class="hljs-variable language_">this</span>, {</li><li>        <span class="hljs-attr">action</span>: <span class="hljs-string">'message'</span>,</li><li>        <span class="hljs-attr">abilityName</span>: <span class="hljs-string">'EntryFormAbility'</span>,</li><li>        <span class="hljs-attr">params</span>: {</li><li>          <span class="hljs-attr">message</span>: <span class="hljs-string">'requestOverflow'</span></li><li>        }</li><li>      });</li><li>    })</li><li>  }</li><li>}</li></ol></pre></div></div></li>      <li>       <p>form_config.json配置</p>       <p>在form_config.json配置文件中新增sceneAnimationParams配置项。</p>       <div _ngcontent-spe-c106="" class="highlight-div"><div _ngcontent-spe-c106="" class="highlight-div-header"><div _ngcontent-spe-c106="" class="highlight-div-header-left"><div _ngcontent-spe-c106="" class="handle-button expand-button"><div _ngcontent-spe-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-spe-c106="" class="highlight-div-header-right"><div _ngcontent-spe-c106="" class="handle-button ai-button"></div><div _ngcontent-spe-c106="" class="handle-button line-button"><div _ngcontent-spe-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-spe-c106="" class="handle-button theme-button"><div _ngcontent-spe-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-spe-c106="" class="handle-button copy-button"><div _ngcontent-spe-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-spe-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// entry/src/main/resources/base/profile/form_config.json</span></li><li>{</li><li>  <span class="hljs-string">"forms"</span>: [</li><li>    {</li><li>      <span class="hljs-string">"name"</span>: <span class="hljs-string">"widget"</span>,</li><li>      <span class="hljs-string">"displayName"</span>: <span class="hljs-string">"$string:widget_display_name"</span>,</li><li>      <span class="hljs-string">"description"</span>: <span class="hljs-string">"$string:widget_desc"</span>,</li><li>      <span class="hljs-string">"src"</span>: <span class="hljs-string">"./ets/widget/pages/WidgetCard.ets"</span>,</li><li>      <span class="hljs-string">"uiSyntax"</span>: <span class="hljs-string">"arkts"</span>,</li><li>      <span class="hljs-string">"window"</span>: {</li><li>        <span class="hljs-string">"designWidth"</span>: <span class="hljs-number">720</span>,</li><li>        <span class="hljs-string">"autoDesignWidth"</span>: <span class="hljs-literal">true</span></li><li>      },</li><li>      <span class="hljs-string">"colorMode"</span>: <span class="hljs-string">"auto"</span>,</li><li>      <span class="hljs-string">"isDefault"</span>: <span class="hljs-literal">true</span>,</li><li>      <span class="hljs-string">"updateEnabled"</span>: <span class="hljs-literal">true</span>,</li><li>      <span class="hljs-string">"scheduledUpdateTime"</span>: <span class="hljs-string">"10:30"</span>,</li><li>      <span class="hljs-string">"updateDuration"</span>: <span class="hljs-number">1</span>,</li><li>      <span class="hljs-string">"defaultDimension"</span>: <span class="hljs-string">"2*2"</span>,</li><li>      <span class="hljs-string">"supportDimensions"</span>: [</li><li>        <span class="hljs-string">"2*2"</span></li><li>      ],</li><li>      <span class="hljs-string">"formConfigAbility"</span>: <span class="hljs-string">"ability://EntryAbility"</span>,</li><li>      <span class="hljs-string">"dataProxyEnabled"</span>: <span class="hljs-literal">false</span>,</li><li>      <span class="hljs-string">"isDynamic"</span>: <span class="hljs-literal">true</span>,</li><li>      <span class="hljs-string">"transparencyEnabled"</span>: <span class="hljs-literal">false</span>,</li><li>      <span class="hljs-string">"metadata"</span>: [],</li><li>      <span class="hljs-string">"sceneAnimationParams"</span>: {</li><li>        <span class="hljs-string">"abilityName"</span>: <span class="hljs-string">"MyLiveFormExtensionAbility"</span></li><li>      }</li><li>    }</li><li>  ]</li><li>}</li></ol></pre></div></div></li>     </ol>    </div>    <div class="tiledSection">     <h3 id="互动卡片动效实现">互动卡片动效实现<i class="anchor-icon anchor-icon-link" anchorid="互动卡片动效实现" tips="复制节点链接"></i></h3>          <ol>      <li>       <p>触发互动卡片动效</p>       <p>互动卡片通过调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-form-formprovider#formproviderrequestoverflow20" target="_blank">formProvider.requestOverflow</a>接口触发动效，调用时需要明确：（1）动效申请范围。（2）动效持续时间。（3）是否使用系统提供的默认切换动效。具体可参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-form-forminfo#overflowinfo20" target="_blank">formInfo.OverflowInfo</a>。其中，互动卡片可以通过调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-form-formprovider#formprovidergetformrect20" target="_blank">formProvider.getFormRect</a>接口获取卡片尺寸和在窗口内的位置信息。卡片提供方以此计算动效申请范围，单位为vp。计算规则具体请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-ui-liveform-sceneanimation-overview#请求参数约束">互动卡片请求参数约束</a>。</p>       <div _ngcontent-spe-c106="" class="highlight-div"><div _ngcontent-spe-c106="" class="highlight-div-header"><div _ngcontent-spe-c106="" class="highlight-div-header-left"><div _ngcontent-spe-c106="" class="handle-button expand-button"><div _ngcontent-spe-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-spe-c106="" class="highlight-div-header-right"><div _ngcontent-spe-c106="" class="handle-button ai-button"></div><div _ngcontent-spe-c106="" class="handle-button line-button"><div _ngcontent-spe-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-spe-c106="" class="handle-button theme-button"><div _ngcontent-spe-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-spe-c106="" class="handle-button copy-button"><div _ngcontent-spe-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-spe-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// entry/src/main/ets/entryformability/EntryFormAbility.ets</span></li><li><span class="hljs-keyword">import</span> {</li><li>  formInfo,</li><li>  formProvider,</li><li>  <span class="hljs-title class_">FormExtensionAbility</span>,</li><li>} <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.FormKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-comment">// Constants实现参考“互动卡片动效工具函数实现”小节</span></li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Constants</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../common/Constants'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryFormAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">FormExtensionAbility</span> {</li><li>  <span class="hljs-keyword">async</span> <span class="hljs-title function_">onFormEvent</span>(<span class="hljs-params">formId: <span class="hljs-built_in">string</span>, message: <span class="hljs-built_in">string</span></span>) {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">shortMessage</span>: <span class="hljs-built_in">string</span> = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(message)[<span class="hljs-string">'message'</span>];</li><li>
</li><li>    <span class="hljs-comment">// 当接收的 message 为 requestOverflow，触发互动卡片动效</span></li><li>    <span class="hljs-keyword">if</span> (shortMessage === <span class="hljs-string">'requestOverflow'</span>) {</li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">formRect</span>: formInfo.<span class="hljs-property">Rect</span> = <span class="hljs-keyword">await</span> formProvider.<span class="hljs-title function_">getFormRect</span>(formId);</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">requestOverflow</span>(formId, formRect.<span class="hljs-property">width</span>, formRect.<span class="hljs-property">height</span>);</li><li>      <span class="hljs-keyword">return</span>;</li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-title function_">requestOverflow</span>(<span class="hljs-attr">formId</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">formWidth</span>: <span class="hljs-built_in">number</span>, <span class="hljs-attr">formHeight</span>: <span class="hljs-built_in">number</span>): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-keyword">if</span> (formWidth &lt;= <span class="hljs-number">0</span> || formHeight &lt;= <span class="hljs-number">0</span>) {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'requestOverflow failed, form size is not correct.'</span>);</li><li>      <span class="hljs-keyword">return</span>;</li><li>    }</li><li>
</li><li>    <span class="hljs-comment">// 基于卡片自身尺寸信息，计算卡片动效渲染区域</span></li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">left</span>: <span class="hljs-built_in">number</span> = -<span class="hljs-title class_">Constants</span>.<span class="hljs-property">OVERFLOW_LEFT_RATIO</span> * formWidth;</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">top</span>: <span class="hljs-built_in">number</span> = -<span class="hljs-title class_">Constants</span>.<span class="hljs-property">OVERFLOW_TOP_RATIO</span> * formHeight;</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">width</span>: <span class="hljs-built_in">number</span> = <span class="hljs-title class_">Constants</span>.<span class="hljs-property">OVERFLOW_WIDTH_RATIO</span> * formWidth;</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">height</span>: <span class="hljs-built_in">number</span> = <span class="hljs-title class_">Constants</span>.<span class="hljs-property">OVERFLOW_HEIGHT_RATIO</span> * formHeight;</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">duration</span>: <span class="hljs-built_in">number</span> = <span class="hljs-title class_">Constants</span>.<span class="hljs-property">OVERFLOW_DURATION</span>;</li><li>
</li><li>    <span class="hljs-comment">// 发起互动卡片动效申请</span></li><li>    <span class="hljs-keyword">try</span> {</li><li>      formProvider.<span class="hljs-title function_">requestOverflow</span>(formId, {</li><li>        <span class="hljs-comment">// 动效申请范围</span></li><li>        <span class="hljs-attr">area</span>: { <span class="hljs-attr">left</span>: left, <span class="hljs-attr">top</span>: top, <span class="hljs-attr">width</span>: width, <span class="hljs-attr">height</span>: height },</li><li>        <span class="hljs-comment">// 动效持续时间</span></li><li>        <span class="hljs-attr">duration</span>: duration,</li><li>        <span class="hljs-comment">// 指定是否使用系统提供的默认切换动效</span></li><li>        <span class="hljs-attr">useDefaultAnimation</span>: <span class="hljs-literal">true</span>,</li><li>      }).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'requestOverflow requestOverflow succeed'</span>);</li><li>      }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error: BusinessError</span>) =&gt;</span> {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`requestOverflow requestOverflow catch error`</span> + <span class="hljs-string">`, code: <span class="hljs-subst">${error.code}</span>, message: <span class="hljs-subst">${error.message}</span>`</span>);</li><li>      })</li><li>    } <span class="hljs-keyword">catch</span> (e) {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`requestOverflow call requestOverflow catch error`</span> + <span class="hljs-string">`, code: <span class="hljs-subst">${e.code}</span>, message: <span class="hljs-subst">${e.message}</span>`</span>);</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div></li>      <li>       <p>互动卡片动效工具函数实现</p>       <div _ngcontent-spe-c106="" class="highlight-div"><div _ngcontent-spe-c106="" class="highlight-div-header"><div _ngcontent-spe-c106="" class="highlight-div-header-left"><div _ngcontent-spe-c106="" class="handle-button expand-button"><div _ngcontent-spe-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-spe-c106="" class="highlight-div-header-right"><div _ngcontent-spe-c106="" class="handle-button ai-button"></div><div _ngcontent-spe-c106="" class="handle-button line-button"><div _ngcontent-spe-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-spe-c106="" class="handle-button theme-button"><div _ngcontent-spe-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-spe-c106="" class="handle-button copy-button"><div _ngcontent-spe-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-spe-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// entry/src/main/ets/common/Constants.ets</span></li><li><span class="hljs-comment">// 动效相关常量的开发</span></li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Constants</span> {</li><li>  <span class="hljs-comment">// 互动卡片动效超范围，左侧偏移百分比 = 偏移值/卡片宽度</span></li><li>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">readonly</span> <span class="hljs-attr">OVERFLOW_LEFT_RATIO</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0.1</span>;</li><li>
</li><li>  <span class="hljs-comment">// 互动卡片动效超范围，上侧偏移百分比 = 偏移值/卡片高度</span></li><li>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">readonly</span> <span class="hljs-attr">OVERFLOW_TOP_RATIO</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0.15</span>;</li><li>
</li><li>  <span class="hljs-comment">// 互动卡片动效超范围，宽度放大百分比</span></li><li>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">readonly</span> <span class="hljs-attr">OVERFLOW_WIDTH_RATIO</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">1.2</span>;</li><li>
</li><li>  <span class="hljs-comment">// 互动卡片动效超范围，高度放大百分比</span></li><li>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">readonly</span> <span class="hljs-attr">OVERFLOW_HEIGHT_RATIO</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">1.3</span>;</li><li>
</li><li>  <span class="hljs-comment">// 互动卡片动效超范围，动效时长</span></li><li>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">readonly</span> <span class="hljs-attr">OVERFLOW_DURATION</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">3500</span>;</li><li>}</li></ol></pre></div></div></li>     </ol>    </div>    <div class="tiledSection">     <h2 id="实现效果">实现效果<i class="anchor-icon anchor-icon-link" anchorid="实现效果" tips="复制节点链接"></i></h2>          <p>以下是按照本文档代码示例开发而成的效果demo，demo执行动效时，点击按钮，将调用 <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-form-formprovider#formprovidercanceloverflow20" target="_blank">formProvider.cancelOverflow</a> 接口，打断当前破框动效，卡片切换为非激活态。</p>     <p><span><img originheight="343" originwidth="357" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114919.04348075751580266778787429035708:50001231000000:2800:A92361B53D55E3C8B0929B963F9229CCE67F0779AB6F52810964E7E8EF1F0F88.gif" width="357" height="343"></span></p>    </div>   </div>   <div></div></div>