<h1 _ngcontent-tjm-c119="" class="doc-title ng-star-inserted" title="场景动效类型互动卡片概述"> 场景动效类型互动卡片概述 </h1>

<div _ngcontent-tjm-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p>场景动效类型互动卡片支持在特定场景下触发互动卡片的特有效果。例如，开发者可以选择将动效渲染区域扩展到卡片自身的渲染区域之外，营造“破框”效果。</p>    <div class="tiledSection">     <h2 id="基本概念">基本概念<i class="anchor-icon anchor-icon-link" anchorid="基本概念" tips="复制节点链接"></i></h2>          <p>场景动效类型互动卡片主要包含两个状态：激活态和非激活态。卡片生命周期中的事件，如数据定时或定点刷新、用户点击等交互场景，可触发卡片动效，使卡片切换至激活态。动效结束后，卡片切回非激活态。</p>     <p><strong>非激活态</strong>：在此状态下，卡片与普通卡片行为无异，遵循既有的卡片开发规范，卡片UI由卡片提供方widgetCard.ets中的内容所承载。</p>     <p><strong>激活态</strong>： 表示互动卡片动效渲染状态，在此状态下，卡片UI由卡片提供方所开发的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-form-liveformextensionability" target="_blank">LiveFormExtensionAbility</a>对应page页面完成渲染。详细可参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-ui-liveform-sceneanimation-development">场景动效类型互动卡片开发指导</a>。</p>     <p><strong>图1</strong> 互动卡片状态切换说明</p>     <p><span><img originheight="337" originwidth="750" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114907.84337027016664276580669448862612:50001231000000:2800:A6ECF8A8AD317F60C153F77556D84CB202366B726C8D153C7C2C0447C62A7678.png" width="750" height="337"></span></p>     <p><strong>图2</strong> 互动卡片动效触发流程</p>     <p><span><img originheight="231" originwidth="750" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114907.05436510373760615539384136789380:50001231000000:2800:77AF892CFD5171478A5888A0EA80BEA531D4C5DA391B3B82E56D699EE0E645F4.png" width="750" height="231"></span></p>    </div>    <div class="tiledSection">     <h2 id="实现原理">实现原理<i class="anchor-icon anchor-icon-link" anchorid="实现原理" tips="复制节点链接"></i></h2>          <p>开发者可以通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-form-formprovider#formproviderrequestoverflow20" target="_blank">formProvider.requestOverflow</a>接口触发互动卡片动效，例如在用户点击时触发，典型时序图如下。</p>     <p><strong>图3</strong> 点击触发互动卡片动效时序图</p>     <p><span><img originheight="307" originwidth="787" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114907.37926800842808178774135449453125:50001231000000:2800:A8F83AB268930B78B395BD33E1023D8BAF5C73CF162C5075377C9415A69B59FD.png" width="787" height="307"></span></p>     <p>定时定点刷新互动卡片动效的时序图如下。</p>     <p><strong>图4</strong> 定时定点触发互动卡片动效时序图</p>     <p><span><img originheight="322" originwidth="660" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114907.01763602971927846922596307606054:50001231000000:2800:CDAA8FC841FF9EE8D77FDF110F8800BF0BCC4E1203A0346B2F26A56311AB7D52.png" width="660" height="322"></span></p>    </div>    <div class="tiledSection">     <h2 id="约束和限制">约束和限制<i class="anchor-icon anchor-icon-link" anchorid="约束和限制" tips="复制节点链接"></i></h2>         </div>    <div class="tiledSection">     <h3 id="请求参数约束" class="firsth2">请求参数约束<i class="anchor-icon anchor-icon-link" anchorid="请求参数约束" tips="复制节点链接"></i></h3>          <ol>      <li>互动卡片申请动效的最大合法动效时长：3500ms，倒计时结束时，卡片将切换回非激活态。</li>      <li>由卡片定时定点刷新触发的互动卡片动效，一天内单张卡片最多触发50次。</li>      <li>最大可申请动效区域：如下图，矩形ABCD表示卡片自身渲染区域，矩形IJKL表示卡片最大可申请动效区域。两个矩形中心对齐。尺寸满足以下表格描述。</li>     </ol>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.5.3.1.4.1.1" valign="top" width="33.33333333333333%">卡片样式</th>         <th align="left" class="cellrowborder" id="mcps1.3.5.3.1.4.1.2" valign="top" width="33.33333333333333%">JK 边长</th>         <th align="left" class="cellrowborder" id="mcps1.3.5.3.1.4.1.3" valign="top" width="33.33333333333333%">IJ 边长</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">1 * 2</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">不超过AD边长的150%。</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">不超过AB边长的200%。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">2 * 2</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">不超过AD边长的150%。</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">不超过AB边长的150%。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">2 * 4</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">不超过AD边长的125%。</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">不超过AB边长的150%。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">4 * 4</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">不超过AD边长的125%。</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">不超过AB边长的125%。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">6 * 4</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">不超过AD边长的125%。</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">不超过AB边长的110%。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>图5</strong> 互动卡片动效区域申请规则说明</p>     <p><span><img originheight="345" originwidth="750" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114907.28653987053015221020145083600392:50001231000000:2800:99F8874FA7D12562782235FF98213761DDB44DE2ADC5FDF6F682DCEA5A707B34.png" width="750" height="345"></span></p>     <p>例如：某设备上一个2*2卡片宽度为158vp，高度为158vp。对应上图则有：</p>     <p>（1）AD=158vp，AB=158vp，IJ=158*1.5=237vp，IL=158*1.5=237vp。</p>     <p>（2）IA两点水平相距39.5vp，垂直相距39.5vp。</p>     <p>因此，以A点为原点，向右为X轴正方向，向下为Y轴正方向，图5中E点的合法坐标可以是（-20，-20），EF边长合法值可以是200vp，EH边长合法值可以是200vp。</p>     <p>互动卡片可以通过调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-form-formprovider#formprovidergetformrect20" target="_blank">formProvider.getFormRect</a>接口获取卡片尺寸和在窗口内的位置信息。卡片提供方以此计算动效申请范围，坐标计算时，以上图A点为（0,0）点，计算矩形EFGH对应参数，单位为vp。</p>     <p>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-form-formprovider#formproviderrequestoverflow20" target="_blank">formProvider.requestOverflow</a>接口时，<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-form-forminfo#overflowinfo20" target="_blank">overflowInfo</a>中描述的互动卡片动效渲染区域（矩形EFGH）需要满足：</p>     <ol>      <li>包含了卡片（矩形ABCD）的全部区域。</li>      <li>不超过矩形IJKL（矩形IJKL完整包含矩形EFGH）。</li>     </ol>     <p>具体可参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-ui-liveform-sceneanimation-development">场景动效类型互动卡片开发指导</a>。</p>    </div>    <div class="tiledSection">     <h3 id="功耗约束">功耗约束<i class="anchor-icon anchor-icon-link" anchorid="功耗约束" tips="复制节点链接"></i></h3>          <ol>      <li>设备进入省电模式时，互动卡片不响应动效请求。</li>      <li>当设备热档位进入HOT时，不再响应非点击触发的动效请求；当热档位进入OVERHEATED时，不再响应所有动效请求。具体可参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-thermal#thermallevel" target="_blank">热档位信息</a>。</li>     </ol>    </div>    <div class="tiledSection">     <h3 id="动效请求约束">动效请求约束<i class="anchor-icon anchor-icon-link" anchorid="动效请求约束" tips="复制节点链接"></i></h3>          <ol>      <li>同一时刻，全局只有一个卡片执行互动卡片动效。</li>      <li>当用户通过点击等方式主动触发互动卡片动效时，优先响应此次请求。此时，当前卡片切换到激活态，执行动效，其他卡片切换到非激活态。</li>      <li>其他触发方式，例如通过卡片定时定数据刷新机制触发动效，遵循先到先得原则。系统只处理第一个合法动效请求。其他请求返回失败，同时不做缓存。</li>      <li>用户在桌面的其他有效操作（点击应用、卡片等，滑动翻页，下拉进入全搜、双中心、拖动卡片、长按卡片等）均会打断当前动效，卡片重新变成非激活态。</li>      <li>互动卡片执行动效期间，超过卡片自身渲染范围（对应图5中的矩形ABCD）的交互事件，互动卡片不做响应。</li>      <li>更多场景动效类型互动卡片激活态能力约束，可参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-form-liveformextensionability" target="_blank">LiveFormExtensionAbility</a>中说明。</li>     </ol>    </div>   </div>   <div></div></div>