<h1 _ngcontent-kgm-c119="" class="doc-title ng-star-inserted" title="基于AVCodec播放DRM节目(C/C++)"> 基于AVCodec播放DRM节目(C/C++) </h1>

<div _ngcontent-kgm-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <div class="tiledSection">     <h2 id="功能介绍">功能介绍<i class="anchor-icon anchor-icon-link" anchorid="功能介绍" tips="复制节点链接"></i></h2>          <p>开发者可以调用DRM Kit的Native API，完成DRM节目播放。</p>     <p>当前支持的解密能力如下：</p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.1.4.1.3.1.1" valign="top" width="50%">音频容器规格</th>         <th align="left" class="cellrowborder" id="mcps1.3.1.4.1.3.1.2" valign="top" width="50%">音频解密类型</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="50%">mp4</td>         <td class="cellrowborder" valign="top" width="50%">AAC</td>        </tr>             </tbody></table></div>     </div>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.1.5.1.3.1.1" valign="top" width="50%">视频容器规格</th>         <th align="left" class="cellrowborder" id="mcps1.3.1.5.1.3.1.2" valign="top" width="50%">视频解密类型</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="50%">ts</td>         <td class="cellrowborder" valign="top" width="50%">AVC(H.264)</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">mp4</td>         <td class="cellrowborder" valign="top" width="50%">AVC(H.264)</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">mp4</td>         <td class="cellrowborder" valign="top" width="50%">HEVC(H.265)</td>        </tr>             </tbody></table></div>     </div>     <p><strong>适用场景</strong></p>     <p>在创建DRM之前，需获取到DRM信息(参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/audio-video-demuxer#开发步骤">媒体数据解析</a>开发步骤第4步)。</p>    </div>    <div class="tiledSection">     <h2 id="开发指导">开发指导<i class="anchor-icon anchor-icon-link" anchorid="开发指导" tips="复制节点链接"></i></h2>          <p>详细的API说明请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-drm" target="_blank">DRM API</a>。</p>     <p>参考以下示例代码，完成DRM的全流程，包括：获取设备支持的DRM解决方案的名称和唯一标识的列表、创建MediaKeySystem、创建MediaKeySession、生成媒体密钥请求、处理媒体密钥响应、获取是否需要安全视频解码以及销毁资源。</p>     <p>在应用开发过程中，开发者应按一定顺序调用方法，执行对应操作，否则系统可能会抛出异常或生成其他未定义的行为。具体顺序可参考下列开发步骤及对应说明。</p>    </div>    <div class="tiledSection">     <h3 id="在-cmake-脚本中链接动态库" class="firsth2">在 CMake 脚本中链接动态库<i class="anchor-icon anchor-icon-link" anchorid="在-cmake-脚本中链接动态库" tips="复制节点链接"></i></h3>          <div _ngcontent-kgm-c106="" class="highlight-div"><div _ngcontent-kgm-c106="" class="highlight-div-header"><div _ngcontent-kgm-c106="" class="highlight-div-header-left"><div _ngcontent-kgm-c106="" class="handle-button expand-button"><div _ngcontent-kgm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kgm-c106="" class="highlight-div-header-right"><div _ngcontent-kgm-c106="" class="handle-button ai-button"></div><div _ngcontent-kgm-c106="" class="handle-button line-button"><div _ngcontent-kgm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kgm-c106="" class="handle-button theme-button"><div _ngcontent-kgm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kgm-c106="" class="handle-button copy-button"><div _ngcontent-kgm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kgm-c106="" class="highlight-scroll-div"><pre class="cmake prettyprint linenums hljs language-scss" hw-language="cmake" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-built_in">target_link_libraries</span>(sample PUBLIC libnative_drm.so)</li></ol></pre></div></div>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>上述'sample'字样仅为示例，此处由调用者根据实际工程目录自定义。</p>      </div></div></div>    </div>    <div class="tiledSection">     <h2 id="开发步骤">开发步骤<i class="anchor-icon anchor-icon-link" anchorid="开发步骤" tips="复制节点链接"></i></h2>          <ol>      <li>       <p>导入DRM Kit接口。</p>       <div _ngcontent-kgm-c106="" class="highlight-div"><div _ngcontent-kgm-c106="" class="highlight-div-header"><div _ngcontent-kgm-c106="" class="highlight-div-header-left"><div _ngcontent-kgm-c106="" class="handle-button expand-button"><div _ngcontent-kgm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kgm-c106="" class="highlight-div-header-right"><div _ngcontent-kgm-c106="" class="handle-button ai-button"></div><div _ngcontent-kgm-c106="" class="handle-button line-button"><div _ngcontent-kgm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kgm-c106="" class="handle-button theme-button"><div _ngcontent-kgm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kgm-c106="" class="handle-button copy-button"><div _ngcontent-kgm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kgm-c106="" class="highlight-scroll-div"><pre class="prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"multimedia/drm_framework/native_drm_common.h"</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"multimedia/drm_framework/native_drm_err.h"</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"multimedia/drm_framework/native_mediakeysession.h"</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"multimedia/drm_framework/native_mediakeysystem.h"</span></span></li></ol></pre></div></div></li>      <li>       <p>获取设备支持的DRM解决方案名称和唯一标识的列表。</p>       <div _ngcontent-kgm-c106="" class="highlight-div"><div _ngcontent-kgm-c106="" class="highlight-div-header"><div _ngcontent-kgm-c106="" class="highlight-div-header-left"><div _ngcontent-kgm-c106="" class="handle-button expand-button"><div _ngcontent-kgm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kgm-c106="" class="highlight-div-header-right"><div _ngcontent-kgm-c106="" class="handle-button ai-button"></div><div _ngcontent-kgm-c106="" class="handle-button line-button"><div _ngcontent-kgm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kgm-c106="" class="handle-button theme-button"><div _ngcontent-kgm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kgm-c106="" class="handle-button copy-button"><div _ngcontent-kgm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kgm-c106="" class="highlight-scroll-div"><pre class="prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-type">uint32_t</span> count = <span class="hljs-number">3</span>; <span class="hljs-comment">// count是当前设备实际支持的DRM插件的个数，用户根据实际情况设置。</span></li><li>DRM_MediaKeySystemDescription descriptions[<span class="hljs-number">3</span>];</li><li><span class="hljs-built_in">memset</span>(descriptions, <span class="hljs-number">0</span>, <span class="hljs-built_in">sizeof</span>(descriptions));</li><li>Drm_ErrCode ret = <span class="hljs-built_in">OH_MediaKeySystem_GetMediaKeySystems</span>(descriptions, &amp;count);</li><li><span class="hljs-keyword">if</span> (ret != DRM_ERR_OK) {</li><li>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"OH_MediaKeySystem_GetMediaKeySystems failed."</span>);</li><li>}</li></ol></pre></div></div>       <p>获取到设备支持的DRM解决方案的名称和唯一标识的列表后，同DRM信息做匹配，创建对应的DRM解决方案。DRM信息可通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/audio-video-demuxer#开发步骤">媒体数据解析</a>开发步骤第4步获取，</p>       <p>或者直接解析媒体协议或媒体数据得到DRM解决方案唯一标识及pssh数据以生成DRM信息。</p></li>      <li>       <p>创建MediaKeySystem实例。</p>       <div _ngcontent-kgm-c106="" class="highlight-div"><div _ngcontent-kgm-c106="" class="highlight-div-header"><div _ngcontent-kgm-c106="" class="highlight-div-header-left"><div _ngcontent-kgm-c106="" class="handle-button expand-button"><div _ngcontent-kgm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kgm-c106="" class="highlight-div-header-right"><div _ngcontent-kgm-c106="" class="handle-button ai-button"></div><div _ngcontent-kgm-c106="" class="handle-button line-button"><div _ngcontent-kgm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kgm-c106="" class="handle-button theme-button"><div _ngcontent-kgm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kgm-c106="" class="handle-button copy-button"><div _ngcontent-kgm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kgm-c106="" class="highlight-scroll-div"><pre class="prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li>MediaKeySystem *mediaKeySystem = <span class="hljs-literal">nullptr</span>;</li><li>ret = <span class="hljs-built_in">OH_MediaKeySystem_Create</span>(<span class="hljs-string">"com.wiseplay.drm"</span>, &amp;mediaKeySystem);</li><li><span class="hljs-keyword">if</span> (ret != DRM_ERR_OK || mediaKeySystem == <span class="hljs-literal">nullptr</span>) {</li><li>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"OH_MediaKeySystem_Create failed."</span>);</li><li>}</li></ol></pre></div></div></li>      <li>       <p>创建MediaKeySession实例。</p>       <div _ngcontent-kgm-c106="" class="highlight-div"><div _ngcontent-kgm-c106="" class="highlight-div-header"><div _ngcontent-kgm-c106="" class="highlight-div-header-left"><div _ngcontent-kgm-c106="" class="handle-button expand-button"><div _ngcontent-kgm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kgm-c106="" class="highlight-div-header-right"><div _ngcontent-kgm-c106="" class="handle-button ai-button"></div><div _ngcontent-kgm-c106="" class="handle-button line-button"><div _ngcontent-kgm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kgm-c106="" class="handle-button theme-button"><div _ngcontent-kgm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kgm-c106="" class="handle-button copy-button"><div _ngcontent-kgm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kgm-c106="" class="highlight-scroll-div"><pre class="prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li>MediaKeySession *mediaKeySession = <span class="hljs-literal">nullptr</span>;</li><li>DRM_ContentProtectionLevel contentProtectionLevel = CONTENT_PROTECTION_LEVEL_SW_CRYPTO; <span class="hljs-comment">// 依据设备支持的内容保护级别设置。</span></li><li>ret = <span class="hljs-built_in">OH_MediaKeySystem_CreateMediaKeySession</span>(mediaKeySystem, &amp;contentProtectionLevel, &amp;mediaKeySession);</li><li><span class="hljs-keyword">if</span> (ret != DRM_ERR_OK || mediaKeySession == <span class="hljs-literal">nullptr</span>) {</li><li>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"OH_MediaKeySystem_CreateMediaKeySession failed."</span>);</li><li>}</li></ol></pre></div></div></li>      <li>       <p>查询是否需要安全解码。</p>       <div _ngcontent-kgm-c106="" class="highlight-div"><div _ngcontent-kgm-c106="" class="highlight-div-header"><div _ngcontent-kgm-c106="" class="highlight-div-header-left"><div _ngcontent-kgm-c106="" class="handle-button expand-button"><div _ngcontent-kgm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kgm-c106="" class="highlight-div-header-right"><div _ngcontent-kgm-c106="" class="handle-button ai-button"></div><div _ngcontent-kgm-c106="" class="handle-button line-button"><div _ngcontent-kgm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kgm-c106="" class="handle-button theme-button"><div _ngcontent-kgm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kgm-c106="" class="handle-button copy-button"><div _ngcontent-kgm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kgm-c106="" class="highlight-scroll-div"><pre class="prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-type">bool</span> requireSecureDecoder;</li><li>ret = <span class="hljs-built_in">OH_MediaKeySession_RequireSecureDecoderModule</span>(mediaKeySession, <span class="hljs-string">"video/avc"</span>, &amp;requireSecureDecoder);</li><li><span class="hljs-keyword">if</span> (ret != DRM_ERR_OK) {</li><li>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"OH_MediaKeySession_RequireSecureDecoderModule failed."</span>);</li><li>}</li></ol></pre></div></div></li>      <li>       <p>生成媒体密钥请求与处理媒体密钥响应。</p>       <div _ngcontent-kgm-c106="" class="highlight-div"><div _ngcontent-kgm-c106="" class="highlight-div-header"><div _ngcontent-kgm-c106="" class="highlight-div-header-left"><div _ngcontent-kgm-c106="" class="handle-button expand-button"><div _ngcontent-kgm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kgm-c106="" class="highlight-div-header-right"><div _ngcontent-kgm-c106="" class="handle-button ai-button"></div><div _ngcontent-kgm-c106="" class="handle-button line-button"><div _ngcontent-kgm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kgm-c106="" class="handle-button theme-button"><div _ngcontent-kgm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kgm-c106="" class="handle-button copy-button"><div _ngcontent-kgm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kgm-c106="" class="highlight-scroll-div"><pre class="prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">#<span class="hljs-keyword">define</span> MAX_DRM_MEDIA_KEY_RESPONSE_BUF_SIZE 24576 <span class="hljs-comment">// 24576: (2 * 12 * 1024)</span></span></li><li>DRM_MediaKeyRequest mediaKeyRequest;</li><li>DRM_MediaKeyRequestInfo info;</li><li><span class="hljs-comment">// initData对应码流中的pssh数据，请按实际数据填入。</span></li><li><span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> initData[<span class="hljs-number">512</span>] = {<span class="hljs-number">0x00</span>};</li><li><span class="hljs-built_in">memset</span>(&amp;info, <span class="hljs-number">0</span>, <span class="hljs-built_in">sizeof</span>(DRM_MediaKeyRequestInfo));</li><li>info.initDataLen = <span class="hljs-built_in">sizeof</span>(initData);</li><li>info.type = MEDIA_KEY_TYPE_ONLINE; <span class="hljs-comment">// MEDIA_KEY_TYPE_ONLINE: 在线媒体密钥请求类型; MEDIA_KEY_TYPE_OFFLINE: 离线媒体密钥请求类型。</span></li><li><span class="hljs-keyword">if</span> (<span class="hljs-built_in">sizeof</span>(<span class="hljs-string">"video/mp4"</span>) &lt;= <span class="hljs-built_in">sizeof</span>(info.mimeType)) {</li><li><span class="hljs-built_in">memcpy</span>(info.mimeType, <span class="hljs-string">"video/mp4"</span>, <span class="hljs-built_in">sizeof</span>(<span class="hljs-string">"video/mp4"</span>));</li><li>}</li><li><span class="hljs-keyword">if</span> (info.initDataLen &lt;= <span class="hljs-built_in">sizeof</span>(info.initData)) {</li><li><span class="hljs-built_in">memcpy</span>(info.initData, initData, info.initDataLen);</li><li>}</li><li><span class="hljs-keyword">if</span> (<span class="hljs-built_in">sizeof</span>(<span class="hljs-string">"optionalDataName"</span>) &lt;= <span class="hljs-built_in">sizeof</span>(info.optionName[<span class="hljs-number">0</span>])) {</li><li><span class="hljs-built_in">memcpy</span>(info.optionName[<span class="hljs-number">0</span>], <span class="hljs-string">"optionalDataName"</span>, <span class="hljs-built_in">sizeof</span>(<span class="hljs-string">"optionalDataName"</span>));</li><li>}</li><li>
</li><li><span class="hljs-keyword">if</span> (<span class="hljs-built_in">sizeof</span>(<span class="hljs-string">"optionalDataValue"</span>) &lt;= <span class="hljs-built_in">sizeof</span>(info.optionData[<span class="hljs-number">0</span>])) {</li><li><span class="hljs-built_in">memcpy</span>(info.optionData[<span class="hljs-number">0</span>], <span class="hljs-string">"optionalDataValue"</span>, <span class="hljs-built_in">sizeof</span>(<span class="hljs-string">"optionalDataValue"</span>));</li><li>}</li><li>info.optionsCount = <span class="hljs-number">1</span>;</li><li>ret = <span class="hljs-built_in">OH_MediaKeySession_GenerateMediaKeyRequest</span>(mediaKeySession, &amp;info, &amp;mediaKeyRequest);</li><li><span class="hljs-keyword">if</span> (ret != DRM_ERR_OK) {</li><li>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"OH_MediaKeySession_GenerateMediaKeyRequest failed."</span>);</li><li>}</li><li><span class="hljs-comment">/*</span></li><li><span class="hljs-comment">  应用通过网络请求DRM服务，获取媒体密钥响应mediaKeyResponse，将响应传到OH_MediaKeySession_ProcessMediaKeyResponse，</span></li><li><span class="hljs-comment">  若是离线媒体密钥响应处理，则返回离线媒体密钥标识mediaKeyId，请根据实际的数据和长度传入。</span></li><li><span class="hljs-comment">*/</span></li><li><span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> mediaKeyId[<span class="hljs-number">128</span>] = {<span class="hljs-number">0x00</span>};</li><li><span class="hljs-type">int32_t</span> mediaKeyIdLen = <span class="hljs-number">128</span>;</li><li><span class="hljs-comment">// 媒体密钥响应长度最大为MAX_DRM_MEDIA_KEY_RESPONSE_BUF_SIZE，请按实际数据输入。</span></li><li><span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> mediaKeyResponse[MAX_DRM_MEDIA_KEY_RESPONSE_BUF_SIZE] = {<span class="hljs-number">0x00</span>};</li><li><span class="hljs-type">int32_t</span> mediaKeyResponseLen = MAX_DRM_MEDIA_KEY_RESPONSE_BUF_SIZE;</li><li>ret = <span class="hljs-built_in">OH_MediaKeySession_ProcessMediaKeyResponse</span>(mediaKeySession, mediaKeyResponse,</li><li>    mediaKeyResponseLen, mediaKeyId, &amp;mediaKeyIdLen);</li><li><span class="hljs-keyword">if</span> (ret != DRM_ERR_OK) {</li><li>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"OH_MediaKeySession_ProcessMediaKeyResponse failed."</span>);</li><li>}</li></ol></pre></div></div>       <p>根据需要设置音频解密配置(详见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/audio-decoding#开发步骤">音频解码开发指南开发步骤</a>第4步)、设置视频解密配置(详见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/video-decoding#surface模式">视频解码开发指南开发步骤Surface模式</a>第4步或<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/video-decoding#buffer模式">Buffer模式</a>第4步)，实现DRM内容解密。</p></li>      <li>       <p>销毁MediaKeySession实例。</p>       <div _ngcontent-kgm-c106="" class="highlight-div"><div _ngcontent-kgm-c106="" class="highlight-div-header"><div _ngcontent-kgm-c106="" class="highlight-div-header-left"><div _ngcontent-kgm-c106="" class="handle-button expand-button"><div _ngcontent-kgm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kgm-c106="" class="highlight-div-header-right"><div _ngcontent-kgm-c106="" class="handle-button ai-button"></div><div _ngcontent-kgm-c106="" class="handle-button line-button"><div _ngcontent-kgm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kgm-c106="" class="handle-button theme-button"><div _ngcontent-kgm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kgm-c106="" class="handle-button copy-button"><div _ngcontent-kgm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kgm-c106="" class="highlight-scroll-div"><pre class="prettyprint linenums hljs language-bash" data-highlighted="yes"><ol class="linenums"><li>ret = OH_MediaKeySession_Destroy(mediaKeySession);</li><li><span class="hljs-keyword">if</span> (ret != DRM_ERR_OK) {</li><li>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"OH_MediaKeySession_Destroy failed."</span>);</li><li>}</li></ol></pre></div></div></li>      <li>       <p>销毁MediaKeySystem实例。</p>       <div _ngcontent-kgm-c106="" class="highlight-div"><div _ngcontent-kgm-c106="" class="highlight-div-header"><div _ngcontent-kgm-c106="" class="highlight-div-header-left"><div _ngcontent-kgm-c106="" class="handle-button expand-button"><div _ngcontent-kgm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kgm-c106="" class="highlight-div-header-right"><div _ngcontent-kgm-c106="" class="handle-button ai-button"></div><div _ngcontent-kgm-c106="" class="handle-button line-button"><div _ngcontent-kgm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kgm-c106="" class="handle-button theme-button"><div _ngcontent-kgm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kgm-c106="" class="handle-button copy-button"><div _ngcontent-kgm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kgm-c106="" class="highlight-scroll-div"><pre class="prettyprint linenums hljs language-bash" data-highlighted="yes"><ol class="linenums"><li>ret = OH_MediaKeySystem_Destroy(mediaKeySystem);</li><li><span class="hljs-keyword">if</span> (ret != DRM_ERR_OK) {</li><li>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"OH_MediaKeySystem_Destroy failed."</span>);</li><li>}</li></ol></pre></div></div></li>     </ol>    </div>   </div>   <div></div></div>