<h1 _ngcontent-pay-c119="" class="doc-title ng-star-inserted" title="基于Page的装饰器方案"> 基于Page的装饰器方案 </h1>

<div _ngcontent-pay-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div><p>开发者使用@InsightIntentPage装饰器进行基于Page的意图声明，可快速将已有的Page页面接入意图框架，以购买电影票的意图为例，详细说明如下：</p> <ol><li>装饰器添加位置：基于Page的装饰器需要添加在Entry页面组件上，建议在目标页面中进行声明。<div _ngcontent-pay-c106="" class="highlight-div"><div _ngcontent-pay-c106="" class="highlight-div-header"><div _ngcontent-pay-c106="" class="highlight-div-header-left"><div _ngcontent-pay-c106="" class="handle-button expand-button"><div _ngcontent-pay-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pay-c106="" class="highlight-div-header-right"><div _ngcontent-pay-c106="" class="handle-button ai-button"></div><div _ngcontent-pay-c106="" class="handle-button line-button"><div _ngcontent-pay-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pay-c106="" class="handle-button theme-button"><div _ngcontent-pay-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pay-c106="" class="handle-button copy-button"><div _ngcontent-pay-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pay-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">InsightIntentPage</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@ohos.app.ability.InsightIntentDecorator"</span>;</li><li>
</li><li><span class="hljs-meta">@Builder</span></li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">PurchaseMovieTicketsIntentPageBuilder</span>(<span class="hljs-params">pageName: <span class="hljs-built_in">string</span>, param: <span class="hljs-built_in">object</span></span>) {</li><li>  <span class="hljs-title class_">PurchaseMovieTicketsIntentPage</span>({ <span class="hljs-attr">param</span>: param });</li><li>}</li><li>
</li><li><span class="hljs-meta">@InsightIntentPage</span>({</li><li>  <span class="hljs-attr">intentName</span>: <span class="hljs-string">'PurchaseMovieTickets'</span>,</li><li>  <span class="hljs-attr">domain</span>: <span class="hljs-string">'PurchaseTickets'</span>,</li><li>  <span class="hljs-attr">intentVersion</span>: <span class="hljs-string">'1.0.1'</span>,</li><li>  <span class="hljs-attr">displayName</span>: <span class="hljs-string">'购买电影票'</span>,</li><li>  <span class="hljs-attr">llmDescription</span>: <span class="hljs-string">'用于在线购买电影票，允许用户选择指定影院、电影和场次时间进行购票。在用户明确表达购票需求，且已提供所有必要信息（cinema, film, time）时使用。如果信息不全或者用户只是查询电影信息、放映时间或票价，不应调用此工具。'</span>,</li><li>  <span class="hljs-attr">uiAbility</span>: <span class="hljs-string">'EntryAbility'</span>,</li><li>  <span class="hljs-attr">pagePath</span>: <span class="hljs-string">'./ets/pages/MainPage'</span>,</li><li>  <span class="hljs-attr">navDestinationName</span>: <span class="hljs-string">'PurchaseMovieTicketsIntentPage'</span>,</li><li>  <span class="hljs-attr">parameters</span>: {</li><li>    <span class="hljs-string">"type"</span>: <span class="hljs-string">"object"</span>,</li><li>    <span class="hljs-string">"properties"</span>: {</li><li>      <span class="hljs-string">"cinema"</span>: {</li><li>        <span class="hljs-string">"type"</span>: <span class="hljs-string">"string"</span>,</li><li>        <span class="hljs-string">"description"</span>: <span class="hljs-string">"目标影院名称，仅支持平台合作的影院"</span></li><li>      },</li><li>      <span class="hljs-string">"film"</span>: {</li><li>        <span class="hljs-string">"type"</span>: <span class="hljs-string">"string"</span>,</li><li>        <span class="hljs-string">"description"</span>: <span class="hljs-string">"目标电影名称，需为当前上映或即将上映且在影院排片列表中的电影"</span></li><li>      },</li><li>      <span class="hljs-string">"time"</span>: {</li><li>        <span class="hljs-string">"type"</span>: <span class="hljs-string">"string"</span>,</li><li>        <span class="hljs-string">"description"</span>: <span class="hljs-string">"放映时间，必须为未来的场次，且需为影院当天有效排片时间；时间格式应为'YYYY-MM-DD HH:MM'（例如'2025-07-01 19:30'）"</span></li><li>      }</li><li>    },</li><li>    <span class="hljs-string">"required"</span>: [<span class="hljs-string">"cinema"</span>, <span class="hljs-string">"film"</span>, <span class="hljs-string">"time"</span>]</li><li>  }</li><li>})</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">PurchaseMovieTicketsIntentPage</span> {</li><li>  <span class="hljs-attr">param</span>: <span class="hljs-built_in">object</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>();</li><li>  <span class="hljs-attr">cinema</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">''</span>;</li><li>  <span class="hljs-attr">film</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">''</span>;</li><li>  <span class="hljs-attr">time</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">''</span>;</li><li>  <span class="hljs-title function_">aboutToAppear</span>(): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">cinema</span>= <span class="hljs-variable language_">this</span>.<span class="hljs-property">param</span>?.[<span class="hljs-string">'cinema'</span>];</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">film</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">param</span>?.[<span class="hljs-string">'film'</span>];</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">time</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">param</span>?.[<span class="hljs-string">'time'</span>];</li><li>  }</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">NavDestination</span>(){</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.cinema}</span> <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.film}</span> <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.time}</span>`</span>)</li><li>        .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">30</span>)</li><li>        .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bolder</span>)</li><li>    }</li><li>    .<span class="hljs-title function_">title</span>(<span class="hljs-string">'IntentPage'</span>)</li><li>    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div> </li><li>装饰器的字段说明以及示例：@InsightIntentPage字段以及具体说明如下。 <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.2.2.1.1.5.1.1" valign="top" width="17.87%"><p>字段名称</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.2.2.1.1.5.1.2" valign="top" width="19.72%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.2.2.1.1.5.1.3" valign="top" width="8.94%"><p>必选</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.2.2.1.1.5.1.4" valign="top" width="53.47%"><p>说明</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="17.87%"><p>intentName</p> </td> <td class="cellrowborder" valign="top" width="19.72%"><p>string</p> </td> <td class="cellrowborder" valign="top" width="8.94%"><p>是</p> </td> <td class="cellrowborder" valign="top" width="53.47%"><p>意图名称，最大长度：64。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="17.87%"><p>domain</p> </td> <td class="cellrowborder" valign="top" width="19.72%"><p>string</p> </td> <td class="cellrowborder" valign="top" width="8.94%"><p>是</p> </td> <td class="cellrowborder" valign="top" width="53.47%"><p>意图所属的功能垂域。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="17.87%"><p>intentVersion</p> </td> <td class="cellrowborder" valign="top" width="19.72%"><p>string</p> </td> <td class="cellrowborder" valign="top" width="8.94%"><p>是</p> </td> <td class="cellrowborder" valign="top" width="53.47%"><p>意图的版本号，用于兼容性管理。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="17.87%"><p>displayName</p> </td> <td class="cellrowborder" valign="top" width="19.72%"><p>string</p> </td> <td class="cellrowborder" valign="top" width="8.94%"><p>是</p> </td> <td class="cellrowborder" valign="top" width="53.47%"><p>意图的展示名称，用于界面显示，最大长度：64。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="17.87%"><p>llmDescription</p> </td> <td class="cellrowborder" valign="top" width="19.72%"><p>string</p> </td> <td class="cellrowborder" valign="top" width="8.94%"><p>否</p> </td> <td class="cellrowborder" valign="top" width="53.47%"><p>意图的描述，详细描述该意图可实现的能力，便于大模型理解并调用。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="17.87%"><p>parameters</p> </td> <td class="cellrowborder" valign="top" width="19.72%"><p>Record&lt;string, object&gt;</p> </td> <td class="cellrowborder" valign="top" width="8.94%"><p>否</p> </td> <td class="cellrowborder" valign="top" width="53.47%"><p>意图参数定义，描述参数类型以及含义。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="17.87%"><p>uiAbility</p> </td> <td class="cellrowborder" valign="top" width="19.72%"><p>string</p> </td> <td class="cellrowborder" valign="top" width="8.94%"><p>否</p> </td> <td class="cellrowborder" valign="top" width="53.47%"><p>页面依赖的UiAbility名，如果不传递默认使用EntryAbility。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="17.87%"><p>pagePath</p> </td> <td class="cellrowborder" valign="top" width="19.72%"><p>string</p> </td> <td class="cellrowborder" valign="top" width="8.94%"><p>是</p> </td> <td class="cellrowborder" valign="top" width="53.47%"><p>Navigation组件所在页面的路径，路径基于Module的根目录的相对路径。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="17.87%"><p>navDestinationName</p> </td> <td class="cellrowborder" valign="top" width="19.72%"><p>string</p> </td> <td class="cellrowborder" valign="top" width="8.94%"><p>否</p> </td> <td class="cellrowborder" valign="top" width="53.47%"><p>Navigation子页面名称，如果不填写，则跳转到pagePath指定的页面。</p> </td> </tr>  </tbody></table></div> </div> <p>为便于大模型理解和调用，相关参数定义需要遵照<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/intents-skill-all-rec-specification">自定义意图相关信息定义规范</a>。</p> </li><li>装饰器的添加方式：装饰器可以直接手动添加，同时也支持一键生成装饰器，建议使用后者，此方式需要安装相应插件，详细步骤如下。<ol><li>打开CodeGenie插件：在DevEco Studio右侧边栏点击CodeGenie或输入快捷键Alt/Option+U，可以进入DevEco CodeGenie。若使用非最新版本的DevEco Studio，可通过<a href="https://developer.huawei.com/consumer/cn/download/deveco-codegenie" target="_blank">下载中心</a>获取并使用相关功能，具体请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-codegenie#section18337533718" target="_blank">插件获取及安装</a>。<p><span><img height="334.1625" originheight="989" originwidth="1548" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114259.53333307153916470430590871732841:50001231000000:2800:997EB4015D28E14A3B2480450F7FA02AC397C7C88BB93001DBCA36AA9FC50B00.png" title="点击放大" width="523.6875"></span></p> </li><li>框选想要接入意图框架功能的代码。<p><span><img height="334.1625" originheight="989" originwidth="1549" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114259.89385712303397489363236948005143:50001231000000:2800:4C8AF9AE37CFA442AAFAFA66265D575CC7F52ADACA91878D2DEE1332FCDE0B17.png" title="点击放大" width="523.6875"></span></p> </li><li>在选中的代码块上右键CodeGenie &gt; Insight Intent &gt; 选择适合的装饰器。<p><span><img height="334.1625" originheight="989" originwidth="1547" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114259.70582540237330279320124719191136:50001231000000:2800:F6DB0558C642E624549A0646BCE97EFC87B56C57E3CB923BFB992849CBA6A15F.png" title="点击放大" width="523.6875"></span></p> </li><li>在DevEco CodeGenie对话框中对意图定义，功能，参数等进行描述。<p><span><img height="334.1625" originheight="990" originwidth="1550" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114259.90865133244505980537202041169703:50001231000000:2800:F2B2918B03B6D0C127B663C5EDCFAF74DA3F54CA2C15F5AE42BD5B3E21415954.png" title="点击放大" width="523.6875"></span></p> </li><li>回车或者点击发送按钮，即可生成对应的装饰器内容。<p><span><img height="334.1625" originheight="3519" originwidth="5499" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114259.79200738412880060318125015101848:50001231000000:2800:8D71A92C9EBD53C9F54569913B397BAA4DB2414874A95288C8035634820A75AB.png" title="点击放大" width="523.6875"></span></p> </li><li>将光标放置于要插入装饰器的位置，点击插入图标，即可在对应位置插入装饰器。<p>插入前：</p> <p><span><img height="334.1625" originheight="3519" originwidth="5508" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114300.71767712628732374717016771785278:50001231000000:2800:EA75BB7DA83F145918806302F437D0BD03EDBEB7508015AEDE45CC936D1F5B6F.png" title="点击放大" width="523.6875"></span></p> <p>插入后：</p> <p><span><img height="334.1625" originheight="3519" originwidth="5511" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114300.80542182504680774618085200869354:50001231000000:2800:9D681AF95F23DDFC3CE50B587A62C7249C609A367FFBCCF99B6D8485D4070A6C.png" title="点击放大" width="523.6875"></span></p> </li></ol> </li><li>装饰器的使用约束和说明：<ul><li>仅支持Navigation页面架构跳转。</li><li>该跳转不能有自定义上下文依赖，比如必须打开前置页面才能跳转，开发者需要进行验证，确认兜底策略。</li><li>跳转页面时，默认使用Navigation页面栈进行push，如果开发者需要实现其他跳转逻辑，则需要自行适配。</li></ul> </li></ol> </div> <div></div></div>