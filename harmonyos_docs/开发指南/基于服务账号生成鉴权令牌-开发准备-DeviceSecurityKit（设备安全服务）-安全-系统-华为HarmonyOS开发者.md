<h1 _ngcontent-eyi-c119="" class="doc-title ng-star-inserted" title="基于服务账号生成鉴权令牌"> 基于服务账号生成鉴权令牌 </h1>

<div _ngcontent-eyi-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div><div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content"><p>只有使用应用设备状态检测服务时才需要配置此章节。</p> </div></div></div> <div class="tiledSection"><h2 id="section4780149123414">概述<i class="anchor-icon anchor-icon-link" anchorid="section4780149123414" tips="复制节点链接"></i></h2><p>服务账号（Service Account）是一种可实现服务器与服务器之间接口鉴权的账号，在华为开发者联盟的<a href="https://developer.huawei.com/consumer/cn/console/overview" target="_blank">API Console</a>上创建服务账号，您可根据返回的公私钥在业务应用中生成鉴权令牌，调用支持此类鉴权的华为公开API。</p> <p>服务账号令牌为JWT（JSON Web Token）格式字符串，JWT数据格式包括三个部分：</p> <ul><li>Header（头部）</li><li>Payload（负载）</li><li>Signature（签名）</li></ul> <p>这三个部分通过“.”进行连接，其中Signature为通过SHA256withRSA算法对Header与Payload拼接的字符串签名生成的字符串。</p> <p><strong>示例</strong></p> <div _ngcontent-eyi-c106="" class="highlight-div"><div _ngcontent-eyi-c106="" class="highlight-div-header"><div _ngcontent-eyi-c106="" class="highlight-div-header-left"><div _ngcontent-eyi-c106="" class="handle-button expand-button"><div _ngcontent-eyi-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-eyi-c106="" class="highlight-div-header-right"><div _ngcontent-eyi-c106="" class="handle-button ai-button"></div><div _ngcontent-eyi-c106="" class="handle-button line-button"><div _ngcontent-eyi-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-eyi-c106="" class="handle-button theme-button"><div _ngcontent-eyi-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-eyi-c106="" class="handle-button copy-button"><div _ngcontent-eyi-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-eyi-c106="" class="highlight-scroll-div"><pre class="json prettyprint linenums hljs language-json" hw-language="json" data-highlighted="yes"><ol class="linenums"><li>eyJra*****JjNjBjMXXX.</li><li>eyJhd*****JodHRXXX.</li><li>BRNss*****<span class="hljs-number">7</span>az5oU7-Zp<span class="">5</span>g<span class="">9</span>X<span class="">2</span>WJVXXX</li></ol></pre></div></div> <p>更多JWT的相关知识请参见<a href="https://jwt.io/introduction/" target="_blank">Introduction to JSON Web Tokens</a>。</p> </div> <div class="tiledSection"><h2 id="section14300125201316">开发步骤<i class="anchor-icon anchor-icon-link" anchorid="section14300125201316" tips="复制节点链接"></i></h2><ol><li><span>创建服务账号密钥文件。</span><p></p><p>开发者需要在华为开发者联盟的<a href="https://developer.huawei.com/consumer/cn/console/overview" target="_blank">API Console</a>上创建并下载服务账号的密钥文件，相关创建步骤请参见<a href="https://developer.huawei.com/consumer/cn/doc/start/api-0000001062522591#section91275725415" target="_blank">API Console操作指南-服务账号密钥</a>。</p> <p><span><img height="405.67527" originheight="933" originwidth="2106" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211115037.19275118173227189238269683842787:50001231000000:2800:2F7E138493B0ED8282F8063E049FD9E1001E21F6D9D1742B942BA7862F5EED41.png" title="点击放大" width="915.705"></span></p> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p>您在开发者联盟需要申请开发者级的服务账号凭证。</p> </div></div></div> <p>服务账号密钥样例文件形式可参考：</p> <div _ngcontent-eyi-c106="" class="highlight-div"><div _ngcontent-eyi-c106="" class="highlight-div-header"><div _ngcontent-eyi-c106="" class="highlight-div-header-left"><div _ngcontent-eyi-c106="" class="handle-button expand-button"><div _ngcontent-eyi-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-eyi-c106="" class="highlight-div-header-right"><div _ngcontent-eyi-c106="" class="handle-button ai-button"></div><div _ngcontent-eyi-c106="" class="handle-button line-button"><div _ngcontent-eyi-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-eyi-c106="" class="handle-button theme-button"><div _ngcontent-eyi-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-eyi-c106="" class="handle-button copy-button"><div _ngcontent-eyi-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-eyi-c106="" class="highlight-scroll-div"><pre class="json prettyprint linenums hljs language-json" hw-language="json" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-punctuation">{</span></li><li>    <span class="hljs-attr">"project_id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"*****"</span><span class="hljs-punctuation">,</span></li><li>    <span class="hljs-attr">"key_id"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"*****"</span><span class="hljs-punctuation">,</span></li><li>    <span class="hljs-attr">"private_key"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"-----BEGIN PRIVATE KEY-----\nMIIJQgIBADANBgkqhkiG9w0BAQEFAASCCSwwggkoAgEAAoICAQCKw6kJKtCh7qmMvp1u1dI27z2TKZrPOzHbQaXO/Eez0AWZ2EN+ouF496R3pfo7fQXC1XOT/YTbVC4DNZwWSMA54fu3/AOCY9Zzyi46OK*****==\n-----END PRIVATE KEY-----\n"</span><span class="hljs-punctuation">,</span></li><li>    <span class="hljs-attr">"sub_account"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"*****"</span><span class="hljs-punctuation">,</span></li><li>    <span class="hljs-attr">"auth_uri"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"https://oauth-login.cloud.huawei.com/oauth2/v3/authorize"</span><span class="hljs-punctuation">,</span></li><li>    <span class="hljs-attr">"token_uri"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"https://oauth-login.cloud.huawei.com/oauth2/v3/token"</span><span class="hljs-punctuation">,</span></li><li>    <span class="hljs-attr">"auth_provider_cert_uri"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"https://oauth-login.cloud.huawei.com/oauth2/v3/certs"</span><span class="hljs-punctuation">,</span></li><li>    <span class="hljs-attr">"client_cert_uri"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"https://oauth-login.cloud.huawei.com/oauth2/v3/x509?client_id=*****"</span></li><li><span class="hljs-punctuation">}</span></li></ol></pre></div></div> <p></p></li><li><span>生成JWT Header数据。</span><p></p><p>根据服务账号密钥文件中的key_id字段拼接以下JSON体，对JSON体进行BASE64编码。</p> <div _ngcontent-eyi-c106="" class="highlight-div"><div _ngcontent-eyi-c106="" class="highlight-div-header"><div _ngcontent-eyi-c106="" class="highlight-div-header-left"><div _ngcontent-eyi-c106="" class="handle-button expand-button"><div _ngcontent-eyi-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-eyi-c106="" class="highlight-div-header-right"><div _ngcontent-eyi-c106="" class="handle-button ai-button"></div><div _ngcontent-eyi-c106="" class="handle-button line-button"><div _ngcontent-eyi-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-eyi-c106="" class="handle-button theme-button"><div _ngcontent-eyi-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-eyi-c106="" class="handle-button copy-button"><div _ngcontent-eyi-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-eyi-c106="" class="highlight-scroll-div"><pre class="json prettyprint linenums hljs language-json" hw-language="json" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-punctuation">{</span></li><li><span class="">  <span class="hljs-attr">"kid"</span></span><span class="hljs-punctuation">:</span> <span class=""><span class="hljs-string">"*****"</span></span><span class="hljs-punctuation">,</span></li><li><span class="">  <span class="hljs-attr">"typ"</span></span><span class="hljs-punctuation">:</span> <span class=""><span class="hljs-string">"JWT"</span></span><span class="hljs-punctuation">,</span></li><li><span class="">  <span class="hljs-attr">"alg"</span></span><span class="hljs-punctuation">:</span> <span class=""><span class="hljs-string">"PS256"</span></span></li><li><span class="hljs-punctuation">}</span></li></ol></pre></div></div>  <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.3.2.2.2.3.1.3.1.1" valign="top" width="24.27%"><p>字段名</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.3.2.2.2.3.1.3.1.2" valign="top" width="75.73%"><p>描述</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="24.27%"><p>kid</p> </td> <td class="cellrowborder" valign="top" width="75.73%"><p>服务账号密钥文件中key_id字段。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="24.27%"><p>typ</p> </td> <td class="cellrowborder" valign="top" width="75.73%"><p>数据类型，固定为：JWT。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="24.27%"><p>alg</p> </td> <td class="cellrowborder" valign="top" width="75.73%"><p>算法类型，固定为：PS256。</p> </td> </tr>  </tbody></table></div> </div> <p></p></li><li><span>生成JWT Payload数据。</span><p></p><p>根据服务账号密钥文件中的sub_account字段拼接以下JSON体，对JSON体进行BASE64编码。</p> <div _ngcontent-eyi-c106="" class="highlight-div"><div _ngcontent-eyi-c106="" class="highlight-div-header"><div _ngcontent-eyi-c106="" class="highlight-div-header-left"><div _ngcontent-eyi-c106="" class="handle-button expand-button"><div _ngcontent-eyi-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-eyi-c106="" class="highlight-div-header-right"><div _ngcontent-eyi-c106="" class="handle-button ai-button"></div><div _ngcontent-eyi-c106="" class="handle-button line-button"><div _ngcontent-eyi-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-eyi-c106="" class="handle-button theme-button"><div _ngcontent-eyi-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-eyi-c106="" class="handle-button copy-button"><div _ngcontent-eyi-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-eyi-c106="" class="highlight-scroll-div"><pre class="json prettyprint linenums hljs language-json" hw-language="json" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-punctuation">{</span></li><li><span class="">  <span class="hljs-attr">"aud"</span></span><span class="hljs-punctuation">:</span> <span class=""><span class="hljs-string">"https://oauth-login.cloud.huawei.com/oauth2/v3/token"</span></span><span class="hljs-punctuation">,</span></li><li><span class="">  <span class="hljs-attr">"iss"</span></span><span class="hljs-punctuation">:</span> <span class=""><span class="hljs-string">"*****"</span></span><span class="hljs-punctuation">,</span></li><li><span class="">  <span class="hljs-attr">"exp"</span></span><span class="hljs-punctuation">:</span> <span class=""><span class="hljs-number">1581410664</span></span><span class="hljs-punctuation">,</span></li><li><span class="">  <span class="hljs-attr">"iat"</span></span><span class="hljs-punctuation">:</span> <span class=""><span class="hljs-number">1581407064</span></span></li><li><span class="hljs-punctuation">}</span></li></ol></pre></div></div>  <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.3.2.3.2.3.1.3.1.1" valign="top" width="24.27%"><p>字段名</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.3.2.3.2.3.1.3.1.2" valign="top" width="75.73%"><p>描述</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="24.27%"><p>aud</p> </td> <td class="cellrowborder" valign="top" width="75.73%"><p>固定为：https://oauth-login.cloud.huawei.com/oauth2/v3/token。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="24.27%"><p>iss</p> </td> <td class="cellrowborder" valign="top" width="75.73%"><p>服务账号密钥文件中sub_account字段，标识数据生成者。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="24.27%"><p>exp</p> </td> <td class="cellrowborder" valign="top" width="75.73%"><p>JWT到期UTC时间戳，建议比“iat”晚3600秒。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="24.27%"><p>iat</p> </td> <td class="cellrowborder" valign="top" width="75.73%"><p>JWT签发UTC时间戳，为自UTC时间1970年1月1日00:00:00的秒数（应用服务器时间需要校准为标准时间）。</p> </td> </tr>  </tbody></table></div> </div> <p></p></li><li><span>生成JWT Token数据。</span><p></p><p>将完成BASE64编码后的Header字符串与Payload字符串，通过“.”进行连接，并在开发者的应用中，通过服务账号密钥文件中的private_key（华为不进行存储，请您妥善保管），使用SHA256withRSA/PSS算法对拼接的字符串签名，最后将Header，Payload以及字符串签名通过“.”进行连接，即可得到Token数据。</p> <p></p></li></ol> </div> <div class="tiledSection"><h2 id="section1910053451218">示例代码<i class="anchor-icon anchor-icon-link" anchorid="section1910053451218" tips="复制节点链接"></i></h2><p>为了方便您生成服务账号鉴权令牌，我们提供了Java语言的示例代码，请按照说明替换参数运行。</p> <p>如果您使用其他开发语言，请选择对应的<a href="https://www.jwt.io/libraries" target="_blank">JWT开源组件</a>进行开发。</p> <div _ngcontent-eyi-c106="" class="highlight-div"><div _ngcontent-eyi-c106="" class="highlight-div-header"><div _ngcontent-eyi-c106="" class="highlight-div-header-left"><div _ngcontent-eyi-c106="" class="handle-button expand-button"><div _ngcontent-eyi-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-eyi-c106="" class="highlight-div-header-right"><div _ngcontent-eyi-c106="" class="handle-button ai-button"></div><div _ngcontent-eyi-c106="" class="handle-button line-button"><div _ngcontent-eyi-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-eyi-c106="" class="handle-button theme-button"><div _ngcontent-eyi-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-eyi-c106="" class="handle-button copy-button"><div _ngcontent-eyi-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-eyi-c106="" class="highlight-scroll-div"><pre class="java prettyprint linenums hljs language-java" hw-language="java" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> com.alibaba.fastjson.JSONObject;</li><li><span class="hljs-keyword">import</span> org.apache.commons.codec.binary.Base64;</li><li><span class="hljs-keyword">import</span> org.bouncycastle.jce.provider.BouncyCastleProvider;</li><li>
</li><li><span class="hljs-keyword">import</span> java.nio.charset.StandardCharsets;</li><li><span class="hljs-keyword">import</span> java.security.*;</li><li><span class="hljs-keyword">import</span> java.security.spec.InvalidKeySpecException;</li><li><span class="hljs-keyword">import</span> java.security.spec.PKCS8EncodedKeySpec;</li><li><span class="hljs-keyword">import</span> java.util.Objects;</li><li>
</li><li><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">JWTGenerateDemo_test</span> {</li><li>    <span class="hljs-comment">// please replace it with the private_key in your json file</span></li><li>    <span class="hljs-comment">// this is the plain text in this demo, please encrypt the private key in your code, only get the string between</span></li><li>    <span class="hljs-comment">// '-----BEGIN PRIVATE KEY-----\n' and '\n-----END PRIVATE KEY-----\n'</span></li><li>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">PRIVATE_KEY</span> <span class="hljs-operator">=</span> <span class="hljs-string">"xxxx"</span>;</li><li>
</li><li>    <span class="hljs-comment">// please replace it with the sub_account in your json file</span></li><li>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">ISS</span> <span class="hljs-operator">=</span> <span class="hljs-string">"xxx"</span>;</li><li>
</li><li>    <span class="hljs-comment">// please replace it with the key_id in your json file</span></li><li>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">KID</span> <span class="hljs-operator">=</span> <span class="hljs-string">"xxx"</span>;</li><li>
</li><li>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">AUD</span> <span class="hljs-operator">=</span> <span class="hljs-string">"https://oauth-login.cloud.huawei.com/oauth2/v3/token"</span>;</li><li>
</li><li>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">ALG_PS256</span> <span class="hljs-operator">=</span> <span class="hljs-string">"PS256"</span>;</li><li>
</li><li>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">DOT</span> <span class="hljs-operator">=</span> <span class="hljs-string">"."</span>;</li><li>
</li><li>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> PrivateKey <span class="hljs-title function_">getPrivateKey</span><span class="hljs-params">(String key)</span> <span class="hljs-keyword">throws</span> NoSuchAlgorithmException, InvalidKeySpecException {</li><li>        <span class="hljs-type">PKCS8EncodedKeySpec</span> <span class="hljs-variable">keySpec</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">PKCS8EncodedKeySpec</span>(decodeBase64(key));</li><li>        <span class="hljs-type">KeyFactory</span> <span class="hljs-variable">keyFactory</span> <span class="hljs-operator">=</span> KeyFactory.getInstance(<span class="hljs-string">"RSA"</span>);</li><li>        <span class="hljs-keyword">return</span> keyFactory.generatePrivate(keySpec);</li><li>    }</li><li>
</li><li>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">byte</span>[] decodeBase64(String Base64Str) {</li><li>        <span class="hljs-keyword">return</span> Base64.decodeBase64(Base64Str.getBytes(StandardCharsets.UTF_8));</li><li>    }</li><li>
</li><li>    <span class="hljs-keyword">private</span> String <span class="hljs-title function_">createJwt</span><span class="hljs-params">()</span></li><li>            <span class="hljs-keyword">throws</span> NoSuchAlgorithmException, InvalidKeySpecException, InvalidKeyException, SignatureException {</li><li>        <span class="hljs-type">long</span> <span class="hljs-variable">iat</span> <span class="hljs-operator">=</span> System.currentTimeMillis() / <span class="hljs-number">1000</span>;</li><li>        <span class="hljs-type">long</span> <span class="hljs-variable">exp</span> <span class="hljs-operator">=</span> iat + <span class="hljs-number">3600</span>;<span class="hljs-comment">//JWT有效期3600s</span></li><li>
</li><li>        <span class="hljs-comment">// jwt header</span></li><li>        <span class="hljs-type">JSONObject</span> <span class="hljs-variable">header</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">JSONObject</span>();</li><li>        header.put(<span class="hljs-string">"alg"</span>, ALG_PS256);</li><li>        header.put(<span class="hljs-string">"kid"</span>, KID);</li><li>        header.put(<span class="hljs-string">"typ"</span>, <span class="hljs-string">"JWT"</span>);</li><li>
</li><li>        <span class="hljs-comment">// jwt payload</span></li><li>        <span class="hljs-type">JSONObject</span> <span class="hljs-variable">payload</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">JSONObject</span>();</li><li>        payload.put(<span class="hljs-string">"aud"</span>, AUD);</li><li>        payload.put(<span class="hljs-string">"iss"</span>, ISS);</li><li>        payload.put(<span class="hljs-string">"exp"</span>, exp);</li><li>        payload.put(<span class="hljs-string">"iat"</span>, iat);</li><li>
</li><li>        <span class="hljs-comment">// jwt signature</span></li><li>        <span class="hljs-type">byte</span>[] encodeHeaderBytes = Base64.encodeBase64URLSafe(header.toString().getBytes(StandardCharsets.UTF_8));</li><li>        <span class="hljs-type">byte</span>[] encodePayloadBytes = Base64.encodeBase64URLSafe(payload.toString().getBytes(StandardCharsets.UTF_8));</li><li>        <span class="hljs-type">String</span> <span class="hljs-variable">encodeHeader</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(encodeHeaderBytes, StandardCharsets.UTF_8);</li><li>        <span class="hljs-type">String</span> <span class="hljs-variable">encodePayload</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(encodePayloadBytes, StandardCharsets.UTF_8);</li><li>        <span class="hljs-type">String</span> <span class="hljs-variable">jwtHeaderAndPayload</span> <span class="hljs-operator">=</span> encodeHeader + DOT + encodePayload;</li><li>        <span class="hljs-type">Signature</span> <span class="hljs-variable">signatureInstance</span> <span class="hljs-operator">=</span> Signature.getInstance(<span class="hljs-string">"SHA256withRSA/PSS"</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">BouncyCastleProvider</span>());</li><li>        signatureInstance.initSign(getPrivateKey(PRIVATE_KEY));</li><li>        signatureInstance.update(jwtHeaderAndPayload.getBytes(StandardCharsets.UTF_8));</li><li>        <span class="hljs-type">String</span> <span class="hljs-variable">signature</span> <span class="hljs-operator">=</span></li><li>                <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(Objects.requireNonNull(Base64.encodeBase64URLSafe(signatureInstance.sign())), StandardCharsets.UTF_8);</li><li>
</li><li>        <span class="hljs-keyword">return</span> jwtHeaderAndPayload + DOT + signature;</li><li>    }</li><li>
</li><li>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String args[])</span></li><li>            <span class="hljs-keyword">throws</span> InvalidKeySpecException, NoSuchAlgorithmException, SignatureException, InvalidKeyException {</li><li>        <span class="hljs-type">JWTGenerateDemo_test</span> <span class="hljs-variable">JWTGenerateDemo</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">JWTGenerateDemo_test</span>();</li><li>        JWTGenerateDemo.createJwt();<span class="hljs-comment">//获取鉴权令牌</span></li><li>    }</li><li>}</li><li>
</li></ol></pre></div></div> <p>执行main()函数即可。</p> <p>推荐的java版本为java8，maven依赖如下：</p> <div _ngcontent-eyi-c106="" class="highlight-div"><div _ngcontent-eyi-c106="" class="highlight-div-header"><div _ngcontent-eyi-c106="" class="highlight-div-header-left"><div _ngcontent-eyi-c106="" class="handle-button expand-button"><div _ngcontent-eyi-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-eyi-c106="" class="highlight-div-header-right"><div _ngcontent-eyi-c106="" class="handle-button ai-button"></div><div _ngcontent-eyi-c106="" class="handle-button line-button"><div _ngcontent-eyi-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-eyi-c106="" class="handle-button theme-button"><div _ngcontent-eyi-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-eyi-c106="" class="handle-button copy-button"><div _ngcontent-eyi-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-eyi-c106="" class="highlight-scroll-div"><pre class="java prettyprint linenums hljs language-java" hw-language="java" data-highlighted="yes"><ol class="linenums"><li>&lt;dependency&gt;</li><li>    &lt;groupId&gt;com.alibaba&lt;/groupId&gt;</li><li>    &lt;artifactId&gt;fastjson&lt;/artifactId&gt;</li><li>    &lt;version&gt;<span class="hljs-number">1.2</span><span class="hljs-number">.83</span>&lt;/version&gt;</li><li>&lt;/dependency&gt;</li><li>&lt;dependency&gt;</li><li>    &lt;groupId&gt;org.bouncycastle&lt;/groupId&gt;</li><li>    &lt;artifactId&gt;bcprov-jdk18on&lt;/artifactId&gt;</li><li>    &lt;version&gt;<span class="hljs-number">1.74</span>&lt;/version&gt;</li><li>&lt;/dependency&gt;</li><li>&lt;dependency&gt;</li><li>    &lt;groupId&gt;commons-codec&lt;/groupId&gt;</li><li>    &lt;artifactId&gt;commons-codec&lt;/artifactId&gt;</li><li>    &lt;version&gt;<span class="hljs-number">1.15</span>&lt;/version&gt;</li><li>&lt;/dependency&gt;</li></ol></pre></div></div> </div> </div> <div></div></div>