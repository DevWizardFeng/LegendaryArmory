<h1 _ngcontent-pjo-c119="" class="doc-title ng-star-inserted" title="基础自定义弹出框 (CustomDialog)"> 基础自定义弹出框 (CustomDialog) </h1>

<div _ngcontent-pjo-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p>CustomDialog是自定义弹出框，可用于广告、中奖、警告、软件更新等与用户交互响应操作。开发者可以通过CustomDialogController类显示自定义弹出框。具体用法请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-methods-custom-dialog-box" target="_blank">自定义弹出框</a>。</p>    <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">      <p>当前，ArkUI弹出框默认为非页面级弹出框，在页面路由跳转时，如果开发者未调用close方法将其关闭，弹出框将不会自动关闭。若需实现在跳转页面时覆盖弹出框的场景，可以使用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-navigation-navigation#页面显示类型">组件导航子页面显示类型的弹窗类型</a>或者<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-embedded-dialog">页面级弹出框</a>。</p>     </div></div></div>    <p>默认为模态弹窗且有蒙层，不可与蒙层下方控件进行交互（不支持点击和手势等向下透传）。可以通过配置<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-methods-custom-dialog-box#customdialogcontrolleroptions对象说明" target="_blank">CustomDialogControllerOptions</a>中的isModal属性来实现模态和非模态弹窗，详细说明可参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-dialog-overview#弹窗的种类">弹窗的种类</a>。</p>    <p>当isModal为true时，弹出框为模态弹窗，且弹窗周围的蒙层区不支持透传。isModal为false时，弹出框为非模态弹窗，且弹窗周围的蒙层区可以透传。因此如果需要同时允许弹出框的交互和弹出框外页面的交互行为，需要将弹出框设置为非模态。</p>    <div class="tiledSection">     <h2 id="生命周期">生命周期<i class="anchor-icon anchor-icon-link" anchorid="生命周期" tips="复制节点链接"></i></h2>          <p>从API version 19开始，自定义弹出框提供了生命周期函数用于通知用户该弹出框的生命周期。生命周期的触发时序依次为：onWillAppear -&gt; onDidAppear -&gt; onWillDisappear -&gt; onDidDisappear。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.5.3.1.4.1.1" valign="top" width="33.33333333333333%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.5.3.1.4.1.2" valign="top" width="33.33333333333333%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.5.3.1.4.1.3" valign="top" width="33.33333333333333%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">onWillAppear</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">Callback&lt;void&gt;</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">弹出框显示动效前的事件回调。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">onDidAppear</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">Callback&lt;void&gt;</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">弹出框弹出后的事件回调。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">onWillDisappear</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">Callback&lt;void&gt;</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">弹出框退出动效前的事件回调。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">onDidDisappear</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">Callback&lt;void&gt;</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">弹出框消失后的事件回调。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="创建自定义弹出框">创建自定义弹出框<i class="anchor-icon anchor-icon-link" anchorid="创建自定义弹出框" tips="复制节点链接"></i></h2>          <ol>      <li>       <p>使用@CustomDialog装饰器装饰自定义弹出框，可在此装饰器内自定义弹出框内容。CustomDialogController需在@Component内定义。</p>       <div _ngcontent-pjo-c106="" class="highlight-div"><div _ngcontent-pjo-c106="" class="highlight-div-header"><div _ngcontent-pjo-c106="" class="highlight-div-header-left"><div _ngcontent-pjo-c106="" class="handle-button expand-button"><div _ngcontent-pjo-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pjo-c106="" class="highlight-div-header-right"><div _ngcontent-pjo-c106="" class="handle-button ai-button"></div><div _ngcontent-pjo-c106="" class="handle-button line-button"><div _ngcontent-pjo-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pjo-c106="" class="handle-button theme-button"><div _ngcontent-pjo-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pjo-c106="" class="handle-button copy-button"><div _ngcontent-pjo-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pjo-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@CustomDialog</span></li><li>struct <span class="hljs-title class_">CustomDialogExample</span> {</li><li>  controller?: <span class="hljs-title class_">CustomDialogController</span></li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">'我是内容'</span>)</li><li>        .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">20</span>)</li><li>    }.<span class="hljs-title function_">height</span>(<span class="hljs-number">60</span>).<span class="hljs-title function_">justifyContent</span>(<span class="hljs-title class_">FlexAlign</span>.<span class="hljs-property">Center</span>)</li><li>  }</li><li>}</li></ol></pre></div></div></li>      <li>       <p>创建构造器，与装饰器相互连接。</p>       <div _ngcontent-pjo-c106="" class="highlight-div"><div _ngcontent-pjo-c106="" class="highlight-div-header"><div _ngcontent-pjo-c106="" class="highlight-div-header-left"><div _ngcontent-pjo-c106="" class="handle-button expand-button"><div _ngcontent-pjo-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pjo-c106="" class="highlight-div-header-right"><div _ngcontent-pjo-c106="" class="handle-button ai-button"></div><div _ngcontent-pjo-c106="" class="handle-button line-button"><div _ngcontent-pjo-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pjo-c106="" class="handle-button theme-button"><div _ngcontent-pjo-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pjo-c106="" class="handle-button copy-button"><div _ngcontent-pjo-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pjo-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li> <span class="hljs-meta">@Entry</span></li><li> <span class="hljs-meta">@Component</span></li><li> struct <span class="hljs-title class_">CustomDialogUser</span> {</li><li>   <span class="hljs-attr">dialogController</span>: <span class="hljs-title class_">CustomDialogController</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">CustomDialogController</span>({</li><li>     <span class="hljs-attr">builder</span>: <span class="hljs-title class_">CustomDialogExample</span>(),</li><li>   })</li><li> }</li></ol></pre></div></div></li>      <li>       <p>点击与onClick事件绑定的组件使弹出框弹出。</p>       <div _ngcontent-pjo-c106="" class="highlight-div"><div _ngcontent-pjo-c106="" class="highlight-div-header"><div _ngcontent-pjo-c106="" class="highlight-div-header-left"><div _ngcontent-pjo-c106="" class="handle-button expand-button"><div _ngcontent-pjo-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pjo-c106="" class="highlight-div-header-right"><div _ngcontent-pjo-c106="" class="handle-button ai-button"></div><div _ngcontent-pjo-c106="" class="handle-button line-button"><div _ngcontent-pjo-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pjo-c106="" class="handle-button theme-button"><div _ngcontent-pjo-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pjo-c106="" class="handle-button copy-button"><div _ngcontent-pjo-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pjo-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">CustomDialogUser</span> {</li><li>  <span class="hljs-attr">dialogController</span>: <span class="hljs-title class_">CustomDialogController</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">CustomDialogController</span>({</li><li>    <span class="hljs-attr">builder</span>: <span class="hljs-title class_">CustomDialogExample</span>(),</li><li>  })</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'click me'</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">dialogController</span>.<span class="hljs-title function_">open</span>();</li><li>        })</li><li>    }.<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>).<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">5</span> })</li><li>  }</li><li>}</li></ol></pre></div></div>       <p><span><img originheight="712" originwidth="330" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114924.80618029107869311640969835610920:50001231000000:2800:31D9AA2BC46078FF0F924DA2C4BE7F489B3F315853A442C392D5FEDE5146CD62.png" width="330" height="712"></span></p></li>     </ol>    </div>    <div class="tiledSection">     <h2 id="弹出框的交互">弹出框的交互<i class="anchor-icon anchor-icon-link" anchorid="弹出框的交互" tips="复制节点链接"></i></h2>          <p>弹出框可用于数据交互，完成用户一系列响应操作。</p>     <ol>      <li>       <p>在@CustomDialog装饰器内添加按钮和数据函数。</p>       <div _ngcontent-pjo-c106="" class="highlight-div"><div _ngcontent-pjo-c106="" class="highlight-div-header"><div _ngcontent-pjo-c106="" class="highlight-div-header-left"><div _ngcontent-pjo-c106="" class="handle-button expand-button"><div _ngcontent-pjo-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pjo-c106="" class="highlight-div-header-right"><div _ngcontent-pjo-c106="" class="handle-button ai-button"></div><div _ngcontent-pjo-c106="" class="handle-button line-button"><div _ngcontent-pjo-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pjo-c106="" class="handle-button theme-button"><div _ngcontent-pjo-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pjo-c106="" class="handle-button copy-button"><div _ngcontent-pjo-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pjo-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@CustomDialog</span></li><li>struct <span class="hljs-title class_">CustomDialogExample</span> {</li><li>  <span class="hljs-attr">cancel</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">void</span> = <span class="hljs-function">() =&gt;</span> {</li><li>  }</li><li>  <span class="hljs-attr">confirm</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">void</span> = <span class="hljs-function">() =&gt;</span> {</li><li>  }</li><li>  controller?: <span class="hljs-title class_">CustomDialogController</span>;</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">'我是内容'</span>).<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">20</span>).<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">10</span>, <span class="hljs-attr">bottom</span>: <span class="hljs-number">10</span> })</li><li>      <span class="hljs-title class_">Flex</span>({ <span class="hljs-attr">justifyContent</span>: <span class="hljs-title class_">FlexAlign</span>.<span class="hljs-property">SpaceAround</span> }) {</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">'cancel'</span>)</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span>?.<span class="hljs-title function_">close</span>();</li><li>            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">cancel</span>) {</li><li>              <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">cancel</span>();</li><li>            }</li><li>          }).<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-number">0xffffff</span>).<span class="hljs-title function_">fontColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Black</span>)</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">'confirm'</span>)</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span>?.<span class="hljs-title function_">close</span>();</li><li>            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">confirm</span>) {</li><li>              <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">confirm</span>();</li><li>            }</li><li>          }).<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-number">0xffffff</span>).<span class="hljs-title function_">fontColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Red</span>)</li><li>      }.<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">bottom</span>: <span class="hljs-number">10</span> })</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div></li>      <li>       <p>页面内需要在构造器内进行接收，同时创建相应的函数操作。</p>       <div _ngcontent-pjo-c106="" class="highlight-div"><div _ngcontent-pjo-c106="" class="highlight-div-header"><div _ngcontent-pjo-c106="" class="highlight-div-header-left"><div _ngcontent-pjo-c106="" class="handle-button expand-button"><div _ngcontent-pjo-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pjo-c106="" class="highlight-div-header-right"><div _ngcontent-pjo-c106="" class="handle-button ai-button"></div><div _ngcontent-pjo-c106="" class="handle-button line-button"><div _ngcontent-pjo-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pjo-c106="" class="handle-button theme-button"><div _ngcontent-pjo-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pjo-c106="" class="handle-button copy-button"><div _ngcontent-pjo-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pjo-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">CustomDialogUser</span> {</li><li>  <span class="hljs-attr">dialogController</span>: <span class="hljs-title class_">CustomDialogController</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">CustomDialogController</span>({</li><li>    <span class="hljs-attr">builder</span>: <span class="hljs-title class_">CustomDialogExample</span>({</li><li>      <span class="hljs-attr">cancel</span>: <span class="hljs-function">()=&gt;</span> { <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">onCancel</span>() },</li><li>      <span class="hljs-attr">confirm</span>: <span class="hljs-function">()=&gt;</span> { <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">onAccept</span>() },</li><li>    }),</li><li>  });</li><li>
</li><li>  <span class="hljs-title function_">onCancel</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Callback when the first button is clicked'</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">onAccept</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Callback when the second button is clicked'</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'click me'</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">dialogController</span>.<span class="hljs-title function_">open</span>();</li><li>        })</li><li>    }.<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>).<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">5</span> })</li><li>  }</li><li>}</li></ol></pre></div></div>       <p><span><img originheight="530" originwidth="345" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114924.66305577282635698284451088933244:50001231000000:2800:5097D02794C542E95CB6DA0C3F9772876726F96EA4211F6CBC0DD69402CE0910.png" width="345" height="530"></span></p>       <p>3.可通过弹出框中的按钮实现路由跳转，同时获取跳转页面向当前页传入的参数。</p>       <div _ngcontent-pjo-c106="" class="highlight-div"><div _ngcontent-pjo-c106="" class="highlight-div-header"><div _ngcontent-pjo-c106="" class="highlight-div-header-left"><div _ngcontent-pjo-c106="" class="handle-button expand-button"><div _ngcontent-pjo-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pjo-c106="" class="highlight-div-header-right"><div _ngcontent-pjo-c106="" class="handle-button ai-button"></div><div _ngcontent-pjo-c106="" class="handle-button line-button"><div _ngcontent-pjo-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pjo-c106="" class="handle-button theme-button"><div _ngcontent-pjo-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pjo-c106="" class="handle-button copy-button"><div _ngcontent-pjo-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pjo-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// Index.ets</span></li><li><span class="hljs-meta">@CustomDialog</span></li><li>struct <span class="hljs-title class_">CustomDialogExample</span> {</li><li>  <span class="hljs-meta">@Link</span> <span class="hljs-attr">textValue</span>: <span class="hljs-built_in">string</span>;</li><li>  controller?: <span class="hljs-title class_">CustomDialogController</span>;</li><li>  <span class="hljs-attr">cancel</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">void</span> = <span class="hljs-function">() =&gt;</span> {</li><li>  }</li><li>  <span class="hljs-attr">confirm</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">void</span> = <span class="hljs-function">() =&gt;</span> {</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>({ <span class="hljs-attr">space</span>: <span class="hljs-number">20</span> }) {</li><li>      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">textValue</span> != <span class="hljs-string">''</span>) {</li><li>        <span class="hljs-title class_">Text</span>(<span class="hljs-string">`第二个页面的内容为：<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.textValue}</span>`</span>)</li><li>          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">20</span>)</li><li>      } <span class="hljs-keyword">else</span> {</li><li>        <span class="hljs-title class_">Text</span>(<span class="hljs-string">'是否获取第二个页面的内容'</span>)</li><li>          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">20</span>)</li><li>      }</li><li>      <span class="hljs-title class_">Flex</span>({ <span class="hljs-attr">justifyContent</span>: <span class="hljs-title class_">FlexAlign</span>.<span class="hljs-property">SpaceAround</span> }) {</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">'cancel'</span>)</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span> != <span class="hljs-literal">undefined</span>) {</li><li>              <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span>.<span class="hljs-title function_">close</span>();</li><li>              <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">cancel</span>();</li><li>            }</li><li>          }).<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-number">0xffffff</span>).<span class="hljs-title function_">fontColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Black</span>)</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">'confirm'</span>)</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span> != <span class="hljs-literal">undefined</span> &amp;&amp; <span class="hljs-variable language_">this</span>.<span class="hljs-property">textValue</span> != <span class="hljs-string">''</span>) {</li><li>              <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span>.<span class="hljs-title function_">close</span>();</li><li>            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span> != <span class="hljs-literal">undefined</span>) {</li><li>              <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getRouter</span>().<span class="hljs-title function_">pushUrl</span>({</li><li>                <span class="hljs-attr">url</span>: <span class="hljs-string">'pages/Index2'</span></li><li>              });</li><li>              <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span>.<span class="hljs-title function_">close</span>();</li><li>            }</li><li>          }).<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-number">0xffffff</span>).<span class="hljs-title function_">fontColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Red</span>)</li><li>      }.<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">bottom</span>: <span class="hljs-number">10</span> })</li><li>    }.<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">10</span>).<span class="hljs-title function_">padding</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">20</span> })</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">CustomDialogUser</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">textValue</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">''</span>;</li><li>  <span class="hljs-attr">dialogController</span>: <span class="hljs-title class_">CustomDialogController</span> | <span class="hljs-literal">null</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">CustomDialogController</span>({</li><li>    <span class="hljs-attr">builder</span>: <span class="hljs-title class_">CustomDialogExample</span>({</li><li>      <span class="hljs-attr">cancel</span>: <span class="hljs-function">() =&gt;</span> {</li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">onCancel</span>()</li><li>      },</li><li>      <span class="hljs-attr">confirm</span>: <span class="hljs-function">() =&gt;</span> {</li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">onAccept</span>()</li><li>      },</li><li>      <span class="hljs-attr">textValue</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">textValue</span></li><li>    })</li><li>  });</li><li>
</li><li>  <span class="hljs-comment">// 在自定义组件即将析构销毁时将dialogController置空</span></li><li>  <span class="hljs-title function_">aboutToDisappear</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">dialogController</span> = <span class="hljs-literal">null</span>; <span class="hljs-comment">// 将dialogController置空</span></li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">onPageShow</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">const</span> params = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getRouter</span>().<span class="hljs-title function_">getParams</span>() <span class="hljs-keyword">as</span> <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">string</span>&gt;; <span class="hljs-comment">// 获取传递过来的参数对象</span></li><li>    <span class="hljs-keyword">if</span> (params) {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">dialogController</span>?.<span class="hljs-title function_">open</span>();</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">textValue</span> = params.<span class="hljs-property">info</span> <span class="hljs-keyword">as</span> <span class="hljs-built_in">string</span>; <span class="hljs-comment">// 获取info属性的值</span></li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">onCancel</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Callback when the first button is clicked'</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">onAccept</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Callback when the second button is clicked'</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">exitApp</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Click the callback in the blank area'</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'click me'</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">dialogController</span> != <span class="hljs-literal">null</span>) {</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">dialogController</span>.<span class="hljs-title function_">open</span>();</li><li>          }</li><li>        }).<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-number">0x317aff</span>)</li><li>    }.<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>).<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">5</span> })</li><li>  }</li><li>}</li></ol></pre></div></div>       <div _ngcontent-pjo-c106="" class="highlight-div"><div _ngcontent-pjo-c106="" class="highlight-div-header"><div _ngcontent-pjo-c106="" class="highlight-div-header-left"><div _ngcontent-pjo-c106="" class="handle-button expand-button"><div _ngcontent-pjo-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pjo-c106="" class="highlight-div-header-right"><div _ngcontent-pjo-c106="" class="handle-button ai-button"></div><div _ngcontent-pjo-c106="" class="handle-button line-button"><div _ngcontent-pjo-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pjo-c106="" class="handle-button theme-button"><div _ngcontent-pjo-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pjo-c106="" class="handle-button copy-button"><div _ngcontent-pjo-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pjo-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// Index2.ets</span></li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index2</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'点击返回'</span>;</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span>)</li><li>        .<span class="hljs-title function_">type</span>(<span class="hljs-title class_">ButtonType</span>.<span class="hljs-property">Capsule</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>           <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getRouter</span>().<span class="hljs-title function_">back</span>({</li><li>             <span class="hljs-attr">url</span>: <span class="hljs-string">'pages/Index'</span>,</li><li>             <span class="hljs-attr">params</span>: {</li><li>             <span class="hljs-attr">info</span>: <span class="hljs-string">'Hello World'</span></li><li>           }</li><li>        });</li><li>      })</li><li>    }.<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>).<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>).<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">20</span> })</li><li>  }</li><li>}</li></ol></pre></div></div>       <p><span><img originheight="682" originwidth="352" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114924.68872049553048874719786459555918:50001231000000:2800:E5F0DEF9B440A702C7EBB7A54126FA4D68349CF5F62D1405AB42826289F0EE58.gif" width="352" height="682"></span></p></li>     </ol>    </div>    <div class="tiledSection">     <h2 id="弹出框的动画">弹出框的动画<i class="anchor-icon anchor-icon-link" anchorid="弹出框的动画" tips="复制节点链接"></i></h2>          <p>弹出框通过定义openAnimation控制出现动画的持续时间，速度等参数。</p>     <div _ngcontent-pjo-c106="" class="highlight-div"><div _ngcontent-pjo-c106="" class="highlight-div-header"><div _ngcontent-pjo-c106="" class="highlight-div-header-left"><div _ngcontent-pjo-c106="" class="handle-button expand-button"><div _ngcontent-pjo-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pjo-c106="" class="highlight-div-header-right"><div _ngcontent-pjo-c106="" class="handle-button ai-button"></div><div _ngcontent-pjo-c106="" class="handle-button line-button"><div _ngcontent-pjo-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pjo-c106="" class="handle-button theme-button"><div _ngcontent-pjo-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pjo-c106="" class="handle-button copy-button"><div _ngcontent-pjo-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pjo-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@CustomDialog</span></li><li>struct <span class="hljs-title class_">CustomDialogExample</span> {</li><li>  controller?: <span class="hljs-title class_">CustomDialogController</span>;</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">'Whether to change a text?'</span>).<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">16</span>).<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">bottom</span>: <span class="hljs-number">10</span> })</li><li>    }</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">CustomDialogUser</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">textValue</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">''</span>;</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">inputValue</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'click me'</span>;</li><li>  <span class="hljs-attr">dialogController</span>: <span class="hljs-title class_">CustomDialogController</span> | <span class="hljs-literal">null</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">CustomDialogController</span>({</li><li>    <span class="hljs-attr">builder</span>: <span class="hljs-title class_">CustomDialogExample</span>(),</li><li>    <span class="hljs-attr">openAnimation</span>: {</li><li>      <span class="hljs-attr">duration</span>: <span class="hljs-number">1200</span>,</li><li>      <span class="hljs-attr">curve</span>: <span class="hljs-title class_">Curve</span>.<span class="hljs-property">Friction</span>,</li><li>      <span class="hljs-attr">delay</span>: <span class="hljs-number">500</span>,</li><li>      <span class="hljs-attr">playMode</span>: <span class="hljs-title class_">PlayMode</span>.<span class="hljs-property">Alternate</span>,</li><li>      <span class="hljs-attr">onFinish</span>: <span class="hljs-function">() =&gt;</span> {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'play end'</span>)</li><li>      }</li><li>    },</li><li>    <span class="hljs-attr">autoCancel</span>: <span class="hljs-literal">true</span>,</li><li>    <span class="hljs-attr">alignment</span>: <span class="hljs-title class_">DialogAlignment</span>.<span class="hljs-property">Bottom</span>,</li><li>    <span class="hljs-attr">offset</span>: { <span class="hljs-attr">dx</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">dy</span>: -<span class="hljs-number">20</span> },</li><li>    <span class="hljs-attr">gridCount</span>: <span class="hljs-number">4</span>,</li><li>    <span class="hljs-attr">customStyle</span>: <span class="hljs-literal">false</span>,</li><li>    <span class="hljs-attr">backgroundColor</span>: <span class="hljs-number">0xd9ffffff</span>,</li><li>    <span class="hljs-attr">cornerRadius</span>: <span class="hljs-number">10</span>,</li><li>  });</li><li>
</li><li>  <span class="hljs-comment">// 在自定义组件即将析构销毁时将dialogController置空</span></li><li>  <span class="hljs-title function_">aboutToDisappear</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">dialogController</span> = <span class="hljs-literal">null</span>; <span class="hljs-comment">// 将dialogController置空</span></li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">inputValue</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">dialogController</span> != <span class="hljs-literal">null</span>) {</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">dialogController</span>.<span class="hljs-title function_">open</span>();</li><li>          }</li><li>        }).<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-number">0x317aff</span>)</li><li>    }.<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>).<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">5</span> })</li><li>  }</li><li>}</li></ol></pre></div></div>     <p><span><img originheight="779" originwidth="352" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114924.88342285252216917553207085614400:50001231000000:2800:78DDF6A1830C61B39A1993A5ADD4EF89E5E1C3B618356C523A06EE1F62547397.gif" width="352" height="779"></span></p>    </div>    <div class="tiledSection">     <h2 id="弹出框的样式">弹出框的样式<i class="anchor-icon anchor-icon-link" anchorid="弹出框的样式" tips="复制节点链接"></i></h2>          <p>通过定义弹出框的宽度、高度、背景色、阴影等参数，控制其样式。</p>     <div _ngcontent-pjo-c106="" class="highlight-div"><div _ngcontent-pjo-c106="" class="highlight-div-header"><div _ngcontent-pjo-c106="" class="highlight-div-header-left"><div _ngcontent-pjo-c106="" class="handle-button expand-button"><div _ngcontent-pjo-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pjo-c106="" class="highlight-div-header-right"><div _ngcontent-pjo-c106="" class="handle-button ai-button"></div><div _ngcontent-pjo-c106="" class="handle-button line-button"><div _ngcontent-pjo-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pjo-c106="" class="handle-button theme-button"><div _ngcontent-pjo-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pjo-c106="" class="handle-button copy-button"><div _ngcontent-pjo-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pjo-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@CustomDialog</span></li><li>struct <span class="hljs-title class_">CustomDialogExample</span> {</li><li>  controller?: <span class="hljs-title class_">CustomDialogController</span>;</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">'我是内容'</span>).<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">16</span>).<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">bottom</span>: <span class="hljs-number">10</span> })</li><li>    }</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">CustomDialogUser</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">textValue</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">''</span>;</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">inputValue</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'click me'</span>;</li><li>  <span class="hljs-attr">dialogController</span>: <span class="hljs-title class_">CustomDialogController</span> | <span class="hljs-literal">null</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">CustomDialogController</span>({</li><li>    <span class="hljs-attr">builder</span>: <span class="hljs-title class_">CustomDialogExample</span>(),</li><li>    <span class="hljs-attr">autoCancel</span>: <span class="hljs-literal">true</span>,</li><li>    <span class="hljs-attr">alignment</span>: <span class="hljs-title class_">DialogAlignment</span>.<span class="hljs-property">Center</span>,</li><li>    <span class="hljs-attr">offset</span>: { <span class="hljs-attr">dx</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">dy</span>: -<span class="hljs-number">20</span> },</li><li>    <span class="hljs-attr">gridCount</span>: <span class="hljs-number">4</span>,</li><li>    <span class="hljs-attr">customStyle</span>: <span class="hljs-literal">false</span>,</li><li>    <span class="hljs-attr">backgroundColor</span>: <span class="hljs-number">0xd9ffffff</span>,</li><li>    <span class="hljs-attr">cornerRadius</span>: <span class="hljs-number">20</span>,</li><li>    <span class="hljs-attr">width</span>: <span class="hljs-string">'80%'</span>,</li><li>    <span class="hljs-attr">height</span>: <span class="hljs-string">'100px'</span>,</li><li>    <span class="hljs-attr">borderWidth</span>: <span class="hljs-number">1</span>,</li><li>    <span class="hljs-attr">borderStyle</span>: <span class="hljs-title class_">BorderStyle</span>.<span class="hljs-property">Dashed</span>, <span class="hljs-comment">//使用borderStyle属性，需要和borderWidth属性一起使用</span></li><li>    <span class="hljs-attr">borderColor</span>: <span class="hljs-title class_">Color</span>.<span class="hljs-property">Blue</span>, <span class="hljs-comment">//使用borderColor属性，需要和borderWidth属性一起使用</span></li><li>    <span class="hljs-attr">shadow</span>: ({</li><li>      <span class="hljs-attr">radius</span>: <span class="hljs-number">20</span>,</li><li>      <span class="hljs-attr">color</span>: <span class="hljs-title class_">Color</span>.<span class="hljs-property">Grey</span>,</li><li>      <span class="hljs-attr">offsetX</span>: <span class="hljs-number">50</span>,</li><li>      <span class="hljs-attr">offsetY</span>: <span class="hljs-number">0</span></li><li>    }),</li><li>  });</li><li>
</li><li>  <span class="hljs-comment">// 在自定义组件即将析构销毁时将dialogController置空</span></li><li>  <span class="hljs-title function_">aboutToDisappear</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">dialogController</span> = <span class="hljs-literal">null</span>; <span class="hljs-comment">// 将dialogController置空</span></li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">inputValue</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">dialogController</span> != <span class="hljs-literal">null</span>) {</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">dialogController</span>.<span class="hljs-title function_">open</span>();</li><li>          }</li><li>        }).<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-number">0x317aff</span>)</li><li>    }.<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>).<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">5</span> })</li><li>  }</li><li>}</li></ol></pre></div></div>     <p><span><img originheight="455" originwidth="347" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114924.03121657252138107537311039153965:50001231000000:2800:A24C75A876E4B50020235265B65AFE0A22B61157471098171A8DA6E145CD4502.gif" width="347" height="455"></span></p>    </div>    <div class="tiledSection">     <h2 id="嵌套自定义弹出框">嵌套自定义弹出框<i class="anchor-icon anchor-icon-link" anchorid="嵌套自定义弹出框" tips="复制节点链接"></i></h2>          <p>通过第一个弹出框打开第二个弹出框时，最好将第二个弹出框定义在第一个弹出框的父组件处，通过父组件传给第一个弹出框的回调来打开第二个弹出框。</p>     <div _ngcontent-pjo-c106="" class="highlight-div"><div _ngcontent-pjo-c106="" class="highlight-div-header"><div _ngcontent-pjo-c106="" class="highlight-div-header-left"><div _ngcontent-pjo-c106="" class="handle-button expand-button"><div _ngcontent-pjo-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pjo-c106="" class="highlight-div-header-right"><div _ngcontent-pjo-c106="" class="handle-button ai-button"></div><div _ngcontent-pjo-c106="" class="handle-button line-button"><div _ngcontent-pjo-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pjo-c106="" class="handle-button theme-button"><div _ngcontent-pjo-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pjo-c106="" class="handle-button copy-button"><div _ngcontent-pjo-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pjo-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@CustomDialog</span></li><li>struct <span class="hljs-title class_">CustomDialogExampleTwo</span> {</li><li>  controllerTwo?: <span class="hljs-title class_">CustomDialogController</span>;</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">"I'm the second dialog box."</span>;</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">showIf</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">false</span>;</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">showIf</span>) {</li><li>        <span class="hljs-title class_">Text</span>(<span class="hljs-string">"Text"</span>)</li><li>          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">30</span>)</li><li>          .<span class="hljs-title function_">height</span>(<span class="hljs-number">100</span>)</li><li>      }</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span>)</li><li>        .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">30</span>)</li><li>        .<span class="hljs-title function_">height</span>(<span class="hljs-number">100</span>)</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">"Create Text"</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">showIf</span> = <span class="hljs-literal">true</span>;</li><li>        })</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'Close Second Dialog Box'</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">controllerTwo</span> != <span class="hljs-literal">undefined</span>) {</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">controllerTwo</span>.<span class="hljs-title function_">close</span>();</li><li>          }</li><li>        })</li><li>        .<span class="hljs-title function_">margin</span>(<span class="hljs-number">20</span>)</li><li>    }</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-meta">@CustomDialog</span></li><li>struct <span class="hljs-title class_">CustomDialogExample</span> {</li><li>  openSecondBox?: <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">void</span></li><li>  controller?: <span class="hljs-title class_">CustomDialogController</span></li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'Open Second Dialog Box and close this box'</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span>!.<span class="hljs-title function_">close</span>();</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">openSecondBox</span>!();</li><li>        })</li><li>        .<span class="hljs-title function_">margin</span>(<span class="hljs-number">20</span>)</li><li>    }.<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">10</span>)</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">CustomDialogUser</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">inputValue</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'Click Me'</span>;</li><li>  <span class="hljs-attr">dialogController</span>: <span class="hljs-title class_">CustomDialogController</span> | <span class="hljs-literal">null</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">CustomDialogController</span>({</li><li>    <span class="hljs-attr">builder</span>: <span class="hljs-title class_">CustomDialogExample</span>({</li><li>      <span class="hljs-attr">openSecondBox</span>: <span class="hljs-function">() =&gt;</span> {</li><li>        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">dialogControllerTwo</span> != <span class="hljs-literal">null</span>) {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">dialogControllerTwo</span>.<span class="hljs-title function_">open</span>()</li><li>        }</li><li>      }</li><li>    }),</li><li>    <span class="hljs-attr">cancel</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">exitApp</span>,</li><li>    <span class="hljs-attr">autoCancel</span>: <span class="hljs-literal">true</span>,</li><li>    <span class="hljs-attr">alignment</span>: <span class="hljs-title class_">DialogAlignment</span>.<span class="hljs-property">Bottom</span>,</li><li>    <span class="hljs-attr">offset</span>: { <span class="hljs-attr">dx</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">dy</span>: -<span class="hljs-number">20</span> },</li><li>    <span class="hljs-attr">gridCount</span>: <span class="hljs-number">4</span>,</li><li>    <span class="hljs-attr">customStyle</span>: <span class="hljs-literal">false</span></li><li>  });</li><li>  <span class="hljs-attr">dialogControllerTwo</span>: <span class="hljs-title class_">CustomDialogController</span> | <span class="hljs-literal">null</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">CustomDialogController</span>({</li><li>    <span class="hljs-attr">builder</span>: <span class="hljs-title class_">CustomDialogExampleTwo</span>(),</li><li>    <span class="hljs-attr">alignment</span>: <span class="hljs-title class_">DialogAlignment</span>.<span class="hljs-property">Bottom</span>,</li><li>    <span class="hljs-attr">offset</span>: { <span class="hljs-attr">dx</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">dy</span>: -<span class="hljs-number">25</span> }</li><li>  });</li><li>
</li><li>  <span class="hljs-title function_">aboutToDisappear</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">dialogController</span> = <span class="hljs-literal">null</span>;</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">dialogControllerTwo</span> = <span class="hljs-literal">null</span>;</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">onCancel</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Callback when the first button is clicked'</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">onAccept</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Callback when the second button is clicked'</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">exitApp</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Click the callback in the blank area'</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">inputValue</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">dialogController</span> != <span class="hljs-literal">null</span>) {</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">dialogController</span>.<span class="hljs-title function_">open</span>();</li><li>          }</li><li>        }).<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-number">0x317aff</span>)</li><li>    }.<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>).<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">5</span> })</li><li>  }</li><li>}</li></ol></pre></div></div>     <p><span><img originheight="687" originwidth="308" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114924.20455367691535095138168405453082:50001231000000:2800:4A15A34EE7A012E9B5208443BDBF0F9D6BEF2A49D6325D614D5C85228D496184.gif" width="308" height="687"></span></p>     <p>由于自定义弹出框在状态管理侧有父子关系，如果将第二个弹出框定义在第一个弹出框内，那么当父组件（第一个弹出框）被销毁（关闭）时，子组件（第二个弹出框）内无法再继续创建新的组件。</p>    </div>    <div class="tiledSection">     <h2 id="实现弹出框的物理返回拦截">实现弹出框的物理返回拦截<i class="anchor-icon anchor-icon-link" anchorid="实现弹出框的物理返回拦截" tips="复制节点链接"></i></h2>          <p>执行点击遮障层关闭、侧滑（左滑或右滑）、三键Back、键盘ESC关闭等交互操作时，如果注册了<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-methods-custom-dialog-box#customdialogcontrolleroptions对象说明" target="_blank">CustomDialogControllerOptions</a>中的onWillDismiss回调函数，弹出框不会立即关闭。在回调函数中，通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-methods-custom-dialog-box#dismissdialogaction12" target="_blank">DismissDialogAction</a>中的reason属性获取阻拦关闭弹出框的操作类型，根据原因决定是否关闭弹出框。</p>     <div _ngcontent-pjo-c106="" class="highlight-div"><div _ngcontent-pjo-c106="" class="highlight-div-header"><div _ngcontent-pjo-c106="" class="highlight-div-header-left"><div _ngcontent-pjo-c106="" class="handle-button expand-button"><div _ngcontent-pjo-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pjo-c106="" class="highlight-div-header-right"><div _ngcontent-pjo-c106="" class="handle-button ai-button"></div><div _ngcontent-pjo-c106="" class="handle-button line-button"><div _ngcontent-pjo-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pjo-c106="" class="handle-button theme-button"><div _ngcontent-pjo-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pjo-c106="" class="handle-button copy-button"><div _ngcontent-pjo-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pjo-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@CustomDialog</span></li><li>struct <span class="hljs-title class_">CustomDialogExample</span> {</li><li>  <span class="hljs-attr">cancel</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">void</span> = <span class="hljs-function">() =&gt;</span> {</li><li>  }</li><li>  <span class="hljs-attr">confirm</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">void</span> = <span class="hljs-function">() =&gt;</span> {</li><li>  }</li><li>  controller?: <span class="hljs-title class_">CustomDialogController</span>;</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">'Are you sure?'</span>)</li><li>        .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">20</span>)</li><li>        .<span class="hljs-title function_">margin</span>({</li><li>          <span class="hljs-attr">top</span>: <span class="hljs-number">10</span>,</li><li>          <span class="hljs-attr">bottom</span>: <span class="hljs-number">10</span></li><li>        })</li><li>      <span class="hljs-title class_">Row</span>() {</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">'cancel'</span>)</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span> != <span class="hljs-literal">undefined</span>) {</li><li>              <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span>.<span class="hljs-title function_">close</span>();</li><li>            }</li><li>          })</li><li>          .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-number">0xffffff</span>)</li><li>          .<span class="hljs-title function_">fontColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Black</span>)</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">'confirm'</span>)</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span> != <span class="hljs-literal">undefined</span>) {</li><li>              <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span>.<span class="hljs-title function_">close</span>();</li><li>            }</li><li>          })</li><li>          .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-number">0xffffff</span>)</li><li>          .<span class="hljs-title function_">fontColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Red</span>)</li><li>      }</li><li>      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>      .<span class="hljs-title function_">justifyContent</span>(<span class="hljs-title class_">FlexAlign</span>.<span class="hljs-property">SpaceAround</span>)</li><li>      .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">bottom</span>: <span class="hljs-number">10</span> })</li><li>    }</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">InterceptCustomDialog</span> {</li><li>  <span class="hljs-attr">dialogController</span>: <span class="hljs-title class_">CustomDialogController</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">CustomDialogController</span>({</li><li>    <span class="hljs-attr">builder</span>: <span class="hljs-title class_">CustomDialogExample</span>({</li><li>      <span class="hljs-attr">cancel</span>: <span class="hljs-function">() =&gt;</span> {</li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">onCancel</span>();</li><li>      },</li><li>      <span class="hljs-attr">confirm</span>: <span class="hljs-function">() =&gt;</span> {</li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">onAccept</span>();</li><li>      }</li><li>    }),</li><li>    <span class="hljs-attr">onWillDismiss</span>: <span class="hljs-function">(<span class="hljs-params">dismissDialogAction: DismissDialogAction</span>) =&gt;</span> {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'dialog onWillDismiss reason: '</span> + dismissDialogAction.<span class="hljs-property">reason</span>);</li><li>      <span class="hljs-comment">// 1、PRESS_BACK    点击三键back、侧滑（左滑/右滑）、键盘ESC。</span></li><li>      <span class="hljs-comment">// 2、TOUCH_OUTSIDE    点击遮障层时</span></li><li>      <span class="hljs-comment">// 3、CLOSE_BUTTON    点击关闭按钮</span></li><li>      <span class="hljs-keyword">if</span> (dismissDialogAction.<span class="hljs-property">reason</span> === <span class="hljs-title class_">DismissReason</span>.<span class="hljs-property">PRESS_BACK</span>) {</li><li>        <span class="hljs-comment">// 处理业务逻辑后通过dismiss主动关闭对话框</span></li><li>        <span class="hljs-comment">// dismissDialogAction.dismiss();</span></li><li>      }</li><li>      <span class="hljs-keyword">if</span> (dismissDialogAction.<span class="hljs-property">reason</span> === <span class="hljs-title class_">DismissReason</span>.<span class="hljs-property">TOUCH_OUTSIDE</span>) {</li><li>        <span class="hljs-comment">// dismissDialogAction.dismiss();</span></li><li>      }</li><li>    },</li><li>    <span class="hljs-attr">alignment</span>: <span class="hljs-title class_">DialogAlignment</span>.<span class="hljs-property">Bottom</span>,</li><li>    <span class="hljs-attr">offset</span>: { <span class="hljs-attr">dx</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">dy</span>: -<span class="hljs-number">20</span> }</li><li>  })</li><li>
</li><li>  <span class="hljs-title function_">onCancel</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Callback when the first button is clicked'</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">onAccept</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Callback when the second button is clicked'</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'click me'</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">dialogController</span>.<span class="hljs-title function_">open</span>();</li><li>        })</li><li>    }</li><li>    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div>     <p><span><img originheight="759" originwidth="351" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114924.76755717282070457473153688264998:50001231000000:2800:59A1B5AE7F3B52D9E31AEDC7430C7E7A7D606A213ACAB731CF88604FCF94896C.gif" width="351" height="759"></span></p>    </div>    <div class="tiledSection">     <h2 id="设置弹出框避让软键盘的距离">设置弹出框避让软键盘的距离<i class="anchor-icon anchor-icon-link" anchorid="设置弹出框避让软键盘的距离" tips="复制节点链接"></i></h2>          <p>为显示弹出框的独立性，弹出框弹出时会与周边进行避让，包括状态栏、导航条以及键盘等留有间距。故当软键盘弹出时，默认情况下，弹出框会自动避开软键盘，并与之保持16vp的距离。从API version 15开始，开发者可以利用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-methods-custom-dialog-box#customdialogcontrolleroptions对象说明" target="_blank">CustomDialogControllerOptions</a>中的keyboardAvoidMode和keyboardAvoidDistance这两个配置项，来设置弹出框在软键盘弹出时的行为，包括是否需要避开软键盘以及与软键盘之间的距离。</p>     <p>设置软键盘间距时，需要将keyboardAvoidMode值设为KeyboardAvoidMode.DEFAULT。</p>     <div _ngcontent-pjo-c106="" class="highlight-div"><div _ngcontent-pjo-c106="" class="highlight-div-header"><div _ngcontent-pjo-c106="" class="highlight-div-header-left"><div _ngcontent-pjo-c106="" class="handle-button expand-button"><div _ngcontent-pjo-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pjo-c106="" class="highlight-div-header-right"><div _ngcontent-pjo-c106="" class="handle-button ai-button"></div><div _ngcontent-pjo-c106="" class="handle-button line-button"><div _ngcontent-pjo-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pjo-c106="" class="handle-button theme-button"><div _ngcontent-pjo-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pjo-c106="" class="handle-button copy-button"><div _ngcontent-pjo-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pjo-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// xxx.ets</span></li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">LengthMetrics</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span></li><li>
</li><li><span class="hljs-meta">@CustomDialog</span></li><li>struct <span class="hljs-title class_">CustomDialogExample</span> {</li><li>  controller?: <span class="hljs-title class_">CustomDialogController</span>;</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Column</span>() {</li><li>        <span class="hljs-title class_">Text</span>(<span class="hljs-string">'keyboardAvoidDistance: 0vp'</span>)</li><li>          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">20</span>)</li><li>          .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">bottom</span>: <span class="hljs-number">36</span> })</li><li>        <span class="hljs-title class_">TextInput</span>({ <span class="hljs-attr">placeholder</span>: <span class="hljs-string">''</span> })</li><li>      }.<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">'#FFF0F0F0'</span>)</li><li>    }</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-attr">dialogController</span>: <span class="hljs-title class_">CustomDialogController</span> | <span class="hljs-literal">null</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">CustomDialogController</span>({</li><li>    <span class="hljs-attr">builder</span>: <span class="hljs-title class_">CustomDialogExample</span>({}),</li><li>    <span class="hljs-attr">autoCancel</span>: <span class="hljs-literal">true</span>,</li><li>    <span class="hljs-attr">gridCount</span>: <span class="hljs-number">4</span>,</li><li>    <span class="hljs-attr">showInSubWindow</span>: <span class="hljs-literal">true</span>,</li><li>    <span class="hljs-attr">isModal</span>: <span class="hljs-literal">true</span>,</li><li>    <span class="hljs-attr">customStyle</span>: <span class="hljs-literal">false</span>,</li><li>    <span class="hljs-attr">cornerRadius</span>: <span class="hljs-number">30</span>,</li><li>    <span class="hljs-attr">alignment</span>: <span class="hljs-title class_">DialogAlignment</span>.<span class="hljs-property">Bottom</span>,</li><li>    <span class="hljs-attr">keyboardAvoidMode</span>: <span class="hljs-title class_">KeyboardAvoidMode</span>.<span class="hljs-property">DEFAULT</span>, <span class="hljs-comment">// 软键盘弹出时，弹出框自动避让</span></li><li>    <span class="hljs-attr">keyboardAvoidDistance</span>: <span class="hljs-title class_">LengthMetrics</span>.<span class="hljs-title function_">vp</span>(<span class="hljs-number">0</span>) <span class="hljs-comment">// 软键盘弹出时与弹出框的距离为0vp</span></li><li>  })</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Row</span>() {</li><li>      <span class="hljs-title class_">Row</span>({ <span class="hljs-attr">space</span>: <span class="hljs-number">20</span> }) {</li><li>        <span class="hljs-title class_">Text</span>(<span class="hljs-string">'打开弹窗'</span>)</li><li>          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">30</span>)</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">dialogController</span> != <span class="hljs-literal">null</span>) {</li><li>              <span class="hljs-variable language_">this</span>.<span class="hljs-property">dialogController</span>.<span class="hljs-title function_">open</span>();</li><li>            }</li><li>          })</li><li>      }</li><li>      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    }</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div>     <p><span><img originheight="662" originwidth="400" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114924.45220518353985497168620034539357:50001231000000:2800:7142CDCFB3F252C770C5AC596A013ED5C928D428681F3468C7CE6E296CDF0494.gif" width="400" height="662"></span></p>    </div>    <div class="tiledSection">     <h2 id="获取弹出框的状态">获取弹出框的状态<i class="anchor-icon anchor-icon-link" anchorid="获取弹出框的状态" tips="复制节点链接"></i></h2>          <p>在业务模块中，页面上可能会同时出现多个弹出框。为避免重复打开相同的弹出框，建议在显示弹出框前，先通过控制器检查其当前状态。如果弹出框已处于显示状态，则不应再次打开。</p>     <p>从API version 20开始，新增了getState接口，用于获取弹出框的当前状态。具体的弹出框状态信息，请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-promptaction#commonstate20枚举说明" target="_blank">CommonState</a>枚举的详细说明。</p>     <p>以下示例通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-custom-component-api#getdialogcontroller18" target="_blank">getDialogController</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-methods-custom-dialog-box#customdialogcontroller" target="_blank">CustomDialogController</a>两种方法，实现了获取弹出框当前状态的功能。</p>     <div _ngcontent-pjo-c106="" class="highlight-div"><div _ngcontent-pjo-c106="" class="highlight-div-header"><div _ngcontent-pjo-c106="" class="highlight-div-header-left"><div _ngcontent-pjo-c106="" class="handle-button expand-button"><div _ngcontent-pjo-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pjo-c106="" class="highlight-div-header-right"><div _ngcontent-pjo-c106="" class="handle-button ai-button"></div><div _ngcontent-pjo-c106="" class="handle-button line-button"><div _ngcontent-pjo-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pjo-c106="" class="handle-button theme-button"><div _ngcontent-pjo-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pjo-c106="" class="handle-button copy-button"><div _ngcontent-pjo-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pjo-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// xxx.ets</span></li><li><span class="hljs-meta">@CustomDialog</span></li><li>struct <span class="hljs-title class_">CustomDialogExample</span> {</li><li>  controller?: <span class="hljs-title class_">CustomDialogController</span></li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'点我查询弹窗状态:通过自定义组件自带controller'</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getDialogController</span>() != <span class="hljs-literal">undefined</span>) {</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'state:'</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getDialogController</span>().<span class="hljs-title function_">getState</span>())</li><li>          } <span class="hljs-keyword">else</span> {</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'state: no exist'</span>)</li><li>          }</li><li>        }).<span class="hljs-title function_">margin</span>(<span class="hljs-number">20</span>)</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'点我查询弹窗状态:通过CustomDialogController '</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'state:'</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span>?.<span class="hljs-title function_">getState</span>())</li><li>        }).<span class="hljs-title function_">margin</span>(<span class="hljs-number">20</span>)</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'点我关闭弹窗'</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getDialogController</span>() != <span class="hljs-literal">undefined</span>) {</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getDialogController</span>().<span class="hljs-title function_">close</span>()</li><li>          }</li><li>        }).<span class="hljs-title function_">margin</span>(<span class="hljs-number">20</span>)</li><li>      </li><li>    }</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">CustomDialogUser</span> {</li><li>  <span class="hljs-attr">dialogController</span>: <span class="hljs-title class_">CustomDialogController</span> | <span class="hljs-literal">null</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">CustomDialogController</span>({</li><li>    <span class="hljs-attr">builder</span>: <span class="hljs-title class_">CustomDialogExample</span>({</li><li>    }),</li><li>    <span class="hljs-attr">autoCancel</span>: <span class="hljs-literal">false</span></li><li>  })</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'click me'</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">dialogController</span> != <span class="hljs-literal">null</span>) {</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">dialogController</span>.<span class="hljs-title function_">open</span>()</li><li>          }</li><li>        })</li><li>    }.<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>).<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">5</span> })</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>   </div>   <div></div></div>