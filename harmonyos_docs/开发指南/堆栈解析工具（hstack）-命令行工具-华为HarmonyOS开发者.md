<h1 _ngcontent-uuq-c119="" class="doc-title ng-star-inserted" title="堆栈解析工具（hstack）"> 堆栈解析工具（hstack） </h1>

<div _ngcontent-uuq-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div id="body0000001777724494"><div class="tiledSection"><h2 id="section11388623181619">简介<i class="anchor-icon anchor-icon-link" anchorid="section11388623181619" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510294315__zh-cn_topic_0000001169160500_p1433535015258">hstack是为开发人员提供的用于将release应用混淆后的crash堆栈解析为源码对应堆栈的工具，支持Windows、Mac、Linux三个平台，关于堆栈解析的原理，请查看<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-exception-stack-parsing-principle" target="_blank">异常堆栈解析原理</a>。</p> <p id="ZH-CN_TOPIC_0000002510294315__p1385762035214">hstack命令行格式为：</p> <div _ngcontent-uuq-c106="" class="highlight-div"><div _ngcontent-uuq-c106="" class="highlight-div-header"><div _ngcontent-uuq-c106="" class="highlight-div-header-left"><div _ngcontent-uuq-c106="" class="handle-button expand-button"><div _ngcontent-uuq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-uuq-c106="" class="highlight-div-header-right"><div _ngcontent-uuq-c106="" class="handle-button ai-button"></div><div _ngcontent-uuq-c106="" class="handle-button line-button"><div _ngcontent-uuq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-uuq-c106="" class="handle-button theme-button"><div _ngcontent-uuq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-uuq-c106="" class="handle-button copy-button"><div _ngcontent-uuq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-uuq-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-css" id="ZH-CN_TOPIC_0000002510294315__screen15948182245615" data-highlighted="yes"><ol class="linenums"><li>hstack <span class="hljs-selector-attr">[options]</span></li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002510294315__p13361519135615">options: 可选配置，请参考<a href="/consumer/cn/doc/harmonyos-guides/ide-command-line-hstack#table25697717185">表hstack命令行配置</a>。</p>  <div class="tablenoborder"><div class="tbBox"><table id="table25697717185" class="layoutFixed idpTab"><caption><b>表1 </b>hstack命令行配置</caption><thead><tr id="ZH-CN_TOPIC_0000002510294315__row45683791812"><th align="left" class="cellrowborder" id="mcps1.3.1.6.2.3.1.1" valign="top" width="28.67%"><p id="ZH-CN_TOPIC_0000002510294315__p10568187161818">指令</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.1.6.2.3.1.2" valign="top" width="71.33%"><p id="ZH-CN_TOPIC_0000002510294315__p456819751812">说明</p> </th> </tr> </thead> <tbody><tr id="ZH-CN_TOPIC_0000002510294315__row1531313105115"><td class="cellrowborder" valign="top" width="28.67%"><p id="ZH-CN_TOPIC_0000002510294315__p13141937514">-i/--input</p> </td> <td class="cellrowborder" valign="top" width="71.33%"><p id="ZH-CN_TOPIC_0000002510294315__p1631415319511">可选，指定工程crash文件归档目录。</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002510294315__row13735135965016"><td class="cellrowborder" valign="top" width="28.67%"><p id="ZH-CN_TOPIC_0000002510294315__p2736125917505">-c/--crash</p> </td> <td class="cellrowborder" valign="top" width="71.33%"><p id="ZH-CN_TOPIC_0000002510294315__p16736115917506">可选，指定一条crash堆栈。</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002510294315__row1476745685011"><td class="cellrowborder" valign="top" width="28.67%"><p id="ZH-CN_TOPIC_0000002510294315__p37671956145018">-o/--output</p> </td> <td class="cellrowborder" valign="top" width="71.33%"><p id="ZH-CN_TOPIC_0000002510294315__p16767185613504">可选，指定解析结果输出目录（输入指定为-c时， -o参数指定一个输出文件）。</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002510294315__row75682710186"><td class="cellrowborder" valign="top" width="28.67%"><p id="ZH-CN_TOPIC_0000002510294315__p185680741816">-s/--sourcemapDir</p> </td> <td class="cellrowborder" valign="top" width="71.33%"><p id="ZH-CN_TOPIC_0000002510294315__p356887161811">可选，指定工程sourcemap文件归档目录。</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002510294315__row1856914711817"><td class="cellrowborder" valign="top" width="28.67%"><p id="ZH-CN_TOPIC_0000002510294315__p95691379185">--so/--soDir</p> </td> <td class="cellrowborder" valign="top" width="71.33%"><p id="ZH-CN_TOPIC_0000002510294315__p1856917141818">可选，指定工程shared object文件归档目录。</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002510294315__row5838151813562"><td class="cellrowborder" valign="top" width="28.67%"><p id="ZH-CN_TOPIC_0000002510294315__p2838161825615">-n/--nameObfuscation</p> </td> <td class="cellrowborder" valign="top" width="71.33%"><p id="ZH-CN_TOPIC_0000002510294315__p1983961811563">可选 ，指定工程nameCache文件归档目录。</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002510294315__row412542116446"><td class="cellrowborder" valign="top" width="28.67%"><p id="ZH-CN_TOPIC_0000002510294315__p71261821134411">-v/--version</p> </td> <td class="cellrowborder" valign="top" width="71.33%"><p id="ZH-CN_TOPIC_0000002510294315__p1512602174410">查看hstack版本。</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002510294315__row4569778189"><td class="cellrowborder" valign="top" width="28.67%"><p id="ZH-CN_TOPIC_0000002510294315__p12569107161820">-h/--help</p> </td> <td class="cellrowborder" valign="top" width="71.33%"><p id="ZH-CN_TOPIC_0000002510294315__p1056918716186">查询hstack命令行帮助。</p> </td> </tr>  </tbody></table></div> </div> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><ul id="ZH-CN_TOPIC_0000002510294315__ul155443431016"><li id="li9543161105318">crash文件归档目录与crash堆栈必须且只能提供一项。</li><li id="li9544194101015">sourcemap与shared object文件归档目录至少提供一项。</li><li id="li16544184141011">如果需要对方法名进行解析还原，则需要同时提供sourcemap与nameCache文件。</li><li id="li152701822616">路径参数不支持以下特殊字符：`~!@#$^&amp;*=|{};,\s\[\]&lt;&gt;?~！@#￥……&amp;*（）——|{}【】‘；：。，、？</li></ul> </div></div></div> </div> <div class="tiledSection"><h2 id="section4733184816412">环境配置<i class="anchor-icon anchor-icon-link" anchorid="section4733184816412" tips="复制节点链接"></i></h2><ol id="ZH-CN_TOPIC_0000002510294315__ol6199104220140"><li id="li13112192916514">hstack工具在Command Line Tools的bin目录下，需要<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-commandline-get#section17776863449">将bin目录配置到PATH变量中</a>。</li><li id="li31991842141413">本工具依赖Node环境，需要<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-command-line-building-app#section159168531288">将Node.js配置到环境变量中</a>。</li><li id="li31999421146">如果需要对C++文件产生的异常进行解析，则需要将SDK中的native\llvm\bin目录配置到环境变量中，变量名设置为“ADDR2LINE_PATH”。<p id="ZH-CN_TOPIC_0000002510294315__p121745291688"><span><img originheight="186" originwidth="656" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104945.55739509619017296577833758328198:50001231000000:2800:76A77039AC494F2090A3D761247BA32F4F2BB6CD93B176AD5FF3AEB09713C90B.png" width="656" height="186"></span></p> </li></ol> </div> <div class="tiledSection"><h2 id="section5181330815">使用示例<i class="anchor-icon anchor-icon-link" anchorid="section5181330815" tips="复制节点链接"></i></h2><ol id="ZH-CN_TOPIC_0000002510294315__ol1194013133320"><li id="li6940201318313"><span>将应用产生的crash文件归档到crashDir目录下（或者-c指定一条crash堆栈），关于堆栈的获取方式请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/crash-detection-overview" target="_blank">崩溃检测</a>。</span><p></p><p id="ZH-CN_TOPIC_0000002510294315__p68075171735"><span><img originheight="82" originwidth="196" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104945.43143509433749151663954909970399:50001231000000:2800:02382C0218E1CBE5FCA1E15FE664173B2675624CF0CDFD8F4BBD9F1900A2B844.png" class="notEnlarge" width="196" height="82"></span></p> <p></p></li><li id="li7218198151217"><span>使用-o指定输出目录，当不指定时，会输出至-i指定的crashDir目录下（通过-c输入为crash堆栈时，可以使用-o指定一个输出文件，或不指定，直接将结果输出至控制台）。</span></li><li id="li09403131136"><span>使用-s指定工程对应sourcemap文件归档目录（可选，与shared object文件归档目录至少提供一项）。</span><p></p><p id="ZH-CN_TOPIC_0000002510294315__p7483191910315"><span><img originheight="106" originwidth="672" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104945.02410838396118695366101362713267:50001231000000:2800:AAE4B879957AA1AD323BB1A4FFB06C42CAE57747683185D2DBAAA0C8E6FA82D2.png" width="672" height="106"></span></p> <p></p></li><li id="li129400130315"><span>使用--so指定shared object文件归档目录（可选，与sourcemap归档目录至少提供一项）。</span><p></p><p id="ZH-CN_TOPIC_0000002510294315__p188691721235"><span><img originheight="145" originwidth="641" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104945.63329013501822945440697996867795:50001231000000:2800:FA6B4C3E80EB03A1B495175F749856C776E22374811CD198380B6E745E15048B.png" width="641" height="145"></span></p> <p></p></li><li id="li78911541123013"><span>使用-n指定nameCache文件归档目录（可选）。</span><p></p><p id="ZH-CN_TOPIC_0000002510294315__p4841936183017"><span><img originheight="99" originwidth="568" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104945.46116209989894016492923385893401:50001231000000:2800:E8580B098A42B6E2B480E85D02F33C7D0DCB3FCACC807B953BBF9154E121B4EC.png" width="568" height="99"></span></p> <p></p></li><li id="li19404131137"><span>执行以下命令，可将release应用crash堆栈解析为源码对应堆栈，并将解析结果输出至outputDir目录：</span><p></p><div _ngcontent-uuq-c106="" class="highlight-div"><div _ngcontent-uuq-c106="" class="highlight-div-header"><div _ngcontent-uuq-c106="" class="highlight-div-header-left"><div _ngcontent-uuq-c106="" class="handle-button expand-button"><div _ngcontent-uuq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-uuq-c106="" class="highlight-div-header-right"><div _ngcontent-uuq-c106="" class="handle-button ai-button"></div><div _ngcontent-uuq-c106="" class="handle-button line-button"><div _ngcontent-uuq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-uuq-c106="" class="handle-button theme-button"><div _ngcontent-uuq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-uuq-c106="" class="handle-button copy-button"><div _ngcontent-uuq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-uuq-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-css" id="ZH-CN_TOPIC_0000002510294315__screen1855835169" data-highlighted="yes"><ol class="linenums"><li>hstack -<span class="hljs-selector-tag">i</span> crashDir -o outputDir -s sourcemapDir <span class="hljs-attr">--so</span> soDir -n nameCacheDir</li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002510294315__p1664021614715"><span><img originheight="86" originwidth="958" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104945.79627653004347700843426626802630:50001231000000:2800:9EF41CCB008BE726BA6A69A789DF41845791FC92AB4B47DE13E073C80A6386BD.png" width="920" height="82.58872651356994"></span></p> <p id="ZH-CN_TOPIC_0000002510294315__p15516192816319">解析完成后，outputDir目录下会生成对应的解析结果，文件以原始crash文件名加“_”前缀进行命名。crash堆栈中的C++日志以及ArkTS日志均已解析为源码对应的文件路径以及行列号，结果如下图所示：</p> <p id="ZH-CN_TOPIC_0000002510294315__p175801235635"><span><img originheight="465" originwidth="1453" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104945.54713726347301815566423574444582:50001231000000:2800:B4D1D8CC751566DEC8D096A1D22DA1A4D681B30374A4459D764B94C611F664AE.png" width="920" height="294.4253269098417"></span></p> <p id="ZH-CN_TOPIC_0000002510294315__p18537145203717">说明：在构建Release应用时，so文件是默认不包含符号表信息的，如果需要在构建Release应用时生成包含符号表的so文件，需要在工程的模块级build-profile.json5文件的buildOption属性中，配置如下信息：</p> <div _ngcontent-uuq-c106="" class="highlight-div"><div _ngcontent-uuq-c106="" class="highlight-div-header"><div _ngcontent-uuq-c106="" class="highlight-div-header-left"><div _ngcontent-uuq-c106="" class="handle-button expand-button"><div _ngcontent-uuq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-uuq-c106="" class="highlight-div-header-right"><div _ngcontent-uuq-c106="" class="handle-button ai-button"></div><div _ngcontent-uuq-c106="" class="handle-button line-button"><div _ngcontent-uuq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-uuq-c106="" class="handle-button theme-button"><div _ngcontent-uuq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-uuq-c106="" class="handle-button copy-button"><div _ngcontent-uuq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-uuq-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" id="ZH-CN_TOPIC_0000002510294315__screen103041711115016" data-highlighted="yes"><ol class="linenums"><li><span class=""><span class="hljs-string">"buildOption"</span></span><span class="">: </span>{</li><li>  <span class=""><span class="hljs-string">"externalNativeOptions"</span></span><span class="">: </span>{</li><li>    <span class=""><span class="hljs-string">"arguments"</span></span><span class="">: </span><span class=""><span class="hljs-string">"-DCMAKE_BUILD_TYPE=RelWithDebInfo"</span></span></li><li>  }</li><li>}</li></ol></pre></div></div> <p></p></li></ol> </div> <div class="tiledSection"><h2 id="section3259141085218">堆栈解析方案说明<i class="anchor-icon anchor-icon-link" anchorid="section3259141085218" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510294315__p0256141011520">以如下代码为例。</p> <p id="ZH-CN_TOPIC_0000002510294315__p0256171011523">Entry模块通过独立har包形式引用har模块中的har方法：</p> <div _ngcontent-uuq-c106="" class="highlight-div"><div _ngcontent-uuq-c106="" class="highlight-div-header"><div _ngcontent-uuq-c106="" class="highlight-div-header-left"><div _ngcontent-uuq-c106="" class="handle-button expand-button"><div _ngcontent-uuq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-uuq-c106="" class="highlight-div-header-right"><div _ngcontent-uuq-c106="" class="handle-button ai-button"></div><div _ngcontent-uuq-c106="" class="handle-button line-button"><div _ngcontent-uuq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-uuq-c106="" class="handle-button theme-button"><div _ngcontent-uuq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-uuq-c106="" class="handle-button copy-button"><div _ngcontent-uuq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-uuq-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-typescript" id="ZH-CN_TOPIC_0000002510294315__screen325914104524" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> {har} <span class="hljs-keyword">from</span> <span class="hljs-string">'Har'</span></li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">har</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'Har'</span>;</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Row</span>() {</li><li>      <span class="hljs-title class_">Column</span>() {</li><li>        <span class="hljs-title class_">Text</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">har</span>)</li><li>          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">50</span>)</li><li>          .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-keyword">let</span> entryClass = <span class="hljs-keyword">new</span> <span class="hljs-title class_">EntryClass</span>();</li><li>            entryClass.<span class="hljs-title function_">callHarFunction</span>();</li><li>          })</li><li>      }</li><li>      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    }</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryClass</span> {</li><li>  <span class="hljs-title function_">callHarFunction</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title function_">har</span>()</li><li>  }</li><li>}</li></ol></pre></div></div> <div _ngcontent-uuq-c106="" class="highlight-div"><div _ngcontent-uuq-c106="" class="highlight-div-header"><div _ngcontent-uuq-c106="" class="highlight-div-header-left"><div _ngcontent-uuq-c106="" class="handle-button expand-button"><div _ngcontent-uuq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-uuq-c106="" class="highlight-div-header-right"><div _ngcontent-uuq-c106="" class="handle-button ai-button"></div><div _ngcontent-uuq-c106="" class="handle-button line-button"><div _ngcontent-uuq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-uuq-c106="" class="handle-button theme-button"><div _ngcontent-uuq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-uuq-c106="" class="handle-button copy-button"><div _ngcontent-uuq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-uuq-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-scss" id="ZH-CN_TOPIC_0000002510294315__screen0259910175218" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">@Component</span></li><li>export struct MainPage {</li><li>  <span class="hljs-keyword">@State</span> <span class="hljs-attribute">message</span>: string = <span class="hljs-string">'Hello World'</span>;</li><li>
</li><li>  <span class="hljs-built_in">build</span>() {</li><li>    <span class="hljs-built_in">Row</span>() {</li><li>      <span class="hljs-built_in">Column</span>() {</li><li>        Text(this.message)</li><li>          <span class="hljs-selector-class">.fontSize</span>(<span class="hljs-number">50</span>)</li><li>          <span class="hljs-selector-class">.fontWeight</span>(FontWeight.Bold)</li><li>      }</li><li>      <span class="hljs-selector-class">.width</span>('<span class="hljs-number">100%</span>')</li><li>    }</li><li>    <span class="hljs-selector-class">.height</span>('<span class="hljs-number">100%</span>')</li><li>  }</li><li>}</li><li>
</li><li>export function <span class="hljs-built_in">har</span>() {</li><li>  <span class="hljs-built_in">BigInt</span>(<span class="hljs-number">1.1</span>)</li><li>}</li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002510294315__p9259161018523">生成的crash如下：</p> <div _ngcontent-uuq-c106="" class="highlight-div"><div _ngcontent-uuq-c106="" class="highlight-div-header"><div _ngcontent-uuq-c106="" class="highlight-div-header-left"><div _ngcontent-uuq-c106="" class="handle-button expand-button"><div _ngcontent-uuq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-uuq-c106="" class="highlight-div-header-right"><div _ngcontent-uuq-c106="" class="handle-button ai-button"></div><div _ngcontent-uuq-c106="" class="handle-button line-button"><div _ngcontent-uuq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-uuq-c106="" class="handle-button theme-button"><div _ngcontent-uuq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-uuq-c106="" class="handle-button copy-button"><div _ngcontent-uuq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-uuq-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-swift" id="ZH-CN_TOPIC_0000002510294315__screen15259110125214" data-highlighted="yes"><ol class="linenums"><li>at har (entry<span class="hljs-operator">|</span>har<span class="hljs-operator">|</span><span class="hljs-number">1.0</span>.<span class="hljs-number">0</span><span class="hljs-operator">|</span>src<span class="hljs-regexp">/main/</span>ets<span class="hljs-regexp">/components/</span>mainpage<span class="hljs-operator">/</span><span class="hljs-type">MainPage</span>.js:<span class="hljs-number">58</span>:<span class="hljs-number">58</span>)</li><li>at i (entry<span class="hljs-operator">|</span>entry<span class="hljs-operator">|</span><span class="hljs-number">1.0</span>.<span class="hljs-number">0</span><span class="hljs-operator">|</span>src<span class="hljs-regexp">/main/</span>ets<span class="hljs-regexp">/pages/</span><span class="hljs-type">Index</span>.ts:<span class="hljs-number">71</span>:<span class="hljs-number">71</span>)</li><li>at anonymous (entry<span class="hljs-operator">|</span>entry<span class="hljs-operator">|</span><span class="hljs-number">1.0</span>.<span class="hljs-number">0</span><span class="hljs-operator">|</span>src<span class="hljs-regexp">/main/</span>ets<span class="hljs-regexp">/pages/</span><span class="hljs-type">Index</span>.ts:<span class="hljs-number">55</span>:<span class="hljs-number">55</span>)</li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002510294315__p3780161284112">crash中，包含混淆后的方法名（或属性名）、路径信息以及混淆后的行列号信息，其中：</p> <ul id="ZH-CN_TOPIC_0000002510294315__ul041984816559"><li id="li84191548205510">方法名在配置相应混淆规则后，会进行混淆处理（例如上述例子中EntryClass的callHarFunction被混淆为i）。方法名混淆前后的映射关系保存在对应模块编译产物的nameCache文件中。</li><li id="li9369088569">路径信息格式为：引用方entry-packageName|被引用方packageName|version|源码相对路径，其中packageName以及version保存在对应模块编译产物的sourcemap文件中。</li><li id="li2320183165811">行列号混淆前后的映射关系保存在对应模块编译产物的sourcemap文件中，可利用文件对应的mappings字段进行解析还原。</li></ul> <p id="ZH-CN_TOPIC_0000002510294315__p11779201015155">在对堆栈进行还原时，可分为以下三步：</p> <ol id="ZH-CN_TOPIC_0000002510294315__ol8268115641512"><li id="li526885681520"><span>根据路径信息，找到引用方模块sourcemap。例如第一条堆栈：</span><p></p><div _ngcontent-uuq-c106="" class="highlight-div"><div _ngcontent-uuq-c106="" class="highlight-div-header"><div _ngcontent-uuq-c106="" class="highlight-div-header-left"><div _ngcontent-uuq-c106="" class="handle-button expand-button"><div _ngcontent-uuq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-uuq-c106="" class="highlight-div-header-right"><div _ngcontent-uuq-c106="" class="handle-button ai-button"></div><div _ngcontent-uuq-c106="" class="handle-button line-button"><div _ngcontent-uuq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-uuq-c106="" class="handle-button theme-button"><div _ngcontent-uuq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-uuq-c106="" class="handle-button copy-button"><div _ngcontent-uuq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-uuq-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-swift" id="ZH-CN_TOPIC_0000002510294315__screen13578234111712" data-highlighted="yes"><ol class="linenums"><li>at har (entry<span class="hljs-operator">|</span>har<span class="hljs-operator">|</span><span class="hljs-number">1.0</span>.<span class="hljs-number">0</span><span class="hljs-operator">|</span>src<span class="hljs-regexp">/main/</span>ets<span class="hljs-regexp">/components/</span>mainpage<span class="hljs-operator">/</span><span class="hljs-type">MainPage</span>.js:<span class="hljs-number">58</span>:<span class="hljs-number">58</span>)</li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002510294315__p189861759183">根据路径信息entry|har|1.0.0|src/main/ets/components/mainpage/MainPage.js，可在entry模块sourcemap文件中找到如下字段：</p> <div _ngcontent-uuq-c106="" class="highlight-div"><div _ngcontent-uuq-c106="" class="highlight-div-header"><div _ngcontent-uuq-c106="" class="highlight-div-header-left"><div _ngcontent-uuq-c106="" class="handle-button expand-button"><div _ngcontent-uuq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-uuq-c106="" class="highlight-div-header-right"><div _ngcontent-uuq-c106="" class="handle-button ai-button"></div><div _ngcontent-uuq-c106="" class="handle-button line-button"><div _ngcontent-uuq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-uuq-c106="" class="handle-button theme-button"><div _ngcontent-uuq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-uuq-c106="" class="handle-button copy-button"><div _ngcontent-uuq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-uuq-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" id="ZH-CN_TOPIC_0000002510294315__screen534397171911" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-string">"entry|har|1.0.0|src/main/ets/components/mainpage/MainPage.js"</span>: {</li><li>    <span class="hljs-string">"version"</span>: <span class="hljs-number">3</span>,</li><li>    <span class="hljs-string">"file"</span>: <span class="hljs-string">"MainPage.js"</span>,</li><li>    <span class="hljs-string">"sources"</span>: [</li><li>      <span class="hljs-string">"oh_modules/.ohpm/Har@ue9rwlwgmslvadnmypsedjcin6a=/oh_modules/Har/src/main/ets/components/mainpage/MainPage.js"</span></li><li>    ],</li><li>    <span class="hljs-string">"names"</span>: [],</li><li>    <span class="hljs-string">"mappings"</span>: <span class="hljs-string">"AAAA,IAAA,CAAA,CAAA,sBAAA,IAAA,MAAA,CAAA,SAAA,CAAA,EAAA;IACA,OAAA,CAAA,GAAA,CAAA,MAAA,CAAA,SAAA,EAAA,sBAAA,EAAA,GAAA,EAAA,GAAA,CAAA,CAAA,CAAA;CACA;AACA,MAAA,OAAA,QAAA,SAAA,MAAA;IACA,YAAA,CAAA,EAAA,EAAA,EAAA,CAAA,EAAA,CAAA,GAAA,CAAA,CAAA,EAAA,CAAA,GAAA,SAAA,EAAA,CAAA;QACA,KAAA,CAAA,CAAA,EAAA,CAAA,EAAA,CAAA,EAAA,CAAA,CAAA,CAAA;QACA,IAAA,OAAA,CAAA,KAAA,UAAA,EAAA;YACA,IAAA,CAAA,gBAAA,GAAA,CAAA,CAAA;SACA;QACA,IAAA,EAAA,GAAA,IAAA,wBAAA,CAAA,aAAA,EAAA,IAAA,EAAA,SAAA,CAAA,CAAA;QACA,IAAA,CAAA,yBAAA,IAAA,CAAA;QACA,IAAA,CAAA,oBAAA,EAAA,CAAA;IACA,CAAA;IACA,yBAAA,CAAA,EAAA;QACA,IAAA,GAAA,OAAA,KAAA,SAAA,EAAA;YACA,IAAA,CAAA,OAAA,GAAA,GAAA,OAAA,CAAA;SACA;IACA,CAAA;IACA,eAAA,CAAA,CAAA;IACA,CAAA;IACA,iCAAA,CAAA,CAAA;QACA,IAAA,EAAA,CAAA,uBAAA,CAAA,CAAA,CAAA,CAAA;IACA,CAAA;IACA,gBAAA;QACA,IAAA,EAAA,CAAA,gBAAA,EAAA,CAAA;QACA,iBAAA,CAAA,GAAA,EAAA,CAAA,MAAA,CAAA,IAAA,CAAA,IAAA,EAAA,CAAA,CAAA;QACA,IAAA,CAAA,wBAAA,EAAA,CAAA;IACA,CAAA;IACA,IAAA,OAAA;QACA,OAAA,IAAA,EAAA,CAAA,GAAA,EAAA,CAAA;IACA,CAAA;IACA,IAAA,OAAA,CAAA,EAAA;QACA,IAAA,EAAA,CAAA,GAAA,IAAA,CAAA;IACA,CAAA;IACA,aAAA;QACA,IAAA,CAAA,yBAAA,CAAA,CAAA,CAAA,EAAA,EAAA,EAAA,EAAA;YACA,GAAA,CAAA,MAAA,EAAA,CAAA;YACA,GAAA,CAAA,MAAA,CAAA,MAAA,CAAA,CAAA;QACA,CAAA,EAAA,GAAA,CAAA,CAAA;QACA,IAAA,CAAA,yBAAA,CAAA,CAAA,CAAA,EAAA,CAAA,EAAA,EAAA;YACA,MAAA,CAAA,MAAA,EAAA,CAAA;YACA,MAAA,CAAA,KAAA,CAAA,MAAA,CAAA,CAAA;QACA,CAAA,EAAA,MAAA,CAAA,CAAA;QACA,IAAA,CAAA,yBAAA,CAAA,CAAA,CAAA,EAAA,CAAA,EAAA,EAAA;YACA,IAAA,CAAA,MAAA,CAAA,IAAA,CAAA,OAAA,CAAA,CAAA;YACA,IAAA,CAAA,QAAA,CAAA,EAAA,CAAA,CAAA;YACA,IAAA,CAAA,UAAA,CAAA,UAAA,CAAA,IAAA,CAAA,CAAA;QACA,CAAA,EAAA,IAAA,CAAA,CAAA;QACA,IAAA,CAAA,GAAA,EAAA,CAAA;QACA,MAAA,CAAA,GAAA,EAAA,CAAA;QACA,GAAA,CAAA,GAAA,EAAA,CAAA;IACA,CAAA;IACA,QAAA;QACA,IAAA,CAAA,mBAAA,EAAA,CAAA;IACA,CAAA;CACA;AACA,MAAA,UAAA,GAAA;IACA,MAAA,CAAA,GAAA,CAAA,CAAA;AACA,CAAA"</span>,</li><li>    <span class="hljs-string">"entry-package-info"</span>: <span class="hljs-string">"entry|1.0.0"</span>,</li><li>    <span class="hljs-string">"package-info"</span>: <span class="hljs-string">"har|1.0.0"</span></li><li>  }</li></ol></pre></div></div> <p></p></li><li id="li55836253246"><span>利用对应sourcemap信息进行堆栈路径以及行列号还原：</span><p></p><p id="ZH-CN_TOPIC_0000002510294315__p576631272520">基于步骤1找到的sourcemap信息，根据sources及mappings字段进行解析，可以将路径以及行列号还原如下：</p> <div _ngcontent-uuq-c106="" class="highlight-div"><div _ngcontent-uuq-c106="" class="highlight-div-header"><div _ngcontent-uuq-c106="" class="highlight-div-header-left"><div _ngcontent-uuq-c106="" class="handle-button expand-button"><div _ngcontent-uuq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-uuq-c106="" class="highlight-div-header-right"><div _ngcontent-uuq-c106="" class="handle-button ai-button"></div><div _ngcontent-uuq-c106="" class="handle-button line-button"><div _ngcontent-uuq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-uuq-c106="" class="handle-button theme-button"><div _ngcontent-uuq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-uuq-c106="" class="handle-button copy-button"><div _ngcontent-uuq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-uuq-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-less" id="ZH-CN_TOPIC_0000002510294315__screen3862202943610" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-selector-tag">at</span> <span class="hljs-selector-tag">har</span> (oh_modules/.ohpm/Har<span class="hljs-variable">@ue9rwlwgmslvadnmypsedjcin6a</span>=/oh_modules/Har/src/main/ets/components/mainpage/MainPage.<span class="hljs-attribute">js</span>:<span class="hljs-number">58</span>:<span class="hljs-number">58</span>)</li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002510294315__p55251749103612">该文件位于entry模块oh_modules路径下。</p> <p id="ZH-CN_TOPIC_0000002510294315__p716116234388">如果对应sourcemap中包含package-info字段，则可以利用package-info中对应模块的sourcemap，对该条堆栈进行二次解析。例如该堆栈中包package-info为har|1.0.0，可利用har中的sourcemap对该堆栈进行再次解析，方案如下：</p> <ol id="ZH-CN_TOPIC_0000002510294315__ol9613255133817"><li id="li86139551385">由路径中最后一个oh_modules起，向下两级，截断上述第一次解析结果路径，结果如下：<div _ngcontent-uuq-c106="" class="highlight-div"><div _ngcontent-uuq-c106="" class="highlight-div-header"><div _ngcontent-uuq-c106="" class="highlight-div-header-left"><div _ngcontent-uuq-c106="" class="handle-button expand-button"><div _ngcontent-uuq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-uuq-c106="" class="highlight-div-header-right"><div _ngcontent-uuq-c106="" class="handle-button ai-button"></div><div _ngcontent-uuq-c106="" class="handle-button line-button"><div _ngcontent-uuq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-uuq-c106="" class="handle-button theme-button"><div _ngcontent-uuq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-uuq-c106="" class="handle-button copy-button"><div _ngcontent-uuq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-uuq-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-css" id="ZH-CN_TOPIC_0000002510294315__screen1272171614547" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-attribute">src</span>/<span class="hljs-selector-tag">main</span>/ets/components/mainpage/MainPage<span class="hljs-selector-class">.js</span></li></ol></pre></div></div> </li><li id="li136131355133811">上述路径拼接package-info， 拼接方式为：packageName|packageName|version|截断路径，得到拼接路径如下：<div _ngcontent-uuq-c106="" class="highlight-div"><div _ngcontent-uuq-c106="" class="highlight-div-header"><div _ngcontent-uuq-c106="" class="highlight-div-header-left"><div _ngcontent-uuq-c106="" class="handle-button expand-button"><div _ngcontent-uuq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-uuq-c106="" class="highlight-div-header-right"><div _ngcontent-uuq-c106="" class="handle-button ai-button"></div><div _ngcontent-uuq-c106="" class="handle-button line-button"><div _ngcontent-uuq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-uuq-c106="" class="handle-button theme-button"><div _ngcontent-uuq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-uuq-c106="" class="handle-button copy-button"><div _ngcontent-uuq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-uuq-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-swift" id="ZH-CN_TOPIC_0000002510294315__screen17377111715811" data-highlighted="yes"><ol class="linenums"><li>har<span class="hljs-operator">|</span>har<span class="hljs-operator">|</span><span class="hljs-number">1.0</span>.<span class="hljs-number">0</span><span class="hljs-operator">|</span>src<span class="hljs-regexp">/main/</span>ets<span class="hljs-regexp">/components/</span>mainpage<span class="hljs-operator">/</span><span class="hljs-type">MainPage</span>.js</li></ol></pre></div></div> </li><li id="li1561315513818">利用拼接后的路径，在har模块sourcemap文件中找到如下字段：<div _ngcontent-uuq-c106="" class="highlight-div"><div _ngcontent-uuq-c106="" class="highlight-div-header"><div _ngcontent-uuq-c106="" class="highlight-div-header-left"><div _ngcontent-uuq-c106="" class="handle-button expand-button"><div _ngcontent-uuq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-uuq-c106="" class="highlight-div-header-right"><div _ngcontent-uuq-c106="" class="handle-button ai-button"></div><div _ngcontent-uuq-c106="" class="handle-button line-button"><div _ngcontent-uuq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-uuq-c106="" class="handle-button theme-button"><div _ngcontent-uuq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-uuq-c106="" class="handle-button copy-button"><div _ngcontent-uuq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-uuq-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" id="ZH-CN_TOPIC_0000002510294315__screen916319194486" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-string">"har|har|1.0.0|src/main/ets/components/mainpage/MainPage.js"</span>: {</li><li>  <span class="hljs-string">"version"</span>: <span class="hljs-number">3</span>,</li><li>  <span class="hljs-string">"file"</span>: <span class="hljs-string">"MainPage.ets"</span>,</li><li>  <span class="hljs-string">"sources"</span>: [</li><li>    <span class="hljs-string">"har/src/main/ets/components/mainpage/MainPage.ets"</span></li><li>  ],</li><li>  <span class="hljs-string">"names"</span>: [],</li><li>  <span class="hljs-string">"mappings"</span>: <span class="hljs-string">";;;AAEA,MAAA,OAAA,QAAA,SAAA,MAAA;IADA,YAAA,CAAA,EAAA,CAAA,EAAA,CAAA,EAAA,IAAA,CAAA,CAAA,EAAA,IAAA,SAAA,EAAA,CAAA;;;;;;;;IADyB,CAAA;;;;;;;;;;;;;;;;;;;;;;IAKvB,aAAA;;;;;;;;;;;;YAGM,IAAA,CAAA,UAAA,CAAA,UAAA,CAAA,IAAA,CAAA,CAAA;;;;;IAOL,CAAA;;;;;AAGH,MAAA,UAAA,GAAA;;AAEA,CAAA"</span>,</li><li>  <span class="hljs-string">"entry-package-info"</span>: <span class="hljs-string">"har|1.0.0"</span></li><li>}</li></ol></pre></div></div> </li><li id="li3538115803818">根据该sourcemap的sources及mappings字段进行再次解析，可得到该堆栈对应的源码信息为：<div _ngcontent-uuq-c106="" class="highlight-div"><div _ngcontent-uuq-c106="" class="highlight-div-header"><div _ngcontent-uuq-c106="" class="highlight-div-header-left"><div _ngcontent-uuq-c106="" class="handle-button expand-button"><div _ngcontent-uuq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-uuq-c106="" class="highlight-div-header-right"><div _ngcontent-uuq-c106="" class="handle-button ai-button"></div><div _ngcontent-uuq-c106="" class="handle-button line-button"><div _ngcontent-uuq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-uuq-c106="" class="handle-button theme-button"><div _ngcontent-uuq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-uuq-c106="" class="handle-button copy-button"><div _ngcontent-uuq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-uuq-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-swift" id="ZH-CN_TOPIC_0000002510294315__screen2096211984917" data-highlighted="yes"><ol class="linenums"><li>at har (har<span class="hljs-regexp">/src/</span>main<span class="hljs-regexp">/ets/</span>components<span class="hljs-regexp">/mainpage/</span><span class="hljs-type">MainPage</span>.ets:<span class="hljs-number">20</span>:<span class="hljs-number">1</span>)</li></ol></pre></div></div> </li></ol> <p></p></li><li id="li178006299817"><span>利用nameCache文件，对方法名进行解析还原。</span><p></p><p id="ZH-CN_TOPIC_0000002510294315__p381912351011">以第二条堆栈为例：</p> <div _ngcontent-uuq-c106="" class="highlight-div"><div _ngcontent-uuq-c106="" class="highlight-div-header"><div _ngcontent-uuq-c106="" class="highlight-div-header-left"><div _ngcontent-uuq-c106="" class="handle-button expand-button"><div _ngcontent-uuq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-uuq-c106="" class="highlight-div-header-right"><div _ngcontent-uuq-c106="" class="handle-button ai-button"></div><div _ngcontent-uuq-c106="" class="handle-button line-button"><div _ngcontent-uuq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-uuq-c106="" class="handle-button theme-button"><div _ngcontent-uuq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-uuq-c106="" class="handle-button copy-button"><div _ngcontent-uuq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-uuq-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-less" id="ZH-CN_TOPIC_0000002510294315__screen11668122121211" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-selector-tag">at</span> <span class="hljs-selector-tag">i</span> (entry|entry|<span class="hljs-number">1.0</span>.<span class="hljs-number">0</span>|src/main/ets/pages/Index.<span class="hljs-attribute">ts</span>:<span class="hljs-number">71</span>:<span class="hljs-number">71</span>)</li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002510294315__p4532233105">通过步骤1与步骤2，将该堆栈路径以及行列号信息进行解析，结果如下：</p> <div _ngcontent-uuq-c106="" class="highlight-div"><div _ngcontent-uuq-c106="" class="highlight-div-header"><div _ngcontent-uuq-c106="" class="highlight-div-header-left"><div _ngcontent-uuq-c106="" class="handle-button expand-button"><div _ngcontent-uuq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-uuq-c106="" class="highlight-div-header-right"><div _ngcontent-uuq-c106="" class="handle-button ai-button"></div><div _ngcontent-uuq-c106="" class="handle-button line-button"><div _ngcontent-uuq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-uuq-c106="" class="handle-button theme-button"><div _ngcontent-uuq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-uuq-c106="" class="handle-button copy-button"><div _ngcontent-uuq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-uuq-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-css" id="ZH-CN_TOPIC_0000002510294315__screen17910319141316" data-highlighted="yes"><ol class="linenums"><li>at <span class="hljs-selector-tag">i</span> (entry/<span class="hljs-attribute">src</span>/<span class="hljs-selector-tag">main</span>/ets/pages/Index<span class="hljs-selector-class">.ets</span>:<span class="hljs-number">25</span>:<span class="hljs-number">3</span>)</li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002510294315__p12648124711134">在对应模块编译产物中的nameCache文件中，通过解析后的文件路径找到如下字段：</p> <div _ngcontent-uuq-c106="" class="highlight-div"><div _ngcontent-uuq-c106="" class="highlight-div-header"><div _ngcontent-uuq-c106="" class="highlight-div-header-left"><div _ngcontent-uuq-c106="" class="handle-button expand-button"><div _ngcontent-uuq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-uuq-c106="" class="highlight-div-header-right"><div _ngcontent-uuq-c106="" class="handle-button ai-button"></div><div _ngcontent-uuq-c106="" class="handle-button line-button"><div _ngcontent-uuq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-uuq-c106="" class="handle-button theme-button"><div _ngcontent-uuq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-uuq-c106="" class="handle-button copy-button"><div _ngcontent-uuq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-uuq-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" id="ZH-CN_TOPIC_0000002510294315__screen92531357111519" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-string">"entry/src/main/ets/pages/Index.ets"</span>: {</li><li>  <span class="hljs-string">"IdentifierCache"</span>: {</li><li>    <span class="hljs-string">"Index#initialRender#__function"</span>: <span class="hljs-string">"o"</span>,</li><li>    <span class="hljs-string">"Index#initialRender#$2#__function"</span>: <span class="hljs-string">"t"</span>,</li><li>    <span class="hljs-string">"Index#initialRender#$2#$0#entryClass"</span>: <span class="hljs-string">"u"</span>,</li><li>    <span class="hljs-string">"$0#__function"</span>: <span class="hljs-string">"a1"</span></li><li>  },</li><li>  <span class="hljs-string">"MemberMethodCache"</span>: {</li><li>    <span class="hljs-string">"initialRender:6:20"</span>: <span class="hljs-string">"initialRender"</span>,</li><li>    <span class="hljs-string">"callHarFunction:24:26"</span>: <span class="hljs-string">"i"</span></li><li>  },</li><li>  <span class="hljs-string">"obfName"</span>: <span class="hljs-string">"entry/src/main/ets/pages/Index.ets"</span></li><li>}</li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002510294315__p12343102161">该字段的IdentifierCache与MemberMethodCache中保存了方法名混淆前后的映射关系，对应格式为：</p> <p id="ZH-CN_TOPIC_0000002510294315__p1623533216207">"源码方法名:该方法起始行号:该方法结束行号":"混淆后方法名"。</p> <p id="ZH-CN_TOPIC_0000002510294315__p782162922517">第二条堆栈混淆后的方法名为"i"，利用上述字段对该方法名进行还原：</p> <ol id="ZH-CN_TOPIC_0000002510294315__ol2015714294119"><li id="li1515711294117">在上述字段中找出所有混淆后方法名为"i"的条目，可能存在多个，该字段中为：<div _ngcontent-uuq-c106="" class="highlight-div"><div _ngcontent-uuq-c106="" class="highlight-div-header"><div _ngcontent-uuq-c106="" class="highlight-div-header-left"><div _ngcontent-uuq-c106="" class="handle-button expand-button"><div _ngcontent-uuq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-uuq-c106="" class="highlight-div-header-right"><div _ngcontent-uuq-c106="" class="handle-button ai-button"></div><div _ngcontent-uuq-c106="" class="handle-button line-button"><div _ngcontent-uuq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-uuq-c106="" class="handle-button theme-button"><div _ngcontent-uuq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-uuq-c106="" class="handle-button copy-button"><div _ngcontent-uuq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-uuq-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-json" id="ZH-CN_TOPIC_0000002510294315__screen227084820269" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-attr">"callHarFunction:24:26"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"i"</span></li></ol></pre></div></div> </li><li id="li20157182104116">找到行号范围包含步骤2中还原后行号的条目，根据步骤2得到还原后的行号为25，包含在24-26之内，因此可以得到源码对应方法名为"callHarFunction"。</li></ol> <p id="ZH-CN_TOPIC_0000002510294315__p1382334217311">通过上述方式，可以得到源码的方法名。</p> <p></p></li><li id="li99213633413"><span>步骤2与步骤3所得结果进行整合，得到最终堆栈结果如下：</span><p></p><div _ngcontent-uuq-c106="" class="highlight-div"><div _ngcontent-uuq-c106="" class="highlight-div-header"><div _ngcontent-uuq-c106="" class="highlight-div-header-left"><div _ngcontent-uuq-c106="" class="handle-button expand-button"><div _ngcontent-uuq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-uuq-c106="" class="highlight-div-header-right"><div _ngcontent-uuq-c106="" class="handle-button ai-button"></div><div _ngcontent-uuq-c106="" class="handle-button line-button"><div _ngcontent-uuq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-uuq-c106="" class="handle-button theme-button"><div _ngcontent-uuq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-uuq-c106="" class="handle-button copy-button"><div _ngcontent-uuq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-uuq-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-swift" id="ZH-CN_TOPIC_0000002510294315__screen18216103817335" data-highlighted="yes"><ol class="linenums"><li>at har (har<span class="hljs-regexp">/src/</span>main<span class="hljs-regexp">/ets/</span>components<span class="hljs-regexp">/mainpage/</span><span class="hljs-type">MainPage</span>.ets:<span class="hljs-number">20</span>:<span class="hljs-number">1</span>)</li><li>at callHarFunction (entry<span class="hljs-regexp">/src/</span>main<span class="hljs-regexp">/ets/</span>pages<span class="hljs-operator">/</span><span class="hljs-type">Index</span>.ets:<span class="hljs-number">25</span>:<span class="hljs-number">3</span>)</li><li>at anonymous (entry<span class="hljs-regexp">/src/</span>main<span class="hljs-regexp">/ets/</span>pages<span class="hljs-operator">/</span><span class="hljs-type">Index</span>.ets:<span class="hljs-number">14</span>:<span class="hljs-number">47</span>)</li></ol></pre></div></div> <p></p></li></ol> <p id="ZH-CN_TOPIC_0000002510294315__p1924928153517">通过上述方式，即可利用编译产物对release应用的crash信息进行解析还原。</p> </div> </div></div>