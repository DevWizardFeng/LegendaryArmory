<h1 _ngcontent-gtf-c119="" class="doc-title ng-star-inserted" title="堆栈轨迹分析"> 堆栈轨迹分析 </h1>

<div _ngcontent-gtf-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div id="body0000001814726289">    <p id="ZH-CN_TOPIC_0000002510294257__p17079568426">对于发布的应用（Release应用），为减小应用程序大小，提高运行效率，会对代码进行优化，去除其中的debug信息。因此无法直接通过Release应用的堆栈信息定位到源码的具体文件和行位置，不易于开发者快速定位解决问题。</p>    <p id="ZH-CN_TOPIC_0000002510294257__p749856194016">针对该场景，DevEco Studio提供了Release应用堆栈解析功能，开发者可以利用构建产物中包含Debug信息的文件（so文件、sourcemap文件、nameCache文件等），对Release应用中C++堆栈、ArkTS堆栈以及ArkTS堆栈中混淆的方法名和文件名进行还原。关于构建产物的介绍和堆栈解析的原理，请查看<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-exception-stack-parsing-principle">异常堆栈解析原理</a>。</p>    <p id="ZH-CN_TOPIC_0000002510294257__p157251917299">Release应用堆栈解析功能操作方法如下：</p>    <ol id="ZH-CN_TOPIC_0000002510294257__ol1552503425912">     <li id="li175251034195917"><span>单击菜单栏<strong>Code &gt; Analyze Stack Trace</strong>，或在FaultLog页面异常堆栈信息处右键选择<strong>Analyze Stack Trace。</strong></span>      <p></p>      <p id="ZH-CN_TOPIC_0000002510294257__p1059585584410"><span><img originheight="225" originwidth="323" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104834.71812684290091155909471245705839:50001231000000:2800:7B5238E2125FDE2FB718F2E2574854B8A43FB73362AC6F7D805DC90A1239ADA5.png" width="323" height="225"></span></p>      <p></p></li>     <li id="li4697192191310"><span>在弹出的<strong>Analyze Stack Trace</strong>对话框中，粘贴Release应用的异常堆栈信息。</span>      <p></p>      <p id="ZH-CN_TOPIC_0000002510294257__p094310613247"><span><img originheight="784" originwidth="933" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104834.14912508190165918532427180524957:50001231000000:2800:7682741716B5995C86EEF861F8C16DE663BE0B1393F7FE3069BB85BC7DCCC344.png" width="920" height="773.0760986066452"></span></p>      <p></p></li>     <li id="li16812538182518"><span>如果当前工程为堆栈所在应用对应的工程，且存在Release构建产物，点击<strong>Start Analyze</strong>即可进行解析。</span>      <p></p>      <p id="ZH-CN_TOPIC_0000002510294257__p2193143372515">如果当前工程不是堆栈所在应用对应的工程，则需要配置应用对应构建产物：勾选<strong>Unscramble stack trace</strong>, 在下方的文件选择框中，分别添加应用对应的sourcemap文件、so文件以及nameCache文件，点击<strong>Start Analyze</strong>进行转换。</p>      <p id="ZH-CN_TOPIC_0000002510294257__p42651355152316">DevEco Studio将解析后的堆栈信息显示在右侧的输出框中。</p>      <p id="ZH-CN_TOPIC_0000002510294257__p1026510554232"><span><img originheight="567" originwidth="1874" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104834.26168974535305598727356908755708:50001231000000:2800:1D0B92F883158A80E7EB68A26D89D3E8718DC1930C55E04C54A6D079B6527339.png" width="920" height="278.3564567769477"></span></p>      <p id="ZH-CN_TOPIC_0000002510294257__p9931203644513">在构建Release应用时，so文件是默认不包含符号表信息的，如果需要在构建Release应用时生成包含符号表的so文件，需要在工程的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-hvigor-cpp">模块级build-profile.json5</a>文件的buildOption属性中，配置如下信息：</p>      <div _ngcontent-gtf-c106="" class="highlight-div"><div _ngcontent-gtf-c106="" class="highlight-div-header"><div _ngcontent-gtf-c106="" class="highlight-div-header-left"><div _ngcontent-gtf-c106="" class="handle-button expand-button"><div _ngcontent-gtf-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gtf-c106="" class="highlight-div-header-right"><div _ngcontent-gtf-c106="" class="handle-button ai-button"></div><div _ngcontent-gtf-c106="" class="handle-button line-button"><div _ngcontent-gtf-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gtf-c106="" class="handle-button theme-button"><div _ngcontent-gtf-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gtf-c106="" class="handle-button copy-button"><div _ngcontent-gtf-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gtf-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" id="ZH-CN_TOPIC_0000002510294257__screen029463920596" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-string">"buildOption"</span>: {</li><li>  <span class="hljs-string">"externalNativeOptions"</span>: {</li><li>    <span class="hljs-string">"arguments"</span>: <span class="hljs-string">"-DCMAKE_BUILD_TYPE=RelWithDebInfo"</span></li><li>  }</li><li>}</li></ol></pre></div></div>      <p id="ZH-CN_TOPIC_0000002510294257__p779404185915">如果引用release Har包中native方法产生了异常堆栈，解析时请勾选<strong>Unscramble stack trace</strong>, 并选择har模块中编译出的带有符号信息的so文件，引用方build产物中的har模块so不带有符号信息。so文件在模块中相对路径为build/default/intermediates/libs/default/{cpu类型}/libxxx.so。</p>      <p></p></li>    </ol>    <p id="ZH-CN_TOPIC_0000002510294257__p8060118"></p>   </div>   <div></div></div>