<h1 _ngcontent-myp-c119="" class="doc-title ng-star-inserted" title="声明权限"> 声明权限 </h1>

<div _ngcontent-myp-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p>应用在申请权限时，需在项目的配置文件中逐个声明所需权限，否则无法获取授权，并可能导致应用上架申请被驳回。</p>    <div class="tiledSection">     <h2 id="在配置文件中声明权限">在配置文件中声明权限<i class="anchor-icon anchor-icon-link" anchorid="在配置文件中声明权限" tips="复制节点链接"></i></h2>          <p>应用必须在module.json5配置文件的requestPermissions标签中声明权限。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.2.3.1.5.1.1" valign="top" width="25%">属性</th>         <th align="left" class="cellrowborder" id="mcps1.3.2.3.1.5.1.2" valign="top" width="25%">含义</th>         <th align="left" class="cellrowborder" id="mcps1.3.2.3.1.5.1.3" valign="top" width="25%">数据类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.2.3.1.5.1.4" valign="top" width="25%">取值范围</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="25%">name</td>         <td class="cellrowborder" valign="top" width="25%">需要使用的权限名称。</td>         <td class="cellrowborder" valign="top" width="25%">字符串</td>         <td class="cellrowborder" valign="top" width="25%"><strong>必填</strong>，需为系统已定义的权限，取值范围请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/app-permissions">应用权限列表</a>。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="25%">reason</td>         <td class="cellrowborder" valign="top" width="25%">申请权限的原因。</td>         <td class="cellrowborder" valign="top" width="25%">字符串</td>         <td class="cellrowborder" valign="top" width="25%">          <p><strong>可选填写</strong>，该字段用于应用上架校验，申请user_grant/manual_settings权限时必填并需多语种适配。</p>          <p>格式为$string: ***。string资源引用需要在string.json文件配置标签"name": "reason"，配置样例可参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/resource-categories-and-access#资源文件示例">资源文件示例</a>。</p>          <p>reason填写内容可参考<a href="/consumer/cn/doc/harmonyos-guides/declare-permissions#权限使用理由的文案内容规范">权限使用理由的文案内容规范</a>。</p></td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="25%">usedScene</td>         <td class="cellrowborder" valign="top" width="25%">          <p>权限使用的场景，该字段用于应用上架校验。包括abilities和when两个子项。</p>          <p>- abilities：使用权限的UIAbility或者ExtensionAbility组件的名称。</p>          <p>- when：调用时机。</p></td>         <td class="cellrowborder" valign="top" width="25%">对象</td>         <td class="cellrowborder" valign="top" width="25%">          <p></p>          <p><strong>申请user_grant/manual_settings权限时，usedScene必填，其他情况下选填。</strong></p>          <p></p>          <p>- abilities：<strong>可选填写</strong>，可以配置为多个UIAbility或者ExtensionAbility名称的字符串数组。</p>          <p>- when：<strong>可选填写</strong>，但如果配置此字段，只能填入固定值inuse（使用时）或always（始终），不能为空。</p>          <p>当申请的权限为user_grant/manual_settings权限时建议填写。</p></td>        </tr>             </tbody></table></div>     </div>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>已在子模块中申请的权限无需在主项目中重复添加，权限将在整个应用中生效。</p>      </div></div></div>    </div>    <div class="tiledSection">     <h2 id="声明样例">声明样例<i class="anchor-icon anchor-icon-link" anchorid="声明样例" tips="复制节点链接"></i></h2>          <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>下述"name"中填入的权限仅为样例示意。请开发者根据实际需要，参照上表要求填写对应属性。</p>      </div></div></div>     <div _ngcontent-myp-c106="" class="highlight-div"><div _ngcontent-myp-c106="" class="highlight-div-header"><div _ngcontent-myp-c106="" class="highlight-div-header-left"><div _ngcontent-myp-c106="" class="handle-button expand-button"><div _ngcontent-myp-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-myp-c106="" class="highlight-div-header-right"><div _ngcontent-myp-c106="" class="handle-button ai-button"></div><div _ngcontent-myp-c106="" class="handle-button line-button"><div _ngcontent-myp-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-myp-c106="" class="handle-button theme-button"><div _ngcontent-myp-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-myp-c106="" class="handle-button copy-button"><div _ngcontent-myp-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-myp-c106="" class="highlight-scroll-div"><pre class="JSON5 prettyprint linenums hljs language-cangjie" hw-language="JSON5" data-highlighted="yes"><ol class="linenums"><li>{</li><li>  <span class="hljs-string">"module"</span>: {</li><li>    <span class="hljs-comment">// ···</span></li><li>    <span class="hljs-comment">// 1.ohos.permission.APPROXIMATELY_LOCATION与ohos.permission.LOCATION为user_grant权限，reason和usedScene为必填字段。</span></li><li>    <span class="hljs-comment">// 2.ohos.permission.USE_BLUETOOTH为system_grant权限，reason和usedScene为选填字段。</span></li><li>    <span class="hljs-string">"requestPermissions"</span>: [</li><li>      {</li><li>        <span class="hljs-string">"name"</span>: <span class="hljs-string">"ohos.permission.APPROXIMATELY_LOCATION"</span>,</li><li>        <span class="hljs-string">"reason"</span>: <span class="hljs-string">"$string:approximately_location_permission_reason"</span>,</li><li>        <span class="hljs-string">"usedScene"</span>: {</li><li>          <span class="hljs-string">"abilities"</span>: [</li><li>            <span class="hljs-string">"FormAbility"</span></li><li>          ],</li><li>          <span class="hljs-string">"when"</span>: <span class="hljs-string">"inuse"</span></li><li>        }</li><li>      },</li><li>      {</li><li>        <span class="hljs-string">"name"</span>: <span class="hljs-string">"ohos.permission.LOCATION"</span>,</li><li>        <span class="hljs-string">"reason"</span>: <span class="hljs-string">"$string:location_permission_reason"</span>,</li><li>        <span class="hljs-string">"usedScene"</span>: {</li><li>          <span class="hljs-string">"abilities"</span>: [</li><li>            <span class="hljs-string">"FormAbility"</span></li><li>          ],</li><li>          <span class="hljs-string">"when"</span>: <span class="hljs-string">"inuse"</span></li><li>        }</li><li>      },</li><li>      {</li><li>        <span class="hljs-string">"name"</span>: <span class="hljs-string">"ohos.permission.USE_BLUETOOTH"</span></li><li>      }</li><li>    ]</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="权限使用理由的文案内容规范">权限使用理由的文案内容规范<i class="anchor-icon anchor-icon-link" anchorid="权限使用理由的文案内容规范" tips="复制节点链接"></i></h2>          <p>当申请user_grant/manual_settings权限时，字段reason（申请权限的原因）必填。开发者需在应用配置文件中配置每个需要的权限。</p>     <p>但在实际向用户弹窗申请授权时，user_grant权限将会以<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/app-permission-mgmt-overview#权限组和子权限">权限组</a>的形式向用户申请。当前支持的权限组请查看<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/app-permission-group-list">应用权限组列表</a>。</p>    </div>    <div class="tiledSection">     <h3 id="reason字段的内容写作规范及建议" class="firsth2">reason字段的内容写作规范及建议<i class="anchor-icon anchor-icon-link" anchorid="reason字段的内容写作规范及建议" tips="复制节点链接"></i></h3>          <ol>      <li>       <p>权限使用理由应准确告知用户获取权限后用于什么场景/功能。</p>       <p>未明确告知用户实际使用场景/功能、权限使用理由和实际调用权限功能不符合将会导致权限申请被驳回，进而导致应用上架申请被驳回。</p>       <p><strong>样例</strong>：以申请相机权限的reason字符串为例。</p>       <p>正例：用于视频通话/拍照。</p>       <p>反例（未明确告知用户实际使用场景/功能）：使用相机；获取相机权限；需要权限。</p>       <p>反例（权限使用理由和实际调用权限功能不符）：录制音频用于语音聊天；获取蓝牙权限用于多设备之间传输文件。</p>       <p>如需了解更多权限使用理由的案例讲解，可参考<a href="https://developer.huawei.com/consumer/cn/forum/topic/0208158494714878699?fid=0102104600515103427" target="_blank">隐私合规问题小学堂——未同步告知权限的使用目的</a>。</p></li>      <li>       <p>字串应为直白、具体、易理解的完整短句， 用于向用户说明应用使用敏感权限的理由。句子避免使用被动语态，并以句号结尾。</p>       <ul>        <li>         <p><strong>建议句式</strong>：用于做某事。</p></li>        <li>         <p><strong>样例</strong>：以申请相机权限的reason字符串为例。</p>         <p>正例：用于视频通话。</p></li>       </ul></li>      <li>       <p>用途描述的字串建议小于72个字符（即36个中文字符，UI界面显示大约为两行）。不能超过256个字符，以保证多语言适配的体验。</p></li>      <li>       <p>字串不能为空白字符串，即不能不填，也不能只填空格符。</p></li>      <li>       <p>如果应用申请的权限用于多个场景，需要确保字串的完整性，让用户了解应用使用此权限的所有场景；多个HAP包内如果申请同一个权限，各个权限Reason字段需要保持场景的完整性和一致性。</p>       <p><strong>样例：</strong></p>       <p>应用中有2个HAP包，均需申请使用相机权限，其中HAP1提供功能场景为视频通话、HAP2提供功能场景为视频直播。</p>       <p>正例：HAP1和HAP2中，相机权限的使用理由都填写为“用于视频通话、视频直播功能。”</p>       <p>反例1：HAP1和HAP2中，相机权限的使用理由字段未保持完全一致。如HAP1中填写为“用于视频通话功能。”，HAP2中填写为“用于视频直播功能。”</p>       <p>反例2：HAP1和HAP2中，相机权限的使用理由字段保持完全一致，但是描述不全面，如HAP1和HAP2中，相机权限的使用理由都填写为“用于视频通话功能。”。</p></li>     </ol>    </div>    <div class="tiledSection">     <h3 id="权限使用理由展示方式">权限使用理由展示方式<i class="anchor-icon anchor-icon-link" anchorid="权限使用理由展示方式" tips="复制节点链接"></i></h3>          <p>权限使用理由有两个展示途径：授权弹窗界面和“设置（Settings）”界面。“设置”的具体路径：设置-隐私-权限管理-某应用某权限详情。</p>     <ol>      <li>       <p>如果申请的是“电话、信息、日历、通讯录、通话记录”这五个权限组中的权限，根据工信部要求，将展示具体子权限的内容与用途。</p>       <p><strong>句式</strong>：包括子权限A和子权限B，用于某事。</p>       <p><strong>样例</strong>：用于获取通话状态和移动网络信息，用于安全运营和统计计费服务。</p></li>      <li>       <p>如果是申请其他权限组中的权限，系统将使用权限组内当前被申请的第一个子权限的使用理由，作为该权限组的使用理由进行展示。组内的排序固定按照权限管理内排列的权限组数组顺序。</p>       <p>举例说明：权限组A = {权限A, 权限B, 权限C}；申请传入的权限是{权限C, 权限B}，界面将展示权限B的权限使用理由。</p></li>      <li>       <p>如果应用内多包申请的权限名称相同，但权限使用理由不一致，系统返回的权限申请详细信息<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-bundlemanager-bundleinfo#reqpermissiondetail" target="_blank">ReqPermissionDetail</a>中只会显示一个权限申请理由。优先级从高到低为：entry类型HAP、feature类型HAP、应用内HSP。</p></li>     </ol>    </div>   </div>   <div></div></div>