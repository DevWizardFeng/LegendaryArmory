<h1 _ngcontent-tha-c119="" class="doc-title ng-star-inserted" title="多摄同开(C/C++)"> 多摄同开(C/C++) </h1>

<div _ngcontent-tha-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p>从API version 18开始支持多摄同开，即应用可同时开启前置和后置相机进行拍照和录像。</p>    <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">      <p>由于多摄同开需要前置/后置相机同时运行，所以对于相机功能有较大限制。当前版本仅支持以下七项基础功能，请勿对多摄同开开启的相机进行超出以下七种基础功能范围之外的查询、设置和使能。</p>      <ol>       <li>闪光灯。</li>       <li>曝光。</li>       <li>变焦。</li>       <li>曝光补偿。</li>       <li>对焦。</li>       <li>防抖。</li>       <li>色彩空间。</li>      </ol>     </div></div></div>    <div class="tiledSection">     <h2 id="开发步骤">开发步骤<i class="anchor-icon anchor-icon-link" anchorid="开发步骤" tips="复制节点链接"></i></h2>          <p>详细的API说明请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-oh-camera" target="_blank">Camera</a>。</p>     <ol>      <li>       <p>导入NDK接口，接口中提供了相机相关的属性和方法，导入方法如下。</p>       <div _ngcontent-tha-c106="" class="highlight-div"><div _ngcontent-tha-c106="" class="highlight-div-header"><div _ngcontent-tha-c106="" class="highlight-div-header-left"><div _ngcontent-tha-c106="" class="handle-button expand-button"><div _ngcontent-tha-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-tha-c106="" class="highlight-div-header-right"><div _ngcontent-tha-c106="" class="handle-button ai-button"></div><div _ngcontent-tha-c106="" class="handle-button line-button"><div _ngcontent-tha-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-tha-c106="" class="handle-button theme-button"><div _ngcontent-tha-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-tha-c106="" class="handle-button copy-button"><div _ngcontent-tha-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-tha-c106="" class="highlight-scroll-div"><pre class="prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstdint&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;unistd.h&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;thread&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstdio&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;fcntl.h&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;map&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;vector&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;native_buffer/native_buffer.h&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"iostream"</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"mutex"</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"hilog/log.h"</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"ohcamera/camera.h"</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"ohcamera/camera_input.h"</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"ohcamera/capture_session.h"</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"ohcamera/photo_output.h"</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"ohcamera/preview_output.h"</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"ohcamera/video_output.h"</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"napi/native_api.h"</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"ohcamera/camera_manager.h"</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"common/log_common.h"</span></span></li></ol></pre></div></div></li>      <li>       <p>在CMake脚本中链接相关动态库。</p>       <div _ngcontent-tha-c106="" class="highlight-div"><div _ngcontent-tha-c106="" class="highlight-div-header"><div _ngcontent-tha-c106="" class="highlight-div-header-left"><div _ngcontent-tha-c106="" class="handle-button expand-button"><div _ngcontent-tha-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-tha-c106="" class="highlight-div-header-right"><div _ngcontent-tha-c106="" class="handle-button ai-button"></div><div _ngcontent-tha-c106="" class="handle-button line-button"><div _ngcontent-tha-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-tha-c106="" class="handle-button theme-button"><div _ngcontent-tha-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-tha-c106="" class="handle-button copy-button"><div _ngcontent-tha-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-tha-c106="" class="highlight-scroll-div"><pre class="txt prettyprint linenums hljs language-plaintext" hw-language="txt" data-highlighted="yes"><ol class="linenums"><li>target_link_libraries(entry PUBLIC</li><li>   libohcamera.so</li><li>   libace_napi.z.so</li><li>   libnative_buffer.so</li><li>   libhilog_ndk.z.so</li><li>   librawfile.z.so)</li></ol></pre></div></div></li>      <li>       <p>通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-camera-manager-h#oh_cameramanager_getcameradevice" target="_blank">OH_CameraManager_GetCameraDevice</a>方法获取对应的前置相机和后置相机。</p>       <div _ngcontent-tha-c106="" class="highlight-div"><div _ngcontent-tha-c106="" class="highlight-div-header"><div _ngcontent-tha-c106="" class="highlight-div-header-left"><div _ngcontent-tha-c106="" class="handle-button expand-button"><div _ngcontent-tha-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-tha-c106="" class="highlight-div-header-right"><div _ngcontent-tha-c106="" class="handle-button ai-button"></div><div _ngcontent-tha-c106="" class="handle-button line-button"><div _ngcontent-tha-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-tha-c106="" class="handle-button theme-button"><div _ngcontent-tha-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-tha-c106="" class="handle-button copy-button"><div _ngcontent-tha-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-tha-c106="" class="highlight-scroll-div"><pre class="prettyprint linenums hljs language-cangjie" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-variable">void</span> <span class="hljs-title function_">GetSupportedCameras</span>(<span class="hljs-variable">Camera_Manager</span> *<span class="hljs-variable">cameraManager</span>)</li><li>{</li><li>    <span class="hljs-variable">Camera_Device</span> *<span class="hljs-variable">cameras</span>;</li><li>    <span class="hljs-variable">uint32_t</span> <span class="hljs-variable">size</span> = <span class="hljs-number">0</span>;</li><li>    <span class="hljs-variable">Camera_ErrorCode</span> <span class="hljs-variable">ret</span> = <span class="hljs-title function_">OH_CameraManager_GetSupportedCameras</span>(<span class="hljs-variable">cameraManager</span>, &amp;<span class="hljs-title class_">cameras</span>, &amp;<span class="hljs-title class_">size</span>);</li><li>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">cameras</span> == <span class="hljs-variable">nullptr</span> || &amp;<span class="hljs-title class_">size</span> == <span class="hljs-variable">nullptr</span> || <span class="hljs-variable">ret</span> != <span class="hljs-variable">CAMERA_OK</span>) {</li><li>        <span class="hljs-keyword">return</span>;</li><li>    }</li><li>
</li><li>    <span class="hljs-comment">// 获取后置相机。</span></li><li>    <span class="hljs-variable">ret</span> = <span class="hljs-title function_">OH_CameraManager_GetCameraDevice</span>(<span class="hljs-variable">cameraManager</span>, <span class="hljs-variable">Camera_Position</span>::<span class="hljs-title class_">CAMERA_POSITION_BACK</span>, <span class="hljs-variable">Camera_Type</span>::<span class="hljs-title class_">CAMERA_TYPE_DEFAULT</span>, &amp;<span class="hljs-title class_">cameras</span>[<span class="hljs-number">0</span>]);</li><li>
</li><li>    <span class="hljs-comment">// 获取前置相机。</span></li><li>    <span class="hljs-variable">ret</span> = <span class="hljs-title function_">OH_CameraManager_GetCameraDevice</span>(<span class="hljs-variable">cameraManager</span>, <span class="hljs-variable">Camera_Position</span>::<span class="hljs-title class_">CAMERA_POSITION_FRONT</span>, <span class="hljs-variable">Camera_Type</span>::<span class="hljs-title class_">CAMERA_TYPE_DEFAULT</span>, &amp;<span class="hljs-title class_">cameras</span>[<span class="hljs-number">1</span>]);</li><li>}</li></ol></pre></div></div></li>      <li>       <p>获取对应的并发能力集。通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-camera-manager-h#oh_cameramanager_getcameraconcurrentinfos" target="_blank">OH_CameraManager_GetCameraConcurrentInfos</a>方法，获取<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-oh-camera-camera-concurrentinfo" target="_blank">Camera_ConcurrentInfo</a>相机并发能力集对象数组，数组包含了前置和后置同时开启的相机在指定多摄同开模式下支持的相机模式和相机输出能力。</p>       <div _ngcontent-tha-c106="" class="highlight-div"><div _ngcontent-tha-c106="" class="highlight-div-header"><div _ngcontent-tha-c106="" class="highlight-div-header-left"><div _ngcontent-tha-c106="" class="handle-button expand-button"><div _ngcontent-tha-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-tha-c106="" class="highlight-div-header-right"><div _ngcontent-tha-c106="" class="handle-button ai-button"></div><div _ngcontent-tha-c106="" class="handle-button line-button"><div _ngcontent-tha-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-tha-c106="" class="handle-button theme-button"><div _ngcontent-tha-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-tha-c106="" class="handle-button copy-button"><div _ngcontent-tha-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-tha-c106="" class="highlight-scroll-div"><pre class="prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">GetSupportedOutputCapability</span><span class="hljs-params">(Camera_Manager *cameraManager, Camera_Device *cameras)</span></span></li><li><span class="hljs-function"></span>{</li><li>    Camera_ConcurrentInfo* cameraConcurrentInfo;</li><li>    <span class="hljs-type">uint32_t</span> infoSize = <span class="hljs-number">0</span>;</li><li>    Camera_ErrorCode ret = <span class="hljs-built_in">OH_CameraManager_GetCameraConcurrentInfos</span>(cameraManager, cameras, <span class="hljs-number">2</span>, &amp;cameraConcurrentInfo, &amp;infoSize);</li><li>    <span class="hljs-keyword">if</span> (cameraConcurrentInfo == <span class="hljs-literal">nullptr</span> || cameraConcurrentInfo-&gt;outputCapabilities == <span class="hljs-literal">nullptr</span></li><li>        || cameraConcurrentInfo-&gt;outputCapabilities-&gt;previewProfiles == <span class="hljs-literal">nullptr</span> || ret != CAMERA_OK) {</li><li>        <span class="hljs-keyword">return</span>;</li><li>   }</li><li>}</li></ol></pre></div></div></li>      <li>       <p>对应并发能力集创建PreviewOutput对象。</p>       <div _ngcontent-tha-c106="" class="highlight-div"><div _ngcontent-tha-c106="" class="highlight-div-header"><div _ngcontent-tha-c106="" class="highlight-div-header-left"><div _ngcontent-tha-c106="" class="handle-button expand-button"><div _ngcontent-tha-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-tha-c106="" class="highlight-div-header-right"><div _ngcontent-tha-c106="" class="handle-button ai-button"></div><div _ngcontent-tha-c106="" class="handle-button line-button"><div _ngcontent-tha-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-tha-c106="" class="handle-button theme-button"><div _ngcontent-tha-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-tha-c106="" class="handle-button copy-button"><div _ngcontent-tha-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-tha-c106="" class="highlight-scroll-div"><pre class="prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">CreatePreviewOutput</span><span class="hljs-params">(Camera_Manager *cameraManager, Camera_ConcurrentInfo* cameraConcurrentInfo, <span class="hljs-type">char</span>* previewSurfaceId)</span></span></li><li><span class="hljs-function"></span>{</li><li>    Camera_Profile *profile = cameraConcurrentInfo-&gt;outputCapabilities-&gt;previewProfiles[<span class="hljs-number">0</span>];</li><li>    <span class="hljs-keyword">if</span> (profile == <span class="hljs-literal">nullptr</span>) {</li><li>        <span class="hljs-keyword">return</span>;</li><li>    }</li><li>    Camera_PreviewOutput *previewOutput;</li><li>    Camera_ErrorCode ret = <span class="hljs-built_in">OH_CameraManager_CreatePreviewOutput</span>(cameraManager, profile, previewSurfaceId, &amp;previewOutput);</li><li>    <span class="hljs-keyword">if</span> (previewOutput == <span class="hljs-literal">nullptr</span> || ret != CAMERA_OK) {</li><li>        <span class="hljs-keyword">return</span>;</li><li>    }</li><li>}</li></ol></pre></div></div></li>      <li>       <p>打开相机。通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-camera-input-h#oh_camerainput_openconcurrentcameras" target="_blank">OH_CameraInput_OpenConcurrentCameras</a>以并发状态打开指定相机，在使用该接口前，请先查询接口是否支持并发能力集，并优先调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-camera-manager-h#oh_cameramanager_getcameraconcurrentinfos" target="_blank">OH_CameraManager_GetCameraConcurrentInfos</a>方法，获取多摄同开状态下的相机并发能力集。请勿在未查询并发能力集的情况下使用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-camera-input-h#oh_camerainput_openconcurrentcameras" target="_blank">OH_CameraInput_OpenConcurrentCameras</a>，否则会导致打开相机失败。</p>       <div _ngcontent-tha-c106="" class="highlight-div"><div _ngcontent-tha-c106="" class="highlight-div-header"><div _ngcontent-tha-c106="" class="highlight-div-header-left"><div _ngcontent-tha-c106="" class="handle-button expand-button"><div _ngcontent-tha-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-tha-c106="" class="highlight-div-header-right"><div _ngcontent-tha-c106="" class="handle-button ai-button"></div><div _ngcontent-tha-c106="" class="handle-button line-button"><div _ngcontent-tha-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-tha-c106="" class="handle-button theme-button"><div _ngcontent-tha-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-tha-c106="" class="handle-button copy-button"><div _ngcontent-tha-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-tha-c106="" class="highlight-scroll-div"><pre class="prettyprint linenums hljs language-objectivec" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-type">void</span> CameraInputOpen(Camera_Manager *cameraManager, Camera_Device *cameras)</li><li>{</li><li>    Camera_Input *cameraInput;</li><li>    Camera_ErrorCode ret = OH_CameraManager_CreateCameraInput(cameraManager, &amp;cameras[<span class="hljs-number">0</span>], &amp;cameraInput);</li><li>    <span class="hljs-keyword">if</span> (cameraInput == nullptr || ret != <span class="hljs-built_in">CAMERA_OK</span>) {</li><li>        <span class="hljs-keyword">return</span>;</li><li>    }</li><li>    <span class="hljs-comment">// 当前版本只支持CAMERA_CONCURRENT_TYPE_LIMITED_CAPABILITY模式并发打开。</span></li><li>    ret = OH_CameraInput_OpenConcurrentCameras(cameraInput, Camera_ConcurrentType::<span class="hljs-built_in">CAMERA_CONCURRENT_TYPE_LIMITED_CAPABILITY</span>);</li><li>    <span class="hljs-keyword">if</span> (ret != <span class="hljs-built_in">CAMERA_OK</span>) {</li><li>        <span class="hljs-keyword">return</span>;</li><li>    }</li><li>}</li></ol></pre></div></div></li>      <li>       <p>会话流程。配置对应的相机输入流<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-oh-camera-camera-input" target="_blank">Camera_Input</a>和需要的相机输出流，此处以预览输出流<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-oh-camera-camera-previewoutput" target="_blank">Camera_PreviewOutput</a>为例 。</p>       <div _ngcontent-tha-c106="" class="highlight-div"><div _ngcontent-tha-c106="" class="highlight-div-header"><div _ngcontent-tha-c106="" class="highlight-div-header-left"><div _ngcontent-tha-c106="" class="handle-button expand-button"><div _ngcontent-tha-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-tha-c106="" class="highlight-div-header-right"><div _ngcontent-tha-c106="" class="handle-button ai-button"></div><div _ngcontent-tha-c106="" class="handle-button line-button"><div _ngcontent-tha-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-tha-c106="" class="handle-button theme-button"><div _ngcontent-tha-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-tha-c106="" class="handle-button copy-button"><div _ngcontent-tha-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-tha-c106="" class="highlight-scroll-div"><pre class="prettyprint linenums hljs language-java" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">void</span> <span class="hljs-title function_">SessionFlowFn</span><span class="hljs-params">(Camera_CaptureSession *captureSession, Camera_Input *cameraInput, Camera_PreviewOutput *previewOutput)</span></li><li>{</li><li>    <span class="hljs-comment">// 开始配置会话。</span></li><li>    <span class="hljs-type">Camera_ErrorCode</span> <span class="hljs-variable">ret</span> <span class="hljs-operator">=</span> OH_CaptureSession_BeginConfig(captureSession);</li><li>
</li><li>    <span class="hljs-comment">// 向会话中添加相机输入流。</span></li><li>    ret = OH_CaptureSession_AddInput(captureSession, cameraInput);</li><li>
</li><li>    <span class="hljs-comment">// 向会话中添加预览输出流。</span></li><li>    ret = OH_CaptureSession_AddPreviewOutput(captureSession, previewOutput);</li><li> </li><li>    <span class="hljs-comment">// 提交配置信息。</span></li><li>    ret = OH_CaptureSession_CommitConfig(captureSession);</li><li>
</li><li>    <span class="hljs-comment">// 开始会话。</span></li><li>    ret = OH_CaptureSession_Start(captureSession);</li><li> </li><li>    <span class="hljs-keyword">return</span>;</li><li>}</li></ol></pre></div></div></li>      <li>       <p>在多摄同开状态下，前/后置相机可配置的能力示例如下（当前版本仅支持本文开头部分所示的七项基础功能）。</p>       <div _ngcontent-tha-c106="" class="highlight-div"><div _ngcontent-tha-c106="" class="highlight-div-header"><div _ngcontent-tha-c106="" class="highlight-div-header-left"><div _ngcontent-tha-c106="" class="handle-button expand-button"><div _ngcontent-tha-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-tha-c106="" class="highlight-div-header-right"><div _ngcontent-tha-c106="" class="handle-button ai-button"></div><div _ngcontent-tha-c106="" class="handle-button line-button"><div _ngcontent-tha-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-tha-c106="" class="handle-button theme-button"><div _ngcontent-tha-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-tha-c106="" class="handle-button copy-button"><div _ngcontent-tha-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-tha-c106="" class="highlight-scroll-div"><pre class="prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 闪光灯能力。</span></li><li><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">HasFlashFn</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> mode, Camera_CaptureSession *captureSession)</span></span></li><li><span class="hljs-function"></span>{</li><li>    Camera_FlashMode flashMode = <span class="hljs-built_in">static_cast</span>&lt;Camera_FlashMode&gt;(mode);</li><li>    <span class="hljs-comment">// 检查闪光灯。</span></li><li>    <span class="hljs-type">bool</span> hasFlash = <span class="hljs-literal">false</span>;</li><li>    Camera_ErrorCode ret = <span class="hljs-built_in">OH_CaptureSession_HasFlash</span>(captureSession, &amp;hasFlash);</li><li>    <span class="hljs-keyword">if</span> (captureSession == <span class="hljs-literal">nullptr</span> || ret != CAMERA_OK || !hasFlash) {</li><li>        <span class="hljs-keyword">return</span>;</li><li>    }</li><li>
</li><li>    <span class="hljs-comment">// 检查闪光灯模式是否支持。</span></li><li>    <span class="hljs-type">bool</span> isSupported = <span class="hljs-literal">false</span>;</li><li>   ret = <span class="hljs-built_in">OH_CaptureSession_IsFlashModeSupported</span>(captureSession, flashMode, &amp;isSupported);</li><li>    <span class="hljs-keyword">if</span> (ret != CAMERA_OK || !isSupported) {</li><li>        <span class="hljs-keyword">return</span>;</li><li>    }</li><li>
</li><li>    <span class="hljs-comment">// 设置闪光灯模式。</span></li><li>    ret = <span class="hljs-built_in">OH_CaptureSession_SetFlashMode</span>(captureSession, flashMode);</li><li>    <span class="hljs-keyword">if</span> (ret != CAMERA_OK) {</li><li>        <span class="hljs-keyword">return</span>;</li><li>    }</li><li>
</li><li>    <span class="hljs-comment">// 获取当前设备的闪光灯模式。</span></li><li>    ret = <span class="hljs-built_in">OH_CaptureSession_GetFlashMode</span>(captureSession, &amp;flashMode);</li><li> }</li><li>
</li><li><span class="hljs-comment">// 曝光。</span></li><li><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">IsExposureModeSupportedFn</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> mode, Camera_CaptureSession *captureSession)</span></span></li><li><span class="hljs-function"></span>{</li><li>    Camera_ExposureMode exposureMode = <span class="hljs-built_in">static_cast</span>&lt;Camera_ExposureMode&gt;(mode);</li><li>    <span class="hljs-type">bool</span> isExposureModeSupported = <span class="hljs-literal">false</span>;</li><li>    Camera_ErrorCode ret = <span class="hljs-built_in">OH_CaptureSession_IsExposureModeSupported</span>(captureSession, exposureMode, &amp;isExposureModeSupported);</li><li>    <span class="hljs-keyword">if</span> (&amp;isExposureModeSupported == <span class="hljs-literal">nullptr</span> || ret != CAMERA_OK) {</li><li>        <span class="hljs-keyword">return</span>;</li><li>    }</li><li>    ret = <span class="hljs-built_in">OH_CaptureSession_SetExposureMode</span>(captureSession, exposureMode);</li><li>    <span class="hljs-keyword">if</span> (ret != CAMERA_OK) {</li><li>        <span class="hljs-keyword">return</span>;</li><li>    }</li><li>    ret = <span class="hljs-built_in">OH_CaptureSession_GetExposureMode</span>(captureSession, &amp;exposureMode);</li><li>}</li></ol></pre></div></div></li>     </ol>    </div>   </div>   <div></div></div>