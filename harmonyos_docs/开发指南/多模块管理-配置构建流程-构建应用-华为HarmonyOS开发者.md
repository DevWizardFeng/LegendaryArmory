<h1 _ngcontent-lql-c119="" class="doc-title ng-star-inserted" title="多模块管理"> 多模块管理 </h1>

<div _ngcontent-lql-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div id="body0000001778674593">    <p id="ZH-CN_TOPIC_0000002478174418__p1389862717813">模块是应用/元服务的基本功能单元，包含了源代码、资源文件、第三方库及应用/元服务配置文件，Hvigor支持工程多模块管理。您可在工程下的build-profile.json5配置文件中增加对应模块信息，即可对模块进行工程绑定和管理，或在hvigorconfig.ts脚本中动态添加或排除某个模块。同时也支持分模块配置、编译和打包。</p>    <div class="tiledSection">     <h2 id="section99251918477">多模块配置<i class="anchor-icon anchor-icon-link" anchorid="section99251918477" tips="复制节点链接"></i></h2>         </div>    <div class="tiledSection">     <h3 id="section2026315125155" class="firsth2">静态配置模块<i class="anchor-icon anchor-icon-link" anchorid="section2026315125155" tips="复制节点链接"></i></h3>          <p id="ZH-CN_TOPIC_0000002478174418__p207581631141619">工程级build-profile.json5配置文件中"modules"字段，用于记录工程下的模块信息，主要包含模块名称、模块的源码路径以及模块的 target 信息。target信息主要用于定制多目标构建产物，更多详细信息可参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-customized-multi-targets-and-products">配置多目标产物</a>章节。</p>     <p id="ZH-CN_TOPIC_0000002478174418__p20758143120165">例如以下目录中存在两个模块目录，您可在工程下的build-profile.json5配置文件，添加模块信息，使得模块与工程进行绑定：</p>     <div _ngcontent-lql-c106="" class="highlight-div"><div _ngcontent-lql-c106="" class="highlight-div-header"><div _ngcontent-lql-c106="" class="highlight-div-header-left"><div _ngcontent-lql-c106="" class="handle-button expand-button"><div _ngcontent-lql-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-lql-c106="" class="highlight-div-header-right"><div _ngcontent-lql-c106="" class="handle-button ai-button"></div><div _ngcontent-lql-c106="" class="handle-button line-button"><div _ngcontent-lql-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-lql-c106="" class="handle-button theme-button"><div _ngcontent-lql-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-lql-c106="" class="handle-button copy-button"><div _ngcontent-lql-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-lql-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" id="ZH-CN_TOPIC_0000002478174418__screen118711114249" data-highlighted="yes"><ol class="linenums"><li>工程结构</li><li>└─ .hvigor目录    <span class="hljs-comment">// 构建项目的缓存文件目录，不需要开发者改动，可以删除</span></li><li>└─ module1</li><li>   └─ 模块源码文件</li><li>   └─ build-profile.json5    <span class="hljs-comment">// 模块级别的构建静态配置文件，主要用于定义当前模块的构建信息、hap(hsp、har)的构建行为等</span></li><li>   └─ hvigorfile.ts    <span class="hljs-comment">// 模块级别的构建动态自定义脚本，主要用于定义和扩展hap(hsp、har)的构建流程</span></li><li>   └─ 其他配置文件</li><li>└─ module2</li><li>└─ hvigor目录</li><li>   └─ hvigor-config.json5    <span class="hljs-comment">// 构建引擎的配置文件，主要用于定义开发态版本号、依赖插件的版本以及Hvigor相关能力的配置等</span></li><li>└─ build-profile.json5    <span class="hljs-comment">// 工程级别的构建静态配置文件，主要用于定义整个项目的模块信息、应用信息、app的构建行为等</span></li><li>└─ hvigorfile.ts    <span class="hljs-comment">// 工程级别的构建动态自定义脚本，主要用于定义和扩展app的构建流程</span></li><li>└─ 其他配置文件</li></ol></pre></div></div>     <p id="ZH-CN_TOPIC_0000002478174418__p147581331181611"></p>     <p id="ZH-CN_TOPIC_0000002478174418__p187581631201614">其他配置文件：</p>     <ul id="ZH-CN_TOPIC_0000002478174418__ul107582031111610">      <li id="li107581531191613">oh-package.json5：应用的三方包依赖配置文件。</li>      <li id="li137581731131619">local.properties: 应用本地环境配置文件。</li>      <li id="li5758163117168">obfuscation-rules.txt: 应用模块的混淆规则配置文件。</li>      <li id="li107581531141618">consumer-rules.txt: HAR/HSP模块默认导出的混淆规则文件，会打包到HAR包中。</li>     </ul>     <p id="ZH-CN_TOPIC_0000002478174418__p1575893117168">工程下的build-profile.json5文件中模块配置示例：</p>     <div _ngcontent-lql-c106="" class="highlight-div"><div _ngcontent-lql-c106="" class="highlight-div-header"><div _ngcontent-lql-c106="" class="highlight-div-header-left"><div _ngcontent-lql-c106="" class="handle-button expand-button"><div _ngcontent-lql-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-lql-c106="" class="highlight-div-header-right"><div _ngcontent-lql-c106="" class="handle-button ai-button"></div><div _ngcontent-lql-c106="" class="handle-button line-button"><div _ngcontent-lql-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-lql-c106="" class="handle-button theme-button"><div _ngcontent-lql-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-lql-c106="" class="handle-button copy-button"><div _ngcontent-lql-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-lql-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" id="ZH-CN_TOPIC_0000002478174418__screen13758931191615" data-highlighted="yes"><ol class="linenums"><li>{</li><li>  <span class="hljs-string">"modules"</span>: [</li><li>    {</li><li>      <span class="hljs-string">"name"</span>: <span class="hljs-string">"module1"</span>, <span class="hljs-comment">// 模块的名称。该名称需与module.json5文件中的module.name保持一致。在FA模型中，对应的文件为config.json。</span></li><li>      <span class="hljs-string">"srcPath"</span>: <span class="hljs-string">"./module1"</span> <span class="hljs-comment">// 模块的源码路径，为模块根目录相对工程根目录的相对路径</span></li><li>    },</li><li>    {</li><li>      <span class="hljs-string">"name"</span>: <span class="hljs-string">"module2"</span>,</li><li>      <span class="hljs-string">"srcPath"</span>: <span class="hljs-string">"./module2"</span></li><li>    }</li><li>  ]</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="section1456515341151">动态配置模块<i class="anchor-icon anchor-icon-link" anchorid="section1456515341151" tips="复制节点链接"></i></h3>          <p id="ZH-CN_TOPIC_0000002478174418__p0703155161510">Hvigor支持在<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-hvigor-life-cycle#section810245135914">hvigorconfig.ts脚本</a>中动态添加或排除某个模块，具体API及示例可参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-hvigor-api#section7253174081515">HvigorConfig</a>。</p>    </div>    <div class="tiledSection">     <h2 id="section166234361378">分模块编译<i class="anchor-icon anchor-icon-link" anchorid="section166234361378" tips="复制节点链接"></i></h2>          <p id="ZH-CN_TOPIC_0000002478174418__p6836919201114">Hvigor支持分模块编译和打包。您可以通过以下两种方式进行分模块构建：</p>     <ul id="ZH-CN_TOPIC_0000002478174418__ul17383152215152">      <li id="li4383192211519">在DevEco Studio中，选中需构建的模块目录后，点击Build菜单栏下的"Make module 'module1'"，其中"module1"根据具体工程模块名称显示；</li>      <li id="li1021117193311">在DevEco Studio的Terminal中，指定模块进行编译。比如模块名称为entry，目标产物target为default，构建HAP模块，可执行以下命令：       <div _ngcontent-lql-c106="" class="highlight-div"><div _ngcontent-lql-c106="" class="highlight-div-header"><div _ngcontent-lql-c106="" class="highlight-div-header-left"><div _ngcontent-lql-c106="" class="handle-button expand-button"><div _ngcontent-lql-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-lql-c106="" class="highlight-div-header-right"><div _ngcontent-lql-c106="" class="handle-button ai-button"></div><div _ngcontent-lql-c106="" class="handle-button line-button"><div _ngcontent-lql-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-lql-c106="" class="handle-button theme-button"><div _ngcontent-lql-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-lql-c106="" class="handle-button copy-button"><div _ngcontent-lql-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-lql-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" id="ZH-CN_TOPIC_0000002478174418__screen1096754317363" data-highlighted="yes"><ol class="linenums"><li>hvigorw --mode <span class="hljs-keyword">module</span> -p product=<span class="hljs-keyword">default</span> -p <span class="hljs-keyword">module</span>=entry@<span class="hljs-keyword">default</span> assembleHap</li></ol></pre></div></div></li>     </ul>     <p id="ZH-CN_TOPIC_0000002478174418__p16156736123614">更多构建HAR/HSP包命令，可参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-hvigor-commandline#section9580122622012">命令行工具</a>章节。</p>    </div>   </div>   <div></div></div>