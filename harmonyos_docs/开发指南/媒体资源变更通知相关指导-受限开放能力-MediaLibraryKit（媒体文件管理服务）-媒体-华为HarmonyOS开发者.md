<h1 _ngcontent-wif-c119="" class="doc-title ng-star-inserted" title="媒体资源变更通知相关指导"> 媒体资源变更通知相关指导 </h1>

<div _ngcontent-wif-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p>photoAccessHelper提供监听指定媒体资源变更的接口。</p>    <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">      <p>在进行功能开发前，请查阅<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/photoaccesshelper-preparation">开发准备</a>，了解如何获取相册管理模块实例和如何申请相册管理模块功能开发相关权限。</p>      <p>文档中使用到photoAccessHelper的地方默认为使用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/photoaccesshelper-preparation">开发准备</a>中获取的对象，如未添加此段代码报photoAccessHelper未定义的错误请自行添加。</p>     </div></div></div>    <p>媒体资源变更通知相关接口的异步调用仅支持使用callback方式。以下只列出部分接口使用方式，其他使用方式可以查阅<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-photoaccesshelper" target="_blank">API参考</a>。</p>    <p>如无特别说明，文档中涉及的待获取资源均视为已预置且数据库中存在相应数据。若按示例代码执行后资源为空，请确认文件是否已预置，以及数据库中是否存在该文件的数据。</p>    <div class="tiledSection">     <h2 id="监听指定uri">监听指定URI<i class="anchor-icon anchor-icon-link" anchorid="监听指定uri" tips="复制节点链接"></i></h2>          <p>通过调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-photoaccesshelper-photoaccesshelper#registerchange" target="_blank">registerChange</a>接口监听指定uri。当被监听对象发生变更时返回监听器回调函数的值。</p>    </div>    <div class="tiledSection">     <h3 id="对指定photoasset注册监听" class="firsth2">对指定PhotoAsset注册监听<i class="anchor-icon anchor-icon-link" anchorid="对指定photoasset注册监听" tips="复制节点链接"></i></h3>          <p>对指定PhotoAsset注册监听，当监听的PhotoAsset发生变更时，返回回调。</p>     <p><strong>前提条件</strong></p>     <ul>      <li>获取相册管理模块photoAccessHelper实例。</li>      <li><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/photoaccesshelper-preparation#申请相册管理模块功能相关权限">申请相册管理模块权限</a>'ohos.permission.READ_IMAGEVIDEO'和'ohos.permission.WRITE_IMAGEVIDEO'。</li>     </ul>     <p>以对一张图片注册监听为例，通过删除图片触发回调。</p>     <p><strong>开发步骤</strong></p>     <ol>      <li><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/photoaccesshelper-resource-guidelines#获取指定媒体资源">获取指定媒体资源</a>。</li>      <li>对指定PhotoAsset注册监听。</li>      <li>将指定媒体资源删除。</li>     </ol>     <div _ngcontent-wif-c106="" class="highlight-div"><div _ngcontent-wif-c106="" class="highlight-div-header"><div _ngcontent-wif-c106="" class="highlight-div-header-left"><div _ngcontent-wif-c106="" class="handle-button expand-button"><div _ngcontent-wif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wif-c106="" class="highlight-div-header-right"><div _ngcontent-wif-c106="" class="handle-button ai-button"></div><div _ngcontent-wif-c106="" class="handle-button line-button"><div _ngcontent-wif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wif-c106="" class="handle-button theme-button"><div _ngcontent-wif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wif-c106="" class="handle-button copy-button"><div _ngcontent-wif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { dataSharePredicates } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkData'</span>;</li><li><span class="hljs-keyword">import</span> { photoAccessHelper } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.MediaLibraryKit'</span>;</li><li>
</li><li><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">example</span>(<span class="hljs-params">phAccessHelper: photoAccessHelper.PhotoAccessHelper, context: Context</span>) {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">predicates</span>: dataSharePredicates.<span class="hljs-property">DataSharePredicates</span> = <span class="hljs-keyword">new</span> dataSharePredicates.<span class="hljs-title class_">DataSharePredicates</span>();</li><li>  predicates.<span class="hljs-title function_">equalTo</span>(photoAccessHelper.<span class="hljs-property">PhotoKeys</span>.<span class="hljs-property">DISPLAY_NAME</span>, <span class="hljs-string">'test.jpg'</span>);</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">fetchOptions</span>: photoAccessHelper.<span class="hljs-property">FetchOptions</span> = {</li><li>    <span class="hljs-attr">fetchColumns</span>: [],</li><li>    <span class="hljs-attr">predicates</span>: predicates</li><li>  };</li><li>  <span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">fetchResult</span>: photoAccessHelper.<span class="hljs-property">FetchResult</span>&lt;photoAccessHelper.<span class="hljs-property">PhotoAsset</span>&gt; = <span class="hljs-keyword">await</span> phAccessHelper.<span class="hljs-title function_">getAssets</span>(fetchOptions);</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">photoAsset</span>: photoAccessHelper.<span class="hljs-property">PhotoAsset</span> = <span class="hljs-keyword">await</span> fetchResult.<span class="hljs-title function_">getFirstObject</span>();</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'getAssets photoAsset.uri : '</span> + photoAsset.<span class="hljs-property">uri</span>);</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-title function_">onCallback</span> = (<span class="hljs-params">changeData: photoAccessHelper.ChangeData</span>) =&gt; {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'onCallback successfully, changeData: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(changeData));</li><li>    }</li><li>    phAccessHelper.<span class="hljs-title function_">registerChange</span>(photoAsset.<span class="hljs-property">uri</span>, <span class="hljs-literal">false</span>, onCallback);</li><li>    <span class="hljs-keyword">await</span> photoAccessHelper.<span class="hljs-property">MediaAssetChangeRequest</span>.<span class="hljs-title function_">deleteAssets</span>(context, [photoAsset]);</li><li>    fetchResult.<span class="hljs-title function_">close</span>();</li><li>  } <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'onCallback failed with err: '</span> + err);</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="对指定album注册监听">对指定Album注册监听<i class="anchor-icon anchor-icon-link" anchorid="对指定album注册监听" tips="复制节点链接"></i></h3>          <p>对指定Album注册监听，当Album发生变更时，触发监听回调。</p>     <p><strong>前提条件</strong></p>     <ul>      <li>获取相册管理模块photoAccessHelper实例。</li>      <li><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/photoaccesshelper-preparation#申请相册管理模块功能相关权限">申请相册管理模块权限</a>'ohos.permission.READ_IMAGEVIDEO'和'ohos.permission.WRITE_IMAGEVIDEO'。</li>     </ul>     <p>以对一个用户相册注册监听为例，通过重命名相册触发回调。</p>     <p><strong>开发步骤</strong></p>     <ol>      <li><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/photoaccesshelper-useralbum-guidelines#获取用户相册">获取用户相册</a>。</li>      <li>对指定Album注册监听。</li>      <li>将指定用户相册重命名。</li>     </ol>     <div _ngcontent-wif-c106="" class="highlight-div"><div _ngcontent-wif-c106="" class="highlight-div-header"><div _ngcontent-wif-c106="" class="highlight-div-header-left"><div _ngcontent-wif-c106="" class="handle-button expand-button"><div _ngcontent-wif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wif-c106="" class="highlight-div-header-right"><div _ngcontent-wif-c106="" class="handle-button ai-button"></div><div _ngcontent-wif-c106="" class="handle-button line-button"><div _ngcontent-wif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wif-c106="" class="handle-button theme-button"><div _ngcontent-wif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wif-c106="" class="handle-button copy-button"><div _ngcontent-wif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { dataSharePredicates } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkData'</span>;</li><li><span class="hljs-keyword">import</span> { photoAccessHelper } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.MediaLibraryKit'</span>;</li><li>
</li><li><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">example</span>(<span class="hljs-params">phAccessHelper: photoAccessHelper.PhotoAccessHelper</span>) {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">predicates</span>: dataSharePredicates.<span class="hljs-property">DataSharePredicates</span> = <span class="hljs-keyword">new</span> dataSharePredicates.<span class="hljs-title class_">DataSharePredicates</span>();</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">albumName</span>: photoAccessHelper.<span class="hljs-property">AlbumKeys</span> = photoAccessHelper.<span class="hljs-property">AlbumKeys</span>.<span class="hljs-property">ALBUM_NAME</span>;</li><li>  predicates.<span class="hljs-title function_">equalTo</span>(albumName, <span class="hljs-string">'albumName'</span>);</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">fetchOptions</span>: photoAccessHelper.<span class="hljs-property">FetchOptions</span> = {</li><li>    <span class="hljs-attr">fetchColumns</span>: [],</li><li>    <span class="hljs-attr">predicates</span>: predicates</li><li>  };</li><li>
</li><li>  <span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">fetchResult</span>: photoAccessHelper.<span class="hljs-property">FetchResult</span>&lt;photoAccessHelper.<span class="hljs-property">Album</span>&gt; = <span class="hljs-keyword">await</span> phAccessHelper.<span class="hljs-title function_">getAlbums</span>(photoAccessHelper.<span class="hljs-property">AlbumType</span>.<span class="hljs-property">USER</span>, photoAccessHelper.<span class="hljs-property">AlbumSubtype</span>.<span class="hljs-property">USER_GENERIC</span>, fetchOptions);</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">album</span>: photoAccessHelper.<span class="hljs-property">Album</span> = <span class="hljs-keyword">await</span> fetchResult.<span class="hljs-title function_">getFirstObject</span>();</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'getAlbums successfully, albumUri: '</span> + album.<span class="hljs-property">albumUri</span>);</li><li>
</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-title function_">onCallback</span> = (<span class="hljs-params">changeData: photoAccessHelper.ChangeData</span>) =&gt; {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'onCallback successfully, changeData: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(changeData));</li><li>    }</li><li>    phAccessHelper.<span class="hljs-title function_">registerChange</span>(album.<span class="hljs-property">albumUri</span>, <span class="hljs-literal">false</span>, onCallback);</li><li>    album.<span class="hljs-property">albumName</span> = <span class="hljs-string">'newAlbumName'</span> + <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();</li><li>    <span class="hljs-keyword">await</span> album.<span class="hljs-title function_">commitModify</span>();</li><li>    fetchResult.<span class="hljs-title function_">close</span>();</li><li>  } <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'onCallback failed with err: '</span> + err);</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="模糊监听">模糊监听<i class="anchor-icon anchor-icon-link" anchorid="模糊监听" tips="复制节点链接"></i></h2>          <ol>      <li>通过设置forChildUris值为true来注册模糊监听，uri为相册uri时，forChildUris为true能监听到相册中文件的变化，如果是false只能监听相册本身变化。</li>      <li>uri为photoAsset时，forChildUris为true、false没有区别。</li>      <li>uri为DefaultChangeUri时，forChildUris必须为true，如果为false将找不到该uri，收不到任何消息。</li>     </ol>    </div>    <div class="tiledSection">     <h3 id="对所有photoasset注册监听" class="firsth2">对所有PhotoAsset注册监听<i class="anchor-icon anchor-icon-link" anchorid="对所有photoasset注册监听" tips="复制节点链接"></i></h3>          <p>对所有PhotoAsset注册监听，当被监听的PhotoAsset发生变更时，返回监听回调。</p>     <p><strong>前提条件</strong></p>     <ul>      <li>获取相册管理模块photoAccessHelper实例。</li>      <li><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/photoaccesshelper-preparation#申请相册管理模块功能相关权限">申请相册管理模块权限</a>'ohos.permission.READ_IMAGEVIDEO'和'ohos.permission.WRITE_IMAGEVIDEO'。</li>     </ul>     <p>下面以对所有PhotoAsset注册监听，通过将被监听的PhotoAsset删除触发监听回调为例。</p>     <p><strong>开发步骤</strong></p>     <ol>      <li>对所有PhotoAsset注册监听。</li>      <li><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/photoaccesshelper-resource-guidelines#获取指定媒体资源">获取指定媒体资源</a>。</li>      <li>将指定媒体资源删除。</li>     </ol>     <div _ngcontent-wif-c106="" class="highlight-div"><div _ngcontent-wif-c106="" class="highlight-div-header"><div _ngcontent-wif-c106="" class="highlight-div-header-left"><div _ngcontent-wif-c106="" class="handle-button expand-button"><div _ngcontent-wif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wif-c106="" class="highlight-div-header-right"><div _ngcontent-wif-c106="" class="handle-button ai-button"></div><div _ngcontent-wif-c106="" class="handle-button line-button"><div _ngcontent-wif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wif-c106="" class="handle-button theme-button"><div _ngcontent-wif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wif-c106="" class="handle-button copy-button"><div _ngcontent-wif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { dataSharePredicates } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkData'</span>;</li><li><span class="hljs-keyword">import</span> { photoAccessHelper } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.MediaLibraryKit'</span>;</li><li>
</li><li><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">example</span>(<span class="hljs-params">phAccessHelper: photoAccessHelper.PhotoAccessHelper, context: Context</span>) {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-title function_">onCallback</span> = (<span class="hljs-params">changeData: photoAccessHelper.ChangeData</span>) =&gt; {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'onCallback successfully, changeData: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(changeData));</li><li>  }</li><li>  phAccessHelper.<span class="hljs-title function_">registerChange</span>(photoAccessHelper.<span class="hljs-property">DefaultChangeUri</span>.<span class="hljs-property">DEFAULT_PHOTO_URI</span>, <span class="hljs-literal">true</span>, onCallback);</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">predicates</span>: dataSharePredicates.<span class="hljs-property">DataSharePredicates</span> = <span class="hljs-keyword">new</span> dataSharePredicates.<span class="hljs-title class_">DataSharePredicates</span>();</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">fetchOptions</span>: photoAccessHelper.<span class="hljs-property">FetchOptions</span> = {</li><li>    <span class="hljs-attr">fetchColumns</span>: [],</li><li>    <span class="hljs-attr">predicates</span>: predicates</li><li>  };</li><li>  <span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">fetchResult</span>: photoAccessHelper.<span class="hljs-property">FetchResult</span>&lt;photoAccessHelper.<span class="hljs-property">PhotoAsset</span>&gt; = <span class="hljs-keyword">await</span> phAccessHelper.<span class="hljs-title function_">getAssets</span>(fetchOptions);</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">photoAsset</span>: photoAccessHelper.<span class="hljs-property">PhotoAsset</span> = <span class="hljs-keyword">await</span> fetchResult.<span class="hljs-title function_">getFirstObject</span>();</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'getAssets photoAsset.uri : '</span> + photoAsset.<span class="hljs-property">uri</span>);</li><li>    <span class="hljs-keyword">await</span> photoAccessHelper.<span class="hljs-property">MediaAssetChangeRequest</span>.<span class="hljs-title function_">deleteAssets</span>(context, [photoAsset]);</li><li>    fetchResult.<span class="hljs-title function_">close</span>();</li><li>  } <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'onCallback failed with err: '</span> + err);</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="取消对指定uri的监听">取消对指定URI的监听<i class="anchor-icon anchor-icon-link" anchorid="取消对指定uri的监听" tips="复制节点链接"></i></h2>          <p>取消对指定uri的监听，通过调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-photoaccesshelper-photoaccesshelper#unregisterchange" target="_blank">unRegisterChange</a>接口取消对指定uri的监听。一个uri可以注册多个监听，存在多个callback监听时，可以取消指定注册的callback的监听；不指定callback时取消该uri的所有监听。</p>     <p><strong>前提条件</strong></p>     <ul>      <li>获取相册管理模块photoAccessHelper实例。</li>      <li><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/photoaccesshelper-preparation#申请相册管理模块功能相关权限">申请相册管理模块权限</a>'ohos.permission.READ_IMAGEVIDEO'和'ohos.permission.WRITE_IMAGEVIDEO'。</li>     </ul>     <p>下面以取消对图片指定的监听为例，取消监听后，删除图片不再触发对应的监听回调。</p>     <p><strong>开发步骤</strong></p>     <ol>      <li><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/photoaccesshelper-resource-guidelines#获取指定媒体资源">获取指定媒体资源</a>。</li>      <li>取消对指定媒体资源uri的监听。</li>      <li>将指定媒体资源删除。</li>     </ol>     <div _ngcontent-wif-c106="" class="highlight-div"><div _ngcontent-wif-c106="" class="highlight-div-header"><div _ngcontent-wif-c106="" class="highlight-div-header-left"><div _ngcontent-wif-c106="" class="handle-button expand-button"><div _ngcontent-wif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wif-c106="" class="highlight-div-header-right"><div _ngcontent-wif-c106="" class="handle-button ai-button"></div><div _ngcontent-wif-c106="" class="handle-button line-button"><div _ngcontent-wif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wif-c106="" class="handle-button theme-button"><div _ngcontent-wif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wif-c106="" class="handle-button copy-button"><div _ngcontent-wif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wif-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { dataSharePredicates } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkData'</span>;</li><li><span class="hljs-keyword">import</span> { photoAccessHelper } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.MediaLibraryKit'</span>;</li><li>
</li><li><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">example</span>(<span class="hljs-params">phAccessHelper: photoAccessHelper.PhotoAccessHelper, context: Context</span>) {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">predicates</span>: dataSharePredicates.<span class="hljs-property">DataSharePredicates</span> = <span class="hljs-keyword">new</span> dataSharePredicates.<span class="hljs-title class_">DataSharePredicates</span>();</li><li>  predicates.<span class="hljs-title function_">equalTo</span>(photoAccessHelper.<span class="hljs-property">PhotoKeys</span>.<span class="hljs-property">DISPLAY_NAME</span>, <span class="hljs-string">'test.jpg'</span>);</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">fetchOptions</span>: photoAccessHelper.<span class="hljs-property">FetchOptions</span> = {</li><li>    <span class="hljs-attr">fetchColumns</span>: [],</li><li>    <span class="hljs-attr">predicates</span>: predicates</li><li>  };</li><li>  <span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">fetchResult</span>: photoAccessHelper.<span class="hljs-property">FetchResult</span>&lt;photoAccessHelper.<span class="hljs-property">PhotoAsset</span>&gt; = <span class="hljs-keyword">await</span> phAccessHelper.<span class="hljs-title function_">getAssets</span>(fetchOptions);</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">photoAsset</span>: photoAccessHelper.<span class="hljs-property">PhotoAsset</span> = <span class="hljs-keyword">await</span> fetchResult.<span class="hljs-title function_">getFirstObject</span>();</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'getAssets photoAsset.uri : '</span> + photoAsset.<span class="hljs-property">uri</span>);</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-title function_">onCallback1</span> = (<span class="hljs-params">changeData: photoAccessHelper.ChangeData</span>) =&gt; {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'onCallback1, changeData: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(changeData));</li><li>    }</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-title function_">onCallback2</span> = (<span class="hljs-params">changeData: photoAccessHelper.ChangeData</span>) =&gt; {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'onCallback2, changeData: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(changeData));</li><li>    }</li><li>    phAccessHelper.<span class="hljs-title function_">registerChange</span>(photoAsset.<span class="hljs-property">uri</span>, <span class="hljs-literal">false</span>, onCallback1);</li><li>    phAccessHelper.<span class="hljs-title function_">registerChange</span>(photoAsset.<span class="hljs-property">uri</span>, <span class="hljs-literal">false</span>, onCallback2);</li><li>    phAccessHelper.<span class="hljs-title function_">unRegisterChange</span>(photoAsset.<span class="hljs-property">uri</span>, onCallback1);</li><li>    <span class="hljs-keyword">await</span> photoAccessHelper.<span class="hljs-property">MediaAssetChangeRequest</span>.<span class="hljs-title function_">deleteAssets</span>(context, [photoAsset]);</li><li>    fetchResult.<span class="hljs-title function_">close</span>();</li><li>  } <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'onCallback failed with err: '</span> + err);</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>   </div>   <div></div></div>