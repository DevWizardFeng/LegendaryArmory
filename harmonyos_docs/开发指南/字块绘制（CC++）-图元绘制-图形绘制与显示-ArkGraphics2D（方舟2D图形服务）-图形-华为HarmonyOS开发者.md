<h1 _ngcontent-rqt-c119="" class="doc-title ng-star-inserted" title="字块绘制（C/C++）"> 字块绘制（C/C++） </h1>

<div _ngcontent-rqt-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <div class="tiledSection">     <h2 id="场景介绍">场景介绍<i class="anchor-icon anchor-icon-link" anchorid="场景介绍" tips="复制节点链接"></i></h2>          <p>字块（TextBlob）是指文本的集合。无论是单个的文字还是大块的文本，都可以通过字块来绘制。</p>     <p>除了基本的字块绘制之外，还可以给文字添加各种绘制效果。常见的字块绘制场景包括<a href="/consumer/cn/doc/harmonyos-guides/textblock-drawing-c#文字描边">文字描边</a>、<a href="/consumer/cn/doc/harmonyos-guides/textblock-drawing-c#文字渐变">文字渐变</a>等，更多效果请见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/drawing-effect-overview">绘制效果</a>。</p>     <p>本节不涉及文本测量和布局排版相关内容，如需在开发中处理此类文本绘制需求，可参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/text-overview">文本开发概述</a>，该文档系统讲解了排版策略与相关使用指导。</p>    </div>    <div class="tiledSection">     <h2 id="基本字块绘制">基本字块绘制<i class="anchor-icon anchor-icon-link" anchorid="基本字块绘制" tips="复制节点链接"></i></h2>          <p>使用OH_Drawing_CanvasDrawTextBlob()接口绘制字块，接口接受4个参数，分别为：画布Canvas对象、字块对象、文字基线左端点的x坐标和y坐标。</p>     <p>画布Canvas对象具体可见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/canvas-get-result-draw-c">画布的获取与绘制结果的显示（C/C++）</a>。</p>     <p>字块对象可以通过多种方式创建得到，详细的字块创建方式请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-drawing-text-blob-h" target="_blank">drawing_text_blob.h</a>。</p>     <p>此处以使用OH_Drawing_TextBlobCreateFromString()接口创建字块为例，接口接受3个参数，分别为：</p>     <ul>      <li>       <p>需要显示的文本字符串内容。</p></li>      <li>       <p>指向OH_Drawing_Font字体对象的指针。OH_Drawing_Font用于设置和获取字体的各种属性，如字体大小、文本样式、字体对齐方式、字体渲染方式、字体描边方式等，详细的API介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-drawing-font-h" target="_blank">draw_font</a>。</p></li>      <li>       <p>文本编码方式。</p></li>     </ul>     <p>简单示例和示意图如下所示：</p>     <div _ngcontent-rqt-c106="" class="highlight-div"><div _ngcontent-rqt-c106="" class="highlight-div-header"><div _ngcontent-rqt-c106="" class="highlight-div-header-left"><div _ngcontent-rqt-c106="" class="handle-button expand-button"><div _ngcontent-rqt-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rqt-c106="" class="highlight-div-header-right"><div _ngcontent-rqt-c106="" class="handle-button ai-button"></div><div _ngcontent-rqt-c106="" class="handle-button line-button"><div _ngcontent-rqt-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rqt-c106="" class="handle-button theme-button"><div _ngcontent-rqt-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rqt-c106="" class="handle-button copy-button"><div _ngcontent-rqt-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rqt-c106="" class="highlight-scroll-div"><pre class="prettyprint linenums hljs language-rust" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// sample_graphics.cpp</span></li><li><span class="hljs-comment">// 创建字体对象</span></li><li>OH_Drawing_Font *font = <span class="hljs-title function_ invoke__">OH_Drawing_FontCreate</span>();</li><li><span class="hljs-comment">// 设置字体大小</span></li><li><span class="hljs-title function_ invoke__">OH_Drawing_FontSetTextSize</span>(font, <span class="hljs-number">100</span>);</li><li><span class="hljs-comment">// 需要绘制的文字</span></li><li><span class="hljs-keyword">const</span> <span class="hljs-type">char</span> *<span class="hljs-type">str</span> = <span class="hljs-string">"Hello world"</span>;</li><li><span class="hljs-comment">// 创建字块对象</span></li><li>OH_Drawing_TextBlob *textBlob =</li><li>    <span class="hljs-title function_ invoke__">OH_Drawing_TextBlobCreateFromString</span>(<span class="hljs-type">str</span>, font, OH_Drawing_TextEncoding::TEXT_ENCODING_UTF8);</li><li><span class="hljs-comment">// 绘制字块</span></li><li><span class="hljs-title function_ invoke__">OH_Drawing_CanvasDrawTextBlob</span>(canvas, textBlob, <span class="hljs-number">200</span>, <span class="hljs-number">800</span>);</li><li><span class="hljs-comment">// 释放字块对象</span></li><li><span class="hljs-title function_ invoke__">OH_Drawing_TextBlobDestroy</span>(textBlob);</li><li><span class="hljs-comment">// 释放字体对象</span></li><li><span class="hljs-title function_ invoke__">OH_Drawing_FontDestroy</span>(font);</li></ol></pre></div></div>     <p><span><img originheight="379" originwidth="887" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114412.66897665120112205342492897726733:50001231000000:2800:1655D08804D28278B9F663272BFFE7AF34B341D820455DFBFEA881F04D70AD7B.jpg" width="887" height="379"></span></p>    </div>    <div class="tiledSection">     <h2 id="文字描边">文字描边<i class="anchor-icon anchor-icon-link" anchorid="文字描边" tips="复制节点链接"></i></h2>          <p>基于基本的字块绘制，还可以通过画笔实现文字描边效果，描边效果的更多介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/basic-drawing-effect-c#描边效果">描边效果</a>。</p>     <p>以下以英文文字描边和中文文字描边给出示例和指导。</p>    </div>    <div class="tiledSection">     <h3 id="英文文字描边" class="firsth2">英文文字描边<i class="anchor-icon anchor-icon-link" anchorid="英文文字描边" tips="复制节点链接"></i></h3>          <p>英文文字描边的简要示例和示意图如下：</p>     <div _ngcontent-rqt-c106="" class="highlight-div"><div _ngcontent-rqt-c106="" class="highlight-div-header"><div _ngcontent-rqt-c106="" class="highlight-div-header-left"><div _ngcontent-rqt-c106="" class="handle-button expand-button"><div _ngcontent-rqt-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rqt-c106="" class="highlight-div-header-right"><div _ngcontent-rqt-c106="" class="handle-button ai-button"></div><div _ngcontent-rqt-c106="" class="handle-button line-button"><div _ngcontent-rqt-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rqt-c106="" class="handle-button theme-button"><div _ngcontent-rqt-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rqt-c106="" class="handle-button copy-button"><div _ngcontent-rqt-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rqt-c106="" class="highlight-scroll-div"><pre class="prettyprint linenums hljs language-rust" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// sample_graphics.cpp</span></li><li><span class="hljs-comment">// 创建画笔</span></li><li>OH_Drawing_Pen *pen = <span class="hljs-title function_ invoke__">OH_Drawing_PenCreate</span>();</li><li><span class="hljs-comment">// 设置抗锯齿</span></li><li><span class="hljs-title function_ invoke__">OH_Drawing_PenSetAntiAlias</span>(pen, <span class="hljs-literal">true</span>);</li><li><span class="hljs-comment">// 设置描边颜色</span></li><li><span class="hljs-title function_ invoke__">OH_Drawing_PenSetColor</span>(pen, <span class="hljs-title function_ invoke__">OH_Drawing_ColorSetArgb</span>(<span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>));</li><li><span class="hljs-comment">// 设置描边线宽为3</span></li><li><span class="hljs-title function_ invoke__">OH_Drawing_PenSetWidth</span>(pen, <span class="hljs-number">3</span>);</li><li><span class="hljs-comment">// 设置画笔描边效果</span></li><li><span class="hljs-title function_ invoke__">OH_Drawing_CanvasAttachPen</span>(canvas, pen);</li><li><span class="hljs-comment">// 创建字型对象</span></li><li>OH_Drawing_Font *font = <span class="hljs-title function_ invoke__">OH_Drawing_FontCreate</span>();</li><li><span class="hljs-comment">// 设置字体大小</span></li><li><span class="hljs-title function_ invoke__">OH_Drawing_FontSetTextSize</span>(font, <span class="hljs-number">150</span>);</li><li><span class="hljs-keyword">const</span> <span class="hljs-type">char</span> *<span class="hljs-type">str</span> = <span class="hljs-string">"Hello world"</span>;</li><li><span class="hljs-comment">// 创建字块对象</span></li><li>OH_Drawing_TextBlob *textBlob =</li><li>    <span class="hljs-title function_ invoke__">OH_Drawing_TextBlobCreateFromString</span>(<span class="hljs-type">str</span>, font, OH_Drawing_TextEncoding::TEXT_ENCODING_UTF8);</li><li><span class="hljs-comment">// 绘制字块</span></li><li><span class="hljs-title function_ invoke__">OH_Drawing_CanvasDrawTextBlob</span>(canvas, textBlob, <span class="hljs-number">200</span>, <span class="hljs-number">800</span>);</li><li><span class="hljs-comment">// 去除描边效果</span></li><li><span class="hljs-title function_ invoke__">OH_Drawing_CanvasDetachPen</span>(canvas);</li><li><span class="hljs-comment">// 销毁各类对象</span></li><li><span class="hljs-title function_ invoke__">OH_Drawing_TextBlobDestroy</span>(textBlob);</li><li><span class="hljs-title function_ invoke__">OH_Drawing_FontDestroy</span>(font);</li><li><span class="hljs-title function_ invoke__">OH_Drawing_PenDestroy</span>(pen);</li></ol></pre></div></div>     <p><span><img originheight="456" originwidth="1248" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114412.56985854799751507242446001309663:50001231000000:2800:0995EBE3B65477E9879CF21ACA7FD77A21EAB35D6CA3CEDB01FD9540377102C8.jpg" width="920" height="336.1538461538462"></span></p>    </div>    <div class="tiledSection">     <h3 id="中文文字描边">中文文字描边<i class="anchor-icon anchor-icon-link" anchorid="中文文字描边" tips="复制节点链接"></i></h3>          <p>首先需要通过画笔描边，然后需要调用画刷填充内部颜色，去除字体中间的杂质和重叠部分，实现中文文字描边效果。</p>     <p>中文文字描边的简要示例和示意图如下：</p>     <div _ngcontent-rqt-c106="" class="highlight-div"><div _ngcontent-rqt-c106="" class="highlight-div-header"><div _ngcontent-rqt-c106="" class="highlight-div-header-left"><div _ngcontent-rqt-c106="" class="handle-button expand-button"><div _ngcontent-rqt-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rqt-c106="" class="highlight-div-header-right"><div _ngcontent-rqt-c106="" class="handle-button ai-button"></div><div _ngcontent-rqt-c106="" class="handle-button line-button"><div _ngcontent-rqt-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rqt-c106="" class="handle-button theme-button"><div _ngcontent-rqt-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rqt-c106="" class="handle-button copy-button"><div _ngcontent-rqt-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rqt-c106="" class="highlight-scroll-div"><pre class="prettyprint linenums hljs language-rust" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// sample_graphics.cpp</span></li><li><span class="hljs-comment">// 创建画刷</span></li><li>OH_Drawing_Brush *brush = <span class="hljs-title function_ invoke__">OH_Drawing_BrushCreate</span>();</li><li><span class="hljs-comment">// 创建画笔</span></li><li>OH_Drawing_Pen *pen = <span class="hljs-title function_ invoke__">OH_Drawing_PenCreate</span>();</li><li><span class="hljs-comment">// 设置画刷抗锯齿</span></li><li><span class="hljs-title function_ invoke__">OH_Drawing_BrushSetAntiAlias</span>(brush, <span class="hljs-literal">true</span>);</li><li><span class="hljs-comment">// 设置画刷描边颜色</span></li><li><span class="hljs-title function_ invoke__">OH_Drawing_BrushSetColor</span>(brush, <span class="hljs-title function_ invoke__">OH_Drawing_ColorSetArgb</span>(<span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>));</li><li><span class="hljs-comment">// 设置画笔抗锯齿</span></li><li><span class="hljs-title function_ invoke__">OH_Drawing_PenSetAntiAlias</span>(pen, <span class="hljs-literal">true</span>);</li><li><span class="hljs-comment">// 设置描边线宽为3</span></li><li><span class="hljs-title function_ invoke__">OH_Drawing_PenSetWidth</span>(pen, <span class="hljs-number">3</span>);</li><li><span class="hljs-comment">// 设置画笔描边颜色</span></li><li><span class="hljs-title function_ invoke__">OH_Drawing_PenSetColor</span>(pen, <span class="hljs-title function_ invoke__">OH_Drawing_ColorSetArgb</span>(<span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>));</li><li><span class="hljs-comment">// 设置画笔描边效果</span></li><li><span class="hljs-title function_ invoke__">OH_Drawing_CanvasAttachPen</span>(canvas, pen);</li><li><span class="hljs-comment">// 创建字型对象</span></li><li>OH_Drawing_Font *font = <span class="hljs-title function_ invoke__">OH_Drawing_FontCreate</span>();</li><li><span class="hljs-comment">// 设置字体大小</span></li><li><span class="hljs-title function_ invoke__">OH_Drawing_FontSetTextSize</span>(font, <span class="hljs-number">150</span>);</li><li><span class="hljs-keyword">const</span> <span class="hljs-type">char</span> *<span class="hljs-type">str</span> = <span class="hljs-string">"你好"</span>;</li><li><span class="hljs-comment">// 创建字块对象</span></li><li>OH_Drawing_TextBlob *textBlob =</li><li>    <span class="hljs-title function_ invoke__">OH_Drawing_TextBlobCreateFromString</span>(<span class="hljs-type">str</span>, font, OH_Drawing_TextEncoding::TEXT_ENCODING_UTF8);</li><li><span class="hljs-comment">// 绘制字块</span></li><li><span class="hljs-title function_ invoke__">OH_Drawing_CanvasDrawTextBlob</span>(canvas, textBlob, <span class="hljs-number">200</span>, <span class="hljs-number">800</span>);</li><li><span class="hljs-comment">// 去除描边效果</span></li><li><span class="hljs-title function_ invoke__">OH_Drawing_CanvasDetachPen</span>(canvas);</li><li><span class="hljs-comment">// 设置画刷描边效果</span></li><li><span class="hljs-title function_ invoke__">OH_Drawing_CanvasAttachBrush</span>(canvas, brush);</li><li><span class="hljs-title function_ invoke__">OH_Drawing_CanvasDrawTextBlob</span>(canvas, textBlob, <span class="hljs-number">200</span>, <span class="hljs-number">800</span>);</li><li>
</li><li><span class="hljs-comment">// 销毁各类对象</span></li><li><span class="hljs-title function_ invoke__">OH_Drawing_TextBlobDestroy</span>(textBlob);</li><li><span class="hljs-title function_ invoke__">OH_Drawing_FontDestroy</span>(font);</li><li><span class="hljs-title function_ invoke__">OH_Drawing_PenDestroy</span>(pen);</li><li><span class="hljs-title function_ invoke__">OH_Drawing_BrushDestroy</span>(brush);</li></ol></pre></div></div>     <p><span><img originheight="77" originwidth="150" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114412.64420537121882944182938316998696:50001231000000:2800:F82D1C699756F205C11CECFA3C37805109DFA3856B71A1D4E3515F1FA0B1629D.png" class="notEnlarge" width="150" height="77"></span></p>    </div>    <div class="tiledSection">     <h2 id="文字渐变">文字渐变<i class="anchor-icon anchor-icon-link" anchorid="文字渐变" tips="复制节点链接"></i></h2>          <p>基于基本字块绘制，还可以通过着色器实现文字渐变的效果，着色器的更多介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/complex-drawing-effect-c#着色器效果">着色器效果</a>。</p>     <p>以下为文字添加了线性渐变着色器效果的简要示例和示意图：</p>     <div _ngcontent-rqt-c106="" class="highlight-div"><div _ngcontent-rqt-c106="" class="highlight-div-header"><div _ngcontent-rqt-c106="" class="highlight-div-header-left"><div _ngcontent-rqt-c106="" class="handle-button expand-button"><div _ngcontent-rqt-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rqt-c106="" class="highlight-div-header-right"><div _ngcontent-rqt-c106="" class="handle-button ai-button"></div><div _ngcontent-rqt-c106="" class="handle-button line-button"><div _ngcontent-rqt-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rqt-c106="" class="handle-button theme-button"><div _ngcontent-rqt-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rqt-c106="" class="handle-button copy-button"><div _ngcontent-rqt-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rqt-c106="" class="highlight-scroll-div"><pre class="prettyprint linenums hljs language-rust" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// sample_graphics.cpp</span></li><li><span class="hljs-comment">// 开始点</span></li><li>OH_Drawing_Point *startPt = <span class="hljs-title function_ invoke__">OH_Drawing_PointCreate</span>(<span class="hljs-number">100</span>, <span class="hljs-number">100</span>);</li><li><span class="hljs-comment">// 结束点</span></li><li>OH_Drawing_Point *endPt = <span class="hljs-title function_ invoke__">OH_Drawing_PointCreate</span>(<span class="hljs-number">900</span>, <span class="hljs-number">900</span>);</li><li><span class="hljs-comment">// 颜色数组</span></li><li>uint32_t colors[] = {<span class="hljs-number">0xFFFFFF00</span>, <span class="hljs-number">0xFFFF0000</span>, <span class="hljs-number">0xFF0000FF</span>};</li><li><span class="hljs-comment">// 相对位置数组</span></li><li>float pos[] = {<span class="hljs-number">0.0</span>f, <span class="hljs-number">0.5</span>f, <span class="hljs-number">1.0</span>f};</li><li><span class="hljs-comment">// 创建线性渐变着色器效果</span></li><li>OH_Drawing_ShaderEffect *colorShaderEffect =</li><li>    <span class="hljs-title function_ invoke__">OH_Drawing_ShaderEffectCreateLinearGradient</span>(startPt, endPt, colors, pos, <span class="hljs-number">3</span>, OH_Drawing_TileMode::CLAMP);</li><li><span class="hljs-comment">// 创建画刷对象</span></li><li>OH_Drawing_Brush *brush = <span class="hljs-title function_ invoke__">OH_Drawing_BrushCreate</span>();</li><li><span class="hljs-comment">// 基于画刷设置着色器效果</span></li><li><span class="hljs-title function_ invoke__">OH_Drawing_BrushSetShaderEffect</span>(brush, colorShaderEffect);</li><li><span class="hljs-comment">// 设置画刷填充效果</span></li><li><span class="hljs-title function_ invoke__">OH_Drawing_CanvasAttachBrush</span>(canvas, brush);</li><li><span class="hljs-comment">// 创建字型对象</span></li><li>OH_Drawing_Font *font = <span class="hljs-title function_ invoke__">OH_Drawing_FontCreate</span>();</li><li><span class="hljs-comment">// 设置字体大小</span></li><li><span class="hljs-title function_ invoke__">OH_Drawing_FontSetTextSize</span>(font, <span class="hljs-number">150</span>);</li><li><span class="hljs-keyword">const</span> <span class="hljs-type">char</span> *<span class="hljs-type">str</span> = <span class="hljs-string">"Hello world"</span>;</li><li><span class="hljs-comment">// 创建字块对象</span></li><li>OH_Drawing_TextBlob *textBlob =</li><li>    <span class="hljs-title function_ invoke__">OH_Drawing_TextBlobCreateFromString</span>(<span class="hljs-type">str</span>, font, OH_Drawing_TextEncoding::TEXT_ENCODING_UTF8);</li><li><span class="hljs-comment">// 绘制字块</span></li><li><span class="hljs-title function_ invoke__">OH_Drawing_CanvasDrawTextBlob</span>(canvas, textBlob, <span class="hljs-number">200</span>, <span class="hljs-number">800</span>);</li><li><span class="hljs-comment">// 取消填充效果</span></li><li><span class="hljs-title function_ invoke__">OH_Drawing_CanvasDetachBrush</span>(canvas);</li><li><span class="hljs-comment">// 销毁各类对象</span></li><li><span class="hljs-title function_ invoke__">OH_Drawing_TextBlobDestroy</span>(textBlob);</li><li><span class="hljs-title function_ invoke__">OH_Drawing_FontDestroy</span>(font);</li><li><span class="hljs-title function_ invoke__">OH_Drawing_BrushDestroy</span>(brush);</li></ol></pre></div></div>     <p><span><img originheight="419" originwidth="1157" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114412.86288509767352752665502468168648:50001231000000:2800:A5C81602AF8519B34A3E2ECD7ACC254BF9FF0CBC2B6F5EACD60F88C9EB0994B9.jpg" width="920" height="333.17199654278306"></span></p>    </div>    <div class="tiledSection">     <h2 id="主题字体">主题字体<i class="anchor-icon anchor-icon-link" anchorid="主题字体" tips="复制节点链接"></i></h2>          <p>主题字体，特指系统<strong>主题应用</strong>中能使用的字体，属于一种特殊的自定义字体。如需涉及文本测量和布局排版相关内容，可参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/theme-font-c">使用主题字体（C/C++）</a>。</p>     <p>设置跟随主题字体的示例代码和效果图如下：</p>     <div _ngcontent-rqt-c106="" class="highlight-div"><div _ngcontent-rqt-c106="" class="highlight-div-header"><div _ngcontent-rqt-c106="" class="highlight-div-header-left"><div _ngcontent-rqt-c106="" class="handle-button expand-button"><div _ngcontent-rqt-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rqt-c106="" class="highlight-div-header-right"><div _ngcontent-rqt-c106="" class="handle-button ai-button"></div><div _ngcontent-rqt-c106="" class="handle-button line-button"><div _ngcontent-rqt-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rqt-c106="" class="handle-button theme-button"><div _ngcontent-rqt-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rqt-c106="" class="handle-button copy-button"><div _ngcontent-rqt-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rqt-c106="" class="highlight-scroll-div"><pre class="prettyprint linenums hljs language-rust" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// sample_graphics.cpp</span></li><li><span class="hljs-comment">// 创建字型对象</span></li><li>OH_Drawing_Font *font = <span class="hljs-title function_ invoke__">OH_Drawing_FontCreate</span>();</li><li><span class="hljs-comment">// 设置文字大小</span></li><li><span class="hljs-title function_ invoke__">OH_Drawing_FontSetTextSize</span>(font, <span class="hljs-number">100</span>);</li><li><span class="hljs-comment">// 设置跟随主题字体</span></li><li><span class="hljs-title function_ invoke__">OH_Drawing_FontSetThemeFontFollowed</span>(font, <span class="hljs-literal">true</span>);</li><li><span class="hljs-comment">// 需要绘制的文字</span></li><li><span class="hljs-keyword">const</span> <span class="hljs-type">char</span> *<span class="hljs-type">str</span> = <span class="hljs-string">"Hello World"</span>;</li><li><span class="hljs-comment">// 创建字块对象</span></li><li>OH_Drawing_TextBlob *textBlob =</li><li>    <span class="hljs-title function_ invoke__">OH_Drawing_TextBlobCreateFromString</span>(<span class="hljs-type">str</span>, font, OH_Drawing_TextEncoding::TEXT_ENCODING_UTF8);</li><li><span class="hljs-comment">// 绘制字块</span></li><li><span class="hljs-title function_ invoke__">OH_Drawing_CanvasDrawTextBlob</span>(canvas, textBlob, <span class="hljs-number">200</span>, <span class="hljs-number">800</span>);</li><li><span class="hljs-comment">// 释放字块对象</span></li><li><span class="hljs-title function_ invoke__">OH_Drawing_TextBlobDestroy</span>(textBlob);</li><li><span class="hljs-comment">// 释放字型对象</span></li><li><span class="hljs-title function_ invoke__">OH_Drawing_FontDestroy</span>(font);</li></ol></pre></div></div>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.7.5.1.3.1.1" valign="top" width="50%">未跟随主题字体的效果图</th>         <th align="left" class="cellrowborder" id="mcps1.3.7.5.1.3.1.2" valign="top" width="50%">跟随主题字体的效果图（不同主题字体显示效果不同，此处仅示意）</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="50%"><span><img originheight="210" originwidth="711" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114413.70999547235067037748367954618944:50001231000000:2800:83B11441A53F64DE919442E47D77E7BE93AD3BFCEC4F542818DA48FE4FB1F98C.jpg" width="436" height="128.77637130801688"></span></td>         <td class="cellrowborder" valign="top" width="50%"><span><img originheight="142" originwidth="517" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114413.70562967835821462088936272960125:50001231000000:2800:C84CDAB8155E1669CF51F732993FEC36F55DC5C948BCBB61936D8F1E00D9ECB0.jpg" width="436" height="119.75241779497098"></span></td>        </tr>             </tbody></table></div>     </div>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>需要在应用入口文件（默认工程中为EntryAbility.ets）中重写onConfigurationUpdate函数，以响应切换主题字体的操作，确保切换后页面能够及时刷新并生效。具体实现可参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/theme-font-c">使用主题字体（C/C++）</a>。</p>      </div></div></div>    </div>    <div class="tiledSection">     <h2 id="单字绘制">单字绘制<i class="anchor-icon anchor-icon-link" anchorid="单字绘制" tips="复制节点链接"></i></h2>          <p>单字绘制是图形渲染中针对文本渲染的一种精细化控制技术。相比字块绘制，其核心优势在于能够利用字体退化机制，在当前字体无法显示某字符时，自动退化到使用系统字体绘制字符，提升对特殊字符的兼容性，避免字符缺失。同时，单字绘制支持逐字符配置字体特征（如连字、替代字形），满足复杂排版需求，增强用户体验。详细API说明请见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-drawing-canvas-h#oh_drawing_canvasdrawsinglecharacter" target="_blank">drawing_canvas.h</a>。</p>     <p>基础场景：绘制无字体特征的字符</p>     <p>对于无需字体特征的常规文本渲染场景，可以使用OH_Drawing_CanvasDrawSingleCharacter绘制单个字符，使用OH_Drawing_FontMeasureSingleCharacter测量单个字符的宽度，示例代码和效果图如下：</p>     <div _ngcontent-rqt-c106="" class="highlight-div"><div _ngcontent-rqt-c106="" class="highlight-div-header"><div _ngcontent-rqt-c106="" class="highlight-div-header-left"><div _ngcontent-rqt-c106="" class="handle-button expand-button"><div _ngcontent-rqt-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rqt-c106="" class="highlight-div-header-right"><div _ngcontent-rqt-c106="" class="handle-button ai-button"></div><div _ngcontent-rqt-c106="" class="handle-button line-button"><div _ngcontent-rqt-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rqt-c106="" class="handle-button theme-button"><div _ngcontent-rqt-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rqt-c106="" class="handle-button copy-button"><div _ngcontent-rqt-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rqt-c106="" class="highlight-scroll-div"><pre class="prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// sample_graphics.cpp</span></li><li><span class="hljs-comment">// 创建字型对象</span></li><li>OH_Drawing_Font *font = <span class="hljs-built_in">OH_Drawing_FontCreate</span>();</li><li><span class="hljs-comment">// 设置文字大小</span></li><li><span class="hljs-built_in">OH_Drawing_FontSetTextSize</span>(font, <span class="hljs-number">100</span>);</li><li><span class="hljs-type">float</span> startX = <span class="hljs-number">100</span>;</li><li><span class="hljs-type">float</span> startY = <span class="hljs-number">100</span>;</li><li><span class="hljs-type">int</span> strLen = <span class="hljs-number">5</span>;</li><li><span class="hljs-type">const</span> <span class="hljs-type">char</span>* str = <span class="hljs-string">"Hello"</span>;</li><li><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; strLen; ++i) {</li><li>    <span class="hljs-comment">// 单字绘制</span></li><li>    <span class="hljs-built_in">OH_Drawing_CanvasDrawSingleCharacter</span>(canvas, &amp;str[i], font, startX, startY);</li><li>    <span class="hljs-type">float</span> textWidth = <span class="hljs-number">0.f</span>;</li><li>    <span class="hljs-comment">// 测量单个字符的宽度</span></li><li>    <span class="hljs-built_in">OH_Drawing_FontMeasureSingleCharacter</span>(font, &amp;str[i], &amp;textWidth);</li><li>    startX += textWidth;</li><li>}</li><li><span class="hljs-comment">// 释放字型对象</span></li><li><span class="hljs-built_in">OH_Drawing_FontDestroy</span>(font);</li></ol></pre></div></div>     <p><span><img originheight="159" originwidth="344" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114413.89092154836880053077151038737128:50001231000000:2800:49B9C4A5E89C4B41A0689D9BB99399C65B9E3604CBCB03ECA3DE89CB66FA419F.jpg" width="344" height="159"></span></p>     <p>进阶场景：绘制带字体特征的字符</p>     <p>对于需要字体特征的文本渲染场景，可以使用OH_Drawing_CanvasDrawSingleCharacterWithFeatures绘制单个字符，使用OH_Drawing_FontMeasureSingleCharacterWithFeatures测量单个字符的宽度，示例代码和效果图如下：</p>     <div _ngcontent-rqt-c106="" class="highlight-div"><div _ngcontent-rqt-c106="" class="highlight-div-header"><div _ngcontent-rqt-c106="" class="highlight-div-header-left"><div _ngcontent-rqt-c106="" class="handle-button expand-button"><div _ngcontent-rqt-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rqt-c106="" class="highlight-div-header-right"><div _ngcontent-rqt-c106="" class="handle-button ai-button"></div><div _ngcontent-rqt-c106="" class="handle-button line-button"><div _ngcontent-rqt-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rqt-c106="" class="handle-button theme-button"><div _ngcontent-rqt-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rqt-c106="" class="handle-button copy-button"><div _ngcontent-rqt-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rqt-c106="" class="highlight-scroll-div"><pre class="prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// sample_graphics.cpp</span></li><li><span class="hljs-comment">// 创建字型对象</span></li><li>OH_Drawing_Font *font = <span class="hljs-built_in">OH_Drawing_FontCreate</span>();</li><li><span class="hljs-comment">// 设置文字大小</span></li><li><span class="hljs-built_in">OH_Drawing_FontSetTextSize</span>(font, <span class="hljs-number">100</span>);</li><li><span class="hljs-comment">// 创建字体特征对象</span></li><li>OH_Drawing_FontFeatures* features = <span class="hljs-built_in">OH_Drawing_FontFeaturesCreate</span>();</li><li><span class="hljs-built_in">OH_Drawing_FontFeaturesAddFeature</span>(features, <span class="hljs-string">"frac"</span>, <span class="hljs-number">1</span>);</li><li><span class="hljs-type">float</span> startX = <span class="hljs-number">100</span>;</li><li><span class="hljs-type">float</span> startY = <span class="hljs-number">100</span>;</li><li><span class="hljs-type">int</span> strLen = <span class="hljs-number">5</span>;</li><li><span class="hljs-type">const</span> <span class="hljs-type">char</span>* str = <span class="hljs-string">"a2+b2"</span>;</li><li><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; strLen; ++i) {</li><li>    <span class="hljs-comment">// 单字绘制</span></li><li>    <span class="hljs-built_in">OH_Drawing_CanvasDrawSingleCharacterWithFeatures</span>(canvas, &amp;str[i], font, startX, startY, features);</li><li>    <span class="hljs-type">float</span> textWidth = <span class="hljs-number">0.f</span>;</li><li>    <span class="hljs-comment">// 测量单个字符的宽度</span></li><li>    <span class="hljs-built_in">OH_Drawing_FontMeasureSingleCharacterWithFeatures</span>(font, &amp;str[i], features, &amp;textWidth);</li><li>    startX += textWidth;</li><li>}</li><li><span class="hljs-comment">// 释放字体特征对象</span></li><li><span class="hljs-built_in">OH_Drawing_FontFeaturesDestroy</span>(features);</li><li><span class="hljs-comment">// 释放字型对象</span></li><li><span class="hljs-built_in">OH_Drawing_FontDestroy</span>(font);</li></ol></pre></div></div>     <p><span><img originheight="46" originwidth="143" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114413.90143817759931363565373202659706:50001231000000:2800:2EF3AC9A6A1A06FD679D2EAAD3215EF6F333852163938136C8A06FB867DC0D51.png" class="notEnlarge" width="143" height="46"></span></p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>如果 OH_Drawing_CanvasDrawSingleCharacterWithFeatures 与 OH_Drawing_FontMeasureSingleCharacter 混合使用，或者 OH_Drawing_CanvasDrawSingleCharacter 与 OH_Drawing_FontMeasureSingleCharacterWithFeatures 混合使用，字体绘制可能会重叠。</p>      </div></div></div>    </div>    <div class="tiledSection">     <h2 id="示例代码">示例代码<i class="anchor-icon anchor-icon-link" anchorid="示例代码" tips="复制节点链接"></i></h2>          <ul>      <li><a href="https://gitcode.com/HarmonyOS_Samples/DocsSample_Graphics/tree/master/ArkGraphics2D/Drawing/NDKAPIDrawing" target="_blank">图形绘制（C/C++）</a></li>     </ul>    </div>   </div>   <div></div></div>