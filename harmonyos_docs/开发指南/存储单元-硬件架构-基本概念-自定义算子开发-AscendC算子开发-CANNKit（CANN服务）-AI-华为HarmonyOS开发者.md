<h1 _ngcontent-jsr-c119="" class="doc-title ng-star-inserted" title="存储单元"> 存储单元 </h1>

<div _ngcontent-jsr-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div><p>AI处理器中的计算资源要想发挥强劲算力，必要条件是保证输入数据能够及时准确地出现在计算单元中，需要精心设计存储系统，保证计算单元所需的数据供应。</p> <p>AI Core中包含多级<strong>内部存储</strong>，AI Core需要把<strong>外部存储</strong>中的数据加载到内部存储中，才能完成相应的计算。AI Core的主要内部存储包括：L1 Buffer（L1缓冲区）、L0 Buffer（L0缓冲区）、Unified Buffer（统一缓冲区）等。为了配合AI Core中的数据传输和搬运，AI Core中还包含MTE（Memory Transfer Engine，存储转换引擎）搬运单元，在搬运过程中可执行<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/cannkit-channel-associated-format-conversion">随路数据格式类型转换</a>。</p> <p>AI Core的内部存储列表如表1所示。</p>  <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><caption><b>表1 </b>存储单元介绍</caption><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.4.2.3.1.1" valign="top" width="30%"><p>存储单元</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.4.2.3.1.2" valign="top" width="70%"><p>描述</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="30%"><p>L1 Buffer</p> </td> <td class="cellrowborder" valign="top" width="70%"><p>L1缓冲区，通用内部存储，是AI Core内比较大的一块数据中转区，可暂存AI Core中需要反复使用的一些数据从而减少从总线读写的次数。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="30%"><p>L0A Buffer / L0B Buffer</p> </td> <td class="cellrowborder" valign="top" width="70%"><p>Cube指令的输入。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="30%"><p>L0C Buffer</p> </td> <td class="cellrowborder" valign="top" width="70%"><p>Cube指令的输出，但进行累加计算的时候，也是输入的一部分。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="30%"><p>Unified Buffer</p> </td> <td class="cellrowborder" valign="top" width="70%"><p>统一缓冲区，向量和标量计算的输入和输出。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="30%"><p>BT Buffer</p> </td> <td class="cellrowborder" valign="top" width="70%"><p>BiasTable Buffer，存放Bias。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="30%"><p>FP Buffer</p> </td> <td class="cellrowborder" valign="top" width="70%"><p>Fixpipe Buffer，存放量化参数、Relu参数等。</p> </td> </tr>  </tbody></table></div> </div>  <div class="tablenoborder"><a name="ZH-CN_TOPIC_0000002445992844__zh-cn_topic_0000002119084361_table417mcpsimp"></a><a name="zh-cn_topic_0000002119084361_table417mcpsimp"></a><div class="tbBox"><table id="zh-cn_topic_0000002119084361_table417mcpsimp" class="layoutFixed idpTab"><caption><b>表2 </b>搬运单元介绍</caption><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.5.2.3.1.1" valign="top" width="30%"><p>搬运单元</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.5.2.3.1.2" valign="top" width="70%"><p>描述</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="30%"><p>MTE1</p> </td> <td class="cellrowborder" valign="top" width="70%"><p>负责如下通路的数据搬运：</p> <ul><li>L1-&gt;L0A/L0B</li><li>L1-&gt;UB（只有耦合架构支持）</li><li>L1-&gt;BT Buffer</li></ul> </td> </tr> <tr><td class="cellrowborder" valign="top" width="30%"><p>MTE2</p> </td> <td class="cellrowborder" valign="top" width="70%"><p>负责如下通路的数据搬运：</p> <ul><li>GM-&gt;{L1, L0A/B}，在该通路下，基于分形大小搬运，搬运时满足cacheline(512Byte)对齐，性能更优。</li><li>GM-&gt;UB，基于cacheline大小搬运性能更优。</li></ul> </td> </tr> <tr><td class="cellrowborder" valign="top" width="30%"><p>MTE3</p> </td> <td class="cellrowborder" valign="top" width="70%"><p>负责如下通路的数据搬运：UB -&gt; GM</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="30%"><p>FixPipe</p> </td> <td class="cellrowborder" valign="top" width="70%"><p>只有分离架构支持，负责如下通路的数据搬运，搬运过程中可以完成随路数据格式/类型转换：</p> <ul><li>L0C-&gt;{GM/L1}</li><li>L1-&gt;FP Buffer</li></ul> </td> </tr>  </tbody></table></div> </div> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><ul><li>不同类型的AI处理器，存储单元大小不同，开发者可通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/cannkit-getcorememsize">GetCoreMemSize</a>接口获取。</li></ul> <ul><li>所有通过搬运单元读写GM的数据都缺省被缓存在L2Cache，以此加快访问速度，提高访问效率。核外L2Cache以cacheline为单位加载数据，根据硬件规格不同，cacheline大小不同（128/256/512Byte等）。</li></ul> </div></div></div> </div> <div></div></div>