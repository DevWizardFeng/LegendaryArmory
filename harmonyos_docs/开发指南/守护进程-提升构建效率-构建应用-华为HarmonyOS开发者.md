<h1 _ngcontent-bxt-c119="" class="doc-title ng-star-inserted" title="守护进程"> 守护进程 </h1>

<div _ngcontent-bxt-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div id="body0000001778674581"><p id="ZH-CN_TOPIC_0000002510174367__p8060118">守护进程是作为后台进程运行而不是在交互式用户的直接控制下运行的计算机程序。Hvigor守护进程是一个持续存在的后台进程，可以减少运行构建所需的时间。</p> <div class="tiledSection"><h2 id="section16015221345">了解守护进程<i class="anchor-icon anchor-icon-link" anchorid="section16015221345" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510174367__p6467202823413">Hvigor客户端发送Daemon构建信息，如命令行参数、工程目录和环境变量等，以便于运行构建。客户端和守护进程之间的通信通过本地套接字进行连接，正在运行的守护进程同时最多开启8个，状态为非停止或中断的守护进程最多开启6个。</p> </div> <div class="tiledSection"><h2 id="section16318421606">启用禁用守护进程<i class="anchor-icon anchor-icon-link" anchorid="section16318421606" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510174367__p381772616597">Hvigor默认启用守护进程，您也可以通过以下几种方式来控制是否启用守护进程：</p> <ul id="ZH-CN_TOPIC_0000002510174367__ul1847655517590"><li id="li78029595270">通过DevEco Studio菜单栏构建：<ul id="ZH-CN_TOPIC_0000002510174367__ul10351234288"><li id="li15257089280">点击<strong>File &gt; </strong><strong>Settings</strong>（macOS为<strong>DevEco Studio &gt; Preferences/Settings</strong>）<strong> &gt; Build, Execution, Deployment &gt; Build Tools &gt; Hvigor</strong>，勾选或取消勾选字段<strong>Enable the Daemon for tasks</strong>。</li></ul> </li><li id="li67831110132810">通过命令行构建：<ul id="ZH-CN_TOPIC_0000002510174367__ul98411242283"><li id="li04714315287">执行命令，其中&lt;task&gt;替换为具体任务名：<div _ngcontent-bxt-c106="" class="highlight-div"><div _ngcontent-bxt-c106="" class="highlight-div-header"><div _ngcontent-bxt-c106="" class="highlight-div-header-left"><div _ngcontent-bxt-c106="" class="handle-button expand-button"><div _ngcontent-bxt-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bxt-c106="" class="highlight-div-header-right"><div _ngcontent-bxt-c106="" class="handle-button ai-button"></div><div _ngcontent-bxt-c106="" class="handle-button line-button"><div _ngcontent-bxt-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bxt-c106="" class="handle-button theme-button"><div _ngcontent-bxt-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bxt-c106="" class="handle-button copy-button"><div _ngcontent-bxt-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bxt-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" id="ZH-CN_TOPIC_0000002510174367__screen19471153172812" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 启用守护进程</span></li><li><span class="hljs-title class_">hvigorw</span> &lt;<span class="hljs-title class_">task</span>&gt; --<span class="hljs-variable">daemon</span></li><li><span class="hljs-comment">// 关闭守护进程</span></li><li><span class="hljs-title class_">hvigorw</span> &lt;<span class="hljs-title class_">task</span>&gt; --<span class="hljs-variable">no</span>-<span class="hljs-variable">daemon</span></li></ol></pre></div></div> </li><li id="li467414013283">在<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-hvigor-set-options">hvigor-config.json5</a>中配置execution.daemon选项。</li></ul> </li></ul> </div> <div class="tiledSection"><h2 id="section327617383145">设置守护进程内存<i class="anchor-icon anchor-icon-link" anchorid="section327617383145" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510174367__p10620112178">守护进程最大的老生代内存默认是8192MB，对绝大多数构建来说已经足够了。如果您想自定义守护进程最大的老生代内存，可以通过以下两种方式修改，建议您参考本地剩余内存进行调整设置。其中命令行方式优先级高于hvigor-config.json5配置文件。</p> <ul id="ZH-CN_TOPIC_0000002510174367__ul66842046151916"><li id="li968474641917">修改<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-hvigor-set-options">hvigor-config.json5文件</a>中的nodeOptions.maxOldSpaceSize配置。</li><li id="li15527909256">执行命令修改守护进程内存，示例如下：<div _ngcontent-bxt-c106="" class="highlight-div"><div _ngcontent-bxt-c106="" class="highlight-div-header"><div _ngcontent-bxt-c106="" class="highlight-div-header-left"><div _ngcontent-bxt-c106="" class="handle-button expand-button"><div _ngcontent-bxt-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bxt-c106="" class="highlight-div-header-right"><div _ngcontent-bxt-c106="" class="handle-button ai-button"></div><div _ngcontent-bxt-c106="" class="handle-button line-button"><div _ngcontent-bxt-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bxt-c106="" class="handle-button theme-button"><div _ngcontent-bxt-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bxt-c106="" class="handle-button copy-button"><div _ngcontent-bxt-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bxt-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-lua" id="ZH-CN_TOPIC_0000002510174367__screen39035102513" data-highlighted="yes"><ol class="linenums"><li>hvigorw assembleHap <span class="hljs-comment">--max-old-space-size=12345</span></li></ol></pre></div></div> </li></ul> <p id="ZH-CN_TOPIC_0000002510174367__p18351152844912">守护进程新生代内存最大的半空间大小默认是16MB，通过设置最大的半空间大小，可以改变Node.js的垃圾收集频率，进而影响性能，同时也会改变消耗的内存大小。可以通过以下两种方式修改，其中命令行方式优先级高于hvigor-config.json5配置文件。</p> <p id="ZH-CN_TOPIC_0000002510174367__p12778103112102">该功能从DevEco Studio 5.1.0 Release版本开始支持。</p> <ul id="ZH-CN_TOPIC_0000002510174367__ul93514289491"><li id="li435112288496">修改<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-hvigor-set-options">hvigor-config.json5文件</a>中的nodeOptions.maxSemiSpaceSize配置。</li><li id="li535102834915">执行命令修改守护进程内存，示例如下：<div _ngcontent-bxt-c106="" class="highlight-div"><div _ngcontent-bxt-c106="" class="highlight-div-header"><div _ngcontent-bxt-c106="" class="highlight-div-header-left"><div _ngcontent-bxt-c106="" class="handle-button expand-button"><div _ngcontent-bxt-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bxt-c106="" class="highlight-div-header-right"><div _ngcontent-bxt-c106="" class="handle-button ai-button"></div><div _ngcontent-bxt-c106="" class="handle-button line-button"><div _ngcontent-bxt-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bxt-c106="" class="handle-button theme-button"><div _ngcontent-bxt-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bxt-c106="" class="handle-button copy-button"><div _ngcontent-bxt-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bxt-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-lua" id="ZH-CN_TOPIC_0000002510174367__screen23516289498" data-highlighted="yes"><ol class="linenums"><li>hvigorw assembleHap <span class="hljs-comment">--max-semi-space-size=32</span></li></ol></pre></div></div> </li></ul> </div> <div class="tiledSection"><h2 id="section13943113123411">检查守护进程状态<i class="anchor-icon anchor-icon-link" anchorid="section13943113123411" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510174367__p16217163963412">如果您想获取正在运行的守护进程及其状态的列表，可以使用以下命令查看：</p> <div _ngcontent-bxt-c106="" class="highlight-div"><div _ngcontent-bxt-c106="" class="highlight-div-header"><div _ngcontent-bxt-c106="" class="highlight-div-header-left"><div _ngcontent-bxt-c106="" class="handle-button expand-button"><div _ngcontent-bxt-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bxt-c106="" class="highlight-div-header-right"><div _ngcontent-bxt-c106="" class="handle-button ai-button"></div><div _ngcontent-bxt-c106="" class="handle-button line-button"><div _ngcontent-bxt-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bxt-c106="" class="handle-button theme-button"><div _ngcontent-bxt-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bxt-c106="" class="handle-button copy-button"><div _ngcontent-bxt-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bxt-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-css" id="ZH-CN_TOPIC_0000002510174367__screen1314113712489" data-highlighted="yes"><ol class="linenums"><li>hvigorw <span class="hljs-attr">--status-daemon</span></li></ol></pre></div></div> <div _ngcontent-bxt-c106="" class="highlight-div"><div _ngcontent-bxt-c106="" class="highlight-div-header"><div _ngcontent-bxt-c106="" class="highlight-div-header-left"><div _ngcontent-bxt-c106="" class="handle-button expand-button"><div _ngcontent-bxt-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bxt-c106="" class="highlight-div-header-right"><div _ngcontent-bxt-c106="" class="handle-button ai-button"></div><div _ngcontent-bxt-c106="" class="handle-button line-button"><div _ngcontent-bxt-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bxt-c106="" class="handle-button theme-button"><div _ngcontent-bxt-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bxt-c106="" class="handle-button copy-button"><div _ngcontent-bxt-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bxt-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-shell" id="ZH-CN_TOPIC_0000002510174367__screen15439250124913" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta prompt_">&gt; </span><span class="language-bash">hvigor PID    STATUS  PORT    ROOT_PATH</span></li><li><span class="hljs-meta prompt_">&gt; </span><span class="language-bash">hvigor 11072  idle    45001   D:\Demo1</span></li><li><span class="hljs-meta prompt_">&gt; </span><span class="language-bash">hvigor 18836  stopped 45000   D:\Demo2</span></li></ol></pre></div></div>  <div class="tablenoborder"><div class="tbBox"><table id="table937118272517" class="layoutFixed idpTab"><thead><tr id="ZH-CN_TOPIC_0000002510174367__row53716279514"><th align="left" class="cellrowborder" id="mcps1.3.5.5.1.3.1.1" valign="top" width="27.22%"><p id="ZH-CN_TOPIC_0000002510174367__p1037142705116">守护进程状态</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.5.5.1.3.1.2" valign="top" width="72.78%"><p id="ZH-CN_TOPIC_0000002510174367__p53715274518">状态描述</p> </th> </tr> </thead> <tbody><tr id="ZH-CN_TOPIC_0000002510174367__row83711327105110"><td class="cellrowborder" valign="top" width="27.22%"><p id="ZH-CN_TOPIC_0000002510174367__p1737102710517">idle</p> </td> <td class="cellrowborder" valign="top" width="72.78%"><p id="ZH-CN_TOPIC_0000002510174367__p137211277511">闲置</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002510174367__row537272795111"><td class="cellrowborder" valign="top" width="27.22%"><p id="ZH-CN_TOPIC_0000002510174367__p937212271519">half_busy</p> </td> <td class="cellrowborder" valign="top" width="72.78%"><p id="ZH-CN_TOPIC_0000002510174367__p123721827155118">半忙碌</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002510174367__row3312443115619"><td class="cellrowborder" valign="top" width="27.22%"><p id="ZH-CN_TOPIC_0000002510174367__p931294345616">busy</p> </td> <td class="cellrowborder" valign="top" width="72.78%"><p id="ZH-CN_TOPIC_0000002510174367__p9312174395613">忙碌</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002510174367__row173721227195111"><td class="cellrowborder" valign="top" width="27.22%"><p id="ZH-CN_TOPIC_0000002510174367__p3372827135120">canceled</p> </td> <td class="cellrowborder" valign="top" width="72.78%"><p id="ZH-CN_TOPIC_0000002510174367__p63723278513">取消</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002510174367__row17579112547"><td class="cellrowborder" valign="top" width="27.22%"><p id="ZH-CN_TOPIC_0000002510174367__p5572145416">stopReq</p> </td> <td class="cellrowborder" valign="top" width="72.78%"><p id="ZH-CN_TOPIC_0000002510174367__p457171205411">停止请求</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002510174367__row1194416713545"><td class="cellrowborder" valign="top" width="27.22%"><p id="ZH-CN_TOPIC_0000002510174367__p394411735413">stopped</p> </td> <td class="cellrowborder" valign="top" width="72.78%"><p id="ZH-CN_TOPIC_0000002510174367__p694497195410">停止</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002510174367__row196113388551"><td class="cellrowborder" valign="top" width="27.22%"><p id="ZH-CN_TOPIC_0000002510174367__p18961638205520">broken</p> </td> <td class="cellrowborder" valign="top" width="72.78%"><p id="ZH-CN_TOPIC_0000002510174367__p896116383556">中断</p> </td> </tr>  </tbody></table></div> </div> </div> <div class="tiledSection"><h2 id="section298519112359">停止守护进程<i class="anchor-icon anchor-icon-link" anchorid="section298519112359" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510174367__p4821823173610">在更改关于守护进程内存设置或调试故障时，重启守护进程是必要的。</p> <p id="ZH-CN_TOPIC_0000002510174367__p10850162155214">您可用以下命令停止运行守护进程，这将停止该工程下的守护进程：</p> <div _ngcontent-bxt-c106="" class="highlight-div"><div _ngcontent-bxt-c106="" class="highlight-div-header"><div _ngcontent-bxt-c106="" class="highlight-div-header-left"><div _ngcontent-bxt-c106="" class="handle-button expand-button"><div _ngcontent-bxt-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bxt-c106="" class="highlight-div-header-right"><div _ngcontent-bxt-c106="" class="handle-button ai-button"></div><div _ngcontent-bxt-c106="" class="handle-button line-button"><div _ngcontent-bxt-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bxt-c106="" class="handle-button theme-button"><div _ngcontent-bxt-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bxt-c106="" class="handle-button copy-button"><div _ngcontent-bxt-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bxt-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-css" id="ZH-CN_TOPIC_0000002510174367__screen14154437195217" data-highlighted="yes"><ol class="linenums"><li>hvigorw <span class="hljs-attr">--stop-daemon</span></li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002510174367__p20945133485216">如果您想停止所有守护进程，可以使用以下命令：</p> <div _ngcontent-bxt-c106="" class="highlight-div"><div _ngcontent-bxt-c106="" class="highlight-div-header"><div _ngcontent-bxt-c106="" class="highlight-div-header-left"><div _ngcontent-bxt-c106="" class="handle-button expand-button"><div _ngcontent-bxt-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bxt-c106="" class="highlight-div-header-right"><div _ngcontent-bxt-c106="" class="handle-button ai-button"></div><div _ngcontent-bxt-c106="" class="handle-button line-button"><div _ngcontent-bxt-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bxt-c106="" class="handle-button theme-button"><div _ngcontent-bxt-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bxt-c106="" class="handle-button copy-button"><div _ngcontent-bxt-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bxt-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-css" id="ZH-CN_TOPIC_0000002510174367__screen8608154119539" data-highlighted="yes"><ol class="linenums"><li>hvigorw <span class="hljs-attr">--stop-daemon-all</span></li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002510174367__p11816143913535"></p> </div> <div class="tiledSection"><h2 id="section164722514364">性能影响<i class="anchor-icon anchor-icon-link" anchorid="section164722514364" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510174367__p14818222546">当您重复构建同一项目时，守护进程能够缩短构建时间。多次构建时，守护进程只会一次性将hvigor加载到内存中，而不会在每次构建时都进行加载。</p> </div> </div> <div></div></div>