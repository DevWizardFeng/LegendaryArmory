<h1 _ngcontent-okw-c119="" class="doc-title ng-star-inserted" title="安全相机(ArkTS)"> 安全相机(ArkTS) </h1>

<div _ngcontent-okw-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div><p>安全相机主要为银行等有活体检测等安全诉求的应用提供，安全相机的使用需要加密算法框架及可信应用服务。</p> <p>应用具体使用步骤如下：</p> <ul><li>通过Camera Kit打开安全摄像头，成功打开安全摄像头后，Camera Kit会返回给应用一个<strong>安全摄像头序列号</strong>。</li><li>通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/devicesecurity-introduction" target="_blank">Device Security Kit</a>来创建证明密钥（安全摄像头序列号会作为入参）、初始化证明会话。Device Security Kit初始化证明会话完成后会返回给应用<strong>匿名证书链</strong>。</li><li>通过Camera Kit配置安全相机输入输出流，重点是配置<strong>安全数据流</strong>，注册安全数据流每帧安全图像回调监听。</li><li>解析安全数据流每帧安全图像，在服务器侧完成安全图像的签名验证。</li></ul> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p>当前文档主要说明通过Camera Kit完成的步骤，证明会话相关步骤需通过Device Security Kit完成，具体可参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/devicesecurity-taas-securecamera" target="_blank">可信应用服务-安全摄像头</a>。</p> </div></div></div> <p><span><img originheight="739" originwidth="796" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114440.05999539693320019456161965586468:50001231000000:2800:84037E220ECCAB638BF0A6443A95F080582FA38E3AC57883DB06287094A9491C.png" width="796" height="739"></span></p> <div class="tiledSection"><h2 id="开发步骤">开发步骤<i class="anchor-icon anchor-icon-link" anchorid="开发步骤" tips="复制节点链接"></i></h2><p>详细的API说明请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-camera" target="_blank">Camera API参考</a>。</p> <ol><li><p>导入依赖，需要导入相机框架相关领域依赖。</p> <div _ngcontent-okw-c106="" class="highlight-div"><div _ngcontent-okw-c106="" class="highlight-div-header"><div _ngcontent-okw-c106="" class="highlight-div-header-left"><div _ngcontent-okw-c106="" class="handle-button expand-button"><div _ngcontent-okw-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-okw-c106="" class="highlight-div-header-right"><div _ngcontent-okw-c106="" class="handle-button ai-button"></div><div _ngcontent-okw-c106="" class="handle-button line-button"><div _ngcontent-okw-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-okw-c106="" class="handle-button theme-button"><div _ngcontent-okw-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-okw-c106="" class="handle-button copy-button"><div _ngcontent-okw-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-okw-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { camera } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.CameraKit'</span>;</li><li><span class="hljs-keyword">import</span> { image } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ImageKit'</span>;</li></ol></pre></div></div> </li><li><p>选择支持安全相机的设备。</p> <p>通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-camera-cameramanager" target="_blank">CameraManager</a>中的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-camera-cameramanager#getsupportedscenemodes11" target="_blank">getSupportedSceneModes</a>方法，可以获取当前设备支持的所有模式，如果当前设备支持安全相机模式，即可使用该设备做后续安全相机操作。</p> <p>当前安全相机仅支持手机前置镜头。</p> <div _ngcontent-okw-c106="" class="highlight-div"><div _ngcontent-okw-c106="" class="highlight-div-header"><div _ngcontent-okw-c106="" class="highlight-div-header-left"><div _ngcontent-okw-c106="" class="handle-button expand-button"><div _ngcontent-okw-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-okw-c106="" class="highlight-div-header-right"><div _ngcontent-okw-c106="" class="handle-button ai-button"></div><div _ngcontent-okw-c106="" class="handle-button line-button"><div _ngcontent-okw-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-okw-c106="" class="handle-button theme-button"><div _ngcontent-okw-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-okw-c106="" class="handle-button copy-button"><div _ngcontent-okw-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-okw-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">isSecureCamera</span>(<span class="hljs-params">cameraManager: camera.CameraManager, cameraDevice: camera.CameraDevice</span>): <span class="hljs-built_in">boolean</span> {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">sceneModes</span>: <span class="hljs-title class_">Array</span>&lt;camera.<span class="hljs-property">SceneMode</span>&gt; = cameraManager.<span class="hljs-title function_">getSupportedSceneModes</span>(cameraDevice);</li><li>  <span class="hljs-keyword">const</span> secureMode = sceneModes.<span class="hljs-title function_">find</span>(<span class="hljs-function"><span class="hljs-params">mode</span> =&gt;</span> mode === camera.<span class="hljs-property">SceneMode</span>.<span class="hljs-property">SECURE_PHOTO</span>);</li><li>  <span class="hljs-keyword">if</span> (secureMode) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'current device support secure camera!'</span>);</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;</li><li>  } <span class="hljs-keyword">else</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'current device not support secure camera!'</span>);</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">secureCamera</span>: camera.<span class="hljs-property">CameraDevice</span>;</li><li>
</li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">getSecureCamera</span>(<span class="hljs-params">cameraManager: camera.CameraManager</span>): <span class="hljs-built_in">void</span> {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">cameraArray</span>: <span class="hljs-title class_">Array</span>&lt;camera.<span class="hljs-property">CameraDevice</span>&gt; = cameraManager.<span class="hljs-title function_">getSupportedCameras</span>();</li><li>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> index = <span class="hljs-number">0</span>; index &lt; cameraArray.<span class="hljs-property">length</span>; index++) {</li><li>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_">isSecureCamera</span>(cameraManager, cameraArray[index])) {</li><li>      secureCamera = cameraArray[index];</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div> </li><li><p>查询相机设备在安全模式下支持的输出能力。</p> <p>通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-camera-cameramanager" target="_blank">CameraManager</a>的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-camera-cameramanager#getsupportedoutputcapability11" target="_blank">getSupportedOutputCapability</a>方法，可获取设备在安全模式下支持的输出能力。</p> <p>当前安全相机仅支持输出预览流，推荐预览流使用640 * 480分辨率。</p> <div _ngcontent-okw-c106="" class="highlight-div"><div _ngcontent-okw-c106="" class="highlight-div-header"><div _ngcontent-okw-c106="" class="highlight-div-header-left"><div _ngcontent-okw-c106="" class="handle-button expand-button"><div _ngcontent-okw-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-okw-c106="" class="highlight-div-header-right"><div _ngcontent-okw-c106="" class="handle-button ai-button"></div><div _ngcontent-okw-c106="" class="handle-button line-button"><div _ngcontent-okw-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-okw-c106="" class="handle-button theme-button"><div _ngcontent-okw-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-okw-c106="" class="handle-button copy-button"><div _ngcontent-okw-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-okw-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">getSupportedOutputCapability</span>(<span class="hljs-params">cameraManager: camera.CameraManager, secureCamera: camera.CameraDevice</span>): <span class="hljs-built_in">void</span> {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">outputCap</span>: camera.<span class="hljs-property">CameraOutputCapability</span> =</li><li>    cameraManager.<span class="hljs-title function_">getSupportedOutputCapability</span>(secureCamera, camera.<span class="hljs-property">SceneMode</span>.<span class="hljs-property">SECURE_PHOTO</span>);</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">previewProfilesArray</span>: <span class="hljs-title class_">Array</span>&lt;camera.<span class="hljs-property">Profile</span>&gt; = outputCap.<span class="hljs-property">previewProfiles</span>;</li><li>}</li></ol></pre></div></div> </li><li><p>创建设备输入输出。</p> <p>安全相机需要创建两路输出流：</p> <ul><li>一路是普通的预览流，用于界面显示，普通预览流的创建流程请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/camera-preview" target="_blank">预览开发指导</a>。</li><li>一路是安全数据流，用于安全服务校验，安全数据流需要通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-image-f#imagecreateimagereceiver11" target="_blank">image.createImageReceiver</a>创建图像接收类<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-image-imagereceiver" target="_blank">ImageReceiver</a>，再通过其<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-image-imagereceiver#getreceivingsurfaceid9" target="_blank">getReceivingSurfaceId</a>方法获取surfaceId。<div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p>安全数据流没有单独的数据类型，同属于预览流，输出能力与预览流保持一致，创建ImageReceiver仅支持JPEG格式。</p> </div></div></div> </li></ul> <div _ngcontent-okw-c106="" class="highlight-div"><div _ngcontent-okw-c106="" class="highlight-div-header"><div _ngcontent-okw-c106="" class="highlight-div-header-left"><div _ngcontent-okw-c106="" class="handle-button expand-button"><div _ngcontent-okw-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-okw-c106="" class="highlight-div-header-right"><div _ngcontent-okw-c106="" class="handle-button ai-button"></div><div _ngcontent-okw-c106="" class="handle-button line-button"><div _ngcontent-okw-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-okw-c106="" class="handle-button theme-button"><div _ngcontent-okw-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-okw-c106="" class="handle-button copy-button"><div _ngcontent-okw-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-okw-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">createInputAndOutputs</span>(<span class="hljs-params">cameraManager: camera.CameraManager, </span></li><li><span class="hljs-params">                                     secureCamera: camera.CameraDevice,</span></li><li><span class="hljs-params">                                     previewProfile: camera.Profile,</span></li><li><span class="hljs-params">                                     previewSurfaceId: <span class="hljs-built_in">string</span></span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {</li><li>  <span class="hljs-comment">// 创建输入流</span></li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">cameraInput</span>: camera.<span class="hljs-property">CameraInput</span> = cameraManager.<span class="hljs-title function_">createCameraInput</span>(secureCamera);</li><li>  <span class="hljs-comment">// 创建普通预览输出流</span></li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">previewOutput</span>: camera.<span class="hljs-property">PreviewOutput</span> = cameraManager.<span class="hljs-title function_">createPreviewOutput</span>(previewProfile, previewSurfaceId);</li><li>  <span class="hljs-comment">// 创建安全数据输出流</span></li><li>  <span class="hljs-keyword">const</span> <span class="hljs-attr">receiver</span>: image.<span class="hljs-property">ImageReceiver</span> =</li><li>    image.<span class="hljs-title function_">createImageReceiver</span>({ <span class="hljs-attr">width</span>: previewProfile.<span class="hljs-property">size</span>.<span class="hljs-property">width</span>, <span class="hljs-attr">height</span>: previewProfile.<span class="hljs-property">size</span>.<span class="hljs-property">height</span> },</li><li>                              image.<span class="hljs-property">ImageFormat</span>.<span class="hljs-property">JPEG</span>, <span class="hljs-number">8</span>);</li><li>  <span class="hljs-keyword">const</span> <span class="hljs-attr">secureSurfaceId</span>: <span class="hljs-built_in">string</span> = <span class="hljs-keyword">await</span> receiver.<span class="hljs-title function_">getReceivingSurfaceId</span>();</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">secureOutput</span>: camera.<span class="hljs-property">PreviewOutput</span> = cameraManager.<span class="hljs-title function_">createPreviewOutput</span>(previewProfile, secureSurfaceId);</li><li>}</li></ol></pre></div></div> </li><li><p>打开安全设备。</p> <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-camera-camerainput" target="_blank">CameraInput</a>提供了<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-camera-camerainput#open12" target="_blank">open(isSecureEnabled)</a>方法用于打开安全相机并返回安全摄像头序列号，该序列号是安全模块创建证明会话的必须参数。</p> <p>仅当isSecureEnabled为true时，才会打开安全相机，并有安全序列号返回。</p> <div _ngcontent-okw-c106="" class="highlight-div"><div _ngcontent-okw-c106="" class="highlight-div-header"><div _ngcontent-okw-c106="" class="highlight-div-header-left"><div _ngcontent-okw-c106="" class="handle-button expand-button"><div _ngcontent-okw-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-okw-c106="" class="highlight-div-header-right"><div _ngcontent-okw-c106="" class="handle-button ai-button"></div><div _ngcontent-okw-c106="" class="handle-button line-button"><div _ngcontent-okw-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-okw-c106="" class="handle-button theme-button"><div _ngcontent-okw-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-okw-c106="" class="handle-button copy-button"><div _ngcontent-okw-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-okw-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">openCamera</span>(<span class="hljs-params">cameraInput: camera.CameraInput</span>) {</li><li>  <span class="hljs-keyword">const</span> <span class="hljs-attr">seqId</span>: <span class="hljs-built_in">bigint</span> = <span class="hljs-keyword">await</span> cameraInput.<span class="hljs-title function_">open</span>(<span class="hljs-literal">true</span>);</li><li>}</li></ol></pre></div></div> </li><li>使用Device Security Kit的能力，创建证明密钥、打开证明会话。请参考Device Security Kit（设备安全服务）的开发指导：<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/devicesecurity-taas-securecamera" target="_blank">可信应用服务-安全摄像头</a>。</li><li><p>创建安全相机会话，配流启流。</p> <p>创建安全相机模式的会话，将输入流、输出流加入会话，需要将安全数据流通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-camera-securesession" target="_blank">SecureSession</a>的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-camera-securesession#addsecureoutput12" target="_blank">addSecureOutput</a>方法标记成安全输出。</p> <div _ngcontent-okw-c106="" class="highlight-div"><div _ngcontent-okw-c106="" class="highlight-div-header"><div _ngcontent-okw-c106="" class="highlight-div-header-left"><div _ngcontent-okw-c106="" class="handle-button expand-button"><div _ngcontent-okw-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-okw-c106="" class="highlight-div-header-right"><div _ngcontent-okw-c106="" class="handle-button ai-button"></div><div _ngcontent-okw-c106="" class="handle-button line-button"><div _ngcontent-okw-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-okw-c106="" class="handle-button theme-button"><div _ngcontent-okw-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-okw-c106="" class="handle-button copy-button"><div _ngcontent-okw-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-okw-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">openSession</span>(<span class="hljs-params">cameraManager: camera.CameraManager,</span></li><li><span class="hljs-params">                           cameraInput: camera.CameraInput,</span></li><li><span class="hljs-params">                           previewOutput: camera.PreviewOutput,</span></li><li><span class="hljs-params">                           secureOutput: camera.PreviewOutput</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {</li><li>  <span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">secureSession</span>: camera.<span class="hljs-property">SecureSession</span> = cameraManager.<span class="hljs-title function_">createSession</span>(camera.<span class="hljs-property">SceneMode</span>.<span class="hljs-property">SECURE_PHOTO</span>);</li><li>    <span class="hljs-keyword">if</span> (secureSession === <span class="hljs-literal">undefined</span>) {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'create secureSession failed!'</span>);</li><li>    }</li><li>    secureSession.<span class="hljs-title function_">beginConfig</span>();</li><li>    secureSession.<span class="hljs-title function_">addInput</span>(cameraInput);</li><li>    secureSession.<span class="hljs-title function_">addOutput</span>(previewOutput);</li><li>    secureSession.<span class="hljs-title function_">addOutput</span>(secureOutput);</li><li>    secureSession.<span class="hljs-title function_">addSecureOutput</span>(secureOutput); <span class="hljs-comment">// 把secureOutput标记成安全输出</span></li><li>    <span class="hljs-keyword">await</span> secureSession.<span class="hljs-title function_">commitConfig</span>();</li><li>    <span class="hljs-keyword">await</span> secureSession.<span class="hljs-title function_">start</span>();</li><li>  } <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'openSession failed!'</span>);</li><li>  }</li><li>}</li></ol></pre></div></div> </li><li>安全模式会话正常启动后，预览流和安全数据流数据逐帧上报，安全数据流每帧数据可以通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-image-imagereceiver" target="_blank">ImageReceiver</a>注册<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-image-imagereceiver#on9" target="_blank">imageArrival</a>回调获取。<div _ngcontent-okw-c106="" class="highlight-div"><div _ngcontent-okw-c106="" class="highlight-div-header"><div _ngcontent-okw-c106="" class="highlight-div-header-left"><div _ngcontent-okw-c106="" class="handle-button expand-button"><div _ngcontent-okw-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-okw-c106="" class="highlight-div-header-right"><div _ngcontent-okw-c106="" class="handle-button ai-button"></div><div _ngcontent-okw-c106="" class="handle-button line-button"><div _ngcontent-okw-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-okw-c106="" class="handle-button theme-button"><div _ngcontent-okw-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-okw-c106="" class="handle-button copy-button"><div _ngcontent-okw-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-okw-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">onBuffer</span>(<span class="hljs-params">receiver: image.ImageReceiver</span>): <span class="hljs-built_in">void</span> {</li><li>  receiver.<span class="hljs-title function_">on</span>(<span class="hljs-string">'imageArrival'</span>, <span class="hljs-function">() =&gt;</span> {</li><li>    <span class="hljs-comment">// 从ImageReceiver读取下一张图片</span></li><li>    receiver.<span class="hljs-title function_">readNextImage</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">img: image.Image</span>) =&gt;</span> {</li><li>      <span class="hljs-comment">// 从图像中获取组件缓存</span></li><li>      img.<span class="hljs-title function_">getComponent</span>(image.<span class="hljs-property">ComponentType</span>.<span class="hljs-property">JPEG</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">component: image.Component</span>) =&gt;</span> {</li><li>        <span class="hljs-comment">// 安全数据流内容，应用通过解析该buffer内容完成签名认证</span></li><li>        <span class="hljs-keyword">const</span> buffer = component.<span class="hljs-property">byteBuffer</span>;</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Succeeded in getting component byteBuffer.'</span>);</li><li>      })</li><li>    })</li><li>  })</li><li>}</li></ol></pre></div></div> <p>解析安全数据流每帧安全图像，在服务器侧完成安全图像的签名验证。</p> <p>如果有在端侧验证图像数据或地理位置数据签名的需求，可参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/devicesecurity-taas-verifysignature" target="_blank">验证签名</a>中与安全图像相关的部分。</p> </li><li>释放安全相机，使用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-camera-session" target="_blank">Session</a>的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-camera-session#release11-1" target="_blank">release</a>方法。</li></ol> </div> </div> <div></div></div>