<h1 _ngcontent-yhe-c119="" class="doc-title ng-star-inserted" title="实时竞价"> 实时竞价 </h1>

<div _ngcontent-yhe-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div><div class="tiledSection"><h2 id="section7927112463614">场景介绍<i class="anchor-icon anchor-icon-link" anchorid="section7927112463614" tips="复制节点链接"></i></h2><p>实时竞价是指用户在访问媒体产生曝光机会时，众多家DSP（Demand Side Platform，需求方平台）根据曝光的上下文以及用户属性实时地评估曝光价值并给出报价，出价最高的DSP胜出，赢得此次曝光机会。</p> </div> <div class="tiledSection"><h2 id="section1515416322083">支持场景<i class="anchor-icon anchor-icon-link" anchorid="section1515416322083" tips="复制节点链接"></i></h2><ul><li>原生广告</li><li>激励广告</li><li>插屏广告</li><li>开屏广告</li><li>贴片广告</li></ul> </div> <div class="tiledSection"><h2 id="section62914164417">接口说明<i class="anchor-icon anchor-icon-link" anchorid="section62914164417" tips="复制节点链接"></i></h2> <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.3.2.1.3.1.1" valign="top" width="50%"><p>接口名</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.3.2.1.3.1.2" valign="top" width="50%"><p>描述</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="50%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-advertising#loadad" target="_blank">loadAd</a>(adParam: AdRequestParams, adOptions: AdOptions, listener: AdLoadListener): void</p> </td> <td class="cellrowborder" valign="top" width="50%"><p>请求单广告位广告，通过AdRequestParams、AdOptions进行广告请求参数设置，通过AdLoadListener监听广告请求回调。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="50%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-advertising#loadadwithmultislots" target="_blank">loadAdWithMultiSlots</a>(adParams: AdRequestParams[], adOptions: AdOptions, listener: MultiSlotsAdLoadListener): void</p> </td> <td class="cellrowborder" valign="top" width="50%"><p>请求多广告位广告，通过AdRequestParams[]、AdOptions进行广告请求参数设置，通过MultiSlotsAdLoadListener监听广告请求回调。</p> </td> </tr>  </tbody></table></div> </div> </div> <div class="tiledSection"><h2 id="section112701721184413">开发步骤<i class="anchor-icon anchor-icon-link" anchorid="section112701721184413" tips="复制节点链接"></i></h2></div> <div class="tiledSection"><h3 id="section82291840174410" class="firsth2">添加竞价参数<i class="anchor-icon anchor-icon-link" anchorid="section82291840174410" tips="复制节点链接"></i></h3></div> <p>开发者需要在广告请求参数<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-advertising#adrequestparams" target="_blank">AdRequestParams</a>中添加实时竞价相关参数。</p> <p>实时竞价关键参数如下所示：</p>  <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.8.1.5.1.1" valign="top" width="25%"><p>名称</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.8.1.5.1.2" valign="top" width="25%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.8.1.5.1.3" valign="top" width="24.97%"><p>必填</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.8.1.5.1.4" valign="top" width="25.03%"><p>说明</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="25%"><p>tMax</p> </td> <td class="cellrowborder" valign="top" width="25%"><p>number</p> </td> <td class="cellrowborder" valign="top" width="24.97%"><p>否</p> </td> <td class="cellrowborder" valign="top" width="25.03%"><p>交易的最大超时时间（包含网络延迟），单位ms。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="25%"><p>cur</p> </td> <td class="cellrowborder" valign="top" width="25%"><p>string</p> </td> <td class="cellrowborder" valign="top" width="24.97%"><p>否</p> </td> <td class="cellrowborder" valign="top" width="25.03%"><p>竞价请求支持的币种，支持传多个，用英文逗号分隔。当前支持五种货币：</p> <ol><li>CNY。</li><li>USD。</li><li>EUR。</li><li>GBP。</li><li>JPY。</li></ol> <p>不填默认是CNY。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="25%"><p>bidFloor</p> </td> <td class="cellrowborder" valign="top" width="25%"><p>number</p> </td> <td class="cellrowborder" valign="top" width="24.97%"><p>否</p> </td> <td class="cellrowborder" valign="top" width="25.03%"><p>竞价广告位的底价。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="25%"><p>bidFloorCur</p> </td> <td class="cellrowborder" valign="top" width="25%"><p>string</p> </td> <td class="cellrowborder" valign="top" width="24.97%"><p>否</p> </td> <td class="cellrowborder" valign="top" width="25.03%"><p>竞价广告位底价使用的币种。如果bidFloor非空，则bidFloorCur也非空。当前只支持五种货币中的一种：</p> <ol><li>CNY。</li><li>USD。</li><li>EUR。</li><li>GBP。</li><li>JPY。</li></ol> <p>不填则默认是CNY。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="25%"><p>bpkgName</p> </td> <td class="cellrowborder" valign="top" width="25%"><p>string</p> </td> <td class="cellrowborder" valign="top" width="24.97%"><p>否</p> </td> <td class="cellrowborder" valign="top" width="25.03%"><p>广告位竞投的APP包名，支持传多个，用英文逗号分隔。</p> </td> </tr>  </tbody></table></div> </div> <p>示例代码如下所示：</p> <div _ngcontent-yhe-c106="" class="highlight-div"><div _ngcontent-yhe-c106="" class="highlight-div-header"><div _ngcontent-yhe-c106="" class="highlight-div-header-left"><div _ngcontent-yhe-c106="" class="handle-button expand-button"><div _ngcontent-yhe-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-yhe-c106="" class="highlight-div-header-right"><div _ngcontent-yhe-c106="" class="handle-button ai-button"></div><div _ngcontent-yhe-c106="" class="handle-button line-button"><div _ngcontent-yhe-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-yhe-c106="" class="handle-button theme-button"><div _ngcontent-yhe-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-yhe-c106="" class="handle-button copy-button"><div _ngcontent-yhe-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-yhe-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-variable">advertising</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AdsKit'</span>;</li><li>
</li><li><span class="hljs-keyword">const</span> <span class="hljs-variable">adRequestParams</span>: <span class="hljs-title class_">advertising</span>.<span class="hljs-title class_">AdRequestParams</span> = {</li><li>  <span class="hljs-comment">// 'testu7m3hc4gvm'为测试专用的广告位ID，暂无竞价信息，App正式发布时需要改为正式的广告位ID</span></li><li>  <span class="hljs-variable">adId</span>: <span class="hljs-string">'testu7m3hc4gvm'</span>,</li><li>  <span class="hljs-comment">// 广告类型</span></li><li>  <span class="hljs-variable">adType</span>: <span class="hljs-number">3</span>,</li><li>  <span class="hljs-comment">// 交易的最大超时时间</span></li><li>  <span class="hljs-variable">tMax</span>: <span class="hljs-number">100</span>,</li><li>  <span class="hljs-comment">// 竞价请求支持的币种，多个用英文逗号分隔</span></li><li>  <span class="hljs-variable">cur</span>: <span class="hljs-string">'CNY'</span>,</li><li>  <span class="hljs-comment">// 竞价广告位的底价</span></li><li>  <span class="hljs-variable">bidFloor</span>: <span class="hljs-number">6.66</span>,</li><li>  <span class="hljs-comment">// 竞价广告位底价使用的币种</span></li><li>  <span class="hljs-variable">bidFloorCur</span>: <span class="hljs-string">'CNY'</span>,</li><li>  <span class="hljs-comment">// 广告位竞投的APP包名，多个用英文逗号分隔</span></li><li>  <span class="hljs-variable">bpkgName</span>: <span class="hljs-string">'com.huawei.baidu,com.huawei.music'</span></li><li>};</li></ol></pre></div></div> <div class="tiledSection"><h3 id="section1895525812564">处理竞价结果<i class="anchor-icon anchor-icon-link" anchorid="section1895525812564" tips="复制节点链接"></i></h3><p>开发者需要在广告请求成功后的回调AdLoadListener.<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-advertising#onadloadsuccess" target="_blank">onAdLoadSuccess</a>或MultiSlotsAdLoadListener.<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-advertising#onadloadsuccess" target="_blank">onAdLoadSuccess</a>中，处理广告返回的实时竞价结果<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-advertising#advertisement" target="_blank">Advertisement</a>.biddingInfo。</p> <p>实时竞价结果信息如下所示：</p> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p>回传竞价结果，需要申请使用Internet网络权限<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/permissions-for-all#ohospermissioninternet" target="_blank">ohos.permission.INTERNET</a>。详细申请权限流程请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/development-preparation" target="_blank">开发准备</a>。</p> </div></div></div>  <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.11.5.1.5.1.1" valign="top" width="25%"><p>名称</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.11.5.1.5.1.2" valign="top" width="25%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.11.5.1.5.1.3" valign="top" width="25%"><p>必填</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.11.5.1.5.1.4" valign="top" width="25%"><p>说明</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="25%"><p>price</p> </td> <td class="cellrowborder" valign="top" width="25%"><p>number</p> </td> <td class="cellrowborder" valign="top" width="25%"><p>是</p> </td> <td class="cellrowborder" valign="top" width="25%"><p>本条广告的eCPM（Effective Cost Per Mille，每一千次展示可以获得的广告收入）。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="25%"><p>cur</p> </td> <td class="cellrowborder" valign="top" width="25%"><p>string</p> </td> <td class="cellrowborder" valign="top" width="25%"><p>是</p> </td> <td class="cellrowborder" valign="top" width="25%"><p>本条广告的价格币种。支持币种：CNY、USD、EUR、GBP、JPY。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="25%"><p>nurl</p> </td> <td class="cellrowborder" valign="top" width="25%"><p>string</p> </td> <td class="cellrowborder" valign="top" width="25%"><p>是</p> </td> <td class="cellrowborder" valign="top" width="25%"><p>媒体回传竞价成功结果的URL。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="25%"><p>lurl</p> </td> <td class="cellrowborder" valign="top" width="25%"><p>string</p> </td> <td class="cellrowborder" valign="top" width="25%"><p>是</p> </td> <td class="cellrowborder" valign="top" width="25%"><p>媒体回传竞价失败结果的URL。</p> </td> </tr>  </tbody></table></div> </div> <ul><li>若广告竞胜，开发者需要替换nurl中的宏，并回传竞胜结果。<p>宏说明如下：</p>  <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.11.6.1.2.1.3.1.1" valign="top" width="50%"><p>宏</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.11.6.1.2.1.3.1.2" valign="top" width="50%"><p>说明</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="50%"><p>SECOND_PRICE</p> </td> <td class="cellrowborder" valign="top" width="50%"><p>竞胜时，其他DSP最高出价。样例：3.6。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="50%"><p>AUCTION_CURRENCY</p> </td> <td class="cellrowborder" valign="top" width="50%"><p>价格币种。支持币种：CNY、USD、EUR、GBP、JPY。</p> </td> </tr>  </tbody></table></div> </div> </li></ul> <ul><li>若广告竞败，开发者需要替换lurl中的宏，并回传竞败结果。<p>宏说明如下：</p>  <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.11.7.1.2.1.3.1.1" valign="top" width="49.96%"><p>宏</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.11.7.1.2.1.3.1.2" valign="top" width="50.03999999999999%"><p>说明</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="49.96%"><p>AUCTION_PRICE</p> </td> <td class="cellrowborder" valign="top" width="50.03999999999999%"><p>竞败时，其他DSP最高出价。样例：3.6。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="49.96%"><p>AUCTION_LOSS</p> </td> <td class="cellrowborder" valign="top" width="50.03999999999999%"><p>竞价结果，如果没有走到参竞环节也需要回调，并替换具体过滤结果码。</p> <p>枚举：</p> <p>102：竞价失败。</p> <p>103：底价过滤。</p> <p>104：包名过滤。</p> <p>105：其他原因过滤。</p> <p>4005：超时未返回。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="49.96%"><p>AUCTION_CURRENCY</p> </td> <td class="cellrowborder" valign="top" width="50.03999999999999%"><p>价格币种。支持币种：CNY、USD、EUR、GBP、JPY。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="49.96%"><p>AUCTION_APP_PKG</p> </td> <td class="cellrowborder" valign="top" width="50.03999999999999%"><p>竞败时，竞胜DSP推广的App包名。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="49.96%"><p>AUCTION_APP_NAME</p> </td> <td class="cellrowborder" valign="top" width="50.03999999999999%"><p>竞败时，竞胜DSP推广的App名称。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="49.96%"><p>AUCTION_CP_ID</p> </td> <td class="cellrowborder" valign="top" width="50.03999999999999%"><p>竞败时，竞胜DSP的编号：</p> <p>1：广点通</p> <p>2：穿山甲</p> <p>3：百青藤</p> <p>4：快手联盟</p> <p>5：爱奇艺</p> <p>6：阿里</p> <p>7：VIVO</p> <p>8：OPPO</p> <p>9：小米</p> <p>10：京东</p> <p>11：拼多多</p> <p>100：其他</p> </td> </tr>  </tbody></table></div> </div> </li></ul> <p>示例代码如下所示：</p> <div _ngcontent-yhe-c106="" class="highlight-div"><div _ngcontent-yhe-c106="" class="highlight-div-header"><div _ngcontent-yhe-c106="" class="highlight-div-header-left"><div _ngcontent-yhe-c106="" class="handle-button expand-button"><div _ngcontent-yhe-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-yhe-c106="" class="highlight-div-header-right"><div _ngcontent-yhe-c106="" class="handle-button ai-button"></div><div _ngcontent-yhe-c106="" class="handle-button line-button"><div _ngcontent-yhe-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-yhe-c106="" class="handle-button theme-button"><div _ngcontent-yhe-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-yhe-c106="" class="handle-button copy-button"><div _ngcontent-yhe-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-yhe-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { advertising } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AdsKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li><span class="hljs-keyword">import</span> { rcp } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.RemoteCommunicationKit'</span>;</li><li>
</li><li><span class="hljs-keyword">interface</span> <span class="hljs-title class_">BiddingInfo</span> {</li><li>  <span class="hljs-comment">// 本条广告的eCPM（每一千次展示可以获得的广告收入）</span></li><li>  <span class="hljs-attr">price</span>: <span class="hljs-built_in">number</span>;</li><li>
</li><li>  <span class="hljs-comment">// 本条广告的价格币种</span></li><li>  <span class="hljs-attr">cur</span>: <span class="hljs-built_in">string</span>;</li><li>
</li><li>  <span class="hljs-comment">// 媒体回传竞价成功结果的URL</span></li><li>  <span class="hljs-attr">nurl</span>: <span class="hljs-built_in">string</span>;</li><li>
</li><li>  <span class="hljs-comment">// 媒体回传竞价失败结果的URL</span></li><li>  <span class="hljs-attr">lurl</span>: <span class="hljs-built_in">string</span>;</li><li>}</li><li>
</li><li><span class="hljs-keyword">const</span> <span class="hljs-attr">adLoaderListener</span>: advertising.<span class="hljs-property">AdLoadListener</span> = {</li><li>  <span class="hljs-comment">// 广告请求失败回调</span></li><li>  <span class="hljs-attr">onAdLoadFailure</span>: <span class="hljs-function">(<span class="hljs-params">errorCode: <span class="hljs-built_in">number</span>, errorMsg: <span class="hljs-built_in">string</span></span>) =&gt;</span> {</li><li>    hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">`Failed to load ad. Code is <span class="hljs-subst">${errorCode}</span>, message is <span class="hljs-subst">${errorMsg}</span>`</span>);</li><li>  },</li><li>  <span class="hljs-comment">// 广告请求成功回调</span></li><li>  <span class="hljs-attr">onAdLoadSuccess</span>: <span class="hljs-function">(<span class="hljs-params">ads: <span class="hljs-built_in">Array</span>&lt;advertising.Advertisement&gt;</span>) =&gt;</span> {</li><li>    hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">'Succeeded in loading ad'</span>);</li><li>    <span class="hljs-comment">// 期望的底价</span></li><li>    <span class="hljs-keyword">const</span> <span class="hljs-attr">bidFloor</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">6</span>;</li><li>    <span class="hljs-keyword">const</span> <span class="hljs-attr">biddingSuccessAds</span>: <span class="hljs-title class_">Array</span>&lt;advertising.<span class="hljs-property">Advertisement</span>&gt; = [];</li><li>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> ad <span class="hljs-keyword">of</span> ads) {</li><li>      <span class="hljs-keyword">const</span> <span class="hljs-attr">biddingInfo</span>: <span class="hljs-title class_">BiddingInfo</span> = ad.<span class="hljs-property">biddingInfo</span> <span class="hljs-keyword">as</span> <span class="hljs-title class_">BiddingInfo</span>;</li><li>      <span class="hljs-keyword">if</span> (!biddingInfo) {</li><li>        <span class="hljs-keyword">continue</span>;</li><li>      }</li><li>      <span class="hljs-keyword">if</span> (biddingInfo.<span class="hljs-property">cur</span> === <span class="hljs-string">'CNY'</span> &amp;&amp; biddingInfo.<span class="hljs-property">price</span> &gt;= bidFloor) {</li><li>        hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">'Petal Ads wins.'</span>);</li><li>        <span class="hljs-keyword">if</span> (biddingInfo.<span class="hljs-property">nurl</span>) {</li><li>          <span class="hljs-keyword">const</span> <span class="hljs-attr">url</span>: <span class="hljs-built_in">string</span> = biddingInfo.<span class="hljs-property">nurl</span></li><li>            <span class="hljs-comment">// 竞胜时，其他DSP最高出价</span></li><li>            .<span class="hljs-title function_">replace</span>(<span class="hljs-string">'SECOND_PRICE'</span>, <span class="hljs-string">'3.6'</span>)</li><li>            <span class="hljs-comment">// 价格币种</span></li><li>            .<span class="hljs-title function_">replace</span>(<span class="hljs-string">'AUCTION_CURRENCY'</span>, <span class="hljs-string">'CNY'</span>);</li><li>          <span class="hljs-title function_">sendBiddingResult</span>(url);</li><li>        }</li><li>        biddingSuccessAds.<span class="hljs-title function_">push</span>(ad);</li><li>      } <span class="hljs-keyword">else</span> {</li><li>        hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">'Petal Ads loses.'</span>);</li><li>        <span class="hljs-keyword">if</span> (biddingInfo.<span class="hljs-property">lurl</span>) {</li><li>          <span class="hljs-keyword">const</span> <span class="hljs-attr">url</span>: <span class="hljs-built_in">string</span> = biddingInfo.<span class="hljs-property">lurl</span></li><li>            <span class="hljs-comment">// 竞败时，其他DSP最高出价</span></li><li>            .<span class="hljs-title function_">replace</span>(<span class="hljs-string">'AUCTION_PRICE'</span>, <span class="hljs-string">'3.6'</span>)</li><li>            <span class="hljs-comment">// 竞价结果</span></li><li>            .<span class="hljs-title function_">replace</span>(<span class="hljs-string">'AUCTION_LOSS'</span>, <span class="hljs-string">'102'</span>)</li><li>            <span class="hljs-comment">// 价格币种</span></li><li>            .<span class="hljs-title function_">replace</span>(<span class="hljs-string">'AUCTION_CURRENCY'</span>, <span class="hljs-string">'CNY'</span>)</li><li>            <span class="hljs-comment">// 竞败时，竞胜DSP推广的App包名</span></li><li>            .<span class="hljs-title function_">replace</span>(<span class="hljs-string">'AUCTION_APP_PKG'</span>, <span class="hljs-string">'com.huawei.music'</span>)</li><li>            <span class="hljs-comment">// 竞败时，竞胜DSP推广的App名称</span></li><li>            .<span class="hljs-title function_">replace</span>(<span class="hljs-string">'AUCTION_APP_NAME'</span>, <span class="hljs-string">'music'</span>)</li><li>            <span class="hljs-comment">// 竞败时，竞胜DSP的编号</span></li><li>            .<span class="hljs-title function_">replace</span>(<span class="hljs-string">'AUCTION_CP_ID'</span>, <span class="hljs-string">'100'</span>)</li><li>          <span class="hljs-title function_">sendBiddingResult</span>(url);</li><li>        }</li><li>      }</li><li>    }</li><li>    <span class="hljs-comment">// ...此处省略展示广告的逻辑</span></li><li>  }</li><li>};</li><li>
</li><li><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">sendBiddingResult</span>(<span class="hljs-params">url: <span class="hljs-built_in">string</span></span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">session</span>: rcp.<span class="hljs-property">Session</span> | <span class="hljs-literal">undefined</span> = <span class="hljs-literal">undefined</span>;</li><li>  <span class="hljs-keyword">try</span> {</li><li>    session = rcp.<span class="hljs-title function_">createSession</span>();</li><li>    <span class="hljs-keyword">await</span> session.<span class="hljs-title function_">get</span>(url);</li><li>  } <span class="hljs-keyword">catch</span> (e) {</li><li>    hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">`Failed to send bidding result. Code is <span class="hljs-subst">${e.code}</span>, message is <span class="hljs-subst">${e.message}</span>`</span>);</li><li>  } <span class="hljs-keyword">finally</span> {</li><li>    session?.<span class="hljs-title function_">close</span>();</li><li>  }</li><li>}</li></ol></pre></div></div> </div> </div> <div></div></div>