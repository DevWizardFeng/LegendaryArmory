<h1 _ngcontent-kxd-c119="" class="doc-title ng-star-inserted" title="实现属性动画"> 实现属性动画 </h1>

<div _ngcontent-kxd-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p>通过可动画属性改变引起UI上产生的连续视觉效果，即为属性动画。属性动画是最基础易懂的动画，ArkUI提供三种动画接口<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-uicontext-uicontext#animateto" target="_blank">animateTo</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-animatorproperty" target="_blank">animation</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-keyframeanimateto" target="_blank">keyframeAnimateTo</a>驱动组件属性按照动画曲线等动画参数进行连续的变化，产生属性动画。</p>    <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">      <p>本章节讨论的属性动画不是狭义的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-animatorproperty" target="_blank">属性动画接口</a>，而是通过给定新的可动画属性终值，对属性产生动画的方式。</p>     </div></div></div>    <div class="tablenoborder">     <div class="tbBox"><table class="layoutFixed idpTab">      <thead>       <tr>        <th align="left" class="cellrowborder" id="mcps1.3.3.1.5.1.1" valign="top" width="25%">动画接口</th>        <th align="left" class="cellrowborder" id="mcps1.3.3.1.5.1.2" valign="top" width="25%">作用域</th>        <th align="left" class="cellrowborder" id="mcps1.3.3.1.5.1.3" valign="top" width="25%">原理</th>        <th align="left" class="cellrowborder" id="mcps1.3.3.1.5.1.4" valign="top" width="25%">使用场景</th>       </tr>      </thead>             <tbody><tr>        <td class="cellrowborder" valign="top" width="25%">animateTo</td>        <td class="cellrowborder" valign="top" width="25%">         <p>闭包内改变属性引起的界面变化。</p>         <p>作用于出现消失转场。</p></td>        <td class="cellrowborder" valign="top" width="25%">         <p>通用函数，对闭包前界面和闭包中的状态变量引起的界面之间的差异做动画。</p>         <p>支持多次调用，支持嵌套。</p></td>        <td class="cellrowborder" valign="top" width="25%">         <p>适用对多个可动画属性配置相同动画参数的动画。</p>         <p>需要嵌套使用动画的场景。</p></td>       </tr>       <tr>        <td class="cellrowborder" valign="top" width="25%">animation</td>        <td class="cellrowborder" valign="top" width="25%">组件通过属性接口绑定的属性变化引起的界面变化。</td>        <td class="cellrowborder" valign="top" width="25%">         <p>识别组件的可动画属性变化，自动添加动画。</p>         <p>组件的接口调用是从下往上执行，animation只会作用于在其之上的属性调用。</p>         <p>组件可以根据调用顺序对多个属性设置不同的animation。</p></td>        <td class="cellrowborder" valign="top" width="25%">适用于对多个可动画属性配置不同参数动画的场景。</td>       </tr>       <tr>        <td class="cellrowborder" valign="top" width="25%">keyframeAnimateTo</td>        <td class="cellrowborder" valign="top" width="25%">多个闭包内改变属性引起的分段属性动画。</td>        <td class="cellrowborder" valign="top" width="25%">         <p>通用函数，每一段闭包中的状态变量与前一次的差异做动画。</p>         <p>支持多次调用，不推荐嵌套。</p></td>        <td class="cellrowborder" valign="top" width="25%">适用于同一属性需要做连续多个动画的场景。</td>       </tr>           </tbody></table></div>    </div>    <div class="tiledSection">     <h2 id="使用animateto产生属性动画">使用animateTo产生属性动画<i class="anchor-icon anchor-icon-link" anchorid="使用animateto产生属性动画" tips="复制节点链接"></i></h2>          <div _ngcontent-kxd-c106="" class="highlight-div"><div _ngcontent-kxd-c106="" class="highlight-div-header"><div _ngcontent-kxd-c106="" class="highlight-div-header-left"><div _ngcontent-kxd-c106="" class="handle-button expand-button"><div _ngcontent-kxd-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kxd-c106="" class="highlight-div-header-right"><div _ngcontent-kxd-c106="" class="handle-button ai-button"></div><div _ngcontent-kxd-c106="" class="handle-button line-button"><div _ngcontent-kxd-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kxd-c106="" class="handle-button theme-button"><div _ngcontent-kxd-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kxd-c106="" class="handle-button copy-button"><div _ngcontent-kxd-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kxd-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-title function_">animateTo</span>(<span class="hljs-variable">value</span>: <span class="hljs-title class_">AnimateParam</span>, <span class="hljs-variable">event</span>: () =&gt; <span class="hljs-variable">void</span>): <span class="hljs-title class_">void</span></li></ol></pre></div></div>     <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-uicontext-uicontext#animateto" target="_blank">animateTo</a>接口参数中，value指定<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-explicit-animation#animateparam对象说明" target="_blank">AnimateParam对象</a>（包括时长、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-curve#curve" target="_blank">Curve</a>等）event为动画的闭包函数，闭包内变量改变产生的属性动画将遵循相同的动画参数。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>直接使用animateTo可能导致<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-global-interface">UI上下文不明确</a>的问题，建议使用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-custom-component-api#getuicontext" target="_blank">getUIContext()</a>获取<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-uicontext-uicontext" target="_blank">UIContext</a>实例，并使用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-uicontext-uicontext#animateto" target="_blank">animateTo</a>调用绑定实例的animateTo。</p>      </div></div></div>     <div _ngcontent-kxd-c106="" class="highlight-div"><div _ngcontent-kxd-c106="" class="highlight-div-header"><div _ngcontent-kxd-c106="" class="highlight-div-header-left"><div _ngcontent-kxd-c106="" class="handle-button expand-button"><div _ngcontent-kxd-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kxd-c106="" class="highlight-div-header-right"><div _ngcontent-kxd-c106="" class="handle-button ai-button"></div><div _ngcontent-kxd-c106="" class="handle-button line-button"><div _ngcontent-kxd-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kxd-c106="" class="handle-button theme-button"><div _ngcontent-kxd-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kxd-c106="" class="handle-button copy-button"><div _ngcontent-kxd-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kxd-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { curves } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">AnimateToDemo</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">animate</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">false</span>;</li><li>  <span class="hljs-comment">// 第一步: 声明相关状态变量</span></li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">rotateValue</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>; <span class="hljs-comment">// 组件一旋转角度</span></li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">translateX</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>; <span class="hljs-comment">// 组件二偏移量</span></li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">opacityValue</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">1</span>; <span class="hljs-comment">// 组件二透明度</span></li><li>
</li><li>  <span class="hljs-comment">// 第二步：将状态变量设置到相关可动画属性接口</span></li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Row</span>() {</li><li>      <span class="hljs-comment">// 组件一</span></li><li>      <span class="hljs-title class_">Column</span>() {</li><li>      }</li><li>      .<span class="hljs-title function_">rotate</span>({ <span class="hljs-attr">angle</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">rotateValue</span> })</li><li>      .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">'#317AF7'</span>)</li><li>      .<span class="hljs-title function_">justifyContent</span>(<span class="hljs-title class_">FlexAlign</span>.<span class="hljs-property">Center</span>)</li><li>      .<span class="hljs-title function_">width</span>(<span class="hljs-number">100</span>)</li><li>      .<span class="hljs-title function_">height</span>(<span class="hljs-number">100</span>)</li><li>      .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">30</span>)</li><li>      .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>()?.<span class="hljs-title function_">animateTo</span>({ <span class="hljs-attr">curve</span>: curves.<span class="hljs-title function_">springMotion</span>() }, <span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">animate</span> = !<span class="hljs-variable language_">this</span>.<span class="hljs-property">animate</span>;</li><li>          <span class="hljs-comment">// 第三步：闭包内通过状态变量改变UI界面</span></li><li>          <span class="hljs-comment">// 这里可以写任何能改变UI的逻辑比如数组添加，显隐控制，系统会检测改变后的UI界面与之前的UI界面的差异，对有差异的部分添加动画</span></li><li>          <span class="hljs-comment">// 组件一的rotate属性发生变化，所以会给组件一添加rotate旋转动画</span></li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">rotateValue</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">animate</span> ? <span class="hljs-number">90</span> : <span class="hljs-number">0</span>;</li><li>          <span class="hljs-comment">// 组件二的透明度发生变化，所以会给组件二添加透明度的动画</span></li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">opacityValue</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">animate</span> ? <span class="hljs-number">0.6</span> : <span class="hljs-number">1</span>;</li><li>          <span class="hljs-comment">// 组件二的translate属性发生变化，所以会给组件二添加translate偏移动画</span></li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">translateX</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">animate</span> ? <span class="hljs-number">50</span> : <span class="hljs-number">0</span>;</li><li>        })</li><li>      })</li><li>
</li><li>      <span class="hljs-comment">// 组件二</span></li><li>      <span class="hljs-title class_">Column</span>() {</li><li>
</li><li>      }</li><li>      .<span class="hljs-title function_">justifyContent</span>(<span class="hljs-title class_">FlexAlign</span>.<span class="hljs-property">Center</span>)</li><li>      .<span class="hljs-title function_">width</span>(<span class="hljs-number">100</span>)</li><li>      .<span class="hljs-title function_">height</span>(<span class="hljs-number">100</span>)</li><li>      .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">'#D94838'</span>)</li><li>      .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">30</span>)</li><li>      .<span class="hljs-title function_">opacity</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">opacityValue</span>)</li><li>      .<span class="hljs-title function_">translate</span>({ <span class="hljs-attr">x</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">translateX</span> })</li><li>    }</li><li>    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>    .<span class="hljs-title function_">justifyContent</span>(<span class="hljs-title class_">FlexAlign</span>.<span class="hljs-property">Center</span>)</li><li>  }</li><li>}</li></ol></pre></div></div>     <p><span><img originheight="394" originwidth="513" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114914.25424653209109561217893002885127:50001231000000:2800:26BF3EE9E744B838BC3555A45536C6D9EE363416D4473926744860C13910DA0E.gif" width="513" height="394"></span></p>    </div>    <div class="tiledSection">     <h2 id="使用animation产生属性动画">使用animation产生属性动画<i class="anchor-icon anchor-icon-link" anchorid="使用animation产生属性动画" tips="复制节点链接"></i></h2>          <p>相比于animateTo接口需要把要执行动画的属性的修改放在闭包中，<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-animatorproperty" target="_blank">animation</a>接口无需使用闭包，把animation接口加在要做属性动画的可动画属性后即可。animation只要检测到其绑定的可动画属性发生变化，就会自动添加属性动画，animateTo则必须在动画闭包内改变可动画属性的值从而生成动画。</p>     <div _ngcontent-kxd-c106="" class="highlight-div"><div _ngcontent-kxd-c106="" class="highlight-div-header"><div _ngcontent-kxd-c106="" class="highlight-div-header-left"><div _ngcontent-kxd-c106="" class="handle-button expand-button"><div _ngcontent-kxd-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kxd-c106="" class="highlight-div-header-right"><div _ngcontent-kxd-c106="" class="handle-button ai-button"></div><div _ngcontent-kxd-c106="" class="handle-button line-button"><div _ngcontent-kxd-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kxd-c106="" class="handle-button theme-button"><div _ngcontent-kxd-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kxd-c106="" class="handle-button copy-button"><div _ngcontent-kxd-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kxd-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { curves } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">AnimationDemo</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">animate</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">false</span>;</li><li>  <span class="hljs-comment">// 第一步: 声明相关状态变量</span></li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">rotateValue</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>; <span class="hljs-comment">// 组件一旋转角度</span></li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">translateX</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>; <span class="hljs-comment">// 组件二偏移量</span></li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">opacityValue</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">1</span>; <span class="hljs-comment">// 组件二透明度</span></li><li>
</li><li>  <span class="hljs-comment">// 第二步：将状态变量设置到相关可动画属性接口</span></li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Row</span>() {</li><li>      <span class="hljs-comment">// 组件一</span></li><li>      <span class="hljs-title class_">Column</span>() {</li><li>      }</li><li>      .<span class="hljs-title function_">opacity</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">opacityValue</span>)</li><li>      .<span class="hljs-title function_">rotate</span>({ <span class="hljs-attr">angle</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">rotateValue</span> })</li><li>      <span class="hljs-comment">// 第三步：通过属性动画接口开启属性动画</span></li><li>      .<span class="hljs-title function_">animation</span>({ <span class="hljs-attr">curve</span>: curves.<span class="hljs-title function_">springMotion</span>() })</li><li>      .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">'#317AF7'</span>)</li><li>      .<span class="hljs-title function_">justifyContent</span>(<span class="hljs-title class_">FlexAlign</span>.<span class="hljs-property">Center</span>)</li><li>      .<span class="hljs-title function_">width</span>(<span class="hljs-number">100</span>)</li><li>      .<span class="hljs-title function_">height</span>(<span class="hljs-number">100</span>)</li><li>      .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">30</span>)</li><li>      .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">animate</span> = !<span class="hljs-variable language_">this</span>.<span class="hljs-property">animate</span>;</li><li>        <span class="hljs-comment">// 第四步：闭包内通过状态变量改变UI界面</span></li><li>        <span class="hljs-comment">// 这里可以写任何能改变UI的逻辑比如数组添加，显隐控制，系统会检测改变后的UI界面与之前的UI界面的差异，对有差异的部分添加动画</span></li><li>        <span class="hljs-comment">// 组件一的rotate属性发生变化，所以会给组件一添加rotate旋转动画</span></li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">rotateValue</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">animate</span> ? <span class="hljs-number">90</span> : <span class="hljs-number">0</span>;</li><li>        <span class="hljs-comment">// 组件二的translate属性发生变化，所以会给组件二添加translate偏移动画</span></li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">translateX</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">animate</span> ? <span class="hljs-number">50</span> : <span class="hljs-number">0</span>;</li><li>        <span class="hljs-comment">// 父组件column的opacity属性有变化，会导致其子节点的透明度也变化，所以这里会给column和其子节点的透明度属性都添加动画</span></li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">opacityValue</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">animate</span> ? <span class="hljs-number">0.6</span> : <span class="hljs-number">1</span>;</li><li>      })</li><li>
</li><li>      <span class="hljs-comment">// 组件二</span></li><li>      <span class="hljs-title class_">Column</span>() {</li><li>      }</li><li>      .<span class="hljs-title function_">justifyContent</span>(<span class="hljs-title class_">FlexAlign</span>.<span class="hljs-property">Center</span>)</li><li>      .<span class="hljs-title function_">width</span>(<span class="hljs-number">100</span>)</li><li>      .<span class="hljs-title function_">height</span>(<span class="hljs-number">100</span>)</li><li>      .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">'#D94838'</span>)</li><li>      .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">30</span>)</li><li>      .<span class="hljs-title function_">opacity</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">opacityValue</span>)</li><li>      .<span class="hljs-title function_">translate</span>({ <span class="hljs-attr">x</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">translateX</span> })</li><li>      .<span class="hljs-title function_">animation</span>({ <span class="hljs-attr">curve</span>: curves.<span class="hljs-title function_">springMotion</span>() })</li><li>    }</li><li>    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>    .<span class="hljs-title function_">justifyContent</span>(<span class="hljs-title class_">FlexAlign</span>.<span class="hljs-property">Center</span>)</li><li>  }</li><li>}</li></ol></pre></div></div>     <p><span><img originheight="342" originwidth="521" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114914.96933546021653250359553094582178:50001231000000:2800:3057C72B76EECA92EC8C9025CC38F934B3A21040D7998EB9A7E7C31BEC858F42.gif" width="521" height="342"></span></p>    </div>    <div class="tiledSection">     <h2 id="使用keyframeanimateto产生属性动画">使用keyframeAnimateTo产生属性动画<i class="anchor-icon anchor-icon-link" anchorid="使用keyframeanimateto产生属性动画" tips="复制节点链接"></i></h2>          <div _ngcontent-kxd-c106="" class="highlight-div"><div _ngcontent-kxd-c106="" class="highlight-div-header"><div _ngcontent-kxd-c106="" class="highlight-div-header-left"><div _ngcontent-kxd-c106="" class="handle-button expand-button"><div _ngcontent-kxd-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kxd-c106="" class="highlight-div-header-right"><div _ngcontent-kxd-c106="" class="handle-button ai-button"></div><div _ngcontent-kxd-c106="" class="handle-button line-button"><div _ngcontent-kxd-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kxd-c106="" class="handle-button theme-button"><div _ngcontent-kxd-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kxd-c106="" class="handle-button copy-button"><div _ngcontent-kxd-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kxd-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-title function_">keyframeAnimateTo</span>(<span class="hljs-variable">param</span>: <span class="hljs-title class_">KeyframeAnimateParam</span>, <span class="hljs-variable">keyframes</span>: <span class="hljs-title class_">Array</span>&lt;<span class="hljs-title class_">KeyframeState</span>&gt;): <span class="hljs-title class_">void</span></li></ol></pre></div></div>     <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-keyframeanimateto" target="_blank">keyframeAnimateTo</a>接口参数中，第一个参数<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-keyframeanimateto#keyframeanimateparam对象说明" target="_blank">KeyframeAnimateParam</a>为关键帧动画的整体参数（包括延时、播放次数、结束回调、期望帧率），第二个参数是一个数组，每一项表示一个关键帧内的动画行为；每一段动画可单独控制动画参数（包括时长、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-curve#curve" target="_blank">Curve</a>等）。</p>     <p>在同一属性存在多段动画过程的场景，可通过在结束回调中再创建新动画实现，但写法更复杂，且每次创建新动画需要耗时，会有衔接卡顿现象。此场景更适宜用关键帧动画实现。</p>     <p>以下示例主要演示如何通过keyframeAnimateTo来设置关键帧动画。</p>     <div _ngcontent-kxd-c106="" class="highlight-div"><div _ngcontent-kxd-c106="" class="highlight-div-header"><div _ngcontent-kxd-c106="" class="highlight-div-header-left"><div _ngcontent-kxd-c106="" class="handle-button expand-button"><div _ngcontent-kxd-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kxd-c106="" class="highlight-div-header-right"><div _ngcontent-kxd-c106="" class="handle-button ai-button"></div><div _ngcontent-kxd-c106="" class="handle-button line-button"><div _ngcontent-kxd-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kxd-c106="" class="handle-button theme-button"><div _ngcontent-kxd-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kxd-c106="" class="handle-button copy-button"><div _ngcontent-kxd-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kxd-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">KeyframeAnimateToDemo</span> {</li><li>  <span class="hljs-comment">// 第一步: 声明相关状态变量</span></li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">rotateValue</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>; <span class="hljs-comment">// 组件一旋转角度</span></li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">translateX</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>; <span class="hljs-comment">// 组件二偏移量</span></li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">opacityValue</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">1</span>; <span class="hljs-comment">// 组件二透明度</span></li><li>  <span class="hljs-comment">// 第二步：将状态变量设置到相关可动画属性接口</span></li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Row</span>() {</li><li>      <span class="hljs-comment">// 组件一</span></li><li>      <span class="hljs-title class_">Column</span>() {</li><li>      }</li><li>      .<span class="hljs-title function_">rotate</span>({ <span class="hljs-attr">angle</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">rotateValue</span> })</li><li>      .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">'#317AF7'</span>)</li><li>      .<span class="hljs-title function_">justifyContent</span>(<span class="hljs-title class_">FlexAlign</span>.<span class="hljs-property">Center</span>)</li><li>      .<span class="hljs-title function_">width</span>(<span class="hljs-number">100</span>)</li><li>      .<span class="hljs-title function_">height</span>(<span class="hljs-number">100</span>)</li><li>      .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">30</span>)</li><li>      .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>        <span class="hljs-comment">// 第三步：调用keyframeAnimateTo接口</span></li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>()?.<span class="hljs-title function_">keyframeAnimateTo</span>({</li><li>          <span class="hljs-attr">iterations</span>: <span class="hljs-number">1</span></li><li>        }, [</li><li>          {</li><li>            <span class="hljs-comment">// 第一段关键帧动画时长为800ms，组件一顺时针旋转90度，组件二的透明度变从1变为0.6，组件二的translate从0位移到50</span></li><li>            <span class="hljs-attr">duration</span>: <span class="hljs-number">800</span>,</li><li>            <span class="hljs-attr">event</span>: <span class="hljs-function">() =&gt;</span> {</li><li>              <span class="hljs-variable language_">this</span>.<span class="hljs-property">rotateValue</span> = <span class="hljs-number">90</span>;</li><li>              <span class="hljs-variable language_">this</span>.<span class="hljs-property">opacityValue</span> = <span class="hljs-number">0.6</span>;</li><li>              <span class="hljs-variable language_">this</span>.<span class="hljs-property">translateX</span> = <span class="hljs-number">50</span>;</li><li>            }</li><li>          },</li><li>          {</li><li>            <span class="hljs-comment">// 第二段关键帧动画时长为500ms，组件一逆时针旋转90度恢复至0度，组件二的透明度变从0.6变为1，组件二的translate从50位移到0</span></li><li>            <span class="hljs-attr">duration</span>: <span class="hljs-number">500</span>,</li><li>            <span class="hljs-attr">event</span>: <span class="hljs-function">() =&gt;</span> {</li><li>              <span class="hljs-variable language_">this</span>.<span class="hljs-property">rotateValue</span> = <span class="hljs-number">0</span>;</li><li>              <span class="hljs-variable language_">this</span>.<span class="hljs-property">opacityValue</span> = <span class="hljs-number">1</span>;</li><li>              <span class="hljs-variable language_">this</span>.<span class="hljs-property">translateX</span> = <span class="hljs-number">0</span>;</li><li>            }</li><li>          }</li><li>        ]);</li><li>      })</li><li>      <span class="hljs-comment">// 组件二</span></li><li>      <span class="hljs-title class_">Column</span>() {</li><li>      }</li><li>      .<span class="hljs-title function_">justifyContent</span>(<span class="hljs-title class_">FlexAlign</span>.<span class="hljs-property">Center</span>)</li><li>      .<span class="hljs-title function_">width</span>(<span class="hljs-number">100</span>)</li><li>      .<span class="hljs-title function_">height</span>(<span class="hljs-number">100</span>)</li><li>      .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">'#D94838'</span>)</li><li>      .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">30</span>)</li><li>      .<span class="hljs-title function_">opacity</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">opacityValue</span>)</li><li>      .<span class="hljs-title function_">translate</span>({ <span class="hljs-attr">x</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">translateX</span> })</li><li>    }</li><li>    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>    .<span class="hljs-title function_">justifyContent</span>(<span class="hljs-title class_">FlexAlign</span>.<span class="hljs-property">Center</span>)</li><li>  }</li><li>}</li></ol></pre></div></div>     <p><span><img originheight="256" originwidth="403" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114914.07853230315419560870865464356398:50001231000000:2800:6A32192C205976C6F1BB3F7932F22CAEE4A3B4A87720A620D91491E3405EA186.gif" width="403" height="256"></span></p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <ul>        <li>         <p>在对组件的位置大小的变化做动画的时候，由于布局属性的改变会触发测量布局，性能开销大。<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-universal-attributes-transformation#scale" target="_blank">scale</a>属性的改变不会触发测量布局，性能开销小。因此，在组件位置大小持续发生变化的场景，如跟手触发组件大小变化的场景，推荐使用scale。</p></li>        <li>         <p>属性动画应该作用于始终存在的组件，对于将要出现或者将要消失的组件的动画应该使用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-transition-overview">转场动画</a>。</p></li>        <li>         <p>尽量不要使用动画结束回调。属性动画是对已经发生的状态进行的动画，不需要开发者去处理结束的逻辑。如果要使用结束回调，一定要正确处理连续操作的数据管理。</p></li>       </ul>      </div></div></div>    </div>   </div>   <div></div></div>