<h1 _ngcontent-ltq-c119="" class="doc-title ng-star-inserted" title="实现应用图标动态切换"> 实现应用图标动态切换 </h1>

<div _ngcontent-ltq-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p>AppGallery Kit为使用动态图标的应用客户端提供查询动态图标信息、切换动态图标、恢复默认图标功能。</p>    <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">      <p>从版本5.0.3(15)开始，支持实现应用图标动态切换。</p>     </div></div></div>    <div class="tiledSection">     <h2 id="section10343164404617">场景介绍<i class="anchor-icon anchor-icon-link" anchorid="section10343164404617" tips="复制节点链接"></i></h2>          <ul>      <li>查询动态图标信息       <p>应用内查询可选的动态图标信息。</p></li>      <li>切换动态图标       <p>用户点击切换可选的动态图标，系统切换对应的动态图标。</p></li>      <li>恢复默认图标       <p>用于停止已选择的动态图标，系统切换默认图标。</p></li>     </ul>    </div>    <div class="tiledSection">     <h2 id="section193161550114115">业务流程<i class="anchor-icon anchor-icon-link" anchorid="section193161550114115" tips="复制节点链接"></i></h2>          <p><span><img height="318.73223900000005" originheight="777" originwidth="1297" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114543.37965332366471540347850264965791:50001231000000:2800:6EEF4834D46419CACAA4FD5AA93C2B52403B874F219A5534BB459EF190D2EABA.png" title="点击放大" width="532.084455"></span></p>     <p></p>    </div>    <div class="tiledSection">     <h3 id="section101401311805" class="firsth2">查询动态图标信息<i class="anchor-icon anchor-icon-link" anchorid="section101401311805" tips="复制节点链接"></i></h3>          <ol>      <li>用户查询可选的动态图标信息。</li>      <li>调用接口queryDynamicIcons获取动态图标信息。</li>      <li>接口返回动态图标信息给应用。</li>      <li>应用返回结果给用户。</li>     </ol>    </div>    <div class="tiledSection">     <h3 id="section9936841833">切换动态图标<i class="anchor-icon anchor-icon-link" anchorid="section9936841833" tips="复制节点链接"></i></h3>          <ol>      <li>用户需要切换动态图标。</li>      <li>调用接口selectDynamicIcon切换动态图标。</li>      <li>接口返回选择结果给应用。</li>      <li>应用返回结果给用户。</li>     </ol>    </div>    <div class="tiledSection">     <h3 id="section18489623631">恢复默认图标<i class="anchor-icon anchor-icon-link" anchorid="section18489623631" tips="复制节点链接"></i></h3>          <ol>      <li>用户需要恢复默认图标。</li>      <li>调用接口disableDynamicIcon禁用动态图标。</li>      <li>接口返回禁用结果给应用。</li>      <li>应用返回结果给用户。</li>     </ol>    </div>    <div class="tiledSection">     <h2 id="section1065418178414">约束与限制<i class="anchor-icon anchor-icon-link" anchorid="section1065418178414" tips="复制节点链接"></i></h2>          <ul>      <li>图标管理服务不支持模拟器，请使用真机调试。</li>      <li>图标管理服务支持Phone、Tablet、PC/2in1设备。并且从5.1.1(18)版本开始，新增支持Wearable设备，从5.1.1(19)版本开始，新增支持TV设备。</li>     </ul>    </div>    <div class="tiledSection">     <h2 id="section6348454124618">接口说明<i class="anchor-icon anchor-icon-link" anchorid="section6348454124618" tips="复制节点链接"></i></h2>          <p>图标管理服务提供以下接口，具体API说明详见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/appgallery-appinfomanager" target="_blank">接口文档</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.9.3.1.3.1.1" valign="top" width="49.95%">          <p>接口名</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.9.3.1.3.1.2" valign="top" width="50.05%">          <p>描述</p></th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="49.95%">          <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/appgallery-appinfomanager#section887383520415" target="_blank">queryDynamicIcons</a>(): Promise&lt;<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/appgallery-appinfomanager#section1535385414136" target="_blank">DynamicIconInfo</a>[]&gt;</p></td>         <td class="cellrowborder" valign="top" width="50.05%">          <p>查询动态图标信息接口，用于查询动态图标信息。</p></td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="49.95%">          <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/appgallery-appinfomanager#section16502191111574" target="_blank">selectDynamicIcon</a>(iconId: string): Promise&lt;void&gt;</p></td>         <td class="cellrowborder" valign="top" width="50.05%">          <p>切换动态图标接口，用于切换动态图标。</p></td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="49.95%">          <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/appgallery-appinfomanager#section984175210392" target="_blank">disableDynamicIcon</a>(): Promise&lt;void&gt;</p></td>         <td class="cellrowborder" valign="top" width="50.05%">          <p>禁用动态图标接口，用于停止动态图标，恢复默认图标。</p></td>        </tr>             </tbody></table></div>     </div>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>从版本6.0.0(20)开始，切换动态图标接口支持返回1006800013错误码。</p>      </div></div></div>    </div>    <div class="tiledSection">     <h2 id="section316371715233">开发步骤<i class="anchor-icon anchor-icon-link" anchorid="section316371715233" tips="复制节点链接"></i></h2>         </div>    <div class="tiledSection">     <h3 id="section887410561210" class="firsth2">查询动态图标信息<i class="anchor-icon anchor-icon-link" anchorid="section887410561210" tips="复制节点链接"></i></h3>          <ol>      <li><span>导入appInfoManager模块及相关公共模块。</span>       <p></p>       <div _ngcontent-ltq-c106="" class="highlight-div"><div _ngcontent-ltq-c106="" class="highlight-div-header"><div _ngcontent-ltq-c106="" class="highlight-div-header-left"><div _ngcontent-ltq-c106="" class="handle-button expand-button"><div _ngcontent-ltq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ltq-c106="" class="highlight-div-header-right"><div _ngcontent-ltq-c106="" class="handle-button ai-button"></div><div _ngcontent-ltq-c106="" class="handle-button line-button"><div _ngcontent-ltq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ltq-c106="" class="handle-button theme-button"><div _ngcontent-ltq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ltq-c106="" class="handle-button copy-button"><div _ngcontent-ltq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ltq-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { appInfoManager } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AppGalleryKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li></ol></pre></div></div>       <p></p></li>      <li><span>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/appgallery-appinfomanager#section887383520415" target="_blank">queryDynamicIcons</a>方法查询动态图标信息。</span>       <p></p>       <div _ngcontent-ltq-c106="" class="highlight-div"><div _ngcontent-ltq-c106="" class="highlight-div-header"><div _ngcontent-ltq-c106="" class="highlight-div-header-left"><div _ngcontent-ltq-c106="" class="handle-button expand-button"><div _ngcontent-ltq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ltq-c106="" class="highlight-div-header-right"><div _ngcontent-ltq-c106="" class="handle-button ai-button"></div><div _ngcontent-ltq-c106="" class="handle-button line-button"><div _ngcontent-ltq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ltq-c106="" class="handle-button theme-button"><div _ngcontent-ltq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ltq-c106="" class="handle-button copy-button"><div _ngcontent-ltq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ltq-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">try</span> {</li><li>  appInfoManager.<span class="hljs-title function_">queryDynamicIcons</span>()</li><li>    .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">queryResult: appInfoManager.DynamicIconInfo[]</span>) =&gt;</span> {</li><li>      hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0</span>, <span class="hljs-string">'TAG'</span>, <span class="hljs-string">"Succeeded in getting DynamicIconInfo size = "</span> + queryResult.<span class="hljs-property">length</span>);</li><li>      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; queryResult.<span class="hljs-property">length</span>; i++) {</li><li>        hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0</span>, <span class="hljs-string">'TAG'</span>, <span class="hljs-string">"Succeeded in getting DynamicIconInfo iconUrl = "</span> + queryResult[i][<span class="hljs-string">"iconUrl"</span>] + <span class="hljs-string">", iconId = "</span> + queryResult[i][<span class="hljs-string">"iconId"</span>] + <span class="hljs-string">", enabled = "</span>+queryResult[i][<span class="hljs-string">"enabled"</span>]);</li><li>      }</li><li>    }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error: BusinessError</span>) =&gt;</span> {</li><li>      hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0</span>, <span class="hljs-string">'TAG'</span>, <span class="hljs-string">"queryDynamicIcons failed, code: "</span> + error.<span class="hljs-property">code</span> + <span class="hljs-string">", exception message: "</span> + error.<span class="hljs-property">message</span>);</li><li>    });</li><li>} <span class="hljs-keyword">catch</span> (error) {</li><li>  hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0</span>, <span class="hljs-string">'TAG'</span>, <span class="hljs-string">"queryDynamicIcons exception code: "</span> + error.<span class="hljs-property">code</span> + <span class="hljs-string">", exception message: "</span> + error.<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>       <p></p></li>     </ol>    </div>    <div class="tiledSection">     <h3 id="section2874156122">切换动态图标<i class="anchor-icon anchor-icon-link" anchorid="section2874156122" tips="复制节点链接"></i></h3>          <ol>      <li><span>导入appInfoManager模块及相关公共模块。</span>       <p></p>       <div _ngcontent-ltq-c106="" class="highlight-div"><div _ngcontent-ltq-c106="" class="highlight-div-header"><div _ngcontent-ltq-c106="" class="highlight-div-header-left"><div _ngcontent-ltq-c106="" class="handle-button expand-button"><div _ngcontent-ltq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ltq-c106="" class="highlight-div-header-right"><div _ngcontent-ltq-c106="" class="handle-button ai-button"></div><div _ngcontent-ltq-c106="" class="handle-button line-button"><div _ngcontent-ltq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ltq-c106="" class="handle-button theme-button"><div _ngcontent-ltq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ltq-c106="" class="handle-button copy-button"><div _ngcontent-ltq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ltq-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { appInfoManager } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AppGalleryKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li></ol></pre></div></div>       <p></p></li>      <li><span>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/appgallery-appinfomanager#section16502191111574" target="_blank">selectDynamicIcon</a>方法切换动态图标。</span>       <p></p>       <div _ngcontent-ltq-c106="" class="highlight-div"><div _ngcontent-ltq-c106="" class="highlight-div-header"><div _ngcontent-ltq-c106="" class="highlight-div-header-left"><div _ngcontent-ltq-c106="" class="handle-button expand-button"><div _ngcontent-ltq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ltq-c106="" class="highlight-div-header-right"><div _ngcontent-ltq-c106="" class="handle-button ai-button"></div><div _ngcontent-ltq-c106="" class="handle-button line-button"><div _ngcontent-ltq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ltq-c106="" class="handle-button theme-button"><div _ngcontent-ltq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ltq-c106="" class="handle-button copy-button"><div _ngcontent-ltq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ltq-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">try</span> {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">iconId</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'iconId'</span>;</li><li>  appInfoManager.<span class="hljs-title function_">selectDynamicIcon</span>(iconId).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>      hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0</span>, <span class="hljs-string">'TAG'</span>, <span class="hljs-string">"Succeeded in selecting dynamic icon"</span>);</li><li>  }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error: BusinessError</span>) =&gt;</span> {</li><li>    hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0</span>, <span class="hljs-string">'TAG'</span>, <span class="hljs-string">"selectDynamicIcon failed, code: "</span> + error.<span class="hljs-property">code</span> + <span class="hljs-string">", exception message: "</span> + error.<span class="hljs-property">message</span>);</li><li>  });</li><li>} <span class="hljs-keyword">catch</span> (error) {</li><li>  hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0</span>, <span class="hljs-string">'TAG'</span>, <span class="hljs-string">"selectDynamicIcon exception code: "</span> + error.<span class="hljs-property">code</span> + <span class="hljs-string">", exception message: "</span> + error.<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>       <p></p></li>     </ol>    </div>    <div class="tiledSection">     <h3 id="section188751155123">恢复默认图标<i class="anchor-icon anchor-icon-link" anchorid="section188751155123" tips="复制节点链接"></i></h3>          <ol>      <li><span>导入appInfoManager模块及相关公共模块。</span>       <p></p>       <div _ngcontent-ltq-c106="" class="highlight-div"><div _ngcontent-ltq-c106="" class="highlight-div-header"><div _ngcontent-ltq-c106="" class="highlight-div-header-left"><div _ngcontent-ltq-c106="" class="handle-button expand-button"><div _ngcontent-ltq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ltq-c106="" class="highlight-div-header-right"><div _ngcontent-ltq-c106="" class="handle-button ai-button"></div><div _ngcontent-ltq-c106="" class="handle-button line-button"><div _ngcontent-ltq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ltq-c106="" class="handle-button theme-button"><div _ngcontent-ltq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ltq-c106="" class="handle-button copy-button"><div _ngcontent-ltq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ltq-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { appInfoManager } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AppGalleryKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li></ol></pre></div></div>       <p></p></li>      <li><span>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/appgallery-appinfomanager#section984175210392" target="_blank">disableDynamicIcon</a>方法恢复默认图标。</span>       <p></p>       <div _ngcontent-ltq-c106="" class="highlight-div"><div _ngcontent-ltq-c106="" class="highlight-div-header"><div _ngcontent-ltq-c106="" class="highlight-div-header-left"><div _ngcontent-ltq-c106="" class="handle-button expand-button"><div _ngcontent-ltq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ltq-c106="" class="highlight-div-header-right"><div _ngcontent-ltq-c106="" class="handle-button ai-button"></div><div _ngcontent-ltq-c106="" class="handle-button line-button"><div _ngcontent-ltq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ltq-c106="" class="handle-button theme-button"><div _ngcontent-ltq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ltq-c106="" class="handle-button copy-button"><div _ngcontent-ltq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ltq-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">try</span> {</li><li>  appInfoManager.<span class="hljs-title function_">disableDynamicIcon</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>      hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0</span>, <span class="hljs-string">'TAG'</span>, <span class="hljs-string">"Succeeded in disabling dynamic icon"</span>);</li><li>  }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error: BusinessError</span>) =&gt;</span> {</li><li>    hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0</span>, <span class="hljs-string">'TAG'</span>, <span class="hljs-string">"disableDynamicIcon failed, code: "</span> + error.<span class="hljs-property">code</span> + <span class="hljs-string">", exception message: "</span> + error.<span class="hljs-property">message</span>);</li><li>  });</li><li>} <span class="hljs-keyword">catch</span> (error) {</li><li>  hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0</span>, <span class="hljs-string">'TAG'</span>, <span class="hljs-string">"disableDynamicIcon exception code: "</span> + error.<span class="hljs-property">code</span> + <span class="hljs-string">", exception message: "</span> + error.<span class="hljs-property">message</span>);</li><li>}</li></ol></pre></div></div>       <p></p></li>     </ol>    </div>   </div>   <div></div></div>