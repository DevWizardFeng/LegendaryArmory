<h1 _ngcontent-qlm-c119="" class="doc-title ng-star-inserted" title="实践说明"> 实践说明 </h1>

<div _ngcontent-qlm-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div id="body0000001815605968"><div class="tiledSection"><h2 id="section67131365449">通过hook以及插件上下文动态配置构建配置(推荐使用)<i class="anchor-icon anchor-icon-link" anchorid="section67131365449" tips="复制节点链接"></i></h2></div> <div class="tiledSection"><h3 id="section973053620286" class="firsth2">修改每个hvigorNode中的build-profile.json5<i class="anchor-icon anchor-icon-link" anchorid="section973053620286" tips="复制节点链接"></i></h3><p id="ZH-CN_TOPIC_0000002510174433__p9625731122911">此处只举例为单个node注册hook并修改build-profile.json5的信息。</p> <p id="ZH-CN_TOPIC_0000002510174433__p11625183182915">例如需要修改根目录下的build-profile.json5的签名信息，则在项目根目录下的hvigorfile.ts中添加如下内容：</p> <div _ngcontent-qlm-c106="" class="highlight-div"><div _ngcontent-qlm-c106="" class="highlight-div-header"><div _ngcontent-qlm-c106="" class="highlight-div-header-left"><div _ngcontent-qlm-c106="" class="handle-button expand-button"><div _ngcontent-qlm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-qlm-c106="" class="highlight-div-header-right"><div _ngcontent-qlm-c106="" class="handle-button ai-button"></div><div _ngcontent-qlm-c106="" class="handle-button line-button"><div _ngcontent-qlm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-qlm-c106="" class="handle-button theme-button"><div _ngcontent-qlm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-qlm-c106="" class="handle-button copy-button"><div _ngcontent-qlm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-qlm-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" id="ZH-CN_TOPIC_0000002510174433__screen18625631142920" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-variable">appTasks</span>, <span class="hljs-variable">OhosAppContext</span>, <span class="hljs-variable">OhosPluginId</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@ohos/hvigor-ohos-plugin'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-variable">hvigor</span>,<span class="hljs-variable">getNode</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@ohos/hvigor'</span></li><li>
</li><li><span class="hljs-comment">// 获取根节点</span></li><li><span class="hljs-keyword">const</span> <span class="hljs-variable">rootNode</span> = <span class="hljs-title function_">getNode</span>(<span class="hljs-variable">__filename</span>);</li><li><span class="hljs-comment">// 为根节点添加一个afterNodeEvaluate hook 在hook中修改根目录下的build-profile.json5的内容并使能</span></li><li><span class="hljs-variable">rootNode</span>.<span class="hljs-title function_">afterNodeEvaluate</span>(<span class="hljs-variable">node</span> =&gt; {</li><li>    <span class="hljs-comment">// 获取app插件的上下文对象</span></li><li>    <span class="hljs-keyword">const</span> <span class="hljs-variable">appContext</span> = <span class="hljs-variable">node</span>.<span class="hljs-title function_">getContext</span>(<span class="hljs-variable">OhosPluginId</span>.<span class="hljs-variable">OHOS_APP_PLUGIN</span>) <span class="hljs-keyword">as</span> <span class="hljs-variable">OhosAppContext</span>;</li><li>    <span class="hljs-comment">// 通过上下文对象获取从根目录build-profile.json5文件中读出来的obj对象</span></li><li>    <span class="hljs-keyword">const</span> <span class="hljs-variable">buildProfileOpt</span> = <span class="hljs-variable">appContext</span>.<span class="hljs-title function_">getBuildProfileOpt</span>();</li><li>    <span class="hljs-comment">// 修改obj对象为想要的，此处举例修改app中的signingConfigs</span></li><li>    <span class="hljs-variable">buildProfileOpt</span>[<span class="hljs-string">'app'</span>][<span class="hljs-string">'signingConfigs'</span>] = [</li><li>        {</li><li>            <span class="hljs-string">"name"</span>: <span class="hljs-string">"default"</span>,</li><li>            <span class="hljs-string">"type"</span>: <span class="hljs-string">"HarmonyOS"</span>,</li><li>            <span class="hljs-string">"material"</span>: {</li><li>                <span class="hljs-string">"certpath"</span>: <span class="hljs-string">"D:\\SigningConfig\\debug_hos.cer"</span>,</li><li>                <span class="hljs-string">"storePassword"</span>: <span class="hljs-string">"******"</span>,</li><li>                <span class="hljs-string">"keyAlias"</span>: <span class="hljs-string">"debugKey"</span>,</li><li>                <span class="hljs-string">"keyPassword"</span>: <span class="hljs-string">"******"</span>,</li><li>                <span class="hljs-string">"profile"</span>: <span class="hljs-string">"D:\\SigningConfig\\debug_hos.p7b"</span>,</li><li>                <span class="hljs-string">"signAlg"</span>: <span class="hljs-string">"SHA256withECDSA"</span>,</li><li>                <span class="hljs-string">"storeFile"</span>: <span class="hljs-string">"D:\\SigningConfig\\debug_hos.p12"</span></li><li>            }</li><li>        }</li><li>    ];</li><li>    <span class="hljs-comment">// 将obj对象设置回上下文对象以使能到构建的过程与结果中</span></li><li>    <span class="hljs-variable">appContext</span>.<span class="hljs-title function_">setBuildProfileOpt</span>(<span class="hljs-variable">buildProfileOpt</span>);</li><li>})</li><li><span class="hljs-variable">export</span> <span class="hljs-variable">default</span> {</li><li>    <span class="hljs-variable">system</span>: <span class="hljs-title class_">appTasks</span>,  <span class="hljs-comment">/* Built-in plugin of Hvigor. It cannot be modified. */</span></li><li>    <span class="hljs-variable">plugins</span>:[]         <span class="hljs-comment">/* Custom plugin to extend the functionality of Hvigor. */</span></li><li>}</li></ol></pre></div></div> </div> <div class="tiledSection"><h3 id="section6236108173016">修改module.json5中的配置信息<i class="anchor-icon anchor-icon-link" anchorid="section6236108173016" tips="复制节点链接"></i></h3><p id="ZH-CN_TOPIC_0000002510174433__p1265904216307">可以通过hvigor对象的hook能力快捷为所有的node创建hook，此处先举例为单一的node创建一个hook并修改其中的module.json5的配置信息。</p> <p id="ZH-CN_TOPIC_0000002510174433__p465904216301">例如此处需要修改entry下的module.json5配置，则在entry下的hvigorfile.ts中添加如下内容：</p> <div _ngcontent-qlm-c106="" class="highlight-div"><div _ngcontent-qlm-c106="" class="highlight-div-header"><div _ngcontent-qlm-c106="" class="highlight-div-header-left"><div _ngcontent-qlm-c106="" class="handle-button expand-button"><div _ngcontent-qlm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-qlm-c106="" class="highlight-div-header-right"><div _ngcontent-qlm-c106="" class="handle-button ai-button"></div><div _ngcontent-qlm-c106="" class="handle-button line-button"><div _ngcontent-qlm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-qlm-c106="" class="handle-button theme-button"><div _ngcontent-qlm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-qlm-c106="" class="handle-button copy-button"><div _ngcontent-qlm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-qlm-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-javascript" id="ZH-CN_TOPIC_0000002510174433__screen2659124218306" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { hapTasks, <span class="hljs-title class_">OhosHapContext</span>, <span class="hljs-title class_">OhosPluginId</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@ohos/hvigor-ohos-plugin'</span>;</li><li><span class="hljs-keyword">import</span> { getNode } <span class="hljs-keyword">from</span> <span class="hljs-string">'@ohos/hvigor'</span></li><li>
</li><li><span class="hljs-keyword">const</span> entryNode = <span class="hljs-title function_">getNode</span>(__filename);</li><li><span class="hljs-comment">// 为此节点添加一个afterNodeEvaluate hook 在hook中修改module.json5的内容并使能</span></li><li>entryNode.<span class="hljs-title function_">afterNodeEvaluate</span>(<span class="hljs-function"><span class="hljs-params">node</span> =&gt;</span> {</li><li>    <span class="hljs-comment">// 获取此节点使用插件的上下文对象 此时为hap插件 获取hap插件上下文对象</span></li><li>    <span class="hljs-keyword">const</span> hapContext = node.<span class="hljs-title function_">getContext</span>(<span class="hljs-title class_">OhosPluginId</span>.<span class="hljs-property">OHOS_HAP_PLUGIN</span>) <span class="hljs-keyword">as</span> <span class="hljs-title class_">OhosHapContext</span>;</li><li>    <span class="hljs-comment">// 通过上下文对象获取从module.json5文件中读出来的obj对象</span></li><li>    <span class="hljs-keyword">const</span> moduleJsonOpt = hapContext.<span class="hljs-title function_">getModuleJsonOpt</span>();</li><li>    <span class="hljs-comment">// 修改obj对象为想要的，此处举例修改module中的deviceTypes</span></li><li>    moduleJsonOpt[<span class="hljs-string">'module'</span>][<span class="hljs-string">'deviceTypes'</span>] = [<span class="hljs-string">"phone"</span>, <span class="hljs-string">"tablet"</span>, <span class="hljs-string">"2in1"</span>, <span class="hljs-string">"car"</span>];</li><li>    <span class="hljs-comment">// 将obj对象设置回上下文对象以使能到构建的过程与结果中</span></li><li>    hapContext.<span class="hljs-title function_">setModuleJsonOpt</span>(moduleJsonOpt);</li><li>})</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {</li><li>    <span class="hljs-attr">system</span>: hapTasks,  <span class="hljs-comment">/* Built-in plugin of Hvigor. It cannot be modified. */</span></li><li>    <span class="hljs-attr">plugins</span>:[]         <span class="hljs-comment">/* Custom plugin to extend the functionality of Hvigor. */</span></li><li>}</li></ol></pre></div></div> </div> <div class="tiledSection"><h3 id="section9435132933118">修改app.json5中的配置信息<i class="anchor-icon anchor-icon-link" anchorid="section9435132933118" tips="复制节点链接"></i></h3><p id="ZH-CN_TOPIC_0000002510174433__p48531354183115">在项目的根目录下的hvigorfile.ts中添加如下代码内容：</p> <div _ngcontent-qlm-c106="" class="highlight-div"><div _ngcontent-qlm-c106="" class="highlight-div-header"><div _ngcontent-qlm-c106="" class="highlight-div-header-left"><div _ngcontent-qlm-c106="" class="handle-button expand-button"><div _ngcontent-qlm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-qlm-c106="" class="highlight-div-header-right"><div _ngcontent-qlm-c106="" class="handle-button ai-button"></div><div _ngcontent-qlm-c106="" class="handle-button line-button"><div _ngcontent-qlm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-qlm-c106="" class="handle-button theme-button"><div _ngcontent-qlm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-qlm-c106="" class="handle-button copy-button"><div _ngcontent-qlm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-qlm-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-javascript" id="ZH-CN_TOPIC_0000002510174433__screen12853354173118" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { appTasks, <span class="hljs-title class_">OhosAppContext</span>, <span class="hljs-title class_">OhosPluginId</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@ohos/hvigor-ohos-plugin'</span>;</li><li><span class="hljs-keyword">import</span> { hvigor } <span class="hljs-keyword">from</span> <span class="hljs-string">'@ohos/hvigor'</span></li><li>
</li><li><span class="hljs-comment">// 为根节点添加一个afterNodeEvaluate hook 在hook中修改app.json5的内容并使能</span></li><li>hvigor.<span class="hljs-title function_">getRootNode</span>().<span class="hljs-title function_">afterNodeEvaluate</span>(<span class="hljs-function"><span class="hljs-params">rootNode</span> =&gt;</span> {</li><li>    <span class="hljs-comment">// 获取app插件的上下文对象</span></li><li>    <span class="hljs-keyword">const</span> appContext = rootNode.<span class="hljs-title function_">getContext</span>(<span class="hljs-title class_">OhosPluginId</span>.<span class="hljs-property">OHOS_APP_PLUGIN</span>) <span class="hljs-keyword">as</span> <span class="hljs-title class_">OhosAppContext</span>;</li><li>    <span class="hljs-comment">// 通过上下文对象获取从app.json5文件中读出来的obj对象</span></li><li>    <span class="hljs-keyword">const</span> appJsonOpt = appContext.<span class="hljs-title function_">getAppJsonOpt</span>();</li><li>    <span class="hljs-comment">// 修改obj对象为想要的，此处举例修改app中的versionCode</span></li><li>    appJsonOpt[<span class="hljs-string">'app'</span>][<span class="hljs-string">'versionCode'</span>] = <span class="hljs-number">1000001</span>;</li><li>    <span class="hljs-comment">// 将obj对象设置回上下文对象以使能到构建的过程与结果中</span></li><li>    appContext.<span class="hljs-title function_">setAppJsonOpt</span>(appJsonOpt);</li><li>})</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {</li><li>    <span class="hljs-attr">system</span>: appTasks,  <span class="hljs-comment">/* Built-in plugin of Hvigor. It cannot be modified. */</span></li><li>    <span class="hljs-attr">plugins</span>:[]         <span class="hljs-comment">/* Custom plugin to extend the functionality of Hvigor. */</span></li><li>}</li></ol></pre></div></div> </div> <div class="tiledSection"><h3 id="section641902414326">修改oh-package.json5中的依赖<i class="anchor-icon anchor-icon-link" anchorid="section641902414326" tips="复制节点链接"></i></h3><div class="p" id="ZH-CN_TOPIC_0000002510174433__p1290433643212">可以通过hvigorfile.ts自定义插件修改工程级、模块级的oh-package.json5的依赖，例如在工程级hvigorfile.ts或模块级hvigorfile.ts分别添加以下内容：<div _ngcontent-qlm-c106="" class="highlight-div"><div _ngcontent-qlm-c106="" class="highlight-div-header"><div _ngcontent-qlm-c106="" class="highlight-div-header-left"><div _ngcontent-qlm-c106="" class="handle-button expand-button"><div _ngcontent-qlm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-qlm-c106="" class="highlight-div-header-right"><div _ngcontent-qlm-c106="" class="handle-button ai-button"></div><div _ngcontent-qlm-c106="" class="handle-button line-button"><div _ngcontent-qlm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-qlm-c106="" class="handle-button theme-button"><div _ngcontent-qlm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-qlm-c106="" class="handle-button copy-button"><div _ngcontent-qlm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-qlm-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-javascript" id="ZH-CN_TOPIC_0000002510174433__screen4904173663212" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 工程级hvigorfile.ts</span></li><li><span class="hljs-keyword">import</span> { appTasks, <span class="hljs-title class_">OhosAppContext</span>, <span class="hljs-title class_">OhosPluginId</span>, <span class="hljs-title class_">Target</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@ohos/hvigor-ohos-plugin'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">HvigorNode</span>, <span class="hljs-title class_">HvigorPlugin</span>, <span class="hljs-title class_">TaskInput</span>, <span class="hljs-title class_">TaskOutput</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@ohos/hvigor'</span>;</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">customPlugin</span>(<span class="hljs-params"></span>): <span class="hljs-title class_">HvigorPlugin</span> {</li><li>    <span class="hljs-keyword">return</span> {</li><li>        <span class="hljs-attr">pluginId</span>: <span class="hljs-string">'customPlugin'</span>,</li><li>        <span class="hljs-keyword">async</span> <span class="hljs-title function_">apply</span>(<span class="hljs-attr">currentNode</span>: <span class="hljs-title class_">HvigorNode</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-keyword">void</span>&gt; {</li><li>            <span class="hljs-keyword">const</span> appContext = currentNode.<span class="hljs-title function_">getContext</span>(<span class="hljs-title class_">OhosPluginId</span>.<span class="hljs-property">OHOS_APP_PLUGIN</span>) <span class="hljs-keyword">as</span> <span class="hljs-title class_">OhosAppContext</span>;</li><li>            <span class="hljs-keyword">const</span> dependency = appContext.<span class="hljs-title function_">getDependenciesOpt</span>({});  <span class="hljs-comment">// 获取dependency依赖</span></li><li>            dependency[<span class="hljs-string">"library"</span>]=<span class="hljs-string">"file:library.har"</span>    <span class="hljs-comment">// 确保har包存在</span></li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(dependency);</li><li>            appContext.<span class="hljs-title function_">setDependenciesOpt</span>(dependency );  <span class="hljs-comment">// 修改dependency依赖，需要确保oh-package.json5中dependencies字段存在</span></li><li>        }</li><li>    };</li><li>}</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {</li><li>    <span class="hljs-attr">system</span>: appTasks,  <span class="hljs-comment">/* Built-in plugin of Hvigor. It cannot be modified. */</span></li><li>    <span class="hljs-attr">plugins</span>:[<span class="hljs-title function_">customPlugin</span>()]         <span class="hljs-comment">/* Custom plugin to extend the functionality of Hvigor. */</span></li><li>}</li><li>
</li><li><span class="hljs-comment">// 模块级hvigorfile.ts</span></li><li><span class="hljs-keyword">import</span> {hapTasks,<span class="hljs-title class_">OhosHapContext</span>,<span class="hljs-title class_">OhosPluginId</span>,<span class="hljs-title class_">Target</span>} <span class="hljs-keyword">from</span> <span class="hljs-string">'@ohos/hvigor-ohos-plugin'</span>;</li><li><span class="hljs-keyword">import</span> { hvigor, <span class="hljs-title class_">HvigorNode</span>, <span class="hljs-title class_">HvigorPlugin</span>} <span class="hljs-keyword">from</span> <span class="hljs-string">'@ohos/hvigor'</span>;</li><li><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> fs <span class="hljs-keyword">from</span> <span class="hljs-string">'fs'</span>;</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">customPlugin</span>(<span class="hljs-params"></span>): <span class="hljs-title class_">HvigorPlugin</span> {</li><li>    <span class="hljs-keyword">return</span> {</li><li>        <span class="hljs-attr">pluginId</span>: <span class="hljs-string">'customPlugin'</span>,</li><li>        <span class="hljs-keyword">async</span> <span class="hljs-title function_">apply</span>(<span class="hljs-attr">currentNode</span>: <span class="hljs-title class_">HvigorNode</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-keyword">void</span>&gt; {</li><li>            <span class="hljs-keyword">const</span> hapContext = currentNode.<span class="hljs-title function_">getContext</span>(<span class="hljs-title class_">OhosPluginId</span>.<span class="hljs-property">OHOS_HAP_PLUGIN</span>) <span class="hljs-keyword">as</span> <span class="hljs-title class_">OhosHapContext</span>;</li><li>            <span class="hljs-keyword">const</span> dependency = hapContext.<span class="hljs-title function_">getDependenciesOpt</span>();    <span class="hljs-comment">// 获取dependency依赖</span></li><li>            dependency[<span class="hljs-string">"library"</span>]=<span class="hljs-string">"file:library.har"</span>    <span class="hljs-comment">// 确保har包存在</span></li><li>            hapContext.<span class="hljs-title function_">setDependenciesOpt</span>(dependency);}   <span class="hljs-comment">// 需要确保oh-package.json5中dependencies字段存在</span></li><li>        }</li><li>    };</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {</li><li>    <span class="hljs-attr">system</span>: hapTasks,  <span class="hljs-comment">/* Built-in plugin of Hvigor. It cannot be modified. */</span></li><li>    <span class="hljs-attr">plugins</span>:[<span class="hljs-title function_">customPlugin</span>()]         <span class="hljs-comment">/* Custom plugin to extend the functionality of Hvigor. */</span></li><li>}</li></ol></pre></div></div> </div> </div> <div class="tiledSection"><h2 id="section185161632473">通过overrides动态配置签名材料和版本信息(不推荐使用)<i class="anchor-icon anchor-icon-link" anchorid="section185161632473" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510174433__p16870143464117">通过在hvigorfile.ts里使用函数方法，动态配置签名材料和版本号、版本名等信息：</p> <div _ngcontent-qlm-c106="" class="highlight-div"><div _ngcontent-qlm-c106="" class="highlight-div-header"><div _ngcontent-qlm-c106="" class="highlight-div-header-left"><div _ngcontent-qlm-c106="" class="handle-button expand-button"><div _ngcontent-qlm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-qlm-c106="" class="highlight-div-header-right"><div _ngcontent-qlm-c106="" class="handle-button ai-button"></div><div _ngcontent-qlm-c106="" class="handle-button line-button"><div _ngcontent-qlm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-qlm-c106="" class="handle-button theme-button"><div _ngcontent-qlm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-qlm-c106="" class="handle-button copy-button"><div _ngcontent-qlm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-qlm-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" id="ZH-CN_TOPIC_0000002510174433__screen699382717433" data-highlighted="yes"><ol class="linenums"><li><span class=""><span class="hljs-comment">//</span></span><span class=""><span class="hljs-comment">工程级别</span></span><span class=""><span class="hljs-comment">hvigorfile.ts</span></span></li><li><span class="hljs-keyword">import</span> <span class="">{ </span><span class=""><span class="hljs-variable">appTasks</span> </span><span class="">} </span><span class="hljs-keyword">from</span> <span class=""><span class="hljs-string">'@ohos/hvigor-ohos-plugin'</span></span><span class="">;</span></li><li><span class="hljs-variable">export</span> <span class="hljs-variable">default</span> <span class="">{</span></li><li>  <span class=""><span class="hljs-variable">system</span></span><span class="">: </span><span class=""><span class="hljs-title class_">appTasks</span></span><span class="">,  </span><span class=""><span class="hljs-comment">/* Built-in plugin of Hvigor. It cannot be modified. */</span></span></li><li>  <span class=""><span class="hljs-variable">plugins</span></span><span class="">: </span><span class="">[]</span><span class="">,       </span><span class=""><span class="hljs-comment">/* Custom plugin to extend the functionality of Hvigor. */</span></span></li><li>  <span class=""><span class="hljs-variable">config</span></span><span class="">: </span><span class="">{</span></li><li>    <span class=""><span class="hljs-variable">ohos</span></span><span class="">: </span><span class="">{</span></li><li>      <span class=""><span class="hljs-variable">overrides</span></span><span class="">:</span><span class="">{</span></li><li>        <span class=""><span class="hljs-variable">signingConfig</span></span><span class="">: </span><span class=""><span class="hljs-title class_">getSigningConfig</span></span><span class="">()</span><span class="">, </span><span class=""><span class="hljs-comment">//</span></span><span class=""><span class="hljs-comment">签名配置对象 </span></span></li><li>        <span class=""><span class="hljs-variable">appOpt</span></span><span class="">: </span><span class="">{</span></li><li>          <span class=""><span class="hljs-variable">versionCode</span></span><span class="">: </span><span class=""><span class="hljs-title class_">getVersionCode</span></span><span class="">()</span><span class="">,</span></li><li>          <span class=""><span class="hljs-variable">versionName</span></span><span class="">: </span><span class=""><span class="hljs-title class_">getVersionName</span></span><span class="">()</span><span class="">,</span></li><li>        <span class="">} </span><span class=""><span class="hljs-comment">//app.json</span></span><span class=""><span class="hljs-comment">中的内容 </span></span></li><li>      <span class="">}</span></li><li><span class="">    }</span></li><li><span class="">  }</span></li><li><span class="">}</span></li><li>
</li><li><span class="hljs-variable">function</span> <span class=""><span class="hljs-title function_">getSigningConfig</span></span><span class="">() </span><span class="">{</span></li><li>  <span class="hljs-keyword">return</span> <span class="">{</span></li><li>    <span class=""><span class="hljs-keyword">type</span></span><span class="">: </span><span class=""><span class="hljs-string">"HarmonyOS"</span></span><span class="">,</span></li><li>    <span class=""><span class="hljs-variable">material</span></span><span class="">: </span><span class="">{</span></li><li>      <span class=""><span class="hljs-variable">certpath</span></span><span class="">: </span><span class=""><span class="hljs-string">"D:</span></span><span class="hljs-string">\\</span><span class=""><span class="hljs-string">SigningConfig</span></span><span class="hljs-string">\\</span><span class=""><span class="hljs-string">debug_hos.cer"</span></span><span class="">,</span></li><li>      <span class=""><span class="hljs-variable">storePassword</span></span><span class="">: </span><span class=""><span class="hljs-string">"******"</span></span><span class="">,</span></li><li>      <span class=""><span class="hljs-variable">keyAlias</span></span><span class="">: </span><span class=""><span class="hljs-string">"debugKey"</span></span><span class="">,</span></li><li>      <span class=""><span class="hljs-variable">keyPassword</span></span><span class="">: </span><span class=""><span class="hljs-string">"******"</span></span><span class="">,</span></li><li>      <span class=""><span class="hljs-variable">profile</span></span><span class="">: </span><span class=""><span class="hljs-string">"D:</span></span><span class="hljs-string">\\</span><span class=""><span class="hljs-string">SigningConfig</span></span><span class="hljs-string">\\</span><span class=""><span class="hljs-string">debug_hos.p7b"</span></span><span class="">,</span></li><li>      <span class=""><span class="hljs-variable">signAlg</span></span><span class="">: </span><span class=""><span class="hljs-string">"SHA256withECDSA"</span></span><span class="">,</span></li><li>      <span class=""><span class="hljs-variable">storeFile</span></span><span class="">: </span><span class=""><span class="hljs-string">"D:</span></span><span class="hljs-string">\\</span><span class=""><span class="hljs-string">SigningConfig</span></span><span class="hljs-string">\\</span><span class=""><span class="hljs-string">debug_hos.p12"</span></span></li><li>    <span class="">}</span></li><li><span class="">  }</span></li><li><span class="">}</span></li><li>
</li><li><span class="hljs-variable">function</span> <span class=""><span class="hljs-title function_">getVersionCode</span></span><span class="">() </span><span class="">{</span></li><li>  <span class="hljs-keyword">return</span> <span class=""><span class="hljs-number">100000</span></span><span class="">+</span><span class="hljs-variable">new</span> <span class="hljs-title function_">Date</span>().<span class="hljs-title function_">getFullYear</span>()<span class="">;</span></li><li><span class="">}</span></li><li>
</li><li><span class="hljs-variable">function</span> <span class=""><span class="hljs-title function_">getVersionName</span></span><span class="">() </span><span class="">{</span></li><li>  <span class="hljs-keyword">return</span> <span class="">`<span class="hljs-number">1.0</span><span class="hljs-number">.0</span></span><span class="">${</span><span class="hljs-variable">new</span> <span class="hljs-title function_">Date</span>()<span class="">.</span><span class=""><span class="hljs-title function_">getTime</span></span><span class="">()</span><span class="">}</span><span class="">`</span><span class="">;</span></li><li><span class="">}</span></li></ol></pre></div></div> </div> </div> <div></div></div>