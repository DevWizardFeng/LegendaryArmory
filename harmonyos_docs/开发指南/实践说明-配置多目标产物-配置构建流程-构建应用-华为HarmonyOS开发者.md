<h1 _ngcontent-bsd-c119="" class="doc-title ng-star-inserted" title="实践说明"> 实践说明 </h1>

<div _ngcontent-bsd-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div id="body0000001778674597"><p id="ZH-CN_TOPIC_0000002510174377__p7509135315134">某对外发布应用共有两个版本：</p> <p id="ZH-CN_TOPIC_0000002510174377__p114481689118">1. Community社区版本，免费，向个人开发者用户提供该应用绝大部分基础功能，但是不提供部分定制化限定功能及技术支持。</p> <p id="ZH-CN_TOPIC_0000002510174377__p2053217278142">2. Ultimate终极版本，收费，向个人、政企等开发者用户提供该应用全部基础功能，同时提供定制化限定功能及技术支持。</p> <p id="ZH-CN_TOPIC_0000002510174377__p850023181815">可以看出在Community版本与Ultimate版本之间，部分功能存在重合，同时也存在某些特定功能，所以期望通过一次开发以实现差异化，根据不同配置完成多种特定运行环境的开发、预览、打包、调试等功能。</p> <p id="ZH-CN_TOPIC_0000002510174377__p8180144916194"><span><img originheight="923" originwidth="1343" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104918.91091754120412765388351689166831:50001231000000:2800:0A20B231AB5428907A936507899D6F699B82C8FCC0A03F0B363FD4C8968E0C40.png" width="920" height="632.2859270290395"></span></p> <p id="ZH-CN_TOPIC_0000002510174377__p8060118">1. 两个不同版本的软件，可能存在差异：如不同的应用标题、应用图标、版本声明。我们可以在工程级build-profile.json5-&gt;app{}-&gt;products[]中，可以对两种不同的外发版本进行差异化定制，新增两个product：Community和Ultimate。根据已支持的字段进行定制修改。</p> <div _ngcontent-bsd-c106="" class="highlight-div"><div _ngcontent-bsd-c106="" class="highlight-div-header"><div _ngcontent-bsd-c106="" class="highlight-div-header-left"><div _ngcontent-bsd-c106="" class="handle-button expand-button"><div _ngcontent-bsd-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bsd-c106="" class="highlight-div-header-right"><div _ngcontent-bsd-c106="" class="handle-button ai-button"></div><div _ngcontent-bsd-c106="" class="handle-button line-button"><div _ngcontent-bsd-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bsd-c106="" class="handle-button theme-button"><div _ngcontent-bsd-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bsd-c106="" class="handle-button copy-button"><div _ngcontent-bsd-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bsd-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" id="ZH-CN_TOPIC_0000002510174377__screen177476619447" data-highlighted="yes"><ol class="linenums"><li>{</li><li>  <span class=""><span class="hljs-string">"name"</span></span><span class="">: </span><span class=""><span class="hljs-string">"Ultimate"</span></span><span class="">,</span></li><li>  <span class=""><span class="hljs-comment">// ultimate</span></span><span class=""><span class="hljs-comment">版本签名</span></span></li><li>  <span class=""><span class="hljs-string">"signingConfig"</span></span><span class="">: </span><span class=""><span class="hljs-string">"Ultimate"</span></span><span class="">,</span></li><li>  <span class=""><span class="hljs-comment">// ultimate</span></span><span class=""><span class="hljs-comment">版本包名</span></span></li><li>  <span class=""><span class="hljs-string">"bundleName"</span></span><span class="">: </span><span class=""><span class="hljs-string">"com.example.ultimate.app"</span></span><span class="">,</span></li><li>  <span class=""><span class="hljs-comment">// ultimate</span></span><span class=""><span class="hljs-comment">版本应用图标</span></span></li><li>  <span class=""><span class="hljs-string">"icon"</span></span><span class="">: </span><span class=""><span class="hljs-string">"$media:app_icon"</span></span><span class="">,</span></li><li>  <span class=""><span class="hljs-comment">// ultimate</span></span><span class=""><span class="hljs-comment">版本应用标签</span></span></li><li>  <span class=""><span class="hljs-string">"label"</span></span><span class="">: </span><span class=""><span class="hljs-string">"$string:app_name"</span></span><span class="">,</span></li><li>  <span class=""><span class="hljs-string">"versionCode"</span></span><span class="">: </span><span class=""><span class="hljs-number">10000</span></span><span class="">,</span></li><li>  <span class=""><span class="hljs-string">"versionName"</span></span><span class="">: </span><span class=""><span class="hljs-string">"1.0.0"</span></span><span class="">,</span></li><li>  <span class=""><span class="hljs-comment">// ultimate</span></span><span class=""><span class="hljs-comment">版本指定资源目录</span></span></li><li>  <span class=""><span class="hljs-string">"resource"</span></span><span class="">: </span>{</li><li>    <span class=""><span class="hljs-string">"directories"</span></span><span class="">: </span>[</li><li>      <span class=""><span class="hljs-string">"./AppScope/ultimateRes"</span></span></li><li>    ]</li><li>  }<span class="">,</span></li><li>  <span class=""><span class="hljs-comment">// ultimate</span></span><span class=""><span class="hljs-comment">版本指定输出产物名</span></span></li><li>  <span class=""><span class="hljs-string">"output"</span></span><span class="">: </span>{</li><li>    <span class=""><span class="hljs-string">"artifactName"</span></span><span class="">: </span><span class=""><span class="hljs-string">"ultimate_version"</span></span></li><li>  }<span class="">,</span></li><li>  <span class=""><span class="hljs-string">"bundleType"</span></span><span class="">: </span><span class=""><span class="hljs-string">"app"</span></span><span class="">,</span></li><li>  <span class=""><span class="hljs-string">"compatibleSdkVersion"</span></span><span class="">: </span><span class=""><span class="hljs-string">"6.0.1(21)"</span></span><span class="">,</span></li><li>  <span class=""><span class="hljs-string">"runtimeOS"</span></span><span class="">: </span><span class=""><span class="hljs-string">"HarmonyOS"</span></span></li><li>}<span class="">,</span></li><li>{</li><li>  <span class=""><span class="hljs-string">"name"</span></span><span class="">: </span><span class=""><span class="hljs-string">"Community"</span></span><span class="">,</span></li><li>  <span class=""><span class="hljs-string">"signingConfig"</span></span><span class="">: </span><span class=""><span class="hljs-string">"Community"</span></span><span class="">,</span></li><li>  <span class=""><span class="hljs-comment">// community</span></span><span class=""><span class="hljs-comment">版本签名</span></span></li><li>  <span class=""><span class="hljs-string">"bundleName"</span></span><span class="">: </span><span class=""><span class="hljs-string">"com.example.community.app"</span></span><span class="">,</span></li><li>  <span class=""><span class="hljs-comment">// community</span></span><span class=""><span class="hljs-comment">版本包名</span></span></li><li>  <span class=""><span class="hljs-string">"icon"</span></span><span class="">: </span><span class=""><span class="hljs-string">"$media:app_icon"</span></span><span class="">,</span></li><li>  <span class=""><span class="hljs-comment">// community</span></span><span class=""><span class="hljs-comment">版本应用图标</span></span></li><li>  <span class=""><span class="hljs-string">"label"</span></span><span class="">: </span><span class=""><span class="hljs-string">"$string:app_name"</span></span><span class="">,</span></li><li>  <span class=""><span class="hljs-comment">// community</span></span><span class=""><span class="hljs-comment">版本应用标签</span></span></li><li>  <span class=""><span class="hljs-string">"versionCode"</span></span><span class="">: </span><span class=""><span class="hljs-number">10000</span></span><span class="">,</span></li><li>  <span class=""><span class="hljs-string">"versionName"</span></span><span class="">: </span><span class=""><span class="hljs-string">"1.0.0"</span></span><span class="">,</span></li><li>  <span class=""><span class="hljs-comment">// community</span></span><span class=""><span class="hljs-comment">版本指定资源目录</span></span></li><li>  <span class=""><span class="hljs-string">"resource"</span></span><span class="">: </span>{</li><li>    <span class=""><span class="hljs-string">"directories"</span></span><span class="">: </span>[</li><li>      <span class=""><span class="hljs-string">"./AppScope/communityRes"</span></span></li><li>    ]</li><li>  }<span class="">,</span></li><li>  <span class=""><span class="hljs-comment">// community</span></span><span class=""><span class="hljs-comment">版本指定输出产物名</span></span></li><li>  <span class=""><span class="hljs-string">"output"</span></span><span class="">: </span>{</li><li>    <span class=""><span class="hljs-string">"artifactName"</span></span><span class="">: </span><span class=""><span class="hljs-string">"community_version"</span></span></li><li>  }<span class="">,</span></li><li>  <span class=""><span class="hljs-string">"bundleType"</span></span><span class="">: </span><span class=""><span class="hljs-string">"app"</span></span><span class="">,</span></li><li>  <span class=""><span class="hljs-string">"compatibleSdkVersion"</span></span><span class="">: </span><span class=""><span class="hljs-string">"6.0.1(21)"</span></span><span class="">,</span></li><li>  <span class=""><span class="hljs-string">"runtimeOS"</span></span><span class="">: </span><span class=""><span class="hljs-string">"HarmonyOS"</span></span><span class="">,</span></li><li>}</li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002510174377__p108645379446"></p> <p id="ZH-CN_TOPIC_0000002510174377__p41221559164920">2. 应用软件部分功能可能针对特定场景存在定制场景：如ultimate版本的功能A在phone设备类型上免费，在TV设备类型上需要收费；再如community版本的功能B在2in1设备类型上的启动页与在wearable设备类型上呈现效果存在差异。在模块级build-profile.json5-&gt;targets[]中新增2个 target：vip和free。</p> <div _ngcontent-bsd-c106="" class="highlight-div"><div _ngcontent-bsd-c106="" class="highlight-div-header"><div _ngcontent-bsd-c106="" class="highlight-div-header-left"><div _ngcontent-bsd-c106="" class="handle-button expand-button"><div _ngcontent-bsd-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bsd-c106="" class="highlight-div-header-right"><div _ngcontent-bsd-c106="" class="handle-button ai-button"></div><div _ngcontent-bsd-c106="" class="handle-button line-button"><div _ngcontent-bsd-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bsd-c106="" class="handle-button theme-button"><div _ngcontent-bsd-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bsd-c106="" class="handle-button copy-button"><div _ngcontent-bsd-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bsd-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" id="ZH-CN_TOPIC_0000002510174377__screen175023744410" data-highlighted="yes"><ol class="linenums"><li>{</li><li>  <span class=""><span class="hljs-string">"name"</span></span><span class="">: </span><span class=""><span class="hljs-string">"vip"</span></span><span class="">,</span></li><li>  <span class=""><span class="hljs-comment">// </span></span><span class=""><span class="hljs-comment">定制</span></span><span class=""><span class="hljs-comment">vip</span></span><span class=""><span class="hljs-comment">包输出产物名</span></span></li><li>  <span class=""><span class="hljs-string">"output"</span></span><span class="">: </span>{</li><li>    <span class=""><span class="hljs-string">"artifactName"</span></span><span class="">: </span><span class=""><span class="hljs-string">"vipVersion"</span></span></li><li>  }<span class="">,</span></li><li>  <span class=""><span class="hljs-comment">// </span></span><span class=""><span class="hljs-comment">定制</span></span><span class=""><span class="hljs-comment">vip</span></span><span class=""><span class="hljs-comment">包源码指定页面</span></span></li><li>  <span class=""><span class="hljs-string">"source"</span></span><span class="">: </span>{</li><li>    <span class=""><span class="hljs-string">"pages"</span></span><span class="">: </span>[</li><li>      <span class=""><span class="hljs-string">"pages/vipIndex"</span></span></li><li>    ]</li><li>  }<span class="">,</span></li><li>  <span class=""><span class="hljs-comment">// </span></span><span class=""><span class="hljs-comment">指定</span></span><span class=""><span class="hljs-comment">vip</span></span><span class=""><span class="hljs-comment">包资源目录</span></span></li><li>  <span class=""><span class="hljs-string">"resource"</span></span><span class="">: </span>{</li><li>    <span class=""><span class="hljs-string">"directories"</span></span><span class="">: </span>[</li><li>      <span class=""><span class="hljs-string">"./src/main/ultimateRes"</span></span></li><li>    ]</li><li>  }<span class="">,</span></li><li>  <span class=""><span class="hljs-string">"config"</span></span><span class="">: </span>{</li><li>    <span class=""><span class="hljs-comment">// </span></span><span class=""><span class="hljs-comment">指定</span></span><span class=""><span class="hljs-comment">vip</span></span><span class=""><span class="hljs-comment">包适用设备类型</span></span></li><li>    <span class=""><span class="hljs-string">"deviceType"</span></span><span class="">: </span>[</li><li>      <span class=""><span class="hljs-string">"phone"</span></span><span class="">,</span></li><li>      <span class=""><span class="hljs-string">"tablet"</span></span><span class="">,</span></li><li>      <span class=""><span class="hljs-string">"2in1"</span></span></li><li>    ]</li><li>  }</li><li>}<span class="">,</span></li><li>{</li><li>  <span class=""><span class="hljs-string">"name"</span></span><span class="">: </span><span class=""><span class="hljs-string">"free"</span></span><span class="">,</span></li><li>  <span class=""><span class="hljs-comment">// </span></span><span class=""><span class="hljs-comment">定制</span></span><span class=""><span class="hljs-comment">free</span></span><span class=""><span class="hljs-comment">包输出产物名</span></span></li><li>  <span class=""><span class="hljs-string">"output"</span></span><span class="">: </span>{</li><li>    <span class=""><span class="hljs-string">"artifactName"</span></span><span class="">: </span><span class=""><span class="hljs-string">"freeVersion"</span></span></li><li>  }<span class="">,</span></li><li>  <span class=""><span class="hljs-comment">// </span></span><span class=""><span class="hljs-comment">定制</span></span><span class=""><span class="hljs-comment">free</span></span><span class=""><span class="hljs-comment">包源码指定页面</span></span></li><li>  <span class=""><span class="hljs-string">"source"</span></span><span class="">: </span>{</li><li>    <span class=""><span class="hljs-string">"pages"</span></span><span class="">: </span>[</li><li>      <span class=""><span class="hljs-string">"pages/freeIndex"</span></span></li><li>    ]</li><li>  }<span class="">,</span></li><li>  <span class=""><span class="hljs-comment">// </span></span><span class=""><span class="hljs-comment">指定</span></span><span class=""><span class="hljs-comment">free</span></span><span class=""><span class="hljs-comment">包资源目录</span></span></li><li>  <span class=""><span class="hljs-string">"resource"</span></span><span class="">: </span>{</li><li>    <span class=""><span class="hljs-string">"directories"</span></span><span class="">: </span>[</li><li>      <span class=""><span class="hljs-string">"./src/main/communityRes"</span></span></li><li>    ]</li><li>  }<span class="">,</span></li><li>  <span class=""><span class="hljs-string">"config"</span></span><span class="">: </span>{</li><li>    <span class=""><span class="hljs-comment">// </span></span><span class=""><span class="hljs-comment">指定</span></span><span class=""><span class="hljs-comment">free</span></span><span class=""><span class="hljs-comment">包适用设备类型</span></span></li><li>    <span class=""><span class="hljs-string">"deviceType"</span></span><span class="">: </span>[</li><li>      <span class=""><span class="hljs-string">"phone"</span></span><span class="">,</span></li><li>      <span class=""><span class="hljs-string">"tablet"</span></span></li><li>    ]</li><li>  }</li><li>}</li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002510174377__p857381449"></p> <p id="ZH-CN_TOPIC_0000002510174377__p18673536114414">3. 新增product、target后，需要在工程级build-profile.json5-&gt;modules[]-&gt;targets[]-&gt;applyToProducts中，指定关联关系。此处表示当前模块的target具体应用到工程product的配置。</p> <div _ngcontent-bsd-c106="" class="highlight-div"><div _ngcontent-bsd-c106="" class="highlight-div-header"><div _ngcontent-bsd-c106="" class="highlight-div-header-left"><div _ngcontent-bsd-c106="" class="handle-button expand-button"><div _ngcontent-bsd-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bsd-c106="" class="highlight-div-header-right"><div _ngcontent-bsd-c106="" class="handle-button ai-button"></div><div _ngcontent-bsd-c106="" class="handle-button line-button"><div _ngcontent-bsd-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bsd-c106="" class="handle-button theme-button"><div _ngcontent-bsd-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bsd-c106="" class="handle-button copy-button"><div _ngcontent-bsd-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bsd-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" id="ZH-CN_TOPIC_0000002510174377__screen109901038113113" data-highlighted="yes"><ol class="linenums"><li><span class=""><span class="hljs-string">"targets"</span></span><span class="">: </span>[</li><li>  {</li><li>    <span class=""><span class="hljs-string">"name"</span></span><span class="">: </span><span class=""><span class="hljs-string">"default"</span></span><span class="">,</span></li><li>    <span class=""><span class="hljs-string">"applyToProducts"</span></span><span class="">: </span>[</li><li>      <span class=""><span class="hljs-string">"default"</span></span><span class="">,</span></li><li>      <span class=""><span class="hljs-string">"Community"</span></span><span class="">,</span></li><li>      <span class=""><span class="hljs-string">"Ultimate"</span></span></li><li>    ]</li><li>  }<span class="">,</span></li><li>  {</li><li>    <span class=""><span class="hljs-string">"name"</span></span><span class="">: </span><span class=""><span class="hljs-string">"free"</span></span><span class="">,</span></li><li>    <span class=""><span class="hljs-string">"applyToProducts"</span></span><span class="">: </span>[</li><li>      <span class=""><span class="hljs-string">"default"</span></span><span class="">,</span></li><li>      <span class=""><span class="hljs-string">"Community"</span></span></li><li>    ]</li><li>  }<span class="">,</span></li><li>  {</li><li>    <span class=""><span class="hljs-string">"name"</span></span><span class="">: </span><span class=""><span class="hljs-string">"vip"</span></span><span class="">,</span></li><li>    <span class=""><span class="hljs-string">"applyToProducts"</span></span><span class="">: </span>[</li><li>      <span class=""><span class="hljs-string">"default"</span></span><span class="">,</span></li><li>      <span class=""><span class="hljs-string">"Ultimate"</span></span></li><li>    ]</li><li>  }</li><li>]</li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002510174377__p29384321328">由上配置：</p> <ul id="ZH-CN_TOPIC_0000002510174377__ul545921915522"><li id="li12459171912523">target：default被应用至product：default、Ultimate、Community中；</li><li id="li6459201912521">target：vip被应用至product：default、Ultimate中；</li><li id="li145951905212">target：free被应用至product：default、Community中。</li></ul> <p id="ZH-CN_TOPIC_0000002510174377__p11864193214362"></p> <p id="ZH-CN_TOPIC_0000002510174377__p534183315369">4. 在实际构建中，可通过可视化窗口灵活选择product-target的关联关系以构建出需要的APP/HAP包。</p> <p id="ZH-CN_TOPIC_0000002510174377__p152019974119">例：用户需要构建Ultimate版本的且具有vip特性的应用，可以选择product：Ultimate，target：vip，apply之后执行构建。</p> <p id="ZH-CN_TOPIC_0000002510174377__p15260752131519"><span><img originheight="307" originwidth="466" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104918.85194245136056808654994508696399:50001231000000:2800:DE522DC310E99315A608FCF398BF9E50EEC887633F86A368B1091DD15DA3AAB9.png" width="466" height="307"></span></p> <p id="ZH-CN_TOPIC_0000002510174377__p15896132514431">查看构建产物</p> <p id="ZH-CN_TOPIC_0000002510174377__p5349181344114"><span><img originheight="244" originwidth="306" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104918.25464104669643935942710372933933:50001231000000:2800:CD581F63D56905EC0E89950EEE29B6D62FCA68BEA7D5683BEEBF5BF467D58DF6.png" width="306" height="244"></span></p> </div> <div></div></div>