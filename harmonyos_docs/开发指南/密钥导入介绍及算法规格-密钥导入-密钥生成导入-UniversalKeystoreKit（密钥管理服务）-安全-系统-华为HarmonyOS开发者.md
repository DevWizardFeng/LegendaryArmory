<h1 _ngcontent-pev-c119="" class="doc-title ng-star-inserted" title="密钥导入介绍及算法规格"> 密钥导入介绍及算法规格 </h1>

<div _ngcontent-pev-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p>如果业务在HUKS外部生成密钥（比如应用间协商生成、服务器端生成），业务可以将密钥导入到HUKS中由HUKS进行管理。密钥一旦导入到HUKS中，在密钥的生命周期内，其明文仅在安全环境中进行访问操作，不会传递出安全环境。</p>    <p>密钥导入的方式包含明文导入和加密导入两种方式。</p>    <div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content">      <p>使用现有密钥别名作为导入的密钥别名会把现有密钥覆盖。</p>     </div></div></div>    <div class="tiledSection">     <h2 id="明文导入">明文导入<i class="anchor-icon anchor-icon-link" anchorid="明文导入" tips="复制节点链接"></i></h2>          <p>该方式直接将密钥明文导入HUKS，在导入过程中密钥明文会暴露在非安全环境中，一般适用于轻量级智能穿戴或低安业务。</p>     <ul>      <li>       <p>推荐使用该方式导入的密钥类型：非对称密钥的公钥。</p></li>      <li>       <p>不推荐使用该方式导入的密钥类型：对称密钥、非对称密钥对。</p>       <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">         <p>轻量级智能穿戴只支持明文导入，不支持加密导入。</p>        </div></div></div></li>     </ul>    </div>    <div class="tiledSection">     <h2 id="加密导入">加密导入<i class="anchor-icon anchor-icon-link" anchorid="加密导入" tips="复制节点链接"></i></h2>          <p>该方式支持业务与HUKS建立端到端的加密传输通道，将密钥安全加密导入到HUKS中，确保导入传入过程中密钥不被泄露，适用于高安敏感业务。相较于明文导入，加密导入步骤更多，密钥材料更复杂。</p>     <ul>      <li>推荐使用该方式导入的密钥类型：对称密钥、非对称密钥对。</li>     </ul>     <p>下图为加密导入密钥开发时序图。</p>     <p><span><img originheight="631" originwidth="610" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211115058.05402629055924287014533312491995:50001231000000:2800:78C7C74C45EF8A4CAECC58B0BD59F36C0D4DFD256C2ADC28AB505FAAE9EBD859.png" width="610" height="631"></span></p>     <p>根据开发流程，在导入加密密钥过程中，需要依次调用HUKS的能力包括：</p>     <ul>      <li>生成非对称密钥对并导出公钥，用于设备间密钥协商。</li>      <li>生成对称密钥，用于加密待导入密钥。</li>      <li>使用对称密钥加密待导入密钥，形成密钥密文。</li>      <li>导入加密密钥。</li>      <li>删除密钥。</li>     </ul>     <p>导出密钥接口返回的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/huks-concepts#公钥材料格式">公钥明文材料是按照<strong>X.509</strong>格式封装</a>，导入加密密钥接口中的密钥材料需满足<strong>Length<sub>Data</sub>-Data</strong>的格式封装，形如：[(Length<sub>part1</sub>Data<sub>part1</sub>)……(Length<sub>partn</sub>Data<sub>partn</sub>)]。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <ol>        <li>加密导入密钥时，协商算法支持ECDH和X25519，协商后的Shared_Key使用AES-GCM算法加密Caller_Kek。对应算法套件定义见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-huks#huksunwrapsuite9" target="_blank">HuksUnwrapSuite</a>。</li>        <li>加密导入不支持X.509格式。</li>        <li>轻量级智能穿戴只支持明文导入，不支持加密导入。</li>       </ol>      </div></div></div>    </div>    <div class="tiledSection">     <h3 id="加密导入密钥材料格式" class="firsth2">加密导入密钥材料格式<i class="anchor-icon anchor-icon-link" anchorid="加密导入密钥材料格式" tips="复制节点链接"></i></h3>          <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.6.2.1.3.1.1" valign="top" width="50%">内容</th>         <th align="left" class="cellrowborder" id="mcps1.3.6.2.1.3.1.2" valign="top" width="50%">长度</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="50%">业务公钥长度L<sub>Caller_Pk</sub></td>         <td class="cellrowborder" valign="top" width="50%">4字节</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">业务公钥Caller_Pk</td>         <td class="cellrowborder" valign="top" width="50%">L<sub>Caller_Pk</sub>字节</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">Shared_Key加密参数AAD2长度L<sub>AAD2</sub></td>         <td class="cellrowborder" valign="top" width="50%">4字节</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">Shared_Key加密参数AAD2</td>         <td class="cellrowborder" valign="top" width="50%">L<sub>AAD2</sub>字节</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">Shared_Key加密参数NONCE2长度L<sub>NONCE2</sub></td>         <td class="cellrowborder" valign="top" width="50%">4字节</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">Shared_Key加密参数NONCE2</td>         <td class="cellrowborder" valign="top" width="50%">L<sub>NONCE2</sub>字节</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">Shared_Key加密参数TAG2长度L<sub>TAG2</sub></td>         <td class="cellrowborder" valign="top" width="50%">4字节</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">Shared_Key加密参数TAG2</td>         <td class="cellrowborder" valign="top" width="50%">L<sub>TAG2</sub>字节</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">Caller_Kek密文长度L<sub>Caller_Kek_enc</sub></td>         <td class="cellrowborder" valign="top" width="50%">4字节</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">Caller_Kek密文Caller_Kek_enc</td>         <td class="cellrowborder" valign="top" width="50%">L<sub>Caller_Kek_enc</sub>字节</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">Caller_Kek加密参数AAD3长度L<sub>AAD3</sub></td>         <td class="cellrowborder" valign="top" width="50%">4字节</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">Caller_Kek加密参数AAD3</td>         <td class="cellrowborder" valign="top" width="50%">L<sub>AAD3</sub>字节</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">Caller_Kek加密参数NONCE3长度L<sub>NONCE3</sub></td>         <td class="cellrowborder" valign="top" width="50%">4字节</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">Caller_Kek加密参数NONCE3</td>         <td class="cellrowborder" valign="top" width="50%">L<sub>NONCE3</sub>字节</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">Caller_Kek加密参数TAG3长度L<sub>TAG3</sub></td>         <td class="cellrowborder" valign="top" width="50%">4字节</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">Caller_Kek加密参数TAG3</td>         <td class="cellrowborder" valign="top" width="50%">L<sub>TAG3</sub>字节</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">密钥明文材料长度的长度L<sub>To_Import_Key_size</sub></td>         <td class="cellrowborder" valign="top" width="50%">4字节</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">密钥明文材料长度To_Import_Key_size</td>         <td class="cellrowborder" valign="top" width="50%">L<sub>To_Import_Key_size</sub>字节</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">To_Import_Key密文长度L<sub>To_Import_Key_enc</sub></td>         <td class="cellrowborder" valign="top" width="50%">4字节</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">To_Import_Key密文To_Import_Key_enc</td>         <td class="cellrowborder" valign="top" width="50%">L<sub>To_Import_Key_enc</sub>字节</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="支持的算法">支持的算法<i class="anchor-icon anchor-icon-link" anchorid="支持的算法" tips="复制节点链接"></i></h2>          <p>以下为密钥导入支持的规格说明。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>导入RSA密钥时，公钥必须大于或者等于65537。</p>      </div></div></div>     <p><strong>手机、平板、PC/2in1设备、TV、智能穿戴规格</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.7.5.1.4.1.1" valign="top" width="33.33333333333333%">算法</th>         <th align="left" class="cellrowborder" id="mcps1.3.7.5.1.4.1.2" valign="top" width="33.33333333333333%">支持的密钥长度</th>         <th align="left" class="cellrowborder" id="mcps1.3.7.5.1.4.1.3" valign="top" width="33.33333333333333%">API级别</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">AES</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">128、192、256</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">8+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">RSA</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">2048、3072、4096</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">8+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">RSA</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">1024-2048（含），必须是8的倍数</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">18+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">HMAC</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">8-1024（含），必须是8的倍数</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">8+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">ECC</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">256、384、521</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">8+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">ED25519</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">256</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">8+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">X25519</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">256</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">8+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">DH</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">2048</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">8+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">SM2</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">256</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">9+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">SM4</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">128</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">9+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">DES</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">64</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">18+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">3DES</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">128、192</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">18+</td>        </tr>             </tbody></table></div>     </div>     <p><strong>轻量级智能穿戴规格</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.7.7.1.4.1.1" valign="top" width="33.33333333333333%">算法</th>         <th align="left" class="cellrowborder" id="mcps1.3.7.7.1.4.1.2" valign="top" width="33.33333333333333%">支持的密钥长度</th>         <th align="left" class="cellrowborder" id="mcps1.3.7.7.1.4.1.3" valign="top" width="33.33333333333333%">API级别</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">AES</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">128、192、256</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">12+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">DES</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">64</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">12+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">3DES</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">128、192</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">12+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">RSA</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">1024-2048（含），必须是8的倍数</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">12+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">HMAC</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">8-1024（含），必须是8的倍数</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">12+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">CMAC</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">128</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">12+</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="导入密钥格式">导入密钥格式<i class="anchor-icon anchor-icon-link" anchorid="导入密钥格式" tips="复制节点链接"></i></h2>          <p>HUKS支持导入密钥类型众多，各种不同类型对应的密钥格式不尽相同。下表归纳了HUKS导入密钥所支持的密钥类型及对应的密钥材料格式。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.8.3.1.4.1.1" valign="top" width="33.33333333333333%">密钥类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.8.3.1.4.1.2" valign="top" width="33.33333333333333%">算法</th>         <th align="left" class="cellrowborder" id="mcps1.3.8.3.1.4.1.3" valign="top" width="33.33333333333333%">导入格式</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">对称密钥</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">-</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">密钥字节数据</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">非对称密钥-密钥对</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">-</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/huks-concepts#密钥对材料格式">密钥对材料格式</a></td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">非对称密钥-公钥</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">ED25519、X25519</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">密钥字节数据，参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/huks-import-key-in-plaintext-arkts#导入x25519密钥公钥">X25519密钥公钥导入</a></td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">非对称密钥-公钥</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">RSA、ECC、ECDH、DSA、DH、SM2</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">X.509规范的DER格式</td>        </tr>             </tbody></table></div>     </div>    </div>   </div>   <div></div></div>