<h1 _ngcontent-yxu-c119="" class="doc-title ng-star-inserted" title="导航流转至车机"> 导航流转至车机 </h1>

<div _ngcontent-yxu-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <div class="tiledSection">     <h2 id="section5330103214559">场景介绍<i class="anchor-icon anchor-icon-link" anchorid="section5330103214559" tips="复制节点链接"></i></h2>          <p>导航流转至车机包含如下几个常见使用场景：</p>    </div>    <ul>     <li>碰一碰导航流转：用户在手机地图的指定页面中（地图选点页面、规划路线页面、驾车导航页面），与车机中控屏指定区域碰一碰后，将手机上的导航数据流转至车机。      <p><span><img height="204.12042" originheight="301" originwidth="1140" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211115033.27404371822959350381921138833973:50001231000000:2800:1104E780E05FCA2E63F74C8FF046B0C416CE2E6CF3327D4D309BE872D1B231BF.png" title="点击放大" width="773.0625"></span></p></li>     <li>上车导航自动流转：用户使用手机地图应用发起驾车导航后上车，手机上的导航数据会自动流转至车机。      <p><span><img height="172.528664" originheight="264" originwidth="1186" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211115033.52419315641538243485563920428712:50001231000000:2800:0CBB93384DD49DC5073CD279B8546E0A02BD545143D1B1608AA9521B038D04A1.png" title="点击放大" width="775.0575"></span></p></li>     <li>车内导航自动流转：用户在车内，使用手机地图应用发起驾车导航，手机上的导航数据会自动流转至车机。      <p><span><img height="174.23532" originheight="267" originwidth="1183" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211115033.27642333352126840240822795173187:50001231000000:2800:0F7E689E579CE916431A5061A5983455C0A153058964809A809409D8C8392450.png" title="点击放大" width="772.065"></span></p></li>    </ul>    <div class="tiledSection">     <h2 id="section114986314342">接口说明<i class="anchor-icon anchor-icon-link" anchorid="section114986314342" tips="复制节点链接"></i></h2>          <p>导航流转至车机使用接口如下：</p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.3.3.1.3.1.1" valign="top" width="49.74%">          <p>接口名</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.3.3.1.3.1.2" valign="top" width="50.260000000000005%">          <p>描述</p></th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="49.74%">          <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/car-navigationinfomgr#section66695411419" target="_blank">registerSystemNavigationListener</a></p></td>         <td class="cellrowborder" valign="top" width="50.260000000000005%">          <p>注册监听系统导航信息和指令。</p></td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="49.74%">          <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/car-smartmobilitycommon#section10205101163617" target="_blank">on('smartMobilityEvent')</a></p></td>         <td class="cellrowborder" valign="top" width="50.260000000000005%">          <p>注册智慧出行业务的事件监听。</p></td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="49.74%">          <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/car-navigationinfomgr#section126311558181112" target="_blank">updateNavigationStatus</a></p></td>         <td class="cellrowborder" valign="top" width="50.260000000000005%">          <p>设置导航状态，包含地图状态、导航类型、导航目的地、导航途径点、路线和主题等。</p></td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="49.74%">          <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/car-navigationinfomgr#section1567066181615" target="_blank">unregisterSystemNavigationListener</a></p></td>         <td class="cellrowborder" valign="top" width="50.260000000000005%">          <p>取消注册监听系统导航信息和指令。</p></td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="49.74%">          <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/car-smartmobilitycommon#section659872123616" target="_blank">off('smartMobilityEvent')</a></p></td>         <td class="cellrowborder" valign="top" width="50.260000000000005%">          <p>取消注册智慧出行业务的事件监听。</p></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h3 id="section12233163725012" class="firsth2">SmartMobilityEvent事件名说明<i class="anchor-icon anchor-icon-link" anchorid="section12233163725012" tips="复制节点链接"></i></h3>          <p>SmartMobilityEvent事件名（eventName）取值如下：</p>    </div>    <div class="tablenoborder">     <div class="tbBox"><table class="layoutFixed idpTab">      <thead>       <tr>        <th align="left" class="cellrowborder" id="mcps1.3.5.1.3.1.1" valign="top" width="50%">         <p>事件名</p></th>        <th align="left" class="cellrowborder" id="mcps1.3.5.1.3.1.2" valign="top" width="50%">         <p>描述</p></th>       </tr>      </thead>             <tbody><tr>        <td class="cellrowborder" valign="top" width="50%">         <p>hopSucceeded</p></td>        <td class="cellrowborder" valign="top" width="50%">         <p>流转成功事件。</p></td>       </tr>           </tbody></table></div>    </div>    <div class="tiledSection">     <h2 id="section10137434185011">开发流程<i class="anchor-icon anchor-icon-link" anchorid="section10137434185011" tips="复制节点链接"></i></h2>          <p><span><img height="656.831805" originheight="775" originwidth="878" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211115033.19754342744168504819350449216048:50001231000000:2800:D1269F0EC99EAF3DE3A75270965AEB742B14E3507661712D4BDDE457BDD67599.png" title="点击放大" width="744.135"></span></p>    </div>    <div class="tiledSection">     <h2 id="section11638135835610">开发步骤<i class="anchor-icon anchor-icon-link" anchorid="section11638135835610" tips="复制节点链接"></i></h2>          <ol>      <li>能力配置。       <p>请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/car-preparations#section239110365269">能力配置</a>进行配置。导航流转至车机场景下，metadata的name取值为carHopCapability。对应的value值根据不同的使用场景取值如下：</p>       <ul>        <li>碰一碰导航流转场景下，value取值为<strong>carHopNavi</strong>。</li>        <li>上车导航自动流转场景下，value取值为<strong>getOnCarNavi</strong>。</li>        <li>车内导航自动流转场景下，value取值为<strong>insideCarNavi</strong>。</li>       </ul></li>      <li>导入Car Kit相关模块。       <div _ngcontent-yxu-c106="" class="highlight-div"><div _ngcontent-yxu-c106="" class="highlight-div-header"><div _ngcontent-yxu-c106="" class="highlight-div-header-left"><div _ngcontent-yxu-c106="" class="handle-button expand-button"><div _ngcontent-yxu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-yxu-c106="" class="highlight-div-header-right"><div _ngcontent-yxu-c106="" class="handle-button ai-button"></div><div _ngcontent-yxu-c106="" class="handle-button line-button"><div _ngcontent-yxu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-yxu-c106="" class="handle-button theme-button"><div _ngcontent-yxu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-yxu-c106="" class="handle-button copy-button"><div _ngcontent-yxu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-yxu-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { navigationInfoMgr, smartMobilityCommon } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.CarKit'</span>;</li></ol></pre></div></div></li>      <li>监听系统导航信息和指令。       <p>从5.1.0(18)开始，新增searchPOI指令，用于搜索POI信息。</p>       <div class="p">        在打开地图应用时，地图应用需要注册监听系统导航信息和指令，方便地图接收系统指令（如：停止导航）用于对应的业务逻辑处理。        <div _ngcontent-yxu-c106="" class="highlight-div"><div _ngcontent-yxu-c106="" class="highlight-div-header"><div _ngcontent-yxu-c106="" class="highlight-div-header-left"><div _ngcontent-yxu-c106="" class="handle-button expand-button"><div _ngcontent-yxu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-yxu-c106="" class="highlight-div-header-right"><div _ngcontent-yxu-c106="" class="handle-button ai-button"></div><div _ngcontent-yxu-c106="" class="handle-button line-button"><div _ngcontent-yxu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-yxu-c106="" class="handle-button theme-button"><div _ngcontent-yxu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-yxu-c106="" class="handle-button copy-button"><div _ngcontent-yxu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-yxu-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-variable">hilog</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li>
</li><li><span class="hljs-comment">// 实现SystemNavigationListener接口</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Listener</span> <span class="hljs-variable">implements</span> <span class="hljs-variable">navigationInfoMgr</span>.<span class="hljs-variable">SystemNavigationListener</span> {</li><li>  <span class="hljs-comment">// 实现onQueryNavigationInfo方法</span></li><li>  <span class="hljs-title function_">onQueryNavigationInfo</span>(<span class="hljs-variable">query</span>: <span class="hljs-title class_">navigationInfoMgr</span>.<span class="hljs-title class_">QueryType</span>, <span class="hljs-variable">args</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-title class_">string</span>, <span class="hljs-title class_">Object</span>&gt;): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">navigationInfoMgr</span>.<span class="hljs-title class_">ResultData</span>&gt; {</li><li>    <span class="hljs-comment">// 返回导航信息给系统</span></li><li>    <span class="hljs-keyword">return</span> <span class="hljs-variable">new</span> <span class="hljs-title function_">Promise</span>(<span class="hljs-variable">resolve</span> =&gt; {</li><li>      <span class="hljs-keyword">let</span> <span class="hljs-variable">ret</span>: <span class="hljs-title class_">navigationInfoMgr</span>.<span class="hljs-title class_">ResultData</span> = {</li><li>        <span class="hljs-variable">code</span>: <span class="hljs-number">1001</span>,</li><li>        <span class="hljs-variable">message</span>: <span class="hljs-string">'message test1'</span>,</li><li>        <span class="hljs-variable">data</span>: <span class="hljs-title class_">args</span></li><li>      }</li><li>      <span class="hljs-title function_">resolve</span>(<span class="hljs-variable">ret</span>);</li><li>    })</li><li>  }</li><li>
</li><li>  <span class="hljs-comment">// 实现onReceiveNavigationCmd方法</span></li><li>  <span class="hljs-title function_">onReceiveNavigationCmd</span>(<span class="hljs-variable">command</span>: <span class="hljs-title class_">navigationInfoMgr</span>.<span class="hljs-title class_">CommandType</span>, <span class="hljs-variable">args</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-title class_">string</span>, <span class="hljs-title class_">Object</span>&gt;): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">navigationInfoMgr</span>.<span class="hljs-title class_">ResultData</span>&gt; {</li><li>    <span class="hljs-comment">// 接收并处理系统导航指令</span></li><li>    <span class="hljs-keyword">return</span> <span class="hljs-variable">new</span> <span class="hljs-title function_">Promise</span>(<span class="hljs-variable">resolve</span> =&gt; {</li><li>      <span class="hljs-keyword">let</span> <span class="hljs-variable">ret</span>: <span class="hljs-title class_">navigationInfoMgr</span>.<span class="hljs-title class_">ResultData</span> = {</li><li>        <span class="hljs-variable">code</span>: <span class="hljs-number">1002</span>,</li><li>        <span class="hljs-variable">message</span>: <span class="hljs-string">'message test2'</span>,</li><li>        <span class="hljs-variable">data</span>: <span class="hljs-title class_">args</span></li><li>      }</li><li>      <span class="hljs-title function_">resolve</span>(<span class="hljs-variable">ret</span>);</li><li>    })</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-keyword">try</span> {</li><li>  <span class="hljs-comment">// 获取NavigationController实例</span></li><li>  <span class="hljs-keyword">let</span> <span class="hljs-variable">navInfoController</span>: <span class="hljs-title class_">navigationInfoMgr</span>.<span class="hljs-title class_">NavigationController</span> = <span class="hljs-variable">navigationInfoMgr</span>.<span class="hljs-title function_">getNavigationController</span>();</li><li>  <span class="hljs-comment">// 注册监听系统导航信息和指令</span></li><li>  <span class="hljs-variable">navInfoController</span>.<span class="hljs-title function_">registerSystemNavigationListener</span>(<span class="hljs-variable">new</span> <span class="hljs-title function_">Listener</span>());</li><li>} <span class="hljs-keyword">catch</span> (<span class="hljs-variable">e</span>) {</li><li>  <span class="hljs-comment">// 捕获接口调用异常时的错误码并做相应处理</span></li><li>  <span class="hljs-variable">hilog</span>.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, `<span class="hljs-variable">register</span> <span class="hljs-variable">system</span> <span class="hljs-variable">navigation</span> <span class="hljs-variable">listener</span> <span class="hljs-variable">error</span>, <span class="hljs-variable">error</span> <span class="hljs-variable">code</span>: ${<span class="hljs-variable">e</span>?.<span class="hljs-variable">code</span>}`);</li><li>}</li></ol></pre></div></div>       </div></li>      <li>（可选）监听智慧出行业务事件。       <p>地图应用在监听系统导航信息和指令的同时，还可以注册智慧出行业务的事件监听，方便地图应用接收智慧出行业务发送的事件通知（如：流转成功事件），用于对应的业务逻辑处理。</p>       <div _ngcontent-yxu-c106="" class="highlight-div"><div _ngcontent-yxu-c106="" class="highlight-div-header"><div _ngcontent-yxu-c106="" class="highlight-div-header-left"><div _ngcontent-yxu-c106="" class="handle-button expand-button"><div _ngcontent-yxu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-yxu-c106="" class="highlight-div-header-right"><div _ngcontent-yxu-c106="" class="handle-button ai-button"></div><div _ngcontent-yxu-c106="" class="handle-button line-button"><div _ngcontent-yxu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-yxu-c106="" class="handle-button theme-button"><div _ngcontent-yxu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-yxu-c106="" class="handle-button copy-button"><div _ngcontent-yxu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-yxu-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-variable">hilog</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li>
</li><li><span class="hljs-comment">// 业务类型</span></li><li><span class="hljs-keyword">let</span> <span class="hljs-variable">types</span>: <span class="hljs-title class_">smartMobilityCommon</span>.<span class="hljs-title class_">SmartMobilityType</span>[] = [<span class="hljs-variable">smartMobilityCommon</span>.<span class="hljs-variable">SmartMobilityType</span>.<span class="hljs-variable">CAR_HOP</span>];</li><li>
</li><li><span class="hljs-comment">// 智慧出行业务的事件回调函数</span></li><li><span class="hljs-keyword">const</span> <span class="hljs-variable">callBack</span> = (<span class="hljs-variable">event</span>: <span class="hljs-title class_">smartMobilityCommon</span>.<span class="hljs-title class_">SmartMobilityEvent</span>) =&gt; {</li><li>  <span class="hljs-variable">hilog</span>.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">'Received smart mobility event: '</span>, <span class="hljs-variable">JSON</span>.<span class="hljs-title function_">stringify</span>(<span class="hljs-variable">event</span>));</li><li>  <span class="hljs-keyword">if</span> (<span class="hljs-variable">event</span>.<span class="hljs-variable">eventName</span> === <span class="hljs-string">'hopSucceeded'</span> &amp;&amp; <span class="hljs-variable">event</span>.<span class="hljs-keyword">type</span> === <span class="hljs-variable">smartMobilityCommon</span>.<span class="hljs-variable">SmartMobilityType</span>.<span class="hljs-variable">CAR_HOP</span>) {</li><li>    <span class="hljs-comment">// 地图应用处理流转成功事件(如退出导航等)</span></li><li>    <span class="hljs-comment">// ...</span></li><li>  }</li><li>};</li><li>
</li><li><span class="hljs-keyword">try</span> {</li><li>  <span class="hljs-comment">// 获取SmartMobilityAwareness实例</span></li><li>  <span class="hljs-keyword">let</span> <span class="hljs-variable">awareness</span>: <span class="hljs-title class_">smartMobilityCommon</span>.<span class="hljs-title class_">SmartMobilityAwareness</span> = <span class="hljs-variable">smartMobilityCommon</span>.<span class="hljs-title function_">getSmartMobilityAwareness</span>();</li><li>  <span class="hljs-comment">// 注册智慧出行业务的事件监听</span></li><li>  <span class="hljs-variable">awareness</span>.<span class="hljs-title function_">on</span>(<span class="hljs-string">'smartMobilityEvent'</span>, <span class="hljs-variable">types</span>, <span class="hljs-variable">callBack</span>);</li><li>} <span class="hljs-keyword">catch</span> (<span class="hljs-variable">e</span>) {</li><li>  <span class="hljs-comment">// 捕获接口调用异常时的错误码并做相应处理</span></li><li>  <span class="hljs-variable">hilog</span>.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, `<span class="hljs-variable">register</span> <span class="hljs-variable">smart</span> <span class="hljs-variable">mobility</span> <span class="hljs-variable">event</span> <span class="hljs-variable">listener</span> <span class="hljs-variable">error</span>, <span class="hljs-variable">error</span> <span class="hljs-variable">code</span>: ${<span class="hljs-variable">e</span>?.<span class="hljs-variable">code</span>}`);</li><li>}</li></ol></pre></div></div></li>      <li>设置系统导航状态。       <p>用户在地图上每次选择目的地、途经点或者变更导航信息时，地图应用都需要设置导航状态，将当前最新的导航状态保存到Car Kit中，系统会将最新的导航状态数据流转到车机上。</p>       <div _ngcontent-yxu-c106="" class="highlight-div"><div _ngcontent-yxu-c106="" class="highlight-div-header"><div _ngcontent-yxu-c106="" class="highlight-div-header-left"><div _ngcontent-yxu-c106="" class="handle-button expand-button"><div _ngcontent-yxu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-yxu-c106="" class="highlight-div-header-right"><div _ngcontent-yxu-c106="" class="handle-button ai-button"></div><div _ngcontent-yxu-c106="" class="handle-button line-button"><div _ngcontent-yxu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-yxu-c106="" class="handle-button theme-button"><div _ngcontent-yxu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-yxu-c106="" class="handle-button copy-button"><div _ngcontent-yxu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-yxu-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-variable">hilog</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li>
</li><li><span class="hljs-comment">// 设置目的地</span></li><li><span class="hljs-keyword">let</span> <span class="hljs-variable">location</span>: <span class="hljs-title class_">navigationInfoMgr</span>.<span class="hljs-title class_">Location</span> = {</li><li>  <span class="hljs-variable">name</span>: <span class="hljs-string">'location'</span>,</li><li>  <span class="hljs-variable">coordType</span>: <span class="hljs-title class_">navigationInfoMgr</span>.<span class="hljs-title class_">LocationCoordType</span>.<span class="hljs-title class_">GCJ02</span>,</li><li>  <span class="hljs-variable">longitude</span>: <span class="hljs-number">0.000000000000001</span>,</li><li>  <span class="hljs-variable">latitude</span>: <span class="hljs-number">1.000000000000001</span>,</li><li>  <span class="hljs-variable">altitude</span>: <span class="hljs-number">2.000000000000001</span>,</li><li>};</li><li><span class="hljs-comment">// 设置途经点（可选）</span></li><li><span class="hljs-keyword">let</span> <span class="hljs-variable">passPoint0</span>: <span class="hljs-title class_">navigationInfoMgr</span>.<span class="hljs-title class_">Location</span> = {</li><li>  <span class="hljs-variable">name</span>: <span class="hljs-string">'passPoint0'</span>,</li><li>  <span class="hljs-variable">coordType</span>: <span class="hljs-title class_">navigationInfoMgr</span>.<span class="hljs-title class_">LocationCoordType</span>.<span class="hljs-title class_">GCJ02</span>,</li><li>  <span class="hljs-variable">longitude</span>: <span class="hljs-number">29.53851890563965</span>,</li><li>  <span class="hljs-variable">latitude</span>: <span class="hljs-number">16.50643920898438</span>,</li><li>  <span class="hljs-variable">altitude</span>: <span class="hljs-number">3.00015949516846</span>,</li><li>};</li><li><span class="hljs-keyword">let</span> <span class="hljs-variable">passPoint1</span>: <span class="hljs-title class_">navigationInfoMgr</span>.<span class="hljs-title class_">Location</span> = {</li><li>  <span class="hljs-variable">name</span>: <span class="hljs-string">'passPoint1'</span>,</li><li>  <span class="hljs-variable">coordType</span>: <span class="hljs-title class_">navigationInfoMgr</span>.<span class="hljs-title class_">LocationCoordType</span>.<span class="hljs-title class_">WGS84</span>,</li><li>  <span class="hljs-variable">longitude</span>: <span class="hljs-number">4.4445874651238</span>,</li><li>  <span class="hljs-variable">latitude</span>: <span class="hljs-number">5.55565329843751</span>,</li><li>  <span class="hljs-variable">altitude</span>: <span class="hljs-number">6.66641578943265</span>,</li><li>};</li><li><span class="hljs-comment">// 设置导航状态属性</span></li><li><span class="hljs-keyword">let</span> <span class="hljs-variable">navigationStatus</span>: <span class="hljs-title class_">navigationInfoMgr</span>.<span class="hljs-title class_">NavigationStatus</span> = {</li><li>  <span class="hljs-variable">status</span>: <span class="hljs-title class_">navigationInfoMgr</span>.<span class="hljs-title class_">MapStatus</span>.<span class="hljs-title class_">NAVIGATION</span>,</li><li>  <span class="hljs-variable">naviType</span>: <span class="hljs-title class_">navigationInfoMgr</span>.<span class="hljs-title class_">NaviType</span>.<span class="hljs-title class_">DRIVING</span>,</li><li>  <span class="hljs-variable">destLocation</span>: <span class="hljs-title class_">location</span>,</li><li>  <span class="hljs-variable">passPoint</span>: [<span class="hljs-variable">passPoint0</span>, <span class="hljs-variable">passPoint1</span>],</li><li>  <span class="hljs-variable">routeIndex</span>: <span class="hljs-number">101</span>,</li><li>  <span class="hljs-variable">customData</span>: <span class="hljs-string">"customData"</span>,</li><li>  <span class="hljs-variable">routePreference</span>: [</li><li>    <span class="hljs-variable">navigationInfoMgr</span>.<span class="hljs-variable">RoutePreference</span>.<span class="hljs-variable">TIME_FIRST</span>,</li><li>    <span class="hljs-variable">navigationInfoMgr</span>.<span class="hljs-variable">RoutePreference</span>.<span class="hljs-variable">MAIN_ROAD_FIRST</span></li><li>  ],</li><li>  <span class="hljs-variable">theme</span>: <span class="hljs-title class_">navigationInfoMgr</span>.<span class="hljs-title class_">ThemeType</span>.<span class="hljs-title class_">LIGHT</span></li><li>};</li><li>
</li><li><span class="hljs-keyword">try</span> {</li><li>  <span class="hljs-comment">// 获取 NavigationController</span></li><li>  <span class="hljs-keyword">let</span> <span class="hljs-variable">navInfoController</span>: <span class="hljs-title class_">navigationInfoMgr</span>.<span class="hljs-title class_">NavigationController</span> = <span class="hljs-variable">navigationInfoMgr</span>.<span class="hljs-title function_">getNavigationController</span>();</li><li>  <span class="hljs-variable">navInfoController</span>.<span class="hljs-title function_">updateNavigationStatus</span>(<span class="hljs-variable">navigationStatus</span>);</li><li>} <span class="hljs-keyword">catch</span> (<span class="hljs-variable">e</span>) {</li><li>  <span class="hljs-comment">// 捕获接口调用异常时的错误码并做相应处理</span></li><li>  <span class="hljs-variable">hilog</span>.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, `<span class="hljs-variable">update</span> <span class="hljs-variable">navigation</span> <span class="hljs-variable">status</span> <span class="hljs-variable">error</span>, <span class="hljs-variable">error</span> <span class="hljs-variable">code</span>: ${<span class="hljs-variable">e</span>?.<span class="hljs-variable">code</span>}`);</li><li>}</li></ol></pre></div></div></li>      <li>取消监听。       <p>在地图应用退出时，需要取消之前注册的监听，减少系统不必要的资源消耗。</p>       <p>取消注册监听系统导航信息和指令：</p>       <div _ngcontent-yxu-c106="" class="highlight-div"><div _ngcontent-yxu-c106="" class="highlight-div-header"><div _ngcontent-yxu-c106="" class="highlight-div-header-left"><div _ngcontent-yxu-c106="" class="handle-button expand-button"><div _ngcontent-yxu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-yxu-c106="" class="highlight-div-header-right"><div _ngcontent-yxu-c106="" class="handle-button ai-button"></div><div _ngcontent-yxu-c106="" class="handle-button line-button"><div _ngcontent-yxu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-yxu-c106="" class="handle-button theme-button"><div _ngcontent-yxu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-yxu-c106="" class="handle-button copy-button"><div _ngcontent-yxu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-yxu-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li>
</li><li><span class="hljs-keyword">try</span> {</li><li>  <span class="hljs-comment">// 获取NavigationController实例</span></li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">navInfoController</span>: navigationInfoMgr.<span class="hljs-property">NavigationController</span> = navigationInfoMgr.<span class="hljs-title function_">getNavigationController</span>();</li><li>  <span class="hljs-comment">// 取消注册监听系统导航信息和指令</span></li><li>  navInfoController.<span class="hljs-title function_">unregisterSystemNavigationListener</span>();</li><li>} <span class="hljs-keyword">catch</span> (e) {</li><li>  <span class="hljs-comment">// 捕获接口调用异常时的错误码并做相应处理</span></li><li>  hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">`unregister system navigation listener error, error code: <span class="hljs-subst">${e?.code}</span>`</span>);</li><li>}</li></ol></pre></div></div>       <p>取消注册智慧出行业务的事件监听，可以选择下面2种方法中的一种：</p>       <p><strong>方法1</strong>：<strong>不传入callback(可选参数)，会取消该type下的所有监听。</strong></p>       <p>示例代码：</p>       <div _ngcontent-yxu-c106="" class="highlight-div"><div _ngcontent-yxu-c106="" class="highlight-div-header"><div _ngcontent-yxu-c106="" class="highlight-div-header-left"><div _ngcontent-yxu-c106="" class="handle-button expand-button"><div _ngcontent-yxu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-yxu-c106="" class="highlight-div-header-right"><div _ngcontent-yxu-c106="" class="handle-button ai-button"></div><div _ngcontent-yxu-c106="" class="handle-button line-button"><div _ngcontent-yxu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-yxu-c106="" class="handle-button theme-button"><div _ngcontent-yxu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-yxu-c106="" class="handle-button copy-button"><div _ngcontent-yxu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-yxu-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-variable">hilog</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li>
</li><li><span class="hljs-comment">// 业务类型</span></li><li><span class="hljs-keyword">let</span> <span class="hljs-variable">types</span>: <span class="hljs-title class_">smartMobilityCommon</span>.<span class="hljs-title class_">SmartMobilityType</span>[] = [<span class="hljs-variable">smartMobilityCommon</span>.<span class="hljs-variable">SmartMobilityType</span>.<span class="hljs-variable">CAR_HOP</span>];</li><li>
</li><li><span class="hljs-keyword">try</span> {</li><li>  <span class="hljs-comment">// 获取SmartMobilityAwareness实例</span></li><li>  <span class="hljs-keyword">let</span> <span class="hljs-variable">awareness</span>: <span class="hljs-title class_">smartMobilityCommon</span>.<span class="hljs-title class_">SmartMobilityAwareness</span> = <span class="hljs-variable">smartMobilityCommon</span>.<span class="hljs-title function_">getSmartMobilityAwareness</span>();</li><li>  <span class="hljs-comment">// 解注册智慧出行业务的事件监听</span></li><li>  <span class="hljs-variable">awareness</span>.<span class="hljs-title function_">off</span>(<span class="hljs-string">'smartMobilityEvent'</span>, <span class="hljs-variable">types</span>);</li><li>} <span class="hljs-keyword">catch</span> (<span class="hljs-variable">e</span>) {</li><li>  <span class="hljs-comment">// 捕获接口调用异常时的错误码并做相应处理</span></li><li>  <span class="hljs-variable">hilog</span>.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, `<span class="hljs-variable">unregister</span> <span class="hljs-variable">smart</span> <span class="hljs-variable">mobility</span> <span class="hljs-variable">event</span> <span class="hljs-variable">listener</span> <span class="hljs-variable">error</span>, <span class="hljs-variable">error</span> <span class="hljs-variable">code</span>: ${<span class="hljs-variable">e</span>?.<span class="hljs-variable">code</span>}`);</li><li>}</li></ol></pre></div></div>       <p><strong>方法2：</strong><strong>传入callback(可选参数)，会取消指定的监听。</strong></p>       <p>示例代码：</p>       <div _ngcontent-yxu-c106="" class="highlight-div"><div _ngcontent-yxu-c106="" class="highlight-div-header"><div _ngcontent-yxu-c106="" class="highlight-div-header-left"><div _ngcontent-yxu-c106="" class="handle-button expand-button"><div _ngcontent-yxu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-yxu-c106="" class="highlight-div-header-right"><div _ngcontent-yxu-c106="" class="handle-button ai-button"></div><div _ngcontent-yxu-c106="" class="handle-button line-button"><div _ngcontent-yxu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-yxu-c106="" class="handle-button theme-button"><div _ngcontent-yxu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-yxu-c106="" class="handle-button copy-button"><div _ngcontent-yxu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-yxu-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-variable">hilog</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li>
</li><li><span class="hljs-comment">// 业务类型</span></li><li><span class="hljs-keyword">let</span> <span class="hljs-variable">types</span>: <span class="hljs-title class_">smartMobilityCommon</span>.<span class="hljs-title class_">SmartMobilityType</span>[] = [<span class="hljs-variable">smartMobilityCommon</span>.<span class="hljs-variable">SmartMobilityType</span>.<span class="hljs-variable">CAR_HOP</span>];</li><li>
</li><li><span class="hljs-comment">// 智慧出行业务的事件回调函数</span></li><li><span class="hljs-keyword">const</span> <span class="hljs-variable">callBack</span> = (<span class="hljs-variable">event</span>: <span class="hljs-title class_">smartMobilityCommon</span>.<span class="hljs-title class_">SmartMobilityEvent</span>) =&gt; {</li><li>  <span class="hljs-variable">hilog</span>.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">'Received smart mobility event: '</span>, <span class="hljs-variable">JSON</span>.<span class="hljs-title function_">stringify</span>(<span class="hljs-variable">event</span>));</li><li>};</li><li>
</li><li><span class="hljs-keyword">try</span> {</li><li>  <span class="hljs-comment">// 获取SmartMobilityAwareness实例</span></li><li>  <span class="hljs-keyword">let</span> <span class="hljs-variable">awareness</span>: <span class="hljs-title class_">smartMobilityCommon</span>.<span class="hljs-title class_">SmartMobilityAwareness</span> = <span class="hljs-variable">smartMobilityCommon</span>.<span class="hljs-title function_">getSmartMobilityAwareness</span>();</li><li>  <span class="hljs-comment">// 解注册智慧出行业务的事件监听</span></li><li>  <span class="hljs-variable">awareness</span>.<span class="hljs-title function_">off</span>(<span class="hljs-string">'smartMobilityEvent'</span>, <span class="hljs-variable">types</span>, <span class="hljs-variable">callBack</span>);</li><li>} <span class="hljs-keyword">catch</span> (<span class="hljs-variable">e</span>) {</li><li>  <span class="hljs-comment">// 捕获接口调用异常时的错误码并做相应处理</span></li><li>  <span class="hljs-variable">hilog</span>.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, `<span class="hljs-variable">unregister</span> <span class="hljs-variable">smart</span> <span class="hljs-variable">mobility</span> <span class="hljs-variable">event</span> <span class="hljs-variable">listener</span> <span class="hljs-variable">error</span>, <span class="hljs-variable">error</span> <span class="hljs-variable">code</span>: ${<span class="hljs-variable">e</span>?.<span class="hljs-variable">code</span>}`);</li><li>}</li></ol></pre></div></div></li>     </ol>    </div>   </div>   <div></div></div>