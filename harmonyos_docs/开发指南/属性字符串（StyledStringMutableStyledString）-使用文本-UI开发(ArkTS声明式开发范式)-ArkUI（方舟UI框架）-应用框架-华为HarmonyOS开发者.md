<h1 _ngcontent-rbe-c119="" class="doc-title ng-star-inserted" title="属性字符串（StyledString/MutableStyledString）"> 属性字符串（StyledString/MutableStyledString） </h1>

<div _ngcontent-rbe-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p>属性字符串StyledString/MutableStyledString（其中MutableStyledString继承自StyledString，下文统称为StyledString），可用于在字符或段落级别上设置文本样式。将StyledString应用到文本组件上，可以采用多种方式修改文本，包括调整字号、添加字体颜色、使文本具备可点击性，以及通过自定义方式绘制文本等。具体使用方法请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-universal-styled-string" target="_blank">属性字符串</a>的文档。</p>    <p>属性字符串提供多种类型样式对象，涵盖各种常见的文本样式格式，例如文本装饰线样式、文本行高样式、文本阴影样式等。也可以自行创建CustomSpan，以应用自定义样式。</p>    <div class="tiledSection">     <h2 id="创建并应用styledstring和mutablestyledstring">创建并应用StyledString和MutableStyledString<i class="anchor-icon anchor-icon-link" anchorid="创建并应用styledstring和mutablestyledstring" tips="复制节点链接"></i></h2>          <p>可以通过TextController提供的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-basic-components-text#setstyledstring12" target="_blank">setStyledString</a>方法，将属性字符串附加到文本组件，并推荐在<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-custom-component-lifecycle#onpageshow" target="_blank">onPageShow</a>或者文本组件的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-universal-events-show-hide#onappear" target="_blank">onAppear</a>回调中触发绑定。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>在aboutToAppear中调用setStyledString方法时，由于该方法运行阶段组件尚未完成创建并成功挂载节点树，因此无法在页面初始化时显示属性字符串。</p>       <p>从API version 15开始，在aboutToAppear中调用setStyledString方法，页面初始化时可以显示属性字符串。</p>      </div></div></div>     <div _ngcontent-rbe-c106="" class="highlight-div"><div _ngcontent-rbe-c106="" class="highlight-div-header"><div _ngcontent-rbe-c106="" class="highlight-div-header-left"><div _ngcontent-rbe-c106="" class="handle-button expand-button"><div _ngcontent-rbe-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rbe-c106="" class="highlight-div-header-right"><div _ngcontent-rbe-c106="" class="handle-button ai-button"></div><div _ngcontent-rbe-c106="" class="handle-button line-button"><div _ngcontent-rbe-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rbe-c106="" class="handle-button theme-button"><div _ngcontent-rbe-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rbe-c106="" class="handle-button copy-button"><div _ngcontent-rbe-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rbe-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct styled_string_demo1 {</li><li>  <span class="hljs-attr">styledString1</span>: <span class="hljs-title class_">StyledString</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">StyledString</span>(<span class="hljs-string">"运动45分钟"</span>);</li><li>  <span class="hljs-attr">mutableStyledString1</span>: <span class="hljs-title class_">MutableStyledString</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MutableStyledString</span>(<span class="hljs-string">"运动35分钟"</span>);</li><li>  <span class="hljs-attr">controller1</span>: <span class="hljs-title class_">TextController</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextController</span>();</li><li>  <span class="hljs-attr">controller2</span>: <span class="hljs-title class_">TextController</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextController</span>();</li><li>
</li><li>  <span class="hljs-keyword">async</span> <span class="hljs-title function_">onPageShow</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-comment">// 在生命周期onPageShow回调中绑定属性字符串</span></li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller1</span>.<span class="hljs-title function_">setStyledString</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">styledString1</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-comment">// 显示属性字符串</span></li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-literal">undefined</span>, { <span class="hljs-attr">controller</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller1</span> })</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-literal">undefined</span>, { <span class="hljs-attr">controller</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller2</span> })</li><li>        .<span class="hljs-title function_">onAppear</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-comment">// 在组件onAppear回调中绑定属性字符串</span></li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller2</span>.<span class="hljs-title function_">setStyledString</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">mutableStyledString1</span>);</li><li>        })</li><li>    }</li><li>    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div>     <p><span><img originheight="88" originwidth="202" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114850.78161727168825855580556110845828:50001231000000:2800:DECB3E9DAEFDB994F441248D658BC7C01EE1F284020A73FF1999B4AEA9F1A8D8.png" class="notEnlarge" width="202" height="88"></span></p>    </div>    <div class="tiledSection">     <h2 id="设置文本样式">设置文本样式<i class="anchor-icon anchor-icon-link" anchorid="设置文本样式" tips="复制节点链接"></i></h2>          <p>属性字符串目前提供了多种Style对象，包括<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-universal-styled-string#textstyle" target="_blank">TextStyle</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-universal-styled-string#textshadowstyle" target="_blank">TextShadowStyle</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-universal-styled-string#decorationstyle" target="_blank">DecorationStyle</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-universal-styled-string#baselineoffsetstyle" target="_blank">BaselineOffsetStyle</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-universal-styled-string#lineheightstyle" target="_blank">LineHeightStyle</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-universal-styled-string#letterspacingstyle" target="_blank">LetterSpacingStyle</a>，用于设置文本的各类样式。</p>     <ul>      <li>       <p>创建及应用文本字体样式对象（TextStyle）</p>       <div _ngcontent-rbe-c106="" class="highlight-div"><div _ngcontent-rbe-c106="" class="highlight-div-header"><div _ngcontent-rbe-c106="" class="highlight-div-header-left"><div _ngcontent-rbe-c106="" class="handle-button expand-button"><div _ngcontent-rbe-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rbe-c106="" class="highlight-div-header-right"><div _ngcontent-rbe-c106="" class="handle-button ai-button"></div><div _ngcontent-rbe-c106="" class="handle-button line-button"><div _ngcontent-rbe-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rbe-c106="" class="handle-button theme-button"><div _ngcontent-rbe-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rbe-c106="" class="handle-button copy-button"><div _ngcontent-rbe-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rbe-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">LengthMetrics</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct styled_string_demo2 {</li><li>  <span class="hljs-attr">textStyleAttrs</span>: <span class="hljs-title class_">TextStyle</span> =</li><li>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextStyle</span>({ <span class="hljs-attr">fontWeight</span>: <span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bolder</span>, <span class="hljs-attr">fontSize</span>: <span class="hljs-title class_">LengthMetrics</span>.<span class="hljs-title function_">vp</span>(<span class="hljs-number">24</span>), <span class="hljs-attr">fontStyle</span>: <span class="hljs-title class_">FontStyle</span>.<span class="hljs-property">Italic</span>, <span class="hljs-attr">strokeWidth</span>: <span class="hljs-title class_">LengthMetrics</span>.<span class="hljs-title function_">px</span>(<span class="hljs-number">5</span>), <span class="hljs-attr">strokeColor</span>: <span class="hljs-title class_">Color</span>.<span class="hljs-property">Green</span> });</li><li>  <span class="hljs-attr">mutableStyledString</span>: <span class="hljs-title class_">MutableStyledString</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MutableStyledString</span>(<span class="hljs-string">"运动45分钟 目标达成"</span>, [</li><li>    {</li><li>      <span class="hljs-attr">start</span>: <span class="hljs-number">2</span>,</li><li>      <span class="hljs-attr">length</span>: <span class="hljs-number">2</span>,</li><li>      <span class="hljs-attr">styledKey</span>: <span class="hljs-title class_">StyledStringKey</span>.<span class="hljs-property">FONT</span>,</li><li>      <span class="hljs-attr">styledValue</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">textStyleAttrs</span></li><li>    },</li><li>    {</li><li>      <span class="hljs-attr">start</span>: <span class="hljs-number">7</span>,</li><li>      <span class="hljs-attr">length</span>: <span class="hljs-number">4</span>,</li><li>      <span class="hljs-attr">styledKey</span>: <span class="hljs-title class_">StyledStringKey</span>.<span class="hljs-property">FONT</span>,</li><li>      <span class="hljs-attr">styledValue</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextStyle</span>({ <span class="hljs-attr">fontColor</span>: <span class="hljs-title class_">Color</span>.<span class="hljs-property">Orange</span>, <span class="hljs-attr">fontSize</span>: <span class="hljs-title class_">LengthMetrics</span>.<span class="hljs-title function_">vp</span>(<span class="hljs-number">12</span>),</li><li>      <span class="hljs-attr">superscript</span>: <span class="hljs-title class_">SuperscriptStyle</span>.<span class="hljs-property">SUPERSCRIPT</span> })</li><li>    }</li><li>  ]);</li><li>  <span class="hljs-attr">controller</span>: <span class="hljs-title class_">TextController</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextController</span>();</li><li>
</li><li>  <span class="hljs-keyword">async</span> <span class="hljs-title function_">onPageShow</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span>.<span class="hljs-title function_">setStyledString</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">mutableStyledString</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-comment">// 显示属性字符串</span></li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-literal">undefined</span>, { <span class="hljs-attr">controller</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span> })</li><li>        .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">10</span> })</li><li>    }</li><li>    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div>       <p><span><img originheight="62" originwidth="222" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114850.38970410387995451391372175362518:50001231000000:2800:2CD7A0402D87B7FBEBC7C1CFBA39C976420CE307275D3CC9499F795A383461D9.png" class="notEnlarge" width="222" height="62"></span></p></li>      <li>       <p>创建及应用文本阴影对象（TextShadowStyle）</p>       <div _ngcontent-rbe-c106="" class="highlight-div"><div _ngcontent-rbe-c106="" class="highlight-div-header"><div _ngcontent-rbe-c106="" class="highlight-div-header-left"><div _ngcontent-rbe-c106="" class="handle-button expand-button"><div _ngcontent-rbe-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rbe-c106="" class="highlight-div-header-right"><div _ngcontent-rbe-c106="" class="handle-button ai-button"></div><div _ngcontent-rbe-c106="" class="handle-button line-button"><div _ngcontent-rbe-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rbe-c106="" class="handle-button theme-button"><div _ngcontent-rbe-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rbe-c106="" class="handle-button copy-button"><div _ngcontent-rbe-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rbe-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// xxx.ets</span></li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct styled_string_demo3 {</li><li>  <span class="hljs-attr">mutableStyledString</span>: <span class="hljs-title class_">MutableStyledString</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MutableStyledString</span>(<span class="hljs-string">"运动35分钟"</span>, [</li><li>    {</li><li>      <span class="hljs-attr">start</span>: <span class="hljs-number">0</span>,</li><li>      <span class="hljs-attr">length</span>: <span class="hljs-number">3</span>,</li><li>      <span class="hljs-attr">styledKey</span>: <span class="hljs-title class_">StyledStringKey</span>.<span class="hljs-property">TEXT_SHADOW</span>,</li><li>      <span class="hljs-attr">styledValue</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextShadowStyle</span>({</li><li>        <span class="hljs-attr">radius</span>: <span class="hljs-number">5</span>,</li><li>        <span class="hljs-attr">type</span>: <span class="hljs-title class_">ShadowType</span>.<span class="hljs-property">COLOR</span>,</li><li>        <span class="hljs-attr">color</span>: <span class="hljs-title class_">Color</span>.<span class="hljs-property">Red</span>,</li><li>        <span class="hljs-attr">offsetX</span>: <span class="hljs-number">10</span>,</li><li>        <span class="hljs-attr">offsetY</span>: <span class="hljs-number">10</span></li><li>      })</li><li>    }</li><li>  ]);</li><li>  <span class="hljs-attr">controller</span>: <span class="hljs-title class_">TextController</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextController</span>();</li><li>
</li><li>  <span class="hljs-keyword">async</span> <span class="hljs-title function_">onPageShow</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span>.<span class="hljs-title function_">setStyledString</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">mutableStyledString</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-comment">// 显示属性字符串</span></li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-literal">undefined</span>, { <span class="hljs-attr">controller</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span> })</li><li>    }</li><li>    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div>       <p><span><img originheight="42" originwidth="198" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114850.80659390493365120096088549197463:50001231000000:2800:A50B6B494E1B6CABA5EE41CC842A91B7DFD8E54A80946B5D884547EB77E823A9.png" class="notEnlarge" width="198" height="42"></span></p></li>      <li>       <p>创建及应用文本装饰线对象（DecorationStyle）</p>       <div _ngcontent-rbe-c106="" class="highlight-div"><div _ngcontent-rbe-c106="" class="highlight-div-header"><div _ngcontent-rbe-c106="" class="highlight-div-header-left"><div _ngcontent-rbe-c106="" class="handle-button expand-button"><div _ngcontent-rbe-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rbe-c106="" class="highlight-div-header-right"><div _ngcontent-rbe-c106="" class="handle-button ai-button"></div><div _ngcontent-rbe-c106="" class="handle-button line-button"><div _ngcontent-rbe-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rbe-c106="" class="handle-button theme-button"><div _ngcontent-rbe-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rbe-c106="" class="handle-button copy-button"><div _ngcontent-rbe-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rbe-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// xxx.ets</span></li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct styled_string_demo4 {</li><li>  <span class="hljs-attr">mutableStyledString</span>: <span class="hljs-title class_">MutableStyledString</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MutableStyledString</span>(<span class="hljs-string">"运动35分钟"</span>, [</li><li>    {</li><li>      <span class="hljs-attr">start</span>: <span class="hljs-number">0</span>,</li><li>      <span class="hljs-attr">length</span>: <span class="hljs-number">4</span>,</li><li>      <span class="hljs-attr">styledKey</span>: <span class="hljs-title class_">StyledStringKey</span>.<span class="hljs-property">DECORATION</span>,</li><li>      <span class="hljs-attr">styledValue</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">DecorationStyle</span>({ <span class="hljs-attr">type</span>: <span class="hljs-title class_">TextDecorationType</span>.<span class="hljs-property">LineThrough</span>, <span class="hljs-attr">color</span>: <span class="hljs-title class_">Color</span>.<span class="hljs-property">Red</span>, <span class="hljs-attr">thicknessScale</span>: <span class="hljs-number">3</span> })</li><li>    },</li><li>    {</li><li>      <span class="hljs-attr">start</span>: <span class="hljs-number">4</span>,</li><li>      <span class="hljs-attr">length</span>: <span class="hljs-number">2</span>,</li><li>      <span class="hljs-attr">styledKey</span>: <span class="hljs-title class_">StyledStringKey</span>.<span class="hljs-property">DECORATION</span>,</li><li>      <span class="hljs-attr">styledValue</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">DecorationStyle</span>(</li><li>        {</li><li>          <span class="hljs-attr">type</span>: <span class="hljs-title class_">TextDecorationType</span>.<span class="hljs-property">Underline</span>,</li><li>        },</li><li>        {</li><li>          <span class="hljs-comment">// 开启多装饰线</span></li><li>          <span class="hljs-attr">enableMultiType</span>: <span class="hljs-literal">true</span></li><li>        }</li><li>      )</li><li>    },</li><li>    {</li><li>      <span class="hljs-attr">start</span>: <span class="hljs-number">4</span>,</li><li>      <span class="hljs-attr">length</span>: <span class="hljs-number">2</span>,</li><li>      <span class="hljs-attr">styledKey</span>: <span class="hljs-title class_">StyledStringKey</span>.<span class="hljs-property">DECORATION</span>,</li><li>      <span class="hljs-attr">styledValue</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">DecorationStyle</span>(</li><li>        {</li><li>          <span class="hljs-attr">type</span>: <span class="hljs-title class_">TextDecorationType</span>.<span class="hljs-property">LineThrough</span>,</li><li>        },</li><li>        {</li><li>          <span class="hljs-comment">// 开启多装饰线</span></li><li>          <span class="hljs-attr">enableMultiType</span>: <span class="hljs-literal">true</span></li><li>        }</li><li>      )</li><li>    },</li><li>  ]);</li><li>  <span class="hljs-attr">controller</span>: <span class="hljs-title class_">TextController</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextController</span>();</li><li>
</li><li>  <span class="hljs-keyword">async</span> <span class="hljs-title function_">onPageShow</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span>.<span class="hljs-title function_">setStyledString</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">mutableStyledString</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-comment">// 显示属性字符串</span></li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-literal">undefined</span>, { <span class="hljs-attr">controller</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span> })</li><li>    }</li><li>    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div>       <p><span><img originheight="50" originwidth="194" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114850.03348455950701562708788464147534:50001231000000:2800:9879B6E6252012627EEC769477636F3F032EA6CF8AA4F8F2CD37DB887C9697E8.jpg" class="notEnlarge" width="194" height="50"></span></p></li>      <li>       <p>创建及应用文本基线偏移量对象（BaselineOffsetStyle）</p>       <div _ngcontent-rbe-c106="" class="highlight-div"><div _ngcontent-rbe-c106="" class="highlight-div-header"><div _ngcontent-rbe-c106="" class="highlight-div-header-left"><div _ngcontent-rbe-c106="" class="handle-button expand-button"><div _ngcontent-rbe-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rbe-c106="" class="highlight-div-header-right"><div _ngcontent-rbe-c106="" class="handle-button ai-button"></div><div _ngcontent-rbe-c106="" class="handle-button line-button"><div _ngcontent-rbe-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rbe-c106="" class="handle-button theme-button"><div _ngcontent-rbe-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rbe-c106="" class="handle-button copy-button"><div _ngcontent-rbe-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rbe-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">LengthMetrics</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span>;</li><li>
</li><li><span class="hljs-comment">// xxx.ets</span></li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct styled_string_demo5 {</li><li>  <span class="hljs-attr">mutableStyledString</span>: <span class="hljs-title class_">MutableStyledString</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MutableStyledString</span>(<span class="hljs-string">"运动35分钟"</span>, [</li><li>    {</li><li>      <span class="hljs-attr">start</span>: <span class="hljs-number">0</span>,</li><li>      <span class="hljs-attr">length</span>: <span class="hljs-number">3</span>,</li><li>      <span class="hljs-attr">styledKey</span>: <span class="hljs-title class_">StyledStringKey</span>.<span class="hljs-property">BASELINE_OFFSET</span>,</li><li>      <span class="hljs-attr">styledValue</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">BaselineOffsetStyle</span>(<span class="hljs-title class_">LengthMetrics</span>.<span class="hljs-title function_">px</span>(<span class="hljs-number">20</span>))</li><li>    }</li><li>  ]);</li><li>  <span class="hljs-attr">controller</span>: <span class="hljs-title class_">TextController</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextController</span>();</li><li>
</li><li>  <span class="hljs-keyword">async</span> <span class="hljs-title function_">onPageShow</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span>.<span class="hljs-title function_">setStyledString</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">mutableStyledString</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-comment">// 显示属性字符串</span></li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-literal">undefined</span>, { <span class="hljs-attr">controller</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span> })</li><li>    }</li><li>    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div>       <p><span><img originheight="67" originwidth="195" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114850.60351252311368824882204796287446:50001231000000:2800:9296DB9465DA768FB064B5715F575AFF6B30C06E53992D5AF5208ECB1FDD78F5.png" class="notEnlarge" width="195" height="67"></span></p></li>      <li>       <p>创建及应用文本行高对象（LineHeightStyle）</p>       <div _ngcontent-rbe-c106="" class="highlight-div"><div _ngcontent-rbe-c106="" class="highlight-div-header"><div _ngcontent-rbe-c106="" class="highlight-div-header-left"><div _ngcontent-rbe-c106="" class="handle-button expand-button"><div _ngcontent-rbe-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rbe-c106="" class="highlight-div-header-right"><div _ngcontent-rbe-c106="" class="handle-button ai-button"></div><div _ngcontent-rbe-c106="" class="handle-button line-button"><div _ngcontent-rbe-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rbe-c106="" class="handle-button theme-button"><div _ngcontent-rbe-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rbe-c106="" class="handle-button copy-button"><div _ngcontent-rbe-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rbe-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">LengthMetrics</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span>;</li><li>
</li><li><span class="hljs-comment">// xxx.ets</span></li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct styled_string_demo6 {</li><li>  <span class="hljs-attr">mutableStyledString</span>: <span class="hljs-title class_">MutableStyledString</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MutableStyledString</span>(<span class="hljs-string">"运动35分钟\n顶顶顶\n得到"</span>, [</li><li>    {</li><li>      <span class="hljs-attr">start</span>: <span class="hljs-number">8</span>,</li><li>      <span class="hljs-attr">length</span>: <span class="hljs-number">3</span>,</li><li>      <span class="hljs-attr">styledKey</span>: <span class="hljs-title class_">StyledStringKey</span>.<span class="hljs-property">LINE_HEIGHT</span>,</li><li>      <span class="hljs-attr">styledValue</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">LineHeightStyle</span>(<span class="hljs-title class_">LengthMetrics</span>.<span class="hljs-title function_">vp</span>(<span class="hljs-number">50</span>))</li><li>    }</li><li>  ]);</li><li>  <span class="hljs-attr">controller</span>: <span class="hljs-title class_">TextController</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextController</span>();</li><li>
</li><li>  <span class="hljs-keyword">async</span> <span class="hljs-title function_">onPageShow</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span>.<span class="hljs-title function_">setStyledString</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">mutableStyledString</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-comment">// 显示属性字符串</span></li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-literal">undefined</span>, { <span class="hljs-attr">controller</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span> })</li><li>    }</li><li>    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">10</span> })</li><li>  }</li><li>}</li></ol></pre></div></div>       <p><span><img originheight="168" originwidth="320" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114850.74324368741014241872007405643096:50001231000000:2800:67B374281E82C1F7869037F22884DCDF19B63D98CF87CA1FA4D781CAA6688800.png" width="320" height="168"></span></p></li>      <li>       <p>创建及应用文本字符间距对象（LetterSpacingStyle）</p>       <div _ngcontent-rbe-c106="" class="highlight-div"><div _ngcontent-rbe-c106="" class="highlight-div-header"><div _ngcontent-rbe-c106="" class="highlight-div-header-left"><div _ngcontent-rbe-c106="" class="handle-button expand-button"><div _ngcontent-rbe-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rbe-c106="" class="highlight-div-header-right"><div _ngcontent-rbe-c106="" class="handle-button ai-button"></div><div _ngcontent-rbe-c106="" class="handle-button line-button"><div _ngcontent-rbe-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rbe-c106="" class="handle-button theme-button"><div _ngcontent-rbe-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rbe-c106="" class="handle-button copy-button"><div _ngcontent-rbe-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rbe-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">LengthMetrics</span>, <span class="hljs-title class_">LengthUnit</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span>;</li><li>
</li><li><span class="hljs-comment">// xxx.ets</span></li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct styled_string_demo7 {</li><li>  <span class="hljs-attr">mutableStyledString</span>: <span class="hljs-title class_">MutableStyledString</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MutableStyledString</span>(<span class="hljs-string">"运动35分钟"</span>, [</li><li>    {</li><li>      <span class="hljs-attr">start</span>: <span class="hljs-number">0</span>,</li><li>      <span class="hljs-attr">length</span>: <span class="hljs-number">2</span>,</li><li>      <span class="hljs-attr">styledKey</span>: <span class="hljs-title class_">StyledStringKey</span>.<span class="hljs-property">LETTER_SPACING</span>,</li><li>      <span class="hljs-attr">styledValue</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">LetterSpacingStyle</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">LengthMetrics</span>(<span class="hljs-number">20</span>, <span class="hljs-title class_">LengthUnit</span>.<span class="hljs-property">VP</span>))</li><li>    }</li><li>  ]);</li><li>  <span class="hljs-attr">controller</span>: <span class="hljs-title class_">TextController</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextController</span>();</li><li>
</li><li>  <span class="hljs-keyword">async</span> <span class="hljs-title function_">onPageShow</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span>.<span class="hljs-title function_">setStyledString</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">mutableStyledString</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-comment">// 显示属性字符串</span></li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-literal">undefined</span>, { <span class="hljs-attr">controller</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span> })</li><li>    }</li><li>    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div>       <p><span><img originheight="47" originwidth="147" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114850.18094249817414866577812791599485:50001231000000:2800:D8D371D538FAA14F5F0DC6DEEB66E7CF855FFE307B4357AAAA8F66A5A651DF12.png" class="notEnlarge" width="147" height="47"></span></p></li>     </ul>    </div>    <div class="tiledSection">     <h2 id="设置段落样式">设置段落样式<i class="anchor-icon anchor-icon-link" anchorid="设置段落样式" tips="复制节点链接"></i></h2>          <p>可通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-universal-styled-string#paragraphstyle" target="_blank">ParagraphStyle</a>设置段落样式布局。下图显示了如何分割文本中的段落，段落以换行符 \n 结尾。</p>     <p><span><img originheight="204" originwidth="451" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114850.02713144924350099164867146191924:50001231000000:2800:C607AAE562FF9B5F3F483B9CB3379E298C076069A611118AA8B50E30F972AC89.png" width="451" height="204"></span></p>     <p>以下代码示例展示了如何创建ParagraphStyle并应用。如果将ParagraphStyle附加到段落开头、末尾或之间的任何位置，均会应用样式，非段落区间内则不会应用样式。</p>     <div _ngcontent-rbe-c106="" class="highlight-div"><div _ngcontent-rbe-c106="" class="highlight-div-header"><div _ngcontent-rbe-c106="" class="highlight-div-header-left"><div _ngcontent-rbe-c106="" class="handle-button expand-button"><div _ngcontent-rbe-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rbe-c106="" class="highlight-div-header-right"><div _ngcontent-rbe-c106="" class="handle-button ai-button"></div><div _ngcontent-rbe-c106="" class="handle-button line-button"><div _ngcontent-rbe-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rbe-c106="" class="handle-button theme-button"><div _ngcontent-rbe-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rbe-c106="" class="handle-button copy-button"><div _ngcontent-rbe-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rbe-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">LengthMetrics</span>} <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span>;</li><li>
</li><li><span class="hljs-comment">// xxx.ets</span></li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-attr">titleParagraphStyleAttr</span>: <span class="hljs-title class_">ParagraphStyle</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ParagraphStyle</span>({ <span class="hljs-attr">textAlign</span>: <span class="hljs-title class_">TextAlign</span>.<span class="hljs-property">Center</span> });</li><li>  <span class="hljs-comment">// 段落首行缩进15vp</span></li><li>  <span class="hljs-attr">paragraphStyleAttr1</span>: <span class="hljs-title class_">ParagraphStyle</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ParagraphStyle</span>({ <span class="hljs-attr">textIndent</span>: <span class="hljs-title class_">LengthMetrics</span>.<span class="hljs-title function_">vp</span>(<span class="hljs-number">15</span>) });</li><li>  <span class="hljs-comment">// 行高样式对象</span></li><li>  <span class="hljs-attr">lineHeightStyle1</span>: <span class="hljs-title class_">LineHeightStyle</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LineHeightStyle</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">LengthMetrics</span>(<span class="hljs-number">24</span>));</li><li>  <span class="hljs-comment">// 创建含段落样式的对象paragraphStyledString1</span></li><li>  <span class="hljs-attr">paragraphStyledString1</span>: <span class="hljs-title class_">MutableStyledString</span> =</li><li>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">MutableStyledString</span>(<span class="hljs-string">"段落标题\n正文第一段落开始0123456789正文第一段落结束。"</span>, [</li><li>      {</li><li>        <span class="hljs-attr">start</span>: <span class="hljs-number">0</span>,</li><li>        <span class="hljs-attr">length</span>: <span class="hljs-number">4</span>,</li><li>        <span class="hljs-attr">styledKey</span>: <span class="hljs-title class_">StyledStringKey</span>.<span class="hljs-property">PARAGRAPH_STYLE</span>,</li><li>        <span class="hljs-attr">styledValue</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">titleParagraphStyleAttr</span></li><li>      },</li><li>      {</li><li>        <span class="hljs-attr">start</span>: <span class="hljs-number">0</span>,</li><li>        <span class="hljs-attr">length</span>: <span class="hljs-number">4</span>,</li><li>        <span class="hljs-attr">styledKey</span>: <span class="hljs-title class_">StyledStringKey</span>.<span class="hljs-property">LINE_HEIGHT</span>,</li><li>        <span class="hljs-attr">styledValue</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">LineHeightStyle</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">LengthMetrics</span>(<span class="hljs-number">50</span>))</li><li>      }, {</li><li>      <span class="hljs-attr">start</span>: <span class="hljs-number">0</span>,</li><li>      <span class="hljs-attr">length</span>: <span class="hljs-number">4</span>,</li><li>      <span class="hljs-attr">styledKey</span>: <span class="hljs-title class_">StyledStringKey</span>.<span class="hljs-property">FONT</span>,</li><li>      <span class="hljs-attr">styledValue</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextStyle</span>({ <span class="hljs-attr">fontSize</span>: <span class="hljs-title class_">LengthMetrics</span>.<span class="hljs-title function_">vp</span>(<span class="hljs-number">24</span>), <span class="hljs-attr">fontWeight</span>: <span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bolder</span> })</li><li>    },</li><li>      {</li><li>        <span class="hljs-attr">start</span>: <span class="hljs-number">5</span>,</li><li>        <span class="hljs-attr">length</span>: <span class="hljs-number">3</span>,</li><li>        <span class="hljs-attr">styledKey</span>: <span class="hljs-title class_">StyledStringKey</span>.<span class="hljs-property">PARAGRAPH_STYLE</span>,</li><li>        <span class="hljs-attr">styledValue</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">paragraphStyleAttr1</span></li><li>      },</li><li>      {</li><li>        <span class="hljs-attr">start</span>: <span class="hljs-number">5</span>,</li><li>        <span class="hljs-attr">length</span>: <span class="hljs-number">20</span>,</li><li>        <span class="hljs-attr">styledKey</span>: <span class="hljs-title class_">StyledStringKey</span>.<span class="hljs-property">LINE_HEIGHT</span>,</li><li>        <span class="hljs-attr">styledValue</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">lineHeightStyle1</span></li><li>      }</li><li>    ]);</li><li>  <span class="hljs-attr">controller</span>: <span class="hljs-title class_">TextController</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextController</span>();</li><li>
</li><li>  <span class="hljs-keyword">async</span> <span class="hljs-title function_">onPageShow</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span>.<span class="hljs-title function_">setStyledString</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">paragraphStyledString1</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-comment">// 显示属性字符串</span></li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-literal">undefined</span>, { <span class="hljs-attr">controller</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span> })</li><li>    }</li><li>    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div>     <p><span><img originheight="107" originwidth="411" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114850.54644121742366771512262877807467:50001231000000:2800:B3822D84466A2BEE5D7F83F976AF70996033DAEC5E40F86E1F3AAB3CE52636CF.png" width="411" height="107"></span></p>     <p>除了可以在创建属性字符串时就预设样式，也可以后续通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-universal-styled-string#replacestyle" target="_blank">replaceStyle</a>清空原样式替换新样式，同时需要在附加的文本组件controller上主动触发更新绑定的属性字符串。</p>     <div _ngcontent-rbe-c106="" class="highlight-div"><div _ngcontent-rbe-c106="" class="highlight-div-header"><div _ngcontent-rbe-c106="" class="highlight-div-header-left"><div _ngcontent-rbe-c106="" class="handle-button expand-button"><div _ngcontent-rbe-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rbe-c106="" class="highlight-div-header-right"><div _ngcontent-rbe-c106="" class="handle-button ai-button"></div><div _ngcontent-rbe-c106="" class="handle-button line-button"><div _ngcontent-rbe-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rbe-c106="" class="handle-button theme-button"><div _ngcontent-rbe-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rbe-c106="" class="handle-button copy-button"><div _ngcontent-rbe-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rbe-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">LengthMetrics</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span>;</li><li>
</li><li><span class="hljs-comment">// xxx.ets</span></li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-attr">titleParagraphStyleAttr</span>: <span class="hljs-title class_">ParagraphStyle</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ParagraphStyle</span>({ <span class="hljs-attr">textAlign</span>: <span class="hljs-title class_">TextAlign</span>.<span class="hljs-property">Center</span> });</li><li>  <span class="hljs-comment">// 段落首行缩进15vp</span></li><li>  <span class="hljs-attr">paragraphStyleAttr1</span>: <span class="hljs-title class_">ParagraphStyle</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ParagraphStyle</span>({ <span class="hljs-attr">textIndent</span>: <span class="hljs-title class_">LengthMetrics</span>.<span class="hljs-title function_">vp</span>(<span class="hljs-number">15</span>) });</li><li>  <span class="hljs-comment">// 行高样式对象</span></li><li>  <span class="hljs-attr">lineHeightStyle1</span>: <span class="hljs-title class_">LineHeightStyle</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LineHeightStyle</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">LengthMetrics</span>(<span class="hljs-number">24</span>));</li><li>  <span class="hljs-comment">// 创建含段落样式的对象paragraphStyledString1</span></li><li>  <span class="hljs-attr">paragraphStyledString1</span>: <span class="hljs-title class_">MutableStyledString</span> =</li><li>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">MutableStyledString</span>(<span class="hljs-string">"段落标题\n正文第一段落开始0123456789正文第一段落结束，通过replaceStyle清空原样式替换新样式。"</span>, [</li><li>      {</li><li>        <span class="hljs-attr">start</span>: <span class="hljs-number">0</span>,</li><li>        <span class="hljs-attr">length</span>: <span class="hljs-number">4</span>,</li><li>        <span class="hljs-attr">styledKey</span>: <span class="hljs-title class_">StyledStringKey</span>.<span class="hljs-property">PARAGRAPH_STYLE</span>,</li><li>        <span class="hljs-attr">styledValue</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">titleParagraphStyleAttr</span></li><li>      },</li><li>      {</li><li>        <span class="hljs-attr">start</span>: <span class="hljs-number">0</span>,</li><li>        <span class="hljs-attr">length</span>: <span class="hljs-number">4</span>,</li><li>        <span class="hljs-attr">styledKey</span>: <span class="hljs-title class_">StyledStringKey</span>.<span class="hljs-property">LINE_HEIGHT</span>,</li><li>        <span class="hljs-attr">styledValue</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">LineHeightStyle</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">LengthMetrics</span>(<span class="hljs-number">50</span>))</li><li>      }, {</li><li>      <span class="hljs-attr">start</span>: <span class="hljs-number">0</span>,</li><li>      <span class="hljs-attr">length</span>: <span class="hljs-number">4</span>,</li><li>      <span class="hljs-attr">styledKey</span>: <span class="hljs-title class_">StyledStringKey</span>.<span class="hljs-property">FONT</span>,</li><li>      <span class="hljs-attr">styledValue</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextStyle</span>({ <span class="hljs-attr">fontSize</span>: <span class="hljs-title class_">LengthMetrics</span>.<span class="hljs-title function_">vp</span>(<span class="hljs-number">24</span>), <span class="hljs-attr">fontWeight</span>: <span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bolder</span> })</li><li>    },</li><li>      {</li><li>        <span class="hljs-attr">start</span>: <span class="hljs-number">5</span>,</li><li>        <span class="hljs-attr">length</span>: <span class="hljs-number">3</span>,</li><li>        <span class="hljs-attr">styledKey</span>: <span class="hljs-title class_">StyledStringKey</span>.<span class="hljs-property">PARAGRAPH_STYLE</span>,</li><li>        <span class="hljs-attr">styledValue</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">paragraphStyleAttr1</span></li><li>      },</li><li>      {</li><li>        <span class="hljs-attr">start</span>: <span class="hljs-number">5</span>,</li><li>        <span class="hljs-attr">length</span>: <span class="hljs-number">20</span>,</li><li>        <span class="hljs-attr">styledKey</span>: <span class="hljs-title class_">StyledStringKey</span>.<span class="hljs-property">LINE_HEIGHT</span>,</li><li>        <span class="hljs-attr">styledValue</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">lineHeightStyle1</span></li><li>      }</li><li>    ]);</li><li>  <span class="hljs-attr">paragraphStyleAttr3</span>: <span class="hljs-title class_">ParagraphStyle</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ParagraphStyle</span>({</li><li>    <span class="hljs-attr">textAlign</span>: <span class="hljs-title class_">TextAlign</span>.<span class="hljs-property">End</span>,</li><li>    <span class="hljs-attr">maxLines</span>: <span class="hljs-number">1</span>,</li><li>    <span class="hljs-attr">wordBreak</span>: <span class="hljs-title class_">WordBreak</span>.<span class="hljs-property">BREAK_ALL</span>,</li><li>    <span class="hljs-attr">overflow</span>: <span class="hljs-title class_">TextOverflow</span>.<span class="hljs-property">Ellipsis</span></li><li>  });</li><li>  <span class="hljs-attr">controller</span>: <span class="hljs-title class_">TextController</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextController</span>();</li><li>
</li><li>  <span class="hljs-keyword">async</span> <span class="hljs-title function_">onPageShow</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span>.<span class="hljs-title function_">setStyledString</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">paragraphStyledString1</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-comment">// 显示属性字符串</span></li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-literal">undefined</span>, { <span class="hljs-attr">controller</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span> }).<span class="hljs-title function_">width</span>(<span class="hljs-number">300</span>)</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'替换段落样式'</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">paragraphStyledString1</span>.<span class="hljs-title function_">replaceStyle</span>({</li><li>            <span class="hljs-attr">start</span>: <span class="hljs-number">5</span>,</li><li>            <span class="hljs-attr">length</span>: <span class="hljs-number">3</span>,</li><li>            <span class="hljs-attr">styledKey</span>: <span class="hljs-title class_">StyledStringKey</span>.<span class="hljs-property">PARAGRAPH_STYLE</span>,</li><li>            <span class="hljs-attr">styledValue</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">paragraphStyleAttr3</span></li><li>          });</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span>.<span class="hljs-title function_">setStyledString</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">paragraphStyledString1</span>);</li><li>        })</li><li>    }</li><li>    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div>     <p><span><img originheight="163" originwidth="436" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114850.56447796355155439226983521545971:50001231000000:2800:062471E958CAB44870C3A6CFBD97E7B40D6BC1084374479D8D0CA5783A2D89B8.gif" width="436" height="163"></span></p>    </div>    <div class="tiledSection">     <h2 id="支持将属性字符串转换成paragraph">支持将属性字符串转换成Paragraph<i class="anchor-icon anchor-icon-link" anchorid="支持将属性字符串转换成paragraph" tips="复制节点链接"></i></h2>          <p>可通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-uicontext-measureutils#getparagraphs20" target="_blank">getParagraphs</a>将属性字符串根据文本布局选项转换成对应的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-graphics-text#paragraph" target="_blank">Paragraph</a>数组。</p>     <ul>      <li>       <p>以下示例展示了通过MeasureUtils的getParagraphs方法测算文本，当内容超出最大显示行数的时候，截断文本显示并展示“...全文”的效果。</p>       <div _ngcontent-rbe-c106="" class="highlight-div"><div _ngcontent-rbe-c106="" class="highlight-div-header"><div _ngcontent-rbe-c106="" class="highlight-div-header-left"><div _ngcontent-rbe-c106="" class="handle-button expand-button"><div _ngcontent-rbe-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rbe-c106="" class="highlight-div-header-right"><div _ngcontent-rbe-c106="" class="handle-button ai-button"></div><div _ngcontent-rbe-c106="" class="handle-button line-button"><div _ngcontent-rbe-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rbe-c106="" class="handle-button theme-button"><div _ngcontent-rbe-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rbe-c106="" class="handle-button copy-button"><div _ngcontent-rbe-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rbe-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">LengthMetrics</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span>;</li><li><span class="hljs-keyword">import</span> { drawing } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkGraphics2D'</span>;</li><li>
</li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyCustomSpan</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">CustomSpan</span> {</li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">word: <span class="hljs-built_in">string</span>, width: <span class="hljs-built_in">number</span>, height: <span class="hljs-built_in">number</span>, context: UIContext</span>) {</li><li>    <span class="hljs-variable language_">super</span>();</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">word</span> = word;</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">width</span> = width;</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">height</span> = height;</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span> = context;</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">onMeasure</span>(<span class="hljs-attr">measureInfo</span>: <span class="hljs-title class_">CustomSpanMeasureInfo</span>): <span class="hljs-title class_">CustomSpanMetrics</span> {</li><li>    <span class="hljs-keyword">return</span> { <span class="hljs-attr">width</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">width</span>, <span class="hljs-attr">height</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">height</span> };</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">onDraw</span>(<span class="hljs-params">context: DrawContext, options: CustomSpanDrawInfo</span>) {</li><li>    <span class="hljs-keyword">let</span> canvas = context.<span class="hljs-property">canvas</span>;</li><li>    <span class="hljs-keyword">const</span> brush = <span class="hljs-keyword">new</span> drawing.<span class="hljs-title class_">Brush</span>();</li><li>    brush.<span class="hljs-title function_">setColor</span>({</li><li>      <span class="hljs-attr">alpha</span>: <span class="hljs-number">255</span>,</li><li>      <span class="hljs-attr">red</span>: <span class="hljs-number">0</span>,</li><li>      <span class="hljs-attr">green</span>: <span class="hljs-number">74</span>,</li><li>      <span class="hljs-attr">blue</span>: <span class="hljs-number">175</span></li><li>    });</li><li>    <span class="hljs-keyword">const</span> font = <span class="hljs-keyword">new</span> drawing.<span class="hljs-title class_">Font</span>();</li><li>    font.<span class="hljs-title function_">setSize</span>(<span class="hljs-number">25</span>);</li><li>    <span class="hljs-keyword">const</span> textBlob = drawing.<span class="hljs-property">TextBlob</span>.<span class="hljs-title function_">makeFromString</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">word</span>, font, drawing.<span class="hljs-property">TextEncoding</span>.<span class="hljs-property">TEXT_ENCODING_UTF8</span>);</li><li>    canvas.<span class="hljs-title function_">attachBrush</span>(brush);</li><li>    canvas.<span class="hljs-title function_">drawRect</span>({</li><li>      <span class="hljs-attr">left</span>: options.<span class="hljs-property">x</span> + <span class="hljs-number">10</span>,</li><li>      <span class="hljs-attr">right</span>: options.<span class="hljs-property">x</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">vp2px</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">width</span>) - <span class="hljs-number">10</span>,</li><li>      <span class="hljs-attr">top</span>: options.<span class="hljs-property">lineTop</span> + <span class="hljs-number">10</span>,</li><li>      <span class="hljs-attr">bottom</span>: options.<span class="hljs-property">lineBottom</span> - <span class="hljs-number">10</span></li><li>    });</li><li>    brush.<span class="hljs-title function_">setColor</span>({</li><li>      <span class="hljs-attr">alpha</span>: <span class="hljs-number">255</span>,</li><li>      <span class="hljs-attr">red</span>: <span class="hljs-number">23</span>,</li><li>      <span class="hljs-attr">green</span>: <span class="hljs-number">169</span>,</li><li>      <span class="hljs-attr">blue</span>: <span class="hljs-number">141</span></li><li>    });</li><li>    canvas.<span class="hljs-title function_">attachBrush</span>(brush);</li><li>    canvas.<span class="hljs-title function_">drawTextBlob</span>(textBlob, options.<span class="hljs-property">x</span> + <span class="hljs-number">20</span>, options.<span class="hljs-property">lineBottom</span> - <span class="hljs-number">15</span>);</li><li>    canvas.<span class="hljs-title function_">detachBrush</span>();</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">setWord</span>(<span class="hljs-params">word: <span class="hljs-built_in">string</span></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">word</span> = word;</li><li>  }</li><li>
</li><li>  <span class="hljs-attr">width</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">160</span>;</li><li>  <span class="hljs-attr">word</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">"drawing"</span>;</li><li>  <span class="hljs-attr">height</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">10</span>;</li><li>  <span class="hljs-attr">context</span>: <span class="hljs-title class_">UIContext</span>;</li><li>}</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-attr">str</span>: <span class="hljs-built_in">string</span> =</li><li>    <span class="hljs-string">"Four score and seven years ago our fathers brought forth on this continent, a new nation, conceived in Liberty, and dedicated to the proposition that all men are created equal."</span>;</li><li>  mutableStr2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MutableStyledString</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">str</span>, [</li><li>    {</li><li>      <span class="hljs-attr">start</span>: <span class="hljs-number">0</span>,</li><li>      <span class="hljs-attr">length</span>: <span class="hljs-number">3</span>,</li><li>      <span class="hljs-attr">styledKey</span>: <span class="hljs-title class_">StyledStringKey</span>.<span class="hljs-property">FONT</span>,</li><li>      <span class="hljs-attr">styledValue</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextStyle</span>({ <span class="hljs-attr">fontSize</span>: <span class="hljs-title class_">LengthMetrics</span>.<span class="hljs-title function_">px</span>(<span class="hljs-number">20</span>) })</li><li>    },</li><li>    {</li><li>      <span class="hljs-attr">start</span>: <span class="hljs-number">3</span>,</li><li>      <span class="hljs-attr">length</span>: <span class="hljs-number">3</span>,</li><li>      <span class="hljs-attr">styledKey</span>: <span class="hljs-title class_">StyledStringKey</span>.<span class="hljs-property">FONT</span>,</li><li>      <span class="hljs-attr">styledValue</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextStyle</span>({ <span class="hljs-attr">fontColor</span>: <span class="hljs-title class_">Color</span>.<span class="hljs-property">Brown</span> })</li><li>    }</li><li>  ]);</li><li>
</li><li>  <span class="hljs-comment">// 测算属性字符串在指定宽度下能显示的行数</span></li><li>  <span class="hljs-title function_">getLineNum</span>(<span class="hljs-params">styledString: StyledString, width: LengthMetrics</span>) {</li><li>    <span class="hljs-keyword">let</span> paragraphArr = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getMeasureUtils</span>().<span class="hljs-title function_">getParagraphs</span>(styledString, { <span class="hljs-attr">constraintWidth</span>: width });</li><li>    <span class="hljs-keyword">let</span> res = <span class="hljs-number">0</span>;</li><li>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; paragraphArr.<span class="hljs-property">length</span>; ++i) {</li><li>      res += paragraphArr[i].<span class="hljs-title function_">getLineCount</span>();</li><li>    }</li><li>    <span class="hljs-keyword">return</span> res;</li><li>  }</li><li>
</li><li>  <span class="hljs-comment">// 测算属性字符串显示maxLines行时最多可以显示的字数</span></li><li>  <span class="hljs-title function_">getCorrectIndex</span>(<span class="hljs-params">styledString: MutableStyledString, maxLines: <span class="hljs-built_in">number</span>, width: LengthMetrics</span>) {</li><li>    <span class="hljs-keyword">let</span> low = <span class="hljs-number">0</span>;</li><li>    <span class="hljs-keyword">let</span> high = styledString.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>;</li><li>    <span class="hljs-comment">// 使用二分查找</span></li><li>    <span class="hljs-keyword">while</span> (low &lt;= high) {</li><li>      <span class="hljs-keyword">let</span> mid = (low + high) &gt;&gt; <span class="hljs-number">1</span>;</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"demo: get "</span> + low + <span class="hljs-string">" "</span> + high + <span class="hljs-string">" "</span> + mid);</li><li>      <span class="hljs-keyword">let</span> moreStyledString = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MutableStyledString</span>(<span class="hljs-string">"... 全文"</span>, [{</li><li>        <span class="hljs-attr">start</span>: <span class="hljs-number">4</span>,</li><li>        <span class="hljs-attr">length</span>: <span class="hljs-number">2</span>,</li><li>        <span class="hljs-attr">styledKey</span>: <span class="hljs-title class_">StyledStringKey</span>.<span class="hljs-property">FONT</span>,</li><li>        <span class="hljs-attr">styledValue</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextStyle</span>({ <span class="hljs-attr">fontColor</span>: <span class="hljs-title class_">Color</span>.<span class="hljs-property">Blue</span> })</li><li>      }]);</li><li>      moreStyledString.<span class="hljs-title function_">insertStyledString</span>(<span class="hljs-number">0</span>, styledString.<span class="hljs-title function_">subStyledString</span>(<span class="hljs-number">0</span>, mid));</li><li>      <span class="hljs-keyword">let</span> lineNum = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getLineNum</span>(moreStyledString, <span class="hljs-title class_">LengthMetrics</span>.<span class="hljs-title function_">px</span>(<span class="hljs-number">500</span>));</li><li>      <span class="hljs-keyword">if</span> (lineNum &lt;= maxLines) {</li><li>        low = mid + <span class="hljs-number">1</span>;</li><li>      } <span class="hljs-keyword">else</span> {</li><li>        high = mid - <span class="hljs-number">1</span>;</li><li>      }</li><li>    }</li><li>    <span class="hljs-keyword">return</span> high;</li><li>  }</li><li>
</li><li>  mutableStrAllContent = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MutableStyledString</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">str</span>, [</li><li>    {</li><li>      <span class="hljs-attr">start</span>: <span class="hljs-number">0</span>,</li><li>      <span class="hljs-attr">length</span>: <span class="hljs-number">3</span>,</li><li>      <span class="hljs-attr">styledKey</span>: <span class="hljs-title class_">StyledStringKey</span>.<span class="hljs-property">FONT</span>,</li><li>      <span class="hljs-attr">styledValue</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextStyle</span>({ <span class="hljs-attr">fontSize</span>: <span class="hljs-title class_">LengthMetrics</span>.<span class="hljs-title function_">px</span>(<span class="hljs-number">40</span>) })</li><li>    },</li><li>    {</li><li>      <span class="hljs-attr">start</span>: <span class="hljs-number">3</span>,</li><li>      <span class="hljs-attr">length</span>: <span class="hljs-number">3</span>,</li><li>      <span class="hljs-attr">styledKey</span>: <span class="hljs-title class_">StyledStringKey</span>.<span class="hljs-property">FONT</span>,</li><li>      <span class="hljs-attr">styledValue</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextStyle</span>({ <span class="hljs-attr">fontColor</span>: <span class="hljs-title class_">Color</span>.<span class="hljs-property">Brown</span> })</li><li>    }</li><li>  ]);</li><li>  <span class="hljs-attr">customSpan1</span>: <span class="hljs-title class_">MyCustomSpan</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyCustomSpan</span>(<span class="hljs-string">"Hello"</span>, <span class="hljs-number">120</span>, <span class="hljs-number">10</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>());</li><li>  mutableStrAllContent2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MutableStyledString</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">str</span>, [</li><li>    {</li><li>      <span class="hljs-attr">start</span>: <span class="hljs-number">0</span>,</li><li>      <span class="hljs-attr">length</span>: <span class="hljs-number">3</span>,</li><li>      <span class="hljs-attr">styledKey</span>: <span class="hljs-title class_">StyledStringKey</span>.<span class="hljs-property">FONT</span>,</li><li>      <span class="hljs-attr">styledValue</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextStyle</span>({ <span class="hljs-attr">fontSize</span>: <span class="hljs-title class_">LengthMetrics</span>.<span class="hljs-title function_">px</span>(<span class="hljs-number">100</span>) })</li><li>    },</li><li>    {</li><li>      <span class="hljs-attr">start</span>: <span class="hljs-number">3</span>,</li><li>      <span class="hljs-attr">length</span>: <span class="hljs-number">3</span>,</li><li>      <span class="hljs-attr">styledKey</span>: <span class="hljs-title class_">StyledStringKey</span>.<span class="hljs-property">FONT</span>,</li><li>      <span class="hljs-attr">styledValue</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextStyle</span>({ <span class="hljs-attr">fontColor</span>: <span class="hljs-title class_">Color</span>.<span class="hljs-property">Brown</span> })</li><li>    }</li><li>  ]);</li><li>  <span class="hljs-attr">controller</span>: <span class="hljs-title class_">TextController</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextController</span>();</li><li>  <span class="hljs-attr">controller2</span>: <span class="hljs-title class_">TextController</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextController</span>();</li><li>  <span class="hljs-attr">textController</span>: <span class="hljs-title class_">TextController</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextController</span>();</li><li>  <span class="hljs-attr">textController2</span>: <span class="hljs-title class_">TextController</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextController</span>();</li><li>
</li><li>  <span class="hljs-title function_">aboutToAppear</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">mutableStrAllContent2</span>.<span class="hljs-title function_">insertStyledString</span>(<span class="hljs-number">0</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">StyledString</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">customSpan1</span>));</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">mutableStr2</span>.<span class="hljs-title function_">insertStyledString</span>(<span class="hljs-number">0</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">StyledString</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">customSpan1</span>));</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Scroll</span>() {</li><li>      <span class="hljs-title class_">Column</span>() {</li><li>        <span class="hljs-title class_">Text</span>(<span class="hljs-string">'原文'</span>)</li><li>        <span class="hljs-title class_">Text</span>(<span class="hljs-literal">undefined</span>, { <span class="hljs-attr">controller</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span> }).<span class="hljs-title function_">width</span>(<span class="hljs-string">'500px'</span>).<span class="hljs-title function_">onAppear</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span>.<span class="hljs-title function_">setStyledString</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">mutableStrAllContent</span>);</li><li>        })</li><li>        <span class="hljs-title class_">Divider</span>().<span class="hljs-title function_">strokeWidth</span>(<span class="hljs-number">8</span>).<span class="hljs-title function_">color</span>(<span class="hljs-string">'#F1F3F5'</span>)</li><li>        <span class="hljs-title class_">Text</span>(<span class="hljs-string">'排版后'</span>)</li><li>        <span class="hljs-title class_">Text</span>(<span class="hljs-literal">undefined</span>, { <span class="hljs-attr">controller</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">textController</span> }).<span class="hljs-title function_">onAppear</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-keyword">let</span> now = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getCorrectIndex</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">mutableStrAllContent</span>, <span class="hljs-number">3</span>, <span class="hljs-title class_">LengthMetrics</span>.<span class="hljs-title function_">px</span>(<span class="hljs-number">500</span>));</li><li>          <span class="hljs-keyword">if</span> (now != <span class="hljs-variable language_">this</span>.<span class="hljs-property">mutableStrAllContent</span>.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>) {</li><li>            <span class="hljs-keyword">let</span> moreStyledString = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MutableStyledString</span>(<span class="hljs-string">"... 全文"</span>, [{</li><li>              <span class="hljs-attr">start</span>: <span class="hljs-number">4</span>,</li><li>              <span class="hljs-attr">length</span>: <span class="hljs-number">2</span>,</li><li>              <span class="hljs-attr">styledKey</span>: <span class="hljs-title class_">StyledStringKey</span>.<span class="hljs-property">FONT</span>,</li><li>              <span class="hljs-attr">styledValue</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextStyle</span>({ <span class="hljs-attr">fontColor</span>: <span class="hljs-title class_">Color</span>.<span class="hljs-property">Blue</span> })</li><li>            }]);</li><li>            moreStyledString.<span class="hljs-title function_">insertStyledString</span>(<span class="hljs-number">0</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">mutableStrAllContent</span>.<span class="hljs-title function_">subStyledString</span>(<span class="hljs-number">0</span>, now));</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">textController</span>.<span class="hljs-title function_">setStyledString</span>(moreStyledString);</li><li>          } <span class="hljs-keyword">else</span> {</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">textController</span>.<span class="hljs-title function_">setStyledString</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">mutableStrAllContent</span>);</li><li>          }</li><li>        })</li><li>          .<span class="hljs-title function_">width</span>(<span class="hljs-string">'500px'</span>)</li><li>        <span class="hljs-title class_">Divider</span>().<span class="hljs-title function_">strokeWidth</span>(<span class="hljs-number">8</span>).<span class="hljs-title function_">color</span>(<span class="hljs-string">'#F1F3F5'</span>)</li><li>        <span class="hljs-title class_">Text</span>(<span class="hljs-string">'原文'</span>)</li><li>        <span class="hljs-title class_">Text</span>(<span class="hljs-literal">undefined</span>, { <span class="hljs-attr">controller</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller2</span> }).<span class="hljs-title function_">width</span>(<span class="hljs-string">'500px'</span>).<span class="hljs-title function_">onAppear</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller2</span>.<span class="hljs-title function_">setStyledString</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">mutableStrAllContent2</span>);</li><li>        })</li><li>        <span class="hljs-title class_">Divider</span>().<span class="hljs-title function_">strokeWidth</span>(<span class="hljs-number">8</span>).<span class="hljs-title function_">color</span>(<span class="hljs-string">'#F1F3F5'</span>)</li><li>        <span class="hljs-title class_">Text</span>(<span class="hljs-string">'排版后'</span>)</li><li>        <span class="hljs-title class_">Text</span>(<span class="hljs-literal">undefined</span>, { <span class="hljs-attr">controller</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">textController2</span> }).<span class="hljs-title function_">onAppear</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-keyword">let</span> now = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getCorrectIndex</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">mutableStrAllContent2</span>, <span class="hljs-number">3</span>, <span class="hljs-title class_">LengthMetrics</span>.<span class="hljs-title function_">px</span>(<span class="hljs-number">500</span>));</li><li>          <span class="hljs-keyword">let</span> moreStyledString = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MutableStyledString</span>(<span class="hljs-string">"... 全文"</span>, [{</li><li>            <span class="hljs-attr">start</span>: <span class="hljs-number">4</span>,</li><li>            <span class="hljs-attr">length</span>: <span class="hljs-number">2</span>,</li><li>            <span class="hljs-attr">styledKey</span>: <span class="hljs-title class_">StyledStringKey</span>.<span class="hljs-property">FONT</span>,</li><li>            <span class="hljs-attr">styledValue</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextStyle</span>({ <span class="hljs-attr">fontColor</span>: <span class="hljs-title class_">Color</span>.<span class="hljs-property">Blue</span> })</li><li>          }]);</li><li>          moreStyledString.<span class="hljs-title function_">insertStyledString</span>(<span class="hljs-number">0</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">mutableStrAllContent2</span>.<span class="hljs-title function_">subStyledString</span>(<span class="hljs-number">0</span>, now));</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">textController2</span>.<span class="hljs-title function_">setStyledString</span>(moreStyledString);</li><li>        })</li><li>          .<span class="hljs-title function_">width</span>(<span class="hljs-string">'500px'</span>)</li><li>      }.<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>       <p><span><img originheight="1055" originwidth="248" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114850.68292754426744214045363541795709:50001231000000:2800:E416ADD8817459043119FCA899142234CE64F05CC71EF20B891558D9712FC459.png" class="notEnlarge" width="248" height="1055"></span></p></li>     </ul>    </div>    <div class="tiledSection">     <h2 id="使用图片">使用图片<i class="anchor-icon anchor-icon-link" anchorid="使用图片" tips="复制节点链接"></i></h2>          <p>可通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-universal-styled-string#imageattachment" target="_blank">ImageAttachment</a>来添加图片。</p>     <p>以下示例展示了如何将图片和文本附加到同一个MutableStyledString对象上，并实现图文混排。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>属性字符串的构造函数<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-universal-styled-string#constructor" target="_blank">constructor</a>中，当入参value的类型为ImageAttachment或CustomSpan时，styles参数不生效。需要设置styles时，通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-universal-styled-string#setstyle" target="_blank">setStyle</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-universal-styled-string#insertstyledstring" target="_blank">insertStyledString</a>等方法实现。</p>      </div></div></div>     <div _ngcontent-rbe-c106="" class="highlight-div"><div _ngcontent-rbe-c106="" class="highlight-div-header"><div _ngcontent-rbe-c106="" class="highlight-div-header-left"><div _ngcontent-rbe-c106="" class="handle-button expand-button"><div _ngcontent-rbe-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rbe-c106="" class="highlight-div-header-right"><div _ngcontent-rbe-c106="" class="handle-button ai-button"></div><div _ngcontent-rbe-c106="" class="handle-button line-button"><div _ngcontent-rbe-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rbe-c106="" class="handle-button theme-button"><div _ngcontent-rbe-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rbe-c106="" class="handle-button copy-button"><div _ngcontent-rbe-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rbe-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// xxx.ets</span></li><li><span class="hljs-keyword">import</span> { image } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ImageKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">LengthMetrics</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct styled_string_demo4 {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'Hello World'</span>;</li><li>  <span class="hljs-attr">imagePixelMap</span>: image.<span class="hljs-property">PixelMap</span> | <span class="hljs-literal">undefined</span> = <span class="hljs-literal">undefined</span>;</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">imagePixelMap3</span>: image.<span class="hljs-property">PixelMap</span> | <span class="hljs-literal">undefined</span> = <span class="hljs-literal">undefined</span>;</li><li>  <span class="hljs-attr">mutableStr</span>: <span class="hljs-title class_">MutableStyledString</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MutableStyledString</span>(<span class="hljs-string">'123'</span>);</li><li>  <span class="hljs-attr">controller</span>: <span class="hljs-title class_">TextController</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextController</span>();</li><li>  <span class="hljs-attr">mutableStr2</span>: <span class="hljs-title class_">MutableStyledString</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MutableStyledString</span>(<span class="hljs-string">'This is set decoration line style to the mutableStr2'</span>, [{</li><li>    <span class="hljs-attr">start</span>: <span class="hljs-number">0</span>,</li><li>    <span class="hljs-attr">length</span>: <span class="hljs-number">15</span>,</li><li>    <span class="hljs-attr">styledKey</span>: <span class="hljs-title class_">StyledStringKey</span>.<span class="hljs-property">DECORATION</span>,</li><li>    <span class="hljs-attr">styledValue</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">DecorationStyle</span>({</li><li>      <span class="hljs-attr">type</span>: <span class="hljs-title class_">TextDecorationType</span>.<span class="hljs-property">Overline</span>,</li><li>      <span class="hljs-attr">color</span>: <span class="hljs-title class_">Color</span>.<span class="hljs-property">Orange</span>,</li><li>      <span class="hljs-attr">style</span>: <span class="hljs-title class_">TextDecorationStyle</span>.<span class="hljs-property">DOUBLE</span></li><li>    })</li><li>  }]);</li><li>
</li><li>  <span class="hljs-keyword">async</span> <span class="hljs-title function_">aboutToAppear</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"aboutToAppear initial imagePixelMap"</span>);</li><li>    <span class="hljs-comment">// $r('app.media.sea')需要替换为开发者所需的图像资源文件。</span></li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">imagePixelMap</span> = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getPixmapFromMedia</span>($r(<span class="hljs-string">'app.media.sea'</span>));</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">getPixmapFromMedia</span>(<span class="hljs-params">resource: Resource</span>) {</li><li>    <span class="hljs-keyword">let</span> unit8Array = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>()?.<span class="hljs-property">resourceManager</span>?.<span class="hljs-title function_">getMediaContent</span>(resource.<span class="hljs-property">id</span>);</li><li>    <span class="hljs-keyword">let</span> imageSource = image.<span class="hljs-title function_">createImageSource</span>(unit8Array?.<span class="hljs-property">buffer</span>?.<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, unit8Array?.<span class="hljs-property">buffer</span>?.<span class="hljs-property">byteLength</span>));</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">createPixelMap</span>: image.<span class="hljs-property">PixelMap</span> = <span class="hljs-keyword">await</span> imageSource.<span class="hljs-title function_">createPixelMap</span>({</li><li>      <span class="hljs-attr">desiredPixelFormat</span>: image.<span class="hljs-property">PixelMapFormat</span>.<span class="hljs-property">RGBA_8888</span></li><li>    });</li><li>    <span class="hljs-keyword">await</span> imageSource.<span class="hljs-title function_">release</span>();</li><li>    <span class="hljs-keyword">return</span> createPixelMap;</li><li>  }</li><li>
</li><li>  <span class="hljs-attr">leadingMarginValue</span>: <span class="hljs-title class_">ParagraphStyle</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ParagraphStyle</span>({ <span class="hljs-attr">leadingMargin</span>: <span class="hljs-title class_">LengthMetrics</span>.<span class="hljs-title function_">vp</span>(<span class="hljs-number">5</span>)});</li><li>  <span class="hljs-comment">// 行高样式对象</span></li><li>  <span class="hljs-attr">lineHeightStyle1</span>: <span class="hljs-title class_">LineHeightStyle</span>= <span class="hljs-keyword">new</span> <span class="hljs-title class_">LineHeightStyle</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">LengthMetrics</span>(<span class="hljs-number">24</span>));</li><li>  <span class="hljs-comment">// Bold样式</span></li><li>  <span class="hljs-attr">boldTextStyle</span>: <span class="hljs-title class_">TextStyle</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextStyle</span>({ <span class="hljs-attr">fontWeight</span>: <span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span> });</li><li>  <span class="hljs-comment">// 创建含段落样式的对象paragraphStyledString1</span></li><li>  <span class="hljs-attr">paragraphStyledString1</span>: <span class="hljs-title class_">MutableStyledString</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MutableStyledString</span>(<span class="hljs-string">"\n品牌相纸 高清冲印30张\n限时直降5.15元 限量赠送"</span>, [</li><li>    {</li><li>      <span class="hljs-attr">start</span>: <span class="hljs-number">0</span>,</li><li>      <span class="hljs-attr">length</span>: <span class="hljs-number">28</span>,</li><li>      <span class="hljs-attr">styledKey</span>: <span class="hljs-title class_">StyledStringKey</span>.<span class="hljs-property">PARAGRAPH_STYLE</span>,</li><li>      <span class="hljs-attr">styledValue</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">leadingMarginValue</span></li><li>    },</li><li>    {</li><li>      <span class="hljs-attr">start</span>: <span class="hljs-number">14</span>,</li><li>      <span class="hljs-attr">length</span>: <span class="hljs-number">9</span>,</li><li>      <span class="hljs-attr">styledKey</span>: <span class="hljs-title class_">StyledStringKey</span>.<span class="hljs-property">FONT</span>,</li><li>      <span class="hljs-attr">styledValue</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextStyle</span>({ <span class="hljs-attr">fontSize</span>: <span class="hljs-title class_">LengthMetrics</span>.<span class="hljs-title function_">vp</span>(<span class="hljs-number">14</span>), <span class="hljs-attr">fontColor</span>: <span class="hljs-string">'#B22222'</span> })</li><li>    },</li><li>    {</li><li>      <span class="hljs-attr">start</span>: <span class="hljs-number">24</span>,</li><li>      <span class="hljs-attr">length</span>: <span class="hljs-number">4</span>,</li><li>      <span class="hljs-attr">styledKey</span>: <span class="hljs-title class_">StyledStringKey</span>.<span class="hljs-property">FONT</span>,</li><li>      <span class="hljs-attr">styledValue</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextStyle</span>({ <span class="hljs-attr">fontSize</span>: <span class="hljs-title class_">LengthMetrics</span>.<span class="hljs-title function_">vp</span>(<span class="hljs-number">14</span>), <span class="hljs-attr">fontWeight</span>: <span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Lighter</span> })</li><li>    },</li><li>    {</li><li>      <span class="hljs-attr">start</span>: <span class="hljs-number">11</span>,</li><li>      <span class="hljs-attr">length</span>: <span class="hljs-number">4</span>,</li><li>      <span class="hljs-attr">styledKey</span>: <span class="hljs-title class_">StyledStringKey</span>.<span class="hljs-property">LINE_HEIGHT</span>,</li><li>      <span class="hljs-attr">styledValue</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">lineHeightStyle1</span></li><li>    }</li><li>  ]);</li><li>  <span class="hljs-attr">paragraphStyledString2</span>: <span class="hljs-title class_">MutableStyledString</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MutableStyledString</span>(<span class="hljs-string">"\n￥16.21 3000+人好评"</span>, [</li><li>    {</li><li>      <span class="hljs-attr">start</span>: <span class="hljs-number">0</span>,</li><li>      <span class="hljs-attr">length</span>: <span class="hljs-number">5</span>,</li><li>      <span class="hljs-attr">styledKey</span>: <span class="hljs-title class_">StyledStringKey</span>.<span class="hljs-property">PARAGRAPH_STYLE</span>,</li><li>      <span class="hljs-attr">styledValue</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">leadingMarginValue</span></li><li>    },</li><li>    {</li><li>      <span class="hljs-attr">start</span>: <span class="hljs-number">0</span>,</li><li>      <span class="hljs-attr">length</span>: <span class="hljs-number">4</span>,</li><li>      <span class="hljs-attr">styledKey</span>: <span class="hljs-title class_">StyledStringKey</span>.<span class="hljs-property">LINE_HEIGHT</span>,</li><li>      <span class="hljs-attr">styledValue</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">LineHeightStyle</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">LengthMetrics</span>(<span class="hljs-number">60</span>))</li><li>    },</li><li>    {</li><li>      <span class="hljs-attr">start</span>: <span class="hljs-number">0</span>,</li><li>      <span class="hljs-attr">length</span>: <span class="hljs-number">7</span>,</li><li>      <span class="hljs-attr">styledKey</span>: <span class="hljs-title class_">StyledStringKey</span>.<span class="hljs-property">FONT</span>,</li><li>      <span class="hljs-attr">styledValue</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">boldTextStyle</span></li><li>    },</li><li>    {</li><li>      <span class="hljs-attr">start</span>: <span class="hljs-number">1</span>,</li><li>      <span class="hljs-attr">length</span>: <span class="hljs-number">1</span>,</li><li>      <span class="hljs-attr">styledKey</span>: <span class="hljs-title class_">StyledStringKey</span>.<span class="hljs-property">FONT</span>,</li><li>      <span class="hljs-attr">styledValue</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextStyle</span>({ <span class="hljs-attr">fontSize</span>: <span class="hljs-title class_">LengthMetrics</span>.<span class="hljs-title function_">vp</span>(<span class="hljs-number">18</span>) })</li><li>    },</li><li>    {</li><li>      <span class="hljs-attr">start</span>: <span class="hljs-number">2</span>,</li><li>      <span class="hljs-attr">length</span>: <span class="hljs-number">2</span>,</li><li>      <span class="hljs-attr">styledKey</span>: <span class="hljs-title class_">StyledStringKey</span>.<span class="hljs-property">FONT</span>,</li><li>      <span class="hljs-attr">styledValue</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextStyle</span>({ <span class="hljs-attr">fontSize</span>: <span class="hljs-title class_">LengthMetrics</span>.<span class="hljs-title function_">vp</span>(<span class="hljs-number">36</span>) })</li><li>    },</li><li>    {</li><li>      <span class="hljs-attr">start</span>: <span class="hljs-number">4</span>,</li><li>      <span class="hljs-attr">length</span>: <span class="hljs-number">3</span>,</li><li>      <span class="hljs-attr">styledKey</span>: <span class="hljs-title class_">StyledStringKey</span>.<span class="hljs-property">FONT</span>,</li><li>      <span class="hljs-attr">styledValue</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextStyle</span>({ <span class="hljs-attr">fontSize</span>: <span class="hljs-title class_">LengthMetrics</span>.<span class="hljs-title function_">vp</span>(<span class="hljs-number">20</span>) })</li><li>    },</li><li>    {</li><li>      <span class="hljs-attr">start</span>: <span class="hljs-number">7</span>,</li><li>      <span class="hljs-attr">length</span>: <span class="hljs-number">9</span>,</li><li>      <span class="hljs-attr">styledKey</span>: <span class="hljs-title class_">StyledStringKey</span>.<span class="hljs-property">FONT</span>,</li><li>      <span class="hljs-attr">styledValue</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextStyle</span>({ <span class="hljs-attr">fontColor</span>: <span class="hljs-title class_">Color</span>.<span class="hljs-property">Grey</span>, <span class="hljs-attr">fontSize</span>: <span class="hljs-title class_">LengthMetrics</span>.<span class="hljs-title function_">vp</span>(<span class="hljs-number">14</span>)})</li><li>    }</li><li>  ]);</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Row</span>() {</li><li>      <span class="hljs-title class_">Column</span>({ <span class="hljs-attr">space</span>: <span class="hljs-number">10</span> }) {</li><li>        <span class="hljs-title class_">Text</span>(<span class="hljs-literal">undefined</span>, { <span class="hljs-attr">controller</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span> })</li><li>          .<span class="hljs-title function_">copyOption</span>(<span class="hljs-title class_">CopyOptions</span>.<span class="hljs-property">InApp</span>)</li><li>          .<span class="hljs-title function_">draggable</span>(<span class="hljs-literal">true</span>)</li><li>          .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">'#FFFFFF'</span>)</li><li>          .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">5</span>)</li><li>
</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">'点击查看商品卡片'</span>)</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">imagePixelMap</span> !== <span class="hljs-literal">undefined</span>) {</li><li>              <span class="hljs-variable language_">this</span>.<span class="hljs-property">mutableStr</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MutableStyledString</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ImageAttachment</span>({</li><li>                <span class="hljs-attr">value</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">imagePixelMap</span>,</li><li>                <span class="hljs-attr">size</span>: { <span class="hljs-attr">width</span>: <span class="hljs-number">180</span>, <span class="hljs-attr">height</span>: <span class="hljs-number">160</span> },</li><li>                <span class="hljs-attr">verticalAlign</span>: <span class="hljs-title class_">ImageSpanAlignment</span>.<span class="hljs-property">BASELINE</span>,</li><li>                <span class="hljs-attr">objectFit</span>: <span class="hljs-title class_">ImageFit</span>.<span class="hljs-property">Fill</span></li><li>              }));</li><li>              <span class="hljs-variable language_">this</span>.<span class="hljs-property">paragraphStyledString1</span>.<span class="hljs-title function_">appendStyledString</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">paragraphStyledString2</span>);</li><li>              <span class="hljs-variable language_">this</span>.<span class="hljs-property">mutableStr</span>.<span class="hljs-title function_">appendStyledString</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">paragraphStyledString1</span>);</li><li>              <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span>.<span class="hljs-title function_">setStyledString</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">mutableStr</span>);</li><li>            }</li><li>          })</li><li>      }</li><li>      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    }</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>    .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">'#F8F8FF'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div>     <p><span><img originheight="443" originwidth="300" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114850.23537397067509023637881529321690:50001231000000:2800:421F949F160FC9D15E7526B8F2A732447D898DE53482AEC2C1A7A0E4F89B5054.png" width="300" height="443"></span></p>    </div>    <div class="tiledSection">     <h2 id="设置事件">设置事件<i class="anchor-icon anchor-icon-link" anchorid="设置事件" tips="复制节点链接"></i></h2>          <p>可通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-universal-styled-string#gesturestyle" target="_blank">GestureStyle</a>设置onClick、onLongPress事件来使文本响应点击长按事件。</p>     <p>除了初始化属性字符串对象即初始样式对象，亦可通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-universal-styled-string#setstyle" target="_blank">setStyle</a>接口再叠加新样式或更新已有样式，同时需要在附加的文本组件controller上主动触发更新绑定的属性字符串。</p>     <div _ngcontent-rbe-c106="" class="highlight-div"><div _ngcontent-rbe-c106="" class="highlight-div-header"><div _ngcontent-rbe-c106="" class="highlight-div-header-left"><div _ngcontent-rbe-c106="" class="handle-button expand-button"><div _ngcontent-rbe-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rbe-c106="" class="highlight-div-header-right"><div _ngcontent-rbe-c106="" class="handle-button ai-button"></div><div _ngcontent-rbe-c106="" class="handle-button line-button"><div _ngcontent-rbe-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rbe-c106="" class="handle-button theme-button"><div _ngcontent-rbe-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rbe-c106="" class="handle-button copy-button"><div _ngcontent-rbe-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rbe-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { drawing } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkGraphics2D'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">gUIContext</span>: <span class="hljs-title class_">UIContext</span>;</li><li>
</li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyCustomSpan</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">CustomSpan</span> {</li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">word: <span class="hljs-built_in">string</span>, width: <span class="hljs-built_in">number</span>, height: <span class="hljs-built_in">number</span>, fontSize: <span class="hljs-built_in">number</span></span>) {</li><li>    <span class="hljs-variable language_">super</span>();</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">word</span> = word;</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">width</span> = width;</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">height</span> = height;</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">fontSize</span> = fontSize;</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">onMeasure</span>(<span class="hljs-attr">measureInfo</span>: <span class="hljs-title class_">CustomSpanMeasureInfo</span>): <span class="hljs-title class_">CustomSpanMetrics</span> {</li><li>    <span class="hljs-keyword">return</span> { <span class="hljs-attr">width</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">width</span>, <span class="hljs-attr">height</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">height</span> };</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">onDraw</span>(<span class="hljs-params">context: DrawContext, options: CustomSpanDrawInfo</span>) {</li><li>    <span class="hljs-keyword">let</span> canvas = context.<span class="hljs-property">canvas</span>;</li><li>
</li><li>    <span class="hljs-keyword">const</span> brush = <span class="hljs-keyword">new</span> drawing.<span class="hljs-title class_">Brush</span>();</li><li>    brush.<span class="hljs-title function_">setColor</span>({</li><li>      <span class="hljs-attr">alpha</span>: <span class="hljs-number">255</span>,</li><li>      <span class="hljs-attr">red</span>: <span class="hljs-number">0</span>,</li><li>      <span class="hljs-attr">green</span>: <span class="hljs-number">0</span>,</li><li>      <span class="hljs-attr">blue</span>: <span class="hljs-number">0</span></li><li>    });</li><li>    <span class="hljs-keyword">const</span> font = <span class="hljs-keyword">new</span> drawing.<span class="hljs-title class_">Font</span>();</li><li>    font.<span class="hljs-title function_">setSize</span>(gUIContext.<span class="hljs-title function_">vp2px</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">fontSize</span>));</li><li>    <span class="hljs-keyword">const</span> textBlob =</li><li>      drawing.<span class="hljs-property">TextBlob</span>.<span class="hljs-title function_">makeFromString</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">word</span>.<span class="hljs-title function_">substring</span>(<span class="hljs-number">0</span>, <span class="hljs-number">5</span>), font, drawing.<span class="hljs-property">TextEncoding</span>.<span class="hljs-property">TEXT_ENCODING_UTF8</span>);</li><li>    canvas.<span class="hljs-title function_">attachBrush</span>(brush);</li><li>
</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">onDrawRectByRadius</span>(context, options.<span class="hljs-property">x</span>, options.<span class="hljs-property">x</span> + gUIContext.<span class="hljs-title function_">vp2px</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">width</span>), options.<span class="hljs-property">lineTop</span>,</li><li>      options.<span class="hljs-property">lineBottom</span>, <span class="hljs-number">20</span>);</li><li>    brush.<span class="hljs-title function_">setColor</span>({</li><li>      <span class="hljs-attr">alpha</span>: <span class="hljs-number">255</span>,</li><li>      <span class="hljs-attr">red</span>: <span class="hljs-number">255</span>,</li><li>      <span class="hljs-attr">green</span>: <span class="hljs-number">255</span>,</li><li>      <span class="hljs-attr">blue</span>: <span class="hljs-number">255</span></li><li>    });</li><li>    canvas.<span class="hljs-title function_">attachBrush</span>(brush);</li><li>    canvas.<span class="hljs-title function_">drawTextBlob</span>(textBlob, options.<span class="hljs-property">x</span>, options.<span class="hljs-property">baseline</span>);</li><li>    brush.<span class="hljs-title function_">setColor</span>({</li><li>      <span class="hljs-attr">alpha</span>: <span class="hljs-number">255</span>,</li><li>      <span class="hljs-attr">red</span>: <span class="hljs-number">255</span>,</li><li>      <span class="hljs-attr">green</span>: <span class="hljs-number">228</span>,</li><li>      <span class="hljs-attr">blue</span>: <span class="hljs-number">196</span></li><li>    });</li><li>    canvas.<span class="hljs-title function_">attachBrush</span>(brush);</li><li>    <span class="hljs-keyword">const</span> textBlob1 =</li><li>      drawing.<span class="hljs-property">TextBlob</span>.<span class="hljs-title function_">makeFromString</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">word</span>.<span class="hljs-title function_">substring</span>(<span class="hljs-number">5</span>), font, drawing.<span class="hljs-property">TextEncoding</span>.<span class="hljs-property">TEXT_ENCODING_UTF8</span>);</li><li>    canvas.<span class="hljs-title function_">drawTextBlob</span>(textBlob1, options.<span class="hljs-property">x</span> + gUIContext.<span class="hljs-title function_">vp2px</span>(<span class="hljs-number">100</span>), options.<span class="hljs-property">baseline</span>);</li><li>
</li><li>    canvas.<span class="hljs-title function_">detachBrush</span>();</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">onDrawRectByRadius</span>(<span class="hljs-params">context: DrawContext, left: <span class="hljs-built_in">number</span>, right: <span class="hljs-built_in">number</span>, top: <span class="hljs-built_in">number</span>, bottom: <span class="hljs-built_in">number</span>, radius: <span class="hljs-built_in">number</span></span>) {</li><li>    <span class="hljs-keyword">let</span> canvas = context.<span class="hljs-property">canvas</span>;</li><li>    <span class="hljs-keyword">let</span> path = <span class="hljs-keyword">new</span> drawing.<span class="hljs-title class_">Path</span>();</li><li>
</li><li>    <span class="hljs-comment">// 画带radius的rect</span></li><li>    path.<span class="hljs-title function_">moveTo</span>(left + radius, top);</li><li>    path.<span class="hljs-title function_">lineTo</span>(right - radius, top);</li><li>    path.<span class="hljs-title function_">arcTo</span>(right - <span class="hljs-number">2</span> * radius, top, right, top + <span class="hljs-number">2</span> * radius, <span class="hljs-number">270</span>, <span class="hljs-number">90</span>);</li><li>    path.<span class="hljs-title function_">lineTo</span>(right, bottom - radius);</li><li>    path.<span class="hljs-title function_">arcTo</span>(right - <span class="hljs-number">2</span> * radius, bottom - <span class="hljs-number">2</span> * radius, right, bottom, <span class="hljs-number">0</span>, <span class="hljs-number">90</span>);</li><li>
</li><li>    path.<span class="hljs-title function_">lineTo</span>(left + <span class="hljs-number">2</span> * radius, bottom);</li><li>    path.<span class="hljs-title function_">arcTo</span>(left, bottom - <span class="hljs-number">2</span> * radius, left + <span class="hljs-number">2</span> * radius, bottom, <span class="hljs-number">90</span>, <span class="hljs-number">90</span>);</li><li>    path.<span class="hljs-title function_">lineTo</span>(left, top + <span class="hljs-number">2</span> * radius);</li><li>    path.<span class="hljs-title function_">arcTo</span>(left, top, left + <span class="hljs-number">2</span> * radius, top + <span class="hljs-number">2</span> * radius, <span class="hljs-number">180</span>, <span class="hljs-number">90</span>);</li><li>
</li><li>    canvas.<span class="hljs-title function_">drawPath</span>(path);</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">setWord</span>(<span class="hljs-params">word: <span class="hljs-built_in">string</span></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">word</span> = word;</li><li>  }</li><li>
</li><li>  <span class="hljs-attr">width</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">160</span>;</li><li>  <span class="hljs-attr">word</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">"drawing"</span>;</li><li>  <span class="hljs-attr">height</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">10</span>;</li><li>  <span class="hljs-attr">fontSize</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">16</span>;</li><li>}</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct styled_string_demo6 {</li><li>  <span class="hljs-attr">customSpan3</span>: <span class="hljs-title class_">MyCustomSpan</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyCustomSpan</span>(<span class="hljs-string">"99VIP88%off"</span>, <span class="hljs-number">200</span>, <span class="hljs-number">40</span>, <span class="hljs-number">30</span>);</li><li>  <span class="hljs-attr">customSpanStyledString</span>: <span class="hljs-title class_">MutableStyledString</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MutableStyledString</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">customSpan3</span>);</li><li>  <span class="hljs-attr">textController</span>: <span class="hljs-title class_">TextController</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextController</span>();</li><li>  <span class="hljs-attr">isPageShow</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">true</span>;</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">backgroundColor1</span>: <span class="hljs-title class_">ResourceColor</span> | <span class="hljs-literal">undefined</span> = <span class="hljs-literal">undefined</span>;</li><li>  <span class="hljs-attr">gestureStyleAttr</span>: <span class="hljs-title class_">GestureStyle</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">GestureStyle</span>({</li><li>    <span class="hljs-attr">onClick</span>: <span class="hljs-function">() =&gt;</span> {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">backgroundColor1</span> = <span class="hljs-title class_">Color</span>.<span class="hljs-property">Green</span>;</li><li>    },</li><li>    <span class="hljs-attr">onLongPress</span>: <span class="hljs-function">() =&gt;</span> {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">backgroundColor1</span> = <span class="hljs-title class_">Color</span>.<span class="hljs-property">Grey</span>;</li><li>    }</li><li>  });</li><li>
</li><li>  <span class="hljs-title function_">aboutToAppear</span>(<span class="hljs-params"></span>) {</li><li>    gUIContext = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>();</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">async</span> <span class="hljs-title function_">onPageShow</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">isPageShow</span>) {</li><li>      <span class="hljs-keyword">return</span>;</li><li>    }</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">isPageShow</span> = <span class="hljs-literal">false</span>;</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">customSpanStyledString</span>.<span class="hljs-title function_">setStyle</span>({</li><li>      <span class="hljs-attr">start</span>: <span class="hljs-number">0</span>,</li><li>      <span class="hljs-attr">length</span>: <span class="hljs-number">1</span>,</li><li>      <span class="hljs-attr">styledKey</span>: <span class="hljs-title class_">StyledStringKey</span>.<span class="hljs-property">GESTURE</span>,</li><li>      <span class="hljs-attr">styledValue</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">gestureStyleAttr</span></li><li>    })</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">textController</span>.<span class="hljs-title function_">setStyledString</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">customSpanStyledString</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Row</span>() {</li><li>      <span class="hljs-title class_">Column</span>() {</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">"响应属性字符串事件改变背景色"</span>).<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">backgroundColor1</span>).<span class="hljs-title function_">width</span>(<span class="hljs-string">'80%'</span>).<span class="hljs-title function_">margin</span>(<span class="hljs-number">10</span>)</li><li>        <span class="hljs-title class_">Text</span>(<span class="hljs-literal">undefined</span>, { <span class="hljs-attr">controller</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">textController</span> })</li><li>          .<span class="hljs-title function_">copyOption</span>(<span class="hljs-title class_">CopyOptions</span>.<span class="hljs-property">InApp</span>)</li><li>          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">30</span>)</li><li>      }</li><li>      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    }</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div>     <p><span><img originheight="143" originwidth="460" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114850.10349879125984684167205308036762:50001231000000:2800:2AC582519839F7AB82A1FD10C0F999C91CCD990C72FB99A30E4E7B567B5318E5.gif" width="460" height="143"></span></p>    </div>    <div class="tiledSection">     <h2 id="格式转换">格式转换<i class="anchor-icon anchor-icon-link" anchorid="格式转换" tips="复制节点链接"></i></h2>          <p>可以通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-universal-styled-string#tohtml14" target="_blank">toHtml</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-universal-styled-string#fromhtml" target="_blank">fromHtml</a>接口实现属性字符串与HTML格式字符串的相关转换，当前支持转换的HTML标签范围：&lt;p&gt;、&lt;span&gt;、&lt;img&gt;、&lt;br&gt;、&lt;strong&gt;、&lt;b&gt;、&lt;a&gt;、&lt;i&gt;、&lt;em&gt;、&lt;s&gt;、&lt;u&gt;、&lt;del&gt;、&lt;sup&gt;、&lt;sub&gt;。</p>     <ul>      <li>以下示例展示了如何将属性字符串转换成HTML格式，并展示了如何从HTML格式转换回属性字符串。</li>     </ul>     <div _ngcontent-rbe-c106="" class="highlight-div"><div _ngcontent-rbe-c106="" class="highlight-div-header"><div _ngcontent-rbe-c106="" class="highlight-div-header-left"><div _ngcontent-rbe-c106="" class="handle-button expand-button"><div _ngcontent-rbe-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rbe-c106="" class="highlight-div-header-right"><div _ngcontent-rbe-c106="" class="handle-button ai-button"></div><div _ngcontent-rbe-c106="" class="handle-button line-button"><div _ngcontent-rbe-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rbe-c106="" class="handle-button theme-button"><div _ngcontent-rbe-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rbe-c106="" class="handle-button copy-button"><div _ngcontent-rbe-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rbe-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// xxx.ets</span></li><li><span class="hljs-keyword">import</span> { image } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ImageKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">LengthMetrics</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct styled_string_demo8 {</li><li>  <span class="hljs-attr">imagePixelMap</span>: image.<span class="hljs-property">PixelMap</span> | <span class="hljs-literal">undefined</span> = <span class="hljs-literal">undefined</span>;</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">html</span>: <span class="hljs-built_in">string</span> | <span class="hljs-literal">undefined</span> = <span class="hljs-literal">undefined</span>;</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">styledString</span>: <span class="hljs-title class_">StyledString</span> | <span class="hljs-literal">undefined</span> = <span class="hljs-literal">undefined</span>;</li><li>  <span class="hljs-attr">controller1</span>: <span class="hljs-title class_">TextController</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextController</span>;</li><li>  <span class="hljs-attr">controller2</span>: <span class="hljs-title class_">TextController</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextController</span>;</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">uiContext</span>: <span class="hljs-title class_">UIContext</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>();</li><li>
</li><li>  <span class="hljs-keyword">async</span> <span class="hljs-title function_">aboutToAppear</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"aboutToAppear initial imagePixelMap"</span>);</li><li>    <span class="hljs-comment">// $r('app.media.startIcon')需要替换为开发者所需的图像资源文件。</span></li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">imagePixelMap</span> = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getPixmapFromMedia</span>($r(<span class="hljs-string">'app.media.startIcon'</span>));</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">getPixmapFromMedia</span>(<span class="hljs-params">resource: Resource</span>) {</li><li>    <span class="hljs-keyword">let</span> unit8Array = <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">uiContext</span>.<span class="hljs-title function_">getHostContext</span>()?.<span class="hljs-property">resourceManager</span>?.<span class="hljs-title function_">getMediaContent</span>(resource.<span class="hljs-property">id</span>);</li><li>    <span class="hljs-keyword">let</span> imageSource = image.<span class="hljs-title function_">createImageSource</span>(unit8Array?.<span class="hljs-property">buffer</span>.<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, unit8Array.<span class="hljs-property">buffer</span>.<span class="hljs-property">byteLength</span>));</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">createPixelMap</span>: image.<span class="hljs-property">PixelMap</span> = <span class="hljs-keyword">await</span> imageSource.<span class="hljs-title function_">createPixelMap</span>({</li><li>      <span class="hljs-attr">desiredPixelFormat</span>: image.<span class="hljs-property">PixelMapFormat</span>.<span class="hljs-property">RGBA_8888</span></li><li>    });</li><li>    <span class="hljs-keyword">await</span> imageSource.<span class="hljs-title function_">release</span>();</li><li>    <span class="hljs-keyword">return</span> createPixelMap;</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-literal">undefined</span>, { <span class="hljs-attr">controller</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller1</span> }).<span class="hljs-title function_">height</span>(<span class="hljs-number">100</span>)</li><li>      <span class="hljs-title class_">Row</span>() {</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">"添加属性字符串"</span>).<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-keyword">let</span> <span class="hljs-attr">mutableStyledString1</span>: <span class="hljs-title class_">MutableStyledString</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MutableStyledString</span>(<span class="hljs-string">"属性字符串"</span>, [{</li><li>            <span class="hljs-attr">start</span>: <span class="hljs-number">0</span>,</li><li>            <span class="hljs-attr">length</span>: <span class="hljs-number">6</span>,</li><li>            <span class="hljs-attr">styledKey</span>: <span class="hljs-title class_">StyledStringKey</span>.<span class="hljs-property">FONT</span>,</li><li>            <span class="hljs-attr">styledValue</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextStyle</span>({ <span class="hljs-attr">fontColor</span>: <span class="hljs-title class_">Color</span>.<span class="hljs-property">Green</span>, <span class="hljs-attr">fontSize</span>: <span class="hljs-title class_">LengthMetrics</span>.<span class="hljs-title function_">px</span>(<span class="hljs-number">50</span>) })</li><li>          }]);</li><li>          <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">imagePixelMap</span> !== <span class="hljs-literal">undefined</span>) {</li><li>            <span class="hljs-keyword">let</span> mutableStyledString2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MutableStyledString</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ImageAttachment</span>({</li><li>              <span class="hljs-attr">value</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">imagePixelMap</span>,</li><li>              <span class="hljs-attr">size</span>: { <span class="hljs-attr">width</span>: <span class="hljs-number">50</span>, <span class="hljs-attr">height</span>: <span class="hljs-number">50</span> },</li><li>            }));</li><li>            mutableStyledString1.<span class="hljs-title function_">appendStyledString</span>(mutableStyledString2);</li><li>          }</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">styledString</span> = mutableStyledString1;</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller1</span>.<span class="hljs-title function_">setStyledString</span>(mutableStyledString1);</li><li>        }).<span class="hljs-title function_">margin</span>(<span class="hljs-number">5</span>)</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">"toHtml"</span>).<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">html</span> = <span class="hljs-title class_">StyledString</span>.<span class="hljs-title function_">toHtml</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">styledString</span>);</li><li>        }).<span class="hljs-title function_">margin</span>(<span class="hljs-number">5</span>)</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">"fromHtml"</span>).<span class="hljs-title function_">onClick</span>(<span class="hljs-keyword">async</span> () =&gt; {</li><li>          <span class="hljs-keyword">let</span> styledString = <span class="hljs-keyword">await</span> <span class="hljs-title class_">StyledString</span>.<span class="hljs-title function_">fromHtml</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">html</span>);</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller2</span>.<span class="hljs-title function_">setStyledString</span>(styledString);</li><li>        }).<span class="hljs-title function_">margin</span>(<span class="hljs-number">5</span>)</li><li>      }</li><li>
</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-literal">undefined</span>, { <span class="hljs-attr">controller</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller2</span> }).<span class="hljs-title function_">height</span>(<span class="hljs-number">100</span>)</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">html</span>)</li><li>    }.<span class="hljs-title function_">width</span>(<span class="hljs-string">"100%"</span>)</li><li>  }</li><li>}</li></ol></pre></div></div>     <p><span><img originheight="366" originwidth="363" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114850.14952464799351778176957762008454:50001231000000:2800:DCB7C812A4751335262EE5E45AB4E41DD08071E3F6F9942EFCD6AD3C957E28AF.gif" width="363" height="366"></span></p>     <ul>      <li>       <p>将HTML中&lt;strong&gt;、&lt;b&gt;、&lt;a&gt;、&lt;i&gt;、&lt;em&gt;、&lt;s&gt;、&lt;u&gt;、&lt;del&gt;、&lt;sup&gt;、&lt;sub&gt;标签及其style属性中的background-color转换为属性字符串并转回HTML。</p>       <div _ngcontent-rbe-c106="" class="highlight-div"><div _ngcontent-rbe-c106="" class="highlight-div-header"><div _ngcontent-rbe-c106="" class="highlight-div-header-left"><div _ngcontent-rbe-c106="" class="handle-button expand-button"><div _ngcontent-rbe-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rbe-c106="" class="highlight-div-header-right"><div _ngcontent-rbe-c106="" class="handle-button ai-button"></div><div _ngcontent-rbe-c106="" class="handle-button line-button"><div _ngcontent-rbe-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rbe-c106="" class="handle-button theme-button"><div _ngcontent-rbe-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rbe-c106="" class="handle-button copy-button"><div _ngcontent-rbe-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rbe-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// xxx.ets</span></li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">HtmlSpanStringDemo</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">html</span>: <span class="hljs-built_in">string</span> =</li><li>    <span class="hljs-string">"&lt;p&gt;This is &lt;b&gt;b&lt;/b&gt; &lt;strong&gt;strong&lt;/strong&gt; &lt;em&gt;em&lt;/em&gt; &lt;i&gt;i&lt;/i&gt; &lt;u&gt;u&lt;/u&gt; &lt;del&gt;del&lt;/del&gt; &lt;s&gt;s&lt;/s&gt; &lt;span style =   \"foreground-color:blue\"&gt; &lt;a href='https://www.example.com'&gt;www.example&lt;/a&gt; &lt;/span&gt; &lt;span   style=\"background-color: red;\"&gt;red span&lt;/span&gt; &lt;sup&gt;superscript&lt;/sup&gt; and &lt;sub&gt;subscript&lt;/sub&gt;&lt;/p&gt;"</span>;</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">spanString</span>: <span class="hljs-title class_">StyledString</span> | <span class="hljs-literal">undefined</span> = <span class="hljs-literal">undefined</span>;</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">resultText</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">""</span>; <span class="hljs-comment">// 保存结果文本的状态</span></li><li>  <span class="hljs-attr">controller</span>: <span class="hljs-title class_">TextController</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextController</span>;</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-comment">// 显示转换后的spanString</span></li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-literal">undefined</span>, { <span class="hljs-attr">controller</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span> }).<span class="hljs-title function_">height</span>(<span class="hljs-number">100</span>)</li><li>
</li><li>      <span class="hljs-comment">// TextArea显示每个步骤的结果</span></li><li>      <span class="hljs-title class_">TextArea</span>({ <span class="hljs-attr">text</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">html</span> })</li><li>        .<span class="hljs-title function_">width</span>(<span class="hljs-string">"100%"</span>)</li><li>        .<span class="hljs-title function_">height</span>(<span class="hljs-number">100</span>)</li><li>        .<span class="hljs-title function_">margin</span>(<span class="hljs-number">5</span>)</li><li>
</li><li>      <span class="hljs-comment">// 按钮1:将HTML转换为SpanString</span></li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">"Converted HTML to SpanString"</span>).<span class="hljs-title function_">onClick</span>(<span class="hljs-keyword">async</span> () =&gt; {</li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">spanString</span> = <span class="hljs-keyword">await</span> <span class="hljs-title class_">StyledString</span>.<span class="hljs-title function_">fromHtml</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">html</span>);</li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span>.<span class="hljs-title function_">setStyledString</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">spanString</span>);</li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">resultText</span> = <span class="hljs-string">"Converted HTML to SpanString successfully."</span>;</li><li>      }).<span class="hljs-title function_">margin</span>(<span class="hljs-number">5</span>)</li><li>
</li><li>      <span class="hljs-comment">// 按钮2:将SpanString转换为HTML</span></li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">"Converted SpanString to HTML"</span>).<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">spanString</span>) {</li><li>          <span class="hljs-comment">// 将spanString转换为HTML并替换当前的HTML状态</span></li><li>          <span class="hljs-keyword">const</span> newHtml = <span class="hljs-title class_">StyledString</span>.<span class="hljs-title function_">toHtml</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">spanString</span>);</li><li>          <span class="hljs-keyword">if</span> (newHtml !== <span class="hljs-variable language_">this</span>.<span class="hljs-property">html</span>) { <span class="hljs-comment">// 通过检查内容是否已经相同来防止重复</span></li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">html</span> = newHtml;</li><li>          }</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">resultText</span> = <span class="hljs-string">"Converted SpanString to HTML successfully."</span>;</li><li>        } <span class="hljs-keyword">else</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">resultText</span> = <span class="hljs-string">"SpanString is undefined."</span>;</li><li>        }</li><li>      }).<span class="hljs-title function_">margin</span>(<span class="hljs-number">5</span>)</li><li>
</li><li>      <span class="hljs-comment">// 按钮3:将HTML转换回SpanString</span></li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">"Converted HTML back to SpanString"</span>).<span class="hljs-title function_">onClick</span>(<span class="hljs-keyword">async</span> () =&gt; {</li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">spanString</span> = <span class="hljs-keyword">await</span> <span class="hljs-title class_">StyledString</span>.<span class="hljs-title function_">fromHtml</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">html</span>);</li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span>.<span class="hljs-title function_">setStyledString</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">spanString</span>);</li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">resultText</span> = <span class="hljs-string">"Converted HTML back to SpanString successfully."</span>;</li><li>      }).<span class="hljs-title function_">margin</span>(<span class="hljs-number">5</span>)</li><li>
</li><li>      <span class="hljs-comment">// 重置：重置HTML和SpanString</span></li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">"Reset"</span>).<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">html</span> =</li><li>          <span class="hljs-string">"&lt;p&gt;This is &lt;b&gt;b&lt;/b&gt; &lt;strong&gt;strong&lt;/strong&gt; &lt;em&gt;em&lt;/em&gt; &lt;i&gt;i&lt;/i&gt; &lt;u&gt;u&lt;/u&gt; &lt;del&gt;del&lt;/del&gt; &lt;s&gt;s&lt;/s&gt; &lt;span   style = \"foreground-color:blue\"&gt; &lt;a href='https://www.example.com'&gt;www.example&lt;/a&gt; &lt;/span&gt; &lt;span   style=\"background-color: red;\"&gt;red span&lt;/span&gt; &lt;sup&gt;superscript&lt;/sup&gt; and &lt;sub&gt;subscript&lt;/sub&gt;&lt;/p&gt;"</span>;</li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">spanString</span> = <span class="hljs-literal">undefined</span>;</li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span>.<span class="hljs-title function_">setStyledString</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">StyledString</span>(<span class="hljs-string">""</span>)); <span class="hljs-comment">// 使用空的StyledString实例</span></li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">resultText</span> = <span class="hljs-string">"Reset HTML and SpanString successfully."</span>;</li><li>      }).<span class="hljs-title function_">margin</span>(<span class="hljs-number">5</span>)</li><li>    }.<span class="hljs-title function_">width</span>(<span class="hljs-string">"100%"</span>).<span class="hljs-title function_">padding</span>(<span class="hljs-number">20</span>)</li><li>  }</li><li>}</li></ol></pre></div></div>       <p><span><img originheight="369" originwidth="390" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114850.01742845341455522888666005294664:50001231000000:2800:1A36473AA60E0E14972C0A48AE9805378A112A6EA40F6E780817200FD43CAAD1.gif" width="390" height="369"></span></p></li>     </ul>    </div>    <div class="tiledSection">     <h2 id="场景示例">场景示例<i class="anchor-icon anchor-icon-link" anchorid="场景示例" tips="复制节点链接"></i></h2>          <p>该示例通过ParagraphStyle、LineHeightStyle、TextStyle对象展示了会员过期提示的效果。</p>     <div _ngcontent-rbe-c106="" class="highlight-div"><div _ngcontent-rbe-c106="" class="highlight-div-header"><div _ngcontent-rbe-c106="" class="highlight-div-header-left"><div _ngcontent-rbe-c106="" class="handle-button expand-button"><div _ngcontent-rbe-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rbe-c106="" class="highlight-div-header-right"><div _ngcontent-rbe-c106="" class="handle-button ai-button"></div><div _ngcontent-rbe-c106="" class="handle-button line-button"><div _ngcontent-rbe-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rbe-c106="" class="handle-button theme-button"><div _ngcontent-rbe-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rbe-c106="" class="handle-button copy-button"><div _ngcontent-rbe-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rbe-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">LengthMetrics</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-attr">alignCenterParagraphStyleAttr</span>: <span class="hljs-title class_">ParagraphStyle</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ParagraphStyle</span>({ <span class="hljs-attr">textAlign</span>: <span class="hljs-title class_">TextAlign</span>.<span class="hljs-property">Center</span> });</li><li>  <span class="hljs-comment">// 行高样式对象</span></li><li>  <span class="hljs-attr">lineHeightStyle1</span>: <span class="hljs-title class_">LineHeightStyle</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LineHeightStyle</span>(<span class="hljs-title class_">LengthMetrics</span>.<span class="hljs-title function_">vp</span>(<span class="hljs-number">24</span>));</li><li>  <span class="hljs-comment">// Bold样式</span></li><li>  <span class="hljs-attr">boldTextStyle</span>: <span class="hljs-title class_">TextStyle</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextStyle</span>({ <span class="hljs-attr">fontWeight</span>: <span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span> });</li><li>  <span class="hljs-comment">// 创建含段落样式的对象paragraphStyledString1</span></li><li>  <span class="hljs-attr">paragraphStyledString1</span>: <span class="hljs-title class_">MutableStyledString</span> =</li><li>    <span class="hljs-keyword">new</span> <span class="hljs-title class_">MutableStyledString</span>(<span class="hljs-string">"您的豪华钻石已过期1天\n续费可继续享受会员专属权益"</span>, [</li><li>      {</li><li>        <span class="hljs-attr">start</span>: <span class="hljs-number">0</span>,</li><li>        <span class="hljs-attr">length</span>: <span class="hljs-number">4</span>,</li><li>        <span class="hljs-attr">styledKey</span>: <span class="hljs-title class_">StyledStringKey</span>.<span class="hljs-property">PARAGRAPH_STYLE</span>,</li><li>        <span class="hljs-attr">styledValue</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">alignCenterParagraphStyleAttr</span></li><li>      },</li><li>      {</li><li>        <span class="hljs-attr">start</span>: <span class="hljs-number">0</span>,</li><li>        <span class="hljs-attr">length</span>: <span class="hljs-number">4</span>,</li><li>        <span class="hljs-attr">styledKey</span>: <span class="hljs-title class_">StyledStringKey</span>.<span class="hljs-property">LINE_HEIGHT</span>,</li><li>        <span class="hljs-attr">styledValue</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">LineHeightStyle</span>(<span class="hljs-title class_">LengthMetrics</span>.<span class="hljs-title function_">vp</span>(<span class="hljs-number">40</span>))</li><li>      },</li><li>      {</li><li>        <span class="hljs-attr">start</span>: <span class="hljs-number">11</span>,</li><li>        <span class="hljs-attr">length</span>: <span class="hljs-number">14</span>,</li><li>        <span class="hljs-attr">styledKey</span>: <span class="hljs-title class_">StyledStringKey</span>.<span class="hljs-property">FONT</span>,</li><li>        <span class="hljs-attr">styledValue</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextStyle</span>({ <span class="hljs-attr">fontSize</span>: <span class="hljs-title class_">LengthMetrics</span>.<span class="hljs-title function_">vp</span>(<span class="hljs-number">14</span>), <span class="hljs-attr">fontColor</span>: <span class="hljs-title class_">Color</span>.<span class="hljs-property">Grey</span> })</li><li>      },</li><li>      {</li><li>        <span class="hljs-attr">start</span>: <span class="hljs-number">11</span>,</li><li>        <span class="hljs-attr">length</span>: <span class="hljs-number">4</span>,</li><li>        <span class="hljs-attr">styledKey</span>: <span class="hljs-title class_">StyledStringKey</span>.<span class="hljs-property">PARAGRAPH_STYLE</span>,</li><li>        <span class="hljs-attr">styledValue</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">alignCenterParagraphStyleAttr</span></li><li>      },</li><li>      {</li><li>        <span class="hljs-attr">start</span>: <span class="hljs-number">11</span>,</li><li>        <span class="hljs-attr">length</span>: <span class="hljs-number">4</span>,</li><li>        <span class="hljs-attr">styledKey</span>: <span class="hljs-title class_">StyledStringKey</span>.<span class="hljs-property">LINE_HEIGHT</span>,</li><li>        <span class="hljs-attr">styledValue</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">lineHeightStyle1</span></li><li>      }</li><li>    ]);</li><li>  <span class="hljs-attr">paragraphStyledString2</span>: <span class="hljs-title class_">MutableStyledString</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MutableStyledString</span>(<span class="hljs-string">"\n￥4.88￥15"</span>, [</li><li>    {</li><li>      <span class="hljs-attr">start</span>: <span class="hljs-number">0</span>,</li><li>      <span class="hljs-attr">length</span>: <span class="hljs-number">4</span>,</li><li>      <span class="hljs-attr">styledKey</span>: <span class="hljs-title class_">StyledStringKey</span>.<span class="hljs-property">PARAGRAPH_STYLE</span>,</li><li>      <span class="hljs-attr">styledValue</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">alignCenterParagraphStyleAttr</span></li><li>    },</li><li>    {</li><li>      <span class="hljs-attr">start</span>: <span class="hljs-number">0</span>,</li><li>      <span class="hljs-attr">length</span>: <span class="hljs-number">4</span>,</li><li>      <span class="hljs-attr">styledKey</span>: <span class="hljs-title class_">StyledStringKey</span>.<span class="hljs-property">LINE_HEIGHT</span>,</li><li>      <span class="hljs-attr">styledValue</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">LineHeightStyle</span>(<span class="hljs-title class_">LengthMetrics</span>.<span class="hljs-title function_">vp</span>(<span class="hljs-number">60</span>))</li><li>    },</li><li>    {</li><li>      <span class="hljs-attr">start</span>: <span class="hljs-number">0</span>,</li><li>      <span class="hljs-attr">length</span>: <span class="hljs-number">6</span>,</li><li>      <span class="hljs-attr">styledKey</span>: <span class="hljs-title class_">StyledStringKey</span>.<span class="hljs-property">FONT</span>,</li><li>      <span class="hljs-attr">styledValue</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">boldTextStyle</span></li><li>    },</li><li>    {</li><li>      <span class="hljs-attr">start</span>: <span class="hljs-number">1</span>,</li><li>      <span class="hljs-attr">length</span>: <span class="hljs-number">1</span>,</li><li>      <span class="hljs-attr">styledKey</span>: <span class="hljs-title class_">StyledStringKey</span>.<span class="hljs-property">FONT</span>,</li><li>      <span class="hljs-attr">styledValue</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextStyle</span>({ <span class="hljs-attr">fontSize</span>: <span class="hljs-title class_">LengthMetrics</span>.<span class="hljs-title function_">vp</span>(<span class="hljs-number">18</span>) })</li><li>    },</li><li>    {</li><li>      <span class="hljs-attr">start</span>: <span class="hljs-number">2</span>,</li><li>      <span class="hljs-attr">length</span>: <span class="hljs-number">4</span>,</li><li>      <span class="hljs-attr">styledKey</span>: <span class="hljs-title class_">StyledStringKey</span>.<span class="hljs-property">FONT</span>,</li><li>      <span class="hljs-attr">styledValue</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextStyle</span>({ <span class="hljs-attr">fontSize</span>: <span class="hljs-title class_">LengthMetrics</span>.<span class="hljs-title function_">vp</span>(<span class="hljs-number">40</span>) })</li><li>    },</li><li>    {</li><li>      <span class="hljs-attr">start</span>: <span class="hljs-number">6</span>,</li><li>      <span class="hljs-attr">length</span>: <span class="hljs-number">3</span>,</li><li>      <span class="hljs-attr">styledKey</span>: <span class="hljs-title class_">StyledStringKey</span>.<span class="hljs-property">FONT</span>,</li><li>      <span class="hljs-attr">styledValue</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextStyle</span>({ <span class="hljs-attr">fontColor</span>: <span class="hljs-title class_">Color</span>.<span class="hljs-property">Grey</span>, <span class="hljs-attr">fontSize</span>: <span class="hljs-title class_">LengthMetrics</span>.<span class="hljs-title function_">vp</span>(<span class="hljs-number">14</span>) })</li><li>    },</li><li>    {</li><li>      <span class="hljs-attr">start</span>: <span class="hljs-number">6</span>,</li><li>      <span class="hljs-attr">length</span>: <span class="hljs-number">3</span>,</li><li>      <span class="hljs-attr">styledKey</span>: <span class="hljs-title class_">StyledStringKey</span>.<span class="hljs-property">DECORATION</span>,</li><li>      <span class="hljs-attr">styledValue</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">DecorationStyle</span>({ <span class="hljs-attr">type</span>: <span class="hljs-title class_">TextDecorationType</span>.<span class="hljs-property">LineThrough</span>, <span class="hljs-attr">color</span>: <span class="hljs-title class_">Color</span>.<span class="hljs-property">Grey</span> })</li><li>    }</li><li>  ]);</li><li>  <span class="hljs-attr">paragraphStyledString3</span>: <span class="hljs-title class_">MutableStyledString</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MutableStyledString</span>(<span class="hljs-string">"\n02时06分后将失去该优惠"</span>, [</li><li>    {</li><li>      <span class="hljs-attr">start</span>: <span class="hljs-number">0</span>,</li><li>      <span class="hljs-attr">length</span>: <span class="hljs-number">4</span>,</li><li>      <span class="hljs-attr">styledKey</span>: <span class="hljs-title class_">StyledStringKey</span>.<span class="hljs-property">PARAGRAPH_STYLE</span>,</li><li>      <span class="hljs-attr">styledValue</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">alignCenterParagraphStyleAttr</span></li><li>    },</li><li>    {</li><li>      <span class="hljs-attr">start</span>: <span class="hljs-number">0</span>,</li><li>      <span class="hljs-attr">length</span>: <span class="hljs-number">4</span>,</li><li>      <span class="hljs-attr">styledKey</span>: <span class="hljs-title class_">StyledStringKey</span>.<span class="hljs-property">LINE_HEIGHT</span>,</li><li>      <span class="hljs-attr">styledValue</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">LineHeightStyle</span>(<span class="hljs-title class_">LengthMetrics</span>.<span class="hljs-title function_">vp</span>(<span class="hljs-number">30</span>))</li><li>    },</li><li>    {</li><li>      <span class="hljs-attr">start</span>: <span class="hljs-number">1</span>,</li><li>      <span class="hljs-attr">length</span>: <span class="hljs-number">2</span>,</li><li>      <span class="hljs-attr">styledKey</span>: <span class="hljs-title class_">StyledStringKey</span>.<span class="hljs-property">FONT</span>,</li><li>      <span class="hljs-attr">styledValue</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextStyle</span>({ <span class="hljs-attr">fontColor</span>: <span class="hljs-string">'#FFD700'</span>, <span class="hljs-attr">fontWeight</span>: <span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span> })</li><li>    },</li><li>    {</li><li>      <span class="hljs-attr">start</span>: <span class="hljs-number">4</span>,</li><li>      <span class="hljs-attr">length</span>: <span class="hljs-number">2</span>,</li><li>      <span class="hljs-attr">styledKey</span>: <span class="hljs-title class_">StyledStringKey</span>.<span class="hljs-property">FONT</span>,</li><li>      <span class="hljs-attr">styledValue</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextStyle</span>({ <span class="hljs-attr">fontColor</span>: <span class="hljs-string">'#FFD700'</span>, <span class="hljs-attr">fontWeight</span>: <span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span> })</li><li>    }</li><li>  ]);</li><li>  <span class="hljs-attr">controller</span>: <span class="hljs-title class_">TextController</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextController</span>();</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Row</span>() {</li><li>      <span class="hljs-title class_">Column</span>({ <span class="hljs-attr">space</span>: <span class="hljs-number">5</span> }) {</li><li>        <span class="hljs-title class_">Text</span>(<span class="hljs-literal">undefined</span>, { <span class="hljs-attr">controller</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span> })</li><li>          .<span class="hljs-title function_">width</span>(<span class="hljs-number">240</span>)</li><li>          .<span class="hljs-title function_">copyOption</span>(<span class="hljs-title class_">CopyOptions</span>.<span class="hljs-property">InApp</span>)</li><li>          .<span class="hljs-title function_">draggable</span>(<span class="hljs-literal">true</span>)</li><li>          .<span class="hljs-title function_">onAppear</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">paragraphStyledString2</span>.<span class="hljs-title function_">appendStyledString</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">paragraphStyledString3</span>);</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">paragraphStyledString1</span>.<span class="hljs-title function_">appendStyledString</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">paragraphStyledString2</span>);</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span>.<span class="hljs-title function_">setStyledString</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">paragraphStyledString1</span>);</li><li>          })</li><li>
</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">"限时4.88元 立即续费"</span>)</li><li>          .<span class="hljs-title function_">width</span>(<span class="hljs-number">200</span>)</li><li>          .<span class="hljs-title function_">fontColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">White</span>)</li><li>          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">18</span>)</li><li>          .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">'#3CB371'</span>)</li><li>          .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">bottom</span>: <span class="hljs-number">10</span> })</li><li>      }</li><li>      .<span class="hljs-title function_">borderWidth</span>(<span class="hljs-number">1</span>).<span class="hljs-title function_">borderColor</span>(<span class="hljs-string">'#FFDEAD'</span>)</li><li>      .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">left</span>: <span class="hljs-number">10</span> })</li><li>    }</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'60%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div>     <p><span><img originheight="325" originwidth="367" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114850.48763528444190599269764093747400:50001231000000:2800:AADC798966916F044A85B482C1695B5B5899EC8673511A974604A0D4398718AE.png" width="367" height="325"></span></p>    </div>   </div>   <div></div></div>