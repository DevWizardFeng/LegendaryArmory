<h1 _ngcontent-yis-c119="" class="doc-title ng-star-inserted" title="常见问题FAQ"> 常见问题FAQ </h1>

<div _ngcontent-yis-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted renderOptimization" style="position: relative;"> <div id="body981235830193423"><div class="tiledSection" style="contain-intrinsic-size: auto 397px;"><h2 id="section1-ohpm-repo私仓工具获取与升级">ohpm-repo私仓工具获取与升级<i class="anchor-icon anchor-icon-link" anchorid="section1-ohpm-repo私仓工具获取与升级" tips="复制节点链接"></i></h2><ul id="ZH-CN_TOPIC_0000002510173705__ul483600186193423"><li id="li131594345133">从<a href="https://developer.huawei.com/consumer/cn/download/ohpm-repo" target="_blank">下载中心</a>上获取最新ohpm-repo工具包。<p id="ZH-CN_TOPIC_0000002510173705__p042614241369"></p> <p id="ZH-CN_TOPIC_0000002510173705__p1111519885214"><span><img height="229.191585" originheight="376" originwidth="1126" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104722.18898994441013373430130158586970:50001231000000:2800:26CC9C78B0E4A8EE3FA6AF721408190212CA74FD477E93B91C4D0BC38A116BD4.png" title="点击放大" width="671.268689"></span></p> </li><li id="li1436635119193423">ohpm-repo升级指导：在升级之前请务必进行好数据的备份，具体的升级指导文档见：<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-ohpm-repo-upgrade">ohpm-repo版本升级</a>。</li></ul> </div> <div class="tiledSection scroll-inwindow" style="contain-intrinsic-size: auto 304px;"><h2 id="section2-ohpm-repo启动后如何修改配置文件并使得修改后配置文件生效">ohpm-repo启动后如何修改配置文件，并使得修改后配置文件生效<i class="anchor-icon anchor-icon-link" anchorid="section2-ohpm-repo启动后如何修改配置文件并使得修改后配置文件生效" tips="复制节点链接"></i></h2><ul id="ZH-CN_TOPIC_0000002510173705__ul1790279643193423"><li id="li1029843153193423"><strong>版本1.0.1</strong>：停止当前ohpm-repo服务，修改ohpm-repo压缩包解压根目录中conf目录中的配置文件，然后重新执行start命令。</li><li id="li1721536074193423"><strong>版本1.1.0</strong>：停止当前ohpm-repo服务，修改部署根目录中conf目录下的配置文件，然后重新执行start命令。</li><li id="li1017271436193423"><strong>版本2.X.X</strong>：停止当前ohpm-repo服务，根据前一次ohpm-repo启动是否指定配置文件进行区别处理：<ul id="ZH-CN_TOPIC_0000002510173705__ul311773978193423"><li id="li616873357193423">上一次执行install命令指定配置文件：找到指定的配置文件进行修改，然后重新执行install，指定修改后配置文件，再执行start命令启动ohpm-repo。</li><li id="li606378832193423">上一次执行install命令未指定配置文件：未指定配置文件即默认使用压缩包解压目录中conf下的配置文件，则修改默认使用的配置文件，然后不指定配置文件执行install，再执行start启动ohpm-repo。</li></ul> </li></ul> </div> <div class="tiledSection scroll-inwindow" style="contain-intrinsic-size: auto 560px;"><h2 id="section3-ohpm-repo部署目录和ohpm-repo解压目录说明">ohpm-repo部署目录和ohpm-repo解压目录说明<i class="anchor-icon anchor-icon-link" anchorid="section3-ohpm-repo部署目录和ohpm-repo解压目录说明" tips="复制节点链接"></i></h2><ul id="ZH-CN_TOPIC_0000002510173705__ul14627901193423"><li id="li05341044173716"><p id="ZH-CN_TOPIC_0000002510173705__p165333440371"><strong>ohpm-repo解压目录</strong>：&lt;binary_root&gt;，ohpm-repo安装包解压后所在的根目录，存放的是ohpm-repo压缩包解压后的内容。</p> </li><li id="li529915940193423"><p id="ZH-CN_TOPIC_0000002510173705__p185394375193423"><strong>ohpm-repo部署目录</strong>：&lt;deploy_root&gt;，ohpm-repo运行时产生数据的存储位置，包括配置文件，日志文件，加密组件等信息。ohpm-repo部署目录在不同版本有不同的配置方法。</p> </li><li id="li171821196193423"><ul id="ZH-CN_TOPIC_0000002510173705__ul877583518193423"><li id="li1202253692193423">ohpm-repo 1.0.1版本：不支持自定义ohpm-repo部署目录，仅支持使用默认路径。</li><li id="li1257666606193423">ohpm-repo 1.1.0版本：在使用ohpm-repo start或ohpm-repo deploy命令时，支持通过配置--deploy_root参数来指定ohpm-repo的部署目录，不指定使用默认路径。</li><li id="li1282502591193423">ohpm-repo 2.X.X版本：<ul id="ZH-CN_TOPIC_0000002510173705__ul1385510678193423"><li id="li760155058193423">方法一：在配置文件中配置参数--deploy_root可指定ohpm-repo的部署目录，执行ohpm-repo install命令生效。</li><li id="li1468336785193423">方法二：使用ohpm-repo deploy命令部署多实例，支持通过配置--deploy_root参数来指定ohpm-repo的部署目录；不指定使用默认路径。</li></ul> </li></ul> <div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content"><p id="ZH-CN_TOPIC_0000002510173705__p15681514387">ohpm-repo部署目录默认路径如下：</p> <ul id="ZH-CN_TOPIC_0000002510173705__ul852566372193423"><li id="li2060419596193423"><strong>Windows系统默认路径</strong>：~/AppData/Roaming/Huawei/ohpm-repo</li><li id="li358986736193423"><strong>Linux/macOS系统默认路径</strong>: ~/ohpm-repo</li></ul> <p id="ZH-CN_TOPIC_0000002510173705__p1995013188188">ohpm-repo部署目录和ohpm-repo解压目录不要放在<strong>同一目录</strong>中。</p> </div></div></div> </li></ul> </div> <div class="tiledSection scroll-inwindow" style="contain-intrinsic-size: auto 80px;"><h2 id="section4-ohpm-repo-的权限管理">ohpm-repo 的权限管理<i class="anchor-icon anchor-icon-link" anchorid="section4-ohpm-repo-的权限管理" tips="复制节点链接"></i></h2></div> <div class="tiledSection scroll-inwindow" style="contain-intrinsic-size: auto 1411px;"><h3 id="section41-账户权限系统管理员和系统普通用户" class="firsth2">账户权限：系统管理员和系统普通用户<i class="anchor-icon anchor-icon-link" anchorid="section41-账户权限系统管理员和系统普通用户" tips="复制节点链接"></i></h3><ol id="ZH-CN_TOPIC_0000002510173705__ol780050767193423"><li id="li131349387193423"><p id="ZH-CN_TOPIC_0000002510173705__p1808895354193423"><strong>账户的注册</strong></p> <p id="ZH-CN_TOPIC_0000002510173705__p1291527169193423">ohpm-repo账户有两种类型：用户类型和管理员类型。ohpm-repo初次启动默认有一个管理员账户：账户名:admin；密码:12345Qq!。</p> <ul id="ZH-CN_TOPIC_0000002510173705__ul1794494662193423"><li id="li1069229442193423">通过ohpm-repo管理界面的注册按钮新增用户类型：<p id="ZH-CN_TOPIC_0000002510173705__p849594417388"><span><img height="239.095829" originheight="630" originwidth="1866" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104722.32336575576320520310951316683001:50001231000000:2800:14E70C93C61E0133FED3E8FF5B6CDC5E199C3A98ED5E2B2C25262ACBA06C139B.png" title="点击放大" width="708.225"></span></p> </li><li id="li1655496128193423">登录任一管理员账户，能够在ohpm-repo的用户管理界面新增用户并管理其他用户（删除用户，变更用户类型，重置密码）：<p id="ZH-CN_TOPIC_0000002510173705__p106279288408"><span><img height="392.158214" originheight="796" originwidth="1461" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104722.07239526907307517653519754105532:50001231000000:2800:AE2E2986FE4B0D493B14E8693BDD0CA08B2AF68D2A8DE125ED7FE01FA290EAC1.png" title="点击放大" width="707.613599"></span></p> <p id="ZH-CN_TOPIC_0000002510173705__p131004288405"></p> </li></ul> </li><li id="li1272765554193423"><strong>账户的权限说明</strong><ul id="ZH-CN_TOPIC_0000002510173705__ul1297584569193423"><li id="li1517458164193423">系统管理员：允许有多个系统管理员。<ul id="ZH-CN_TOPIC_0000002510173705__ul641672144193423"><li id="li658989650193423">用户管理：创建新用户，编辑用户类型，修改其他用户类型和重置其他用户密码。</li><li id="li111992327193423">仓库管理：编辑仓库，管理三方包（可以通过ohpm-repo管理界面直接发包），编辑uplink仓库和配置代理信息。</li><li id="li1559180950193423">系统设置：添加oh-package.json5检查规则，重置系统密钥和添加支持匿名化配置。</li><li id="li1826821191517">组织管理：查看所有组织信息，编辑或删除所管理组织，能够编辑所有组织的管理员。</li><li id="li77531752142710">操作日志：能够记录用户所有操作记录。</li><li id="li331824019193423">认证管理：支持公私钥认证和AccessToken认证。</li><li id="li162661048145715">包权限管理：支持对单个三方包配置精细化的权限控制，包含包的所有者、包的维护者和包的查看者。</li></ul> </li><li id="li1620018791193423">系统普通用户：允许有多个系统普通用户。<ul id="ZH-CN_TOPIC_0000002510173705__ul2082769820193423"><li id="li484157183193423">组织管理：查看所在组织列表，编辑或删除所管理组织信息。</li><li id="li1332276568193423">认证管理：支持公私钥认证和AccessToken认证。</li><li id="li155316231528">包权限管理：支持对单个三方包配置精细化的权限控制，包含包的所有者、包的维护者和包的查看者。</li></ul> </li></ul> </li></ol> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 2139px;"><h3 id="section42-组织权限组织成员和组织管理员">组织权限：组织成员和组织管理员<i class="anchor-icon anchor-icon-link" anchorid="section42-组织权限组织成员和组织管理员" tips="复制节点链接"></i></h3><ol id="ZH-CN_TOPIC_0000002510173705__ol1346286888193423"><li id="li286314192193423"><strong>组织创建与组织权限的编辑</strong><ul id="ZH-CN_TOPIC_0000002510173705__ul770326443193423"><li id="li1841642886193423">组织的新增和删除：登录系统管理员账户，在组织管理界面，通过新增按钮创建组织，当前系统管理员默认成为该组织的管理员；通过删除按钮删除组织。<p id="ZH-CN_TOPIC_0000002510173705__p181711835102511"><span><img height="468.965714" originheight="796" originwidth="1461" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104722.89093561824620527869236323194406:50001231000000:2800:1295D75E227AB11DE44B9B1A2A8F58E867067EAC7A649F691962069CBE95046C.png" title="点击放大" width="847.964775"></span></p> <p id="ZH-CN_TOPIC_0000002510173705__p6825193318292"></p> </li><li id="li307125527193423">组织普通成员的添加和删除：登录组织管理员的账户，在组织管理界面，选中需要添加用户的组织的详情按钮，然后在成员界面通过新增按钮添加组织成员，通过删除按钮删除组织成员。<p id="ZH-CN_TOPIC_0000002510173705__p10244207164212"><span><img height="471.958214" originheight="796" originwidth="1461" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104722.98092244128975368169215983207639:50001231000000:2800:0D34197D8E39034DAC6EE9489859871B30E9D407BF37C8E96CDA86D81F986982.png" title="点击放大" width="852.8316440000001"></span></p> </li><li id="li4307822131816">组织管理员的添加和删除：登录系统管理员账户，在组织管理界面，选中需要添加用户的组织的编辑组织管理员按钮，然后在编辑组织管理员界面通过新增组织管理员按钮添加组织管理员，通过删除按钮删除组织管理员。<p id="ZH-CN_TOPIC_0000002510173705__p8504134754220"><span><img height="473.906265" originheight="796" originwidth="1461" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104723.62381904238988963527863229360778:50001231000000:2800:B16AA59B9C0C133C63951BF568BEAD3A644A2A4B7D43B5A6E7A3F7729D383312.png" title="点击放大" width="858.8475000000001"></span></p> </li></ul> </li><li id="li806764684193423"><strong>组织的权限说明</strong><ul id="ZH-CN_TOPIC_0000002510173705__ul871724127193423"><li id="li908306425193423">组织用户：允许有多个组织用户。<ul id="ZH-CN_TOPIC_0000002510173705__ul1385872652193423"><li id="li1658258496193423">上传包：能够上传带有该组织的三方包</li><li id="li1312284707193423">下架包：能够下架成员自己上传的三方包</li></ul> </li><li id="li469020004193423">组织管理员：允许有多个组织管理员。<ul id="ZH-CN_TOPIC_0000002510173705__ul1952687335193423"><li id="li1792421647193423">上传包：能够上传带有该组织的三方包</li><li id="li1294974599193423">下架包：能够下架组织下所有成员上传的包</li><li id="li293259890193423">组织编辑：编辑所属组织，删除与组织管理员权限变更</li><li id="li1614401303193423">组织成员编辑：管理所属组织成员的添加与删除</li></ul> </li></ul> </li></ol> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 244px;"><h3 id="section43-上传包和卸载包权限管理">上传包和卸载包权限管理<i class="anchor-icon anchor-icon-link" anchorid="section43-上传包和卸载包权限管理" tips="复制节点链接"></i></h3><p id="ZH-CN_TOPIC_0000002510173705__p1544302627193423">三方包可以分为有组织的包和没有组织的包两类，上传和下架包可以通过ohpm-repo和ohpm命令行工具两种方式操作。</p> <ul id="ZH-CN_TOPIC_0000002510173705__ul227228992193423"><li id="li514188848193423">通过ohpm-repo管理界面中仓库管理上传和下架包：只有系统管理员才有此权限。<strong>有组织包管理</strong>：系统管理员可对所在组织的全部包执行上架与下架操作；<strong>无组织包管理</strong>：系统管理员可上架所有无组织包（注：无组织包的所有版本仅限单一用户上传），并拥有下架全部无组织包的权限。</li><li id="li2133048925193423">通过ohpm命令行工具上传和下架包：配置.ohpmrc文件时，无论采用公私钥认证还是AccessToken认证，认证信息配置会标识唯一的用户信息，对于带组织的包，能够上传和下架用户所属组织的所有包；对于无组织的包，能够上传和下架所有的包。</li></ul> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 80px;"><h2 id="section5-ohpm-repo-的元数据与三方包数据管理">ohpm-repo 的元数据与三方包数据管理<i class="anchor-icon anchor-icon-link" anchorid="section5-ohpm-repo-的元数据与三方包数据管理" tips="复制节点链接"></i></h2></div> <div class="tiledSection" style="contain-intrinsic-size: auto 220px;"><h3 id="section51-元数据与三方包数据介绍" class="firsth2">元数据与三方包数据介绍<i class="anchor-icon anchor-icon-link" anchorid="section51-元数据与三方包数据介绍" tips="复制节点链接"></i></h3><p id="ZH-CN_TOPIC_0000002510173705__p12225545193423">ohpm-repo的数据包括两部分：</p> <ul id="ZH-CN_TOPIC_0000002510173705__ul74891024132412"><li id="li20489224132419">元数据：ohpm-repo运行过程中生成的用户数据和上传包后包的描述数据，在配置文件中，通过在配置文件中db选项配置存储信息。</li><li id="li148952413244">三方包数据：ohpm-repo运行后，通过ohpm-repo管理界面和ohpm命令行工具发布三方包到ohpm-repo中后，三方包的包文件数据，通过在配置文件中store选项配置存储信息。</li></ul> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 396px;"><h3 id="section52-元数据和三方包数据存储方式介绍">元数据和三方包数据存储方式介绍<i class="anchor-icon anchor-icon-link" anchorid="section52-元数据和三方包数据存储方式介绍" tips="复制节点链接"></i></h3><ul id="ZH-CN_TOPIC_0000002510173705__ul451380922193423"><li id="li1694503040193423">元数据：可以存放在本地文件（fileDb）和mysql数据库（mysql）。</li><li id="li960029326193423">三方包数据：可以存放在本地文件（file storage）,sftp服务器（sftp storage）和自定义插件存储（custom storage，包括各种云存储）。<p id="ZH-CN_TOPIC_0000002510173705__p1826235175193423">元数据和三方包数据的存储方法不能够随意搭配，匹配规则和支持的ohpm-repo版本信息见下图：</p> <p id="ZH-CN_TOPIC_0000002510173705__p4181345421"><span><img height="123.61618500000002" originheight="166" originwidth="971" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104723.81281414504318769199870091571834:50001231000000:2800:9F4DAA7CFEB0AE3996CC6B434D4DA30EF5D0C73A96306FA4A640D5B76D4F8782.png" title="点击放大" width="723.1875"></span></p> <p id="ZH-CN_TOPIC_0000002510173705__p544139096193423">存储方式的变更：如果元数据和包数据的存储位置需要改变，可以通过数据迁移指导进行完成。</p> </li></ul> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 188px;"><h2 id="section6-ohpm-repo认证方式">ohpm-repo认证方式<i class="anchor-icon anchor-icon-link" anchorid="section6-ohpm-repo认证方式" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510173705__p1726067975193423">ohpm在执行publish，unpublish和dist-tags等需要修改ohpm-repo数据库内容命令时，需要获取读写权限才能够操作。</p> <p id="ZH-CN_TOPIC_0000002510173705__p148627122496">从ohpm-repo5.0.5版本开始，如果ohpm-repo配置不支持匿名访问，ohpm在执行install，info和update命令时需要通过AccessToken认证或者自定义AccessToken认证方法，正确配置读写/只读AccessToken信息获取读权限。</p> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 312px;"><h3 id="section61-认证方式说明" class="firsth2">认证方式说明<i class="anchor-icon anchor-icon-link" anchorid="section61-认证方式说明" tips="复制节点链接"></i></h3><ul id="ZH-CN_TOPIC_0000002510173705__ul1448028354193423"><li id="li734400008193423"><strong>证书认证：</strong>通过嵌入加密ssh证书进行身份验证，需要输入密码，获得读写权限。</li><li id="li1410456746193423"><strong>AccessToken认证(对接数据库中用户数据)：</strong>AccessToken是ohpm-repo 2.1.0版本新引入的认证机制（需配套使用1.6.0及以上版本的ohpm命令行工具），用户通过ohpm-repo界面生成Token，并将其配置至ohpm客户端配置文件中。在与ohpm-repo交互时，客户端会自动附带Token进行身份验证，实现免密认证。配置只读AccessToken获得读权限，配置读写AccessToken获得读写权限。</li><li id="li507036559193423"><strong>自定义AccessToken认证（对接自定义的用户数据）：</strong>AccessToken是ohpm-repo 2.3.0版本新引入的认证机制（需配套使用1.8.0及以上版本的ohpm命令行工具），如果开发者不想把用户的数据存储在所配置的db存储路径中，可以<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-custom-auth-plugin">自定义认证插件</a>，对接自定义的用户数据。AccessToken的有效性由自定义的用户数据认证。配置只读AccessToken获得读权限，配置读写AccessToken获得读写权限。</li></ul> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 56px;"><h3 id="section62-认证失败faq">认证失败FAQ<i class="anchor-icon anchor-icon-link" anchorid="section62-认证失败faq" tips="复制节点链接"></i></h3></div> <div class="tiledSection" style="contain-intrinsic-size: auto 256px;"><h3 id="section621-使用证书认证执行publishunpublishdist-tags等命令失败">使用证书认证执行publish/unpublish/dist-tags等命令失败<i class="anchor-icon anchor-icon-link" anchorid="section621-使用证书认证执行publishunpublishdist-tags等命令失败" tips="复制节点链接"></i></h3><ul id="ZH-CN_TOPIC_0000002510173705__ul1798622040193423"><li id="li1773728379193423"><strong>现象</strong>：报错信息为：ERROR: Publish failed, detail: The "key_path" is empty - configure "key_path" in the .ohpmrc file.</li><li id="li315735634193423"><strong>原因分析</strong>：没有正确配置证书认证参数。</li><li id="li2087362749193423"><strong>解决方法</strong>：<ul id="ZH-CN_TOPIC_0000002510173705__ul522776283193423"><li id="li2083452124193423">确保通过ssh-keygen工具生成的公私钥文件是成对的。</li><li id="li1586500070193423">确保在ohpm-repo私仓管理界面配置公钥信息，在ohpm的配置文件.ohpmrc配置publish_id，publish_registry和key_path等参数。</li></ul> </li></ul> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 743px;"><h3 id="section622-使用证书认证在-git-bash-终端下执行-ohpm-publish-xxhar-发包到私仓中报错the-content-of-private-key-in-the-key_path-error">使用证书认证在git-bash终端下执行ohpm publish XX.har发包到ohpm-repo中报错：The content of private key in the key_path error<i class="anchor-icon anchor-icon-link" anchorid="section622-使用证书认证在-git-bash-终端下执行-ohpm-publish-xxhar-发包到私仓中报错the-content-of-private-key-in-the-key_path-error" tips="复制节点链接"></i></h3><ul id="ZH-CN_TOPIC_0000002510173705__ul516543334193423"><li id="li18140302193423"><strong>现象</strong>：在git-bash终端下运行ohpm publish命令出现 “The content of private key in the key_path error”错误，报错截图为：<p id="ZH-CN_TOPIC_0000002510173705__p124193824210"><span><img height="383.04" originheight="519" originwidth="709" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104723.50183801927621854839963148178856:50001231000000:2800:819B0B5B6BC2834194D7AD22B497199CA4E6DBED0C1F5CDF990B1FCCFE5AB10E.png" title="点击放大" width="523.6875"></span></p> </li><li id="li1101612654193423"><strong>原因分析</strong>：使用ohpm publish命令上传包时，此时如果使用ssh证书密码认证，程序需要通过TTY流读取用户输入的密码，git安装的版本过低其携带的git-bash会导致TTY流丢失，从而出现该错误。</li><li id="li1735240230193423"><strong>解决方法</strong>：<ul id="ZH-CN_TOPIC_0000002510173705__ul968399001193423"><li id="li1578704205193423">方法一：从git官网下载安装最新版本git，使用最新版本携带的git-bash终端进行操作。</li><li id="li637882403193423">方法二：在当前git安装目录下的etc目录中新增git-bash.config文件，git-bash.config文件里面添加一行MSYS=enable_pcon 配置。重新打开git-bash终端运行ohpm publish命令即可。</li></ul> </li></ul> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 352px;"><h3 id="section623-使用accesstoken认证执行publishunpublishdist-tags等命令失败">使用AccessToken认证，执行publish/unpublish/dist-tags等命令失败<i class="anchor-icon anchor-icon-link" anchorid="section623-使用accesstoken认证执行publishunpublishdist-tags等命令失败" tips="复制节点链接"></i></h3><ul id="ZH-CN_TOPIC_0000002510173705__ul51639542193423"><li id="li1323510243193423"><strong>现象</strong>：报错信息为ERROR: Publish failed, detail: The "key_path" is empty - configure "key_path" in the .ohpmrc file.</li><li id="li1856196758193423"><strong>原因分析</strong>：没有正确配置AccessToken或者当前工具版本不支持该功能。</li><li id="li1879479731193423"><strong>解决方法</strong>：<ul id="ZH-CN_TOPIC_0000002510173705__ul34280728193423"><li id="li1657938266193423">升级工具版本：从ohpm-repo2.1.0和ohpm 1.6.0版本起，开始支持AccessToken功能，确保ohpm-repo和ohpm升级到对应的版本。</li><li id="li762249468193423">在ohpm配置文件.ohpmrc中配置AccessToken错误，请遵循如下步骤完成配置：<ul id="ZH-CN_TOPIC_0000002510173705__ul753926354193423"><li id="li447146793193423">在ohpm客户端的配置文件.ohpmrc中新增一行//&lt;ip&gt;:&lt;port&gt;/repos/ohpm/:_auth=&lt;token&gt;</li><li id="li705274070193423"><em>//&lt;ip&gt;:&lt;port&gt;/repos/ohpm/</em>是客户端publish_registry去除协议名的部分url,&lt;token&gt;是生成的token。</li><li id="li1411870940193423">使用ohpm客户端执行publish等命令。</li></ul> </li></ul> </li></ul> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 452px;"><h2 id="section7-应用内-hsp-包是如何发布到私仓的">应用内hsp包如何发布到ohpm-repo<i class="anchor-icon anchor-icon-link" anchorid="section7-应用内-hsp-包是如何发布到私仓的" tips="复制节点链接"></i></h2><ol id="ZH-CN_TOPIC_0000002510173705__ol1237163448193423"><li id="li916037370193423">如果需要发布应用内hsp包到ohpm-repo，需要确保安装指定版本的软件：<ul id="ZH-CN_TOPIC_0000002510173705__ul1927249573193423"><li id="li477762858193423"><strong>ohpm-cli命令行工具</strong>：1.3.0版本开始支持。</li><li id="li534279265193423"><strong>DevEco Studio</strong>：4.1.0版本开始支持。</li><li id="li790448710193423"><strong>ohpm-repo私仓</strong>： 1.1.0版本开始支持。</li></ul> </li><li id="li1721239118193423">应用内hsp包不能直接发布在ohpm-repo，需要获得.tgz格式的包文件，再上传到ohpm-repo。</li><li id="li1392153780193423">有两种获得.tgz的方法：<ul id="ZH-CN_TOPIC_0000002510173705__ul609952997193423"><li id="li769324220193423">当使用DevEco Studio软件时，点击release发布，可获得.tgz包，具体步骤请参考：<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-hsp">开发动态共享包</a>。</li><li id="li755319172193423">如果已经获得了一个包的.hsp文件和.har文件，可在两个文件所在的目录中执行tar命令生成.tgz包文件：<div _ngcontent-yis-c106="" class="highlight-div"><div _ngcontent-yis-c106="" class="highlight-div-header"><div _ngcontent-yis-c106="" class="highlight-div-header-left"><div _ngcontent-yis-c106="" class="handle-button expand-button"><div _ngcontent-yis-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-yis-c106="" class="highlight-div-header-right"><div _ngcontent-yis-c106="" class="handle-button ai-button"></div><div _ngcontent-yis-c106="" class="handle-button line-button"><div _ngcontent-yis-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-yis-c106="" class="handle-button theme-button"><div _ngcontent-yis-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-yis-c106="" class="handle-button copy-button"><div _ngcontent-yis-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-yis-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" id="ZH-CN_TOPIC_0000002510173705__screen2083360923193423" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 打包 libhsp.har 和 libhsp.hsp 文件，生成 libhsp.tgz文件</span></li><li>tar -czvf libhsp.tgz libhsp.har libhsp.hsp</li></ol></pre></div></div> </li></ul> </li></ol> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 80px;"><h2 id="section8-ohpm-repo运行过程faq">执行ohpm-repo命令报错<i class="anchor-icon anchor-icon-link" anchorid="section8-ohpm-repo运行过程faq" tips="复制节点链接"></i></h2></div> <div class="tiledSection" style="contain-intrinsic-size: auto 270px;"><h3 id="section81-在执行ohpm-repo-install-或者-ohpm-repo-start-的时候报错server-install-failed-yamlexception-bad-indentation-of-a-mapping-entry" class="firsth2">在执行ohpm-repo install或者ohpm-repo start的时候报错：server install failed: YAMLException: bad indentation of a mapping entry<i class="anchor-icon anchor-icon-link" anchorid="section81-在执行ohpm-repo-install-或者-ohpm-repo-start-的时候报错server-install-failed-yamlexception-bad-indentation-of-a-mapping-entry" tips="复制节点链接"></i></h3><p id="ZH-CN_TOPIC_0000002510173705__p025212398431"><span><img height="130.130791" originheight="195" originwidth="1088" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104723.98076830634102188402049178581841:50001231000000:2800:190AB8C594332A55918FEE2AAB12DA67B6CF5893A85EF1FEC1CE218716ACF02A.png" title="点击放大" width="726.1800000000001"></span></p> <p id="ZH-CN_TOPIC_0000002510173705__p2109038262193423">ohpm-repo的配置文件config.yaml 中配置缩进格式不对，并且在报错信息中会提示出错误的位置。</p> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 184px;"><h3 id="section82-执行命令-ohpm-repo-command报错-ohpm-repo-不存在或者-command-命令不存在">执行命令ohpm-repo &lt;command&gt;，报错ohpm-repo不存在或者&lt;command&gt;命令不存在。<i class="anchor-icon anchor-icon-link" anchorid="section82-执行命令-ohpm-repo-command报错-ohpm-repo-不存在或者-command-命令不存在" tips="复制节点链接"></i></h3><ul id="ZH-CN_TOPIC_0000002510173705__ul1256034921193423"><li id="li1029082251193423"><strong>报错ohpm-repo不存在</strong>：ohpm-repo工具包解压目录中bin目录的路径没有配置到系统环境变量path中，需要手动添加<a href="/consumer/cn/doc/harmonyos-guides/ide-ohpm-repo-faq#section24117279211">系统环境变量</a>，或者进入bin目录，在命令前面加上 ./，即执行命令./ohpm-repo &lt;command&gt;方式使命令生效。</li><li id="li253834751193423"><strong>报错&lt;command&gt;命令不存在</strong>：查询当前ohpm-repo版本是否是2.X.X，部分命令2.0.0版本之后才存在，例如install和remove_instance。</li></ul> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 216px;"><h3 id="section83-ohpm-repo成功启动后根据配置文件中的-listen-值访问ohpm-repo私仓管理界面界面不显示信息或者无法打开页面">ohpm-repo成功启动后，根据配置文件中的listen值访问ohpm-repo私仓管理界面，界面不显示信息或者无法打开页面<i class="anchor-icon anchor-icon-link" anchorid="section83-ohpm-repo成功启动后根据配置文件中的-listen-值访问ohpm-repo私仓管理界面界面不显示信息或者无法打开页面" tips="复制节点链接"></i></h3><ul id="ZH-CN_TOPIC_0000002510173705__ul1755575194193423"><li id="li1260819171193423"><strong>可能性一</strong>：浏览器和ohpm-repo不兼容导致不显示内容，当ohpm-repo成功启动后，打开ohpm-repo管理页面并不显示内容，这可能是因为当前用户使用的浏览器与ohpm-repo不兼容，请下载最新版本的浏览器，重新输入listen值进行访问。</li><li id="li1417058252193423"><strong>可能性二</strong>：服务未启动，执行命令ohpm-repo install和ohpm-repo start，启动ohpm-repo私仓服务。</li><li id="li1133889893193423"><strong>可能性三</strong>：ohpm-repo私仓管理界面访问地址不正确，请在浏览器中输入ohpm-repo配置文件config.yaml中配置的listen值。</li></ul> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 639px;"><h3 id="section84-机器a部署ohpm-repo私仓服务在机器b上通过a的域名端口访问已部署的ohpm-repo私仓服务打开包的描述页出错">机器A部署ohpm-repo私仓服务，在机器B上通过A的域名+端口访问已部署的ohpm-repo私仓服务，打开包的描述页出错<i class="anchor-icon anchor-icon-link" anchorid="section84-机器a部署ohpm-repo私仓服务在机器b上通过a的域名端口访问已部署的ohpm-repo私仓服务打开包的描述页出错" tips="复制节点链接"></i></h3><ul id="ZH-CN_TOPIC_0000002510173705__ul1752559674193423"><li id="li935687872193423"><strong>现象</strong>：报错信息如下：<p id="ZH-CN_TOPIC_0000002510173705__p18438387440"><span><img height="367.49402900000007" originheight="571" originwidth="1136" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104723.99819856416015711244615076328609:50001231000000:2800:A0B7007C4E1C782DDA4ED48C06E86ABFFC944FA3A5996B1418B7BF738B8794FA.png" title="点击放大" width="731.1675"></span></p> </li><li id="li123775777193423"><strong>原因分析</strong>：部署ohpm-repo的机器没有配置server，使用的是默认的server，host为localhost，在其他机器中不能访问。</li><li id="li2064195975193423"><strong>解决方法</strong>：修改部署ohpm-repo机器A的配置文件，添加store.config.server的配置。建议手动修改host为本机的ip/域名，例如listen为0.0.0.0:8088，故server需配置为http://&lt;本机ip/域名&gt;:8088。</li></ul> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 80px;"><h3 id="section62937495216">执行ohpm-repo install时报错：fail to initialize encryption component: Error: invalid crypto component.<i class="anchor-icon anchor-icon-link" anchorid="section62937495216" tips="复制节点链接"></i></h3></div> <ul id="ZH-CN_TOPIC_0000002510173705__ul14541043152113"><li id="li93391318102318"><strong>现象</strong>：报错信息如下：<p id="ZH-CN_TOPIC_0000002510173705__p13374423122311"><span><img height="39.743326" originheight="51" originwidth="1417" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104723.58327749355055981824119107199454:50001231000000:2800:4FD98C4E321BC3EE452EF2B403682695A21FF68012DCBD5146503F1DA0E7A8B8.png" title="点击放大" width="776.0550000000001"></span></p> </li><li id="li95484372118"><strong>原因分析</strong>：在ohpm-repo私仓部署根目录deploy_root中，加密组件meta文件受到损坏，处于失效状态。ohpm-repo私仓中，uplink的代理地址信息和证书认证的公钥信息均通过meta加密组件进行加密存储。</li><li id="li135474319218"><strong>解决方法</strong>：<ul id="ZH-CN_TOPIC_0000002510173705__ul664764712264"><li id="li10313047182612">如果是版本升级导致的问题，请找回上一个版本中meta文件，替换当前版本的meta文件。</li><li id="li5336394819">其他原因导致meta文件损坏，需要执行如下步骤：<ol id="ZH-CN_TOPIC_0000002510173705__ol1256005711112"><li id="li1956014571118">清空数据库中表publickey和uplinkproxy中的内容（操作数据库前请提前备份，避免误删数据影响开发）。</li><li id="li5560857013">删除受损的meta文件。</li><li id="li20560957418">重新执行ohpm-repo install命令，生成新的meta文件。</li><li id="li656015576118">在ohpm-repo管理界面的仓库管理处，重新配置uplink的代理信息。</li><li id="li18560135720111">在ohpm-repo管理界面的认证管理处，重新配置证书认证的公钥数据。</li></ol> </li></ul> </li></ul> <div class="tiledSection" style="contain-intrinsic-size: auto 80px;"><h2 id="section9-执行-ohpm-publish-xxhar-发包到私仓中报错">执行ohpm publish XX.har发包到ohpm-repo私仓中报错<i class="anchor-icon anchor-icon-link" anchorid="section9-执行-ohpm-publish-xxhar-发包到私仓中报错" tips="复制节点链接"></i></h2></div> <div class="tiledSection" style="contain-intrinsic-size: auto 388px;"><h3 id="section91-报错connect-econnrefused-18089" class="firsth2">报错：connect ECONNREFUSED ::1:8089<i class="anchor-icon anchor-icon-link" anchorid="section91-报错connect-econnrefused-18089" tips="复制节点链接"></i></h3><ul id="ZH-CN_TOPIC_0000002510173705__ul954590969193423"><li id="li1575088288193423"><strong>现象</strong>： 配置文件中store.config.server为http://Localhost:8089，其host为localhost，ohpm执行publish命令，命令行报如下错误<div _ngcontent-yis-c106="" class="highlight-div"><div _ngcontent-yis-c106="" class="highlight-div-header"><div _ngcontent-yis-c106="" class="highlight-div-header-left"><div _ngcontent-yis-c106="" class="handle-button expand-button"><div _ngcontent-yis-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-yis-c106="" class="highlight-div-header-right"><div _ngcontent-yis-c106="" class="handle-button ai-button"></div><div _ngcontent-yis-c106="" class="handle-button line-button"><div _ngcontent-yis-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-yis-c106="" class="handle-button theme-button"><div _ngcontent-yis-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-yis-c106="" class="handle-button copy-button"><div _ngcontent-yis-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-yis-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-less" id="ZH-CN_TOPIC_0000002510173705__screen1847633569193423" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-selector-tag">ohpm</span> <span class="hljs-selector-tag">ERROR</span> <span class="hljs-selector-tag">request</span> <span class="hljs-selector-tag">to</span> <span class="hljs-selector-tag">http</span>:<span class="hljs-comment">//Localhost:8089/repos/ohpm/Login failed, reason: connect ECONNREFUSED ::1:8089</span></li></ol></pre></div></div> </li><li id="li1840682528193423"><strong>原因：</strong> 通过报错信息最后的listen值::1:8089可知：localhost没有被正确解析为127.0.0.1，而是被解析为::1，这是因为iPv6协议优先级大于iPv4协议，故localhost解析为 ::1 (127.0.0.1 ipv6的形式)。</li><li id="li1032892504193423"><strong>解决方法</strong>：<ul id="ZH-CN_TOPIC_0000002510173705__ul888286923193423"><li id="li252676123193423">方法一：修改iPv4的解析优先级，使其大于iPv6的优先级。</li><li id="li455381560193423">方法二：把server中的localhost修改为127.0.0.1。</li></ul> </li></ul> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 244px;"><h3 id="section92-报错the-content-of-private-key-in-the-key_path-error">报错：The content of private key in the key_path error.<i class="anchor-icon anchor-icon-link" anchorid="section92-报错the-content-of-private-key-in-the-key_path-error" tips="复制节点链接"></i></h3><ul id="ZH-CN_TOPIC_0000002510173705__ul1197164249193423"><li id="li839751558193423"><strong>现象</strong>：ohpm执行publish命令，命令行报错信息为：<div _ngcontent-yis-c106="" class="highlight-div"><div _ngcontent-yis-c106="" class="highlight-div-header"><div _ngcontent-yis-c106="" class="highlight-div-header-left"><div _ngcontent-yis-c106="" class="handle-button expand-button"><div _ngcontent-yis-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-yis-c106="" class="highlight-div-header-right"><div _ngcontent-yis-c106="" class="handle-button ai-button"></div><div _ngcontent-yis-c106="" class="handle-button line-button"><div _ngcontent-yis-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-yis-c106="" class="handle-button theme-button"><div _ngcontent-yis-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-yis-c106="" class="handle-button copy-button"><div _ngcontent-yis-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-yis-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-vbnet" id="ZH-CN_TOPIC_0000002510173705__screen830504312193423" data-highlighted="yes"><ol class="linenums"><li>The content <span class="hljs-keyword">of</span> <span class="hljs-keyword">private</span> <span class="hljs-keyword">key</span> <span class="hljs-keyword">in</span> the key_path <span class="hljs-keyword">error</span>.</li></ol></pre></div></div> </li><li id="li225241267193423"><strong>解决方法</strong>：输入的密码错误，请重新输入或重新配置密钥。</li></ul> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 216px;"><h3 id="section93-报错httpcode-400-group-does-not-exist">报错：HttpCode 400 Group does not exist!<i class="anchor-icon anchor-icon-link" anchorid="section93-报错httpcode-400-group-does-not-exist" tips="复制节点链接"></i></h3><ul id="ZH-CN_TOPIC_0000002510173705__ul2014212851193423"><li id="li1299354243193423"><p id="ZH-CN_TOPIC_0000002510173705__p884013408193423"><strong>现象</strong>：ohpm执行publish命令，命令行报错信息为</p> <p id="ZH-CN_TOPIC_0000002510173705__p16631759184416">HttpCode 400 Group does not exist!</p> </li><li id="li996620164615"><strong>解决方法</strong>：有一些三方包包含组织名，只有发布包的用户在该组织下才具有发包的能力。报错信息表明三方包具有组织名，但组织未被创建。在ohpm中包的命名格式为：@&lt;group&gt;/&lt;package_name&gt;，其中&lt;group&gt;为组织名，打开ohpm-repo管理界面，添加组织即可成功发布包。</li></ul> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 217px;"><h3 id="section94-报错httpcode-400-you-are-not-a-developer-of-the-group">报错：HttpCode 400 You are not a developer of the group!<i class="anchor-icon anchor-icon-link" anchorid="section94-报错httpcode-400-you-are-not-a-developer-of-the-group" tips="复制节点链接"></i></h3><ul id="ZH-CN_TOPIC_0000002510173705__ul331060205193423"><li id="li99174043193423"><strong>现象</strong>：ohpm执行publish命令，命令行报错信息为：<div _ngcontent-yis-c106="" class="highlight-div"><div _ngcontent-yis-c106="" class="highlight-div-header"><div _ngcontent-yis-c106="" class="highlight-div-header-left"><div _ngcontent-yis-c106="" class="handle-button expand-button"><div _ngcontent-yis-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-yis-c106="" class="highlight-div-header-right"><div _ngcontent-yis-c106="" class="handle-button ai-button"></div><div _ngcontent-yis-c106="" class="handle-button line-button"><div _ngcontent-yis-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-yis-c106="" class="handle-button theme-button"><div _ngcontent-yis-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-yis-c106="" class="handle-button copy-button"><div _ngcontent-yis-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-yis-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-sql" id="ZH-CN_TOPIC_0000002510173705__screen408303142193423" data-highlighted="yes"><ol class="linenums"><li>HttpCode <span class="hljs-number">400</span> You <span class="hljs-keyword">are</span> <span class="hljs-keyword">not</span> a developer <span class="hljs-keyword">of</span> the <span class="hljs-keyword">group</span><span class="hljs-operator">!</span></li></ol></pre></div></div> </li></ul> </div> <ul id="ZH-CN_TOPIC_0000002510173705__ul103108446465"><li id="li420154517460"><strong>解决方法</strong>：有一些三方包包含组织名，只有发布包的用户在该组织下才具有发包的能力。报错信息表明已经有管理员账户添加了该包组织，但是当前账户没有在该组织的成员里面。在ohpm中包的命名格式为@&lt;group&gt;/&lt;package_name&gt;，其中&lt;group&gt;为组织名，找到创建&lt;group&gt;组织的负责人账户，然后负责人账户登录ohpm-repo管理界面，进入组织的详情里，添加需要发包的账户为组织的成员，成员即可发布具有对应组织名的包。<p id="ZH-CN_TOPIC_0000002510173705__p7251159114415"><span><img height="401.135714" originheight="796" originwidth="1461" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104723.28906861813980259613678432384650:50001231000000:2800:54E78C5E6EBC3E4BFA7609C4CEFE6EFFB537CC8B1521D0FA9E41EC0A1A1AA902.png" title="点击放大" width="725.459805"></span></p> </li></ul> <div class="tiledSection" style="contain-intrinsic-size: auto 357px;"><h3 id="section95-报错ohpm-error-httpcode-404-not-found">报错：ohpm ERROR: HttpCode 404 Not Found<i class="anchor-icon anchor-icon-link" anchorid="section95-报错ohpm-error-httpcode-404-not-found" tips="复制节点链接"></i></h3><ul id="ZH-CN_TOPIC_0000002510173705__ul1645912843193423"><li id="li72182913193423"><strong>现象</strong>：ohpm执行publish命令，命令行报错信息如下：<div _ngcontent-yis-c106="" class="highlight-div"><div _ngcontent-yis-c106="" class="highlight-div-header"><div _ngcontent-yis-c106="" class="highlight-div-header-left"><div _ngcontent-yis-c106="" class="handle-button expand-button"><div _ngcontent-yis-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-yis-c106="" class="highlight-div-header-right"><div _ngcontent-yis-c106="" class="handle-button ai-button"></div><div _ngcontent-yis-c106="" class="handle-button line-button"><div _ngcontent-yis-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-yis-c106="" class="handle-button theme-button"><div _ngcontent-yis-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-yis-c106="" class="handle-button copy-button"><div _ngcontent-yis-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-yis-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" id="ZH-CN_TOPIC_0000002510173705__screen1752743368193423" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-variable">ohpm</span> <span class="hljs-variable">ERROR</span>: <span class="hljs-title class_">HttpCode</span> <span class="hljs-number">404</span> <span class="hljs-title class_">Not</span> <span class="hljs-title class_">Found</span></li></ol></pre></div></div> </li><li id="li763369935193423"><strong>解决方法</strong>：ohpm配置文件中的配置项publish_registry配置错误，未配置端口或路径不全，正确的配置例如：<div _ngcontent-yis-c106="" class="highlight-div"><div _ngcontent-yis-c106="" class="highlight-div-header"><div _ngcontent-yis-c106="" class="highlight-div-header-left"><div _ngcontent-yis-c106="" class="handle-button expand-button"><div _ngcontent-yis-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-yis-c106="" class="highlight-div-header-right"><div _ngcontent-yis-c106="" class="handle-button ai-button"></div><div _ngcontent-yis-c106="" class="handle-button line-button"><div _ngcontent-yis-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-yis-c106="" class="handle-button theme-button"><div _ngcontent-yis-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-yis-c106="" class="handle-button copy-button"><div _ngcontent-yis-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-yis-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-bash" id="ZH-CN_TOPIC_0000002510173705__screen775421872193423" data-highlighted="yes"><ol class="linenums"><li>publish_registry = http://localhost:8089/repos/ohpm</li></ol></pre></div></div> </li></ul> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 317px;"><h3 id="section96-报错same-ohpm-package-is-exists">报错：Same ohpm package is exists!<i class="anchor-icon anchor-icon-link" anchorid="section96-报错same-ohpm-package-is-exists" tips="复制节点链接"></i></h3><ul id="ZH-CN_TOPIC_0000002510173705__ul1067568899193423"><li id="li2018001951193423"><strong>现象</strong>：ohpm执行publish命令，命令行报错信息为：Same ohpm package is exists!<p id="ZH-CN_TOPIC_0000002510173705__p54441111125013"><span><img height="69.39354800000001" originheight="75" originwidth="760" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104723.53087981387081858617045423571779:50001231000000:2800:61817B86E243B7EB9FB32B5674F8DE0FFEA89E171D9CD4283544387D00289779.png" title="点击放大" width="703.2375000000001"></span></p> </li><li id="li201402449193423"><strong>原因分析</strong>：对没有组织三方库进行升级时，只能由原来发包用户升级，不能变更其他用户升级。</li><li id="li18374198193423"><strong>解决方法</strong>：使用原来发包用户可以继续升级上传，不能变更用户对已经上传的包升级；如果需要支持不同用户升级上传包，包名必须带有组织名。</li></ul> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 192px;"><h3 id="section19389111819315">报错：Request Entity Too Large<i class="anchor-icon anchor-icon-link" anchorid="section19389111819315" tips="复制节点链接"></i></h3><ul id="ZH-CN_TOPIC_0000002510173705__ul1737992018312"><li id="li1379182018315"><strong>现象</strong>：ohpm执行publish命令，命令行报错信息为：Request Entity Too Large。</li><li id="li133791920143116"><strong>原因分析</strong>：当使用nginx作为反向代理服务器时，发送过大的包，超过了nginx配置中设置的client_max_body_size的限制。默认情况下，nginx设置此值为1MB。</li><li id="li19507855123212"><strong>解决方法</strong>：修改nginx中参数client_max_body_size的配置，设置一个与上架包相匹配的大小。</li></ul> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 256px;"><h3 id="section4105134582114">报错：The packageType is no equals the exists packageType!<i class="anchor-icon anchor-icon-link" anchorid="section4105134582114" tips="复制节点链接"></i></h3><ul id="ZH-CN_TOPIC_0000002510173705__ul11105745192115"><li id="li121051845142118"><strong>现象</strong>：ohpm执行publish命令，命令行报错信息为：The packageType is no equals the exists packageType!</li><li id="li171055456213"><strong>原因分析</strong>：当前上传包的包是一个har包，仓库中已经存在同名的hsp包，har包和hsp包不能够同名。</li><li id="li63783437558"><strong>解决方法</strong>：<ul id="ZH-CN_TOPIC_0000002510173705__ul67782437556"><li id="li112295468552">方法一：修改需要上传包的名称，避免与已经上传的hsp包同名；</li><li id="li11051145172118">方法二：下架已经上传的所有同名hsp包，然后再上传同名的har包（下架包后，再次上传同名的第三方包会受限并锁定一段时间，以防止滥用。您可以通过在config.yaml文件中设置upload_lock_hour参数来调整这个锁定期的时长）。</li></ul> </li></ul> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 80px;"><h2 id="section10-执行-ohpm-install-xxhar-从私仓中下载包报错">执行ohpm install XX.har从ohpm-repo私仓中下载包报错<i class="anchor-icon anchor-icon-link" anchorid="section10-执行-ohpm-install-xxhar-从私仓中下载包报错" tips="复制节点链接"></i></h2></div> <div class="tiledSection" style="contain-intrinsic-size: auto 969px;"><h3 id="section101-ohpm-repo配置uplink后执行install命令下载uplinks所配置仓库中的包失败" class="firsth2">ohpm-repo配置uplink后，执行install命令下载uplink所配置仓库中的包失败<i class="anchor-icon anchor-icon-link" anchorid="section101-ohpm-repo配置uplink后执行install命令下载uplinks所配置仓库中的包失败" tips="复制节点链接"></i></h3><ul id="ZH-CN_TOPIC_0000002510173705__ul350757480193423"><li id="li666057193423">当添加了uplink的时候，首先确认是否在管理仓库的地方，选用了新增的uplink，下图表示新增的uplink没有被选中，uplink处为空：<p id="ZH-CN_TOPIC_0000002510173705__p58469854612"><span><img height="347.789281" originheight="911" originwidth="1920" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104723.86946738306411735364204141716430:50001231000000:2800:9A757054D17C20000419AEDD9BDE826100FD966775D29354A468FC5351F2B21E.png" title="点击放大" width="719.1975"></span></p> </li><li id="li399106970193423">如果新增的uplink中存在所需的三方包，但是下载不下来，可能是需要配置uplink的代理信息，配置位置如下：<p id="ZH-CN_TOPIC_0000002510173705__p6537955154611"><span><img height="364.82964" originheight="911" originwidth="1920" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104723.42209684300909550240742274382500:50001231000000:2800:389474C79F65EBE1C4B759E2458AB1EC1FD8D76F8E0D78FA9A94D0FED8211E5D.png" title="点击放大" width="751.1175000000001"></span></p> </li></ul> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 80px;"><h2 id="section15971414154116">访问ohpm-repo私仓管理界面报错<i class="anchor-icon anchor-icon-link" anchorid="section15971414154116" tips="复制节点链接"></i></h2></div> <div class="tiledSection" style="contain-intrinsic-size: auto 56px;"><h3 id="section647310614313" class="firsth2">访问ohpm-repo私仓管理界面中页面功能，报错：非法请求<i class="anchor-icon anchor-icon-link" anchorid="section647310614313" tips="复制节点链接"></i></h3></div> <ul id="ZH-CN_TOPIC_0000002510173705__ul6906371838"><li id="li6917378313"><strong>现象</strong>：访问ohpm-repo私仓管理界面的页面功能，报错“非法请求”。<p id="ZH-CN_TOPIC_0000002510173705__p149241339114816"><span><img height="366.223214" originheight="601" originwidth="1253" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104723.92542660414544013472365492174440:50001231000000:2800:CA84E70F24D6F34FBCF79073A8BCA5C05AB1A39A115A58A5A8CD97A7BA069E0F.png" title="点击放大" width="753.964365"></span></p> <p id="ZH-CN_TOPIC_0000002510173705__p204339399488"></p> </li></ul> <ul id="ZH-CN_TOPIC_0000002510173705__ul15330161354216"><li id="li12330141364214"><strong>原因分析</strong>：在ohpm-repo私仓5.0.2版本中，新增接口防重放攻击机制，该机制将校验ohpm-repo私仓所有涉及修改数据请求中的时间戳。若请求携带的时间戳与服务器当前时间相差超过1分钟（超前或滞后），系统将拒绝该请求，并返回"非法请求"错误。</li><li id="li2529717144716"><strong>解决方法</strong>：为确保系统正常运行，请保持服务器与客户端浏览器时间同步。</li></ul> <div class="tiledSection" style="contain-intrinsic-size: auto 56px;"><h3 id="section836818106414">访问ohpm-repo私仓管理页面，报错“加密组件无效”。<i class="anchor-icon anchor-icon-link" anchorid="section836818106414" tips="复制节点链接"></i></h3></div> <ul id="ZH-CN_TOPIC_0000002510173705__ul10782162144220"><li id="li1218910591199"><strong>现象</strong>：打开ohpm-repo私仓管理界面，访问仓库管理页面中uplink代理配置页面，或访问认证管理页面中证书认证配置页面，报错“加密组件无效”，且已经配置的信息被清空。<p id="ZH-CN_TOPIC_0000002510173705__p20142122445314"><span><img height="307.90630500000003" originheight="632" originwidth="1256" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104723.55387221297002641175444862744690:50001231000000:2800:94EDFAD1CB8F3AAB6CF305E3284708EEDE312EF8214C98EE1FC77567E27A8E9D.png" title="点击放大" width="603.4875000000001"></span></p> <p id="ZH-CN_TOPIC_0000002510173705__p142401521507"><span><img height="333.305714" originheight="796" originwidth="1461" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104723.46619873877137998673027483833843:50001231000000:2800:AF22BD70A98CA3C2FECE573DBFEFA03CDB8618F96CE61A59E8333F23A0C64DD6.png" title="点击放大" width="606.235546"></span></p> </li><li id="li443711334545"><strong>原因</strong>：uplink代理的地址信息和证书认证的公钥信息存储均需要加密，加密组件为ohpm-repo私仓部署根目录deploy_root中的meta文件。如果加密时的meta文件和解密时的meta文件不一致，会导致解密数据失败。</li><li id="li102841935165617"><strong>解决方法</strong>：<ul id="ZH-CN_TOPIC_0000002510173705__ul18504914570"><li id="li143367775720">如果是版本升级导致的问题，请找回上一个版本中meta文件，替换当前版本的meta文件，保证加密组件的一致性。</li><li id="li0939246152">其他原因导致使用meta文件解密失败，需要执行如下步骤：<ol id="ZH-CN_TOPIC_0000002510173705__ol1989910207414"><li id="li98990201748">清空数据库中表publickey和uplinkproxy中的内容（操作数据库前请提前备份，避免误删数据影响开发）。</li><li id="li1890012010410">删除解密失败的meta文件。</li><li id="li18900192018420">重新执行ohpm-repo install命令，生成新的meta文件。</li><li id="li89006209412">在ohpm-repo管理界面的仓库管理处，重新配置uplink的代理信息。</li><li id="li7900520845">在ohpm-repo管理界面的认证管理处，重新配置证书认证的公钥数据。</li></ol> </li></ul> </li></ul> <div class="tiledSection" style="contain-intrinsic-size: auto 56px;"><h3 id="section790764185416">访问ohpm-repo私仓管理界面，报错：“系统配置错误，请联系管理员“<i class="anchor-icon anchor-icon-link" anchorid="section790764185416" tips="复制节点链接"></i></h3></div> <ul id="ZH-CN_TOPIC_0000002510173705__ul573663715011"><li id="li18736837175019"><strong>现象</strong>：访问ohpm-repo私仓管理界面，在ohpm-repo管理界面报错“非法请求”，在ohpm-repo运行日志报错：“verify reverse proxy usage: set "use_reverse_proxy" to false in config.yaml if not used, or refresh "x-forwarded-for" in Nginx if it is.”。<p id="ZH-CN_TOPIC_0000002510173705__p14558940125515"><span><img originheight="95" originwidth="320" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104723.98348404370671903170479595557614:50001231000000:2800:700DE169511091418045E92C1E9B3C7C78823DEBEEBB212FD867619E05B83F53.png" width="320" height="95"></span></p> <p id="ZH-CN_TOPIC_0000002510173705__p11390113985515"><span><img height="39.17567979506884" originheight="32" originwidth="1718" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104723.25106222269281867912455773690292:50001231000000:2800:5667AB3AD64B8D0ECEB2FBA947E358A922070457D0B0359E3B26F3730D35A189.png" title="点击放大" width="920"></span></p> </li></ul> <ul id="ZH-CN_TOPIC_0000002510173705__ul107376376502"><li id="li1128093325610"><strong>原因分析</strong>：在ohpm-repo私仓5.0.7版本中，配置文件新增配置项<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-ohpm-repo-configuration#section1074004784011">use_reverse_proxy</a>，用于判断是否已使用反向代理。如果配置use_reverse_proxy值为true，但未使用反向代理或者在配置反向代理时未刷新x-forwarded-for值，将导致从请求头获取到x-forwarded-for值为空，报此错误。</li><li id="li27371737165015"><strong>解决方法</strong>：只有已使用反向代理，才能够将配置项use_reverse_proxy置为true，且需要在反向代理配置时刷新x-forwarded-for值（如果存在多级代理，只需要在最外层代理配置），配置命令为：“proxy_set_header x-forwarded-for $remote_addr”。</li></ul> <div class="tiledSection" style="contain-intrinsic-size: auto 80px;"><h2 id="section24117279211">配置ohpm-repo私仓工具环境变量<i class="anchor-icon anchor-icon-link" anchorid="section24117279211" tips="复制节点链接"></i></h2></div> <div class="tiledSection" style="contain-intrinsic-size: auto 252px;"><h3 id="section1891346124118" class="firsth2"><strong>Windows环境</strong><i class="anchor-icon anchor-icon-link" anchorid="section1891346124118" tips="复制节点链接"></i></h3><ol id="ZH-CN_TOPIC_0000002510173705__ol172218239389"><li id="li2022023153819">在任务栏搜索框或开始菜单中，搜索“环境变量”，选择“<strong>编辑系统环境变量</strong>”。</li><li id="li1222152312383">在弹出的“系统属性”窗口中，点击右下角的“<strong>环境变量</strong>”按钮。</li></ol><ol id="ZH-CN_TOPIC_0000002510173705__ol922122315386" start="3"><li id="li921122316389">在弹出的“环境变量”窗口中，在系统变量中找到"<strong>Path</strong>" 变量。</li><li id="li621023153810">编辑Path变量，将ohpm-repo工具包解压目录下的bin目录路径添加到新的一行中。</li><li id="li1222182393810">连续点击所有打开的窗口上的“<strong>确定</strong>”，进行保存。</li><li id="li92212315384">重新打开命令行终端，即可使用 <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-ohpm-repo-command">ohpm-repo 相关命令</a>。</li></ol> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 525px;"><h3 id="section237813234214"><strong>Linux和macOS环境</strong><i class="anchor-icon anchor-icon-link" anchorid="section237813234214" tips="复制节点链接"></i></h3><ol id="ZH-CN_TOPIC_0000002510173705__ol344616157428"><li id="li1544612152425">打开命令行终端，执行以下命令编辑 .bashrc 文件。<div _ngcontent-yis-c106="" class="highlight-div"><div _ngcontent-yis-c106="" class="highlight-div-header"><div _ngcontent-yis-c106="" class="highlight-div-header-left"><div _ngcontent-yis-c106="" class="handle-button expand-button"><div _ngcontent-yis-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-yis-c106="" class="highlight-div-header-right"><div _ngcontent-yis-c106="" class="handle-button ai-button"></div><div _ngcontent-yis-c106="" class="handle-button line-button"><div _ngcontent-yis-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-yis-c106="" class="handle-button theme-button"><div _ngcontent-yis-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-yis-c106="" class="handle-button copy-button"><div _ngcontent-yis-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-yis-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-bash" id="ZH-CN_TOPIC_0000002510173705__screen14446111519428" data-highlighted="yes"><ol class="linenums"><li>vim ~/.bashrc</li></ol></pre></div></div> </li><li id="li444611517424">按 i 进入插入模式（底部显示 -- INSERT --）。</li><li id="li13446615104210">在文件末尾新起一行，添加以下内容：<div _ngcontent-yis-c106="" class="highlight-div"><div _ngcontent-yis-c106="" class="highlight-div-header"><div _ngcontent-yis-c106="" class="highlight-div-header-left"><div _ngcontent-yis-c106="" class="handle-button expand-button"><div _ngcontent-yis-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-yis-c106="" class="highlight-div-header-right"><div _ngcontent-yis-c106="" class="handle-button ai-button"></div><div _ngcontent-yis-c106="" class="handle-button line-button"><div _ngcontent-yis-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-yis-c106="" class="handle-button theme-button"><div _ngcontent-yis-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-yis-c106="" class="handle-button copy-button"><div _ngcontent-yis-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-yis-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-bash" id="ZH-CN_TOPIC_0000002510173705__screen20446191504212" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-built_in">export</span> PATH=<span class="hljs-string">"<span class="hljs-variable">$PATH</span>:[指定路径]"</span>  // 其中的[指定路径]请替换为 ohpm-repo 工具包解压目录中 bin 目录的路径</li></ol></pre></div></div> </li><li id="li1344681514216">按 Esc 键退出插入模式，输入 :wq 然后按 Enter 来保存并退出。</li><li id="li18446121517420">输入下面的命令使配置生效后，即可使用 <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-ohpm-repo-command">ohpm-repo 相关命令</a>。<div _ngcontent-yis-c106="" class="highlight-div"><div _ngcontent-yis-c106="" class="highlight-div-header"><div _ngcontent-yis-c106="" class="highlight-div-header-left"><div _ngcontent-yis-c106="" class="handle-button expand-button"><div _ngcontent-yis-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-yis-c106="" class="highlight-div-header-right"><div _ngcontent-yis-c106="" class="handle-button ai-button"></div><div _ngcontent-yis-c106="" class="handle-button line-button"><div _ngcontent-yis-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-yis-c106="" class="handle-button theme-button"><div _ngcontent-yis-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-yis-c106="" class="handle-button copy-button"><div _ngcontent-yis-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-yis-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-bash" id="ZH-CN_TOPIC_0000002510173705__screen19446815134217" data-highlighted="yes"><ol class="linenums"><li><strong><span class="hljs-built_in">source</span></strong> ~/.bashrc</li></ol></pre></div></div> </li></ol> </div> </div> <div></div></div>