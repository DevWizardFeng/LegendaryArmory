<h1 _ngcontent-puk-c119="" class="doc-title ng-star-inserted" title="应用冻屏事件介绍"> 应用冻屏事件介绍 </h1>

<div _ngcontent-puk-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <div class="tiledSection">     <h2 id="简介">简介<i class="anchor-icon anchor-icon-link" anchorid="简介" tips="复制节点链接"></i></h2>          <p>用户在使用应用时，如果出现点击无反应或应用无响应等情况，并且持续时间超过一定限制，就会被定义为应用冻屏，也被称为应用无响应。为了应对应用冻屏问题，系统会提供应用冻屏检测、维测日志抓取、日志上报的能力，为开发者提供详细的维测日志以辅助故障定位。</p>    </div>    <div class="tiledSection">     <h2 id="检测原理">检测原理<i class="anchor-icon anchor-icon-link" anchorid="检测原理" tips="复制节点链接"></i></h2>          <p>详见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/appfreeze-guidelines#检测原理">AppFreeze（应用冻屏）检测原理</a>。</p>    </div>    <div class="tiledSection">     <h2 id="接口说明">接口说明<i class="anchor-icon anchor-icon-link" anchorid="接口说明" tips="复制节点链接"></i></h2>          <p>开发者可以通过HiAppEvent提供接口订阅应用冻屏事件“hiAppEvent.event.APP_FREEZE”，系统检测到应用冻屏后，会抓取维测信息通过HiAppEvent将冻屏事件回调给应用进程。</p>     <ul>      <li>       <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/hiappevent-watcher-freeze-events-arkts">订阅应用冻屏事件（ArkTS）</a></p></li>      <li>       <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/hiappevent-watcher-freeze-events-ndk">订阅应用冻屏事件（C/C++）</a></p></li>     </ul>    </div>    <div class="tiledSection">     <h2 id="事件字段说明">事件字段说明<i class="anchor-icon anchor-icon-link" anchorid="事件字段说明" tips="复制节点链接"></i></h2>         </div>    <div class="tiledSection">     <h3 id="params字段说明" class="firsth2">params字段说明<i class="anchor-icon anchor-icon-link" anchorid="params字段说明" tips="复制节点链接"></i></h3>          <p>应用无响应事件信息中params属性的详细描述如下：</p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.5.3.1.4.1.1" valign="top" width="33.33333333333333%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.5.3.1.4.1.2" valign="top" width="33.33333333333333%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.5.3.1.4.1.3" valign="top" width="33.33333333333333%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">time</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">number</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">事件触发时间，单位为ms。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">foreground</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">boolean</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">应用是否处于前台状态。true表示应用处于前台；false表示应用处于后台。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">bundle_version</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">string</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">应用版本。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">bundle_name</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">string</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">应用名称。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">process_name</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">string</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">应用的进程名称。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">pid</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">number</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">应用的进程ID。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">uid</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">number</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">应用的用户ID。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">uuid</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">string</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">根据故障信息生成的故障特征码，用于标识特征相同的崩溃故障。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">exception</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">object</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">异常信息，详见exception属性。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">hilog</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">string[]</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">日志信息。当生成应用无响应事件日志时，从hilog缓冲区中获取最多100行故障进程日志信息。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">event_handler</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">string[]</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">主线程未处理消息。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">event_handler_size_3s</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">string</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/appfreeze-guidelines#thread_block_6s-应用主线程卡死超时">THREAD_BLOCK_6S事件</a>（仅在应用无响应事件生效）中3s时任务栈中任务数量。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">event_handler_size_6s</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">string</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/appfreeze-guidelines#thread_block_6s-应用主线程卡死超时">THREAD_BLOCK_6S事件</a>（仅在应用无响应事件生效）中6s时任务栈中任务数量。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">peer_binder</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">string[]</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">binder调用信息。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">threads</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">object[]</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">全量线程调用栈，详见thread属性。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">memory</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">object</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">内存信息，详见memory属性。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">external_log<sup>12+</sup></td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">string[]</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">故障日志文件路径。<strong>为避免目录空间超限（参考log_over_limit），导致新生成的日志文件写入失败，日志文件处理完后请及时删除。</strong></td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">log_over_limit<sup>12+</sup></td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">boolean</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">生成的故障日志文件与已存在的日志文件总大小是否超过5M上限。true表示超过上限，日志写入失败；false表示未超过上限。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h3 id="exception字段说明">exception字段说明<i class="anchor-icon anchor-icon-link" anchorid="exception字段说明" tips="复制节点链接"></i></h3>          <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.6.2.1.4.1.1" valign="top" width="33.33333333333333%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.6.2.1.4.1.2" valign="top" width="33.33333333333333%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.6.2.1.4.1.3" valign="top" width="33.33333333333333%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">name</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">string</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">异常类型</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">message</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">string</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">异常原因</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h3 id="thread字段说明">thread字段说明<i class="anchor-icon anchor-icon-link" anchorid="thread字段说明" tips="复制节点链接"></i></h3>          <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.7.2.1.4.1.1" valign="top" width="33.33333333333333%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.7.2.1.4.1.2" valign="top" width="33.33333333333333%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.7.2.1.4.1.3" valign="top" width="33.33333333333333%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">thread_name</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">string</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">线程名。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">tid</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">number</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">线程id。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">frames</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">object[]</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">线程调用栈，详见frame属性。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h3 id="frame字段说明">frame字段说明<i class="anchor-icon anchor-icon-link" anchorid="frame字段说明" tips="复制节点链接"></i></h3>          <p><strong>Native帧frame字段说明</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.8.3.1.4.1.1" valign="top" width="33.33333333333333%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.8.3.1.4.1.2" valign="top" width="33.33333333333333%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.8.3.1.4.1.3" valign="top" width="33.33333333333333%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">symbol</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">string</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">函数名称。<strong>名称长度超过256字节时将被删除，防止超长字符串引起未知问题。</strong></td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">file</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">string</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">文件名。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">buildId</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">string</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">文件唯一标识。<strong>文件可能没有buildId</strong>。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">pc</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">string</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">程序执行的指令在文件内的偏移十六进制字节数。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">offset</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">number</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">程序执行的指令在函数内偏移字节数。</td>        </tr>             </tbody></table></div>     </div>     <p>详细说明请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/cppcrash-guidelines#一般故障场景日志规格">调用栈帧内容说明</a>。</p>     <p><strong>Js帧frame字段说明</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.8.6.1.4.1.1" valign="top" width="33.33333333333333%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.8.6.1.4.1.2" valign="top" width="33.33333333333333%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.8.6.1.4.1.3" valign="top" width="33.33333333333333%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">file</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">string</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">文件名</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">packageName</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">string</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">模块的包名</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">symbol</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">string</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">函数名称</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">line</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">number</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">代码行号</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">column</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">number</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">代码列号</td>        </tr>             </tbody></table></div>     </div>     <p>详细说明请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/cppcrash-guidelines#一般故障场景日志规格">JS混合栈帧内容说明</a>。</p>    </div>    <div class="tiledSection">     <h3 id="memory字段说明">memory字段说明<i class="anchor-icon anchor-icon-link" anchorid="memory字段说明" tips="复制节点链接"></i></h3>          <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.9.2.1.4.1.1" valign="top" width="33.33333333333333%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.9.2.1.4.1.2" valign="top" width="33.33333333333333%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.9.2.1.4.1.3" valign="top" width="33.33333333333333%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">rss</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">number</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">进程实际占用内存大小，单位KB。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">vss</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">number</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">进程向系统申请的虚拟内存大小，单位KB。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">pss</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">number</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">进程实际使用的物理内存大小，单位KB。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">sys_free_mem</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">number</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">空闲内存大小，单位KB。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">sys_avail_mem</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">number</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">可用内存大小，单位KB。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">sys_total_mem</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">number</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">总内存大小，单位KB。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="应用冻屏规格自定义参数设置">应用冻屏规格自定义参数设置<i class="anchor-icon anchor-icon-link" anchorid="应用冻屏规格自定义参数设置" tips="复制节点链接"></i></h2>         </div>    <div class="tiledSection">     <h3 id="接口说明-1" class="firsth2">接口说明<i class="anchor-icon anchor-icon-link" anchorid="接口说明-1" tips="复制节点链接"></i></h3>          <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.11.2.1.3.1.1" valign="top" width="50%">接口名</th>         <th align="left" class="cellrowborder" id="mcps1.3.11.2.1.3.1.2" valign="top" width="50%">描述</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="50%">setEventParam(params: Record&lt;string, ParamType&gt;, domain: string, name?: string): Promise&lt;void&gt;</td>         <td class="cellrowborder" valign="top" width="50%"><strong>应用冻屏事件自定义参数设置方法。</strong></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h3 id="参数设置说明">参数设置说明<i class="anchor-icon anchor-icon-link" anchorid="参数设置说明" tips="复制节点链接"></i></h3>          <p>开发者可以通过该接口订阅name为hiAppEvent.event.APP_FREEZE的应用冻屏事件，具体使用详见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-hiviewdfx-hiappevent#hiappeventseteventparam12" target="_blank">setEventParam使用</a>。</p>    </div>   </div>   <div></div></div>