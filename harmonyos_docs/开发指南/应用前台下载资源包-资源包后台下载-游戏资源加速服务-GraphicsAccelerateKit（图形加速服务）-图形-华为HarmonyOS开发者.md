<h1 _ngcontent-ast-c119="" class="doc-title ng-star-inserted" title="应用前台下载资源包"> 应用前台下载资源包 </h1>

<div _ngcontent-ast-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p>启动游戏后，为游戏提供管理、创建资源包下载任务功能。</p>    <div class="tiledSection">     <h2 id="section153974301564">业务流程<i class="anchor-icon anchor-icon-link" anchorid="section153974301564" tips="复制节点链接"></i></h2>          <p><span><img originheight="631" originwidth="947" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114409.91668114429351358731706643881312:50001231000000:2800:FC20A9FAF509E03EB75162852F4B24FD8D8E32B8C826FE89B7E6B4FBCDF930FA.png" width="920" height="613.0095036958817"></span></p>    </div>    <ol>     <li>用户打开游戏App。</li>     <li>游戏调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/graphics-accelerate-assetdownloadmanager#section81101219425" target="_blank">fetchManifestUrl</a>方法，从游戏资源加速服务获取manifestUrl资源清单。</li>     <li>游戏根据manifestUrl获取资源包下载任务列表。若manifestUrl不为空，游戏从华为CDN获取资源包下载任务列表，若manifestUrl为空，从三方CDN获取资源包下载任务列表。</li>     <li>游戏向资源加速服务订阅资源包下载进度/状态事件。游戏调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/graphics-accelerate-assetdownloadmanager#section171317233391" target="_blank">on('progress')</a>方法，监听资源包下载进度。游戏调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/graphics-accelerate-assetdownloadmanager#section93468227013" target="_blank">on('pause')</a>方法，监听下载任务是否暂停。游戏调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/graphics-accelerate-assetdownloadmanager#section165201771441" target="_blank">on('complete')</a>方法，监听资源是否成功下载。游戏调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/graphics-accelerate-assetdownloadmanager#section22331871979" target="_blank">on('fail')</a>方法，监听下载任务是否失败。</li>     <li>游戏调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/graphics-accelerate-assetdownloadmanager#section104771151219" target="_blank">addAssetDownloadTask</a>方法，新增manifestUrl清单上的资源包下载任务。</li>     <li>游戏资源加速服务根据下载任务逐一下载资源包。</li>     <li>游戏资源加速服务每完成一个下载任务，均会向游戏通知当前任务的下载进度和下载状态。</li>     <li>若游戏接收到<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/graphics-accelerate-assetdownloadmanager#section171317233391" target="_blank">on('progress')</a>方法返回的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/graphics-accelerate-assetdownloadmanager#section13627145473413" target="_blank">DownloadCompletedInfo</a>，表示资源包下载成功，游戏可前往下载路径操作（例如转移、解压）资源文件。若游戏接收到<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/graphics-accelerate-assetdownloadmanager#section22331871979" target="_blank">on('fail')</a>方法返回的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/graphics-accelerate-assetdownloadmanager#section154451056193512" target="_blank">DownloadFailedInfo</a>，表示下载任务失败，游戏可以根据<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/graphics-accelerate-assetdownloadmanager#section82071855806" target="_blank">DownloadFault</a>自行实现处理逻辑。若游戏接收到<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/graphics-accelerate-assetdownloadmanager#section93468227013" target="_blank">on('pause')</a>方法返回的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/graphics-accelerate-assetdownloadmanager#section1639510932819" target="_blank">AssetDownloadTask</a>，表示下载任务已暂停，游戏可以携带taskId，调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/graphics-accelerate-assetdownloadmanager#section81011552114216" target="_blank">resumeAssetDownloadTask</a>方法，恢复暂停中的下载任务。</li>     <li>游戏向资源加速服务取消订阅资源包下载进度/状态事件。游戏调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/graphics-accelerate-assetdownloadmanager#section119038965812" target="_blank">off('progress')</a>方法，取消监听资源包下载进度。游戏调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/graphics-accelerate-assetdownloadmanager#section1229111411927" target="_blank">off('pause')</a>方法，取消监听下载任务暂停事件。游戏调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/graphics-accelerate-assetdownloadmanager#section145731108615" target="_blank">off('complete')</a>方法，取消监听资源包下载成功事件。游戏调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/graphics-accelerate-assetdownloadmanager#section131235411188" target="_blank">off('fail')</a>方法，取消监听资源包下载失败事件。</li>    </ol>    <div class="tiledSection">     <h2 id="section1212682065918">接口说明<i class="anchor-icon anchor-icon-link" anchorid="section1212682065918" tips="复制节点链接"></i></h2>          <p>具体API说明请详见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/graphics-accelerate-assetdownloadmanager" target="_blank">接口文档</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.4.3.1.3.1.1" valign="top" width="53.769999999999996%">          <p>接口名</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.4.3.1.3.1.2" valign="top" width="46.23%">          <p>描述</p></th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="53.769999999999996%">          <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/graphics-accelerate-assetdownloadmanager#section81101219425" target="_blank">fetchManifestUrl</a>(): Promise&lt;string&gt;</p></td>         <td class="cellrowborder" valign="top" width="46.23%">          <p>获取资源包文件下载列表。使用Promise异步回调。</p></td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="53.769999999999996%">          <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/graphics-accelerate-assetdownloadmanager#section171317233391" target="_blank">on</a>(type: 'progress', callback: Callback&lt;DownloadProgressInfo[]&gt;): void</p></td>         <td class="cellrowborder" valign="top" width="46.23%">          <p>订阅资源包下载进度事件。使用callback形式返回结果。</p></td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="53.769999999999996%">          <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/graphics-accelerate-assetdownloadmanager#section93468227013" target="_blank">on</a>(type: 'pause', callback: Callback&lt;AssetDownloadTask&gt;): void</p></td>         <td class="cellrowborder" valign="top" width="46.23%">          <p>订阅资源包下载暂停事件。使用callback形式返回结果。</p></td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="53.769999999999996%">          <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/graphics-accelerate-assetdownloadmanager#section165201771441" target="_blank">on</a>(type: 'complete', callback: Callback&lt;DownloadCompletedInfo&gt;): void</p></td>         <td class="cellrowborder" valign="top" width="46.23%">          <p>订阅资源包下载成功事件。使用callback形式返回结果。</p></td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="53.769999999999996%">          <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/graphics-accelerate-assetdownloadmanager#section22331871979" target="_blank">on</a>(type: 'fail', callback: Callback&lt;DownloadFailedInfo&gt;): void</p></td>         <td class="cellrowborder" valign="top" width="46.23%">          <p>订阅资源包下载失败事件。使用callback形式返回结果。</p></td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="53.769999999999996%">          <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/graphics-accelerate-assetdownloadmanager#section104771151219" target="_blank">addAssetDownloadTask</a>(context: common.BaseContext, downloadConfig: AssetDownloadConfig): Promise&lt;string&gt;</p></td>         <td class="cellrowborder" valign="top" width="46.23%">          <p>新增资源包下载任务。使用Promise异步回调。</p></td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="53.769999999999996%">          <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/graphics-accelerate-assetdownloadmanager#section119038965812" target="_blank">off</a>(type: 'progress', callback?: Callback&lt;DownloadProgressInfo[]&gt;): void</p></td>         <td class="cellrowborder" valign="top" width="46.23%">          <p>取消订阅资源包下载进度事件。使用callback形式返回结果。</p></td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="53.769999999999996%">          <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/graphics-accelerate-assetdownloadmanager#section1229111411927" target="_blank">off</a>(type: 'pause', callback?: Callback&lt;AssetDownloadTask&gt;): void</p></td>         <td class="cellrowborder" valign="top" width="46.23%">          <p>取消订阅资源包下载暂停事件。使用callback形式返回结果。</p></td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="53.769999999999996%">          <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/graphics-accelerate-assetdownloadmanager#section145731108615" target="_blank">off</a>(type: 'complete', callback?: Callback&lt;DownloadCompletedInfo&gt;): void</p></td>         <td class="cellrowborder" valign="top" width="46.23%">          <p>取消订阅资源包下载成功事件。使用callback形式返回结果。</p></td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="53.769999999999996%">          <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/graphics-accelerate-assetdownloadmanager#section131235411188" target="_blank">off</a>(type: 'fail', callback?: Callback&lt;DownloadFailedInfo&gt;): void</p></td>         <td class="cellrowborder" valign="top" width="46.23%">          <p>取消订阅资源包下载失败事件。使用callback形式返回结果。</p></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="section1956810132371">开发步骤<i class="anchor-icon anchor-icon-link" anchorid="section1956810132371" tips="复制节点链接"></i></h2>          <ol>      <li>导入assetDownloadManager模块。       <div _ngcontent-ast-c106="" class="highlight-div"><div _ngcontent-ast-c106="" class="highlight-div-header"><div _ngcontent-ast-c106="" class="highlight-div-header-left"><div _ngcontent-ast-c106="" class="handle-button expand-button"><div _ngcontent-ast-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ast-c106="" class="highlight-div-header-right"><div _ngcontent-ast-c106="" class="handle-button ai-button"></div><div _ngcontent-ast-c106="" class="handle-button line-button"><div _ngcontent-ast-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ast-c106="" class="handle-button theme-button"><div _ngcontent-ast-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ast-c106="" class="handle-button copy-button"><div _ngcontent-ast-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ast-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { assetDownloadManager } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.GraphicsAccelerateKit'</span>;</li><li><span class="hljs-keyword">import</span> { common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li></ol></pre></div></div></li>      <li>游戏调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/graphics-accelerate-assetdownloadmanager#section81101219425" target="_blank">fetchManifestUrl</a>方法，获取manifestUrl资源清单，并根据manifestUrl获取资源包下载任务列表。若manifestUrl不为空，则游戏从华为CDN获取资源包下载任务列表。若manifestUrl为空，则从三方CDN获取资源包下载任务列表。       <div _ngcontent-ast-c106="" class="highlight-div"><div _ngcontent-ast-c106="" class="highlight-div-header"><div _ngcontent-ast-c106="" class="highlight-div-header-left"><div _ngcontent-ast-c106="" class="handle-button expand-button"><div _ngcontent-ast-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ast-c106="" class="highlight-div-header-right"><div _ngcontent-ast-c106="" class="handle-button ai-button"></div><div _ngcontent-ast-c106="" class="handle-button line-button"><div _ngcontent-ast-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ast-c106="" class="handle-button theme-button"><div _ngcontent-ast-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ast-c106="" class="handle-button copy-button"><div _ngcontent-ast-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ast-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">async</span> <span class="hljs-title function_">fetchManifestUrl</span>(<span class="hljs-params"></span>) {</li><li>  <span class="hljs-keyword">let</span> manifestUrl : <span class="hljs-built_in">string</span> = <span class="hljs-string">''</span>;</li><li>  <span class="hljs-keyword">try</span> {</li><li>    manifestUrl = <span class="hljs-keyword">await</span> assetDownloadManager.<span class="hljs-title function_">fetchManifestUrl</span>();</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'AssetAccelDemo'</span>, <span class="hljs-string">`Succeeded in fetching manifestUrl, manifestUrl = <span class="hljs-subst">${manifestUrl}</span>`</span>);</li><li>  } <span class="hljs-keyword">catch</span> (error) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'AssetAccelDemo'</span>, <span class="hljs-string">`Failed to fetch manifestUrl, errCode: <span class="hljs-subst">${error.code}</span>, errMessage: <span class="hljs-subst">${error.message}</span>`</span>);</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-comment">// 根据获取到的manifestUrl不为空，获取华为CDN侧资源。若获取到的manifestUrl为空，则获取三方CDN侧资源。</span></li><li>}</li></ol></pre></div></div></li>      <li>游戏调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/graphics-accelerate-assetdownloadmanager#section171317233391" target="_blank">on('progress')</a>方法，监听资源包下载进度。游戏调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/graphics-accelerate-assetdownloadmanager#section93468227013" target="_blank">on('pause')</a>方法，监听下载任务是否暂停。游戏调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/graphics-accelerate-assetdownloadmanager#section165201771441" target="_blank">on('complete')</a>方法，监听资源是否成功下载。游戏调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/graphics-accelerate-assetdownloadmanager#section22331871979" target="_blank">on('fail')</a>方法，监听下载任务是否失败。       <div _ngcontent-ast-c106="" class="highlight-div"><div _ngcontent-ast-c106="" class="highlight-div-header"><div _ngcontent-ast-c106="" class="highlight-div-header-left"><div _ngcontent-ast-c106="" class="handle-button expand-button"><div _ngcontent-ast-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ast-c106="" class="highlight-div-header-right"><div _ngcontent-ast-c106="" class="handle-button ai-button"></div><div _ngcontent-ast-c106="" class="handle-button line-button"><div _ngcontent-ast-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ast-c106="" class="handle-button theme-button"><div _ngcontent-ast-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ast-c106="" class="handle-button copy-button"><div _ngcontent-ast-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ast-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-attr">onProgressCallback</span>: <span class="hljs-function">(<span class="hljs-params">progressArray: assetDownloadManager.DownloadProgressInfo[]</span>) =&gt;</span> <span class="hljs-built_in">void</span> = <span class="hljs-function">(<span class="hljs-params">progressArray</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'AssetAccelDemo'</span>, <span class="hljs-string">`onProgressCallback progressArray length: <span class="hljs-subst">${progressArray.length}</span>`</span>);</li><li>  <span class="hljs-comment">// 添加资源包下载进度处理逻辑。</span></li><li>}</li><li>
</li><li><span class="hljs-attr">onPauseCallback</span>: <span class="hljs-function">(<span class="hljs-params">downloadTaskInfo: assetDownloadManager.AssetDownloadTask</span>) =&gt;</span> <span class="hljs-built_in">void</span> = <span class="hljs-function">(<span class="hljs-params">downloadTaskInfo</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'AssetAccelDemo'</span>, <span class="hljs-string">`task identifier = <span class="hljs-subst">${downloadTaskInfo.config.identifier}</span> has paused.`</span>);</li><li>  <span class="hljs-comment">// 添加资源包下载暂停处理逻辑。</span></li><li>}</li><li>
</li><li><span class="hljs-attr">onCompleteCallback</span>: <span class="hljs-function">(<span class="hljs-params">completeInfo: assetDownloadManager.DownloadCompletedInfo</span>) =&gt;</span> <span class="hljs-built_in">void</span> = <span class="hljs-keyword">async</span> (completeInfo) =&gt; {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'AssetAccelDemo'</span>, <span class="hljs-string">`task identifier = <span class="hljs-subst">${completeInfo.downloadTask.config.identifier}</span> has completed.`</span>);</li><li>  <span class="hljs-comment">// 添加资源包下载完成处理逻辑。</span></li><li>}</li><li>
</li><li><span class="hljs-attr">onFailedCallback</span>: <span class="hljs-function">(<span class="hljs-params">failedInfo: assetDownloadManager.DownloadFailedInfo</span>) =&gt;</span> <span class="hljs-built_in">void</span> = <span class="hljs-keyword">async</span> (failedInfo) =&gt; {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'AssetAccelDemo'</span>, <span class="hljs-string">`task identifier = <span class="hljs-subst">${failedInfo.downloadTask.config.identifier}</span> has failed.`</span>);</li><li>  <span class="hljs-comment">// 添加资源包下载失败处理逻辑。</span></li><li>}</li><li>
</li><li><span class="hljs-comment">// 订阅下载状态和下载进度事件。</span></li><li><span class="hljs-keyword">try</span> {</li><li>　assetDownloadManager.<span class="hljs-title function_">on</span>(<span class="hljs-string">"progress"</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">onProgressCallback</span>);</li><li>　assetDownloadManager.<span class="hljs-title function_">on</span>(<span class="hljs-string">"pause"</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">onPauseCallback</span>);</li><li>　assetDownloadManager.<span class="hljs-title function_">on</span>(<span class="hljs-string">"complete"</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">onCompleteCallback</span>);</li><li>　assetDownloadManager.<span class="hljs-title function_">on</span>(<span class="hljs-string">"fail"</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">onFailedCallback</span>);</li><li>} <span class="hljs-keyword">catch</span> (error) {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'AssetAccelDemo'</span>, <span class="hljs-string">`Failed to do assetDownloadManager.on, errCode: <span class="hljs-subst">${error.code}</span>, errMessage: <span class="hljs-subst">${error.message}</span>`</span>);</li><li>}</li></ol></pre></div></div></li>      <li>游戏调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/graphics-accelerate-assetdownloadmanager#section104771151219" target="_blank">addAssetDownloadTask</a>方法，新增资源包下载任务。       <div _ngcontent-ast-c106="" class="highlight-div"><div _ngcontent-ast-c106="" class="highlight-div-header"><div _ngcontent-ast-c106="" class="highlight-div-header-left"><div _ngcontent-ast-c106="" class="handle-button expand-button"><div _ngcontent-ast-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ast-c106="" class="highlight-div-header-right"><div _ngcontent-ast-c106="" class="handle-button ai-button"></div><div _ngcontent-ast-c106="" class="handle-button line-button"><div _ngcontent-ast-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ast-c106="" class="handle-button theme-button"><div _ngcontent-ast-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ast-c106="" class="handle-button copy-button"><div _ngcontent-ast-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ast-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">async</span> <span class="hljs-title function_">addAssetDownloadTask</span>(<span class="hljs-params"></span>) {</li><li>  <span class="hljs-comment">// 构造资源包下载配置信息。</span></li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">assetDownload</span>: assetDownloadManager.<span class="hljs-property">AssetDownloadConfig</span> = {</li><li>    <span class="hljs-attr">fileName</span>: <span class="hljs-string">'fileName'</span>, <span class="hljs-comment">// 下载资源文件名。</span></li><li>    <span class="hljs-attr">url</span>: <span class="hljs-string">'url'</span>, <span class="hljs-comment">// 下载资源url。</span></li><li>    <span class="hljs-attr">isEssential</span>: <span class="hljs-literal">false</span>, <span class="hljs-comment">// 是否是必要下载资源。</span></li><li>    <span class="hljs-attr">identifier</span>: <span class="hljs-string">'identifier'</span>, <span class="hljs-comment">// 标识信息。</span></li><li>    <span class="hljs-attr">groupId</span>: <span class="hljs-string">'groupId'</span> <span class="hljs-comment">// 组ID，用于标识资源的版本信息。</span></li><li>  }</li><li>  <span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-comment">// 添加资源包下载任务。</span></li><li>    <span class="hljs-comment">// 根据实际代码上下文自行传入合适的context。</span></li><li>    <span class="hljs-keyword">const</span> <span class="hljs-attr">taskId</span>: <span class="hljs-built_in">string</span> = <span class="hljs-keyword">await</span> assetDownloadManager.<span class="hljs-title function_">addAssetDownloadTask</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">Context</span>, assetDownload);</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'AssetAccelDemo'</span>, <span class="hljs-string">`Succeeded in adding assetDownloadTask`</span>);</li><li>  } <span class="hljs-keyword">catch</span> (error) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'AssetAccelDemo'</span>, <span class="hljs-string">`Failed to add assetDownloadTask, errCode:<span class="hljs-subst">${error.code}</span>, errMessage:<span class="hljs-subst">${error.message}</span>`</span>);</li><li>  }</li><li>}</li></ol></pre></div></div></li>      <li>游戏调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/graphics-accelerate-assetdownloadmanager#section119038965812" target="_blank">off('progress')</a>方法，取消监听资源包下载进度。游戏调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/graphics-accelerate-assetdownloadmanager#section1229111411927" target="_blank">off('pause')</a>方法，取消监听下载任务暂停事件。游戏调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/graphics-accelerate-assetdownloadmanager#section145731108615" target="_blank">off('complete')</a>方法，取消监听资源包下载成功事件。游戏调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/graphics-accelerate-assetdownloadmanager#section131235411188" target="_blank">off('fail')</a>方法，取消监听资源包下载失败事件。       <div _ngcontent-ast-c106="" class="highlight-div"><div _ngcontent-ast-c106="" class="highlight-div-header"><div _ngcontent-ast-c106="" class="highlight-div-header-left"><div _ngcontent-ast-c106="" class="handle-button expand-button"><div _ngcontent-ast-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ast-c106="" class="highlight-div-header-right"><div _ngcontent-ast-c106="" class="handle-button ai-button"></div><div _ngcontent-ast-c106="" class="handle-button line-button"><div _ngcontent-ast-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ast-c106="" class="handle-button theme-button"><div _ngcontent-ast-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ast-c106="" class="handle-button copy-button"><div _ngcontent-ast-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ast-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 取消订阅下载状态和下载进度事件。</span></li><li><span class="hljs-keyword">try</span> {</li><li>　assetDownloadManager.<span class="hljs-title function_">off</span>(<span class="hljs-string">"progress"</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">onProgressCallback</span>);</li><li>　assetDownloadManager.<span class="hljs-title function_">off</span>(<span class="hljs-string">"pause"</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">onPauseCallback</span>);</li><li>　assetDownloadManager.<span class="hljs-title function_">off</span>(<span class="hljs-string">"complete"</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">onCompleteCallback</span>);</li><li>　assetDownloadManager.<span class="hljs-title function_">off</span>(<span class="hljs-string">"fail"</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">onFailedCallback</span>);</li><li>} <span class="hljs-keyword">catch</span> (error) {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'AssetAccelDemo'</span>, <span class="hljs-string">`Failed to do assetDownloadManager.off, errCode: <span class="hljs-subst">${error.code}</span>, errMessage: <span class="hljs-subst">${error.message}</span>`</span>);</li><li>}</li></ol></pre></div></div></li>     </ol>    </div>   </div>   <div></div></div>