<h1 _ngcontent-ery-c119="" class="doc-title ng-star-inserted" title="应用声明支持智慧多窗"> 应用声明支持智慧多窗 </h1>

<div _ngcontent-ery-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div><p>当应用需要智慧多窗的能力时，可以通过在<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/module-configuration-file" target="_blank">module.json5配置文件</a>中对应标签添加相关字段声明支持。</p> <div class="tiledSection"><h2 id="section14646185913211">声明支持悬浮窗<i class="anchor-icon anchor-icon-link" anchorid="section14646185913211" tips="复制节点链接"></i></h2><p>开发者可以通过在module.json5配置文件中<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/module-configuration-file#abilities标签" target="_blank">abilities标签</a>下的<strong>supportWindowMode</strong>属性增加“<strong>floating</strong>”字段或使用缺省值以声明应用支持悬浮窗。</p> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p>supportWindowMode缺省值为["fullscreen", "split", "floating"]。</p> </div></div></div> <p><strong>supportWindowMode</strong>属性主要标识当前UIAbility所支持的窗口模式，支持的字段及含义如下表所示。</p>  <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.2.5.1.3.1.1" valign="top" width="50%"><p>字段</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.2.5.1.3.1.2" valign="top" width="50%"><p>说明</p> </th> </tr> </thead> <tbody><tr><td align="left" class="cellrowborder" valign="top" width="50%"><p>fullscreen</p> </td> <td align="left" class="cellrowborder" valign="top" width="50%"><p>窗口支持全屏显示。</p> </td> </tr> <tr><td align="left" class="cellrowborder" valign="top" width="50%"><p>split</p> </td> <td align="left" class="cellrowborder" valign="top" width="50%"><p>窗口支持分屏显示。</p> </td> </tr> <tr><td align="left" class="cellrowborder" valign="top" width="50%"><p>floating</p> </td> <td align="left" class="cellrowborder" valign="top" width="50%"><p>窗口支持悬浮窗显示。</p> </td> </tr>  </tbody></table></div> </div> <p>在应用声明支持智慧多窗后，还可根据业务场景的需要配置是否支持横向悬浮窗或上下分屏模式。</p> <p>当应用需要支持横向悬浮窗时，开发者可以通过在module.json5配置文件中<strong>abilities</strong>标签下的<strong>preferMultiWindowOrientation</strong>属性增加“<strong>landscape</strong>”或者“<strong>landscape_auto</strong>”配合API以声明应用支持横向悬浮窗或上下分屏模式。</p> <p><strong>preferMultiWindowOrientation</strong>属性主要标识当前UIAbility组件多窗布局方向，支持的字段及含义如下表所示。</p>  <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.2.9.1.4.1.1" valign="top" width="18.61%"><p>配置值</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.2.9.1.4.1.2" valign="top" width="40.21%"><p>说明</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.2.9.1.4.1.3" valign="top" width="41.18%"><p>效果</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="18.61%"><p>portrait</p> </td> <td class="cellrowborder" valign="top" width="40.21%"><p>多窗布局方向为竖向。建议竖向游戏类应用配置。</p> </td> <td class="cellrowborder" valign="top" width="41.18%"><p><strong>手机</strong></p> <p>手势触发悬浮窗：竖向悬浮窗</p> <p>手势触发分屏：不支持</p> <p>分屏样式切换：不涉及</p> <p><strong>折叠屏手机展开态</strong></p> <p>手势触发悬浮窗：竖向悬浮窗</p> <p>手势触发分屏：形成左右分屏</p> <p>分屏样式切换：不支持样式切换</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="18.61%"><p>landscape</p> </td> <td class="cellrowborder" valign="top" width="40.21%"><p>多窗布局方向为横向，配置后支持横向悬浮窗和上下分屏。建议横向游戏类应用配置。</p> <p></p> </td> <td class="cellrowborder" valign="top" width="41.18%"><p><strong>手机</strong></p> <p>手势触发悬浮窗：横向悬浮窗</p> <p>手势触发分屏：不支持</p> <p>分屏样式切换：不涉及</p> <p><strong>折叠屏手机展开态</strong></p> <p>手势触发悬浮窗：横向悬浮窗</p> <p>手势触发分屏：形成上下分屏</p> <p>分屏样式切换：不支持样式切换</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="18.61%"><p>landscape_auto</p> </td> <td class="cellrowborder" valign="top" width="40.21%"><p>多窗布局动态可变为横向，需要配合API（<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-window-window#enablelandscapemultiwindow12" target="_blank">enableLandscapeMultiWindow</a> / <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-window-window#disablelandscapemultiwindow12" target="_blank">disableLandscapeMultiWindow</a>）使用。建议视频类应用配置。</p> </td> <td class="cellrowborder" valign="top" width="41.18%"><p><strong>系统识别应用为横向全屏播放</strong><strong>：</strong></p> <p><strong>手机</strong></p> <p>手势触发悬浮窗：横向悬浮窗</p> <p>手势触发分屏：形成上下分屏</p> <p>分屏样式切换：不涉及</p> <p><strong>折叠屏手机展开态</strong></p> <p>手势触发悬浮窗：横向悬浮窗</p> <p>手势触发分屏：形成上下分屏</p> <p>分屏样式切换：支持样式切换</p> <p><strong>系统识别应用为非横向全屏播放：</strong>同配置为default</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="18.61%"><p>default</p> </td> <td class="cellrowborder" valign="top" width="40.21%"><p>缺省值，参数不配置时默认为default。</p> <p>建议其他应用类配置。</p> </td> <td class="cellrowborder" valign="top" width="41.18%"><p><strong>折叠屏手机折叠态 &amp; 手机</strong></p> <p>手势触发悬浮窗：竖向悬浮窗</p> <p>手势触发分屏：形成上下分屏</p> <p>分屏样式切换：不涉及</p> <p><strong>折叠屏手机展开态</strong></p> <p>手势触发悬浮窗：竖向悬浮窗</p> <p>手势触发分屏：形成左右分屏</p> <p>分屏样式切换：支持样式切换</p> </td> </tr>  </tbody></table></div> </div> </div> <div class="tiledSection"><h2 id="section2205081316">声明支持分屏<i class="anchor-icon anchor-icon-link" anchorid="section2205081316" tips="复制节点链接"></i></h2><p>开发者可以通过在module.json5配置文件中<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/module-configuration-file#abilities标签" target="_blank">abilities标签</a>下的<strong>supportWindowMode</strong>属性增加“<strong>split</strong>”字段或使用缺省值以声明应用支持分屏。</p> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p>supportWindowMode缺省值为["fullscreen", "split", "floating"]。</p> </div></div></div> <p><strong>supportWindowMode</strong>属性主要标识当前UIAbility所支持的窗口模式，支持的字段及含义如下表所示。</p>  <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.3.5.1.3.1.1" valign="top" width="50%"><p>字段</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.3.5.1.3.1.2" valign="top" width="50%"><p>说明</p> </th> </tr> </thead> <tbody><tr><td align="left" class="cellrowborder" valign="top" width="50%"><p>fullscreen</p> </td> <td align="left" class="cellrowborder" valign="top" width="50%"><p>窗口支持全屏显示。</p> </td> </tr> <tr><td align="left" class="cellrowborder" valign="top" width="50%"><p>split</p> </td> <td align="left" class="cellrowborder" valign="top" width="50%"><p>窗口支持分屏显示。</p> </td> </tr> <tr><td align="left" class="cellrowborder" valign="top" width="50%"><p>floating</p> </td> <td align="left" class="cellrowborder" valign="top" width="50%"><p>窗口支持悬浮窗显示。</p> </td> </tr>  </tbody></table></div> </div> </div> <div class="tiledSection"><h2 id="section152819561687">应用内分屏<i class="anchor-icon anchor-icon-link" anchorid="section152819561687" tips="复制节点链接"></i></h2><p>应用内分屏功能允许<a href="/consumer/cn/doc/harmonyos-guides/multi-window-support#section2205081316">声明支持分屏</a>的应用在全屏显示模式下，通过调用startAbility方法启动UIAbility并形成分屏。该功能能够增强应用的多任务处理能力，提升用户的操作体验。</p> <p>此处以点击按钮启动分屏为例，主要步骤和示例如下所示：</p> <ol><li><span>在应用中获取UIAbilityContext 对象，这是启动分屏所必需的上下文对象，用于后续调用startAbility接口。</span><p></p><div _ngcontent-ery-c106="" class="highlight-div"><div _ngcontent-ery-c106="" class="highlight-div-header"><div _ngcontent-ery-c106="" class="highlight-div-header-left"><div _ngcontent-ery-c106="" class="handle-button expand-button"><div _ngcontent-ery-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ery-c106="" class="highlight-div-header-right"><div _ngcontent-ery-c106="" class="handle-button ai-button"></div><div _ngcontent-ery-c106="" class="handle-button line-button"><div _ngcontent-ery-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ery-c106="" class="handle-button theme-button"><div _ngcontent-ery-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ery-c106="" class="handle-button copy-button"><div _ngcontent-ery-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ery-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-kotlin" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">this</span>.hostContext = <span class="hljs-keyword">this</span>.getUIContext()?.getHostContext() <span class="hljs-keyword">as</span> common.UIAbilityContext;</li></ol></pre></div></div> <p></p></li><li><span>调用startAbility接口启动UIAbility，形成分屏。调用startAbility接口时，设置StartOptions对象，需要指定窗口模式<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-abilityconstant#windowmode12" target="_blank">windowMode</a>（需设置为WINDOW_MODE_SPLIT_PRIMARY或者WINDOW_MODE_SPLIT_SECONDARY），并可根据需要设置其他StartOptions属性或startAbility参数，如Want对象。</span><p></p><div _ngcontent-ery-c106="" class="highlight-div"><div _ngcontent-ery-c106="" class="highlight-div-header"><div _ngcontent-ery-c106="" class="highlight-div-header-left"><div _ngcontent-ery-c106="" class="handle-button expand-button"><div _ngcontent-ery-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ery-c106="" class="highlight-div-header-right"><div _ngcontent-ery-c106="" class="handle-button ai-button"></div><div _ngcontent-ery-c106="" class="handle-button line-button"><div _ngcontent-ery-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ery-c106="" class="handle-button theme-button"><div _ngcontent-ery-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ery-c106="" class="handle-button copy-button"><div _ngcontent-ery-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ery-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 创建StartOptions并设置为主窗口模式</span></li><li><span class="hljs-keyword">let</span> <span class="hljs-variable">option</span>: <span class="hljs-title class_">StartOptions</span> = { <span class="hljs-variable">windowMode</span>: <span class="hljs-title class_">AbilityConstant</span>.<span class="hljs-title class_">WindowMode</span>.<span class="hljs-title class_">WINDOW_MODE_SPLIT_PRIMARY</span> }; </li><li><span class="hljs-keyword">let</span> <span class="hljs-variable">want</span>: <span class="hljs-title class_">Want</span> = { <span class="hljs-variable">bundleName</span>: <span class="hljs-string">'com.example.startsplitdemo'</span>, <span class="hljs-variable">abilityName</span>: <span class="hljs-string">'EntryAbility1'</span>, <span class="hljs-variable">moduleName</span>: <span class="hljs-string">''</span> };</li><li><span class="hljs-keyword">this</span>.<span class="hljs-variable">hostContext</span>?.<span class="hljs-title function_">startAbility</span>(<span class="hljs-variable">want</span>, <span class="hljs-variable">option</span>);</li></ol></pre></div></div> <p></p></li><li><span>若继续执行上述步骤，可继续启动其他UIAbility窗口，呈现左右分屏或替换一侧的分屏窗口。</span></li></ol> <p>完整示例如下：</p> <p>使用DevEco Studio新建Ability，创建EntryAbility1和EntryAbility2，对应文中组成分屏的两个窗口页面，加载页面为默认页面Index.ets。</p> <div _ngcontent-ery-c106="" class="highlight-div"><div _ngcontent-ery-c106="" class="highlight-div-header"><div _ngcontent-ery-c106="" class="highlight-div-header-left"><div _ngcontent-ery-c106="" class="handle-button expand-button"><div _ngcontent-ery-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ery-c106="" class="highlight-div-header-right"><div _ngcontent-ery-c106="" class="handle-button ai-button"></div><div _ngcontent-ery-c106="" class="handle-button line-button"><div _ngcontent-ery-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ery-c106="" class="handle-button theme-button"><div _ngcontent-ery-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ery-c106="" class="handle-button copy-button"><div _ngcontent-ery-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ery-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// Index.ets</span></li><li><span class="hljs-keyword">import</span> { <span class="hljs-variable">AbilityConstant</span>, <span class="hljs-variable">common</span>, <span class="hljs-variable">StartOptions</span>, <span class="hljs-variable">Want</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-variable">hilog</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-variable">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li>@<span class="hljs-title function_">Entry</span></li><li>@<span class="hljs-title function_">Component</span></li><li><span class="hljs-keyword">struct</span> <span class="hljs-title class_">Index</span> {</li><li>  @<span class="hljs-title function_">State</span> <span class="hljs-variable">name</span>: <span class="hljs-title class_">string</span> = <span class="hljs-string">''</span>;</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-variable">hostContext</span>: <span class="hljs-title class_">common</span>.<span class="hljs-title class_">UIAbilityContext</span> | <span class="hljs-title class_">null</span> = <span class="hljs-variable">null</span>;</li><li>
</li><li>  <span class="hljs-title function_">aboutToAppear</span>(): <span class="hljs-title class_">void</span> {</li><li>    <span class="hljs-keyword">this</span>.<span class="hljs-variable">hostContext</span> = <span class="hljs-keyword">this</span>.<span class="hljs-title function_">getUIContext</span>()?.<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> <span class="hljs-variable">common</span>.<span class="hljs-variable">UIAbilityContext</span>;</li><li>    <span class="hljs-keyword">this</span>.<span class="hljs-variable">name</span> = <span class="hljs-keyword">this</span>.<span class="hljs-variable">hostContext</span>.<span class="hljs-variable">abilityInfo</span>.<span class="hljs-variable">name</span>;</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>() {</li><li>    <span class="hljs-title function_">Column</span>({ <span class="hljs-variable">space</span>: <span class="hljs-number">20</span> }) {</li><li>      <span class="hljs-title function_">Text</span>(<span class="hljs-keyword">this</span>.<span class="hljs-variable">name</span>)</li><li>
</li><li>      <span class="hljs-title function_">Button</span>() {</li><li>        <span class="hljs-title function_">Text</span>(<span class="hljs-string">'启动应用内分屏'</span>)</li><li>      }</li><li>      .<span class="hljs-title function_">height</span>(<span class="hljs-number">40</span>)</li><li>      .<span class="hljs-title function_">onClick</span>(() =&gt; {</li><li>        <span class="hljs-comment">// 指定拉起的分屏窗口的应用信息</span></li><li>        <span class="hljs-keyword">let</span> <span class="hljs-variable">want</span>: <span class="hljs-title class_">Want</span> = { <span class="hljs-variable">bundleName</span>: <span class="hljs-string">'com.example.startsplitdemo'</span>, <span class="hljs-variable">abilityName</span>: <span class="hljs-string">'EntryAbility1'</span>, <span class="hljs-variable">moduleName</span>: <span class="hljs-string">''</span> };</li><li>        <span class="hljs-comment">// 创建StartOptions并设置窗口模式为分屏模式，左侧分屏</span></li><li>        <span class="hljs-keyword">let</span> <span class="hljs-variable">option</span>: <span class="hljs-title class_">StartOptions</span> = { <span class="hljs-variable">windowMode</span>: <span class="hljs-title class_">AbilityConstant</span>.<span class="hljs-title class_">WindowMode</span>.<span class="hljs-title class_">WINDOW_MODE_SPLIT_PRIMARY</span> };</li><li>        <span class="hljs-keyword">this</span>.<span class="hljs-variable">hostContext</span>?.<span class="hljs-title function_">startAbility</span>(<span class="hljs-variable">want</span>, <span class="hljs-variable">option</span>);</li><li>      })</li><li>
</li><li>      <span class="hljs-title function_">Button</span>() {</li><li>        <span class="hljs-title function_">Text</span>(<span class="hljs-string">'启动另一分屏窗口'</span>)</li><li>      }</li><li>      .<span class="hljs-title function_">height</span>(<span class="hljs-number">40</span>)</li><li>      .<span class="hljs-title function_">onClick</span>(() =&gt; {</li><li>        <span class="hljs-keyword">let</span> <span class="hljs-variable">want</span>: <span class="hljs-title class_">Want</span> = { <span class="hljs-variable">bundleName</span>: <span class="hljs-string">'com.example.startsplitdemo'</span>, <span class="hljs-variable">abilityName</span>: <span class="hljs-string">'EntryAbility2'</span>, <span class="hljs-variable">moduleName</span>: <span class="hljs-string">''</span> };</li><li>        <span class="hljs-comment">// 指定启动EntryAbility2的窗口模式，右侧分屏</span></li><li>        <span class="hljs-keyword">let</span> <span class="hljs-variable">option</span>: <span class="hljs-title class_">StartOptions</span> = { <span class="hljs-variable">windowMode</span>: <span class="hljs-title class_">AbilityConstant</span>.<span class="hljs-title class_">WindowMode</span>.<span class="hljs-title class_">WINDOW_MODE_SPLIT_SECONDARY</span> };</li><li>        <span class="hljs-keyword">this</span>.<span class="hljs-variable">hostContext</span>?.<span class="hljs-title function_">startAbility</span>(<span class="hljs-variable">want</span>, <span class="hljs-variable">option</span>, (<span class="hljs-variable">error</span>: <span class="hljs-title class_">BusinessError</span>) =&gt; {</li><li>          <span class="hljs-keyword">if</span> (<span class="hljs-variable">error</span>.<span class="hljs-variable">code</span>) {</li><li>            <span class="hljs-keyword">return</span>;</li><li>          }</li><li>          <span class="hljs-variable">hilog</span>.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">'启动分屏成功'</span>);</li><li>        });</li><li>      })</li><li>    }</li><li>    .<span class="hljs-title function_">padding</span>(<span class="hljs-number">20</span>)</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div> </div> </div> <div></div></div>