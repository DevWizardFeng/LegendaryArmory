<h1 _ngcontent-asr-c119="" class="doc-title ng-star-inserted" title="应用市场推荐"> 应用市场推荐 </h1>

<div _ngcontent-asr-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <div class="tiledSection">     <h2 id="section13070154413">场景介绍<i class="anchor-icon anchor-icon-link" anchorid="section13070154413" tips="复制节点链接"></i></h2>          <ul>      <li>元服务卡片加桌       <p>您可调用应用市场服务提供的元服务加桌<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/store-productviewmanager#section16879449144620" target="_blank">loadService</a>接口，加载元服务卡片加桌页面，用户点击“添加至桌面”按钮，将元服务卡片添加至桌面。</p></li>     </ul>     <ul>      <li>应用详情页展示       <ol>        <li>您可调用应用市场服务提供的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/store-productviewmanager#section144826162913" target="_blank">loadProduct</a>接口，直接加载应用市场的应用详情页面，用户可以在页面内点击“安装”按钮完成应用的下载安装；</li>        <li>您可使用Deep Linking链接的方式拉起应用市场应用详情页，通过拼接应用市场Deep Linking链接，在应用中调用或网页中点击Deep Linking链接拉起应用详情页，用户可以在页面内点击“安装”按钮完成应用的下载安装；</li>        <li>您可使用App Linking链接的方式拉起应用市场应用详情页，通过拼接应用市场App Linking链接，在应用中调用或网页中点击App Linking链接拉起应用详情页，用户可以在页面内点击“安装”按钮完成应用的下载安装。         <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">           <p>应用内打开应用市场App，通过应用市场下载推荐应用，推荐使用loadProduct()方式；Web页面打开应用市场App，推荐使用App Linking。</p>          </div></div></div></li>       </ol></li>      <li>应用内快捷方式加桌       <ol>        <li>您可调用应用市场服务提供的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/store-productviewmanager#section5665513519" target="_blank">checkPinShortcutPermitted</a>接口，查询快捷方式加桌是否允许，允许的话则返回鉴权结果及结果的有效期；</li>        <li>您调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/store-productviewmanager#section5665513519" target="_blank">checkPinShortcutPermitted</a>接口获取到鉴权结果后，并在其有效期内再调用应用市场提供的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/store-productviewmanager#section2891132652315" target="_blank">requestNewPinShortcut</a>接口，创建快捷方式加桌，展示快捷方式加桌的用户确认弹窗，待用户确认后，可将快捷方式添加至桌面。</li>       </ol></li>      <li>应用写评论页展示       <ol>        <li>您可使用Deep Linking链接的方式拉起应用市场写评论页，通过拼接应用市场Deep Linking链接，在应用中调用或网页中点击Deep Linking链接在应用详情页拉起写评论页，用户可以在页面内进行评分与评论；</li>        <li>您可使用App Linking链接的方式拉起应用市场写评论页，通过拼接应用市场App Linking链接，在应用中调用或网页中点击App Linking链接在应用详情页拉起写评论页，用户可以在页面内进行评分与评论。</li>       </ol></li>     </ul>     <div class="tablenoborder">      <div class="tbBox"><table style="border-style: none;" class="layoutFixed idpTab">               <tbody><tr>         <td class="nocellnorowborder" style="border: none;" valign="top" width="33.33333333333333%">          <div class="fignone">           <span class="figcap"><b>图1 </b>元服务卡片加桌</span>           <br><span><img height="484.10377400000004" originheight="3120" originwidth="1440" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114508.54038089683984928896021354675817:50001231000000:2800:141F2963C04DF92D67FAF646622A9F54A138FE441E87AC31830D05939B156373.jpg" title="点击放大" width="223.44"></span>          </div></td>         <td class="nocellnorowborder" style="border: none;" valign="top" width="33.33333333333333%">          <div class="fignone">           <span class="figcap"><b>图2 </b>应用详情页展示</span>           <br><span><img height="485.09422500000005" originheight="2772" originwidth="1254" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114508.48406687393632413126705890464876:50001231000000:2800:9487971FD1B1D1C0DCF9017155D3B6286FA1B7642773113FDB0D8AA7F34BA82E.png" title="点击放大" width="219.45000000000002"></span>          </div></td>         <td class="cell-norowborder" style="border: none;" valign="top" width="33.33333333333333%">          <div class="fignone">           <span class="figcap"><b>图3 </b>应用内快捷方式加桌</span>           <br><span><img height="485.94210000000004" originheight="959" originwidth="437" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114508.61427022555653606206505803472319:50001231000000:2800:F3C632CF68B457D4C890FF2F0EEE5EF946BBD7B7C2787CCF14348DE0CC54AF92.png" title="点击放大" width="221.44500000000002"></span>          </div></td>        </tr>        <tr>         <td class="nocellnorowborder" style="border: none;" valign="top" width="33.33333333333333%">          <div class="fignone">           <span class="figcap"><b>图4 </b>通过Deep Linking拉起写评论页</span>           <br><span><img height="489.479235" originheight="2688" originwidth="1216" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114508.79976525400917955773936736684299:50001231000000:2800:81169036FFBDD8E4A308D591E932D2F0C7D3FA4E5F100018F49C9E200D6D44BF.jpg" title="点击放大" width="221.44500000000002"></span>          </div></td>         <td class="nocellnorowborder" style="border: none;" valign="top" width="33.33333333333333%">          <div class="fignone">           <span class="figcap"><b>图5 </b>通过App Linking拉起写评论页</span>           <br><span><img height="491.708581" originheight="2688" originwidth="1216" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114508.38942118066579712161176717090929:50001231000000:2800:F39639D7ED1BD6F35444ACA9C97663ED2CA6C8E282FAE625BB310E526ED62CCA.jpg" title="点击放大" width="222.44250000000002"></span>          </div></td>         <td class="cell-norowborder" style="border: none;" valign="top" width="33.33333333333333%">&nbsp;&nbsp;</td>        </tr>        <tr>         <td class="nocellnorowborder" style="border: none;" valign="top" width="33.33333333333333%">&nbsp;&nbsp;</td>         <td class="nocellnorowborder" style="border: none;" valign="top" width="33.33333333333333%">&nbsp;&nbsp;</td>         <td class="cell-norowborder" style="border: none;" valign="top" width="33.33333333333333%">&nbsp;&nbsp;</td>        </tr>        <tr>         <td class="row-nocellborder" style="border: none;" valign="top" width="33.33333333333333%">&nbsp;&nbsp;</td>         <td class="row-nocellborder" style="border: none;" valign="top" width="33.33333333333333%">&nbsp;&nbsp;</td>         <td class="cellrowborder" style="border: none;" valign="top" width="33.33333333333333%">&nbsp;&nbsp;</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="section2901103614298">业务流程<i class="anchor-icon anchor-icon-link" anchorid="section2901103614298" tips="复制节点链接"></i></h2>         </div>    <div class="tiledSection">     <h3 id="section132321151204313" class="firsth2">元服务卡片加桌&amp;应用详情页展示<i class="anchor-icon anchor-icon-link" anchorid="section132321151204313" tips="复制节点链接"></i></h3>          <p><span><img height="353.88108000000005" originheight="697" originwidth="1222" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114509.20384637667693505578144755788912:50001231000000:2800:E76A4330F1F1E852E99C39ADAD684B73A59CAC068C3397D5D84762B2B13D2EF4.png" title="点击放大" width="620.445"></span></p>     <p></p>     <ol>      <li>用户使用打开应用详情页功能；</li>      <li>应用调用AppGallery Kit的loadProduct接口；</li>      <li>AppGallery Kit API获取应用传入的信息，生成展示页面；</li>      <li>展示生成的页面给用户使用。</li>     </ol>    </div>    <div class="tiledSection">     <h3 id="section2516144612475">应用内快捷方式加桌<i class="anchor-icon anchor-icon-link" anchorid="section2516144612475" tips="复制节点链接"></i></h3>          <p><span><img height="431.47354600000006" originheight="675" originwidth="955" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114509.21854964376026408645349971910394:50001231000000:2800:AE068340CE62541A5BB69AEC51EA093E43F223796B3E2C31E729DFFE63AC6A54.png" title="点击放大" width="610.47"></span></p>     <p></p>     <ol>      <li>应用预先调用checkPinShortcutPermitted接口检查是否允许快捷方式加桌；</li>      <li>AppGallery Kit获取应用传入的快捷方式信息并生成检查结果；</li>      <li>AppGallery Kit返回检查结果和有效时间给应用；</li>      <li>检查通过后应用给用户展示添加快捷方式入口；</li>      <li>用户点击“添加”快捷方式；</li>      <li>调用requestNewPinShortcut接口请求创建快捷方式；</li>      <li>AppGallery Kit加载快捷方式信息并弹出用户确认框；</li>      <li>用户确认是否同意加桌；</li>      <li>用户同意后，AppGallery Kit处理加桌请求；</li>      <li>AppGallery Kit返回加桌结果给应用。</li>     </ol>    </div>    <div class="tiledSection">     <h3 id="section16822152504814">通过Deep Linking拉起写评论页<i class="anchor-icon anchor-icon-link" anchorid="section16822152504814" tips="复制节点链接"></i></h3>          <p><span><img height="361.66264400000006" originheight="746" originwidth="1288" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114509.18086539574992496347956100947011:50001231000000:2800:181D3E92DEB4EE2C8FAA701117DC2CE9323C2DFD0529BAB14867256D19277864.png" title="点击放大" width="624.4350000000001"></span></p>     <p></p>     <ol>      <li>用户使用某应用时，存在跳转应用市场内针对该应用进行评分与评论的诉求；</li>      <li>应用通过拼接应用市场Deep Linking链接直接跳转写评论页面；</li>      <li>应用市场解析Deep Linking链接中的参数，展示应用详情页面（全屏）；</li>      <li>拉起写评论页面（半模态或浅层窗口）；</li>      <li>向用户展示写评论页面。</li>     </ol>    </div>    <div class="tiledSection">     <h3 id="section1167714511305">通过App Linking拉起写评论页<i class="anchor-icon anchor-icon-link" anchorid="section1167714511305" tips="复制节点链接"></i></h3>          <p><span><img height="358.18323100000003" originheight="746" originwidth="1288" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114509.29309273975795647563810035081125:50001231000000:2800:7C5D86488C12E8A92B5DDE29C7A82ADAFE5E00453C9F4901AC8B838960FADCBB.png" title="点击放大" width="618.45"></span></p>     <p></p>     <ol>      <li>用户使用某应用时，存在跳转应用市场内针对该应用进行评分与评论的诉求；</li>      <li>应用通过拼接应用市场App Linking链接直接跳转写评论页面；</li>      <li>应用市场解析App Linking链接中的参数，展示应用详情页面（全屏）；</li>      <li>拉起写评论页面（半模态或浅层窗口）；</li>      <li>向用户展示写评论页面。</li>     </ol>    </div>    <div class="tiledSection">     <h2 id="section17325183415910">约束与限制<i class="anchor-icon anchor-icon-link" anchorid="section17325183415910" tips="复制节点链接"></i></h2>          <p>应用市场推荐服务不支持模拟器，请使用真机调试。在模拟器中使用该服务将会提示：无法获取内容，请点击屏幕重试。</p>    </div>    <div class="tiledSection">     <h2 id="section3584151102912">接口说明<i class="anchor-icon anchor-icon-link" anchorid="section3584151102912" tips="复制节点链接"></i></h2>          <p>应用市场推荐场景提供loadService，loadProduct、checkPinShortcutPermitted、requestNewPinShortcut四个接口，具体API说明详见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/store-productviewmanager" target="_blank">接口文档</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.8.3.1.3.1.1" valign="top" width="49.95%">          <p>接口名</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.8.3.1.3.1.2" valign="top" width="50.05%">          <p>描述</p></th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="49.95%">          <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/store-productviewmanager#section16879449144620" target="_blank">loadService</a>(context: <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext" target="_blank">common.UIAbilityContext</a>, want: <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-want" target="_blank">Want</a>, callback?: <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/store-productviewmanager#section428319231351" target="_blank">ServiceViewCallback</a>): void</p></td>         <td class="cellrowborder" valign="top" width="50.05%">          <p>加载元服务加桌页面接口。</p></td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="49.95%">          <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/store-productviewmanager#section144826162913" target="_blank">loadProduct</a>(context: <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext" target="_blank">common.UIAbilityContext</a>, want: <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-want" target="_blank">Want</a>, callback?: <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/store-productviewmanager#section1744815172418" target="_blank">ProductViewCallback</a>): void</p></td>         <td class="cellrowborder" valign="top" width="50.05%">          <p>加载应用详情页面接口。</p></td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="49.95%">          <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/store-productviewmanager#section5665513519" target="_blank">checkPinShortcutPermitted</a>(context: <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext" target="_blank">common.UIAbilityContext</a>, shortcutId: string, want: <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-want" target="_blank">Want</a>, labelResName: string, iconResName: string): Promise&lt;<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/store-productviewmanager#section1548317391199" target="_blank">CheckShortcutResult</a>&gt;</p></td>         <td class="cellrowborder" valign="top" width="50.05%">          <p>以静态资源方式校验桌面快捷方式。</p></td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="49.95%">          <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/store-productviewmanager#section41029172212" target="_blank">checkPinShortcutPermitted</a>(context: <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext" target="_blank">common.UIAbilityContext</a>, shortcutId: string, want: <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-want" target="_blank">Want</a>, label: string, foregroundIcon: string, backgroundIcon: string): Promise&lt;<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/store-productviewmanager#section1548317391199" target="_blank">CheckShortcutResult</a>&gt;</p></td>         <td class="cellrowborder" valign="top" width="50.05%">          <p>以自定义资源方式校验桌面快捷方式。</p></td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="49.95%">          <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/store-productviewmanager#section2891132652315" target="_blank">requestNewPinShortcut</a>(context: <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext" target="_blank">common.UIAbilityContext</a>, tid: string): Promise&lt;void&gt;</p></td>         <td class="cellrowborder" valign="top" width="50.05%">          <p>创建桌面快捷方式。</p></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="section834744816416">开发步骤<i class="anchor-icon anchor-icon-link" anchorid="section834744816416" tips="复制节点链接"></i></h2>         </div>    <div class="tiledSection">     <h3 id="section16289954112115" class="firsth2">元服务卡片加桌<i class="anchor-icon anchor-icon-link" anchorid="section16289954112115" tips="复制节点链接"></i></h3>          <ol>      <li><span>导入productViewManager模块及相关公共模块。</span>       <p></p>       <div _ngcontent-asr-c106="" class="highlight-div"><div _ngcontent-asr-c106="" class="highlight-div-header"><div _ngcontent-asr-c106="" class="highlight-div-header-left"><div _ngcontent-asr-c106="" class="handle-button expand-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-asr-c106="" class="highlight-div-header-right"><div _ngcontent-asr-c106="" class="handle-button ai-button"></div><div _ngcontent-asr-c106="" class="handle-button line-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-asr-c106="" class="handle-button theme-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-asr-c106="" class="handle-button copy-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-asr-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { productViewManager } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AppGalleryKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li><span class="hljs-keyword">import</span> <span class="hljs-keyword">type</span> { common, <span class="hljs-title class_">Want</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li></ol></pre></div></div>       <p></p></li>      <li><span>构造元服务卡片参数。</span>       <p></p>       <ul>        <li>第一个参数是获取当前Page页面的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext" target="_blank">UIAbilityContext</a>。</li>        <li>第二个参数是构造一个<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-want" target="_blank">Want</a>类型的对象，在属性中传入要加载的<a href="https://developer.huawei.com/consumer/cn/doc/atomic-guides/atomic-applinking" target="_blank">元服务的加桌链接</a>。</li>        <li>第三个参数是可选参数对象，可以传入四个属性，<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/store-productviewmanager#section428319231351" target="_blank">onError</a>：回调函数，回调返回的信息为元服务卡片加桌页加载失败的错误信息。<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/store-productviewmanager#section428319231351" target="_blank">onReceive</a>：回调函数，接收元服务卡片加桌结果信息。<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/store-productviewmanager#section428319231351" target="_blank">onAppear</a>：回调函数，当元服务卡片加桌页成功打开时回调。<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/store-productviewmanager#section428319231351" target="_blank">onDisappear</a>：回调函数，当元服务卡片加桌页关闭时回调。         <div _ngcontent-asr-c106="" class="highlight-div"><div _ngcontent-asr-c106="" class="highlight-div-header"><div _ngcontent-asr-c106="" class="highlight-div-header-left"><div _ngcontent-asr-c106="" class="handle-button expand-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-asr-c106="" class="highlight-div-header-right"><div _ngcontent-asr-c106="" class="handle-button ai-button"></div><div _ngcontent-asr-c106="" class="handle-button line-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-asr-c106="" class="handle-button theme-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-asr-c106="" class="handle-button copy-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-asr-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">LoadServiceView</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'拉起应用市场详情页'</span>;</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Row</span>() {</li><li>      <span class="hljs-title class_">Column</span>() {</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span>)</li><li>          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">24</span>)</li><li>          .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-keyword">const</span> uiContext = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li>            <span class="hljs-keyword">const</span> <span class="hljs-attr">wantParam</span>: <span class="hljs-title class_">Want</span> = {</li><li>              <span class="hljs-comment">// 此处填入要加载的元服务的加桌链接</span></li><li>              <span class="hljs-attr">uri</span>: <span class="hljs-string">'xxx'</span></li><li>            }</li><li>            <span class="hljs-keyword">const</span> <span class="hljs-attr">callback</span>: productViewManager.<span class="hljs-property">ServiceViewCallback</span> = {</li><li>              <span class="hljs-attr">onReceive</span>: <span class="hljs-function">(<span class="hljs-params">data: productViewManager.ServiceViewReceiveData</span>) =&gt;</span> {</li><li>                hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0001</span>, <span class="hljs-string">'TAG'</span>, <span class="hljs-string">`loadService onReceive.result is <span class="hljs-subst">${data.result}</span>, msg is <span class="hljs-subst">${data.msg}</span>, formInfo is <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(data.formInfo)}</span>`</span>);</li><li>              },</li><li>              <span class="hljs-attr">onError</span>: <span class="hljs-function">(<span class="hljs-params">error: BusinessError</span>) =&gt;</span> {</li><li>                hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0</span>, <span class="hljs-string">'TAG'</span>, <span class="hljs-string">`loadService onError.code is <span class="hljs-subst">${error.code}</span>, message is <span class="hljs-subst">${error.message}</span>`</span>)</li><li>              },</li><li>              <span class="hljs-attr">onAppear</span>: <span class="hljs-function">() =&gt;</span> {</li><li>                hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0</span>, <span class="hljs-string">'TAG'</span>, <span class="hljs-string">`loadService onAppear.`</span>);</li><li>              },</li><li>              <span class="hljs-attr">onDisappear</span>: <span class="hljs-function">() =&gt;</span> {</li><li>                hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0</span>, <span class="hljs-string">'TAG'</span>, <span class="hljs-string">`loadService onDisappear.`</span>);</li><li>              }</li><li>            }</li><li>          })</li><li>      }</li><li>      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    }</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div></li>       </ul>       <p></p></li>      <li><span>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/store-productviewmanager#section16879449144620" target="_blank">productViewManager.loadService</a>方法，将步骤2中构造的参数依次传入接口中。</span>       <p></p>       <div _ngcontent-asr-c106="" class="highlight-div"><div _ngcontent-asr-c106="" class="highlight-div-header"><div _ngcontent-asr-c106="" class="highlight-div-header-left"><div _ngcontent-asr-c106="" class="handle-button expand-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-asr-c106="" class="highlight-div-header-right"><div _ngcontent-asr-c106="" class="handle-button ai-button"></div><div _ngcontent-asr-c106="" class="handle-button line-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-asr-c106="" class="handle-button theme-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-asr-c106="" class="handle-button copy-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-asr-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 调用接口，加载元服务加桌页面</span></li><li>productViewManager.<span class="hljs-title function_">loadService</span>(uiContext, wantParam, callback);</li></ol></pre></div></div>       <p></p></li>     </ol>    </div>    <div class="tiledSection">     <h3 id="section729012543213">应用详情页展示<i class="anchor-icon anchor-icon-link" anchorid="section729012543213" tips="复制节点链接"></i></h3>          <ul>      <li><strong>方式一：loadProduct接口调用</strong></li>     </ul>     <ol>      <li><span>导入productViewManager模块及相关公共模块。</span>       <p></p>       <div _ngcontent-asr-c106="" class="highlight-div"><div _ngcontent-asr-c106="" class="highlight-div-header"><div _ngcontent-asr-c106="" class="highlight-div-header-left"><div _ngcontent-asr-c106="" class="handle-button expand-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-asr-c106="" class="highlight-div-header-right"><div _ngcontent-asr-c106="" class="handle-button ai-button"></div><div _ngcontent-asr-c106="" class="handle-button line-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-asr-c106="" class="handle-button theme-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-asr-c106="" class="handle-button copy-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-asr-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { productViewManager } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AppGalleryKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li><span class="hljs-keyword">import</span> <span class="hljs-keyword">type</span> { common, <span class="hljs-title class_">Want</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li></ol></pre></div></div>       <p></p></li>      <li><span>构造应用详情页参数。</span>       <p></p>       <ul>        <li>第一个参数是获取当前Page页面的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext" target="_blank">UIAbilityContext</a>。</li>        <li>第二个参数是构造一个<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-want" target="_blank">Want</a>类型的对象，可以传入两个属性，bundleName：需要加载的应用包名。skExposure：<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/store-productviewmanager#section1346915243448" target="_blank">SKExposure</a>类型，向应用归因服务传递登记归因来源信息。</li>        <li>第三个参数是可选参数对象，可以传入三个属性，<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/store-productviewmanager#section1744815172418" target="_blank">onError</a>：回调函数，回调返回的信息为应用详情页加载失败时的错误信息。<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/store-productviewmanager#section1744815172418" target="_blank">onAppear</a>：回调函数，当应用详情页成功打开时回调。<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/store-productviewmanager#section1744815172418" target="_blank">onDisappear</a>：回调函数，当应用详情页关闭时回调。         <div _ngcontent-asr-c106="" class="highlight-div"><div _ngcontent-asr-c106="" class="highlight-div-header"><div _ngcontent-asr-c106="" class="highlight-div-header-left"><div _ngcontent-asr-c106="" class="handle-button expand-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-asr-c106="" class="highlight-div-header-right"><div _ngcontent-asr-c106="" class="handle-button ai-button"></div><div _ngcontent-asr-c106="" class="handle-button line-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-asr-c106="" class="handle-button theme-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-asr-c106="" class="handle-button copy-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-asr-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">LoadProductView</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'拉起应用市场详情页'</span>;</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Row</span>() {</li><li>      <span class="hljs-title class_">Column</span>() {</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span>)</li><li>          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">24</span>)</li><li>          .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-keyword">const</span> <span class="hljs-attr">exposureData</span>: productViewManager.<span class="hljs-property">SKExposure</span> = {</li><li>              <span class="hljs-attr">adTechId</span>: <span class="hljs-string">'20****e8'</span>,</li><li>              <span class="hljs-attr">campaignId</span>: <span class="hljs-string">'123456'</span>,</li><li>              <span class="hljs-attr">destinationId</span>: <span class="hljs-string">'10******'</span>,</li><li>              <span class="hljs-attr">mmpIds</span>: [<span class="hljs-string">'2f****5'</span>, <span class="hljs-string">'2f7***5'</span>],</li><li>              <span class="hljs-attr">serviceTag</span>: <span class="hljs-string">'123***2'</span>,</li><li>              <span class="hljs-attr">nonce</span>: <span class="hljs-string">'123***2'</span>,</li><li>              <span class="hljs-attr">timestamp</span>: <span class="hljs-number">1705536488</span>,</li><li>              <span class="hljs-attr">signature</span>: <span class="hljs-string">'MEQCIEQlmZ****zKBSE8QnhLTIHZZZ****ZpRqRxHss65Ko****JgJKjdrWdkL****juEx2RmFS7da****ZRVZ8RyMyUXg=='</span></li><li>            };</li><li>            <span class="hljs-keyword">const</span> uiContext = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span></li><li>            <span class="hljs-keyword">const</span> <span class="hljs-attr">wantParam</span>: <span class="hljs-title class_">Want</span> = {</li><li>              <span class="hljs-attr">parameters</span>: {</li><li>                <span class="hljs-comment">// 必填，此处填入要加载的应用包名，例如： bundleName: 'com.huawei.hmsapp.books'</span></li><li>                <span class="hljs-attr">bundleName</span>: <span class="hljs-string">'com.xxx'</span>,</li><li>                <span class="hljs-comment">// 可选，向应用归因服务传递登记归因来源数据</span></li><li>                <span class="hljs-attr">skExposure</span>: exposureData</li><li>              }</li><li>            }</li><li>            <span class="hljs-keyword">const</span> <span class="hljs-attr">callback</span>: productViewManager.<span class="hljs-property">ProductViewCallback</span> = {</li><li>              <span class="hljs-attr">onError</span>: <span class="hljs-function">(<span class="hljs-params">error: BusinessError</span>) =&gt;</span> {</li><li>                hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0</span>, <span class="hljs-string">'TAG'</span>,</li><li>                  <span class="hljs-string">`loadProduct onError.code is <span class="hljs-subst">${error.code}</span>, message is <span class="hljs-subst">${error.message}</span>`</span>)</li><li>              },</li><li>              <span class="hljs-attr">onAppear</span>: <span class="hljs-function">() =&gt;</span> {</li><li>                hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0</span>, <span class="hljs-string">'TAG'</span>, <span class="hljs-string">`loadProduct onAppear.`</span>);</li><li>              },</li><li>              <span class="hljs-attr">onDisappear</span>: <span class="hljs-function">() =&gt;</span> {</li><li>                hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0</span>, <span class="hljs-string">'TAG'</span>, <span class="hljs-string">`loadProduct onDisappear.`</span>);</li><li>              }</li><li>            }</li><li>          })</li><li>          .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>      }</li><li>      .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div></li>       </ul>       <p></p></li>      <li><span>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/store-productviewmanager#section144826162913" target="_blank">loadProduct</a>方法，将步骤2中构造的参数依次传入接口中。</span>       <p></p>       <div _ngcontent-asr-c106="" class="highlight-div"><div _ngcontent-asr-c106="" class="highlight-div-header"><div _ngcontent-asr-c106="" class="highlight-div-header-left"><div _ngcontent-asr-c106="" class="handle-button expand-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-asr-c106="" class="highlight-div-header-right"><div _ngcontent-asr-c106="" class="handle-button ai-button"></div><div _ngcontent-asr-c106="" class="handle-button line-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-asr-c106="" class="handle-button theme-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-asr-c106="" class="handle-button copy-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-asr-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 调用接口，拉起应用详情页</span></li><li>productViewManager.<span class="hljs-title function_">loadProduct</span>(uiContext, wantParam, callback);</li></ol></pre></div></div>       <p></p></li>     </ol>     <ul>      <li><strong>方式二：Deep Linking方式</strong>       <p>构造拼接bundleName的Deep Linking链接，其中bundleName为需要打开的应用包名，其格式为：</p>       <div _ngcontent-asr-c106="" class="highlight-div"><div _ngcontent-asr-c106="" class="highlight-div-header"><div _ngcontent-asr-c106="" class="highlight-div-header-left"><div _ngcontent-asr-c106="" class="handle-button expand-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-asr-c106="" class="highlight-div-header-right"><div _ngcontent-asr-c106="" class="handle-button ai-button"></div><div _ngcontent-asr-c106="" class="handle-button line-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-asr-c106="" class="handle-button theme-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-asr-c106="" class="handle-button copy-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-asr-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-attr">store</span>:<span class="hljs-comment">//appgallery.huawei.com/app/detail?id= + bundleName</span></li></ol></pre></div></div>       <p>在应用中调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext#startability-2" target="_blank">startAbility</a>方法，拉起应用市场应用详情页：</p>       <div _ngcontent-asr-c106="" class="highlight-div"><div _ngcontent-asr-c106="" class="highlight-div-header"><div _ngcontent-asr-c106="" class="highlight-div-header-left"><div _ngcontent-asr-c106="" class="handle-button expand-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-asr-c106="" class="highlight-div-header-right"><div _ngcontent-asr-c106="" class="handle-button ai-button"></div><div _ngcontent-asr-c106="" class="handle-button line-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-asr-c106="" class="handle-button theme-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-asr-c106="" class="handle-button copy-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-asr-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li><span class="hljs-keyword">import</span> <span class="hljs-keyword">type</span> { common, <span class="hljs-title class_">Want</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-comment">// 拉起应用市场对应的应用详情页面</span></li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">startAppGalleryDetailAbility</span>(<span class="hljs-params">context: common.UIAbilityContext, bundleName: <span class="hljs-built_in">string</span></span>): <span class="hljs-built_in">void</span> {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">want</span>: <span class="hljs-title class_">Want</span> = {</li><li>    <span class="hljs-attr">action</span>: <span class="hljs-string">'ohos.want.action.appdetail'</span>, <span class="hljs-comment">//隐式指定action为ohos.want.action.appdetail</span></li><li>    <span class="hljs-attr">uri</span>: <span class="hljs-string">'store://appgallery.huawei.com/app/detail?id='</span> + bundleName, <span class="hljs-comment">//  bundleName为需要打开应用详情的应用包名</span></li><li>  };</li><li>  context.<span class="hljs-title function_">startAbility</span>(want).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>    hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0001</span>, <span class="hljs-string">'TAG'</span>, <span class="hljs-string">"Succeeded in starting Ability successfully."</span>)</li><li>  }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error: BusinessError</span>) =&gt;</span> {</li><li>    hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0001</span>, <span class="hljs-string">'TAG'</span>, <span class="hljs-string">`Failed to startAbility.Code: <span class="hljs-subst">${error.code}</span>, message is <span class="hljs-subst">${error.message}</span>`</span>);</li><li>  });</li><li>}</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">StartAppGalleryDetailAbilityView</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'拉起应用市场详情页'</span>;</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Row</span>() {</li><li>      <span class="hljs-title class_">Column</span>() {</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span>)</li><li>          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">24</span>)</li><li>          .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-keyword">const</span> <span class="hljs-attr">context</span>: common.<span class="hljs-property">UIAbilityContext</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li>            <span class="hljs-comment">// 按实际需求获取应用的bundleName，例如bundleName: 'com.huawei.hmsapp.books'</span></li><li>            <span class="hljs-keyword">const</span> bundleName = <span class="hljs-string">'xxxx'</span>;</li><li>            <span class="hljs-title function_">startAppGalleryDetailAbility</span>(context, bundleName);</li><li>          })</li><li>      }</li><li>      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    }</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div>       <p>在网页中打开Deep Linking链接拉起应用市场应用详情页：</p>       <div _ngcontent-asr-c106="" class="highlight-div"><div _ngcontent-asr-c106="" class="highlight-div-header"><div _ngcontent-asr-c106="" class="highlight-div-header-left"><div _ngcontent-asr-c106="" class="handle-button expand-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-asr-c106="" class="highlight-div-header-right"><div _ngcontent-asr-c106="" class="handle-button ai-button"></div><div _ngcontent-asr-c106="" class="handle-button line-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-asr-c106="" class="handle-button theme-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-asr-c106="" class="handle-button copy-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-asr-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li>&lt;html lang=<span class="hljs-string">"en"</span>&gt;</li><li>  <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span></span></li><li><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span></span></li><li><span class="language-xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span></span></li><li><span class="language-xml">  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span></span></li><li><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span></li><li><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"button"</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">"openDeepLink()"</span>&gt;</span>拉起应用详情页<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span></li><li><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span></li><li><span class="language-xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></span></li><li><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></span></li><li><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span></span></li><li><span class="language-xml">  <span class="hljs-keyword">function</span> <span class="hljs-title function_">openDeepLink</span>(<span class="hljs-params"></span>) {</span></li><li><span class="language-xml">    <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">open</span>(<span class="hljs-string">'store://appgallery.huawei.com/app/detail?id=com.xxxx.xxxx'</span>)</span></li><li><span class="language-xml">  }</span></li><li><span class="language-xml"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></li></ol></pre></div></div></li>     </ul>     <ul>      <li><strong>方式三：App Linking方式</strong>       <p>构造拼接bundleName的App Linking链接，其中bundleName为需要打开的应用包名，其格式为：</p>       <div _ngcontent-asr-c106="" class="highlight-div"><div _ngcontent-asr-c106="" class="highlight-div-header"><div _ngcontent-asr-c106="" class="highlight-div-header-left"><div _ngcontent-asr-c106="" class="handle-button expand-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-asr-c106="" class="highlight-div-header-right"><div _ngcontent-asr-c106="" class="handle-button ai-button"></div><div _ngcontent-asr-c106="" class="handle-button line-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-asr-c106="" class="handle-button theme-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-asr-c106="" class="handle-button copy-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-asr-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-attr">https</span>:<span class="hljs-comment">//appgallery.huawei.com/app/detail?id= + bundleName</span></li></ol></pre></div></div>       <p>在应用中调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext#openlink12" target="_blank">openLink</a>接口拉起App Linking链接：</p>       <div _ngcontent-asr-c106="" class="highlight-div"><div _ngcontent-asr-c106="" class="highlight-div-header"><div _ngcontent-asr-c106="" class="highlight-div-header-left"><div _ngcontent-asr-c106="" class="handle-button expand-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-asr-c106="" class="highlight-div-header-right"><div _ngcontent-asr-c106="" class="handle-button ai-button"></div><div _ngcontent-asr-c106="" class="handle-button line-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-asr-c106="" class="handle-button theme-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-asr-c106="" class="handle-button copy-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-asr-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li><span class="hljs-keyword">import</span> <span class="hljs-keyword">type</span> { common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Button</span>(<span class="hljs-string">'start app linking'</span>, { <span class="hljs-attr">type</span>: <span class="hljs-title class_">ButtonType</span>.<span class="hljs-property">Capsule</span>, <span class="hljs-attr">stateEffect</span>: <span class="hljs-literal">true</span> })</li><li>      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'87%'</span>)</li><li>      .<span class="hljs-title function_">height</span>(<span class="hljs-string">'5%'</span>)</li><li>      .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">bottom</span>: <span class="hljs-string">'12vp'</span> })</li><li>      .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>        <span class="hljs-keyword">let</span> <span class="hljs-attr">context</span>: common.<span class="hljs-property">UIAbilityContext</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li>        <span class="hljs-comment">// 需要拼接不同的应用包名，用以打开不同的应用详情页,例如：bundleName: 'com.huawei.hmsapp.books'</span></li><li>        <span class="hljs-keyword">let</span> <span class="hljs-attr">bundleName</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'xxxx'</span>;</li><li>        <span class="hljs-keyword">let</span> <span class="hljs-attr">link</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'https://appgallery.huawei.com/app/detail?id='</span> + bundleName;</li><li>        <span class="hljs-comment">// 以App Linking优先的方式在应用市场打开指定包名的应用详情页</span></li><li>        context.<span class="hljs-title function_">openLink</span>(link, { <span class="hljs-attr">appLinkingOnly</span>: <span class="hljs-literal">false</span> })</li><li>          .<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0001</span>, <span class="hljs-string">'TAG'</span>, <span class="hljs-string">'openlink success.'</span>);</li><li>          })</li><li>          .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error: BusinessError</span>) =&gt;</span> {</li><li>            hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0001</span>, <span class="hljs-string">'TAG'</span>, <span class="hljs-string">`openlink failed. Code: <span class="hljs-subst">${error.code}</span>, message is <span class="hljs-subst">${error.message}</span>`</span>);</li><li>          });</li><li>      })</li><li>  }</li><li>}</li></ol></pre></div></div>       <p>在网页中打开App Linking链接：</p>       <div _ngcontent-asr-c106="" class="highlight-div"><div _ngcontent-asr-c106="" class="highlight-div-header"><div _ngcontent-asr-c106="" class="highlight-div-header-left"><div _ngcontent-asr-c106="" class="handle-button expand-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-asr-c106="" class="highlight-div-header-right"><div _ngcontent-asr-c106="" class="handle-button ai-button"></div><div _ngcontent-asr-c106="" class="handle-button line-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-asr-c106="" class="handle-button theme-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-asr-c106="" class="handle-button copy-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-asr-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li>&lt;html lang=<span class="hljs-string">"en"</span>&gt;</li><li>  <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span></span></li><li><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span></span></li><li><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>跳转示例<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span></span></li><li><span class="language-xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span></span></li><li><span class="language-xml">  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span></span></li><li><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">'https://appgallery.huawei.com/app/detail?id=bundleName'</span>&gt;</span>AppLinking跳转示例<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></span></li><li><span class="language-xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></span></li><li><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></span></li></ol></pre></div></div></li>     </ul>    </div>    <div class="tiledSection">     <h3 id="section24431311141514">应用内快捷方式加桌<i class="anchor-icon anchor-icon-link" anchorid="section24431311141514" tips="复制节点链接"></i></h3>         </div>    <ul>     <li><strong>方式一：以静态资源方式创建桌面快捷方式</strong></li>    </ul>    <ol>     <li><span>导入productViewManager模块及相关公共模块。</span>      <p></p>      <div _ngcontent-asr-c106="" class="highlight-div"><div _ngcontent-asr-c106="" class="highlight-div-header"><div _ngcontent-asr-c106="" class="highlight-div-header-left"><div _ngcontent-asr-c106="" class="handle-button expand-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-asr-c106="" class="highlight-div-header-right"><div _ngcontent-asr-c106="" class="handle-button ai-button"></div><div _ngcontent-asr-c106="" class="handle-button line-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-asr-c106="" class="handle-button theme-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-asr-c106="" class="handle-button copy-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-asr-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { productViewManager } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AppGalleryKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li><span class="hljs-keyword">import</span> <span class="hljs-keyword">type</span> { common, <span class="hljs-title class_">Want</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li></ol></pre></div></div>      <p></p></li>     <li><span>构造调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/store-productviewmanager#section5665513519" target="_blank">checkPinShortcutPermitted</a>接口校验桌面快捷方式的参数。</span>      <p></p>      <ul>       <li>第一个参数是获取当前Page页面的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext" target="_blank">UIAbilityContext</a>。</li>       <li>第二个参数是应用构造的快捷方式ID，取值为长度不超过63字节的字符串。</li>       <li>第三个参数是构造一个<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-want" target="_blank">Want</a>类型的对象，在该参数中传入用户点击快捷方式后被拉起的目标应用的bundleName、moduleName、abilityName等。</li>       <li>第四个参数是快捷方式显示在桌面上的名称的label资源索引名称。</li>       <li>第五个参数是快捷方式显示在桌面上的图标的icon文件资源索引名称。</li>      </ul>      <div _ngcontent-asr-c106="" class="highlight-div"><div _ngcontent-asr-c106="" class="highlight-div-header"><div _ngcontent-asr-c106="" class="highlight-div-header-left"><div _ngcontent-asr-c106="" class="handle-button expand-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-asr-c106="" class="highlight-div-header-right"><div _ngcontent-asr-c106="" class="handle-button ai-button"></div><div _ngcontent-asr-c106="" class="handle-button line-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-asr-c106="" class="handle-button theme-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-asr-c106="" class="handle-button copy-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-asr-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">const</span> uiContext =<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li><span class="hljs-keyword">const</span> shortcutId = <span class="hljs-string">"id_test1"</span>; <span class="hljs-comment">// 对应shortcuts标签中配置的shortcutId, 例如: "shortcutId": "id_test1"</span></li><li><span class="hljs-keyword">const</span> labelResName = <span class="hljs-string">"shortcut"</span>; <span class="hljs-comment">// 对应shortcuts标签中配置的label资源索引名称, 例如: "label": "$string:shortcut"</span></li><li><span class="hljs-keyword">const</span> iconResName = <span class="hljs-string">"aa_icon"</span>; <span class="hljs-comment">// 对应shortcuts标签中配置的icon资源索引名称, 例如: "icon": "$media:aa_icon"</span></li><li><span class="hljs-keyword">const</span> <span class="hljs-attr">want</span>: <span class="hljs-title class_">Want</span> = {            <span class="hljs-comment">// 对应shortcuts标签中配置的want</span></li><li>  <span class="hljs-attr">bundleName</span>: <span class="hljs-string">"com.example.appgallery.kit.demo"</span>,</li><li>  <span class="hljs-attr">moduleName</span>: <span class="hljs-string">"entry"</span>,</li><li>  <span class="hljs-attr">abilityName</span>: <span class="hljs-string">"EntryAbility"</span>,</li><li>  <span class="hljs-attr">parameters</span>: {</li><li>    <span class="hljs-attr">testKey</span>: <span class="hljs-string">"testValue"</span></li><li>  }</li><li>};</li></ol></pre></div></div>      <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">        <p>需提前<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/typical-scenario-configuration" target="_blank">创建应用静态快捷方式</a>，且第二、三、四、五个参数需要与<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/module-configuration-file#shortcuts标签" target="_blank">shortcuts标签</a>中的配置保持一致。</p>        <p>若校验参数发生变化，则每次覆盖生成新的tid，否则返回历史tid以及剩余过期时间expired。</p>       </div></div></div>      <p></p></li>     <li><span>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/store-productviewmanager#section5665513519" target="_blank">checkPinShortcutPermitted</a>接口，将步骤2中的参数依次传入接口中，并保存异步返回的结果<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/store-productviewmanager#section1548317391199" target="_blank">CheckShortcutResult</a>。</span>      <p></p>      <div _ngcontent-asr-c106="" class="highlight-div"><div _ngcontent-asr-c106="" class="highlight-div-header"><div _ngcontent-asr-c106="" class="highlight-div-header-left"><div _ngcontent-asr-c106="" class="handle-button expand-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-asr-c106="" class="highlight-div-header-right"><div _ngcontent-asr-c106="" class="handle-button ai-button"></div><div _ngcontent-asr-c106="" class="handle-button line-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-asr-c106="" class="handle-button theme-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-asr-c106="" class="handle-button copy-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-asr-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">try</span> {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">checkShortcutResult</span>: productViewManager.<span class="hljs-property">CheckShortcutResult</span>;</li><li>  productViewManager.<span class="hljs-title function_">checkPinShortcutPermitted</span>(uiContext, shortcutId, want, labelResName, iconResName)</li><li>    .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">result: productViewManager.CheckShortcutResult</span>) =&gt;</span> {</li><li>      hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0001</span>, <span class="hljs-string">'TAG'</span>, <span class="hljs-string">`checkPinShortcutPermitted success result is <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(result)}</span>`</span>);</li><li>      checkShortcutResult = result;</li><li>    }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error: BusinessError</span>) =&gt;</span> {</li><li>    hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0001</span>, <span class="hljs-string">'TAG'</span>,</li><li>      <span class="hljs-string">`checkPinShortcutPermitted error. code is <span class="hljs-subst">${error.code}</span>, message is <span class="hljs-subst">${error.message}</span>`</span>);</li><li>  })</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>  hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0001</span>, <span class="hljs-string">'TAG'</span>, <span class="hljs-string">`checkPinShortcutPermitted failed, code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>}</li></ol></pre></div></div>      <p></p></li>     <li><span>构造调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/store-productviewmanager#section2891132652315" target="_blank">requestNewPinShortcut</a>接口创建桌面快捷方式的参数。</span>      <p></p>      <ul>       <li>第一个参数是获取当前Page页面的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext" target="_blank">UIAbilityContext</a>。</li>       <li>第二个参数是步骤3中调用接口返回得到的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/store-productviewmanager#section1548317391199" target="_blank">CheckShortcutResult</a>的属性tid的值。</li>      </ul>      <div _ngcontent-asr-c106="" class="highlight-div"><div _ngcontent-asr-c106="" class="highlight-div-header"><div _ngcontent-asr-c106="" class="highlight-div-header-left"><div _ngcontent-asr-c106="" class="handle-button expand-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-asr-c106="" class="highlight-div-header-right"><div _ngcontent-asr-c106="" class="handle-button ai-button"></div><div _ngcontent-asr-c106="" class="handle-button line-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-asr-c106="" class="handle-button theme-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-asr-c106="" class="handle-button copy-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-asr-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">const</span> uiContext = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li><span class="hljs-keyword">const</span> tid = checkShortcutResult.<span class="hljs-property">tid</span>;</li></ol></pre></div></div>      <p></p></li>     <li><span>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/store-productviewmanager#section2891132652315" target="_blank">requestNewPinShortcut</a>接口，将步骤4中的参数依次传入接口中。</span>      <p></p>      <div _ngcontent-asr-c106="" class="highlight-div"><div _ngcontent-asr-c106="" class="highlight-div-header"><div _ngcontent-asr-c106="" class="highlight-div-header-left"><div _ngcontent-asr-c106="" class="handle-button expand-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-asr-c106="" class="highlight-div-header-right"><div _ngcontent-asr-c106="" class="handle-button ai-button"></div><div _ngcontent-asr-c106="" class="handle-button line-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-asr-c106="" class="handle-button theme-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-asr-c106="" class="handle-button copy-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-asr-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">try</span> {</li><li>  productViewManager.<span class="hljs-title function_">requestNewPinShortcut</span>(uiContext, tid)</li><li>    .<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>      hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0001</span>, <span class="hljs-string">'TAG'</span>, <span class="hljs-string">`requestNewPinShortcut success.`</span>);</li><li>    }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error: BusinessError</span>) =&gt;</span> {</li><li>    hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0001</span>, <span class="hljs-string">'TAG'</span>, <span class="hljs-string">`requestNewPinShortcut error. code is <span class="hljs-subst">${error.code}</span>, message is <span class="hljs-subst">${error.message}</span>`</span>);</li><li>  })</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>  hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0001</span>, <span class="hljs-string">'TAG'</span>, <span class="hljs-string">`requestNewPinShortcut failed, code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>}</li></ol></pre></div></div>      <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">        <p>快捷方式加桌成功后，原校验结果tid会失效，再次加桌需重新校验生成新的tid。</p>        <p>为了提升用户体验，推荐预先调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/store-productviewmanager#section5665513519" target="_blank">checkPinShortcutPermitted</a>接口，当用户点击加桌后，再调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/store-productviewmanager#section2891132652315" target="_blank">requestNewPinShortcut</a>接口执行加桌请求。</p>        <p>不建议在用户点击加桌后再连续调用这两个接口执行加桌。</p>       </div></div></div>      <p></p></li>    </ol>    <ul>     <li><strong>方式二：以自定义资源方式创建桌面快捷方式</strong></li>    </ul>    <ol>     <li><span>导入productViewManager模块及相关公共模块。</span>      <p></p>      <div _ngcontent-asr-c106="" class="highlight-div"><div _ngcontent-asr-c106="" class="highlight-div-header"><div _ngcontent-asr-c106="" class="highlight-div-header-left"><div _ngcontent-asr-c106="" class="handle-button expand-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-asr-c106="" class="highlight-div-header-right"><div _ngcontent-asr-c106="" class="handle-button ai-button"></div><div _ngcontent-asr-c106="" class="handle-button line-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-asr-c106="" class="handle-button theme-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-asr-c106="" class="handle-button copy-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-asr-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { productViewManager } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AppGalleryKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li><span class="hljs-keyword">import</span> <span class="hljs-keyword">type</span> { common, <span class="hljs-title class_">Want</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li></ol></pre></div></div>      <p></p></li>     <li><span>构造调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/store-productviewmanager#section5665513519" target="_blank">checkPinShortcutPermitted</a>接口构造校验桌面快捷方式的参数。</span>      <p></p>      <ul>       <li>第一个参数是获取当前Page页面的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext" target="_blank">UIAbilityContext</a>。</li>       <li>第二个参数是应用构造的快捷方式ID，取值为长度不超过63字节的字符串。</li>       <li>第三个参数是构造一个<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-want" target="_blank">Want</a>类型的对象，在该参数中传入用户点击快捷方式后被拉起的目标应用的bundleName、moduleName、abilityName等。</li>       <li>第四个参数是快捷方式显示在桌面名称的文本内容。</li>       <li>第五个参数是快捷方式显示在桌面图标的应用沙箱地址，图标最大不超过100KB，格式为png和webp。</li>       <li>第六个参数预留，暂不支持，传入空字符串。</li>      </ul>      <div _ngcontent-asr-c106="" class="highlight-div"><div _ngcontent-asr-c106="" class="highlight-div-header"><div _ngcontent-asr-c106="" class="highlight-div-header-left"><div _ngcontent-asr-c106="" class="handle-button expand-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-asr-c106="" class="highlight-div-header-right"><div _ngcontent-asr-c106="" class="handle-button ai-button"></div><div _ngcontent-asr-c106="" class="handle-button line-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-asr-c106="" class="handle-button theme-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-asr-c106="" class="handle-button copy-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-asr-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">const</span> uiContext = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li><span class="hljs-keyword">const</span> shortcutId = <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-built_in">Date</span>.now()}</span>`</span>;</li><li><span class="hljs-keyword">const</span> <span class="hljs-attr">want</span>: <span class="hljs-title class_">Want</span> = {</li><li>  <span class="hljs-attr">bundleName</span>: <span class="hljs-string">"com.example.appgallery.kit.demo"</span>,</li><li>  <span class="hljs-attr">moduleName</span>: <span class="hljs-string">"entry"</span>,</li><li>  <span class="hljs-attr">abilityName</span>: <span class="hljs-string">"EntryAbility"</span>,</li><li>  <span class="hljs-attr">parameters</span>: {</li><li>    <span class="hljs-attr">testKey</span>: <span class="hljs-string">"testValue"</span></li><li>  }</li><li>}</li><li><span class="hljs-keyword">const</span> label = <span class="hljs-string">"shortcut"</span>;</li><li><span class="hljs-keyword">const</span> foregroundIcon = uiContext.<span class="hljs-property">filesDir</span> + <span class="hljs-string">"/icon.png"</span>;</li><li><span class="hljs-keyword">const</span> backgroundIcon = <span class="hljs-string">""</span>;</li></ol></pre></div></div>      <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">        <p>当前不支持背景层图标，第六个参数backgroundIcon传空字符串。</p>        <p>若校验参数发生变化，则每次覆盖生成新的tid，否则返回历史tid以及剩余过期时间expired。</p>       </div></div></div>      <p></p></li>     <li><span>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/store-productviewmanager#section41029172212" target="_blank">checkPinShortcutPermitted</a>接口，将步骤2中的参数依次传入接口中，并保存异步返回的结果<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/store-productviewmanager#section1548317391199" target="_blank">CheckShortcutResult</a>。</span>      <p></p>      <div _ngcontent-asr-c106="" class="highlight-div"><div _ngcontent-asr-c106="" class="highlight-div-header"><div _ngcontent-asr-c106="" class="highlight-div-header-left"><div _ngcontent-asr-c106="" class="handle-button expand-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-asr-c106="" class="highlight-div-header-right"><div _ngcontent-asr-c106="" class="handle-button ai-button"></div><div _ngcontent-asr-c106="" class="handle-button line-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-asr-c106="" class="handle-button theme-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-asr-c106="" class="handle-button copy-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-asr-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">try</span> {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">checkShortcutResult</span>: productViewManager.<span class="hljs-property">CheckShortcutResult</span>;</li><li>  productViewManager.<span class="hljs-title function_">checkPinShortcutPermitted</span>(uiContext, shortcutId, want, label, foregroundIcon, backgroundIcon)</li><li>    .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">result: productViewManager.CheckShortcutResult</span>) =&gt;</span> {</li><li>      hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0001</span>, <span class="hljs-string">'TAG'</span>, <span class="hljs-string">`checkPinShortcutPermitted success result is <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(result)}</span>`</span>)</li><li>      checkShortcutResult = result;</li><li>    }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error: BusinessError</span>) =&gt;</span> {</li><li>    hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0001</span>, <span class="hljs-string">'TAG'</span>,</li><li>      <span class="hljs-string">`checkPinShortcutPermitted error. code is <span class="hljs-subst">${error.code}</span>, message is <span class="hljs-subst">${error.message}</span>`</span>);</li><li>  })</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>  hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0001</span>, <span class="hljs-string">'TAG'</span>, <span class="hljs-string">`checkPinShortcutPermitted failed, code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>}</li></ol></pre></div></div>      <p></p></li>     <li><span>构造调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/store-productviewmanager#section2891132652315" target="_blank">requestNewPinShortcut</a>接口创建桌面快捷方式的参数。</span>      <p></p>      <ul>       <li>第一个参数是获取当前Page页面的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext" target="_blank">UIAbilityContext</a>。</li>       <li>第二个参数是步骤3中调用接口返回得到的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/store-productviewmanager#section1548317391199" target="_blank">CheckShortcutResult</a>的属性tid的值。</li>      </ul>      <div _ngcontent-asr-c106="" class="highlight-div"><div _ngcontent-asr-c106="" class="highlight-div-header"><div _ngcontent-asr-c106="" class="highlight-div-header-left"><div _ngcontent-asr-c106="" class="handle-button expand-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-asr-c106="" class="highlight-div-header-right"><div _ngcontent-asr-c106="" class="handle-button ai-button"></div><div _ngcontent-asr-c106="" class="handle-button line-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-asr-c106="" class="handle-button theme-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-asr-c106="" class="handle-button copy-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-asr-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">const</span> uiContext = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li><span class="hljs-keyword">const</span> tid = checkShortcutResult.<span class="hljs-property">tid</span>;</li></ol></pre></div></div>      <p></p></li>     <li><span>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/store-productviewmanager#section2891132652315" target="_blank">requestNewPinShortcut</a>接口，将步骤4中的参数依次传入接口中。</span>      <p></p>      <div _ngcontent-asr-c106="" class="highlight-div"><div _ngcontent-asr-c106="" class="highlight-div-header"><div _ngcontent-asr-c106="" class="highlight-div-header-left"><div _ngcontent-asr-c106="" class="handle-button expand-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-asr-c106="" class="highlight-div-header-right"><div _ngcontent-asr-c106="" class="handle-button ai-button"></div><div _ngcontent-asr-c106="" class="handle-button line-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-asr-c106="" class="handle-button theme-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-asr-c106="" class="handle-button copy-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-asr-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">try</span> {</li><li>  productViewManager.<span class="hljs-title function_">requestNewPinShortcut</span>(uiContext, tid)</li><li>    .<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>      hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0001</span>, <span class="hljs-string">'TAG'</span>, <span class="hljs-string">`requestNewPinShortcut success.`</span>);</li><li>    }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error: BusinessError</span>) =&gt;</span> {</li><li>    hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0001</span>, <span class="hljs-string">'TAG'</span>, <span class="hljs-string">`requestNewPinShortcut error. code is <span class="hljs-subst">${error.code}</span>, message is <span class="hljs-subst">${error.message}</span>`</span>);</li><li>  })</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>  hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0001</span>, <span class="hljs-string">'TAG'</span>, <span class="hljs-string">`requestNewPinShortcut failed, code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>}</li></ol></pre></div></div>      <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">        <p>快捷方式加桌成功后，原校验结果tid会失效，再次加桌需重新校验生成新的tid。</p>        <p>为了提升用户体验，推荐预先调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/store-productviewmanager#section5665513519" target="_blank">checkPinShortcutPermitted</a>接口，当用户点击加桌后，再调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/store-productviewmanager#section2891132652315" target="_blank">requestNewPinShortcut</a>接口执行加桌请求。</p>        <p>不建议在用户点击加桌后再连续调用这两个接口执行加桌。</p>       </div></div></div>      <p></p></li>    </ol>    <div class="tiledSection">     <h3 id="section143955287304">通过Deep Linking拉起写评论页<i class="anchor-icon anchor-icon-link" anchorid="section143955287304" tips="复制节点链接"></i></h3>         </div>    <p>构造拼接bundleName和action的Deep Linking链接，其中bundleName为需要拉起写评论页的应用包名，action隐式指定为write-review，表示进入详情页后，下一步将拉起写评论页，其格式为：</p>    <div _ngcontent-asr-c106="" class="highlight-div"><div _ngcontent-asr-c106="" class="highlight-div-header"><div _ngcontent-asr-c106="" class="highlight-div-header-left"><div _ngcontent-asr-c106="" class="handle-button expand-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-asr-c106="" class="highlight-div-header-right"><div _ngcontent-asr-c106="" class="handle-button ai-button"></div><div _ngcontent-asr-c106="" class="handle-button line-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-asr-c106="" class="handle-button theme-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-asr-c106="" class="handle-button copy-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-asr-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-attr">store</span>:<span class="hljs-comment">//appgallery.huawei.com/app/detail?id= + bundleName + &amp;action=write-review</span></li></ol></pre></div></div>    <p>在应用中调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext#startability-2" target="_blank">startAbility</a>方法，拉起应用市场应用的写评论页：</p>    <div _ngcontent-asr-c106="" class="highlight-div"><div _ngcontent-asr-c106="" class="highlight-div-header"><div _ngcontent-asr-c106="" class="highlight-div-header-left"><div _ngcontent-asr-c106="" class="handle-button expand-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-asr-c106="" class="highlight-div-header-right"><div _ngcontent-asr-c106="" class="handle-button ai-button"></div><div _ngcontent-asr-c106="" class="handle-button line-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-asr-c106="" class="handle-button theme-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-asr-c106="" class="handle-button copy-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-asr-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li><span class="hljs-keyword">import</span> <span class="hljs-keyword">type</span> { common, <span class="hljs-title class_">Want</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-comment">// 通过Deep Linking拉起应用市场指定的应用写评论页</span></li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">startAppGalleryDetailAbility</span>(<span class="hljs-params">context: common.UIAbilityContext, bundleName: <span class="hljs-built_in">string</span></span>): <span class="hljs-built_in">void</span> {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">want</span>: <span class="hljs-title class_">Want</span> = {</li><li>    <span class="hljs-attr">action</span>: <span class="hljs-string">'ohos.want.action.appdetail'</span>, <span class="hljs-comment">// 隐式指定action为ohos.want.action.appdetail</span></li><li>    <span class="hljs-attr">uri</span>: <span class="hljs-string">'store://appgallery.huawei.com/app/detail?id='</span> + bundleName + <span class="hljs-string">'&amp;action=write-review'</span><span class="hljs-comment">// bundleName为需要拉起写评论页的应用包名，action隐式指定为write-review，表示进入详情页后，下一步将拉起写评论页。</span></li><li>  };</li><li>  context.<span class="hljs-title function_">startAbility</span>(want).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>    hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0001</span>, <span class="hljs-string">'TAG'</span>, <span class="hljs-string">"Succeeded in starting Ability successfully."</span>)</li><li>  }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error: BusinessError</span>) =&gt;</span> {</li><li>    hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0001</span>, <span class="hljs-string">'TAG'</span>, <span class="hljs-string">`Failed to startAbility. Code: <span class="hljs-subst">${error.code}</span>, message is <span class="hljs-subst">${error.message}</span>`</span>);</li><li>  });</li><li>}</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">StartAppGalleryDetailAbilityView</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'通过Deep Linking拉起应用市场写评论页'</span></li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Row</span>() {</li><li>      <span class="hljs-title class_">Column</span>() {</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span>)</li><li>          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">24</span>)</li><li>          .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-keyword">const</span> <span class="hljs-attr">context</span>: common.<span class="hljs-property">UIAbilityContext</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li>            <span class="hljs-comment">// 按实际需求获取应用的bundleName，例如bundleName: 'com.huawei.hmsapp.books'</span></li><li>            <span class="hljs-keyword">const</span> bundleName = <span class="hljs-string">'xxxx'</span>;</li><li>            <span class="hljs-title function_">startAppGalleryDetailAbility</span>(context, bundleName);</li><li>          })</li><li>      }</li><li>      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    }</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div>    <p>在网页中打开Deep Linking链接拉起应用市场应用的写评论页：</p>    <div _ngcontent-asr-c106="" class="highlight-div"><div _ngcontent-asr-c106="" class="highlight-div-header"><div _ngcontent-asr-c106="" class="highlight-div-header-left"><div _ngcontent-asr-c106="" class="handle-button expand-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-asr-c106="" class="highlight-div-header-right"><div _ngcontent-asr-c106="" class="handle-button ai-button"></div><div _ngcontent-asr-c106="" class="handle-button line-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-asr-c106="" class="handle-button theme-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-asr-c106="" class="handle-button copy-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-asr-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li>&lt;html lang=<span class="hljs-string">"en"</span>&gt;</li><li>  <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span></span></li><li><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span></span></li><li><span class="language-xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span></span></li><li><span class="language-xml">  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span></span></li><li><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span></span></li><li><span class="language-xml">      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"button"</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">"openDeepLink()"</span>&gt;</span>通过Deep Linking拉起应用市场写评论页<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span></li><li><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span></li><li><span class="language-xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></span></li><li><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></span></li><li><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span></span></li><li><span class="language-xml">  <span class="hljs-keyword">function</span> <span class="hljs-title function_">openDeepLink</span>(<span class="hljs-params"></span>) {</span></li><li><span class="language-xml">    <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">open</span>(<span class="hljs-string">'store://appgallery.huawei.com/app/detail?id=com.xxxx.xxxx&amp;action=write-review'</span>)</span></li><li><span class="language-xml">  }</span></li><li><span class="language-xml"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></li></ol></pre></div></div>    <div class="tiledSection">     <h3 id="section62754534235">通过App Linking拉起写评论页<i class="anchor-icon anchor-icon-link" anchorid="section62754534235" tips="复制节点链接"></i></h3>          <p>构造拼接bundleName的App Linking链接，其中bundleName为需要拉起写评论页的应用包名，action隐式指定为write-review，表示进入详情页后，下一步将拉起写评论页，其格式为：</p>     <div _ngcontent-asr-c106="" class="highlight-div"><div _ngcontent-asr-c106="" class="highlight-div-header"><div _ngcontent-asr-c106="" class="highlight-div-header-left"><div _ngcontent-asr-c106="" class="handle-button expand-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-asr-c106="" class="highlight-div-header-right"><div _ngcontent-asr-c106="" class="handle-button ai-button"></div><div _ngcontent-asr-c106="" class="handle-button line-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-asr-c106="" class="handle-button theme-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-asr-c106="" class="handle-button copy-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-asr-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-attr">https</span>:<span class="hljs-comment">//appgallery.huawei.com/app/detail?id= + bundleName + &amp;action=write-review</span></li></ol></pre></div></div>     <p>在应用中调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext#openlink12" target="_blank">openLink</a>接口拉起App Linking链接：</p>     <div _ngcontent-asr-c106="" class="highlight-div"><div _ngcontent-asr-c106="" class="highlight-div-header"><div _ngcontent-asr-c106="" class="highlight-div-header-left"><div _ngcontent-asr-c106="" class="handle-button expand-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-asr-c106="" class="highlight-div-header-right"><div _ngcontent-asr-c106="" class="handle-button ai-button"></div><div _ngcontent-asr-c106="" class="handle-button line-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-asr-c106="" class="handle-button theme-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-asr-c106="" class="handle-button copy-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-asr-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li><span class="hljs-keyword">import</span> <span class="hljs-keyword">type</span> { common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Button</span>(<span class="hljs-string">'start app linking'</span>, { <span class="hljs-attr">type</span>: <span class="hljs-title class_">ButtonType</span>.<span class="hljs-property">Capsule</span>, <span class="hljs-attr">stateEffect</span>: <span class="hljs-literal">true</span> })</li><li>      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'87%'</span>)</li><li>      .<span class="hljs-title function_">height</span>(<span class="hljs-string">'5%'</span>)</li><li>      .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">bottom</span>: <span class="hljs-string">'12vp'</span> })</li><li>      .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>        <span class="hljs-keyword">let</span> <span class="hljs-attr">context</span>: common.<span class="hljs-property">UIAbilityContext</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li>        <span class="hljs-comment">// 需要拼接不同的应用包名，用以打开不同的应用写评论页,例如：bundleName: 'com.huawei.hmsapp.books'</span></li><li>        <span class="hljs-keyword">let</span> <span class="hljs-attr">bundleName</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'xxxx'</span>;</li><li>        <span class="hljs-keyword">let</span> <span class="hljs-attr">link</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'https://appgallery.huawei.com/app/detail?id='</span> + bundleName + <span class="hljs-string">'&amp;action=write-review'</span>;</li><li>        <span class="hljs-comment">// 以App Linking优先的方式在应用市场打开指定包名的应用写评论页</span></li><li>        context.<span class="hljs-title function_">openLink</span>(link, { <span class="hljs-attr">appLinkingOnly</span>: <span class="hljs-literal">false</span> })</li><li>          .<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0001</span>, <span class="hljs-string">'TAG'</span>, <span class="hljs-string">'openlink success.'</span>);</li><li>          })</li><li>          .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error: BusinessError</span>) =&gt;</span> {</li><li>            hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0001</span>, <span class="hljs-string">'TAG'</span>, <span class="hljs-string">`openlink failed. Code: <span class="hljs-subst">${error.code}</span>, message is <span class="hljs-subst">${error.message}</span>`</span>);</li><li>          });</li><li>      })</li><li>  }</li><li>}</li></ol></pre></div></div>     <p>在网页中打开App Linking链接：</p>     <div _ngcontent-asr-c106="" class="highlight-div"><div _ngcontent-asr-c106="" class="highlight-div-header"><div _ngcontent-asr-c106="" class="highlight-div-header-left"><div _ngcontent-asr-c106="" class="handle-button expand-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-asr-c106="" class="highlight-div-header-right"><div _ngcontent-asr-c106="" class="handle-button ai-button"></div><div _ngcontent-asr-c106="" class="handle-button line-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-asr-c106="" class="handle-button theme-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-asr-c106="" class="handle-button copy-button"><div _ngcontent-asr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-asr-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li>&lt;html lang=<span class="hljs-string">"en"</span>&gt;</li><li>  <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span></span></li><li><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span></span></li><li><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>跳转示例<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span></span></li><li><span class="language-xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span></span></li><li><span class="language-xml">  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span></span></li><li><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">'https://appgallery.huawei.com/app/detail?id=bundleName&amp;action=write-review'</span>&gt;</span>通过AppLinking拉起应用市场写评论页<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></span></li><li><span class="language-xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></span></li><li><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></span></li></ol></pre></div></div>    </div>   </div>   <div></div></div>