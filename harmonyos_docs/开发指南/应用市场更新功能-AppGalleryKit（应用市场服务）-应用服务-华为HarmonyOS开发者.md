<h1 _ngcontent-rcj-c119="" class="doc-title ng-star-inserted" title="应用市场更新功能"> 应用市场更新功能 </h1>

<div _ngcontent-rcj-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p>应用市场更新功能为开发者提供版本检测、显示更新提醒功能。开发者使用应用市场更新功能可以在应用内提醒用户及时更新到最新版本。</p>    <div class="tiledSection">     <h2 id="section10343164404617">场景介绍<i class="anchor-icon anchor-icon-link" anchorid="section10343164404617" tips="复制节点链接"></i></h2>          <p>当应用启动完成或用户在应用中主动检查应用新版本时，开发者可以通过本服务，来查询应用是否有可更新的版本。如果存在可更新版本，您可以通过本服务为用户显示更新提醒。</p>     <div class="tablenoborder">      <div class="tbBox"><table style="border-style: none;" class="layoutFixed idpTab">               <tbody><tr>         <td class="nocellnorowborder" style="border: none;" valign="top" width="37.21%">          <div class="fignone">           <span class="figcap"><b>图1 </b>调用检查更新、显示更新提醒</span>           <br><span><img height="607.81266" originheight="2848" originwidth="1276" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114517.50246531632524393539135336142971:50001231000000:2800:F13B52F391A6795C3D6B2B35120DAC8CA881A40A30CC0E5A4610AD57BA8ED7F3.jpg" title="点击放大" width="272.3175"></span>          </div></td>         <td class="cell-norowborder" style="border: none;" valign="top" width="62.79%">          <div class="fignone">           <span class="figcap"><b>图2 </b>进入更新界面</span>           <br><span><img height="603.35982" originheight="2848" originwidth="1276" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114517.68948683911352024177137203262262:50001231000000:2800:DE89BA1B8734313CEB538F09572962E1DB21E250B382B7A4582CD11F09095293.jpg" title="点击放大" width="270.3225"></span>          </div></td>        </tr>        <tr>         <td class="cellrowborder" style="border: none;" valign="top" width="37.21%">&nbsp;&nbsp;</td>         <td class="cellrowborder" style="border: none;" valign="top" width="62.79%">&nbsp;&nbsp;</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="section193161550114115">业务流程<i class="anchor-icon anchor-icon-link" anchorid="section193161550114115" tips="复制节点链接"></i></h2>          <p><span><img height="463.464435" originheight="814" originwidth="1356" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114518.50825358233113646954917845392509:50001231000000:2800:C4C94E08612E8886EBB40C854257B25D88A8F273ACCCB06541229E05916EC16E.png" title="点击放大" width="772.065"></span></p>     <p></p>     <p></p>     <ol>      <li>应用调用检查更新接口。</li>      <li>升级服务API返回是否有新版本。</li>      <li>调用显示升级对话框接口。</li>      <li>升级服务API向应用返回显示结果。</li>     </ol>    </div>    <div class="tiledSection">     <h2 id="section141091371419">约束与限制<i class="anchor-icon anchor-icon-link" anchorid="section141091371419" tips="复制节点链接"></i></h2>          <ul>      <li>应用市场更新功能支持Phone、Tablet、PC/2in1设备。从5.1.1(19)版本开始，新增支持TV设备，并且从6.0.0(20)版本开始，新增支持Wearable设备。</li>      <li>应用市场更新功能不支持模拟器，请使用真机调试。在模拟器中使用该服务将会提示：无法获取内容，请点击屏幕重试。</li>      <li>应用需要在应用市场上架。</li>     </ul>    </div>    <div class="tiledSection">     <h2 id="section6348454124618">接口说明<i class="anchor-icon anchor-icon-link" anchorid="section6348454124618" tips="复制节点链接"></i></h2>          <p>应用市场更新服务提供以下接口，具体API说明详见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/store-updatemanager" target="_blank">接口文档</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.5.3.1.3.1.1" valign="top" width="49.95%">          <p>接口名</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.5.3.1.3.1.2" valign="top" width="50.05%">          <p>描述</p></th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="49.95%">          <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/store-updatemanager#section10984155711373" target="_blank">checkAppUpdate</a>(context: <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext" target="_blank">common.UIAbilityContext</a>): Promise&lt;<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/store-updatemanager#section1535385414136" target="_blank">CheckUpdateResult</a>&gt;</p></td>         <td class="cellrowborder" valign="top" width="50.05%">          <p>检查更新接口，用于检测当前是否有新版本。</p></td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="49.95%">          <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/store-updatemanager#section16502191111574" target="_blank">showUpdateDialog</a>(context:<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext" target="_blank">common.UIAbilityContext</a>): Promise&lt;<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/store-updatemanager#section194882568246" target="_blank">ShowUpdateResultCode</a>&gt;</p></td>         <td class="cellrowborder" valign="top" width="50.05%">          <p>显示升级对话框接口，用于提示用户进行升级。</p></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="section316371715233">开发步骤<i class="anchor-icon anchor-icon-link" anchorid="section316371715233" tips="复制节点链接"></i></h2>         </div>    <div class="tiledSection">     <h3 id="section4267151120239" class="firsth2">检测应用新版本<i class="anchor-icon anchor-icon-link" anchorid="section4267151120239" tips="复制节点链接"></i></h3>          <ol>      <li><span>导入updateManager模块及相关公共模块。</span>       <p></p>       <div _ngcontent-rcj-c106="" class="highlight-div"><div _ngcontent-rcj-c106="" class="highlight-div-header"><div _ngcontent-rcj-c106="" class="highlight-div-header-left"><div _ngcontent-rcj-c106="" class="handle-button expand-button"><div _ngcontent-rcj-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rcj-c106="" class="highlight-div-header-right"><div _ngcontent-rcj-c106="" class="handle-button ai-button"></div><div _ngcontent-rcj-c106="" class="handle-button line-button"><div _ngcontent-rcj-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rcj-c106="" class="handle-button theme-button"><div _ngcontent-rcj-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rcj-c106="" class="handle-button copy-button"><div _ngcontent-rcj-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rcj-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { updateManager } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AppGalleryKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li><span class="hljs-keyword">import</span> <span class="hljs-keyword">type</span> { common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li></ol></pre></div></div>       <p></p></li>      <li><span>构造参数，其中入参为<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext" target="_blank">common.UIAbilityContext</a>类型的Context。</span>       <p></p>       <div _ngcontent-rcj-c106="" class="highlight-div"><div _ngcontent-rcj-c106="" class="highlight-div-header"><div _ngcontent-rcj-c106="" class="highlight-div-header-left"><div _ngcontent-rcj-c106="" class="handle-button expand-button"><div _ngcontent-rcj-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rcj-c106="" class="highlight-div-header-right"><div _ngcontent-rcj-c106="" class="handle-button ai-button"></div><div _ngcontent-rcj-c106="" class="handle-button line-button"><div _ngcontent-rcj-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rcj-c106="" class="handle-button theme-button"><div _ngcontent-rcj-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rcj-c106="" class="handle-button copy-button"><div _ngcontent-rcj-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rcj-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">let</span> <span class="hljs-attr">context</span>: common.<span class="hljs-property">UIAbilityContext</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li></ol></pre></div></div>       <p></p></li>      <li><span>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/store-updatemanager#section10984155711373" target="_blank">checkAppUpdate</a>方法检查应用版本是否有更新。</span>       <p></p>       <div _ngcontent-rcj-c106="" class="highlight-div"><div _ngcontent-rcj-c106="" class="highlight-div-header"><div _ngcontent-rcj-c106="" class="highlight-div-header-left"><div _ngcontent-rcj-c106="" class="handle-button expand-button"><div _ngcontent-rcj-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rcj-c106="" class="highlight-div-header-right"><div _ngcontent-rcj-c106="" class="handle-button ai-button"></div><div _ngcontent-rcj-c106="" class="handle-button line-button"><div _ngcontent-rcj-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rcj-c106="" class="handle-button theme-button"><div _ngcontent-rcj-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rcj-c106="" class="handle-button copy-button"><div _ngcontent-rcj-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rcj-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">try</span> {</li><li>  updateManager.<span class="hljs-title function_">checkAppUpdate</span>(context)</li><li>    .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">checkResult: updateManager.CheckUpdateResult</span>) =&gt;</span> {</li><li>      hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0</span>, <span class="hljs-string">'TAG'</span>, <span class="hljs-string">"Succeeded in checking Result updateAvailable:"</span> + checkResult.<span class="hljs-property">updateAvailable</span>);</li><li>    }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error: BusinessError</span>) =&gt;</span> {</li><li>    hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0</span>, <span class="hljs-string">'TAG'</span>, <span class="hljs-string">`checkAppUpdate onError.code is <span class="hljs-subst">${error.code}</span>, message is <span class="hljs-subst">${error.message}</span>`</span>);</li><li>  });</li><li>} <span class="hljs-keyword">catch</span> (error) {</li><li>  hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0</span>, <span class="hljs-string">'TAG'</span>, <span class="hljs-string">`checkAppUpdate onError.code is <span class="hljs-subst">${error.code}</span>, message is <span class="hljs-subst">${error.message}</span>`</span>);</li><li>}</li></ol></pre></div></div>       <p></p></li>     </ol>     <div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content">       <ul>        <li>本地安装版本须低于应用市场在架版本才能检查到更新。</li>        <li>本地安装版本须和应用市场在架版本签名信息保持一致。</li>        <li>暂不支持邀请测试和公开测试。</li>       </ul>      </div></div></div>    </div>    <div class="tiledSection">     <h3 id="section1226719114231">显示升级对话框<i class="anchor-icon anchor-icon-link" anchorid="section1226719114231" tips="复制节点链接"></i></h3>          <ol>      <li><span>导入updateManager 模块及相关公共模块。</span>       <p></p>       <div _ngcontent-rcj-c106="" class="highlight-div"><div _ngcontent-rcj-c106="" class="highlight-div-header"><div _ngcontent-rcj-c106="" class="highlight-div-header-left"><div _ngcontent-rcj-c106="" class="handle-button expand-button"><div _ngcontent-rcj-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rcj-c106="" class="highlight-div-header-right"><div _ngcontent-rcj-c106="" class="handle-button ai-button"></div><div _ngcontent-rcj-c106="" class="handle-button line-button"><div _ngcontent-rcj-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rcj-c106="" class="handle-button theme-button"><div _ngcontent-rcj-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rcj-c106="" class="handle-button copy-button"><div _ngcontent-rcj-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rcj-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { updateManager } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AppGalleryKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li><span class="hljs-keyword">import</span> <span class="hljs-keyword">type</span> { common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li></ol></pre></div></div>       <p></p></li>      <li><span>构造参数，其中入参为<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext" target="_blank">common.UIAbilityContext</a>类型的Context。</span>       <p></p>       <div _ngcontent-rcj-c106="" class="highlight-div"><div _ngcontent-rcj-c106="" class="highlight-div-header"><div _ngcontent-rcj-c106="" class="highlight-div-header-left"><div _ngcontent-rcj-c106="" class="handle-button expand-button"><div _ngcontent-rcj-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rcj-c106="" class="highlight-div-header-right"><div _ngcontent-rcj-c106="" class="handle-button ai-button"></div><div _ngcontent-rcj-c106="" class="handle-button line-button"><div _ngcontent-rcj-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rcj-c106="" class="handle-button theme-button"><div _ngcontent-rcj-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rcj-c106="" class="handle-button copy-button"><div _ngcontent-rcj-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rcj-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">let</span> <span class="hljs-attr">context</span>: common.<span class="hljs-property">UIAbilityContext</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li></ol></pre></div></div>       <p></p></li>      <li><span>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/store-updatemanager#section16502191111574" target="_blank">showUpdateDialog</a>方法显示升级对话框。</span>       <p></p>       <div _ngcontent-rcj-c106="" class="highlight-div"><div _ngcontent-rcj-c106="" class="highlight-div-header"><div _ngcontent-rcj-c106="" class="highlight-div-header-left"><div _ngcontent-rcj-c106="" class="handle-button expand-button"><div _ngcontent-rcj-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rcj-c106="" class="highlight-div-header-right"><div _ngcontent-rcj-c106="" class="handle-button ai-button"></div><div _ngcontent-rcj-c106="" class="handle-button line-button"><div _ngcontent-rcj-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rcj-c106="" class="handle-button theme-button"><div _ngcontent-rcj-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rcj-c106="" class="handle-button copy-button"><div _ngcontent-rcj-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rcj-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">try</span> {</li><li>  updateManager.<span class="hljs-title function_">showUpdateDialog</span>(context)</li><li>    .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">resultCode: updateManager.ShowUpdateResultCode</span>) =&gt;</span> {</li><li>      hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0</span>, <span class="hljs-string">'TAG'</span>, <span class="hljs-string">"Succeeded in showing UpdateDialog resultCode:"</span> + resultCode);</li><li>    })</li><li>    .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error: BusinessError</span>) =&gt;</span> {</li><li>      hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0</span>, <span class="hljs-string">'TAG'</span>, <span class="hljs-string">`showUpdateDialog onError.code is <span class="hljs-subst">${error.code}</span>, message is <span class="hljs-subst">${error.message}</span>`</span>);</li><li>    });</li><li>} <span class="hljs-keyword">catch</span> (error) {</li><li>  hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0</span>, <span class="hljs-string">'TAG'</span>, <span class="hljs-string">`showUpdateDialog onError.code is <span class="hljs-subst">${error.code}</span>, message is <span class="hljs-subst">${error.message}</span>`</span>);</li><li>}</li></ol></pre></div></div>       <p></p></li>     </ol>    </div>   </div>   <div></div></div>