<h1 _ngcontent-vuq-c119="" class="doc-title ng-star-inserted" title="应用数据向量化 (ArkTS)"> 应用数据向量化 (ArkTS) </h1>

<div _ngcontent-vuq-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <div class="tiledSection">     <h2 id="场景介绍">场景介绍<i class="anchor-icon anchor-icon-link" anchorid="场景介绍" tips="复制节点链接"></i></h2>          <p>在数字化向智能化演进的关键阶段，构建智慧化服务已成为应用开发者提升产品竞争力的必然选择。</p>     <p>当前，系统提供ArkData智慧数据平台（ArkData Intelligence Platform，AIP），提供端侧数据智慧化构建，使应用数据向量化，通过嵌入模型将非结构化的文本、图像等多模态数据，转换成具有语义的向量。</p>     <p>从API version 15开始，支持应用数据向量化。</p>    </div>    <div class="tiledSection">     <h2 id="基本概念">基本概念<i class="anchor-icon anchor-icon-link" anchorid="基本概念" tips="复制节点链接"></i></h2>          <p>在智慧化数据构建过程中，涉及以下基本概念，请先了解相关含义。</p>    </div>    <div class="tiledSection">     <h3 id="向量化" class="firsth2">向量化<i class="anchor-icon anchor-icon-link" anchorid="向量化" tips="复制节点链接"></i></h3>          <p>向量化主要是指通过嵌入模型将高维非结构化数据（如文字、图像）映射为低维连续向量的嵌入技术。嵌入技术通过模型捕捉数据之间的语义关系，将抽象概念转化为可计算的数学表示，使计算机能够理解非结构化数据。目前，嵌入技术广泛应用于自然语言处理（语义搜索）、图像识别（特征提取）、推荐系统（用户/物品表征）等领域。</p>    </div>    <div class="tiledSection">     <h3 id="多模态嵌入模型">多模态嵌入模型<i class="anchor-icon anchor-icon-link" anchorid="多模态嵌入模型" tips="复制节点链接"></i></h3>          <p>应用数据向量化，主要通过嵌入模型实现。当前支持多模态嵌入模型，能将文本和图像这两种不同数据模态转换到同一个向量空间，支持单模态（文搜文、图搜图）和跨模态（文搜图、图搜文）的语义表征能力。</p>    </div>    <div class="tiledSection">     <h3 id="文本分块">文本分块<i class="anchor-icon anchor-icon-link" anchorid="文本分块" tips="复制节点链接"></i></h3>          <p>数据向量化时，文本数据长度受限，可通过AIP分块接口切分文本，高效实现数据向量化。</p>    </div>    <div class="tiledSection">     <h2 id="实现机制">实现机制<i class="anchor-icon anchor-icon-link" anchorid="实现机制" tips="复制节点链接"></i></h2>          <p>应用可借助智慧数据平台能力，实现智慧化数据的构建，将应用数据转化为可计算的向量，相关能力均运行在应用进程内，数据不出应用，保证隐私安全。</p>    </div>    <div class="tiledSection">     <h2 id="运作机制">运作机制<i class="anchor-icon anchor-icon-link" anchorid="运作机制" tips="复制节点链接"></i></h2>          <p>应用数据向量化，将应用原数据向量化并存储在向量数据库中。</p>    </div>    <div class="tiledSection">     <h2 id="约束限制">约束限制<i class="anchor-icon anchor-icon-link" anchorid="约束限制" tips="复制节点链接"></i></h2>          <ul>      <li>考虑到数据向量化处理的计算量和资源占用较大，当前仅支持在2in1设备上使用。</li>      <li>嵌入模型的推理过程可使用NPU加速。与NPU计算相比，纯CPU的计算在时延和功耗上都有较大差距，建议采用NPU加速。</li>      <li>模型推理单次可处理的文本长度上限为512个字符，支持中英文。</li>      <li>模型推理单次可处理的图像大小小于20MB。</li>     </ul>    </div>    <div class="tiledSection">     <h2 id="接口说明">接口说明<i class="anchor-icon anchor-icon-link" anchorid="接口说明" tips="复制节点链接"></i></h2>          <p>以下是智慧数据向量化功能的相关接口。更多接口及使用方式请见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-data-intelligence" target="_blank">智慧数据平台</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.9.3.1.3.1.1" valign="top" width="50%">接口名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.9.3.1.3.1.2" valign="top" width="50%">描述</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="50%">getTextEmbeddingModel(config: ModelConfig): Promise&lt;TextEmbedding&gt;</td>         <td class="cellrowborder" valign="top" width="50%">获取文本嵌入模型。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">loadModel(): Promise&lt;void&gt;</td>         <td class="cellrowborder" valign="top" width="50%">加载文本嵌入模型。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">splitText(text: string, config: SplitConfig): Promise&lt;Array&lt;string&gt;&gt;</td>         <td class="cellrowborder" valign="top" width="50%">获取文本的分块。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">getEmbedding(text: string): Promise&lt;Array&lt;number&gt;&gt;</td>         <td class="cellrowborder" valign="top" width="50%">获取给定文本的嵌入向量。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">getEmbedding(batchTexts: Array&lt;string&gt;): Promise&lt;Array&lt;Array&lt;number&gt;&gt;&gt;</td>         <td class="cellrowborder" valign="top" width="50%">获取给定批次文本的嵌入向量。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">releaseModel(): Promise&lt;void&gt;</td>         <td class="cellrowborder" valign="top" width="50%">释放文本嵌入模型。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">getImageEmbeddingModel(config: ModelConfig): Promise&lt;ImageEmbedding&gt;</td>         <td class="cellrowborder" valign="top" width="50%">获取图像嵌入模型。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">loadModel(): Promise&lt;void&gt;</td>         <td class="cellrowborder" valign="top" width="50%">加载图像嵌入模型。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">getEmbedding(image: Image): Promise&lt;Array&lt;number&gt;&gt;</td>         <td class="cellrowborder" valign="top" width="50%">获取给定图像的嵌入向量。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">releaseModel(): Promise&lt;void&gt;</td>         <td class="cellrowborder" valign="top" width="50%">释放图像嵌入模型。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="文本向量化开发步骤">文本向量化开发步骤<i class="anchor-icon anchor-icon-link" anchorid="文本向量化开发步骤" tips="复制节点链接"></i></h2>          <ol>      <li>       <p>导入模块。</p>       <div _ngcontent-vuq-c106="" class="highlight-div"><div _ngcontent-vuq-c106="" class="highlight-div-header"><div _ngcontent-vuq-c106="" class="highlight-div-header-left"><div _ngcontent-vuq-c106="" class="handle-button expand-button"><div _ngcontent-vuq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-vuq-c106="" class="highlight-div-header-right"><div _ngcontent-vuq-c106="" class="handle-button ai-button"></div><div _ngcontent-vuq-c106="" class="handle-button line-button"><div _ngcontent-vuq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-vuq-c106="" class="handle-button theme-button"><div _ngcontent-vuq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-vuq-c106="" class="handle-button copy-button"><div _ngcontent-vuq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-vuq-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { intelligence } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkData'</span>;</li></ol></pre></div></div></li>      <li>       <p>获取文本嵌入模型。</p>       <p>调用getTextEmbeddingModel方法，获取文本嵌入模型。示例代码如下所示：</p>       <div _ngcontent-vuq-c106="" class="highlight-div"><div _ngcontent-vuq-c106="" class="highlight-div-header"><div _ngcontent-vuq-c106="" class="highlight-div-header-left"><div _ngcontent-vuq-c106="" class="handle-button expand-button"><div _ngcontent-vuq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-vuq-c106="" class="highlight-div-header-right"><div _ngcontent-vuq-c106="" class="handle-button ai-button"></div><div _ngcontent-vuq-c106="" class="handle-button line-button"><div _ngcontent-vuq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-vuq-c106="" class="handle-button theme-button"><div _ngcontent-vuq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-vuq-c106="" class="handle-button copy-button"><div _ngcontent-vuq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-vuq-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">textConfig</span>:intelligence.<span class="hljs-property">ModelConfig</span> = {</li><li>  <span class="hljs-attr">version</span>:intelligence.<span class="hljs-property">ModelVersion</span>.<span class="hljs-property">BASIC_MODEL</span>,</li><li>  <span class="hljs-attr">isNpuAvailable</span>:<span class="hljs-literal">false</span>,</li><li>  <span class="hljs-attr">cachePath</span>:<span class="hljs-string">"/data"</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">textEmbedding</span>:intelligence.<span class="hljs-property">TextEmbedding</span>;</li><li>
</li><li>intelligence.<span class="hljs-title function_">getTextEmbeddingModel</span>(textConfig)</li><li>  .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">data:intelligence.TextEmbedding</span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"Succeeded in getting TextModel"</span>);</li><li>    textEmbedding = data;</li><li>  })</li><li>  .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err:BusinessError</span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"Failed to get TextModel and code is "</span> + err.<span class="hljs-property">code</span>);</li><li>  })</li></ol></pre></div></div></li>      <li>       <p>加载文本嵌入模型。</p>       <p>调用loadModel方法，加载文本嵌入模型。示例代码如下所示：</p>       <div _ngcontent-vuq-c106="" class="highlight-div"><div _ngcontent-vuq-c106="" class="highlight-div-header"><div _ngcontent-vuq-c106="" class="highlight-div-header-left"><div _ngcontent-vuq-c106="" class="handle-button expand-button"><div _ngcontent-vuq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-vuq-c106="" class="highlight-div-header-right"><div _ngcontent-vuq-c106="" class="handle-button ai-button"></div><div _ngcontent-vuq-c106="" class="handle-button line-button"><div _ngcontent-vuq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-vuq-c106="" class="handle-button theme-button"><div _ngcontent-vuq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-vuq-c106="" class="handle-button copy-button"><div _ngcontent-vuq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-vuq-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li>textEmbedding.<span class="hljs-title function_">loadModel</span>()</li><li>  .<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"Succeeded in loading Model"</span>);</li><li>  })</li><li>  .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err:BusinessError</span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"Failed to load Model and code is "</span> + err.<span class="hljs-property">code</span>);</li><li>  })</li></ol></pre></div></div></li>      <li>       <p>获取文本的分块。当数据长度超过限定时，使用splitText()接口将其分块，然后再进行数据向量化。</p>       <p>调用splitText方法，获取文本的分块结果。示例代码如下所示：</p>       <div _ngcontent-vuq-c106="" class="highlight-div"><div _ngcontent-vuq-c106="" class="highlight-div-header"><div _ngcontent-vuq-c106="" class="highlight-div-header-left"><div _ngcontent-vuq-c106="" class="handle-button expand-button"><div _ngcontent-vuq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-vuq-c106="" class="highlight-div-header-right"><div _ngcontent-vuq-c106="" class="handle-button ai-button"></div><div _ngcontent-vuq-c106="" class="handle-button line-button"><div _ngcontent-vuq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-vuq-c106="" class="handle-button theme-button"><div _ngcontent-vuq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-vuq-c106="" class="handle-button copy-button"><div _ngcontent-vuq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-vuq-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">let</span> <span class="hljs-attr">splitConfig</span>:intelligence.<span class="hljs-property">SplitConfig</span> = {</li><li>  <span class="hljs-attr">size</span>:<span class="hljs-number">10</span>,</li><li>  <span class="hljs-attr">overlapRatio</span>:<span class="hljs-number">0.1</span></li><li>}</li><li><span class="hljs-keyword">let</span> splitText = <span class="hljs-string">'text'</span>;</li><li>
</li><li>intelligence.<span class="hljs-title function_">splitText</span>(splitText, splitConfig)</li><li>  .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">data:<span class="hljs-built_in">Array</span>&lt;<span class="hljs-built_in">string</span>&gt;</span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"Succeeded in splitting Text"</span>);</li><li>  })</li><li>  .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err:BusinessError</span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"Failed to split Text and code is "</span> + err.<span class="hljs-property">code</span>);</li><li>  })</li></ol></pre></div></div></li>      <li>       <p>获取给定文本的嵌入向量。给定的文本数据可以是单个文本或文本集合。</p>       <p>调用getEmbedding方法，获取给定单个文本或文本集合的嵌入向量。示例代码如下所示：</p>       <div _ngcontent-vuq-c106="" class="highlight-div"><div _ngcontent-vuq-c106="" class="highlight-div-header"><div _ngcontent-vuq-c106="" class="highlight-div-header-left"><div _ngcontent-vuq-c106="" class="handle-button expand-button"><div _ngcontent-vuq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-vuq-c106="" class="highlight-div-header-right"><div _ngcontent-vuq-c106="" class="handle-button ai-button"></div><div _ngcontent-vuq-c106="" class="handle-button line-button"><div _ngcontent-vuq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-vuq-c106="" class="handle-button theme-button"><div _ngcontent-vuq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-vuq-c106="" class="handle-button copy-button"><div _ngcontent-vuq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-vuq-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">let</span> text = <span class="hljs-string">'text'</span>;</li><li>textEmbedding.<span class="hljs-title function_">getEmbedding</span>(text)</li><li>  .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">data:<span class="hljs-built_in">Array</span>&lt;<span class="hljs-built_in">number</span>&gt;</span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"Succeeded in getting Embedding"</span>);</li><li>  })</li><li>  .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err:BusinessError</span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"Failed to get Embedding and code is "</span> + err.<span class="hljs-property">code</span>);</li><li>  })</li></ol></pre></div></div>       <div _ngcontent-vuq-c106="" class="highlight-div"><div _ngcontent-vuq-c106="" class="highlight-div-header"><div _ngcontent-vuq-c106="" class="highlight-div-header-left"><div _ngcontent-vuq-c106="" class="handle-button expand-button"><div _ngcontent-vuq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-vuq-c106="" class="highlight-div-header-right"><div _ngcontent-vuq-c106="" class="handle-button ai-button"></div><div _ngcontent-vuq-c106="" class="handle-button line-button"><div _ngcontent-vuq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-vuq-c106="" class="handle-button theme-button"><div _ngcontent-vuq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-vuq-c106="" class="handle-button copy-button"><div _ngcontent-vuq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-vuq-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">let</span> batchTexts = [<span class="hljs-string">'text1'</span>,<span class="hljs-string">'text2'</span>];</li><li>textEmbedding.<span class="hljs-title function_">getEmbedding</span>(batchTexts)</li><li>  .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">data:<span class="hljs-built_in">Array</span>&lt;<span class="hljs-built_in">Array</span>&lt;<span class="hljs-built_in">number</span>&gt;&gt;</span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"Succeeded in getting Embedding"</span>);</li><li>  })</li><li>  .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err:BusinessError</span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"Failed to get Embedding and code is "</span> + err.<span class="hljs-property">code</span>);</li><li>  })</li></ol></pre></div></div></li>      <li>       <p>释放文本嵌入模型。</p>       <p>调用releaseModel方法，释放文本嵌入模型。示例代码如下所示：</p>       <div _ngcontent-vuq-c106="" class="highlight-div"><div _ngcontent-vuq-c106="" class="highlight-div-header"><div _ngcontent-vuq-c106="" class="highlight-div-header-left"><div _ngcontent-vuq-c106="" class="handle-button expand-button"><div _ngcontent-vuq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-vuq-c106="" class="highlight-div-header-right"><div _ngcontent-vuq-c106="" class="handle-button ai-button"></div><div _ngcontent-vuq-c106="" class="handle-button line-button"><div _ngcontent-vuq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-vuq-c106="" class="handle-button theme-button"><div _ngcontent-vuq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-vuq-c106="" class="handle-button copy-button"><div _ngcontent-vuq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-vuq-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li>textEmbedding.<span class="hljs-title function_">releaseModel</span>()</li><li>  .<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"Succeeded in releasing Model"</span>);</li><li>  })</li><li>  .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err:BusinessError</span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"Failed to release Model and code is "</span> + err.<span class="hljs-property">code</span>);</li><li>  })</li></ol></pre></div></div></li>     </ol>    </div>    <div class="tiledSection">     <h2 id="图像向量化开发步骤">图像向量化开发步骤<i class="anchor-icon anchor-icon-link" anchorid="图像向量化开发步骤" tips="复制节点链接"></i></h2>          <ol>      <li>       <p>导入模块。</p>       <div _ngcontent-vuq-c106="" class="highlight-div"><div _ngcontent-vuq-c106="" class="highlight-div-header"><div _ngcontent-vuq-c106="" class="highlight-div-header-left"><div _ngcontent-vuq-c106="" class="handle-button expand-button"><div _ngcontent-vuq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-vuq-c106="" class="highlight-div-header-right"><div _ngcontent-vuq-c106="" class="handle-button ai-button"></div><div _ngcontent-vuq-c106="" class="handle-button line-button"><div _ngcontent-vuq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-vuq-c106="" class="handle-button theme-button"><div _ngcontent-vuq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-vuq-c106="" class="handle-button copy-button"><div _ngcontent-vuq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-vuq-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { intelligence } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkData'</span>;</li></ol></pre></div></div></li>      <li>       <p>获取图像嵌入模型。</p>       <p>调用getImageEmbeddingModel方法，获取图像嵌入模型。示例代码如下所示：</p>       <div _ngcontent-vuq-c106="" class="highlight-div"><div _ngcontent-vuq-c106="" class="highlight-div-header"><div _ngcontent-vuq-c106="" class="highlight-div-header-left"><div _ngcontent-vuq-c106="" class="handle-button expand-button"><div _ngcontent-vuq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-vuq-c106="" class="highlight-div-header-right"><div _ngcontent-vuq-c106="" class="handle-button ai-button"></div><div _ngcontent-vuq-c106="" class="handle-button line-button"><div _ngcontent-vuq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-vuq-c106="" class="handle-button theme-button"><div _ngcontent-vuq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-vuq-c106="" class="handle-button copy-button"><div _ngcontent-vuq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-vuq-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">let</span> <span class="hljs-attr">imageConfig</span>:intelligence.<span class="hljs-property">ModelConfig</span> = {</li><li>  <span class="hljs-attr">version</span>:intelligence.<span class="hljs-property">ModelVersion</span>.<span class="hljs-property">BASIC_MODEL</span>,</li><li>  <span class="hljs-attr">isNpuAvailable</span>:<span class="hljs-literal">false</span>,</li><li>  <span class="hljs-attr">cachePath</span>:<span class="hljs-string">"/data"</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">imageEmbedding</span>:intelligence.<span class="hljs-property">ImageEmbedding</span>;</li><li>
</li><li>intelligence.<span class="hljs-title function_">getImageEmbeddingModel</span>(imageConfig)</li><li>  .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">data:intelligence.ImageEmbedding</span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"Succeeded in getting ImageModel"</span>);</li><li>    imageEmbedding = data;</li><li>  })</li><li>  .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err:BusinessError</span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"Failed to get ImageModel and code is "</span> + err.<span class="hljs-property">code</span>);</li><li>  })</li></ol></pre></div></div></li>      <li>       <p>加载图像嵌入模型。</p>       <p>调用loadModel方法，加载图像嵌入模型。示例代码如下所示：</p>       <div _ngcontent-vuq-c106="" class="highlight-div"><div _ngcontent-vuq-c106="" class="highlight-div-header"><div _ngcontent-vuq-c106="" class="highlight-div-header-left"><div _ngcontent-vuq-c106="" class="handle-button expand-button"><div _ngcontent-vuq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-vuq-c106="" class="highlight-div-header-right"><div _ngcontent-vuq-c106="" class="handle-button ai-button"></div><div _ngcontent-vuq-c106="" class="handle-button line-button"><div _ngcontent-vuq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-vuq-c106="" class="handle-button theme-button"><div _ngcontent-vuq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-vuq-c106="" class="handle-button copy-button"><div _ngcontent-vuq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-vuq-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li>imageEmbedding.<span class="hljs-title function_">loadModel</span>()</li><li>  .<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>     <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"Succeeded in loading Model"</span>);</li><li>  })</li><li>  .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err:BusinessError</span>) =&gt;</span> {</li><li>     <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"Failed to load Model and code is "</span> + err.<span class="hljs-property">code</span>);</li><li>  })</li></ol></pre></div></div></li>      <li>       <p>获取给定图像的嵌入向量。</p>       <p>调用getEmbedding方法，获取给定图像的嵌入向量。示例代码如下所示：</p>       <div _ngcontent-vuq-c106="" class="highlight-div"><div _ngcontent-vuq-c106="" class="highlight-div-header"><div _ngcontent-vuq-c106="" class="highlight-div-header-left"><div _ngcontent-vuq-c106="" class="handle-button expand-button"><div _ngcontent-vuq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-vuq-c106="" class="highlight-div-header-right"><div _ngcontent-vuq-c106="" class="handle-button ai-button"></div><div _ngcontent-vuq-c106="" class="handle-button line-button"><div _ngcontent-vuq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-vuq-c106="" class="handle-button theme-button"><div _ngcontent-vuq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-vuq-c106="" class="handle-button copy-button"><div _ngcontent-vuq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-vuq-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">let</span> image = <span class="hljs-string">"file://&lt;packageName&gt;/data/storage/el2/base/haps/entry/files/xxx.jpg"</span>;</li><li>imageEmbedding.<span class="hljs-title function_">getEmbedding</span>(image)</li><li>  .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">data:<span class="hljs-built_in">Array</span>&lt;<span class="hljs-built_in">number</span>&gt;</span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"Succeeded in getting Embedding"</span>);</li><li>  })</li><li>  .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err:BusinessError</span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"Failed to get Embedding and code is "</span> + err.<span class="hljs-property">code</span>);</li><li>  })</li></ol></pre></div></div></li>      <li>       <p>释放图像嵌入模型。</p>       <p>调用releaseModel方法，释放图像嵌入模型。示例代码如下所示：</p>       <div _ngcontent-vuq-c106="" class="highlight-div"><div _ngcontent-vuq-c106="" class="highlight-div-header"><div _ngcontent-vuq-c106="" class="highlight-div-header-left"><div _ngcontent-vuq-c106="" class="handle-button expand-button"><div _ngcontent-vuq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-vuq-c106="" class="highlight-div-header-right"><div _ngcontent-vuq-c106="" class="handle-button ai-button"></div><div _ngcontent-vuq-c106="" class="handle-button line-button"><div _ngcontent-vuq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-vuq-c106="" class="handle-button theme-button"><div _ngcontent-vuq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-vuq-c106="" class="handle-button copy-button"><div _ngcontent-vuq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-vuq-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li>imageEmbedding.<span class="hljs-title function_">releaseModel</span>()</li><li>  .<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"Succeeded in releasing Model"</span>);</li><li>  })</li><li>  .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err:BusinessError</span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"Failed to release Model and code is "</span> + err.<span class="hljs-property">code</span>);</li><li>  })</li></ol></pre></div></div></li>     </ol>    </div>   </div>   <div></div></div>