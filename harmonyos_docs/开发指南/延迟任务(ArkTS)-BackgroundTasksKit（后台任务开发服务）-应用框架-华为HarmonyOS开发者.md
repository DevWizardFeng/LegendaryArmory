<h1 _ngcontent-ady-c119="" class="doc-title ng-star-inserted" title="延迟任务(ArkTS)"> 延迟任务(ArkTS) </h1>

<div _ngcontent-ady-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <div class="tiledSection">     <h2 id="概述">概述<i class="anchor-icon anchor-icon-link" anchorid="概述" tips="复制节点链接"></i></h2>         </div>    <div class="tiledSection">     <h3 id="功能介绍" class="firsth2">功能介绍<i class="anchor-icon anchor-icon-link" anchorid="功能介绍" tips="复制节点链接"></i></h3>          <p>应用退至后台后，需要执行实时性要求不高的任务，例如有网络时不定期主动获取邮件等，可以使用延迟任务。当应用满足设定的触发条件（包括网络类型、充电类型、存储状态、电池状态、定时状态等）时，将任务添加到执行队列，系统会根据内存、功耗、设备温度、用户使用习惯等统一调度拉起应用，执行相应的延迟任务。</p>    </div>    <div class="tiledSection">     <h3 id="运行原理">运行原理<i class="anchor-icon anchor-icon-link" anchorid="运行原理" tips="复制节点链接"></i></h3>          <p><strong>图1</strong> 延迟任务实现原理</p>     <p><span><img originheight="633" originwidth="1156" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114716.72595446821184003064792237904477:50001231000000:2800:E638D2829758F69481B85BE10923A973C1052218F5505BABD7C667CD039DB46C.png" width="920" height="503.7716262975778"></span></p>     <p>应用调用延迟任务接口添加、删除、查询延迟任务，延迟任务管理模块会根据任务设置的条件（通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-resourceschedule-workscheduler#workinfo" target="_blank">WorkInfo</a>参数设置，包括网络类型、充电类型、存储状态等）和系统状态（包括内存、功耗、设备温度、用户使用习惯等）统一决策调度时机。</p>     <p>当满足调度条件或调度结束时，系统会回调应用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-workschedulerextensionability" target="_blank">WorkSchedulerExtensionAbility</a>中 onWorkStart() 或 onWorkStop() 的方法，同时会为应用单独创建一个Extension扩展进程用以承载<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-workschedulerextensionability" target="_blank">WorkSchedulerExtensionAbility</a>，并给<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-workschedulerextensionability" target="_blank">WorkSchedulerExtensionAbility</a>一定的活动周期，开发者可以在对应回调方法中实现自己的任务逻辑。</p>    </div>    <div class="tiledSection">     <h3 id="约束与限制">约束与限制<i class="anchor-icon anchor-icon-link" anchorid="约束与限制" tips="复制节点链接"></i></h3>          <ul>      <li>       <p><strong>数量限制</strong>：一个应用同一时刻最多申请10个延迟任务。</p></li>      <li>       <p><strong>执行频率限制</strong>：系统会根据应用的活跃分组，对延迟任务做分级管控，限制延迟任务调度的执行频率。</p>       <p><strong>表1</strong> 应用活跃程度分组</p>       <div class="tablenoborder">        <div class="tbBox"><table class="layoutFixed idpTab">         <thead>          <tr>           <th align="left" class="cellrowborder" id="mcps1.3.4.2.2.3.1.3.1.1" valign="top" width="50%">应用活跃分组</th>           <th align="left" class="cellrowborder" id="mcps1.3.4.2.2.3.1.3.1.2" valign="top" width="50%">延迟任务执行频率</th>          </tr>         </thead>                   <tbody><tr>           <td class="cellrowborder" valign="top" width="50%">活跃分组</td>           <td class="cellrowborder" valign="top" width="50%">最小间隔2小时</td>          </tr>          <tr>           <td class="cellrowborder" valign="top" width="50%">经常使用分组</td>           <td class="cellrowborder" valign="top" width="50%">最小间隔4小时</td>          </tr>          <tr>           <td class="cellrowborder" valign="top" width="50%">常用分组</td>           <td class="cellrowborder" valign="top" width="50%">最小间隔24小时</td>          </tr>          <tr>           <td class="cellrowborder" valign="top" width="50%">极少使用分组</td>           <td class="cellrowborder" valign="top" width="50%">最小间隔48小时</td>          </tr>          <tr>           <td class="cellrowborder" valign="top" width="50%">受限使用分组</td>           <td class="cellrowborder" valign="top" width="50%">禁止</td>          </tr>          <tr>           <td class="cellrowborder" valign="top" width="50%">从未使用分组</td>           <td class="cellrowborder" valign="top" width="50%">禁止</td>          </tr>                 </tbody></table></div>       </div></li>      <li>       <p><strong>超时</strong>：WorkSchedulerExtensionAbility单次回调最长运行2分钟。如果超时不取消，系统会终止对应的Extension进程。</p></li>      <li>       <p><strong>调度延迟</strong>：系统会根据内存、功耗、设备温度、用户使用习惯等统一调度，如当系统内存资源不足或温度达到一定档位时，系统将延迟调度该任务。</p></li>      <li>       <p><strong>WorkSchedulerExtensionAbility接口调用限制</strong>：为实现对WorkSchedulerExtensionAbility能力的管控，在WorkSchedulerExtensionAbility中限制以下接口的调用：</p>       <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-resourceschedule-backgroundtaskmanager" target="_blank">@ohos.resourceschedule.backgroundTaskManager (后台任务管理)</a></p>       <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-backgroundtaskmanager" target="_blank">@ohos.backgroundTaskManager (后台任务管理)</a></p>       <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-camera" target="_blank">@ohos.multimedia.camera (相机管理)</a></p>       <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-audio" target="_blank">@ohos.multimedia.audio (音频管理)</a></p>       <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-media" target="_blank">@ohos.multimedia.media (媒体服务)</a></p></li>     </ul>    </div>    <div class="tiledSection">     <h2 id="接口说明">接口说明<i class="anchor-icon anchor-icon-link" anchorid="接口说明" tips="复制节点链接"></i></h2>          <p><strong>表2</strong> 延迟任务主要接口</p>     <p>以下是延迟任务开发使用的相关接口，更多接口及使用方式请见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-resourceschedule-workscheduler" target="_blank">延迟任务调度</a>文档。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.5.4.1.3.1.1" valign="top" width="50%">接口名</th>         <th align="left" class="cellrowborder" id="mcps1.3.5.4.1.3.1.2" valign="top" width="50%">接口描述</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-resourceschedule-workscheduler#workschedulerstartwork" target="_blank">startWork(work: WorkInfo): void</a></td>         <td class="cellrowborder" valign="top" width="50%">申请延迟任务。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-resourceschedule-workscheduler#workschedulerstopwork" target="_blank">stopWork(work: WorkInfo, needCancel?: boolean): void</a></td>         <td class="cellrowborder" valign="top" width="50%">取消延迟任务。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-resourceschedule-workscheduler#workschedulergetworkstatus" target="_blank">getWorkStatus(workId: number, callback: AsyncCallback&lt;WorkInfo&gt;): void</a></td>         <td class="cellrowborder" valign="top" width="50%">获取延迟任务状态（Callback形式）。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-resourceschedule-workscheduler#workschedulergetworkstatus-1" target="_blank">getWorkStatus(workId: number): Promise&lt;WorkInfo&gt;</a></td>         <td class="cellrowborder" valign="top" width="50%">获取延迟任务状态（Promise形式）。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-resourceschedule-workscheduler#workschedulerobtainallworks10" target="_blank">obtainAllWorks(callback: AsyncCallback&lt;Array&lt;WorkInfo&gt;&gt;): void</a></td>         <td class="cellrowborder" valign="top" width="50%">获取所有延迟任务（Callback形式）。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-resourceschedule-workscheduler#workschedulerobtainallworks" target="_blank">obtainAllWorks(): Promise&lt;Array&lt;WorkInfo&gt;&gt;</a></td>         <td class="cellrowborder" valign="top" width="50%">获取所有延迟任务（Promise形式）。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-resourceschedule-workscheduler#workschedulerstopandclearworks" target="_blank">stopAndClearWorks(): void</a></td>         <td class="cellrowborder" valign="top" width="50%">停止并清除任务。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-resourceschedule-workscheduler#workschedulerislastworktimeout10" target="_blank">isLastWorkTimeOut(workId: number, callback: AsyncCallback&lt;boolean&gt;): void</a></td>         <td class="cellrowborder" valign="top" width="50%">获取上次任务是否超时（针对RepeatWork，Callback形式）。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-resourceschedule-workscheduler#workschedulerislastworktimeout" target="_blank">isLastWorkTimeOut(workId: number): Promise&lt;boolean&gt;</a></td>         <td class="cellrowborder" valign="top" width="50%">获取上次任务是否超时（针对RepeatWork，Promise形式）。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>表3</strong> 延迟任务回调接口</p>     <p>以下是延迟任务回调开发使用的相关接口，更多接口及使用方式请见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-workschedulerextensionability" target="_blank">延迟任务调度回调</a>文档。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.5.7.1.3.1.1" valign="top" width="50%">接口名</th>         <th align="left" class="cellrowborder" id="mcps1.3.5.7.1.3.1.2" valign="top" width="50%">接口描述</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-workschedulerextensionability#onworkstart" target="_blank">onWorkStart(work: workScheduler.WorkInfo): void</a></td>         <td class="cellrowborder" valign="top" width="50%">延迟调度任务开始的回调。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-workschedulerextensionability#onworkstop" target="_blank">onWorkStop(work: workScheduler.WorkInfo): void</a></td>         <td class="cellrowborder" valign="top" width="50%">延迟调度任务结束的回调。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="开发步骤">开发步骤<i class="anchor-icon anchor-icon-link" anchorid="开发步骤" tips="复制节点链接"></i></h2>          <p>延迟任务调度开发步骤分为两步：实现延迟任务调度扩展能力、实现延迟任务调度。</p>     <ol>      <li>       <p><strong>延迟任务调度扩展能力</strong>：实现WorkSchedulerExtensionAbility开始和结束的回调接口。</p></li>      <li>       <p><strong>延迟任务调度</strong>：调用延迟任务接口，实现延迟任务申请、取消等功能。</p></li>     </ol>    </div>    <div class="tiledSection">     <h3 id="实现延迟任务回调扩展能力" class="firsth2">实现延迟任务回调扩展能力<i class="anchor-icon anchor-icon-link" anchorid="实现延迟任务回调扩展能力" tips="复制节点链接"></i></h3>          <ol>      <li>       <p>新建工程目录。</p>       <p>在工程entry Module对应的ets目录(./entry/src/main/ets)下，新建目录及ArkTS文件，例如新建一个目录并命名为WorkSchedulerExtension。在WorkSchedulerExtension目录下，新建一个ArkTS文件并命名为WorkSchedulerExtension.ets，用以实现延迟任务回调接口。</p></li>      <li>       <p>导入模块。</p>       <div _ngcontent-ady-c106="" class="highlight-div"><div _ngcontent-ady-c106="" class="highlight-div-header"><div _ngcontent-ady-c106="" class="highlight-div-header-left"><div _ngcontent-ady-c106="" class="handle-button expand-button"><div _ngcontent-ady-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ady-c106="" class="highlight-div-header-right"><div _ngcontent-ady-c106="" class="handle-button ai-button"></div><div _ngcontent-ady-c106="" class="handle-button line-button"><div _ngcontent-ady-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ady-c106="" class="handle-button theme-button"><div _ngcontent-ady-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ady-c106="" class="handle-button copy-button"><div _ngcontent-ady-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ady-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">WorkSchedulerExtensionAbility</span>, workScheduler } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BackgroundTasksKit'</span>;</li></ol></pre></div></div></li>      <li>       <p>实现WorkSchedulerExtension生命周期接口。</p>       <div _ngcontent-ady-c106="" class="highlight-div"><div _ngcontent-ady-c106="" class="highlight-div-header"><div _ngcontent-ady-c106="" class="highlight-div-header-left"><div _ngcontent-ady-c106="" class="handle-button expand-button"><div _ngcontent-ady-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ady-c106="" class="highlight-div-header-right"><div _ngcontent-ady-c106="" class="handle-button ai-button"></div><div _ngcontent-ady-c106="" class="handle-button line-button"><div _ngcontent-ady-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ady-c106="" class="handle-button theme-button"><div _ngcontent-ady-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ady-c106="" class="handle-button copy-button"><div _ngcontent-ady-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ady-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyWorkSchedulerExtensionAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">WorkSchedulerExtensionAbility</span> {</li><li>  <span class="hljs-comment">// 延迟任务开始回调</span></li><li>  <span class="hljs-title function_">onWorkStart</span>(<span class="hljs-params">workInfo: workScheduler.WorkInfo</span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`onWorkStart, workInfo = <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(workInfo)}</span>`</span>);</li><li>    <span class="hljs-comment">// 打印 parameters中的参数，如：参数key1</span></li><li>    <span class="hljs-comment">// console.info(`work info parameters: ${JSON.parse(workInfo.parameters?.toString()).key1}`)</span></li><li>  }</li><li>
</li><li>  <span class="hljs-comment">// 延迟任务结束回调。当延迟任务2分钟超时或应用调用stopWork接口取消任务时，触发该回调。</span></li><li>  <span class="hljs-title function_">onWorkStop</span>(<span class="hljs-params">workInfo: workScheduler.WorkInfo</span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`onWorkStop, workInfo is <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(workInfo)}</span>`</span>);</li><li>  }</li><li>}</li></ol></pre></div></div></li>      <li>       <p>在<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/module-configuration-file">module.json5配置文件</a>中注册WorkSchedulerExtensionAbility，并设置如下标签：</p>       <ul>        <li>         <p>type标签设置为“workScheduler”。</p></li>        <li>         <p>srcEntry标签设置为当前ExtensionAbility组件所对应的代码路径。</p></li>       </ul>       <div _ngcontent-ady-c106="" class="highlight-div"><div _ngcontent-ady-c106="" class="highlight-div-header"><div _ngcontent-ady-c106="" class="highlight-div-header-left"><div _ngcontent-ady-c106="" class="handle-button expand-button"><div _ngcontent-ady-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ady-c106="" class="highlight-div-header-right"><div _ngcontent-ady-c106="" class="handle-button ai-button"></div><div _ngcontent-ady-c106="" class="handle-button line-button"><div _ngcontent-ady-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ady-c106="" class="handle-button theme-button"><div _ngcontent-ady-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ady-c106="" class="handle-button copy-button"><div _ngcontent-ady-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ady-c106="" class="highlight-scroll-div"><pre class="json prettyprint linenums hljs language-json" hw-language="json" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-punctuation">{</span></li><li>  <span class="hljs-attr">"module"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>      <span class="hljs-attr">"extensionAbilities"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span></li><li>        <span class="hljs-punctuation">{</span></li><li>          <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"MyWorkSchedulerExtensionAbility"</span><span class="hljs-punctuation">,</span></li><li>          <span class="hljs-attr">"srcEntry"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"./ets/WorkSchedulerExtension/WorkSchedulerExtension.ets"</span><span class="hljs-punctuation">,</span></li><li>          <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"workScheduler"</span></li><li>        <span class="hljs-punctuation">}</span></li><li>      <span class="hljs-punctuation">]</span></li><li>  <span class="hljs-punctuation">}</span></li><li><span class="hljs-punctuation">}</span></li></ol></pre></div></div></li>     </ol>    </div>    <div class="tiledSection">     <h3 id="实现延迟任务调度">实现延迟任务调度<i class="anchor-icon anchor-icon-link" anchorid="实现延迟任务调度" tips="复制节点链接"></i></h3>          <ol>      <li>       <p>导入模块。</p>       <div _ngcontent-ady-c106="" class="highlight-div"><div _ngcontent-ady-c106="" class="highlight-div-header"><div _ngcontent-ady-c106="" class="highlight-div-header-left"><div _ngcontent-ady-c106="" class="handle-button expand-button"><div _ngcontent-ady-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ady-c106="" class="highlight-div-header-right"><div _ngcontent-ady-c106="" class="handle-button ai-button"></div><div _ngcontent-ady-c106="" class="handle-button line-button"><div _ngcontent-ady-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ady-c106="" class="handle-button theme-button"><div _ngcontent-ady-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ady-c106="" class="handle-button copy-button"><div _ngcontent-ady-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ady-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { workScheduler } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BackgroundTasksKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li></ol></pre></div></div></li>      <li>       <p>申请延迟任务。</p>       <div _ngcontent-ady-c106="" class="highlight-div"><div _ngcontent-ady-c106="" class="highlight-div-header"><div _ngcontent-ady-c106="" class="highlight-div-header-left"><div _ngcontent-ady-c106="" class="handle-button expand-button"><div _ngcontent-ady-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ady-c106="" class="highlight-div-header-right"><div _ngcontent-ady-c106="" class="handle-button ai-button"></div><div _ngcontent-ady-c106="" class="handle-button line-button"><div _ngcontent-ady-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ady-c106="" class="handle-button theme-button"><div _ngcontent-ady-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ady-c106="" class="handle-button copy-button"><div _ngcontent-ady-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ady-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 创建workinfo</span></li><li><span class="hljs-keyword">const</span> <span class="hljs-attr">workInfo</span>: workScheduler.<span class="hljs-property">WorkInfo</span> = {</li><li>  <span class="hljs-attr">workId</span>: <span class="hljs-number">1</span>,</li><li>  <span class="hljs-attr">networkType</span>: workScheduler.<span class="hljs-property">NetworkType</span>.<span class="hljs-property">NETWORK_TYPE_WIFI</span>,</li><li>  <span class="hljs-attr">bundleName</span>: <span class="hljs-string">'com.example.application'</span>,</li><li>  <span class="hljs-attr">abilityName</span>: <span class="hljs-string">'MyWorkSchedulerExtensionAbility'</span></li><li>}</li><li>
</li><li><span class="hljs-keyword">try</span> {</li><li>  workScheduler.<span class="hljs-title function_">startWork</span>(workInfo);</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`startWork success`</span>);</li><li>} <span class="hljs-keyword">catch</span> (error) {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`startWork failed. code is <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> BusinessError).code}</span> message is <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> BusinessError).message}</span>`</span>);</li><li>}</li></ol></pre></div></div></li>      <li>       <p>取消延迟任务。</p>       <div _ngcontent-ady-c106="" class="highlight-div"><div _ngcontent-ady-c106="" class="highlight-div-header"><div _ngcontent-ady-c106="" class="highlight-div-header-left"><div _ngcontent-ady-c106="" class="handle-button expand-button"><div _ngcontent-ady-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ady-c106="" class="highlight-div-header-right"><div _ngcontent-ady-c106="" class="handle-button ai-button"></div><div _ngcontent-ady-c106="" class="handle-button line-button"><div _ngcontent-ady-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ady-c106="" class="handle-button theme-button"><div _ngcontent-ady-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ady-c106="" class="handle-button copy-button"><div _ngcontent-ady-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ady-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 创建workinfo</span></li><li><span class="hljs-keyword">const</span> <span class="hljs-attr">workInfo</span>: workScheduler.<span class="hljs-property">WorkInfo</span> = {</li><li>  <span class="hljs-attr">workId</span>: <span class="hljs-number">1</span>,</li><li>  <span class="hljs-attr">networkType</span>: workScheduler.<span class="hljs-property">NetworkType</span>.<span class="hljs-property">NETWORK_TYPE_WIFI</span>,</li><li>  <span class="hljs-attr">bundleName</span>: <span class="hljs-string">'com.example.application'</span>,</li><li>  <span class="hljs-attr">abilityName</span>: <span class="hljs-string">'MyWorkSchedulerExtensionAbility'</span></li><li>}</li><li>
</li><li><span class="hljs-keyword">try</span> {</li><li>  workScheduler.<span class="hljs-title function_">stopWork</span>(workInfo);</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`stopWork success`</span>);</li><li>} <span class="hljs-keyword">catch</span> (error) {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`stopWork failed. code is <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> BusinessError).code}</span> message is <span class="hljs-subst">${(error <span class="hljs-keyword">as</span> BusinessError).message}</span>`</span>);</li><li>}</li></ol></pre></div></div></li>     </ol>    </div>    <div class="tiledSection">     <h3 id="延迟任务调度功能验证">延迟任务调度功能验证<i class="anchor-icon anchor-icon-link" anchorid="延迟任务调度功能验证" tips="复制节点链接"></i></h3>          <p>确认延迟任务WorkSchedulerExtensionAbility回调方法onWorkStart、onWorkStop实现是否正确、是否可以成功回调</p>     <p>延迟任务申请成功之后，需要等到条件满足后才可以执行延迟任务回调，为了快速验证延迟任务回调功能是否正确，可以通过以下<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/hidumper">hidumper命令</a>手动触发延迟任务执行回调。</p>     <div _ngcontent-ady-c106="" class="highlight-div"><div _ngcontent-ady-c106="" class="highlight-div-header"><div _ngcontent-ady-c106="" class="highlight-div-header-left"><div _ngcontent-ady-c106="" class="handle-button expand-button"><div _ngcontent-ady-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ady-c106="" class="highlight-div-header-right"><div _ngcontent-ady-c106="" class="handle-button ai-button"></div><div _ngcontent-ady-c106="" class="handle-button line-button"><div _ngcontent-ady-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ady-c106="" class="handle-button theme-button"><div _ngcontent-ady-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ady-c106="" class="handle-button copy-button"><div _ngcontent-ady-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ady-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li>$ hidumper -s <span class="hljs-number">1904</span> -a <span class="hljs-string">'-t com.example.application MyWorkSchedulerExtensionAbility'</span></li><li>
</li><li>-------------------------------[ability]-------------------------------</li><li>
</li><li>
</li><li>----------------------------------<span class="hljs-title class_">WorkSchedule</span>----------------------------------</li></ol></pre></div></div>    </div>   </div>   <div></div></div>