<h1 _ngcontent-pqy-c119="" class="doc-title ng-star-inserted" title="延迟加载（lazy import）"> 延迟加载（lazy import） </h1>

<div _ngcontent-pqy-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p>随着应用程序功能的扩展，冷启动时间显著增加，主要是因为启动初期加载了大量未实际执行的模块。这不仅延长了应用的初始化时间，还浪费了资源。需要精简加载流程，剔除非必需的文件执行，优化冷启动性能，确保用户体验流畅。</p>    <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">      <ul>       <li>        <p>延迟加载特性在API 12版本开始支持。</p></li>       <li>        <p>开发者如需在API 12上使用lazy import语法，需在工程中配置"compatibleSdkVersionStage": "beta3"，否则将无法通过编译。参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/ide-hvigor-build-profile-V5#section511142752919" target="_blank">DevEco Studio build-profile.json5配置文件说明</a>。</p></li>       <li>        <p>针对API version大于12的工程，开发者可直接使用lazy import语法，无需再进行其他配置。</p></li>      </ul>     </div></div></div>    <div class="tiledSection">     <h2 id="功能特性">功能特性<i class="anchor-icon anchor-icon-link" anchorid="功能特性" tips="复制节点链接"></i></h2>          <p>延迟加载特性使文件在冷启动阶段不被加载，而是在程序运行时按需加载，从而缩短冷启动时间。</p>    </div>    <div class="tiledSection">     <h2 id="使用方式">使用方式<i class="anchor-icon anchor-icon-link" anchorid="使用方式" tips="复制节点链接"></i></h2>          <p>开发者可以利用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-insight-session-launch" target="_blank">DevEco Profiler展示冷启动过程文件加载情况</a>、<a href="/consumer/cn/doc/harmonyos-guides/arkts-lazy-import#可延迟加载文件检测">可延迟加载文件检测</a>、Trace工具或日志记录等手段，识别冷启动期间未被实际调用的文件，分析方法可参考<a href="https://developer.huawei.com/consumer/cn/doc/best-practices/bpta-arkts-high-performance#section12861143418213" target="_blank">延迟加载lazy-import使用指导</a>。通过对这些数据的分析，开发者可以精准定位启动阶段不必预先加载的文件列表，并在这些文件的调用点增加lazy标识。但需要注意，后续执行的加载是同步加载，可能阻塞任务执行（如单击任务，触发了延迟加载，那么运行时会去执行冷启动未加载的文件，从而增加耗时），因此是否使用lazy需要开发者自行评估。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>不建议盲目增加lazy，这会增加编译和运行时的识别开销。</p>      </div></div></div>    </div>    <div class="tiledSection">     <h2 id="场景行为解析">场景行为解析<i class="anchor-icon anchor-icon-link" anchorid="场景行为解析" tips="复制节点链接"></i></h2>          <ul>      <li>使用lazy-import延迟加载。</li>     </ul>     <div _ngcontent-pqy-c106="" class="highlight-div"><div _ngcontent-pqy-c106="" class="highlight-div-header"><div _ngcontent-pqy-c106="" class="highlight-div-header-left"><div _ngcontent-pqy-c106="" class="handle-button expand-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pqy-c106="" class="highlight-div-header-right"><div _ngcontent-pqy-c106="" class="handle-button ai-button"></div><div _ngcontent-pqy-c106="" class="handle-button line-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pqy-c106="" class="handle-button theme-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pqy-c106="" class="handle-button copy-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pqy-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// main.ets</span></li><li><span class="hljs-keyword">import</span> lazy { a } <span class="hljs-keyword">from</span> <span class="hljs-string">"./mod1"</span>;    <span class="hljs-comment">// "mod1" 未执行</span></li><li><span class="hljs-keyword">import</span> { c } <span class="hljs-keyword">from</span> <span class="hljs-string">"./mod2"</span>;         <span class="hljs-comment">// "mod2" 执行</span></li><li>        </li><li><span class="hljs-comment">// ...</span></li><li>        </li><li><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"main executed"</span>);</li><li><span class="hljs-keyword">while</span> (<span class="hljs-literal">false</span>) {</li><li>    <span class="hljs-keyword">let</span> xx = a;</li><li>    <span class="hljs-keyword">let</span> yy = c;</li><li>}</li><li>        </li><li><span class="hljs-comment">// mod1.ets</span></li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">let</span> a = <span class="hljs-string">"mod1 executed"</span></li><li><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(a);</li><li>        </li><li><span class="hljs-comment">// mod2.ets</span></li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">let</span> c = <span class="hljs-string">"mod2 executed"</span></li><li><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(c);</li></ol></pre></div></div>     <p>执行结果为：</p>     <div _ngcontent-pqy-c106="" class="highlight-div"><div _ngcontent-pqy-c106="" class="highlight-div-header"><div _ngcontent-pqy-c106="" class="highlight-div-header-left"><div _ngcontent-pqy-c106="" class="handle-button expand-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pqy-c106="" class="highlight-div-header-right"><div _ngcontent-pqy-c106="" class="handle-button ai-button"></div><div _ngcontent-pqy-c106="" class="handle-button line-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pqy-c106="" class="handle-button theme-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pqy-c106="" class="handle-button copy-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pqy-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li>mod2 executed</li><li>main executed</li></ol></pre></div></div>     <ul>      <li>同时对同一模块引用lazy-import与import。</li>     </ul>     <div _ngcontent-pqy-c106="" class="highlight-div"><div _ngcontent-pqy-c106="" class="highlight-div-header"><div _ngcontent-pqy-c106="" class="highlight-div-header-left"><div _ngcontent-pqy-c106="" class="handle-button expand-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pqy-c106="" class="highlight-div-header-right"><div _ngcontent-pqy-c106="" class="handle-button ai-button"></div><div _ngcontent-pqy-c106="" class="handle-button line-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pqy-c106="" class="handle-button theme-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pqy-c106="" class="handle-button copy-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pqy-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// main.ets</span></li><li><span class="hljs-keyword">import</span> lazy { a } <span class="hljs-keyword">from</span> <span class="hljs-string">"./mod1"</span>;    <span class="hljs-comment">// "mod1" 未执行</span></li><li><span class="hljs-keyword">import</span> { c } <span class="hljs-keyword">from</span> <span class="hljs-string">"./mod2"</span>;         <span class="hljs-comment">// "mod2" 执行</span></li><li><span class="hljs-keyword">import</span> { b } <span class="hljs-keyword">from</span> <span class="hljs-string">"./mod1"</span>;         <span class="hljs-comment">// "mod1" 执行</span></li><li>        </li><li><span class="hljs-comment">// ...</span></li><li>        </li><li><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"main executed"</span>);</li><li><span class="hljs-keyword">while</span> (<span class="hljs-literal">false</span>) {</li><li>    <span class="hljs-keyword">let</span> xx = a;</li><li>    <span class="hljs-keyword">let</span> yy = c;</li><li>    <span class="hljs-keyword">let</span> zz = b;</li><li>}</li><li>        </li><li><span class="hljs-comment">// mod1.ets</span></li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">let</span> a = <span class="hljs-string">"mod1 a executed"</span></li><li><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(a);</li><li>        </li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">let</span> b = <span class="hljs-string">"mod1 b executed"</span></li><li><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(b);</li><li>        </li><li><span class="hljs-comment">// mod2.ets</span></li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">let</span> c = <span class="hljs-string">"mod2 c executed"</span></li><li><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(c);</li></ol></pre></div></div>     <p>执行结果为：</p>     <div _ngcontent-pqy-c106="" class="highlight-div"><div _ngcontent-pqy-c106="" class="highlight-div-header"><div _ngcontent-pqy-c106="" class="highlight-div-header-left"><div _ngcontent-pqy-c106="" class="handle-button expand-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pqy-c106="" class="highlight-div-header-right"><div _ngcontent-pqy-c106="" class="handle-button ai-button"></div><div _ngcontent-pqy-c106="" class="handle-button line-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pqy-c106="" class="handle-button theme-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pqy-c106="" class="handle-button copy-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pqy-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li>mod2 c executed</li><li>mod1 a executed</li><li>mod1 b executed</li><li>main executed</li></ol></pre></div></div>     <p>如果在main.ets内删除lazy关键字，执行顺序如下：</p>     <div _ngcontent-pqy-c106="" class="highlight-div"><div _ngcontent-pqy-c106="" class="highlight-div-header"><div _ngcontent-pqy-c106="" class="highlight-div-header-left"><div _ngcontent-pqy-c106="" class="handle-button expand-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pqy-c106="" class="highlight-div-header-right"><div _ngcontent-pqy-c106="" class="handle-button ai-button"></div><div _ngcontent-pqy-c106="" class="handle-button line-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pqy-c106="" class="handle-button theme-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pqy-c106="" class="handle-button copy-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pqy-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li>mod1 a executed</li><li>mod1 b executed</li><li>mod2 c executed</li><li>main executed</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="lazy-import与动态加载的区别">lazy-import与动态加载的区别<i class="anchor-icon anchor-icon-link" anchorid="lazy-import与动态加载的区别" tips="复制节点链接"></i></h2>          <p>lazy-import与<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-dynamic-import">动态加载</a>都可以延后特定文件的执行时间，帮助设备分摊性能消耗，缓解特定时段的性能压力。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.6.3.1.4.1.1" valign="top" width="33.33333333333333%">区别项</th>         <th align="left" class="cellrowborder" id="mcps1.3.6.3.1.4.1.2" valign="top" width="33.33333333333333%">动态加载</th>         <th align="left" class="cellrowborder" id="mcps1.3.6.3.1.4.1.3" valign="top" width="33.33333333333333%">lazy-import</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">语法示例</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">let A = await import("./A");</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">import lazy { A } from "./A";</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">性能开销</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">          <p>1.创建异步任务开销。</p>          <p>2.执行到动态加载时，触发依赖模块的模块解析+源码执行。</p></td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">          <p>1.lazy-import的模块解析在冷启动依旧会触发遍历。</p>          <p>2.导入的变量A被使用到时，触发模块的源码执行。</p></td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">使用位置</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">代码块/运行逻辑中使用</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">需要写在源码开头</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">是否可以运行时拼接</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">是</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">否</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">加载时序</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">异步</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">同步</td>        </tr>             </tbody></table></div>     </div>     <p>lazy-import 相较于动态加载的优势：</p>     <ol>      <li>在使用动态加载时，开发者需要将静态加载的代码（即同步导入）改写为动态加载语法（即异步导入），这可能涉及较大的代码修改量。</li>      <li>如果希望在冷启动阶段通过动态加载实现优化，开发者需要明确感知到被动态加载的文件在冷启动时不会被执行，否则会增加冷启动开销（放入异步队列等）。</li>      <li>相较于动态加载，使用 lazy-import 延迟加载，开发者只需在 import 语句中添加 lazy 关键字即可实现延迟加载，使用更加便捷。</li>     </ol>    </div>    <div class="tiledSection">     <h2 id="语法规格及起始支持版本">语法规格及起始支持版本<i class="anchor-icon anchor-icon-link" anchorid="语法规格及起始支持版本" tips="复制节点链接"></i></h2>          <ul>      <li>lazy-import支持如下指令实现：</li>     </ul>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.7.3.1.6.1.1" valign="top" width="20%">语法</th>         <th align="left" class="cellrowborder" id="mcps1.3.7.3.1.6.1.2" valign="top" width="20%">ModuleRequest</th>         <th align="left" class="cellrowborder" id="mcps1.3.7.3.1.6.1.3" valign="top" width="20%">ImportName</th>         <th align="left" class="cellrowborder" id="mcps1.3.7.3.1.6.1.4" valign="top" width="20%">LocalName</th>         <th align="left" class="cellrowborder" id="mcps1.3.7.3.1.6.1.5" valign="top" width="20%">开始支持的API版本</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="20%">import lazy { x } from "mod";</td>         <td class="cellrowborder" valign="top" width="20%">"mod"</td>         <td class="cellrowborder" valign="top" width="20%">"x"</td>         <td class="cellrowborder" valign="top" width="20%">"x"</td>         <td class="cellrowborder" valign="top" width="20%">API 12</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="20%">import lazy { x as v } from "mod";</td>         <td class="cellrowborder" valign="top" width="20%">"mod"</td>         <td class="cellrowborder" valign="top" width="20%">"x"</td>         <td class="cellrowborder" valign="top" width="20%">"v"</td>         <td class="cellrowborder" valign="top" width="20%">API 12</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="20%">import lazy x from "mod";</td>         <td class="cellrowborder" valign="top" width="20%">"mod"</td>         <td class="cellrowborder" valign="top" width="20%">"default"</td>         <td class="cellrowborder" valign="top" width="20%">"x"</td>         <td class="cellrowborder" valign="top" width="20%">API 18</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="20%">import lazy { KitClass } from "@kit.SomeKit";</td>         <td class="cellrowborder" valign="top" width="20%">"@kit.SomeKit"</td>         <td class="cellrowborder" valign="top" width="20%">"KitClass"</td>         <td class="cellrowborder" valign="top" width="20%">"KitClass"</td>         <td class="cellrowborder" valign="top" width="20%">API 18</td>        </tr>             </tbody></table></div>     </div>     <ul>      <li>       <p>延迟加载共享模块或依赖路径内包含共享模块。</p>       <p>延迟加载对于共享模块依旧生效，使用限制参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-sendable-module">共享模块开发指导</a>。</p></li>     </ul>    </div>    <div class="tiledSection">     <h3 id="错误示例" class="firsth2">错误示例<i class="anchor-icon anchor-icon-link" anchorid="错误示例" tips="复制节点链接"></i></h3>          <p>以下写法将引起编译报错。</p>     <div _ngcontent-pqy-c106="" class="highlight-div"><div _ngcontent-pqy-c106="" class="highlight-div-header"><div _ngcontent-pqy-c106="" class="highlight-div-header-left"><div _ngcontent-pqy-c106="" class="handle-button expand-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pqy-c106="" class="highlight-div-header-right"><div _ngcontent-pqy-c106="" class="handle-button ai-button"></div><div _ngcontent-pqy-c106="" class="handle-button line-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pqy-c106="" class="handle-button theme-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pqy-c106="" class="handle-button copy-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pqy-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">export</span> lazy <span class="hljs-keyword">var</span> v;                    <span class="hljs-comment">// 编译器提示报错：应用编译报错</span></li><li><span class="hljs-keyword">export</span> lazy <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">f</span>(<span class="hljs-params"></span>){};   <span class="hljs-comment">// 编译器提示报错：应用编译报错</span></li><li><span class="hljs-keyword">export</span> lazy <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>){};     <span class="hljs-comment">// 编译器提示报错：应用编译报错</span></li><li><span class="hljs-keyword">export</span> lazy <span class="hljs-keyword">default</span> <span class="hljs-number">42</span>;               <span class="hljs-comment">// 编译器提示报错：应用编译报错</span></li><li><span class="hljs-keyword">export</span> lazy { x };                    <span class="hljs-comment">// 编译器提示报错：应用编译报错</span></li><li><span class="hljs-keyword">export</span> lazy { x <span class="hljs-keyword">as</span> v };               <span class="hljs-comment">// 编译器提示报错：应用编译报错</span></li><li><span class="hljs-keyword">export</span> lazy { x } <span class="hljs-keyword">from</span> <span class="hljs-string">"mod"</span>;         <span class="hljs-comment">// 编译器提示报错：应用编译报错</span></li><li><span class="hljs-keyword">export</span> lazy { x <span class="hljs-keyword">as</span> v } <span class="hljs-keyword">from</span> <span class="hljs-string">"mod"</span>;    <span class="hljs-comment">// 编译器提示报错：应用编译报错</span></li><li><span class="hljs-keyword">export</span> lazy * <span class="hljs-keyword">from</span> <span class="hljs-string">"mod"</span>;             <span class="hljs-comment">// 编译器提示报错：应用编译报错</span></li><li>
</li><li><span class="hljs-keyword">import</span> lazy * <span class="hljs-keyword">as</span> ns <span class="hljs-keyword">from</span> <span class="hljs-string">"mod"</span>;            <span class="hljs-comment">// 编译器提示报错：应用编译报错</span></li><li><span class="hljs-keyword">import</span> lazy <span class="hljs-title class_">KitClass</span> <span class="hljs-keyword">from</span> <span class="hljs-string">"@kit.SomeKit"</span>   <span class="hljs-comment">// 编译器提示报错：应用编译报错</span></li><li><span class="hljs-keyword">import</span> lazy * <span class="hljs-keyword">as</span> <span class="hljs-title class_">MyKit</span> <span class="hljs-keyword">from</span> <span class="hljs-string">"@kit.SomeKit"</span> <span class="hljs-comment">// 编译器提示报错：应用编译报错</span></li></ol></pre></div></div>     <p>与type关键词同时使用会导致编译报错。</p>     <div _ngcontent-pqy-c106="" class="highlight-div"><div _ngcontent-pqy-c106="" class="highlight-div-header"><div _ngcontent-pqy-c106="" class="highlight-div-header-left"><div _ngcontent-pqy-c106="" class="handle-button expand-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pqy-c106="" class="highlight-div-header-right"><div _ngcontent-pqy-c106="" class="handle-button ai-button"></div><div _ngcontent-pqy-c106="" class="handle-button line-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pqy-c106="" class="handle-button theme-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pqy-c106="" class="handle-button copy-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pqy-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> lazy <span class="hljs-keyword">type</span> { obj } <span class="hljs-keyword">from</span> <span class="hljs-string">"./mod"</span>;    <span class="hljs-comment">// 不支持，编译器、应用编译报错</span></li><li><span class="hljs-keyword">import</span> <span class="hljs-keyword">type</span> lazy { obj } <span class="hljs-keyword">from</span> <span class="hljs-string">"./mod"</span>;    <span class="hljs-comment">// 不支持，编译器、应用编译报错</span></li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="不推荐用法">不推荐用法<i class="anchor-icon anchor-icon-link" anchorid="不推荐用法" tips="复制节点链接"></i></h3>          <ul>      <li>在同一个ets文件中，期望延迟加载的依赖模块标记不完全。</li>     </ul>     <p>标记不完全将导致延迟加载失效，并且增加识别延迟加载的开销。</p>     <div _ngcontent-pqy-c106="" class="highlight-div"><div _ngcontent-pqy-c106="" class="highlight-div-header"><div _ngcontent-pqy-c106="" class="highlight-div-header-left"><div _ngcontent-pqy-c106="" class="handle-button expand-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pqy-c106="" class="highlight-div-header-right"><div _ngcontent-pqy-c106="" class="handle-button ai-button"></div><div _ngcontent-pqy-c106="" class="handle-button line-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pqy-c106="" class="handle-button theme-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pqy-c106="" class="handle-button copy-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pqy-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// main.ets</span></li><li><span class="hljs-keyword">import</span> lazy { a } <span class="hljs-keyword">from</span> <span class="hljs-string">"./mod1"</span>;    <span class="hljs-comment">// 从"mod1"内获取a对象，标记为延迟加载</span></li><li><span class="hljs-keyword">import</span> { c } <span class="hljs-keyword">from</span> <span class="hljs-string">"./mod2"</span>;</li><li><span class="hljs-keyword">import</span> { b } <span class="hljs-keyword">from</span> <span class="hljs-string">"./mod1"</span>;         <span class="hljs-comment">// 再次获取"mod1"内属性，未标记lazy，"mod1"默认执行</span></li><li>        </li><li><span class="hljs-comment">// ...</span></li></ol></pre></div></div>     <ul>      <li>在同一ets文件中，未使用延迟加载变量并再次导出，不支持延迟加载变量被re-export导出，可以通过打开工程级build-profile.json5文件中的reExportCheckMode开关进行扫描排查。</li>     </ul>     <div _ngcontent-pqy-c106="" class="highlight-div"><div _ngcontent-pqy-c106="" class="highlight-div-header"><div _ngcontent-pqy-c106="" class="highlight-div-header-left"><div _ngcontent-pqy-c106="" class="handle-button expand-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pqy-c106="" class="highlight-div-header-right"><div _ngcontent-pqy-c106="" class="handle-button ai-button"></div><div _ngcontent-pqy-c106="" class="handle-button line-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pqy-c106="" class="handle-button theme-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pqy-c106="" class="handle-button copy-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pqy-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// build-profile.json5</span></li><li><span class="hljs-string">"arkOptions"</span>:{</li><li>    <span class="hljs-string">"reExportCheckMode"</span>:<span class="hljs-string">"compatible"</span></li><li>}</li></ol></pre></div></div>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <ul>        <li>针对以下场景，编译时是否进行拦截报错：使用lazy import导入的变量，在同文件中被再次导出。</li>        <li>noCheck（缺省默认值）：不检查，不报错。</li>        <li>compatible：兼容模式，报Warning。</li>        <li>strict：严格模式，报Error。</li>        <li>该字段从DevEco Studio 5.0.13.200版本开始支持。</li>       </ul>      </div></div></div>     <p>这种方式导出的变量c未在B.ets中使用，因此B.ets不会触发执行。在A.ets中使用变量c时，由于该变量未被初始化，将会抛出JavaScript异常。</p>     <div _ngcontent-pqy-c106="" class="highlight-div"><div _ngcontent-pqy-c106="" class="highlight-div-header"><div _ngcontent-pqy-c106="" class="highlight-div-header-left"><div _ngcontent-pqy-c106="" class="handle-button expand-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pqy-c106="" class="highlight-div-header-right"><div _ngcontent-pqy-c106="" class="handle-button ai-button"></div><div _ngcontent-pqy-c106="" class="handle-button line-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pqy-c106="" class="handle-button theme-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pqy-c106="" class="handle-button copy-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pqy-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// A.ets</span></li><li><span class="hljs-keyword">import</span> { c } <span class="hljs-keyword">from</span> <span class="hljs-string">"./B"</span>;</li><li><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(c);</li><li>
</li><li><span class="hljs-comment">// B.ets</span></li><li><span class="hljs-keyword">import</span> lazy { c } <span class="hljs-keyword">from</span> <span class="hljs-string">"./C"</span>;    <span class="hljs-comment">// 从"C"内获取c对象，标记为延迟加载</span></li><li><span class="hljs-keyword">export</span> { c }</li><li>
</li><li><span class="hljs-comment">// C.ets</span></li><li><span class="hljs-keyword">let</span> c = <span class="hljs-string">"c"</span>;</li><li><span class="hljs-keyword">export</span> { c }</li></ol></pre></div></div>     <p>执行结果：</p>     <div _ngcontent-pqy-c106="" class="highlight-div"><div _ngcontent-pqy-c106="" class="highlight-div-header"><div _ngcontent-pqy-c106="" class="highlight-div-header-left"><div _ngcontent-pqy-c106="" class="handle-button expand-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pqy-c106="" class="highlight-div-header-right"><div _ngcontent-pqy-c106="" class="handle-button ai-button"></div><div _ngcontent-pqy-c106="" class="handle-button line-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pqy-c106="" class="handle-button theme-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pqy-c106="" class="handle-button copy-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pqy-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-title class_">ReferenceError</span>: c is not initialized</li><li>    at func_main_0 (A.<span class="hljs-property">ets</span>:<span class="hljs-number">2</span>:<span class="hljs-number">13</span>)</li></ol></pre></div></div>     <div _ngcontent-pqy-c106="" class="highlight-div"><div _ngcontent-pqy-c106="" class="highlight-div-header"><div _ngcontent-pqy-c106="" class="highlight-div-header-left"><div _ngcontent-pqy-c106="" class="handle-button expand-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pqy-c106="" class="highlight-div-header-right"><div _ngcontent-pqy-c106="" class="handle-button ai-button"></div><div _ngcontent-pqy-c106="" class="handle-button line-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pqy-c106="" class="handle-button theme-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pqy-c106="" class="handle-button copy-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pqy-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// A_ns.ets</span></li><li><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> ns <span class="hljs-keyword">from</span> <span class="hljs-string">"./B"</span>;</li><li><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(ns.<span class="hljs-property">c</span>);</li><li>
</li><li><span class="hljs-comment">// B.ets</span></li><li><span class="hljs-keyword">import</span> lazy { c } <span class="hljs-keyword">from</span> <span class="hljs-string">"./C"</span>;    <span class="hljs-comment">// 从“C”内获取c对象，标记为延迟加载</span></li><li><span class="hljs-keyword">export</span> { c }</li><li>
</li><li><span class="hljs-comment">// C.ets</span></li><li><span class="hljs-keyword">let</span> c = <span class="hljs-string">"c"</span>;</li><li><span class="hljs-keyword">export</span> { c }</li></ol></pre></div></div>     <p>执行结果：</p>     <div _ngcontent-pqy-c106="" class="highlight-div"><div _ngcontent-pqy-c106="" class="highlight-div-header"><div _ngcontent-pqy-c106="" class="highlight-div-header-left"><div _ngcontent-pqy-c106="" class="handle-button expand-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pqy-c106="" class="highlight-div-header-right"><div _ngcontent-pqy-c106="" class="handle-button ai-button"></div><div _ngcontent-pqy-c106="" class="handle-button line-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pqy-c106="" class="handle-button theme-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pqy-c106="" class="handle-button copy-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pqy-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-title class_">ReferenceError</span>: <span class="hljs-variable language_">module</span> environment is <span class="hljs-literal">undefined</span></li><li>    at func_main_0 (A_ns.<span class="hljs-property">js</span>:<span class="hljs-number">2</span>:<span class="hljs-number">13</span>)</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="注意事项">注意事项<i class="anchor-icon anchor-icon-link" anchorid="注意事项" tips="复制节点链接"></i></h3>          <ul>      <li>不依赖该模块执行的副作用（如初始化全局变量，挂载globalThis等）。可参考：<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-module-side-effects">模块加载副作用及优化</a>。</li>      <li>使用导出对象时，触发延迟加载的耗时可能导致对应特性的功能劣化。由于lazy-import的后续加载是同步加载，可能在某些场景阻塞任务执行（比如在点击业务时触发了懒加载，那么运行时会执行冷启动为加载的文件，增加执行耗时，存在掉帧风险），是否使用延迟加载仍需要开发者自行评估。</li>      <li>使用lazy特性可能导致模块未执行，从而引发bug。</li>      <li>已经被动态加载的文件同时使用lazy-import时，这些文件会执行lazy标识，在动态加载的then逻辑中同步加载。</li>     </ul>    </div>    <div class="tiledSection">     <h2 id="可延迟加载文件检测">可延迟加载文件检测<i class="anchor-icon anchor-icon-link" anchorid="可延迟加载文件检测" tips="复制节点链接"></i></h2>          <p>本工具用于本地检测应用冷启动时的文件加载情况，可打印应用启动后固定时间段内使用和未使用的文件名，帮助开发者筛选可延迟加载的文件。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>可延迟加载文件检测从API 20版本开始支持。</p>      </div></div></div>    </div>    <div class="tiledSection">     <h3 id="检测步骤" class="firsth2">检测步骤<i class="anchor-icon anchor-icon-link" anchorid="检测步骤" tips="复制节点链接"></i></h3>          <ol>      <li>       <p>打开工具：获取<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/hdc#环境准备">hdc工具</a>，连接设备，在终端直接输入下方命令执行。</p>       <div _ngcontent-pqy-c106="" class="highlight-div"><div _ngcontent-pqy-c106="" class="highlight-div-header"><div _ngcontent-pqy-c106="" class="highlight-div-header-left"><div _ngcontent-pqy-c106="" class="handle-button expand-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pqy-c106="" class="highlight-div-header-right"><div _ngcontent-pqy-c106="" class="handle-button ai-button"></div><div _ngcontent-pqy-c106="" class="handle-button line-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pqy-c106="" class="handle-button theme-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pqy-c106="" class="handle-button copy-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pqy-c106="" class="highlight-scroll-div"><pre class="shell prettyprint linenums hljs language-shell" hw-language="shell" data-highlighted="yes"><ol class="linenums"><li>hdc shell param set persist.ark.properties 0x200105c</li></ol></pre></div></div></li>      <li>       <p>可选项：设置抓取应用启动阶段的时间，单位为ms，范围为[100-30000]，默认为2s。设置范围外的数字无法保证工具的计时准确性。</p>       <div _ngcontent-pqy-c106="" class="highlight-div"><div _ngcontent-pqy-c106="" class="highlight-div-header"><div _ngcontent-pqy-c106="" class="highlight-div-header-left"><div _ngcontent-pqy-c106="" class="handle-button expand-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pqy-c106="" class="highlight-div-header-right"><div _ngcontent-pqy-c106="" class="handle-button ai-button"></div><div _ngcontent-pqy-c106="" class="handle-button line-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pqy-c106="" class="handle-button theme-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pqy-c106="" class="handle-button copy-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pqy-c106="" class="highlight-scroll-div"><pre class="shell prettyprint linenums hljs language-shell" hw-language="shell" data-highlighted="yes"><ol class="linenums"><li>hdc shell param set persist.ark.importDuration 1000</li></ol></pre></div></div></li>      <li>       <p>清除应用后台进程后，重新启动应用进程，等待抓取时间结束，会在应用沙箱下（data/app/el2/100/base/${bundlename}/files/）生成主/子线程对应文件。</p>       <div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content">         <ol>          <li>该工具仅支持本地安装的应用。</li>          <li>生成文件的操作需要在当前进程存活时执行。</li>          <li>如果抓取过程中进程退出，那么不会生成对应的文件。</li>         </ol>        </div></div></div></li>      <li>       <p>关闭工具</p>       <p>工具常开会损耗性能，使用后应及时关闭。</p>       <div _ngcontent-pqy-c106="" class="highlight-div"><div _ngcontent-pqy-c106="" class="highlight-div-header"><div _ngcontent-pqy-c106="" class="highlight-div-header-left"><div _ngcontent-pqy-c106="" class="handle-button expand-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pqy-c106="" class="highlight-div-header-right"><div _ngcontent-pqy-c106="" class="handle-button ai-button"></div><div _ngcontent-pqy-c106="" class="handle-button line-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pqy-c106="" class="handle-button theme-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pqy-c106="" class="handle-button copy-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pqy-c106="" class="highlight-scroll-div"><pre class="shell prettyprint linenums hljs language-shell" hw-language="shell" data-highlighted="yes"><ol class="linenums"><li>hdc shell param set persist.ark.properties 0x000105c</li></ol></pre></div></div></li>     </ol>    </div>    <div class="tiledSection">     <h3 id="生成文件介绍">生成文件介绍<i class="anchor-icon anchor-icon-link" anchorid="生成文件介绍" tips="复制节点链接"></i></h3>          <p>工具会根据设置的抓取时间，分别记录主线程和子线程在该时间内的文件加载情况。各线程独立计时。</p>     <p>例如，设置时间为1秒，工具将记录主线程和子线程各自启动后1秒内的文件执行情况。</p>     <p>文件生成路径：data/app/el2/100/base/${bundleName}/files</p>     <p>主线程文件名：${bundleName}_redundant_file.txt</p>     <p>子线程文件名：${bundleName}_${tId}_redundant_file.txt</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <ol>        <li>主线程文件名不含线程号信息，因此写入文件时会发生覆盖。</li>        <li>子线程文件名包含线程号tId，且每个tId唯一，确保每个子线程对应一个单独的文件。若需查找对应线程文件，可依据日志中的线程号或使用trace工具查看线程号进行匹配。</li>       </ol>      </div></div></div>     <p><strong>示例</strong></p>     <p>当前测试应用bundleName为com.example.myapplication，应用内创建了一个子线程，线程号为18089（随机）。</p>     <p>文件生成路径：data/app/el2/100/base/com.example.myapplication/files</p>     <p>主线程文件名：data/app/el2/100/base/com.example.myapplication/files/com.example.myapplication_redundant_file.txt</p>     <p>子线程文件名：data/app/el2/100/base/com.example.myapplication/files/com.example.myapplication_18089_redundant_file.txt</p>     <p><span><img originheight="384" originwidth="628" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114825.18985394989748109581259929355418:50001231000000:2800:D56402A78C2B84E96AF64378029CEDA88DEB877C8F75B49DB115BF4646D3A8AE.png" width="628" height="384"></span></p>    </div>    <div class="tiledSection">     <h3 id="检测原理">检测原理<i class="anchor-icon anchor-icon-link" anchorid="检测原理" tips="复制节点链接"></i></h3>          <p>如下例所示，A文件和B文件同时被Index文件依赖，那么A、B会随着Index文件的加载被直接加载执行。</p>     <p>A文件执行过程完成了变量定义赋值并进行导出，对应A文件的耗时。B文件定义了一个函数并导出，对应B文件的耗时。</p>     <p>在Index文件执行时，B文件的导出函数func被顶层执行，因此B文件的导出是无法优化的，在工具侧就会显示used。但是A文件的导出变量a在Index文件的myFunc函数被调用时才使用，如果冷启动阶段没有其他文件调用myFunc函数，那么A文件在工具侧就会显示unused，即可以延迟加载。</p>     <div _ngcontent-pqy-c106="" class="highlight-div"><div _ngcontent-pqy-c106="" class="highlight-div-header"><div _ngcontent-pqy-c106="" class="highlight-div-header-left"><div _ngcontent-pqy-c106="" class="handle-button expand-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pqy-c106="" class="highlight-div-header-right"><div _ngcontent-pqy-c106="" class="handle-button ai-button"></div><div _ngcontent-pqy-c106="" class="handle-button line-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pqy-c106="" class="handle-button theme-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pqy-c106="" class="handle-button copy-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pqy-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// Index.ets</span></li><li><span class="hljs-keyword">import</span> { a } <span class="hljs-keyword">from</span> <span class="hljs-string">'./A'</span>;</li><li><span class="hljs-keyword">import</span> { func } <span class="hljs-keyword">from</span> <span class="hljs-string">'./B'</span>;</li><li><span class="hljs-title function_">func</span>(); <span class="hljs-comment">// 使用B文件变量</span></li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">myFunc</span>(<span class="hljs-params"></span>) {</li><li>   <span class="hljs-keyword">return</span> a; <span class="hljs-comment">// a变量未被使用</span></li><li>}</li><li><span class="hljs-comment">// A.ets</span></li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">let</span> a = <span class="hljs-number">10</span>;</li><li>
</li><li><span class="hljs-comment">// B.ets</span></li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">func</span>(<span class="hljs-params"></span>) {</li><li>   <span class="hljs-keyword">return</span> <span class="hljs-number">20</span>;</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="加载情况总结">加载情况总结<i class="anchor-icon anchor-icon-link" anchorid="加载情况总结" tips="复制节点链接"></i></h3>          <p>总结加载时间内所有文件及其耗时，包括已使用的文件及其耗时和未使用的文件及其耗时。</p>     <p>例：</p>     <div _ngcontent-pqy-c106="" class="highlight-div"><div _ngcontent-pqy-c106="" class="highlight-div-header"><div _ngcontent-pqy-c106="" class="highlight-div-header-left"><div _ngcontent-pqy-c106="" class="handle-button expand-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pqy-c106="" class="highlight-div-header-right"><div _ngcontent-pqy-c106="" class="handle-button ai-button"></div><div _ngcontent-pqy-c106="" class="handle-button line-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pqy-c106="" class="handle-button theme-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pqy-c106="" class="handle-button copy-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pqy-c106="" class="highlight-scroll-div"><pre class="text prettyprint linenums hljs language-plaintext" hw-language="text" data-highlighted="yes"><ol class="linenums"><li>&lt;----Summary----&gt; Total file number: 13, total time: 2ms, including used file:12, cost time: 1ms, and unused file: 1, cost time: 1ms</li></ol></pre></div></div>     <p>上述信息表示应用当前线程在冷启动抓取时间段内加载了13个文件，共耗时2ms。其中，12个文件导出内容被其他文件加载使用，执行这12个文件共耗时1ms；1个文件执行完成，但是其导出内容没有被其他文件在冷启阶段用到，耗时1ms。</p>    </div>    <div class="tiledSection">     <h3 id="被使用文件">被使用文件<i class="anchor-icon anchor-icon-link" anchorid="被使用文件" tips="复制节点链接"></i></h3>          <p>在冷启动阶段，导出内容被其他文件使用的文件称为used file。</p>     <ul>      <li>       <p>场景1：通过静态加载加载的文件，其父文件（parentModule）代表该文件的引入方。</p>       <div _ngcontent-pqy-c106="" class="highlight-div"><div _ngcontent-pqy-c106="" class="highlight-div-header"><div _ngcontent-pqy-c106="" class="highlight-div-header-left"><div _ngcontent-pqy-c106="" class="handle-button expand-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pqy-c106="" class="highlight-div-header-right"><div _ngcontent-pqy-c106="" class="handle-button ai-button"></div><div _ngcontent-pqy-c106="" class="handle-button line-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pqy-c106="" class="handle-button theme-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pqy-c106="" class="handle-button copy-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pqy-c106="" class="highlight-scroll-div"><pre class="text prettyprint linenums hljs language-plaintext" hw-language="text" data-highlighted="yes"><ol class="linenums"><li>used file 1: &amp;entry/src/main/ets/pages/1&amp;, cost time: 0.248ms</li><li>    parentModule 1: &amp;entry/src/main/ets/pages/outter&amp; a</li></ol></pre></div></div>       <p>对应写法示例：</p>       <div _ngcontent-pqy-c106="" class="highlight-div"><div _ngcontent-pqy-c106="" class="highlight-div-header"><div _ngcontent-pqy-c106="" class="highlight-div-header-left"><div _ngcontent-pqy-c106="" class="handle-button expand-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pqy-c106="" class="highlight-div-header-right"><div _ngcontent-pqy-c106="" class="handle-button ai-button"></div><div _ngcontent-pqy-c106="" class="handle-button line-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pqy-c106="" class="handle-button theme-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pqy-c106="" class="handle-button copy-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pqy-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// entry/src/main/ets/pages/outter.ets</span></li><li><span class="hljs-keyword">import</span> { a } <span class="hljs-keyword">from</span> <span class="hljs-string">'./1'</span> <span class="hljs-comment">// outter文件从1文件中加载了a变量</span></li><li><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"example "</span>, a); <span class="hljs-comment">// a变量在outter文件执行时就被使用</span></li></ol></pre></div></div></li>      <li>       <p>场景2：通过静态加载加载的文件，存在多个父文件。</p>       <div _ngcontent-pqy-c106="" class="highlight-div"><div _ngcontent-pqy-c106="" class="highlight-div-header"><div _ngcontent-pqy-c106="" class="highlight-div-header-left"><div _ngcontent-pqy-c106="" class="handle-button expand-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pqy-c106="" class="highlight-div-header-right"><div _ngcontent-pqy-c106="" class="handle-button ai-button"></div><div _ngcontent-pqy-c106="" class="handle-button line-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pqy-c106="" class="handle-button theme-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pqy-c106="" class="handle-button copy-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pqy-c106="" class="highlight-scroll-div"><pre class="text prettyprint linenums hljs language-plaintext" hw-language="text" data-highlighted="yes"><ol class="linenums"><li>// 说明：显示顺序不代表父文件的加载顺序。</li><li>used file 1: &amp;entry/src/main/ets/pages/1&amp;, cost time: 0.248ms</li><li>   parentModule 1: &amp;entry/src/main/ets/pages/outter&amp; a</li><li>   parentModule 2: &amp;entry/src/main/ets/pages/innerinner&amp; a</li></ol></pre></div></div>       <p>对应写法示例：</p>       <div _ngcontent-pqy-c106="" class="highlight-div"><div _ngcontent-pqy-c106="" class="highlight-div-header"><div _ngcontent-pqy-c106="" class="highlight-div-header-left"><div _ngcontent-pqy-c106="" class="handle-button expand-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pqy-c106="" class="highlight-div-header-right"><div _ngcontent-pqy-c106="" class="handle-button ai-button"></div><div _ngcontent-pqy-c106="" class="handle-button line-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pqy-c106="" class="handle-button theme-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pqy-c106="" class="handle-button copy-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pqy-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// entry/src/main/ets/pages/outter.ets</span></li><li><span class="hljs-keyword">import</span> { a } <span class="hljs-keyword">from</span> <span class="hljs-string">'./1'</span> <span class="hljs-comment">// outter文件从1文件中加载了a变量</span></li><li><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"example "</span>, a); <span class="hljs-comment">// a变量在outter文件执行时就被使用</span></li><li>
</li><li><span class="hljs-comment">// entry/src/main/ets/pages/innerinner.ets</span></li><li><span class="hljs-keyword">import</span> { a } <span class="hljs-keyword">from</span> <span class="hljs-string">'./1'</span> <span class="hljs-comment">// innerinner文件从1文件中加载了a变量</span></li><li><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"example "</span>, a); <span class="hljs-comment">// a变量在innerinner文件执行时就被使用</span></li></ol></pre></div></div></li>      <li>       <p>场景3：通过静态加载加载的文件，存在多个导出，但是只显示了一部分。</p>       <div _ngcontent-pqy-c106="" class="highlight-div"><div _ngcontent-pqy-c106="" class="highlight-div-header"><div _ngcontent-pqy-c106="" class="highlight-div-header-left"><div _ngcontent-pqy-c106="" class="handle-button expand-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pqy-c106="" class="highlight-div-header-right"><div _ngcontent-pqy-c106="" class="handle-button ai-button"></div><div _ngcontent-pqy-c106="" class="handle-button line-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pqy-c106="" class="handle-button theme-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pqy-c106="" class="handle-button copy-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pqy-c106="" class="highlight-scroll-div"><pre class="text prettyprint linenums hljs language-plaintext" hw-language="text" data-highlighted="yes"><ol class="linenums"><li>used file 1: &amp;entry/src/main/ets/pages/1&amp;, cost time: 0.248ms</li><li>   parentModule 1: &amp;entry/src/main/ets/pages/outter&amp; a</li></ol></pre></div></div>       <p>对应写法示例：</p>       <div _ngcontent-pqy-c106="" class="highlight-div"><div _ngcontent-pqy-c106="" class="highlight-div-header"><div _ngcontent-pqy-c106="" class="highlight-div-header-left"><div _ngcontent-pqy-c106="" class="handle-button expand-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pqy-c106="" class="highlight-div-header-right"><div _ngcontent-pqy-c106="" class="handle-button ai-button"></div><div _ngcontent-pqy-c106="" class="handle-button line-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pqy-c106="" class="handle-button theme-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pqy-c106="" class="handle-button copy-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pqy-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// entry/src/main/ets/pages/outter.ets</span></li><li><span class="hljs-keyword">import</span> { a , b } <span class="hljs-keyword">from</span> <span class="hljs-string">'./1'</span> <span class="hljs-comment">// 加载1文件的多个变量</span></li><li><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"example "</span>, a); <span class="hljs-comment">// a被使用</span></li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">myFunc</span>(<span class="hljs-params"></span>) {</li><li> <span class="hljs-keyword">return</span> b; <span class="hljs-comment">// b未被使用</span></li><li>}</li><li><span class="hljs-comment">// entry/src/main/ets/pages/1.ets</span></li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">let</span> a = <span class="hljs-number">10</span>;</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">let</span> b = <span class="hljs-number">100</span>;</li></ol></pre></div></div></li>      <li>       <p>场景4：动态加载或使用napi接口加载时，暂未支持父文件打印，因此不会显示父文件。</p>       <div _ngcontent-pqy-c106="" class="highlight-div"><div _ngcontent-pqy-c106="" class="highlight-div-header"><div _ngcontent-pqy-c106="" class="highlight-div-header-left"><div _ngcontent-pqy-c106="" class="handle-button expand-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pqy-c106="" class="highlight-div-header-right"><div _ngcontent-pqy-c106="" class="handle-button ai-button"></div><div _ngcontent-pqy-c106="" class="handle-button line-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pqy-c106="" class="handle-button theme-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pqy-c106="" class="handle-button copy-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pqy-c106="" class="highlight-scroll-div"><pre class="text prettyprint linenums hljs language-plaintext" hw-language="text" data-highlighted="yes"><ol class="linenums"><li>unused file 1: &amp;entry/src/main/ets/pages/1&amp;, cost time: 0.07ms</li></ol></pre></div></div>       <p>对应写法示例：</p>       <div _ngcontent-pqy-c106="" class="highlight-div"><div _ngcontent-pqy-c106="" class="highlight-div-header"><div _ngcontent-pqy-c106="" class="highlight-div-header-left"><div _ngcontent-pqy-c106="" class="handle-button expand-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pqy-c106="" class="highlight-div-header-right"><div _ngcontent-pqy-c106="" class="handle-button ai-button"></div><div _ngcontent-pqy-c106="" class="handle-button line-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pqy-c106="" class="handle-button theme-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pqy-c106="" class="handle-button copy-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pqy-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span>(<span class="hljs-string">"./1"</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">ns:ESObject</span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'import file 1 success'</span>);</li><li>});</li></ol></pre></div></div></li>      <li>       <p>场景5：通过loadContent、pushUrl等接口加载的文件，其父文件（parentModule）统一显示为EntryPoint。</p>       <div _ngcontent-pqy-c106="" class="highlight-div"><div _ngcontent-pqy-c106="" class="highlight-div-header"><div _ngcontent-pqy-c106="" class="highlight-div-header-left"><div _ngcontent-pqy-c106="" class="handle-button expand-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pqy-c106="" class="highlight-div-header-right"><div _ngcontent-pqy-c106="" class="handle-button ai-button"></div><div _ngcontent-pqy-c106="" class="handle-button line-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pqy-c106="" class="handle-button theme-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pqy-c106="" class="handle-button copy-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pqy-c106="" class="highlight-scroll-div"><pre class="text prettyprint linenums hljs language-plaintext" hw-language="text" data-highlighted="yes"><ol class="linenums"><li>used file 1: &amp;entry/src/main/ets/pages/Index&amp;, cost time: 0.545ms</li><li>parentModule 1: EntryPoint</li></ol></pre></div></div></li>     </ul>    </div>    <div class="tiledSection">     <h3 id="未被使用文件">未被使用文件<i class="anchor-icon anchor-icon-link" anchorid="未被使用文件" tips="复制节点链接"></i></h3>          <p>在冷启动阶段，导出内容没有被其他文件使用的文件称为未使用的文件，代表可以延迟加载。</p>     <p>场景与被使用文件场景一致，但未被使用文件没有变量被使用的信息。</p>     <ul>      <li>       <p>场景：文件被这些父文件引用，但变量未被使用。可在引入未使用文件处（父文件）使用延迟加载方式加载该文件。</p>       <div _ngcontent-pqy-c106="" class="highlight-div"><div _ngcontent-pqy-c106="" class="highlight-div-header"><div _ngcontent-pqy-c106="" class="highlight-div-header-left"><div _ngcontent-pqy-c106="" class="handle-button expand-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pqy-c106="" class="highlight-div-header-right"><div _ngcontent-pqy-c106="" class="handle-button ai-button"></div><div _ngcontent-pqy-c106="" class="handle-button line-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pqy-c106="" class="handle-button theme-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pqy-c106="" class="handle-button copy-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pqy-c106="" class="highlight-scroll-div"><pre class="text prettyprint linenums hljs language-plaintext" hw-language="text" data-highlighted="yes"><ol class="linenums"><li>unused file 1: &amp;entry/src/main/ets/pages/under1&amp;, cost time: 0.001ms</li><li>    parentModule 1: &amp;entry/src/main/ets/pages/1&amp;</li></ol></pre></div></div>       <p>对应写法示例：</p>       <div _ngcontent-pqy-c106="" class="highlight-div"><div _ngcontent-pqy-c106="" class="highlight-div-header"><div _ngcontent-pqy-c106="" class="highlight-div-header-left"><div _ngcontent-pqy-c106="" class="handle-button expand-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pqy-c106="" class="highlight-div-header-right"><div _ngcontent-pqy-c106="" class="handle-button ai-button"></div><div _ngcontent-pqy-c106="" class="handle-button line-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pqy-c106="" class="handle-button theme-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pqy-c106="" class="handle-button copy-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pqy-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// entry/src/main/ets/pages/1.ets</span></li><li><span class="hljs-keyword">import</span> { a } <span class="hljs-keyword">from</span> <span class="hljs-string">'./under1'</span> <span class="hljs-comment">// 加载under1文件的变量</span></li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">myFunc</span>(<span class="hljs-params"></span>) {</li><li> <span class="hljs-keyword">return</span> a; <span class="hljs-comment">// a未被使用</span></li><li>}</li></ol></pre></div></div>       <p>可使用延迟加载：</p>       <div _ngcontent-pqy-c106="" class="highlight-div"><div _ngcontent-pqy-c106="" class="highlight-div-header"><div _ngcontent-pqy-c106="" class="highlight-div-header-left"><div _ngcontent-pqy-c106="" class="handle-button expand-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pqy-c106="" class="highlight-div-header-right"><div _ngcontent-pqy-c106="" class="handle-button ai-button"></div><div _ngcontent-pqy-c106="" class="handle-button line-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pqy-c106="" class="handle-button theme-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pqy-c106="" class="handle-button copy-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pqy-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// entry/src/main/ets/pages/1.ets</span></li><li><span class="hljs-keyword">import</span> lazy { a } <span class="hljs-keyword">from</span> <span class="hljs-string">'./under1'</span> <span class="hljs-comment">// 不在此处触发under1文件的加载</span></li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">myFunc</span>(<span class="hljs-params"></span>) {</li><li> <span class="hljs-keyword">return</span> a; <span class="hljs-comment">// 此时触发under1文件的加载</span></li><li>}</li></ol></pre></div></div></li>     </ul>    </div>    <div class="tiledSection">     <h3 id="使用示例">使用示例<i class="anchor-icon anchor-icon-link" anchorid="使用示例" tips="复制节点链接"></i></h3>          <p><strong>使用场景</strong></p>     <p>下述例子中A文件被引用，在应用启动到点击按钮的这段时间里，A文件并没有被实际执行，在冷启动阶段加载A文件的行为属于冗余。</p>     <div _ngcontent-pqy-c106="" class="highlight-div"><div _ngcontent-pqy-c106="" class="highlight-div-header"><div _ngcontent-pqy-c106="" class="highlight-div-header-left"><div _ngcontent-pqy-c106="" class="handle-button expand-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pqy-c106="" class="highlight-div-header-right"><div _ngcontent-pqy-c106="" class="handle-button ai-button"></div><div _ngcontent-pqy-c106="" class="handle-button line-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pqy-c106="" class="handle-button theme-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pqy-c106="" class="handle-button copy-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pqy-c106="" class="highlight-scroll-div"><pre class="javascript prettyprint linenums hljs language-javascript" hw-language="javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// A为任意可以被引入的ets文件</span></li><li><span class="hljs-keyword">import</span> { A } <span class="hljs-keyword">from</span> <span class="hljs-string">"./A"</span>;</li><li>
</li><li>@<span class="hljs-title class_">Entry</span></li><li>@<span class="hljs-title class_">Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">RelativeContainer</span>() {</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'点击执行A文件'</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-comment">// 点击后触发A文件的执行</span></li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"执行A文件"</span>, A);</li><li>        })</li><li>    }</li><li>    <span class="hljs-comment">// ...</span></li><li>  }</li><li>}</li></ol></pre></div></div>     <p><span><img originheight="449" originwidth="1551" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114825.24432501623140904719405651269000:50001231000000:2800:E0C330AE8F43E6289FBBA211C674E6466B8B95CB2EBC4F38FDE7E6B26DC75775.png" width="920" height="266.33139909735655"></span></p>     <p>通过抓取Trace图查看调用栈，可以发现应用在冷启动时加载了A文件。</p>     <p><strong>使用工具分析</strong></p>     <ol>      <li>       <p>连接设备，在终端直接输入下方命令执行。</p>       <div _ngcontent-pqy-c106="" class="highlight-div"><div _ngcontent-pqy-c106="" class="highlight-div-header"><div _ngcontent-pqy-c106="" class="highlight-div-header-left"><div _ngcontent-pqy-c106="" class="handle-button expand-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pqy-c106="" class="highlight-div-header-right"><div _ngcontent-pqy-c106="" class="handle-button ai-button"></div><div _ngcontent-pqy-c106="" class="handle-button line-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pqy-c106="" class="handle-button theme-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pqy-c106="" class="handle-button copy-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pqy-c106="" class="highlight-scroll-div"><pre class="shell prettyprint linenums hljs language-shell" hw-language="shell" data-highlighted="yes"><ol class="linenums"><li>hdc shell param set persist.ark.properties 0x200105c</li></ol></pre></div></div></li>      <li>       <p>启动应用，启动结束后关闭应用。</p></li>      <li>       <p>下载文件到本地，其中${bundleName}为应用名。</p>       <div _ngcontent-pqy-c106="" class="highlight-div"><div _ngcontent-pqy-c106="" class="highlight-div-header"><div _ngcontent-pqy-c106="" class="highlight-div-header-left"><div _ngcontent-pqy-c106="" class="handle-button expand-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pqy-c106="" class="highlight-div-header-right"><div _ngcontent-pqy-c106="" class="handle-button ai-button"></div><div _ngcontent-pqy-c106="" class="handle-button line-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pqy-c106="" class="handle-button theme-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pqy-c106="" class="handle-button copy-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pqy-c106="" class="highlight-scroll-div"><pre class="shell prettyprint linenums hljs language-shell" hw-language="shell" data-highlighted="yes"><ol class="linenums"><li>hdc file recv data/app/el2/100/base/${bundleName}/files/${bundleName}_redundant_file.txt D:\</li></ol></pre></div></div></li>      <li>       <p>对上述示例代码获取到的文件进行分析。</p>       <p><span><img originheight="389" originwidth="911" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114825.48103031830509560400099988911409:50001231000000:2800:E237EDF6AB4CE5230DC0DC16B9CBEE830777021E20812A5E14EC49A83EF8B424.png" width="911" height="389"></span></p></li>     </ol>     <p><strong>修改方式</strong></p>     <p>工具筛选出冗余文件后，开发者可在引入时添加lazy关键字，标记文件可延迟加载。</p>     <div _ngcontent-pqy-c106="" class="highlight-div"><div _ngcontent-pqy-c106="" class="highlight-div-header"><div _ngcontent-pqy-c106="" class="highlight-div-header-left"><div _ngcontent-pqy-c106="" class="handle-button expand-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pqy-c106="" class="highlight-div-header-right"><div _ngcontent-pqy-c106="" class="handle-button ai-button"></div><div _ngcontent-pqy-c106="" class="handle-button line-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pqy-c106="" class="handle-button theme-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pqy-c106="" class="handle-button copy-button"><div _ngcontent-pqy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pqy-c106="" class="highlight-scroll-div"><pre class="javascript prettyprint linenums hljs language-javascript" hw-language="javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 此处添加lazy关键字，标记该文件可延迟加载</span></li><li><span class="hljs-keyword">import</span> lazy { A } <span class="hljs-keyword">from</span> <span class="hljs-string">"./A"</span>;</li><li>
</li><li>@<span class="hljs-title class_">Entry</span></li><li>@<span class="hljs-title class_">Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">RelativeContainer</span>() {</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'点击执行A文件'</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-comment">// 点击后触发A文件的执行</span></li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"执行A文件"</span>, A);</li><li>        })</li><li>    }</li><li>    <span class="hljs-comment">// ...</span></li><li>  }</li><li>}</li></ol></pre></div></div>     <p><span><img originheight="436" originwidth="1551" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114825.02953176673712980765888739281810:50001231000000:2800:507F48C9D355800EEB990404E93B1301523176C229D627C4E0436719AB10ECEF.png" width="920" height="258.6202450032237"></span></p>     <p>通过抓取Trace图查看调用栈可以发现，使用lazy-import标识后，应用在冷启动时不再加载A文件。</p>     <p><strong>优化效果</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.18.15.1.3.1.1" valign="top" width="50%"></th>         <th align="left" class="cellrowborder" id="mcps1.3.18.15.1.3.1.2" valign="top" width="50%">加载文件耗时（微秒μs）</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="50%">优化前</td>         <td class="cellrowborder" valign="top" width="50%">412us</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">优化后</td>         <td class="cellrowborder" valign="top" width="50%">350us</td>        </tr>             </tbody></table></div>     </div>     <p>根据上述优化前后案例Trace图对比分析，使用延迟加载后应用冷启动时不再加载A文件，在资源加载阶段减少因加载冗余文件产生的耗时约15%，提高了应用冷启动性能。（由于案例仅演示场景，优化数据仅做参考，在实际业务中随着引用文件的复杂度提高，引用文件数量增多，优化效果也会随之提升。）</p>    </div>   </div>   <div></div></div>