<h1 _ngcontent-dag-c119="" class="doc-title ng-star-inserted" title="开发准备"> 开发准备 </h1>

<div _ngcontent-dag-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p>应用需获取相册管理模块实例，才能访问和修改相册中的媒体数据。相册管理模块涉及用户个人数据信息，应用需向用户申请读写权限，以保证功能的正常运行。使用相册管理模块接口时，如无其他注明，默认在工程代码的pages/index.ets或其他自定义的ets文件中使用。</p>    <div class="tiledSection">     <h2 id="获取相册管理模块实例">获取相册管理模块实例<i class="anchor-icon anchor-icon-link" anchorid="获取相册管理模块实例" tips="复制节点链接"></i></h2>          <p>应用需要通过上下文Context和接口<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-photoaccesshelper-f#photoaccesshelpergetphotoaccesshelper" target="_blank">getPhotoAccessHelper</a>，获取相册管理模块实例，用于访问和修改相册中的媒体数据信息，如图片和视频。</p>     <p><strong>开发步骤</strong></p>     <ol>      <li>导入photoAccessHelper模块以使用相册管理模块相关接口。</li>      <li>通过getUIContext().getHostContext()获取应用上下文。</li>      <li>获取相册管理模块实例。</li>     </ol>     <div _ngcontent-dag-c106="" class="highlight-div"><div _ngcontent-dag-c106="" class="highlight-div-header"><div _ngcontent-dag-c106="" class="highlight-div-header-left"><div _ngcontent-dag-c106="" class="handle-button expand-button"><div _ngcontent-dag-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-dag-c106="" class="highlight-div-header-right"><div _ngcontent-dag-c106="" class="handle-button ai-button"></div><div _ngcontent-dag-c106="" class="handle-button line-button"><div _ngcontent-dag-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-dag-c106="" class="handle-button theme-button"><div _ngcontent-dag-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-dag-c106="" class="handle-button copy-button"><div _ngcontent-dag-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-dag-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { photoAccessHelper } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.MediaLibraryKit'</span>;</li><li><span class="hljs-keyword">import</span> { common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-comment">// 此处获取的photoAccessHelper实例为全局对象，后续文档中使用到的地方默认为使用此处获取的对象，如未添加此段代码报未定义的错误请自行添加。</span></li><li><span class="hljs-comment">// 请在组件内获取context，确保this.getUiContext().getHostContext()返回结果为UIAbilityContext</span></li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">outputText</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'支持的类型为：\n'</span>;</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Row</span>() {</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">"example"</span>).<span class="hljs-title function_">onClick</span>(<span class="hljs-keyword">async</span> () =&gt; {</li><li>        <span class="hljs-keyword">let</span> <span class="hljs-attr">context</span>: <span class="hljs-title class_">Context</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li>        <span class="hljs-keyword">let</span> phAccessHelper = photoAccessHelper.<span class="hljs-title function_">getPhotoAccessHelper</span>(context);</li><li>      }).<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    }</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'90%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="申请相册管理模块功能相关权限">申请相册管理模块功能相关权限<i class="anchor-icon anchor-icon-link" anchorid="申请相册管理模块功能相关权限" tips="复制节点链接"></i></h2>          <p>相册管理模块的读写操作需要相应权限，在申请权限前，请保证符合<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/app-permission-mgmt-overview#权限使用的基本原则">权限使用的基本原则</a>。涉及的权限如下表。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.3.3.1.4.1.1" valign="top" width="33.33333333333333%">权限名</th>         <th align="left" class="cellrowborder" id="mcps1.3.3.3.1.4.1.2" valign="top" width="33.33333333333333%">说明</th>         <th align="left" class="cellrowborder" id="mcps1.3.3.3.1.4.1.3" valign="top" width="33.33333333333333%">授权方式</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">ohos.permission.READ_IMAGEVIDEO</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">允许应用读取媒体库的图片和视频媒体文件信息。</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">user_grant</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">ohos.permission.WRITE_IMAGEVIDEO</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">允许应用读写媒体库的图片和视频媒体文件信息。</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">user_grant</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">ohos.permission.MEDIA_LOCATION</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">允许应用访问用户媒体文件中的地理位置信息。</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">user_grant</td>        </tr>             </tbody></table></div>     </div>     <p>以上权限的授权方式均为user_grant（用户授权），即开发者在module.json5文件中配置对应的权限后，需要使用接口<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-abilityaccessctrl#requestpermissionsfromuser9" target="_blank">abilityAccessCtrl.requestPermissionsFromUser</a>去校验当前用户是否已授权。如果已授权，应用可以直接访问和修改目标对象；否则需要弹框向用户申请授权。</p>     <p><strong>开发步骤</strong></p>     <ol>      <li>上述权限均为受控开放权限，通常是不允许三方应用申请的。如果有特殊场景需要使用，请提供相关申请材料到应用市场（AGC）申请相应权限证书。申请前请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/restricted-permissions">受限开发权限列表</a>，确保应用符合可申请的场景。然后再参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/declare-permissions-in-acl" target="_blank">申请使用受限权限</a>，完成受限开放权限的申请。</li>     </ol>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>即使用户曾经授予权限，应用在调用受此权限保护的接口前，也应该先检查是否有权限。不能把之前授予的状态持久化，因为用户在动态授予后还可以通过“设置”取消应用的权限。</p>      </div></div></div>    </div>   </div>   <div></div></div>