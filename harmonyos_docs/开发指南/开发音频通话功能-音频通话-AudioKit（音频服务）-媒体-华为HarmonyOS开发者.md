<h1 _ngcontent-kqk-c119="" class="doc-title ng-star-inserted" title="开发音频通话功能"> 开发音频通话功能 </h1>

<div _ngcontent-kqk-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p>在音频通话场景下，音频输出（播放对端声音）和音频输入（录制本端声音）会同时进行，应用可以通过使用AudioRenderer来实现音频输出，通过使用AudioCapturer来实现音频输入，同时使用AudioRenderer和AudioCapturer即可实现音频通话功能。</p>    <p>在音频通话开始和结束时，应用可以自行检查当前的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/audio-call-overview#音频场景模式">音频场景模式</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/audio-call-overview#铃声模式">铃声模式</a>，以便采取合适的音频管理及提示策略。</p>    <p>以下代码示范了同时使用AudioRenderer和AudioCapturer实现音频通话功能的基本过程，其中未包含音频通话数据的传输过程，实际开发中，需要将网络传输来的对端通话数据解码播放，此处仅以读取音频文件的数据代替；同时需要将本端录制的通话数据编码打包，通过网络发送给对端，此处仅以将数据写入音频文件代替。</p>    <div class="tiledSection">     <h2 id="使用audiorenderer播放对端的通话声音">使用AudioRenderer播放对端的通话声音<i class="anchor-icon anchor-icon-link" anchorid="使用audiorenderer播放对端的通话声音" tips="复制节点链接"></i></h2>          <p>该过程与<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/using-audiorenderer-for-playback">使用AudioRenderer开发音频播放功能</a>过程相似，关键区别在于audioRendererInfo参数和音频数据来源。audioRendererInfo参数中，音频流使用类型usage需设置为VoIP通话：STREAM_USAGE_VOICE_COMMUNICATION。</p>     <div _ngcontent-kqk-c106="" class="highlight-div"><div _ngcontent-kqk-c106="" class="highlight-div-header"><div _ngcontent-kqk-c106="" class="highlight-div-header-left"><div _ngcontent-kqk-c106="" class="handle-button expand-button"><div _ngcontent-kqk-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kqk-c106="" class="highlight-div-header-right"><div _ngcontent-kqk-c106="" class="handle-button ai-button"></div><div _ngcontent-kqk-c106="" class="handle-button line-button"><div _ngcontent-kqk-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kqk-c106="" class="handle-button theme-button"><div _ngcontent-kqk-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kqk-c106="" class="handle-button copy-button"><div _ngcontent-kqk-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kqk-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { audio } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AudioKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { fileIo <span class="hljs-keyword">as</span> fs } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.CoreFileKit'</span>;</li><li><span class="hljs-keyword">import</span> { common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-comment">// 与使用AudioRenderer开发音频播放功能过程相似，关键区别在于audioRendererInfo参数和音频数据来源。</span></li><li><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">TAG</span> = <span class="hljs-string">'VoIPDemoForAudioRenderer'</span>;</li><li>
</li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Options</span> {</li><li>  offset?: <span class="hljs-built_in">number</span>;</li><li>  length?: <span class="hljs-built_in">number</span>;</li><li>}</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">bufferSize</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">audioRenderer</span>: audio.<span class="hljs-property">AudioRenderer</span> | <span class="hljs-literal">undefined</span> = <span class="hljs-literal">undefined</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">audioStreamInfo</span>: audio.<span class="hljs-property">AudioStreamInfo</span> = {</li><li>  <span class="hljs-attr">samplingRate</span>: audio.<span class="hljs-property">AudioSamplingRate</span>.<span class="hljs-property">SAMPLE_RATE_48000</span>, <span class="hljs-comment">// 采样率。</span></li><li>  <span class="hljs-attr">channels</span>: audio.<span class="hljs-property">AudioChannel</span>.<span class="hljs-property">CHANNEL_2</span>, <span class="hljs-comment">// 通道。</span></li><li>  <span class="hljs-attr">sampleFormat</span>: audio.<span class="hljs-property">AudioSampleFormat</span>.<span class="hljs-property">SAMPLE_FORMAT_S16LE</span>, <span class="hljs-comment">// 采样格式。</span></li><li>  <span class="hljs-attr">encodingType</span>: audio.<span class="hljs-property">AudioEncodingType</span>.<span class="hljs-property">ENCODING_TYPE_RAW</span> <span class="hljs-comment">// 编码格式。</span></li><li>};</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">audioRendererInfo</span>: audio.<span class="hljs-property">AudioRendererInfo</span> = {</li><li>  <span class="hljs-comment">// 需使用通话场景相应的参数。</span></li><li>  <span class="hljs-attr">usage</span>: audio.<span class="hljs-property">StreamUsage</span>.<span class="hljs-property">STREAM_USAGE_VOICE_COMMUNICATION</span>, <span class="hljs-comment">// 音频流使用类型：VoIP通话。</span></li><li>  <span class="hljs-attr">rendererFlags</span>: <span class="hljs-number">0</span> <span class="hljs-comment">// 音频渲染器标志：默认为0即可。</span></li><li>};</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">audioRendererOptions</span>: audio.<span class="hljs-property">AudioRendererOptions</span> = {</li><li>  <span class="hljs-attr">streamInfo</span>: audioStreamInfo,</li><li>  <span class="hljs-attr">rendererInfo</span>: audioRendererInfo</li><li>};</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">file</span>: fs.<span class="hljs-property">File</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">writeDataCallback</span>: audio.<span class="hljs-property">AudioRendererWriteDataCallback</span>;</li><li>
</li><li><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">initArguments</span>(<span class="hljs-params">context: common.UIAbilityContext</span>) {</li><li>  <span class="hljs-keyword">let</span> path = context.<span class="hljs-property">cacheDir</span>;</li><li>  <span class="hljs-comment">// 此处仅作示例，实际使用时需要将文件替换为应用要播放的PCM文件。</span></li><li>  <span class="hljs-keyword">let</span> filePath = path + <span class="hljs-string">'/StarWars10s-2C-48000-4SW.pcm'</span>;</li><li>  file = fs.<span class="hljs-title function_">openSync</span>(filePath, fs.<span class="hljs-property">OpenMode</span>.<span class="hljs-property">READ_ONLY</span>);</li><li>  writeDataCallback = <span class="hljs-function">(<span class="hljs-params">buffer: <span class="hljs-built_in">ArrayBuffer</span></span>) =&gt;</span> {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">options</span>: <span class="hljs-title class_">Options</span> = {</li><li>      <span class="hljs-attr">offset</span>: bufferSize,</li><li>      <span class="hljs-attr">length</span>: buffer.<span class="hljs-property">byteLength</span></li><li>    };</li><li>
</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-keyword">let</span> bufferLength = fs.<span class="hljs-title function_">readSync</span>(file.<span class="hljs-property">fd</span>, buffer, options);</li><li>      bufferSize += buffer.<span class="hljs-property">byteLength</span>;</li><li>      <span class="hljs-comment">// 如果当前回调传入的数据不足一帧，空白区域需要使用静音数据填充，否则会导致播放出现杂音。</span></li><li>      <span class="hljs-keyword">if</span> (bufferLength &lt; buffer.<span class="hljs-property">byteLength</span>) {</li><li>        <span class="hljs-keyword">let</span> view = <span class="hljs-keyword">new</span> <span class="hljs-title class_">DataView</span>(buffer);</li><li>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = bufferLength; i &lt; buffer.<span class="hljs-property">byteLength</span>; i++) {</li><li>          <span class="hljs-comment">// 空白区域填充静音数据。当使用音频采样格式为SAMPLE_FORMAT_U8时0x7F为静音数据，使用其他采样格式时0为静音数据。</span></li><li>          view.<span class="hljs-title function_">setUint8</span>(i, <span class="hljs-number">0</span>);</li><li>        }</li><li>      }</li><li>      <span class="hljs-comment">// API version 11不支持返回回调结果，从API version 12开始支持返回回调结果。</span></li><li>      <span class="hljs-comment">// 如果开发者不希望播放某段buffer，返回audio.AudioDataCallbackResult.INVALID即可。</span></li><li>      <span class="hljs-keyword">return</span> audio.<span class="hljs-property">AudioDataCallbackResult</span>.<span class="hljs-property">VALID</span>;</li><li>    } <span class="hljs-keyword">catch</span> (error) {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'Error reading file:'</span>, error);</li><li>      <span class="hljs-comment">// API version 11不支持返回回调结果，从API version 12开始支持返回回调结果。</span></li><li>      <span class="hljs-keyword">return</span> audio.<span class="hljs-property">AudioDataCallbackResult</span>.<span class="hljs-property">INVALID</span>;</li><li>    }</li><li>  };</li><li>}</li><li>
</li><li><span class="hljs-comment">// 初始化，创建实例，设置监听事件。</span></li><li><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">init</span>(<span class="hljs-params"></span>) {</li><li>  audio.<span class="hljs-title function_">createAudioRenderer</span>(audioRendererOptions, <span class="hljs-function">(<span class="hljs-params">err, renderer</span>) =&gt;</span> { <span class="hljs-comment">// 创建AudioRenderer实例。</span></li><li>    <span class="hljs-keyword">if</span> (!err) {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`<span class="hljs-subst">${TAG}</span>: creating AudioRenderer success`</span>);</li><li>      audioRenderer = renderer;</li><li>      <span class="hljs-keyword">if</span> (audioRenderer !== <span class="hljs-literal">undefined</span>) {</li><li>        audioRenderer.<span class="hljs-title function_">on</span>(<span class="hljs-string">'writeData'</span>, writeDataCallback);</li><li>      }</li><li>    } <span class="hljs-keyword">else</span> {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`<span class="hljs-subst">${TAG}</span>: creating AudioRenderer failed, error: <span class="hljs-subst">${err.message}</span>`</span>);</li><li>    }</li><li>  });</li><li>}</li><li>
</li><li><span class="hljs-comment">// 开始一次音频渲染。</span></li><li><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">start</span>(<span class="hljs-params"></span>) {</li><li>  <span class="hljs-keyword">if</span> (audioRenderer !== <span class="hljs-literal">undefined</span>) {</li><li>    <span class="hljs-keyword">let</span> stateGroup = [audio.<span class="hljs-property">AudioState</span>.<span class="hljs-property">STATE_PREPARED</span>, audio.<span class="hljs-property">AudioState</span>.<span class="hljs-property">STATE_PAUSED</span>, audio.<span class="hljs-property">AudioState</span>.<span class="hljs-property">STATE_STOPPED</span>];</li><li>    <span class="hljs-keyword">if</span> (stateGroup.<span class="hljs-title function_">indexOf</span>(audioRenderer.<span class="hljs-property">state</span>.<span class="hljs-title function_">valueOf</span>()) === -<span class="hljs-number">1</span>) { <span class="hljs-comment">// 当且仅当状态为prepared、paused和stopped之一时才能启动渲染。</span></li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-variable constant_">TAG</span> + <span class="hljs-string">'start failed'</span>);</li><li>      <span class="hljs-keyword">return</span>;</li><li>    }</li><li>    <span class="hljs-comment">// 启动渲染。</span></li><li>    audioRenderer.<span class="hljs-title function_">start</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>      <span class="hljs-keyword">if</span> (err) {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'Renderer start failed.'</span>);</li><li>      } <span class="hljs-keyword">else</span> {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Renderer start success.'</span>);</li><li>      }</li><li>    });</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-comment">// 暂停渲染。</span></li><li><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">pause</span>(<span class="hljs-params"></span>) {</li><li>  <span class="hljs-keyword">if</span> (audioRenderer !== <span class="hljs-literal">undefined</span>) {</li><li>    <span class="hljs-comment">// 只有渲染器状态为running的时候才能暂停。</span></li><li>    <span class="hljs-keyword">if</span> (audioRenderer.<span class="hljs-property">state</span>.<span class="hljs-title function_">valueOf</span>() !== audio.<span class="hljs-property">AudioState</span>.<span class="hljs-property">STATE_RUNNING</span>) {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Renderer is not running'</span>);</li><li>      <span class="hljs-keyword">return</span>;</li><li>    }</li><li>    <span class="hljs-comment">// 暂停渲染。</span></li><li>    audioRenderer.<span class="hljs-title function_">pause</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>      <span class="hljs-keyword">if</span> (err) {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'Renderer pause failed.'</span>);</li><li>      } <span class="hljs-keyword">else</span> {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Renderer pause success.'</span>);</li><li>      }</li><li>    });</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-comment">// 停止渲染。</span></li><li><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">stop</span>(<span class="hljs-params"></span>) {</li><li>  <span class="hljs-keyword">if</span> (audioRenderer !== <span class="hljs-literal">undefined</span>) {</li><li>    <span class="hljs-comment">// 只有渲染器状态为running或paused的时候才可以停止。</span></li><li>    <span class="hljs-keyword">if</span> (audioRenderer.<span class="hljs-property">state</span>.<span class="hljs-title function_">valueOf</span>() !== audio.<span class="hljs-property">AudioState</span>.<span class="hljs-property">STATE_RUNNING</span> &amp;&amp; audioRenderer.<span class="hljs-property">state</span>.<span class="hljs-title function_">valueOf</span>() !== audio.<span class="hljs-property">AudioState</span>.<span class="hljs-property">STATE_PAUSED</span>) {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Renderer is not running or paused.'</span>);</li><li>      <span class="hljs-keyword">return</span>;</li><li>    }</li><li>    <span class="hljs-comment">// 停止渲染。</span></li><li>    audioRenderer.<span class="hljs-title function_">stop</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>      <span class="hljs-keyword">if</span> (err) {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'Renderer stop failed.'</span>);</li><li>      } <span class="hljs-keyword">else</span> {</li><li>        fs.<span class="hljs-title function_">close</span>(file);</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Renderer stop success.'</span>);</li><li>      }</li><li>    });</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-comment">// 销毁实例，释放资源。</span></li><li><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">release</span>(<span class="hljs-params"></span>) {</li><li>  <span class="hljs-keyword">if</span> (audioRenderer !== <span class="hljs-literal">undefined</span>) {</li><li>    <span class="hljs-comment">// 渲染器状态不是released状态，才能release。</span></li><li>    <span class="hljs-keyword">if</span> (audioRenderer.<span class="hljs-property">state</span>.<span class="hljs-title function_">valueOf</span>() === audio.<span class="hljs-property">AudioState</span>.<span class="hljs-property">STATE_RELEASED</span>) {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Renderer already released'</span>);</li><li>      <span class="hljs-keyword">return</span>;</li><li>    }</li><li>    <span class="hljs-comment">// 释放资源。</span></li><li>    audioRenderer.<span class="hljs-title function_">release</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>      <span class="hljs-keyword">if</span> (err) {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'Renderer release failed.'</span>);</li><li>      } <span class="hljs-keyword">else</span> {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Renderer release success.'</span>);</li><li>      }</li><li>    });</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Scroll</span>() {</li><li>      <span class="hljs-title class_">Column</span>() {</li><li>        <span class="hljs-title class_">Row</span>() {</li><li>          <span class="hljs-title class_">Column</span>() {</li><li>            <span class="hljs-title class_">Text</span>(<span class="hljs-string">'初始化'</span>).<span class="hljs-title function_">fontColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Black</span>).<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">16</span>).<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">12</span> });</li><li>          }</li><li>          .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">White</span>)</li><li>          .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">30</span>)</li><li>          .<span class="hljs-title function_">width</span>(<span class="hljs-string">'45%'</span>)</li><li>          .<span class="hljs-title function_">height</span>(<span class="hljs-string">'25%'</span>)</li><li>          .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">right</span>: <span class="hljs-number">12</span>, <span class="hljs-attr">bottom</span>: <span class="hljs-number">12</span> })</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-keyword">async</span> () =&gt; {</li><li>            <span class="hljs-keyword">let</span> context = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li>            <span class="hljs-title function_">initArguments</span>(context);</li><li>            <span class="hljs-title function_">init</span>();</li><li>          });</li><li>
</li><li>          <span class="hljs-title class_">Column</span>() {</li><li>            <span class="hljs-title class_">Text</span>(<span class="hljs-string">'开始播放'</span>).<span class="hljs-title function_">fontColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Black</span>).<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">16</span>).<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">12</span> });</li><li>          }</li><li>          .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">White</span>)</li><li>          .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">30</span>)</li><li>          .<span class="hljs-title function_">width</span>(<span class="hljs-string">'45%'</span>)</li><li>          .<span class="hljs-title function_">height</span>(<span class="hljs-string">'25%'</span>)</li><li>          .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">bottom</span>: <span class="hljs-number">12</span> })</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-keyword">async</span> () =&gt; {</li><li>            <span class="hljs-title function_">start</span>();</li><li>          });</li><li>        }</li><li>
</li><li>        <span class="hljs-title class_">Row</span>() {</li><li>          <span class="hljs-title class_">Column</span>() {</li><li>            <span class="hljs-title class_">Text</span>(<span class="hljs-string">'暂停播放'</span>).<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">16</span>).<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">12</span> });</li><li>          }</li><li>          .<span class="hljs-title function_">id</span>(<span class="hljs-string">'audio_effect_manager_card'</span>)</li><li>          .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">White</span>)</li><li>          .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">30</span>)</li><li>          .<span class="hljs-title function_">width</span>(<span class="hljs-string">'45%'</span>)</li><li>          .<span class="hljs-title function_">height</span>(<span class="hljs-string">'25%'</span>)</li><li>          .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">right</span>: <span class="hljs-number">12</span>, <span class="hljs-attr">bottom</span>: <span class="hljs-number">12</span> })</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-keyword">async</span> () =&gt; {</li><li>            <span class="hljs-title function_">pause</span>();</li><li>          });</li><li>
</li><li>          <span class="hljs-title class_">Column</span>() {</li><li>            <span class="hljs-title class_">Text</span>(<span class="hljs-string">'停止播放'</span>).<span class="hljs-title function_">fontColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Black</span>).<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">16</span>).<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">12</span> });</li><li>          }</li><li>          .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">White</span>)</li><li>          .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">30</span>)</li><li>          .<span class="hljs-title function_">width</span>(<span class="hljs-string">'45%'</span>)</li><li>          .<span class="hljs-title function_">height</span>(<span class="hljs-string">'25%'</span>)</li><li>          .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">bottom</span>: <span class="hljs-number">12</span> })</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-keyword">async</span> () =&gt; {</li><li>            <span class="hljs-title function_">stop</span>();</li><li>          });</li><li>        }</li><li>
</li><li>        <span class="hljs-title class_">Row</span>() {</li><li>          <span class="hljs-title class_">Column</span>() {</li><li>            <span class="hljs-title class_">Text</span>(<span class="hljs-string">'释放资源'</span>).<span class="hljs-title function_">fontColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Black</span>).<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">16</span>).<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">12</span> });</li><li>          }</li><li>          .<span class="hljs-title function_">id</span>(<span class="hljs-string">'audio_volume_card'</span>)</li><li>          .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">White</span>)</li><li>          .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">30</span>)</li><li>          .<span class="hljs-title function_">width</span>(<span class="hljs-string">'45%'</span>)</li><li>          .<span class="hljs-title function_">height</span>(<span class="hljs-string">'25%'</span>)</li><li>          .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">right</span>: <span class="hljs-number">12</span>, <span class="hljs-attr">bottom</span>: <span class="hljs-number">12</span> })</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-keyword">async</span> () =&gt; {</li><li>            <span class="hljs-title function_">release</span>();</li><li>          });</li><li>        }</li><li>        .<span class="hljs-title function_">padding</span>(<span class="hljs-number">12</span>)</li><li>      }</li><li>      .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>      .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">'#F1F3F5'</span>);</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="使用audiocapturer录制本端的通话声音">使用AudioCapturer录制本端的通话声音<i class="anchor-icon anchor-icon-link" anchorid="使用audiocapturer录制本端的通话声音" tips="复制节点链接"></i></h2>          <p>该过程与<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/using-audiocapturer-for-recording">使用AudioCapturer开发音频录制功能</a>过程相似，关键区别在于audioCapturerInfo参数和音频数据流向。audioCapturerInfo参数中音源类型source需设置为语音通话：SOURCE_TYPE_VOICE_COMMUNICATION。</p>     <p>所有录制均需要申请麦克风权限：ohos.permission.MICROPHONE，申请方式请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/request-user-authorization">向用户申请授权</a>。</p>     <div _ngcontent-kqk-c106="" class="highlight-div"><div _ngcontent-kqk-c106="" class="highlight-div-header"><div _ngcontent-kqk-c106="" class="highlight-div-header-left"><div _ngcontent-kqk-c106="" class="handle-button expand-button"><div _ngcontent-kqk-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kqk-c106="" class="highlight-div-header-right"><div _ngcontent-kqk-c106="" class="handle-button ai-button"></div><div _ngcontent-kqk-c106="" class="handle-button line-button"><div _ngcontent-kqk-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kqk-c106="" class="handle-button theme-button"><div _ngcontent-kqk-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kqk-c106="" class="handle-button copy-button"><div _ngcontent-kqk-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kqk-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { audio } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AudioKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { fileIo <span class="hljs-keyword">as</span> fs } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.CoreFileKit'</span>;</li><li><span class="hljs-keyword">import</span> { common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-comment">// 与使用AudioCapturer开发音频录制功能过程相似，关键区别在于audioCapturerInfo参数和音频数据流向。</span></li><li><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">TAG</span> = <span class="hljs-string">'VoIPDemoForAudioCapturer'</span>;</li><li>
</li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Options</span> {</li><li>  offset?: <span class="hljs-built_in">number</span>;</li><li>  length?: <span class="hljs-built_in">number</span>;</li><li>}</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">bufferSize</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">audioCapturer</span>: audio.<span class="hljs-property">AudioCapturer</span> | <span class="hljs-literal">undefined</span> = <span class="hljs-literal">undefined</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">audioStreamInfo</span>: audio.<span class="hljs-property">AudioStreamInfo</span> = {</li><li>  <span class="hljs-attr">samplingRate</span>: audio.<span class="hljs-property">AudioSamplingRate</span>.<span class="hljs-property">SAMPLE_RATE_48000</span>, <span class="hljs-comment">// 采样率。</span></li><li>  <span class="hljs-attr">channels</span>: audio.<span class="hljs-property">AudioChannel</span>.<span class="hljs-property">CHANNEL_2</span>, <span class="hljs-comment">// 通道。</span></li><li>  <span class="hljs-attr">sampleFormat</span>: audio.<span class="hljs-property">AudioSampleFormat</span>.<span class="hljs-property">SAMPLE_FORMAT_S16LE</span>, <span class="hljs-comment">// 采样格式。</span></li><li>  <span class="hljs-attr">encodingType</span>: audio.<span class="hljs-property">AudioEncodingType</span>.<span class="hljs-property">ENCODING_TYPE_RAW</span> <span class="hljs-comment">// 编码格式。</span></li><li>};</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">audioCapturerInfo</span>: audio.<span class="hljs-property">AudioCapturerInfo</span> = {</li><li>  <span class="hljs-comment">// 需使用通话场景相应的参数。</span></li><li>  <span class="hljs-attr">source</span>: audio.<span class="hljs-property">SourceType</span>.<span class="hljs-property">SOURCE_TYPE_VOICE_COMMUNICATION</span>, <span class="hljs-comment">// 音源类型：语音通话。</span></li><li>  <span class="hljs-attr">capturerFlags</span>: <span class="hljs-number">0</span> <span class="hljs-comment">// 音频采集器标志：默认为0即可。</span></li><li>};</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">audioCapturerOptions</span>: audio.<span class="hljs-property">AudioCapturerOptions</span> = {</li><li>  <span class="hljs-attr">streamInfo</span>: audioStreamInfo,</li><li>  <span class="hljs-attr">capturerInfo</span>: audioCapturerInfo</li><li>};</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">file</span>: fs.<span class="hljs-property">File</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">readDataCallback</span>: <span class="hljs-title class_">Callback</span>&lt;<span class="hljs-title class_">ArrayBuffer</span>&gt;;</li><li>
</li><li><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">initArguments</span>(<span class="hljs-params">context: common.UIAbilityContext</span>) {</li><li>  <span class="hljs-keyword">let</span> path = context.<span class="hljs-property">cacheDir</span>;</li><li>  <span class="hljs-keyword">let</span> filePath = path + <span class="hljs-string">'/StarWars10s-2C-48000-4SW.pcm'</span>;</li><li>  file = fs.<span class="hljs-title function_">openSync</span>(filePath, fs.<span class="hljs-property">OpenMode</span>.<span class="hljs-property">READ_WRITE</span> | fs.<span class="hljs-property">OpenMode</span>.<span class="hljs-property">CREATE</span>);</li><li>  readDataCallback = <span class="hljs-function">(<span class="hljs-params">buffer: <span class="hljs-built_in">ArrayBuffer</span></span>) =&gt;</span> {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">options</span>: <span class="hljs-title class_">Options</span> = {</li><li>      <span class="hljs-attr">offset</span>: bufferSize,</li><li>      <span class="hljs-attr">length</span>: buffer.<span class="hljs-property">byteLength</span></li><li>    }</li><li>    fs.<span class="hljs-title function_">writeSync</span>(file.<span class="hljs-property">fd</span>, buffer, options);</li><li>    bufferSize += buffer.<span class="hljs-property">byteLength</span>;</li><li>  };</li><li>}</li><li>
</li><li><span class="hljs-comment">// 初始化，创建实例，设置监听事件。</span></li><li><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">init</span>(<span class="hljs-params"></span>) {</li><li>  audio.<span class="hljs-title function_">createAudioCapturer</span>(audioCapturerOptions, <span class="hljs-function">(<span class="hljs-params">err, capturer</span>) =&gt;</span> { <span class="hljs-comment">// 创建AudioCapturer实例。</span></li><li>    <span class="hljs-keyword">if</span> (err) {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Invoke createAudioCapturer failed, code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>      <span class="hljs-keyword">return</span>;</li><li>    }</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`<span class="hljs-subst">${TAG}</span>: create AudioCapturer success`</span>);</li><li>    audioCapturer = capturer;</li><li>    <span class="hljs-keyword">if</span> (audioCapturer !== <span class="hljs-literal">undefined</span>) {</li><li>      audioCapturer.<span class="hljs-title function_">on</span>(<span class="hljs-string">'readData'</span>, readDataCallback);</li><li>    }</li><li>  });</li><li>}</li><li>
</li><li><span class="hljs-comment">// 开始一次音频采集。</span></li><li><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">start</span>(<span class="hljs-params"></span>) {</li><li>  <span class="hljs-keyword">if</span> (audioCapturer !== <span class="hljs-literal">undefined</span>) {</li><li>    <span class="hljs-keyword">let</span> stateGroup = [audio.<span class="hljs-property">AudioState</span>.<span class="hljs-property">STATE_PREPARED</span>, audio.<span class="hljs-property">AudioState</span>.<span class="hljs-property">STATE_PAUSED</span>, audio.<span class="hljs-property">AudioState</span>.<span class="hljs-property">STATE_STOPPED</span>];</li><li>    <span class="hljs-keyword">if</span> (stateGroup.<span class="hljs-title function_">indexOf</span>(audioCapturer.<span class="hljs-property">state</span>.<span class="hljs-title function_">valueOf</span>()) === -<span class="hljs-number">1</span>) { <span class="hljs-comment">// 当且仅当状态为STATE_PREPARED、STATE_PAUSED和STATE_STOPPED之一时才能启动采集。</span></li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`<span class="hljs-subst">${TAG}</span>: start failed`</span>);</li><li>      <span class="hljs-keyword">return</span>;</li><li>    }</li><li>
</li><li>    <span class="hljs-comment">// 启动采集。</span></li><li>    audioCapturer.<span class="hljs-title function_">start</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>      <span class="hljs-keyword">if</span> (err) {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'Capturer start failed.'</span>);</li><li>      } <span class="hljs-keyword">else</span> {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Capturer start success.'</span>);</li><li>      }</li><li>    });</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-comment">// 停止采集。</span></li><li><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">stop</span>(<span class="hljs-params"></span>) {</li><li>  <span class="hljs-keyword">if</span> (audioCapturer !== <span class="hljs-literal">undefined</span>) {</li><li>    <span class="hljs-comment">// 只有采集器状态为STATE_RUNNING或STATE_PAUSED的时候才可以停止。</span></li><li>    <span class="hljs-keyword">if</span> (audioCapturer.<span class="hljs-property">state</span>.<span class="hljs-title function_">valueOf</span>() !== audio.<span class="hljs-property">AudioState</span>.<span class="hljs-property">STATE_RUNNING</span> &amp;&amp; audioCapturer.<span class="hljs-property">state</span>.<span class="hljs-title function_">valueOf</span>() !== audio.<span class="hljs-property">AudioState</span>.<span class="hljs-property">STATE_PAUSED</span>) {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Capturer is not running or paused'</span>);</li><li>      <span class="hljs-keyword">return</span>;</li><li>    }</li><li>
</li><li>    <span class="hljs-comment">// 停止采集。</span></li><li>    audioCapturer.<span class="hljs-title function_">stop</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>      <span class="hljs-keyword">if</span> (err) {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'Capturer stop failed.'</span>);</li><li>      } <span class="hljs-keyword">else</span> {</li><li>        fs.<span class="hljs-title function_">close</span>(file);</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Capturer stop success.'</span>);</li><li>      }</li><li>    });</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-comment">// 销毁实例，释放资源。</span></li><li><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">release</span>(<span class="hljs-params"></span>) {</li><li>  <span class="hljs-keyword">if</span> (audioCapturer !== <span class="hljs-literal">undefined</span>) {</li><li>    <span class="hljs-comment">// 采集器状态不是STATE_RELEASED或STATE_NEW状态，才能release。</span></li><li>    <span class="hljs-keyword">if</span> (audioCapturer.<span class="hljs-property">state</span>.<span class="hljs-title function_">valueOf</span>() === audio.<span class="hljs-property">AudioState</span>.<span class="hljs-property">STATE_RELEASED</span> || audioCapturer.<span class="hljs-property">state</span>.<span class="hljs-title function_">valueOf</span>() === audio.<span class="hljs-property">AudioState</span>.<span class="hljs-property">STATE_NEW</span>) {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Capturer already released'</span>);</li><li>      <span class="hljs-keyword">return</span>;</li><li>    }</li><li>
</li><li>    <span class="hljs-comment">// 释放资源。</span></li><li>    audioCapturer.<span class="hljs-title function_">release</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>      <span class="hljs-keyword">if</span> (err) {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'Capturer release failed.'</span>);</li><li>      } <span class="hljs-keyword">else</span> {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Capturer release success.'</span>);</li><li>      }</li><li>    });</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Scroll</span>() {</li><li>      <span class="hljs-title class_">Column</span>() {</li><li>        <span class="hljs-title class_">Row</span>() {</li><li>          <span class="hljs-title class_">Column</span>() {</li><li>            <span class="hljs-title class_">Text</span>(<span class="hljs-string">'初始化'</span>).<span class="hljs-title function_">fontColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Black</span>).<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">16</span>).<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">12</span> });</li><li>          }</li><li>          .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">White</span>)</li><li>          .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">30</span>)</li><li>          .<span class="hljs-title function_">width</span>(<span class="hljs-string">'45%'</span>)</li><li>          .<span class="hljs-title function_">height</span>(<span class="hljs-string">'25%'</span>)</li><li>          .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">right</span>: <span class="hljs-number">12</span>, <span class="hljs-attr">bottom</span>: <span class="hljs-number">12</span> })</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-keyword">async</span> () =&gt; {</li><li>            <span class="hljs-keyword">let</span> context = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li>            <span class="hljs-title function_">initArguments</span>(context);</li><li>            <span class="hljs-title function_">init</span>();</li><li>          });</li><li>
</li><li>          <span class="hljs-title class_">Column</span>() {</li><li>            <span class="hljs-title class_">Text</span>(<span class="hljs-string">'开始录制'</span>).<span class="hljs-title function_">fontColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Black</span>).<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">16</span>).<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">12</span> });</li><li>          }</li><li>          .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">White</span>)</li><li>          .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">30</span>)</li><li>          .<span class="hljs-title function_">width</span>(<span class="hljs-string">'45%'</span>)</li><li>          .<span class="hljs-title function_">height</span>(<span class="hljs-string">'25%'</span>)</li><li>          .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">bottom</span>: <span class="hljs-number">12</span> })</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-keyword">async</span> () =&gt; {</li><li>            <span class="hljs-title function_">start</span>();</li><li>          });</li><li>        }</li><li>
</li><li>        <span class="hljs-title class_">Row</span>() {</li><li>          <span class="hljs-title class_">Column</span>() {</li><li>            <span class="hljs-title class_">Text</span>(<span class="hljs-string">'停止录制'</span>).<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">16</span>).<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">12</span> });</li><li>          }</li><li>          .<span class="hljs-title function_">id</span>(<span class="hljs-string">'audio_effect_manager_card'</span>)</li><li>          .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">White</span>)</li><li>          .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">30</span>)</li><li>          .<span class="hljs-title function_">width</span>(<span class="hljs-string">'45%'</span>)</li><li>          .<span class="hljs-title function_">height</span>(<span class="hljs-string">'25%'</span>)</li><li>          .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">right</span>: <span class="hljs-number">12</span>, <span class="hljs-attr">bottom</span>: <span class="hljs-number">12</span> })</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-keyword">async</span> () =&gt; {</li><li>            <span class="hljs-title function_">stop</span>();</li><li>          });</li><li>
</li><li>          <span class="hljs-title class_">Column</span>() {</li><li>            <span class="hljs-title class_">Text</span>(<span class="hljs-string">'释放资源'</span>).<span class="hljs-title function_">fontColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Black</span>).<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">16</span>).<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">12</span> });</li><li>          }</li><li>          .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">White</span>)</li><li>          .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">30</span>)</li><li>          .<span class="hljs-title function_">width</span>(<span class="hljs-string">'45%'</span>)</li><li>          .<span class="hljs-title function_">height</span>(<span class="hljs-string">'25%'</span>)</li><li>          .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">bottom</span>: <span class="hljs-number">12</span> })</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-keyword">async</span> () =&gt; {</li><li>            <span class="hljs-title function_">release</span>();</li><li>          });</li><li>        }</li><li>        .<span class="hljs-title function_">padding</span>(<span class="hljs-number">12</span>)</li><li>      }</li><li>      .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>      .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">'#F1F3F5'</span>);</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>   </div>   <div></div></div>