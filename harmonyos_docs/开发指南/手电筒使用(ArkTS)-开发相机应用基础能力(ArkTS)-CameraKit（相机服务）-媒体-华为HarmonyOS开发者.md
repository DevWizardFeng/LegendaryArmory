<h1 _ngcontent-gdy-c119="" class="doc-title ng-star-inserted" title="手电筒使用(ArkTS)"> 手电筒使用(ArkTS) </h1>

<div _ngcontent-gdy-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p>通过操作设备启用手电筒功能，可使设备的手电筒保持常亮状态。</p>    <p>在使用相机应用并操作手电筒功能时，存在以下几种情况说明：</p>    <ul>     <li>当使用后置相机并设置闪光灯模式<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-camera-e#flashmode" target="_blank">FlashMode</a>关闭时，手电筒功能无法启用。</li>     <li>当使用前置相机时，手电筒可以正常启用并保持常亮状态。</li>     <li>从前置相机切换至后置相机时，如果手电筒原本处于开启状态，它将会被自动关闭。</li>    </ul>    <div class="tiledSection">     <h2 id="开发步骤">开发步骤<i class="anchor-icon anchor-icon-link" anchorid="开发步骤" tips="复制节点链接"></i></h2>          <p>详细的API说明请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-camera" target="_blank">Camera API参考</a>。</p>     <ol>      <li>       <p>导入camera接口，接口中提供了相机相关的属性和方法，导入方法如下。</p>       <div _ngcontent-gdy-c106="" class="highlight-div"><div _ngcontent-gdy-c106="" class="highlight-div-header"><div _ngcontent-gdy-c106="" class="highlight-div-header-left"><div _ngcontent-gdy-c106="" class="handle-button expand-button"><div _ngcontent-gdy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gdy-c106="" class="highlight-div-header-right"><div _ngcontent-gdy-c106="" class="handle-button ai-button"></div><div _ngcontent-gdy-c106="" class="handle-button line-button"><div _ngcontent-gdy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gdy-c106="" class="handle-button theme-button"><div _ngcontent-gdy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gdy-c106="" class="handle-button copy-button"><div _ngcontent-gdy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gdy-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { camera } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.CameraKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li></ol></pre></div></div></li>      <li>       <p>通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-camera-cameramanager" target="_blank">CameraManager</a>中的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-camera-cameramanager#istorchsupported11" target="_blank">isTorchSupported</a>方法，检测当前设备是否支持手电筒功能。</p>       <div _ngcontent-gdy-c106="" class="highlight-div"><div _ngcontent-gdy-c106="" class="highlight-div-header"><div _ngcontent-gdy-c106="" class="highlight-div-header-left"><div _ngcontent-gdy-c106="" class="handle-button expand-button"><div _ngcontent-gdy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gdy-c106="" class="highlight-div-header-right"><div _ngcontent-gdy-c106="" class="handle-button ai-button"></div><div _ngcontent-gdy-c106="" class="handle-button line-button"><div _ngcontent-gdy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gdy-c106="" class="handle-button theme-button"><div _ngcontent-gdy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gdy-c106="" class="handle-button copy-button"><div _ngcontent-gdy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gdy-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">isTorchSupported</span>(<span class="hljs-params">cameraManager: camera.CameraManager</span>) : <span class="hljs-built_in">boolean</span> {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">torchSupport</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">false</span>;</li><li>  <span class="hljs-keyword">try</span> {</li><li>    torchSupport = cameraManager.<span class="hljs-title function_">isTorchSupported</span>();</li><li>  } <span class="hljs-keyword">catch</span> (error) {</li><li>    <span class="hljs-keyword">let</span> err = error <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>;</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'Failed to torch. errorCode = '</span> + err.<span class="hljs-property">code</span>);</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Returned with the torch support status:'</span> + torchSupport);</li><li>  <span class="hljs-keyword">return</span> torchSupport;</li><li>}</li></ol></pre></div></div></li>      <li>       <p>通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-camera-cameramanager" target="_blank">CameraManager</a>中的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-camera-cameramanager#istorchmodesupported11" target="_blank">isTorchModeSupported</a>方法，检测是否支持指定的手电筒模式<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-camera-e#torchmode11" target="_blank">TorchMode</a>。</p>       <div _ngcontent-gdy-c106="" class="highlight-div"><div _ngcontent-gdy-c106="" class="highlight-div-header"><div _ngcontent-gdy-c106="" class="highlight-div-header-left"><div _ngcontent-gdy-c106="" class="handle-button expand-button"><div _ngcontent-gdy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gdy-c106="" class="highlight-div-header-right"><div _ngcontent-gdy-c106="" class="handle-button ai-button"></div><div _ngcontent-gdy-c106="" class="handle-button line-button"><div _ngcontent-gdy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gdy-c106="" class="handle-button theme-button"><div _ngcontent-gdy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gdy-c106="" class="handle-button copy-button"><div _ngcontent-gdy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gdy-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">isTorchModeSupported</span>(<span class="hljs-params">cameraManager: camera.CameraManager, torchMode: camera.TorchMode</span>) : <span class="hljs-built_in">boolean</span> {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">isTorchModeSupport</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">false</span>;</li><li>  <span class="hljs-keyword">try</span> {</li><li>    isTorchModeSupport = cameraManager.<span class="hljs-title function_">isTorchModeSupported</span>(torchMode);</li><li>  } <span class="hljs-keyword">catch</span> (error) {</li><li>    <span class="hljs-keyword">let</span> err = error <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>;</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'Failed to set the torch mode. errorCode = '</span> + err.<span class="hljs-property">code</span>);</li><li>  }</li><li>  <span class="hljs-keyword">return</span> isTorchModeSupport;</li><li>}</li></ol></pre></div></div></li>      <li>       <p>通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-camera-cameramanager" target="_blank">CameraManager</a>中的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-camera-cameramanager#settorchmode11" target="_blank">setTorchMode</a>方法，设置当前设备的手电筒模式。以及通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-camera-cameramanager" target="_blank">CameraManager</a>中的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-camera-cameramanager#gettorchmode11" target="_blank">getTorchMode</a>方法，获取当前设备的手电筒模式。</p>       <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">         <p>在使用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-camera-cameramanager#gettorchmode11" target="_blank">getTorchMode</a>方法前，需要先注册监听手电筒的状态变化，请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/camera-torch-use#状态监听">状态监听</a>。</p>        </div></div></div>       <div _ngcontent-gdy-c106="" class="highlight-div"><div _ngcontent-gdy-c106="" class="highlight-div-header"><div _ngcontent-gdy-c106="" class="highlight-div-header-left"><div _ngcontent-gdy-c106="" class="handle-button expand-button"><div _ngcontent-gdy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gdy-c106="" class="highlight-div-header-right"><div _ngcontent-gdy-c106="" class="handle-button ai-button"></div><div _ngcontent-gdy-c106="" class="handle-button line-button"><div _ngcontent-gdy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gdy-c106="" class="handle-button theme-button"><div _ngcontent-gdy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gdy-c106="" class="handle-button copy-button"><div _ngcontent-gdy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gdy-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">setTorchModeSupported</span>(<span class="hljs-params">cameraManager: camera.CameraManager, torchMode: camera.TorchMode</span>) : <span class="hljs-built_in">void</span> {</li><li>  cameraManager.<span class="hljs-title function_">setTorchMode</span>(torchMode);</li><li>  <span class="hljs-keyword">let</span> isTorchMode = cameraManager.<span class="hljs-title function_">getTorchMode</span>();</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`Returned with the torch mode supportd mode: <span class="hljs-subst">${isTorchMode}</span>`</span>);</li><li>}</li></ol></pre></div></div></li>     </ol>    </div>    <div class="tiledSection">     <h2 id="状态监听">状态监听<i class="anchor-icon anchor-icon-link" anchorid="状态监听" tips="复制节点链接"></i></h2>          <p>在相机应用开发过程中，可以随时监听手电筒状态，包括手电筒打开、手电筒关闭、手电筒不可用、手电筒恢复可用。手电筒状态发生变化，可通过回调函数获取状态的变化。</p>     <p>注册torchStatusChange事件后，回调会返回监听结果，callback返回TorchStatusInfo参数，参数的具体内容可参考相机管理器回调接口实例<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-camera-i#torchstatusinfo11" target="_blank">TorchStatusInfo</a>。</p>     <div _ngcontent-gdy-c106="" class="highlight-div"><div _ngcontent-gdy-c106="" class="highlight-div-header"><div _ngcontent-gdy-c106="" class="highlight-div-header-left"><div _ngcontent-gdy-c106="" class="handle-button expand-button"><div _ngcontent-gdy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gdy-c106="" class="highlight-div-header-right"><div _ngcontent-gdy-c106="" class="handle-button ai-button"></div><div _ngcontent-gdy-c106="" class="handle-button line-button"><div _ngcontent-gdy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gdy-c106="" class="handle-button theme-button"><div _ngcontent-gdy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gdy-c106="" class="handle-button copy-button"><div _ngcontent-gdy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gdy-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">onTorchStatusChange</span>(<span class="hljs-params">cameraManager: camera.CameraManager</span>): <span class="hljs-built_in">void</span> {</li><li>  cameraManager.<span class="hljs-title function_">on</span>(<span class="hljs-string">'torchStatusChange'</span>, <span class="hljs-function">(<span class="hljs-params">err: BusinessError, torchStatusInfo: camera.TorchStatusInfo</span>) =&gt;</span> {</li><li>    <span class="hljs-keyword">if</span> (err !== <span class="hljs-literal">undefined</span> &amp;&amp; err.<span class="hljs-property">code</span> !== <span class="hljs-number">0</span>) {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Callback Error, errorCode: <span class="hljs-subst">${err.code}</span>`</span>);</li><li>      <span class="hljs-keyword">return</span>;</li><li>    }</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`onTorchStatusChange, isTorchAvailable: <span class="hljs-subst">${torchStatusInfo.isTorchAvailable}</span>, isTorchActive: <span class="hljs-subst">${torchStatusInfo.</span></span></li><li><span class="hljs-string">      isTorchActive}</span>, level: <span class="hljs-subst">${torchStatusInfo.torchLevel}</span>`);</li><li>  });</li><li>}</li></ol></pre></div></div>    </div>   </div>   <div></div></div>