<h1 _ngcontent-pqe-c119="" class="doc-title ng-star-inserted" title="拉起文件处理类应用（startAbility）"> 拉起文件处理类应用（startAbility） </h1>

<div _ngcontent-pqe-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <div class="tiledSection">     <h2 id="使用场景">使用场景<i class="anchor-icon anchor-icon-link" anchorid="使用场景" tips="复制节点链接"></i></h2>          <p>开发者可以通过调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext#startability" target="_blank">startAbility</a>接口，由系统从已安装的应用中寻找符合要求的应用，打开特定文件。</p>     <p>例如，浏览器下应用下载PDF文件，可以调用此接口选择文件处理应用打开此PDF文件。开发者需要在请求中设置待打开文件的URI路径（<a href="/consumer/cn/doc/harmonyos-guides/file-processing-apps-startup#接口关键参数说明">uri</a>）、文件格式（<a href="/consumer/cn/doc/harmonyos-guides/file-processing-apps-startup#接口关键参数说明">type</a>）等字段，以便系统能够识别，直接拉起文件打开应用或弹出一个选择框，让用户选择合适的应用来打开文件，效果示意如下图所示。</p>     <p>图1 效果示意图</p>     <p><span><img originheight="640" originwidth="290" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114948.31862003737475195045851070360363:50001231000000:2800:8AF664F924F5850C62E617F9D975BB649C5C4533B4958131BFF2BC3B4461720E.jpeg" class="notEnlarge" width="290" height="640"></span></p>    </div>    <div class="tiledSection">     <h2 id="接口关键参数说明">接口关键参数说明<i class="anchor-icon anchor-icon-link" anchorid="接口关键参数说明" tips="复制节点链接"></i></h2>          <p>开发者通过调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext#startability" target="_blank">startAbility</a>接口即可实现由已安装的垂域应用来打开文件。</p>     <p>表1 startAbility请求中<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-want" target="_blank">want</a>相关参数说明</p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.2.4.1.5.1.1" valign="top" width="25%">参数名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.2.4.1.5.1.2" valign="top" width="25%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.2.4.1.5.1.3" valign="top" width="25%">是否必填</th>         <th align="left" class="cellrowborder" id="mcps1.3.2.4.1.5.1.4" valign="top" width="25%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="25%">uri</td>         <td class="cellrowborder" valign="top" width="25%">string</td>         <td class="cellrowborder" valign="top" width="25%">是</td>         <td class="cellrowborder" valign="top" width="25%">          <p>表示待打开文件的URI路径，一般配合type使用。</p>          <p>uri格式为：file://bundleName/path</p>          <p>- file：文件URI的标志。</p>          <p>- bundleName：该文件资源的属主。</p>          <p>- path：文件资源在应用沙箱中的路径。</p></td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="25%">type</td>         <td class="cellrowborder" valign="top" width="25%">string</td>         <td class="cellrowborder" valign="top" width="25%">否</td>         <td class="cellrowborder" valign="top" width="25%">          <p>表示打开文件的类型，推荐使用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/uniform-data-type-descriptors">UTD类型</a>，比如：'general.plain-text'、'general.image'。目前也可以兼容使用<a href="https://www.iana.org/assignments/media-types/media-types.xhtml?utm_source=ld246.com" target="_blank">MIME type类型</a>，如：'text/xml' 、 'image/*'等。</p>          <p><strong>说明：</strong></p>          <p>1. type为可选字段，如果不传type，系统会尝试根据uri后缀名判断文件类型进行匹配；如果传入type，必须确保与uri的文件类型一致，否则会导致无法匹配到合适的应用。文件后缀与文件类型的映射关系参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/uniform-data-type-list">Uniform Type Descriptor(UTD)预置列表</a>。</p>          <p>2. 不支持传*/*。</p></td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="25%">parameters</td>         <td class="cellrowborder" valign="top" width="25%">Record&lt;string, Object&gt;</td>         <td class="cellrowborder" valign="top" width="25%">否</td>         <td class="cellrowborder" valign="top" width="25%">表示由系统定义，由开发者按需赋值的自定义参数，文件打开场景请参考表2。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="25%">flags</td>         <td class="cellrowborder" valign="top" width="25%">number</td>         <td class="cellrowborder" valign="top" width="25%">否</td>         <td class="cellrowborder" valign="top" width="25%">表示处理方式，文件打开场景请参考表3。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="25%">action</td>         <td class="cellrowborder" valign="top" width="25%">string</td>         <td class="cellrowborder" valign="top" width="25%">是</td>         <td class="cellrowborder" valign="top" width="25%">表示要执行的通用操作。文件打开场景固定值：'ohos.want.action.viewData' ，表示查看数据的操作。</td>        </tr>             </tbody></table></div>     </div>     <p><strong>表2</strong> <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-wantconstant#params" target="_blank">parameters</a>相关参数说明</p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.2.6.1.4.1.1" valign="top" width="33.33333333333333%">参数名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.2.6.1.4.1.2" valign="top" width="33.33333333333333%">类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.2.6.1.4.1.3" valign="top" width="33.33333333333333%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">ability.params.stream</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">string</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">指示携带的文件URI要授权给目标方，用于待打开的文件存在其他文件依赖的场景。例如打开本地html文件依赖本地其余资源文件的场景等。对应的value必须是string类型的文件URI数组。文件URI的获取参考表1中uri参数。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">ohos.ability.params.showDefaultPicker</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">boolean</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">          <p>表示是否强制展示文件打开方式的选择弹框，缺省为false。</p>          <p>- false：表示由系统策略或默认应用设置决定直接拉起文件打开应用还是展示弹框。</p>          <p>- true：表示始终展示弹框。</p></td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">showCaller</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">boolean</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">          <p>表示调用方本身是否作为目标方应用之一参与匹配，缺省为false。</p>          <p>- false：不参与匹配。</p>          <p>- true：参与匹配。</p></td>        </tr>             </tbody></table></div>     </div>     <p><strong>表3</strong> <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-wantconstant#flags" target="_blank">flags</a>相关参数说明</p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.2.8.1.4.1.1" valign="top" width="33.33333333333333%">参数名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.2.8.1.4.1.2" valign="top" width="33.33333333333333%">值</th>         <th align="left" class="cellrowborder" id="mcps1.3.2.8.1.4.1.3" valign="top" width="33.33333333333333%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">FLAG_AUTH_READ_URI_PERMISSION</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">0x00000001</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">指对URI执行读取操作的授权。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">FLAG_AUTH_WRITE_URI_PERMISSION</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">0x00000002</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">指对URI执行写入操作的授权。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="接入步骤">接入步骤<i class="anchor-icon anchor-icon-link" anchorid="接入步骤" tips="复制节点链接"></i></h2>         </div>    <div class="tiledSection">     <h3 id="调用方接入步骤" class="firsth2">调用方接入步骤<i class="anchor-icon anchor-icon-link" anchorid="调用方接入步骤" tips="复制节点链接"></i></h3>          <ol>      <li>       <p>导入相关模块。</p>       <div _ngcontent-pqe-c106="" class="highlight-div"><div _ngcontent-pqe-c106="" class="highlight-div-header"><div _ngcontent-pqe-c106="" class="highlight-div-header-left"><div _ngcontent-pqe-c106="" class="handle-button expand-button"><div _ngcontent-pqe-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pqe-c106="" class="highlight-div-header-right"><div _ngcontent-pqe-c106="" class="handle-button ai-button"></div><div _ngcontent-pqe-c106="" class="handle-button line-button"><div _ngcontent-pqe-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pqe-c106="" class="handle-button theme-button"><div _ngcontent-pqe-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pqe-c106="" class="handle-button copy-button"><div _ngcontent-pqe-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pqe-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// xxx.ets</span></li><li><span class="hljs-keyword">import</span> { fileUri } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.CoreFileKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIAbility</span>, <span class="hljs-title class_">Want</span>, common, wantConstant } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-variable language_">window</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span>;</li></ol></pre></div></div></li>      <li>       <p>获取<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/application-context-stage#获取应用文件路径">应用文件路径</a>。</p>       <div _ngcontent-pqe-c106="" class="highlight-div"><div _ngcontent-pqe-c106="" class="highlight-div-header"><div _ngcontent-pqe-c106="" class="highlight-div-header-left"><div _ngcontent-pqe-c106="" class="handle-button expand-button"><div _ngcontent-pqe-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pqe-c106="" class="highlight-div-header-right"><div _ngcontent-pqe-c106="" class="handle-button ai-button"></div><div _ngcontent-pqe-c106="" class="handle-button line-button"><div _ngcontent-pqe-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pqe-c106="" class="handle-button theme-button"><div _ngcontent-pqe-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pqe-c106="" class="handle-button copy-button"><div _ngcontent-pqe-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pqe-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// xxx.ets</span></li><li><span class="hljs-comment">// 假设应用bundleName值为com.example.demo</span></li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>    <span class="hljs-title function_">onWindowStageCreate</span>(<span class="hljs-params">windowStage: <span class="hljs-variable language_">window</span>.WindowStage</span>) {</li><li>        <span class="hljs-comment">// 获取文件沙箱路径</span></li><li>        <span class="hljs-keyword">let</span> filePath = <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-property">filesDir</span> + <span class="hljs-string">'/test1.txt'</span>;</li><li>        <span class="hljs-comment">// 将沙箱路径转换为uri</span></li><li>        <span class="hljs-keyword">let</span> uri = fileUri.<span class="hljs-title function_">getUriFromPath</span>(filePath);</li><li>        <span class="hljs-comment">// 获取的uri为"file://com.example.demo/data/storage/el2/base/files/test.txt"</span></li><li>    }</li><li>    <span class="hljs-comment">// ...</span></li><li>}</li></ol></pre></div></div></li>      <li>       <p>构造请求数据。</p>       <div _ngcontent-pqe-c106="" class="highlight-div"><div _ngcontent-pqe-c106="" class="highlight-div-header"><div _ngcontent-pqe-c106="" class="highlight-div-header-left"><div _ngcontent-pqe-c106="" class="handle-button expand-button"><div _ngcontent-pqe-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pqe-c106="" class="highlight-div-header-right"><div _ngcontent-pqe-c106="" class="handle-button ai-button"></div><div _ngcontent-pqe-c106="" class="handle-button line-button"><div _ngcontent-pqe-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pqe-c106="" class="handle-button theme-button"><div _ngcontent-pqe-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pqe-c106="" class="handle-button copy-button"><div _ngcontent-pqe-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pqe-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// xxx.ets</span></li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>    <span class="hljs-title function_">onWindowStageCreate</span>(<span class="hljs-params">windowStage: <span class="hljs-variable language_">window</span>.WindowStage</span>) {</li><li>        <span class="hljs-comment">// 获取文件沙箱路径</span></li><li>        <span class="hljs-keyword">let</span> filePath = <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-property">filesDir</span> + <span class="hljs-string">'/test.txt'</span>;</li><li>        <span class="hljs-comment">// 将沙箱路径转换为uri</span></li><li>        <span class="hljs-keyword">let</span> uri = fileUri.<span class="hljs-title function_">getUriFromPath</span>(filePath);</li><li>        <span class="hljs-comment">// 构造请求数据</span></li><li>        <span class="hljs-keyword">let</span> <span class="hljs-attr">want</span>: <span class="hljs-title class_">Want</span> = {</li><li>        <span class="hljs-attr">action</span>: <span class="hljs-string">'ohos.want.action.viewData'</span>, <span class="hljs-comment">// 表示查看数据的操作，文件打开场景固定为此值</span></li><li>        <span class="hljs-attr">uri</span>: uri,</li><li>        <span class="hljs-attr">type</span>: <span class="hljs-string">'general.plain-text'</span>, <span class="hljs-comment">// 表示待打开文件的类型</span></li><li>        <span class="hljs-comment">// 配置被分享文件的读写权限，例如对文件打开应用进行读写授权</span></li><li>        <span class="hljs-attr">flags</span>: wantConstant.<span class="hljs-property">Flags</span>.<span class="hljs-property">FLAG_AUTH_WRITE_URI_PERMISSION</span> | wantConstant.<span class="hljs-property">Flags</span>.<span class="hljs-property">FLAG_AUTH_READ_URI_PERMISSION</span></li><li>        };</li><li>    }</li><li>    <span class="hljs-comment">// ...</span></li><li>}</li></ol></pre></div></div></li>      <li>       <p>调用接口启动。</p>       <div _ngcontent-pqe-c106="" class="highlight-div"><div _ngcontent-pqe-c106="" class="highlight-div-header"><div _ngcontent-pqe-c106="" class="highlight-div-header-left"><div _ngcontent-pqe-c106="" class="handle-button expand-button"><div _ngcontent-pqe-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pqe-c106="" class="highlight-div-header-right"><div _ngcontent-pqe-c106="" class="handle-button ai-button"></div><div _ngcontent-pqe-c106="" class="handle-button line-button"><div _ngcontent-pqe-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pqe-c106="" class="handle-button theme-button"><div _ngcontent-pqe-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pqe-c106="" class="handle-button copy-button"><div _ngcontent-pqe-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pqe-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// xxx.ets</span></li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>    <span class="hljs-title function_">onWindowStageCreate</span>(<span class="hljs-params">windowStage: <span class="hljs-variable language_">window</span>.WindowStage</span>) {</li><li>        <span class="hljs-comment">// 获取文件沙箱路径</span></li><li>        <span class="hljs-keyword">let</span> filePath = <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-property">filesDir</span> + <span class="hljs-string">'/test.txt'</span>;</li><li>        <span class="hljs-comment">// 将沙箱路径转换为uri</span></li><li>        <span class="hljs-keyword">let</span> uri = fileUri.<span class="hljs-title function_">getUriFromPath</span>(filePath);</li><li>        <span class="hljs-comment">// 构造请求数据</span></li><li>        <span class="hljs-keyword">let</span> <span class="hljs-attr">want</span>: <span class="hljs-title class_">Want</span> = {</li><li>        <span class="hljs-attr">action</span>: <span class="hljs-string">'ohos.want.action.viewData'</span>, <span class="hljs-comment">// 表示查看数据的操作，文件打开场景固定为此值</span></li><li>        <span class="hljs-attr">uri</span>: uri,</li><li>        <span class="hljs-attr">type</span>: <span class="hljs-string">'general.plain-text'</span>, <span class="hljs-comment">// 表示待打开文件的类型</span></li><li>        <span class="hljs-comment">// 配置被分享文件的读写权限，例如对文件打开应用进行读写授权</span></li><li>        <span class="hljs-attr">flags</span>: wantConstant.<span class="hljs-property">Flags</span>.<span class="hljs-property">FLAG_AUTH_WRITE_URI_PERMISSION</span> | wantConstant.<span class="hljs-property">Flags</span>.<span class="hljs-property">FLAG_AUTH_READ_URI_PERMISSION</span></li><li>        };</li><li>        <span class="hljs-comment">// 调用接口启动</span></li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">startAbility</span>(want)</li><li>        .<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Succeed to invoke startAbility.'</span>);</li><li>        })</li><li>        .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Failed to invoke startAbility, code: <span class="hljs-subst">${err.code}</span>, message: <span class="hljs-subst">${err.message}</span>`</span>);</li><li>        });</li><li>    }</li><li>    <span class="hljs-comment">// ...</span></li><li>}</li></ol></pre></div></div></li>     </ol>    </div>    <div class="tiledSection">     <h3 id="目标方接入步骤">目标方接入步骤<i class="anchor-icon anchor-icon-link" anchorid="目标方接入步骤" tips="复制节点链接"></i></h3>          <ol>      <li>       <p>声明文件打开能力。</p>       <p>支持打开文件的应用需要在<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/module-configuration-file">module.json5</a>配置文件中声明文件打开能力。其中uris字段表示接收URI的类型，其中scheme固定为file。type字段表示支持打开的文件类型（参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/uniform-data-type-descriptors">UTD类型</a>（推荐）或<a href="https://www.iana.org/assignments/media-types/media-types.xhtml?utm_source=ld246.com" target="_blank">MIME type类型</a>），如下举例中类型为txt文件。</p>       <div _ngcontent-pqe-c106="" class="highlight-div"><div _ngcontent-pqe-c106="" class="highlight-div-header"><div _ngcontent-pqe-c106="" class="highlight-div-header-left"><div _ngcontent-pqe-c106="" class="handle-button expand-button"><div _ngcontent-pqe-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pqe-c106="" class="highlight-div-header-right"><div _ngcontent-pqe-c106="" class="handle-button ai-button"></div><div _ngcontent-pqe-c106="" class="handle-button line-button"><div _ngcontent-pqe-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pqe-c106="" class="handle-button theme-button"><div _ngcontent-pqe-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pqe-c106="" class="handle-button copy-button"><div _ngcontent-pqe-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pqe-c106="" class="highlight-scroll-div"><pre class="json prettyprint linenums hljs language-json" hw-language="json" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-punctuation">{</span></li><li><span class="hljs-attr">"module"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>    <span class="hljs-comment">// ...</span></li><li>    <span class="hljs-attr">"abilities"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span></li><li>    <span class="hljs-punctuation">{</span></li><li>        <span class="hljs-comment">// ...</span></li><li>        <span class="hljs-attr">"skills"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span></li><li>        <span class="hljs-punctuation">{</span></li><li>            <span class="hljs-attr">"actions"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span></li><li>            <span class="hljs-string">"ohos.want.action.viewData"</span> <span class="hljs-comment">// 必填，声明数据处理能力</span></li><li>            <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span></li><li>            <span class="hljs-attr">"uris"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span></li><li>            <span class="hljs-punctuation">{</span></li><li>                <span class="hljs-comment">// 允许打开uri中以file://协议开头标识的本地文件</span></li><li>                <span class="hljs-attr">"scheme"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"file"</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// 必填，声明协议类型为文件</span></li><li>                <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"general.plain-text"</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// 必填，表示支持打开的文件类型</span></li><li>                <span class="hljs-attr">"linkFeature"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"FileOpen"</span> <span class="hljs-comment">// 必填且大小写敏感，表示此URI的功能为文件打开</span></li><li>            <span class="hljs-punctuation">}</span></li><li>            <span class="hljs-comment">// ...</span></li><li>            <span class="hljs-punctuation">]</span></li><li>            <span class="hljs-comment">// ...</span></li><li>        <span class="hljs-punctuation">}</span></li><li>        <span class="hljs-punctuation">]</span></li><li>    <span class="hljs-punctuation">}</span></li><li>    <span class="hljs-punctuation">]</span></li><li><span class="hljs-punctuation">}</span></li><li><span class="hljs-punctuation">}</span></li></ol></pre></div></div></li>      <li>       <p>应用处理待打开文件。</p>       <p>声明了文件打开的应用在被拉起后，获取传入的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-want" target="_blank">Want</a>参数信息，从中获取待打开文件的URI，在打开文件并获取对应的file对象后，可对文件进行读写操作。</p>       <div _ngcontent-pqe-c106="" class="highlight-div"><div _ngcontent-pqe-c106="" class="highlight-div-header"><div _ngcontent-pqe-c106="" class="highlight-div-header-left"><div _ngcontent-pqe-c106="" class="handle-button expand-button"><div _ngcontent-pqe-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pqe-c106="" class="highlight-div-header-right"><div _ngcontent-pqe-c106="" class="handle-button ai-button"></div><div _ngcontent-pqe-c106="" class="handle-button line-button"><div _ngcontent-pqe-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pqe-c106="" class="handle-button theme-button"><div _ngcontent-pqe-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pqe-c106="" class="handle-button copy-button"><div _ngcontent-pqe-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pqe-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// xxx.ets</span></li><li><span class="hljs-keyword">import</span> fs <span class="hljs-keyword">from</span> <span class="hljs-string">'@ohos.file.fs'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Want</span>, <span class="hljs-title class_">AbilityConstant</span>, <span class="hljs-title class_">UIAbility</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>    <span class="hljs-title function_">onCreate</span>(<span class="hljs-params">want: Want, launchParam: AbilityConstant.LaunchParam</span>) {</li><li>        <span class="hljs-comment">// 从want信息中获取uri字段</span></li><li>        <span class="hljs-keyword">let</span> uri = want.<span class="hljs-property">uri</span>;</li><li>        <span class="hljs-keyword">if</span> (uri == <span class="hljs-literal">null</span> || uri == <span class="hljs-literal">undefined</span>) {</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'uri is invalid'</span>);</li><li>            <span class="hljs-keyword">return</span>;</li><li>        }</li><li>        <span class="hljs-keyword">try</span> {</li><li>            <span class="hljs-comment">// 根据待打开文件的URI进行相应操作。例如同步读写的方式打开URI获取file对象</span></li><li>            <span class="hljs-keyword">let</span> file = fs.<span class="hljs-title function_">openSync</span>(uri, fs.<span class="hljs-property">OpenMode</span>.<span class="hljs-property">READ_WRITE</span>);</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Succeed to open file.'</span>);</li><li>        } <span class="hljs-keyword">catch</span> (err) {</li><li>            <span class="hljs-keyword">let</span> <span class="hljs-attr">error</span>: <span class="hljs-title class_">BusinessError</span> = err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>;</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Failed to open file openSync, code: <span class="hljs-subst">${error.code}</span>, message: <span class="hljs-subst">${error.message}</span>`</span>);</li><li>        }</li><li>    }</li><li>}</li></ol></pre></div></div></li>     </ol>    </div>   </div>   <div></div></div>