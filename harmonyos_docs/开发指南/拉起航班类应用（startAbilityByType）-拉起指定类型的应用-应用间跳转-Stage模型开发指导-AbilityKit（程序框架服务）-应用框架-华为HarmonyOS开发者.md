<h1 _ngcontent-wlj-c119="" class="doc-title ng-star-inserted" title="拉起航班类应用（startAbilityByType）"> 拉起航班类应用（startAbilityByType） </h1>

<div _ngcontent-wlj-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p>本章节介绍如何拉起航班类应用扩展面板。</p>    <p>例如，在行程安排类App中，当用户记录了某次行程的航班号，应用能够识别航班号信息并提供航班动态查询的链接。用户点击链接后，应用将通过调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext#startabilitybytype11" target="_blank">UIAbilityContext.startAbilityByType</a>或<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiextensioncontentsession#startabilitybytype11" target="_blank">UIExtensionContentSession.startAbilityByType</a>接口，拉起航班类应用的扩展面板。面板上将展示设备上所有支持航班查询的应用，供用户选择并跳转至所需应用。</p>    <div class="tiledSection">     <h2 id="航班类应用扩展面板参数说明">航班类应用扩展面板参数说明<i class="anchor-icon anchor-icon-link" anchorid="航班类应用扩展面板参数说明" tips="复制节点链接"></i></h2>          <p>startAbilityByType接口中type字段为flight，支持按航班号查询、按起降地查询两种意图场景，对应的wantParam参数如下：</p>     <ul>      <li>       <p>按航班号查询场景</p>       <div class="tablenoborder">        <div class="tbBox"><table class="layoutFixed idpTab">         <thead>          <tr>           <th align="left" class="cellrowborder" id="mcps1.3.3.3.1.2.1.5.1.1" valign="top" width="25%">参数名</th>           <th align="left" class="cellrowborder" id="mcps1.3.3.3.1.2.1.5.1.2" valign="top" width="25%">类型</th>           <th align="left" class="cellrowborder" id="mcps1.3.3.3.1.2.1.5.1.3" valign="top" width="25%">必填</th>           <th align="left" class="cellrowborder" id="mcps1.3.3.3.1.2.1.5.1.4" valign="top" width="25%">说明</th>          </tr>         </thead>                   <tbody><tr>           <td class="cellrowborder" valign="top" width="25%">sceneType</td>           <td class="cellrowborder" valign="top" width="25%">number</td>           <td class="cellrowborder" valign="top" width="25%">否</td>           <td class="cellrowborder" valign="top" width="25%">意图场景，表明本次请求对应的操作意图。默认为1，按航班号查询场景填1或不填。</td>          </tr>          <tr>           <td class="cellrowborder" valign="top" width="25%">flightNo</td>           <td class="cellrowborder" valign="top" width="25%">string</td>           <td class="cellrowborder" valign="top" width="25%">是</td>           <td class="cellrowborder" valign="top" width="25%">航班号，航司二位代码+数字。</td>          </tr>          <tr>           <td class="cellrowborder" valign="top" width="25%">departureDate</td>           <td class="cellrowborder" valign="top" width="25%">string</td>           <td class="cellrowborder" valign="top" width="25%">否</td>           <td class="cellrowborder" valign="top" width="25%">航班出发时间：YYYY-MM-DD。</td>          </tr>                 </tbody></table></div>       </div></li>      <li>       <p>按起降地查询场景</p>       <div class="tablenoborder">        <div class="tbBox"><table class="layoutFixed idpTab">         <thead>          <tr>           <th align="left" class="cellrowborder" id="mcps1.3.3.3.2.2.1.5.1.1" valign="top" width="25%">参数名</th>           <th align="left" class="cellrowborder" id="mcps1.3.3.3.2.2.1.5.1.2" valign="top" width="25%">类型</th>           <th align="left" class="cellrowborder" id="mcps1.3.3.3.2.2.1.5.1.3" valign="top" width="25%">必填</th>           <th align="left" class="cellrowborder" id="mcps1.3.3.3.2.2.1.5.1.4" valign="top" width="25%">说明</th>          </tr>         </thead>                   <tbody><tr>           <td class="cellrowborder" valign="top" width="25%">sceneType</td>           <td class="cellrowborder" valign="top" width="25%">number</td>           <td class="cellrowborder" valign="top" width="25%">是</td>           <td class="cellrowborder" valign="top" width="25%">意图场景，表明本次请求对应的操作意图。按起降地查询场景填2。</td>          </tr>          <tr>           <td class="cellrowborder" valign="top" width="25%">originLocation</td>           <td class="cellrowborder" valign="top" width="25%">string</td>           <td class="cellrowborder" valign="top" width="25%">是</td>           <td class="cellrowborder" valign="top" width="25%">出发地。</td>          </tr>          <tr>           <td class="cellrowborder" valign="top" width="25%">destinationLocation</td>           <td class="cellrowborder" valign="top" width="25%">string</td>           <td class="cellrowborder" valign="top" width="25%">是</td>           <td class="cellrowborder" valign="top" width="25%">目的地。</td>          </tr>          <tr>           <td class="cellrowborder" valign="top" width="25%">departureDate</td>           <td class="cellrowborder" valign="top" width="25%">string</td>           <td class="cellrowborder" valign="top" width="25%">否</td>           <td class="cellrowborder" valign="top" width="25%">航班出发时间：YYYY-MM-DD。</td>          </tr>                 </tbody></table></div>       </div></li>     </ul>    </div>    <div class="tiledSection">     <h2 id="拉起方开发步骤">拉起方开发步骤<i class="anchor-icon anchor-icon-link" anchorid="拉起方开发步骤" tips="复制节点链接"></i></h2>          <ol>      <li>       <p>导入相关模块。</p>       <div _ngcontent-wlj-c106="" class="highlight-div"><div _ngcontent-wlj-c106="" class="highlight-div-header"><div _ngcontent-wlj-c106="" class="highlight-div-header-left"><div _ngcontent-wlj-c106="" class="handle-button expand-button"><div _ngcontent-wlj-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wlj-c106="" class="highlight-div-header-right"><div _ngcontent-wlj-c106="" class="handle-button ai-button"></div><div _ngcontent-wlj-c106="" class="handle-button line-button"><div _ngcontent-wlj-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wlj-c106="" class="handle-button theme-button"><div _ngcontent-wlj-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wlj-c106="" class="handle-button copy-button"><div _ngcontent-wlj-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wlj-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li></ol></pre></div></div></li>      <li>       <p>构造接口参数并调用startAbilityByType接口。</p>       <div _ngcontent-wlj-c106="" class="highlight-div"><div _ngcontent-wlj-c106="" class="highlight-div-header"><div _ngcontent-wlj-c106="" class="highlight-div-header-left"><div _ngcontent-wlj-c106="" class="handle-button expand-button"><div _ngcontent-wlj-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wlj-c106="" class="highlight-div-header-right"><div _ngcontent-wlj-c106="" class="handle-button ai-button"></div><div _ngcontent-wlj-c106="" class="handle-button line-button"><div _ngcontent-wlj-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wlj-c106="" class="handle-button theme-button"><div _ngcontent-wlj-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wlj-c106="" class="handle-button copy-button"><div _ngcontent-wlj-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wlj-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>    <span class="hljs-meta">@State</span> <span class="hljs-attr">hideAbility</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'hideAbility'</span></li><li>
</li><li>    <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>        <span class="hljs-title class_">Row</span>() {</li><li>            <span class="hljs-title class_">Column</span>() {</li><li>                <span class="hljs-title class_">Text</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">hideAbility</span>)</li><li>                    .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">30</span>)</li><li>                    .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)</li><li>                    .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>                        <span class="hljs-keyword">let</span> context = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li>                        <span class="hljs-keyword">let</span> <span class="hljs-attr">wantParam</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-title class_">Object</span>&gt; = {</li><li>                            <span class="hljs-string">'sceneType'</span>: <span class="hljs-number">1</span>,</li><li>                            <span class="hljs-string">'flightNo'</span>: <span class="hljs-string">'ZH1509'</span>,</li><li>                            <span class="hljs-string">'departureDate'</span>: <span class="hljs-string">'2024-10-01'</span></li><li>                        };</li><li>                        <span class="hljs-keyword">let</span> <span class="hljs-attr">abilityStartCallback</span>: common.<span class="hljs-property">AbilityStartCallback</span> = {</li><li>                            <span class="hljs-attr">onError</span>: <span class="hljs-function">(<span class="hljs-params">code: <span class="hljs-built_in">number</span>, name: <span class="hljs-built_in">string</span>, message: <span class="hljs-built_in">string</span></span>) =&gt;</span> {</li><li>                                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`onError code <span class="hljs-subst">${code}</span> name: <span class="hljs-subst">${name}</span> message: <span class="hljs-subst">${message}</span>`</span>);</li><li>                            },</li><li>                            <span class="hljs-attr">onResult</span>: <span class="hljs-function">(<span class="hljs-params">result</span>) =&gt;</span> {</li><li>                                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`onResult result: <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(result)}</span>`</span>);</li><li>                            }</li><li>                        }</li><li>
</li><li>                        context.<span class="hljs-title function_">startAbilityByType</span>(<span class="hljs-string">"flight"</span>, wantParam, abilityStartCallback,</li><li>                            <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> {</li><li>                                <span class="hljs-keyword">if</span> (err) {</li><li>                                    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`startAbilityByType fail, err: <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(err)}</span>`</span>);</li><li>                                } <span class="hljs-keyword">else</span> {</li><li>                                    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`success`</span>);</li><li>                                }</li><li>                            });</li><li>                    });</li><li>            }</li><li>            .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>        }</li><li>        .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>    }</li><li>}</li></ol></pre></div></div>       <p>效果示例图：</p>       <p><span><img originheight="729" originwidth="328" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114942.58935745647815004804784908273987:50001231000000:2800:4F54148421F90F4079C9E4FD43EFB94CA21A97372DDEAA672DA89237894EEC7D.png" width="328" height="729"></span></p></li>     </ol>    </div>    <div class="tiledSection">     <h2 id="目标方开发步骤">目标方开发步骤<i class="anchor-icon anchor-icon-link" anchorid="目标方开发步骤" tips="复制节点链接"></i></h2>          <ol>      <li>       <p>在module.json5中配置<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/module-configuration-file#skills标签">uris</a>：</p>       <ol>        <li>设置linkFeature属性以声明当前应用支持的特性功能，从而系统可以从设备已安装应用中找到当前支持该特性的应用，取值范围如下：          <div class="tablenoborder">          <div class="tbBox"><table class="layoutFixed idpTab">           <thead>            <tr>             <th align="left" class="cellrowborder" id="mcps1.3.5.2.1.2.1.1.1.3.1.1" valign="top" width="50%">取值</th>             <th align="left" class="cellrowborder" id="mcps1.3.5.2.1.2.1.1.1.3.1.2" valign="top" width="50%">含义</th>            </tr>           </thead>                       <tbody><tr>             <td class="cellrowborder" valign="top" width="50%">QueryByFlightNo</td>             <td class="cellrowborder" valign="top" width="50%">声明应用支持按航班号查询航班。</td>            </tr>            <tr>             <td class="cellrowborder" valign="top" width="50%">QueryByLocation</td>             <td class="cellrowborder" valign="top" width="50%">声明应用支持按起降地查询航班。</td>            </tr>                     </tbody></table></div>         </div></li>        <li>设置scheme、host、port、path/pathStartWith属性，与Want中URI相匹配，以便区分不同功能。         <div _ngcontent-wlj-c106="" class="highlight-div"><div _ngcontent-wlj-c106="" class="highlight-div-header"><div _ngcontent-wlj-c106="" class="highlight-div-header-left"><div _ngcontent-wlj-c106="" class="handle-button expand-button"><div _ngcontent-wlj-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wlj-c106="" class="highlight-div-header-right"><div _ngcontent-wlj-c106="" class="handle-button ai-button"></div><div _ngcontent-wlj-c106="" class="handle-button line-button"><div _ngcontent-wlj-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wlj-c106="" class="handle-button theme-button"><div _ngcontent-wlj-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wlj-c106="" class="handle-button copy-button"><div _ngcontent-wlj-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wlj-c106="" class="highlight-scroll-div"><pre class="json prettyprint linenums hljs language-json" hw-language="json" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-punctuation">{</span></li><li>    <span class="hljs-attr">"abilities"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span></li><li>        <span class="hljs-punctuation">{</span></li><li>            <span class="hljs-attr">"skills"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span></li><li>                <span class="hljs-punctuation">{</span></li><li>                    <span class="hljs-attr">"uris"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span></li><li>                        <span class="hljs-punctuation">{</span></li><li>                            <span class="hljs-attr">"scheme"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"flight"</span><span class="hljs-punctuation">,</span></li><li>                            <span class="hljs-attr">"host"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"queryByFlightNo"</span><span class="hljs-punctuation">,</span></li><li>                            <span class="hljs-attr">"path"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">""</span><span class="hljs-punctuation">,</span></li><li>                            <span class="hljs-attr">"linkFeature"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"QueryByFlightNo"</span></li><li>                        <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span></li><li>                        <span class="hljs-punctuation">{</span></li><li>                            <span class="hljs-attr">"scheme"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"flight"</span><span class="hljs-punctuation">,</span></li><li>                            <span class="hljs-attr">"host"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"queryByLocation"</span><span class="hljs-punctuation">,</span></li><li>                            <span class="hljs-attr">"path"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">""</span><span class="hljs-punctuation">,</span></li><li>                            <span class="hljs-attr">"linkFeature"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"QueryByLocation"</span></li><li>                        <span class="hljs-punctuation">}</span></li><li>                    <span class="hljs-punctuation">]</span></li><li>                <span class="hljs-punctuation">}</span></li><li>            <span class="hljs-punctuation">]</span></li><li>        <span class="hljs-punctuation">}</span></li><li>    <span class="hljs-punctuation">]</span></li><li><span class="hljs-punctuation">}</span></li></ol></pre></div></div></li>       </ol></li>      <li>       <p>解析参数并做对应处理。</p>       <div _ngcontent-wlj-c106="" class="highlight-div"><div _ngcontent-wlj-c106="" class="highlight-div-header"><div _ngcontent-wlj-c106="" class="highlight-div-header-left"><div _ngcontent-wlj-c106="" class="handle-button expand-button"><div _ngcontent-wlj-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wlj-c106="" class="highlight-div-header-right"><div _ngcontent-wlj-c106="" class="handle-button ai-button"></div><div _ngcontent-wlj-c106="" class="handle-button line-button"><div _ngcontent-wlj-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wlj-c106="" class="handle-button theme-button"><div _ngcontent-wlj-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wlj-c106="" class="handle-button copy-button"><div _ngcontent-wlj-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wlj-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-title class_">UIAbility</span>.<span class="hljs-title function_">onCreate</span>(<span class="hljs-attr">want</span>: <span class="hljs-title class_">Want</span>, <span class="hljs-attr">launchParam</span>: <span class="hljs-title class_">AbilityConstant</span>.<span class="hljs-property">LaunchParam</span>): <span class="hljs-built_in">void</span></li></ol></pre></div></div>       <p>在参数<strong>want.uri</strong>中会携带目标方配置的linkFeature对应的uri。</p>       <p>在参数<strong>want.parameters</strong>中会携带Caller方传入的参数，不同场景参数如下所示</p>       <ul>        <li>         <p>按航班号查询场景</p>         <div class="tablenoborder">          <div class="tbBox"><table class="layoutFixed idpTab">           <thead>            <tr>             <th align="left" class="cellrowborder" id="mcps1.3.5.2.2.5.1.2.1.5.1.1" valign="top" width="25%">参数名</th>             <th align="left" class="cellrowborder" id="mcps1.3.5.2.2.5.1.2.1.5.1.2" valign="top" width="25%">类型</th>             <th align="left" class="cellrowborder" id="mcps1.3.5.2.2.5.1.2.1.5.1.3" valign="top" width="25%">必填</th>             <th align="left" class="cellrowborder" id="mcps1.3.5.2.2.5.1.2.1.5.1.4" valign="top" width="25%">说明</th>            </tr>           </thead>                       <tbody><tr>             <td class="cellrowborder" valign="top" width="25%">flightNo</td>             <td class="cellrowborder" valign="top" width="25%">string</td>             <td class="cellrowborder" valign="top" width="25%">是</td>             <td class="cellrowborder" valign="top" width="25%">航班号，航司二位代码+数字。</td>            </tr>            <tr>             <td class="cellrowborder" valign="top" width="25%">departureDate</td>             <td class="cellrowborder" valign="top" width="25%">string</td>             <td class="cellrowborder" valign="top" width="25%">否</td>             <td class="cellrowborder" valign="top" width="25%">航班出发时间：YYYY-MM-DD。不填时，Target可按当天处理。</td>            </tr>                     </tbody></table></div>         </div></li>        <li>         <p>按起降地查询场景</p>         <div class="tablenoborder">          <div class="tbBox"><table class="layoutFixed idpTab">           <thead>            <tr>             <th align="left" class="cellrowborder" id="mcps1.3.5.2.2.5.2.2.1.5.1.1" valign="top" width="25%">参数名</th>             <th align="left" class="cellrowborder" id="mcps1.3.5.2.2.5.2.2.1.5.1.2" valign="top" width="25%">类型</th>             <th align="left" class="cellrowborder" id="mcps1.3.5.2.2.5.2.2.1.5.1.3" valign="top" width="25%">必填</th>             <th align="left" class="cellrowborder" id="mcps1.3.5.2.2.5.2.2.1.5.1.4" valign="top" width="25%">说明</th>            </tr>           </thead>                       <tbody><tr>             <td class="cellrowborder" valign="top" width="25%">originLocation</td>             <td class="cellrowborder" valign="top" width="25%">string</td>             <td class="cellrowborder" valign="top" width="25%">是</td>             <td class="cellrowborder" valign="top" width="25%">出发地。</td>            </tr>            <tr>             <td class="cellrowborder" valign="top" width="25%">destinationLocation</td>             <td class="cellrowborder" valign="top" width="25%">string</td>             <td class="cellrowborder" valign="top" width="25%">是</td>             <td class="cellrowborder" valign="top" width="25%">目的地。</td>            </tr>            <tr>             <td class="cellrowborder" valign="top" width="25%">departureDate</td>             <td class="cellrowborder" valign="top" width="25%">string</td>             <td class="cellrowborder" valign="top" width="25%">否</td>             <td class="cellrowborder" valign="top" width="25%">航班出发时间：YYYY-MM-DD。不填时，Target可按当天处理。</td>            </tr>                     </tbody></table></div>         </div></li>       </ul>       <p>应用可根据<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/module-configuration-file#skills标签">linkFeature</a>中定义的特性功能，比如按航班号查询和按起降地查询，结合接收到的uri和参数开发不同的样式页面。</p></li>     </ol>     <p><strong>完整示例：</strong></p>     <div _ngcontent-wlj-c106="" class="highlight-div"><div _ngcontent-wlj-c106="" class="highlight-div-header"><div _ngcontent-wlj-c106="" class="highlight-div-header-left"><div _ngcontent-wlj-c106="" class="handle-button expand-button"><div _ngcontent-wlj-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wlj-c106="" class="highlight-div-header-right"><div _ngcontent-wlj-c106="" class="handle-button ai-button"></div><div _ngcontent-wlj-c106="" class="handle-button line-button"><div _ngcontent-wlj-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wlj-c106="" class="handle-button theme-button"><div _ngcontent-wlj-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wlj-c106="" class="handle-button copy-button"><div _ngcontent-wlj-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wlj-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AbilityConstant</span>, <span class="hljs-title class_">UIAbility</span>, <span class="hljs-title class_">Want</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-variable language_">window</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span>;</li><li>
</li><li><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">TAG</span> = <span class="hljs-string">'EntryAbility'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>    <span class="hljs-attr">windowStage</span>: <span class="hljs-variable language_">window</span>.<span class="hljs-property">WindowStage</span> | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;</li><li>
</li><li>    uri?: <span class="hljs-built_in">string</span>;</li><li>    flightNo?: <span class="hljs-built_in">string</span>;</li><li>    departureDate?: <span class="hljs-built_in">string</span>;</li><li>    originLocation?: <span class="hljs-built_in">string</span>;</li><li>    destinationLocation?: <span class="hljs-built_in">string</span>;</li><li>
</li><li>    <span class="hljs-title function_">onCreate</span>(<span class="hljs-attr">want</span>: <span class="hljs-title class_">Want</span>, <span class="hljs-attr">launchParam</span>: <span class="hljs-title class_">AbilityConstant</span>.<span class="hljs-property">LaunchParam</span>): <span class="hljs-built_in">void</span> {</li><li>        hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">`onCreate, want=<span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(want)}</span>`</span>);</li><li>        <span class="hljs-variable language_">super</span>.<span class="hljs-title function_">onCreate</span>(want, launchParam);</li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">parseWant</span>(want);</li><li>    }</li><li>
</li><li>    <span class="hljs-title function_">onNewWant</span>(<span class="hljs-attr">want</span>: <span class="hljs-title class_">Want</span>, <span class="hljs-attr">launchParam</span>: <span class="hljs-title class_">AbilityConstant</span>.<span class="hljs-property">LaunchParam</span>): <span class="hljs-built_in">void</span> {</li><li>        hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">`onNewWant, want=<span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(want)}</span>`</span>);</li><li>        <span class="hljs-variable language_">super</span>.<span class="hljs-title function_">onNewWant</span>(want, launchParam);</li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">parseWant</span>(want);</li><li>        <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">windowStage</span>) {</li><li>            hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'windowStage is null'</span>);</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">terminateSelf</span>();</li><li>            <span class="hljs-keyword">return</span>;</li><li>        }</li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">loadPage</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">windowStage</span>);</li><li>    }</li><li>
</li><li>    <span class="hljs-keyword">private</span> <span class="hljs-title function_">parseWant</span>(<span class="hljs-attr">want</span>: <span class="hljs-title class_">Want</span>): <span class="hljs-built_in">void</span> {</li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">uri</span> = want.<span class="hljs-property">uri</span> <span class="hljs-keyword">as</span> <span class="hljs-built_in">string</span> | <span class="hljs-literal">undefined</span>;</li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">flightNo</span> = want.<span class="hljs-property">parameters</span>?.<span class="hljs-property">flightNo</span> <span class="hljs-keyword">as</span> <span class="hljs-built_in">string</span> | <span class="hljs-literal">undefined</span>;</li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">departureDate</span> = want.<span class="hljs-property">parameters</span>?.<span class="hljs-property">departureDate</span> <span class="hljs-keyword">as</span> <span class="hljs-built_in">string</span> | <span class="hljs-literal">undefined</span>;</li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">originLocation</span> = want.<span class="hljs-property">parameters</span>?.<span class="hljs-property">originLocation</span> <span class="hljs-keyword">as</span> <span class="hljs-built_in">string</span> | <span class="hljs-literal">undefined</span>;</li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">destinationLocation</span> = want.<span class="hljs-property">parameters</span>?.<span class="hljs-property">destinationLocation</span> <span class="hljs-keyword">as</span> <span class="hljs-built_in">string</span> | <span class="hljs-literal">undefined</span>;</li><li>    }</li><li>
</li><li>    <span class="hljs-keyword">private</span> <span class="hljs-title function_">loadPage</span>(<span class="hljs-attr">windowStage</span>: <span class="hljs-variable language_">window</span>.<span class="hljs-property">WindowStage</span>): <span class="hljs-built_in">void</span> {</li><li>        hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">`loadPage, uri=<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.uri}</span>`</span>);</li><li>        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">uri</span> === <span class="hljs-string">'flight://queryByFlightNo'</span>) {</li><li>            <span class="hljs-comment">// 构建按航班号查询场景参数</span></li><li>            <span class="hljs-keyword">const</span> <span class="hljs-attr">storage</span>: <span class="hljs-title class_">LocalStorage</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LocalStorage</span>({</li><li>                <span class="hljs-string">"flightNo"</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">flightNo</span>,</li><li>                <span class="hljs-string">"departureDate"</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">departureDate</span></li><li>            } <span class="hljs-keyword">as</span> <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-title class_">Object</span>&gt;);</li><li>            <span class="hljs-comment">// 拉起按航班号查询页面</span></li><li>            windowStage.<span class="hljs-title function_">loadContent</span>(<span class="hljs-string">'pages/QueryByFlightNoPage'</span>, storage)</li><li>        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">uri</span> === <span class="hljs-string">'flight://queryByLocation'</span>) {</li><li>            <span class="hljs-comment">// 构建按起降地查询场景参数</span></li><li>            <span class="hljs-keyword">const</span> <span class="hljs-attr">storage</span>: <span class="hljs-title class_">LocalStorage</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">LocalStorage</span>({</li><li>                <span class="hljs-string">"originLocation"</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">originLocation</span>,</li><li>                <span class="hljs-string">"destinationLocation"</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">destinationLocation</span>,</li><li>                <span class="hljs-string">"departureDate"</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">departureDate</span></li><li>            } <span class="hljs-keyword">as</span> <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-title class_">Object</span>&gt;);</li><li>            <span class="hljs-comment">// 拉起按起降地查询页面</span></li><li>            windowStage.<span class="hljs-title function_">loadContent</span>(<span class="hljs-string">'pages/QueryByLocationPage'</span>, storage)</li><li>        } <span class="hljs-keyword">else</span> {</li><li>            <span class="hljs-comment">// 默认拉起首页</span></li><li>            windowStage.<span class="hljs-title function_">loadContent</span>(<span class="hljs-string">'pages/Index'</span>, <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> {</li><li>                <span class="hljs-keyword">if</span> (err.<span class="hljs-property">code</span>) {</li><li>                    hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'Failed to load the content. Cause: %{public}s'</span>,</li><li>                        <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err) ?? <span class="hljs-string">''</span>);</li><li>                    <span class="hljs-keyword">return</span>;</li><li>                }</li><li>                hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'Succeeded in loading the content.'</span>);</li><li>            });</li><li>        }</li><li>    }</li><li>
</li><li>    <span class="hljs-title function_">onDestroy</span>(): <span class="hljs-built_in">void</span> {</li><li>        hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">`onDestroy`</span>);</li><li>    }</li><li>
</li><li>    <span class="hljs-title function_">onWindowStageCreate</span>(<span class="hljs-attr">windowStage</span>: <span class="hljs-variable language_">window</span>.<span class="hljs-property">WindowStage</span>): <span class="hljs-built_in">void</span> {</li><li>        hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">`onWindowStageCreate`</span>);</li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">windowStage</span> = windowStage;</li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">loadPage</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">windowStage</span>);</li><li>    }</li><li>
</li><li>    <span class="hljs-title function_">onWindowStageDestroy</span>(): <span class="hljs-built_in">void</span> {</li><li>        hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'%{public}s'</span>, <span class="hljs-string">'Ability onWindowStageDestroy'</span>);</li><li>    }</li><li>
</li><li>    <span class="hljs-title function_">onForeground</span>(): <span class="hljs-built_in">void</span> {</li><li>        hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'%{public}s'</span>, <span class="hljs-string">'Ability onForeground'</span>);</li><li>    }</li><li>
</li><li>    <span class="hljs-title function_">onBackground</span>(): <span class="hljs-built_in">void</span> {</li><li>        hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'%{public}s'</span>, <span class="hljs-string">'Ability onBackground'</span>);</li><li>    }</li><li>}</li></ol></pre></div></div>    </div>   </div>   <div></div></div>