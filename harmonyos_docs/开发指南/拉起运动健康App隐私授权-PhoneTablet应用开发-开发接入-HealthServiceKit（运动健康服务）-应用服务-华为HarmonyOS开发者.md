<h1 _ngcontent-gle-c119="" class="doc-title ng-star-inserted" title="拉起运动健康App隐私授权"> 拉起运动健康App隐私授权 </h1>

<div _ngcontent-gle-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <div class="tiledSection">     <h2 id="section1523933484217">场景介绍<i class="anchor-icon anchor-icon-link" anchorid="section1523933484217" tips="复制节点链接"></i></h2>          <p>用户在设备上首次使用运动健康服务时，需要用户同意运动健康服务隐私协议，当前隐私授权依赖运动健康App，需引导用户打开运动健康App并完成隐私授权。</p>     <p>开发者调用后续章节的接口后，如果返回错误码<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/errorcode-healthservice#section9390213122310" target="_blank">1002703001</a>，可参考本章节，引导用户同意运动健康服务隐私授权。</p>    </div>    <div class="tiledSection">     <h2 id="section137871837175615">开发步骤<i class="anchor-icon anchor-icon-link" anchorid="section137871837175615" tips="复制节点链接"></i></h2>          <ol>      <li>在module.json5文件中增加querySchemes字段，并在列表中配置"huaweischeme"。       <p>"huaweischeme"为需要跳转到的运动健康App首页的scheme，页面参考如下：</p>       <p><span><img originheight="382" originwidth="409" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114647.96557408255504331817141355586372:50001231000000:2800:A6E2E3ACFE4F4D3CB9830CE2047CA22D3BD65237A0F9EAD45BC128E5438D912F.png" width="409" height="382"></span></p></li>      <li>导入相关功能模块。       <div _ngcontent-gle-c106="" class="highlight-div"><div _ngcontent-gle-c106="" class="highlight-div-header"><div _ngcontent-gle-c106="" class="highlight-div-header-left"><div _ngcontent-gle-c106="" class="handle-button expand-button"><div _ngcontent-gle-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gle-c106="" class="highlight-div-header-right"><div _ngcontent-gle-c106="" class="handle-button ai-button"></div><div _ngcontent-gle-c106="" class="handle-button line-button"><div _ngcontent-gle-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gle-c106="" class="handle-button theme-button"><div _ngcontent-gle-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gle-c106="" class="handle-button copy-button"><div _ngcontent-gle-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gle-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { bundleManager, common, <span class="hljs-title class_">Want</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { productViewManager } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AppGalleryKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li></ol></pre></div></div></li>      <li>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-bundlemanager#bundlemanagercanopenlink12" target="_blank">canOpenLink</a>判断运动健康App是否安装。       <ul>        <li>已安装则调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext#openlink12" target="_blank">openLink</a>接口拉起运动健康App；</li>        <li>未安装调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/store-productview#section729012543213" target="_blank">应用市场推荐</a>接口，引导用户下载运动健康App。</li>       </ul>       <div _ngcontent-gle-c106="" class="highlight-div"><div _ngcontent-gle-c106="" class="highlight-div-header"><div _ngcontent-gle-c106="" class="highlight-div-header-left"><div _ngcontent-gle-c106="" class="handle-button expand-button"><div _ngcontent-gle-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gle-c106="" class="highlight-div-header-right"><div _ngcontent-gle-c106="" class="handle-button ai-button"></div><div _ngcontent-gle-c106="" class="handle-button line-button"><div _ngcontent-gle-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gle-c106="" class="handle-button theme-button"><div _ngcontent-gle-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gle-c106="" class="handle-button copy-button"><div _ngcontent-gle-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gle-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">try</span> {</li><li>  <span class="hljs-keyword">let</span> result = bundleManager.<span class="hljs-title function_">canOpenLink</span>(<span class="hljs-string">'huaweischeme://healthapp/home/main'</span>);</li><li>  <span class="hljs-keyword">let</span> context = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li>  <span class="hljs-keyword">if</span> (result) {</li><li>    <span class="hljs-comment">// 拉起运动健康App首页，进行隐私授权</span></li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">link</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'huaweischeme://healthapp/home/main'</span>;  </li><li>    <span class="hljs-keyword">await</span> context.<span class="hljs-title function_">openLink</span>(link)</li><li>  } <span class="hljs-keyword">else</span> {</li><li>    <span class="hljs-comment">// 拉起应用市场推荐，引导用户下载运动健康App，进行隐私授权</span></li><li>    <span class="hljs-keyword">const</span> <span class="hljs-attr">wantParam</span>: <span class="hljs-title class_">Want</span> = {</li><li>      <span class="hljs-attr">parameters</span>: {</li><li>        <span class="hljs-attr">bundleName</span>: <span class="hljs-string">'com.huawei.hmos.health'</span></li><li>      }</li><li>    };</li><li>    <span class="hljs-keyword">const</span> <span class="hljs-attr">callback</span>: productViewManager.<span class="hljs-property">ProductViewCallback</span> = {</li><li>      <span class="hljs-attr">onError</span>: <span class="hljs-function">(<span class="hljs-params">error: BusinessError</span>) =&gt;</span> {</li><li>        hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0001</span>, <span class="hljs-string">'TAG'</span>, <span class="hljs-string">`Failed to open AppGallery.Code: <span class="hljs-subst">${error.code}</span>, message: <span class="hljs-subst">${error.message}</span>`</span>);</li><li>      }</li><li>    }</li><li>    productViewManager.<span class="hljs-title function_">loadProduct</span>(context, wantParam, callback);</li><li>  }</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>  hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">`Failed to agree user privacy.Code: <span class="hljs-subst">${err.code}</span>, message: <span class="hljs-subst">${err.message}</span>`</span>);</li><li>}</li></ol></pre></div></div></li>     </ol>    </div>   </div>   <div></div></div>