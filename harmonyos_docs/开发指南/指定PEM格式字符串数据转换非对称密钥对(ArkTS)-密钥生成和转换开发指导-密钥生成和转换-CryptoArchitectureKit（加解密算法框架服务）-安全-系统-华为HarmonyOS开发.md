<h1 _ngcontent-pml-c119="" class="doc-title ng-star-inserted" title="指定PEM格式字符串数据转换非对称密钥对(ArkTS)"> 指定PEM格式字符串数据转换非对称密钥对(ArkTS) </h1>

<div _ngcontent-pml-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p>以RSA为例，根据指定的非对称密钥字符串数据，生成非对称密钥对（KeyPair）。</p>    <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">      <p>针对非对称密钥的convertPemKey操作：</p>      <ul>       <li>        <p>公钥需满足X.509规范、PKCS#1规范、PEM编码格式。</p></li>       <li>        <p>私钥需满足PKCS#8规范、PKCS#1规范、PEM编码格式。</p></li>      </ul>     </div></div></div>    <div class="tiledSection">     <h2 id="指定pem格式字符串数据转换密钥对">指定PEM格式字符串数据转换密钥对<i class="anchor-icon anchor-icon-link" anchorid="指定pem格式字符串数据转换密钥对" tips="复制节点链接"></i></h2>          <p>对应的算法规格请查看<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/crypto-asym-key-generation-conversion-spec">非对称密钥生成和转换规格</a>。</p>     <ol>      <li>       <p>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-cryptoframework#cryptoframeworkcreateasykeygenerator" target="_blank">cryptoFramework.createAsyKeyGenerator</a>，指定字符串参数'RSA1024'，创建RSA密钥类型为RSA1024、素数个数为2的非对称密钥生成器（AsyKeyGenerator）。</p>       <p>生成RSA非对称密钥时，默认素数为2，此处省略了参数PRIMES_2。</p></li>      <li>       <p>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-cryptoframework#convertpemkey12" target="_blank">AsyKeyGenerator.convertPemKey</a>，传入二进制密钥数据，生成非对称密钥对象（KeyPair）。</p></li>      <li>       <p>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-cryptoframework#getencodedpem12" target="_blank">AsyKeyGenerator.getEncodedPem</a>，将非对称密钥对象中的公钥转换成pkcs1或x509格式，私钥转换成pkcs1或pkcs8格式。</p></li>     </ol>     <ul>      <li>       <p>以Promise方式生成RSA密钥对为例：</p>       <div _ngcontent-pml-c106="" class="highlight-div"><div _ngcontent-pml-c106="" class="highlight-div-header"><div _ngcontent-pml-c106="" class="highlight-div-header-left"><div _ngcontent-pml-c106="" class="handle-button expand-button"><div _ngcontent-pml-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pml-c106="" class="highlight-div-header-right"><div _ngcontent-pml-c106="" class="handle-button ai-button"></div><div _ngcontent-pml-c106="" class="handle-button line-button"><div _ngcontent-pml-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pml-c106="" class="handle-button theme-button"><div _ngcontent-pml-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pml-c106="" class="handle-button copy-button"><div _ngcontent-pml-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pml-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { cryptoFramework } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.CryptoArchitectureKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">priKeyPkcs1Str1024</span>: <span class="hljs-built_in">string</span>  =</li><li>  <span class="hljs-string">"-----BEGIN RSA PRIVATE KEY-----\n"</span></li><li>  + <span class="hljs-string">"MIICXQIBAAKBgQCwIN3mr21+N96ToxnVnaS+xyK9cNRAHiHGgrbjHw6RAj3V+l+W\n"</span></li><li>  + <span class="hljs-string">"Y68IhIe3DudVlzE9oMjeOQwkMkq//HCxNlIlFR6O6pa0mrXSwPRE7YKG97CeKk2g\n"</span></li><li>  + <span class="hljs-string">"YOS8YEh8toAvm7xKbiLkXuuMlxrjP2j/mb5iI/UASFSPZiQ/IyxDr0AQaQIDAQAB\n"</span></li><li>  + <span class="hljs-string">"AoGAEvBFzBNa+7J4PXnRQlYEK/tvsd0bBZX33ceacMubHl6WVZbphltLq+fMTBPP\n"</span></li><li>  + <span class="hljs-string">"LjXmtpC+aJ7Lvmyl+wTi/TsxE9vxW5JnbuRT48rnZ/Xwq0eozDeEeIBRrpsr7Rvr\n"</span></li><li>  + <span class="hljs-string">"7ctrgzr4m4yMHq9aDgpxj8IR7oHkfwnmWr0wM3FuiVlj650CQQDineeNZ1hUTkj4\n"</span></li><li>  + <span class="hljs-string">"D3O+iCi3mxEVEeJrpqrmSFolRMb+iozrIRKuJlgcOs+Gqi2fHfOTTL7LkpYe8SVg\n"</span></li><li>  + <span class="hljs-string">"e3JxUdVLAkEAxvcZXk+byMFoetrnlcMR13VHUpoVeoV9qkv6CAWLlbMdgf7uKmgp\n"</span></li><li>  + <span class="hljs-string">"a1Yp3QPDNQQqkPvrqtfR19JWZ4uy1qREmwJALTU3BjyBoH/liqb6fh4HkWk75Som\n"</span></li><li>  + <span class="hljs-string">"MzeSjFIOubSYxhq5tgZpBZjcpvUMhV7Zrw54kwASZ+YcUJvmyvKViAm9NQJBAKF7\n"</span></li><li>  + <span class="hljs-string">"DyXSKrem8Ws0m1ybM7HQx5As6l3EVhePDmDQT1eyRbKp+xaD74nkJpnwYdB3jyyY\n"</span></li><li>  + <span class="hljs-string">"qc7A1tj5J5NmeEFolR0CQQCn76Xp8HCjGgLHw9vg7YyIL28y/XyfFyaZAzzK+Yia\n"</span></li><li>  + <span class="hljs-string">"akNwQ6NeGtXSsuGCcyyfpacHp9xy8qXQNKSkw03/5vDO\n"</span></li><li>  + <span class="hljs-string">"-----END RSA PRIVATE KEY-----\n"</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">publicPkcs1Str1024</span>: <span class="hljs-built_in">string</span>  =</li><li>  <span class="hljs-string">"-----BEGIN RSA PUBLIC KEY-----\n"</span></li><li>  + <span class="hljs-string">"MIGJAoGBALAg3eavbX433pOjGdWdpL7HIr1w1EAeIcaCtuMfDpECPdX6X5ZjrwiE\n"</span></li><li>  + <span class="hljs-string">"h7cO51WXMT2gyN45DCQySr/8cLE2UiUVHo7qlrSatdLA9ETtgob3sJ4qTaBg5Lxg\n"</span></li><li>  + <span class="hljs-string">"SHy2gC+bvEpuIuRe64yXGuM/aP+ZvmIj9QBIVI9mJD8jLEOvQBBpAgMBAAE=\n"</span></li><li>  + <span class="hljs-string">"-----END RSA PUBLIC KEY-----\n"</span>;</li><li><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">TestPkcs1ToPkcs8ByPromise</span>(<span class="hljs-params"></span>) {</li><li>  <span class="hljs-keyword">let</span> asyKeyGenerator = cryptoFramework.<span class="hljs-title function_">createAsyKeyGenerator</span>(<span class="hljs-string">'RSA1024'</span>);</li><li>  <span class="hljs-keyword">let</span> keyPair = <span class="hljs-keyword">await</span> asyKeyGenerator.<span class="hljs-title function_">convertPemKey</span>(publicPkcs1Str1024, priKeyPkcs1Str1024);</li><li>  <span class="hljs-keyword">let</span> priPemKey = keyPair.<span class="hljs-property">priKey</span>;</li><li>  <span class="hljs-keyword">let</span> pubPemKey = keyPair.<span class="hljs-property">pubKey</span>;</li><li>  <span class="hljs-keyword">let</span> priString = priPemKey.<span class="hljs-title function_">getEncodedPem</span>(<span class="hljs-string">'PKCS8'</span>);</li><li>  <span class="hljs-keyword">let</span> pubString = pubPemKey.<span class="hljs-title function_">getEncodedPem</span>(<span class="hljs-string">'X509'</span>);</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"[promise]TestPkcs1ToPkcs8ByPromise priString output is "</span> + priString);</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"[promise]TestPkcs1ToPkcs8ByPromise pubString output is "</span> + pubString);</li><li>}</li></ol></pre></div></div></li>      <li>       <p>同步返回结果（调用方法<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-cryptoframework#convertpemkeysync12" target="_blank">convertPemKeySync</a>）：</p>       <div _ngcontent-pml-c106="" class="highlight-div"><div _ngcontent-pml-c106="" class="highlight-div-header"><div _ngcontent-pml-c106="" class="highlight-div-header-left"><div _ngcontent-pml-c106="" class="handle-button expand-button"><div _ngcontent-pml-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pml-c106="" class="highlight-div-header-right"><div _ngcontent-pml-c106="" class="handle-button ai-button"></div><div _ngcontent-pml-c106="" class="handle-button line-button"><div _ngcontent-pml-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pml-c106="" class="handle-button theme-button"><div _ngcontent-pml-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pml-c106="" class="handle-button copy-button"><div _ngcontent-pml-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pml-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { cryptoFramework } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.CryptoArchitectureKit'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">priKeyPkcs1Str1024</span>: <span class="hljs-built_in">string</span>  =</li><li>  <span class="hljs-string">"-----BEGIN RSA PRIVATE KEY-----\n"</span></li><li>  + <span class="hljs-string">"MIICXQIBAAKBgQCwIN3mr21+N96ToxnVnaS+xyK9cNRAHiHGgrbjHw6RAj3V+l+W\n"</span></li><li>  + <span class="hljs-string">"Y68IhIe3DudVlzE9oMjeOQwkMkq//HCxNlIlFR6O6pa0mrXSwPRE7YKG97CeKk2g\n"</span></li><li>  + <span class="hljs-string">"YOS8YEh8toAvm7xKbiLkXuuMlxrjP2j/mb5iI/UASFSPZiQ/IyxDr0AQaQIDAQAB\n"</span></li><li>  + <span class="hljs-string">"AoGAEvBFzBNa+7J4PXnRQlYEK/tvsd0bBZX33ceacMubHl6WVZbphltLq+fMTBPP\n"</span></li><li>  + <span class="hljs-string">"LjXmtpC+aJ7Lvmyl+wTi/TsxE9vxW5JnbuRT48rnZ/Xwq0eozDeEeIBRrpsr7Rvr\n"</span></li><li>  + <span class="hljs-string">"7ctrgzr4m4yMHq9aDgpxj8IR7oHkfwnmWr0wM3FuiVlj650CQQDineeNZ1hUTkj4\n"</span></li><li>  + <span class="hljs-string">"D3O+iCi3mxEVEeJrpqrmSFolRMb+iozrIRKuJlgcOs+Gqi2fHfOTTL7LkpYe8SVg\n"</span></li><li>  + <span class="hljs-string">"e3JxUdVLAkEAxvcZXk+byMFoetrnlcMR13VHUpoVeoV9qkv6CAWLlbMdgf7uKmgp\n"</span></li><li>  + <span class="hljs-string">"a1Yp3QPDNQQqkPvrqtfR19JWZ4uy1qREmwJALTU3BjyBoH/liqb6fh4HkWk75Som\n"</span></li><li>  + <span class="hljs-string">"MzeSjFIOubSYxhq5tgZpBZjcpvUMhV7Zrw54kwASZ+YcUJvmyvKViAm9NQJBAKF7\n"</span></li><li>  + <span class="hljs-string">"DyXSKrem8Ws0m1ybM7HQx5As6l3EVhePDmDQT1eyRbKp+xaD74nkJpnwYdB3jyyY\n"</span></li><li>  + <span class="hljs-string">"qc7A1tj5J5NmeEFolR0CQQCn76Xp8HCjGgLHw9vg7YyIL28y/XyfFyaZAzzK+Yia\n"</span></li><li>  + <span class="hljs-string">"akNwQ6NeGtXSsuGCcyyfpacHp9xy8qXQNKSkw03/5vDO\n"</span></li><li>  + <span class="hljs-string">"-----END RSA PRIVATE KEY-----\n"</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">publicPkcs1Str1024</span>: <span class="hljs-built_in">string</span>  =</li><li>  <span class="hljs-string">"-----BEGIN RSA PUBLIC KEY-----\n"</span></li><li>  + <span class="hljs-string">"MIGJAoGBALAg3eavbX433pOjGdWdpL7HIr1w1EAeIcaCtuMfDpECPdX6X5ZjrwiE\n"</span></li><li>  + <span class="hljs-string">"h7cO51WXMT2gyN45DCQySr/8cLE2UiUVHo7qlrSatdLA9ETtgob3sJ4qTaBg5Lxg\n"</span></li><li>  + <span class="hljs-string">"SHy2gC+bvEpuIuRe64yXGuM/aP+ZvmIj9QBIVI9mJD8jLEOvQBBpAgMBAAE=\n"</span></li><li>  + <span class="hljs-string">"-----END RSA PUBLIC KEY-----\n"</span>;</li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">TestPkcs1ToPkcs8BySync</span>(<span class="hljs-params"></span>) {</li><li>  <span class="hljs-keyword">let</span> asyKeyGenerator = cryptoFramework.<span class="hljs-title function_">createAsyKeyGenerator</span>(<span class="hljs-string">'RSA1024'</span>);</li><li>  <span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">let</span> keyPairData = asyKeyGenerator.<span class="hljs-title function_">convertPemKeySync</span>(publicPkcs1Str1024, priKeyPkcs1Str1024);</li><li>    <span class="hljs-keyword">if</span> (keyPairData !== <span class="hljs-literal">null</span>) {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'[Sync]: convert pem key pair success'</span>);</li><li>    } <span class="hljs-keyword">else</span> {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"[Sync]: convert pem key pair result fail!"</span>);</li><li>    }</li><li>    <span class="hljs-keyword">let</span> priPemKey = keyPairData.<span class="hljs-property">priKey</span>;</li><li>    <span class="hljs-keyword">let</span> pubPemKey = keyPairData.<span class="hljs-property">pubKey</span>;</li><li>    <span class="hljs-keyword">let</span> priString = priPemKey.<span class="hljs-title function_">getEncodedPem</span>(<span class="hljs-string">'PKCS8'</span>);</li><li>    <span class="hljs-keyword">let</span> pubString = pubPemKey.<span class="hljs-title function_">getEncodedPem</span>(<span class="hljs-string">'X509'</span>);</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"[Sync]TestPkcs1ToPkcs8BySync priString output is "</span> + priString);</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"[Sync]TestPkcs1ToPkcs8BySync pubString output is "</span> + pubString);</li><li>  } <span class="hljs-keyword">catch</span> (e) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Sync error, <span class="hljs-subst">${e.code}</span>, <span class="hljs-subst">${e.message}</span>`</span>);</li><li>  }</li><li>}</li></ol></pre></div></div></li>     </ul>    </div>   </div>   <div></div></div>