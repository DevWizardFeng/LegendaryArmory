<h1 _ngcontent-trn-c119="" class="doc-title ng-star-inserted" title="振动开发指导(ArkTS)"> 振动开发指导(ArkTS) </h1>

<div _ngcontent-trn-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <div class="tiledSection">     <h2 id="场景介绍">场景介绍<i class="anchor-icon anchor-icon-link" anchorid="场景介绍" tips="复制节点链接"></i></h2>          <p>当设备需要设置不同的振动效果时，可以调用Vibrator模块，例如：设备的按键可以设置不同强度和不同时长的振动，闹钟和来电可以设置不同强度和时长的单次或周期振动。</p>     <p>详细的接口介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-vibrator" target="_blank">Vibrator接口</a>。</p>    </div>    <div class="tiledSection">     <h2 id="接口说明">接口说明<i class="anchor-icon anchor-icon-link" anchorid="接口说明" tips="复制节点链接"></i></h2>          <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.2.2.1.3.1.1" valign="top" width="50%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.2.2.1.3.1.2" valign="top" width="50%">描述</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="50%">startVibration(effect: VibrateEffect, attribute: VibrateAttribute): Promise&lt;void&gt;</td>         <td class="cellrowborder" valign="top" width="50%">根据指定振动效果和振动属性触发马达振动，使用Promise异步回调。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">startVibration(effect: VibrateEffect, attribute: VibrateAttribute, callback: AsyncCallback&lt;void&gt;): void</td>         <td class="cellrowborder" valign="top" width="50%">根据指定振动效果和振动属性触发马达振动，使用Callback异步回调。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">stopVibration(stopMode: VibratorStopMode): Promise&lt;void&gt;</td>         <td class="cellrowborder" valign="top" width="50%">按照指定模式停止马达的振动，使用Promise异步回调。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">stopVibration(stopMode: VibratorStopMode, callback: AsyncCallback&lt;void&gt;): void</td>         <td class="cellrowborder" valign="top" width="50%">按照指定模式停止马达的振动，使用Callback异步回调。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">stopVibration(): Promise&lt;void&gt;</td>         <td class="cellrowborder" valign="top" width="50%">停止所有模式的马达振动，使用Promise异步回调。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">stopVibration(param?: VibratorInfoParam): Promise&lt;void&gt;</td>         <td class="cellrowborder" valign="top" width="50%">不传参则停止本地设备所有马达的振动，也可传参停止指定马达振动，使用Promise异步回调。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">stopVibration(callback: AsyncCallback&lt;void&gt;): void</td>         <td class="cellrowborder" valign="top" width="50%">停止所有模式的马达振动，使用Callback异步回调。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">isSupportEffect(effectId: string): Promise&lt;boolean&gt;</td>         <td class="cellrowborder" valign="top" width="50%">查询是否支持传入的参数effectId。返回true则表示支持，否则不支持，使用Promise异步回调。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">isSupportEffect(effectId: string, callback: AsyncCallback&lt;boolean&gt;): void</td>         <td class="cellrowborder" valign="top" width="50%">查询是否支持传入的参数effectId。返回true则表示支持，否则不支持，使用Callback异步回调。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">getEffectInfoSync(effectId: string, param?: VibratorInfoParam): EffectInfo</td>         <td class="cellrowborder" valign="top" width="50%">同步查询是否支持传入的参数effectId，param可指定具体马达。返回EffectInfo中isEffectSupported字段可判断是否支持。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">getVibratorInfoSync(param?: VibratorInfoParam): Array&lt;VibratorInfo&gt;</td>         <td class="cellrowborder" valign="top" width="50%">同步查询一个或所有设备的马达信息列表。返回VibratorInfo包含设备ID、马达ID、设备名称、是否支持高清振动、是否本地设备等信息。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">on(type: 'vibratorStateChange', callback: Callback&lt;VibratorStatusEvent&gt;): void</td>         <td class="cellrowborder" valign="top" width="50%">注册马达设备上线下状态变化的监听。callback参数VibratorStatusEvent可返回事件时间戳、设备ID、马达数量、上线或下线等信息。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">off(type: 'vibratorStateChange', callback?: Callback&lt;VibratorStatusEvent&gt;): void</td>         <td class="cellrowborder" valign="top" width="50%">注销马达设备上线下状态变化的监听。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="振动效果说明">振动效果说明<i class="anchor-icon anchor-icon-link" anchorid="振动效果说明" tips="复制节点链接"></i></h2>          <p>目前支持三类振动效果，如下所示：</p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.3.3.1.3.1.1" valign="top" width="50%">名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.3.3.1.3.1.2" valign="top" width="50%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="50%">固定时长振动</td>         <td class="cellrowborder" valign="top" width="50%">传入一个固定时长，马达按照默认强度和频率触发振动，振动效果描述请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-vibrator#vibratetime9" target="_blank">VibrateTime</a>。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">预置振动</td>         <td class="cellrowborder" valign="top" width="50%">系统中的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-vibrator#effectid" target="_blank">预置振动效果</a>，这些效果适用于某些固定场景，比如效果"haptic.clock.timer"通常用于用户调整计时器时的振感反馈，振动效果描述请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-vibrator#vibratepreset9" target="_blank">VibratePreset</a>。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">自定义振动</td>         <td class="cellrowborder" valign="top" width="50%">自定义振动提供给用户设计自己所需振动效果的能力，用户可通过自定义振动配置文件，并遵循相应规则编排所需振动形式，使能更加开放的振感交互体验，效果描述请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-vibrator#vibratefromfile10" target="_blank">VibrateFromFile</a>。</td>        </tr>             </tbody></table></div>     </div>     <p>自定义振动配置文件为Json格式，在形式上如下所示：</p>     <div _ngcontent-trn-c106="" class="highlight-div"><div _ngcontent-trn-c106="" class="highlight-div-header"><div _ngcontent-trn-c106="" class="highlight-div-header-left"><div _ngcontent-trn-c106="" class="handle-button expand-button"><div _ngcontent-trn-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-trn-c106="" class="highlight-div-header-right"><div _ngcontent-trn-c106="" class="handle-button ai-button"></div><div _ngcontent-trn-c106="" class="handle-button line-button"><div _ngcontent-trn-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-trn-c106="" class="handle-button theme-button"><div _ngcontent-trn-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-trn-c106="" class="handle-button copy-button"><div _ngcontent-trn-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-trn-c106="" class="highlight-scroll-div"><pre class="json prettyprint linenums hljs language-json" hw-language="json" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-punctuation">{</span></li><li>    <span class="hljs-attr">"MetaData"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>        <span class="hljs-attr">"Create"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2023-01-09"</span><span class="hljs-punctuation">,</span></li><li>        <span class="hljs-attr">"Description"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"a haptic case"</span><span class="hljs-punctuation">,</span></li><li>        <span class="hljs-attr">"Version"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1.0</span><span class="hljs-punctuation">,</span></li><li>        <span class="hljs-attr">"ChannelNumber"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span></li><li>    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span></li><li>    <span class="hljs-attr">"Channels"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span></li><li>        <span class="hljs-punctuation">{</span></li><li>            <span class="hljs-attr">"Parameters"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>                <span class="hljs-attr">"Index"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span></li><li>            <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span></li><li>            <span class="hljs-attr">"Pattern"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span></li><li>                <span class="hljs-punctuation">{</span></li><li>                    <span class="hljs-attr">"Event"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>                        <span class="hljs-attr">"Type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"transient"</span><span class="hljs-punctuation">,</span></li><li>                        <span class="hljs-attr">"StartTime"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span></li><li>                        <span class="hljs-attr">"Parameters"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>                            <span class="hljs-attr">"Frequency"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">31</span><span class="hljs-punctuation">,</span></li><li>                            <span class="hljs-attr">"Intensity"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">100</span></li><li>                        <span class="hljs-punctuation">}</span></li><li>                    <span class="hljs-punctuation">}</span></li><li>                <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span></li><li>                <span class="hljs-punctuation">{</span></li><li>                    <span class="hljs-attr">"Event"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>                        <span class="hljs-attr">"Type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"continuous"</span><span class="hljs-punctuation">,</span></li><li>                        <span class="hljs-attr">"StartTime"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">40</span><span class="hljs-punctuation">,</span></li><li>                        <span class="hljs-attr">"Duration"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">54</span><span class="hljs-punctuation">,</span></li><li>                        <span class="hljs-attr">"Parameters"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>                            <span class="hljs-attr">"Frequency"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">30</span><span class="hljs-punctuation">,</span></li><li>                            <span class="hljs-attr">"Intensity"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">38</span><span class="hljs-punctuation">,</span></li><li>                            <span class="hljs-attr">"Curve"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span></li><li>                                <span class="hljs-punctuation">{</span></li><li>                                    <span class="hljs-attr">"Time"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span></li><li>                                    <span class="hljs-attr">"Frequency"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span></li><li>                                    <span class="hljs-attr">"Intensity"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span></li><li>                                <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span></li><li>                                <span class="hljs-punctuation">{</span></li><li>                                    <span class="hljs-attr">"Time"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span></li><li>                                    <span class="hljs-attr">"Frequency"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">15</span><span class="hljs-punctuation">,</span></li><li>                                    <span class="hljs-attr">"Intensity"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0.5</span></li><li>                                <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span></li><li>                                <span class="hljs-punctuation">{</span></li><li>                                    <span class="hljs-attr">"Time"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">40</span><span class="hljs-punctuation">,</span></li><li>                                    <span class="hljs-attr">"Frequency"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">-8</span><span class="hljs-punctuation">,</span></li><li>                                    <span class="hljs-attr">"Intensity"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1.0</span></li><li>                                <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span></li><li>                                <span class="hljs-punctuation">{</span></li><li>                                    <span class="hljs-attr">"Time"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">54</span><span class="hljs-punctuation">,</span></li><li>                                    <span class="hljs-attr">"Frequency"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span></li><li>                                    <span class="hljs-attr">"Intensity"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span></li><li>                                <span class="hljs-punctuation">}</span></li><li>                            <span class="hljs-punctuation">]</span></li><li>                        <span class="hljs-punctuation">}</span></li><li>                    <span class="hljs-punctuation">}</span></li><li>                <span class="hljs-punctuation">}</span></li><li>            <span class="hljs-punctuation">]</span></li><li>        <span class="hljs-punctuation">}</span></li><li>    <span class="hljs-punctuation">]</span></li><li><span class="hljs-punctuation">}</span></li></ol></pre></div></div>     <p>Json文件共包含3个属性。</p>     <ol>      <li>       <p>"MetaData"属性中为文件头信息，可在如下属性中添加描述：</p>       <div class="tablenoborder">        <div class="tbBox"><table class="layoutFixed idpTab">         <thead>          <tr>           <th align="left" class="cellrowborder" id="mcps1.3.3.7.1.2.1.4.1.1" valign="top" width="33.33333333333333%">名称</th>           <th align="left" class="cellrowborder" id="mcps1.3.3.7.1.2.1.4.1.2" valign="top" width="33.33333333333333%">必填项</th>           <th align="left" class="cellrowborder" id="mcps1.3.3.7.1.2.1.4.1.3" valign="top" width="33.33333333333333%">说明</th>          </tr>         </thead>                   <tbody><tr>           <td class="cellrowborder" valign="top" width="33.33333333333333%">Version</td>           <td class="cellrowborder" valign="top" width="33.33333333333333%">是</td>           <td class="cellrowborder" valign="top" width="33.33333333333333%">文件格式的版本号，向前兼容，目前支持版本1.0。</td>          </tr>          <tr>           <td class="cellrowborder" valign="top" width="33.33333333333333%">ChannelNumber</td>           <td class="cellrowborder" valign="top" width="33.33333333333333%">是</td>           <td class="cellrowborder" valign="top" width="33.33333333333333%">表示马达振动的通道数，最大支持双马达通道。</td>          </tr>          <tr>           <td class="cellrowborder" valign="top" width="33.33333333333333%">Create</td>           <td class="cellrowborder" valign="top" width="33.33333333333333%">否</td>           <td class="cellrowborder" valign="top" width="33.33333333333333%">可记录文件创作时间。</td>          </tr>          <tr>           <td class="cellrowborder" valign="top" width="33.33333333333333%">Description</td>           <td class="cellrowborder" valign="top" width="33.33333333333333%">否</td>           <td class="cellrowborder" valign="top" width="33.33333333333333%">可指明振动效果、创建信息等附加说明。</td>          </tr>                 </tbody></table></div>       </div></li>      <li>       <p>"Channels"属性中为马达振动通道的相关信息。</p>       <p>"Channels"是Json数组，表示各个通道的信息，包含2个属性。</p>       <div class="tablenoborder">        <div class="tbBox"><table class="layoutFixed idpTab">         <thead>          <tr>           <th align="left" class="cellrowborder" id="mcps1.3.3.7.2.3.1.4.1.1" valign="top" width="33.33333333333333%">名称</th>           <th align="left" class="cellrowborder" id="mcps1.3.3.7.2.3.1.4.1.2" valign="top" width="33.33333333333333%">必填项</th>           <th align="left" class="cellrowborder" id="mcps1.3.3.7.2.3.1.4.1.3" valign="top" width="33.33333333333333%">说明</th>          </tr>         </thead>                   <tbody><tr>           <td class="cellrowborder" valign="top" width="33.33333333333333%">Parameters</td>           <td class="cellrowborder" valign="top" width="33.33333333333333%">是</td>           <td class="cellrowborder" valign="top" width="33.33333333333333%">为通道参数。其中"Index"表示通道编号，0表示全通道发送，1、2分别对应左右马达。0不能与其他通道编号同时作为配置参数。</td>          </tr>          <tr>           <td class="cellrowborder" valign="top" width="33.33333333333333%">Pattern</td>           <td class="cellrowborder" valign="top" width="33.33333333333333%">否</td>           <td class="cellrowborder" valign="top" width="33.33333333333333%">马达振动序列。</td>          </tr>                 </tbody></table></div>       </div>       <p>"Pattern"是Json数组，包含振动事件序列，每个"Event"属性代表1个振动事件，支持添加2种振动类型。</p>       <div class="tablenoborder">        <div class="tbBox"><table class="layoutFixed idpTab">         <thead>          <tr>           <th align="left" class="cellrowborder" id="mcps1.3.3.7.2.5.1.3.1.1" valign="top" width="50%">振动类型</th>           <th align="left" class="cellrowborder" id="mcps1.3.3.7.2.5.1.3.1.2" valign="top" width="50%">说明</th>          </tr>         </thead>                   <tbody><tr>           <td class="cellrowborder" valign="top" width="50%">transient</td>           <td class="cellrowborder" valign="top" width="50%">瞬态短振动，干脆有力。</td>          </tr>          <tr>           <td class="cellrowborder" valign="top" width="50%">continuous</td>           <td class="cellrowborder" valign="top" width="50%">稳态长振动，具备长时间输出强劲有力振动的能力。</td>          </tr>                 </tbody></table></div>       </div>       <p>"Event"表示一个振动事件，包含如下属性：</p>       <div class="tablenoborder">        <div class="tbBox"><table class="layoutFixed idpTab">         <thead>          <tr>           <th align="left" class="cellrowborder" id="mcps1.3.3.7.2.7.1.4.1.1" valign="top" width="33.33333333333333%">名称</th>           <th align="left" class="cellrowborder" id="mcps1.3.3.7.2.7.1.4.1.2" valign="top" width="33.33333333333333%">必填项</th>           <th align="left" class="cellrowborder" id="mcps1.3.3.7.2.7.1.4.1.3" valign="top" width="33.33333333333333%">说明</th>          </tr>         </thead>                   <tbody><tr>           <td class="cellrowborder" valign="top" width="33.33333333333333%">Type</td>           <td class="cellrowborder" valign="top" width="33.33333333333333%">是</td>           <td class="cellrowborder" valign="top" width="33.33333333333333%">振动事件类型，为"transient" 或"continuous"。</td>          </tr>          <tr>           <td class="cellrowborder" valign="top" width="33.33333333333333%">StartTime</td>           <td class="cellrowborder" valign="top" width="33.33333333333333%">是</td>           <td class="cellrowborder" valign="top" width="33.33333333333333%">振动的起始时间，单位ms，有效范围为[0, 1800,000]。</td>          </tr>          <tr>           <td class="cellrowborder" valign="top" width="33.33333333333333%">Duration</td>           <td class="cellrowborder" valign="top" width="33.33333333333333%">是</td>           <td class="cellrowborder" valign="top" width="33.33333333333333%">振动持续时间，仅当类型为"continuous"时有效，单位ms，有效范围为[0, 5000]。</td>          </tr>                 </tbody></table></div>       </div></li>      <li>       <p>"Parameters"表示振动事件参数设置，必填项，可设置以下属性参数：</p>       <div class="tablenoborder">        <div class="tbBox"><table class="layoutFixed idpTab">         <thead>          <tr>           <th align="left" class="cellrowborder" id="mcps1.3.3.7.3.2.1.4.1.1" valign="top" width="33.33333333333333%">名称</th>           <th align="left" class="cellrowborder" id="mcps1.3.3.7.3.2.1.4.1.2" valign="top" width="33.33333333333333%">必填项</th>           <th align="left" class="cellrowborder" id="mcps1.3.3.7.3.2.1.4.1.3" valign="top" width="33.33333333333333%">说明</th>          </tr>         </thead>                   <tbody><tr>           <td class="cellrowborder" valign="top" width="33.33333333333333%">Intensity</td>           <td class="cellrowborder" valign="top" width="33.33333333333333%">是</td>           <td class="cellrowborder" valign="top" width="33.33333333333333%">振动事件强度，有效范围为[0, 100]，数字大小代表最大振动量的xx%。</td>          </tr>          <tr>           <td class="cellrowborder" valign="top" width="33.33333333333333%">Frequency</td>           <td class="cellrowborder" valign="top" width="33.33333333333333%">是</td>           <td class="cellrowborder" valign="top" width="33.33333333333333%">振动事件频率，有效范围为[0, 100]，一般支持频率调节的马达设置为55时为器件的谐振频率，此时振动量最大，越靠近谐振频率的振动，同强度设置的振动量越大。</td>          </tr>          <tr>           <td class="cellrowborder" valign="top" width="33.33333333333333%">Curve</td>           <td class="cellrowborder" valign="top" width="33.33333333333333%">否</td>           <td class="cellrowborder" valign="top" width="33.33333333333333%">            <p>振动曲线，当振动事件类型为"continuous"时有效，为Json数组，支持设置一组调节点，调节点数量最大支持16个，最小为4个，每个调节点需包含如下属性：</p>            <p>"Time"：相对事件起始时间的偏移，最小为0，最大不能超过事件振动时长；</p>            <p>"Intensity"：相对事件振动强度的增益，范围为[0, 1]，此值乘上振动事件强度为对应时间点调节后的强度；</p>            <p>"Frequency"：相对事件振动频率的变化，范围为[-100, 100]，此值加上振动事件频率为对应时间点调节后的频率。</p></td>          </tr>                 </tbody></table></div>       </div></li>     </ol>     <p>其他要求：</p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.3.9.1.3.1.1" valign="top" width="50%">参数</th>         <th align="left" class="cellrowborder" id="mcps1.3.3.9.1.3.1.2" valign="top" width="50%">要求</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="50%">振动事件(event)的数量</td>         <td class="cellrowborder" valign="top" width="50%">不得超过128个。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">振动配置文件长度</td>         <td class="cellrowborder" valign="top" width="50%">不得超过64KB。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="开发步骤">开发步骤<i class="anchor-icon anchor-icon-link" anchorid="开发步骤" tips="复制节点链接"></i></h2>          <ol>      <li>       <p>控制设备上的振动器，需要申请权限ohos.permission.VIBRATE。具体配置方式请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/declare-permissions">声明权限</a>。</p></li>      <li>       <p>振动器查询。</p></li>     </ol>     <p><strong>情形一</strong> 查询所有马达信息：</p>     <div _ngcontent-trn-c106="" class="highlight-div"><div _ngcontent-trn-c106="" class="highlight-div-header"><div _ngcontent-trn-c106="" class="highlight-div-header-left"><div _ngcontent-trn-c106="" class="handle-button expand-button"><div _ngcontent-trn-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-trn-c106="" class="highlight-div-header-right"><div _ngcontent-trn-c106="" class="handle-button ai-button"></div><div _ngcontent-trn-c106="" class="handle-button line-button"><div _ngcontent-trn-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-trn-c106="" class="handle-button theme-button"><div _ngcontent-trn-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-trn-c106="" class="handle-button copy-button"><div _ngcontent-trn-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-trn-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li> <span class="hljs-keyword">import</span> { vibrator } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.SensorServiceKit'</span>;</li><li> <span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">try</span> {</li><li>  <span class="hljs-keyword">const</span> <span class="hljs-attr">vibratorInfoList</span>: vibrator.<span class="hljs-property">VibratorInfo</span>[] = vibrator.<span class="hljs-title function_">getVibratorInfoSync</span>();</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`vibratorInfoList: <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(vibratorInfoList)}</span>`</span>);</li><li>} <span class="hljs-keyword">catch</span> (error) {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">e</span>: <span class="hljs-title class_">BusinessError</span> = error <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>;</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`An unexpected error occurred. Code: <span class="hljs-subst">${e.code}</span>, message: <span class="hljs-subst">${e.message}</span>`</span>);</li><li>}</li></ol></pre></div></div>     <p><strong>情形二</strong> 查询指定设备的一个或多个马达信息：</p>     <div _ngcontent-trn-c106="" class="highlight-div"><div _ngcontent-trn-c106="" class="highlight-div-header"><div _ngcontent-trn-c106="" class="highlight-div-header-left"><div _ngcontent-trn-c106="" class="handle-button expand-button"><div _ngcontent-trn-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-trn-c106="" class="highlight-div-header-right"><div _ngcontent-trn-c106="" class="handle-button ai-button"></div><div _ngcontent-trn-c106="" class="handle-button line-button"><div _ngcontent-trn-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-trn-c106="" class="handle-button theme-button"><div _ngcontent-trn-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-trn-c106="" class="handle-button copy-button"><div _ngcontent-trn-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-trn-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li> <span class="hljs-keyword">import</span> { vibrator } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.SensorServiceKit'</span>;</li><li> <span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">try</span> {</li><li>  <span class="hljs-keyword">const</span> <span class="hljs-attr">vibratorParam</span>: vibrator.<span class="hljs-property">VibratorInfoParam</span> = {</li><li>    <span class="hljs-attr">deviceId</span>: <span class="hljs-number">1</span>    <span class="hljs-comment">// deviceid 需要是查询出来真实存在的设备</span></li><li>  }</li><li>  <span class="hljs-keyword">const</span> <span class="hljs-attr">vibratorInfoList</span>: vibrator.<span class="hljs-property">VibratorInfo</span>[] = vibrator.<span class="hljs-title function_">getVibratorInfoSync</span>(vibratorParam);</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`vibratorInfoList: <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(vibratorInfoList)}</span>`</span>);</li><li>} <span class="hljs-keyword">catch</span> (error) {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">e</span>: <span class="hljs-title class_">BusinessError</span> = error <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>;</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`An unexpected error occurred. Code: <span class="hljs-subst">${e.code}</span>, message: <span class="hljs-subst">${e.message}</span>`</span>);</li><li>}</li></ol></pre></div></div>     <ol>      <li>       <p>根据指定振动效果和振动属性触发马达振动。</p>       <p><strong>情形一</strong> 按照指定持续时间触发马达振动：</p>       <div _ngcontent-trn-c106="" class="highlight-div"><div _ngcontent-trn-c106="" class="highlight-div-header"><div _ngcontent-trn-c106="" class="highlight-div-header-left"><div _ngcontent-trn-c106="" class="handle-button expand-button"><div _ngcontent-trn-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-trn-c106="" class="highlight-div-header-right"><div _ngcontent-trn-c106="" class="handle-button ai-button"></div><div _ngcontent-trn-c106="" class="handle-button line-button"><div _ngcontent-trn-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-trn-c106="" class="handle-button theme-button"><div _ngcontent-trn-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-trn-c106="" class="handle-button copy-button"><div _ngcontent-trn-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-trn-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { vibrator } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.SensorServiceKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">try</span> {</li><li>  <span class="hljs-comment">// 触发马达振动</span></li><li>  vibrator.<span class="hljs-title function_">startVibration</span>({</li><li>    <span class="hljs-attr">type</span>: <span class="hljs-string">'time'</span>,</li><li>    <span class="hljs-attr">duration</span>: <span class="hljs-number">1000</span>,</li><li>  }, {</li><li>    <span class="hljs-attr">id</span>: <span class="hljs-number">0</span>,</li><li>    <span class="hljs-attr">usage</span>: <span class="hljs-string">'alarm'</span></li><li>  }, <span class="hljs-function">(<span class="hljs-params">error: BusinessError</span>) =&gt;</span> {</li><li>    <span class="hljs-keyword">if</span> (error) {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Failed to start vibration. Code: <span class="hljs-subst">${error.code}</span>, message: <span class="hljs-subst">${error.message}</span>`</span>);</li><li>      <span class="hljs-keyword">return</span>;</li><li>    }</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Succeed in starting vibration'</span>);</li><li>  });</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">e</span>: <span class="hljs-title class_">BusinessError</span> = err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>;</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`An unexpected error occurred. Code: <span class="hljs-subst">${e.code}</span>, message: <span class="hljs-subst">${e.message}</span>`</span>);</li><li>}</li></ol></pre></div></div>       <p><strong>情形二</strong> 按照预置振动效果触发马达振动，可先查询振动效果是否被支持，再调用振动接口：</p>       <div _ngcontent-trn-c106="" class="highlight-div"><div _ngcontent-trn-c106="" class="highlight-div-header"><div _ngcontent-trn-c106="" class="highlight-div-header-left"><div _ngcontent-trn-c106="" class="handle-button expand-button"><div _ngcontent-trn-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-trn-c106="" class="highlight-div-header-right"><div _ngcontent-trn-c106="" class="handle-button ai-button"></div><div _ngcontent-trn-c106="" class="handle-button line-button"><div _ngcontent-trn-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-trn-c106="" class="handle-button theme-button"><div _ngcontent-trn-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-trn-c106="" class="handle-button copy-button"><div _ngcontent-trn-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-trn-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { vibrator } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.SensorServiceKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">try</span> {</li><li>  <span class="hljs-comment">// 查询是否支持'haptic.effect.soft'</span></li><li>  vibrator.<span class="hljs-title function_">isSupportEffect</span>(<span class="hljs-string">'haptic.effect.soft'</span>, <span class="hljs-function">(<span class="hljs-params">err: BusinessError, state: <span class="hljs-built_in">boolean</span></span>) =&gt;</span> {</li><li>    <span class="hljs-keyword">if</span> (err) {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Failed to query effect. Code: <span class="hljs-subst">${err.code}</span>, message: <span class="hljs-subst">${err.message}</span>`</span>);</li><li>      <span class="hljs-keyword">return</span>;</li><li>    }</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Succeed in querying effect'</span>);</li><li>    <span class="hljs-keyword">if</span> (state) {</li><li>      <span class="hljs-keyword">try</span> {</li><li>        <span class="hljs-comment">// 触发马达振动</span></li><li>        vibrator.<span class="hljs-title function_">startVibration</span>({</li><li>          <span class="hljs-attr">type</span>: <span class="hljs-string">'preset'</span>,</li><li>          <span class="hljs-attr">effectId</span>: <span class="hljs-string">'haptic.effect.soft'</span>,</li><li>          <span class="hljs-attr">count</span>: <span class="hljs-number">1</span>,</li><li>          <span class="hljs-attr">intensity</span>: <span class="hljs-number">50</span>,</li><li>        }, {</li><li>          <span class="hljs-attr">usage</span>: <span class="hljs-string">'unknown'</span></li><li>        }, <span class="hljs-function">(<span class="hljs-params">error: BusinessError</span>) =&gt;</span> {</li><li>          <span class="hljs-keyword">if</span> (error) {</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Failed to start vibration. Code: <span class="hljs-subst">${error.code}</span>, message: <span class="hljs-subst">${error.message}</span>`</span>);</li><li>          } <span class="hljs-keyword">else</span> {</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Succeed in starting vibration'</span>);</li><li>          }</li><li>        });</li><li>      } <span class="hljs-keyword">catch</span> (error) {</li><li>        <span class="hljs-keyword">let</span> <span class="hljs-attr">e</span>: <span class="hljs-title class_">BusinessError</span> = error <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>;</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`An unexpected error occurred. Code: <span class="hljs-subst">${e.code}</span>, message: <span class="hljs-subst">${e.message}</span>`</span>);</li><li>      }</li><li>    }</li><li>  })</li><li>} <span class="hljs-keyword">catch</span> (error) {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">e</span>: <span class="hljs-title class_">BusinessError</span> = error <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>;</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`An unexpected error occurred. Code: <span class="hljs-subst">${e.code}</span>, message: <span class="hljs-subst">${e.message}</span>`</span>);</li><li>}</li></ol></pre></div></div>       <p><strong>情形三</strong> 按照自定义振动配置文件触发马达振动：</p>       <div _ngcontent-trn-c106="" class="highlight-div"><div _ngcontent-trn-c106="" class="highlight-div-header"><div _ngcontent-trn-c106="" class="highlight-div-header-left"><div _ngcontent-trn-c106="" class="handle-button expand-button"><div _ngcontent-trn-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-trn-c106="" class="highlight-div-header-right"><div _ngcontent-trn-c106="" class="handle-button ai-button"></div><div _ngcontent-trn-c106="" class="handle-button line-button"><div _ngcontent-trn-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-trn-c106="" class="handle-button theme-button"><div _ngcontent-trn-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-trn-c106="" class="handle-button copy-button"><div _ngcontent-trn-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-trn-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { vibrator } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.SensorServiceKit'</span>;</li><li><span class="hljs-keyword">import</span> { resourceManager } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.LocalizationKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">const</span> <span class="hljs-attr">fileName</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'xxx.json'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  uiContext = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>();</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Row</span>() {</li><li>      <span class="hljs-title class_">Column</span>() {</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">'alarm-file'</span>)</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-comment">// 获取文件资源描述符</span></li><li>            <span class="hljs-keyword">let</span> <span class="hljs-attr">rawFd</span>: resourceManager.<span class="hljs-property">RawFileDescriptor</span> | <span class="hljs-literal">undefined</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">uiContext</span>.<span class="hljs-title function_">getHostContext</span>()?.<span class="hljs-property">resourceManager</span>.<span class="hljs-title function_">getRawFdSync</span>(fileName);</li><li>            <span class="hljs-keyword">if</span> (rawFd != <span class="hljs-literal">undefined</span>) {</li><li>              <span class="hljs-comment">// 触发马达振动</span></li><li>              <span class="hljs-keyword">try</span> {</li><li>                vibrator.<span class="hljs-title function_">startVibration</span>({</li><li>                  <span class="hljs-attr">type</span>: <span class="hljs-string">"file"</span>,</li><li>                  <span class="hljs-attr">hapticFd</span>: { <span class="hljs-attr">fd</span>: rawFd.<span class="hljs-property">fd</span>, <span class="hljs-attr">offset</span>: rawFd.<span class="hljs-property">offset</span>, <span class="hljs-attr">length</span>: rawFd.<span class="hljs-property">length</span> }</li><li>                }, {</li><li>                  <span class="hljs-attr">id</span>: <span class="hljs-number">0</span>,</li><li>                  <span class="hljs-attr">usage</span>: <span class="hljs-string">'alarm'</span> <span class="hljs-comment">// 根据实际选择类型归属不同的开关管控</span></li><li>                }, <span class="hljs-function">(<span class="hljs-params">error: BusinessError</span>) =&gt;</span> {</li><li>                  <span class="hljs-keyword">if</span> (error) {</li><li>                    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Failed to start vibration. Code: <span class="hljs-subst">${error.code}</span>, message: <span class="hljs-subst">${error.message}</span>`</span>);</li><li>                    <span class="hljs-keyword">return</span>;</li><li>                  }</li><li>                  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Succeed in starting vibration'</span>);</li><li>                });</li><li>              } <span class="hljs-keyword">catch</span> (err) {</li><li>                <span class="hljs-keyword">let</span> <span class="hljs-attr">e</span>: <span class="hljs-title class_">BusinessError</span> = err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>;</li><li>                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`An unexpected error occurred. Code: <span class="hljs-subst">${e.code}</span>, message: <span class="hljs-subst">${e.message}</span>`</span>);</li><li>              } <span class="hljs-keyword">finally</span> {</li><li>                vibrator.<span class="hljs-title function_">stopVibration</span>();</li><li>                <span class="hljs-variable language_">this</span>.<span class="hljs-property">uiContext</span>.<span class="hljs-title function_">getHostContext</span>()?.<span class="hljs-property">resourceManager</span>.<span class="hljs-title function_">closeRawFdSync</span>(fileName);</li><li>              }</li><li>            }</li><li>          })</li><li>      }</li><li>      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    }</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div></li>      <li>       <p>停止马达的振动。</p>       <p><strong>方式一</strong> 按照指定模式停止对应的马达振动，自定义振动不支持此类停止方式：</p>       <p>​ 停止固定时长振动：</p>       <div _ngcontent-trn-c106="" class="highlight-div"><div _ngcontent-trn-c106="" class="highlight-div-header"><div _ngcontent-trn-c106="" class="highlight-div-header-left"><div _ngcontent-trn-c106="" class="handle-button expand-button"><div _ngcontent-trn-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-trn-c106="" class="highlight-div-header-right"><div _ngcontent-trn-c106="" class="handle-button ai-button"></div><div _ngcontent-trn-c106="" class="handle-button line-button"><div _ngcontent-trn-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-trn-c106="" class="handle-button theme-button"><div _ngcontent-trn-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-trn-c106="" class="handle-button copy-button"><div _ngcontent-trn-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-trn-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { vibrator } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.SensorServiceKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">try</span> {</li><li>  <span class="hljs-comment">// 按照VIBRATOR_STOP_MODE_TIME模式停止振动</span></li><li>  vibrator.<span class="hljs-title function_">stopVibration</span>(vibrator.<span class="hljs-property">VibratorStopMode</span>.<span class="hljs-property">VIBRATOR_STOP_MODE_TIME</span>, <span class="hljs-function">(<span class="hljs-params">error: BusinessError</span>) =&gt;</span> {</li><li>    <span class="hljs-keyword">if</span> (error) {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Failed to stop vibration. Code: <span class="hljs-subst">${error.code}</span>, message: <span class="hljs-subst">${error.message}</span>`</span>);</li><li>      <span class="hljs-keyword">return</span>;</li><li>    }</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Succeed in stopping vibration'</span>);</li><li>  })</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">e</span>: <span class="hljs-title class_">BusinessError</span> = err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>;</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`An unexpected error occurred. Code: <span class="hljs-subst">${e.code}</span>, message: <span class="hljs-subst">${e.message}</span>`</span>);</li><li>}</li></ol></pre></div></div>       <p>​ 停止预置振动：</p>       <div _ngcontent-trn-c106="" class="highlight-div"><div _ngcontent-trn-c106="" class="highlight-div-header"><div _ngcontent-trn-c106="" class="highlight-div-header-left"><div _ngcontent-trn-c106="" class="handle-button expand-button"><div _ngcontent-trn-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-trn-c106="" class="highlight-div-header-right"><div _ngcontent-trn-c106="" class="handle-button ai-button"></div><div _ngcontent-trn-c106="" class="handle-button line-button"><div _ngcontent-trn-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-trn-c106="" class="handle-button theme-button"><div _ngcontent-trn-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-trn-c106="" class="handle-button copy-button"><div _ngcontent-trn-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-trn-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { vibrator } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.SensorServiceKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">try</span> {</li><li>  <span class="hljs-comment">// 按照VIBRATOR_STOP_MODE_PRESET模式停止振动</span></li><li>  vibrator.<span class="hljs-title function_">stopVibration</span>(vibrator.<span class="hljs-property">VibratorStopMode</span>.<span class="hljs-property">VIBRATOR_STOP_MODE_PRESET</span>, <span class="hljs-function">(<span class="hljs-params">error: BusinessError</span>) =&gt;</span> {</li><li>    <span class="hljs-keyword">if</span> (error) {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Failed to stop vibration. Code: <span class="hljs-subst">${error.code}</span>, message: <span class="hljs-subst">${error.message}</span>`</span>);</li><li>      <span class="hljs-keyword">return</span>;</li><li>    }</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Succeed in stopping vibration'</span>);</li><li>  })</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">e</span>: <span class="hljs-title class_">BusinessError</span> = err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>;</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`An unexpected error occurred. Code: <span class="hljs-subst">${e.code}</span>, message: <span class="hljs-subst">${e.message}</span>`</span>);</li><li>}</li></ol></pre></div></div>       <p><strong>方式二</strong> 停止所有模式的马达振动，包括自定义振动：</p>       <div _ngcontent-trn-c106="" class="highlight-div"><div _ngcontent-trn-c106="" class="highlight-div-header"><div _ngcontent-trn-c106="" class="highlight-div-header-left"><div _ngcontent-trn-c106="" class="handle-button expand-button"><div _ngcontent-trn-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-trn-c106="" class="highlight-div-header-right"><div _ngcontent-trn-c106="" class="handle-button ai-button"></div><div _ngcontent-trn-c106="" class="handle-button line-button"><div _ngcontent-trn-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-trn-c106="" class="handle-button theme-button"><div _ngcontent-trn-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-trn-c106="" class="handle-button copy-button"><div _ngcontent-trn-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-trn-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { vibrator } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.SensorServiceKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">try</span> {</li><li>  <span class="hljs-comment">// 停止所有模式的马达振动</span></li><li>  vibrator.<span class="hljs-title function_">stopVibration</span>(<span class="hljs-function">(<span class="hljs-params">error: BusinessError</span>) =&gt;</span> {</li><li>    <span class="hljs-keyword">if</span> (error) {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Failed to stop vibration. Code: <span class="hljs-subst">${error.code}</span>, message: <span class="hljs-subst">${error.message}</span>`</span>);</li><li>      <span class="hljs-keyword">return</span>;</li><li>    }</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Succeed in stopping vibration'</span>);</li><li>  })</li><li>} <span class="hljs-keyword">catch</span> (error) {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">e</span>: <span class="hljs-title class_">BusinessError</span> = error <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>;</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`An unexpected error occurred. Code: <span class="hljs-subst">${e.code}</span>, message: <span class="hljs-subst">${e.message}</span>`</span>);</li><li>}</li></ol></pre></div></div>       <p><strong>方式三</strong> 停止指定设备的振动：</p>       <div _ngcontent-trn-c106="" class="highlight-div"><div _ngcontent-trn-c106="" class="highlight-div-header"><div _ngcontent-trn-c106="" class="highlight-div-header-left"><div _ngcontent-trn-c106="" class="handle-button expand-button"><div _ngcontent-trn-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-trn-c106="" class="highlight-div-header-right"><div _ngcontent-trn-c106="" class="handle-button ai-button"></div><div _ngcontent-trn-c106="" class="handle-button line-button"><div _ngcontent-trn-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-trn-c106="" class="handle-button theme-button"><div _ngcontent-trn-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-trn-c106="" class="handle-button copy-button"><div _ngcontent-trn-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-trn-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { vibrator } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.SensorServiceKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li> </li><li><span class="hljs-keyword">const</span> <span class="hljs-attr">vibratorInfoParam</span>: vibrator.<span class="hljs-property">VibratorInfoParam</span> = {</li><li>  <span class="hljs-attr">deviceId</span>: <span class="hljs-number">1</span>   <span class="hljs-comment">// deviceid 需要是查询出来真实存在的设备</span></li><li>}</li><li><span class="hljs-keyword">try</span> {</li><li>  vibrator.<span class="hljs-title function_">stopVibration</span>(vibratorInfoParam).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Succeed in stopping vibration'</span>);</li><li>  }, <span class="hljs-function">(<span class="hljs-params">error: BusinessError</span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Failed to stop vibration. Code: <span class="hljs-subst">${error.code}</span>, message: <span class="hljs-subst">${error.message}</span>`</span>);</li><li>  });</li><li>} <span class="hljs-keyword">catch</span> (error) {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">e</span>: <span class="hljs-title class_">BusinessError</span> = error <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>;</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`An unexpected error occurred. Code: <span class="hljs-subst">${e.code}</span>, message: <span class="hljs-subst">${e.message}</span>`</span>);</li><li>}</li></ol></pre></div></div></li>      <li>       <p>动态马达状态变化监听。</p>       <p>注册监听。</p>       <div _ngcontent-trn-c106="" class="highlight-div"><div _ngcontent-trn-c106="" class="highlight-div-header"><div _ngcontent-trn-c106="" class="highlight-div-header-left"><div _ngcontent-trn-c106="" class="handle-button expand-button"><div _ngcontent-trn-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-trn-c106="" class="highlight-div-header-right"><div _ngcontent-trn-c106="" class="handle-button ai-button"></div><div _ngcontent-trn-c106="" class="handle-button line-button"><div _ngcontent-trn-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-trn-c106="" class="handle-button theme-button"><div _ngcontent-trn-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-trn-c106="" class="handle-button copy-button"><div _ngcontent-trn-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-trn-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { vibrator } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.SensorServiceKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-comment">// 回调函数</span></li><li><span class="hljs-keyword">const</span> <span class="hljs-title function_">vibratorStateChangeCallback</span> = (<span class="hljs-params">data: vibrator.VibratorStatusEvent</span>) =&gt; {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'vibrator state callback info:'</span>, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data));</li><li>}</li><li>
</li><li><span class="hljs-keyword">try</span> {</li><li>  <span class="hljs-comment">// 订阅 vibratorStateChange事件</span></li><li>  vibrator.<span class="hljs-title function_">on</span>(<span class="hljs-string">'vibratorStateChange'</span>, vibratorStateChangeCallback);</li><li>} <span class="hljs-keyword">catch</span> (error) {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">e</span>: <span class="hljs-title class_">BusinessError</span> = error <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>;</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`An unexpected error occurred. Code: <span class="hljs-subst">${e.code}</span>, message: <span class="hljs-subst">${e.message}</span>`</span>);</li><li>}</li></ol></pre></div></div>       <p>取消监听,取消传入的callback需与注册的一致。</p>       <div _ngcontent-trn-c106="" class="highlight-div"><div _ngcontent-trn-c106="" class="highlight-div-header"><div _ngcontent-trn-c106="" class="highlight-div-header-left"><div _ngcontent-trn-c106="" class="handle-button expand-button"><div _ngcontent-trn-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-trn-c106="" class="highlight-div-header-right"><div _ngcontent-trn-c106="" class="handle-button ai-button"></div><div _ngcontent-trn-c106="" class="handle-button line-button"><div _ngcontent-trn-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-trn-c106="" class="handle-button theme-button"><div _ngcontent-trn-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-trn-c106="" class="handle-button copy-button"><div _ngcontent-trn-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-trn-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { vibrator } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.SensorServiceKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-comment">// 回调函数</span></li><li><span class="hljs-keyword">const</span> <span class="hljs-title function_">vibratorStateChangeCallback</span> = (<span class="hljs-params">data: vibrator.VibratorStatusEvent</span>) =&gt; {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'vibrator state callback info:'</span>, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data));</li><li>}</li><li><span class="hljs-keyword">try</span> {</li><li>  <span class="hljs-comment">// 取消订阅 vibratorStateChange事件</span></li><li>  vibrator.<span class="hljs-title function_">off</span>(<span class="hljs-string">'vibratorStateChange'</span>, vibratorStateChangeCallback);</li><li>  <span class="hljs-comment">// 取消订阅所有 vibratorStateChange事件</span></li><li>  <span class="hljs-comment">// vibrator.off('vibratorStateChange');</span></li><li>} <span class="hljs-keyword">catch</span> (error) {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">e</span>: <span class="hljs-title class_">BusinessError</span> = error <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>;</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`An unexpected error occurred. Code: <span class="hljs-subst">${e.code}</span>, message: <span class="hljs-subst">${e.message}</span>`</span>);</li><li>}</li></ol></pre></div></div></li>     </ol>    </div>   </div>   <div></div></div>