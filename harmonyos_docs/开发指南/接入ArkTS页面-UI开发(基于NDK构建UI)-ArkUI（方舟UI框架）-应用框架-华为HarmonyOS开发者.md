<h1 _ngcontent-beb-c119="" class="doc-title ng-star-inserted" title="接入ArkTS页面"> 接入ArkTS页面 </h1>

<div _ngcontent-beb-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <div class="tiledSection">     <h2 id="占位组件">占位组件<i class="anchor-icon anchor-icon-link" anchorid="占位组件" tips="复制节点链接"></i></h2>          <p>使用NDK接口构建UI界面时，需要在ArkTS页面创建用于挂载NDK接口创建组件的占位组件。占位组件类型为<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-components-contentslot" target="_blank">ContentSlot</a>，ContentSlot能够绑定一个<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-arkui-nodecontent" target="_blank">NodeContent</a>对象，该对象可通过Node-API传递到Native侧挂载显示Native组件。</p>     <ul>      <li>       <p>NDK配置文件entry/src/main/cpp/types/libentry/oh-package.json5如下。</p>       <div _ngcontent-beb-c106="" class="highlight-div"><div _ngcontent-beb-c106="" class="highlight-div-header"><div _ngcontent-beb-c106="" class="highlight-div-header-left"><div _ngcontent-beb-c106="" class="handle-button expand-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-beb-c106="" class="highlight-div-header-right"><div _ngcontent-beb-c106="" class="handle-button ai-button"></div><div _ngcontent-beb-c106="" class="handle-button line-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-beb-c106="" class="handle-button theme-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-beb-c106="" class="handle-button copy-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-beb-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li>{</li><li>  <span class="hljs-string">"name"</span>: <span class="hljs-string">"libentry.so"</span>,</li><li>  <span class="hljs-string">"types"</span>: <span class="hljs-string">"./index.d.ts"</span>,</li><li>  <span class="hljs-string">"version"</span>: <span class="hljs-string">""</span>,</li><li>  <span class="hljs-string">"description"</span>: <span class="hljs-string">"Please describe the basic information."</span></li><li>}</li></ol></pre></div></div></li>      <li>       <p>占位组件和其他ArkTS系统组件使用方法相同。详细代码请参考<a href="/consumer/cn/doc/harmonyos-guides/ndk-access-the-arkts-page#示例">示例</a>。</p>       <div _ngcontent-beb-c106="" class="highlight-div"><div _ngcontent-beb-c106="" class="highlight-div-header"><div _ngcontent-beb-c106="" class="highlight-div-header-left"><div _ngcontent-beb-c106="" class="handle-button expand-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-beb-c106="" class="highlight-div-header-right"><div _ngcontent-beb-c106="" class="handle-button ai-button"></div><div _ngcontent-beb-c106="" class="handle-button line-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-beb-c106="" class="handle-button theme-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-beb-c106="" class="handle-button copy-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-beb-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">NodeContent</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span>;</li><li><span class="hljs-keyword">import</span> nativeNode <span class="hljs-keyword">from</span> <span class="hljs-string">'libentry.so'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-comment">// 初始化NodeContent对象。</span></li><li>  <span class="hljs-keyword">private</span> rootSlot = <span class="hljs-keyword">new</span> <span class="hljs-title class_">NodeContent</span>();</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-meta">@Watch</span>(<span class="hljs-string">'changeNativeFlag'</span>) <span class="hljs-attr">showNative</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">false</span>;</li><li>
</li><li>  <span class="hljs-title function_">changeNativeFlag</span>(): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">showNative</span>) {</li><li>      <span class="hljs-comment">// 传递NodeContent对象用于Native创建组件的挂载显示</span></li><li>      nativeNode.<span class="hljs-title function_">createNativeRoot</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">rootSlot</span>)</li><li>    } <span class="hljs-keyword">else</span> {</li><li>      <span class="hljs-comment">// 销毁NativeModule组件</span></li><li>      nativeNode.<span class="hljs-title function_">destroyNativeRoot</span>()</li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">showNative</span> ? <span class="hljs-string">"HideNativeUI"</span> : <span class="hljs-string">"ShowNativeUI"</span>).<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">showNative</span> = !<span class="hljs-variable language_">this</span>.<span class="hljs-property">showNative</span></li><li>      })</li><li>      <span class="hljs-title class_">Row</span>() {</li><li>        <span class="hljs-comment">// 将NodeContent和ContentSlot占位组件绑定。</span></li><li>        <span class="hljs-title class_">ContentSlot</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">rootSlot</span>)</li><li>      }.<span class="hljs-title function_">layoutWeight</span>(<span class="hljs-number">1</span>)</li><li>    }</li><li>    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div></li>      <li>       <p>占位组件可以通过相关接口在Native侧转化为挂载对象。</p>       <div _ngcontent-beb-c106="" class="highlight-div"><div _ngcontent-beb-c106="" class="highlight-div-header"><div _ngcontent-beb-c106="" class="highlight-div-header-left"><div _ngcontent-beb-c106="" class="handle-button expand-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-beb-c106="" class="highlight-div-header-right"><div _ngcontent-beb-c106="" class="handle-button ai-button"></div><div _ngcontent-beb-c106="" class="handle-button line-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-beb-c106="" class="handle-button theme-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-beb-c106="" class="handle-button copy-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-beb-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-scss" data-highlighted="yes"><ol class="linenums"><li>ArkUI_NodeContentHandle contentHandle;</li><li><span class="hljs-built_in">OH_ArkUI_GetNodeContentFromNapiValue</span>(env, args[<span class="hljs-number">0</span>], &amp;contentHandle);</li></ol></pre></div></div></li>      <li>       <p>挂载对象提供了相关挂载和卸载组件接口。</p>       <div _ngcontent-beb-c106="" class="highlight-div"><div _ngcontent-beb-c106="" class="highlight-div-header"><div _ngcontent-beb-c106="" class="highlight-div-header-left"><div _ngcontent-beb-c106="" class="handle-button expand-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-beb-c106="" class="highlight-div-header-right"><div _ngcontent-beb-c106="" class="handle-button ai-button"></div><div _ngcontent-beb-c106="" class="handle-button line-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-beb-c106="" class="handle-button theme-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-beb-c106="" class="handle-button copy-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-beb-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-scss" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-built_in">OH_ArkUI_NodeContent_AddNode</span>(handle_, myNativeNode);</li><li><span class="hljs-built_in">OH_ArkUI_NodeContent_RemoveNode</span>(handle_, myNativeNode);</li></ol></pre></div></div></li>     </ul>    </div>    <div class="tiledSection">     <h2 id="ndk组件模块">NDK组件模块<i class="anchor-icon anchor-icon-link" anchorid="ndk组件模块" tips="复制节点链接"></i></h2>          <p>NDK提供的UI组件能力如组件创建、树操作、属性设置、事件注册等是通过函数指针结构体（如<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-arkui-nativemodule-arkui-nativenodeapi-1" target="_blank">ArkUI_NativeNodeAPI_1</a>）进行暴露，该函数指针结构体可以通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-native-interface-h#oh_arkui_getmoduleinterface" target="_blank">模块查询接口</a>获取。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <ul>        <li><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-native-interface-h#oh_arkui_getmoduleinterface" target="_blank">模块查询接口</a>带有初始化NDK的逻辑，建议先调用该接口进行全局初始化，再使用NDK进行UI构造。</li>       </ul>      </div></div></div>     <div _ngcontent-beb-c106="" class="highlight-div"><div _ngcontent-beb-c106="" class="highlight-div-header"><div _ngcontent-beb-c106="" class="highlight-div-header-left"><div _ngcontent-beb-c106="" class="handle-button expand-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-beb-c106="" class="highlight-div-header-right"><div _ngcontent-beb-c106="" class="handle-button ai-button"></div><div _ngcontent-beb-c106="" class="handle-button line-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-beb-c106="" class="handle-button theme-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-beb-c106="" class="handle-button copy-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-beb-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li>ArkUI_NativeNodeAPI_1* arkUINativeNodeApi = <span class="hljs-literal">nullptr</span>;</li><li><span class="hljs-built_in">OH_ArkUI_GetModuleInterface</span>(ARKUI_NATIVE_NODE, ArkUI_NativeNodeAPI_1, arkUINativeNodeApi);</li></ol></pre></div></div>     <p>在获取到函数指针结构体后，可以使用该结构体内的函数实现相关UI组件操作。</p>     <ul>      <li>       <p>组件创建和销毁。</p>       <div _ngcontent-beb-c106="" class="highlight-div"><div _ngcontent-beb-c106="" class="highlight-div-header"><div _ngcontent-beb-c106="" class="highlight-div-header-left"><div _ngcontent-beb-c106="" class="handle-button expand-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-beb-c106="" class="highlight-div-header-right"><div _ngcontent-beb-c106="" class="handle-button ai-button"></div><div _ngcontent-beb-c106="" class="handle-button line-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-beb-c106="" class="handle-button theme-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-beb-c106="" class="handle-button copy-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-beb-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-variable">auto</span> <span class="hljs-variable">listNode</span> = <span class="hljs-variable">arkUINativeNodeApi</span>-&gt;<span class="hljs-title class_">createNode</span>(<span class="hljs-title class_">ARKUI_NODE_LIST</span>);</li><li><span class="hljs-variable">arkUINativeNodeApi</span>-&gt;<span class="hljs-title class_">disposeNode</span>(<span class="hljs-title class_">listNode</span>);</li></ol></pre></div></div>       <p>获取NDK接口支持的组件范围可以通过查询<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-native-node-h#arkui_nodetype" target="_blank">ArkUI_NodeType</a>枚举值。</p></li>      <li>       <p>组件树操作。</p>       <div _ngcontent-beb-c106="" class="highlight-div"><div _ngcontent-beb-c106="" class="highlight-div-header"><div _ngcontent-beb-c106="" class="highlight-div-header-left"><div _ngcontent-beb-c106="" class="handle-button expand-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-beb-c106="" class="highlight-div-header-right"><div _ngcontent-beb-c106="" class="handle-button ai-button"></div><div _ngcontent-beb-c106="" class="handle-button line-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-beb-c106="" class="handle-button theme-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-beb-c106="" class="handle-button copy-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-beb-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-variable">auto</span> <span class="hljs-variable">parent</span> = <span class="hljs-variable">arkUINativeNodeApi</span>-&gt;<span class="hljs-title class_">createNode</span>(<span class="hljs-title class_">ARKUI_NODE_STACK</span>);</li><li><span class="hljs-variable">auto</span> <span class="hljs-variable">child</span> = <span class="hljs-variable">arkUINativeNodeApi</span>-&gt;<span class="hljs-title class_">createNode</span>(<span class="hljs-title class_">ARKUI_NODE_STACK</span>);</li><li><span class="hljs-variable">arkUINativeNodeApi</span>-&gt;<span class="hljs-title class_">addChild</span>(<span class="hljs-title class_">parent</span>, <span class="hljs-title class_">child</span>);</li><li><span class="hljs-variable">arkUINativeNodeApi</span>-&gt;<span class="hljs-title class_">removeChild</span>(<span class="hljs-title class_">parent</span>, <span class="hljs-title class_">child</span>);</li></ol></pre></div></div></li>      <li>       <p>属性设置。</p>       <div _ngcontent-beb-c106="" class="highlight-div"><div _ngcontent-beb-c106="" class="highlight-div-header"><div _ngcontent-beb-c106="" class="highlight-div-header-left"><div _ngcontent-beb-c106="" class="handle-button expand-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-beb-c106="" class="highlight-div-header-right"><div _ngcontent-beb-c106="" class="handle-button ai-button"></div><div _ngcontent-beb-c106="" class="handle-button line-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-beb-c106="" class="handle-button theme-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-beb-c106="" class="handle-button copy-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-beb-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-variable">auto</span> <span class="hljs-variable">stack</span> = <span class="hljs-variable">arkUINativeNodeApi</span>-&gt;<span class="hljs-title class_">createNode</span>(<span class="hljs-title class_">ARKUI_NODE_STACK</span>);</li><li><span class="hljs-variable">ArkUI_NumberValue</span> <span class="hljs-variable">value</span>[] = {{.<span class="hljs-variable">f32</span> = <span class="hljs-number">100</span>}};</li><li><span class="hljs-variable">ArkUI_AttributeItem</span> <span class="hljs-variable">item</span> = {<span class="hljs-variable">value</span>, <span class="hljs-number">1</span>};</li><li><span class="hljs-variable">arkUINativeNodeApi</span>-&gt;<span class="hljs-title class_">setAttribute</span>(<span class="hljs-title class_">stack</span>, <span class="hljs-title class_">NODE_WIDTH</span>, &amp;<span class="hljs-title class_">item</span>);</li><li><span class="hljs-variable">ArkUI_NumberValue</span> <span class="hljs-variable">value_color</span>[] = {{.<span class="hljs-variable">u32</span> = <span class="hljs-number">0xff112233</span>}};</li><li><span class="hljs-variable">ArkUI_AttributeItem</span> <span class="hljs-variable">item_color</span> = {<span class="hljs-variable">value_color</span>, <span class="hljs-number">1</span>};</li><li><span class="hljs-variable">arkUINativeNodeApi</span>-&gt;<span class="hljs-title class_">setAttribute</span>(<span class="hljs-title class_">stack</span>, <span class="hljs-title class_">NODE_BACKGROUND_COLOR</span>, &amp;<span class="hljs-title class_">item</span>);</li></ol></pre></div></div>       <p>获取NDK接口支持的属性范围可以通过查询<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-native-node-h#arkui_nodeattributetype" target="_blank">ArkUI_NodeAttributeType</a>枚举值。</p></li>      <li>       <p>事件注册。</p>       <div _ngcontent-beb-c106="" class="highlight-div"><div _ngcontent-beb-c106="" class="highlight-div-header"><div _ngcontent-beb-c106="" class="highlight-div-header-left"><div _ngcontent-beb-c106="" class="handle-button expand-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-beb-c106="" class="highlight-div-header-right"><div _ngcontent-beb-c106="" class="handle-button ai-button"></div><div _ngcontent-beb-c106="" class="handle-button line-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-beb-c106="" class="handle-button theme-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-beb-c106="" class="handle-button copy-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-beb-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-variable">auto</span> <span class="hljs-variable">stack</span> = <span class="hljs-variable">arkUINativeNodeApi</span>-&gt;<span class="hljs-title class_">createNode</span>(<span class="hljs-title class_">ARKUI_NODE_STACK</span>);</li><li><span class="hljs-variable">arkUINativeNodeApi</span>-&gt;<span class="hljs-title class_">addNodeEventReceiver</span>(<span class="hljs-title class_">stack</span>, [](<span class="hljs-variable">ArkUI_NodeEvent</span><span class="hljs-variable">* event</span>){</li><li>    <span class="hljs-comment">// process event</span></li><li>});</li><li><span class="hljs-variable">arkUINativeNodeApi</span>-&gt;<span class="hljs-title class_">registerNodeEvent</span>(<span class="hljs-title class_">stack</span>, <span class="hljs-title class_">NODE_ON_CLICK</span>, <span class="hljs-number">0</span>, <span class="hljs-title class_">nullptr</span>);</li></ol></pre></div></div>       <p>获取NDK接口支持的事件范围可以通过查询<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-native-node-h#arkui_nodeeventtype" target="_blank">ArkUI_NodeEventType</a>枚举值。</p></li>     </ul>    </div>    <div class="tiledSection">     <h2 id="示例">示例<i class="anchor-icon anchor-icon-link" anchorid="示例" tips="复制节点链接"></i></h2>          <p>下面的示例展示了如何使用ContentSlot挂载Native侧的文本列表。</p>     <p>示例代码的目录结构及其文件说明如下：</p>     <div _ngcontent-beb-c106="" class="highlight-div"><div _ngcontent-beb-c106="" class="highlight-div-header"><div _ngcontent-beb-c106="" class="highlight-div-header-left"><div _ngcontent-beb-c106="" class="handle-button expand-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-beb-c106="" class="highlight-div-header-right"><div _ngcontent-beb-c106="" class="handle-button ai-button"></div><div _ngcontent-beb-c106="" class="handle-button line-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-beb-c106="" class="handle-button theme-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-beb-c106="" class="handle-button copy-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-beb-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-objectivec" data-highlighted="yes"><ol class="linenums"><li>.</li><li>|——cpp</li><li>|    |——types</li><li>|    |      |——libentry</li><li>|    |      |       |——index.d.ts 提供Native和ArkTS侧的桥接方法。</li><li>|    |——napi_init.cpp 与index.d.ts对应的桥接方法对接Native侧的定义处。</li><li>|    |——NativeEntry.cpp 桥接方法的Native侧实现。</li><li>|    |——NativeEntry.h 桥接方法的Native侧定义。</li><li>|    |——<span class="hljs-built_in">CMakeList</span>.txt C语言库引用文件。</li><li>|    |——ArkUIBaseNode.h 节点封装扩展类。</li><li>|    |——ArkUINode.h 节点封装扩展类。</li><li>|    |——ArkUIListNode.h 节点封装扩展类。</li><li>|    |——ArkUIListItemNode.h 节点封装扩展类。</li><li>|    |——ArkUITextNode.h 节点封装扩展类。</li><li>|    |——NormalTextListExample.h 示例代码文件。</li><li>|</li><li>|——ets</li><li>|    |——pages</li><li>|         |——entry.ets 应用启动页，加载承载Native的容器。</li><li>|</li></ol></pre></div></div>     <p><strong>图1</strong> Native文本列表</p>     <p><span><img originheight="661" originwidth="347" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114729.88331704768847042548360014900217:50001231000000:2800:FD1A4A92453B78317058950A6BF32B1B075BFDC1D132F8BA5DB240EBD50EEE2F.gif" width="347" height="661"></span></p>     <ol>      <li>       <p>在ArkTS页面上声明用于Native页面挂载的占位组件，并在页面创建时通知Native侧创建文本列表。</p>       <div _ngcontent-beb-c106="" class="highlight-div"><div _ngcontent-beb-c106="" class="highlight-div-header"><div _ngcontent-beb-c106="" class="highlight-div-header-left"><div _ngcontent-beb-c106="" class="handle-button expand-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-beb-c106="" class="highlight-div-header-right"><div _ngcontent-beb-c106="" class="handle-button ai-button"></div><div _ngcontent-beb-c106="" class="handle-button line-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-beb-c106="" class="handle-button theme-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-beb-c106="" class="handle-button copy-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-beb-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> nativeNode <span class="hljs-keyword">from</span> <span class="hljs-string">'libentry.so'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">NodeContent</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-comment">// 初始化NodeContent对象。</span></li><li>  <span class="hljs-keyword">private</span> rootSlot = <span class="hljs-keyword">new</span> <span class="hljs-title class_">NodeContent</span>();</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-meta">@Watch</span>(<span class="hljs-string">'changeNativeFlag'</span>) <span class="hljs-attr">showNative</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">false</span>;</li><li>
</li><li>  <span class="hljs-title function_">changeNativeFlag</span>(): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">showNative</span>) {</li><li>      <span class="hljs-comment">// 传递NodeContent对象用于Native创建组件的挂载显示</span></li><li>      nativeNode.<span class="hljs-title function_">createNativeRoot</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">rootSlot</span>)</li><li>    } <span class="hljs-keyword">else</span> {</li><li>      <span class="hljs-comment">// 销毁NativeModule组件</span></li><li>      nativeNode.<span class="hljs-title function_">destroyNativeRoot</span>()</li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">showNative</span> ? <span class="hljs-string">"HideNativeUI"</span> : <span class="hljs-string">"ShowNativeUI"</span>).<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">showNative</span> = !<span class="hljs-variable language_">this</span>.<span class="hljs-property">showNative</span></li><li>      })</li><li>      <span class="hljs-title class_">Row</span>() {</li><li>        <span class="hljs-comment">// 将NodeContent和ContentSlot占位组件绑定。</span></li><li>        <span class="hljs-title class_">ContentSlot</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">rootSlot</span>)</li><li>      }.<span class="hljs-title function_">layoutWeight</span>(<span class="hljs-number">1</span>)</li><li>    }</li><li>    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div></li>      <li>       <p>使用Native模板创建工程，并在Native侧提供Node-API的桥接方法，实现ArkTS侧的NativeNode模块接口。</p>       <p>接口声明。</p>       <div _ngcontent-beb-c106="" class="highlight-div"><div _ngcontent-beb-c106="" class="highlight-div-header"><div _ngcontent-beb-c106="" class="highlight-div-header-left"><div _ngcontent-beb-c106="" class="handle-button expand-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-beb-c106="" class="highlight-div-header-right"><div _ngcontent-beb-c106="" class="handle-button ai-button"></div><div _ngcontent-beb-c106="" class="handle-button line-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-beb-c106="" class="handle-button theme-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-beb-c106="" class="handle-button copy-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-beb-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// entry/src/main/cpp/types/libentry/Index.d.ts</span></li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-attr">createNativeRoot</span>: <span class="hljs-function">(<span class="hljs-params">content: <span class="hljs-built_in">Object</span></span>) =&gt;</span> <span class="hljs-built_in">void</span>;</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-attr">destroyNativeRoot</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">void</span>;</li></ol></pre></div></div>       <p>Native实现。</p>       <div _ngcontent-beb-c106="" class="highlight-div"><div _ngcontent-beb-c106="" class="highlight-div-header"><div _ngcontent-beb-c106="" class="highlight-div-header-left"><div _ngcontent-beb-c106="" class="handle-button expand-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-beb-c106="" class="highlight-div-header-right"><div _ngcontent-beb-c106="" class="handle-button ai-button"></div><div _ngcontent-beb-c106="" class="handle-button line-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-beb-c106="" class="handle-button theme-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-beb-c106="" class="handle-button copy-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-beb-c106="" class="highlight-scroll-div"><pre class="cpp prettyprint linenums hljs language-cpp" hw-language="cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// entry/src/main/cpp/napi_init.cpp</span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"napi/native_api.h"</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"NativeEntry.h"</span></span></li><li>
</li><li><span class="hljs-function">EXTERN_C_START</span></li><li><span class="hljs-function"><span class="hljs-type">static</span> napi_value <span class="hljs-title">Init</span><span class="hljs-params">(napi_env env, napi_value exports)</span> </span>{</li><li>    <span class="hljs-comment">// 绑定Native侧的创建组件和销毁组件。</span></li><li>    napi_property_descriptor desc[] = {</li><li>        {<span class="hljs-string">"createNativeRoot"</span>, <span class="hljs-literal">nullptr</span>, NativeModule::CreateNativeRoot, <span class="hljs-literal">nullptr</span>, <span class="hljs-literal">nullptr</span>, <span class="hljs-literal">nullptr</span>, napi_default, <span class="hljs-literal">nullptr</span>},</li><li>        {<span class="hljs-string">"destroyNativeRoot"</span>, <span class="hljs-literal">nullptr</span>, NativeModule::DestroyNativeRoot, <span class="hljs-literal">nullptr</span>, <span class="hljs-literal">nullptr</span>, <span class="hljs-literal">nullptr</span>, napi_default, <span class="hljs-literal">nullptr</span>}};</li><li>    <span class="hljs-built_in">napi_define_properties</span>(env, exports, <span class="hljs-built_in">sizeof</span>(desc) / <span class="hljs-built_in">sizeof</span>(desc[<span class="hljs-number">0</span>]), desc);</li><li>    <span class="hljs-keyword">return</span> exports;</li><li>}</li><li>EXTERN_C_END</li><li>
</li><li><span class="hljs-type">static</span> napi_module demoModule = {</li><li>    .nm_version = <span class="hljs-number">1</span>,</li><li>    .nm_flags = <span class="hljs-number">0</span>,</li><li>    .nm_filename = <span class="hljs-literal">nullptr</span>,</li><li>    .nm_register_func = Init,</li><li>    .nm_modname = <span class="hljs-string">"entry"</span>,</li><li>    .nm_priv = ((<span class="hljs-type">void</span> *)<span class="hljs-number">0</span>),</li><li>    .reserved = {<span class="hljs-number">0</span>},</li><li>};</li><li>
</li><li><span class="hljs-keyword">extern</span> <span class="hljs-string">"C"</span> __attribute__((constructor)) <span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">RegisterEntryModule</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span> </span>{ <span class="hljs-built_in">napi_module_register</span>(&amp;demoModule); }</li></ol></pre></div></div></li>      <li>       <p>在NativeEntry.h文件中创建Native界面。</p>       <div _ngcontent-beb-c106="" class="highlight-div"><div _ngcontent-beb-c106="" class="highlight-div-header"><div _ngcontent-beb-c106="" class="highlight-div-header-left"><div _ngcontent-beb-c106="" class="handle-button expand-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-beb-c106="" class="highlight-div-header-right"><div _ngcontent-beb-c106="" class="handle-button ai-button"></div><div _ngcontent-beb-c106="" class="handle-button line-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-beb-c106="" class="handle-button theme-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-beb-c106="" class="handle-button copy-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-beb-c106="" class="highlight-scroll-div"><pre class="c prettyprint linenums hljs language-c" hw-language="c" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// NativeEntry.h</span></li><li>
</li><li><span class="hljs-meta">#<span class="hljs-keyword">ifndef</span> MYAPPLICATION_NATIVEENTRY_H</span></li><li><span class="hljs-meta">#<span class="hljs-keyword">define</span> MYAPPLICATION_NATIVEENTRY_H</span></li><li>
</li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;ArkUIBaseNode.h&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;arkui/native_type.h&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;js_native_api_types.h&gt;</span></span></li><li>
</li><li>namespace NativeModule {</li><li>
</li><li>napi_value <span class="hljs-title function_">CreateNativeRoot</span><span class="hljs-params">(napi_env env, napi_callback_info info)</span>;</li><li>
</li><li>napi_value <span class="hljs-title function_">DestroyNativeRoot</span><span class="hljs-params">(napi_env env, napi_callback_info info)</span>;</li><li>
</li><li><span class="hljs-comment">// 管理Native组件的生命周期和内存。</span></li><li><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">NativeEntry</span> {</span></li><li>public:</li><li>    <span class="hljs-type">static</span> NativeEntry *<span class="hljs-title function_">GetInstance</span><span class="hljs-params">()</span> {</li><li>        <span class="hljs-type">static</span> NativeEntry nativeEntry;</li><li>        <span class="hljs-keyword">return</span> &amp;nativeEntry;</li><li>    }</li><li>
</li><li>    <span class="hljs-type">void</span> <span class="hljs-title function_">SetContentHandle</span><span class="hljs-params">(ArkUI_NodeContentHandle handle)</span> {</li><li>        handle_ = handle;</li><li>    }</li><li>
</li><li>    <span class="hljs-type">void</span> <span class="hljs-title function_">SetRootNode</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;ArkUIBaseNode&gt; &amp;baseNode)</span> {</li><li>        root_ = baseNode;</li><li>        <span class="hljs-comment">// 添加Native组件到NodeContent上用于挂载显示。</span></li><li>        OH_ArkUI_NodeContent_AddNode(handle_, root_-&gt;GetHandle());</li><li>    }</li><li>    <span class="hljs-type">void</span> <span class="hljs-title function_">DisposeRootNode</span><span class="hljs-params">()</span> {</li><li>        <span class="hljs-comment">// 从NodeContent上卸载组件并销毁Native组件。</span></li><li>        OH_ArkUI_NodeContent_RemoveNode(handle_, root_-&gt;GetHandle());</li><li>        root_.reset();</li><li>    }</li><li>
</li><li>private:</li><li>    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;ArkUIBaseNode&gt; root_;</li><li>    ArkUI_NodeContentHandle handle_;</li><li>};</li><li>
</li><li>} <span class="hljs-comment">// namespace NativeModule</span></li><li>
</li><li><span class="hljs-meta">#<span class="hljs-keyword">endif</span> <span class="hljs-comment">// MYAPPLICATION_NATIVEENTRY_H</span></span></li></ol></pre></div></div>       <p>对应实现文件。</p>       <div _ngcontent-beb-c106="" class="highlight-div"><div _ngcontent-beb-c106="" class="highlight-div-header"><div _ngcontent-beb-c106="" class="highlight-div-header-left"><div _ngcontent-beb-c106="" class="handle-button expand-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-beb-c106="" class="highlight-div-header-right"><div _ngcontent-beb-c106="" class="handle-button ai-button"></div><div _ngcontent-beb-c106="" class="handle-button line-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-beb-c106="" class="handle-button theme-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-beb-c106="" class="handle-button copy-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-beb-c106="" class="highlight-scroll-div"><pre class="cpp prettyprint linenums hljs language-cpp" hw-language="cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// NativeEntry.cpp</span></li><li>
</li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;arkui/native_node_napi.h&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;hilog/log.h&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;js_native_api.h&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"NativeEntry.h"</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"NormalTextListExample.h"</span></span></li><li>
</li><li><span class="hljs-keyword">namespace</span> NativeModule {</li><li>
</li><li><span class="hljs-function">napi_value <span class="hljs-title">CreateNativeRoot</span><span class="hljs-params">(napi_env env, napi_callback_info info)</span> </span>{</li><li>    <span class="hljs-type">size_t</span> argc = <span class="hljs-number">1</span>;</li><li>    napi_value args[<span class="hljs-number">1</span>] = {<span class="hljs-literal">nullptr</span>};</li><li>
</li><li>    <span class="hljs-built_in">napi_get_cb_info</span>(env, info, &amp;argc, args, <span class="hljs-literal">nullptr</span>, <span class="hljs-literal">nullptr</span>);</li><li>
</li><li>    <span class="hljs-comment">// 获取NodeContent</span></li><li>    ArkUI_NodeContentHandle contentHandle;</li><li>    <span class="hljs-built_in">OH_ArkUI_GetNodeContentFromNapiValue</span>(env, args[<span class="hljs-number">0</span>], &amp;contentHandle);</li><li>    NativeEntry::<span class="hljs-built_in">GetInstance</span>()-&gt;<span class="hljs-built_in">SetContentHandle</span>(contentHandle);</li><li>
</li><li>    <span class="hljs-comment">// 创建文本列表</span></li><li>    <span class="hljs-keyword">auto</span> list = <span class="hljs-built_in">CreateTextListExample</span>();</li><li>
</li><li>    <span class="hljs-comment">// 保持Native侧对象到管理类中，维护生命周期。</span></li><li>    NativeEntry::<span class="hljs-built_in">GetInstance</span>()-&gt;<span class="hljs-built_in">SetRootNode</span>(list);</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-literal">nullptr</span>;</li><li>}</li><li>
</li><li><span class="hljs-function">napi_value <span class="hljs-title">DestroyNativeRoot</span><span class="hljs-params">(napi_env env, napi_callback_info info)</span> </span>{</li><li>    <span class="hljs-comment">// 从管理类中释放Native侧对象。</span></li><li>    NativeEntry::<span class="hljs-built_in">GetInstance</span>()-&gt;<span class="hljs-built_in">DisposeRootNode</span>();</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-literal">nullptr</span>;</li><li>}</li><li>
</li><li>} <span class="hljs-comment">// namespace NativeModule</span></li></ol></pre></div></div>       <p>使用NDK提供的C接口需要在CMakeLists.txt中增加libace_ndk.z.so的引用，如下所示。其中entry为工程导出的动态库名称，如当前示例使用的是默认的名称libentry.so。新增cpp文件后，同样需要在CMakeLists.txt中添加相应的cpp文件。若未进行此配置，对应的文件将不会被编译。</p>       <div _ngcontent-beb-c106="" class="highlight-div"><div _ngcontent-beb-c106="" class="highlight-div-header"><div _ngcontent-beb-c106="" class="highlight-div-header-left"><div _ngcontent-beb-c106="" class="handle-button expand-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-beb-c106="" class="highlight-div-header-right"><div _ngcontent-beb-c106="" class="handle-button ai-button"></div><div _ngcontent-beb-c106="" class="handle-button line-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-beb-c106="" class="handle-button theme-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-beb-c106="" class="handle-button copy-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-beb-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-scss" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-built_in">add_library</span>(entry SHARED napi_init.cpp NativeEntry.cpp)</li><li><span class="hljs-built_in">target_link_libraries</span>(entry PUBLIC libace_napi.z.so libace_ndk.z.so)</li></ol></pre></div></div></li>      <li>       <p>由于NDK接口提供的是C接口，为了使用面向对象的方式简化编程和工程管理，这里建议使用C++进行二次封装，下面示例代码展示了示例界面中所需的列表，文本组件封装类。</p>       <p>1）获取ArkUI在NDK接口的入口模块<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-arkui-nativemodule-arkui-nativenodeapi-1" target="_blank">ArkUI_NativeNodeAPI_1</a>，该结构体模块提供了一系列组件创建、树构建、属性设置和事件注册等函数指针。</p>       <div _ngcontent-beb-c106="" class="highlight-div"><div _ngcontent-beb-c106="" class="highlight-div-header"><div _ngcontent-beb-c106="" class="highlight-div-header-left"><div _ngcontent-beb-c106="" class="handle-button expand-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-beb-c106="" class="highlight-div-header-right"><div _ngcontent-beb-c106="" class="handle-button ai-button"></div><div _ngcontent-beb-c106="" class="handle-button line-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-beb-c106="" class="handle-button theme-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-beb-c106="" class="handle-button copy-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-beb-c106="" class="highlight-scroll-div"><pre class="c prettyprint linenums hljs language-c" hw-language="c" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// NativeModule.h</span></li><li><span class="hljs-comment">// 提供获取ArkUI在Native侧模块的封装接口</span></li><li>
</li><li><span class="hljs-meta">#<span class="hljs-keyword">ifndef</span> MYAPPLICATION_NATIVEMODULE_H</span></li><li><span class="hljs-meta">#<span class="hljs-keyword">define</span> MYAPPLICATION_NATIVEMODULE_H</span></li><li>
</li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"napi/native_api.h"</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;arkui/native_node.h&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cassert&gt;</span></span></li><li>
</li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;arkui/native_interface.h&gt;</span></span></li><li>
</li><li>namespace NativeModule {</li><li>
</li><li><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">NativeModuleInstance</span> {</span></li><li>public:</li><li>    <span class="hljs-type">static</span> NativeModuleInstance *<span class="hljs-title function_">GetInstance</span><span class="hljs-params">()</span> {</li><li>        <span class="hljs-type">static</span> NativeModuleInstance instance;</li><li>        <span class="hljs-keyword">return</span> &amp;instance;</li><li>    }</li><li>
</li><li>    NativeModuleInstance() {</li><li>        <span class="hljs-comment">// 获取NDK接口的函数指针结构体对象，用于后续操作。</span></li><li>        OH_ArkUI_GetModuleInterface(ARKUI_NATIVE_NODE, ArkUI_NativeNodeAPI_1, arkUINativeNodeApi_);</li><li>        assert(arkUINativeNodeApi_);</li><li>    }</li><li>    <span class="hljs-comment">// 暴露给其他模块使用。</span></li><li>    ArkUI_NativeNodeAPI_1 *<span class="hljs-title function_">GetNativeNodeAPI</span><span class="hljs-params">()</span> { <span class="hljs-keyword">return</span> arkUINativeNodeApi_; }</li><li>
</li><li>private:</li><li>    ArkUI_NativeNodeAPI_1 *arkUINativeNodeApi_ = nullptr;</li><li>};</li><li>
</li><li>} <span class="hljs-comment">// namespace NativeModule</span></li><li>
</li><li><span class="hljs-meta">#<span class="hljs-keyword">endif</span> <span class="hljs-comment">// MYAPPLICATION_NATIVEMODULE_H</span></span></li></ol></pre></div></div>       <p>2）提供列表，文本组件的基类对象，用于封装通用属性和事件。</p>       <div _ngcontent-beb-c106="" class="highlight-div"><div _ngcontent-beb-c106="" class="highlight-div-header"><div _ngcontent-beb-c106="" class="highlight-div-header-left"><div _ngcontent-beb-c106="" class="handle-button expand-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-beb-c106="" class="highlight-div-header-right"><div _ngcontent-beb-c106="" class="handle-button ai-button"></div><div _ngcontent-beb-c106="" class="handle-button line-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-beb-c106="" class="handle-button theme-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-beb-c106="" class="handle-button copy-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-beb-c106="" class="highlight-scroll-div"><pre class="c prettyprint linenums hljs language-c" hw-language="c" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// ArkUIBaseNode.h</span></li><li><span class="hljs-comment">// 提供组件树操作的基类。</span></li><li>
</li><li><span class="hljs-meta">#<span class="hljs-keyword">ifndef</span> MYAPPLICATION_ARKUIBASENODE_H</span></li><li><span class="hljs-meta">#<span class="hljs-keyword">define</span> MYAPPLICATION_ARKUIBASENODE_H</span></li><li>
</li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;arkui/native_type.h&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;list&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;memory&gt;</span></span></li><li>
</li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"NativeModule.h"</span></span></li><li>
</li><li>namespace NativeModule {</li><li>
</li><li><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ArkUIBaseNode</span> {</span></li><li>public:</li><li>    explicit <span class="hljs-title function_">ArkUIBaseNode</span><span class="hljs-params">(ArkUI_NodeHandle handle)</span></li><li>        : <span class="hljs-title function_">handle_</span><span class="hljs-params">(handle)</span>, <span class="hljs-title function_">nativeModule_</span><span class="hljs-params">(NativeModuleInstance::GetInstance()-&gt;GetNativeNodeAPI())</span> {}</li><li>
</li><li>    virtual ~ArkUIBaseNode() {</li><li>        <span class="hljs-comment">// 封装析构函数，实现子节点移除功能。</span></li><li>        <span class="hljs-keyword">if</span> (!children_.empty()) {</li><li>            <span class="hljs-keyword">for</span> (<span class="hljs-type">const</span> <span class="hljs-keyword">auto</span>&amp; child : children_) {</li><li>                nativeModule_-&gt;removeChild(handle_, child-&gt;GetHandle());</li><li>            }</li><li>            children_.clear();</li><li>        }</li><li>        <span class="hljs-comment">// 封装析构函数，统一回收节点资源。</span></li><li>        nativeModule_-&gt;disposeNode(handle_);</li><li>    }</li><li>
</li><li>    <span class="hljs-type">void</span> <span class="hljs-title function_">AddChild</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;ArkUIBaseNode&gt; &amp;child)</span> {</li><li>        children_.emplace_back(child);</li><li>        OnAddChild(child);</li><li>    }</li><li>
</li><li>    <span class="hljs-type">void</span> <span class="hljs-title function_">RemoveChild</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;ArkUIBaseNode&gt; &amp;child)</span> {</li><li>        children_.remove(child);</li><li>        OnRemoveChild(child);</li><li>    }</li><li>
</li><li>    <span class="hljs-type">void</span> <span class="hljs-title function_">InsertChild</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;ArkUIBaseNode&gt; &amp;child, <span class="hljs-type">int32_t</span> index)</span> {</li><li>        <span class="hljs-keyword">if</span> (index &gt;= children_.size()) {</li><li>            AddChild(child);</li><li>        } <span class="hljs-keyword">else</span> {</li><li>            <span class="hljs-keyword">auto</span> iter = children_.begin();</li><li>            <span class="hljs-built_in">std</span>::advance(iter, index);</li><li>            children_.insert(iter, child);</li><li>            OnInsertChild(child, index);</li><li>        }</li><li>    }</li><li>
</li><li>    ArkUI_NodeHandle <span class="hljs-title function_">GetHandle</span><span class="hljs-params">()</span> <span class="hljs-type">const</span> { <span class="hljs-keyword">return</span> handle_; }</li><li>
</li><li>protected:</li><li>    <span class="hljs-comment">// 针对父容器子类需要重载下面的函数，实现组件挂载和卸载。</span></li><li>    virtual <span class="hljs-type">void</span> <span class="hljs-title function_">OnAddChild</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;ArkUIBaseNode&gt; &amp;child)</span> {}</li><li>    virtual <span class="hljs-type">void</span> <span class="hljs-title function_">OnRemoveChild</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;ArkUIBaseNode&gt; &amp;child)</span> {}</li><li>    virtual <span class="hljs-type">void</span> <span class="hljs-title function_">OnInsertChild</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;ArkUIBaseNode&gt; &amp;child, <span class="hljs-type">int32_t</span> index)</span> {}</li><li>
</li><li>    ArkUI_NodeHandle handle_;</li><li>    ArkUI_NativeNodeAPI_1 *nativeModule_ = nullptr;</li><li>
</li><li>private:</li><li>    <span class="hljs-built_in">std</span>::<span class="hljs-built_in">list</span>&lt;<span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;ArkUIBaseNode&gt;&gt; children_;</li><li>};</li><li>} <span class="hljs-comment">// namespace NativeModule</span></li><li>
</li><li><span class="hljs-meta">#<span class="hljs-keyword">endif</span> <span class="hljs-comment">// MYAPPLICATION_ARKUIBASENODE_H</span></span></li></ol></pre></div></div>       <div _ngcontent-beb-c106="" class="highlight-div"><div _ngcontent-beb-c106="" class="highlight-div-header"><div _ngcontent-beb-c106="" class="highlight-div-header-left"><div _ngcontent-beb-c106="" class="handle-button expand-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-beb-c106="" class="highlight-div-header-right"><div _ngcontent-beb-c106="" class="handle-button ai-button"></div><div _ngcontent-beb-c106="" class="handle-button line-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-beb-c106="" class="handle-button theme-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-beb-c106="" class="handle-button copy-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-beb-c106="" class="highlight-scroll-div"><pre class="c prettyprint linenums hljs language-c" hw-language="c" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// ArkUINode.h</span></li><li><span class="hljs-comment">// 提供通用属性和事件的封装。</span></li><li>
</li><li><span class="hljs-meta">#<span class="hljs-keyword">ifndef</span> MYAPPLICATION_ARKUINODE_H</span></li><li><span class="hljs-meta">#<span class="hljs-keyword">define</span> MYAPPLICATION_ARKUINODE_H</span></li><li>
</li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"ArkUIBaseNode.h"</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"NativeModule.h"</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;arkui/native_node.h&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;arkui/native_type.h&gt;</span></span></li><li>
</li><li>namespace NativeModule {</li><li>
</li><li><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ArkUINode</span> :</span> public ArkUIBaseNode {</li><li>public:</li><li>    explicit <span class="hljs-title function_">ArkUINode</span><span class="hljs-params">(ArkUI_NodeHandle handle)</span> : <span class="hljs-title function_">ArkUIBaseNode</span><span class="hljs-params">(handle)</span> {}</li><li>
</li><li>    ~ArkUINode() override {}</li><li>
</li><li>    <span class="hljs-comment">// NDK相关通用属性调用封装</span></li><li>    <span class="hljs-type">void</span> <span class="hljs-title function_">SetWidth</span><span class="hljs-params">(<span class="hljs-type">float</span> width)</span> {</li><li>        assert(handle_);</li><li>        ArkUI_NumberValue value[] = {{.f32 = width}};</li><li>        ArkUI_AttributeItem item = {value, <span class="hljs-number">1</span>};</li><li>        nativeModule_-&gt;setAttribute(handle_, NODE_WIDTH, &amp;item);</li><li>    }</li><li>    <span class="hljs-type">void</span> <span class="hljs-title function_">SetPercentWidth</span><span class="hljs-params">(<span class="hljs-type">float</span> percent)</span> {</li><li>        assert(handle_);</li><li>        ArkUI_NumberValue value[] = {{.f32 = percent}};</li><li>        ArkUI_AttributeItem item = {value, <span class="hljs-number">1</span>};</li><li>        nativeModule_-&gt;setAttribute(handle_, NODE_WIDTH_PERCENT, &amp;item);</li><li>    }</li><li>    <span class="hljs-type">void</span> <span class="hljs-title function_">SetHeight</span><span class="hljs-params">(<span class="hljs-type">float</span> height)</span> {</li><li>        assert(handle_);</li><li>        ArkUI_NumberValue value[] = {{.f32 = height}};</li><li>        ArkUI_AttributeItem item = {value, <span class="hljs-number">1</span>};</li><li>        nativeModule_-&gt;setAttribute(handle_, NODE_HEIGHT, &amp;item);</li><li>    }</li><li>    <span class="hljs-type">void</span> <span class="hljs-title function_">SetPercentHeight</span><span class="hljs-params">(<span class="hljs-type">float</span> percent)</span> {</li><li>        assert(handle_);</li><li>        ArkUI_NumberValue value[] = {{.f32 = percent}};</li><li>        ArkUI_AttributeItem item = {value, <span class="hljs-number">1</span>};</li><li>        nativeModule_-&gt;setAttribute(handle_, NODE_HEIGHT_PERCENT, &amp;item);</li><li>    }</li><li>    <span class="hljs-type">void</span> <span class="hljs-title function_">SetBackgroundColor</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> color)</span> {</li><li>        assert(handle_);</li><li>        ArkUI_NumberValue value[] = {{.u32 = color}};</li><li>        ArkUI_AttributeItem item = {value, <span class="hljs-number">1</span>};</li><li>        nativeModule_-&gt;setAttribute(handle_, NODE_BACKGROUND_COLOR, &amp;item);</li><li>    }</li><li>
</li><li>protected:</li><li>    <span class="hljs-comment">// 组件树操作的实现类对接。</span></li><li>    <span class="hljs-type">void</span> <span class="hljs-title function_">OnAddChild</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;ArkUIBaseNode&gt; &amp;child)</span> override {</li><li>        nativeModule_-&gt;addChild(handle_, child-&gt;GetHandle());</li><li>    }</li><li>    <span class="hljs-type">void</span> <span class="hljs-title function_">OnRemoveChild</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;ArkUIBaseNode&gt; &amp;child)</span> override {</li><li>        nativeModule_-&gt;removeChild(handle_, child-&gt;GetHandle());</li><li>    }</li><li>    <span class="hljs-type">void</span> <span class="hljs-title function_">OnInsertChild</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;ArkUIBaseNode&gt; &amp;child, <span class="hljs-type">int32_t</span> index)</span> override {</li><li>        nativeModule_-&gt;insertChildAt(handle_, child-&gt;GetHandle(), index);</li><li>    }</li><li>};</li><li>} <span class="hljs-comment">// namespace NativeModule</span></li><li>
</li><li><span class="hljs-meta">#<span class="hljs-keyword">endif</span> <span class="hljs-comment">// MYAPPLICATION_ARKUINODE_H</span></span></li></ol></pre></div></div>       <p>3）实现列表组件。</p>       <div _ngcontent-beb-c106="" class="highlight-div"><div _ngcontent-beb-c106="" class="highlight-div-header"><div _ngcontent-beb-c106="" class="highlight-div-header-left"><div _ngcontent-beb-c106="" class="handle-button expand-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-beb-c106="" class="highlight-div-header-right"><div _ngcontent-beb-c106="" class="handle-button ai-button"></div><div _ngcontent-beb-c106="" class="handle-button line-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-beb-c106="" class="handle-button theme-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-beb-c106="" class="handle-button copy-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-beb-c106="" class="highlight-scroll-div"><pre class="c prettyprint linenums hljs language-c" hw-language="c" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// ArkUIListNode.h</span></li><li><span class="hljs-comment">// 提供列表组件的封装。</span></li><li>
</li><li><span class="hljs-meta">#<span class="hljs-keyword">ifndef</span> MYAPPLICATION_ARKUILISTNODE_H</span></li><li><span class="hljs-meta">#<span class="hljs-keyword">define</span> MYAPPLICATION_ARKUILISTNODE_H</span></li><li>
</li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"ArkUINode.h"</span></span></li><li>
</li><li>namespace NativeModule {</li><li><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ArkUIListNode</span> :</span> public ArkUINode {</li><li>public:</li><li>    ArkUIListNode()</li><li>        : ArkUINode((NativeModuleInstance::GetInstance()-&gt;GetNativeNodeAPI())-&gt;createNode(ARKUI_NODE_LIST)) {} <span class="hljs-comment">// 创建ArkUI的列表组件。</span></li><li>
</li><li>    ~ArkUIListNode() override {}</li><li>    <span class="hljs-comment">// List组件的属性NDK接口封装。</span></li><li>    <span class="hljs-type">void</span> <span class="hljs-title function_">SetScrollBarState</span><span class="hljs-params">(<span class="hljs-type">bool</span> isShow)</span> {</li><li>        assert(handle_);</li><li>        ArkUI_ScrollBarDisplayMode displayMode =</li><li>            isShow ? ARKUI_SCROLL_BAR_DISPLAY_MODE_ON : ARKUI_SCROLL_BAR_DISPLAY_MODE_OFF;</li><li>        ArkUI_NumberValue value[] = {{.i32 = displayMode}};</li><li>        ArkUI_AttributeItem item = {value, <span class="hljs-number">1</span>};</li><li>        nativeModule_-&gt;setAttribute(handle_, NODE_SCROLL_BAR_DISPLAY_MODE, &amp;item);</li><li>    }</li><li>};</li><li>} <span class="hljs-comment">// namespace NativeModule</span></li><li>
</li><li><span class="hljs-meta">#<span class="hljs-keyword">endif</span> <span class="hljs-comment">// MYAPPLICATION_ARKUILISTNODE_H</span></span></li></ol></pre></div></div>       <p>4）实现列表项组件。</p>       <div _ngcontent-beb-c106="" class="highlight-div"><div _ngcontent-beb-c106="" class="highlight-div-header"><div _ngcontent-beb-c106="" class="highlight-div-header-left"><div _ngcontent-beb-c106="" class="handle-button expand-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-beb-c106="" class="highlight-div-header-right"><div _ngcontent-beb-c106="" class="handle-button ai-button"></div><div _ngcontent-beb-c106="" class="handle-button line-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-beb-c106="" class="handle-button theme-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-beb-c106="" class="handle-button copy-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-beb-c106="" class="highlight-scroll-div"><pre class="c prettyprint linenums hljs language-c" hw-language="c" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// ArkUIListItemNode.h</span></li><li><span class="hljs-comment">// 提供列表项的封装类。</span></li><li>
</li><li><span class="hljs-meta">#<span class="hljs-keyword">ifndef</span> MYAPPLICATION_ARKUISTACKNODE_H</span></li><li><span class="hljs-meta">#<span class="hljs-keyword">define</span> MYAPPLICATION_ARKUISTACKNODE_H</span></li><li>
</li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"ArkUINode.h"</span></span></li><li>
</li><li>namespace NativeModule {</li><li><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ArkUIListItemNode</span> :</span> public ArkUINode {</li><li>public:</li><li>    ArkUIListItemNode()</li><li>        : ArkUINode((NativeModuleInstance::GetInstance()-&gt;GetNativeNodeAPI())-&gt;createNode(ARKUI_NODE_LIST_ITEM)) {}</li><li>};</li><li>} <span class="hljs-comment">// namespace NativeModule</span></li><li>
</li><li><span class="hljs-meta">#<span class="hljs-keyword">endif</span> <span class="hljs-comment">// MYAPPLICATION_ARKUISTACKNODE_H</span></span></li></ol></pre></div></div>       <p>5）实现文本组件。</p>       <div _ngcontent-beb-c106="" class="highlight-div"><div _ngcontent-beb-c106="" class="highlight-div-header"><div _ngcontent-beb-c106="" class="highlight-div-header-left"><div _ngcontent-beb-c106="" class="handle-button expand-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-beb-c106="" class="highlight-div-header-right"><div _ngcontent-beb-c106="" class="handle-button ai-button"></div><div _ngcontent-beb-c106="" class="handle-button line-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-beb-c106="" class="handle-button theme-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-beb-c106="" class="handle-button copy-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-beb-c106="" class="highlight-scroll-div"><pre class="c prettyprint linenums hljs language-c" hw-language="c" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// ArkUITextNode.h</span></li><li><span class="hljs-comment">// 实现文本组件的封装类。</span></li><li>
</li><li><span class="hljs-meta">#<span class="hljs-keyword">ifndef</span> MYAPPLICATION_ARKUITEXTNODE_H</span></li><li><span class="hljs-meta">#<span class="hljs-keyword">define</span> MYAPPLICATION_ARKUITEXTNODE_H</span></li><li>
</li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"ArkUINode.h"</span></span></li><li>
</li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string&gt;</span></span></li><li>
</li><li>namespace NativeModule {</li><li><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ArkUITextNode</span> :</span> public ArkUINode {</li><li>public:</li><li>    ArkUITextNode()</li><li>        : ArkUINode((NativeModuleInstance::GetInstance()-&gt;GetNativeNodeAPI())-&gt;createNode(ARKUI_NODE_TEXT)) {}</li><li>    <span class="hljs-comment">// 文本属性NDK接口封装。</span></li><li>    <span class="hljs-type">void</span> <span class="hljs-title function_">SetFontSize</span><span class="hljs-params">(<span class="hljs-type">float</span> fontSize)</span> {</li><li>        assert(handle_);</li><li>        ArkUI_NumberValue value[] = {{.f32 = fontSize}};</li><li>        ArkUI_AttributeItem item = {value, <span class="hljs-number">1</span>};</li><li>        nativeModule_-&gt;setAttribute(handle_, NODE_FONT_SIZE, &amp;item);</li><li>    }</li><li>    <span class="hljs-type">void</span> <span class="hljs-title function_">SetFontColor</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> color)</span> {</li><li>        assert(handle_);</li><li>        ArkUI_NumberValue value[] = {{.u32 = color}};</li><li>        ArkUI_AttributeItem item = {value, <span class="hljs-number">1</span>};</li><li>        nativeModule_-&gt;setAttribute(handle_, NODE_FONT_COLOR, &amp;item);</li><li>    }</li><li>    <span class="hljs-type">void</span> <span class="hljs-title function_">SetTextContent</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-built_in">std</span>::<span class="hljs-built_in">string</span> &amp;content)</span> {</li><li>        assert(handle_);</li><li>        ArkUI_AttributeItem item = {nullptr, <span class="hljs-number">0</span>, content.c_str()};</li><li>        nativeModule_-&gt;setAttribute(handle_, NODE_TEXT_CONTENT, &amp;item);</li><li>    }</li><li>    <span class="hljs-type">void</span> <span class="hljs-title function_">SetTextAlign</span><span class="hljs-params">(ArkUI_TextAlignment align)</span> {</li><li>        assert(handle_);</li><li>        ArkUI_NumberValue value[] = {{.i32 = align}};</li><li>        ArkUI_AttributeItem item = {value, <span class="hljs-number">1</span>};</li><li>        nativeModule_-&gt;setAttribute(handle_, NODE_TEXT_ALIGN, &amp;item);</li><li>    }</li><li>};</li><li>} <span class="hljs-comment">// namespace NativeModule</span></li><li>
</li><li><span class="hljs-meta">#<span class="hljs-keyword">endif</span> <span class="hljs-comment">// MYAPPLICATION_ARKUITEXTNODE_H</span></span></li></ol></pre></div></div></li>      <li>       <p>完善步骤3的CreateTextListExample函数，实现Native文本列表的创建和挂载显示。</p>       <div _ngcontent-beb-c106="" class="highlight-div"><div _ngcontent-beb-c106="" class="highlight-div-header"><div _ngcontent-beb-c106="" class="highlight-div-header-left"><div _ngcontent-beb-c106="" class="handle-button expand-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-beb-c106="" class="highlight-div-header-right"><div _ngcontent-beb-c106="" class="handle-button ai-button"></div><div _ngcontent-beb-c106="" class="handle-button line-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-beb-c106="" class="handle-button theme-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-beb-c106="" class="handle-button copy-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-beb-c106="" class="highlight-scroll-div"><pre class="c prettyprint linenums hljs language-c" hw-language="c" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// NormalTextListExample.h</span></li><li><span class="hljs-comment">// 自定义NDK接口入口函数。</span></li><li>
</li><li><span class="hljs-meta">#<span class="hljs-keyword">ifndef</span> MYAPPLICATION_NORMALTEXTLISTEXAMPLE_H</span></li><li><span class="hljs-meta">#<span class="hljs-keyword">define</span> MYAPPLICATION_NORMALTEXTLISTEXAMPLE_H</span></li><li>
</li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"ArkUIBaseNode.h"</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"ArkUIListItemNode.h"</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"ArkUIListNode.h"</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"ArkUITextNode.h"</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;hilog/log.h&gt;</span></span></li><li>
</li><li>namespace NativeModule {</li><li>
</li><li><span class="hljs-built_in">std</span>::<span class="hljs-built_in">shared_ptr</span>&lt;ArkUIBaseNode&gt; <span class="hljs-title function_">CreateTextListExample</span><span class="hljs-params">()</span> {</li><li>    <span class="hljs-comment">// 创建组件并挂载</span></li><li>    <span class="hljs-comment">// 1：使用智能指针创建List组件。</span></li><li>    <span class="hljs-keyword">auto</span> <span class="hljs-built_in">list</span> = <span class="hljs-built_in">std</span>::make_shared&lt;ArkUIListNode&gt;();</li><li>    <span class="hljs-built_in">list</span>-&gt;SetPercentWidth(<span class="hljs-number">1</span>);</li><li>    <span class="hljs-built_in">list</span>-&gt;SetPercentHeight(<span class="hljs-number">1</span>);</li><li>    <span class="hljs-built_in">list</span>-&gt;SetScrollBarState(<span class="hljs-literal">true</span>);</li><li>    <span class="hljs-comment">// 2：创建ListItem子组件并挂载到List上。</span></li><li>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int32_t</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">30</span>; ++i) {</li><li>        <span class="hljs-keyword">auto</span> listItem = <span class="hljs-built_in">std</span>::make_shared&lt;ArkUIListItemNode&gt;();</li><li>        <span class="hljs-keyword">auto</span> textNode = <span class="hljs-built_in">std</span>::make_shared&lt;ArkUITextNode&gt;();</li><li>        textNode-&gt;SetTextContent(<span class="hljs-built_in">std</span>::to_string(i));</li><li>        textNode-&gt;SetFontSize(<span class="hljs-number">16</span>);</li><li>        textNode-&gt;SetFontColor(<span class="hljs-number">0xFFff00ff</span>);</li><li>        textNode-&gt;SetPercentWidth(<span class="hljs-number">1</span>);</li><li>        textNode-&gt;SetWidth(<span class="hljs-number">300</span>);</li><li>        textNode-&gt;SetHeight(<span class="hljs-number">100</span>);</li><li>        textNode-&gt;SetBackgroundColor(<span class="hljs-number">0xFFfffacd</span>);</li><li>        textNode-&gt;SetTextAlign(ARKUI_TEXT_ALIGNMENT_CENTER);</li><li>        listItem-&gt;InsertChild(textNode, i);</li><li>        <span class="hljs-built_in">list</span>-&gt;AddChild(listItem);</li><li>    }</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">list</span>;</li><li>}</li><li>} <span class="hljs-comment">// namespace NativeModule</span></li><li>
</li><li><span class="hljs-meta">#<span class="hljs-keyword">endif</span> <span class="hljs-comment">// MYAPPLICATION_NORMALTEXTLISTEXAMPLE_H</span></span></li></ol></pre></div></div></li>     </ol>    </div>   </div>   <div></div></div>