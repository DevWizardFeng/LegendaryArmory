<h1 _ngcontent-oog-c119="" class="doc-title ng-star-inserted" title="接入“扫码直达”服务"> 接入“扫码直达”服务 </h1>

<div _ngcontent-oog-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div><div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p>扫码直达能力仅支持中国境内（不包含中国香港、中国澳门、中国台湾）接入使用。</p> </div></div></div> <p>在日常生活中，人们会使用各种应用扫各式各样的码，而“扫码直达”服务则为用户带来一种全新的扫码体验。</p> <p>开发者将域名注册到“扫码直达”服务后，用户可通过控制中心等系统级的常驻入口，扫应用的二维码、条形码并跳转到应用对应服务页，实现一步直达服务的体验。</p> <p>开发者接入“扫码直达”服务，能为应用带来：</p> <ul><li>更浅层的扫码入口和更便捷的“扫码直达”服务体验。</li><li>HarmonyOS强大的扫码能力。</li><li>更容易触达用户的全新渠道。</li></ul> <div class="tiledSection"><h2 id="section17514184120564">业务流程<i class="anchor-icon anchor-icon-link" anchorid="section17514184120564" tips="复制节点链接"></i></h2><p><span><img height="236.85943400000002" originheight="352" originwidth="867" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114419.52376554271459896719216621572342:50001231000000:2800:D1CE582AB48E9228D0ABB250F41109B700EA85D098404B20F2F3E9EB4F2DD4C9.png" title="点击放大" width="583.400909"></span></p> <ol><li>开发者参考App Linking指导完成域名注册。</li><li>用户通过HarmonyOS扫码入口发起扫码请求。</li><li>HarmonyOS扫码入口调用系统能力解析码值，查询码值对应的应用信息后拉起应用。</li><li>解析码值结果跳转应用服务页。</li></ol> </div> <div class="tiledSection"><h2 id="section3877330816">开发步骤<i class="anchor-icon anchor-icon-link" anchorid="section3877330816" tips="复制节点链接"></i></h2><ol><li>参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/scan-config-agc">开发准备</a>完成必要的准备工作。</li><li>处理接收到的码值，完成应用内页面跳转逻辑。<div _ngcontent-oog-c106="" class="highlight-div"><div _ngcontent-oog-c106="" class="highlight-div-header"><div _ngcontent-oog-c106="" class="highlight-div-header-left"><div _ngcontent-oog-c106="" class="handle-button expand-button"><div _ngcontent-oog-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-oog-c106="" class="highlight-div-header-right"><div _ngcontent-oog-c106="" class="handle-button ai-button"></div><div _ngcontent-oog-c106="" class="handle-button line-button"><div _ngcontent-oog-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-oog-c106="" class="handle-button theme-button"><div _ngcontent-oog-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-oog-c106="" class="handle-button copy-button"><div _ngcontent-oog-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-oog-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { router, <span class="hljs-variable language_">window</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">AbilityConstant</span>, <span class="hljs-title class_">UIAbility</span>, <span class="hljs-title class_">Want</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryAbility</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">UIAbility</span> {</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">page</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'pages/Index'</span>;</li><li>  <span class="hljs-keyword">private</span> uiContext?: <span class="hljs-title class_">UIContext</span>;</li><li>
</li><li>  <span class="hljs-comment">// 冷启动场景通过onCreate回调获取码值信息</span></li><li>  <span class="hljs-title function_">onCreate</span>(<span class="hljs-attr">want</span>: <span class="hljs-title class_">Want</span>, <span class="hljs-attr">_</span>: <span class="hljs-title class_">AbilityConstant</span>.<span class="hljs-property">LaunchParam</span>): <span class="hljs-built_in">void</span> {</li><li>    hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0001</span>, <span class="hljs-string">'[Scan Access]'</span>, <span class="hljs-string">'Succeeded in getting want in onCreate'</span>);</li><li>    <span class="hljs-comment">// 从want中获取传入的链接信息。</span></li><li>    <span class="hljs-comment">// 如传入的url为：https://www.example.com/programs?router=Access</span></li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getRouterUri</span>(want);</li><li>  }</li><li>
</li><li>
</li><li>  <span class="hljs-comment">// 热启动场景通过onNewWant回调获取码值信息</span></li><li>  <span class="hljs-title function_">onNewWant</span>(<span class="hljs-attr">want</span>: <span class="hljs-title class_">Want</span>, <span class="hljs-attr">_</span>: <span class="hljs-title class_">AbilityConstant</span>.<span class="hljs-property">LaunchParam</span>): <span class="hljs-built_in">void</span> {</li><li>    hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0001</span>, <span class="hljs-string">'[Scan Access]'</span>, <span class="hljs-string">'Succeeded in getting want in onNewWant'</span>);</li><li>    <span class="hljs-comment">// 从want中获取传入的链接信息</span></li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getRouterUri</span>(want);</li><li>  }</li><li>
</li><li>
</li><li>  <span class="hljs-title function_">onWindowStageCreate</span>(<span class="hljs-attr">windowStage</span>: <span class="hljs-variable language_">window</span>.<span class="hljs-property">WindowStage</span>): <span class="hljs-built_in">void</span> {</li><li>    hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0001</span>, <span class="hljs-string">'[Scan Access]'</span>, <span class="hljs-string">'Ability onWindowStageCreate'</span>);</li><li>    <span class="hljs-keyword">try</span> {</li><li>      windowStage.<span class="hljs-title function_">getMainWindow</span>().<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">windowObj: <span class="hljs-variable language_">window</span>.Window</span>) =&gt;</span> {</li><li>        <span class="hljs-keyword">try</span> {</li><li>          windowStage.<span class="hljs-title function_">loadContent</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">page</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0001</span>, <span class="hljs-string">'[Scan Access]'</span>, <span class="hljs-string">'Succeeded in loading the content.'</span>);</li><li>            <span class="hljs-keyword">try</span> {</li><li>              <span class="hljs-variable language_">this</span>.<span class="hljs-property">uiContext</span> = windowObj.<span class="hljs-title function_">getUIContext</span>();</li><li>              hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0001</span>, <span class="hljs-string">'[Scan Access]'</span>, <span class="hljs-string">'Succeeded in getting UIContext.'</span>);</li><li>            } <span class="hljs-keyword">catch</span> (error) {</li><li>              hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0001</span>, <span class="hljs-string">'[Scan Access]'</span>, <span class="hljs-string">`Failed to get UIContext by windowObj. Code: <span class="hljs-subst">${error.code}</span>.`</span>);</li><li>            }</li><li>          }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error: BusinessError</span>) =&gt;</span> {</li><li>            hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0001</span>, <span class="hljs-string">'[Scan Access]'</span>, <span class="hljs-string">`Failed to load the content. Code: <span class="hljs-subst">${error.code}</span>.`</span>);</li><li>          })</li><li>        } <span class="hljs-keyword">catch</span> (error) {</li><li>          hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0001</span>, <span class="hljs-string">'[Scan Access]'</span>, <span class="hljs-string">`Failed to load the content. Code: <span class="hljs-subst">${error.code}</span>.`</span>);</li><li>        }</li><li>      }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error: BusinessError</span>) =&gt;</span> {</li><li>        hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0001</span>, <span class="hljs-string">'[Scan Access]'</span>, <span class="hljs-string">`Failed to get MainWindow. Code: <span class="hljs-subst">${error.code}</span>.`</span>);</li><li>      })</li><li>    } <span class="hljs-keyword">catch</span> (error) {</li><li>      hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0001</span>, <span class="hljs-string">'[Scan Access]'</span>, <span class="hljs-string">`Failed to get MainWindow. Code: <span class="hljs-subst">${error.code}</span>.`</span>);</li><li>    }</li><li>  }</li><li>
</li><li>
</li><li>  <span class="hljs-comment">// 解析扫码结果，跳转相应页面</span></li><li>  <span class="hljs-keyword">private</span> <span class="hljs-title function_">getRouterUri</span>(<span class="hljs-params">want: Want</span>) {</li><li>    <span class="hljs-keyword">const</span> <span class="hljs-attr">uri</span>: <span class="hljs-built_in">string</span> | <span class="hljs-literal">undefined</span> = want?.<span class="hljs-property">uri</span>;</li><li>    <span class="hljs-keyword">if</span> (uri &amp;&amp; <span class="hljs-variable language_">this</span>.<span class="hljs-property">uiContext</span>) {</li><li>      <span class="hljs-comment">// 开发者根据解析的uri跳转至相应页面，例如需要跳转页面为"pages/Access"</span></li><li>      <span class="hljs-keyword">const</span> <span class="hljs-attr">status</span>: router.<span class="hljs-property">RouterState</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">uiContext</span>.<span class="hljs-title function_">getRouter</span>().<span class="hljs-title function_">getState</span>();</li><li>      <span class="hljs-keyword">if</span> (status &amp;&amp; status.<span class="hljs-property">name</span> !== <span class="hljs-string">'Access'</span> &amp;&amp; uri) {</li><li>        <span class="hljs-keyword">try</span> {</li><li>          <span class="hljs-comment">// 根据uri参数做业务处理</span></li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">uiContext</span>.<span class="hljs-title function_">getRouter</span>().<span class="hljs-title function_">pushUrl</span>({</li><li>            <span class="hljs-attr">url</span>: <span class="hljs-string">'pages/Access'</span></li><li>          }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error: BusinessError</span>) =&gt;</span> {</li><li>            hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0001</span>, <span class="hljs-string">'[Scan Access]'</span>, <span class="hljs-string">`Failed to pushUrl by getRouter. Code: <span class="hljs-subst">${error.code}</span>.`</span>);</li><li>          });</li><li>        } <span class="hljs-keyword">catch</span> (error) {</li><li>          hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0001</span>, <span class="hljs-string">'[Scan Access]'</span>, <span class="hljs-string">`Failed to pushUrl by getRouter. Code: <span class="hljs-subst">${error.code}</span>.`</span>);</li><li>        }</li><li>      }</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div> </li><li>验证“扫码直达”服务。<ol><li>将配置好域名映射关系的测试应用安装到本地。</li><li>打开HarmonyOS扫码入口（控制中心扫码入口），扫描应用发行的二维码。</li><li>确认能否拉起应用并跳转目标服务页。</li></ol> </li><li>集成效果，以美团单车场景为例：<p><span><img height="498.05840000000006" originheight="720" originwidth="348" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114419.70668947284020765170342653800371:50001231000000:2800:057371510ADAC4CBBF2EAF2535C35E27359DE971C19EC79F7EF270F8E06F8224.gif" title="点击放大" width="240.71670000000003"></span></p> </li></ol> </div> <div class="tiledSection"><h2 id="section203641044153015">开发后验证<i class="anchor-icon anchor-icon-link" anchorid="section203641044153015" tips="复制节点链接"></i></h2><p>集成扫码直达能力应用用户体验质量建议</p> <p>应用完成开发后，可参照以下标准检查集成扫码直达后的用户体验是否符合预期：</p>  <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.8.4.1.5.1.1" valign="top" width="9.36%"><p>标准编号</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.8.4.1.5.1.2" valign="top" width="21.029999999999998%"><p>标准项名称</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.8.4.1.5.1.3" valign="top" width="9.51%"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.8.4.1.5.1.4" valign="top" width="60.099999999999994%"><p>标准详细描述</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="9.36%"><p>1</p> </td> <td class="cellrowborder" valign="top" width="21.029999999999998%"><p>应用已安装跳转体验</p> </td> <td class="cellrowborder" valign="top" width="9.51%"><p>规则</p> </td> <td class="cellrowborder" valign="top" width="60.099999999999994%"><p>通过系统扫一扫扫描码图可以跳转到履约页面。履约页面指的是扫码后的目标服务页面，例如，扫支付码跳转到应用的支付页面，而非首页。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="9.36%"><p>2</p> </td> <td class="cellrowborder" valign="top" width="21.029999999999998%"><p>应用未安装跳转体验</p> </td> <td class="cellrowborder" valign="top" width="9.51%"><p>建议</p> </td> <td class="cellrowborder" valign="top" width="60.099999999999994%"><p>通过系统扫一扫扫描码图会拉起浏览器加载码值所对应的网页，请设计网页满足用户诉求、指导用户安装应用等。</p> </td> </tr>  </tbody></table></div> </div> </div> </div> <div></div></div>