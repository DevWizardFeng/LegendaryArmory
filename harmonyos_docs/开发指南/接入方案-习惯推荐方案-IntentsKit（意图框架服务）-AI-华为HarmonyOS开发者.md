<h1 _ngcontent-thx-c119="" class="doc-title ng-star-inserted" title="接入方案"> 接入方案 </h1>

<div _ngcontent-thx-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <div class="tiledSection">     <h2 id="section1622019412596">方案概述<i class="anchor-icon anchor-icon-link" anchorid="section1622019412596" tips="复制节点链接"></i></h2>          <p>当用户在应用/元服务内使用功能时，开发者需要按照标准意图Schema向系统共享行为数据，并支持意图调用（空调用与传参调用），以实现用户点击模板卡后跳转回对应页面。</p>    </div>    <p><span><img height="584.51904" originheight="2076" originwidth="2940" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114240.74186427569306218723906216249643:50001231000000:2800:F175B1B91BD700FAE230013BB0FA6BF50F52D73649FD2F0FC4DDE081A0D533E7.png" title="点击放大" width="827.8053"></span></p>    <div class="tiledSection">     <h2 id="section12621163216260">意图注册<i class="anchor-icon anchor-icon-link" anchorid="section12621163216260" tips="复制节点链接"></i></h2>          <p>以歌曲续听推荐特性为例，首先要注册播放歌曲意图（PlayMusic），其他意图见<a href="https://developer.huawei.com/consumer/cn/doc/service/intents-schema-0000001901962713" target="_blank">各垂域意图Schema</a>。</p>     <p>开发者需要编辑对应的意图配置insight_intent.json文件实现意图声明。insight_intent.json文件需要放置在任意一个module下面的指定目录：src/main/resources/base/profile/insight_intent.json，并且整个工程中只能存在一个insight_intent.json文件。</p>     <div _ngcontent-thx-c106="" class="highlight-div"><div _ngcontent-thx-c106="" class="highlight-div-header"><div _ngcontent-thx-c106="" class="highlight-div-header-left"><div _ngcontent-thx-c106="" class="handle-button expand-button"><div _ngcontent-thx-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-thx-c106="" class="highlight-div-header-right"><div _ngcontent-thx-c106="" class="handle-button ai-button"></div><div _ngcontent-thx-c106="" class="handle-button line-button"><div _ngcontent-thx-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-thx-c106="" class="handle-button theme-button"><div _ngcontent-thx-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-thx-c106="" class="handle-button copy-button"><div _ngcontent-thx-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-thx-c106="" class="highlight-scroll-div"><pre class="json prettyprint linenums hljs language-json" hw-language="json" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-punctuation">{</span></li><li>  <span class=""><span class="hljs-comment">// </span></span><span class=""><span class="hljs-comment">应用支持的意图</span></span><span class=""><span class="hljs-comment">列表</span></span></li><li>  <span class=""><span class="hljs-comment">// </span></span><span class=""><span class="hljs-comment">必须声明应用支持插件包含的必选</span></span><span class=""><span class="hljs-comment">意图，应用上架时会进行校验</span></span></li><li>  <span class=""><span class="hljs-attr">"insightIntents"</span></span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span></li><li>    <span class="hljs-punctuation">{</span></li><li>      <span class=""><span class="hljs-comment">// </span></span><span class=""><span class="hljs-comment">意图</span></span><span class=""><span class="hljs-comment">名称</span></span></li><li>      <span class=""><span class="hljs-comment">// </span></span><span class=""><span class="hljs-comment">名称应当遵循意图框架规范，当前仅支持预置垂域意图</span></span><span class=""><span class="hljs-comment">，不允许自定义</span></span></li><li>      <span class=""><span class="hljs-comment">// </span></span><span class=""><span class="hljs-comment">应用内意图名称唯一，不允许出现相同的名称定义</span></span></li><li>      <span class=""><span class="hljs-attr">"intentName"</span></span><span class="hljs-punctuation">:</span> <span class=""><span class="hljs-string">"PlayMusic"</span></span><span class="hljs-punctuation">,</span></li><li>      <span class=""><span class="hljs-comment">// </span></span><span class=""><span class="hljs-comment">意图</span></span><span class=""><span class="hljs-comment">所属的垂域</span></span></li><li>      <span class=""><span class="hljs-attr">"domain"</span></span><span class="hljs-punctuation">:</span> <span class=""><span class="hljs-string">"MusicDomain"</span></span><span class="hljs-punctuation">,</span></li><li>      <span class=""><span class="hljs-comment">// </span></span><span class=""><span class="hljs-comment">意图</span></span><span class=""><span class="hljs-comment">版本号</span></span></li><li>      <span class=""><span class="hljs-comment">// </span></span><span class=""><span class="hljs-comment">插件引用意图</span></span><span class=""><span class="hljs-comment">时会校验该版本号，只有和插件定义的版本号一致才能正常调用</span></span></li><li>      <span class=""><span class="hljs-attr">"intentVersion"</span></span><span class="hljs-punctuation">:</span> <span class=""><span class="hljs-string">"1.0.1"</span></span><span class="hljs-punctuation">,</span></li><li><span class="">      <span class="hljs-comment">// 意图调用逻辑入口</span></span></li><li>      <span class="hljs-comment">// </span><span class=""><span class="hljs-comment">根据意图调用文件实际路径和实际名称进行填写，此处文件仅做示意</span></span></li><li>      <span class=""><span class="hljs-attr">"srcEntry"</span></span><span class="hljs-punctuation">:</span> <span class=""><span class="hljs-string">"./ets/entryability/InsightIntentExecutorImpl.ets"</span></span><span class="hljs-punctuation">,</span></li><li>      <span class=""><span class="hljs-attr">"uiAbility"</span></span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>        <span class=""><span class="hljs-comment">// </span></span><span class=""><span class="hljs-comment">意图所在ability</span></span></li><li>        <span class=""><span class="hljs-attr">"ability"</span></span><span class="hljs-punctuation">:</span> <span class=""><span class="hljs-string">"EntryAbility"</span></span><span class="hljs-punctuation">,</span></li><li>        <span class=""><span class="hljs-comment">// UIAbility</span></span><span class=""><span class="hljs-comment">支持前后台两种执行模式</span></span></li><li>        <span class=""><span class="hljs-attr">"executeMode"</span></span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span></li><li><span class="">          <span class="hljs-string">"background"</span></span><span class="hljs-punctuation">,</span></li><li><span class="">          <span class="hljs-string">"foreground"</span></span></li><li>        <span class="hljs-punctuation">]</span></li><li>      <span class="hljs-punctuation">}</span></li><li>    <span class="hljs-punctuation">}</span></li><li>  <span class="hljs-punctuation">]</span></li><li><span class="hljs-punctuation">}</span></li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="section14210125472916">端侧意图共享<i class="anchor-icon anchor-icon-link" anchorid="section14210125472916" tips="复制节点链接"></i></h2>          <p>构建意图对象，并且调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/intents-arkts-api-insightintent#section161911659112211" target="_blank">shareIntent()</a>，实现意图共享。可同时构建多个PlayMusic或PlayMusicList的意图对象。</p>     <div _ngcontent-thx-c106="" class="highlight-div"><div _ngcontent-thx-c106="" class="highlight-div-header"><div _ngcontent-thx-c106="" class="highlight-div-header-left"><div _ngcontent-thx-c106="" class="handle-button expand-button"><div _ngcontent-thx-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-thx-c106="" class="highlight-div-header-right"><div _ngcontent-thx-c106="" class="handle-button ai-button"></div><div _ngcontent-thx-c106="" class="handle-button line-button"><div _ngcontent-thx-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-thx-c106="" class="handle-button theme-button"><div _ngcontent-thx-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-thx-c106="" class="handle-button copy-button"><div _ngcontent-thx-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-thx-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> <span class="">{ </span><span class="">insightIntent </span><span class="">} </span><span class="hljs-keyword">from</span> <span class=""><span class="hljs-string">'@kit.IntentsKit'</span></span><span class="">;</span></li><li><span class="hljs-keyword">import</span> <span class="">{ </span><span class=""><span class="hljs-title class_">BusinessError</span> </span><span class="">} </span><span class="hljs-keyword">from</span> <span class=""><span class="hljs-string">'@kit.BasicServicesKit'</span></span><span class="">;</span></li><li>
</li><li><span class="hljs-keyword">let</span> <span class=""><span class="hljs-attr">playMusicIntent1</span></span><span class="">: </span><span class="">insightIntent</span><span class="">.</span><span class=""><span class="hljs-property">InsightIntent</span></span><span class="">;</span></li><li><span class="hljs-keyword">let</span> <span class=""><span class="hljs-attr">playMusicIntent2</span></span><span class="">: </span><span class="">insightIntent</span><span class="">.</span><span class=""><span class="hljs-property">InsightIntent</span></span><span class="">;</span></li><li><span class=""><span class="hljs-comment">// </span></span><span class=""><span class="hljs-comment">共享数据接口  意图数组可以是更多的实体</span></span></li><li><span class=""><span class="hljs-comment">// </span></span><span class=""><span class="hljs-comment">根据实际代码上下文自行传入合适的</span></span><span class=""><span class="hljs-comment">context</span></span></li><li><span class="">insightIntent</span><span class="">.</span><span class=""><span class="hljs-title function_">shareIntent</span></span><span class="">(</span><span class="">context</span><span class="">, </span><span class="">[</span><span class="">playMusicIntent1</span><span class="">, </span><span class="">playMusicIntent2</span><span class="">]</span><span class="">)</span><span class="">.</span><span class=""><span class="hljs-title function_">then</span></span><span class="">(</span><span class=""><span class="hljs-function">() </span></span><span class=""><span class="hljs-function">=</span></span><span class=""><span class="hljs-function">&gt;</span></span> <span class="">{</span></li><li>  <span class=""><span class="hljs-variable language_">console</span></span><span class="">.</span><span class=""><span class="hljs-title function_">info</span></span><span class="">(</span><span class=""><span class="hljs-string">'shareIntent succeed'</span></span><span class="">)</span><span class="">;</span></li><li><span class="">}</span><span class="">)</span><span class="">.</span><span class=""><span class="hljs-title function_">catch</span></span><span class="">(</span><span class=""><span class="hljs-function">(</span></span><span class=""><span class="hljs-function"><span class="hljs-params">err</span></span></span><span class=""><span class="hljs-function"><span class="hljs-params">: </span></span></span><span class=""><span class="hljs-function"><span class="hljs-params">BusinessError</span></span></span><span class=""><span class="hljs-function">) </span></span><span class=""><span class="hljs-function">=</span></span><span class=""><span class="hljs-function">&gt;</span></span> <span class="">{</span></li><li>  <span class=""><span class="hljs-variable language_">console</span></span><span class="">.</span><span class=""><span class="hljs-title function_">error</span></span><span class="">(</span><span class=""><span class="hljs-string">`error.code: </span></span><span class=""><span class="hljs-string"><span class="hljs-subst">${</span></span></span><span class=""><span class="hljs-string"><span class="hljs-subst">err</span></span></span><span class=""><span class="hljs-string"><span class="hljs-subst">?.</span></span></span><span class=""><span class="hljs-string"><span class="hljs-subst">code</span></span></span><span class=""><span class="hljs-string"><span class="hljs-subst">}</span></span></span><span class=""><span class="hljs-string">, failed because </span></span><span class=""><span class="hljs-string"><span class="hljs-subst">${</span></span></span><span class=""><span class="hljs-string"><span class="hljs-subst">err</span></span></span><span class=""><span class="hljs-string"><span class="hljs-subst">?.</span></span></span><span class=""><span class="hljs-string"><span class="hljs-subst">message</span></span></span><span class=""><span class="hljs-string"><span class="hljs-subst">}</span></span></span><span class=""><span class="hljs-string">`</span></span><span class="">)</span><span class="">;</span></li><li><span class="">})</span><span class="">;</span></li></ol></pre></div></div>     <p>PlayMusic的意图共享字段定义见<a href="https://developer.huawei.com/consumer/cn/doc/service/intents-schema-0000001901962713" target="_blank">各垂域意图Schema</a>定义，代码示例如下：</p>     <div _ngcontent-thx-c106="" class="highlight-div"><div _ngcontent-thx-c106="" class="highlight-div-header"><div _ngcontent-thx-c106="" class="highlight-div-header-left"><div _ngcontent-thx-c106="" class="handle-button expand-button"><div _ngcontent-thx-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-thx-c106="" class="highlight-div-header-right"><div _ngcontent-thx-c106="" class="handle-button ai-button"></div><div _ngcontent-thx-c106="" class="handle-button line-button"><div _ngcontent-thx-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-thx-c106="" class="handle-button theme-button"><div _ngcontent-thx-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-thx-c106="" class="handle-button copy-button"><div _ngcontent-thx-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-thx-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> <span class="">{ </span><span class="">insightIntent </span><span class="">} </span><span class="hljs-keyword">from</span> <span class=""><span class="hljs-string">'@kit.IntentsKit'</span></span><span class="">;</span></li><li>
</li><li><span class="hljs-keyword">let</span> <span class=""><span class="hljs-attr">playMusicIntent</span></span><span class="">: </span><span class="">insightIntent</span><span class="">.</span><span class=""><span class="hljs-property">InsightIntent</span> </span><span class="">= </span><span class="">{</span></li><li>  <span class=""><span class="hljs-attr">intentName</span></span><span class="">: </span><span class=""><span class="hljs-string">"PlayMusic"</span></span><span class="">,</span></li><li>  <span class=""><span class="hljs-attr">intentVersion</span></span><span class="">: </span><span class=""><span class="hljs-string">"1.0"</span></span><span class="">,</span></li><li>  <span class=""><span class="hljs-attr">identifier</span></span><span class="">: </span><span class=""><span class="hljs-string">"52dac3b0-6520-4974-81e5-25f0879449b5"</span></span><span class="">,</span></li><li>  <span class=""><span class="hljs-attr">intentActionInfo</span></span><span class="">: </span><span class="">{</span></li><li>    <span class=""><span class="hljs-attr">actionMode</span></span><span class="">: </span><span class=""><span class="hljs-string">"EXECUTED"</span></span><span class="">,</span></li><li>    <span class=""><span class="hljs-attr">executedTimeSlots</span></span><span class="">: </span><span class="">{</span></li><li>      <span class=""><span class="hljs-attr">executedStartTime</span></span><span class="">: </span><span class=""><span class="hljs-number">1637393112000</span></span><span class="">,</span></li><li>      <span class=""><span class="hljs-attr">executedEndTime</span></span><span class="">: </span><span class=""><span class="hljs-number">1637393212000</span></span><span class="">,</span></li><li>    <span class="">}</span><span class="">,</span></li><li>    <span class=""><span class="hljs-attr">currentPercentage</span></span><span class="">: </span><span class=""><span class="hljs-number">50</span></span><span class="">,</span></li><li>  <span class="">}</span><span class="">,</span></li><li>  <span class=""><span class="hljs-attr">intentEntityInfo</span></span><span class="">: </span><span class="">{</span></li><li>    <span class=""><span class="hljs-attr">entityName</span></span><span class="">: </span><span class=""><span class="hljs-string">"Music"</span></span><span class="">,</span></li><li>    <span class=""><span class="hljs-attr">entityId</span></span><span class="">: </span><span class=""><span class="hljs-string">"C10194368"</span></span><span class="">,</span></li><li>    <span class=""><span class="hljs-attr">entityGroupId</span></span><span class="">: </span><span class=""><span class="hljs-string">"C10194321312"</span></span><span class="">,</span></li><li>    <span class=""><span class="hljs-attr">displayName</span></span><span class="">: </span><span class=""><span class="hljs-string">"</span></span><span class=""><span class="hljs-string">测试歌曲1</span></span><span class=""><span class="hljs-string">"</span></span><span class="">,</span></li><li>    <span class=""><span class="hljs-attr">description</span></span><span class="">: </span><span class=""><span class="hljs-string">"NA"</span></span><span class="">,</span></li><li>    <span class=""><span class="hljs-attr">logoURL</span></span><span class="">: </span><span class=""><span class="hljs-string">"https://www-file.abc.com/-/media/corporate/images/home/logo/abc_logo.png"</span></span><span class="">,</span></li><li>    <span class=""><span class="hljs-attr">keywords</span></span><span class="">: </span><span class="">[</span><span class=""><span class="hljs-string">"</span></span><span class=""><span class="hljs-string">华为音乐</span></span><span class=""><span class="hljs-string">"</span></span><span class="">, </span><span class=""><span class="hljs-string">"</span></span><span class=""><span class="hljs-string">化妆</span></span><span class=""><span class="hljs-string">"</span></span><span class="">]</span><span class="">,</span></li><li>    <span class=""><span class="hljs-attr">rankingHint</span></span><span class="">: </span><span class=""><span class="hljs-number">99</span></span><span class="">,</span></li><li>    <span class=""><span class="hljs-attr">expirationTime</span></span><span class="">: </span><span class=""><span class="hljs-number">1637393212000</span></span><span class="">,</span></li><li>    <span class=""><span class="hljs-attr">metadataModificationTime</span></span><span class="">: </span><span class=""><span class="hljs-number">1637393212000</span></span><span class="">,</span></li><li>    <span class=""><span class="hljs-attr">activityType</span></span><span class="">: </span><span class="">[</span><span class=""><span class="hljs-string">"1"</span></span><span class="">, </span><span class=""><span class="hljs-string">"2"</span></span><span class="">, </span><span class=""><span class="hljs-string">"3"</span></span><span class="">]</span><span class="">,</span></li><li>    <span class=""><span class="hljs-attr">artist</span></span><span class="">: </span><span class="">[</span><span class=""><span class="hljs-string">"</span></span><span class=""><span class="hljs-string">测试歌手</span></span><span class=""><span class="hljs-string">1"</span></span><span class="">, </span><span class=""><span class="hljs-string">"</span></span><span class=""><span class="hljs-string">测试歌手</span></span><span class=""><span class="hljs-string">2"</span></span><span class="">]</span><span class="">,</span></li><li>    <span class=""><span class="hljs-attr">lyricist</span></span><span class="">: </span><span class="">[</span><span class=""><span class="hljs-string">"</span></span><span class=""><span class="hljs-string">测试词作者</span></span><span class=""><span class="hljs-string">1"</span></span><span class="">, </span><span class=""><span class="hljs-string">"</span></span><span class=""><span class="hljs-string">测试词作者</span></span><span class=""><span class="hljs-string">2"</span></span><span class="">]</span><span class="">,</span></li><li>    <span class=""><span class="hljs-attr">composer</span></span><span class="">: </span><span class="">[</span><span class=""><span class="hljs-string">"</span></span><span class=""><span class="hljs-string">测试曲作者</span></span><span class=""><span class="hljs-string">1"</span></span><span class="">, </span><span class=""><span class="hljs-string">"</span></span><span class=""><span class="hljs-string">测试曲作者</span></span><span class=""><span class="hljs-string">2"</span></span><span class="">]</span><span class="">,</span></li><li>    <span class=""><span class="hljs-attr">albumName</span></span><span class="">: </span><span class=""><span class="hljs-string">"</span></span><span class=""><span class="hljs-string">测试专辑</span></span><span class=""><span class="hljs-string">"</span></span><span class="">,</span></li><li>    <span class=""><span class="hljs-attr">duration</span></span><span class="">: </span><span class=""><span class="hljs-number">244000</span></span><span class="">,</span></li><li>    <span class=""><span class="hljs-attr">playCount</span></span><span class="">: </span><span class=""><span class="hljs-number">100000</span></span><span class="">,</span></li><li>    <span class=""><span class="hljs-attr">musicalGenre</span></span><span class="">: </span><span class="">[</span><span class=""><span class="hljs-string">"</span></span><span class=""><span class="hljs-string">流行</span></span><span class=""><span class="hljs-string">"</span></span><span class="">, </span><span class=""><span class="hljs-string">"华语"</span></span><span class="">, </span><span class=""><span class="hljs-string">"</span></span><span class=""><span class="hljs-string">金曲</span></span><span class=""><span class="hljs-string">"</span></span><span class="">, </span><span class=""><span class="hljs-string">"00</span></span><span class=""><span class="hljs-string">后</span></span><span class=""><span class="hljs-string">"</span></span><span class="">]</span><span class="">,</span></li><li>    <span class=""><span class="hljs-attr">isPublicData</span></span><span class="">: </span><span class="hljs-literal">false</span><span class="">,</span></li><li>  <span class="">}</span></li><li><span class="">}</span></li></ol></pre></div></div>     <p>完整的意图共享示例如下所示，该示例构建了一个PlayMusic意图，并进行了shareIntent调用。</p>     <div _ngcontent-thx-c106="" class="highlight-div"><div _ngcontent-thx-c106="" class="highlight-div-header"><div _ngcontent-thx-c106="" class="highlight-div-header-left"><div _ngcontent-thx-c106="" class="handle-button expand-button"><div _ngcontent-thx-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-thx-c106="" class="highlight-div-header-right"><div _ngcontent-thx-c106="" class="handle-button ai-button"></div><div _ngcontent-thx-c106="" class="handle-button line-button"><div _ngcontent-thx-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-thx-c106="" class="handle-button theme-button"><div _ngcontent-thx-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-thx-c106="" class="handle-button copy-button"><div _ngcontent-thx-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-thx-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> <span class="">{ </span><span class="">insightIntent </span><span class="">} </span><span class="hljs-keyword">from</span> <span class=""><span class="hljs-string">'@kit.IntentsKit'</span></span><span class="">;</span></li><li><span class="hljs-keyword">import</span> <span class="">{ </span><span class=""><span class="hljs-title class_">BusinessError</span> </span><span class="">} </span><span class="hljs-keyword">from</span> <span class=""><span class="hljs-string">'@kit.BasicServicesKit'</span></span><span class="">;</span></li><li>
</li><li><span class="hljs-keyword">let</span> <span class=""><span class="hljs-attr">playMusicIntent</span></span><span class="">: </span><span class="">insightIntent</span><span class="">.</span><span class=""><span class="hljs-property">InsightIntent</span> </span><span class="">= </span><span class="">{</span></li><li>  <span class=""><span class="hljs-attr">intentName</span></span><span class="">: </span><span class=""><span class="hljs-string">"PlayMusic"</span></span><span class="">,</span></li><li>  <span class=""><span class="hljs-attr">intentVersion</span></span><span class="">: </span><span class=""><span class="hljs-string">"1.0"</span></span><span class="">,</span></li><li>  <span class=""><span class="hljs-attr">identifier</span></span><span class="">: </span><span class=""><span class="hljs-string">"52dac3b0-6520-4974-81e5-25f0879449b5"</span></span><span class="">,</span></li><li>  <span class=""><span class="hljs-attr">intentActionInfo</span></span><span class="">: </span><span class="">{</span></li><li>    <span class=""><span class="hljs-attr">actionMode</span></span><span class="">: </span><span class=""><span class="hljs-string">"EXECUTED"</span></span><span class="">,</span></li><li>    <span class=""><span class="hljs-attr">executedTimeSlots</span></span><span class="">: </span><span class="">{</span></li><li>      <span class=""><span class="hljs-attr">executedStartTime</span></span><span class="">: </span><span class=""><span class="hljs-number">1637393112000</span></span><span class="">,</span></li><li>      <span class=""><span class="hljs-attr">executedEndTime</span></span><span class="">: </span><span class=""><span class="hljs-number">1637393212000</span></span><span class="">,</span></li><li>    <span class="">}</span><span class="">,</span></li><li>    <span class=""><span class="hljs-attr">currentPercentage</span></span><span class="">: </span><span class=""><span class="hljs-number">50</span></span><span class="">,</span></li><li>  <span class="">}</span><span class="">,</span></li><li>  <span class=""><span class="hljs-attr">intentEntityInfo</span></span><span class="">: </span><span class="">{</span></li><li>    <span class=""><span class="hljs-attr">entityName</span></span><span class="">: </span><span class=""><span class="hljs-string">"Music"</span></span><span class="">,</span></li><li>    <span class=""><span class="hljs-attr">entityId</span></span><span class="">: </span><span class=""><span class="hljs-string">"C10194368"</span></span><span class="">,</span></li><li>    <span class=""><span class="hljs-attr">entityGroupId</span></span><span class="">: </span><span class=""><span class="hljs-string">"C10194321312"</span></span><span class="">,</span></li><li>    <span class=""><span class="hljs-attr">displayName</span></span><span class="">: </span><span class=""><span class="hljs-string">"</span></span><span class=""><span class="hljs-string">测试歌曲</span></span><span class=""><span class="hljs-string">1"</span></span><span class="">,</span></li><li>    <span class=""><span class="hljs-attr">description</span></span><span class="">: </span><span class=""><span class="hljs-string">"NA"</span></span><span class="">,</span></li><li>    <span class=""><span class="hljs-attr">logoURL</span></span><span class="">: </span><span class=""><span class="hljs-string">"https://www-file.abc.com/-/media/corporate/images/home/logo/abc_logo.png"</span></span><span class="">,</span></li><li>    <span class=""><span class="hljs-attr">keywords</span></span><span class="">: </span><span class="">[</span><span class=""><span class="hljs-string">"</span></span><span class=""><span class="hljs-string">华为音乐</span></span><span class=""><span class="hljs-string">"</span></span><span class="">, </span><span class=""><span class="hljs-string">"</span></span><span class=""><span class="hljs-string">化妆</span></span><span class=""><span class="hljs-string">"</span></span><span class="">]</span><span class="">,</span></li><li>    <span class=""><span class="hljs-attr">rankingHint</span></span><span class="">: </span><span class=""><span class="hljs-number">99</span></span><span class="">,</span></li><li>    <span class=""><span class="hljs-attr">expirationTime</span></span><span class="">: </span><span class=""><span class="hljs-number">1637393212000</span></span><span class="">,</span></li><li>    <span class=""><span class="hljs-attr">metadataModificationTime</span></span><span class="">: </span><span class=""><span class="hljs-number">1637393212000</span></span><span class="">,</span></li><li>    <span class=""><span class="hljs-attr">activityType</span></span><span class="">: </span><span class="">[</span><span class=""><span class="hljs-string">"1"</span></span><span class="">, </span><span class=""><span class="hljs-string">"2"</span></span><span class="">, </span><span class=""><span class="hljs-string">"3"</span></span><span class="">]</span><span class="">,</span></li><li>    <span class=""><span class="hljs-attr">artist</span></span><span class="">: </span><span class="">[</span><span class=""><span class="hljs-string">"</span></span><span class=""><span class="hljs-string">测试歌手</span></span><span class=""><span class="hljs-string">1"</span></span><span class="">, </span><span class=""><span class="hljs-string">"</span></span><span class=""><span class="hljs-string">测试歌手</span></span><span class=""><span class="hljs-string">2"</span></span><span class="">]</span><span class="">,</span></li><li>    <span class=""><span class="hljs-attr">lyricist</span></span><span class="">: </span><span class="">[</span><span class=""><span class="hljs-string">"</span></span><span class=""><span class="hljs-string">测试词作者</span></span><span class=""><span class="hljs-string">1"</span></span><span class="">, </span><span class=""><span class="hljs-string">"</span></span><span class=""><span class="hljs-string">测试词作者</span></span><span class=""><span class="hljs-string">2"</span></span><span class="">]</span><span class="">,</span></li><li>    <span class=""><span class="hljs-attr">composer</span></span><span class="">: </span><span class="">[</span><span class=""><span class="hljs-string">"</span></span><span class=""><span class="hljs-string">测试曲作者</span></span><span class=""><span class="hljs-string">1"</span></span><span class="">, </span><span class=""><span class="hljs-string">"</span></span><span class=""><span class="hljs-string">测试曲作者</span></span><span class=""><span class="hljs-string">2"</span></span><span class="">]</span><span class="">,</span></li><li>    <span class=""><span class="hljs-attr">albumName</span></span><span class="">: </span><span class=""><span class="hljs-string">"</span></span><span class=""><span class="hljs-string">测试专辑</span></span><span class=""><span class="hljs-string">"</span></span><span class="">,</span></li><li>    <span class=""><span class="hljs-attr">duration</span></span><span class="">: </span><span class=""><span class="hljs-number">244000</span></span><span class="">,</span></li><li>    <span class=""><span class="hljs-attr">playCount</span></span><span class="">: </span><span class=""><span class="hljs-number">100000</span></span><span class="">,</span></li><li>    <span class=""><span class="hljs-attr">musicalGenre</span></span><span class="">: </span><span class="">[</span><span class=""><span class="hljs-string">"</span></span><span class=""><span class="hljs-string">流行</span></span><span class=""><span class="hljs-string">"</span></span><span class="">, </span><span class=""><span class="hljs-string">"</span></span><span class=""><span class="hljs-string">华语</span></span><span class=""><span class="hljs-string">"</span></span><span class="">, </span><span class=""><span class="hljs-string">"</span></span><span class=""><span class="hljs-string">金曲</span></span><span class=""><span class="hljs-string">"</span></span><span class="">, </span><span class=""><span class="hljs-string">"00</span></span><span class=""><span class="hljs-string">后</span></span><span class=""><span class="hljs-string">"</span></span><span class="">]</span><span class="">,</span></li><li>    <span class=""><span class="hljs-attr">isPublicData</span></span><span class="">: </span><span class="hljs-literal">false</span><span class="">,</span></li><li>  <span class="">}</span></li><li><span class="">}</span></li><li><span class=""><span class="hljs-comment">// </span></span><span class=""><span class="hljs-comment">共享数据接口  意图数组可以是更多的实体</span></span></li><li><span class=""><span class="hljs-comment">// </span></span><span class=""><span class="hljs-comment">根据实际代码上下文自行传入合适的</span></span><span class=""><span class="hljs-comment">context</span></span></li><li><span class="">insightIntent</span><span class="">.</span><span class=""><span class="hljs-title function_">shareIntent</span></span><span class="">(</span><span class="">context</span><span class="">, </span><span class="">[</span><span class="">playMusicIntent</span><span class="">]</span><span class="">)</span><span class="">.</span><span class=""><span class="hljs-title function_">then</span></span><span class="">(</span><span class=""><span class="hljs-function">() </span></span><span class=""><span class="hljs-function">=</span></span><span class=""><span class="hljs-function">&gt;</span></span> <span class="">{</span></li><li>  <span class=""><span class="hljs-variable language_">console</span></span><span class="">.</span><span class=""><span class="hljs-title function_">info</span></span><span class="">(</span><span class=""><span class="hljs-string">'shareIntent succeed'</span></span><span class="">)</span><span class="">;</span></li><li><span class="">}</span><span class="">)</span><span class="">.</span><span class=""><span class="hljs-title function_">catch</span></span><span class="">(</span><span class=""><span class="hljs-function">(</span></span><span class=""><span class="hljs-function"><span class="hljs-params">err</span></span></span><span class=""><span class="hljs-function"><span class="hljs-params">: </span></span></span><span class=""><span class="hljs-function"><span class="hljs-params">BusinessError</span></span></span><span class=""><span class="hljs-function">) </span></span><span class=""><span class="hljs-function">=</span></span><span class=""><span class="hljs-function">&gt;</span></span> <span class="">{</span></li><li>  <span class=""><span class="hljs-variable language_">console</span></span><span class="">.</span><span class=""><span class="hljs-title function_">error</span></span><span class="">(</span><span class=""><span class="hljs-string">`error.code: </span></span><span class=""><span class="hljs-string"><span class="hljs-subst">${</span></span></span><span class=""><span class="hljs-string"><span class="hljs-subst">err</span></span></span><span class=""><span class="hljs-string"><span class="hljs-subst">?.</span></span></span><span class=""><span class="hljs-string"><span class="hljs-subst">code</span></span></span><span class=""><span class="hljs-string"><span class="hljs-subst">}</span></span></span><span class=""><span class="hljs-string">, failed because </span></span><span class=""><span class="hljs-string"><span class="hljs-subst">${</span></span></span><span class=""><span class="hljs-string"><span class="hljs-subst">err</span></span></span><span class=""><span class="hljs-string"><span class="hljs-subst">?.</span></span></span><span class=""><span class="hljs-string"><span class="hljs-subst">message</span></span></span><span class=""><span class="hljs-string"><span class="hljs-subst">}</span></span></span><span class=""><span class="hljs-string">`</span></span><span class="">)</span><span class="">;</span></li><li><span class="">})</span><span class="">;</span></li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="section9408948143016">端侧意图调用<i class="anchor-icon anchor-icon-link" anchorid="section9408948143016" tips="复制节点链接"></i></h2>         </div>    <div class="tiledSection">     <h3 id="section9654633155018" class="firsth2">意图执行组件为uiAbility的意图调用<i class="anchor-icon anchor-icon-link" anchorid="section9654633155018" tips="复制节点链接"></i></h3>          <p>如上文意图注册，当开发者注册的意图承载的运行组件为uiAbility时，开发者需要自己实现InsightIntentExecutor，并在对应回调实现打开落地页（点击推荐卡片跳转的界面）的能力，PlayMusic的意图调用字段定义见<a href="https://developer.huawei.com/consumer/cn/doc/service/intents-schema-0000001901962713" target="_blank">各垂域意图Schema</a>。</p>     <p>步骤如下：</p>     <ol>      <li>继承InsightIntentExecutor。</li>      <li>重写对应方法，例如目标拉起前台页面，则可重写onExecuteInUIAbilityForegroundMode方法。</li>      <li>通过意图名称，识别播放歌曲意图（PlayMusic），在对应的方法中传递意图参数（param），并拉起对应落地页（如歌曲落地页）。       <div _ngcontent-thx-c106="" class="highlight-div"><div _ngcontent-thx-c106="" class="highlight-div-header"><div _ngcontent-thx-c106="" class="highlight-div-header-left"><div _ngcontent-thx-c106="" class="handle-button expand-button"><div _ngcontent-thx-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-thx-c106="" class="highlight-div-header-right"><div _ngcontent-thx-c106="" class="handle-button ai-button"></div><div _ngcontent-thx-c106="" class="handle-button line-button"><div _ngcontent-thx-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-thx-c106="" class="handle-button theme-button"><div _ngcontent-thx-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-thx-c106="" class="handle-button copy-button"><div _ngcontent-thx-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-thx-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> <span class="">{ </span><span class="">insightIntent</span><span class="">, </span><span class=""><span class="hljs-title class_">InsightIntentExecutor</span> </span><span class="">} </span><span class="hljs-keyword">from</span> <span class=""><span class="hljs-string">'@kit.AbilityKit'</span></span><span class="">;</span></li><li><span class="hljs-keyword">import</span> <span class="">{ </span><span class=""><span class="hljs-variable language_">window</span> </span><span class="">} </span><span class="hljs-keyword">from</span> <span class=""><span class="hljs-string">'@kit.ArkUI'</span></span><span class="">;</span></li><li><span class="hljs-keyword">import</span> <span class="">{ </span><span class=""><span class="hljs-title class_">BusinessError</span> </span><span class="">} </span><span class="hljs-keyword">from</span> <span class=""><span class="hljs-string">'@kit.BasicServicesKit'</span></span><span class="">;</span></li><li>
</li><li><span class=""><span class="hljs-comment">/**</span></span><span class="hljs-comment"></span></li><li><span class="hljs-comment"></span><span class=""><span class="hljs-comment"> * </span></span><span class=""><span class="hljs-comment">意图调用样例</span></span><span class="hljs-comment"></span></li><li><span class="hljs-comment"></span><span class=""><span class="hljs-comment"> */</span></span></li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class=""><span class="hljs-title class_">InsightIntentExecutorImpl</span> </span><span class="hljs-keyword">extends</span> <span class=""><span class="hljs-title class_ inherited__">InsightIntentExecutor</span> </span><span class="">{</span></li><li>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">readonly</span> <span class=""><span class="hljs-variable constant_">PLAY_MUSIC</span> </span><span class="">= </span><span class=""><span class="hljs-string">'PlayMusic'</span></span><span class="">;</span></li><li>  <span class=""><span class="hljs-comment">/**</span></span><span class="hljs-comment"></span></li><li><span class="hljs-comment"></span><span class=""><span class="hljs-comment">   * override </span></span><span class=""><span class="hljs-comment">执行前台</span></span><span class=""><span class="hljs-comment">UIAbility</span></span><span class=""><span class="hljs-comment">意图</span></span><span class="hljs-comment"></span></li><li><span class="hljs-comment"></span><span class=""><span class="hljs-comment">   *</span></span><span class="hljs-comment"></span></li><li><span class="hljs-comment"></span><span class=""><span class="hljs-comment">   * <span class="hljs-doctag">@param</span> name </span></span><span class=""><span class="hljs-comment">意图名称</span></span><span class="hljs-comment"></span></li><li><span class="hljs-comment"></span><span class=""><span class="hljs-comment">   * <span class="hljs-doctag">@param</span> param </span></span><span class=""><span class="hljs-comment">意图参数</span></span><span class="hljs-comment"></span></li><li><span class="hljs-comment"></span><span class=""><span class="hljs-comment">   * <span class="hljs-doctag">@param</span> pageLoader </span></span><span class=""><span class="hljs-comment">窗口</span></span><span class="hljs-comment"></span></li><li><span class="hljs-comment"></span><span class=""><span class="hljs-comment">   * <span class="hljs-doctag">@returns</span> </span></span><span class=""><span class="hljs-comment">意图调用结果</span></span><span class="hljs-comment"></span></li><li><span class="hljs-comment"></span><span class=""><span class="hljs-comment">   */</span></span></li><li>  <span class=""><span class="hljs-title function_">onExecuteInUIAbilityForegroundMode</span></span><span class="">(</span><span class=""><span class="hljs-attr">name</span></span><span class="">: </span><span class=""><span class="hljs-built_in">string</span></span><span class="">, </span><span class=""><span class="hljs-attr">param</span></span><span class="">: </span><span class=""><span class="hljs-title class_">Record</span></span><span class="">&lt;</span><span class=""><span class="hljs-built_in">string</span></span><span class="">, </span><span class=""><span class="hljs-title class_">Object</span></span><span class="">&gt;</span><span class="">, </span><span class=""><span class="hljs-attr">pageLoader</span></span><span class="">: </span><span class=""><span class="hljs-variable language_">window</span></span><span class="">.</span><span class=""><span class="hljs-property">WindowStage</span></span><span class="">)</span><span class="">:</span></li><li>    <span class=""><span class="hljs-title class_">Promise</span></span><span class="">&lt;</span><span class="">insightIntent</span><span class="">.</span><span class=""><span class="hljs-property">ExecuteResult</span></span><span class="">&gt;</span> <span class="">{</span></li><li>    <span class=""><span class="hljs-comment">// </span></span><span class=""><span class="hljs-comment">根据意图名称分发处理逻辑</span></span><span class=""><span class="hljs-comment">。接入方可根据实际业务实现页面跳转</span></span></li><li>    <span class="hljs-keyword">switch</span> <span class="">(</span><span class="">name</span><span class="">) </span><span class="">{</span></li><li>      <span class="hljs-keyword">case</span> <span class=""><span class="hljs-title class_">InsightIntentExecutorImpl</span></span><span class="">.</span><span class=""><span class="hljs-property">PLAY_MUSIC</span></span><span class="">:</span></li><li>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span><span class="">.</span><span class=""><span class="hljs-title function_">playMusic</span></span><span class="">(</span><span class="">param</span><span class="">, </span><span class="">pageLoader</span><span class="">)</span><span class="">;</span></li><li>      <span class="hljs-attr">default</span><span class="">:</span></li><li>        <span class="hljs-keyword">break</span><span class="">;</span></li><li>    <span class="">}</span></li><li>    <span class="hljs-keyword">return</span> <span class=""><span class="hljs-title class_">Promise</span></span><span class="">.</span><span class=""><span class="hljs-title function_">resolve</span></span><span class="">(</span><span class="">{</span></li><li>      <span class=""><span class="hljs-attr">code</span></span><span class="">: -</span><span class=""><span class="hljs-number">1</span></span><span class="">,</span></li><li>      <span class=""><span class="hljs-attr">result</span></span><span class="">: </span><span class="">{</span></li><li>        <span class=""><span class="hljs-attr">message</span></span><span class="">: </span><span class=""><span class="hljs-string">'unknown intent'</span></span></li><li>      <span class="">}</span></li><li><span class="">    } </span><span class="hljs-keyword">as</span> <span class="">insightIntent</span><span class="">.</span><span class=""><span class="hljs-property">ExecuteResult</span></span><span class="">)</span></li><li>  <span class="">}</span></li><li>  <span class=""><span class="hljs-comment">/**</span></span><span class="hljs-comment"></span></li><li><span class="hljs-comment"></span><span class=""><span class="hljs-comment">   * </span></span><span class=""><span class="hljs-comment">实现调用播放歌曲功能</span></span><span class="hljs-comment"></span></li><li><span class="hljs-comment"></span><span class=""><span class="hljs-comment">   *</span></span><span class="hljs-comment"></span></li><li><span class="hljs-comment"></span><span class=""><span class="hljs-comment">   * <span class="hljs-doctag">@param</span> param </span></span><span class=""><span class="hljs-comment">意图参数</span></span><span class="hljs-comment"></span></li><li><span class="hljs-comment"></span><span class=""><span class="hljs-comment">   * <span class="hljs-doctag">@param</span> pageLoader </span></span><span class=""><span class="hljs-comment">窗口</span></span><span class="hljs-comment"></span></li><li><span class="hljs-comment"></span><span class=""><span class="hljs-comment">   */</span></span></li><li>  <span class="hljs-keyword">private</span> <span class=""><span class="hljs-title function_">playMusic</span></span><span class="">(</span><span class=""><span class="hljs-attr">param</span></span><span class="">: </span><span class=""><span class="hljs-title class_">Record</span></span><span class="">&lt;</span><span class=""><span class="hljs-built_in">string</span></span><span class="">, </span><span class=""><span class="hljs-title class_">Object</span></span><span class="">&gt;</span><span class="">, </span><span class=""><span class="hljs-attr">pageLoader</span></span><span class="">: </span><span class=""><span class="hljs-variable language_">window</span></span><span class="">.</span><span class=""><span class="hljs-property">WindowStage</span></span><span class="">)</span><span class="">: </span><span class=""><span class="hljs-title class_">Promise</span></span><span class="">&lt;</span><span class="">insightIntent</span><span class="">.</span><span class=""><span class="hljs-property">ExecuteResult</span></span><span class="">&gt;</span> <span class="">{</span></li><li>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class=""><span class="hljs-title class_">Promise</span></span><span class="">(<span class="hljs-function">(</span></span><span class=""><span class="hljs-function"><span class="hljs-params">resolve</span></span></span><span class=""><span class="hljs-function"><span class="hljs-params">, </span></span></span><span class=""><span class="hljs-function"><span class="hljs-params">reject</span></span></span><span class=""><span class="hljs-function">) </span></span><span class=""><span class="hljs-function">=</span></span><span class=""><span class="hljs-function">&gt;</span></span> <span class="">{</span></li><li>      <span class="hljs-keyword">let</span> <span class=""><span class="hljs-attr">para</span></span><span class="">: </span><span class=""><span class="hljs-title class_">Record</span></span><span class="">&lt;</span><span class=""><span class="hljs-built_in">string</span></span><span class="">, </span><span class=""><span class="hljs-built_in">string</span></span><span class="">&gt;</span><span class=""> = </span><span class="">{</span></li><li>        <span class=""><span class="hljs-string">'result'</span></span><span class="">: </span><span class=""><span class="hljs-title class_">JSON</span></span><span class="">.</span><span class=""><span class="hljs-title function_">stringify</span></span><span class="">(</span><span class="">param</span><span class="">)</span></li><li>      <span class="">}</span><span class="">;</span></li><li>      <span class="hljs-keyword">let</span> <span class=""><span class="hljs-attr">localStorage</span></span><span class="">: </span><span class=""><span class="hljs-title class_">LocalStorage</span> </span><span class="">= </span><span class="hljs-keyword">new</span> <span class=""><span class="hljs-title class_">LocalStorage</span></span><span class="">(</span><span class="">para</span><span class="">)</span><span class="">;</span></li><li>      <span class=""><span class="hljs-comment">// </span></span><span class=""><span class="hljs-comment">TODO </span></span><span class=""><span class="hljs-comment">实现意图调用，</span></span><span class=""><span class="hljs-comment">loadContent</span></span><span class=""><span class="hljs-comment">的入参为歌曲落地页路径，例如：</span></span><span class=""><span class="hljs-comment">pages/Index</span></span></li><li>      <span class="">pageLoader</span><span class="">.</span><span class=""><span class="hljs-title function_">loadContent</span></span><span class="">(</span><span class=""><span class="hljs-string">'pages/Index'</span></span><span class="">, </span><span class=""><span class="hljs-variable language_">localStorage</span></span><span class="">)</span></li><li>        <span class="">.</span><span class=""><span class="hljs-title function_">then</span></span><span class="">(<span class="hljs-function">() </span></span><span class=""><span class="hljs-function">=</span></span><span class=""><span class="hljs-function">&gt;</span></span> <span class="">{</span></li><li>          <span class="hljs-keyword">let</span> <span class=""><span class="hljs-attr">entityId</span></span><span class="">: </span><span class=""><span class="hljs-built_in">string</span> </span><span class="">= </span><span class="">(</span><span class="">param</span><span class="">.</span><span class=""><span class="hljs-property">items</span> </span><span class="hljs-keyword">as</span> <span class=""><span class="hljs-title class_">Array</span></span><span class="">&lt;</span><span class=""><span class="hljs-built_in">object</span></span><span class="">&gt;</span><span class="">)</span><span class="">?.</span><span class="">[</span><span class=""><span class="hljs-number">0</span></span><span class="">]</span><span class="">?.</span><span class="">[</span><span class=""><span class="hljs-string">'entityId'</span></span><span class="">]</span><span class="">;</span></li><li>          <span class=""><span class="hljs-comment">// </span></span><span class=""><span class="hljs-comment">TODO </span></span><span class=""><span class="hljs-comment">调用成功的情况，此处可以打印日志</span></span></li><li>          <span class=""><span class="hljs-title function_">resolve</span></span><span class="">(</span><span class="">{</span></li><li>            <span class=""><span class="hljs-attr">code</span></span><span class="">: </span><span class=""><span class="hljs-number">0</span></span><span class="">,</span></li><li>            <span class=""><span class="hljs-attr">result</span></span><span class="">: </span><span class="">{</span></li><li>              <span class=""><span class="hljs-attr">message</span></span><span class="">: </span><span class=""><span class="hljs-string">'Intent execute succeed'</span></span></li><li>            <span class="">}</span></li><li><span class="">          }</span><span class="">)</span><span class="">;</span></li><li>        <span class="">}</span><span class="">)</span></li><li>        <span class="">.</span><span class=""><span class="hljs-title function_">catch</span></span><span class="">(<span class="hljs-function">(</span></span><span class=""><span class="hljs-function"><span class="hljs-params">err</span></span></span><span class=""><span class="hljs-function"><span class="hljs-params">: </span></span></span><span class=""><span class="hljs-function"><span class="hljs-params">BusinessError</span></span></span><span class=""><span class="hljs-function">) </span></span><span class=""><span class="hljs-function">=</span></span><span class=""><span class="hljs-function">&gt;</span></span> <span class="">{</span></li><li>          <span class=""><span class="hljs-comment">// </span></span><span class=""><span class="hljs-comment">TODO </span></span><span class=""><span class="hljs-comment">调用失败的情况</span></span></li><li>          <span class=""><span class="hljs-title function_">resolve</span></span><span class="">(</span><span class="">{</span></li><li>            <span class=""><span class="hljs-attr">code</span></span><span class="">: -</span><span class=""><span class="hljs-number">1</span></span><span class="">,</span></li><li>            <span class=""><span class="hljs-attr">result</span></span><span class="">: </span><span class="">{</span></li><li>              <span class=""><span class="hljs-attr">message</span></span><span class="">: </span><span class=""><span class="hljs-string">'Intent execute failed'</span></span></li><li>            <span class="">}</span></li><li><span class="">          }</span><span class="">)</span></li><li>        <span class="">}</span><span class="">)</span><span class="">;</span></li><li>    <span class="">}</span><span class="">)</span></li><li>  <span class="">}</span></li><li><span class="">}</span></li></ol></pre></div></div></li>     </ol>    </div>    <div class="tiledSection">     <h3 id="section5959155055610">意图执行组件为form的意图调用<i class="anchor-icon anchor-icon-link" anchorid="section5959155055610" tips="复制节点链接"></i></h3>          <p>如上文意图注册，当开发者注册的意图承载的运行组件为form（运行组件FormExtensionAbility）时，则需要开发者在实现的FormExtensionAbility中从want中获取并解析意图名和执行参数，用于卡片展示。</p>     <p>步骤如下：</p>     <ol>      <li>在意图执行绑定FormExtensionAbility的onAddForm(want: Want)中获取运行态意图框架传入的意图名（预定义keyName为ohos.insightIntent.executeParam.name）和意图执行参数（预定义keyName为ohos.insightIntent.executeParam.param）；</li>      <li>通过意图名称，识别播放歌曲意图(PlayMusic)，在对应的方法中传递意图参数（param），并加载对应数据用于卡片展示。</li>     </ol>     <div _ngcontent-thx-c106="" class="highlight-div"><div _ngcontent-thx-c106="" class="highlight-div-header"><div _ngcontent-thx-c106="" class="highlight-div-header-left"><div _ngcontent-thx-c106="" class="handle-button expand-button"><div _ngcontent-thx-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-thx-c106="" class="highlight-div-header-right"><div _ngcontent-thx-c106="" class="handle-button ai-button"></div><div _ngcontent-thx-c106="" class="handle-button line-button"><div _ngcontent-thx-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-thx-c106="" class="handle-button theme-button"><div _ngcontent-thx-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-thx-c106="" class="handle-button copy-button"><div _ngcontent-thx-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-thx-c106="" class="highlight-scroll-div"><pre class="TypeScript prettyprint linenums hljs language-TypeScript" hw-language="TypeScript" data-highlighted="yes"><ol class="linenums"><li><strong><span class=""><span class="hljs-keyword">import</span> </span></strong><span class="">{ </span><span class=""><span class="hljs-title class_">Want</span> </span><span class="">} </span><strong><span class=""><span class="hljs-keyword">from</span> </span></strong><span class=""><span class="hljs-string">'@kit.AbilityKit'</span></span><span class="">;</span></li><li><strong><span class=""><span class="hljs-keyword">import</span> </span></strong><span class="">{ </span><span class="">formBindingData</span><span class="">, </span><span class=""><span class="hljs-title class_">FormExtensionAbility</span> </span><span class="">} </span><strong><span class=""><span class="hljs-keyword">from</span> </span></strong><span class=""><span class="hljs-string">'@kit.FormKit'</span></span><span class="">;</span></li><li>
</li><li><em><span class=""><span class="hljs-comment">/**</span></span></em><span class="hljs-comment"></span></li><li><span class="hljs-comment"></span><em><span class=""><span class="hljs-comment"> * 卡片意图调用示例</span></span></em><span class="hljs-comment"></span></li><li><span class="hljs-comment"></span><em><span class=""><span class="hljs-comment"> */</span></span></em></li><li><strong><span class=""><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> </span></strong><span class=""><span class="hljs-title class_">LoadCardFormAbility</span> </span><strong><span class=""><span class="hljs-keyword">extends</span> </span></strong><span class=""><span class="hljs-title class_ inherited__">FormExtensionAbility</span> </span><span class="">{</span></li><li>  <span class=""><span class="hljs-title function_">onAddForm</span></span><span class="">(</span><span class=""><span class="hljs-attr">want</span></span><span class="">: </span><span class=""><span class="hljs-title class_">Want</span></span><span class="">)</span><span class="">: </span><span class="">formBindingData</span><span class="">.</span><span class=""><span class="hljs-property">FormBindingData</span> </span><span class="">{</span></li><li>    <strong><span class=""><span class="hljs-keyword">if</span> </span></strong><span class="">(</span><span class="">want</span><span class="">?.</span><span class=""><span class="hljs-property">parameters</span></span><span class="">?.</span><span class="">[</span><span class=""><span class="hljs-string">'ohos.insightIntent.executeParam.name'</span></span><span class="">] </span><span class="">!= </span><strong><span class=""><span class="hljs-literal">undefined</span></span></strong><span class="">) </span><span class="">{</span></li><li>      <strong><span class=""><span class="hljs-keyword">const</span> </span></strong><span class="">intentName </span><span class="">= </span><span class="">want</span><span class="">.</span><span class=""><span class="hljs-property">parameters</span></span><span class="">[</span><span class=""><span class="hljs-string">'ohos.insightIntent.executeParam.name'</span></span><span class="">]</span><span class="">; </span><em><span class=""><span class="hljs-comment">//意图名</span></span></em></li><li><em><span class="">      <span class="hljs-comment">//</span></span></em><em><span class=""><span class="hljs-comment"><span class="hljs-doctag">TODO:</span> 根据意图名称分发处理逻辑，若仅一个卡片意图，则可以忽略</span></span></em></li><li><em>    </em><span class="">}</span></li><li>
</li><li>    <strong><span class=""><span class="hljs-keyword">if</span> </span></strong><span class="">(</span><span class="">want</span><span class="">?.</span><span class=""><span class="hljs-property">parameters</span></span><span class="">?.</span><span class="">[</span><span class=""><span class="hljs-string">'ohos.insightIntent.executeParam.param'</span></span><span class="">] </span><span class="">!= </span><strong><span class=""><span class="hljs-literal">undefined</span></span></strong><span class="">) </span><span class="">{</span></li><li>      <strong><span class=""><span class="hljs-keyword">const</span> </span></strong><span class="">executeParameter </span><span class="">= </span><span class="">want</span><span class="">.</span><span class=""><span class="hljs-property">parameters</span></span><span class="">[</span><span class=""><span class="hljs-string">'ohos.insightIntent.executeParam.param'</span></span><span class="">]</span><span class="">; </span><em><span class=""><span class="hljs-comment">//意图执行参数</span></span></em></li><li><em><span class="">      <span class="hljs-comment">//</span></span></em><em><span class=""><span class="hljs-comment"><span class="hljs-doctag">TODO:</span> 从 executeParameter 中解析具体意图执行参数，用于卡片内容展示</span></span></em></li><li><em>    </em><span class="">}</span></li><li>
</li><li>    <strong><span class=""><span class="hljs-keyword">let</span> </span></strong><span class="">formData </span><span class="">= </span><span class=""><span class="hljs-string">''</span></span><span class="">; </span><em><span class=""><span class="hljs-comment">//</span></span></em><em><span class=""><span class="hljs-comment"><span class="hljs-doctag">TODO:</span> 仅示例，根据具体逻辑封装</span></span></em></li><li><em>    </em><strong><span class=""><span class="hljs-keyword">return</span> </span></strong><span class="">formBindingData</span><span class="">.</span><span class=""><span class="hljs-title function_">createFormBindingData</span></span><span class="">(</span><span class="">formData</span><span class="">)</span><span class="">;</span></li><li>  <span class="">}</span></li><li><span class="">}</span></li></ol></pre></div></div>    </div>   </div>   <div></div></div>