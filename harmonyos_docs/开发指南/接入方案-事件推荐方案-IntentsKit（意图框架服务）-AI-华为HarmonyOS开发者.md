<h1 _ngcontent-ksr-c119="" class="doc-title ng-star-inserted" title="接入方案"> 接入方案 </h1>

<div _ngcontent-ksr-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <div class="tiledSection">     <h2 id="section215214458116">方案概述<i class="anchor-icon anchor-icon-link" anchorid="section215214458116" tips="复制节点链接"></i></h2>          <p>当开发者有事件想要通知到用户时，可通过应用/元服务的云侧服务器向智慧分发平台推送事件内容（意图共享）。系统通过智慧决策判断事件发生的条件，在满足条件时，向用户推荐事件提醒卡片，当用户点击卡片后，可跳转到应用/元服务的详情页查看事件详情（意图调用）。</p>     <p><span><img height="516.813794" originheight="1758" originwidth="2940" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114240.35684961138066309156926976437431:50001231000000:2800:428AE864E39EF403A929ECA4A8CEC91B93B6EC11EC3FDD95A5ABDA7F1B0E7891.png" title="点击放大" width="864.30183"></span></p>    </div>    <div class="tiledSection">     <h2 id="section062151151410">流程图<i class="anchor-icon anchor-icon-link" anchorid="section062151151410" tips="复制节点链接"></i></h2>          <ol>      <li>开发者获取云侧事件捐赠所需的SID（Service OpenID）。</li>     </ol>     <ol start="2">      <li>当用户有订单事件后，开发者云将事件内容和SID同步到业务云。</li>      <li>华为内部会根据事件和具体场景制定事件服务推出规则和时机。</li>      <li>在满足制定规则场景下展示对应用户事件，增加服务曝光率。</li>     </ol>     <p><span><img height="443.99616100000003" originheight="2640" originwidth="4203" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114241.20706927921170687943209227322234:50001231000000:2800:7213C2892F1563411020F47E76A0012388096EF3CEA9D8CFD116EDDB394E2C1D.png" title="点击放大" width="706.855366"></span></p>    </div>    <div class="tiledSection">     <h2 id="section187475512159">意图注册<i class="anchor-icon anchor-icon-link" anchorid="section187475512159" tips="复制节点链接"></i></h2>          <p>以还款待办事件提醒特性为例，首先要注册查看还款意图（ViewRepayment），详见<a href="https://developer.huawei.com/consumer/cn/doc/service/intents-schema-0000001901962713" target="_blank">各垂域意图Schema</a>。</p>     <p>开发者需要编辑对应的意图配置insight_intent.json文件实现意图声明。insight_intent.json文件需要放置在任意一个module下面的指定目录：src/main/resources/base/profile/insight_intent.json，并且整个工程中只能存在一个insight_intent.json文件。</p>     <div _ngcontent-ksr-c106="" class="highlight-div"><div _ngcontent-ksr-c106="" class="highlight-div-header"><div _ngcontent-ksr-c106="" class="highlight-div-header-left"><div _ngcontent-ksr-c106="" class="handle-button expand-button"><div _ngcontent-ksr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ksr-c106="" class="highlight-div-header-right"><div _ngcontent-ksr-c106="" class="handle-button ai-button"></div><div _ngcontent-ksr-c106="" class="handle-button line-button"><div _ngcontent-ksr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ksr-c106="" class="handle-button theme-button"><div _ngcontent-ksr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ksr-c106="" class="handle-button copy-button"><div _ngcontent-ksr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ksr-c106="" class="highlight-scroll-div"><pre class="json prettyprint linenums hljs language-json" hw-language="json" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-punctuation">{</span></li><li>  <span class=""><span class="hljs-comment">// </span></span><span class=""><span class="hljs-comment">应用支持的意图列表</span></span></li><li>  <span class=""><span class="hljs-comment">// </span></span><span class=""><span class="hljs-comment">必须声明应用支持插件包含的必选意图，应用上架时会进行校验</span></span></li><li>  <span class=""><span class="hljs-attr">"insightIntents"</span></span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span></li><li>    <span class="hljs-punctuation">{</span></li><li>      <span class=""><span class="hljs-comment">// </span></span><span class=""><span class="hljs-comment">意图名称</span></span></li><li>      <span class=""><span class="hljs-comment">// </span></span><span class=""><span class="hljs-comment">名称应当遵循意图框架规范，当前仅支持预置垂域意图，不允许自定义</span></span></li><li>      <span class=""><span class="hljs-comment">// </span></span><span class=""><span class="hljs-comment">应用内意图名称唯一，不允许出现相同的名称定义</span></span></li><li>      <span class=""><span class="hljs-attr">"intentName"</span></span><span class="hljs-punctuation">:</span> <span class=""><span class="hljs-string">"ViewRepayment"</span></span><span class="hljs-punctuation">,</span></li><li>      <span class=""><span class="hljs-comment">// </span></span><span class=""><span class="hljs-comment">意图所属的垂域</span></span></li><li>      <span class=""><span class="hljs-attr">"domain"</span></span><span class="hljs-punctuation">:</span> <span class=""><span class="hljs-string">"BankingDomain"</span></span><span class="hljs-punctuation">,</span></li><li>      <span class=""><span class="hljs-comment">// </span></span><span class=""><span class="hljs-comment">意图版本号</span></span></li><li>      <span class=""><span class="hljs-comment">// </span></span><span class=""><span class="hljs-comment">插件引用意图时会校验该版本号，只有和插件定义的版本号一致才能正常调用</span></span></li><li>      <span class=""><span class="hljs-attr">"intentVersion"</span></span><span class="hljs-punctuation">:</span> <span class=""><span class="hljs-string">"1.0.1"</span></span><span class="hljs-punctuation">,</span></li><li>      <span class=""><span class="hljs-comment">// </span></span><span class=""><span class="hljs-comment">意图调用逻辑入口</span></span></li><li>      <span class=""><span class="hljs-attr">"srcEntry"</span></span><span class="hljs-punctuation">:</span> <span class=""><span class="hljs-string">"./ets/entryability/InsightIntentExecutorImpl.ets"</span></span><span class="hljs-punctuation">,</span></li><li>      <span class=""><span class="hljs-attr">"uiAbility"</span></span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>        <span class=""><span class="hljs-comment">// </span></span><span class=""><span class="hljs-comment">意图所在ability</span></span></li><li>        <span class=""><span class="hljs-attr">"ability"</span></span><span class="hljs-punctuation">:</span> <span class=""><span class="hljs-string">"EntryAbility"</span></span><span class="hljs-punctuation">,</span></li><li>        <span class=""><span class="hljs-comment">// UIAbility</span></span><span class=""><span class="hljs-comment">支持前后台两种执行模式</span></span></li><li>        <span class=""><span class="hljs-attr">"executeMode"</span></span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span></li><li>          <span class=""><span class="hljs-string">"background"</span></span><span class="hljs-punctuation">,</span></li><li>          <span class=""><span class="hljs-string">"foreground"</span></span></li><li>        <span class="hljs-punctuation">]</span></li><li>      <span class="hljs-punctuation">}</span></li><li>    <span class="hljs-punctuation">}</span></li><li>  <span class="hljs-punctuation">]</span></li><li><span class="hljs-punctuation">}</span></li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="section2151759161514">获取SID<i class="anchor-icon anchor-icon-link" anchorid="section2151759161514" tips="复制节点链接"></i></h2>          <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>API文档参见：<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/intents-arkts-api-insightintent#section76701233209" target="_blank">意图框架API参考 &gt; getSid</a>。</p>      </div></div></div>     <div class="p">      云侧事件捐赠凭证SID（Service OpenID）优先从缓存获取，当缓存获取失败可以强制从云侧获取新的SID。      <div _ngcontent-ksr-c106="" class="highlight-div"><div _ngcontent-ksr-c106="" class="highlight-div-header"><div _ngcontent-ksr-c106="" class="highlight-div-header-left"><div _ngcontent-ksr-c106="" class="handle-button expand-button"><div _ngcontent-ksr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ksr-c106="" class="highlight-div-header-right"><div _ngcontent-ksr-c106="" class="handle-button ai-button"></div><div _ngcontent-ksr-c106="" class="handle-button line-button"><div _ngcontent-ksr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ksr-c106="" class="handle-button theme-button"><div _ngcontent-ksr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ksr-c106="" class="handle-button copy-button"><div _ngcontent-ksr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ksr-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> <span class="">{ </span><span class="">insightIntent </span><span class="">} </span><span class="hljs-keyword">from</span> <span class=""><span class="hljs-string">'@kit.IntentsKit'</span></span><span class="">;</span></li><li><span class="hljs-keyword">import</span> <span class="">{ </span><span class=""><span class="hljs-title class_">BusinessError</span> </span><span class="">} </span><span class="hljs-keyword">from</span> <span class=""><span class="hljs-string">'@kit.BasicServicesKit'</span></span><span class="">;</span></li><li>
</li><li><span class=""><span class="hljs-comment">// </span></span><span class=""><span class="hljs-comment">根据实际代码上下文自行传入合适的</span></span><span class=""><span class="hljs-comment">context</span></span></li><li><span class="">insightIntent</span><span class="">.</span><span class=""><span class="hljs-title function_">getSid</span></span><span class="">(</span><span class="">context</span><span class="">, </span><span class="hljs-literal">false</span><span class="">) </span><span class=""><span class="hljs-comment">// </span></span><span class=""><span class="hljs-comment">优先获取缓存</span></span><span class=""><span class="hljs-comment">SID</span></span><span class=""><span class="hljs-comment">，改为</span></span><span class=""><span class="hljs-comment">true</span></span><span class=""><span class="hljs-comment">则强制从云侧获取新</span></span><span class=""><span class="hljs-comment">SID</span></span></li><li>  <span class="">.</span><span class=""><span class="hljs-title function_">then</span></span><span class="">(</span><span class=""><span class="hljs-function">(</span></span><span class=""><span class="hljs-function"><span class="hljs-params">sid</span></span></span><span class=""><span class="hljs-function"><span class="hljs-params">: </span></span></span><span class=""><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">string</span></span></span></span><span class=""><span class="hljs-function">) </span></span><span class=""><span class="hljs-function">=</span></span><span class=""><span class="hljs-function">&gt;</span></span> <span class="">{</span></li><li>    <span class=""><span class="hljs-comment">// </span></span><span class=""><span class="hljs-comment">获取</span></span><span class=""><span class="hljs-comment">SID</span></span><span class=""><span class="hljs-comment">成功</span></span></li><li>    <span class=""><span class="hljs-variable language_">console</span></span><span class="">.</span><span class=""><span class="hljs-title function_">info</span></span><span class="">(</span><span class=""><span class="hljs-string">'getSid succeed!'</span></span><span class="">)</span><span class="">;</span></li><li>  <span class="">}</span><span class="">)</span><span class="">.</span><span class=""><span class="hljs-title function_">catch</span></span><span class="">(</span><span class=""><span class="hljs-function">(</span></span><span class=""><span class="hljs-function"><span class="hljs-params">error</span></span></span><span class=""><span class="hljs-function"><span class="hljs-params">: </span></span></span><span class=""><span class="hljs-function"><span class="hljs-params">BusinessError</span></span></span><span class=""><span class="hljs-function">) </span></span><span class=""><span class="hljs-function">=</span></span><span class=""><span class="hljs-function">&gt;</span></span> <span class="">{</span></li><li>  <span class=""><span class="hljs-comment">// </span></span><span class=""><span class="hljs-comment">获取</span></span><span class=""><span class="hljs-comment">SID</span></span><span class=""><span class="hljs-comment">失败</span></span></li><li>  <span class=""><span class="hljs-variable language_">console</span></span><span class="">.</span><span class=""><span class="hljs-title function_">error</span></span><span class="">(</span><span class=""><span class="hljs-string">`getSid failed! error=</span></span><span class=""><span class="hljs-string"><span class="hljs-subst">${</span></span></span><span class=""><span class="hljs-string"><span class="hljs-subst">error</span></span></span><span class=""><span class="hljs-string"><span class="hljs-subst">.</span></span></span><span class=""><span class="hljs-string"><span class="hljs-subst">code</span></span></span><span class=""><span class="hljs-string"><span class="hljs-subst">}</span></span></span><span class=""><span class="hljs-string"> reason=</span></span><span class=""><span class="hljs-string"><span class="hljs-subst">${</span></span></span><span class=""><span class="hljs-string"><span class="hljs-subst">error</span></span></span><span class=""><span class="hljs-string"><span class="hljs-subst">.</span></span></span><span class=""><span class="hljs-string"><span class="hljs-subst">message</span></span></span><span class=""><span class="hljs-string"><span class="hljs-subst">}</span></span></span><span class=""><span class="hljs-string">`</span></span><span class="">)</span><span class="">;</span></li><li><span class="">})</span><span class="">;</span></li></ol></pre></div></div>     </div>    </div>    <div class="tiledSection">     <h2 id="section12536204281714">云侧意图共享<i class="anchor-icon anchor-icon-link" anchorid="section12536204281714" tips="复制节点链接"></i></h2>         </div>    <div class="tiledSection">     <h3 id="section156701726185313" class="firsth2">意图共享接口调用<i class="anchor-icon anchor-icon-link" anchorid="section156701726185313" tips="复制节点链接"></i></h3>          <p>应用/元服务通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/intents-rest-api-intent-share#section105321034437" target="_blank">云侧意图共享接口</a>，把对应意图的相关事件数据共享给Intents Kit，用于事件提醒服务。</p>    </div>    <div class="tiledSection">     <h3 id="section196351950115511">事件撤销接口调用<i class="anchor-icon anchor-icon-link" anchorid="section196351950115511" tips="复制节点链接"></i></h3>          <p>当应用/元服务共享的意图相关事件数据超过时效期，Intents Kit需要通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/intents-rest-api-revoke-event" target="_blank">云侧事件撤销接口</a>把相关事件数据撤销，以避免触发超过时效期的事件提醒。</p>    </div>    <div class="tiledSection">     <h2 id="section201627147184">端侧意图调用<i class="anchor-icon anchor-icon-link" anchorid="section201627147184" tips="复制节点链接"></i></h2>          <p>开发者需要自己实现InsightIntentExecutor，并在对应回调实现打开落地页（点击推荐卡片跳转的界面）的能力，ViewRepayment的意图调用字段定义见对应<a href="https://developer.huawei.com/consumer/cn/doc/service/intents-schema-0000001901962713" target="_blank">垂域意图Schema</a>定义表。</p>     <p>步骤如下：</p>     <ol>      <li>继承InsightIntentExecutor。</li>      <li>重写对应方法，例如目标拉起前台页面，则可重写onExecuteInUIAbilityForegroundMode方法。</li>      <li>通过意图名称，识别查看还款意图（ViewRepayment）。</li>      <li>在对应的方法中传递意图参数（param），并拉起对应落地页（如还款页面）。       <div _ngcontent-ksr-c106="" class="highlight-div"><div _ngcontent-ksr-c106="" class="highlight-div-header"><div _ngcontent-ksr-c106="" class="highlight-div-header-left"><div _ngcontent-ksr-c106="" class="handle-button expand-button"><div _ngcontent-ksr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ksr-c106="" class="highlight-div-header-right"><div _ngcontent-ksr-c106="" class="handle-button ai-button"></div><div _ngcontent-ksr-c106="" class="handle-button line-button"><div _ngcontent-ksr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ksr-c106="" class="handle-button theme-button"><div _ngcontent-ksr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ksr-c106="" class="handle-button copy-button"><div _ngcontent-ksr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ksr-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> <span class="">{ </span><span class="">insightIntent</span><span class="">, </span><span class=""><span class="hljs-title class_">InsightIntentExecutor</span> </span><span class="">} </span><span class="hljs-keyword">from</span> <span class=""><span class="hljs-string">'@kit.AbilityKit'</span></span><span class="">;</span></li><li><span class="hljs-keyword">import</span> <span class="">{ </span><span class=""><span class="hljs-variable language_">window</span> </span><span class="">} </span><span class="hljs-keyword">from</span> <span class=""><span class="hljs-string">'@kit.ArkUI'</span></span><span class="">;</span></li><li><span class="hljs-keyword">import</span> <span class="">{ </span><span class=""><span class="hljs-title class_">BusinessError</span> </span><span class="">} </span><span class="hljs-keyword">from</span> <span class=""><span class="hljs-string">'@kit.BasicServicesKit'</span></span><span class="">;</span></li><li>
</li><li><span class=""><span class="hljs-comment">/**</span></span><span class="hljs-comment"></span></li><li><span class="hljs-comment"></span><span class=""><span class="hljs-comment"> * </span></span><span class=""><span class="hljs-comment">意图调用样例</span></span><span class=""><span class="hljs-comment"> */</span></span></li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">class</span> <span class=""><span class="hljs-title class_">InsightIntentExecutorImpl</span> </span><span class="hljs-keyword">extends</span> <span class=""><span class="hljs-title class_ inherited__">InsightIntentExecutor</span> </span><span class="">{</span></li><li>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">readonly</span> <span class=""><span class="hljs-variable constant_">VIEW_REPAYMENT</span> </span><span class="">= </span><span class=""><span class="hljs-string">'ViewRepayment'</span></span><span class="">;</span></li><li>  <span class=""><span class="hljs-comment">/**</span></span><span class="hljs-comment"></span></li><li><span class="hljs-comment"></span><span class=""><span class="hljs-comment">   * override </span></span><span class=""><span class="hljs-comment">执行前台</span></span><span class=""><span class="hljs-comment">UIAbility</span></span><span class=""><span class="hljs-comment">意图</span></span><span class="hljs-comment"></span></li><li><span class="hljs-comment"></span><span class=""><span class="hljs-comment">   *</span></span><span class="hljs-comment"></span></li><li><span class="hljs-comment"></span><span class=""><span class="hljs-comment">   * <span class="hljs-doctag">@param</span> name </span></span><span class=""><span class="hljs-comment">意图名称</span></span><span class="hljs-comment"></span></li><li><span class="hljs-comment"></span><span class=""><span class="hljs-comment">   * <span class="hljs-doctag">@param</span> param </span></span><span class=""><span class="hljs-comment">意图参数</span></span><span class="hljs-comment"></span></li><li><span class="hljs-comment"></span><span class=""><span class="hljs-comment">   * <span class="hljs-doctag">@param</span> pageLoader </span></span><span class=""><span class="hljs-comment">窗口</span></span><span class="hljs-comment"></span></li><li><span class="hljs-comment"></span><span class=""><span class="hljs-comment">   * <span class="hljs-doctag">@returns</span> </span></span><span class=""><span class="hljs-comment">意图调用结果</span></span><span class="hljs-comment"></span></li><li><span class="hljs-comment"></span><span class=""><span class="hljs-comment">   */</span></span></li><li>  <span class=""><span class="hljs-title function_">onExecuteInUIAbilityForegroundMode</span></span><span class="">(</span><span class=""><span class="hljs-attr">name</span></span><span class="">: </span><span class=""><span class="hljs-built_in">string</span></span><span class="">, </span><span class=""><span class="hljs-attr">param</span></span><span class="">: </span><span class=""><span class="hljs-title class_">Record</span></span><span class="">&lt;</span><span class=""><span class="hljs-built_in">string</span></span><span class="">, </span><span class=""><span class="hljs-title class_">Object</span></span><span class="">&gt;</span><span class="">, </span><span class=""><span class="hljs-attr">pageLoader</span></span><span class="">: </span><span class=""><span class="hljs-variable language_">window</span></span><span class="">.</span><span class=""><span class="hljs-property">WindowStage</span></span><span class="">)</span><span class="">:</span></li><li>    <span class=""><span class="hljs-title class_">Promise</span></span><span class="">&lt;</span><span class="">insightIntent</span><span class="">.</span><span class=""><span class="hljs-property">ExecuteResult</span></span><span class="">&gt;</span> <span class="">{</span></li><li>    <span class=""><span class="hljs-comment">// </span></span><span class=""><span class="hljs-comment">根据意图名称分发处理逻辑</span></span><span class=""><span class="hljs-comment">。接入方可根据实际业务实现页面跳转</span></span></li><li>    <span class="hljs-keyword">switch</span> <span class="">(</span><span class="">name</span><span class="">) </span><span class="">{</span></li><li>      <span class="hljs-keyword">case</span> <span class=""><span class="hljs-title class_">InsightIntentExecutorImpl</span></span><span class="">.</span><span class=""><span class="hljs-property">VIEW_REPAYMENT</span></span><span class="">:</span></li><li>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span><span class="">.</span><span class=""><span class="hljs-title function_">viewRepayment</span></span><span class="">(</span><span class="">param</span><span class="">, </span><span class="">pageLoader</span><span class="">)</span><span class="">;</span></li><li>      <span class="hljs-attr">default</span><span class="">:</span></li><li>        <span class="hljs-keyword">break</span><span class="">;</span></li><li>    <span class="">}</span></li><li>    <span class="hljs-keyword">return</span> <span class=""><span class="hljs-title class_">Promise</span></span><span class="">.</span><span class=""><span class="hljs-title function_">resolve</span></span><span class="">(</span><span class="">{</span></li><li>      <span class=""><span class="hljs-attr">code</span></span><span class="">: -</span><span class=""><span class="hljs-number">1</span></span><span class="">,</span></li><li>      <span class=""><span class="hljs-attr">result</span></span><span class="">: </span><span class="">{</span></li><li>        <span class=""><span class="hljs-attr">message</span></span><span class="">: </span><span class=""><span class="hljs-string">'unknown intent'</span></span></li><li>      <span class="">}</span></li><li><span class="">    } </span><span class="hljs-keyword">as</span> <span class="">insightIntent</span><span class="">.</span><span class=""><span class="hljs-property">ExecuteResult</span></span><span class="">)</span></li><li>  <span class="">}</span></li><li>
</li><li>  <span class=""><span class="hljs-comment">/**</span></span><span class="hljs-comment"></span></li><li><span class="hljs-comment"></span><span class=""><span class="hljs-comment">   * </span></span><span class=""><span class="hljs-comment">实现调用查看还款功能</span></span><span class="hljs-comment"></span></li><li><span class="hljs-comment"></span><span class=""><span class="hljs-comment">   *</span></span><span class="hljs-comment"></span></li><li><span class="hljs-comment"></span><span class=""><span class="hljs-comment">   * <span class="hljs-doctag">@param</span> param </span></span><span class=""><span class="hljs-comment">意图参数</span></span><span class="hljs-comment"></span></li><li><span class="hljs-comment"></span><span class=""><span class="hljs-comment">   * <span class="hljs-doctag">@param</span> pageLoader </span></span><span class=""><span class="hljs-comment">窗口</span></span><span class="hljs-comment"></span></li><li><span class="hljs-comment"></span><span class=""><span class="hljs-comment">   */</span></span></li><li>  <span class="hljs-keyword">private</span> <span class=""><span class="hljs-title function_">viewRepayment</span></span><span class="">(</span><span class=""><span class="hljs-attr">param</span></span><span class="">: </span><span class=""><span class="hljs-title class_">Record</span></span><span class="">&lt;</span><span class=""><span class="hljs-built_in">string</span></span><span class="">, </span><span class=""><span class="hljs-title class_">Object</span></span><span class="">&gt;</span><span class="">, </span><span class=""><span class="hljs-attr">pageLoader</span></span><span class="">: </span><span class=""><span class="hljs-variable language_">window</span></span><span class="">.</span><span class=""><span class="hljs-property">WindowStage</span></span><span class="">)</span><span class="">: </span><span class=""><span class="hljs-title class_">Promise</span></span><span class="">&lt;</span><span class="">insightIntent</span><span class="">.</span><span class=""><span class="hljs-property">ExecuteResult</span></span><span class="">&gt;</span> <span class="">{</span></li><li>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class=""><span class="hljs-title class_">Promise</span></span><span class="">(<span class="hljs-function">(</span></span><span class=""><span class="hljs-function"><span class="hljs-params">resolve</span></span></span><span class=""><span class="hljs-function"><span class="hljs-params">, </span></span></span><span class=""><span class="hljs-function"><span class="hljs-params">reject</span></span></span><span class=""><span class="hljs-function">) </span></span><span class=""><span class="hljs-function">=</span></span><span class=""><span class="hljs-function">&gt;</span></span> <span class="">{</span></li><li>      <span class="hljs-keyword">let</span> <span class=""><span class="hljs-attr">para</span></span><span class="">: </span><span class=""><span class="hljs-title class_">Record</span></span><span class="">&lt;</span><span class=""><span class="hljs-built_in">string</span></span><span class="">, </span><span class=""><span class="hljs-built_in">string</span></span><span class="">&gt;</span><span class=""> = </span><span class="">{</span></li><li>        <span class=""><span class="hljs-string">'result'</span></span><span class="">: </span><span class=""><span class="hljs-title class_">JSON</span></span><span class="">.</span><span class=""><span class="hljs-title function_">stringify</span></span><span class="">(</span><span class="">param</span><span class="">)</span></li><li>      <span class="">}</span><span class="">;</span></li><li>      <span class="hljs-keyword">let</span> <span class=""><span class="hljs-attr">localStorage</span></span><span class="">: </span><span class=""><span class="hljs-title class_">LocalStorage</span> </span><span class="">= </span><span class="hljs-keyword">new</span> <span class=""><span class="hljs-title class_">LocalStorage</span></span><span class="">(</span><span class="">para</span><span class="">)</span><span class="">;</span></li><li>      <span class=""><span class="hljs-comment">// </span></span><span class=""><span class="hljs-comment">TODO </span></span><span class=""><span class="hljs-comment">实现意图调用，</span></span><span class=""><span class="hljs-comment">loadContent</span></span><span class=""><span class="hljs-comment">的入参为查看还款落地页路径，例如：</span></span><span class=""><span class="hljs-comment">'pages/Index'</span></span></li><li>      <span class="">pageLoader</span><span class="">.</span><span class=""><span class="hljs-title function_">loadContent</span></span><span class="">(</span><span class=""><span class="hljs-string">'pages/Index'</span></span><span class="">, </span><span class=""><span class="hljs-variable language_">localStorage</span></span><span class="">)</span></li><li>        <span class="">.</span><span class=""><span class="hljs-title function_">then</span></span><span class="">(<span class="hljs-function">() </span></span><span class=""><span class="hljs-function">=</span></span><span class=""><span class="hljs-function">&gt;</span></span> <span class="">{</span></li><li>          <span class="hljs-keyword">let</span> <span class=""><span class="hljs-attr">entityId</span></span><span class="">: </span><span class=""><span class="hljs-built_in">string</span> </span><span class="">= </span><span class="">(</span><span class="">param</span><span class="">.</span><span class=""><span class="hljs-property">items</span> </span><span class="hljs-keyword">as</span> <span class=""><span class="hljs-title class_">Array</span></span><span class="">&lt;</span><span class=""><span class="hljs-built_in">object</span></span><span class="">&gt;</span><span class="">)</span><span class="">?.</span><span class="">[</span><span class=""><span class="hljs-number">0</span></span><span class="">]</span><span class="">?.</span><span class="">[</span><span class=""><span class="hljs-string">'entityId'</span></span><span class="">]</span><span class="">;</span></li><li>          <span class=""><span class="hljs-comment">// </span></span><span class=""><span class="hljs-comment">TODO </span></span><span class=""><span class="hljs-comment">调用成功的情况，此处可以打印日志</span></span></li><li>          <span class=""><span class="hljs-title function_">resolve</span></span><span class="">(</span><span class="">{</span></li><li>            <span class=""><span class="hljs-attr">code</span></span><span class="">: </span><span class=""><span class="hljs-number">0</span></span><span class="">,</span></li><li>            <span class=""><span class="hljs-attr">result</span></span><span class="">: </span><span class="">{</span></li><li>              <span class=""><span class="hljs-attr">message</span></span><span class="">: </span><span class=""><span class="hljs-string">'Intent execute succeed'</span></span></li><li>            <span class="">}</span></li><li><span class="">          }</span><span class="">)</span><span class="">;</span></li><li>        <span class="">}</span><span class="">)</span></li><li>        <span class="">.</span><span class=""><span class="hljs-title function_">catch</span></span><span class="">(<span class="hljs-function">(</span></span><span class=""><span class="hljs-function"><span class="hljs-params">err</span></span></span><span class=""><span class="hljs-function"><span class="hljs-params">: </span></span></span><span class=""><span class="hljs-function"><span class="hljs-params">BusinessError</span></span></span><span class=""><span class="hljs-function">) </span></span><span class=""><span class="hljs-function">=</span></span><span class=""><span class="hljs-function">&gt;</span></span> <span class="">{</span></li><li>          <span class=""><span class="hljs-comment">// </span></span><span class=""><span class="hljs-comment">TODO </span></span><span class=""><span class="hljs-comment">调用失败的情况</span></span></li><li>          <span class=""><span class="hljs-title function_">resolve</span></span><span class="">(</span><span class="">{</span></li><li>            <span class=""><span class="hljs-attr">code</span></span><span class="">: -</span><span class=""><span class="hljs-number">1</span></span><span class="">,</span></li><li>            <span class=""><span class="hljs-attr">result</span></span><span class="">: </span><span class="">{</span></li><li>              <span class=""><span class="hljs-attr">message</span></span><span class="">: </span><span class=""><span class="hljs-string">'Intent execute failed'</span></span></li><li>            <span class="">}</span></li><li><span class="">          }</span><span class="">)</span></li><li>        <span class="">}</span><span class="">)</span><span class="">;</span></li><li>    <span class="">}</span><span class="">)</span></li><li>  <span class="">}</span></li><li><span class="">}</span></li></ol></pre></div></div></li>     </ol>    </div>   </div>   <div></div></div>