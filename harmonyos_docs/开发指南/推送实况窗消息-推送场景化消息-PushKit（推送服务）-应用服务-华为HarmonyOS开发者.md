<h1 _ngcontent-bmd-c119="" class="doc-title ng-star-inserted" title="推送实况窗消息"> 推送实况窗消息 </h1>

<div _ngcontent-bmd-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <div class="tiledSection">     <h2 id="section118281298134">场景介绍<i class="anchor-icon anchor-icon-link" anchorid="section118281298134" tips="复制节点链接"></i></h2>          <p>实况窗是一种帮助用户聚焦正在进行的任务，方便快速查看和即时处理的通知形态。有关实况窗简介、权限申请、开放场景、设计规范等说明，请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/liveview-introduction" target="_blank">Live View Kit简介</a>。</p>     <p>通过Push Kit发送的实况窗消息支持三种操作类型，分别是：</p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.1.4.1.4.1.1" valign="top" width="20.84%">          <p>实况窗消息操作类型</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.1.4.1.4.1.2" valign="top" width="29.299999999999997%">          <p>支持操作的场景类型</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.1.4.1.4.1.3" valign="top" width="49.86%">          <p>说明</p></th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="20.84%">          <p>创建实况窗</p></td>         <td class="cellrowborder" valign="top" width="29.299999999999997%">          <p>FLIGHT、TAXI、TRAIN</p></td>         <td class="cellrowborder" valign="top" width="49.86%">          <p>仅航班、出行打车、高铁/火车场景支持通过Push Kit创建实况窗，其他场景请通过Live View Kit本地创建。</p></td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="20.84%">          <p>更新实况窗</p></td>         <td class="cellrowborder" valign="top" width="29.299999999999997%">          <p>所有场景</p></td>         <td class="cellrowborder" valign="top" width="49.86%">          <p>所有场景皆支持通过Push Kit更新实况窗。</p></td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="20.84%">          <p>结束实况窗</p></td>         <td class="cellrowborder" valign="top" width="29.299999999999997%">          <p>所有场景</p></td>         <td class="cellrowborder" valign="top" width="49.86%">          <p>所有场景皆支持通过Push Kit结束实况窗。</p></td>        </tr>             </tbody></table></div>     </div>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>推送实况窗消息仅支持Phone、Tablet设备。</p>      </div></div></div>     <p>有关场景类型的详细说明请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/liveview-introduction#section1539812274717" target="_blank">支持的范围与场景</a>。</p>     <p>根据创建实况窗的方式不同，通过Push Kit发送实况窗消息的流程有所区别。</p>     <p><strong>通过Live View Kit创建实况窗，Push Kit更新与结束实况窗</strong></p>     <p><span><img height="359.1" originheight="572" originwidth="832" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114629.21700418114276295100431354535191:50001231000000:2800:7907DDFF095FB94FD863A57D741CFD92ABC2478AB06E336E270D119E34414068.png" title="点击放大" width="523.6875"></span></p>     <ol>      <li>使用Push Kit，获取Push Token。</li>      <li>使用Live View Kit创建实况窗成功后，开发者需要将实况窗id、pushToken、实况窗场景event以及业务服务的相关的状态属性保存到业务服务端。</li>      <li>当业务服务的用户订单状态发生变化时，通过Push Kit通道推送更新消息，更新/结束实况窗。</li>     </ol>     <p><strong>通过Push Kit创建、更新、结束实况窗</strong></p>     <p><span><img height="391.02000000000004" originheight="600" originwidth="803" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114629.79500598535818452486070949669804:50001231000000:2800:8F3E90189A90C05F48962DBC13B518149D139DE621813E981228CC4A789E6B52.png" title="点击放大" width="523.6875"></span></p>     <ol>      <li>使用Push Kit，获取Push Token。</li>      <li>将Push Token保存到业务的服务端。</li>      <li>通过Push Kit推送创建/更新/结束实况窗消息。</li>     </ol>     <p></p>     <p><strong>实况窗更新效果示例图：</strong></p>     <p><span><img height="226.1255433698903" originheight="280" originwidth="1139" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114629.61109291339883864085379379466972:50001231000000:2800:F4B0248D9B22BE646E0A4F86F96BBBA13EBA2E69C8C3FC41009045688F94670E.png" title="点击放大" width="920"></span></p>    </div>    <div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content">      <ul>       <li>单个实况窗的生命周期最长不超过8小时，超过8小时后，系统会认为通知结束。</li>       <li>为了确保用户看到内容的时效性，请您确保对实况窗内容进行及时更新。系统将在实况窗超过2小时未更新时，隐藏实况窗在状态栏胶囊和锁屏的展示，保留通知中心展示；超过4小时未更新，系统会认为实况窗结束，并从各个展示入口清除该实况窗。</li>      </ul>     </div></div></div>    <div class="tiledSection">     <h2 id="section1842712216538">开通权益<i class="anchor-icon anchor-icon-link" anchorid="section1842712216538" tips="复制节点链接"></i></h2>          <p>推送实况窗消息前您需要开通对应的场景权益，可参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/liveview-formal-authority" target="_blank">开通实况窗权益</a>完成权益的申请。</p>     <div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content">       <p>必须要开通实况窗权益才可以通过Push Kit推送实况窗消息，无法通过添加白名单设备的方式进行调试。</p>      </div></div></div>    </div>    <div class="tiledSection">     <h2 id="section89921523427">频控规则<i class="anchor-icon anchor-icon-link" anchorid="section89921523427" tips="复制节点链接"></i></h2>          <p><strong>调测阶段</strong>，每个项目每日全网最多可推送<span id="ZH-CN_TOPIC_0000002368705856__zh-cn_topic_0000002368705820_text54316313257">1000</span>条测试消息。发送测试消息需设置<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/push-scenariozed-api-request-param#section418321011212" target="_blank">testMessage</a>为true。</p>     <p><strong>正式发布阶段</strong>，单设备单应用下每日推送消息总条数受<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/push-msg-freq-control#section993063213715" target="_blank">设备消息频控</a>限制，系统会根据现网使用场景和流量进行管控，不合理的使用场景系统会进行频控。</p>     <p>单个实况窗消息，出行打车与赛事比分场景每个设备每5分钟最多更新30次，每小时最多更新180次。其余场景每个设备每5分钟最多更新10次，每小时最多更新60次。超过频次部分将丢弃不下发。</p>    </div>    <div class="tiledSection">     <h2 id="section207201926151512">开发步骤<i class="anchor-icon anchor-icon-link" anchorid="section207201926151512" tips="复制节点链接"></i></h2>          <ol>      <li><span>参见指导<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/push-get-token">获取Push Token</a>。</span></li>      <li><span>根据应用情况选择创建实况窗的方式：</span>       <p></p>       <ul>        <li>通过Live View Kit创建本地实况窗，详细内容请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/liveview-create-locally" target="_blank">构建本地实况窗</a>。</li>        <li>通过Push Kit远程创建实况窗，需满足<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/push-scenariozed-api-request-param#section441214411235" target="_blank">创建实况窗约束</a>。以出行打车场景为例，消息示例如下：         <div _ngcontent-bmd-c106="" class="highlight-div"><div _ngcontent-bmd-c106="" class="highlight-div-header"><div _ngcontent-bmd-c106="" class="highlight-div-header-left"><div _ngcontent-bmd-c106="" class="handle-button expand-button"><div _ngcontent-bmd-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bmd-c106="" class="highlight-div-header-right"><div _ngcontent-bmd-c106="" class="handle-button ai-button"></div><div _ngcontent-bmd-c106="" class="handle-button line-button"><div _ngcontent-bmd-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bmd-c106="" class="handle-button theme-button"><div _ngcontent-bmd-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bmd-c106="" class="handle-button copy-button"><div _ngcontent-bmd-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bmd-c106="" class="highlight-scroll-div"><pre class="json prettyprint linenums hljs language-json" hw-language="json" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// Request URL </span></li><li>POST <span class="hljs-string">"https://push-api.cloud.huawei.com/v3/</span><strong><span class="hljs-string">[projectId]</span></strong><span class="hljs-string">/messages:send"</span></li><li> </li><li><span class="hljs-comment">// Request Header </span></li><li>Content-Type<span class="hljs-punctuation">:</span> application/json </li><li>Authorization<span class="hljs-punctuation">:</span> Bearer eyJr*****OiIx---****.eyJh*****iJodHR--***.QRod*****<span class="hljs-number">4</span>Gp---****  </li><li>push-type<span class="hljs-punctuation">:</span> <span class="hljs-number">7</span></li><li>
</li><li><span class="hljs-comment">// Request Body</span></li><li><span class="hljs-punctuation">{</span></li><li>  <span class="hljs-attr">"payload"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>    <span class="hljs-attr">"activityId"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span></li><li>    <span class="hljs-attr">"operation"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span></li><li>    <span class="hljs-attr">"event"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"TAXI"</span><span class="hljs-punctuation">,</span></li><li>    <span class="hljs-attr">"status"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"DRIVER_ON_THE_WAY"</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// 司机正在赶来</span></li><li>    <span class="hljs-attr">"activityData"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>      <span class="hljs-attr">"notificationData"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>        <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">3</span><span class="hljs-punctuation">,</span>       </li><li>        <span class="hljs-attr">"contentTitle"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"{{status}}"</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// 司机正在赶来</span></li><li>        <span class="hljs-attr">"contentText"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span></li><li>          <span class="hljs-punctuation">{</span></li><li>            <span class="hljs-attr">"text"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"距您"</span></li><li>          <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span></li><li>          <span class="hljs-punctuation">{</span></li><li>            <span class="hljs-attr">"text"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"1.2公里"</span><span class="hljs-punctuation">,</span></li><li>            <span class="hljs-attr">"foregroundColor"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"#FF317AF7"</span></li><li>          <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span></li><li>          <span class="hljs-punctuation">{</span></li><li>            <span class="hljs-attr">"text"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">" | "</span></li><li>          <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span></li><li>          <span class="hljs-punctuation">{</span></li><li>            <span class="hljs-attr">"text"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"5分钟"</span><span class="hljs-punctuation">,</span></li><li>            <span class="hljs-attr">"foregroundColor"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"#FF317AF7"</span></li><li>          <span class="hljs-punctuation">}</span></li><li>        <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span></li><li>        <span class="hljs-attr">"clickAction"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>          <span class="hljs-attr">"actionType"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// 打开应用自定义页面</span></li><li>          <span class="hljs-attr">"action"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"xxxxxx"</span> <span class="hljs-comment">// 应用内置页面ability对应的action</span></li><li>        <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span></li><li>        <span class="hljs-attr">"richProgress"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>          <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span></li><li>          <span class="hljs-attr">"nodeIcons"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"icon1.png"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"icon2.png"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"icon3.png"</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// 取值为“/resources/rawfile”路径下的文件名</span></li><li>          <span class="hljs-attr">"indicatorIcon"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"taxi.png"</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// 取值为“/resources/rawfile”路径下的文件名</span></li><li>          <span class="hljs-attr">"progress"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">40</span><span class="hljs-punctuation">,</span></li><li>          <span class="hljs-attr">"indicatorType"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span></li><li>          <span class="hljs-attr">"color"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"#FF317AF7"</span><span class="hljs-punctuation">,</span></li><li>          <span class="hljs-attr">"bgColor"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"#19000000"</span></li><li>        <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span></li><li>        <span class="hljs-attr">"extend"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>          <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">3</span><span class="hljs-punctuation">,</span></li><li>          <span class="hljs-attr">"pic"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"phone.png"</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// 取值为“/resources/rawfile”路径下的文件名</span></li><li>          <span class="hljs-attr">"clickAction"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>            <span class="hljs-attr">"actionType"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span> <span class="hljs-comment">// 点击辅助区打开应用首页</span></li><li>          <span class="hljs-punctuation">}</span></li><li>        <span class="hljs-punctuation">}</span></li><li>      <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span></li><li>      <span class="hljs-attr">"capsuleData"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>        <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span></li><li>        <span class="hljs-attr">"status"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span></li><li>        <span class="hljs-attr">"icon"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"icon.svg"</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// 取值为“/resources/rawfile”路径下的文件名</span></li><li>        <span class="hljs-attr">"bgColor"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"#FF317AF7"</span><span class="hljs-punctuation">,</span></li><li>        <span class="hljs-attr">"remind"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"EXPAND"</span><span class="hljs-punctuation">,</span></li><li>        <span class="hljs-attr">"title"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"接驾中"</span><span class="hljs-punctuation">,</span></li><li>        <span class="hljs-attr">"content"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"预计5分钟"</span></li><li>      <span class="hljs-punctuation">}</span></li><li>    <span class="hljs-punctuation">}</span></li><li>  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span></li><li>  <span class="hljs-attr">"pushOptions"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>    <span class="hljs-attr">"ttl"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1000</span><span class="hljs-punctuation">,</span></li><li>    <span class="hljs-attr">"biTag"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"biTag"</span></li><li>  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span></li><li>  <span class="hljs-attr">"target"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>    <span class="hljs-attr">"token"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span></li><li>      <span class="hljs-string">"MAAALgE4G98BAAAAst************jq"</span></li><li>    <span class="hljs-punctuation">]</span></li><li>  <span class="hljs-punctuation">}</span></li><li><span class="hljs-punctuation">}</span></li></ol></pre></div></div>         <ul>          <li>[projectId]：项目ID，登录<a href="https://developer.huawei.com/consumer/cn/service/josp/agc/index.html" target="_blank">AppGallery Connect</a>网站，选择“开发与服务”，在项目列表中选择对应的项目，左侧导航栏选择“项目设置”，在该页面获取。</li>          <li>Authorization：JWT格式字符串，可参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/push-scenariozed-api-request-struct#section20573634202313" target="_blank">Authorization</a>获取。</li>          <li>push-type：7表示实况窗消息场景。</li>          <li>activityId：实况活动ID。详情请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/push-scenariozed-api-request-param#section66881469306" target="_blank">activityId</a>。</li>          <li>operation：实况窗通知操作类型，0表示创建实况窗。详情请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/push-scenariozed-api-request-param#section66881469306" target="_blank">operation</a>。</li>          <li>event：实况窗消息具体场景类型，需要与应用实际申请通过的场景一致。例如：TAXI（出行打车）、FLIGHT（航班）等。通过Push Kit创建实况窗仅支持TAXI、FLIGHT、TRAIN三种场景。详情请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/push-scenariozed-api-request-param#section441214411235" target="_blank">创建实况窗约束</a>。</li>          <li>status：表示实况窗消息状态。operation为0时必填，取值范围根据场景类型而定，详情见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/push-scenariozed-api-request-param#section1251014198565" target="_blank">Status取值范围</a>，并且需要在<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/push-scenariozed-api-request-param#section111894703518" target="_blank">支持携带占位符的字段</a>填入至少一次status的占位符{{status}}，Push Kit将替换占位符{{status}}为<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/push-scenariozed-api-request-param#section1251014198565" target="_blank">Status取值范围</a>中对应的值。</li>          <li>activityData：填写您项目中的实况窗数据。详情请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/push-scenariozed-api-request-param#section93901138192612" target="_blank">activityData</a>。</li>          <li>type：实况窗布局类型，有进度可视化类、强调文本类等。创建实况窗时每种event仅可使用特定的布局类型，详情请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/push-scenariozed-api-request-param#section441214411235" target="_blank">创建实况窗约束</a>。</li>          <li>token：Push Token，可参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/push-get-token">获取Push Token</a>获取。</li>         </ul></li>       </ul>       <p></p></li>      <li><span>当用户的服务订单状态发生变化时，开发者可以调用Push Kit服务端开放的REST API服务接口，更新或者结束实况窗。</span>       <p></p>       <p>消息详情可参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/push-scenariozed-api-intro" target="_blank">场景化消息API接口功能介绍</a>。（若开发者更新的实况窗为通过Push Kit远程创建的实况窗，更新时请遵守<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/push-scenariozed-api-request-param#section441214411235" target="_blank">创建实况窗约束</a>）</p>       <div _ngcontent-bmd-c106="" class="highlight-div"><div _ngcontent-bmd-c106="" class="highlight-div-header"><div _ngcontent-bmd-c106="" class="highlight-div-header-left"><div _ngcontent-bmd-c106="" class="handle-button expand-button"><div _ngcontent-bmd-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bmd-c106="" class="highlight-div-header-right"><div _ngcontent-bmd-c106="" class="handle-button ai-button"></div><div _ngcontent-bmd-c106="" class="handle-button line-button"><div _ngcontent-bmd-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bmd-c106="" class="handle-button theme-button"><div _ngcontent-bmd-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bmd-c106="" class="handle-button copy-button"><div _ngcontent-bmd-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bmd-c106="" class="highlight-scroll-div"><pre class="json prettyprint linenums hljs language-json" hw-language="json" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// Request URL </span></li><li>POST <span class="hljs-string">"https://push-api.cloud.huawei.com/v3/</span><strong><span class="hljs-string">[projectId]</span></strong><span class="hljs-string">/messages:send"</span></li><li> </li><li><span class="hljs-comment">// Request Header </span></li><li>Content-Type<span class="hljs-punctuation">:</span> application/json </li><li>Authorization<span class="hljs-punctuation">:</span> Bearer eyJr*****OiIx---****.eyJh*****iJodHR--***.QRod*****<span class="hljs-number">4</span>Gp---****  </li><li>push-type<span class="hljs-punctuation">:</span> <span class="hljs-number">7</span> </li><li> </li><li><span class="hljs-comment">// Request Body</span></li><li><span class="hljs-punctuation">{</span></li><li>  <span class="hljs-attr">"payload"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>    <span class="hljs-attr">"activityId"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span></li><li>    <span class="hljs-attr">"operation"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span></li><li>    <span class="hljs-attr">"event"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"TAXI"</span><span class="hljs-punctuation">,</span></li><li>    <span class="hljs-attr">"status"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"HEADING_TO_DESTINATION"</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// 正在去往目的地</span></li><li>    <span class="hljs-attr">"version"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span></li><li>    <span class="hljs-attr">"activityData"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>      <span class="hljs-attr">"notificationData"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>        <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">3</span><span class="hljs-punctuation">,</span></li><li>        <span class="hljs-attr">"contentTitle"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"{{status}}"</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// 正在去往目的地</span></li><li>        <span class="hljs-attr">"contentText"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span></li><li>          <span class="hljs-punctuation">{</span></li><li>            <span class="hljs-attr">"text"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"距目的地"</span></li><li>          <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span></li><li>          <span class="hljs-punctuation">{</span></li><li>            <span class="hljs-attr">"text"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"7.2公里"</span><span class="hljs-punctuation">,</span></li><li>            <span class="hljs-attr">"foregroundColor"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"#FF317AF7"</span></li><li>          <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span></li><li>          <span class="hljs-punctuation">{</span></li><li>            <span class="hljs-attr">"text"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">" | 预计"</span></li><li>          <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span></li><li>          <span class="hljs-punctuation">{</span></li><li>            <span class="hljs-attr">"text"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"27分钟"</span><span class="hljs-punctuation">,</span></li><li>            <span class="hljs-attr">"foregroundColor"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"#FF317AF7"</span></li><li>          <span class="hljs-punctuation">}</span></li><li>        <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span></li><li>        <span class="hljs-attr">"clickAction"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>          <span class="hljs-attr">"actionType"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// 打开应用自定义页面</span></li><li>          <span class="hljs-attr">"action"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"xxxxxx"</span> <span class="hljs-comment">// 应用内置页面ability对应的action</span></li><li>        <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span></li><li>        <span class="hljs-attr">"richProgress"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>          <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span></li><li>          <span class="hljs-attr">"nodeIcons"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">"icon1.png"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"icon2.png"</span><span class="hljs-punctuation">,</span> <span class="hljs-string">"icon3.png"</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// 取值为“/resources/rawfile”路径下的文件名</span></li><li>          <span class="hljs-attr">"indicatorIcon"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"taxi.png"</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// 取值为“/resources/rawfile”路径下的文件名</span></li><li>          <span class="hljs-attr">"progress"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">70</span><span class="hljs-punctuation">,</span></li><li>          <span class="hljs-attr">"indicatorType"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span></li><li>          <span class="hljs-attr">"color"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"#FF317AF7"</span><span class="hljs-punctuation">,</span></li><li>          <span class="hljs-attr">"bgColor"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"#19000000"</span></li><li>        <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span></li><li>        <span class="hljs-attr">"extend"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>          <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span></li><li>        <span class="hljs-punctuation">}</span></li><li>      <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span></li><li>      <span class="hljs-attr">"capsuleData"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>        <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span></li><li>        <span class="hljs-attr">"status"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span></li><li>        <span class="hljs-attr">"icon"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"icon.svg"</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// 取值为“/resources/rawfile”路径下的文件名</span></li><li>        <span class="hljs-attr">"bgColor"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"#FF317AF7"</span><span class="hljs-punctuation">,</span></li><li>        <span class="hljs-attr">"title"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"27分钟"</span><span class="hljs-punctuation">,</span></li><li>        <span class="hljs-attr">"content"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"距目的地7.2公里"</span></li><li>      <span class="hljs-punctuation">}</span></li><li>    <span class="hljs-punctuation">}</span></li><li>  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span></li><li>  <span class="hljs-attr">"pushOptions"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>    <span class="hljs-attr">"ttl"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1000</span><span class="hljs-punctuation">,</span></li><li>    <span class="hljs-attr">"biTag"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"biTag"</span></li><li>  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span></li><li>  <span class="hljs-attr">"target"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>    <span class="hljs-attr">"token"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span></li><li>      <span class="hljs-string">"MAMzLg**********lPW"</span></li><li>    <span class="hljs-punctuation">]</span></li><li>  <span class="hljs-punctuation">}</span></li><li><span class="hljs-punctuation">}</span></li></ol></pre></div></div>       <ul>        <li>[projectId]：项目ID，登录<a href="https://developer.huawei.com/consumer/cn/service/josp/agc/index.html" target="_blank">AppGallery Connect</a>网站，选择“开发与服务”，在项目列表中选择对应的项目，左侧导航栏选择“项目设置”，在该页面获取。</li>        <li>Authorization：JWT格式字符串，可参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/push-scenariozed-api-request-struct#section20573634202313" target="_blank">Authorization</a>获取。</li>        <li>push-type：7表示实况窗消息场景。</li>        <li>activityId：实况活动ID。详情请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/push-scenariozed-api-request-param#section66881469306" target="_blank">activityId</a>。</li>        <li>operation：实况窗通知操作类型，0表示创建实况窗，1表示更新实况窗，2表示结束实况窗。详情请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/push-scenariozed-api-request-param#section66881469306" target="_blank">operation</a>。</li>        <li>event：实况窗通知具体场景类型，需要与应用实际申请通过的场景一致。例如：TAXI（出行打车）、FLIGHT（航班）等。详情请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/push-scenariozed-api-request-param#section66881469306" target="_blank">event</a>。</li>        <li>status：表示实况窗消息状态。operation为1且更新的实况窗为通过Push Kit远程创建的实况窗时必填，取值范围根据场景类型而定，详情见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/push-scenariozed-api-request-param#section1251014198565" target="_blank">Status取值范围</a>，并且需要在<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/push-scenariozed-api-request-param#section111894703518" target="_blank">支持携带占位符的字段</a>填入至少一次status的占位符{{status}}，Push Kit将替换占位符{{status}}为<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/push-scenariozed-api-request-param#section1251014198565" target="_blank">Status取值范围</a>中对应的值。</li>        <li>version：更新实况窗通知的版本号。详情请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/push-scenariozed-api-request-param#section66881469306" target="_blank">version</a>。</li>        <li>activityData：填写您项目中的实况窗数据。详情请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/push-scenariozed-api-request-param#section93901138192612" target="_blank">activityData</a>。</li>        <li>type：实况窗布局类型，有进度可视化类、强调文本类等。详情请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/push-scenariozed-api-request-param#section7742121916279" target="_blank">type</a>。</li>        <li>token：Push Token，可参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/push-get-token">获取Push Token</a>获取。         <div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content">           <p>若发送的activityId对应的实况窗不存在（更新或结束实况窗的场景中），将限制使用该activityId发送实况窗消息24小时。</p>          </div></div></div></li>       </ul>       <p></p></li>     </ol>    </div>   </div>   <div></div></div>