<h1 _ngcontent-nyp-c119="" class="doc-title ng-star-inserted" title="支持表冠输入事件"> 支持表冠输入事件 </h1>

<div _ngcontent-nyp-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p>表冠事件从API version 18开始支持，是指通过旋转表冠触发的事件，通过硬件采样频率上报旋转角度的变化。</p>    <p>表冠事件分发依赖于应用内组件焦点，只有拥有焦点的组件才能接收到该事件，因此，接收此事件的组件必须管理好其焦点状态，并通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-universal-focus-event#onfocus" target="_blank">onFocus</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-universal-focus-event#onblur" target="_blank">onBlur</a>接口关注自身焦点状态变化，当正在接收表冠事件的组件失焦时，接下来的表冠事件都不会再发送给这个组件。</p>    <p>目前，系统中一些组件已默认支持与表冠的交互，例如，旋转手表表冠后，滚动条会根据表冠的旋转方向滚动。</p>    <p>当前，默认支持表冠事件的组件包括： <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-basic-components-slider" target="_blank">Slider</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-basic-components-datepicker" target="_blank">DatePicker</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-basic-components-textpicker" target="_blank">TextPicker</a>、 <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-basic-components-timepicker" target="_blank">TimePicker</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-scroll" target="_blank">Scroll</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-list" target="_blank">List</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-grid" target="_blank">Grid</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-waterflow" target="_blank">WaterFlow</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-arclist" target="_blank">ArcList</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-refresh" target="_blank">Refresh</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-swiper" target="_blank">Swiper</a>。</p>    <p>此外，应用也可以自行通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-universal-events-crown#ondigitalcrown" target="_blank">onDigitalCrown</a>接口感知表冠事件的上报。</p>    <p>其中，event参数提供表冠事件的时间戳、旋转角速度、旋转角度和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-appendix-enums#crownaction18" target="_blank">表冠动作</a>。</p>    <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">      <ul>       <li>当前仅Wearable设备支持表冠事件。</li>       <li>组件对表冠事件的接收受自身获焦状态影响，接收到BEGIN后，如果失焦，则无法继续再接收到后续的UPDATE和END。</li>      </ul>     </div></div></div>    <p>当组件需要获取旋转角度等信息时，可以通过onDigitalCrown接收表冠事件来获得上报信息。以下以Text组件为例，介绍表冠事件开发的基本步骤及开发过程中需要注意的事项。</p>    <ol>     <li>      <p>组件获焦</p>      <p>确保接收事件的组件获得焦点，可以通过使用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-universal-attributes-focus#focusable" target="_blank">focusable</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-universal-attributes-focus#defaultfocus9" target="_blank">defaultFocus</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-universal-attributes-focus#focusontouch9" target="_blank">focusOnTouch</a>等方法来实现。如需更详细的焦点控制信息，请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-universal-attributes-focus" target="_blank">焦点事件</a>文档。</p>      <div _ngcontent-nyp-c106="" class="highlight-div"><div _ngcontent-nyp-c106="" class="highlight-div-header"><div _ngcontent-nyp-c106="" class="highlight-div-header-left"><div _ngcontent-nyp-c106="" class="handle-button expand-button"><div _ngcontent-nyp-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-nyp-c106="" class="highlight-div-header-right"><div _ngcontent-nyp-c106="" class="handle-button ai-button"></div><div _ngcontent-nyp-c106="" class="handle-button line-button"><div _ngcontent-nyp-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-nyp-c106="" class="handle-button theme-button"><div _ngcontent-nyp-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-nyp-c106="" class="handle-button copy-button"><div _ngcontent-nyp-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-nyp-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-title class_">Text</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span>)</li><li>  .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">20</span>)</li><li>  .<span class="hljs-title function_">fontColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">White</span>)</li><li>  .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">"#262626"</span>)</li><li>  .<span class="hljs-title function_">textAlign</span>(<span class="hljs-title class_">TextAlign</span>.<span class="hljs-property">Center</span>)</li><li>  .<span class="hljs-title function_">focusable</span>(<span class="hljs-literal">true</span>)</li><li>  .<span class="hljs-title function_">focusOnTouch</span>(<span class="hljs-literal">true</span>)</li><li>  .<span class="hljs-title function_">defaultFocus</span>(<span class="hljs-literal">true</span>)</li></ol></pre></div></div></li>     <li>      <p>注册事件回调</p>      <p>接收表冠事件需要注册表冠事件回调，当触发表冠事件时会执行回调函数。</p>      <div _ngcontent-nyp-c106="" class="highlight-div"><div _ngcontent-nyp-c106="" class="highlight-div-header"><div _ngcontent-nyp-c106="" class="highlight-div-header-left"><div _ngcontent-nyp-c106="" class="handle-button expand-button"><div _ngcontent-nyp-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-nyp-c106="" class="highlight-div-header-right"><div _ngcontent-nyp-c106="" class="handle-button ai-button"></div><div _ngcontent-nyp-c106="" class="handle-button line-button"><div _ngcontent-nyp-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-nyp-c106="" class="handle-button theme-button"><div _ngcontent-nyp-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-nyp-c106="" class="handle-button copy-button"><div _ngcontent-nyp-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-nyp-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li>.<span class="hljs-title function_">onDigitalCrown</span>(<span class="hljs-function">(<span class="hljs-params">event: CrownEvent</span>) =&gt;</span> {})</li></ol></pre></div></div></li>     <li>      <p>事件字段的含义</p>      <p>表冠事件提供了时间戳，旋转角速度，旋转角度和表冠动作。此外表冠事件会触发事件冒泡，可通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-universal-events-crown#crownevent对象说明" target="_blank">stopPropagation</a>阻止事件冒泡。</p>      <div _ngcontent-nyp-c106="" class="highlight-div"><div _ngcontent-nyp-c106="" class="highlight-div-header"><div _ngcontent-nyp-c106="" class="highlight-div-header-left"><div _ngcontent-nyp-c106="" class="handle-button expand-button"><div _ngcontent-nyp-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-nyp-c106="" class="highlight-div-header-right"><div _ngcontent-nyp-c106="" class="handle-button ai-button"></div><div _ngcontent-nyp-c106="" class="handle-button line-button"><div _ngcontent-nyp-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-nyp-c106="" class="handle-button theme-button"><div _ngcontent-nyp-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-nyp-c106="" class="handle-button copy-button"><div _ngcontent-nyp-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-nyp-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li>event.<span class="hljs-title function_">stopPropagation</span>();</li><li><span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span> = <span class="hljs-string">"CrownEvent\n\n"</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(event);</li><li><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">debug</span>(<span class="hljs-string">"action:%d, angularVelocity:%f, degree:%f, timestamp:%f"</span>,</li><li>event.<span class="hljs-property">action</span>, event.<span class="hljs-property">angularVelocity</span>, event.<span class="hljs-property">degree</span>, event.<span class="hljs-property">timestamp</span>);</li></ol></pre></div></div></li>    </ol>    <p><strong>完整示例：</strong></p>    <div _ngcontent-nyp-c106="" class="highlight-div"><div _ngcontent-nyp-c106="" class="highlight-div-header"><div _ngcontent-nyp-c106="" class="highlight-div-header-left"><div _ngcontent-nyp-c106="" class="handle-button expand-button"><div _ngcontent-nyp-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-nyp-c106="" class="highlight-div-header-right"><div _ngcontent-nyp-c106="" class="handle-button ai-button"></div><div _ngcontent-nyp-c106="" class="handle-button line-button"><div _ngcontent-nyp-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-nyp-c106="" class="handle-button theme-button"><div _ngcontent-nyp-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-nyp-c106="" class="handle-button copy-button"><div _ngcontent-nyp-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-nyp-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// xxx.ets</span></li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">CityList</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">"onDigitalCrown"</span>;</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Row</span>(){</li><li>        <span class="hljs-title class_">Stack</span>() {</li><li>          <span class="hljs-title class_">Text</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span>)</li><li>            .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">20</span>)</li><li>            .<span class="hljs-title function_">fontColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">White</span>)</li><li>            .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">"#262626"</span>)</li><li>            .<span class="hljs-title function_">textAlign</span>(<span class="hljs-title class_">TextAlign</span>.<span class="hljs-property">Center</span>)</li><li>            .<span class="hljs-title function_">focusable</span>(<span class="hljs-literal">true</span>)</li><li>            .<span class="hljs-title function_">focusOnTouch</span>(<span class="hljs-literal">true</span>)</li><li>            .<span class="hljs-title function_">defaultFocus</span>(<span class="hljs-literal">true</span>)</li><li>            .<span class="hljs-title function_">borderWidth</span>(<span class="hljs-number">2</span>)</li><li>            .<span class="hljs-title function_">width</span>(<span class="hljs-number">223</span>).<span class="hljs-title function_">height</span>(<span class="hljs-number">223</span>)</li><li>            .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">110</span>)</li><li>            .<span class="hljs-title function_">onDigitalCrown</span>(<span class="hljs-function">(<span class="hljs-params">event: CrownEvent</span>) =&gt;</span> {</li><li>              event.<span class="hljs-title function_">stopPropagation</span>();</li><li>              <span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span> = <span class="hljs-string">"CrownEvent\n\n"</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(event);</li><li>              <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">debug</span>(<span class="hljs-string">"action:%d, angularVelocity:%f, degree:%f, timestamp:%f"</span>,</li><li>                event.<span class="hljs-property">action</span>, event.<span class="hljs-property">angularVelocity</span>, event.<span class="hljs-property">degree</span>, event.<span class="hljs-property">timestamp</span>);</li><li>            })</li><li>        }.<span class="hljs-title function_">width</span>(<span class="hljs-string">"100%"</span>).<span class="hljs-title function_">height</span>(<span class="hljs-string">"100%"</span>)</li><li>      }.<span class="hljs-title function_">width</span>(<span class="hljs-string">"100%"</span>).<span class="hljs-title function_">height</span>(<span class="hljs-string">"100%"</span>)</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>    <p><span><img originheight="337" originwidth="337" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114939.99421155674459563845166787898188:50001231000000:2800:2404A411CF1AB4B8387997F9DBFAAC4EA139593D007697ECEC3C8C2C4DC082F4.gif" width="337" height="337"></span></p>   </div>   <div></div></div>