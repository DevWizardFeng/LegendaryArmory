<h1 _ngcontent-jun-c119="" class="doc-title ng-star-inserted" title="文件预览"> 文件预览 </h1>

<div _ngcontent-jun-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p>当前Preview Kit的文件预览能力采用拉起新窗口的方式来实现，在新的窗口中展示需要预览的文件，并按照统一设计的界面进行展示，如果开发者需要使用Preview Kit的文件预览能力，需要注意以下事项：</p>    <ul>     <li>当前Preview Kit仅支持跳出应用进行文件的预览，暂不支持应用内预览。</li>     <li>Office类型文档预览借助WPS提供的能力来实现，在预览文档类型文件时会存在”WPS提供技术支持”、”使用WPS Office打开”等相关字样。</li>     <li>当前Preview Kit暂不支持安全定制能力，包括禁止截录屏、屏蔽其他应用打开入口、屏蔽分享入口等安全预览能力。</li>     <li>当前Preview Kit需要调用方存在对应uri的转授权能力，从而让预览获得该文件的访问权限来正常读取文件，具体问题可以参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/preview-faq-2">Preview Kit常见问题2</a>。</li>    </ul>    <div class="tiledSection">     <h2 id="section1064231523817">接口说明<i class="anchor-icon anchor-icon-link" anchorid="section1064231523817" tips="复制节点链接"></i></h2>          <p>接口返回值有两种返回形式：callback和promise，promise和callback只是返回值方式不一样，功能相同。具体API说明详见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/preview-arkts" target="_blank">接口文档</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <caption>        <b>表1 </b>Preview Kit的接口介绍       </caption>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.3.3.2.3.1.1" valign="top" width="50%">          <p>接口名</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.3.3.2.3.1.2" valign="top" width="50%">          <p>描述</p></th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="50%">          <p>openPreview(context: Context, file: PreviewInfo, info?: DisplayInfo): Promise&lt;void&gt;</p></td>         <td class="cellrowborder" valign="top" width="50%">          <p>打开预览功能。通过传入单个文件预览信息以及悬浮窗口属性信息，打开预览窗口。1秒内重复调用无效。使用Promise方式异步返回结果。</p></td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">          <p>openPreview(context: Context, file: PreviewInfo, info: DisplayInfo, callback: AsyncCallback&lt;void&gt;): void</p></td>         <td class="cellrowborder" valign="top" width="50%">          <p>打开预览功能。通过传入单个文件预览信息以及悬浮窗口属性信息，打开预览窗口。1秒内重复调用无效。传入callback进行异步回调。</p></td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">          <p>openPreview(context: Context, files: Array&lt;PreviewInfo&gt;, index?: number): Promise&lt;void&gt;</p></td>         <td class="cellrowborder" valign="top" width="50%">          <p>打开预览功能。通过传入多个文件预览信息以及选择展示的文件信息下标，打开预览窗口。1秒内重复调用无效。使用Promise方式异步返回结果。仅移动端可用。</p></td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">          <p>canPreview(context: Context, uri: string): Promise&lt;boolean&gt;</p></td>         <td class="cellrowborder" valign="top" width="50%">          <p>根据文件的uri判断文件是否可预览。</p>          <ul>           <li>当传入支持的文件类型（图片、视频、音频、文本、html）并且文件存在时，会返回true。</li>           <li>当传入不可预览的文件uri时，返回false。</li>          </ul></td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">          <p>hasDisplayed(context: Context): Promise&lt;boolean&gt;</p></td>         <td class="cellrowborder" valign="top" width="50%">          <p>判断预览窗口是否已经存在。预览窗口是单例的形式。</p>          <ul>           <li>如果预览窗口已经打开过并且没关闭，那会返回true。</li>           <li>如果没打开或者打开后已关闭，那将返回false。</li>          </ul></td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">          <p>closePreview(context: Context): Promise&lt;void&gt;</p></td>         <td class="cellrowborder" valign="top" width="50%">          <p>关闭预览窗口，仅当预览窗口存在时起效。</p></td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">          <p>loadData(context: Context, file: PreviewInfo): Promise&lt;void&gt;</p></td>         <td class="cellrowborder" valign="top" width="50%">          <p>加载预览文件信息。仅当预览窗口存在时生效。100毫秒内重复调用无效。</p>          <ul>           <li>传入可预览文件时展示对应预览界面。</li>           <li>传入不可预览文件显示不支持预览界面。</li>          </ul></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="section56115372167">开发步骤<i class="anchor-icon anchor-icon-link" anchorid="section56115372167" tips="复制节点链接"></i></h2>          <ol>      <li>导入相关模块。       <div _ngcontent-jun-c106="" class="highlight-div"><div _ngcontent-jun-c106="" class="highlight-div-header"><div _ngcontent-jun-c106="" class="highlight-div-header-left"><div _ngcontent-jun-c106="" class="handle-button expand-button"><div _ngcontent-jun-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jun-c106="" class="highlight-div-header-right"><div _ngcontent-jun-c106="" class="handle-button ai-button"></div><div _ngcontent-jun-c106="" class="handle-button line-button"><div _ngcontent-jun-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jun-c106="" class="handle-button theme-button"><div _ngcontent-jun-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jun-c106="" class="handle-button copy-button"><div _ngcontent-jun-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jun-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { filePreview } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PreviewKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li></ol></pre></div></div>       <p></p></li>      <li>判断是否可以预览。       <div _ngcontent-jun-c106="" class="highlight-div"><div _ngcontent-jun-c106="" class="highlight-div-header"><div _ngcontent-jun-c106="" class="highlight-div-header-left"><div _ngcontent-jun-c106="" class="handle-button expand-button"><div _ngcontent-jun-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jun-c106="" class="highlight-div-header-right"><div _ngcontent-jun-c106="" class="handle-button ai-button"></div><div _ngcontent-jun-c106="" class="handle-button line-button"><div _ngcontent-jun-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jun-c106="" class="handle-button theme-button"><div _ngcontent-jun-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jun-c106="" class="handle-button copy-button"><div _ngcontent-jun-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jun-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">let</span> uri = <span class="hljs-string">'file://docs/storage/Users/currentUser/Documents/1.txt'</span>;  </li><li><span class="hljs-keyword">let</span> uiContext = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> <span class="hljs-title class_">Context</span>;</li><li>filePreview.<span class="hljs-title function_">canPreview</span>(uiContext, uri).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">result</span>) =&gt;</span> {    <span class="hljs-comment">// 传入支持的文件类型且文件存在时会返回true</span></li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`Succeeded in obtaining the result of whether it can be previewed. result = <span class="hljs-subst">${result}</span>`</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Failed to obtain the result of whether it can be previewed, err.code = <span class="hljs-subst">${err.code}</span>, err.message = <span class="hljs-subst">${err.message}</span>`</span>);</li><li>});</li></ol></pre></div></div></li>      <li>调用openPreview，实现打开文件预览的功能。       <ul>        <li>通过Promise方式打开文件         <div _ngcontent-jun-c106="" class="highlight-div"><div _ngcontent-jun-c106="" class="highlight-div-header"><div _ngcontent-jun-c106="" class="highlight-div-header-left"><div _ngcontent-jun-c106="" class="handle-button expand-button"><div _ngcontent-jun-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jun-c106="" class="highlight-div-header-right"><div _ngcontent-jun-c106="" class="handle-button ai-button"></div><div _ngcontent-jun-c106="" class="handle-button line-button"><div _ngcontent-jun-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jun-c106="" class="handle-button theme-button"><div _ngcontent-jun-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jun-c106="" class="handle-button copy-button"><div _ngcontent-jun-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jun-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">let</span> uiContext = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> <span class="hljs-title class_">Context</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">displayInfo</span>: filePreview.<span class="hljs-property">DisplayInfo</span> = {</li><li>  <span class="hljs-attr">x</span>: <span class="hljs-number">100</span>,</li><li>  <span class="hljs-attr">y</span>: <span class="hljs-number">100</span>,</li><li>  <span class="hljs-attr">width</span>: <span class="hljs-number">800</span>,</li><li>  <span class="hljs-attr">height</span>: <span class="hljs-number">800</span></li><li>};</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">fileInfo</span>: filePreview.<span class="hljs-property">PreviewInfo</span> = {</li><li>  <span class="hljs-attr">title</span>: <span class="hljs-string">'1.txt'</span>,</li><li>  <span class="hljs-attr">uri</span>: <span class="hljs-string">'file://docs/storage/Users/currentUser/Documents/1.txt'</span>,</li><li>  <span class="hljs-attr">mimeType</span>: <span class="hljs-string">'text/plain'</span></li><li>};</li><li>filePreview.<span class="hljs-title function_">openPreview</span>(uiContext, fileInfo, displayInfo).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Succeeded in opening preview'</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Failed to open preview, err.code = <span class="hljs-subst">${err.code}</span>, err.message = <span class="hljs-subst">${err.message}</span>`</span>);</li><li>});</li></ol></pre></div></div></li>       </ul>       <ul>        <li>通过CallBack回调函数方式打开文件         <div _ngcontent-jun-c106="" class="highlight-div"><div _ngcontent-jun-c106="" class="highlight-div-header"><div _ngcontent-jun-c106="" class="highlight-div-header-left"><div _ngcontent-jun-c106="" class="handle-button expand-button"><div _ngcontent-jun-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jun-c106="" class="highlight-div-header-right"><div _ngcontent-jun-c106="" class="handle-button ai-button"></div><div _ngcontent-jun-c106="" class="handle-button line-button"><div _ngcontent-jun-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jun-c106="" class="handle-button theme-button"><div _ngcontent-jun-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jun-c106="" class="handle-button copy-button"><div _ngcontent-jun-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jun-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">let</span> uiContext = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> <span class="hljs-title class_">Context</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">displayInfo</span>: filePreview.<span class="hljs-property">DisplayInfo</span> = {</li><li>  <span class="hljs-attr">x</span>: <span class="hljs-number">100</span>,</li><li>  <span class="hljs-attr">y</span>: <span class="hljs-number">100</span>,</li><li>  <span class="hljs-attr">width</span>: <span class="hljs-number">800</span>,</li><li>  <span class="hljs-attr">height</span>: <span class="hljs-number">800</span></li><li>};</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">fileInfo</span>: filePreview.<span class="hljs-property">PreviewInfo</span> = {</li><li>  <span class="hljs-attr">title</span>: <span class="hljs-string">'1.txt'</span>,</li><li>  <span class="hljs-attr">uri</span>: <span class="hljs-string">'file://docs/storage/Users/currentUser/Documents/1.txt'</span>,</li><li>  <span class="hljs-attr">mimeType</span>: <span class="hljs-string">'text/plain'</span></li><li>};</li><li>filePreview.<span class="hljs-title function_">openPreview</span>(uiContext, fileInfo, displayInfo, <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (err &amp;&amp; err.<span class="hljs-property">code</span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Failed to open preview, err.code = <span class="hljs-subst">${err.code}</span>, err.message = <span class="hljs-subst">${err.message}</span>`</span>);    </li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Succeeded in opening preview'</span>);</li><li>});</li></ol></pre></div></div></li>        <li>传入多个文件打开预览，仅移动端可用。         <div _ngcontent-jun-c106="" class="highlight-div"><div _ngcontent-jun-c106="" class="highlight-div-header"><div _ngcontent-jun-c106="" class="highlight-div-header-left"><div _ngcontent-jun-c106="" class="handle-button expand-button"><div _ngcontent-jun-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jun-c106="" class="highlight-div-header-right"><div _ngcontent-jun-c106="" class="handle-button ai-button"></div><div _ngcontent-jun-c106="" class="handle-button line-button"><div _ngcontent-jun-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jun-c106="" class="handle-button theme-button"><div _ngcontent-jun-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jun-c106="" class="handle-button copy-button"><div _ngcontent-jun-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jun-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">let</span> uiContext = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> <span class="hljs-title class_">Context</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">fileInfo</span>: filePreview.<span class="hljs-property">PreviewInfo</span> = {</li><li>  <span class="hljs-attr">title</span>: <span class="hljs-string">'1.txt'</span>,</li><li>  <span class="hljs-attr">uri</span>: <span class="hljs-string">'file://docs/storage/Users/currentUser/Documents/1.txt'</span>,</li><li>  <span class="hljs-attr">mimeType</span>: <span class="hljs-string">'text/plain'</span></li><li>};</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">fileInfo1</span>: filePreview.<span class="hljs-property">PreviewInfo</span> = {</li><li>  <span class="hljs-attr">title</span>: <span class="hljs-string">'2.txt'</span>,</li><li>  <span class="hljs-attr">uri</span>: <span class="hljs-string">'file://docs/storage/Users/currentUser/Documents/2.txt'</span>,</li><li>  <span class="hljs-attr">mimeType</span>: <span class="hljs-string">'text/plain'</span></li><li>};</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">files</span>: <span class="hljs-title class_">Array</span>&lt;filePreview.<span class="hljs-property">PreviewInfo</span>&gt; = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>();</li><li>files.<span class="hljs-title function_">push</span>(fileInfo);</li><li>files.<span class="hljs-title function_">push</span>(fileInfo1);</li><li>filePreview.<span class="hljs-title function_">openPreview</span>(uiContext, files, <span class="hljs-number">0</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Succeeded in opening preview'</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Failed to open preview, err.code = <span class="hljs-subst">${err.code}</span>, err.message = <span class="hljs-subst">${err.message}</span>`</span>);</li><li>});</li></ol></pre></div></div></li>       </ul></li>      <li>（可选）如果已经打开过预览窗口，需要重新加载页面，需要调用loadData接口，加载文件。       <div _ngcontent-jun-c106="" class="highlight-div"><div _ngcontent-jun-c106="" class="highlight-div-header"><div _ngcontent-jun-c106="" class="highlight-div-header-left"><div _ngcontent-jun-c106="" class="handle-button expand-button"><div _ngcontent-jun-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jun-c106="" class="highlight-div-header-right"><div _ngcontent-jun-c106="" class="handle-button ai-button"></div><div _ngcontent-jun-c106="" class="handle-button line-button"><div _ngcontent-jun-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jun-c106="" class="handle-button theme-button"><div _ngcontent-jun-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jun-c106="" class="handle-button copy-button"><div _ngcontent-jun-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jun-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">let</span> uiContext = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> <span class="hljs-title class_">Context</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">fileInfo</span>: filePreview.<span class="hljs-property">PreviewInfo</span> = {</li><li>  <span class="hljs-attr">title</span>: <span class="hljs-string">'2.txt'</span>,</li><li>  <span class="hljs-attr">uri</span>: <span class="hljs-string">'file://docs/storage/Users/currentUser/Documents/2.txt'</span>,</li><li>  <span class="hljs-attr">mimeType</span>: <span class="hljs-string">'text/plain'</span></li><li>};</li><li>filePreview.<span class="hljs-title function_">loadData</span>(uiContext, fileInfo).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {   <span class="hljs-comment">// 仅当预览窗口存在时起效</span></li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Succeeded in loading data.'</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Failed to load data, err.code = <span class="hljs-subst">${err.code}</span>, err.message = <span class="hljs-subst">${err.message}</span>`</span>);</li><li>});</li></ol></pre></div></div>       <p></p></li>      <li>（可选）如果想要关闭预览窗口，需要调用closePreview。       <div _ngcontent-jun-c106="" class="highlight-div"><div _ngcontent-jun-c106="" class="highlight-div-header"><div _ngcontent-jun-c106="" class="highlight-div-header-left"><div _ngcontent-jun-c106="" class="handle-button expand-button"><div _ngcontent-jun-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jun-c106="" class="highlight-div-header-right"><div _ngcontent-jun-c106="" class="handle-button ai-button"></div><div _ngcontent-jun-c106="" class="handle-button line-button"><div _ngcontent-jun-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jun-c106="" class="handle-button theme-button"><div _ngcontent-jun-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jun-c106="" class="handle-button copy-button"><div _ngcontent-jun-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jun-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">let</span> uiContext = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> <span class="hljs-title class_">Context</span>;</li><li>filePreview.<span class="hljs-title function_">closePreview</span>(uiContext).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {   <span class="hljs-comment">// 仅当预览窗口存在时起效</span></li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Succeeded in closing preview'</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Failed to close preview, err.code = <span class="hljs-subst">${err.code}</span>, err.message = <span class="hljs-subst">${err.message}</span>`</span>);</li><li>});</li></ol></pre></div></div></li>     </ol>    </div>   </div>   <div></div></div>