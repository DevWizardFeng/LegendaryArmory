<h1 _ngcontent-mmu-c119="" class="doc-title ng-star-inserted" title="文本测量（C/C++）"> 文本测量（C/C++） </h1>

<div _ngcontent-mmu-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <div class="tiledSection">     <h2 id="场景介绍">场景介绍<i class="anchor-icon anchor-icon-link" anchorid="场景介绍" tips="复制节点链接"></i></h2>          <p>文本测量指的是在图形绘制中，对文本的尺寸和布局进行评估，计算文本在给定字体和样式下占用的空间（例如宽度、高度和其他相关信息）的过程。文本测量用于文本排版、布局、渲染以及调整文本显示的位置和大小等场景，便于更精准地控制与调整界面的布局和呈现，以达到设计预期。</p>     <p>当前主要支持以下方面的文本测量能力：</p>     <ul>      <li>       <p><strong>文本宽度</strong>：测量给定文本在特定字体、大小和样式下的水平长度。</p></li>      <li>       <p><strong>文本高度</strong>：测量给定文本的垂直高度，通常涉及字体的上升线、下降线等。</p></li>      <li>       <p><strong>行间距</strong>：测量多行文本之间的垂直距离，通常与字体的行距相关。</p></li>      <li>       <p><strong>字符间距</strong>：测量单个字符之间的水平距离，通常与字形和字体设计有关。</p></li>     </ul>    </div>    <div class="tiledSection">     <h2 id="接口说明">接口说明<i class="anchor-icon anchor-icon-link" anchorid="接口说明" tips="复制节点链接"></i></h2>          <p>文本测量中常用接口如下表所示，详细接口说明参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-drawing-text-typography-h" target="_blank">drawing_text_typography.h</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.2.3.1.3.1.1" valign="top" width="50%">接口名</th>         <th align="left" class="cellrowborder" id="mcps1.3.2.3.1.3.1.2" valign="top" width="50%">描述</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="50%">double OH_Drawing_TypographyGetLongestLine(OH_Drawing_Typography*)</td>         <td class="cellrowborder" valign="top" width="50%">获取最长行的宽度，建议实际使用时将返回值向上取整。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">double OH_Drawing_TypographyGetLongestLineWithIndent(OH_Drawing_Typography*)</td>         <td class="cellrowborder" valign="top" width="50%">获取最长行的宽度（该宽度包含当前行缩进的宽度），建议实际使用时将返回值向上取整。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">size_t OH_Drawing_TypographyGetLineCount (OH_Drawing_Typography* )</td>         <td class="cellrowborder" valign="top" width="50%">获取文本行数。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">OH_Drawing_LineMetrics* OH_Drawing_TypographyGetLineMetrics (OH_Drawing_Typography* )</td>         <td class="cellrowborder" valign="top" width="50%">获取段落行的度量信息。包含行的高度、宽度、起始坐标等信息。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">double OH_Drawing_TextStyleGetLetterSpacing (OH_Drawing_TextStyle *)</td>         <td class="cellrowborder" valign="top" width="50%">获取文本的字符间距。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="开发步骤">开发步骤<i class="anchor-icon anchor-icon-link" anchorid="开发步骤" tips="复制节点链接"></i></h2>          <ol>      <li>       <p>在工程的src/main/cpp/CMakeLists.txt文件中添加以下lib。</p>       <div _ngcontent-mmu-c106="" class="highlight-div"><div _ngcontent-mmu-c106="" class="highlight-div-header"><div _ngcontent-mmu-c106="" class="highlight-div-header-left"><div _ngcontent-mmu-c106="" class="handle-button expand-button"><div _ngcontent-mmu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mmu-c106="" class="highlight-div-header-right"><div _ngcontent-mmu-c106="" class="handle-button ai-button"></div><div _ngcontent-mmu-c106="" class="handle-button line-button"><div _ngcontent-mmu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mmu-c106="" class="handle-button theme-button"><div _ngcontent-mmu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mmu-c106="" class="handle-button copy-button"><div _ngcontent-mmu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mmu-c106="" class="highlight-scroll-div"><pre class="prettyprint linenums hljs language-undefined" data-highlighted="yes"><ol class="linenums"><li>libnative_drawing.so</li></ol></pre></div></div></li>      <li>       <p>导入依赖的相关头文件。</p>       <div _ngcontent-mmu-c106="" class="highlight-div"><div _ngcontent-mmu-c106="" class="highlight-div-header"><div _ngcontent-mmu-c106="" class="highlight-div-header-left"><div _ngcontent-mmu-c106="" class="handle-button expand-button"><div _ngcontent-mmu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mmu-c106="" class="highlight-div-header-right"><div _ngcontent-mmu-c106="" class="handle-button ai-button"></div><div _ngcontent-mmu-c106="" class="handle-button line-button"><div _ngcontent-mmu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mmu-c106="" class="handle-button theme-button"><div _ngcontent-mmu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mmu-c106="" class="handle-button copy-button"><div _ngcontent-mmu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mmu-c106="" class="highlight-scroll-div"><pre class="prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;native_drawing/drawing_font_collection.h&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;native_drawing/drawing_text_declaration.h&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;native_drawing/drawing_text_typography.h&gt;</span></span></li></ol></pre></div></div></li>      <li>       <p>创建段落生成器ParagraphBuilder，并设置段落样式。</p>       <div _ngcontent-mmu-c106="" class="highlight-div"><div _ngcontent-mmu-c106="" class="highlight-div-header"><div _ngcontent-mmu-c106="" class="highlight-div-header-left"><div _ngcontent-mmu-c106="" class="handle-button expand-button"><div _ngcontent-mmu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mmu-c106="" class="highlight-div-header-right"><div _ngcontent-mmu-c106="" class="handle-button ai-button"></div><div _ngcontent-mmu-c106="" class="handle-button line-button"><div _ngcontent-mmu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mmu-c106="" class="handle-button theme-button"><div _ngcontent-mmu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mmu-c106="" class="handle-button copy-button"><div _ngcontent-mmu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mmu-c106="" class="highlight-scroll-div"><pre class="prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 创建段落样式</span></li><li>OH_Drawing_TypographyStyle *typoStyle = <span class="hljs-built_in">OH_Drawing_CreateTypographyStyle</span>();</li><li><span class="hljs-comment">// 创建段落生成器</span></li><li>OH_Drawing_TypographyCreate *handler = <span class="hljs-built_in">OH_Drawing_CreateTypographyHandler</span>(typoStyle, <span class="hljs-built_in">OH_Drawing_CreateFontCollection</span>());</li><li><span class="hljs-comment">// 创建文本样式，并设置字体大小为50</span></li><li>OH_Drawing_TextStyle *txtStyle = <span class="hljs-built_in">OH_Drawing_CreateTextStyle</span>();</li><li><span class="hljs-built_in">OH_Drawing_SetTextStyleFontSize</span>(txtStyle, <span class="hljs-number">50</span>);</li><li><span class="hljs-built_in">OH_Drawing_TypographyHandlerPushTextStyle</span>(handler, txtStyle);</li><li><span class="hljs-comment">// 向构造器中添加文本</span></li><li><span class="hljs-type">const</span> <span class="hljs-type">char</span> *text = <span class="hljs-string">"排版测量的文字度量信息"</span>;</li><li><span class="hljs-built_in">OH_Drawing_TypographyHandlerAddText</span>(handler, text);</li><li><span class="hljs-comment">// 通过生成器构造段落</span></li><li>OH_Drawing_Typography *typography = <span class="hljs-built_in">OH_Drawing_CreateTypography</span>(handler);</li></ol></pre></div></div></li>      <li>       <p>调用排版接口并设置段落排版宽度，对段落进行塑型排版。</p>       <div _ngcontent-mmu-c106="" class="highlight-div"><div _ngcontent-mmu-c106="" class="highlight-div-header"><div _ngcontent-mmu-c106="" class="highlight-div-header-left"><div _ngcontent-mmu-c106="" class="handle-button expand-button"><div _ngcontent-mmu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mmu-c106="" class="highlight-div-header-right"><div _ngcontent-mmu-c106="" class="handle-button ai-button"></div><div _ngcontent-mmu-c106="" class="handle-button line-button"><div _ngcontent-mmu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mmu-c106="" class="handle-button theme-button"><div _ngcontent-mmu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mmu-c106="" class="handle-button copy-button"><div _ngcontent-mmu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mmu-c106="" class="highlight-scroll-div"><pre class="prettyprint linenums hljs language-scss" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 对段落进行塑形排版，设置排版宽度1000</span></li><li><span class="hljs-built_in">OH_Drawing_TypographyLayout</span>(typography, <span class="hljs-number">1000</span>);</li></ol></pre></div></div></li>      <li>       <p>调用段落测量信息获取接口，获取指定数据。</p>       <div _ngcontent-mmu-c106="" class="highlight-div"><div _ngcontent-mmu-c106="" class="highlight-div-header"><div _ngcontent-mmu-c106="" class="highlight-div-header-left"><div _ngcontent-mmu-c106="" class="handle-button expand-button"><div _ngcontent-mmu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-mmu-c106="" class="highlight-div-header-right"><div _ngcontent-mmu-c106="" class="handle-button ai-button"></div><div _ngcontent-mmu-c106="" class="handle-button line-button"><div _ngcontent-mmu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-mmu-c106="" class="handle-button theme-button"><div _ngcontent-mmu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-mmu-c106="" class="handle-button copy-button"><div _ngcontent-mmu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-mmu-c106="" class="highlight-scroll-div"><pre class="prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// case1: 获取排版后最长行行宽</span></li><li><span class="hljs-type">double</span> longestLine = <span class="hljs-built_in">OH_Drawing_TypographyGetLongestLine</span>(typography);</li><li>
</li><li><span class="hljs-comment">// case2:获取排版后段落行数</span></li><li><span class="hljs-type">size_t</span> lineCnt = <span class="hljs-built_in">OH_Drawing_TypographyGetLineCount</span>(typography);</li><li>
</li><li><span class="hljs-comment">// case3:获取段落每行的度量信息</span></li><li>OH_Drawing_LineMetrics* lineMetrics = <span class="hljs-built_in">OH_Drawing_TypographyGetLineMetrics</span>(typography);</li><li><span class="hljs-type">int</span> lineMetricsSize = <span class="hljs-built_in">OH_Drawing_LineMetricsGetSize</span>(lineMetrics);</li><li><span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; lineMetricsSize; ++i) {</li><li>    <span class="hljs-comment">// lineMetrics为经过排版测量的文字度量信息</span></li><li>    <span class="hljs-type">double</span> curLineAscender = lineMetrics[i].ascender;</li><li>    <span class="hljs-type">double</span> curLineWidth = lineMetrics[i].width;</li><li>}</li><li>
</li><li><span class="hljs-comment">// case4:获取段落带缩进最长行行宽</span></li><li><span class="hljs-type">double</span> longestLineWithIndent = <span class="hljs-built_in">OH_Drawing_TypographyGetLongestLineWithIndent</span>(typography);</li></ol></pre></div></div></li>     </ol>    </div>   </div>   <div></div></div>