<h1 _ngcontent-bhk-c119="" class="doc-title ng-star-inserted" title="旋转屏动画"> 旋转屏动画 </h1>

<div _ngcontent-bhk-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p>旋转屏动画主要分为两类：<a href="/consumer/cn/doc/harmonyos-guides/arkts-rotation-transition-animation#布局切换的旋转屏动画">布局切换的旋转屏动画</a>和<a href="/consumer/cn/doc/harmonyos-guides/arkts-rotation-transition-animation#透明度变化的旋转屏动画">透明度变化的旋转屏动画</a>，旨在实现屏幕显示方向变化时的自然过渡。布局切换的旋转屏动画实现较为简便，例如在module.json5中配置自动旋转（或设置窗口显示方向）即可实现。而透明度变化的旋转屏动画则需在module.json5配置的基础上，预备两套视图，在屏幕旋转时，通过视图切换，使消失的视图呈现渐隐效果，新出现的视图则渐显，从而营造流畅的视觉体验。</p>    <div class="tiledSection">     <h2 id="布局切换的旋转屏动画">布局切换的旋转屏动画<i class="anchor-icon anchor-icon-link" anchorid="布局切换的旋转屏动画" tips="复制节点链接"></i></h2>          <p>布局切换时的旋转屏动画，是在屏幕显示方向改变时，为窗口与应用视图同步旋转而设计的大小和位置过渡动画。这种布局切换的旋转屏动画是系统默认的，便于开发者实现。当屏幕显示方向变化时，系统会生成窗口旋转动画，并自动调整窗口大小以匹配旋转后的尺寸。在此过程中，窗口会通知对应的应用，要求其根据新的窗口大小重新布局，产生与窗口旋转动画参数相同的布局动画。</p>     <p>切换屏幕方向即可实现布局切换的旋转屏动画效果。</p>     <div _ngcontent-bhk-c106="" class="highlight-div"><div _ngcontent-bhk-c106="" class="highlight-div-header"><div _ngcontent-bhk-c106="" class="highlight-div-header-left"><div _ngcontent-bhk-c106="" class="handle-button expand-button"><div _ngcontent-bhk-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bhk-c106="" class="highlight-div-header-right"><div _ngcontent-bhk-c106="" class="handle-button ai-button"></div><div _ngcontent-bhk-c106="" class="handle-button line-button"><div _ngcontent-bhk-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bhk-c106="" class="handle-button theme-button"><div _ngcontent-bhk-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bhk-c106="" class="handle-button copy-button"><div _ngcontent-bhk-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bhk-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// xx.ets</span></li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct rotation {</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Stack</span>() {</li><li>      <span class="hljs-title class_">Image</span>($r(<span class="hljs-string">'app.media.tree'</span>))</li><li>        .<span class="hljs-title function_">position</span>({ <span class="hljs-attr">x</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">0</span> })</li><li>        .<span class="hljs-title function_">size</span>({ <span class="hljs-attr">width</span>: <span class="hljs-number">100</span>, <span class="hljs-attr">height</span>: <span class="hljs-number">100</span> })</li><li>        .<span class="hljs-title function_">id</span>(<span class="hljs-string">'image1'</span>)</li><li>    }</li><li>    .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">White</span>)</li><li>    .<span class="hljs-title function_">size</span>({ <span class="hljs-attr">width</span>: <span class="hljs-string">'100%'</span>, <span class="hljs-attr">height</span>: <span class="hljs-string">'100%'</span> })</li><li>  }</li><li>}</li></ol></pre></div></div>     <p>需要在项目的module.json5文件中的abilities列表里添加"orientation"，指定为"auto_rotation"。</p>     <div _ngcontent-bhk-c106="" class="highlight-div"><div _ngcontent-bhk-c106="" class="highlight-div-header"><div _ngcontent-bhk-c106="" class="highlight-div-header-left"><div _ngcontent-bhk-c106="" class="handle-button expand-button"><div _ngcontent-bhk-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bhk-c106="" class="highlight-div-header-right"><div _ngcontent-bhk-c106="" class="handle-button ai-button"></div><div _ngcontent-bhk-c106="" class="handle-button line-button"><div _ngcontent-bhk-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bhk-c106="" class="handle-button theme-button"><div _ngcontent-bhk-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bhk-c106="" class="handle-button copy-button"><div _ngcontent-bhk-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bhk-c106="" class="highlight-scroll-div"><pre class="json prettyprint linenums hljs language-json" hw-language="json" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-attr">"orientation"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"auto_rotation"</span><span class="hljs-punctuation">,</span></li></ol></pre></div></div>     <p>布局切换的旋转屏动画，会对同步旋转的窗口与应用视图做大小和位置的过渡。</p>     <p><span><img originheight="342" originwidth="288" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114939.40004078342883007573863283979346:50001231000000:2800:12F96C7AD427E78D57DABA4D5DB1B1BF1F54AAD8A90CE3FA04D76F0473221247.gif" class="notEnlarge" width="288" height="342"></span></p>    </div>    <div class="tiledSection">     <h2 id="透明度变化的旋转屏动画">透明度变化的旋转屏动画<i class="anchor-icon anchor-icon-link" anchorid="透明度变化的旋转屏动画" tips="复制节点链接"></i></h2>          <p>透明度变化的旋转屏动画在屏幕显示方向变化时启用，当窗口进行旋转动画时，为旋转过程中新增或删除的组件添加默认透明度转场，以实现组件的优雅出现和消失。此功能通过监听窗口旋转事件，在事件中切换组件的视图效果，如果消失视图的根节点和新出现视图的根节点未设置转场效果，会为其自动添加默认透明度转场（即<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-transition-animation-component#transitioneffect10对象说明" target="_blank">TransitionEffect</a>.OPACITY），展现出透明度的渐隐和渐显效果。</p>     <div _ngcontent-bhk-c106="" class="highlight-div"><div _ngcontent-bhk-c106="" class="highlight-div-header"><div _ngcontent-bhk-c106="" class="highlight-div-header-left"><div _ngcontent-bhk-c106="" class="handle-button expand-button"><div _ngcontent-bhk-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bhk-c106="" class="highlight-div-header-right"><div _ngcontent-bhk-c106="" class="handle-button ai-button"></div><div _ngcontent-bhk-c106="" class="handle-button line-button"><div _ngcontent-bhk-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bhk-c106="" class="handle-button theme-button"><div _ngcontent-bhk-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bhk-c106="" class="handle-button copy-button"><div _ngcontent-bhk-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bhk-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// xx.ets</span></li><li><span class="hljs-keyword">import</span> { display } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct rotation {</li><li>
</li><li>  <span class="hljs-comment">// 获取通过监听窗口的windowsSizeChange事件得到的屏幕显示方向</span></li><li>  <span class="hljs-meta">@StorageLink</span>(<span class="hljs-string">'orientation'</span>) <span class="hljs-attr">myOrientation</span>: display.<span class="hljs-property">Orientation</span> = display.<span class="hljs-property">Orientation</span>.<span class="hljs-property">PORTRAIT</span>;</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Stack</span>() {</li><li>
</li><li>      <span class="hljs-comment">// 当屏幕显示方向变化时，切换组件的视图效果</span></li><li>      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">myOrientation</span> == display.<span class="hljs-property">Orientation</span>.<span class="hljs-property">PORTRAIT</span> || <span class="hljs-variable language_">this</span>.<span class="hljs-property">myOrientation</span> == display.<span class="hljs-property">Orientation</span>.<span class="hljs-property">PORTRAIT_INVERTED</span>) {</li><li>        <span class="hljs-title class_">Image</span>($r(<span class="hljs-string">'app.media.sky'</span>))</li><li>          .<span class="hljs-title function_">size</span>({ <span class="hljs-attr">width</span>: <span class="hljs-number">100</span>, <span class="hljs-attr">height</span>: <span class="hljs-number">100</span> })</li><li>          .<span class="hljs-title function_">id</span>(<span class="hljs-string">'image1'</span>)</li><li>
</li><li>          <span class="hljs-comment">// 开发者也可以通过自行设置transition的TransitionEffect.OPACITY转场效果来实现旋转屏动画的透明度变化</span></li><li>          <span class="hljs-comment">// .transition(TransitionEffect.OPACITY)</span></li><li>      } <span class="hljs-keyword">else</span> {</li><li>        <span class="hljs-title class_">Image</span>($r(<span class="hljs-string">'app.media.tree'</span>))</li><li>          .<span class="hljs-title function_">position</span>({ <span class="hljs-attr">x</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">0</span> })</li><li>          .<span class="hljs-title function_">size</span>({ <span class="hljs-attr">width</span>: <span class="hljs-number">200</span>, <span class="hljs-attr">height</span>: <span class="hljs-number">200</span> })</li><li>          .<span class="hljs-title function_">id</span>(<span class="hljs-string">'image2'</span>)</li><li>          </li><li>          <span class="hljs-comment">// 开发者也可以通过自行设置transition的TransitionEffect.OPACITY来实现旋转屏动画的透明度变化</span></li><li>          <span class="hljs-comment">// .transition(TransitionEffect.OPACITY)</span></li><li>      }</li><li>    }</li><li>    .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">White</span>)</li><li>    .<span class="hljs-title function_">size</span>({ <span class="hljs-attr">width</span>: <span class="hljs-string">'100%'</span>, <span class="hljs-attr">height</span>: <span class="hljs-string">'100%'</span> })</li><li>  }</li><li>}</li></ol></pre></div></div>     <p>监听窗口旋转的同步事件windowsSizeChange来实现视图的切换。例如可在EntryAbility.ets文件的onWindowStageCreate方法中添加处理逻辑以获取屏幕的显示方向。</p>     <div _ngcontent-bhk-c106="" class="highlight-div"><div _ngcontent-bhk-c106="" class="highlight-div-header"><div _ngcontent-bhk-c106="" class="highlight-div-header-left"><div _ngcontent-bhk-c106="" class="handle-button expand-button"><div _ngcontent-bhk-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bhk-c106="" class="highlight-div-header-right"><div _ngcontent-bhk-c106="" class="handle-button ai-button"></div><div _ngcontent-bhk-c106="" class="handle-button line-button"><div _ngcontent-bhk-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bhk-c106="" class="handle-button theme-button"><div _ngcontent-bhk-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bhk-c106="" class="handle-button copy-button"><div _ngcontent-bhk-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bhk-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-title function_">onWindowStageCreate</span>(<span class="hljs-attr">windowStage</span>: <span class="hljs-variable language_">window</span>.<span class="hljs-property">WindowStage</span>): <span class="hljs-built_in">void</span> {</li><li>
</li><li>    hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">'%{public}s'</span>, <span class="hljs-string">'Ability onWindowStageCreate'</span>);</li><li>
</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">mainWindow</span>: <span class="hljs-variable language_">window</span>.<span class="hljs-property">Window</span>;</li><li>    <span class="hljs-keyword">try</span> {</li><li>      mainWindow = windowStage.<span class="hljs-title function_">getMainWindowSync</span>();</li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">displayClass</span>: display.<span class="hljs-property">Display</span> = display.<span class="hljs-title function_">getDefaultDisplaySync</span>();</li><li>      <span class="hljs-title class_">AppStorage</span>.<span class="hljs-title function_">setOrCreate</span>(<span class="hljs-string">'orientation'</span>, displayClass.<span class="hljs-property">orientation</span>);</li><li>      <span class="hljs-comment">// 监听窗口的windowsSizeChange事件，旋转屏时会触发该事件</span></li><li>      mainWindow.<span class="hljs-title function_">on</span>(<span class="hljs-string">'windowSizeChange'</span>, <span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Succeeded in enabling the listener for window size changes. Data: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data));</li><li>        <span class="hljs-keyword">let</span> <span class="hljs-attr">displayClass</span>: display.<span class="hljs-property">Display</span> | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;</li><li>        <span class="hljs-keyword">try</span> {</li><li>          displayClass = display.<span class="hljs-title function_">getDefaultDisplaySync</span>();</li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'display orientation is '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(displayClass.<span class="hljs-property">orientation</span>));</li><li>          <span class="hljs-comment">// 获取屏幕的显示方向</span></li><li>          <span class="hljs-title class_">AppStorage</span>.<span class="hljs-title function_">set</span>(<span class="hljs-string">'orientation'</span>, displayClass.<span class="hljs-property">orientation</span>);</li><li>        } <span class="hljs-keyword">catch</span> {</li><li>          <span class="hljs-keyword">return</span>;</li><li>        }</li><li>      })</li><li>    } <span class="hljs-keyword">catch</span> {</li><li>      hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">'%{public}s'</span>, <span class="hljs-string">'error'</span>);</li><li>      <span class="hljs-keyword">return</span>;</li><li>    }</li><li>
</li><li>    windowStage.<span class="hljs-title function_">loadContent</span>(<span class="hljs-string">'pages/Index'</span>, <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> {</li><li>      <span class="hljs-keyword">if</span> (err.<span class="hljs-property">code</span>) {</li><li>        hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">'Failed to load the content. Cause: %{public}s'</span>, <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err) ?? <span class="hljs-string">''</span>);</li><li>        <span class="hljs-keyword">return</span>;</li><li>      }</li><li>      hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">'Succeeded in loading the content.'</span>);</li><li>    });</li><li>}</li></ol></pre></div></div>     <p>需要在项目的 module.json5 文件中的 abilities 列表里添加 "orientation"，指定为 "auto_rotation"。</p>     <div _ngcontent-bhk-c106="" class="highlight-div"><div _ngcontent-bhk-c106="" class="highlight-div-header"><div _ngcontent-bhk-c106="" class="highlight-div-header-left"><div _ngcontent-bhk-c106="" class="handle-button expand-button"><div _ngcontent-bhk-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bhk-c106="" class="highlight-div-header-right"><div _ngcontent-bhk-c106="" class="handle-button ai-button"></div><div _ngcontent-bhk-c106="" class="handle-button line-button"><div _ngcontent-bhk-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bhk-c106="" class="handle-button theme-button"><div _ngcontent-bhk-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bhk-c106="" class="handle-button copy-button"><div _ngcontent-bhk-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bhk-c106="" class="highlight-scroll-div"><pre class="json prettyprint linenums hljs language-json" hw-language="json" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-attr">"orientation"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"auto_rotation"</span><span class="hljs-punctuation">,</span></li></ol></pre></div></div>     <p>透明度变化的旋转屏动画，会对窗口做大小和位置的过渡，并同时对应用视图做切换过渡，且为消失隐藏的应用视图做渐隐效果，对新出现的视图做渐显的效果。</p>     <p><span><img originheight="419" originwidth="300" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114939.72648127174921766354245041698459:50001231000000:2800:D2E4DA62AF112C9324B5B7B76614E1BBA799853233AED750F9C4A1D65EBC5980.gif" width="300" height="419"></span></p>    </div>   </div>   <div></div></div>