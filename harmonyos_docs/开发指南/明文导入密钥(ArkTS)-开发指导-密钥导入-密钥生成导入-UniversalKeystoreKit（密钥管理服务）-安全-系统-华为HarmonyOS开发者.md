<h1 _ngcontent-kjp-c119="" class="doc-title ng-star-inserted" title="明文导入密钥(ArkTS)"> 明文导入密钥(ArkTS) </h1>

<div _ngcontent-kjp-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p>分别以导入AES256、RSA2048和X25519密钥为例。具体的场景介绍及支持的算法规格，请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/huks-key-import-overview#支持的算法">密钥导入支持的算法</a>。</p>    <div class="tiledSection">     <h2 id="开发步骤">开发步骤<i class="anchor-icon anchor-icon-link" anchorid="开发步骤" tips="复制节点链接"></i></h2>          <ol>      <li>       <p>指定密钥别名，密钥别名命名规范参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/huks-key-generation-overview">密钥生成介绍及算法规格</a>。</p></li>      <li>       <p>封装密钥属性集和密钥材料。</p>       <ul>        <li>密钥属性集同样与密钥生成中指定的密钥属性一致，须包含<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-huks#hukskeyalg" target="_blank">HuksKeyAlg</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-huks#hukskeysize" target="_blank">HuksKeySize</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-huks#hukskeypurpose" target="_blank">HuksKeyPurpose</a>属性。</li>        <li>密钥材料须符合<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/huks-concepts#密钥材料格式">HUKS密钥材料格式</a>，并以Uint8Array形式赋值给<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-huks#huksoptions" target="_blank">HuksOptions</a>的inData字段。</li>       </ul></li>      <li>       <p>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-huks#huksimportkeyitem9" target="_blank">huks.importKeyItem</a>，传入密钥别名和密钥属性集，即可导入密钥。</p>       <p>HuksParam和HuksOptions的含义参考：<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-huks#huksparam" target="_blank">HuksParam</a> 和 <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-huks#huksoptions" target="_blank">HuksOptions</a></p></li>     </ol>    </div>    <div class="tiledSection">     <h3 id="导入aes256密钥" class="firsth2">导入AES256密钥<i class="anchor-icon anchor-icon-link" anchorid="导入aes256密钥" tips="复制节点链接"></i></h3>          <div _ngcontent-kjp-c106="" class="highlight-div"><div _ngcontent-kjp-c106="" class="highlight-div-header"><div _ngcontent-kjp-c106="" class="highlight-div-header-left"><div _ngcontent-kjp-c106="" class="handle-button expand-button"><div _ngcontent-kjp-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kjp-c106="" class="highlight-div-header-right"><div _ngcontent-kjp-c106="" class="handle-button ai-button"></div><div _ngcontent-kjp-c106="" class="handle-button line-button"><div _ngcontent-kjp-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kjp-c106="" class="handle-button theme-button"><div _ngcontent-kjp-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kjp-c106="" class="handle-button copy-button"><div _ngcontent-kjp-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kjp-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">/* 以下以导入AES256密钥的Callback操作使用为例。 */</span></li><li><span class="hljs-keyword">import</span> { huks } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.UniversalKeystoreKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@kit.BasicServicesKit"</span>;</li><li>
</li><li><span class="hljs-comment">/* 密钥材料。 */</span></li><li><span class="hljs-keyword">let</span> plainTextSize32 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>([</li><li>  <span class="hljs-number">0xfb</span>, <span class="hljs-number">0x8b</span>, <span class="hljs-number">0x9f</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0xa0</span>, <span class="hljs-number">0x83</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0xbe</span>, <span class="hljs-number">0x6a</span>, <span class="hljs-number">0x6f</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x2a</span>, <span class="hljs-number">0x7c</span>, <span class="hljs-number">0x86</span>, <span class="hljs-number">0xba</span>, <span class="hljs-number">0xca</span>,</li><li>  <span class="hljs-number">0x64</span>, <span class="hljs-number">0x0b</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0x96</span>, <span class="hljs-number">0xe2</span>, <span class="hljs-number">0xfa</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0xbc</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0xe3</span>, <span class="hljs-number">0x0f</span>, <span class="hljs-number">0x0f</span>, <span class="hljs-number">0x9e</span>, <span class="hljs-number">0x3c</span>, <span class="hljs-number">0xe5</span>, <span class="hljs-number">0xf9</span></li><li>]);</li><li><span class="hljs-comment">/* 1.确定密钥别名。 */</span></li><li><span class="hljs-keyword">let</span> keyAlias = <span class="hljs-string">'AES256Alias_sample'</span>;</li><li>
</li><li><span class="hljs-comment">/* 2.封装密钥属性集和密钥材料。 */</span></li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">properties</span>: <span class="hljs-title class_">Array</span>&lt;huks.<span class="hljs-property">HuksParam</span>&gt; = [{</li><li>    <span class="hljs-attr">tag</span>: huks.<span class="hljs-property">HuksTag</span>.<span class="hljs-property">HUKS_TAG_ALGORITHM</span>,</li><li>    <span class="hljs-attr">value</span>: huks.<span class="hljs-property">HuksKeyAlg</span>.<span class="hljs-property">HUKS_ALG_AES</span></li><li>  }, {</li><li>    <span class="hljs-attr">tag</span>: huks.<span class="hljs-property">HuksTag</span>.<span class="hljs-property">HUKS_TAG_KEY_SIZE</span>,</li><li>    <span class="hljs-attr">value</span>: huks.<span class="hljs-property">HuksKeySize</span>.<span class="hljs-property">HUKS_AES_KEY_SIZE_256</span></li><li>  }, {</li><li>    <span class="hljs-attr">tag</span>: huks.<span class="hljs-property">HuksTag</span>.<span class="hljs-property">HUKS_TAG_PURPOSE</span>,</li><li>    <span class="hljs-attr">value</span>: huks.<span class="hljs-property">HuksKeyPurpose</span>.<span class="hljs-property">HUKS_KEY_PURPOSE_ENCRYPT</span> | huks.<span class="hljs-property">HuksKeyPurpose</span>.<span class="hljs-property">HUKS_KEY_PURPOSE_DECRYPT</span></li><li>  },</li><li>]</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">options</span>: huks.<span class="hljs-property">HuksOptions</span> = {</li><li>  <span class="hljs-attr">properties</span>: properties,</li><li>  <span class="hljs-attr">inData</span>: plainTextSize32</li><li>};</li><li>
</li><li><span class="hljs-comment">/* 3.明文导入密钥。 */</span></li><li><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">importKeyItem</span>(<span class="hljs-params">keyAlias: <span class="hljs-built_in">string</span>, huksOptions: huks.HuksOptions</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">boolean</span>&gt; {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"promise: enter importKeyItem"</span>);</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">ret</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">false</span>;</li><li>  <span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">await</span> huks.importKeyItem(keyAlias, huksOptions)</li><li>      .<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`promise: importKeyItem success`</span>);</li><li>        ret = <span class="hljs-literal">true</span>;</li><li>      }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error: BusinessError</span>) =&gt;</span> {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`promise: importKeyItem failed errCode : <span class="hljs-subst">${error.code}</span>, errMsg : <span class="hljs-subst">${error.message}</span>`</span>);</li><li>      })</li><li>  } <span class="hljs-keyword">catch</span> (error) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`promise: importKeyItem input arg invalid`</span>);</li><li>  }</li><li>  <span class="hljs-keyword">return</span> ret;</li><li>}</li><li>
</li><li><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">testImport</span>(<span class="hljs-params"></span>) {</li><li>  <span class="hljs-keyword">let</span> retImp = <span class="hljs-keyword">await</span> importKeyItem(keyAlias, options);</li><li>  <span class="hljs-keyword">if</span> (retImp == <span class="hljs-literal">false</span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`testImport failed`</span>);</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`testImport success`</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="导入rsa2048密钥对">导入RSA2048密钥对<i class="anchor-icon anchor-icon-link" anchorid="导入rsa2048密钥对" tips="复制节点链接"></i></h3>          <div _ngcontent-kjp-c106="" class="highlight-div"><div _ngcontent-kjp-c106="" class="highlight-div-header"><div _ngcontent-kjp-c106="" class="highlight-div-header-left"><div _ngcontent-kjp-c106="" class="handle-button expand-button"><div _ngcontent-kjp-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kjp-c106="" class="highlight-div-header-right"><div _ngcontent-kjp-c106="" class="handle-button ai-button"></div><div _ngcontent-kjp-c106="" class="handle-button line-button"><div _ngcontent-kjp-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kjp-c106="" class="handle-button theme-button"><div _ngcontent-kjp-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kjp-c106="" class="handle-button copy-button"><div _ngcontent-kjp-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kjp-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">/* 以下以导入RSA2048密钥的Callback操作使用为例。 */</span></li><li><span class="hljs-keyword">import</span> { huks } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.UniversalKeystoreKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@kit.BasicServicesKit"</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> rsa2048KeyPairMaterial = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>([</li><li>  <span class="hljs-number">0x01</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-comment">// 密钥算法(小端表示)huks.HuksKeyAlg.HUKS_ALG_RSA = 1。</span></li><li>  <span class="hljs-number">0x00</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-comment">// 密钥大小（比特）：2048。</span></li><li>  <span class="hljs-number">0x00</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-comment">// 模数n长度（字节）：256。</span></li><li>  <span class="hljs-number">0x03</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-comment">// 公钥指数e长度（字节）：3。</span></li><li>  <span class="hljs-number">0x00</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-comment">// 私钥指数d长度（字节）：256。</span></li><li>  <span class="hljs-comment">// 模数n。</span></li><li>  <span class="hljs-number">0xc5</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0xc4</span>, <span class="hljs-number">0x92</span>, <span class="hljs-number">0x87</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0x0d</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x96</span>, <span class="hljs-number">0xfc</span>, <span class="hljs-number">0x7b</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x06</span>,</li><li>  <span class="hljs-number">0x0f</span>, <span class="hljs-number">0x8d</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0xc1</span>, <span class="hljs-number">0x0e</span>, <span class="hljs-number">0xad</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x92</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0x2f</span>, <span class="hljs-number">0x6a</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0xba</span>, <span class="hljs-number">0xec</span>, <span class="hljs-number">0x1d</span>,</li><li>  <span class="hljs-number">0x54</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x0a</span>, <span class="hljs-number">0x4b</span>, <span class="hljs-number">0xd3</span>, <span class="hljs-number">0xc7</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0xe4</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0xd9</span>, <span class="hljs-number">0xb7</span>, <span class="hljs-number">0xc2</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0xcb</span>, <span class="hljs-number">0x9a</span>,</li><li>  <span class="hljs-number">0x90</span>, <span class="hljs-number">0xad</span>, <span class="hljs-number">0xe3</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0xe8</span>, <span class="hljs-number">0x5e</span>, <span class="hljs-number">0xa6</span>, <span class="hljs-number">0xf8</span>, <span class="hljs-number">0xd0</span>, <span class="hljs-number">0x6e</span>, <span class="hljs-number">0xbc</span>, <span class="hljs-number">0xd1</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0x7f</span>, <span class="hljs-number">0x6b</span>, <span class="hljs-number">0xe4</span>,</li><li>  <span class="hljs-number">0x2b</span>, <span class="hljs-number">0x4e</span>, <span class="hljs-number">0x1a</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0xbb</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0x6b</span>, <span class="hljs-number">0x7c</span>, <span class="hljs-number">0xaf</span>, <span class="hljs-number">0x7e</span>, <span class="hljs-number">0xd0</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0xeb</span>, <span class="hljs-number">0xa5</span>,</li><li>  <span class="hljs-number">0xbe</span>, <span class="hljs-number">0xd6</span>, <span class="hljs-number">0xe8</span>, <span class="hljs-number">0xee</span>, <span class="hljs-number">0x9c</span>, <span class="hljs-number">0xa5</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0xa5</span>, <span class="hljs-number">0xc9</span>, <span class="hljs-number">0xd3</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0xc4</span>, <span class="hljs-number">0x0e</span>, <span class="hljs-number">0x6c</span>, <span class="hljs-number">0xab</span>,</li><li>  <span class="hljs-number">0x50</span>, <span class="hljs-number">0xb6</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0xc9</span>, <span class="hljs-number">0xce</span>, <span class="hljs-number">0x8f</span>, <span class="hljs-number">0x0a</span>, <span class="hljs-number">0x0b</span>, <span class="hljs-number">0xc6</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0xe9</span>, <span class="hljs-number">0x83</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0xde</span>, <span class="hljs-number">0x42</span>,</li><li>  <span class="hljs-number">0x56</span>, <span class="hljs-number">0x79</span>, <span class="hljs-number">0x7f</span>, <span class="hljs-number">0xde</span>, <span class="hljs-number">0x86</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0xca</span>, <span class="hljs-number">0xfc</span>, <span class="hljs-number">0xaa</span>, <span class="hljs-number">0xc0</span>, <span class="hljs-number">0xf3</span>, <span class="hljs-number">0xf3</span>, <span class="hljs-number">0x7f</span>, <span class="hljs-number">0x92</span>, <span class="hljs-number">0x8e</span>, <span class="hljs-number">0x8a</span>,</li><li>  <span class="hljs-number">0x12</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0xfe</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0xb1</span>, <span class="hljs-number">0x5e</span>, <span class="hljs-number">0x8c</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xce</span>, <span class="hljs-number">0xfc</span>, <span class="hljs-number">0x7e</span>, <span class="hljs-number">0xf2</span>, <span class="hljs-number">0x4f</span>, <span class="hljs-number">0x5f</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0xfe</span>,</li><li>  <span class="hljs-number">0xa7</span>, <span class="hljs-number">0xcd</span>, <span class="hljs-number">0xa1</span>, <span class="hljs-number">0xfc</span>, <span class="hljs-number">0x94</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x8b</span>, <span class="hljs-number">0x9b</span>, <span class="hljs-number">0x7f</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0xab</span>, <span class="hljs-number">0xa8</span>, <span class="hljs-number">0xa4</span>, <span class="hljs-number">0xf5</span>, <span class="hljs-number">0xb4</span>,</li><li>  <span class="hljs-number">0xa5</span>, <span class="hljs-number">0xaa</span>, <span class="hljs-number">0xfc</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0xeb</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0xa9</span>, <span class="hljs-number">0xee</span>, <span class="hljs-number">0xbe</span>, <span class="hljs-number">0x8f</span>, <span class="hljs-number">0xc2</span>, <span class="hljs-number">0xd1</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0xc2</span>, <span class="hljs-number">0x0d</span>,</li><li>  <span class="hljs-number">0x44</span>, <span class="hljs-number">0xa9</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0x3b</span>, <span class="hljs-number">0x5d</span>, <span class="hljs-number">0x4a</span>, <span class="hljs-number">0xde</span>, <span class="hljs-number">0xfb</span>, <span class="hljs-number">0xae</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0xfc</span>, <span class="hljs-number">0xa3</span>, <span class="hljs-number">0xd9</span>,</li><li>  <span class="hljs-number">0xbc</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0xc2</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0xbc</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0xa7</span>, <span class="hljs-number">0x9a</span>, <span class="hljs-number">0xc5</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0xa3</span>, <span class="hljs-number">0xee</span>, <span class="hljs-number">0x5a</span>, <span class="hljs-number">0xef</span>, <span class="hljs-number">0x41</span>,</li><li>  <span class="hljs-number">0x80</span>, <span class="hljs-number">0x7d</span>, <span class="hljs-number">0xf8</span>, <span class="hljs-number">0x5e</span>, <span class="hljs-number">0xc1</span>, <span class="hljs-number">0x1d</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x5b</span>, <span class="hljs-number">0xb6</span>, <span class="hljs-number">0x92</span>, <span class="hljs-number">0xb8</span>, <span class="hljs-number">0xb7</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x0d</span>,</li><li>  <span class="hljs-number">0x3e</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x0f</span>, <span class="hljs-number">0x1c</span>, <span class="hljs-number">0xb3</span>, <span class="hljs-number">0xe1</span>, <span class="hljs-number">0x2a</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0x1a</span>, <span class="hljs-number">0x3b</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x4f</span>, <span class="hljs-number">0xc4</span>, <span class="hljs-number">0x1d</span>, <span class="hljs-number">0xcf</span>, <span class="hljs-number">0x73</span>,</li><li>  <span class="hljs-number">0x7c</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0xca</span>, <span class="hljs-number">0xe3</span>, <span class="hljs-number">0x0b</span>, <span class="hljs-number">0xa7</span>, <span class="hljs-number">0xc7</span>, <span class="hljs-number">0x1a</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x4a</span>, <span class="hljs-number">0xee</span>, <span class="hljs-number">0xbe</span>, <span class="hljs-number">0x1f</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0xdd</span>, <span class="hljs-number">0xf9</span>,</li><li>  <span class="hljs-comment">// 公钥指数e。</span></li><li>  <span class="hljs-number">0x01</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x01</span>,</li><li>  <span class="hljs-comment">// 私钥指数d。</span></li><li>  <span class="hljs-number">0x88</span>, <span class="hljs-number">0x4b</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0xe7</span>, <span class="hljs-number">0xe3</span>, <span class="hljs-number">0xe3</span>, <span class="hljs-number">0x99</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0x6c</span>, <span class="hljs-number">0x9e</span>, <span class="hljs-number">0xaf</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x3e</span>, <span class="hljs-number">0xd9</span>, <span class="hljs-number">0x07</span>,</li><li>  <span class="hljs-number">0xfd</span>, <span class="hljs-number">0x4b</span>, <span class="hljs-number">0xae</span>, <span class="hljs-number">0xce</span>, <span class="hljs-number">0x92</span>, <span class="hljs-number">0xc4</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x5e</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x79</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0xb6</span>, <span class="hljs-number">0xc3</span>, <span class="hljs-number">0x7f</span>, <span class="hljs-number">0x58</span>,</li><li>  <span class="hljs-number">0x2d</span>, <span class="hljs-number">0xef</span>, <span class="hljs-number">0xac</span>, <span class="hljs-number">0x4a</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0xcd</span>, <span class="hljs-number">0xaf</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x8f</span>, <span class="hljs-number">0xb4</span>, <span class="hljs-number">0xc4</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0xf9</span>, <span class="hljs-number">0xff</span>, <span class="hljs-number">0x5f</span>, <span class="hljs-number">0x74</span>,</li><li>  <span class="hljs-number">0x2d</span>, <span class="hljs-number">0xb5</span>, <span class="hljs-number">0xe0</span>, <span class="hljs-number">0x1c</span>, <span class="hljs-number">0xab</span>, <span class="hljs-number">0xf4</span>, <span class="hljs-number">0x6e</span>, <span class="hljs-number">0xd5</span>, <span class="hljs-number">0xdb</span>, <span class="hljs-number">0xc8</span>, <span class="hljs-number">0x0c</span>, <span class="hljs-number">0xfb</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0x3c</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0x66</span>,</li><li>  <span class="hljs-number">0xf3</span>, <span class="hljs-number">0x7f</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x7a</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0xa4</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0xb3</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0xd9</span>, <span class="hljs-number">0xe3</span>, <span class="hljs-number">0x57</span>,</li><li>  <span class="hljs-number">0x23</span>, <span class="hljs-number">0xf4</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0xfc</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0x8a</span>, <span class="hljs-number">0xc6</span>, <span class="hljs-number">0xcc</span>, <span class="hljs-number">0xa2</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0xb3</span>, <span class="hljs-number">0xe5</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0x4a</span>, <span class="hljs-number">0xa8</span>,</li><li>  <span class="hljs-number">0x84</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0xdc</span>, <span class="hljs-number">0xef</span>, <span class="hljs-number">0xfc</span>, <span class="hljs-number">0xb0</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x0b</span>, <span class="hljs-number">0xfa</span>, <span class="hljs-number">0xf6</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x0b</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0xea</span>, <span class="hljs-number">0x31</span>,</li><li>  <span class="hljs-number">0x52</span>, <span class="hljs-number">0xee</span>, <span class="hljs-number">0x99</span>, <span class="hljs-number">0xef</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x2a</span>, <span class="hljs-number">0xbe</span>, <span class="hljs-number">0x97</span>, <span class="hljs-number">0xad</span>, <span class="hljs-number">0xb3</span>, <span class="hljs-number">0xb9</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x7a</span>, <span class="hljs-number">0xae</span>, <span class="hljs-number">0xe1</span>, <span class="hljs-number">0x8f</span>,</li><li>  <span class="hljs-number">0x57</span>, <span class="hljs-number">0x86</span>, <span class="hljs-number">0xe5</span>, <span class="hljs-number">0xfe</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0x3c</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0xd0</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0xf8</span>, <span class="hljs-number">0x86</span>, <span class="hljs-number">0x1a</span>, <span class="hljs-number">0x0b</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0xc9</span>,</li><li>  <span class="hljs-number">0x33</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0xb8</span>, <span class="hljs-number">0x99</span>, <span class="hljs-number">0xc6</span>, <span class="hljs-number">0x2e</span>, <span class="hljs-number">0x94</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0xee</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0xe1</span>, <span class="hljs-number">0x5c</span>, <span class="hljs-number">0x4e</span>, <span class="hljs-number">0x6c</span>, <span class="hljs-number">0x22</span>,</li><li>  <span class="hljs-number">0x72</span>, <span class="hljs-number">0xa7</span>, <span class="hljs-number">0x2a</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0xdd</span>, <span class="hljs-number">0xd7</span>, <span class="hljs-number">0x1d</span>, <span class="hljs-number">0xfc</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x15</span>, <span class="hljs-number">0x0b</span>, <span class="hljs-number">0xde</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x9c</span>, <span class="hljs-number">0xf3</span>, <span class="hljs-number">0x28</span>,</li><li>  <span class="hljs-number">0xf3</span>, <span class="hljs-number">0xac</span>, <span class="hljs-number">0x4a</span>, <span class="hljs-number">0xa8</span>, <span class="hljs-number">0xb5</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0xca</span>, <span class="hljs-number">0x9b</span>, <span class="hljs-number">0xcc</span>, <span class="hljs-number">0x0a</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0xfe</span>, <span class="hljs-number">0x3f</span>, <span class="hljs-number">0x98</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x81</span>,</li><li>  <span class="hljs-number">0xac</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0xea</span>, <span class="hljs-number">0x1f</span>, <span class="hljs-number">0x1c</span>, <span class="hljs-number">0x6e</span>, <span class="hljs-number">0x5e</span>, <span class="hljs-number">0xca</span>, <span class="hljs-number">0xe8</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x0d</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0xf3</span>, <span class="hljs-number">0x26</span>,</li><li>  <span class="hljs-number">0xf8</span>, <span class="hljs-number">0x5e</span>, <span class="hljs-number">0xeb</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0xae</span>, <span class="hljs-number">0xaa</span>, <span class="hljs-number">0xc3</span>, <span class="hljs-number">0xad</span>, <span class="hljs-number">0x6c</span>, <span class="hljs-number">0xc1</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xdb</span>, <span class="hljs-number">0x7d</span>, <span class="hljs-number">0x5a</span>, <span class="hljs-number">0x12</span>,</li><li>  <span class="hljs-number">0x55</span>, <span class="hljs-number">0xad</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0xa1</span>, <span class="hljs-number">0xa9</span>, <span class="hljs-number">0x8f</span>, <span class="hljs-number">0x0b</span>, <span class="hljs-number">0x6d</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x8d</span>, <span class="hljs-number">0x1c</span>, <span class="hljs-number">0xdf</span>, <span class="hljs-number">0xe5</span>, <span class="hljs-number">0x63</span>, <span class="hljs-number">0x82</span>,</li><li>  <span class="hljs-number">0x0b</span>, <span class="hljs-number">0x7d</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0xb4</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0x8c</span>, <span class="hljs-number">0xed</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0xfc</span>, <span class="hljs-number">0x1a</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0xe0</span>, <span class="hljs-number">0x61</span>,</li><li>]);</li><li>
</li><li><span class="hljs-comment">/* 1.确定密钥别名。 */</span></li><li><span class="hljs-keyword">let</span> keyAlias = <span class="hljs-string">'RSA_sample'</span>;</li><li><span class="hljs-comment">/* 2.封装密钥属性集和密钥材料。 */</span></li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">properties</span>: <span class="hljs-title class_">Array</span>&lt;huks.<span class="hljs-property">HuksParam</span>&gt; = [{</li><li>    <span class="hljs-attr">tag</span>: huks.<span class="hljs-property">HuksTag</span>.<span class="hljs-property">HUKS_TAG_ALGORITHM</span>,</li><li>    <span class="hljs-attr">value</span>: huks.<span class="hljs-property">HuksKeyAlg</span>.<span class="hljs-property">HUKS_ALG_RSA</span></li><li>  }, {</li><li>    <span class="hljs-attr">tag</span>: huks.<span class="hljs-property">HuksTag</span>.<span class="hljs-property">HUKS_TAG_KEY_SIZE</span>,</li><li>    <span class="hljs-attr">value</span>: huks.<span class="hljs-property">HuksKeySize</span>.<span class="hljs-property">HUKS_RSA_KEY_SIZE_2048</span></li><li>  }, {</li><li>    <span class="hljs-comment">// 此tag表示密钥导入后的用途，导入后将不可更改。</span></li><li>    <span class="hljs-attr">tag</span>: huks.<span class="hljs-property">HuksTag</span>.<span class="hljs-property">HUKS_TAG_PURPOSE</span>,</li><li>    <span class="hljs-attr">value</span>: huks.<span class="hljs-property">HuksKeyPurpose</span>.<span class="hljs-property">HUKS_KEY_PURPOSE_ENCRYPT</span> | huks.<span class="hljs-property">HuksKeyPurpose</span>.<span class="hljs-property">HUKS_KEY_PURPOSE_DECRYPT</span></li><li>  }, {</li><li>    <span class="hljs-comment">// 此tag表示需导入的密钥类型。</span></li><li>    <span class="hljs-attr">tag</span>: huks.<span class="hljs-property">HuksTag</span>.<span class="hljs-property">HUKS_TAG_IMPORT_KEY_TYPE</span>,</li><li>    <span class="hljs-comment">// 此value表示导入密钥对，若改为HUKS_KEY_TYPE_PUBLIC_KEY时表示仅导入公钥。</span></li><li>    <span class="hljs-attr">value</span>: huks.<span class="hljs-property">HuksImportKeyType</span>.<span class="hljs-property">HUKS_KEY_TYPE_KEY_PAIR</span></li><li>  },</li><li>]</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">options</span>: huks.<span class="hljs-property">HuksOptions</span> = {</li><li>  <span class="hljs-attr">properties</span>: properties,</li><li>  <span class="hljs-attr">inData</span>: rsa2048KeyPairMaterial</li><li>};</li><li>
</li><li><span class="hljs-comment">/* 3.明文导入密钥。 */</span></li><li><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">importKeyItem</span>(<span class="hljs-params">keyAlias: <span class="hljs-built_in">string</span>, huksOptions: huks.HuksOptions</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">boolean</span>&gt; {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"promise: enter importKeyItem"</span>);</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">ret</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">false</span>;</li><li>  <span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">await</span> huks.importKeyItem(keyAlias, huksOptions)</li><li>      .<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`promise: importKeyItem success`</span>);</li><li>        ret = <span class="hljs-literal">true</span>;</li><li>      }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error: BusinessError</span>) =&gt;</span> {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`promise: importKeyItem failed errCode : <span class="hljs-subst">${error.code}</span>, errMsg : <span class="hljs-subst">${error.message}</span>`</span>);</li><li>      })</li><li>  } <span class="hljs-keyword">catch</span> (error) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`promise: importKeyItem input arg invalid`</span>);</li><li>  }</li><li>  <span class="hljs-keyword">return</span> ret;</li><li>}</li><li>
</li><li><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">testImport</span>(<span class="hljs-params"></span>) {</li><li>  <span class="hljs-keyword">let</span> retImp = <span class="hljs-keyword">await</span> importKeyItem(keyAlias, options);</li><li>  <span class="hljs-keyword">if</span> (retImp == <span class="hljs-literal">false</span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`testImport failed`</span>);</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`testImport success`</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="导入x25519密钥公钥">导入X25519密钥公钥<i class="anchor-icon anchor-icon-link" anchorid="导入x25519密钥公钥" tips="复制节点链接"></i></h3>          <div _ngcontent-kjp-c106="" class="highlight-div"><div _ngcontent-kjp-c106="" class="highlight-div-header"><div _ngcontent-kjp-c106="" class="highlight-div-header-left"><div _ngcontent-kjp-c106="" class="handle-button expand-button"><div _ngcontent-kjp-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kjp-c106="" class="highlight-div-header-right"><div _ngcontent-kjp-c106="" class="handle-button ai-button"></div><div _ngcontent-kjp-c106="" class="handle-button line-button"><div _ngcontent-kjp-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kjp-c106="" class="handle-button theme-button"><div _ngcontent-kjp-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kjp-c106="" class="handle-button copy-button"><div _ngcontent-kjp-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kjp-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">/* 以下以导入X25519密钥的Callback操作使用为例。 */</span></li><li><span class="hljs-keyword">import</span> { huks } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.UniversalKeystoreKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@kit.BasicServicesKit"</span>;</li><li>
</li><li><span class="hljs-comment">// X25519的公钥数据。X25519密钥对中的私钥和公钥都是32字节（256位），关于算法原理请自行参考相关密码学资料。</span></li><li><span class="hljs-keyword">let</span> x25519KeyPubMaterial = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>([</li><li>  <span class="hljs-number">0x30</span>, <span class="hljs-number">0x2A</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x2B</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x6E</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xD2</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x9E</span>, <span class="hljs-number">0xCF</span>,</li><li>  <span class="hljs-number">0xF0</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x5B</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0xCE</span>, <span class="hljs-number">0x4F</span>, <span class="hljs-number">0xF0</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x2B</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0x3E</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0xC6</span></li><li>]);</li><li>
</li><li><span class="hljs-comment">/* 1.确定密钥别名。 */</span></li><li><span class="hljs-keyword">let</span> keyAlias = <span class="hljs-string">'X25519_Pub_import_sample'</span>;</li><li><span class="hljs-comment">/* 2.封装密钥属性集和密钥材料。 */</span></li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">properties</span>: <span class="hljs-title class_">Array</span>&lt;huks.<span class="hljs-property">HuksParam</span>&gt; = [{</li><li>    <span class="hljs-attr">tag</span>: huks.<span class="hljs-property">HuksTag</span>.<span class="hljs-property">HUKS_TAG_ALGORITHM</span>,</li><li>    <span class="hljs-attr">value</span>: huks.<span class="hljs-property">HuksKeyAlg</span>.<span class="hljs-property">HUKS_ALG_X25519</span></li><li>  }, {</li><li>    <span class="hljs-attr">tag</span>: huks.<span class="hljs-property">HuksTag</span>.<span class="hljs-property">HUKS_TAG_KEY_SIZE</span>,</li><li>    <span class="hljs-attr">value</span>: huks.<span class="hljs-property">HuksKeySize</span>.<span class="hljs-property">HUKS_CURVE25519_KEY_SIZE_256</span></li><li>  }, {</li><li>    <span class="hljs-comment">// 此tag表示密钥导入后的用途，导入后将不可更改。</span></li><li>    <span class="hljs-attr">tag</span>: huks.<span class="hljs-property">HuksTag</span>.<span class="hljs-property">HUKS_TAG_PURPOSE</span>,</li><li>    <span class="hljs-attr">value</span>: huks.<span class="hljs-property">HuksKeyPurpose</span>.<span class="hljs-property">HUKS_KEY_PURPOSE_VERIFY</span></li><li>  }, {</li><li>    <span class="hljs-comment">// 此tag表示需导入的密钥类型。</span></li><li>    <span class="hljs-attr">tag</span>: huks.<span class="hljs-property">HuksTag</span>.<span class="hljs-property">HUKS_TAG_IMPORT_KEY_TYPE</span>,</li><li>    <span class="hljs-comment">// 此value表示导入密钥的公钥，若改为HUKS_KEY_TYPE_KEY_PAIR时表示导入密钥对。</span></li><li>    <span class="hljs-attr">value</span>: huks.<span class="hljs-property">HuksImportKeyType</span>.<span class="hljs-property">HUKS_KEY_TYPE_PUBLIC_KEY</span></li><li>  },</li><li>]</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">options</span>: huks.<span class="hljs-property">HuksOptions</span> = {</li><li>  <span class="hljs-attr">properties</span>: properties,</li><li>  <span class="hljs-attr">inData</span>: x25519KeyPubMaterial</li><li>};</li><li>
</li><li><span class="hljs-comment">/* 3.明文导入密钥。 */</span></li><li><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">importKeyItem</span>(<span class="hljs-params">keyAlias: <span class="hljs-built_in">string</span>, huksOptions: huks.HuksOptions</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">boolean</span>&gt; {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"promise: enter importKeyItem"</span>);</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">ret</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">false</span>;</li><li>  <span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">await</span> huks.importKeyItem(keyAlias, huksOptions)</li><li>      .<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`promise: importKeyItem success`</span>);</li><li>        ret = <span class="hljs-literal">true</span>;</li><li>      }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error: BusinessError</span>) =&gt;</span> {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`promise: importKeyItem failed errCode : <span class="hljs-subst">${error.code}</span>, errMsg : <span class="hljs-subst">${error.message}</span>`</span>);</li><li>      })</li><li>  } <span class="hljs-keyword">catch</span> (error) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`promise: importKeyItem input arg invalid`</span>);</li><li>  }</li><li>  <span class="hljs-keyword">return</span> ret;</li><li>}</li><li>
</li><li><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">testImport</span>(<span class="hljs-params"></span>) {</li><li>  <span class="hljs-keyword">let</span> retImp = <span class="hljs-keyword">await</span> importKeyItem(keyAlias, options);</li><li>  <span class="hljs-keyword">if</span> (retImp == <span class="hljs-literal">false</span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`testImport failed`</span>);</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`testImport success`</span>);</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="调测验证">调测验证<i class="anchor-icon anchor-icon-link" anchorid="调测验证" tips="复制节点链接"></i></h2>          <p>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-huks#huksiskeyitemexist9" target="_blank">huks.isKeyItemExist</a>验证密钥是否存在，如密钥存在即表示密钥导入成功。</p>     <div _ngcontent-kjp-c106="" class="highlight-div"><div _ngcontent-kjp-c106="" class="highlight-div-header"><div _ngcontent-kjp-c106="" class="highlight-div-header-left"><div _ngcontent-kjp-c106="" class="handle-button expand-button"><div _ngcontent-kjp-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kjp-c106="" class="highlight-div-header-right"><div _ngcontent-kjp-c106="" class="handle-button ai-button"></div><div _ngcontent-kjp-c106="" class="handle-button line-button"><div _ngcontent-kjp-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kjp-c106="" class="handle-button theme-button"><div _ngcontent-kjp-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kjp-c106="" class="handle-button copy-button"><div _ngcontent-kjp-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kjp-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { huks } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.UniversalKeystoreKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"@kit.BasicServicesKit"</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> keyAlias = <span class="hljs-string">'AES256Alias_sample'</span>;</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">keyProperties</span>: <span class="hljs-title class_">Array</span>&lt;huks.<span class="hljs-property">HuksParam</span>&gt; = [{</li><li>    <span class="hljs-attr">tag</span>: huks.<span class="hljs-property">HuksTag</span>.<span class="hljs-property">HUKS_TAG_ALGORITHM</span>,</li><li>    <span class="hljs-attr">value</span>: huks.<span class="hljs-property">HuksKeyAlg</span>.<span class="hljs-property">HUKS_ALG_AES</span></li><li>  }</li><li>]</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">huksOptions</span>: huks.<span class="hljs-property">HuksOptions</span> = {</li><li>  <span class="hljs-attr">properties</span>: keyProperties, <span class="hljs-comment">// 非空填充。</span></li><li>  <span class="hljs-attr">inData</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Array</span>()) <span class="hljs-comment">// 非空填充。</span></li><li>}</li><li>
</li><li><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">isKeyItemExist</span>(<span class="hljs-params">keyAlias: <span class="hljs-built_in">string</span>, options: huks.HuksOptions</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">boolean</span>&gt; {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`promise: enter isKeyItemExist success`</span>);</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">ret</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">false</span>;</li><li>  <span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">await</span> huks.<span class="hljs-title function_">isKeyItemExist</span>(keyAlias, options)</li><li>      .<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`promise: isKeyItemExist success, data = <span class="hljs-subst">${data}</span>`</span>);</li><li>        ret = <span class="hljs-literal">true</span>;</li><li>      }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error: BusinessError</span>) =&gt;</span> {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`promise: isKeyItemExist success, errCode : <span class="hljs-subst">${error.code}</span>, errMsg : <span class="hljs-subst">${error.message}</span>`</span>);</li><li>      })</li><li>  } <span class="hljs-keyword">catch</span> (error) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`promise: isKeyItemExist input arg invalid`</span>);</li><li>  }</li><li>  <span class="hljs-keyword">return</span> ret;</li><li>}</li><li>
</li><li><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">testImportKeyExist</span>(<span class="hljs-params"></span>) {</li><li>  <span class="hljs-keyword">let</span> retExist = <span class="hljs-keyword">await</span> <span class="hljs-title function_">isKeyItemExist</span>(keyAlias, huksOptions);</li><li>  <span class="hljs-keyword">if</span> (retExist == <span class="hljs-literal">false</span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`testImportKeyExist failed`</span>);</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`testImportKeyExist success`</span>);</li><li>}</li></ol></pre></div></div>    </div>   </div>   <div></div></div>