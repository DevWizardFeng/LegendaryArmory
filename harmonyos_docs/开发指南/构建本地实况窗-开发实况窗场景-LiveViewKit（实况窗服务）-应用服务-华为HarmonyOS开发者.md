<h1 _ngcontent-dkp-c119="" class="doc-title ng-star-inserted" title="构建本地实况窗"> 构建本地实况窗 </h1>

<div _ngcontent-dkp-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <div class="tiledSection">     <h2 id="section738118456219">简介<i class="anchor-icon anchor-icon-link" anchorid="section738118456219" tips="复制节点链接"></i></h2>          <p>开发者可以通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/liveveiw-liveviewmanager" target="_blank">liveViewManager</a>模块构建本地实况窗，完成实况窗的整个生命周期流程（包括创建、更新与结束）。请注意，只有应用在前台运行，即用户实际使用应用并且产生了服务合约的情况下，开发者才可以创建实况窗；与此同时，本地更新或结束实况窗依赖于开发者的应用进程，所以我们更推荐开发者在本地创建实况窗后使用Push Kit更新或结束实况窗。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>Live View Kit提供了“出行打车/即时配送/航班/高铁火车/排队叫号/取餐/赛事比分/共享租赁/计时/运动锻炼/导航”共11个场景的包含实况窗整个生命周期流程的示例代码，如开发者想在正式开发实况窗前先行体验效果，请参考<a href="https://gitcode.com/HarmonyOS_Samples/live-view-kit_-sample-code_-clientdemo_-arkts" target="_blank">实况窗SampleCode</a>。</p>      </div></div></div>    </div>    <div class="tiledSection">     <h2 id="section1456953322711">导入liveViewManager<i class="anchor-icon anchor-icon-link" anchorid="section1456953322711" tips="复制节点链接"></i></h2>          <p>在项目中导入<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/liveveiw-liveviewmanager" target="_blank">liveViewManager</a>，并新建实况窗控制类（例如LiveViewController），构造isLiveViewEnabled()方法，用于校验实况窗开关（设置&gt;应用和元服务&gt;应用名&gt;实况窗）是否打开。打开实况窗开关是创建实况窗的前提条件。示例代码如下：</p>     <div _ngcontent-dkp-c106="" class="highlight-div"><div _ngcontent-dkp-c106="" class="highlight-div-header"><div _ngcontent-dkp-c106="" class="highlight-div-header-left"><div _ngcontent-dkp-c106="" class="handle-button expand-button"><div _ngcontent-dkp-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-dkp-c106="" class="highlight-div-header-right"><div _ngcontent-dkp-c106="" class="handle-button ai-button"></div><div _ngcontent-dkp-c106="" class="handle-button line-button"><div _ngcontent-dkp-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-dkp-c106="" class="handle-button theme-button"><div _ngcontent-dkp-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-dkp-c106="" class="handle-button copy-button"><div _ngcontent-dkp-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-dkp-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { liveViewManager } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.LiveViewKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LiveViewController</span> {</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">isLiveViewEnabled</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">boolean</span>&gt; {</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> liveViewManager.<span class="hljs-title function_">isLiveViewEnabled</span>();</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="section69141150182715">创建实况窗<i class="anchor-icon anchor-icon-link" anchorid="section69141150182715" tips="复制节点链接"></i></h2>          <p>实况窗根据扩展区不同共有5种样式模板：进度可视化模板、强调文本模板、左右文本模板、赛事比分模板和导航模板。</p>     <p>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/liveveiw-liveviewmanager#section195321751104612" target="_blank">liveViewManager.startLiveView</a>创建实况窗，该API接口传入参数为实况窗实例（liveViewManager.<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/liveveiw-liveviewmanager#section411410371767" target="_blank">LiveView</a>）。</p>    </div>    <div class="tiledSection">     <h3 id="section62041442218" class="firsth2">进度可视化模板<i class="anchor-icon anchor-icon-link" anchorid="section62041442218" tips="复制节点链接"></i></h3>          <p>进度可视化模板适用于打车、外卖等场景。</p>     <p><span><img height="268.3275" originheight="768" originwidth="1496" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114545.73282389907279800145796180730118:50001231000000:2800:89EE1B1F1D7AFB3BEF2AA2D5B8690D0FB8DACC544E4A1C7B089F219B9672BADA.png" title="点击放大" width="523.6875"></span></p>     <p></p>     <p>示例代码如下：</p>     <div class="p">      构建LiveViewController后，请在代码中初始化LiveViewController并调用LiveViewController.startLiveView()方法。      <div _ngcontent-dkp-c106="" class="highlight-div"><div _ngcontent-dkp-c106="" class="highlight-div-header"><div _ngcontent-dkp-c106="" class="highlight-div-header-left"><div _ngcontent-dkp-c106="" class="handle-button expand-button"><div _ngcontent-dkp-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-dkp-c106="" class="highlight-div-header-right"><div _ngcontent-dkp-c106="" class="handle-button ai-button"></div><div _ngcontent-dkp-c106="" class="handle-button line-button"><div _ngcontent-dkp-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-dkp-c106="" class="handle-button theme-button"><div _ngcontent-dkp-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-dkp-c106="" class="handle-button copy-button"><div _ngcontent-dkp-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-dkp-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { liveViewManager } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.LiveViewKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Want</span>, wantAgent } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LiveViewController</span> {</li><li>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">startLiveView</span>(): <span class="hljs-title class_">Promise</span>&lt;liveViewManager.<span class="hljs-property">LiveViewResult</span>&gt; {</li><li>    <span class="hljs-comment">// 校验实况窗开关是否打开</span></li><li>    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">await</span> <span class="hljs-title class_">LiveViewController</span>.<span class="hljs-title function_">isLiveViewEnabled</span>()) {</li><li>      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">"Live view is disabled."</span>);</li><li>    }</li><li>    <span class="hljs-comment">// 创建实况窗</span></li><li>    <span class="hljs-keyword">const</span> defaultView = <span class="hljs-keyword">await</span> <span class="hljs-title class_">LiveViewController</span>.<span class="hljs-title function_">buildDefaultView</span>();</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> liveViewManager.<span class="hljs-title function_">startLiveView</span>(defaultView);</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">buildDefaultView</span>(): <span class="hljs-title class_">Promise</span>&lt;liveViewManager.<span class="hljs-property">LiveView</span>&gt; {</li><li>    <span class="hljs-keyword">return</span> {</li><li>      <span class="hljs-comment">// 构造实况窗请求体</span></li><li>      <span class="hljs-attr">id</span>: <span class="hljs-number">0</span>, <span class="hljs-comment">// 实况窗ID，开发者生成。</span></li><li>      <span class="hljs-attr">event</span>: <span class="hljs-string">"DELIVERY"</span>, <span class="hljs-comment">// 实况窗的应用场景。DELIVERY：即时配送（外卖、生鲜）</span></li><li>      <span class="hljs-attr">liveViewData</span>: {</li><li>        <span class="hljs-attr">primary</span>: {</li><li>          <span class="hljs-attr">title</span>: <span class="hljs-string">"骑手已接单"</span>,</li><li>          <span class="hljs-attr">content</span>: [</li><li>            { <span class="hljs-attr">text</span>: <span class="hljs-string">"距商家 "</span> },</li><li>            { <span class="hljs-attr">text</span>: <span class="hljs-string">"300 "</span>, <span class="hljs-attr">textColor</span>: <span class="hljs-string">"#FF0A59F7"</span> },</li><li>            { <span class="hljs-attr">text</span>: <span class="hljs-string">"米 | "</span> },</li><li>            { <span class="hljs-attr">text</span>: <span class="hljs-string">"3 "</span>, <span class="hljs-attr">textColor</span>: <span class="hljs-string">"#FF0A59F7"</span> },</li><li>            { <span class="hljs-attr">text</span>: <span class="hljs-string">"分钟到店"</span> }</li><li>          ], <span class="hljs-comment">// 设置textColor字段时，所有拥有textColor字段的对象仅能设置同一种颜色，不设置textColor时，默认展示#FF000000</span></li><li>          <span class="hljs-attr">keepTime</span>: <span class="hljs-number">15</span>,</li><li>          <span class="hljs-attr">clickAction</span>: <span class="hljs-keyword">await</span> <span class="hljs-title class_">LiveViewController</span>.<span class="hljs-title function_">buildWantAgent</span>(),</li><li>          <span class="hljs-attr">layoutData</span>: {</li><li>            <span class="hljs-attr">layoutType</span>: liveViewManager.<span class="hljs-property">LayoutType</span>.<span class="hljs-property">LAYOUT_TYPE_PROGRESS</span>,</li><li>            <span class="hljs-attr">progress</span>: <span class="hljs-number">40</span>,</li><li>            <span class="hljs-attr">color</span>: <span class="hljs-string">"#FF317AF7"</span>,</li><li>            <span class="hljs-attr">backgroundColor</span>: <span class="hljs-string">"#f7819ae0"</span>,</li><li>            <span class="hljs-attr">indicatorType</span>: liveViewManager.<span class="hljs-property">IndicatorType</span>.<span class="hljs-property">INDICATOR_TYPE_UP</span>,</li><li>            <span class="hljs-attr">indicatorIcon</span>: <span class="hljs-string">"indicator.png"</span>, <span class="hljs-comment">// 进度条指示器图标，取值为“/resources/rawfile”路径下的文件名或image.</span><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-image-pixelmap" target="_blank"><span class="hljs-comment">PixelMap</span></a></li><li>            <span class="hljs-attr">lineType</span>: liveViewManager.<span class="hljs-property">LineType</span>.<span class="hljs-property">LINE_TYPE_DOTTED_LINE</span>,</li><li>            <span class="hljs-attr">nodeIcons</span>: [<span class="hljs-string">"icon_1.png"</span>, <span class="hljs-string">"icon_2.png"</span>, <span class="hljs-string">"icon_3.png"</span>] <span class="hljs-comment">// 进度条每个节点图标，取值为“/resources/rawfile”路径下的文件名或image.</span><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-image-pixelmap" target="_blank"><span class="hljs-comment">PixelMap</span></a></li><li>          }</li><li>        }</li><li>      }</li><li>    };</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">isLiveViewEnabled</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">boolean</span>&gt; {</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> liveViewManager.<span class="hljs-title function_">isLiveViewEnabled</span>();</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">buildWantAgent</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">Want</span>&gt; {</li><li>    <span class="hljs-keyword">const</span> <span class="hljs-attr">wantAgentInfo</span>: wantAgent.<span class="hljs-property">WantAgentInfo</span> = {</li><li>      <span class="hljs-attr">wants</span>: [</li><li>        {</li><li>          <span class="hljs-attr">bundleName</span>: <span class="hljs-string">'xxx.xxx.xxx'</span>, <span class="hljs-comment">// 应用实际bundleName</span></li><li>          <span class="hljs-attr">abilityName</span>: <span class="hljs-string">'EntryAbility'</span></li><li>        } <span class="hljs-keyword">as</span> <span class="hljs-title class_">Want</span></li><li>      ],</li><li>      <span class="hljs-attr">actionType</span>: wantAgent.<span class="hljs-property">OperationType</span>.<span class="hljs-property">START_ABILITIES</span>,</li><li>      <span class="hljs-attr">requestCode</span>: <span class="hljs-number">0</span>,</li><li>      <span class="hljs-attr">actionFlags</span>: [wantAgent.<span class="hljs-property">WantAgentFlags</span>.<span class="hljs-property">UPDATE_PRESENT_FLAG</span>]</li><li>    };</li><li>    <span class="hljs-keyword">const</span> agent = <span class="hljs-keyword">await</span> wantAgent.<span class="hljs-title function_">getWantAgent</span>(wantAgentInfo);</li><li>    <span class="hljs-keyword">return</span> agent;</li><li>  }</li><li>}</li></ol></pre></div></div>     </div>    </div>    <div class="tiledSection">     <h3 id="section113626521804">强调文本模板<i class="anchor-icon anchor-icon-link" anchorid="section113626521804" tips="复制节点链接"></i></h3>          <p>强调文本模板适用于取餐、排队等场景。</p>     <p><span><img height="265.33500000000004" originheight="760" originwidth="1496" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114545.26346687811491271153236008770983:50001231000000:2800:E507784DD77046885281B65AFA45713E480C6276B2D450FC89BB5E84EA878592.png" title="点击放大" width="523.6875"></span></p>     <p></p>     <p>示例代码如下：</p>     <p>构建LiveViewController后，请在代码中初始化LiveViewController并调用LiveViewController.startLiveView()方法。</p>     <div _ngcontent-dkp-c106="" class="highlight-div"><div _ngcontent-dkp-c106="" class="highlight-div-header"><div _ngcontent-dkp-c106="" class="highlight-div-header-left"><div _ngcontent-dkp-c106="" class="handle-button expand-button"><div _ngcontent-dkp-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-dkp-c106="" class="highlight-div-header-right"><div _ngcontent-dkp-c106="" class="handle-button ai-button"></div><div _ngcontent-dkp-c106="" class="handle-button line-button"><div _ngcontent-dkp-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-dkp-c106="" class="handle-button theme-button"><div _ngcontent-dkp-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-dkp-c106="" class="handle-button copy-button"><div _ngcontent-dkp-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-dkp-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { liveViewManager } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.LiveViewKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Want</span>, wantAgent } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LiveViewController</span> {</li><li>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">startLiveView</span>(): <span class="hljs-title class_">Promise</span>&lt;liveViewManager.<span class="hljs-property">LiveViewResult</span>&gt; {</li><li>    <span class="hljs-comment">// 校验实况窗开关是否打开</span></li><li>    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">await</span> <span class="hljs-title class_">LiveViewController</span>.<span class="hljs-title function_">isLiveViewEnabled</span>()) {</li><li>      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">"Live view is disabled."</span>);</li><li>    }</li><li>    <span class="hljs-comment">// 创建实况窗</span></li><li>    <span class="hljs-keyword">const</span> defaultView = <span class="hljs-keyword">await</span> <span class="hljs-title class_">LiveViewController</span>.<span class="hljs-title function_">buildDefaultView</span>();</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> liveViewManager.<span class="hljs-title function_">startLiveView</span>(defaultView);</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">buildDefaultView</span>(): <span class="hljs-title class_">Promise</span>&lt;liveViewManager.<span class="hljs-property">LiveView</span>&gt; {</li><li>    <span class="hljs-keyword">return</span> {</li><li>      <span class="hljs-comment">// 构造实况窗请求体</span></li><li>      <span class="hljs-attr">id</span>: <span class="hljs-number">0</span>, <span class="hljs-comment">// 实况窗ID，开发者生成。</span></li><li>      <span class="hljs-attr">event</span>: <span class="hljs-string">"PICK_UP"</span>, <span class="hljs-comment">// 实况窗的应用场景。PICK_UP：取餐。</span></li><li>      <span class="hljs-attr">liveViewData</span>: {</li><li>        <span class="hljs-attr">primary</span>: {</li><li>          <span class="hljs-attr">title</span>: <span class="hljs-string">"餐品已备好"</span>,</li><li>          <span class="hljs-attr">content</span>: [</li><li>            { <span class="hljs-attr">text</span>: <span class="hljs-string">"请前往"</span> },</li><li>            { <span class="hljs-attr">text</span>: <span class="hljs-string">" XXX店 "</span>, <span class="hljs-attr">textColor</span>: <span class="hljs-string">"#FF0A59F7"</span> },</li><li>            { <span class="hljs-attr">text</span>: <span class="hljs-string">"取餐"</span> },</li><li>          ],</li><li>          <span class="hljs-attr">keepTime</span>: <span class="hljs-number">15</span>,</li><li>          <span class="hljs-attr">clickAction</span>: <span class="hljs-keyword">await</span> <span class="hljs-title class_">LiveViewController</span>.<span class="hljs-title function_">buildWantAgent</span>(),</li><li>          <span class="hljs-attr">layoutData</span>: {</li><li>            <span class="hljs-attr">layoutType</span>: liveViewManager.<span class="hljs-property">LayoutType</span>.<span class="hljs-property">LAYOUT_TYPE_PICKUP</span>,</li><li>            <span class="hljs-attr">title</span>: <span class="hljs-string">"取餐码"</span>,</li><li>            <span class="hljs-attr">content</span>: <span class="hljs-string">"72988"</span>,</li><li>            <span class="hljs-attr">underlineColor</span>: <span class="hljs-string">"#FF0A59F7"</span>,</li><li>            <span class="hljs-attr">descPic</span>: <span class="hljs-string">"coffee.png"</span> <span class="hljs-comment">// 扩展区右侧产品描述图，取值为“/resources/rawfile”路径下的文件名或image.</span><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-image-pixelmap" target="_blank"><span class="hljs-comment">PixelMap</span></a></li><li>          }</li><li>        }</li><li>      }</li><li>    };</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">isLiveViewEnabled</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">boolean</span>&gt; {</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> liveViewManager.<span class="hljs-title function_">isLiveViewEnabled</span>();</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">buildWantAgent</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">Want</span>&gt; {</li><li>    <span class="hljs-keyword">const</span> <span class="hljs-attr">wantAgentInfo</span>: wantAgent.<span class="hljs-property">WantAgentInfo</span> = {</li><li>      <span class="hljs-attr">wants</span>: [</li><li>        {</li><li>          <span class="hljs-attr">bundleName</span>: <span class="hljs-string">'xxx.xxx.xxx'</span>, <span class="hljs-comment">// 应用实际bundleName</span></li><li>          <span class="hljs-attr">abilityName</span>: <span class="hljs-string">'EntryAbility'</span></li><li>        } <span class="hljs-keyword">as</span> <span class="hljs-title class_">Want</span></li><li>      ],</li><li>      <span class="hljs-attr">actionType</span>: wantAgent.<span class="hljs-property">OperationType</span>.<span class="hljs-property">START_ABILITIES</span>,</li><li>      <span class="hljs-attr">requestCode</span>: <span class="hljs-number">0</span>,</li><li>      <span class="hljs-attr">actionFlags</span>: [wantAgent.<span class="hljs-property">WantAgentFlags</span>.<span class="hljs-property">UPDATE_PRESENT_FLAG</span>]</li><li>    };</li><li>    <span class="hljs-keyword">const</span> agent = <span class="hljs-keyword">await</span> wantAgent.<span class="hljs-title function_">getWantAgent</span>(wantAgentInfo);</li><li>    <span class="hljs-keyword">return</span> agent;</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="section95851325212">左右文本模板<i class="anchor-icon anchor-icon-link" anchorid="section95851325212" tips="复制节点链接"></i></h3>          <p>左右文本模板适用于高铁、航班等场景。</p>     <p><span><img height="290.27250000000004" originheight="884" originwidth="1592" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114545.07413290855779009809967259140732:50001231000000:2800:BC96BB14C9404E3EA76DF122AE2033422EE94081AAA25E352D0E0E61B84D9EAC.png" title="点击放大" width="523.6875"></span></p>     <p></p>     <p>示例代码如下：</p>     <div class="p">      构建LiveViewController后，请在代码中初始化LiveViewController并调用LiveViewController.startLiveView()方法。      <div _ngcontent-dkp-c106="" class="highlight-div"><div _ngcontent-dkp-c106="" class="highlight-div-header"><div _ngcontent-dkp-c106="" class="highlight-div-header-left"><div _ngcontent-dkp-c106="" class="handle-button expand-button"><div _ngcontent-dkp-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-dkp-c106="" class="highlight-div-header-right"><div _ngcontent-dkp-c106="" class="handle-button ai-button"></div><div _ngcontent-dkp-c106="" class="handle-button line-button"><div _ngcontent-dkp-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-dkp-c106="" class="handle-button theme-button"><div _ngcontent-dkp-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-dkp-c106="" class="handle-button copy-button"><div _ngcontent-dkp-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-dkp-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { liveViewManager } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.LiveViewKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Want</span>, wantAgent } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LiveViewController</span> {</li><li>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">startLiveView</span>(): <span class="hljs-title class_">Promise</span>&lt;liveViewManager.<span class="hljs-property">LiveViewResult</span>&gt; {</li><li>    <span class="hljs-comment">// 校验实况窗开关是否打开</span></li><li>    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">await</span> <span class="hljs-title class_">LiveViewController</span>.<span class="hljs-title function_">isLiveViewEnabled</span>()) {</li><li>      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">"Live view is disabled."</span>);</li><li>    }</li><li>    <span class="hljs-comment">// 创建实况窗</span></li><li>    <span class="hljs-keyword">const</span> defaultView = <span class="hljs-keyword">await</span> <span class="hljs-title class_">LiveViewController</span>.<span class="hljs-title function_">buildDefaultView</span>();</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> liveViewManager.<span class="hljs-title function_">startLiveView</span>(defaultView);</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">buildDefaultView</span>(): <span class="hljs-title class_">Promise</span>&lt;liveViewManager.<span class="hljs-property">LiveView</span>&gt; {</li><li>    <span class="hljs-keyword">return</span> {</li><li>      <span class="hljs-comment">// 构造实况窗请求体</span></li><li>      <span class="hljs-attr">id</span>: <span class="hljs-number">0</span>, <span class="hljs-comment">// 实况窗ID，开发者生成。</span></li><li>      <span class="hljs-attr">event</span>: <span class="hljs-string">"TRAIN"</span>, <span class="hljs-comment">// 实况窗的应用场景。TRAIN：高铁/火车。</span></li><li>      <span class="hljs-attr">liveViewData</span>: {</li><li>        <span class="hljs-attr">primary</span>: {</li><li>          <span class="hljs-attr">title</span>: <span class="hljs-string">"列车检票提醒"</span>,</li><li>          <span class="hljs-attr">content</span>: [</li><li>            { <span class="hljs-attr">text</span>: <span class="hljs-string">"检票口 "</span> },</li><li>            { <span class="hljs-attr">text</span>: <span class="hljs-string">"6B "</span>, <span class="hljs-attr">textColor</span>: <span class="hljs-string">"#FF0A59F7"</span> },</li><li>            { <span class="hljs-attr">text</span>: <span class="hljs-string">"| 座位 "</span> },</li><li>            { <span class="hljs-attr">text</span>: <span class="hljs-string">"03车 12F"</span>, <span class="hljs-attr">textColor</span>: <span class="hljs-string">"#FF0A59F7"</span> }</li><li>          ], <span class="hljs-comment">// 设置textColor字段时，所有拥有textColor字段的对象仅能设置同一种颜色，不设置textColor时，默认展示#FF000000</span></li><li>          <span class="hljs-attr">keepTime</span>: <span class="hljs-number">15</span>,</li><li>          <span class="hljs-attr">clickAction</span>: <span class="hljs-keyword">await</span> <span class="hljs-title class_">LiveViewController</span>.<span class="hljs-title function_">buildWantAgent</span>(), <span class="hljs-comment">// 点击实况窗默认动作。</span></li><li>          <span class="hljs-attr">layoutData</span>: {</li><li>            <span class="hljs-attr">layoutType</span>: liveViewManager.<span class="hljs-property">LayoutType</span>.<span class="hljs-property">LAYOUT_TYPE_FLIGHT</span>,</li><li>            <span class="hljs-attr">firstTitle</span>: <span class="hljs-string">"09:00"</span>,</li><li>            <span class="hljs-attr">firstContent</span>: <span class="hljs-string">"上海虹桥"</span>,</li><li>            <span class="hljs-attr">lastTitle</span>: <span class="hljs-string">"14:20"</span>,</li><li>            <span class="hljs-attr">lastContent</span>: <span class="hljs-string">"汉口"</span>,</li><li>            <span class="hljs-attr">spaceIcon</span>: <span class="hljs-string">"icon.png"</span>, <span class="hljs-comment">// 扩展区中间间隔图标，取值为“/resources/rawfile”路径下的文件名或image.</span><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-image-pixelmap" target="_blank"><span class="hljs-comment">PixelMap</span></a></li><li>            <span class="hljs-attr">isHorizontalLineDisplayed</span>: <span class="hljs-literal">true</span>,</li><li>            <span class="hljs-attr">additionalText</span>: <span class="hljs-string">"以上信息仅供参考"</span> <span class="hljs-comment">// 扩展区底部内容，仅可用于左右文本模板。</span></li><li>          }</li><li>        }</li><li>      }</li><li>    };</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">isLiveViewEnabled</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">boolean</span>&gt; {</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> liveViewManager.<span class="hljs-title function_">isLiveViewEnabled</span>();</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">buildWantAgent</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">Want</span>&gt; {</li><li>    <span class="hljs-keyword">const</span> <span class="hljs-attr">wantAgentInfo</span>: wantAgent.<span class="hljs-property">WantAgentInfo</span> = {</li><li>      <span class="hljs-attr">wants</span>: [</li><li>        {</li><li>          <span class="hljs-attr">bundleName</span>: <span class="hljs-string">'xxx.xxx.xxx'</span>, <span class="hljs-comment">// 应用实际bundleName</span></li><li>          <span class="hljs-attr">abilityName</span>: <span class="hljs-string">'EntryAbility'</span></li><li>        } <span class="hljs-keyword">as</span> <span class="hljs-title class_">Want</span></li><li>      ],</li><li>      <span class="hljs-attr">actionType</span>: wantAgent.<span class="hljs-property">OperationType</span>.<span class="hljs-property">START_ABILITIES</span>,</li><li>      <span class="hljs-attr">requestCode</span>: <span class="hljs-number">0</span>,</li><li>      <span class="hljs-attr">actionFlags</span>: [wantAgent.<span class="hljs-property">WantAgentFlags</span>.<span class="hljs-property">UPDATE_PRESENT_FLAG</span>]</li><li>    };</li><li>    <span class="hljs-keyword">const</span> agent = <span class="hljs-keyword">await</span> wantAgent.<span class="hljs-title function_">getWantAgent</span>(wantAgentInfo);</li><li>    <span class="hljs-keyword">return</span> agent;</li><li>  }</li><li>}</li></ol></pre></div></div>     </div>    </div>    <p>航班场景下，传入雨、雪天气信息或夕阳、赏月航班背景氛围参数，实况卡片支持显示雨、雪天气背景氛围或夕阳、赏月航班背景氛围。</p>    <p><span><img height="438.72350900000004" originheight="868" originwidth="1784" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114545.05421332947986275962125993870735:50001231000000:2800:108310262290C88A68CE74769FF467D3FCA72508F18CA730B4A26C82C10A0BD4.gif" title="点击放大" width="902.7375000000001"></span></p>    <p>从6.0.0(20)开始，实况卡片支持赏月/夕阳航班/天气背景氛围，代码示例如下：</p>    <div class="p">     构建LiveViewController后，请在代码中初始化LiveViewController并调用LiveViewController.startLiveView()方法。     <div _ngcontent-dkp-c106="" class="highlight-div"><div _ngcontent-dkp-c106="" class="highlight-div-header"><div _ngcontent-dkp-c106="" class="highlight-div-header-left"><div _ngcontent-dkp-c106="" class="handle-button expand-button"><div _ngcontent-dkp-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-dkp-c106="" class="highlight-div-header-right"><div _ngcontent-dkp-c106="" class="handle-button ai-button"></div><div _ngcontent-dkp-c106="" class="handle-button line-button"><div _ngcontent-dkp-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-dkp-c106="" class="handle-button theme-button"><div _ngcontent-dkp-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-dkp-c106="" class="handle-button copy-button"><div _ngcontent-dkp-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-dkp-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { liveViewManager } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.LiveViewKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Want</span>, wantAgent } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LiveViewController</span> {</li><li>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">startLiveView</span>(): <span class="hljs-title class_">Promise</span>&lt;liveViewManager.<span class="hljs-property">LiveViewResult</span>&gt; {</li><li>    <span class="hljs-comment">// 校验实况窗开关是否打开</span></li><li>    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">await</span> <span class="hljs-title class_">LiveViewController</span>.<span class="hljs-title function_">isLiveViewEnabled</span>()) {</li><li>      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">"Live view is disabled."</span>);</li><li>    }</li><li>    <span class="hljs-comment">// 创建实况窗</span></li><li>    <span class="hljs-keyword">const</span> defaultView = <span class="hljs-keyword">await</span> <span class="hljs-title class_">LiveViewController</span>.<span class="hljs-title function_">buildDefaultView</span>();</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> liveViewManager.<span class="hljs-title function_">startLiveView</span>(defaultView);</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">buildDefaultView</span>() : <span class="hljs-title class_">Promise</span> &lt; liveViewManager.<span class="hljs-property">LiveView</span> &gt; {</li><li>    <span class="hljs-keyword">return</span> {</li><li>      id : <span class="hljs-number">6</span>, <span class="hljs-comment">//liveView ID, generated by the developer</span></li><li>      event : <span class="hljs-string">"FLIGHT"</span>, <span class="hljs-comment">// application scenarios of liveView：FLIGHT。</span></li><li>      liveViewData : {</li><li>    primary : {</li><li>      title : <span class="hljs-string">"计划出发"</span>,</li><li>      content : [</li><li>        {text : <span class="hljs-string">"登机口"</span>}, </li><li>           {text : <span class="hljs-string">"32"</span>, <span class="hljs-attr">textColor</span>: <span class="hljs-string">"#FF0A59F7"</span> }, </li><li>         {text : <span class="hljs-string">"| 座位"</span>}, </li><li>        {text : <span class="hljs-string">" 17H"</span>, <span class="hljs-attr">textColor</span>: <span class="hljs-string">"#FF0A59F7"</span> }</li><li>      ], <span class="hljs-comment">// 设置textColor字段时，所有拥有textColor字段的对象仅能设置同一种颜色，不设置textColor时，默认展示#FF000000</span></li><li>      keepTime : <span class="hljs-number">15</span>,</li><li>      clickAction : <span class="hljs-keyword">await</span> <span class="hljs-title class_">LiveViewController</span>.<span class="hljs-title function_">buildWantAgent</span>(),</li><li>      backgroundType : liveViewManager.<span class="hljs-property">BackgroundType</span>.<span class="hljs-property">SYS_BACKGROUND_FLIGHT_SUNSET</span>,  <span class="hljs-comment">//当传入实况窗卡片的背景氛围类型参数backgroundType值为赏月航班或夕阳航班时，且同时传入天气类型(</span><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/liveveiw-liveviewmanager#section145641518183913" target="_blank"><span class="hljs-comment">WeatherInfo</span></a><span class="hljs-comment">)为雨、雪特殊天气，卡片上优先展示天气背景，其余非特殊天气在卡片上展示赏月航班或夕阳航班背景氛围。</span></li><li>      layoutData : {</li><li>        layoutType : liveViewManager.<span class="hljs-property">LayoutType</span>.<span class="hljs-property">LAYOUT_TYPE_FLIGHT</span>,</li><li>        weatherInfo : {</li><li>          weatherType : liveViewManager.<span class="hljs-property">WeatherType</span>.<span class="hljs-property">WEATHER_TYPE_LIGHT_RAIN</span>,</li><li>              locationType : liveViewManager.<span class="hljs-property">WeatherLocationType</span>.<span class="hljs-property">LOCATION_TYPE_DESTINATION</span>,</li><li>           highTemperature : <span class="hljs-number">30</span>,</li><li>              lowTemperature : -<span class="hljs-number">10</span></li><li>          },</li><li>        <span class="hljs-attr">firstTitle</span>: <span class="hljs-string">"09:00"</span>,</li><li>            <span class="hljs-attr">firstContent</span>: <span class="hljs-string">"上海虹桥"</span>,</li><li>        <span class="hljs-attr">lastTitle</span>: <span class="hljs-string">"14:20"</span>,</li><li>        <span class="hljs-attr">lastContent</span>: <span class="hljs-string">"汉口"</span>,</li><li>        spaceIcon : <span class="hljs-string">"icon_plane.png"</span>,<span class="hljs-comment">// 扩展区中间间隔图标，取值为“/resources/rawfile”路径下的文件名或image.PixelMap</span></li><li>        isHorizontalLineDisplayed : <span class="hljs-literal">false</span>,</li><li>        additionalText : <span class="hljs-string">"以上信息仅供参考"</span> <span class="hljs-comment">// 扩展区底部内容，仅可用于左右文本模板。</span></li><li>      } </li><li>        }</li><li>      }</li><li>    };</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">isLiveViewEnabled</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">boolean</span>&gt; {</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> liveViewManager.<span class="hljs-title function_">isLiveViewEnabled</span>();</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">buildWantAgent</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">Want</span>&gt; {</li><li>    <span class="hljs-keyword">const</span> <span class="hljs-attr">wantAgentInfo</span>: wantAgent.<span class="hljs-property">WantAgentInfo</span> = {</li><li>      <span class="hljs-attr">wants</span>: [</li><li>        {</li><li>          <span class="hljs-attr">bundleName</span>: <span class="hljs-string">'xxx.xxx.xxx'</span>, <span class="hljs-comment">// 应用实际bundleName</span></li><li>          <span class="hljs-attr">abilityName</span>: <span class="hljs-string">'EntryAbility'</span></li><li>        } <span class="hljs-keyword">as</span> <span class="hljs-title class_">Want</span></li><li>      ],</li><li>      <span class="hljs-attr">actionType</span>: wantAgent.<span class="hljs-property">OperationType</span>.<span class="hljs-property">START_ABILITIES</span>,</li><li>      <span class="hljs-attr">requestCode</span>: <span class="hljs-number">0</span>,</li><li>      <span class="hljs-attr">actionFlags</span>: [wantAgent.<span class="hljs-property">WantAgentFlags</span>.<span class="hljs-property">UPDATE_PRESENT_FLAG</span>]</li><li>    };</li><li>    <span class="hljs-keyword">const</span> agent = <span class="hljs-keyword">await</span> wantAgent.<span class="hljs-title function_">getWantAgent</span>(wantAgentInfo);</li><li>    <span class="hljs-keyword">return</span> agent;</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="section25155137214">赛事比分模板<i class="anchor-icon anchor-icon-link" anchorid="section25155137214" tips="复制节点链接"></i></h3>          <p>赛事比分模板适用于赛事场景。</p>     <p><span><img height="265.33500000000004" originheight="760" originwidth="1496" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114545.00482114249001018473034399726266:50001231000000:2800:3FC87C3287F9D9DC269FA8B0671CA1309752DFFDBE79FDAB13DBCB15D5A1D3E1.png" title="点击放大" width="523.6875"></span></p>     <p></p>     <p>示例代码如下：</p>     <p>构建LiveViewController后，请在代码中初始化LiveViewController并调用LiveViewController.startLiveView()方法。</p>     <div _ngcontent-dkp-c106="" class="highlight-div"><div _ngcontent-dkp-c106="" class="highlight-div-header"><div _ngcontent-dkp-c106="" class="highlight-div-header-left"><div _ngcontent-dkp-c106="" class="handle-button expand-button"><div _ngcontent-dkp-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-dkp-c106="" class="highlight-div-header-right"><div _ngcontent-dkp-c106="" class="handle-button ai-button"></div><div _ngcontent-dkp-c106="" class="handle-button line-button"><div _ngcontent-dkp-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-dkp-c106="" class="handle-button theme-button"><div _ngcontent-dkp-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-dkp-c106="" class="handle-button copy-button"><div _ngcontent-dkp-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-dkp-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { liveViewManager } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.LiveViewKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Want</span>, wantAgent } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LiveViewController</span> {</li><li>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">startLiveView</span>(): <span class="hljs-title class_">Promise</span>&lt;liveViewManager.<span class="hljs-property">LiveViewResult</span>&gt; {</li><li>    <span class="hljs-comment">// 校验实况窗开关是否打开</span></li><li>    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">await</span> <span class="hljs-title class_">LiveViewController</span>.<span class="hljs-title function_">isLiveViewEnabled</span>()) {</li><li>      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">"Live view is disabled."</span>);</li><li>    }</li><li>    <span class="hljs-comment">// 创建实况窗</span></li><li>    <span class="hljs-keyword">const</span> defaultView = <span class="hljs-keyword">await</span> <span class="hljs-title class_">LiveViewController</span>.<span class="hljs-title function_">buildDefaultView</span>();</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> liveViewManager.<span class="hljs-title function_">startLiveView</span>(defaultView);</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">buildDefaultView</span>(): <span class="hljs-title class_">Promise</span>&lt;liveViewManager.<span class="hljs-property">LiveView</span>&gt; {</li><li>    <span class="hljs-keyword">return</span> {</li><li>      <span class="hljs-comment">// 构造实况窗请求体</span></li><li>      <span class="hljs-attr">id</span>: <span class="hljs-number">0</span>, <span class="hljs-comment">// 实况窗ID，开发者生成。</span></li><li>      <span class="hljs-attr">event</span>: <span class="hljs-string">"SCORE"</span>, <span class="hljs-comment">// 实况窗的应用场景。SCORE：赛事比分。</span></li><li>      <span class="hljs-attr">liveViewData</span>: {</li><li>        <span class="hljs-attr">primary</span>: {</li><li>          <span class="hljs-attr">title</span>: <span class="hljs-string">"第四节比赛中"</span>,</li><li>          <span class="hljs-attr">content</span>: [</li><li>            { <span class="hljs-attr">text</span>: <span class="hljs-string">"XX"</span>, <span class="hljs-attr">textColor</span>:<span class="hljs-string">"#FF0A59F7"</span> },</li><li>            { <span class="hljs-attr">text</span>: <span class="hljs-string">" VS "</span> },</li><li>            { <span class="hljs-attr">text</span>: <span class="hljs-string">"XX"</span>, <span class="hljs-attr">textColor</span>:<span class="hljs-string">"#FF0A59F7"</span> },</li><li>            { <span class="hljs-attr">text</span>: <span class="hljs-string">" | "</span> },</li><li>            { <span class="hljs-attr">text</span>: <span class="hljs-string">"小组赛 第五场"</span>, <span class="hljs-attr">textColor</span>:<span class="hljs-string">"#FF0A59F7"</span> }</li><li>          ],</li><li>          <span class="hljs-attr">keepTime</span>: <span class="hljs-number">1</span>,</li><li>          <span class="hljs-attr">clickAction</span>: <span class="hljs-keyword">await</span> <span class="hljs-title class_">LiveViewController</span>.<span class="hljs-title function_">buildWantAgent</span>(),</li><li>          <span class="hljs-attr">layoutData</span>: {</li><li>            <span class="hljs-attr">layoutType</span>: liveViewManager.<span class="hljs-property">LayoutType</span>.<span class="hljs-property">LAYOUT_TYPE_SCORE</span>,</li><li>            <span class="hljs-attr">hostName</span>: <span class="hljs-string">"队名A"</span>,</li><li>            <span class="hljs-attr">hostIcon</span>: <span class="hljs-string">"host.png"</span>, <span class="hljs-comment">// 扩展区左侧图标，取值为“/resources/rawfile”路径下的文件名或image.</span><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-image-pixelmap" target="_blank"><span class="hljs-comment">PixelMap</span></a></li><li>            <span class="hljs-attr">hostScore</span>: <span class="hljs-string">"110"</span>,</li><li>            <span class="hljs-attr">guestName</span>: <span class="hljs-string">"队名B"</span>,</li><li>            <span class="hljs-attr">guestIcon</span>: <span class="hljs-string">"guest.png"</span>, <span class="hljs-comment">// 扩展区右侧图标，取值为“/resources/rawfile”路径下的文件名或image.</span><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-image-pixelmap" target="_blank"><span class="hljs-comment">PixelMap</span></a></li><li>            <span class="hljs-attr">guestScore</span>: <span class="hljs-string">"102"</span>,</li><li>            <span class="hljs-attr">competitionDesc</span>: [</li><li>              { <span class="hljs-attr">text</span>: <span class="hljs-string">"●"</span>, <span class="hljs-attr">textColor</span>: <span class="hljs-string">"#FFFF0000"</span> },</li><li>              { <span class="hljs-attr">text</span>: <span class="hljs-string">"Q4"</span> }</li><li>            ],</li><li>            <span class="hljs-attr">competitionTime</span>: <span class="hljs-string">"02:16"</span>,</li><li>            <span class="hljs-attr">isHorizontalLineDisplayed</span>: <span class="hljs-literal">true</span></li><li>          }</li><li>        }</li><li>      }</li><li>    };</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">isLiveViewEnabled</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">boolean</span>&gt; {</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> liveViewManager.<span class="hljs-title function_">isLiveViewEnabled</span>();</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">buildWantAgent</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">Want</span>&gt; {</li><li>    <span class="hljs-keyword">const</span> <span class="hljs-attr">wantAgentInfo</span>: wantAgent.<span class="hljs-property">WantAgentInfo</span> = {</li><li>      <span class="hljs-attr">wants</span>: [</li><li>        {</li><li>          <span class="hljs-attr">bundleName</span>: <span class="hljs-string">'xxx.xxx.xxx'</span>, <span class="hljs-comment">// 应用实际bundleName</span></li><li>          <span class="hljs-attr">abilityName</span>: <span class="hljs-string">'EntryAbility'</span></li><li>        } <span class="hljs-keyword">as</span> <span class="hljs-title class_">Want</span></li><li>      ],</li><li>      <span class="hljs-attr">actionType</span>: wantAgent.<span class="hljs-property">OperationType</span>.<span class="hljs-property">START_ABILITIES</span>,</li><li>      <span class="hljs-attr">requestCode</span>: <span class="hljs-number">0</span>,</li><li>      <span class="hljs-attr">actionFlags</span>: [wantAgent.<span class="hljs-property">WantAgentFlags</span>.<span class="hljs-property">UPDATE_PRESENT_FLAG</span>]</li><li>    };</li><li>    <span class="hljs-keyword">const</span> agent = <span class="hljs-keyword">await</span> wantAgent.<span class="hljs-title function_">getWantAgent</span>(wantAgentInfo);</li><li>    <span class="hljs-keyword">return</span> agent;</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="section202231347592">导航模板<i class="anchor-icon anchor-icon-link" anchorid="section202231347592" tips="复制节点链接"></i></h3>          <p>导航模板适用于出行导航场景。</p>     <p><span><img height="240.849434" originheight="623" originwidth="1293" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114545.04610000812187064346182698205610:50001231000000:2800:2EECADCB54CC71544F89F4F79E0C909948199033D404D0D07A42B6217805DE1D.png" title="点击放大" width="499.897125"></span></p>     <p></p>     <p>示例代码如下：</p>     <p>构建LiveViewController后，请在代码中初始化LiveViewController并调用LiveViewController.startLiveView()方法。</p>     <div _ngcontent-dkp-c106="" class="highlight-div"><div _ngcontent-dkp-c106="" class="highlight-div-header"><div _ngcontent-dkp-c106="" class="highlight-div-header-left"><div _ngcontent-dkp-c106="" class="handle-button expand-button"><div _ngcontent-dkp-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-dkp-c106="" class="highlight-div-header-right"><div _ngcontent-dkp-c106="" class="handle-button ai-button"></div><div _ngcontent-dkp-c106="" class="handle-button line-button"><div _ngcontent-dkp-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-dkp-c106="" class="handle-button theme-button"><div _ngcontent-dkp-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-dkp-c106="" class="handle-button copy-button"><div _ngcontent-dkp-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-dkp-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { liveViewManager } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.LiveViewKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Want</span>, wantAgent } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LiveViewController</span> {</li><li>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">startLiveView</span>(): <span class="hljs-title class_">Promise</span>&lt;liveViewManager.<span class="hljs-property">LiveViewResult</span>&gt; {</li><li>    <span class="hljs-comment">// 校验实况窗开关是否打开</span></li><li>    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">await</span> <span class="hljs-title class_">LiveViewController</span>.<span class="hljs-title function_">isLiveViewEnabled</span>()) {</li><li>      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">"Live view is disabled."</span>);</li><li>    }</li><li>    <span class="hljs-comment">// 创建实况窗</span></li><li>    <span class="hljs-keyword">const</span> defaultView = <span class="hljs-keyword">await</span> <span class="hljs-title class_">LiveViewController</span>.<span class="hljs-title function_">buildDefaultView</span>();</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> liveViewManager.<span class="hljs-title function_">startLiveView</span>(defaultView);</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">buildDefaultView</span>(): <span class="hljs-title class_">Promise</span>&lt;liveViewManager.<span class="hljs-property">LiveView</span>&gt; {</li><li>    <span class="hljs-keyword">return</span> {</li><li>      <span class="hljs-comment">// 构造实况窗请求体</span></li><li>      <span class="hljs-attr">id</span>: <span class="hljs-number">0</span>, <span class="hljs-comment">// 实况窗ID，开发者生成。</span></li><li>      <span class="hljs-attr">event</span>: <span class="hljs-string">"NAVIGATION"</span>, <span class="hljs-comment">// 实况窗的应用场景。NAVIGATION：导航。</span></li><li>      <span class="hljs-attr">liveViewData</span>: {</li><li>        <span class="hljs-attr">primary</span>: {</li><li>          <span class="hljs-attr">title</span>: <span class="hljs-string">"178米后左转"</span>,</li><li>          <span class="hljs-attr">content</span>: [</li><li>            { <span class="hljs-attr">text</span>: <span class="hljs-string">"去往"</span>},</li><li>            { <span class="hljs-attr">text</span>: <span class="hljs-string">" 南京东路"</span>, <span class="hljs-attr">textColor</span>: <span class="hljs-string">"#FF0A59F7"</span> }</li><li>          ],</li><li>          <span class="hljs-attr">keepTime</span>: <span class="hljs-number">15</span>,</li><li>          <span class="hljs-attr">clickAction</span>: <span class="hljs-keyword">await</span> <span class="hljs-title class_">LiveViewController</span>.<span class="hljs-title function_">buildWantAgent</span>(),</li><li>          <span class="hljs-attr">layoutData</span>: {</li><li>            <span class="hljs-attr">layoutType</span>: liveViewManager.<span class="hljs-property">LayoutType</span>.<span class="hljs-property">LAYOUT_TYPE_NAVIGATION</span>,</li><li>            <span class="hljs-attr">currentNavigationIcon</span>: <span class="hljs-string">"navigation.png"</span>, <span class="hljs-comment">// 当前导航方向，取值为“/resources/rawfile”路径下的文件名或image.</span><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-image-pixelmap" target="_blank"><span class="hljs-comment">PixelMap</span></a></li><li>            <span class="hljs-attr">navigationIcons</span>: [<span class="hljs-string">"left.png"</span>,<span class="hljs-string">"straight.png"</span>,<span class="hljs-string">"straight.png"</span>,<span class="hljs-string">"right.png"</span>] <span class="hljs-comment">// 导航方向的箭头集合图片，每个元素取值为“/resources/rawfile”路径下的文件名或image.</span><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-image-pixelmap" target="_blank"><span class="hljs-comment">PixelMap</span></a></li><li>          }</li><li>        }</li><li>      }</li><li>    };</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">isLiveViewEnabled</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">boolean</span>&gt; {</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> liveViewManager.<span class="hljs-title function_">isLiveViewEnabled</span>();</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">buildWantAgent</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">Want</span>&gt; {</li><li>    <span class="hljs-keyword">const</span> <span class="hljs-attr">wantAgentInfo</span>: wantAgent.<span class="hljs-property">WantAgentInfo</span> = {</li><li>      <span class="hljs-attr">wants</span>: [</li><li>        {</li><li>          <span class="hljs-attr">bundleName</span>: <span class="hljs-string">'xxx.xxx.xxx'</span>, <span class="hljs-comment">// 应用实际bundleName</span></li><li>          <span class="hljs-attr">abilityName</span>: <span class="hljs-string">'EntryAbility'</span></li><li>        } <span class="hljs-keyword">as</span> <span class="hljs-title class_">Want</span></li><li>      ],</li><li>      <span class="hljs-attr">actionType</span>: wantAgent.<span class="hljs-property">OperationType</span>.<span class="hljs-property">START_ABILITIES</span>,</li><li>      <span class="hljs-attr">requestCode</span>: <span class="hljs-number">0</span>,</li><li>      <span class="hljs-attr">actionFlags</span>: [wantAgent.<span class="hljs-property">WantAgentFlags</span>.<span class="hljs-property">UPDATE_PRESENT_FLAG</span>]</li><li>    };</li><li>    <span class="hljs-keyword">const</span> agent = <span class="hljs-keyword">await</span> wantAgent.<span class="hljs-title function_">getWantAgent</span>(wantAgentInfo);</li><li>    <span class="hljs-keyword">return</span> agent;</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="section4396663589">实况胶囊<i class="anchor-icon anchor-icon-link" anchorid="section4396663589" tips="复制节点链接"></i></h3>          <p><span><img height="387.03000000000003" originheight="1065" originwidth="1440" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114546.88626139152281389158144177807347:50001231000000:2800:B2CB9FAC1FE1F1E6742511DB3E6B15BB982810330A9ADFDE83A3CD30C84B4330.png" title="点击放大" width="523.6875"></span></p>     <p></p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>胶囊形态各模板参数固定，与创建实况窗时的模板类型无关。可创建的胶囊类型有：文本胶囊、计时器胶囊、进度胶囊，详情请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/liveveiw-liveviewmanager#section1600824135815" target="_blank">CapsuleData</a>。</p>      </div></div></div>     <div class="p">      除了实况窗卡片形态，开发者还需考虑实况窗胶囊形态的展示效果。若开发者创建实况窗时还想同步创建实况窗胶囊，则需在liveViewManager.<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/liveveiw-liveviewmanager#section411410371767" target="_blank">LiveView</a>（结构体）中携带胶囊所需的参数liveViewData.<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/liveveiw-liveviewmanager#section980821010388" target="_blank">capsule</a>（不同胶囊类型携带不同的参数）。示例代码如下：      <div _ngcontent-dkp-c106="" class="highlight-div"><div _ngcontent-dkp-c106="" class="highlight-div-header"><div _ngcontent-dkp-c106="" class="highlight-div-header-left"><div _ngcontent-dkp-c106="" class="handle-button expand-button"><div _ngcontent-dkp-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-dkp-c106="" class="highlight-div-header-right"><div _ngcontent-dkp-c106="" class="handle-button ai-button"></div><div _ngcontent-dkp-c106="" class="handle-button line-button"><div _ngcontent-dkp-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-dkp-c106="" class="handle-button theme-button"><div _ngcontent-dkp-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-dkp-c106="" class="handle-button copy-button"><div _ngcontent-dkp-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-dkp-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { liveViewManager } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.LiveViewKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Want</span>, wantAgent } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LiveViewController</span> {</li><li>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">startLiveView</span>(): <span class="hljs-title class_">Promise</span>&lt;liveViewManager.<span class="hljs-property">LiveViewResult</span>&gt; {</li><li>    <span class="hljs-comment">// 校验实况窗开关是否打开</span></li><li>    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">await</span> <span class="hljs-title class_">LiveViewController</span>.<span class="hljs-title function_">isLiveViewEnabled</span>()) {</li><li>      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">"Live view is disabled."</span>);</li><li>    }</li><li>    <span class="hljs-comment">// 创建实况窗</span></li><li>    <span class="hljs-keyword">const</span> defaultView = <span class="hljs-keyword">await</span> <span class="hljs-title class_">LiveViewController</span>.<span class="hljs-title function_">buildDefaultView</span>();</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> liveViewManager.<span class="hljs-title function_">startLiveView</span>(defaultView);</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">buildDefaultView</span>(): <span class="hljs-title class_">Promise</span>&lt;liveViewManager.<span class="hljs-property">LiveView</span>&gt; {</li><li>    <span class="hljs-keyword">return</span> {</li><li>      <span class="hljs-comment">// 构造实况窗请求体</span></li><li>      <span class="hljs-attr">id</span>: <span class="hljs-number">0</span>, <span class="hljs-comment">// 实况窗ID，开发者生成。</span></li><li>      <span class="hljs-attr">event</span>: <span class="hljs-string">"TAXI"</span>, <span class="hljs-comment">// 实况窗的应用场景。TAXI：出行打车。</span></li><li>      <span class="hljs-attr">liveViewData</span>: {</li><li>        <span class="hljs-attr">primary</span>: {</li><li>          <span class="hljs-attr">title</span>: <span class="hljs-string">"司机预计5分钟后到达"</span>,</li><li>          <span class="hljs-attr">content</span>: [</li><li>            { <span class="hljs-attr">text</span>: <span class="hljs-string">"白"</span>, <span class="hljs-attr">textColor</span>: <span class="hljs-string">"#FF0A59F7"</span> },</li><li>            { <span class="hljs-attr">text</span>: <span class="hljs-string">"●"</span> },</li><li>            { <span class="hljs-attr">text</span>: <span class="hljs-string">"沪AXXXXXX"</span>, <span class="hljs-attr">textColor</span>: <span class="hljs-string">"#FF0A59F7"</span> }</li><li>          ],</li><li>          <span class="hljs-attr">keepTime</span>: <span class="hljs-number">15</span>,</li><li>          <span class="hljs-attr">clickAction</span>: <span class="hljs-keyword">await</span> <span class="hljs-title class_">LiveViewController</span>.<span class="hljs-title function_">buildWantAgent</span>(),</li><li>          <span class="hljs-attr">layoutData</span>: {</li><li>            <span class="hljs-attr">layoutType</span>: liveViewManager.<span class="hljs-property">LayoutType</span>.<span class="hljs-property">LAYOUT_TYPE_PROGRESS</span>,</li><li>            <span class="hljs-attr">progress</span>: <span class="hljs-number">30</span>,</li><li>            <span class="hljs-attr">color</span>: <span class="hljs-string">"#ff0959F8"</span>,</li><li>            <span class="hljs-attr">backgroundColor</span>: <span class="hljs-string">"#ffc9d7e4"</span>,</li><li>            <span class="hljs-attr">indicatorType</span>: liveViewManager.<span class="hljs-property">IndicatorType</span>.<span class="hljs-property">INDICATOR_TYPE_UP</span>,</li><li>            <span class="hljs-attr">indicatorIcon</span>: <span class="hljs-string">"indicator.png"</span>, <span class="hljs-comment">// 进度条指示器图标，取值为“/resources/rawfile”路径下的文件名或image.</span><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-image-pixelmap" target="_blank"><span class="hljs-comment">PixelMap</span></a></li><li>            <span class="hljs-attr">lineType</span>: liveViewManager.<span class="hljs-property">LineType</span>.<span class="hljs-property">LINE_TYPE_NORMAL_SOLID_LINE</span>,</li><li>            <span class="hljs-attr">nodeIcons</span>: [<span class="hljs-string">"icon_1.png"</span>, <span class="hljs-string">"icon_2.png"</span>, <span class="hljs-string">"icon_3.png"</span>] <span class="hljs-comment">// 进度条节点图标集合，每个元素取值为“/resources/rawfile”路径下的文件名或image.</span><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-image-pixelmap" target="_blank"><span class="hljs-comment">PixelMap</span></a></li><li>          }</li><li>        },</li><li>        <span class="hljs-comment">// 实况胶囊相关参数</span></li><li>        <span class="hljs-attr">capsule</span>: {</li><li>          <span class="hljs-attr">type</span>: liveViewManager.<span class="hljs-property">CapsuleType</span>.<span class="hljs-property">CAPSULE_TYPE_TEXT</span>,</li><li>          <span class="hljs-attr">status</span>: <span class="hljs-number">1</span>,</li><li>          <span class="hljs-attr">icon</span>: <span class="hljs-string">"capsule_store.png"</span>, <span class="hljs-comment">// 胶囊图标，取值为“/resources/rawfile”路径下的文件名或image.</span><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-image-pixelmap" target="_blank"><span class="hljs-comment">PixelMap</span></a></li><li>          <span class="hljs-attr">backgroundColor</span>: <span class="hljs-string">"#ff0959F8"</span>,</li><li>          <span class="hljs-attr">title</span>: <span class="hljs-string">"5分钟"</span></li><li>        }</li><li>      }</li><li>    };</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">isLiveViewEnabled</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">boolean</span>&gt; {</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> liveViewManager.<span class="hljs-title function_">isLiveViewEnabled</span>();</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">buildWantAgent</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">Want</span>&gt; {</li><li>    <span class="hljs-keyword">const</span> <span class="hljs-attr">wantAgentInfo</span>: wantAgent.<span class="hljs-property">WantAgentInfo</span> = {</li><li>      <span class="hljs-attr">wants</span>: [</li><li>        {</li><li>          <span class="hljs-attr">bundleName</span>: <span class="hljs-string">'xxx.xxx.xxx'</span>, <span class="hljs-comment">// 应用实际bundleName</span></li><li>          <span class="hljs-attr">abilityName</span>: <span class="hljs-string">'EntryAbility'</span></li><li>        } <span class="hljs-keyword">as</span> <span class="hljs-title class_">Want</span></li><li>      ],</li><li>      <span class="hljs-attr">actionType</span>: wantAgent.<span class="hljs-property">OperationType</span>.<span class="hljs-property">START_ABILITIES</span>,</li><li>      <span class="hljs-attr">requestCode</span>: <span class="hljs-number">0</span>,</li><li>      <span class="hljs-attr">actionFlags</span>: [wantAgent.<span class="hljs-property">WantAgentFlags</span>.<span class="hljs-property">UPDATE_PRESENT_FLAG</span>]</li><li>    };</li><li>    <span class="hljs-keyword">const</span> agent = <span class="hljs-keyword">await</span> wantAgent.<span class="hljs-title function_">getWantAgent</span>(wantAgentInfo);</li><li>    <span class="hljs-keyword">return</span> agent;</li><li>  }</li><li>}</li></ol></pre></div></div>     </div>    </div>    <div class="tiledSection">     <h3 id="section11267105154">小折叠外屏实况窗<i class="anchor-icon anchor-icon-link" anchorid="section11267105154" tips="复制节点链接"></i></h3>          <p><span><img height="221.03895100000003" originheight="323" originwidth="344" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114546.26066093410487444790058024155844:50001231000000:2800:B707BD1A0E5F10AA622FB87880D71D44D5BC1892C18DD3CAE6A7283A0DB3BC98.png" title="点击放大" width="235.41000000000003"></span></p>     <p>外屏实况窗适用于在小折叠屏的外屏显示实况窗的简要信息，方便用户可以在折叠状态便捷查看。</p>     <p>若开发者创建实况窗时需要同步创建，则需在liveViewManager.<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/liveveiw-liveviewmanager#section411410371767" target="_blank">LiveView</a>（结构体）中携带外屏所需的参数liveViewData.<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/liveveiw-liveviewmanager#section980821010388" target="_blank">external</a>。示例代码如下：</p>     <div _ngcontent-dkp-c106="" class="highlight-div"><div _ngcontent-dkp-c106="" class="highlight-div-header"><div _ngcontent-dkp-c106="" class="highlight-div-header-left"><div _ngcontent-dkp-c106="" class="handle-button expand-button"><div _ngcontent-dkp-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-dkp-c106="" class="highlight-div-header-right"><div _ngcontent-dkp-c106="" class="handle-button ai-button"></div><div _ngcontent-dkp-c106="" class="handle-button line-button"><div _ngcontent-dkp-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-dkp-c106="" class="handle-button theme-button"><div _ngcontent-dkp-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-dkp-c106="" class="handle-button copy-button"><div _ngcontent-dkp-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-dkp-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { liveViewManager } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.LiveViewKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Want</span>, wantAgent } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LiveViewController</span> {</li><li>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">startLiveView</span>(): <span class="hljs-title class_">Promise</span>&lt;liveViewManager.<span class="hljs-property">LiveViewResult</span>&gt; {</li><li>    <span class="hljs-comment">// 校验实况窗开关是否打开</span></li><li>    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">await</span> <span class="hljs-title class_">LiveViewController</span>.<span class="hljs-title function_">isLiveViewEnabled</span>()) {</li><li>      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">"Live view is disabled."</span>);</li><li>    }</li><li>    <span class="hljs-comment">// 创建实况窗</span></li><li>    <span class="hljs-keyword">const</span> defaultView = <span class="hljs-keyword">await</span> <span class="hljs-title class_">LiveViewController</span>.<span class="hljs-title function_">buildDefaultView</span>();</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> liveViewManager.<span class="hljs-title function_">startLiveView</span>(defaultView);</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">buildDefaultView</span>(): <span class="hljs-title class_">Promise</span>&lt;liveViewManager.<span class="hljs-property">LiveView</span>&gt; {</li><li>    <span class="hljs-keyword">return</span> {</li><li>      <span class="hljs-comment">// 构造实况窗请求体</span></li><li>      <span class="hljs-attr">id</span>: <span class="hljs-number">0</span>, <span class="hljs-comment">// 实况窗ID，开发者生成。</span></li><li>      <span class="hljs-attr">event</span>: <span class="hljs-string">"FLIGHT"</span>, <span class="hljs-comment">// 实况窗的应用场景。FLIGHT：航班</span></li><li>      <span class="hljs-attr">liveViewData</span>: {</li><li>        <span class="hljs-attr">primary</span>: {</li><li>          <span class="hljs-attr">title</span>: <span class="hljs-string">"航班XXX 已值机"</span>,</li><li>          <span class="hljs-attr">content</span>: [</li><li>            { <span class="hljs-attr">text</span>: <span class="hljs-string">'登机口'</span>, },</li><li>            { <span class="hljs-attr">text</span>: <span class="hljs-string">'27 17:45'</span>, <span class="hljs-attr">textColor</span>: <span class="hljs-string">'#FFFF9C4F'</span> },</li><li>            { <span class="hljs-attr">text</span>: <span class="hljs-string">'开始登机'</span> }</li><li>          ], <span class="hljs-comment">// 设置textColor字段时，所有拥有textColor字段的对象仅能设置同一种颜色，不设置textColor时，默认展示#FF000000</span></li><li>          <span class="hljs-attr">keepTime</span>: <span class="hljs-number">15</span>,</li><li>          <span class="hljs-attr">clickAction</span>: <span class="hljs-keyword">await</span> <span class="hljs-title class_">LiveViewController</span>.<span class="hljs-title function_">buildWantAgent</span>(),</li><li>          <span class="hljs-attr">layoutData</span>: {</li><li>            <span class="hljs-attr">layoutType</span>: liveViewManager.<span class="hljs-property">LayoutType</span>.<span class="hljs-property">LAYOUT_TYPE_FLIGHT</span>,</li><li>            <span class="hljs-attr">firstTitle</span>: <span class="hljs-string">"18:15"</span>,</li><li>            <span class="hljs-attr">firstContent</span>: <span class="hljs-string">"上海"</span>,</li><li>            <span class="hljs-attr">lastTitle</span>: <span class="hljs-string">"20:30"</span>,</li><li>            <span class="hljs-attr">lastContent</span>: <span class="hljs-string">"成都"</span>,</li><li>            <span class="hljs-attr">spaceIcon</span>: <span class="hljs-string">"icon.png"</span>, <span class="hljs-comment">// 扩展区中间间隔图标，取值为“/resources/rawfile”路径下的文件名或image.</span><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-image-pixelmap" target="_blank"><span class="hljs-comment">PixelMap</span></a></li><li>            <span class="hljs-attr">isHorizontalLineDisplayed</span>: <span class="hljs-literal">true</span>,</li><li>            <span class="hljs-attr">additionalText</span>: <span class="hljs-string">"以上信息仅供参考"</span> <span class="hljs-comment">// 扩展区底部内容，仅可用于左右文本模板</span></li><li>          }</li><li>        },</li><li>        <span class="hljs-attr">external</span>: {</li><li>          <span class="hljs-attr">title</span>: <span class="hljs-string">"已值机"</span>,</li><li>          <span class="hljs-attr">content</span>: [</li><li>            { <span class="hljs-attr">text</span>: <span class="hljs-string">'登机口'</span> },</li><li>            { <span class="hljs-attr">text</span>: <span class="hljs-string">'27\n'</span>, <span class="hljs-attr">textColor</span>: <span class="hljs-string">'#FFFF9C4F'</span> },</li><li>            { <span class="hljs-attr">text</span>: <span class="hljs-string">'17:45'</span>, <span class="hljs-attr">textColor</span>: <span class="hljs-string">'#FFFF9C4F'</span> },</li><li>            { <span class="hljs-attr">text</span>: <span class="hljs-string">'开始登机'</span> }</li><li>          ],</li><li>          <span class="hljs-attr">type</span>: liveViewManager.<span class="hljs-property">ExternalType</span>.<span class="hljs-property">BACKGROUND_PICTURE</span>, <span class="hljs-comment">// 外屏实况的背景样式类型</span></li><li>          <span class="hljs-attr">backgroundPicture</span>: <span class="hljs-string">'airplane.png'</span> <span class="hljs-comment">// 外屏实况的背景图片，取值为“/resources/rawfile”路径下的文件名或image.</span><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-image-pixelmap" target="_blank"><span class="hljs-comment">PixelMap</span></a></li><li>        }</li><li>      }</li><li>    };</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">isLiveViewEnabled</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">boolean</span>&gt; {</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> liveViewManager.<span class="hljs-title function_">isLiveViewEnabled</span>();</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">buildWantAgent</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">Want</span>&gt; {</li><li>    <span class="hljs-keyword">const</span> <span class="hljs-attr">wantAgentInfo</span>: wantAgent.<span class="hljs-property">WantAgentInfo</span> = {</li><li>      <span class="hljs-attr">wants</span>: [</li><li>        {</li><li>          <span class="hljs-attr">bundleName</span>: <span class="hljs-string">'xxx.xxx.xxx'</span>, <span class="hljs-comment">// 应用实际bundleName</span></li><li>          <span class="hljs-attr">abilityName</span>: <span class="hljs-string">'EntryAbility'</span></li><li>        } <span class="hljs-keyword">as</span> <span class="hljs-title class_">Want</span></li><li>      ],</li><li>      <span class="hljs-attr">actionType</span>: wantAgent.<span class="hljs-property">OperationType</span>.<span class="hljs-property">START_ABILITIES</span>,</li><li>      <span class="hljs-attr">requestCode</span>: <span class="hljs-number">0</span>,</li><li>      <span class="hljs-attr">actionFlags</span>: [wantAgent.<span class="hljs-property">WantAgentFlags</span>.<span class="hljs-property">UPDATE_PRESENT_FLAG</span>]</li><li>    };</li><li>    <span class="hljs-keyword">const</span> agent = <span class="hljs-keyword">await</span> wantAgent.<span class="hljs-title function_">getWantAgent</span>(wantAgentInfo);</li><li>    <span class="hljs-keyword">return</span> agent;</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="section173301760411">实况窗计时器<i class="anchor-icon anchor-icon-link" anchorid="section173301760411" tips="复制节点链接"></i></h3>          <p>实况窗计时器适用于排队、抢票等场景。</p>     <p>开发者若需要使用实况窗计时器，则需在liveViewManager.<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/liveveiw-liveviewmanager#section411410371767" target="_blank">LiveView</a>（结构体）中配置<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/liveveiw-liveviewmanager#section411410371767" target="_blank">timer</a>字段，并在当前支持的字段中使用占位符：<strong>${placeholder.timer}</strong>。</p>     <p>例如：固定区的文本内容中使用占位符，系统将替代占位符为实况窗计时器。</p>     <p><span><img height="178.208429" originheight="268" originwidth="615" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114546.88018253318739444375398049078933:50001231000000:2800:7C73215450B581C28F5899063C0AB6DD9D98D264C315B85C61142F1937226778.png" title="点击放大" width="408.975"></span></p>     <p></p>     <p>示例代码如下：</p>     <div class="p">      构建LiveViewController后，请在代码中初始化LiveViewController并调用LiveViewController.startLiveView()方法。      <div _ngcontent-dkp-c106="" class="highlight-div"><div _ngcontent-dkp-c106="" class="highlight-div-header"><div _ngcontent-dkp-c106="" class="highlight-div-header-left"><div _ngcontent-dkp-c106="" class="handle-button expand-button"><div _ngcontent-dkp-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-dkp-c106="" class="highlight-div-header-right"><div _ngcontent-dkp-c106="" class="handle-button ai-button"></div><div _ngcontent-dkp-c106="" class="handle-button line-button"><div _ngcontent-dkp-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-dkp-c106="" class="handle-button theme-button"><div _ngcontent-dkp-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-dkp-c106="" class="handle-button copy-button"><div _ngcontent-dkp-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-dkp-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { liveViewManager } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.LiveViewKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Want</span>, wantAgent } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LiveViewController</span> {</li><li>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">startLiveView</span>(): <span class="hljs-title class_">Promise</span>&lt;liveViewManager.<span class="hljs-property">LiveViewResult</span>&gt; {</li><li>    <span class="hljs-comment">// 校验实况窗开关是否打开</span></li><li>    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">await</span> <span class="hljs-title class_">LiveViewController</span>.<span class="hljs-title function_">isLiveViewEnabled</span>()) {</li><li>      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">"Live view is disabled."</span>);</li><li>    }</li><li>    <span class="hljs-comment">// 创建实况窗</span></li><li>    <span class="hljs-keyword">const</span> defaultView = <span class="hljs-keyword">await</span> <span class="hljs-title class_">LiveViewController</span>.<span class="hljs-title function_">buildDefaultView</span>();</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> liveViewManager.<span class="hljs-title function_">startLiveView</span>(defaultView);</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">buildDefaultView</span>(): <span class="hljs-title class_">Promise</span>&lt;liveViewManager.<span class="hljs-property">LiveView</span>&gt; {</li><li>    <span class="hljs-keyword">return</span> {</li><li>      <span class="hljs-comment">// 构造实况窗请求体</span></li><li>      <span class="hljs-attr">id</span>: <span class="hljs-number">0</span>, <span class="hljs-comment">// 实况窗ID，开发者生成。</span></li><li>      <span class="hljs-attr">event</span>: <span class="hljs-string">"QUEUE"</span>, <span class="hljs-comment">// 实况窗的应用场景。QUEUE：排队</span></li><li>      <span class="hljs-attr">timer</span>: {</li><li>        <span class="hljs-attr">time</span>: <span class="hljs-number">620000</span>,</li><li>        <span class="hljs-attr">isCountdown</span>: <span class="hljs-literal">false</span>,</li><li>        <span class="hljs-attr">isPaused</span>: <span class="hljs-literal">false</span></li><li>      },</li><li>      <span class="hljs-attr">liveViewData</span>: {</li><li>        <span class="hljs-attr">primary</span>: {</li><li>          <span class="hljs-attr">title</span>: <span class="hljs-string">"大桌4人等位  32桌"</span>,</li><li>          <span class="hljs-attr">content</span>: [</li><li>            { <span class="hljs-attr">text</span>: <span class="hljs-string">"已等待 "</span> }, </li><li>            { <span class="hljs-attr">text</span>: <span class="hljs-string">"${placeholder.timer}"</span>, <span class="hljs-attr">textColor</span>:<span class="hljs-string">"#ff10c1f7"</span> },</li><li>            { <span class="hljs-attr">text</span>: <span class="hljs-string">" | 预计还需&gt;30分钟"</span> }</li><li>          ], <span class="hljs-comment">// 设置textColor字段时，所有拥有textColor字段的对象仅能设置同一种颜色，不设置textColor时，默认展示#FF000000</span></li><li>          <span class="hljs-attr">keepTime</span>: <span class="hljs-number">15</span>,</li><li>          <span class="hljs-attr">clickAction</span>: <span class="hljs-keyword">await</span> <span class="hljs-title class_">LiveViewController</span>.<span class="hljs-title function_">buildWantAgent</span>(),</li><li>          <span class="hljs-attr">layoutData</span>: {</li><li>            <span class="hljs-attr">layoutType</span>: liveViewManager.<span class="hljs-property">LayoutType</span>.<span class="hljs-property">LAYOUT_TYPE_PROGRESS</span>,</li><li>            <span class="hljs-attr">progress</span>: <span class="hljs-number">0</span>,</li><li>            <span class="hljs-attr">color</span>: <span class="hljs-string">"#FFFF0000"</span>,</li><li>            <span class="hljs-attr">backgroundColor</span>: <span class="hljs-string">"#FF000000"</span>,</li><li>            <span class="hljs-attr">indicatorType</span>: liveViewManager.<span class="hljs-property">IndicatorType</span>.<span class="hljs-property">INDICATOR_TYPE_OVERLAY</span>,</li><li>            <span class="hljs-attr">indicatorIcon</span>: <span class="hljs-string">"indicator.png"</span>, <span class="hljs-comment">// 进度条指示器图标，取值为“/resources/rawfile”路径下的文件名或image.</span><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-image-pixelmap" target="_blank"><span class="hljs-comment">PixelMap</span></a></li><li>            <span class="hljs-attr">lineType</span>: liveViewManager.<span class="hljs-property">LineType</span>.<span class="hljs-property">LINE_TYPE_DOTTED_LINE</span>,</li><li>            <span class="hljs-attr">nodeIcons</span>: [<span class="hljs-string">"icon_1.png"</span>,<span class="hljs-string">"icon_2.png"</span>] <span class="hljs-comment">// 进度条节点图标集合，每个元素取值为“/resources/rawfile”路径下的文件名或image.</span><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-image-pixelmap" target="_blank"><span class="hljs-comment">PixelMap</span></a></li><li>          }</li><li>        }</li><li>      }</li><li>    };</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">isLiveViewEnabled</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">boolean</span>&gt; {</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> liveViewManager.<span class="hljs-title function_">isLiveViewEnabled</span>();</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">buildWantAgent</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">Want</span>&gt; {</li><li>    <span class="hljs-keyword">const</span> <span class="hljs-attr">wantAgentInfo</span>: wantAgent.<span class="hljs-property">WantAgentInfo</span> = {</li><li>      <span class="hljs-attr">wants</span>: [</li><li>        {</li><li>          <span class="hljs-attr">bundleName</span>: <span class="hljs-string">'xxx.xxx.xxx'</span>, <span class="hljs-comment">// 应用实际bundleName</span></li><li>          <span class="hljs-attr">abilityName</span>: <span class="hljs-string">'EntryAbility'</span></li><li>        } <span class="hljs-keyword">as</span> <span class="hljs-title class_">Want</span></li><li>      ],</li><li>      <span class="hljs-attr">actionType</span>: wantAgent.<span class="hljs-property">OperationType</span>.<span class="hljs-property">START_ABILITIES</span>,</li><li>      <span class="hljs-attr">requestCode</span>: <span class="hljs-number">0</span>,</li><li>      <span class="hljs-attr">actionFlags</span>: [wantAgent.<span class="hljs-property">WantAgentFlags</span>.<span class="hljs-property">UPDATE_PRESENT_FLAG</span>]</li><li>    };</li><li>    <span class="hljs-keyword">const</span> agent = <span class="hljs-keyword">await</span> wantAgent.<span class="hljs-title function_">getWantAgent</span>(wantAgentInfo);</li><li>    <span class="hljs-keyword">return</span> agent;</li><li>  }</li><li>}</li></ol></pre></div></div>     </div>    </div>    <div class="tiledSection">     <h3 id="section25952751613">点击实况窗动作<i class="anchor-icon anchor-icon-link" anchorid="section25952751613" tips="复制节点链接"></i></h3>          <p>请调用<span>wantAgent.<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-wantagent#wantagentgetwantagent-1" target="_blank">getWantAgent</a>()</span>构造点击动作字段所需的参数值，当前实况窗支持的点击动作如下：</p>     <ul>      <li>点击实况窗的默认动作：在liveViewManager.<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/liveveiw-liveviewmanager#section411410371767" target="_blank">LiveView</a>（结构体）中携带胶囊所需的参数liveViewData.primary.<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/liveveiw-liveviewmanager#section452772611408" target="_blank">clickAction</a>字段。</li>      <li>点击辅助区的跳转动作：在liveViewManager.<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/liveveiw-liveviewmanager#section411410371767" target="_blank">LiveView</a>（结构体）中携带胶囊所需的参数liveViewData.primary.extensionData.<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/liveveiw-liveviewmanager#section14934174734616" target="_blank">clickAction</a>字段。</li>     </ul>    </div>    <div class="tiledSection">     <h2 id="section3554203502815">本地更新和结束实况窗<i class="anchor-icon anchor-icon-link" anchorid="section3554203502815" tips="复制节点链接"></i></h2>          <p>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/liveveiw-liveviewmanager#section19741144281410" target="_blank">liveViewManager.isLiveViewEnabled</a>()确认实况窗开关打开后，调用liveViewManager的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/liveveiw-liveviewmanager#section1310319579406" target="_blank">updateLiveView</a>更新实况窗，调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/liveveiw-liveviewmanager#section929145112243" target="_blank">stopLiveView</a>结束实况窗。更新时需要修改请求体中对应的参数。示例代码如下：</p>     <div _ngcontent-dkp-c106="" class="highlight-div"><div _ngcontent-dkp-c106="" class="highlight-div-header"><div _ngcontent-dkp-c106="" class="highlight-div-header-left"><div _ngcontent-dkp-c106="" class="handle-button expand-button"><div _ngcontent-dkp-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-dkp-c106="" class="highlight-div-header-right"><div _ngcontent-dkp-c106="" class="handle-button ai-button"></div><div _ngcontent-dkp-c106="" class="handle-button line-button"><div _ngcontent-dkp-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-dkp-c106="" class="handle-button theme-button"><div _ngcontent-dkp-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-dkp-c106="" class="handle-button copy-button"><div _ngcontent-dkp-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-dkp-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { liveViewManager } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.LiveViewKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Want</span>, wantAgent } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LiveViewController</span> {</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-attr">contentColor</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'#FF000000'</span>;</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-attr">capsuleColor</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'#FF308977'</span>;</li><li>
</li><li>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">startLiveView</span>(): <span class="hljs-title class_">Promise</span>&lt;liveViewManager.<span class="hljs-property">LiveViewResult</span>&gt; {</li><li>    <span class="hljs-comment">// 校验实况窗开关是否打开</span></li><li>    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">await</span> <span class="hljs-title class_">LiveViewController</span>.<span class="hljs-title function_">isLiveViewEnabled</span>()) {</li><li>      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">"Live view is disabled."</span>);</li><li>    }</li><li>    <span class="hljs-comment">// 创建实况窗</span></li><li>    <span class="hljs-keyword">const</span> defaultView = <span class="hljs-keyword">await</span> <span class="hljs-title class_">LiveViewController</span>.<span class="hljs-title function_">buildDefaultView</span>();</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> liveViewManager.<span class="hljs-title function_">startLiveView</span>(defaultView);</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">updateLiveView</span>(): <span class="hljs-title class_">Promise</span>&lt;liveViewManager.<span class="hljs-property">LiveViewResult</span>&gt; {</li><li>    <span class="hljs-comment">// 校验实况窗开关是否打开</span></li><li>    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">await</span> <span class="hljs-title class_">LiveViewController</span>.<span class="hljs-title function_">isLiveViewEnabled</span>()) {</li><li>      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">"Live view is disabled."</span>);</li><li>    }</li><li>    <span class="hljs-comment">// 修改实况窗内容</span></li><li>    <span class="hljs-keyword">const</span> defaultView = <span class="hljs-keyword">await</span> <span class="hljs-title class_">LiveViewController</span>.<span class="hljs-title function_">buildDefaultView</span>();</li><li>    defaultView.<span class="hljs-property">liveViewData</span>.<span class="hljs-property">primary</span>.<span class="hljs-property">title</span> = <span class="hljs-string">"预计23:49送达"</span>;</li><li>    defaultView.<span class="hljs-property">liveViewData</span>.<span class="hljs-property">primary</span>.<span class="hljs-property">content</span> = [</li><li>      { <span class="hljs-attr">text</span>: <span class="hljs-string">"等待商家接单， "</span> },</li><li>      { <span class="hljs-attr">text</span>: <span class="hljs-string">"03:20"</span>, <span class="hljs-attr">textColor</span>: <span class="hljs-string">"#FFFF9C4F"</span> },</li><li>      { <span class="hljs-attr">text</span>: <span class="hljs-string">" 未接单自动取消"</span> },</li><li>    ];</li><li>    defaultView.<span class="hljs-property">liveViewData</span>.<span class="hljs-property">primary</span>.<span class="hljs-property">layoutData</span> = {</li><li>      <span class="hljs-attr">layoutType</span>: liveViewManager.<span class="hljs-property">LayoutType</span>.<span class="hljs-property">LAYOUT_TYPE_PROGRESS</span>,</li><li>      <span class="hljs-attr">progress</span>: <span class="hljs-number">0</span>,</li><li>      <span class="hljs-attr">lineType</span>: <span class="hljs-number">0</span>,</li><li>      <span class="hljs-attr">nodeIcons</span>: [</li><li>        <span class="hljs-string">'icon_store_white.png'</span>,</li><li>        <span class="hljs-string">'icon_finish.png'</span></li><li>      ] <span class="hljs-comment">// 进度条节点图标集合，每个元素取值为“/resources/rawfile”路径下的文件名或image.</span><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-image-pixelmap" target="_blank"><span class="hljs-comment">PixelMap</span></a></li><li>    };</li><li>    defaultView.<span class="hljs-property">liveViewData</span>.<span class="hljs-property">capsule</span> = {</li><li>      <span class="hljs-attr">type</span>: liveViewManager.<span class="hljs-property">CapsuleType</span>.<span class="hljs-property">CAPSULE_TYPE_TEXT</span>,</li><li>      <span class="hljs-attr">status</span>: <span class="hljs-number">1</span>,</li><li>      <span class="hljs-attr">icon</span>: <span class="hljs-string">'capsule_store.png'</span>, <span class="hljs-comment">// 实况胶囊的图标，取值为“/resources/rawfile”路径下的文件名或image.</span><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-image-pixelmap" target="_blank"><span class="hljs-comment">PixelMap</span></a></li><li>      <span class="hljs-attr">backgroundColor</span>: <span class="hljs-title class_">LiveViewController</span>.<span class="hljs-property">capsuleColor</span>,</li><li>      <span class="hljs-attr">title</span>: <span class="hljs-string">"待接单"</span></li><li>    };</li><li>    <span class="hljs-comment">// 更新实况窗</span></li><li>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> liveViewManager.<span class="hljs-title function_">updateLiveView</span>(defaultView);</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">stopLiveView</span>(): <span class="hljs-title class_">Promise</span>&lt;liveViewManager.<span class="hljs-property">LiveViewResult</span>&gt; {</li><li>    <span class="hljs-comment">// 校验实况窗开关是否打开</span></li><li>    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">await</span> <span class="hljs-title class_">LiveViewController</span>.<span class="hljs-title function_">isLiveViewEnabled</span>()) {</li><li>      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">"Live view is disabled."</span>);</li><li>    }</li><li>    <span class="hljs-comment">// 修改实况窗内容</span></li><li>    <span class="hljs-keyword">const</span> defaultView = <span class="hljs-keyword">await</span> <span class="hljs-title class_">LiveViewController</span>.<span class="hljs-title function_">buildDefaultView</span>();</li><li>    defaultView.<span class="hljs-property">liveViewData</span>.<span class="hljs-property">primary</span>.<span class="hljs-property">title</span> = <span class="hljs-string">'商品已送达'</span>;</li><li>    defaultView.<span class="hljs-property">liveViewData</span>.<span class="hljs-property">primary</span>.<span class="hljs-property">content</span> = [</li><li>      { <span class="hljs-attr">text</span>: <span class="hljs-string">'感谢您的认可,'</span> },</li><li>      { <span class="hljs-attr">text</span>: <span class="hljs-string">'期待下一次光临'</span> }</li><li>    ];</li><li>    defaultView.<span class="hljs-property">liveViewData</span>.<span class="hljs-property">primary</span>.<span class="hljs-property">layoutData</span> = {</li><li>      <span class="hljs-attr">layoutType</span>: liveViewManager.<span class="hljs-property">LayoutType</span>.<span class="hljs-property">LAYOUT_TYPE_PROGRESS</span>,</li><li>      <span class="hljs-attr">progress</span>: <span class="hljs-number">100</span>,</li><li>      <span class="hljs-attr">lineType</span>: <span class="hljs-number">0</span>,</li><li>      <span class="hljs-attr">nodeIcons</span>: [</li><li>        <span class="hljs-string">'icon_order.png'</span>,</li><li>        <span class="hljs-string">'icon_finish.png'</span></li><li>      ] <span class="hljs-comment">// 进度条节点图标集合，每个元素取值为“/resources/rawfile”路径下的文件名或image.</span><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-image-pixelmap" target="_blank"><span class="hljs-comment">PixelMap</span></a></li><li>    };</li><li>    defaultView.<span class="hljs-property">liveViewData</span>.<span class="hljs-property">capsule</span> = {</li><li>      <span class="hljs-attr">type</span>: liveViewManager.<span class="hljs-property">CapsuleType</span>.<span class="hljs-property">CAPSULE_TYPE_TEXT</span>,</li><li>      <span class="hljs-attr">status</span>: <span class="hljs-number">1</span>,</li><li>      <span class="hljs-attr">icon</span>: <span class="hljs-string">'capsule_gps.png'</span>, <span class="hljs-comment">// 实况胶囊的图标，取值为“/resources/rawfile”路径下的文件名或image.</span><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-image-pixelmap" target="_blank"><span class="hljs-comment">PixelMap</span></a></li><li>      <span class="hljs-attr">backgroundColor</span>: <span class="hljs-title class_">LiveViewController</span>.<span class="hljs-property">capsuleColor</span>,</li><li>      <span class="hljs-attr">title</span>: <span class="hljs-string">'已送达'</span></li><li>    };</li><li>    <span class="hljs-comment">// 结束实况窗</span></li><li>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> liveViewManager.<span class="hljs-title function_">stopLiveView</span>(defaultView);</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">buildDefaultView</span>(): <span class="hljs-title class_">Promise</span>&lt;liveViewManager.<span class="hljs-property">LiveView</span>&gt; {</li><li>    <span class="hljs-keyword">return</span> {</li><li>      <span class="hljs-comment">// 构造实况窗请求体</span></li><li>      <span class="hljs-attr">id</span>: <span class="hljs-number">0</span>, <span class="hljs-comment">// 实况窗ID，开发者生成。</span></li><li>      <span class="hljs-attr">event</span>: <span class="hljs-string">"DELIVERY"</span>, <span class="hljs-comment">// 实况窗的应用场景。DELIVERY：即时配送（外卖、生鲜）</span></li><li>      <span class="hljs-attr">liveViewData</span>: {</li><li>        <span class="hljs-attr">primary</span>: {</li><li>          <span class="hljs-attr">title</span>: <span class="hljs-string">"餐品待支付"</span>,</li><li>          <span class="hljs-attr">content</span>: [</li><li>            { <span class="hljs-attr">text</span>: <span class="hljs-string">"咖啡 "</span>, <span class="hljs-attr">textColor</span>: <span class="hljs-string">"#FF0A59F7"</span> },</li><li>            { <span class="hljs-attr">text</span>: <span class="hljs-string">"等2件商品"</span> }</li><li>          ],</li><li>          <span class="hljs-attr">keepTime</span>: <span class="hljs-number">15</span>,</li><li>          <span class="hljs-attr">clickAction</span>: <span class="hljs-keyword">await</span> <span class="hljs-title class_">LiveViewController</span>.<span class="hljs-title function_">buildWantAgent</span>(),</li><li>          <span class="hljs-attr">layoutData</span>: {</li><li>            <span class="hljs-attr">layoutType</span>: liveViewManager.<span class="hljs-property">LayoutType</span>.<span class="hljs-property">LAYOUT_TYPE_PICKUP</span>,</li><li>            <span class="hljs-attr">title</span>: <span class="hljs-string">"待支付金额"</span>,</li><li>            <span class="hljs-attr">content</span>: <span class="hljs-string">"25.5元"</span>,</li><li>            <span class="hljs-attr">underlineColor</span>: <span class="hljs-string">"#FF0A59F7"</span>,</li><li>            <span class="hljs-attr">descPic</span>: <span class="hljs-string">"coffee.png"</span> <span class="hljs-comment">// 扩展区右侧产品描述图，取值为“/resources/rawfile”路径下的文件名或image.</span><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-image-pixelmap" target="_blank"><span class="hljs-comment">PixelMap</span></a></li><li>          }</li><li>        },</li><li>        <span class="hljs-comment">// 实况胶囊相关参数</span></li><li>        <span class="hljs-attr">capsule</span>: {</li><li>          <span class="hljs-attr">type</span>: liveViewManager.<span class="hljs-property">CapsuleType</span>.<span class="hljs-property">CAPSULE_TYPE_TEXT</span>,</li><li>          <span class="hljs-attr">status</span>: <span class="hljs-number">1</span>,</li><li>          <span class="hljs-attr">icon</span>: <span class="hljs-string">"capsule_store.png"</span>, <span class="hljs-comment">// 实况胶囊的图标，取值为“/resources/rawfile”路径下的文件名或image.</span><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-image-pixelmap" target="_blank"><span class="hljs-comment">PixelMap</span></a></li><li>          <span class="hljs-attr">backgroundColor</span>: <span class="hljs-string">"#FF308977"</span>,</li><li>          <span class="hljs-attr">title</span>: <span class="hljs-string">"待支付"</span></li><li>        }</li><li>      }</li><li>    };</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">isLiveViewEnabled</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">boolean</span>&gt; {</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> liveViewManager.<span class="hljs-title function_">isLiveViewEnabled</span>();</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">buildWantAgent</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">Want</span>&gt; {</li><li>    <span class="hljs-keyword">const</span> <span class="hljs-attr">wantAgentInfo</span>: wantAgent.<span class="hljs-property">WantAgentInfo</span> = {</li><li>      <span class="hljs-attr">wants</span>: [</li><li>        {</li><li>          <span class="hljs-attr">bundleName</span>: <span class="hljs-string">'xxx.xxx.xxx'</span>, <span class="hljs-comment">// 应用实际bundleName</span></li><li>          <span class="hljs-attr">abilityName</span>: <span class="hljs-string">'EntryAbility'</span></li><li>        } <span class="hljs-keyword">as</span> <span class="hljs-title class_">Want</span></li><li>      ],</li><li>      <span class="hljs-attr">actionType</span>: wantAgent.<span class="hljs-property">OperationType</span>.<span class="hljs-property">START_ABILITIES</span>,</li><li>      <span class="hljs-attr">requestCode</span>: <span class="hljs-number">0</span>,</li><li>      <span class="hljs-attr">actionFlags</span>: [wantAgent.<span class="hljs-property">WantAgentFlags</span>.<span class="hljs-property">UPDATE_PRESENT_FLAG</span>]</li><li>    };</li><li>    <span class="hljs-keyword">const</span> agent = <span class="hljs-keyword">await</span> wantAgent.<span class="hljs-title function_">getWantAgent</span>(wantAgentInfo);</li><li>    <span class="hljs-keyword">return</span> agent;</li><li>  }</li><li>}</li></ol></pre></div></div>     <p>更详细的参数请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/liveview-arkts" target="_blank">Live View Kit ArkTS API参考</a>。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>以上是应用在本地创建、更新和结束实况窗通知的全部流程。此外，应用也可以通过Push Kit实现远程<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/push-update-liveview" target="_blank">创建、更新和结束实况窗消息</a>。</p>      </div></div></div>    </div>   </div>   <div></div></div>