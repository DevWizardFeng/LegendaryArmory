<h1 _ngcontent-kkn-c119="" class="doc-title ng-star-inserted" title="构造函数"> 构造函数 </h1>

<div _ngcontent-kkn-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div><div class="tiledSection"><h2 id="section26440mcpsimp">功能说明<i class="anchor-icon anchor-icon-link" anchorid="section26440mcpsimp" tips="复制节点链接"></i></h2><p>构造用来管理全局内存和同步的TPipe对象。</p> </div> <div class="tiledSection"><h2 id="section26443mcpsimp">函数原型<i class="anchor-icon anchor-icon-link" anchorid="section26443mcpsimp" tips="复制节点链接"></i></h2><div _ngcontent-kkn-c106="" class="highlight-div"><div _ngcontent-kkn-c106="" class="highlight-div-header"><div _ngcontent-kkn-c106="" class="highlight-div-header-left"><div _ngcontent-kkn-c106="" class="handle-button expand-button"><div _ngcontent-kkn-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kkn-c106="" class="highlight-div-header-right"><div _ngcontent-kkn-c106="" class="handle-button ai-button"></div><div _ngcontent-kkn-c106="" class="handle-button line-button"><div _ngcontent-kkn-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kkn-c106="" class="handle-button theme-button"><div _ngcontent-kkn-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kkn-c106="" class="handle-button copy-button"><div _ngcontent-kkn-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kkn-c106="" class="highlight-scroll-div"><pre class="cpp prettyprint linenums hljs language-cpp" hw-language="cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-function">__aicore__ <span class="hljs-keyword">inline</span> <span class="hljs-title">TPipe</span><span class="hljs-params">()</span></span></li></ol></pre></div></div> </div> <div class="tiledSection"><h2 id="section26446mcpsimp">支持的型号<i class="anchor-icon anchor-icon-link" anchorid="section26446mcpsimp" tips="复制节点链接"></i></h2><p>Kirin9020系列处理器</p> <p>KirinX90系列处理器</p> </div> <div class="tiledSection"><h2 id="section26454mcpsimp">注意事项<i class="anchor-icon anchor-icon-link" anchorid="section26454mcpsimp" tips="复制节点链接"></i></h2><ul><li>避免TPipe在对象内创建和初始化，TPipe在对象内创建时，可能会影响编译器对对象内常量的优化，引起scalar性能劣化。</li><li>TPipe对象同一时刻全局只能存在一份，同时定义多个TPipe对象，会出现卡顿等随机行为。如果需要使用多个TPipe时，请先调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/cannkit-destroy">Destroy</a>接口释放前一个TPipe。</li></ul> </div> <div class="tiledSection"><h2 id="section26460mcpsimp">返回值<i class="anchor-icon anchor-icon-link" anchorid="section26460mcpsimp" tips="复制节点链接"></i></h2><p>无</p> </div> <div class="tiledSection"><h2 id="section26463mcpsimp">调用示例<i class="anchor-icon anchor-icon-link" anchorid="section26463mcpsimp" tips="复制节点链接"></i></h2><div _ngcontent-kkn-c106="" class="highlight-div"><div _ngcontent-kkn-c106="" class="highlight-div-header"><div _ngcontent-kkn-c106="" class="highlight-div-header-left"><div _ngcontent-kkn-c106="" class="handle-button expand-button"><div _ngcontent-kkn-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kkn-c106="" class="highlight-div-header-right"><div _ngcontent-kkn-c106="" class="handle-button ai-button"></div><div _ngcontent-kkn-c106="" class="handle-button line-button"><div _ngcontent-kkn-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kkn-c106="" class="handle-button theme-button"><div _ngcontent-kkn-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kkn-c106="" class="handle-button copy-button"><div _ngcontent-kkn-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kkn-c106="" class="highlight-scroll-div"><pre class="cpp prettyprint linenums hljs language-cpp" hw-language="cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">template</span> &lt;<span class="hljs-keyword">typename</span> ComputeT&gt; <span class="hljs-keyword">class</span> <span class="hljs-title class_">KernelExample</span> { </li><li><span class="hljs-keyword">public</span>: </li><li>    <span class="hljs-function">__aicore__ <span class="hljs-keyword">inline</span> <span class="hljs-title">KernelExample</span><span class="hljs-params">()</span> </span>{} </li><li>    <span class="hljs-function">__aicore__ <span class="hljs-keyword">inline</span> <span class="hljs-type">void</span> <span class="hljs-title">Init</span><span class="hljs-params">(..., TPipe* pipeIn)</span> </span></li><li><span class="hljs-function">    </span>{ </li><li>        <span class="hljs-comment">// ... </span></li><li>        pipe = pipeIn; </li><li>        pipe-&gt;<span class="hljs-built_in">InitBuffer</span>(xxxBuf, BUFFER_NUM, xxxSize); </li><li>        <span class="hljs-comment">// ... </span></li><li>    } </li><li><span class="hljs-keyword">private</span>: </li><li>    <span class="hljs-comment">// ... </span></li><li>    TPipe* pipe; </li><li>    <span class="hljs-comment">// ... </span></li><li>}; </li><li><span class="hljs-keyword">extern</span> <span class="hljs-string">"C"</span> <span class="hljs-function">__global__ __aicore__ <span class="hljs-type">void</span> <span class="hljs-title">example_kernel</span><span class="hljs-params">(...)</span> </span>{ </li><li>    <span class="hljs-comment">// ... </span></li><li>    TPipe pipe; </li><li>    KernelExample&lt;<span class="hljs-type">float</span>&gt; op; </li><li>    op.<span class="hljs-built_in">Init</span>(..., &amp;pipe); </li><li>    <span class="hljs-comment">// ... </span></li><li>}</li></ol></pre></div></div> </div> </div> <div></div></div>