<h1 _ngcontent-xqh-c119="" class="doc-title ng-star-inserted" title="查询需要用户认证的关键资产(ArkTS)"> 查询需要用户认证的关键资产(ArkTS) </h1>

<div _ngcontent-xqh-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <div class="tiledSection">     <h2 id="接口介绍">接口介绍<i class="anchor-icon anchor-icon-link" anchorid="接口介绍" tips="复制节点链接"></i></h2>          <p>可通过API文档查看此功能的相关接口：</p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.1.3.1.4.1.1" valign="top" width="33.33333333333333%">异步接口</th>         <th align="left" class="cellrowborder" id="mcps1.3.1.3.1.4.1.2" valign="top" width="33.33333333333333%">同步接口</th>         <th align="left" class="cellrowborder" id="mcps1.3.1.3.1.4.1.3" valign="top" width="33.33333333333333%">说明</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-asset#assetprequery" target="_blank">preQuery(query: AssetMap)</a></td>         <td class="cellrowborder" valign="top" width="33.33333333333333%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-asset#assetprequerysync12" target="_blank">preQuerySync(query: AssetMap)</a></td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">查询预处理。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-asset#assetquery" target="_blank">query(query: AssetMap)</a></td>         <td class="cellrowborder" valign="top" width="33.33333333333333%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-asset#assetquerysync12" target="_blank">querySync(query: AssetMap)</a></td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">查询关键资产。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-asset#assetpostquery" target="_blank">postQuery(handle: AssetMap)</a></td>         <td class="cellrowborder" valign="top" width="33.33333333333333%"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-asset#assetpostquerysync12" target="_blank">postQuerySync(handle: AssetMap)</a></td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">查询后置处理。</td>        </tr>             </tbody></table></div>     </div>     <p>查询需要用户认证的关键资产时，关键资产属性的内容（AssetMap）参数如下表所示：</p>     <div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content">       <p>下表中“ALIAS”和名称包含“DATA_LABEL”的关键资产属性，用于存储业务自定义信息，其内容不会被加密，请勿存放敏感个人数据。</p>      </div></div></div>     <ul>      <li>       <p><strong>preQuery参数列表</strong></p>       <div class="tablenoborder">        <div class="tbBox"><table class="layoutFixed idpTab">         <thead>          <tr>           <th align="left" class="cellrowborder" id="mcps1.3.1.6.1.2.1.5.1.1" valign="top" width="25%">属性名称（Tag）</th>           <th align="left" class="cellrowborder" id="mcps1.3.1.6.1.2.1.5.1.2" valign="top" width="25%">属性内容（Value）</th>           <th align="left" class="cellrowborder" id="mcps1.3.1.6.1.2.1.5.1.3" valign="top" width="25%">是否必选</th>           <th align="left" class="cellrowborder" id="mcps1.3.1.6.1.2.1.5.1.4" valign="top" width="25%">说明</th>          </tr>         </thead>                   <tbody><tr>           <td class="cellrowborder" valign="top" width="25%">ALIAS</td>           <td class="cellrowborder" valign="top" width="25%">类型为Uint8Array，长度为1-256字节。</td>           <td class="cellrowborder" valign="top" width="25%">可选</td>           <td class="cellrowborder" valign="top" width="25%">关键资产别名，每条关键资产的唯一索引。</td>          </tr>          <tr>           <td class="cellrowborder" valign="top" width="25%">ACCESSIBILITY</td>           <td class="cellrowborder" valign="top" width="25%">类型为number，取值范围详见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-asset#accessibility" target="_blank">Accessibility</a>。</td>           <td class="cellrowborder" valign="top" width="25%">可选</td>           <td class="cellrowborder" valign="top" width="25%">基于锁屏状态的访问控制。</td>          </tr>          <tr>           <td class="cellrowborder" valign="top" width="25%">REQUIRE_PASSWORD_SET</td>           <td class="cellrowborder" valign="top" width="25%">类型为boolean。</td>           <td class="cellrowborder" valign="top" width="25%">可选</td>           <td class="cellrowborder" valign="top" width="25%">是否仅在设置了锁屏密码的情况下，可访问关键资产。为true时表示查询仅用户设置了锁屏密码才允许访问的关键资产；为false时表示查询无论用户是否设置锁屏密码，均可访问的关键资产。</td>          </tr>          <tr>           <td class="cellrowborder" valign="top" width="25%">AUTH_TYPE</td>           <td class="cellrowborder" valign="top" width="25%">类型为number，取值范围详见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-asset#authtype" target="_blank">AuthType</a>。</td>           <td class="cellrowborder" valign="top" width="25%">可选</td>           <td class="cellrowborder" valign="top" width="25%">访问关键资产所需的用户认证类型。</td>          </tr>          <tr>           <td class="cellrowborder" valign="top" width="25%">AUTH_VALIDITY_PERIOD</td>           <td class="cellrowborder" valign="top" width="25%">类型为number，取值范围：1-600，单位为秒。</td>           <td class="cellrowborder" valign="top" width="25%">可选</td>           <td class="cellrowborder" valign="top" width="25%">用户认证的有效期，默认值为60。</td>          </tr>          <tr>           <td class="cellrowborder" valign="top" width="25%">SYNC_TYPE</td>           <td class="cellrowborder" valign="top" width="25%">类型为number，取值范围详见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-asset#synctype" target="_blank">SyncType</a>。</td>           <td class="cellrowborder" valign="top" width="25%">可选</td>           <td class="cellrowborder" valign="top" width="25%">关键资产支持的同步类型。</td>          </tr>          <tr>           <td class="cellrowborder" valign="top" width="25%">IS_PERSISTENT</td>           <td class="cellrowborder" valign="top" width="25%">类型为boolean。</td>           <td class="cellrowborder" valign="top" width="25%">可选</td>           <td class="cellrowborder" valign="top" width="25%">在应用卸载时是否需要保留关键资产。为true时表示查询应用卸载后会被保留的关键资产；为false时表示查询应用卸载后会被删除的关键资产。</td>          </tr>          <tr>           <td class="cellrowborder" valign="top" width="25%">DATA_LABEL_CRITICAL_1</td>           <td class="cellrowborder" valign="top" width="25%">类型为Uint8Array，长度为1-2048字节。</td>           <td class="cellrowborder" valign="top" width="25%">可选</td>           <td class="cellrowborder" valign="top" width="25%">            <p>关键资产附属信息，内容由业务自定义且有完整性保护。</p>            <p><strong>说明：</strong> API12前长度为1-512字节。</p></td>          </tr>          <tr>           <td class="cellrowborder" valign="top" width="25%">DATA_LABEL_CRITICAL_2</td>           <td class="cellrowborder" valign="top" width="25%">类型为Uint8Array，长度为1-2048字节。</td>           <td class="cellrowborder" valign="top" width="25%">可选</td>           <td class="cellrowborder" valign="top" width="25%">            <p>关键资产附属信息，内容由业务自定义且有完整性保护。</p>            <p><strong>说明：</strong> API12前长度为1-512字节。</p></td>          </tr>          <tr>           <td class="cellrowborder" valign="top" width="25%">DATA_LABEL_CRITICAL_3</td>           <td class="cellrowborder" valign="top" width="25%">类型为Uint8Array，长度为1-2048字节。</td>           <td class="cellrowborder" valign="top" width="25%">可选</td>           <td class="cellrowborder" valign="top" width="25%">            <p>关键资产附属信息，内容由业务自定义且有完整性保护。</p>            <p><strong>说明：</strong> API12前长度为1-512字节。</p></td>          </tr>          <tr>           <td class="cellrowborder" valign="top" width="25%">DATA_LABEL_CRITICAL_4</td>           <td class="cellrowborder" valign="top" width="25%">类型为Uint8Array，长度为1-2048字节。</td>           <td class="cellrowborder" valign="top" width="25%">可选</td>           <td class="cellrowborder" valign="top" width="25%">            <p>关键资产附属信息，内容由业务自定义且有完整性保护。</p>            <p><strong>说明：</strong> API12前长度为1-512字节。</p></td>          </tr>          <tr>           <td class="cellrowborder" valign="top" width="25%">DATA_LABEL_NORMAL_1</td>           <td class="cellrowborder" valign="top" width="25%">类型为Uint8Array，长度为1-2048字节。</td>           <td class="cellrowborder" valign="top" width="25%">可选</td>           <td class="cellrowborder" valign="top" width="25%">            <p>关键资产附属信息，内容由业务自定义且无完整性保护。</p>            <p><strong>说明：</strong> API12前长度为1-512字节。</p></td>          </tr>          <tr>           <td class="cellrowborder" valign="top" width="25%">DATA_LABEL_NORMAL_2</td>           <td class="cellrowborder" valign="top" width="25%">类型为Uint8Array，长度为1-2048字节。</td>           <td class="cellrowborder" valign="top" width="25%">可选</td>           <td class="cellrowborder" valign="top" width="25%">            <p>关键资产附属信息，内容由业务自定义且无完整性保护。</p>            <p><strong>说明：</strong> API12前长度为1-512字节。</p></td>          </tr>          <tr>           <td class="cellrowborder" valign="top" width="25%">DATA_LABEL_NORMAL_3</td>           <td class="cellrowborder" valign="top" width="25%">类型为Uint8Array，长度为1-2048字节。</td>           <td class="cellrowborder" valign="top" width="25%">可选</td>           <td class="cellrowborder" valign="top" width="25%">            <p>关键资产附属信息，内容由业务自定义且无完整性保护。</p>            <p><strong>说明：</strong> API12前长度为1-512字节。</p></td>          </tr>          <tr>           <td class="cellrowborder" valign="top" width="25%">DATA_LABEL_NORMAL_4</td>           <td class="cellrowborder" valign="top" width="25%">类型为Uint8Array，长度为1-2048字节。</td>           <td class="cellrowborder" valign="top" width="25%">可选</td>           <td class="cellrowborder" valign="top" width="25%">            <p>关键资产附属信息，内容由业务自定义且无完整性保护。</p>            <p><strong>说明：</strong> API12前长度为1-512字节。</p></td>          </tr>          <tr>           <td class="cellrowborder" valign="top" width="25%">DATA_LABEL_NORMAL_LOCAL_1<sup>12+</sup></td>           <td class="cellrowborder" valign="top" width="25%">类型为Uint8Array，长度为1-2048字节。</td>           <td class="cellrowborder" valign="top" width="25%">可选</td>           <td class="cellrowborder" valign="top" width="25%">关键资产附属的本地信息，内容由业务自定义且无完整性保护，该项信息不会进行同步。</td>          </tr>          <tr>           <td class="cellrowborder" valign="top" width="25%">DATA_LABEL_NORMAL_LOCAL_2<sup>12+</sup></td>           <td class="cellrowborder" valign="top" width="25%">类型为Uint8Array，长度为1-2048字节。</td>           <td class="cellrowborder" valign="top" width="25%">可选</td>           <td class="cellrowborder" valign="top" width="25%">关键资产附属的本地信息，内容由业务自定义且无完整性保护，该项信息不会进行同步。</td>          </tr>          <tr>           <td class="cellrowborder" valign="top" width="25%">DATA_LABEL_NORMAL_LOCAL_3<sup>12+</sup></td>           <td class="cellrowborder" valign="top" width="25%">类型为Uint8Array，长度为1-2048字节。</td>           <td class="cellrowborder" valign="top" width="25%">可选</td>           <td class="cellrowborder" valign="top" width="25%">关键资产附属的本地信息，内容由业务自定义且无完整性保护，该项信息不会进行同步。</td>          </tr>          <tr>           <td class="cellrowborder" valign="top" width="25%">DATA_LABEL_NORMAL_LOCAL_4<sup>12+</sup></td>           <td class="cellrowborder" valign="top" width="25%">类型为Uint8Array，长度为1-2048字节。</td>           <td class="cellrowborder" valign="top" width="25%">可选</td>           <td class="cellrowborder" valign="top" width="25%">关键资产附属的本地信息，内容由业务自定义且无完整性保护，该项信息不会进行同步。</td>          </tr>          <tr>           <td class="cellrowborder" valign="top" width="25%">REQUIRE_ATTR_ENCRYPTED<sup>14+</sup></td>           <td class="cellrowborder" valign="top" width="25%">类型为boolean。</td>           <td class="cellrowborder" valign="top" width="25%">可选</td>           <td class="cellrowborder" valign="top" width="25%">是否查询业务自定义附属信息被加密的数据。为true时表示查询业务自定义附属信息加密存储的数据，为false时表示查询业务自定义附属信息不加密存储的数据。默认值为false。</td>          </tr>          <tr>           <td class="cellrowborder" valign="top" width="25%">GROUP_ID<sup>18+</sup></td>           <td class="cellrowborder" valign="top" width="25%">类型为Uint8Array，长度为7-127字节。</td>           <td class="cellrowborder" valign="top" width="25%">可选</td>           <td class="cellrowborder" valign="top" width="25%">待查询的关键资产所属群组，默认查询不属于任何群组的关键资产。</td>          </tr>                 </tbody></table></div>       </div></li>      <li>       <p><strong>query参数列表</strong></p>       <div class="tablenoborder">        <div class="tbBox"><table class="layoutFixed idpTab">         <thead>          <tr>           <th align="left" class="cellrowborder" id="mcps1.3.1.6.2.2.1.5.1.1" valign="top" width="25%">属性名称（Tag）</th>           <th align="left" class="cellrowborder" id="mcps1.3.1.6.2.2.1.5.1.2" valign="top" width="25%">属性内容（Value）</th>           <th align="left" class="cellrowborder" id="mcps1.3.1.6.2.2.1.5.1.3" valign="top" width="25%">是否必选</th>           <th align="left" class="cellrowborder" id="mcps1.3.1.6.2.2.1.5.1.4" valign="top" width="25%">说明</th>          </tr>         </thead>                   <tbody><tr>           <td class="cellrowborder" valign="top" width="25%">ALIAS</td>           <td class="cellrowborder" valign="top" width="25%">类型为Uint8Array，长度为1-256字节。</td>           <td class="cellrowborder" valign="top" width="25%">必选</td>           <td class="cellrowborder" valign="top" width="25%">关键资产别名，每条关键资产的唯一索引。</td>          </tr>          <tr>           <td class="cellrowborder" valign="top" width="25%">AUTH_CHALLENGE</td>           <td class="cellrowborder" valign="top" width="25%">类型为Uint8Array，长度为32字节。</td>           <td class="cellrowborder" valign="top" width="25%">必选</td>           <td class="cellrowborder" valign="top" width="25%">用户认证的挑战值。</td>          </tr>          <tr>           <td class="cellrowborder" valign="top" width="25%">AUTH_TOKEN</td>           <td class="cellrowborder" valign="top" width="25%">            <p>类型为Uint8Array。</p>            <p>API 20开始：长度为1-1024字节。</p>            <p>API 11-19：长度为148字节。</p></td>           <td class="cellrowborder" valign="top" width="25%">必选</td>           <td class="cellrowborder" valign="top" width="25%">用户认证通过的授权令牌。</td>          </tr>          <tr>           <td class="cellrowborder" valign="top" width="25%">RETURN_TYPE</td>           <td class="cellrowborder" valign="top" width="25%">类型为number，asset.ReturnType.ALL。</td>           <td class="cellrowborder" valign="top" width="25%">必选</td>           <td class="cellrowborder" valign="top" width="25%">关键资产查询返回的结果类型。</td>          </tr>          <tr>           <td class="cellrowborder" valign="top" width="25%">ACCESSIBILITY</td>           <td class="cellrowborder" valign="top" width="25%">类型为number，取值范围详见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-asset#accessibility" target="_blank">Accessibility</a>。</td>           <td class="cellrowborder" valign="top" width="25%">可选</td>           <td class="cellrowborder" valign="top" width="25%">基于锁屏状态的访问控制。</td>          </tr>          <tr>           <td class="cellrowborder" valign="top" width="25%">REQUIRE_PASSWORD_SET</td>           <td class="cellrowborder" valign="top" width="25%">类型为boolean。</td>           <td class="cellrowborder" valign="top" width="25%">可选</td>           <td class="cellrowborder" valign="top" width="25%">是否仅在设置了锁屏密码的情况下，可访问关键资产。为true时表示查询仅用户设置了锁屏密码才允许访问的关键资产；为false时表示查询无论用户是否设置锁屏密码，均可访问的关键资产。</td>          </tr>          <tr>           <td class="cellrowborder" valign="top" width="25%">AUTH_TYPE</td>           <td class="cellrowborder" valign="top" width="25%">类型为number，取值范围详见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-asset#authtype" target="_blank">AuthType</a>。</td>           <td class="cellrowborder" valign="top" width="25%">可选</td>           <td class="cellrowborder" valign="top" width="25%">访问关键资产所需的用户认证类型。</td>          </tr>          <tr>           <td class="cellrowborder" valign="top" width="25%">SYNC_TYPE</td>           <td class="cellrowborder" valign="top" width="25%">类型为number，取值范围详见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-asset#synctype" target="_blank">SyncType</a>。</td>           <td class="cellrowborder" valign="top" width="25%">可选</td>           <td class="cellrowborder" valign="top" width="25%">关键资产支持的同步类型。</td>          </tr>          <tr>           <td class="cellrowborder" valign="top" width="25%">IS_PERSISTENT</td>           <td class="cellrowborder" valign="top" width="25%">类型为boolean。</td>           <td class="cellrowborder" valign="top" width="25%">可选</td>           <td class="cellrowborder" valign="top" width="25%">在应用卸载时是否需要保留关键资产。为true时表示查询应用卸载后会被保留的关键资产；为false时表示查询应用卸载后会被删除的关键资产。</td>          </tr>          <tr>           <td class="cellrowborder" valign="top" width="25%">DATA_LABEL_CRITICAL_1</td>           <td class="cellrowborder" valign="top" width="25%">类型为Uint8Array，长度为1-2048字节。</td>           <td class="cellrowborder" valign="top" width="25%">可选</td>           <td class="cellrowborder" valign="top" width="25%">            <p>关键资产附属信息，内容由业务自定义且有完整性保护。</p>            <p><strong>说明：</strong> API12前长度为1-512字节。</p></td>          </tr>          <tr>           <td class="cellrowborder" valign="top" width="25%">DATA_LABEL_CRITICAL_2</td>           <td class="cellrowborder" valign="top" width="25%">类型为Uint8Array，长度为1-2048字节。</td>           <td class="cellrowborder" valign="top" width="25%">可选</td>           <td class="cellrowborder" valign="top" width="25%">            <p>关键资产附属信息，内容由业务自定义且有完整性保护。</p>            <p><strong>说明：</strong> API12前长度为1-512字节。</p></td>          </tr>          <tr>           <td class="cellrowborder" valign="top" width="25%">DATA_LABEL_CRITICAL_3</td>           <td class="cellrowborder" valign="top" width="25%">类型为Uint8Array，长度为1-2048字节。</td>           <td class="cellrowborder" valign="top" width="25%">可选</td>           <td class="cellrowborder" valign="top" width="25%">            <p>关键资产附属信息，内容由业务自定义且有完整性保护。</p>            <p><strong>说明：</strong> API12前长度为1-512字节。</p></td>          </tr>          <tr>           <td class="cellrowborder" valign="top" width="25%">DATA_LABEL_CRITICAL_4</td>           <td class="cellrowborder" valign="top" width="25%">类型为Uint8Array，长度为1-2048字节。</td>           <td class="cellrowborder" valign="top" width="25%">可选</td>           <td class="cellrowborder" valign="top" width="25%">            <p>关键资产附属信息，内容由业务自定义且有完整性保护。</p>            <p><strong>说明：</strong> API12前长度为1-512字节。</p></td>          </tr>          <tr>           <td class="cellrowborder" valign="top" width="25%">DATA_LABEL_NORMAL_1</td>           <td class="cellrowborder" valign="top" width="25%">类型为Uint8Array，长度为1-2048字节。</td>           <td class="cellrowborder" valign="top" width="25%">可选</td>           <td class="cellrowborder" valign="top" width="25%">            <p>关键资产附属信息，内容由业务自定义且无完整性保护。</p>            <p><strong>说明：</strong> API12前长度为1-512字节。</p></td>          </tr>          <tr>           <td class="cellrowborder" valign="top" width="25%">DATA_LABEL_NORMAL_2</td>           <td class="cellrowborder" valign="top" width="25%">类型为Uint8Array，长度为1-2048字节。</td>           <td class="cellrowborder" valign="top" width="25%">可选</td>           <td class="cellrowborder" valign="top" width="25%">            <p>关键资产附属信息，内容由业务自定义且无完整性保护。</p>            <p><strong>说明：</strong> API12前长度为1-512字节。</p></td>          </tr>          <tr>           <td class="cellrowborder" valign="top" width="25%">DATA_LABEL_NORMAL_3</td>           <td class="cellrowborder" valign="top" width="25%">类型为Uint8Array，长度为1-2048字节。</td>           <td class="cellrowborder" valign="top" width="25%">可选</td>           <td class="cellrowborder" valign="top" width="25%">            <p>关键资产附属信息，内容由业务自定义且无完整性保护。</p>            <p><strong>说明：</strong> API12前长度为1-512字节。</p></td>          </tr>          <tr>           <td class="cellrowborder" valign="top" width="25%">DATA_LABEL_NORMAL_4</td>           <td class="cellrowborder" valign="top" width="25%">类型为Uint8Array，长度为1-2048字节。</td>           <td class="cellrowborder" valign="top" width="25%">可选</td>           <td class="cellrowborder" valign="top" width="25%">            <p>关键资产附属信息，内容由业务自定义且无完整性保护。</p>            <p><strong>说明：</strong> API12前长度为1-512字节。</p></td>          </tr>          <tr>           <td class="cellrowborder" valign="top" width="25%">DATA_LABEL_NORMAL_LOCAL_1<sup>12+</sup></td>           <td class="cellrowborder" valign="top" width="25%">类型为Uint8Array，长度为1-2048字节。</td>           <td class="cellrowborder" valign="top" width="25%">可选</td>           <td class="cellrowborder" valign="top" width="25%">关键资产附属的本地信息，内容由业务自定义且无完整性保护，该项信息不会进行同步。</td>          </tr>          <tr>           <td class="cellrowborder" valign="top" width="25%">DATA_LABEL_NORMAL_LOCAL_2<sup>12+</sup></td>           <td class="cellrowborder" valign="top" width="25%">类型为Uint8Array，长度为1-2048字节。</td>           <td class="cellrowborder" valign="top" width="25%">可选</td>           <td class="cellrowborder" valign="top" width="25%">关键资产附属的本地信息，内容由业务自定义且无完整性保护，该项信息不会进行同步。</td>          </tr>          <tr>           <td class="cellrowborder" valign="top" width="25%">DATA_LABEL_NORMAL_LOCAL_3<sup>12+</sup></td>           <td class="cellrowborder" valign="top" width="25%">类型为Uint8Array，长度为1-2048字节。</td>           <td class="cellrowborder" valign="top" width="25%">可选</td>           <td class="cellrowborder" valign="top" width="25%">关键资产附属的本地信息，内容由业务自定义且无完整性保护，该项信息不会进行同步。</td>          </tr>          <tr>           <td class="cellrowborder" valign="top" width="25%">DATA_LABEL_NORMAL_LOCAL_4<sup>12+</sup></td>           <td class="cellrowborder" valign="top" width="25%">类型为Uint8Array，长度为1-2048字节。</td>           <td class="cellrowborder" valign="top" width="25%">可选</td>           <td class="cellrowborder" valign="top" width="25%">关键资产附属的本地信息，内容由业务自定义且无完整性保护，该项信息不会进行同步。</td>          </tr>          <tr>           <td class="cellrowborder" valign="top" width="25%">REQUIRE_ATTR_ENCRYPTED<sup>14+</sup></td>           <td class="cellrowborder" valign="top" width="25%">类型为boolean。</td>           <td class="cellrowborder" valign="top" width="25%">可选</td>           <td class="cellrowborder" valign="top" width="25%">是否查询业务自定义附属信息被加密的数据。为true时表示查询业务自定义附属信息加密存储的数据，为false时表示查询业务自定义附属信息不加密存储的数据。默认值为false。</td>          </tr>          <tr>           <td class="cellrowborder" valign="top" width="25%">GROUP_ID<sup>18+</sup></td>           <td class="cellrowborder" valign="top" width="25%">类型为Uint8Array，长度为7-127字节。</td>           <td class="cellrowborder" valign="top" width="25%">可选</td>           <td class="cellrowborder" valign="top" width="25%">待查询的关键资产所属群组，默认查询不属于任何群组的关键资产。</td>          </tr>                 </tbody></table></div>       </div></li>      <li>       <p><strong>postQuery参数列表</strong></p>       <div class="tablenoborder">        <div class="tbBox"><table class="layoutFixed idpTab">         <thead>          <tr>           <th align="left" class="cellrowborder" id="mcps1.3.1.6.3.2.1.5.1.1" valign="top" width="25%">属性名称（Tag）</th>           <th align="left" class="cellrowborder" id="mcps1.3.1.6.3.2.1.5.1.2" valign="top" width="25%">属性内容（Value）</th>           <th align="left" class="cellrowborder" id="mcps1.3.1.6.3.2.1.5.1.3" valign="top" width="25%">是否必选</th>           <th align="left" class="cellrowborder" id="mcps1.3.1.6.3.2.1.5.1.4" valign="top" width="25%">说明</th>          </tr>         </thead>                   <tbody><tr>           <td class="cellrowborder" valign="top" width="25%">AUTH_CHALLENGE</td>           <td class="cellrowborder" valign="top" width="25%">类型为Uint8Array，长度为32字节。</td>           <td class="cellrowborder" valign="top" width="25%">必选</td>           <td class="cellrowborder" valign="top" width="25%">用户认证的挑战值。</td>          </tr>          <tr>           <td class="cellrowborder" valign="top" width="25%">GROUP_ID<sup>18+</sup></td>           <td class="cellrowborder" valign="top" width="25%">类型为Uint8Array，长度为7-127字节。</td>           <td class="cellrowborder" valign="top" width="25%">可选</td>           <td class="cellrowborder" valign="top" width="25%">待清理关键资产所属群组，默认清理内存中不属于任何群组的关键资产。</td>          </tr>                 </tbody></table></div>       </div></li>     </ul>    </div>    <div class="tiledSection">     <h2 id="代码示例">代码示例<i class="anchor-icon anchor-icon-link" anchorid="代码示例" tips="复制节点链接"></i></h2>          <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>本模块提供了异步和同步两套接口，以下为异步接口的使用示例，同步接口详见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-asset" target="_blank">API文档</a>。</p>       <p>在查询前，需确保已有需要用户认证的关键资产，可参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/asset-js-add">指南文档</a>新增关键资产，否则将抛出NOT_FOUND错误（错误码24000002）。</p>      </div></div></div>     <p>查询别名是demo_alias且需要用户认证的关键资产。示例中引入的@ohos.userIAM.userAuth用法详见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-useriam-userauth#start10" target="_blank">userAuth文档</a>。</p>     <div _ngcontent-xqh-c106="" class="highlight-div"><div _ngcontent-xqh-c106="" class="highlight-div-header"><div _ngcontent-xqh-c106="" class="highlight-div-header-left"><div _ngcontent-xqh-c106="" class="handle-button expand-button"><div _ngcontent-xqh-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-xqh-c106="" class="highlight-div-header-right"><div _ngcontent-xqh-c106="" class="handle-button ai-button"></div><div _ngcontent-xqh-c106="" class="handle-button line-button"><div _ngcontent-xqh-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-xqh-c106="" class="handle-button theme-button"><div _ngcontent-xqh-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-xqh-c106="" class="handle-button copy-button"><div _ngcontent-xqh-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-xqh-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { asset } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AssetStoreKit'</span>;</li><li><span class="hljs-keyword">import</span> { util } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkTS'</span>;</li><li><span class="hljs-keyword">import</span> { userAuth } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.UserAuthenticationKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">stringToArray</span>(<span class="hljs-params">str: <span class="hljs-built_in">string</span></span>): <span class="hljs-title class_">Uint8Array</span> {</li><li>  <span class="hljs-keyword">let</span> textEncoder = <span class="hljs-keyword">new</span> util.<span class="hljs-title class_">TextEncoder</span>();</li><li>  <span class="hljs-keyword">return</span> textEncoder.<span class="hljs-title function_">encodeInto</span>(str);</li><li>}</li><li>
</li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">arrayToString</span>(<span class="hljs-params">arr: <span class="hljs-built_in">Uint8Array</span></span>): <span class="hljs-built_in">string</span> {</li><li>  <span class="hljs-keyword">let</span> textDecoder = util.<span class="hljs-property">TextDecoder</span>.<span class="hljs-title function_">create</span>(<span class="hljs-string">"utf-8"</span>, { <span class="hljs-attr">ignoreBOM</span>: <span class="hljs-literal">true</span> });</li><li>  <span class="hljs-keyword">let</span> str = textDecoder.<span class="hljs-title function_">decodeToString</span>(arr, { <span class="hljs-attr">stream</span>: <span class="hljs-literal">false</span> })</li><li>  <span class="hljs-keyword">return</span> str;</li><li>}</li><li>
</li><li><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">userAuthenticate</span>(<span class="hljs-params">challenge: <span class="hljs-built_in">Uint8Array</span></span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">Uint8Array</span>&gt; {</li><li>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {</li><li>    <span class="hljs-keyword">const</span> <span class="hljs-attr">authParam</span>: userAuth.<span class="hljs-property">AuthParam</span> = {</li><li>      <span class="hljs-attr">challenge</span>: challenge,</li><li>      <span class="hljs-attr">authType</span>: [userAuth.<span class="hljs-property">UserAuthType</span>.<span class="hljs-property">PIN</span>],</li><li>      <span class="hljs-attr">authTrustLevel</span>: userAuth.<span class="hljs-property">AuthTrustLevel</span>.<span class="hljs-property">ATL1</span>,</li><li>    };</li><li>    <span class="hljs-keyword">const</span> <span class="hljs-attr">widgetParam</span>: userAuth.<span class="hljs-property">WidgetParam</span> = { <span class="hljs-attr">title</span>: <span class="hljs-string">'请输入锁屏密码'</span> };</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-keyword">let</span> userAuthInstance = userAuth.<span class="hljs-title function_">getUserAuthInstance</span>(authParam, widgetParam);</li><li>      userAuthInstance.<span class="hljs-title function_">on</span>(<span class="hljs-string">'result'</span>, {</li><li>        <span class="hljs-title function_">onResult</span>(<span class="hljs-params">result</span>) {</li><li>          <span class="hljs-keyword">if</span> (result.<span class="hljs-property">result</span> == userAuth.<span class="hljs-property">UserAuthResultCode</span>.<span class="hljs-property">SUCCESS</span>) {</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`User identity authentication succeeded.`</span>);</li><li>            <span class="hljs-title function_">resolve</span>(result.<span class="hljs-property">token</span>);</li><li>          } <span class="hljs-keyword">else</span> {</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`User identity authentication failed.`</span>);</li><li>            <span class="hljs-title function_">reject</span>();</li><li>          }</li><li>        }</li><li>      });</li><li>      userAuthInstance.<span class="hljs-title function_">start</span>();</li><li>    } <span class="hljs-keyword">catch</span> (err) {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`User identity authentication failed. Code is <span class="hljs-subst">${err?.code}</span>, message is <span class="hljs-subst">${err?.message}</span>`</span>);</li><li>      <span class="hljs-title function_">reject</span>();</li><li>    }</li><li>  })</li><li>}</li><li>
</li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">preQueryAsset</span>(<span class="hljs-params"></span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">Uint8Array</span>&gt; {</li><li>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">query</span>: asset.<span class="hljs-property">AssetMap</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();</li><li>      query.<span class="hljs-title function_">set</span>(asset.<span class="hljs-property">Tag</span>.<span class="hljs-property">ALIAS</span>, <span class="hljs-title function_">stringToArray</span>(<span class="hljs-string">'demo_alias'</span>));</li><li>      asset.<span class="hljs-title function_">preQuery</span>(query).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">challenge: <span class="hljs-built_in">Uint8Array</span></span>) =&gt;</span> {</li><li>        <span class="hljs-title function_">resolve</span>(challenge);</li><li>      }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">() =&gt;</span> {</li><li>        <span class="hljs-title function_">reject</span>();</li><li>      })</li><li>    } <span class="hljs-keyword">catch</span> (err) {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Failed to pre-query Asset. Code is <span class="hljs-subst">${err?.code}</span>, message is <span class="hljs-subst">${err?.message}</span>`</span>);</li><li>      <span class="hljs-title function_">reject</span>();</li><li>    }</li><li>  });</li><li>}</li><li>
</li><li><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">postQueryAsset</span>(<span class="hljs-params">challenge: <span class="hljs-built_in">Uint8Array</span></span>) {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">handle</span>: asset.<span class="hljs-property">AssetMap</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();</li><li>  handle.<span class="hljs-title function_">set</span>(asset.<span class="hljs-property">Tag</span>.<span class="hljs-property">AUTH_CHALLENGE</span>, challenge);</li><li>  <span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">await</span> asset.<span class="hljs-title function_">postQuery</span>(handle);</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`Succeeded in post-querying Asset.`</span>);</li><li>  } <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Failed to post-query Asset. Code is <span class="hljs-subst">${err?.code}</span>, message is <span class="hljs-subst">${err?.message}</span>`</span>);</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">queryAsset</span>(<span class="hljs-params"></span>) {</li><li>  <span class="hljs-comment">// step1. 调用asset.preQuery获取挑战值。</span></li><li>  <span class="hljs-title function_">preQueryAsset</span>().<span class="hljs-title function_">then</span>(<span class="hljs-keyword">async</span> (<span class="hljs-attr">challenge</span>: <span class="hljs-title class_">Uint8Array</span>) =&gt; {</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-comment">// step2. 传入挑战值，拉起用户认证框。</span></li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">authToken</span>: <span class="hljs-title class_">Uint8Array</span> = <span class="hljs-keyword">await</span> <span class="hljs-title function_">userAuthenticate</span>(challenge);</li><li>      <span class="hljs-comment">// step3 用户认证通过后，传入挑战值和授权令牌，查询关键资产明文。</span></li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">query</span>: asset.<span class="hljs-property">AssetMap</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();</li><li>      query.<span class="hljs-title function_">set</span>(asset.<span class="hljs-property">Tag</span>.<span class="hljs-property">ALIAS</span>, <span class="hljs-title function_">stringToArray</span>(<span class="hljs-string">'demo_alias'</span>));</li><li>      query.<span class="hljs-title function_">set</span>(asset.<span class="hljs-property">Tag</span>.<span class="hljs-property">RETURN_TYPE</span>, asset.<span class="hljs-property">ReturnType</span>.<span class="hljs-property">ALL</span>);</li><li>      query.<span class="hljs-title function_">set</span>(asset.<span class="hljs-property">Tag</span>.<span class="hljs-property">AUTH_CHALLENGE</span>, challenge);</li><li>      query.<span class="hljs-title function_">set</span>(asset.<span class="hljs-property">Tag</span>.<span class="hljs-property">AUTH_TOKEN</span>, authToken);</li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">res</span>: <span class="hljs-title class_">Array</span>&lt;asset.<span class="hljs-property">AssetMap</span>&gt; = <span class="hljs-keyword">await</span> asset.<span class="hljs-title function_">query</span>(query);</li><li>      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; res.<span class="hljs-property">length</span>; i++) {</li><li>        <span class="hljs-comment">// 解析secret。</span></li><li>        <span class="hljs-keyword">let</span> <span class="hljs-attr">secret</span>: <span class="hljs-title class_">Uint8Array</span> = res[i].<span class="hljs-title function_">get</span>(asset.<span class="hljs-property">Tag</span>.<span class="hljs-property">SECRET</span>) <span class="hljs-keyword">as</span> <span class="hljs-title class_">Uint8Array</span>;</li><li>        <span class="hljs-comment">// 将Uint8Array转换为string类型。</span></li><li>        <span class="hljs-keyword">let</span> <span class="hljs-attr">secretStr</span>: <span class="hljs-built_in">string</span> = <span class="hljs-title function_">arrayToString</span>(secret);</li><li>      }</li><li>      <span class="hljs-comment">// step4. 关键资产明文查询成功后，需要调用asset.postQuery进行查询的后置处理。</span></li><li>      <span class="hljs-title function_">postQueryAsset</span>(challenge);</li><li>    } <span class="hljs-keyword">catch</span> (error) {</li><li>      <span class="hljs-comment">// step5. preQuery成功，后续操作失败，也需要调用asset.postQuery进行查询的后置处理。</span></li><li>      <span class="hljs-title function_">postQueryAsset</span>(challenge);</li><li>    }</li><li>  }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Failed to pre-query Asset. Code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>  })</li><li>}</li></ol></pre></div></div>    </div>   </div>   <div></div></div>