<h1 _ngcontent-ujn-c119="" class="doc-title ng-star-inserted" title="标准化数据类型 (C/C++)"> 标准化数据类型 (C/C++) </h1>

<div _ngcontent-ujn-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <div class="tiledSection">     <h2 id="场景介绍">场景介绍<i class="anchor-icon anchor-icon-link" anchorid="场景介绍" tips="复制节点链接"></i></h2>          <p>统一数据管理框架（UDMF）提供数据跨应用、跨设备交互标准，定义数据交互过程中的数据语言，提升数据交互效率。它提供安全、标准化的数据流通路径，支持不同级别的数据访问权限和生命周期管理策略，实现高效的数据共享。</p>    </div>    <div class="tiledSection">     <h2 id="基本概念">基本概念<i class="anchor-icon anchor-icon-link" anchorid="基本概念" tips="复制节点链接"></i></h2>          <ul>      <li><strong>标准化数据类型</strong>：Uniform Type Descriptor，简称UTD。主要针对同一种数据类型，提供统一定义，即标准数据类型描述符，定义了包括标识数据类型的ID、类型归属关系等相关信息，用于解决HarmonyOS系统中的类型模糊问题。一般用于过滤或者识别某一种数据类型的场景，比如文件预览、文件分享等。</li>     </ul>    </div>    <div class="tiledSection">     <h2 id="接口说明">接口说明<i class="anchor-icon anchor-icon-link" anchorid="接口说明" tips="复制节点链接"></i></h2>          <p>详细的接口说明请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-utd-h" target="_blank">UTD接口文档</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.3.3.1.3.1.1" valign="top" width="50%">接口名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.3.3.1.3.1.2" valign="top" width="50%">描述</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="50%">OH_Utd* OH_Utd_Create(const char* typeId)</td>         <td class="cellrowborder" valign="top" width="50%">创建一个指向统一数据类型描述符OH_Utd的指针。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">void OH_Utd_Destroy(OH_Utd* pThis)</td>         <td class="cellrowborder" valign="top" width="50%">销毁指向统一数据类型描述符OH_Utd的指针。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">const char** OH_Utd_GetTypesByFilenameExtension(const char* extension, unsigned int* count)</td>         <td class="cellrowborder" valign="top" width="50%">通过文件后缀名获取标准化数据类型ID。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">const char** OH_Utd_GetTypesByMimeType(const char* mimeType, unsigned int* count)</td>         <td class="cellrowborder" valign="top" width="50%">通过MIME类型获取标准化数据类型ID。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">bool OH_Utd_Equals(OH_Utd* utd1, OH_Utd* utd2)</td>         <td class="cellrowborder" valign="top" width="50%">判断两种标准化数据类型是否相等。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">void OH_Utd_DestroyStringList(const char** list, unsigned int count)</td>         <td class="cellrowborder" valign="top" width="50%">销毁字符串列表数据。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">bool OH_Utd_BelongsTo (const char *srcTypeId, const char *destTypeId)</td>         <td class="cellrowborder" valign="top" width="50%">判断两个标准化数据描述类型是否存在归属关系。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">bool OH_Utd_IsLower (const char* srcTypeId, const char* destTypeId )</td>         <td class="cellrowborder" valign="top" width="50%">判断原标准化数据类型是否是目标标准化数据类型的低层级类型。 例如TYPE_SCRIPT为SOURCE_CODE的低层级类型，TYPE_SCRIPT和SOURCE_CODE为PLAIN_TEXT的低层级类型。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">bool OH_Utd_IsHigher (const char* srcTypeId, const char* destTypeId )</td>         <td class="cellrowborder" valign="top" width="50%">判断原标准化数据类型是否是目标标准化数据类型的高层级类型。 例如SOURCE_CODE为TYPE_SCRIPT的高层级类型，PLAIN_TEXT为SOURCE_CODE和TYPE_SCRIPT的高层级类型。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="添加动态链接库">添加动态链接库<i class="anchor-icon anchor-icon-link" anchorid="添加动态链接库" tips="复制节点链接"></i></h2>          <p>CMakeLists.txt中添加以下库。</p>     <div _ngcontent-ujn-c106="" class="highlight-div"><div _ngcontent-ujn-c106="" class="highlight-div-header"><div _ngcontent-ujn-c106="" class="highlight-div-header-left"><div _ngcontent-ujn-c106="" class="handle-button expand-button"><div _ngcontent-ujn-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ujn-c106="" class="highlight-div-header-right"><div _ngcontent-ujn-c106="" class="handle-button ai-button"></div><div _ngcontent-ujn-c106="" class="handle-button line-button"><div _ngcontent-ujn-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ujn-c106="" class="handle-button theme-button"><div _ngcontent-ujn-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ujn-c106="" class="handle-button copy-button"><div _ngcontent-ujn-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ujn-c106="" class="highlight-scroll-div"><pre class="txt prettyprint linenums hljs language-plaintext" hw-language="txt" data-highlighted="yes"><ol class="linenums"><li>libudmf.so, libhilog_ndk.z.so</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="引用头文件">引用头文件<i class="anchor-icon anchor-icon-link" anchorid="引用头文件" tips="复制节点链接"></i></h2>          <div _ngcontent-ujn-c106="" class="highlight-div"><div _ngcontent-ujn-c106="" class="highlight-div-header"><div _ngcontent-ujn-c106="" class="highlight-div-header-left"><div _ngcontent-ujn-c106="" class="handle-button expand-button"><div _ngcontent-ujn-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ujn-c106="" class="highlight-div-header-right"><div _ngcontent-ujn-c106="" class="handle-button ai-button"></div><div _ngcontent-ujn-c106="" class="handle-button line-button"><div _ngcontent-ujn-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ujn-c106="" class="handle-button theme-button"><div _ngcontent-ujn-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ujn-c106="" class="handle-button copy-button"><div _ngcontent-ujn-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ujn-c106="" class="highlight-scroll-div"><pre class="c prettyprint linenums hljs language-c" hw-language="c" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstdio&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstring&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;database/udmf/utd.h&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;database/udmf/uds.h&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;database/udmf/udmf.h&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;database/udmf/udmf_meta.h&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;database/udmf/udmf_err_code.h&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;hilog/log.h&gt;</span></span></li><li>
</li><li><span class="hljs-meta">#<span class="hljs-keyword">undef</span> LOG_TAG</span></li><li><span class="hljs-meta">#<span class="hljs-keyword">define</span> LOG_TAG <span class="hljs-string">"MY_LOG"</span></span></li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="通过不同方式获取不同类型数据并且比较它们之间的关系">通过不同方式获取不同类型数据并且比较它们之间的关系<i class="anchor-icon anchor-icon-link" anchorid="通过不同方式获取不同类型数据并且比较它们之间的关系" tips="复制节点链接"></i></h2>          <p>下面以获取纯文本数据的查询场景为例，说明如何使用UTD。</p>     <ol>      <li>通过后缀名“.txt”获取UTD的typeId。</li>      <li>通过MIME类型“text/plain”获取UTD的typeId。</li>      <li>使用以上两个步骤获取到的typeId创建UTD实例对象。</li>      <li>比较UTD实例对象是否相等。</li>      <li>比较两种方式获取到的typeId是否存在归属关系。</li>      <li>比较两种方式获取到的typeIds1[0]是否是typeIds2[0]的低层级类型。</li>      <li>比较两种方式获取到的typeIds1[0]是否是typeIds2[0]的高层级类型。</li>      <li>使用结束后，删除上述步骤中产生的指针。</li>     </ol>     <div _ngcontent-ujn-c106="" class="highlight-div"><div _ngcontent-ujn-c106="" class="highlight-div-header"><div _ngcontent-ujn-c106="" class="highlight-div-header-left"><div _ngcontent-ujn-c106="" class="handle-button expand-button"><div _ngcontent-ujn-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ujn-c106="" class="highlight-div-header-right"><div _ngcontent-ujn-c106="" class="handle-button ai-button"></div><div _ngcontent-ujn-c106="" class="handle-button line-button"><div _ngcontent-ujn-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ujn-c106="" class="handle-button theme-button"><div _ngcontent-ujn-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ujn-c106="" class="handle-button copy-button"><div _ngcontent-ujn-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ujn-c106="" class="highlight-scroll-div"><pre class="c prettyprint linenums hljs language-c" hw-language="c" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 1. 通过文件后缀名获取纯文本类型的UTD的typeId</span></li><li><span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> typeIds1Count = <span class="hljs-number">0</span>;</li><li><span class="hljs-type">const</span> <span class="hljs-type">char</span>** typeIds1 = OH_Utd_GetTypesByFilenameExtension(<span class="hljs-string">".txt"</span>, &amp;typeIds1Count);</li><li>OH_LOG_INFO(LOG_APP, <span class="hljs-string">"the count of typeIds1 is %{public}u"</span>, typeIds1Count);</li><li><span class="hljs-comment">// 2. 通过MIME类型获取typeId</span></li><li><span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> typeIds2Count = <span class="hljs-number">0</span>;</li><li><span class="hljs-type">const</span> <span class="hljs-type">char</span>** typeIds2 = OH_Utd_GetTypesByMimeType(<span class="hljs-string">"text/plain"</span>, &amp;typeIds2Count);</li><li>OH_LOG_INFO(LOG_APP, <span class="hljs-string">"the count of typeIds2 is %{public}u"</span>, typeIds2Count);</li><li><span class="hljs-comment">// 3. 使用以上两个步骤获取到的typeId创建UTD实例对象。</span></li><li>OH_Utd* utd1 = OH_Utd_Create(typeIds1[<span class="hljs-number">0</span>]);</li><li>OH_Utd* utd2 = OH_Utd_Create(typeIds2[<span class="hljs-number">0</span>]);</li><li><span class="hljs-comment">// 4. 比较两种方式获取到的typeId对应的UTD是否相同</span></li><li><span class="hljs-type">bool</span> isEquals = OH_Utd_Equals(utd1, utd2);</li><li><span class="hljs-keyword">if</span> (isEquals) {</li><li>    OH_LOG_INFO(LOG_APP, <span class="hljs-string">"utd1 == utd2"</span>);</li><li>} <span class="hljs-keyword">else</span> {</li><li>    OH_LOG_INFO(LOG_APP, <span class="hljs-string">"utd1 != utd2"</span>);</li><li>}</li><li><span class="hljs-comment">// 5. 比较两种方式获取到的typeId是否存在归属关系</span></li><li><span class="hljs-type">bool</span> isBelongsTo = OH_Utd_BelongsTo(typeIds1[<span class="hljs-number">0</span>], typeIds2[<span class="hljs-number">0</span>]);</li><li><span class="hljs-keyword">if</span> (isBelongsTo) {</li><li>    OH_LOG_INFO(LOG_APP, <span class="hljs-string">"typeIds1[0] belongs to typeIds2[0]"</span>);</li><li>} <span class="hljs-keyword">else</span> {</li><li>    OH_LOG_INFO(LOG_APP, <span class="hljs-string">"typeIds1[0] don't belongs to typeIds2[0]"</span>);</li><li>}</li><li><span class="hljs-comment">// 6. 比较两种方式获取到的typeIds1[0]是否是typeIds2[0]的低层级类型</span></li><li><span class="hljs-type">bool</span> isLower = OH_Utd_IsLower(typeIds1[<span class="hljs-number">0</span>], typeIds2[<span class="hljs-number">0</span>]);</li><li><span class="hljs-keyword">if</span> (isLower) {</li><li>    OH_LOG_INFO(LOG_APP, <span class="hljs-string">"typeIds1[0] is lower typeIds2[0]"</span>);</li><li>} <span class="hljs-keyword">else</span> {</li><li>    OH_LOG_INFO(LOG_APP, <span class="hljs-string">"typeIds1[0] is not lower typeIds2[0]"</span>);</li><li>}</li><li><span class="hljs-comment">// 7. 比较两种方式获取到的typeIds1[0]是否是typeIds2[0]的高层级类型</span></li><li><span class="hljs-type">bool</span> isHigher = OH_Utd_IsHigher(typeIds1[<span class="hljs-number">0</span>], typeIds2[<span class="hljs-number">0</span>]);</li><li><span class="hljs-keyword">if</span> (isHigher) {</li><li>    OH_LOG_INFO(LOG_APP, <span class="hljs-string">"typeIds1[0] is higher typeIds2[0]"</span>);</li><li>} <span class="hljs-keyword">else</span> {</li><li>    OH_LOG_INFO(LOG_APP, <span class="hljs-string">"typeIds1[0]  is not higher typeIds2[0]"</span>);</li><li>}</li><li><span class="hljs-comment">// 8. 销毁OH_Utd_GetTypesByFilenameExtension与OH_Utd_GetTypesByMimeType函数获取到的指针，同时销毁UTD指针</span></li><li>OH_Utd_DestroyStringList(typeIds1, typeIds1Count);</li><li>OH_Utd_DestroyStringList(typeIds2, typeIds2Count);</li><li>OH_Utd_Destroy(utd1);</li><li>OH_Utd_Destroy(utd2);</li></ol></pre></div></div>    </div>   </div>   <div></div></div>