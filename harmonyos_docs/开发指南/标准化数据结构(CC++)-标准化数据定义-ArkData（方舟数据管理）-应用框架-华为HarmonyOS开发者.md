<h1 _ngcontent-tgh-c119="" class="doc-title ng-star-inserted" title="标准化数据结构 (C/C++)"> 标准化数据结构 (C/C++) </h1>

<div _ngcontent-tgh-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <div class="tiledSection">     <h2 id="场景介绍">场景介绍<i class="anchor-icon anchor-icon-link" anchorid="场景介绍" tips="复制节点链接"></i></h2>          <p>针对<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-utd-h" target="_blank">UTD标准化数据类型</a>中的部分常见类型，为了方便业务使用，提供了标准化数据结构。例如，系统定义的桌面图标类型（标准化数据类型标识为'OH_UdsAppItem'）明确定义了相关描述信息。</p>     <p>某些业务场景下应用可以直接使用我们具体定义的UTD标准化数据结构，例如跨应用拖拽场景。拖出方应用可以按照标准化数据结构将拖拽数据写入<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ndk-drag-event">拖拽事件</a>，拖入方应用从拖拽事件中读取拖拽数据并按照标准化数据结构进行数据的解析。这使得不同应用间的数据交互遵从相同的标准定义，有效减少了跨应用数据交互的开发工作量。</p>    </div>    <div class="tiledSection">     <h2 id="基本概念">基本概念<i class="anchor-icon anchor-icon-link" anchorid="基本概念" tips="复制节点链接"></i></h2>          <ul>      <li><strong>标准化数据结构</strong>：Unified Data Structure，简称UDS。主要针对部分标准化数据类型定义了统一的数据内容结构，并明确了对应的描述信息。应用间使用标准化数据结构进行数据交互后，将遵从统一的解析标准，可有效减少适配相关的工作量。一般用于跨应用跨设备间的数据交互，比如拖拽。</li>     </ul>    </div>    <div class="tiledSection">     <h2 id="接口说明">接口说明<i class="anchor-icon anchor-icon-link" anchorid="接口说明" tips="复制节点链接"></i></h2>          <p>详细的接口说明请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-uds-h" target="_blank">标准化数据结构相关接口</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.3.3.1.3.1.1" valign="top" width="50%">接口名称</th>         <th align="left" class="cellrowborder" id="mcps1.3.3.3.1.3.1.2" valign="top" width="50%">描述</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="50%">OH_UdmfData* OH_UdmfData_Create()</td>         <td class="cellrowborder" valign="top" width="50%">创建统一数据对象指针及实例对象</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">OH_UdmfRecord* OH_UdmfRecord_Create()</td>         <td class="cellrowborder" valign="top" width="50%">创建统一数据记录指针及实例对象</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">OH_UdsPlainText* OH_UdsPlainText_Create()</td>         <td class="cellrowborder" valign="top" width="50%">创建纯文本类型指针及实例对象</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">int OH_UdmfRecord_GetPlainText(OH_UdmfRecord* pThis, OH_UdsPlainText* plainText)</td>         <td class="cellrowborder" valign="top" width="50%">从统一数据记录中获取纯文本类型</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">int OH_UdsPlainText_SetContent(OH_UdsPlainText* pThis, const char* content)</td>         <td class="cellrowborder" valign="top" width="50%">设置纯文本类型中的纯文本内容参数</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">int OH_UdmfRecord_AddPlainText(OH_UdmfRecord* pThis, OH_UdsPlainText* plainText)</td>         <td class="cellrowborder" valign="top" width="50%">添加纯文本类型数据至统一数据记录中</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">int OH_UdmfData_AddRecord(OH_UdmfData* pThis, OH_UdmfRecord* record)</td>         <td class="cellrowborder" valign="top" width="50%">添加一个数据记录到统一数据对象中</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">OH_UdsFileUri* OH_UdsFileUri_Create()</td>         <td class="cellrowborder" valign="top" width="50%">创建文件Uri类型指针及实例对象</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">int OH_UdsFileUri_SetFileUri(OH_UdsFileUri* pThis, const char* fileUri)</td>         <td class="cellrowborder" valign="top" width="50%">设置文件Uri类型对象的Uri信息</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">int OH_UdsFileUri_SetFileType(OH_UdsFileUri* pThis, const char* fileType)</td>         <td class="cellrowborder" valign="top" width="50%">设置文件Uri类型对象的文件类型</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">int OH_UdmfRecord_AddFileUri(OH_UdmfRecord* pThis, OH_UdsFileUri* fileUri)</td>         <td class="cellrowborder" valign="top" width="50%">增加文件Uri类型数据至统一数据记录中</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">int OH_Udmf_SetUnifiedData(Udmf_Intention intention, OH_UdmfData* unifiedData,char* key, unsigned int keyLen)</td>         <td class="cellrowborder" valign="top" width="50%">从统一数据管理框架数据库中写入统一数据对象数据</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">void OH_UdsPlainText_Destroy(OH_UdsPlainText* pThis)</td>         <td class="cellrowborder" valign="top" width="50%">销毁纯文本类型数据指针指向的实例对象</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">void OH_UdmfData_Destroy(OH_UdmfData* pThis)</td>         <td class="cellrowborder" valign="top" width="50%">销毁统一数据对象指针指向的实例对象</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">void OH_UdsFileUri_Destroy(OH_UdsFileUri* pThis)</td>         <td class="cellrowborder" valign="top" width="50%">销毁文件Uri类型的实例对象</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="添加动态链接库">添加动态链接库<i class="anchor-icon anchor-icon-link" anchorid="添加动态链接库" tips="复制节点链接"></i></h2>          <p>CMakeLists.txt中添加以下库。</p>     <div _ngcontent-tgh-c106="" class="highlight-div"><div _ngcontent-tgh-c106="" class="highlight-div-header"><div _ngcontent-tgh-c106="" class="highlight-div-header-left"><div _ngcontent-tgh-c106="" class="handle-button expand-button"><div _ngcontent-tgh-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-tgh-c106="" class="highlight-div-header-right"><div _ngcontent-tgh-c106="" class="handle-button ai-button"></div><div _ngcontent-tgh-c106="" class="handle-button line-button"><div _ngcontent-tgh-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-tgh-c106="" class="handle-button theme-button"><div _ngcontent-tgh-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-tgh-c106="" class="handle-button copy-button"><div _ngcontent-tgh-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-tgh-c106="" class="highlight-scroll-div"><pre class="txt prettyprint linenums hljs language-plaintext" hw-language="txt" data-highlighted="yes"><ol class="linenums"><li>libudmf.so, libhilog_ndk.z.so</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="引用头文件">引用头文件<i class="anchor-icon anchor-icon-link" anchorid="引用头文件" tips="复制节点链接"></i></h2>          <div _ngcontent-tgh-c106="" class="highlight-div"><div _ngcontent-tgh-c106="" class="highlight-div-header"><div _ngcontent-tgh-c106="" class="highlight-div-header-left"><div _ngcontent-tgh-c106="" class="handle-button expand-button"><div _ngcontent-tgh-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-tgh-c106="" class="highlight-div-header-right"><div _ngcontent-tgh-c106="" class="handle-button ai-button"></div><div _ngcontent-tgh-c106="" class="handle-button line-button"><div _ngcontent-tgh-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-tgh-c106="" class="handle-button theme-button"><div _ngcontent-tgh-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-tgh-c106="" class="handle-button copy-button"><div _ngcontent-tgh-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-tgh-c106="" class="highlight-scroll-div"><pre class="c prettyprint linenums hljs language-c" hw-language="c" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;database/udmf/uds.h&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;database/udmf/udmf.h&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;database/udmf/udmf_meta.h&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;hilog/log.h&gt;</span></span></li><li>
</li><li><span class="hljs-meta">#<span class="hljs-keyword">undef</span> LOG_TAG</span></li><li><span class="hljs-meta">#<span class="hljs-keyword">define</span> LOG_TAG <span class="hljs-string">"MY_LOG"</span></span></li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="纯文本类型数据结构的使用">纯文本类型数据结构的使用<i class="anchor-icon anchor-icon-link" anchorid="纯文本类型数据结构的使用" tips="复制节点链接"></i></h2>          <ol>      <li>创建PlainText对象指针。</li>      <li>添加PlainText内容。</li>      <li>获取数据。</li>      <li>使用完成后销毁指针。</li>     </ol>     <div _ngcontent-tgh-c106="" class="highlight-div"><div _ngcontent-tgh-c106="" class="highlight-div-header"><div _ngcontent-tgh-c106="" class="highlight-div-header-left"><div _ngcontent-tgh-c106="" class="handle-button expand-button"><div _ngcontent-tgh-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-tgh-c106="" class="highlight-div-header-right"><div _ngcontent-tgh-c106="" class="handle-button ai-button"></div><div _ngcontent-tgh-c106="" class="handle-button line-button"><div _ngcontent-tgh-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-tgh-c106="" class="handle-button theme-button"><div _ngcontent-tgh-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-tgh-c106="" class="handle-button copy-button"><div _ngcontent-tgh-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-tgh-c106="" class="highlight-scroll-div"><pre class="c prettyprint linenums hljs language-c" hw-language="c" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 1.创建PlainText对象指针</span></li><li>OH_UdmfRecord *plainTextRecord = OH_UdmfRecord_Create();</li><li>OH_UdsPlainText *plainText = OH_UdsPlainText_Create();</li><li><span class="hljs-type">char</span> content[] = <span class="hljs-string">"hello world"</span>;</li><li>
</li><li><span class="hljs-comment">// 2.添加PlainText内容</span></li><li>OH_UdsPlainText_SetContent(plainText, content);</li><li>OH_UdmfRecord_AddPlainText(plainTextRecord, plainText);</li><li>
</li><li><span class="hljs-comment">// 3.获取PlainText数据</span></li><li>OH_UdsPlainText* plainText2 = OH_UdsPlainText_Create();</li><li>OH_UdmfRecord_GetPlainText(plainTextRecord, plainText2);</li><li><span class="hljs-type">const</span> <span class="hljs-type">char</span>* content2 = OH_UdsPlainText_GetContent(plainText2);</li><li>
</li><li>OH_LOG_INFO(LOG_APP, <span class="hljs-string">"content = %{public}s."</span>, content2);</li><li><span class="hljs-comment">// 4.使用完成后销毁指针。</span></li><li>OH_UdsPlainText_Destroy(plainText);</li><li>OH_UdmfRecord_Destroy(plainTextRecord);</li><li>OH_UdsPlainText_Destroy(plainText2);</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="fileuri类型的数据结构的使用">fileUri类型的数据结构的使用<i class="anchor-icon anchor-icon-link" anchorid="fileuri类型的数据结构的使用" tips="复制节点链接"></i></h2>          <ol>      <li>创建fileUri类型的数据结构。</li>      <li>设置fileUri中的URL和描述信息。</li>      <li>创建OH_UdmfRecord对象，并向OH_UdmfRecord中添加fileUri类型数据。</li>      <li>获取fileUri数据。</li>      <li>使用完成后销毁指针。</li>     </ol>     <div _ngcontent-tgh-c106="" class="highlight-div"><div _ngcontent-tgh-c106="" class="highlight-div-header"><div _ngcontent-tgh-c106="" class="highlight-div-header-left"><div _ngcontent-tgh-c106="" class="handle-button expand-button"><div _ngcontent-tgh-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-tgh-c106="" class="highlight-div-header-right"><div _ngcontent-tgh-c106="" class="handle-button ai-button"></div><div _ngcontent-tgh-c106="" class="handle-button line-button"><div _ngcontent-tgh-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-tgh-c106="" class="handle-button theme-button"><div _ngcontent-tgh-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-tgh-c106="" class="handle-button copy-button"><div _ngcontent-tgh-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-tgh-c106="" class="highlight-scroll-div"><pre class="c prettyprint linenums hljs language-c" hw-language="c" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 1.创建fileUri类型的数据结构</span></li><li><span class="hljs-type">const</span> <span class="hljs-type">char</span>* uri = <span class="hljs-string">"https://xxx/xx/xx.jpg"</span>;</li><li>OH_UdsFileUri* fileUri = OH_UdsFileUri_Create();</li><li><span class="hljs-comment">// 2. 设置fileUri中的URL和描述信息。</span></li><li>OH_UdsFileUri_SetFileUri(fileUri, uri);</li><li>OH_UdsFileUri_SetFileType(fileUri, UDMF_META_IMAGE);</li><li><span class="hljs-comment">// 3. 创建OH_UdmfRecord对象，并向OH_UdmfRecord中添加fileUri类型数据。</span></li><li>OH_UdmfRecord* record = OH_UdmfRecord_Create();</li><li>OH_UdmfRecord_AddFileUri(record, fileUri);</li><li><span class="hljs-comment">// 4. 获取fileUri数据。</span></li><li>OH_UdsFileUri* fileUri1 = OH_UdsFileUri_Create();</li><li>OH_UdmfRecord_GetFileUri(record, fileUri1);</li><li><span class="hljs-type">const</span> <span class="hljs-type">char</span>* fileUriStr = OH_UdsFileUri_GetFileUri(fileUri1);</li><li>OH_LOG_INFO(LOG_APP, <span class="hljs-string">"fileUri1 = %{public}s."</span>, fileUriStr);</li><li><span class="hljs-comment">// 5. 使用完成后销毁指针。</span></li><li>OH_UdsFileUri_Destroy(fileUri);</li><li>OH_UdmfRecord_Destroy(record);</li><li>OH_UdsFileUri_Destroy(fileUri1);</li></ol></pre></div></div>    </div>   </div>   <div></div></div>