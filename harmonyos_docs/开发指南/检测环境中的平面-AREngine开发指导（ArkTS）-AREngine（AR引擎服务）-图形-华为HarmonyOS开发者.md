<h1 _ngcontent-llc-c119="" class="doc-title ng-star-inserted" title="检测环境中的平面"> 检测环境中的平面 </h1>

<div _ngcontent-llc-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <div class="tiledSection">     <h2 id="section6809117662">概要<i class="anchor-icon anchor-icon-link" anchorid="section6809117662" tips="复制节点链接"></i></h2>          <p>从5.1.0(18)开始，AR Engine支持检测环境中的平面能力。</p>     <p>本章节介绍如何通过AR Engine进行平面检测。通过学习本章节，可以检测当前环境中的平面，并在应用中处理这些平面。</p>     <p>本章节涉及的AR Engine能力如下：</p>     <ul>      <li>运动跟踪能力</li>      <li>环境跟踪能力（平面检测）</li>     </ul>     <div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content">       <p>初始化之后需要缓慢移动相机来寻找平面。</p>      </div></div></div>    </div>    <div class="tiledSection">     <h2 id="section57212150139">接口说明<i class="anchor-icon anchor-icon-link" anchorid="section57212150139" tips="复制节点链接"></i></h2>          <p>检测平面通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arengine-api-arengine#section3392194311417" target="_blank">ARPlane</a>平面对象进行，以下接口为平面相关接口。详细接口和说明，请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arengine-arkts-api" target="_blank">AR Engine API参考</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.2.3.1.3.1.1" valign="top" width="49.94%">          <p>接口名</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.2.3.1.3.1.2" valign="top" width="50.06%">          <p>描述</p></th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="49.94%">          <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arengine-api-arengine#section14241133116264" target="_blank">ARTrackable.getPose</a></p></td>         <td class="cellrowborder" valign="top" width="50.06%">          <p>获取追踪目标的位姿信息。</p></td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="49.94%">          <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arengine-api-arengine#section10878141483010" target="_blank">ARTrackable.getAnchors</a></p></td>         <td class="cellrowborder" valign="top" width="50.06%">          <p>获取绑定到输入可跟踪对象的锚点对象。</p></td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="49.94%">          <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arengine-api-arengine#section5278038164917" target="_blank">ARPose.getMatrix</a></p></td>         <td class="cellrowborder" valign="top" width="50.06%">          <p>将位姿数据转换为一个4x4的矩阵。</p></td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="49.94%">          <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arengine-api-arengine#section12949442354" target="_blank">ARPlane.getPolygonXZ</a></p></td>         <td class="cellrowborder" valign="top" width="50.06%">          <p>获取检测到的平面2D顶点数组。</p></td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="49.94%">          <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arengine-api-arengine#section1127511467514" target="_blank">ARPlane.getSubsumedBy</a></p></td>         <td class="cellrowborder" valign="top" width="50.06%">          <p>获取平面的父平面（当平面与另一个平面合并时会生成父平面）。</p></td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="49.94%">          <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arengine-api-arengine#section102761471453" target="_blank">ARPlane.isPoseInExtents</a></p></td>         <td class="cellrowborder" valign="top" width="50.06%">          <p>检查给定位姿是否在平面的边界矩形内。</p></td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="49.94%">          <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arengine-api-arengine#section1471811920162" target="_blank">ARPlane.isPoseInPolygon</a></p></td>         <td class="cellrowborder" valign="top" width="50.06%">          <p>检查给定位姿是否在平面的边界多边形内。</p></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="section18620185424816">开发步骤<i class="anchor-icon anchor-icon-link" anchorid="section18620185424816" tips="复制节点链接"></i></h2>          <p id="ZH-CN_TOPIC_0000002363785065__p1729183119493">AR Engine仅输出识别到的平面数据。为便于用户观察，开发者可使用AGP（Ark Graphics Platform）渲染引擎或者<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-basic-components-xcomponent" target="_blank">XComponent</a>绘制识别的平面。关于AGP的介绍可以查看<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkgraphics3d-overview" target="_blank">ArkGraphics 3D简介</a>和<a href="https://gitcode.com/openharmony/graphic_graphic_3d" target="_blank">AGP引擎</a>。</p>     <p id="ZH-CN_TOPIC_0000002363785065__p2773155115917">对于使用ArkTS的任何AR应用，首先需要创建一个AR会话<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arengine-api-arviewcontroller#section12681656121519" target="_blank">ARViewContext</a>，用于管理AR Engine的系统状态。AR会话<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arengine-api-arviewcontroller#section12681656121519" target="_blank">ARViewContext</a>的创建可以参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arengine-arsession">管理AR会话</a>章节。</p>    </div>    <div class="tiledSection">     <h3 id="section17975153172911" class="firsth2">导入模块<i class="anchor-icon anchor-icon-link" anchorid="section17975153172911" tips="复制节点链接"></i></h3>          <p>平面检测能力所需的模块导入如下：</p>     <div _ngcontent-llc-c106="" class="highlight-div"><div _ngcontent-llc-c106="" class="highlight-div-header"><div _ngcontent-llc-c106="" class="highlight-div-header-left"><div _ngcontent-llc-c106="" class="handle-button expand-button"><div _ngcontent-llc-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-llc-c106="" class="highlight-div-header-right"><div _ngcontent-llc-c106="" class="handle-button ai-button"></div><div _ngcontent-llc-c106="" class="handle-button line-button"><div _ngcontent-llc-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-llc-c106="" class="handle-button theme-button"><div _ngcontent-llc-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-llc-c106="" class="handle-button copy-button"><div _ngcontent-llc-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-llc-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { arEngine, <span class="hljs-title class_">ARView</span>, arViewController } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AREngine'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Node</span>, <span class="hljs-title class_">Scene</span>, <span class="hljs-title class_">Vec3</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkGraphics3D'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Matrix4</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span>;</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="section57509123317">显示预览流<i class="anchor-icon anchor-icon-link" anchorid="section57509123317" tips="复制节点链接"></i></h3>          <p>首先初始化AR会话和AR场景，可以参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arengine-arsession#section3391814131611">初始化AR会话和AR场景</a>章节。</p>     <div _ngcontent-llc-c106="" class="highlight-div"><div _ngcontent-llc-c106="" class="highlight-div-header"><div _ngcontent-llc-c106="" class="highlight-div-header-left"><div _ngcontent-llc-c106="" class="handle-button expand-button"><div _ngcontent-llc-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-llc-c106="" class="highlight-div-header-right"><div _ngcontent-llc-c106="" class="handle-button ai-button"></div><div _ngcontent-llc-c106="" class="handle-button line-button"><div _ngcontent-llc-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-llc-c106="" class="handle-button theme-button"><div _ngcontent-llc-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-llc-c106="" class="handle-button copy-button"><div _ngcontent-llc-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-llc-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@Builder</span></li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">ARPlaneBuilder</span>(<span class="hljs-params"></span>): <span class="hljs-built_in">void</span> {</li><li>  <span class="hljs-title class_">ARPlane</span>();</li><li>}</li><li>
</li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">ARPlane</span> {</li><li>  <span class="hljs-meta">@State</span> arContext?: arViewController.<span class="hljs-property">ARViewContext</span> = <span class="hljs-literal">undefined</span>;</li><li>
</li><li>  <span class="hljs-title function_">build</span>(): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-comment">// ...</span></li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-title function_">initARView</span>(): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-comment">// ...</span></li><li>  }</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-title function_">stopARView</span>(): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-comment">// ...</span></li><li>  }</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-title function_">resumeARView</span>(): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-comment">// ...</span></li><li>  }</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-title function_">pauseARView</span>(): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-comment">// ...</span></li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="section36435113214">检测环境平面<i class="anchor-icon anchor-icon-link" anchorid="section36435113214" tips="复制节点链接"></i></h3>          <p>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arengine-api-arviewcontroller#section9396615174614" target="_blank">ARViewCallback</a>，使用其中的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arengine-api-arviewcontroller#section52341758194715" target="_blank">onFrameUpdate</a>方法进行帧数据更新，通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arengine-api-arengine#section559349112710" target="_blank">ARSession.getAllTrackables</a>方法获取所有识别到的平面。</p>     <div _ngcontent-llc-c106="" class="highlight-div"><div _ngcontent-llc-c106="" class="highlight-div-header"><div _ngcontent-llc-c106="" class="highlight-div-header-left"><div _ngcontent-llc-c106="" class="handle-button expand-button"><div _ngcontent-llc-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-llc-c106="" class="highlight-div-header-right"><div _ngcontent-llc-c106="" class="handle-button ai-button"></div><div _ngcontent-llc-c106="" class="handle-button line-button"><div _ngcontent-llc-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-llc-c106="" class="handle-button theme-button"><div _ngcontent-llc-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-llc-c106="" class="handle-button copy-button"><div _ngcontent-llc-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-llc-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">ARViewCallbackImpl</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">arViewController.ARViewCallback</span> {</li><li>  <span class="hljs-title function_">onAnchorAdd</span>(<span class="hljs-attr">ctx</span>: arViewController.<span class="hljs-property">ARViewContext</span>, <span class="hljs-attr">node</span>: <span class="hljs-title class_">Node</span>, <span class="hljs-attr">anchor</span>: arEngine.<span class="hljs-property">ARAnchor</span>): <span class="hljs-built_in">void</span> {</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">onAnchorUpdate</span>(<span class="hljs-attr">ctx</span>: arViewController.<span class="hljs-property">ARViewContext</span>, <span class="hljs-attr">node</span>: <span class="hljs-title class_">Node</span>, <span class="hljs-attr">anchor</span>: arEngine.<span class="hljs-property">ARAnchor</span>): <span class="hljs-built_in">void</span> {</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">async</span> <span class="hljs-title function_">onFrameUpdate</span>(<span class="hljs-attr">ctx</span>: arViewController.<span class="hljs-property">ARViewContext</span>, <span class="hljs-attr">sysBootTs</span>: <span class="hljs-built_in">number</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {</li><li>    <span class="hljs-keyword">if</span> (!ctx.<span class="hljs-property">session</span>) {</li><li>      <span class="hljs-keyword">return</span>;</li><li>    }</li><li>
</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">arSession</span>: arEngine.<span class="hljs-property">ARSession</span> = ctx.<span class="hljs-property">session</span>;</li><li>
</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">frame</span>: arEngine.<span class="hljs-property">ARFrame</span> = arSession.<span class="hljs-title function_">getFrame</span>();</li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">camera</span>: arEngine.<span class="hljs-property">ARCamera</span> = frame.<span class="hljs-title function_">getCamera</span>();</li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">trackable</span>: arEngine.<span class="hljs-property">ARTrackable</span>[] = [];</li><li>
</li><li>      <span class="hljs-keyword">if</span> (camera.<span class="hljs-property">state</span> === arEngine.<span class="hljs-property">ARTrackingState</span>.<span class="hljs-property">TRACKING</span>) {</li><li>        trackable = arSession.<span class="hljs-title function_">getAllTrackables</span>(arEngine.<span class="hljs-property">ARTrackableType</span>.<span class="hljs-property">PLANE</span>);</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`Succeeded in getting tracking plane, length is: <span class="hljs-subst">${trackable.length}</span>`</span>);  <span class="hljs-comment">// 打印当前识别到的平面数量</span></li><li>      }</li><li>
</li><li>    } <span class="hljs-keyword">catch</span> (error) {</li><li>      <span class="hljs-keyword">const</span> <span class="hljs-attr">err</span>: <span class="hljs-title class_">BusinessError</span> = error <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>;</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Failed to update data. Code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>.`</span>);</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="section142331216260">检测平面的自定义方法<i class="anchor-icon anchor-icon-link" anchorid="section142331216260" tips="复制节点链接"></i></h3>          <p>自定义方法获取顶点数据getVertices、创建索引generateMeshIndex、创建mesh数据generateMeshInput。</p>     <div _ngcontent-llc-c106="" class="highlight-div"><div _ngcontent-llc-c106="" class="highlight-div-header"><div _ngcontent-llc-c106="" class="highlight-div-header-left"><div _ngcontent-llc-c106="" class="handle-button expand-button"><div _ngcontent-llc-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-llc-c106="" class="highlight-div-header-right"><div _ngcontent-llc-c106="" class="handle-button ai-button"></div><div _ngcontent-llc-c106="" class="handle-button line-button"><div _ngcontent-llc-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-llc-c106="" class="handle-button theme-button"><div _ngcontent-llc-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-llc-c106="" class="handle-button copy-button"><div _ngcontent-llc-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-llc-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 获取三维空间顶点坐标，第一个入参的位姿矩阵按垂直列排列，第二个坐标点为(x, 0, z, 1)，对应x-z平面。</span></li><li><span class="hljs-variable">export</span> <span class="hljs-variable">function</span> <span class="hljs-title function_">getVertices</span>(<span class="hljs-variable">mat</span>: <span class="hljs-title class_">Matrix4</span>, <span class="hljs-variable">point</span>: <span class="hljs-title class_">number</span>[]): <span class="hljs-title class_">Vec3</span>[] {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-variable">result</span>: <span class="hljs-title class_">Vec3</span>[] = [];</li><li>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> <span class="hljs-variable">i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">i</span> &lt; <span class="hljs-title class_">point</span>.<span class="hljs-title class_">length</span>; <span class="hljs-title class_">i</span> += <span class="hljs-number">2</span>) {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-variable">single</span>: <span class="hljs-title class_">Vec3</span> = {</li><li>      <span class="hljs-variable">x</span>: (<span class="hljs-title class_">mat</span>[<span class="hljs-number">2</span>] <span class="hljs-variable">* point</span>[<span class="hljs-title class_">i</span>] <span class="hljs-variable">+ mat</span>[<span class="hljs-number">6</span>] * <span class="hljs-number">0</span></li><li>        <span class="hljs-variable">+ mat</span>[<span class="hljs-number">10</span>] <span class="hljs-variable">* point</span>[<span class="hljs-variable">i</span> + <span class="hljs-number">1</span>] <span class="hljs-variable">+ mat</span>[<span class="hljs-number">14</span>] * <span class="hljs-number">1.0</span>),</li><li>      <span class="hljs-variable">y</span>: <span class="hljs-title class_">mat</span>[<span class="hljs-number">1</span>] * <span class="hljs-variable">point</span>[<span class="hljs-variable">i</span>] + <span class="hljs-variable">mat</span>[<span class="hljs-number">5</span>] * <span class="hljs-number">0</span></li><li>        + <span class="hljs-variable">mat</span>[<span class="hljs-number">9</span>] * <span class="hljs-variable">point</span>[<span class="hljs-variable">i</span> + <span class="hljs-number">1</span>] + <span class="hljs-variable">mat</span>[<span class="hljs-number">13</span>] * <span class="hljs-number">1.0</span>,</li><li>      <span class="hljs-variable">z</span>: -(<span class="hljs-title class_">mat</span>[<span class="hljs-number">0</span>] <span class="hljs-variable">* point</span>[<span class="hljs-title class_">i</span>] <span class="hljs-variable">+ mat</span>[<span class="hljs-number">4</span>] * <span class="hljs-number">0</span></li><li>        <span class="hljs-variable">+ mat</span>[<span class="hljs-number">8</span>] <span class="hljs-variable">* point</span>[<span class="hljs-variable">i</span> + <span class="hljs-number">1</span>] <span class="hljs-variable">+ mat</span>[<span class="hljs-number">12</span>] * <span class="hljs-number">1.0</span>),</li><li>    }</li><li>    <span class="hljs-variable">result</span>.<span class="hljs-title function_">push</span>(<span class="hljs-variable">single</span>);</li><li>  }</li><li>  <span class="hljs-keyword">return</span> <span class="hljs-variable">result</span>;</li><li>}</li><li><span class="hljs-comment">// 创建 ARWorld 的 mesh索引。由于平面是由三角形拼接而成的，因此每个平面上的每个三角形的首个顶点索引都是相同的。</span></li><li><span class="hljs-variable">export</span> <span class="hljs-variable">function</span> <span class="hljs-title function_">generateMeshIndex</span>(<span class="hljs-variable">input</span>: <span class="hljs-title class_">Vec3</span>[][]): <span class="hljs-title class_">number</span>[] {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-variable">result</span>: <span class="hljs-title class_">number</span>[] = [];</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-variable">start</span>: <span class="hljs-title class_">number</span> = <span class="hljs-number">0</span>;</li><li>
</li><li>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> <span class="hljs-variable">i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">i</span> &lt; <span class="hljs-title class_">input</span>.<span class="hljs-title class_">length</span>; <span class="hljs-title class_">i</span>++) {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-variable">length</span>: <span class="hljs-title class_">number</span> = <span class="hljs-variable">input</span>[<span class="hljs-variable">i</span>].<span class="hljs-variable">length</span>;</li><li>
</li><li>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> <span class="hljs-variable">j</span> = <span class="hljs-variable">start</span> + <span class="hljs-number">1</span>; <span class="hljs-variable">j</span> &lt; <span class="hljs-title class_">start</span> + <span class="hljs-title class_">length</span> - <span class="hljs-number">1</span>; <span class="hljs-title class_">j</span>++) {</li><li>      <span class="hljs-variable">result</span>.<span class="hljs-title function_">push</span>(<span class="hljs-variable">start</span>);</li><li>      <span class="hljs-variable">result</span>.<span class="hljs-title function_">push</span>(<span class="hljs-variable">j</span>);</li><li>      <span class="hljs-variable">result</span>.<span class="hljs-title function_">push</span>(<span class="hljs-variable">j</span> + <span class="hljs-number">1</span>);</li><li>    }</li><li>    <span class="hljs-variable">start</span> += <span class="hljs-variable">length</span>;</li><li>  }</li><li>  <span class="hljs-keyword">return</span> <span class="hljs-variable">result</span>;</li><li>}</li><li>
</li><li><span class="hljs-variable">export</span> <span class="hljs-variable">function</span> <span class="hljs-title function_">generateMeshInput</span>(<span class="hljs-variable">vex</span>: <span class="hljs-title class_">Vec3</span>[][]): <span class="hljs-title class_">Vec3</span>[] {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-variable">result</span>: <span class="hljs-title class_">Vec3</span>[] = [];</li><li>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> <span class="hljs-variable">i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">i</span> &lt; <span class="hljs-title class_">vex</span>.<span class="hljs-title class_">length</span>; <span class="hljs-title class_">i</span>++) {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-variable">tmp</span>: <span class="hljs-title class_">Vec3</span>[] = <span class="hljs-variable">vex</span>[<span class="hljs-variable">i</span>];</li><li>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> <span class="hljs-variable">j</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">j</span> &lt; <span class="hljs-title class_">tmp</span>.<span class="hljs-title class_">length</span>; <span class="hljs-title class_">j</span>++) {</li><li>      <span class="hljs-variable">result</span>.<span class="hljs-title function_">push</span>(<span class="hljs-variable">tmp</span>[<span class="hljs-variable">j</span>]);</li><li>    }</li><li>  }</li><li>  <span class="hljs-keyword">return</span> <span class="hljs-variable">result</span>;</li><li>}</li></ol></pre></div></div>    </div>   </div>   <div></div></div>