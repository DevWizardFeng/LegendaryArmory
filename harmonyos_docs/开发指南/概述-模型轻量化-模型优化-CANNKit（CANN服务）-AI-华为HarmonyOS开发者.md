<h1 _ngcontent-qit-c119="" class="doc-title ng-star-inserted" title="概述"> 概述 </h1>

<div _ngcontent-qit-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div><div class="tiledSection"><h2 id="section1914512481303">简介<i class="anchor-icon anchor-icon-link" anchorid="section1914512481303" tips="复制节点链接"></i></h2><p>轻量化工具是一款集模型压缩算法和网络结构搜索算法于一体的自动模型轻量化工具，针对NPU架构对深度神经网络模型进行深度的模型优化，可以帮助开发者自动地完成模型轻量化以及网络结构的生成任务。目前支持无训练模式、插件式量化模式、大语言模型低位量化和网络结构搜索训练。</p> <ul><li>无训练量化：开发者可以直接输入模型，无需重训练，快速的完成模型轻量化。适用于快捷方便量化的开发者使用。</li></ul> <ul><li>插件式量化：为开发者提供模型量化API，在开发者训练工程中对浮点模型进行量化模型校准或量化模型重训练，易用性高，插件式重训练量化适用于较高精度要求的开发者。</li><li>大语言模型低位量化：提供大语言模型的4bit低位量化支持。通过权重量化、激活量化和参数提取三段式执行流程，实现大模型压缩。</li><li>网络结构搜索训练：支持分类网络、检测网络、分割网络三种网络类型。开发者配置相应的搜索参数和接口函数后，使用网络结构搜索工具进行搜索，在设定的算力约束下，得到优秀的网络模型。适用于需要自动生成网络结构的开发者。</li></ul>  <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.1.5.1.5.1.1" valign="top" width="15.03%"><p>模式</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.1.5.1.5.1.2" valign="top" width="24.18%"><p>支持的框架</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.1.5.1.5.1.3" valign="top" width="21.52%"><p>支持的策略</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.1.5.1.5.1.4" valign="top" width="39.269999999999996%"><p>支持的设备</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="15.03%"><p>无训练量化</p> </td> <td class="cellrowborder" valign="top" width="24.18%"><p>TensorFlow、PyTorch、ONNX</p> </td> <td class="cellrowborder" valign="top" width="21.52%"><p>Quant_INT8-8</p> </td> <td class="cellrowborder" valign="top" width="39.269999999999996%"><p>同时支持CPU和GPU模式，GPU支持单机单卡。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="15.03%"><p>插件式量化</p> </td> <td class="cellrowborder" valign="top" width="24.18%"><p>TensorFlow、PyTorch</p> </td> <td class="cellrowborder" valign="top" width="21.52%"><p>Quant_INT8-8</p> </td> <td class="cellrowborder" valign="top" width="39.269999999999996%"><p>支持GPU，支持单机单卡。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="15.03%"><p>网络结构搜索训练</p> </td> <td class="cellrowborder" valign="top" width="24.18%"><p>TensorFlow、PyTorch</p> </td> <td class="cellrowborder" valign="top" width="21.52%"><p>NASEA</p> </td> <td class="cellrowborder" valign="top" width="39.269999999999996%"><p>支持GPU，支持单机单卡和单机多卡。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="15.03%"><p>大语言模型低位量化</p> </td> <td class="cellrowborder" valign="top" width="24.18%"><p>PyTorch</p> </td> <td class="cellrowborder" valign="top" width="21.52%"><p>Quant_INT16-4</p> </td> <td class="cellrowborder" valign="top" width="39.269999999999996%"><p>支持GPU，量化蒸馏支持单机多卡。</p> </td> </tr>  </tbody></table></div> </div> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p>Quant_INT8-8：数据8bit量化，权重8bit量化。</p> <p>Quant_INT16-4：数据16bit量化，权重4bit量化。</p> </div></div></div> <p>通过模型轻量化以及网络结构搜索获得模型在NPU上的收益可以参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/cannkit-model-benefits">模型收益</a>。</p> <p>经过轻量化工具小型化后的模型，可以使用OMG转换工具转为OM离线模型，使用方式可参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/cannkit-model-conversion-example#section29012331976">量化模型转换</a>。</p> <p>该轻量化工具位于<span class="filepath">“tools_dopt”</span>目录下。</p>  <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.1.10.1.3.1.1" valign="top" width="37.84%"><p>目录文件</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.1.10.1.3.1.2" valign="top" width="62.160000000000004%"><p>描述说明</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="37.84%"><p>tools_dopt/dopt_tf_py3</p> </td> <td class="cellrowborder" valign="top" width="62.160000000000004%"><p>TensorFlow框架无训练，插件式量化，网络结构搜索的工具入口以及demo。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="37.84%"><p>tools_dopt/dopt_pytorch_py3</p> </td> <td class="cellrowborder" valign="top" width="62.160000000000004%"><p>PyTorch框架无训练，插件式，大语言模型量化，网络结构搜索的工具入口以及demo。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="37.84%"><p>tools_dopt/dopt_onnx_py3</p> </td> <td class="cellrowborder" valign="top" width="62.160000000000004%"><p>ONNX框架无训练工具入口。</p> </td> </tr>  </tbody></table></div> </div> </div> <div class="tiledSection"><h2 id="section033644814114">支持范围<i class="anchor-icon anchor-icon-link" anchorid="section033644814114" tips="复制节点链接"></i></h2><ul><li>插件式支持GPU训练，单机单卡训练。</li><li>无训练支持CPU和GPU量化。</li><li>大语言模型低位量化支持GPU量化。</li><li>网络结构搜索工具支持单机单卡和单机多卡，进行分类、检测、分割场景的骨架搜索，依赖运行环境参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/cannkit-network-structure-search-training#section193737375169">环境准备</a>。</li></ul> </div> <div class="tiledSection"><h2 id="section38291317533">系统要求<i class="anchor-icon anchor-icon-link" anchorid="section38291317533" tips="复制节点链接"></i></h2><ul><li>TensorFlow开发者使用本工具需同时满足下列环境要求：<ul><li>Python 3.10</li><li>Ubuntu 22.04</li><li>Tensorflow 2.8.0</li><li>GPU需要使用支持CUDA的显卡（无训练量化可不配置）</li></ul> </li><li>PyTorch开发者使用本工具需同时满足下列环境要求：<ul><li>Python 3.10</li><li>Ubuntu 22.04</li><li>PyTorch 1.11</li><li>opencv-python</li><li>GPU需要使用支持CUDA的显卡（无训练量化可不配置）</li></ul> </li></ul> <ul><li>ONNX开发者使用本工具需同时满足下列环境要求：<ul><li>Python 3.10</li><li>Ubuntu 22.04</li><li>ONNX Runtime 1.15</li><li>ONNX 1.14</li></ul> </li></ul> </div> <div class="tiledSection"><h2 id="section145166587320">开发者指引<i class="anchor-icon anchor-icon-link" anchorid="section145166587320" tips="复制节点链接"></i></h2><p>下面列举了不同开发者场景对应的步骤和工具链功能。开发者可以根据下表中列举的不同场景选择适宜的优化方式。</p> </div> <div class="tiledSection"><h3 id="section01245551642" class="firsth2">TensorFlow开发者<i class="anchor-icon anchor-icon-link" anchorid="section01245551642" tips="复制节点链接"></i></h3> <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.5.2.1.6.1.1" valign="top" width="23.20767923207679%"><p><strong>开发者场景</strong></p> </th> <th align="left" class="cellrowborder" id="mcps1.3.5.2.1.6.1.2" valign="top" width="21.71782821717828%"><p><strong>使用依赖</strong></p> </th> <th align="left" class="cellrowborder" id="mcps1.3.5.2.1.6.1.3" valign="top" width="19.838016198380156%"><p><strong>工具链提供功能</strong></p> </th> <th align="left" class="cellrowborder" id="mcps1.3.5.2.1.6.1.4" valign="top" width="18.188181181881806%"><p><strong>建议使用工具</strong></p> </th> <th align="left" class="cellrowborder" id="mcps1.3.5.2.1.6.1.5" valign="top" width="17.048295170482948%"><p>优势</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="23.20767923207679%"><ul><li>缺少足量数据集和训练资源</li><li>追求高易用性</li></ul> </td> <td class="cellrowborder" valign="top" width="21.71782821717828%"><ul><li>可运行TensorFlow环境</li><li>模型pb文件（需要开发者自行转换）</li><li>校准集</li></ul> </td> <td class="cellrowborder" valign="top" width="19.838016198380156%"><p>Quant_INT8-8</p> </td> <td class="cellrowborder" valign="top" width="18.188181181881806%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/cannkit-no-training-and-quantization#section293645783311">TensorFlow无训练量化</a></p> </td> <td class="cellrowborder" valign="top" width="17.048295170482948%"><p>无需TensorFlow编写代码，新手开发者友好</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="23.20767923207679%"><ul><li>对精度要求较高</li><li>有足够数据集和训练资源</li><li>有一定编程能力</li><li>持有模型训练工程</li></ul> </td> <td class="cellrowborder" valign="top" width="21.71782821717828%"><ul><li>可运行TensorFlow环境</li><li>模型的ckpt文件</li><li>训练集</li><li>测试集</li><li>开发者需要在训练工程中调用轻量化工具API量化模型并进行重训练</li></ul> </td> <td class="cellrowborder" valign="top" width="19.838016198380156%"><p>Quant_INT8-8</p> </td> <td class="cellrowborder" valign="top" width="18.188181181881806%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/cannkit-plugin-based-quantization#section16110815547">TensorFlow插件式量化</a></p> </td> <td class="cellrowborder" valign="top" width="17.048295170482948%"><p>模型精度可保障</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="23.20767923207679%"><ul><li>需要自动生成符合需求的网络结构</li></ul> </td> <td class="cellrowborder" valign="top" width="21.71782821717828%"><ul><li><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/cannkit-network-structure-search-training#section193737375169">环境准备</a></li><li>训练集</li><li>测试集</li><li>开发者需要根据说明书编写模型接口代码</li></ul> </td> <td class="cellrowborder" valign="top" width="19.838016198380156%"><p>搜索生成网络结构</p> </td> <td class="cellrowborder" valign="top" width="18.188181181881806%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/cannkit-network-structure-search-training">网络结构搜索训练</a></p> </td> <td class="cellrowborder" valign="top" width="17.048295170482948%"><p>可根据开发者提供的配置信息自动搜索到在特定场景上表现优秀的网络结构</p> </td> </tr>  </tbody></table></div> </div> </div> <div class="tiledSection"><h3 id="section6734124191510">PyTorch开发者<i class="anchor-icon anchor-icon-link" anchorid="section6734124191510" tips="复制节点链接"></i></h3> <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.6.2.1.6.1.1" valign="top" width="23.292329232923294%"><p><strong>开发者场景</strong></p> </th> <th align="left" class="cellrowborder" id="mcps1.3.6.2.1.6.1.2" valign="top" width="22.142214221422144%"><p><strong>使用依赖</strong></p> </th> <th align="left" class="cellrowborder" id="mcps1.3.6.2.1.6.1.3" valign="top" width="19.86198619861986%"><p><strong>工具链提供功能</strong></p> </th> <th align="left" class="cellrowborder" id="mcps1.3.6.2.1.6.1.4" valign="top" width="17.23172317231723%"><p><strong>建议使用工具</strong></p> </th> <th align="left" class="cellrowborder" id="mcps1.3.6.2.1.6.1.5" valign="top" width="17.47174717471747%"><p><strong>优势</strong></p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="23.292329232923294%"><ul><li>缺少足量数据集和训练资源</li><li>追求高易用性</li></ul> </td> <td class="cellrowborder" valign="top" width="22.142214221422144%"><ul><li>可运行PyTorch环境</li><li>模型参数文件pth</li><li>python模型定义</li><li>校准集</li></ul> </td> <td class="cellrowborder" valign="top" width="19.86198619861986%"><p>Quant_INT8-8</p> </td> <td class="cellrowborder" valign="top" width="17.23172317231723%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/cannkit-no-training-and-quantization#section18483131873820">PyTorch无训练量化</a></p> </td> <td class="cellrowborder" valign="top" width="17.47174717471747%"><p>无需PyTorch编写代码，新手开发者友好</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="23.292329232923294%"><ul><li>对精度要求较高</li><li>有足够数据集和训练资源</li><li>有一定编程能力</li></ul> </td> <td class="cellrowborder" valign="top" width="22.142214221422144%"><ul><li>可运行PyTorch环境</li><li>模型参数文件pth</li><li>训练集</li><li>测试集</li><li>开发者需要调用轻量化工具API量化模型并进行重训练</li></ul> </td> <td class="cellrowborder" valign="top" width="19.86198619861986%"><p>Quant_INT8-8</p> </td> <td class="cellrowborder" valign="top" width="17.23172317231723%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/cannkit-plugin-based-quantization#section162431930104618">PyTorch插件式量化</a></p> </td> <td class="cellrowborder" valign="top" width="17.47174717471747%"><p>模型精度可保障</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="23.292329232923294%"><ul><li>需要自动生成符合需求的网络结构</li></ul> </td> <td class="cellrowborder" valign="top" width="22.142214221422144%"><ul><li><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/cannkit-network-structure-search-training#section193737375169">环境准备</a></li><li>训练集</li><li>测试集</li><li>开发者需要根据说明书编写模型接口代码</li></ul> </td> <td class="cellrowborder" valign="top" width="19.86198619861986%"><p>搜索生成网络结构</p> </td> <td class="cellrowborder" valign="top" width="17.23172317231723%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/cannkit-network-structure-search-training">网络结构搜索训练</a></p> </td> <td class="cellrowborder" valign="top" width="17.47174717471747%"><p>可根据开发者提供的配置信息自动搜索到在特定场景上表现优秀的网络结构</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="23.292329232923294%"><ul><li>需要对大语言模型进行4bit权重量化</li></ul> </td> <td class="cellrowborder" valign="top" width="22.142214221422144%"><ul><li>训练集</li><li>开发者根据说明书生成配置文件和执行脚本</li><li>脚本执行量化</li></ul> </td> <td class="cellrowborder" valign="top" width="19.86198619861986%"><p>Quant_INT16-4</p> </td> <td class="cellrowborder" valign="top" width="17.23172317231723%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/cannkit-large-language-model">大语言模型低位量化</a></p> </td> <td class="cellrowborder" valign="top" width="17.47174717471747%"><p>超大规模模型，权重压缩至4bit</p> </td> </tr>  </tbody></table></div> </div> </div> <div class="tiledSection"><h3 id="section433191616415">ONNX开发者<i class="anchor-icon anchor-icon-link" anchorid="section433191616415" tips="复制节点链接"></i></h3> <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.7.2.1.6.1.1" valign="top" width="23.732373237323735%"><p><strong>开发者场景</strong></p> </th> <th align="left" class="cellrowborder" id="mcps1.3.7.2.1.6.1.2" valign="top" width="22.21222122212221%"><p><strong>开发者需要准备</strong></p> </th> <th align="left" class="cellrowborder" id="mcps1.3.7.2.1.6.1.3" valign="top" width="19.48194819481948%"><p><strong>工具链提供功能</strong></p> </th> <th align="left" class="cellrowborder" id="mcps1.3.7.2.1.6.1.4" valign="top" width="16.75167516751675%"><p><strong>建议使用工具</strong></p> </th> <th align="left" class="cellrowborder" id="mcps1.3.7.2.1.6.1.5" valign="top" width="17.82178217821782%"><p>优势</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="23.732373237323735%"><ul><li>缺少足量数据集和训练资源</li><li>追求高易用性</li></ul> </td> <td class="cellrowborder" valign="top" width="22.21222122212221%"><ul><li>可运行ONNX Runtime环境</li><li>ONNX model</li><li>校准集</li></ul> </td> <td class="cellrowborder" valign="top" width="19.48194819481948%"><p>Quant_INT8-8</p> </td> <td class="cellrowborder" valign="top" width="16.75167516751675%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/cannkit-no-training-and-quantization#section1262217244312">ONNX模型无训练量化</a></p> </td> <td class="cellrowborder" valign="top" width="17.82178217821782%"><p>无需编写代码，新手开发者友好</p> </td> </tr>  </tbody></table></div> </div> </div> </div> <div></div></div>