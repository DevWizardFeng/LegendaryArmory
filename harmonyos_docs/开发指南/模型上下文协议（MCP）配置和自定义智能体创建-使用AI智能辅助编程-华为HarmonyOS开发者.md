<h1 _ngcontent-xsu-c119="" class="doc-title ng-star-inserted" title="模型上下文协议（MCP）配置和自定义智能体创建"> 模型上下文协议（MCP）配置和自定义智能体创建 </h1>

<div _ngcontent-xsu-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div id="body0000002449340124"><p id="ZH-CN_TOPIC_0000002478174494__p615841612113">从DevEco Studio 6.0.1 Beta1开始，CodeGenie支持用户添加模型和自定义Agent，增强AI问答能力，提升AI辅助编程和分析能力。自定义过程包括模型上下文协议（Model Context Protocol，简称MCP）配置、模型（Model）配置、智能体（Agent）配置和调用。</p> <div class="tiledSection"><h2 id="section1918313413580">MCP配置<i class="anchor-icon anchor-icon-link" anchorid="section1918313413580" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002478174494__p96241957185715">为确保MCP Server正常启动，需要安装npx和uvx。其中，npx依赖于Node.js，建议使用Node.js的LTS版本；uvx是基于Python的快速执行工具，建议安装Python 3.9 以上的版本。</p> <ol id="ZH-CN_TOPIC_0000002478174494__ol662681218011"><li id="li862620121908"><span>点击页面右侧菜单栏CodeGenie图标，完成登录后。点击界面右上方<strong>Settings</strong><span><img originheight="20" originwidth="22" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104758.45787123079480166621130904675097:50001231000000:2800:C8CEE5F1BB51CA1559BA2E525BC351B07DA1921970D57E6A511D62AB68315795.png" class="IconPic notEnlarge" width="22" height="20"></span>按钮，选择<strong>MCP </strong><strong>Settings</strong>，进入配置页面。</span><p></p><p id="ZH-CN_TOPIC_0000002478174494__p33611328141013"><span><img originheight="336" originwidth="758" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104758.85836871229021524458943517753960:50001231000000:2800:DB834774734AD0A3EB48C5319EE660466954B3EED616401D94198C482AA429C6.png" width="758" height="336"></span></p> <p></p></li><li id="li1222914181862"><span>点击<span><img height="19.373312000000002" originheight="20" originwidth="20" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104759.32123040957286764862375005131264:50001231000000:2800:119D6FB32AEAAE6E55DFF58B450C47140128ADDA66190FCFAB8A93235555A8EC.png" width="19.373312000000002" class="IconPic notEnlarge"></span>按钮，添加MCP工具。</span><p></p><p id="ZH-CN_TOPIC_0000002478174494__p188571030131110"><span><img height="187.8093" originheight="251" originwidth="631" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104759.67674476605871068654336373488706:50001231000000:2800:3A159B16D8C20A6B7163837F1DD263F19FAA86722FD5FB5F2E2EDD9BC8EBD2EF.png" title="点击放大" width="465.5"></span></p> <p></p></li><li id="li12508244191217"><span>在编辑框中填写MCP工具的配置信息，填写完成后点击<strong>Add</strong>。</span><p></p><div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p id="ZH-CN_TOPIC_0000002478174494__p1489813152318">MCP  Server支持三种通信方式：Stdio 、Server-Sent Events (SSE) 和Streamable HTTP。</p> <p id="ZH-CN_TOPIC_0000002478174494__p74351487111">Stdio方式支持配置cmd、args和env字段，SSE和Streamable HTTP方式支持配置url字段。</p> </div></div></div> <p id="ZH-CN_TOPIC_0000002478174494__p14968151313383"><span><img height="554.7962" originheight="752" originwidth="630" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104759.31749465717680964499007259750821:50001231000000:2800:57372A175213EB454A6C1F19398DA0CC8488CBF29488FD5A221CD8D8C1FA503E.png" title="点击放大" width="465.5"></span></p> <p></p></li><li id="li164025131112"><span>在<strong>Added Tools</strong>列表中，展示所有MCP工具信息，包括名称、连接状态、启用状态。同时，将鼠标悬浮在工具上会显示三个操作按钮：刷新、编辑和删除，方便开发者管理工具。</span><p></p><div class="p" id="ZH-CN_TOPIC_0000002478174494__p3583232113616"><span><img height="202.8649" originheight="364" originwidth="843" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104759.26526974257043984641853387909980:50001231000000:2800:D012DC788BBF686195E920EEB7F6A37A50F53A55FEEDA5354D41A971F0CD1B84.png" title="点击放大" width="465.5"></span><ul id="ZH-CN_TOPIC_0000002478174494__ul1011861312366"><li id="li141181013193616">名称：MCP工具名称，如Context7、Time。</li><li id="li111189138367">连接状态：工具连接状态，包括“成功”、“失败”和“连接中”三种状态。</li><li id="li151181313133619">启用状态：工具是否已启用。</li></ul> </div> <p></p></li></ol> </div> <div class="tiledSection"><h2 id="section13929843125813">模型配置<i class="anchor-icon anchor-icon-link" anchorid="section13929843125813" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002478174494__p8843915132511">CodeGenie支持通过OpenAI-API协议接入第三方模型，为自定义Agent提供多样化的模型选择。</p> <ol id="ZH-CN_TOPIC_0000002478174494__ol151961826183410"><li id="li439327173416"><span>点击界面右上方<strong>Settings</strong><span><img originheight="20" originwidth="22" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104759.49368292984394856891777950916595:50001231000000:2800:1239FA43E80F6C9CF32F956F3CC7F5611109C098153B6660BC53E68B952DA157.png" class="IconPic notEnlarge" width="22" height="20"></span>按钮，选择<strong>Model Settings</strong>，进入配置页面。</span><p></p><p id="ZH-CN_TOPIC_0000002478174494__p1422185019109"><span><img height="150.5427" originheight="200" originwidth="631" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104759.05498360016766247056278706995897:50001231000000:2800:855B139330F41C7725FD3D51210B16216D86873A5747ACE14AD9DD50B5CC833C.png" title="点击放大" width="465.5"></span></p> <p></p></li><li id="li44018275341"><span>点击<span><img height="19.373312000000002" originheight="20" originwidth="20" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104759.64688197548054678186541412300142:50001231000000:2800:A6EDAFB63D43CF8EC9BC3481F7647A93A7CFBF261B72D7DA0A988F5FDF385862.png" width="19.373312000000002" class="IconPic notEnlarge"></span>按钮，填写相关信息。点击<strong>Add</strong>，校验成功的模型将被添加到列表中。</span><p></p><ul id="ZH-CN_TOPIC_0000002478174494__ul6172153917359"><li id="li917273916354"><strong>Name</strong>：模型名称。</li><li id="li71791852173517"><strong>Url</strong>：模型的访问地址。</li><li id="li166216599356"><strong>API Key</strong>：模型的访问密钥。</li><li id="li7341840362"><strong>Model</strong>：模型的标识。</li></ul> <p id="ZH-CN_TOPIC_0000002478174494__p1865613210710"><span><img height="271.2402" originheight="364" originwidth="629" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104759.96015233495198838282664918897644:50001231000000:2800:3C11997E5DFE34283FE8BD93823AD8043DAD949CB763E7B7D4432E80F55440FB.png" title="点击放大" width="465.5"></span></p> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p id="ZH-CN_TOPIC_0000002478174494__p149152092618">当前仅支持添加遵循OpenAI-API规范的模型。</p> </div></div></div> <p></p></li><li id="li182401319182215"><span>在<strong>All Models</strong>下展示所有添加成功的模型。将鼠标悬浮在模型上会显示两个操作按钮：编辑、删除，方便开发者管理模型。</span><p></p><p id="ZH-CN_TOPIC_0000002478174494__p6513114112718"><span><img height="161.7546" originheight="215" originwidth="630" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104759.33645588345423449664308220717289:50001231000000:2800:DC6C8AAC45973B7C69C4AACB473CF51E3F2DD700F00E9196CDF25459ADE64AFE.png" title="点击放大" width="465.5"></span></p> <p></p></li></ol> </div> <div class="tiledSection"><h2 id="section6999115213304">Agent配置<i class="anchor-icon anchor-icon-link" anchorid="section6999115213304" tips="复制节点链接"></i></h2><ol id="ZH-CN_TOPIC_0000002478174494__ol139031115153019"><li id="li1090461543015"><span>点击界面右上方<strong>Settings</strong><span><img originheight="20" originwidth="22" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104759.37855978718316890879116037756433:50001231000000:2800:9EB3D0C8A506A66445AD79FD40FEB744E39484E9D697A6FC958EE8933E530737.png" class="IconPic notEnlarge" width="22" height="20"></span>按钮，选择<strong>Agent </strong><strong>Settings</strong>；或者在输入框左下角下拉框选择<strong>Create an Agent</strong>，进入配置页面。</span><p></p><p id="ZH-CN_TOPIC_0000002478174494__p16401191724512"><span><img originheight="857" originwidth="540" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104759.91268784099732237268119411905165:50001231000000:2800:4BFC31297280BCC3DEDF9CD4977CBB3A42C59648338D64B005E94902E4782BEF.png" width="540" height="857"></span></p> <p></p></li><li id="li163941335173012"><span>点击<span><img height="19.373312000000002" originheight="20" originwidth="20" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104759.14246412268407337054938391569661:50001231000000:2800:88AF3302C29CE69A99506C94F6D97FE7FDC191C8A3E853672DB7DA61BBF31279.png" width="19.373312000000002" class="IconPic notEnlarge"></span>按钮，填写自定义Agent的相关信息。点击<strong>Add</strong>，将创建自定义Agent。</span><p></p><ul id="ZH-CN_TOPIC_0000002478174494__ul257753185017"><li id="li11577031125013"><strong>Name</strong>：必填，自定义Agent的名称。</li><li id="li957763119501"><strong>Prompt description</strong>：可选，自定义Agent的提示词。</li><li id="li1957793195011"><strong>Added Tools</strong>：可选，添加MCP工具。具体请参考<a href="/consumer/cn/doc/harmonyos-guides/ide-mcp-agent#section1918313413580">MCP配置</a>。</li><li id="li1157723114505"><strong>Select Model</strong>：必填，选择需要使用的模型。具体请参考<a href="/consumer/cn/doc/harmonyos-guides/ide-mcp-agent#section13929843125813">模型配置</a>。</li></ul> <p id="ZH-CN_TOPIC_0000002478174494__p15767617135014"><span><img height="501.37010000000004" originheight="679" originwidth="630" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104759.14188421748378895503840791752905:50001231000000:2800:F872C4F89C24B9B76FBD8E655A46B7B8DA35469A185F1FCB3D63E097605984A6.png" title="点击放大" width="465.5"></span></p> <p></p></li><li id="li42975452364"><span>在<strong>All Agents</strong>下展示所有内置（HarmonyOS Ask、Generate UI Code、Service Widget）和自定义的Agent（如figma2code）。</span><p></p><p id="ZH-CN_TOPIC_0000002478174494__p12521014164519"><span><img height="218.10670000000002" originheight="292" originwidth="630" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104759.88982395009611584700191496041244:50001231000000:2800:A9BE09502695BC197DD0ED6BB66A9F0C4DE3D9D39EDD2F7BE9A45AA434B2DA16.png" title="点击放大" width="465.5"></span></p> <p></p></li></ol> </div> <div class="tiledSection"><h2 id="section1617693325814">Agent调用<i class="anchor-icon anchor-icon-link" anchorid="section1617693325814" tips="复制节点链接"></i></h2><ol id="ZH-CN_TOPIC_0000002478174494__ol1413612353598"><li id="li1013763545914"><span>Agent配置完成后，在对话区域输入"/"调出命令，选择自定义的Agent（如figma2code）；或者在输入框左下角HarmonyOS Ask处下拉框中选择自定义的Agent（如figma2code）。</span><p></p><p id="ZH-CN_TOPIC_0000002478174494__p7390203020561"><span><img originheight="258" originwidth="538" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104759.85953184810172350338207510598633:50001231000000:2800:40E8CAA1CEAAB88DC2706589CDAC80BC9FAE49C882F4533596B26E7CDEBF01D8.png" width="538" height="258"></span></p> <p></p></li><li id="li19179527135615"><span id="ZH-CN_TOPIC_0000002478174494__p68244268115">选择自定义的Agent后，在右侧可以切换模型，默认使用<a href="/consumer/cn/doc/harmonyos-guides/ide-mcp-agent#li163941335173012">配置Agent时添加的模型</a>。</span><p></p><p id="ZH-CN_TOPIC_0000002478174494__p42222037125713"><span><img height="145.38230000000001" originheight="192" originwidth="628" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104759.90499485355927091162287048247929:50001231000000:2800:CE227EAEC4511E9BF74C8F2F79FCF642DB5392ADF6B5CD2B39F56DA0A7F4F550.png" title="点击放大" width="465.5"></span></p> <p></p></li><li id="li3792123411315"><span>根据业务需要，进行智能问答、代码生成、代码智能解读等，CodeGenie将会调用自定义的Agent和选择的模型生成内容。若Agent已添加MCP工具，界面会有授权弹框。</span><p></p><p id="ZH-CN_TOPIC_0000002478174494__p172961327636"><span><img height="174.33640000000003" originheight="288" originwidth="779" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104800.26895011142030131262640657546308:50001231000000:2800:04F1484FDA4EB9FBE02D360F230093F0FE613E72FF723C365DE26B23522326E8.png" title="点击放大" width="465.5"></span></p> <p></p></li></ol> </div> </div></div>