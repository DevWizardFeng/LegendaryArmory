<h1 _ngcontent-fuc-c119="" class="doc-title ng-star-inserted" title="正地理编码与逆地理编码开发指导"> 正地理编码与逆地理编码开发指导 </h1>

<div _ngcontent-fuc-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div><div class="tiledSection"><h2 id="场景概述">场景概述<i class="anchor-icon anchor-icon-link" anchorid="场景概述" tips="复制节点链接"></i></h2><p>使用经纬度坐标描述一个位置，非常准确，但是并不直观，面向用户表达并不友好。系统向开发者提供了以下两种转化能力。</p> <ul><li><p>正地理编码：将地理位置信息转化为具体经纬度坐标。</p> </li><li><p>逆地理编码：将具体的经纬度坐标转化为地理位置信息。</p> </li></ul> <p>其中地理编码包含多个属性来描述位置，包括国家、行政区划、街道、门牌号、地址描述等等，这样的信息更便于用户理解。</p> </div> <div class="tiledSection"><h2 id="接口说明">接口说明<i class="anchor-icon anchor-icon-link" anchorid="接口说明" tips="复制节点链接"></i></h2><p>进行经纬度坐标和地理位置信息的相互转化，所使用的接口说明如下，详细信息参见：<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/location-api" target="_blank">Location Kit API参考</a>。</p> </div> <div class="tiledSection"><h2 id="section46917143211">接口介绍<i class="anchor-icon anchor-icon-link" anchorid="section46917143211" tips="复制节点链接"></i></h2> <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.3.2.1.3.1.1" valign="top" width="50%"><p>接口名</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.3.2.1.3.1.2" valign="top" width="50%"><p>功能描述</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="50%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-geolocationmanager#geolocationmanagerisgeocoderavailable" target="_blank">isGeocoderAvailable(): boolean;</a></p> </td> <td class="cellrowborder" valign="top" width="50%"><p>判断正地理编码与逆地理编码服务是否可用。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="50%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-geolocationmanager#geolocationmanagergetaddressesfromlocation" target="_blank">getAddressesFromLocation(request: ReverseGeoCodeRequest, callback: AsyncCallback&lt;Array&lt;GeoAddress&gt;&gt;): void</a></p> </td> <td class="cellrowborder" valign="top" width="50%"><p>调用逆地理编码服务，将经纬度坐标转换为地理位置信息，使用callback回调异步返回结果。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="50%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-geolocationmanager#geolocationmanagergetaddressesfromlocationname" target="_blank">getAddressesFromLocationName(request: GeoCodeRequest, callback: AsyncCallback&lt;Array&lt;GeoAddress&gt;&gt;): void</a></p> </td> <td class="cellrowborder" valign="top" width="50%"><p>调用正地理编码服务，将地理位置信息转换为具体经纬度坐标，使用callback回调异步返回结果。</p> </td> </tr>  </tbody></table></div> </div> </div> <div class="tiledSection"><h2 id="开发步骤">开发步骤<i class="anchor-icon anchor-icon-link" anchorid="开发步骤" tips="复制节点链接"></i></h2><div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p>正地理编码与逆地理编码功能需要访问后端服务，请确保设备联网，以进行信息获取。</p> </div></div></div> <ol><li><p>导入geoLocationManager模块，所有与正地理编码&amp;逆地理编码能力相关的功能API，都是通过该模块提供的。</p> <div _ngcontent-fuc-c106="" class="highlight-div"><div _ngcontent-fuc-c106="" class="highlight-div-header"><div _ngcontent-fuc-c106="" class="highlight-div-header-left"><div _ngcontent-fuc-c106="" class="handle-button expand-button"><div _ngcontent-fuc-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fuc-c106="" class="highlight-div-header-right"><div _ngcontent-fuc-c106="" class="handle-button ai-button"></div><div _ngcontent-fuc-c106="" class="handle-button line-button"><div _ngcontent-fuc-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fuc-c106="" class="handle-button theme-button"><div _ngcontent-fuc-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fuc-c106="" class="handle-button copy-button"><div _ngcontent-fuc-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fuc-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { geoLocationManager } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.LocationKit'</span>;</li></ol></pre></div></div> </li><li><p>查询正地理编码与逆地理编码服务是否可用。</p> <ul><li><p>调用isGeoServiceAvailable查询正地理编码与逆地理编码服务是否可用，如果服务可用再继续进行步骤3。如果服务不可用，说明该设备不具备正地理编码与逆地理编码能力，请勿使用相关接口。</p> <div _ngcontent-fuc-c106="" class="highlight-div"><div _ngcontent-fuc-c106="" class="highlight-div-header"><div _ngcontent-fuc-c106="" class="highlight-div-header-left"><div _ngcontent-fuc-c106="" class="handle-button expand-button"><div _ngcontent-fuc-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fuc-c106="" class="highlight-div-header-right"><div _ngcontent-fuc-c106="" class="handle-button ai-button"></div><div _ngcontent-fuc-c106="" class="handle-button line-button"><div _ngcontent-fuc-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fuc-c106="" class="handle-button theme-button"><div _ngcontent-fuc-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fuc-c106="" class="handle-button copy-button"><div _ngcontent-fuc-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fuc-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { geoLocationManager } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.LocationKit'</span>;</li><li><span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">let</span> isAvailable = geoLocationManager.<span class="hljs-title function_">isGeocoderAvailable</span>();</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"errCode:"</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));</li><li>}</li></ol></pre></div></div> </li></ul> </li><li><p>获取转化结果。</p> <ul><li><p>调用getAddressesFromLocation，把经纬度坐标转化为地理位置信息。应用可以获得与此坐标匹配的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-geolocationmanager#geoaddress" target="_blank">GeoAddress</a>（地理编码地址信息）列表，应用可以根据实际使用需求，读取相应的参数数据。</p> <div _ngcontent-fuc-c106="" class="highlight-div"><div _ngcontent-fuc-c106="" class="highlight-div-header"><div _ngcontent-fuc-c106="" class="highlight-div-header-left"><div _ngcontent-fuc-c106="" class="handle-button expand-button"><div _ngcontent-fuc-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fuc-c106="" class="highlight-div-header-right"><div _ngcontent-fuc-c106="" class="handle-button ai-button"></div><div _ngcontent-fuc-c106="" class="handle-button line-button"><div _ngcontent-fuc-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fuc-c106="" class="handle-button theme-button"><div _ngcontent-fuc-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fuc-c106="" class="handle-button copy-button"><div _ngcontent-fuc-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fuc-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">let</span> <span class="hljs-attr">reverseGeocodeRequest</span>:geoLocationManager.<span class="hljs-property">ReverseGeoCodeRequest</span> = {<span class="hljs-string">"latitude"</span>: <span class="hljs-number">31.12</span>, <span class="hljs-string">"longitude"</span>: <span class="hljs-number">121.11</span>, <span class="hljs-string">"maxItems"</span>: <span class="hljs-number">1</span>};</li><li><span class="hljs-keyword">try</span> {</li><li>    geoLocationManager.<span class="hljs-title function_">getAddressesFromLocation</span>(reverseGeocodeRequest, <span class="hljs-function">(<span class="hljs-params">err, data</span>) =&gt;</span> {</li><li>        <span class="hljs-keyword">if</span> (err) {</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'getAddressesFromLocation err: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));</li><li>        } <span class="hljs-keyword">else</span> {</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'getAddressesFromLocation data: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data));</li><li>        }</li><li>    });</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"errCode:"</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));</li><li>}</li></ol></pre></div></div> </li><li><p>调用getAddressesFromLocationName把位置信息转化为经纬度坐标。</p> <div _ngcontent-fuc-c106="" class="highlight-div"><div _ngcontent-fuc-c106="" class="highlight-div-header"><div _ngcontent-fuc-c106="" class="highlight-div-header-left"><div _ngcontent-fuc-c106="" class="handle-button expand-button"><div _ngcontent-fuc-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-fuc-c106="" class="highlight-div-header-right"><div _ngcontent-fuc-c106="" class="handle-button ai-button"></div><div _ngcontent-fuc-c106="" class="handle-button line-button"><div _ngcontent-fuc-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-fuc-c106="" class="handle-button theme-button"><div _ngcontent-fuc-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-fuc-c106="" class="handle-button copy-button"><div _ngcontent-fuc-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-fuc-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">let</span> <span class="hljs-attr">geocodeRequest</span>:geoLocationManager.<span class="hljs-property">GeoCodeRequest</span> = {<span class="hljs-string">"description"</span>: <span class="hljs-string">"上海市浦东新区xx路xx号"</span>, <span class="hljs-string">"maxItems"</span>: <span class="hljs-number">1</span>};</li><li><span class="hljs-keyword">try</span> {</li><li>    geoLocationManager.<span class="hljs-title function_">getAddressesFromLocationName</span>(geocodeRequest, <span class="hljs-function">(<span class="hljs-params">err, data</span>) =&gt;</span> {</li><li>        <span class="hljs-keyword">if</span> (err) {</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'getAddressesFromLocationName err: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));</li><li>        } <span class="hljs-keyword">else</span> {</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'getAddressesFromLocationName data: '</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data));</li><li>        }</li><li>    });</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"errCode:"</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(err));</li><li>}</li></ol></pre></div></div> <p>应用可以获得与位置描述相匹配的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-geolocationmanager#geoaddress" target="_blank">GeoAddress</a>（地理编码地址信息）列表，其中包含对应的坐标数据。</p> <p>如果需要查询的位置描述可能出现多地重名的请求，可以设置<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-geolocationmanager#geocoderequest" target="_blank">GeoCodeRequest</a>，通过设置一个经纬度范围，以高效地获取期望的准确结果。</p> </li></ul> </li></ol> </div> </div> <div></div></div>