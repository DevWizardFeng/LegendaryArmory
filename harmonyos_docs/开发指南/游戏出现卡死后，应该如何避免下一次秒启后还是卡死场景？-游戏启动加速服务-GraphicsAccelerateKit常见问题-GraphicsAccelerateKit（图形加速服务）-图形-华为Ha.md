<h1 _ngcontent-ypo-c119="" class="doc-title ng-star-inserted" title="游戏出现卡死后，应该如何避免下一次秒启后还是卡死场景？"> 游戏出现卡死后，应该如何避免下一次秒启后还是卡死场景？ </h1>

<div _ngcontent-ypo-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div><p>建议游戏上划退出后进行场景切换操作，若场景切换超时（5s）则设置游戏不支持缓存后快速启动。</p> <p>示例代码：</p> <div _ngcontent-ypo-c106="" class="highlight-div"><div _ngcontent-ypo-c106="" class="highlight-div-header"><div _ngcontent-ypo-c106="" class="highlight-div-header-left"><div _ngcontent-ypo-c106="" class="handle-button expand-button"><div _ngcontent-ypo-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ypo-c106="" class="highlight-div-header-right"><div _ngcontent-ypo-c106="" class="handle-button ai-button"></div><div _ngcontent-ypo-c106="" class="handle-button line-button"><div _ngcontent-ypo-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ypo-c106="" class="handle-button theme-button"><div _ngcontent-ypo-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ypo-c106="" class="handle-button copy-button"><div _ngcontent-ypo-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ypo-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-title function_">onWindowStageWillDestroy</span>(<span class="hljs-attr">windowStage</span>: <span class="hljs-variable language_">window</span>.<span class="hljs-property">WindowStage</span>): <span class="hljs-built_in">void</span> {</li><li>  <span class="hljs-title class_">TuanjieLog</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'%{public}s'</span>, <span class="hljs-string">'TuanjiePlayerAbility onWindowStageWillDestroy'</span>);</li><li>  <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">isLaunchSnapshotEnabled</span>()) {</li><li>    globalThis.<span class="hljs-property">isCacheStatus</span> = <span class="hljs-literal">true</span>;</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">onResume</span>();</li><li>    <span class="hljs-title class_">Tuanjie</span>.<span class="hljs-title class_">TuanjieSendMessage</span>(<span class="hljs-string">"GlobalObjectForArkTSCall"</span>, <span class="hljs-string">"OnMessageCall"</span>, <span class="hljs-string">"SwitchToLoginPage"</span>);</li><li>    <span class="hljs-keyword">let</span> waitTime = <span class="hljs-number">0</span>;</li><li>    <span class="hljs-keyword">while</span>(<span class="hljs-literal">true</span>) {</li><li>      <span class="hljs-keyword">let</span> sceneChangeComplete = dataPreferences?.<span class="hljs-title function_">getSync</span>(<span class="hljs-string">'sceneChangeComplete'</span>, <span class="hljs-literal">false</span>);</li><li>      <span class="hljs-keyword">if</span> (sceneChangeComplete) {</li><li>        <span class="hljs-keyword">break</span>;</li><li>      }</li><li>      <span class="hljs-keyword">if</span> (waitTime &gt;= <span class="hljs-number">5000</span>) {</li><li>        <span class="hljs-comment">//若场景切换超时,则设置游戏不支持缓存后快速启动</span></li><li>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_">canIUse</span>(<span class="hljs-string">"SystemCapability.GraphicsGame.LaunchAcceleration"</span>)) {</li><li>            <span class="hljs-keyword">try</span> {</li><li>              <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">getApplicationContext</span>().<span class="hljs-title function_">setSupportedProcessCache</span>(<span class="hljs-literal">false</span>);</li><li>            } <span class="hljs-keyword">catch</span> (error) {</li><li>              <span class="hljs-keyword">let</span> code = (error <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">code</span>;</li><li>              <span class="hljs-keyword">let</span> message = (error <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>).<span class="hljs-property">message</span>;</li><li>              <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`setSupportedProcessCache fail, code: <span class="hljs-subst">${code}</span>, msg: <span class="hljs-subst">${message}</span>`</span>);</li><li>            }</li><li>        }</li><li>        <span class="hljs-keyword">break</span>;</li><li>      }</li><li>      sleepNapi.<span class="hljs-title function_">sleep</span>(<span class="hljs-number">500</span>);</li><li>      waitTime += <span class="hljs-number">500</span>;</li><li>    }</li><li>    sleepNapi.<span class="hljs-title function_">sleep</span>(<span class="hljs-number">500</span>);</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">onPause</span>();</li><li>  }</li><li>}</li></ol></pre></div></div> </div> <div></div></div>