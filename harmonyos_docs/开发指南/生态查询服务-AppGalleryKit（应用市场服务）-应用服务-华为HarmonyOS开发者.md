<h1 _ngcontent-cjm-c119="" class="doc-title ng-star-inserted" title="生态查询服务"> 生态查询服务 </h1>

<div _ngcontent-cjm-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <div class="tiledSection">     <h2 id="section10343164404617">场景介绍<i class="anchor-icon anchor-icon-link" anchorid="section10343164404617" tips="复制节点链接"></i></h2>          <p>生态查询服务可以为您提供应用/元服务运行信息的查询，当前提供场景值查询和广告验签信息查询。场景值是用来描述用户进入应用和元服务的路径。您可以通过本服务，来查询您的元服务/应用是通过何种场景被打开的（<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/appgallery-scene-list#section126341258847">场景值列表</a>）。当前我们支持元服务的场景值查询，后续我们会继续公布应用场景值的查询。广告验签版本查询只在您的应用涉及广告场景下才会被使用到。您可以通过本查询服务，查询广告验签参数处理逻辑。</p>    </div>    <div class="tiledSection">     <h2 id="section193161550114115">业务流程<i class="anchor-icon anchor-icon-link" anchorid="section193161550114115" tips="复制节点链接"></i></h2>          <p><span><img height="361.004161" originheight="689" originwidth="1207" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114515.10759838690072475130971935012235:50001231000000:2800:751BE01DCF0ABEC4C89E3F78BC84AA90BB73357E2538C07B4239ADAB0F09356E.png" title="点击放大" width="632.4150000000001"></span></p>     <ol>      <li>用户需要查询应用/元服务自身场景值或者查询广告验签版本。</li>      <li>应用调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/store-scenemanager#section145261628122720" target="_blank">getSelfSceneCode</a>接口和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/store-scenemanager#section552702811279" target="_blank">getAdsVerificationVersion</a>接口分别获取自身场景值和广告验签版本。</li>      <li>返回自身场景值和广告验签版本给应用/元服务。</li>      <li>返回结果给用户。</li>     </ol>    </div>    <div class="tiledSection">     <h2 id="section2933193284216">约束与限制<i class="anchor-icon anchor-icon-link" anchorid="section2933193284216" tips="复制节点链接"></i></h2>          <ul>      <li>生态查询服务支持Phone、Tablet、PC/2in1设备。并且从5.1.1(19)版本开始，新增支持TV设备。</li>      <li>如果应用或者元服务没有产生场景值，调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/store-scenemanager#section145261628122720" target="_blank">getSelfSceneCode</a>接口返回的场景值为空。</li>      <li>生态查询服务不支持模拟器，请使用真机调试。</li>     </ul>    </div>    <div class="tiledSection">     <h2 id="section6348454124618">接口说明<i class="anchor-icon anchor-icon-link" anchorid="section6348454124618" tips="复制节点链接"></i></h2>          <p>生态查询服务场景提供以下接口，具体API说明详见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/store-scenemanager" target="_blank">接口文档</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.4.3.1.3.1.1" valign="top" width="49.95%">          <p>接口名</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.4.3.1.3.1.2" valign="top" width="50.05%">          <p>描述</p></th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="49.95%">          <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/store-scenemanager#section145261628122720" target="_blank">getSelfSceneCode</a>():string</p></td>         <td class="cellrowborder" valign="top" width="50.05%">          <p>获取自身场景值。</p></td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="49.95%">          <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/store-scenemanager#section552702811279" target="_blank">getAdsVerificationVersion</a>(): number</p></td>         <td class="cellrowborder" valign="top" width="50.05%">          <p>查询广告验签版本。</p></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="section13726195434615">开发步骤<i class="anchor-icon anchor-icon-link" anchorid="section13726195434615" tips="复制节点链接"></i></h2>         </div>    <div class="tiledSection">     <h3 id="section156909366412" class="firsth2">查询自身场景值<i class="anchor-icon anchor-icon-link" anchorid="section156909366412" tips="复制节点链接"></i></h3>          <ol>      <li><span>导入模块。</span>       <p></p>       <div _ngcontent-cjm-c106="" class="highlight-div"><div _ngcontent-cjm-c106="" class="highlight-div-header"><div _ngcontent-cjm-c106="" class="highlight-div-header-left"><div _ngcontent-cjm-c106="" class="handle-button expand-button"><div _ngcontent-cjm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-cjm-c106="" class="highlight-div-header-right"><div _ngcontent-cjm-c106="" class="handle-button ai-button"></div><div _ngcontent-cjm-c106="" class="handle-button line-button"><div _ngcontent-cjm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-cjm-c106="" class="handle-button theme-button"><div _ngcontent-cjm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-cjm-c106="" class="handle-button copy-button"><div _ngcontent-cjm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-cjm-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li><span class="hljs-keyword">import</span> { sceneManager } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AppGalleryKit'</span>;</li></ol></pre></div></div>       <p></p></li>      <li><span>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/store-scenemanager#section145261628122720" target="_blank">getSelfSceneCode</a>方法。</span>       <p></p>       <div _ngcontent-cjm-c106="" class="highlight-div"><div _ngcontent-cjm-c106="" class="highlight-div-header"><div _ngcontent-cjm-c106="" class="highlight-div-header-left"><div _ngcontent-cjm-c106="" class="handle-button expand-button"><div _ngcontent-cjm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-cjm-c106="" class="highlight-div-header-right"><div _ngcontent-cjm-c106="" class="handle-button ai-button"></div><div _ngcontent-cjm-c106="" class="handle-button line-button"><div _ngcontent-cjm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-cjm-c106="" class="handle-button theme-button"><div _ngcontent-cjm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-cjm-c106="" class="handle-button copy-button"><div _ngcontent-cjm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-cjm-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">try</span> {</li><li>  <span class="hljs-keyword">const</span> <span class="hljs-attr">sceneCode</span>: <span class="hljs-built_in">string</span> = sceneManager.<span class="hljs-title function_">getSelfSceneCode</span>();</li><li>  hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0</span>, <span class="hljs-string">'TAG'</span>, <span class="hljs-string">"Succeeded in getting SelfSceneCode res = "</span> + sceneCode);</li><li>} <span class="hljs-keyword">catch</span> (error) {</li><li>  hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0</span>, <span class="hljs-string">'TAG'</span>, <span class="hljs-string">`getSelfSceneCode failed. code is <span class="hljs-subst">${error.code}</span>, message is <span class="hljs-subst">${error.message}</span>`</span>);</li><li>}</li></ol></pre></div></div>       <p></p></li>     </ol>    </div>    <div class="tiledSection">     <h3 id="section163531324711">查询广告验签版本<i class="anchor-icon anchor-icon-link" anchorid="section163531324711" tips="复制节点链接"></i></h3>          <ol>      <li><span>导入模块。</span>       <p></p>       <div _ngcontent-cjm-c106="" class="highlight-div"><div _ngcontent-cjm-c106="" class="highlight-div-header"><div _ngcontent-cjm-c106="" class="highlight-div-header-left"><div _ngcontent-cjm-c106="" class="handle-button expand-button"><div _ngcontent-cjm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-cjm-c106="" class="highlight-div-header-right"><div _ngcontent-cjm-c106="" class="handle-button ai-button"></div><div _ngcontent-cjm-c106="" class="handle-button line-button"><div _ngcontent-cjm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-cjm-c106="" class="handle-button theme-button"><div _ngcontent-cjm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-cjm-c106="" class="handle-button copy-button"><div _ngcontent-cjm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-cjm-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li><span class="hljs-keyword">import</span> { sceneManager } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AppGalleryKit'</span>;</li></ol></pre></div></div>       <p></p></li>      <li><span>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/store-scenemanager#section552702811279" target="_blank">getAdsVerificationVersion</a>方法。</span>       <p></p>       <div _ngcontent-cjm-c106="" class="highlight-div"><div _ngcontent-cjm-c106="" class="highlight-div-header"><div _ngcontent-cjm-c106="" class="highlight-div-header-left"><div _ngcontent-cjm-c106="" class="handle-button expand-button"><div _ngcontent-cjm-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-cjm-c106="" class="highlight-div-header-right"><div _ngcontent-cjm-c106="" class="handle-button ai-button"></div><div _ngcontent-cjm-c106="" class="handle-button line-button"><div _ngcontent-cjm-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-cjm-c106="" class="handle-button theme-button"><div _ngcontent-cjm-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-cjm-c106="" class="handle-button copy-button"><div _ngcontent-cjm-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-cjm-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">try</span> {</li><li>  <span class="hljs-keyword">const</span> <span class="hljs-attr">version</span>: <span class="hljs-built_in">number</span> = sceneManager.<span class="hljs-title function_">getAdsVerificationVersion</span>();</li><li>  hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0</span>, <span class="hljs-string">'TAG'</span>, <span class="hljs-string">"Succeeded in getting AdsVerificationVersion res = "</span> + version);</li><li>} <span class="hljs-keyword">catch</span> (error) {</li><li>  hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0</span>, <span class="hljs-string">'TAG'</span>, <span class="hljs-string">`getAdsVerificationVersion failed. code is <span class="hljs-subst">${error.code}</span>, message is <span class="hljs-subst">${error.message}</span>`</span>);</li><li>}</li></ol></pre></div></div>       <p></p></li>     </ol>    </div>   </div>   <div></div></div>