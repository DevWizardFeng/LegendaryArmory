<h1 _ngcontent-pbw-c119="" class="doc-title ng-star-inserted" title="用户相册资源使用指导"> 用户相册资源使用指导 </h1>

<div _ngcontent-pbw-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p>photoAccessHelper提供用户相册相关的接口，支持创建和删除相册，以及添加和删除相册中的图片和视频资源。</p>    <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">      <p>在进行功能开发前，请查阅<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/photoaccesshelper-preparation">开发准备</a>，了解如何获取相册管理模块实例和申请相关权限。</p>      <p>文档中使用到photoAccessHelper的地方默认为使用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/photoaccesshelper-preparation">开发准备</a>中获取的对象，如未添加此段代码报photoAccessHelper未定义的错误请自行添加。</p>     </div></div></div>    <p>为了保证应用的运行效率，大部分photoAccessHelper的接口调用都是异步的。以下异步调用的API示例均采用Promise函数，更多方式可以查阅<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-photoaccesshelper" target="_blank">API参考</a>。</p>    <p>如无特别说明，文档中涉及的待获取资源均视为已预置，并且数据库中存在相应数据。如果按照示例代码执行后获取资源为空，请确认文件是否已预置，以及数据库中是否存在该文件的数据。</p>    <div class="tiledSection">     <h2 id="获取用户相册">获取用户相册<i class="anchor-icon anchor-icon-link" anchorid="获取用户相册" tips="复制节点链接"></i></h2>          <p>通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-photoaccesshelper-photoaccesshelper#getalbums-2" target="_blank">PhotoAccessHelper.getAlbums</a>接口获取用户相册。</p>     <p><strong>前提条件</strong></p>     <ul>      <li>获取相册管理模块photoAccessHelper实例。</li>      <li><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/photoaccesshelper-preparation#申请相册管理模块功能相关权限">申请相册管理模块权限</a>'ohos.permission.READ_IMAGEVIDEO'。</li>     </ul>     <p>下面以获取一个相册名为'albumName'的用户相册为例。</p>     <p><strong>开发步骤</strong></p>     <ol>      <li>建立检索条件，用于获取用户相册。</li>      <li>调用PhotoAccessHelper.getAlbums接口获取用户相册资源。</li>      <li>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-photoaccesshelper-fetchresult#getfirstobject-1" target="_blank">FetchResult.getFirstObject</a>接口获取第一个用户相册。</li>     </ol>     <div _ngcontent-pbw-c106="" class="highlight-div"><div _ngcontent-pbw-c106="" class="highlight-div-header"><div _ngcontent-pbw-c106="" class="highlight-div-header-left"><div _ngcontent-pbw-c106="" class="handle-button expand-button"><div _ngcontent-pbw-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pbw-c106="" class="highlight-div-header-right"><div _ngcontent-pbw-c106="" class="handle-button ai-button"></div><div _ngcontent-pbw-c106="" class="handle-button line-button"><div _ngcontent-pbw-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pbw-c106="" class="handle-button theme-button"><div _ngcontent-pbw-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pbw-c106="" class="handle-button copy-button"><div _ngcontent-pbw-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pbw-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { dataSharePredicates } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkData'</span>;</li><li><span class="hljs-keyword">import</span> { photoAccessHelper } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.MediaLibraryKit'</span>;</li><li>
</li><li><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">example</span>(<span class="hljs-params">phAccessHelper: photoAccessHelper.PhotoAccessHelper</span>) {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">predicates</span>: dataSharePredicates.<span class="hljs-property">DataSharePredicates</span> = <span class="hljs-keyword">new</span> dataSharePredicates.<span class="hljs-title class_">DataSharePredicates</span>();</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">albumName</span>: photoAccessHelper.<span class="hljs-property">AlbumKeys</span> = photoAccessHelper.<span class="hljs-property">AlbumKeys</span>.<span class="hljs-property">ALBUM_NAME</span>;</li><li>  predicates.<span class="hljs-title function_">equalTo</span>(albumName, <span class="hljs-string">'albumName'</span>);</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">fetchOptions</span>: photoAccessHelper.<span class="hljs-property">FetchOptions</span> = {</li><li>    <span class="hljs-attr">fetchColumns</span>: [],</li><li>    <span class="hljs-attr">predicates</span>: predicates</li><li>  };</li><li>
</li><li>  <span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">fetchResult</span>: photoAccessHelper.<span class="hljs-property">FetchResult</span>&lt;photoAccessHelper.<span class="hljs-property">Album</span>&gt; = <span class="hljs-keyword">await</span> phAccessHelper.<span class="hljs-title function_">getAlbums</span>(photoAccessHelper.<span class="hljs-property">AlbumType</span>.<span class="hljs-property">USER</span>, photoAccessHelper.<span class="hljs-property">AlbumSubtype</span>.<span class="hljs-property">USER_GENERIC</span>, fetchOptions);</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">album</span>: photoAccessHelper.<span class="hljs-property">Album</span> = <span class="hljs-keyword">await</span> fetchResult.<span class="hljs-title function_">getFirstObject</span>();</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'getAlbums successfully, albumName: '</span> + album.<span class="hljs-property">albumName</span>);</li><li>    fetchResult.<span class="hljs-title function_">close</span>();</li><li>  } <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'getAlbums failed with err: '</span> + err);</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="重命名用户相册">重命名用户相册<i class="anchor-icon anchor-icon-link" anchorid="重命名用户相册" tips="复制节点链接"></i></h2>          <p>重命名用户相册时，修改的是相册的Album.albumName属性。</p>     <p>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/kts-apis-photoaccesshelper-mediaalbumchangerequest#setalbumname11" target="_blank">MediaAlbumChangeRequest.setAlbumName</a>重命名用户相册后再通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-photoaccesshelper-photoaccesshelper#applychanges11" target="_blank">PhotoAccessHelper.applyChanges</a>更新到数据库中完成修改。</p>     <p>在重命名用户相册之前，需要先获取相册对象，可以通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-photoaccesshelper-fetchresult" target="_blank">FetchResult</a>中的接口获取对应位置的用户相册。</p>     <p>重命名相册时，相册名的参数规格为：</p>     <ul>      <li>相册名字符串长度为1~255。</li>      <li>       <p>不允许出现的非法英文字符，包括：</p>       <p>. \ / : * ? " ' ` &lt; &gt; | { } [ ]</p></li>      <li>英文字符大小写不敏感。</li>      <li>相册名不允许重名。</li>     </ul>     <p><strong>前提条件</strong></p>     <ul>      <li>获取相册管理模块photoAccessHelper实例。</li>      <li><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/photoaccesshelper-preparation#申请相册管理模块功能相关权限">申请相册管理模块权限</a>'ohos.permission.READ_IMAGEVIDEO'和'ohos.permission.WRITE_IMAGEVIDEO'。</li>     </ul>     <p>下面以将一个相册名为'albumName'的用户相册重命名为例。</p>     <p><strong>开发步骤</strong></p>     <ol>      <li>建立检索条件，用于获取用户相册。</li>      <li>调用PhotoAccessHelper.getAlbums接口获取用户相册资源。</li>      <li>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-photoaccesshelper-fetchresult#getfirstobject-1" target="_blank">FetchResult.getFirstObject</a>接口获取第一个用户相册。</li>      <li>调用MediaAlbumChangeRequest.setAlbumName接口设置新的相册名。</li>      <li>调用PhotoAccessHelper.applyChanges接口将修改的相册属性更新到数据库中完成修改。</li>     </ol>     <div _ngcontent-pbw-c106="" class="highlight-div"><div _ngcontent-pbw-c106="" class="highlight-div-header"><div _ngcontent-pbw-c106="" class="highlight-div-header-left"><div _ngcontent-pbw-c106="" class="handle-button expand-button"><div _ngcontent-pbw-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pbw-c106="" class="highlight-div-header-right"><div _ngcontent-pbw-c106="" class="handle-button ai-button"></div><div _ngcontent-pbw-c106="" class="handle-button line-button"><div _ngcontent-pbw-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pbw-c106="" class="handle-button theme-button"><div _ngcontent-pbw-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pbw-c106="" class="handle-button copy-button"><div _ngcontent-pbw-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pbw-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { dataSharePredicates } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkData'</span>;</li><li><span class="hljs-keyword">import</span> { photoAccessHelper } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.MediaLibraryKit'</span>;</li><li>
</li><li><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">example</span>(<span class="hljs-params">phAccessHelper: photoAccessHelper.PhotoAccessHelper</span>) {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">predicates</span>: dataSharePredicates.<span class="hljs-property">DataSharePredicates</span> = <span class="hljs-keyword">new</span> dataSharePredicates.<span class="hljs-title class_">DataSharePredicates</span>();</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">albumName</span>: photoAccessHelper.<span class="hljs-property">AlbumKeys</span> = photoAccessHelper.<span class="hljs-property">AlbumKeys</span>.<span class="hljs-property">ALBUM_NAME</span>;</li><li>  predicates.<span class="hljs-title function_">equalTo</span>(albumName, <span class="hljs-string">'albumName'</span>);</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">fetchOptions</span>: photoAccessHelper.<span class="hljs-property">FetchOptions</span> = {</li><li>    <span class="hljs-attr">fetchColumns</span>: [],</li><li>    <span class="hljs-attr">predicates</span>: predicates</li><li>  };</li><li>
</li><li>  <span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">fetchResult</span>: photoAccessHelper.<span class="hljs-property">FetchResult</span>&lt;photoAccessHelper.<span class="hljs-property">Album</span>&gt; = <span class="hljs-keyword">await</span> phAccessHelper.<span class="hljs-title function_">getAlbums</span>(photoAccessHelper.<span class="hljs-property">AlbumType</span>.<span class="hljs-property">USER</span>, photoAccessHelper.<span class="hljs-property">AlbumSubtype</span>.<span class="hljs-property">USER_GENERIC</span>, fetchOptions);</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">album</span>: photoAccessHelper.<span class="hljs-property">Album</span> = <span class="hljs-keyword">await</span> fetchResult.<span class="hljs-title function_">getFirstObject</span>();</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'getAlbums successfully, albumName: '</span> + album.<span class="hljs-property">albumName</span>);</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">albumChangeRequest</span>: photoAccessHelper.<span class="hljs-property">MediaAlbumChangeRequest</span> = <span class="hljs-keyword">new</span> photoAccessHelper.<span class="hljs-title class_">MediaAlbumChangeRequest</span>(album);</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">newAlbumName</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'newAlbumName'</span>;</li><li>    albumChangeRequest.<span class="hljs-title function_">setAlbumName</span>(newAlbumName);</li><li>    <span class="hljs-keyword">await</span> phAccessHelper.<span class="hljs-title function_">applyChanges</span>(albumChangeRequest);</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'setAlbumName successfully, new albumName: '</span> + album.<span class="hljs-property">albumName</span>);</li><li>    fetchResult.<span class="hljs-title function_">close</span>();</li><li>  } <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'setAlbumName failed with err: '</span> + err);</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="添加图片和视频到用户相册中">添加图片和视频到用户相册中<i class="anchor-icon anchor-icon-link" anchorid="添加图片和视频到用户相册中" tips="复制节点链接"></i></h2>          <p>先<a href="/consumer/cn/doc/harmonyos-guides/photoaccesshelper-useralbum-guidelines#获取用户相册">获取用户相册</a>对象和需要添加到用户相册中的图片或视频的对象数组，然后调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/kts-apis-photoaccesshelper-mediaalbumchangerequest#addassets11" target="_blank">MediaAlbumChangeRequest.addAssets</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-photoaccesshelper-photoaccesshelper#applychanges11" target="_blank">PhotoAccessHelper.applyChanges</a>接口往用户相册中添加图片或视频。</p>     <p><strong>前提条件</strong></p>     <ul>      <li>获取相册管理模块photoAccessHelper实例。</li>      <li><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/photoaccesshelper-preparation#申请相册管理模块功能相关权限">申请相册管理模块权限</a>'ohos.permission.READ_IMAGEVIDEO'和'ohos.permission.WRITE_IMAGEVIDEO'。</li>     </ul>     <p>下面以将往相册名为'albumName'的用户相册中添加一张图片为例。</p>     <p><strong>开发步骤</strong></p>     <ol>      <li>建立相册检索条件，用于获取用户相册。</li>      <li>建立图片检索条件，用于获取图片。</li>      <li>调用PhotoAccessHelper.getAlbums接口获取用户相册资源。</li>      <li>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-photoaccesshelper-fetchresult#getfirstobject" target="_blank">FetchResult.getFirstObject</a>接口获取第一个用户相册。</li>      <li>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-photoaccesshelper-photoaccesshelper#getassets" target="_blank">PhotoAccessHelper.getAssets</a>接口获取图片资源。</li>      <li>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-photoaccesshelper-fetchresult#getfirstobject" target="_blank">FetchResult.getFirstObject</a>接口获取第一张图片。</li>      <li>调用MediaAlbumChangeRequest.addAssets接口往用户相册中添加图片。</li>      <li>调用PhotoAccessHelper.applyChanges接口提交相册变更请求。</li>     </ol>     <div _ngcontent-pbw-c106="" class="highlight-div"><div _ngcontent-pbw-c106="" class="highlight-div-header"><div _ngcontent-pbw-c106="" class="highlight-div-header-left"><div _ngcontent-pbw-c106="" class="handle-button expand-button"><div _ngcontent-pbw-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pbw-c106="" class="highlight-div-header-right"><div _ngcontent-pbw-c106="" class="handle-button ai-button"></div><div _ngcontent-pbw-c106="" class="handle-button line-button"><div _ngcontent-pbw-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pbw-c106="" class="handle-button theme-button"><div _ngcontent-pbw-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pbw-c106="" class="handle-button copy-button"><div _ngcontent-pbw-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pbw-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { dataSharePredicates } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkData'</span>;</li><li><span class="hljs-keyword">import</span> { photoAccessHelper } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.MediaLibraryKit'</span>;</li><li>
</li><li><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">example</span>(<span class="hljs-params">phAccessHelper: photoAccessHelper.PhotoAccessHelper</span>) {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">albumPredicates</span>: dataSharePredicates.<span class="hljs-property">DataSharePredicates</span> = <span class="hljs-keyword">new</span> dataSharePredicates.<span class="hljs-title class_">DataSharePredicates</span>();</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">albumName</span>: photoAccessHelper.<span class="hljs-property">AlbumKeys</span> = photoAccessHelper.<span class="hljs-property">AlbumKeys</span>.<span class="hljs-property">ALBUM_NAME</span>;</li><li>  albumPredicates.<span class="hljs-title function_">equalTo</span>(albumName, <span class="hljs-string">'albumName'</span>);</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">albumFetchOptions</span>: photoAccessHelper.<span class="hljs-property">FetchOptions</span> = {</li><li>    <span class="hljs-attr">fetchColumns</span>: [],</li><li>    <span class="hljs-attr">predicates</span>: albumPredicates</li><li>  };</li><li>
</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">photoPredicates</span>: dataSharePredicates.<span class="hljs-property">DataSharePredicates</span> = <span class="hljs-keyword">new</span> dataSharePredicates.<span class="hljs-title class_">DataSharePredicates</span>();</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">photoFetchOptions</span>: photoAccessHelper.<span class="hljs-property">FetchOptions</span> = {</li><li>    <span class="hljs-attr">fetchColumns</span>: [],</li><li>    <span class="hljs-attr">predicates</span>: photoPredicates</li><li>  };</li><li>
</li><li>  <span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">albumFetchResult</span>: photoAccessHelper.<span class="hljs-property">FetchResult</span>&lt;photoAccessHelper.<span class="hljs-property">Album</span>&gt; = <span class="hljs-keyword">await</span> phAccessHelper.<span class="hljs-title function_">getAlbums</span>(photoAccessHelper.<span class="hljs-property">AlbumType</span>.<span class="hljs-property">USER</span>, photoAccessHelper.<span class="hljs-property">AlbumSubtype</span>.<span class="hljs-property">USER_GENERIC</span>, albumFetchOptions);</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">album</span>: photoAccessHelper.<span class="hljs-property">Album</span> = <span class="hljs-keyword">await</span> albumFetchResult.<span class="hljs-title function_">getFirstObject</span>();</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'getAlbums successfully, albumName: '</span> + album.<span class="hljs-property">albumName</span>);</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">photoFetchResult</span>: photoAccessHelper.<span class="hljs-property">FetchResult</span>&lt;photoAccessHelper.<span class="hljs-property">PhotoAsset</span>&gt; = <span class="hljs-keyword">await</span> phAccessHelper.<span class="hljs-title function_">getAssets</span>(photoFetchOptions);</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">photoAsset</span>: photoAccessHelper.<span class="hljs-property">PhotoAsset</span> = <span class="hljs-keyword">await</span> photoFetchResult.<span class="hljs-title function_">getFirstObject</span>();</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'getAssets successfully, albumName: '</span> + photoAsset.<span class="hljs-property">displayName</span>);</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">albumChangeRequest</span>: photoAccessHelper.<span class="hljs-property">MediaAlbumChangeRequest</span> = <span class="hljs-keyword">new</span> photoAccessHelper.<span class="hljs-title class_">MediaAlbumChangeRequest</span>(album);</li><li>    albumChangeRequest.<span class="hljs-title function_">addAssets</span>([photoAsset]);</li><li>    <span class="hljs-keyword">await</span> phAccessHelper.<span class="hljs-title function_">applyChanges</span>(albumChangeRequest);</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'succeed to add '</span> + photoAsset.<span class="hljs-property">displayName</span> + <span class="hljs-string">' to '</span> + album.<span class="hljs-property">albumName</span>);</li><li>    albumFetchResult.<span class="hljs-title function_">close</span>();</li><li>    photoFetchResult.<span class="hljs-title function_">close</span>();</li><li>  } <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'addAssets failed with err: '</span> + err);</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="获取用户相册中的图片和视频">获取用户相册中的图片和视频<i class="anchor-icon anchor-icon-link" anchorid="获取用户相册中的图片和视频" tips="复制节点链接"></i></h2>          <p>先<a href="/consumer/cn/doc/harmonyos-guides/photoaccesshelper-useralbum-guidelines#获取用户相册">获取用户相册</a>对象，然后调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-photoaccesshelper-absalbum#getassets-1" target="_blank">Album.getAssets</a>接口获取用户相册中的图片资源。</p>     <p><strong>前提条件</strong></p>     <ul>      <li>获取相册管理模块photoAccessHelper实例。</li>      <li><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/photoaccesshelper-preparation#申请相册管理模块功能相关权限">申请相册管理模块权限</a>'ohos.permission.READ_IMAGEVIDEO'和'ohos.permission.WRITE_IMAGEVIDEO'。</li>     </ul>     <p>下面以获取相册名为'albumName'的用户相册中的一张图片为例。</p>     <p><strong>开发步骤</strong></p>     <ol>      <li>建立相册检索条件，用于获取用户相册。</li>      <li>建立图片检索条件，用于获取图片。</li>      <li>调用PhotoAccessHelper.getAlbums接口获取用户相册资源。</li>      <li>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-photoaccesshelper-fetchresult#getfirstobject-1" target="_blank">FetchResult.getFirstObject</a>接口获取第一个用户相册。</li>      <li>调用Album.getAssets接口获取用户相册中的图片资源。</li>      <li>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-photoaccesshelper-fetchresult#getfirstobject-1" target="_blank">FetchResult.getFirstObject</a>接口获取第一张图片。</li>     </ol>     <div _ngcontent-pbw-c106="" class="highlight-div"><div _ngcontent-pbw-c106="" class="highlight-div-header"><div _ngcontent-pbw-c106="" class="highlight-div-header-left"><div _ngcontent-pbw-c106="" class="handle-button expand-button"><div _ngcontent-pbw-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pbw-c106="" class="highlight-div-header-right"><div _ngcontent-pbw-c106="" class="handle-button ai-button"></div><div _ngcontent-pbw-c106="" class="handle-button line-button"><div _ngcontent-pbw-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pbw-c106="" class="handle-button theme-button"><div _ngcontent-pbw-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pbw-c106="" class="handle-button copy-button"><div _ngcontent-pbw-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pbw-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { dataSharePredicates } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkData'</span>;</li><li><span class="hljs-keyword">import</span> { photoAccessHelper } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.MediaLibraryKit'</span>;</li><li>
</li><li><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">example</span>(<span class="hljs-params">phAccessHelper: photoAccessHelper.PhotoAccessHelper</span>) {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">albumPredicates</span>: dataSharePredicates.<span class="hljs-property">DataSharePredicates</span> = <span class="hljs-keyword">new</span> dataSharePredicates.<span class="hljs-title class_">DataSharePredicates</span>();</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">albumName</span>: photoAccessHelper.<span class="hljs-property">AlbumKeys</span> = photoAccessHelper.<span class="hljs-property">AlbumKeys</span>.<span class="hljs-property">ALBUM_NAME</span>;</li><li>  albumPredicates.<span class="hljs-title function_">equalTo</span>(albumName, <span class="hljs-string">'albumName'</span>);</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">albumFetchOptions</span>: photoAccessHelper.<span class="hljs-property">FetchOptions</span> = {</li><li>    <span class="hljs-attr">fetchColumns</span>: [],</li><li>    <span class="hljs-attr">predicates</span>: albumPredicates</li><li>  };</li><li>
</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">photoPredicates</span>: dataSharePredicates.<span class="hljs-property">DataSharePredicates</span> = <span class="hljs-keyword">new</span> dataSharePredicates.<span class="hljs-title class_">DataSharePredicates</span>();</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">photoFetchOptions</span>: photoAccessHelper.<span class="hljs-property">FetchOptions</span> = {</li><li>    <span class="hljs-attr">fetchColumns</span>: [],</li><li>    <span class="hljs-attr">predicates</span>: photoPredicates</li><li>  };</li><li>
</li><li>  <span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">albumFetchResult</span>: photoAccessHelper.<span class="hljs-property">FetchResult</span>&lt;photoAccessHelper.<span class="hljs-property">Album</span>&gt; = <span class="hljs-keyword">await</span> phAccessHelper.<span class="hljs-title function_">getAlbums</span>(photoAccessHelper.<span class="hljs-property">AlbumType</span>.<span class="hljs-property">USER</span>, photoAccessHelper.<span class="hljs-property">AlbumSubtype</span>.<span class="hljs-property">USER_GENERIC</span>, albumFetchOptions);</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">album</span>: photoAccessHelper.<span class="hljs-property">Album</span> = <span class="hljs-keyword">await</span> albumFetchResult.<span class="hljs-title function_">getFirstObject</span>();</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'getAlbums successfully, albumName: '</span> + album.<span class="hljs-property">albumName</span>);</li><li>    <span class="hljs-keyword">let</span> photoFetchResult = <span class="hljs-keyword">await</span> album.<span class="hljs-title function_">getAssets</span>(photoFetchOptions);</li><li>    <span class="hljs-keyword">let</span> photoAsset = <span class="hljs-keyword">await</span> photoFetchResult.<span class="hljs-title function_">getFirstObject</span>();</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'album getAssets successfully, albumName: '</span> + photoAsset.<span class="hljs-property">displayName</span>);</li><li>    albumFetchResult.<span class="hljs-title function_">close</span>();</li><li>    photoFetchResult.<span class="hljs-title function_">close</span>();</li><li>  } <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'album getAssets failed with err: '</span> + err);</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="从用户相册中移除图片和视频">从用户相册中移除图片和视频<i class="anchor-icon anchor-icon-link" anchorid="从用户相册中移除图片和视频" tips="复制节点链接"></i></h2>          <p>先<a href="/consumer/cn/doc/harmonyos-guides/photoaccesshelper-useralbum-guidelines#获取用户相册">获取用户相册</a>对象，然后调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-photoaccesshelper-absalbum#getassets-1" target="_blank">Album.getAssets</a>接口获取用户相册中的资源。</p>     <p>选择其中要移除的资源，然后调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/kts-apis-photoaccesshelper-mediaalbumchangerequest#removeassets11" target="_blank">MediaAlbumChangeRequest.removeAssets</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-photoaccesshelper-photoaccesshelper#applychanges11" target="_blank">PhotoAccessHelper.applyChanges</a>接口移除。</p>     <p><strong>前提条件</strong></p>     <ul>      <li>获取相册管理模块photoAccessHelper实例。</li>      <li><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/photoaccesshelper-preparation#申请相册管理模块功能相关权限">申请相册管理模块权限</a>'ohos.permission.READ_IMAGEVIDEO'和'ohos.permission.WRITE_IMAGEVIDEO'。</li>     </ul>     <p>下面以从相册名为'albumName'的用户相册中移除一张图片为例。</p>     <p><strong>开发步骤</strong></p>     <ol>      <li>建立相册检索条件，用于获取用户相册。</li>      <li>建立图片检索条件，用于获取图片。</li>      <li>调用PhotoAccessHelper.getAlbums接口获取用户相册资源。</li>      <li>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-photoaccesshelper-fetchresult#getfirstobject-1" target="_blank">FetchResult.getFirstObject</a>接口获取第一个用户相册。</li>      <li>调用Album.getAssets接口获取图片资源。</li>      <li>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-photoaccesshelper-fetchresult#getfirstobject-1" target="_blank">FetchResult.getFirstObject</a>接口获取第一张图片。</li>      <li>调用MediaAlbumChangeRequest.removeAssets接口从用户相册中移除图片。</li>      <li>调用PhotoAccessHelper.applyChanges接口提交相册变更请求。</li>     </ol>     <div _ngcontent-pbw-c106="" class="highlight-div"><div _ngcontent-pbw-c106="" class="highlight-div-header"><div _ngcontent-pbw-c106="" class="highlight-div-header-left"><div _ngcontent-pbw-c106="" class="handle-button expand-button"><div _ngcontent-pbw-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-pbw-c106="" class="highlight-div-header-right"><div _ngcontent-pbw-c106="" class="handle-button ai-button"></div><div _ngcontent-pbw-c106="" class="handle-button line-button"><div _ngcontent-pbw-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-pbw-c106="" class="handle-button theme-button"><div _ngcontent-pbw-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-pbw-c106="" class="handle-button copy-button"><div _ngcontent-pbw-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-pbw-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { dataSharePredicates } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkData'</span>;</li><li><span class="hljs-keyword">import</span> { photoAccessHelper } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.MediaLibraryKit'</span>;</li><li>
</li><li><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">example</span>(<span class="hljs-params">phAccessHelper: photoAccessHelper.PhotoAccessHelper</span>) {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">albumPredicates</span>: dataSharePredicates.<span class="hljs-property">DataSharePredicates</span> = <span class="hljs-keyword">new</span> dataSharePredicates.<span class="hljs-title class_">DataSharePredicates</span>();</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">albumName</span>: photoAccessHelper.<span class="hljs-property">AlbumKeys</span> = photoAccessHelper.<span class="hljs-property">AlbumKeys</span>.<span class="hljs-property">ALBUM_NAME</span>;</li><li>  albumPredicates.<span class="hljs-title function_">equalTo</span>(albumName, <span class="hljs-string">'albumName'</span>);</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">albumFetchOptions</span>: photoAccessHelper.<span class="hljs-property">FetchOptions</span> = {</li><li>    <span class="hljs-attr">fetchColumns</span>: [],</li><li>    <span class="hljs-attr">predicates</span>: albumPredicates</li><li>  };</li><li>
</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">photoPredicates</span>: dataSharePredicates.<span class="hljs-property">DataSharePredicates</span> = <span class="hljs-keyword">new</span> dataSharePredicates.<span class="hljs-title class_">DataSharePredicates</span>();</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">photoFetchOptions</span>: photoAccessHelper.<span class="hljs-property">FetchOptions</span> = {</li><li>    <span class="hljs-attr">fetchColumns</span>: [],</li><li>    <span class="hljs-attr">predicates</span>: photoPredicates</li><li>  };</li><li>
</li><li>  <span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">albumFetchResult</span>: photoAccessHelper.<span class="hljs-property">FetchResult</span>&lt;photoAccessHelper.<span class="hljs-property">Album</span>&gt; = <span class="hljs-keyword">await</span> phAccessHelper.<span class="hljs-title function_">getAlbums</span>(photoAccessHelper.<span class="hljs-property">AlbumType</span>.<span class="hljs-property">USER</span>, photoAccessHelper.<span class="hljs-property">AlbumSubtype</span>.<span class="hljs-property">USER_GENERIC</span>, albumFetchOptions);</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">album</span>: photoAccessHelper.<span class="hljs-property">Album</span> = <span class="hljs-keyword">await</span> albumFetchResult.<span class="hljs-title function_">getFirstObject</span>();</li><li>    <span class="hljs-keyword">if</span> (album === <span class="hljs-literal">undefined</span>) {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'album is undefined'</span>);</li><li>      albumFetchResult.<span class="hljs-title function_">close</span>();</li><li>      <span class="hljs-keyword">return</span>;</li><li>    }</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'getAlbums successfully, albumName: '</span> + album.<span class="hljs-property">albumName</span>);</li><li>    <span class="hljs-keyword">let</span> photoFetchResult = <span class="hljs-keyword">await</span> album.<span class="hljs-title function_">getAssets</span>(photoFetchOptions);</li><li>    <span class="hljs-keyword">let</span> photoAsset = <span class="hljs-keyword">await</span> photoFetchResult.<span class="hljs-title function_">getFirstObject</span>();</li><li>    <span class="hljs-keyword">if</span> (photoAsset === <span class="hljs-literal">undefined</span>) {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'photoAsset is undefined'</span>);</li><li>      photoFetchResult.<span class="hljs-title function_">close</span>();</li><li>      <span class="hljs-keyword">return</span>;</li><li>    }</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'album getAssets successfully, albumName: '</span> + photoAsset.<span class="hljs-property">displayName</span>);</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">albumChangeRequest</span>: photoAccessHelper.<span class="hljs-property">MediaAlbumChangeRequest</span> = <span class="hljs-keyword">new</span> photoAccessHelper.<span class="hljs-title class_">MediaAlbumChangeRequest</span>(album);</li><li>    albumChangeRequest.<span class="hljs-title function_">removeAssets</span>([photoAsset]);</li><li>    <span class="hljs-keyword">await</span> phAccessHelper.<span class="hljs-title function_">applyChanges</span>(albumChangeRequest);</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'succeed to remove '</span> + photoAsset.<span class="hljs-property">displayName</span> + <span class="hljs-string">' from '</span> + album.<span class="hljs-property">albumName</span>);</li><li>    albumFetchResult.<span class="hljs-title function_">close</span>();</li><li>    photoFetchResult.<span class="hljs-title function_">close</span>();</li><li>  } <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'removeAssets failed with err: '</span> + err);</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>   </div>   <div></div></div>